const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-Cd3wF-to.js","assets/graph-CqJQq_yO.js","assets/_baseUniq-CbO-8VIx.js","assets/layout-BLzPmoMH.js","assets/_basePickBy-t1ho-wn-.js","assets/clone-OT5icCTA.js","assets/c4Diagram-VJAJSXHY-CbWfQgx6.js","assets/chunk-D6G4REZN-kq4sgvyi.js","assets/flowDiagram-4HSFHLVR-ox3wVZnH.js","assets/chunk-RZ5BOZE2-CrOxtQqH.js","assets/channel-DCMeeY9m.js","assets/erDiagram-Q7BY3M3F-ClW3W3Lm.js","assets/gitGraphDiagram-7IBYFJ6S-CdS0MeYr.js","assets/chunk-4BMEZGHF-BHxhWj1K.js","assets/chunk-XZIHB7SX-Daic2yjy.js","assets/radar-MK3ICKWK-O3wDGIrH.js","assets/ganttDiagram-APWFNJXF-Dbdq55u7.js","assets/linear-wObsF_VX.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-DlL3HGUv.js","assets/pieDiagram-IB7DONF6-DbXs6uhO.js","assets/arc-DGw4Oum_.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-DYYH9nmp.js","assets/xychartDiagram-VJFVF3MP-kHLixIrq.js","assets/requirementDiagram-KVF5MWMF-C3HUqf4M.js","assets/sequenceDiagram-X6HHIX6F-DFrBYG9V.js","assets/classDiagram-GIVACNV2-DPOFCsq0.js","assets/chunk-A2AXSNBT-BdurpdI8.js","assets/classDiagram-v2-COTLJTTW-DPOFCsq0.js","assets/stateDiagram-DGXRK772-B02l0ZUW.js","assets/chunk-AEK57VVT-DXeXNlgY.js","assets/stateDiagram-v2-YXO3MK2T-BLG6zomh.js","assets/journeyDiagram-U35MCT3I-CfDj_deJ.js","assets/timeline-definition-BDJGKUSR-D3dihuQl.js","assets/mindmap-definition-ALO5MXBD-DOPmOc00.js","assets/cytoscape.esm-Cj8CsbiE.js","assets/sankeyDiagram-QLVOVGJD-CMxqnjlT.js","assets/diagram-VNBRO52H-CGL2XTgy.js","assets/diagram-SSKATNLV-DPdNGNxT.js","assets/blockDiagram-JOT3LUYC--lRDJLLV.js","assets/architectureDiagram-IEHRJDOE-BSAl4fw0.js"])))=>i.map(i=>d[i]);
var x0e=Object.defineProperty;var w0e=(e,t,n)=>t in e?x0e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ue=(e,t,n)=>w0e(e,typeof t!="symbol"?t+"":t,n);function S0e(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var jm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function la(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var FI={exports:{}},yx={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lz;function _0e(){if(lz)return yx;lz=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return yx.Fragment=t,yx.jsx=n,yx.jsxs=n,yx}var cz;function C0e(){return cz||(cz=1,FI.exports=_0e()),FI.exports}var f=C0e(),LI={exports:{}};function k0e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $K={exports:{}},ji=$K.exports={},Pu,Ou;function EP(){throw new Error("setTimeout has not been defined")}function TP(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Pu=setTimeout:Pu=EP}catch{Pu=EP}try{typeof clearTimeout=="function"?Ou=clearTimeout:Ou=TP}catch{Ou=TP}})();function BK(e){if(Pu===setTimeout)return setTimeout(e,0);if((Pu===EP||!Pu)&&setTimeout)return Pu=setTimeout,setTimeout(e,0);try{return Pu(e,0)}catch{try{return Pu.call(null,e,0)}catch{return Pu.call(this,e,0)}}}function E0e(e){if(Ou===clearTimeout)return clearTimeout(e);if((Ou===TP||!Ou)&&clearTimeout)return Ou=clearTimeout,clearTimeout(e);try{return Ou(e)}catch{try{return Ou.call(null,e)}catch{return Ou.call(this,e)}}}var of=[],gy=!1,Pm,$2=-1;function T0e(){!gy||!Pm||(gy=!1,Pm.length?of=Pm.concat(of):$2=-1,of.length&&zK())}function zK(){if(!gy){var e=BK(T0e);gy=!0;for(var t=of.length;t;){for(Pm=of,of=[];++$2<t;)Pm&&Pm[$2].run();$2=-1,t=of.length}Pm=null,gy=!1,E0e(e)}}ji.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];of.push(new UK(e,t)),of.length===1&&!gy&&BK(zK)};function UK(e,t){this.fun=e,this.array=t}UK.prototype.run=function(){this.fun.apply(null,this.array)};ji.title="browser";ji.browser=!0;ji.env={};ji.argv=[];ji.version="";ji.versions={};function Pf(){}ji.on=Pf;ji.addListener=Pf;ji.once=Pf;ji.off=Pf;ji.removeListener=Pf;ji.removeAllListeners=Pf;ji.emit=Pf;ji.prependListener=Pf;ji.prependOnceListener=Pf;ji.listeners=function(e){return[]};ji.binding=function(e){throw new Error("process.binding is not supported")};ji.cwd=function(){return"/"};ji.chdir=function(e){throw new Error("process.chdir is not supported")};ji.umask=function(){return 0};var A0e=$K.exports;const Wi=k0e(A0e);var Mr={},uz;function N0e(){if(uz)return Mr;uz=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(B){return B===null||typeof B!="object"?null:(B=d&&B[d]||B["@@iterator"],typeof B=="function"?B:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,y={};function v(B,G,Z){this.props=B,this.context=G,this.refs=y,this.updater=Z||p}v.prototype.isReactComponent={},v.prototype.setState=function(B,G){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,G,"setState")},v.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(B,G,Z){this.props=B,this.context=G,this.refs=y,this.updater=Z||p}var S=w.prototype=new x;S.constructor=w,g(S,v.prototype),S.isPureReactComponent=!0;var _=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function A(B,G,Z,ne,ae,le){return Z=le.ref,{$$typeof:e,type:B,key:G,ref:Z!==void 0?Z:null,props:le}}function R(B,G){return A(B.type,G,void 0,void 0,void 0,B.props)}function M(B){return typeof B=="object"&&B!==null&&B.$$typeof===e}function j(B){var G={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(Z){return G[Z]})}var F=/\/+/g;function P(B,G){return typeof B=="object"&&B!==null&&B.key!=null?j(""+B.key):G.toString(36)}function q(){}function I(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(q,q):(B.status="pending",B.then(function(G){B.status==="pending"&&(B.status="fulfilled",B.value=G)},function(G){B.status==="pending"&&(B.status="rejected",B.reason=G)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function V(B,G,Z,ne,ae){var le=typeof B;(le==="undefined"||le==="boolean")&&(B=null);var Se=!1;if(B===null)Se=!0;else switch(le){case"bigint":case"string":case"number":Se=!0;break;case"object":switch(B.$$typeof){case e:case t:Se=!0;break;case u:return Se=B._init,V(Se(B._payload),G,Z,ne,ae)}}if(Se)return ae=ae(B),Se=ne===""?"."+P(B,0):ne,_(ae)?(Z="",Se!=null&&(Z=Se.replace(F,"$&/")+"/"),V(ae,G,Z,"",function(pe){return pe})):ae!=null&&(M(ae)&&(ae=R(ae,Z+(ae.key==null||B&&B.key===ae.key?"":(""+ae.key).replace(F,"$&/")+"/")+Se)),G.push(ae)),1;Se=0;var Ee=ne===""?".":ne+":";if(_(B))for(var he=0;he<B.length;he++)ne=B[he],le=Ee+P(ne,he),Se+=V(ne,G,Z,le,ae);else if(he=h(B),typeof he=="function")for(B=he.call(B),he=0;!(ne=B.next()).done;)ne=ne.value,le=Ee+P(ne,he++),Se+=V(ne,G,Z,le,ae);else if(le==="object"){if(typeof B.then=="function")return V(I(B),G,Z,ne,ae);throw G=String(B),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return Se}function D(B,G,Z){if(B==null)return B;var ne=[],ae=0;return V(B,ne,"","",function(le){return G.call(Z,le,ae++)}),ne}function z(B){if(B._status===-1){var G=B._result;G=G(),G.then(function(Z){(B._status===0||B._status===-1)&&(B._status=1,B._result=Z)},function(Z){(B._status===0||B._status===-1)&&(B._status=2,B._result=Z)}),B._status===-1&&(B._status=0,B._result=G)}if(B._status===1)return B._result.default;throw B._result}var $=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(G))return}else if(typeof Wi=="object"&&typeof Wi.emit=="function"){Wi.emit("uncaughtException",B);return}console.error(B)};function Y(){}return Mr.Children={map:D,forEach:function(B,G,Z){D(B,function(){G.apply(this,arguments)},Z)},count:function(B){var G=0;return D(B,function(){G++}),G},toArray:function(B){return D(B,function(G){return G})||[]},only:function(B){if(!M(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Mr.Component=v,Mr.Fragment=n,Mr.Profiler=s,Mr.PureComponent=w,Mr.StrictMode=r,Mr.Suspense=l,Mr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Mr.__COMPILER_RUNTIME={__proto__:null,c:function(B){return k.H.useMemoCache(B)}},Mr.cache=function(B){return function(){return B.apply(null,arguments)}},Mr.cloneElement=function(B,G,Z){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var ne=g({},B.props),ae=B.key,le=void 0;if(G!=null)for(Se in G.ref!==void 0&&(le=void 0),G.key!==void 0&&(ae=""+G.key),G)!T.call(G,Se)||Se==="key"||Se==="__self"||Se==="__source"||Se==="ref"&&G.ref===void 0||(ne[Se]=G[Se]);var Se=arguments.length-2;if(Se===1)ne.children=Z;else if(1<Se){for(var Ee=Array(Se),he=0;he<Se;he++)Ee[he]=arguments[he+2];ne.children=Ee}return A(B.type,ae,void 0,void 0,le,ne)},Mr.createContext=function(B){return B={$$typeof:a,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:i,_context:B},B},Mr.createElement=function(B,G,Z){var ne,ae={},le=null;if(G!=null)for(ne in G.key!==void 0&&(le=""+G.key),G)T.call(G,ne)&&ne!=="key"&&ne!=="__self"&&ne!=="__source"&&(ae[ne]=G[ne]);var Se=arguments.length-2;if(Se===1)ae.children=Z;else if(1<Se){for(var Ee=Array(Se),he=0;he<Se;he++)Ee[he]=arguments[he+2];ae.children=Ee}if(B&&B.defaultProps)for(ne in Se=B.defaultProps,Se)ae[ne]===void 0&&(ae[ne]=Se[ne]);return A(B,le,void 0,void 0,null,ae)},Mr.createRef=function(){return{current:null}},Mr.forwardRef=function(B){return{$$typeof:o,render:B}},Mr.isValidElement=M,Mr.lazy=function(B){return{$$typeof:u,_payload:{_status:-1,_result:B},_init:z}},Mr.memo=function(B,G){return{$$typeof:c,type:B,compare:G===void 0?null:G}},Mr.startTransition=function(B){var G=k.T,Z={};k.T=Z;try{var ne=B(),ae=k.S;ae!==null&&ae(Z,ne),typeof ne=="object"&&ne!==null&&typeof ne.then=="function"&&ne.then(Y,$)}catch(le){$(le)}finally{k.T=G}},Mr.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Mr.use=function(B){return k.H.use(B)},Mr.useActionState=function(B,G,Z){return k.H.useActionState(B,G,Z)},Mr.useCallback=function(B,G){return k.H.useCallback(B,G)},Mr.useContext=function(B){return k.H.useContext(B)},Mr.useDebugValue=function(){},Mr.useDeferredValue=function(B,G){return k.H.useDeferredValue(B,G)},Mr.useEffect=function(B,G,Z){var ne=k.H;if(typeof Z=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return ne.useEffect(B,G)},Mr.useId=function(){return k.H.useId()},Mr.useImperativeHandle=function(B,G,Z){return k.H.useImperativeHandle(B,G,Z)},Mr.useInsertionEffect=function(B,G){return k.H.useInsertionEffect(B,G)},Mr.useLayoutEffect=function(B,G){return k.H.useLayoutEffect(B,G)},Mr.useMemo=function(B,G){return k.H.useMemo(B,G)},Mr.useOptimistic=function(B,G){return k.H.useOptimistic(B,G)},Mr.useReducer=function(B,G,Z){return k.H.useReducer(B,G,Z)},Mr.useRef=function(B){return k.H.useRef(B)},Mr.useState=function(B){return k.H.useState(B)},Mr.useSyncExternalStore=function(B,G,Z){return k.H.useSyncExternalStore(B,G,Z)},Mr.useTransition=function(){return k.H.useTransition()},Mr.version="19.1.0",Mr}var dz;function Ib(){return dz||(dz=1,LI.exports=N0e()),LI.exports}var E=Ib();const We=la(E),qK=S0e({__proto__:null,default:We},[E]);var $I={exports:{}},bx={},BI={exports:{}},zI={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fz;function R0e(){return fz||(fz=1,function(e){function t(D,z){var $=D.length;D.push(z);e:for(;0<$;){var Y=$-1>>>1,B=D[Y];if(0<s(B,z))D[Y]=z,D[$]=B,$=Y;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var z=D[0],$=D.pop();if($!==z){D[0]=$;e:for(var Y=0,B=D.length,G=B>>>1;Y<G;){var Z=2*(Y+1)-1,ne=D[Z],ae=Z+1,le=D[ae];if(0>s(ne,$))ae<B&&0>s(le,ne)?(D[Y]=le,D[ae]=$,Y=ae):(D[Y]=ne,D[Z]=$,Y=Z);else if(ae<B&&0>s(le,$))D[Y]=le,D[ae]=$,Y=ae;else break e}}return z}function s(D,z){var $=D.sortIndex-z.sortIndex;return $!==0?$:D.id-z.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,p=!1,g=!1,y=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function _(D){for(var z=n(c);z!==null;){if(z.callback===null)r(c);else if(z.startTime<=D)r(c),z.sortIndex=z.expirationTime,t(l,z);else break;z=n(c)}}function k(D){if(y=!1,_(D),!g)if(n(l)!==null)g=!0,T||(T=!0,P());else{var z=n(c);z!==null&&V(k,z.startTime-D)}}var T=!1,A=-1,R=5,M=-1;function j(){return v?!0:!(e.unstable_now()-M<R)}function F(){if(v=!1,T){var D=e.unstable_now();M=D;var z=!0;try{e:{g=!1,y&&(y=!1,w(A),A=-1),p=!0;var $=h;try{t:{for(_(D),d=n(l);d!==null&&!(d.expirationTime>D&&j());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,h=d.priorityLevel;var B=Y(d.expirationTime<=D);if(D=e.unstable_now(),typeof B=="function"){d.callback=B,_(D),z=!0;break t}d===n(l)&&r(l),_(D)}else r(l);d=n(l)}if(d!==null)z=!0;else{var G=n(c);G!==null&&V(k,G.startTime-D),z=!1}}break e}finally{d=null,h=$,p=!1}z=void 0}}finally{z?P():T=!1}}}var P;if(typeof S=="function")P=function(){S(F)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,I=q.port2;q.port1.onmessage=F,P=function(){I.postMessage(null)}}else P=function(){x(F,0)};function V(D,z){A=x(function(){D(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(D){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var $=h;h=z;try{return D()}finally{h=$}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(D,z){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var $=h;h=D;try{return z()}finally{h=$}},e.unstable_scheduleCallback=function(D,z,$){var Y=e.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?Y+$:Y):$=Y,D){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=$+B,D={id:u++,callback:z,priorityLevel:D,startTime:$,expirationTime:B,sortIndex:-1},$>Y?(D.sortIndex=$,t(c,D),n(l)===null&&D===n(c)&&(y?(w(A),A=-1):y=!0,V(k,$-Y))):(D.sortIndex=B,t(l,D),g||p||(g=!0,T||(T=!0,P()))),D},e.unstable_shouldYield=j,e.unstable_wrapCallback=function(D){var z=h;return function(){var $=h;h=z;try{return D.apply(this,arguments)}finally{h=$}}}}(zI)),zI}var hz;function I0e(){return hz||(hz=1,BI.exports=R0e()),BI.exports}var UI={exports:{}},Wa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pz;function M0e(){if(pz)return Wa;pz=1;var e=Ib();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Wa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Wa.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Wa.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Wa.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Wa.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Wa.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,p=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:p}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:p,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Wa.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Wa.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Wa.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Wa.requestFormReset=function(l){r.d.r(l)},Wa.unstable_batchedUpdates=function(l,c){return l(c)},Wa.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Wa.useFormStatus=function(){return a.H.useHostTransitionStatus()},Wa.version="19.1.0",Wa}var mz;function VK(){if(mz)return UI.exports;mz=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),UI.exports=M0e(),UI.exports}var gz;function j0e(){if(gz)return bx;gz=1;var e=I0e(),t=Ib(),n=VK();function r(m){var b="https://react.dev/errors/"+m;if(1<arguments.length){b+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)b+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+m+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function i(m){var b=m,C=m;if(m.alternate)for(;b.return;)b=b.return;else{m=b;do b=m,(b.flags&4098)!==0&&(C=b.return),m=b.return;while(m)}return b.tag===3?C:null}function a(m){if(m.tag===13){var b=m.memoizedState;if(b===null&&(m=m.alternate,m!==null&&(b=m.memoizedState)),b!==null)return b.dehydrated}return null}function o(m){if(i(m)!==m)throw Error(r(188))}function l(m){var b=m.alternate;if(!b){if(b=i(m),b===null)throw Error(r(188));return b!==m?null:m}for(var C=m,N=b;;){var L=C.return;if(L===null)break;var K=L.alternate;if(K===null){if(N=L.return,N!==null){C=N;continue}break}if(L.child===K.child){for(K=L.child;K;){if(K===C)return o(L),m;if(K===N)return o(L),b;K=K.sibling}throw Error(r(188))}if(C.return!==N.return)C=L,N=K;else{for(var ge=!1,De=L.child;De;){if(De===C){ge=!0,C=L,N=K;break}if(De===N){ge=!0,N=L,C=K;break}De=De.sibling}if(!ge){for(De=K.child;De;){if(De===C){ge=!0,C=K,N=L;break}if(De===N){ge=!0,N=K,C=L;break}De=De.sibling}if(!ge)throw Error(r(189))}}if(C.alternate!==N)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?m:b}function c(m){var b=m.tag;if(b===5||b===26||b===27||b===6)return m;for(m=m.child;m!==null;){if(b=c(m),b!==null)return b;m=m.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),j=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function P(m){return m===null||typeof m!="object"?null:(m=F&&m[F]||m["@@iterator"],typeof m=="function"?m:null)}var q=Symbol.for("react.client.reference");function I(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===q?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case g:return"Fragment";case v:return"Profiler";case y:return"StrictMode";case k:return"Suspense";case T:return"SuspenseList";case M:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case p:return"Portal";case S:return(m.displayName||"Context")+".Provider";case w:return(m._context.displayName||"Context")+".Consumer";case _:var b=m.render;return m=m.displayName,m||(m=b.displayName||b.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case A:return b=m.displayName||null,b!==null?b:I(m.type)||"Memo";case R:b=m._payload,m=m._init;try{return I(m(b))}catch{}}return null}var V=Array.isArray,D=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$={pending:!1,data:null,method:null,action:null},Y=[],B=-1;function G(m){return{current:m}}function Z(m){0>B||(m.current=Y[B],Y[B]=null,B--)}function ne(m,b){B++,Y[B]=m.current,m.current=b}var ae=G(null),le=G(null),Se=G(null),Ee=G(null);function he(m,b){switch(ne(Se,b),ne(le,m),ne(ae,null),b.nodeType){case 9:case 11:m=(m=b.documentElement)&&(m=m.namespaceURI)?DB(m):0;break;default:if(m=b.tagName,b=b.namespaceURI)b=DB(b),m=FB(b,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}Z(ae),ne(ae,m)}function pe(){Z(ae),Z(le),Z(Se)}function Le(m){m.memoizedState!==null&&ne(Ee,m);var b=ae.current,C=FB(b,m.type);b!==C&&(ne(le,m),ne(ae,C))}function He(m){le.current===m&&(Z(ae),Z(le)),Ee.current===m&&(Z(Ee),fx._currentValue=$)}var Fe=Object.prototype.hasOwnProperty,Ie=e.unstable_scheduleCallback,X=e.unstable_cancelCallback,ye=e.unstable_shouldYield,Ne=e.unstable_requestPaint,fe=e.unstable_now,ce=e.unstable_getCurrentPriorityLevel,se=e.unstable_ImmediatePriority,Pe=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,je=e.unstable_LowPriority,ot=e.unstable_IdlePriority,Et=e.log,ut=e.unstable_setDisableYieldValue,Pt=null,$t=null;function Ft(m){if(typeof Et=="function"&&ut(m),$t&&typeof $t.setStrictMode=="function")try{$t.setStrictMode(Pt,m)}catch{}}var Ht=Math.clz32?Math.clz32:ee,Ce=Math.log,U=Math.LN2;function ee(m){return m>>>=0,m===0?32:31-(Ce(m)/U|0)|0}var xe=256,Re=4194304;function ve(m){var b=m&42;if(b!==0)return b;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function Me(m,b,C){var N=m.pendingLanes;if(N===0)return 0;var L=0,K=m.suspendedLanes,ge=m.pingedLanes;m=m.warmLanes;var De=N&134217727;return De!==0?(N=De&~K,N!==0?L=ve(N):(ge&=De,ge!==0?L=ve(ge):C||(C=De&~m,C!==0&&(L=ve(C))))):(De=N&~K,De!==0?L=ve(De):ge!==0?L=ve(ge):C||(C=N&~m,C!==0&&(L=ve(C)))),L===0?0:b!==0&&b!==L&&(b&K)===0&&(K=L&-L,C=b&-b,K>=C||K===32&&(C&4194048)!==0)?b:L}function de(m,b){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&b)===0}function ht(m,b){switch(m){case 1:case 2:case 4:case 8:case 64:return b+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var m=xe;return xe<<=1,(xe&4194048)===0&&(xe=256),m}function W(){var m=Re;return Re<<=1,(Re&62914560)===0&&(Re=4194304),m}function Ve(m){for(var b=[],C=0;31>C;C++)b.push(m);return b}function tt(m,b){m.pendingLanes|=b,b!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function we(m,b,C,N,L,K){var ge=m.pendingLanes;m.pendingLanes=C,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=C,m.entangledLanes&=C,m.errorRecoveryDisabledLanes&=C,m.shellSuspendCounter=0;var De=m.entanglements,Xe=m.expirationTimes,_t=m.hiddenUpdates;for(C=ge&~C;0<C;){var Dt=31-Ht(C),zt=1<<Dt;De[Dt]=0,Xe[Dt]=-1;var Tt=_t[Dt];if(Tt!==null)for(_t[Dt]=null,Dt=0;Dt<Tt.length;Dt++){var Rt=Tt[Dt];Rt!==null&&(Rt.lane&=-536870913)}C&=~zt}N!==0&&Te(m,N,0),K!==0&&L===0&&m.tag!==0&&(m.suspendedLanes|=K&~(ge&~b))}function Te(m,b,C){m.pendingLanes|=b,m.suspendedLanes&=~b;var N=31-Ht(b);m.entangledLanes|=b,m.entanglements[N]=m.entanglements[N]|1073741824|C&4194090}function Ue(m,b){var C=m.entangledLanes|=b;for(m=m.entanglements;C;){var N=31-Ht(C),L=1<<N;L&b|m[N]&b&&(m[N]|=b),C&=~L}}function Ct(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function me(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function Q(){var m=z.p;return m!==0?m:(m=window.event,m===void 0?32:nz(m.type))}function J(m,b){var C=z.p;try{return z.p=m,b()}finally{z.p=C}}var te=Math.random().toString(36).slice(2),_e="__reactFiber$"+te,$e="__reactProps$"+te,Ge="__reactContainer$"+te,wt="__reactEvents$"+te,Jt="__reactListeners$"+te,jn="__reactHandles$"+te,Gt="__reactResources$"+te,rn="__reactMarker$"+te;function dn(m){delete m[_e],delete m[$e],delete m[wt],delete m[Jt],delete m[jn]}function br(m){var b=m[_e];if(b)return b;for(var C=m.parentNode;C;){if(b=C[Ge]||C[_e]){if(C=b.alternate,b.child!==null||C!==null&&C.child!==null)for(m=zB(m);m!==null;){if(C=m[_e])return C;m=zB(m)}return b}m=C,C=m.parentNode}return null}function Cr(m){if(m=m[_e]||m[Ge]){var b=m.tag;if(b===5||b===6||b===13||b===26||b===27||b===3)return m}return null}function Jr(m){var b=m.tag;if(b===5||b===26||b===27||b===6)return m.stateNode;throw Error(r(33))}function Qr(m){var b=m[Gt];return b||(b=m[Gt]={hoistableStyles:new Map,hoistableScripts:new Map}),b}function Sr(m){m[rn]=!0}var mn=new Set,nt={};function Vt(m,b){gn(m,b),gn(m+"Capture",b)}function gn(m,b){for(nt[m]=b,m=0;m<b.length;m++)mn.add(b[m])}var tr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ps={},es={};function xi(m){return Fe.call(es,m)?!0:Fe.call(ps,m)?!1:tr.test(m)?es[m]=!0:(ps[m]=!0,!1)}function si(m,b,C){if(xi(b))if(C===null)m.removeAttribute(b);else{switch(typeof C){case"undefined":case"function":case"symbol":m.removeAttribute(b);return;case"boolean":var N=b.toLowerCase().slice(0,5);if(N!=="data-"&&N!=="aria-"){m.removeAttribute(b);return}}m.setAttribute(b,""+C)}}function Ea(m,b,C){if(C===null)m.removeAttribute(b);else{switch(typeof C){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(b);return}m.setAttribute(b,""+C)}}function Zi(m,b,C,N){if(N===null)m.removeAttribute(C);else{switch(typeof N){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(C);return}m.setAttributeNS(b,C,""+N)}}var $s,fo;function ho(m){if($s===void 0)try{throw Error()}catch(C){var b=C.stack.trim().match(/\n( *(at )?)/);$s=b&&b[1]||"",fo=-1<C.stack.indexOf(`
    at`)?" (<anonymous>)":-1<C.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$s+m+fo}var hu=!1;function Gf(m,b){if(!m||hu)return"";hu=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var N={DetermineComponentFrameRoot:function(){try{if(b){var zt=function(){throw Error()};if(Object.defineProperty(zt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(zt,[])}catch(Rt){var Tt=Rt}Reflect.construct(m,[],zt)}else{try{zt.call()}catch(Rt){Tt=Rt}m.call(zt.prototype)}}else{try{throw Error()}catch(Rt){Tt=Rt}(zt=m())&&typeof zt.catch=="function"&&zt.catch(function(){})}}catch(Rt){if(Rt&&Tt&&typeof Rt.stack=="string")return[Rt.stack,Tt.stack]}return[null,null]}};N.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var L=Object.getOwnPropertyDescriptor(N.DetermineComponentFrameRoot,"name");L&&L.configurable&&Object.defineProperty(N.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var K=N.DetermineComponentFrameRoot(),ge=K[0],De=K[1];if(ge&&De){var Xe=ge.split(`
`),_t=De.split(`
`);for(L=N=0;N<Xe.length&&!Xe[N].includes("DetermineComponentFrameRoot");)N++;for(;L<_t.length&&!_t[L].includes("DetermineComponentFrameRoot");)L++;if(N===Xe.length||L===_t.length)for(N=Xe.length-1,L=_t.length-1;1<=N&&0<=L&&Xe[N]!==_t[L];)L--;for(;1<=N&&0<=L;N--,L--)if(Xe[N]!==_t[L]){if(N!==1||L!==1)do if(N--,L--,0>L||Xe[N]!==_t[L]){var Dt=`
`+Xe[N].replace(" at new "," at ");return m.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",m.displayName)),Dt}while(1<=N&&0<=L);break}}}finally{hu=!1,Error.prepareStackTrace=C}return(C=m?m.displayName||m.name:"")?ho(C):""}function Fr(m){switch(m.tag){case 26:case 27:case 5:return ho(m.type);case 16:return ho("Lazy");case 13:return ho("Suspense");case 19:return ho("SuspenseList");case 0:case 15:return Gf(m.type,!1);case 11:return Gf(m.type.render,!1);case 1:return Gf(m.type,!0);case 31:return ho("Activity");default:return""}}function qp(m){try{var b="";do b+=Fr(m),m=m.return;while(m);return b}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}function Ta(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function Vp(m){var b=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(b==="checkbox"||b==="radio")}function Ss(m){var b=Vp(m)?"checked":"value",C=Object.getOwnPropertyDescriptor(m.constructor.prototype,b),N=""+m[b];if(!m.hasOwnProperty(b)&&typeof C<"u"&&typeof C.get=="function"&&typeof C.set=="function"){var L=C.get,K=C.set;return Object.defineProperty(m,b,{configurable:!0,get:function(){return L.call(this)},set:function(ge){N=""+ge,K.call(this,ge)}}),Object.defineProperty(m,b,{enumerable:C.enumerable}),{getValue:function(){return N},setValue:function(ge){N=""+ge},stopTracking:function(){m._valueTracker=null,delete m[b]}}}}function po(m){m._valueTracker||(m._valueTracker=Ss(m))}function pu(m){if(!m)return!1;var b=m._valueTracker;if(!b)return!0;var C=b.getValue(),N="";return m&&(N=Vp(m)?m.checked?"true":"false":m.value),m=N,m!==C?(b.setValue(m),!0):!1}function hl(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var Wp=/[\n"\\]/g;function Di(m){return m.replace(Wp,function(b){return"\\"+b.charCodeAt(0).toString(16)+" "})}function mu(m,b,C,N,L,K,ge,De){m.name="",ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"?m.type=ge:m.removeAttribute("type"),b!=null?ge==="number"?(b===0&&m.value===""||m.value!=b)&&(m.value=""+Ta(b)):m.value!==""+Ta(b)&&(m.value=""+Ta(b)):ge!=="submit"&&ge!=="reset"||m.removeAttribute("value"),b!=null?Rc(m,ge,Ta(b)):C!=null?Rc(m,ge,Ta(C)):N!=null&&m.removeAttribute("value"),L==null&&K!=null&&(m.defaultChecked=!!K),L!=null&&(m.checked=L&&typeof L!="function"&&typeof L!="symbol"),De!=null&&typeof De!="function"&&typeof De!="symbol"&&typeof De!="boolean"?m.name=""+Ta(De):m.removeAttribute("name")}function Hp(m,b,C,N,L,K,ge,De){if(K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"&&(m.type=K),b!=null||C!=null){if(!(K!=="submit"&&K!=="reset"||b!=null))return;C=C!=null?""+Ta(C):"",b=b!=null?""+Ta(b):C,De||b===m.value||(m.value=b),m.defaultValue=b}N=N??L,N=typeof N!="function"&&typeof N!="symbol"&&!!N,m.checked=De?m.checked:!!N,m.defaultChecked=!!N,ge!=null&&typeof ge!="function"&&typeof ge!="symbol"&&typeof ge!="boolean"&&(m.name=ge)}function Rc(m,b,C){b==="number"&&hl(m.ownerDocument)===m||m.defaultValue===""+C||(m.defaultValue=""+C)}function kd(m,b,C,N){if(m=m.options,b){b={};for(var L=0;L<C.length;L++)b["$"+C[L]]=!0;for(C=0;C<m.length;C++)L=b.hasOwnProperty("$"+m[C].value),m[C].selected!==L&&(m[C].selected=L),L&&N&&(m[C].defaultSelected=!0)}else{for(C=""+Ta(C),b=null,L=0;L<m.length;L++){if(m[L].value===C){m[L].selected=!0,N&&(m[L].defaultSelected=!0);return}b!==null||m[L].disabled||(b=m[L])}b!==null&&(b.selected=!0)}}function Kf(m,b,C){if(b!=null&&(b=""+Ta(b),b!==m.value&&(m.value=b),C==null)){m.defaultValue!==b&&(m.defaultValue=b);return}m.defaultValue=C!=null?""+Ta(C):""}function bv(m,b,C,N){if(b==null){if(N!=null){if(C!=null)throw Error(r(92));if(V(N)){if(1<N.length)throw Error(r(93));N=N[0]}C=N}C==null&&(C=""),b=C}C=Ta(b),m.defaultValue=C,N=m.textContent,N===C&&N!==""&&N!==null&&(m.value=N)}function Yf(m,b){if(b){var C=m.firstChild;if(C&&C===m.lastChild&&C.nodeType===3){C.nodeValue=b;return}}m.textContent=b}var ts=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Wg(m,b,C){var N=b.indexOf("--")===0;C==null||typeof C=="boolean"||C===""?N?m.setProperty(b,""):b==="float"?m.cssFloat="":m[b]="":N?m.setProperty(b,C):typeof C!="number"||C===0||ts.has(b)?b==="float"?m.cssFloat=C:m[b]=(""+C).trim():m[b]=C+"px"}function __(m,b,C){if(b!=null&&typeof b!="object")throw Error(r(62));if(m=m.style,C!=null){for(var N in C)!C.hasOwnProperty(N)||b!=null&&b.hasOwnProperty(N)||(N.indexOf("--")===0?m.setProperty(N,""):N==="float"?m.cssFloat="":m[N]="");for(var L in b)N=b[L],b.hasOwnProperty(L)&&C[L]!==N&&Wg(m,L,N)}else for(var K in b)b.hasOwnProperty(K)&&Wg(m,K,b[K])}function vv(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mo=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ed(m){return Zf.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}var $l=null;function Hg(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Td=null,qs=null;function pl(m){var b=Cr(m);if(b&&(m=b.stateNode)){var C=m[$e]||null;e:switch(m=b.stateNode,b.type){case"input":if(mu(m,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name),b=C.name,C.type==="radio"&&b!=null){for(C=m;C.parentNode;)C=C.parentNode;for(C=C.querySelectorAll('input[name="'+Di(""+b)+'"][type="radio"]'),b=0;b<C.length;b++){var N=C[b];if(N!==m&&N.form===m.form){var L=N[$e]||null;if(!L)throw Error(r(90));mu(N,L.value,L.defaultValue,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name)}}for(b=0;b<C.length;b++)N=C[b],N.form===m.form&&pu(N)}break e;case"textarea":Kf(m,C.value,C.defaultValue);break e;case"select":b=C.value,b!=null&&kd(m,!!C.multiple,b,!1)}}}var Ad=!1;function Xf(m,b,C){if(Ad)return m(b,C);Ad=!0;try{var N=m(b);return N}finally{if(Ad=!1,(Td!==null||qs!==null)&&(dC(),Td&&(b=Td,m=qs,qs=Td=null,pl(b),m)))for(b=0;b<m.length;b++)pl(m[b])}}function Nd(m,b){var C=m.stateNode;if(C===null)return null;var N=C[$e]||null;if(N===null)return null;C=N[b];e:switch(b){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(N=!N.disabled)||(m=m.type,N=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!N;break e;default:m=!1}if(m)return null;if(C&&typeof C!="function")throw Error(r(231,b,typeof C));return C}var ua=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xv=!1;if(ua)try{var Ua={};Object.defineProperty(Ua,"passive",{get:function(){xv=!0}}),window.addEventListener("test",Ua,Ua),window.removeEventListener("test",Ua,Ua)}catch{xv=!1}var Bl=null,Gg=null,Jf=null;function Qf(){if(Jf)return Jf;var m,b=Gg,C=b.length,N,L="value"in Bl?Bl.value:Bl.textContent,K=L.length;for(m=0;m<C&&b[m]===L[m];m++);var ge=C-m;for(N=1;N<=ge&&b[C-N]===L[K-N];N++);return Jf=L.slice(m,1<N?1-N:void 0)}function eh(m){var b=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&b===13&&(m=13)):m=b,m===10&&(m=13),32<=m||m===13?m:0}function Gp(){return!0}function C_(){return!1}function Fi(m){function b(C,N,L,K,ge){this._reactName=C,this._targetInst=L,this.type=N,this.nativeEvent=K,this.target=ge,this.currentTarget=null;for(var De in m)m.hasOwnProperty(De)&&(C=m[De],this[De]=C?C(K):K[De]);return this.isDefaultPrevented=(K.defaultPrevented!=null?K.defaultPrevented:K.returnValue===!1)?Gp:C_,this.isPropagationStopped=C_,this}return u(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var C=this.nativeEvent;C&&(C.preventDefault?C.preventDefault():typeof C.returnValue!="unknown"&&(C.returnValue=!1),this.isDefaultPrevented=Gp)},stopPropagation:function(){var C=this.nativeEvent;C&&(C.stopPropagation?C.stopPropagation():typeof C.cancelBubble!="unknown"&&(C.cancelBubble=!0),this.isPropagationStopped=Gp)},persist:function(){},isPersistent:Gp}),b}var Rd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kg=Fi(Rd),gu=u({},Rd,{view:0,detail:0}),Yg=Fi(gu),Kp,wv,Yp,Zg=u({},gu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Id,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==Yp&&(Yp&&m.type==="mousemove"?(Kp=m.screenX-Yp.screenX,wv=m.screenY-Yp.screenY):wv=Kp=0,Yp=m),Kp)},movementY:function(m){return"movementY"in m?m.movementY:wv}}),Xg=Fi(Zg),Sv=u({},Zg,{dataTransfer:0}),k_=Fi(Sv),Jg=u({},gu,{relatedTarget:0}),th=Fi(Jg),Qg=u({},Rd,{animationName:0,elapsedTime:0,pseudoElement:0}),E_=Fi(Qg),XN=u({},Rd,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),e0=Fi(XN),_v=u({},Rd,{data:0}),t0=Fi(_v),Cv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},da={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zp(m){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(m):(m=da[m])?!!b[m]:!1}function Id(){return Zp}var T_=u({},gu,{key:function(m){if(m.key){var b=Cv[m.key]||m.key;if(b!=="Unidentified")return b}return m.type==="keypress"?(m=eh(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?kv[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Id,charCode:function(m){return m.type==="keypress"?eh(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?eh(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),n0=Fi(T_),A_=u({},Zg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ev=Fi(A_),r0=u({},gu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Id}),Tv=Fi(r0),Md=u({},Rd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Av=Fi(Md),Nv=u({},Zg,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),s0=Fi(Nv),Rv=u({},Rd,{newState:0,oldState:0}),N_=Fi(Rv),JN=[9,13,27,32],Xp=ua&&"CompositionEvent"in window,yu=null;ua&&"documentMode"in document&&(yu=document.documentMode);var QN=ua&&"TextEvent"in window&&!yu,i0=ua&&(!Xp||yu&&8<yu&&11>=yu),a0=" ",R_=!1;function Iv(m,b){switch(m){case"keyup":return JN.indexOf(b.keyCode)!==-1;case"keydown":return b.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I_(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var jd=!1;function M_(m,b){switch(m){case"compositionend":return I_(b);case"keypress":return b.which!==32?null:(R_=!0,a0);case"textInput":return m=b.data,m===a0&&R_?null:m;default:return null}}function eR(m,b){if(jd)return m==="compositionend"||!Xp&&Iv(m,b)?(m=Qf(),Jf=Gg=Bl=null,jd=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case"compositionend":return i0&&b.locale!=="ko"?null:b.data;default:return null}}var j_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function o0(m){var b=m&&m.nodeName&&m.nodeName.toLowerCase();return b==="input"?!!j_[m.type]:b==="textarea"}function Mv(m,b,C,N){Td?qs?qs.push(N):qs=[N]:Td=N,b=yC(b,"onChange"),0<b.length&&(C=new Kg("onChange","change",null,C,N),m.push({event:C,listeners:b}))}var nh=null,Jp=null;function tR(m){IB(m,0)}function l0(m){var b=Jr(m);if(pu(b))return m}function Qp(m,b){if(m==="change")return b}var zl=!1;if(ua){var Vs;if(ua){var rh="oninput"in document;if(!rh){var go=document.createElement("div");go.setAttribute("oninput","return;"),rh=typeof go.oninput=="function"}Vs=rh}else Vs=!1;zl=Vs&&(!document.documentMode||9<document.documentMode)}function P_(){nh&&(nh.detachEvent("onpropertychange",c0),Jp=nh=null)}function c0(m){if(m.propertyName==="value"&&l0(Jp)){var b=[];Mv(b,Jp,m,Hg(m)),Xf(tR,b)}}function O_(m,b,C){m==="focusin"?(P_(),nh=b,Jp=C,nh.attachEvent("onpropertychange",c0)):m==="focusout"&&P_()}function Pd(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return l0(Jp)}function jv(m,b){if(m==="click")return l0(b)}function sh(m,b){if(m==="input"||m==="change")return l0(b)}function bu(m,b){return m===b&&(m!==0||1/m===1/b)||m!==m&&b!==b}var qa=typeof Object.is=="function"?Object.is:bu;function O(m,b){if(qa(m,b))return!0;if(typeof m!="object"||m===null||typeof b!="object"||b===null)return!1;var C=Object.keys(m),N=Object.keys(b);if(C.length!==N.length)return!1;for(N=0;N<C.length;N++){var L=C[N];if(!Fe.call(b,L)||!qa(m[L],b[L]))return!1}return!0}function H(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function re(m,b){var C=H(m);m=0;for(var N;C;){if(C.nodeType===3){if(N=m+C.textContent.length,m<=b&&N>=b)return{node:C,offset:b-m};m=N}e:{for(;C;){if(C.nextSibling){C=C.nextSibling;break e}C=C.parentNode}C=void 0}C=H(C)}}function oe(m,b){return m&&b?m===b?!0:m&&m.nodeType===3?!1:b&&b.nodeType===3?oe(m,b.parentNode):"contains"in m?m.contains(b):m.compareDocumentPosition?!!(m.compareDocumentPosition(b)&16):!1:!1}function be(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var b=hl(m.document);b instanceof m.HTMLIFrameElement;){try{var C=typeof b.contentWindow.location.href=="string"}catch{C=!1}if(C)m=b.contentWindow;else break;b=hl(m.document)}return b}function Oe(m){var b=m&&m.nodeName&&m.nodeName.toLowerCase();return b&&(b==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||b==="textarea"||m.contentEditable==="true")}var ze=ua&&"documentMode"in document&&11>=document.documentMode,Ke=null,it=null,lt=null,mt=!1;function Qe(m,b,C){var N=C.window===C?C.document:C.nodeType===9?C:C.ownerDocument;mt||Ke==null||Ke!==hl(N)||(N=Ke,"selectionStart"in N&&Oe(N)?N={start:N.selectionStart,end:N.selectionEnd}:(N=(N.ownerDocument&&N.ownerDocument.defaultView||window).getSelection(),N={anchorNode:N.anchorNode,anchorOffset:N.anchorOffset,focusNode:N.focusNode,focusOffset:N.focusOffset}),lt&&O(lt,N)||(lt=N,N=yC(it,"onSelect"),0<N.length&&(b=new Kg("onSelect","select",null,b,C),m.push({event:b,listeners:N}),b.target=Ke)))}function yt(m,b){var C={};return C[m.toLowerCase()]=b.toLowerCase(),C["Webkit"+m]="webkit"+b,C["Moz"+m]="moz"+b,C}var st={animationend:yt("Animation","AnimationEnd"),animationiteration:yt("Animation","AnimationIteration"),animationstart:yt("Animation","AnimationStart"),transitionrun:yt("Transition","TransitionRun"),transitionstart:yt("Transition","TransitionStart"),transitioncancel:yt("Transition","TransitionCancel"),transitionend:yt("Transition","TransitionEnd")},pt={},bt={};ua&&(bt=document.createElement("div").style,"AnimationEvent"in window||(delete st.animationend.animation,delete st.animationiteration.animation,delete st.animationstart.animation),"TransitionEvent"in window||delete st.transitionend.transition);function ct(m){if(pt[m])return pt[m];if(!st[m])return m;var b=st[m],C;for(C in b)if(b.hasOwnProperty(C)&&C in bt)return pt[m]=b[C];return m}var kt=ct("animationend"),Mt=ct("animationiteration"),jt=ct("animationstart"),Ot=ct("transitionrun"),Xt=ct("transitionstart"),sn=ct("transitioncancel"),Kt=ct("transitionend"),tn=new Map,ln="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ln.push("scrollEnd");function Yt(m,b){tn.set(m,b),Vt(b,[m])}var bn=new WeakMap;function Wn(m,b){if(typeof m=="object"&&m!==null){var C=bn.get(m);return C!==void 0?C:(b={value:m,source:b,stack:qp(b)},bn.set(m,b),b)}return{value:m,source:b,stack:qp(b)}}var Xn=[],vr=0,Aa=0;function lr(){for(var m=vr,b=Aa=vr=0;b<m;){var C=Xn[b];Xn[b++]=null;var N=Xn[b];Xn[b++]=null;var L=Xn[b];Xn[b++]=null;var K=Xn[b];if(Xn[b++]=null,N!==null&&L!==null){var ge=N.pending;ge===null?L.next=L:(L.next=ge.next,ge.next=L),N.pending=L}K!==0&&fa(C,L,K)}}function wi(m,b,C,N){Xn[vr++]=m,Xn[vr++]=b,Xn[vr++]=C,Xn[vr++]=N,Aa|=N,m.lanes|=N,m=m.alternate,m!==null&&(m.lanes|=N)}function Li(m,b,C,N){return wi(m,b,C,N),Ul(m)}function Ic(m,b){return wi(m,null,null,b),Ul(m)}function fa(m,b,C){m.lanes|=C;var N=m.alternate;N!==null&&(N.lanes|=C);for(var L=!1,K=m.return;K!==null;)K.childLanes|=C,N=K.alternate,N!==null&&(N.childLanes|=C),K.tag===22&&(m=K.stateNode,m===null||m._visibility&1||(L=!0)),m=K,K=K.return;return m.tag===3?(K=m.stateNode,L&&b!==null&&(L=31-Ht(C),m=K.hiddenUpdates,N=m[L],N===null?m[L]=[b]:N.push(b),b.lane=C|536870912),K):null}function Ul(m){if(50<sx)throw sx=0,oI=null,Error(r(185));for(var b=m.return;b!==null;)m=b,b=m.return;return m.tag===3?m.stateNode:null}var vu={};function ige(m,b,C,N){this.tag=m,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ml(m,b,C,N){return new ige(m,b,C,N)}function nR(m){return m=m.prototype,!(!m||!m.isReactComponent)}function Od(m,b){var C=m.alternate;return C===null?(C=ml(m.tag,b,m.key,m.mode),C.elementType=m.elementType,C.type=m.type,C.stateNode=m.stateNode,C.alternate=m,m.alternate=C):(C.pendingProps=b,C.type=m.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=m.flags&65011712,C.childLanes=m.childLanes,C.lanes=m.lanes,C.child=m.child,C.memoizedProps=m.memoizedProps,C.memoizedState=m.memoizedState,C.updateQueue=m.updateQueue,b=m.dependencies,C.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},C.sibling=m.sibling,C.index=m.index,C.ref=m.ref,C.refCleanup=m.refCleanup,C}function g8(m,b){m.flags&=65011714;var C=m.alternate;return C===null?(m.childLanes=0,m.lanes=b,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=C.childLanes,m.lanes=C.lanes,m.child=C.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=C.memoizedProps,m.memoizedState=C.memoizedState,m.updateQueue=C.updateQueue,m.type=C.type,b=C.dependencies,m.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),m}function D_(m,b,C,N,L,K){var ge=0;if(N=m,typeof m=="function")nR(m)&&(ge=1);else if(typeof m=="string")ge=o0e(m,C,ae.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case M:return m=ml(31,C,b,L),m.elementType=M,m.lanes=K,m;case g:return em(C.children,L,K,b);case y:ge=8,L|=24;break;case v:return m=ml(12,C,b,L|2),m.elementType=v,m.lanes=K,m;case k:return m=ml(13,C,b,L),m.elementType=k,m.lanes=K,m;case T:return m=ml(19,C,b,L),m.elementType=T,m.lanes=K,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case x:case S:ge=10;break e;case w:ge=9;break e;case _:ge=11;break e;case A:ge=14;break e;case R:ge=16,N=null;break e}ge=29,C=Error(r(130,m===null?"null":typeof m,"")),N=null}return b=ml(ge,C,b,L),b.elementType=m,b.type=N,b.lanes=K,b}function em(m,b,C,N){return m=ml(7,m,N,b),m.lanes=C,m}function rR(m,b,C){return m=ml(6,m,null,b),m.lanes=C,m}function sR(m,b,C){return b=ml(4,m.children!==null?m.children:[],m.key,b),b.lanes=C,b.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},b}var u0=[],d0=0,F_=null,L_=0,ql=[],Vl=0,tm=null,Dd=1,Fd="";function nm(m,b){u0[d0++]=L_,u0[d0++]=F_,F_=m,L_=b}function y8(m,b,C){ql[Vl++]=Dd,ql[Vl++]=Fd,ql[Vl++]=tm,tm=m;var N=Dd;m=Fd;var L=32-Ht(N)-1;N&=~(1<<L),C+=1;var K=32-Ht(b)+L;if(30<K){var ge=L-L%5;K=(N&(1<<ge)-1).toString(32),N>>=ge,L-=ge,Dd=1<<32-Ht(b)+L|C<<L|N,Fd=K+m}else Dd=1<<K|C<<L|N,Fd=m}function iR(m){m.return!==null&&(nm(m,1),y8(m,1,0))}function aR(m){for(;m===F_;)F_=u0[--d0],u0[d0]=null,L_=u0[--d0],u0[d0]=null;for(;m===tm;)tm=ql[--Vl],ql[Vl]=null,Fd=ql[--Vl],ql[Vl]=null,Dd=ql[--Vl],ql[Vl]=null}var yo=null,hi=null,us=!1,rm=null,xu=!1,oR=Error(r(519));function sm(m){var b=Error(r(418,""));throw Dv(Wn(b,m)),oR}function b8(m){var b=m.stateNode,C=m.type,N=m.memoizedProps;switch(b[_e]=m,b[$e]=N,C){case"dialog":qr("cancel",b),qr("close",b);break;case"iframe":case"object":case"embed":qr("load",b);break;case"video":case"audio":for(C=0;C<ax.length;C++)qr(ax[C],b);break;case"source":qr("error",b);break;case"img":case"image":case"link":qr("error",b),qr("load",b);break;case"details":qr("toggle",b);break;case"input":qr("invalid",b),Hp(b,N.value,N.defaultValue,N.checked,N.defaultChecked,N.type,N.name,!0),po(b);break;case"select":qr("invalid",b);break;case"textarea":qr("invalid",b),bv(b,N.value,N.defaultValue,N.children),po(b)}C=N.children,typeof C!="string"&&typeof C!="number"&&typeof C!="bigint"||b.textContent===""+C||N.suppressHydrationWarning===!0||OB(b.textContent,C)?(N.popover!=null&&(qr("beforetoggle",b),qr("toggle",b)),N.onScroll!=null&&qr("scroll",b),N.onScrollEnd!=null&&qr("scrollend",b),N.onClick!=null&&(b.onclick=bC),b=!0):b=!1,b||sm(m)}function v8(m){for(yo=m.return;yo;)switch(yo.tag){case 5:case 13:xu=!1;return;case 27:case 3:xu=!0;return;default:yo=yo.return}}function Pv(m){if(m!==yo)return!1;if(!us)return v8(m),us=!0,!1;var b=m.tag,C;if((C=b!==3&&b!==27)&&((C=b===5)&&(C=m.type,C=!(C!=="form"&&C!=="button")||_I(m.type,m.memoizedProps)),C=!C),C&&hi&&sm(m),v8(m),b===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,b=0;m;){if(m.nodeType===8)if(C=m.data,C==="/$"){if(b===0){hi=jc(m.nextSibling);break e}b--}else C!=="$"&&C!=="$!"&&C!=="$?"||b++;m=m.nextSibling}hi=null}}else b===27?(b=hi,xh(m.type)?(m=TI,TI=null,hi=m):hi=b):hi=yo?jc(m.stateNode.nextSibling):null;return!0}function Ov(){hi=yo=null,us=!1}function x8(){var m=rm;return m!==null&&(Vo===null?Vo=m:Vo.push.apply(Vo,m),rm=null),m}function Dv(m){rm===null?rm=[m]:rm.push(m)}var lR=G(null),im=null,Ld=null;function ih(m,b,C){ne(lR,b._currentValue),b._currentValue=C}function $d(m){m._currentValue=lR.current,Z(lR)}function cR(m,b,C){for(;m!==null;){var N=m.alternate;if((m.childLanes&b)!==b?(m.childLanes|=b,N!==null&&(N.childLanes|=b)):N!==null&&(N.childLanes&b)!==b&&(N.childLanes|=b),m===C)break;m=m.return}}function uR(m,b,C,N){var L=m.child;for(L!==null&&(L.return=m);L!==null;){var K=L.dependencies;if(K!==null){var ge=L.child;K=K.firstContext;e:for(;K!==null;){var De=K;K=L;for(var Xe=0;Xe<b.length;Xe++)if(De.context===b[Xe]){K.lanes|=C,De=K.alternate,De!==null&&(De.lanes|=C),cR(K.return,C,m),N||(ge=null);break e}K=De.next}}else if(L.tag===18){if(ge=L.return,ge===null)throw Error(r(341));ge.lanes|=C,K=ge.alternate,K!==null&&(K.lanes|=C),cR(ge,C,m),ge=null}else ge=L.child;if(ge!==null)ge.return=L;else for(ge=L;ge!==null;){if(ge===m){ge=null;break}if(L=ge.sibling,L!==null){L.return=ge.return,ge=L;break}ge=ge.return}L=ge}}function Fv(m,b,C,N){m=null;for(var L=b,K=!1;L!==null;){if(!K){if((L.flags&524288)!==0)K=!0;else if((L.flags&262144)!==0)break}if(L.tag===10){var ge=L.alternate;if(ge===null)throw Error(r(387));if(ge=ge.memoizedProps,ge!==null){var De=L.type;qa(L.pendingProps.value,ge.value)||(m!==null?m.push(De):m=[De])}}else if(L===Ee.current){if(ge=L.alternate,ge===null)throw Error(r(387));ge.memoizedState.memoizedState!==L.memoizedState.memoizedState&&(m!==null?m.push(fx):m=[fx])}L=L.return}m!==null&&uR(b,m,C,N),b.flags|=262144}function $_(m){for(m=m.firstContext;m!==null;){if(!qa(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function am(m){im=m,Ld=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Va(m){return w8(im,m)}function B_(m,b){return im===null&&am(m),w8(m,b)}function w8(m,b){var C=b._currentValue;if(b={context:b,memoizedValue:C,next:null},Ld===null){if(m===null)throw Error(r(308));Ld=b,m.dependencies={lanes:0,firstContext:b},m.flags|=524288}else Ld=Ld.next=b;return C}var age=typeof AbortController<"u"?AbortController:function(){var m=[],b=this.signal={aborted:!1,addEventListener:function(C,N){m.push(N)}};this.abort=function(){b.aborted=!0,m.forEach(function(C){return C()})}},oge=e.unstable_scheduleCallback,lge=e.unstable_NormalPriority,Xi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dR(){return{controller:new age,data:new Map,refCount:0}}function Lv(m){m.refCount--,m.refCount===0&&oge(lge,function(){m.controller.abort()})}var $v=null,fR=0,f0=0,h0=null;function cge(m,b){if($v===null){var C=$v=[];fR=0,f0=pI(),h0={status:"pending",value:void 0,then:function(N){C.push(N)}}}return fR++,b.then(S8,S8),b}function S8(){if(--fR===0&&$v!==null){h0!==null&&(h0.status="fulfilled");var m=$v;$v=null,f0=0,h0=null;for(var b=0;b<m.length;b++)(0,m[b])()}}function uge(m,b){var C=[],N={status:"pending",value:null,reason:null,then:function(L){C.push(L)}};return m.then(function(){N.status="fulfilled",N.value=b;for(var L=0;L<C.length;L++)(0,C[L])(b)},function(L){for(N.status="rejected",N.reason=L,L=0;L<C.length;L++)(0,C[L])(void 0)}),N}var _8=D.S;D.S=function(m,b){typeof b=="object"&&b!==null&&typeof b.then=="function"&&cge(m,b),_8!==null&&_8(m,b)};var om=G(null);function hR(){var m=om.current;return m!==null?m:Bs.pooledCache}function z_(m,b){b===null?ne(om,om.current):ne(om,b.pool)}function C8(){var m=hR();return m===null?null:{parent:Xi._currentValue,pool:m}}var Bv=Error(r(460)),k8=Error(r(474)),U_=Error(r(542)),pR={then:function(){}};function E8(m){return m=m.status,m==="fulfilled"||m==="rejected"}function q_(){}function T8(m,b,C){switch(C=m[C],C===void 0?m.push(b):C!==b&&(b.then(q_,q_),b=C),b.status){case"fulfilled":return b.value;case"rejected":throw m=b.reason,N8(m),m;default:if(typeof b.status=="string")b.then(q_,q_);else{if(m=Bs,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=b,m.status="pending",m.then(function(N){if(b.status==="pending"){var L=b;L.status="fulfilled",L.value=N}},function(N){if(b.status==="pending"){var L=b;L.status="rejected",L.reason=N}})}switch(b.status){case"fulfilled":return b.value;case"rejected":throw m=b.reason,N8(m),m}throw zv=b,Bv}}var zv=null;function A8(){if(zv===null)throw Error(r(459));var m=zv;return zv=null,m}function N8(m){if(m===Bv||m===U_)throw Error(r(483))}var ah=!1;function mR(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function gR(m,b){m=m.updateQueue,b.updateQueue===m&&(b.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function oh(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function lh(m,b,C){var N=m.updateQueue;if(N===null)return null;if(N=N.shared,(_s&2)!==0){var L=N.pending;return L===null?b.next=b:(b.next=L.next,L.next=b),N.pending=b,b=Ul(m),fa(m,null,C),b}return wi(m,N,b,C),Ul(m)}function Uv(m,b,C){if(b=b.updateQueue,b!==null&&(b=b.shared,(C&4194048)!==0)){var N=b.lanes;N&=m.pendingLanes,C|=N,b.lanes=C,Ue(m,C)}}function yR(m,b){var C=m.updateQueue,N=m.alternate;if(N!==null&&(N=N.updateQueue,C===N)){var L=null,K=null;if(C=C.firstBaseUpdate,C!==null){do{var ge={lane:C.lane,tag:C.tag,payload:C.payload,callback:null,next:null};K===null?L=K=ge:K=K.next=ge,C=C.next}while(C!==null);K===null?L=K=b:K=K.next=b}else L=K=b;C={baseState:N.baseState,firstBaseUpdate:L,lastBaseUpdate:K,shared:N.shared,callbacks:N.callbacks},m.updateQueue=C;return}m=C.lastBaseUpdate,m===null?C.firstBaseUpdate=b:m.next=b,C.lastBaseUpdate=b}var bR=!1;function qv(){if(bR){var m=h0;if(m!==null)throw m}}function Vv(m,b,C,N){bR=!1;var L=m.updateQueue;ah=!1;var K=L.firstBaseUpdate,ge=L.lastBaseUpdate,De=L.shared.pending;if(De!==null){L.shared.pending=null;var Xe=De,_t=Xe.next;Xe.next=null,ge===null?K=_t:ge.next=_t,ge=Xe;var Dt=m.alternate;Dt!==null&&(Dt=Dt.updateQueue,De=Dt.lastBaseUpdate,De!==ge&&(De===null?Dt.firstBaseUpdate=_t:De.next=_t,Dt.lastBaseUpdate=Xe))}if(K!==null){var zt=L.baseState;ge=0,Dt=_t=Xe=null,De=K;do{var Tt=De.lane&-536870913,Rt=Tt!==De.lane;if(Rt?(ns&Tt)===Tt:(N&Tt)===Tt){Tt!==0&&Tt===f0&&(bR=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:De.tag,payload:De.payload,callback:null,next:null});e:{var cr=m,Jn=De;Tt=b;var Rs=C;switch(Jn.tag){case 1:if(cr=Jn.payload,typeof cr=="function"){zt=cr.call(Rs,zt,Tt);break e}zt=cr;break e;case 3:cr.flags=cr.flags&-65537|128;case 0:if(cr=Jn.payload,Tt=typeof cr=="function"?cr.call(Rs,zt,Tt):cr,Tt==null)break e;zt=u({},zt,Tt);break e;case 2:ah=!0}}Tt=De.callback,Tt!==null&&(m.flags|=64,Rt&&(m.flags|=8192),Rt=L.callbacks,Rt===null?L.callbacks=[Tt]:Rt.push(Tt))}else Rt={lane:Tt,tag:De.tag,payload:De.payload,callback:De.callback,next:null},Dt===null?(_t=Dt=Rt,Xe=zt):Dt=Dt.next=Rt,ge|=Tt;if(De=De.next,De===null){if(De=L.shared.pending,De===null)break;Rt=De,De=Rt.next,Rt.next=null,L.lastBaseUpdate=Rt,L.shared.pending=null}}while(!0);Dt===null&&(Xe=zt),L.baseState=Xe,L.firstBaseUpdate=_t,L.lastBaseUpdate=Dt,K===null&&(L.shared.lanes=0),gh|=ge,m.lanes=ge,m.memoizedState=zt}}function R8(m,b){if(typeof m!="function")throw Error(r(191,m));m.call(b)}function I8(m,b){var C=m.callbacks;if(C!==null)for(m.callbacks=null,m=0;m<C.length;m++)R8(C[m],b)}var p0=G(null),V_=G(0);function M8(m,b){m=Hd,ne(V_,m),ne(p0,b),Hd=m|b.baseLanes}function vR(){ne(V_,Hd),ne(p0,p0.current)}function xR(){Hd=V_.current,Z(p0),Z(V_)}var ch=0,Lr=null,As=null,$i=null,W_=!1,m0=!1,lm=!1,H_=0,Wv=0,g0=null,dge=0;function Si(){throw Error(r(321))}function wR(m,b){if(b===null)return!1;for(var C=0;C<b.length&&C<m.length;C++)if(!qa(m[C],b[C]))return!1;return!0}function SR(m,b,C,N,L,K){return ch=K,Lr=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,D.H=m===null||m.memoizedState===null?m$:g$,lm=!1,K=C(N,L),lm=!1,m0&&(K=P8(b,C,N,L)),j8(m),K}function j8(m){D.H=J_;var b=As!==null&&As.next!==null;if(ch=0,$i=As=Lr=null,W_=!1,Wv=0,g0=null,b)throw Error(r(300));m===null||ha||(m=m.dependencies,m!==null&&$_(m)&&(ha=!0))}function P8(m,b,C,N){Lr=m;var L=0;do{if(m0&&(g0=null),Wv=0,m0=!1,25<=L)throw Error(r(301));if(L+=1,$i=As=null,m.updateQueue!=null){var K=m.updateQueue;K.lastEffect=null,K.events=null,K.stores=null,K.memoCache!=null&&(K.memoCache.index=0)}D.H=bge,K=b(C,N)}while(m0);return K}function fge(){var m=D.H,b=m.useState()[0];return b=typeof b.then=="function"?Hv(b):b,m=m.useState()[0],(As!==null?As.memoizedState:null)!==m&&(Lr.flags|=1024),b}function _R(){var m=H_!==0;return H_=0,m}function CR(m,b,C){b.updateQueue=m.updateQueue,b.flags&=-2053,m.lanes&=~C}function kR(m){if(W_){for(m=m.memoizedState;m!==null;){var b=m.queue;b!==null&&(b.pending=null),m=m.next}W_=!1}ch=0,$i=As=Lr=null,m0=!1,Wv=H_=0,g0=null}function Uo(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $i===null?Lr.memoizedState=$i=m:$i=$i.next=m,$i}function Bi(){if(As===null){var m=Lr.alternate;m=m!==null?m.memoizedState:null}else m=As.next;var b=$i===null?Lr.memoizedState:$i.next;if(b!==null)$i=b,As=m;else{if(m===null)throw Lr.alternate===null?Error(r(467)):Error(r(310));As=m,m={memoizedState:As.memoizedState,baseState:As.baseState,baseQueue:As.baseQueue,queue:As.queue,next:null},$i===null?Lr.memoizedState=$i=m:$i=$i.next=m}return $i}function ER(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Hv(m){var b=Wv;return Wv+=1,g0===null&&(g0=[]),m=T8(g0,m,b),b=Lr,($i===null?b.memoizedState:$i.next)===null&&(b=b.alternate,D.H=b===null||b.memoizedState===null?m$:g$),m}function G_(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return Hv(m);if(m.$$typeof===S)return Va(m)}throw Error(r(438,String(m)))}function TR(m){var b=null,C=Lr.updateQueue;if(C!==null&&(b=C.memoCache),b==null){var N=Lr.alternate;N!==null&&(N=N.updateQueue,N!==null&&(N=N.memoCache,N!=null&&(b={data:N.data.map(function(L){return L.slice()}),index:0})))}if(b==null&&(b={data:[],index:0}),C===null&&(C=ER(),Lr.updateQueue=C),C.memoCache=b,C=b.data[b.index],C===void 0)for(C=b.data[b.index]=Array(m),N=0;N<m;N++)C[N]=j;return b.index++,C}function Bd(m,b){return typeof b=="function"?b(m):b}function K_(m){var b=Bi();return AR(b,As,m)}function AR(m,b,C){var N=m.queue;if(N===null)throw Error(r(311));N.lastRenderedReducer=C;var L=m.baseQueue,K=N.pending;if(K!==null){if(L!==null){var ge=L.next;L.next=K.next,K.next=ge}b.baseQueue=L=K,N.pending=null}if(K=m.baseState,L===null)m.memoizedState=K;else{b=L.next;var De=ge=null,Xe=null,_t=b,Dt=!1;do{var zt=_t.lane&-536870913;if(zt!==_t.lane?(ns&zt)===zt:(ch&zt)===zt){var Tt=_t.revertLane;if(Tt===0)Xe!==null&&(Xe=Xe.next={lane:0,revertLane:0,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),zt===f0&&(Dt=!0);else if((ch&Tt)===Tt){_t=_t.next,Tt===f0&&(Dt=!0);continue}else zt={lane:0,revertLane:_t.revertLane,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null},Xe===null?(De=Xe=zt,ge=K):Xe=Xe.next=zt,Lr.lanes|=Tt,gh|=Tt;zt=_t.action,lm&&C(K,zt),K=_t.hasEagerState?_t.eagerState:C(K,zt)}else Tt={lane:zt,revertLane:_t.revertLane,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null},Xe===null?(De=Xe=Tt,ge=K):Xe=Xe.next=Tt,Lr.lanes|=zt,gh|=zt;_t=_t.next}while(_t!==null&&_t!==b);if(Xe===null?ge=K:Xe.next=De,!qa(K,m.memoizedState)&&(ha=!0,Dt&&(C=h0,C!==null)))throw C;m.memoizedState=K,m.baseState=ge,m.baseQueue=Xe,N.lastRenderedState=K}return L===null&&(N.lanes=0),[m.memoizedState,N.dispatch]}function NR(m){var b=Bi(),C=b.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=m;var N=C.dispatch,L=C.pending,K=b.memoizedState;if(L!==null){C.pending=null;var ge=L=L.next;do K=m(K,ge.action),ge=ge.next;while(ge!==L);qa(K,b.memoizedState)||(ha=!0),b.memoizedState=K,b.baseQueue===null&&(b.baseState=K),C.lastRenderedState=K}return[K,N]}function O8(m,b,C){var N=Lr,L=Bi(),K=us;if(K){if(C===void 0)throw Error(r(407));C=C()}else C=b();var ge=!qa((As||L).memoizedState,C);ge&&(L.memoizedState=C,ha=!0),L=L.queue;var De=L8.bind(null,N,L,m);if(Gv(2048,8,De,[m]),L.getSnapshot!==b||ge||$i!==null&&$i.memoizedState.tag&1){if(N.flags|=2048,y0(9,Y_(),F8.bind(null,N,L,C,b),null),Bs===null)throw Error(r(349));K||(ch&124)!==0||D8(N,b,C)}return C}function D8(m,b,C){m.flags|=16384,m={getSnapshot:b,value:C},b=Lr.updateQueue,b===null?(b=ER(),Lr.updateQueue=b,b.stores=[m]):(C=b.stores,C===null?b.stores=[m]:C.push(m))}function F8(m,b,C,N){b.value=C,b.getSnapshot=N,$8(b)&&B8(m)}function L8(m,b,C){return C(function(){$8(b)&&B8(m)})}function $8(m){var b=m.getSnapshot;m=m.value;try{var C=b();return!qa(m,C)}catch{return!0}}function B8(m){var b=Ic(m,2);b!==null&&xl(b,m,2)}function RR(m){var b=Uo();if(typeof m=="function"){var C=m;if(m=C(),lm){Ft(!0);try{C()}finally{Ft(!1)}}}return b.memoizedState=b.baseState=m,b.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bd,lastRenderedState:m},b}function z8(m,b,C,N){return m.baseState=C,AR(m,As,typeof N=="function"?N:Bd)}function hge(m,b,C,N,L){if(X_(m))throw Error(r(485));if(m=b.action,m!==null){var K={payload:L,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ge){K.listeners.push(ge)}};D.T!==null?C(!0):K.isTransition=!1,N(K),C=b.pending,C===null?(K.next=b.pending=K,U8(b,K)):(K.next=C.next,b.pending=C.next=K)}}function U8(m,b){var C=b.action,N=b.payload,L=m.state;if(b.isTransition){var K=D.T,ge={};D.T=ge;try{var De=C(L,N),Xe=D.S;Xe!==null&&Xe(ge,De),q8(m,b,De)}catch(_t){IR(m,b,_t)}finally{D.T=K}}else try{K=C(L,N),q8(m,b,K)}catch(_t){IR(m,b,_t)}}function q8(m,b,C){C!==null&&typeof C=="object"&&typeof C.then=="function"?C.then(function(N){V8(m,b,N)},function(N){return IR(m,b,N)}):V8(m,b,C)}function V8(m,b,C){b.status="fulfilled",b.value=C,W8(b),m.state=C,b=m.pending,b!==null&&(C=b.next,C===b?m.pending=null:(C=C.next,b.next=C,U8(m,C)))}function IR(m,b,C){var N=m.pending;if(m.pending=null,N!==null){N=N.next;do b.status="rejected",b.reason=C,W8(b),b=b.next;while(b!==N)}m.action=null}function W8(m){m=m.listeners;for(var b=0;b<m.length;b++)(0,m[b])()}function H8(m,b){return b}function G8(m,b){if(us){var C=Bs.formState;if(C!==null){e:{var N=Lr;if(us){if(hi){t:{for(var L=hi,K=xu;L.nodeType!==8;){if(!K){L=null;break t}if(L=jc(L.nextSibling),L===null){L=null;break t}}K=L.data,L=K==="F!"||K==="F"?L:null}if(L){hi=jc(L.nextSibling),N=L.data==="F!";break e}}sm(N)}N=!1}N&&(b=C[0])}}return C=Uo(),C.memoizedState=C.baseState=b,N={pending:null,lanes:0,dispatch:null,lastRenderedReducer:H8,lastRenderedState:b},C.queue=N,C=f$.bind(null,Lr,N),N.dispatch=C,N=RR(!1),K=DR.bind(null,Lr,!1,N.queue),N=Uo(),L={state:b,dispatch:null,action:m,pending:null},N.queue=L,C=hge.bind(null,Lr,L,K,C),L.dispatch=C,N.memoizedState=m,[b,C,!1]}function K8(m){var b=Bi();return Y8(b,As,m)}function Y8(m,b,C){if(b=AR(m,b,H8)[0],m=K_(Bd)[0],typeof b=="object"&&b!==null&&typeof b.then=="function")try{var N=Hv(b)}catch(ge){throw ge===Bv?U_:ge}else N=b;b=Bi();var L=b.queue,K=L.dispatch;return C!==b.memoizedState&&(Lr.flags|=2048,y0(9,Y_(),pge.bind(null,L,C),null)),[N,K,m]}function pge(m,b){m.action=b}function Z8(m){var b=Bi(),C=As;if(C!==null)return Y8(b,C,m);Bi(),b=b.memoizedState,C=Bi();var N=C.queue.dispatch;return C.memoizedState=m,[b,N,!1]}function y0(m,b,C,N){return m={tag:m,create:C,deps:N,inst:b,next:null},b=Lr.updateQueue,b===null&&(b=ER(),Lr.updateQueue=b),C=b.lastEffect,C===null?b.lastEffect=m.next=m:(N=C.next,C.next=m,m.next=N,b.lastEffect=m),m}function Y_(){return{destroy:void 0,resource:void 0}}function X8(){return Bi().memoizedState}function Z_(m,b,C,N){var L=Uo();N=N===void 0?null:N,Lr.flags|=m,L.memoizedState=y0(1|b,Y_(),C,N)}function Gv(m,b,C,N){var L=Bi();N=N===void 0?null:N;var K=L.memoizedState.inst;As!==null&&N!==null&&wR(N,As.memoizedState.deps)?L.memoizedState=y0(b,K,C,N):(Lr.flags|=m,L.memoizedState=y0(1|b,K,C,N))}function J8(m,b){Z_(8390656,8,m,b)}function Q8(m,b){Gv(2048,8,m,b)}function e$(m,b){return Gv(4,2,m,b)}function t$(m,b){return Gv(4,4,m,b)}function n$(m,b){if(typeof b=="function"){m=m();var C=b(m);return function(){typeof C=="function"?C():b(null)}}if(b!=null)return m=m(),b.current=m,function(){b.current=null}}function r$(m,b,C){C=C!=null?C.concat([m]):null,Gv(4,4,n$.bind(null,b,m),C)}function MR(){}function s$(m,b){var C=Bi();b=b===void 0?null:b;var N=C.memoizedState;return b!==null&&wR(b,N[1])?N[0]:(C.memoizedState=[m,b],m)}function i$(m,b){var C=Bi();b=b===void 0?null:b;var N=C.memoizedState;if(b!==null&&wR(b,N[1]))return N[0];if(N=m(),lm){Ft(!0);try{m()}finally{Ft(!1)}}return C.memoizedState=[N,b],N}function jR(m,b,C){return C===void 0||(ch&1073741824)!==0?m.memoizedState=b:(m.memoizedState=C,m=lB(),Lr.lanes|=m,gh|=m,C)}function a$(m,b,C,N){return qa(C,b)?C:p0.current!==null?(m=jR(m,C,N),qa(m,b)||(ha=!0),m):(ch&42)===0?(ha=!0,m.memoizedState=C):(m=lB(),Lr.lanes|=m,gh|=m,b)}function o$(m,b,C,N,L){var K=z.p;z.p=K!==0&&8>K?K:8;var ge=D.T,De={};D.T=De,DR(m,!1,b,C);try{var Xe=L(),_t=D.S;if(_t!==null&&_t(De,Xe),Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var Dt=uge(Xe,N);Kv(m,b,Dt,vl(m))}else Kv(m,b,N,vl(m))}catch(zt){Kv(m,b,{then:function(){},status:"rejected",reason:zt},vl())}finally{z.p=K,D.T=ge}}function mge(){}function PR(m,b,C,N){if(m.tag!==5)throw Error(r(476));var L=l$(m).queue;o$(m,L,b,$,C===null?mge:function(){return c$(m),C(N)})}function l$(m){var b=m.memoizedState;if(b!==null)return b;b={memoizedState:$,baseState:$,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bd,lastRenderedState:$},next:null};var C={};return b.next={memoizedState:C,baseState:C,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bd,lastRenderedState:C},next:null},m.memoizedState=b,m=m.alternate,m!==null&&(m.memoizedState=b),b}function c$(m){var b=l$(m).next.queue;Kv(m,b,{},vl())}function OR(){return Va(fx)}function u$(){return Bi().memoizedState}function d$(){return Bi().memoizedState}function gge(m){for(var b=m.return;b!==null;){switch(b.tag){case 24:case 3:var C=vl();m=oh(C);var N=lh(b,m,C);N!==null&&(xl(N,b,C),Uv(N,b,C)),b={cache:dR()},m.payload=b;return}b=b.return}}function yge(m,b,C){var N=vl();C={lane:N,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null},X_(m)?h$(b,C):(C=Li(m,b,C,N),C!==null&&(xl(C,m,N),p$(C,b,N)))}function f$(m,b,C){var N=vl();Kv(m,b,C,N)}function Kv(m,b,C,N){var L={lane:N,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null};if(X_(m))h$(b,L);else{var K=m.alternate;if(m.lanes===0&&(K===null||K.lanes===0)&&(K=b.lastRenderedReducer,K!==null))try{var ge=b.lastRenderedState,De=K(ge,C);if(L.hasEagerState=!0,L.eagerState=De,qa(De,ge))return wi(m,b,L,0),Bs===null&&lr(),!1}catch{}finally{}if(C=Li(m,b,L,N),C!==null)return xl(C,m,N),p$(C,b,N),!0}return!1}function DR(m,b,C,N){if(N={lane:2,revertLane:pI(),action:N,hasEagerState:!1,eagerState:null,next:null},X_(m)){if(b)throw Error(r(479))}else b=Li(m,C,N,2),b!==null&&xl(b,m,2)}function X_(m){var b=m.alternate;return m===Lr||b!==null&&b===Lr}function h$(m,b){m0=W_=!0;var C=m.pending;C===null?b.next=b:(b.next=C.next,C.next=b),m.pending=b}function p$(m,b,C){if((C&4194048)!==0){var N=b.lanes;N&=m.pendingLanes,C|=N,b.lanes=C,Ue(m,C)}}var J_={readContext:Va,use:G_,useCallback:Si,useContext:Si,useEffect:Si,useImperativeHandle:Si,useLayoutEffect:Si,useInsertionEffect:Si,useMemo:Si,useReducer:Si,useRef:Si,useState:Si,useDebugValue:Si,useDeferredValue:Si,useTransition:Si,useSyncExternalStore:Si,useId:Si,useHostTransitionStatus:Si,useFormState:Si,useActionState:Si,useOptimistic:Si,useMemoCache:Si,useCacheRefresh:Si},m$={readContext:Va,use:G_,useCallback:function(m,b){return Uo().memoizedState=[m,b===void 0?null:b],m},useContext:Va,useEffect:J8,useImperativeHandle:function(m,b,C){C=C!=null?C.concat([m]):null,Z_(4194308,4,n$.bind(null,b,m),C)},useLayoutEffect:function(m,b){return Z_(4194308,4,m,b)},useInsertionEffect:function(m,b){Z_(4,2,m,b)},useMemo:function(m,b){var C=Uo();b=b===void 0?null:b;var N=m();if(lm){Ft(!0);try{m()}finally{Ft(!1)}}return C.memoizedState=[N,b],N},useReducer:function(m,b,C){var N=Uo();if(C!==void 0){var L=C(b);if(lm){Ft(!0);try{C(b)}finally{Ft(!1)}}}else L=b;return N.memoizedState=N.baseState=L,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:L},N.queue=m,m=m.dispatch=yge.bind(null,Lr,m),[N.memoizedState,m]},useRef:function(m){var b=Uo();return m={current:m},b.memoizedState=m},useState:function(m){m=RR(m);var b=m.queue,C=f$.bind(null,Lr,b);return b.dispatch=C,[m.memoizedState,C]},useDebugValue:MR,useDeferredValue:function(m,b){var C=Uo();return jR(C,m,b)},useTransition:function(){var m=RR(!1);return m=o$.bind(null,Lr,m.queue,!0,!1),Uo().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,b,C){var N=Lr,L=Uo();if(us){if(C===void 0)throw Error(r(407));C=C()}else{if(C=b(),Bs===null)throw Error(r(349));(ns&124)!==0||D8(N,b,C)}L.memoizedState=C;var K={value:C,getSnapshot:b};return L.queue=K,J8(L8.bind(null,N,K,m),[m]),N.flags|=2048,y0(9,Y_(),F8.bind(null,N,K,C,b),null),C},useId:function(){var m=Uo(),b=Bs.identifierPrefix;if(us){var C=Fd,N=Dd;C=(N&~(1<<32-Ht(N)-1)).toString(32)+C,b=""+b+"R"+C,C=H_++,0<C&&(b+="H"+C.toString(32)),b+=""}else C=dge++,b=""+b+"r"+C.toString(32)+"";return m.memoizedState=b},useHostTransitionStatus:OR,useFormState:G8,useActionState:G8,useOptimistic:function(m){var b=Uo();b.memoizedState=b.baseState=m;var C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return b.queue=C,b=DR.bind(null,Lr,!0,C),C.dispatch=b,[m,b]},useMemoCache:TR,useCacheRefresh:function(){return Uo().memoizedState=gge.bind(null,Lr)}},g$={readContext:Va,use:G_,useCallback:s$,useContext:Va,useEffect:Q8,useImperativeHandle:r$,useInsertionEffect:e$,useLayoutEffect:t$,useMemo:i$,useReducer:K_,useRef:X8,useState:function(){return K_(Bd)},useDebugValue:MR,useDeferredValue:function(m,b){var C=Bi();return a$(C,As.memoizedState,m,b)},useTransition:function(){var m=K_(Bd)[0],b=Bi().memoizedState;return[typeof m=="boolean"?m:Hv(m),b]},useSyncExternalStore:O8,useId:u$,useHostTransitionStatus:OR,useFormState:K8,useActionState:K8,useOptimistic:function(m,b){var C=Bi();return z8(C,As,m,b)},useMemoCache:TR,useCacheRefresh:d$},bge={readContext:Va,use:G_,useCallback:s$,useContext:Va,useEffect:Q8,useImperativeHandle:r$,useInsertionEffect:e$,useLayoutEffect:t$,useMemo:i$,useReducer:NR,useRef:X8,useState:function(){return NR(Bd)},useDebugValue:MR,useDeferredValue:function(m,b){var C=Bi();return As===null?jR(C,m,b):a$(C,As.memoizedState,m,b)},useTransition:function(){var m=NR(Bd)[0],b=Bi().memoizedState;return[typeof m=="boolean"?m:Hv(m),b]},useSyncExternalStore:O8,useId:u$,useHostTransitionStatus:OR,useFormState:Z8,useActionState:Z8,useOptimistic:function(m,b){var C=Bi();return As!==null?z8(C,As,m,b):(C.baseState=m,[m,C.queue.dispatch])},useMemoCache:TR,useCacheRefresh:d$},b0=null,Yv=0;function Q_(m){var b=Yv;return Yv+=1,b0===null&&(b0=[]),T8(b0,m,b)}function Zv(m,b){b=b.props.ref,m.ref=b!==void 0?b:null}function eC(m,b){throw b.$$typeof===d?Error(r(525)):(m=Object.prototype.toString.call(b),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":m)))}function y$(m){var b=m._init;return b(m._payload)}function b$(m){function b(gt,at){if(m){var St=gt.deletions;St===null?(gt.deletions=[at],gt.flags|=16):St.push(at)}}function C(gt,at){if(!m)return null;for(;at!==null;)b(gt,at),at=at.sibling;return null}function N(gt){for(var at=new Map;gt!==null;)gt.key!==null?at.set(gt.key,gt):at.set(gt.index,gt),gt=gt.sibling;return at}function L(gt,at){return gt=Od(gt,at),gt.index=0,gt.sibling=null,gt}function K(gt,at,St){return gt.index=St,m?(St=gt.alternate,St!==null?(St=St.index,St<at?(gt.flags|=67108866,at):St):(gt.flags|=67108866,at)):(gt.flags|=1048576,at)}function ge(gt){return m&&gt.alternate===null&&(gt.flags|=67108866),gt}function De(gt,at,St,Lt){return at===null||at.tag!==6?(at=rR(St,gt.mode,Lt),at.return=gt,at):(at=L(at,St),at.return=gt,at)}function Xe(gt,at,St,Lt){var Sn=St.type;return Sn===g?Dt(gt,at,St.props.children,Lt,St.key):at!==null&&(at.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===R&&y$(Sn)===at.type)?(at=L(at,St.props),Zv(at,St),at.return=gt,at):(at=D_(St.type,St.key,St.props,null,gt.mode,Lt),Zv(at,St),at.return=gt,at)}function _t(gt,at,St,Lt){return at===null||at.tag!==4||at.stateNode.containerInfo!==St.containerInfo||at.stateNode.implementation!==St.implementation?(at=sR(St,gt.mode,Lt),at.return=gt,at):(at=L(at,St.children||[]),at.return=gt,at)}function Dt(gt,at,St,Lt,Sn){return at===null||at.tag!==7?(at=em(St,gt.mode,Lt,Sn),at.return=gt,at):(at=L(at,St),at.return=gt,at)}function zt(gt,at,St){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return at=rR(""+at,gt.mode,St),at.return=gt,at;if(typeof at=="object"&&at!==null){switch(at.$$typeof){case h:return St=D_(at.type,at.key,at.props,null,gt.mode,St),Zv(St,at),St.return=gt,St;case p:return at=sR(at,gt.mode,St),at.return=gt,at;case R:var Lt=at._init;return at=Lt(at._payload),zt(gt,at,St)}if(V(at)||P(at))return at=em(at,gt.mode,St,null),at.return=gt,at;if(typeof at.then=="function")return zt(gt,Q_(at),St);if(at.$$typeof===S)return zt(gt,B_(gt,at),St);eC(gt,at)}return null}function Tt(gt,at,St,Lt){var Sn=at!==null?at.key:null;if(typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint")return Sn!==null?null:De(gt,at,""+St,Lt);if(typeof St=="object"&&St!==null){switch(St.$$typeof){case h:return St.key===Sn?Xe(gt,at,St,Lt):null;case p:return St.key===Sn?_t(gt,at,St,Lt):null;case R:return Sn=St._init,St=Sn(St._payload),Tt(gt,at,St,Lt)}if(V(St)||P(St))return Sn!==null?null:Dt(gt,at,St,Lt,null);if(typeof St.then=="function")return Tt(gt,at,Q_(St),Lt);if(St.$$typeof===S)return Tt(gt,at,B_(gt,St),Lt);eC(gt,St)}return null}function Rt(gt,at,St,Lt,Sn){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return gt=gt.get(St)||null,De(at,gt,""+Lt,Sn);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case h:return gt=gt.get(Lt.key===null?St:Lt.key)||null,Xe(at,gt,Lt,Sn);case p:return gt=gt.get(Lt.key===null?St:Lt.key)||null,_t(at,gt,Lt,Sn);case R:var Br=Lt._init;return Lt=Br(Lt._payload),Rt(gt,at,St,Lt,Sn)}if(V(Lt)||P(Lt))return gt=gt.get(St)||null,Dt(at,gt,Lt,Sn,null);if(typeof Lt.then=="function")return Rt(gt,at,St,Q_(Lt),Sn);if(Lt.$$typeof===S)return Rt(gt,at,St,B_(at,Lt),Sn);eC(at,Lt)}return null}function cr(gt,at,St,Lt){for(var Sn=null,Br=null,Ln=at,nr=at=0,ma=null;Ln!==null&&nr<St.length;nr++){Ln.index>nr?(ma=Ln,Ln=null):ma=Ln.sibling;var ls=Tt(gt,Ln,St[nr],Lt);if(ls===null){Ln===null&&(Ln=ma);break}m&&Ln&&ls.alternate===null&&b(gt,Ln),at=K(ls,at,nr),Br===null?Sn=ls:Br.sibling=ls,Br=ls,Ln=ma}if(nr===St.length)return C(gt,Ln),us&&nm(gt,nr),Sn;if(Ln===null){for(;nr<St.length;nr++)Ln=zt(gt,St[nr],Lt),Ln!==null&&(at=K(Ln,at,nr),Br===null?Sn=Ln:Br.sibling=Ln,Br=Ln);return us&&nm(gt,nr),Sn}for(Ln=N(Ln);nr<St.length;nr++)ma=Rt(Ln,gt,nr,St[nr],Lt),ma!==null&&(m&&ma.alternate!==null&&Ln.delete(ma.key===null?nr:ma.key),at=K(ma,at,nr),Br===null?Sn=ma:Br.sibling=ma,Br=ma);return m&&Ln.forEach(function(kh){return b(gt,kh)}),us&&nm(gt,nr),Sn}function Jn(gt,at,St,Lt){if(St==null)throw Error(r(151));for(var Sn=null,Br=null,Ln=at,nr=at=0,ma=null,ls=St.next();Ln!==null&&!ls.done;nr++,ls=St.next()){Ln.index>nr?(ma=Ln,Ln=null):ma=Ln.sibling;var kh=Tt(gt,Ln,ls.value,Lt);if(kh===null){Ln===null&&(Ln=ma);break}m&&Ln&&kh.alternate===null&&b(gt,Ln),at=K(kh,at,nr),Br===null?Sn=kh:Br.sibling=kh,Br=kh,Ln=ma}if(ls.done)return C(gt,Ln),us&&nm(gt,nr),Sn;if(Ln===null){for(;!ls.done;nr++,ls=St.next())ls=zt(gt,ls.value,Lt),ls!==null&&(at=K(ls,at,nr),Br===null?Sn=ls:Br.sibling=ls,Br=ls);return us&&nm(gt,nr),Sn}for(Ln=N(Ln);!ls.done;nr++,ls=St.next())ls=Rt(Ln,gt,nr,ls.value,Lt),ls!==null&&(m&&ls.alternate!==null&&Ln.delete(ls.key===null?nr:ls.key),at=K(ls,at,nr),Br===null?Sn=ls:Br.sibling=ls,Br=ls);return m&&Ln.forEach(function(v0e){return b(gt,v0e)}),us&&nm(gt,nr),Sn}function Rs(gt,at,St,Lt){if(typeof St=="object"&&St!==null&&St.type===g&&St.key===null&&(St=St.props.children),typeof St=="object"&&St!==null){switch(St.$$typeof){case h:e:{for(var Sn=St.key;at!==null;){if(at.key===Sn){if(Sn=St.type,Sn===g){if(at.tag===7){C(gt,at.sibling),Lt=L(at,St.props.children),Lt.return=gt,gt=Lt;break e}}else if(at.elementType===Sn||typeof Sn=="object"&&Sn!==null&&Sn.$$typeof===R&&y$(Sn)===at.type){C(gt,at.sibling),Lt=L(at,St.props),Zv(Lt,St),Lt.return=gt,gt=Lt;break e}C(gt,at);break}else b(gt,at);at=at.sibling}St.type===g?(Lt=em(St.props.children,gt.mode,Lt,St.key),Lt.return=gt,gt=Lt):(Lt=D_(St.type,St.key,St.props,null,gt.mode,Lt),Zv(Lt,St),Lt.return=gt,gt=Lt)}return ge(gt);case p:e:{for(Sn=St.key;at!==null;){if(at.key===Sn)if(at.tag===4&&at.stateNode.containerInfo===St.containerInfo&&at.stateNode.implementation===St.implementation){C(gt,at.sibling),Lt=L(at,St.children||[]),Lt.return=gt,gt=Lt;break e}else{C(gt,at);break}else b(gt,at);at=at.sibling}Lt=sR(St,gt.mode,Lt),Lt.return=gt,gt=Lt}return ge(gt);case R:return Sn=St._init,St=Sn(St._payload),Rs(gt,at,St,Lt)}if(V(St))return cr(gt,at,St,Lt);if(P(St)){if(Sn=P(St),typeof Sn!="function")throw Error(r(150));return St=Sn.call(St),Jn(gt,at,St,Lt)}if(typeof St.then=="function")return Rs(gt,at,Q_(St),Lt);if(St.$$typeof===S)return Rs(gt,at,B_(gt,St),Lt);eC(gt,St)}return typeof St=="string"&&St!==""||typeof St=="number"||typeof St=="bigint"?(St=""+St,at!==null&&at.tag===6?(C(gt,at.sibling),Lt=L(at,St),Lt.return=gt,gt=Lt):(C(gt,at),Lt=rR(St,gt.mode,Lt),Lt.return=gt,gt=Lt),ge(gt)):C(gt,at)}return function(gt,at,St,Lt){try{Yv=0;var Sn=Rs(gt,at,St,Lt);return b0=null,Sn}catch(Ln){if(Ln===Bv||Ln===U_)throw Ln;var Br=ml(29,Ln,null,gt.mode);return Br.lanes=Lt,Br.return=gt,Br}finally{}}}var v0=b$(!0),v$=b$(!1),Wl=G(null),wu=null;function uh(m){var b=m.alternate;ne(Ji,Ji.current&1),ne(Wl,m),wu===null&&(b===null||p0.current!==null||b.memoizedState!==null)&&(wu=m)}function x$(m){if(m.tag===22){if(ne(Ji,Ji.current),ne(Wl,m),wu===null){var b=m.alternate;b!==null&&b.memoizedState!==null&&(wu=m)}}else dh()}function dh(){ne(Ji,Ji.current),ne(Wl,Wl.current)}function zd(m){Z(Wl),wu===m&&(wu=null),Z(Ji)}var Ji=G(0);function tC(m){for(var b=m;b!==null;){if(b.tag===13){var C=b.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||C.data==="$?"||EI(C)))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===m)break;for(;b.sibling===null;){if(b.return===null||b.return===m)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}function FR(m,b,C,N){b=m.memoizedState,C=C(N,b),C=C==null?b:u({},b,C),m.memoizedState=C,m.lanes===0&&(m.updateQueue.baseState=C)}var LR={enqueueSetState:function(m,b,C){m=m._reactInternals;var N=vl(),L=oh(N);L.payload=b,C!=null&&(L.callback=C),b=lh(m,L,N),b!==null&&(xl(b,m,N),Uv(b,m,N))},enqueueReplaceState:function(m,b,C){m=m._reactInternals;var N=vl(),L=oh(N);L.tag=1,L.payload=b,C!=null&&(L.callback=C),b=lh(m,L,N),b!==null&&(xl(b,m,N),Uv(b,m,N))},enqueueForceUpdate:function(m,b){m=m._reactInternals;var C=vl(),N=oh(C);N.tag=2,b!=null&&(N.callback=b),b=lh(m,N,C),b!==null&&(xl(b,m,C),Uv(b,m,C))}};function w$(m,b,C,N,L,K,ge){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(N,K,ge):b.prototype&&b.prototype.isPureReactComponent?!O(C,N)||!O(L,K):!0}function S$(m,b,C,N){m=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(C,N),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(C,N),b.state!==m&&LR.enqueueReplaceState(b,b.state,null)}function cm(m,b){var C=b;if("ref"in b){C={};for(var N in b)N!=="ref"&&(C[N]=b[N])}if(m=m.defaultProps){C===b&&(C=u({},C));for(var L in m)C[L]===void 0&&(C[L]=m[L])}return C}var nC=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var b=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(b))return}else if(typeof Wi=="object"&&typeof Wi.emit=="function"){Wi.emit("uncaughtException",m);return}console.error(m)};function _$(m){nC(m)}function C$(m){console.error(m)}function k$(m){nC(m)}function rC(m,b){try{var C=m.onUncaughtError;C(b.value,{componentStack:b.stack})}catch(N){setTimeout(function(){throw N})}}function E$(m,b,C){try{var N=m.onCaughtError;N(C.value,{componentStack:C.stack,errorBoundary:b.tag===1?b.stateNode:null})}catch(L){setTimeout(function(){throw L})}}function $R(m,b,C){return C=oh(C),C.tag=3,C.payload={element:null},C.callback=function(){rC(m,b)},C}function T$(m){return m=oh(m),m.tag=3,m}function A$(m,b,C,N){var L=C.type.getDerivedStateFromError;if(typeof L=="function"){var K=N.value;m.payload=function(){return L(K)},m.callback=function(){E$(b,C,N)}}var ge=C.stateNode;ge!==null&&typeof ge.componentDidCatch=="function"&&(m.callback=function(){E$(b,C,N),typeof L!="function"&&(yh===null?yh=new Set([this]):yh.add(this));var De=N.stack;this.componentDidCatch(N.value,{componentStack:De!==null?De:""})})}function vge(m,b,C,N,L){if(C.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){if(b=C.alternate,b!==null&&Fv(b,C,L,!0),C=Wl.current,C!==null){switch(C.tag){case 13:return wu===null?cI():C.alternate===null&&pi===0&&(pi=3),C.flags&=-257,C.flags|=65536,C.lanes=L,N===pR?C.flags|=16384:(b=C.updateQueue,b===null?C.updateQueue=new Set([N]):b.add(N),dI(m,N,L)),!1;case 22:return C.flags|=65536,N===pR?C.flags|=16384:(b=C.updateQueue,b===null?(b={transitions:null,markerInstances:null,retryQueue:new Set([N])},C.updateQueue=b):(C=b.retryQueue,C===null?b.retryQueue=new Set([N]):C.add(N)),dI(m,N,L)),!1}throw Error(r(435,C.tag))}return dI(m,N,L),cI(),!1}if(us)return b=Wl.current,b!==null?((b.flags&65536)===0&&(b.flags|=256),b.flags|=65536,b.lanes=L,N!==oR&&(m=Error(r(422),{cause:N}),Dv(Wn(m,C)))):(N!==oR&&(b=Error(r(423),{cause:N}),Dv(Wn(b,C))),m=m.current.alternate,m.flags|=65536,L&=-L,m.lanes|=L,N=Wn(N,C),L=$R(m.stateNode,N,L),yR(m,L),pi!==4&&(pi=2)),!1;var K=Error(r(520),{cause:N});if(K=Wn(K,C),rx===null?rx=[K]:rx.push(K),pi!==4&&(pi=2),b===null)return!0;N=Wn(N,C),C=b;do{switch(C.tag){case 3:return C.flags|=65536,m=L&-L,C.lanes|=m,m=$R(C.stateNode,N,m),yR(C,m),!1;case 1:if(b=C.type,K=C.stateNode,(C.flags&128)===0&&(typeof b.getDerivedStateFromError=="function"||K!==null&&typeof K.componentDidCatch=="function"&&(yh===null||!yh.has(K))))return C.flags|=65536,L&=-L,C.lanes|=L,L=T$(L),A$(L,m,C,N),yR(C,L),!1}C=C.return}while(C!==null);return!1}var N$=Error(r(461)),ha=!1;function Na(m,b,C,N){b.child=m===null?v$(b,null,C,N):v0(b,m.child,C,N)}function R$(m,b,C,N,L){C=C.render;var K=b.ref;if("ref"in N){var ge={};for(var De in N)De!=="ref"&&(ge[De]=N[De])}else ge=N;return am(b),N=SR(m,b,C,ge,K,L),De=_R(),m!==null&&!ha?(CR(m,b,L),Ud(m,b,L)):(us&&De&&iR(b),b.flags|=1,Na(m,b,N,L),b.child)}function I$(m,b,C,N,L){if(m===null){var K=C.type;return typeof K=="function"&&!nR(K)&&K.defaultProps===void 0&&C.compare===null?(b.tag=15,b.type=K,M$(m,b,K,N,L)):(m=D_(C.type,null,N,b,b.mode,L),m.ref=b.ref,m.return=b,b.child=m)}if(K=m.child,!GR(m,L)){var ge=K.memoizedProps;if(C=C.compare,C=C!==null?C:O,C(ge,N)&&m.ref===b.ref)return Ud(m,b,L)}return b.flags|=1,m=Od(K,N),m.ref=b.ref,m.return=b,b.child=m}function M$(m,b,C,N,L){if(m!==null){var K=m.memoizedProps;if(O(K,N)&&m.ref===b.ref)if(ha=!1,b.pendingProps=N=K,GR(m,L))(m.flags&131072)!==0&&(ha=!0);else return b.lanes=m.lanes,Ud(m,b,L)}return BR(m,b,C,N,L)}function j$(m,b,C){var N=b.pendingProps,L=N.children,K=m!==null?m.memoizedState:null;if(N.mode==="hidden"){if((b.flags&128)!==0){if(N=K!==null?K.baseLanes|C:C,m!==null){for(L=b.child=m.child,K=0;L!==null;)K=K|L.lanes|L.childLanes,L=L.sibling;b.childLanes=K&~N}else b.childLanes=0,b.child=null;return P$(m,b,N,C)}if((C&536870912)!==0)b.memoizedState={baseLanes:0,cachePool:null},m!==null&&z_(b,K!==null?K.cachePool:null),K!==null?M8(b,K):vR(),x$(b);else return b.lanes=b.childLanes=536870912,P$(m,b,K!==null?K.baseLanes|C:C,C)}else K!==null?(z_(b,K.cachePool),M8(b,K),dh(),b.memoizedState=null):(m!==null&&z_(b,null),vR(),dh());return Na(m,b,L,C),b.child}function P$(m,b,C,N){var L=hR();return L=L===null?null:{parent:Xi._currentValue,pool:L},b.memoizedState={baseLanes:C,cachePool:L},m!==null&&z_(b,null),vR(),x$(b),m!==null&&Fv(m,b,N,!0),null}function sC(m,b){var C=b.ref;if(C===null)m!==null&&m.ref!==null&&(b.flags|=4194816);else{if(typeof C!="function"&&typeof C!="object")throw Error(r(284));(m===null||m.ref!==C)&&(b.flags|=4194816)}}function BR(m,b,C,N,L){return am(b),C=SR(m,b,C,N,void 0,L),N=_R(),m!==null&&!ha?(CR(m,b,L),Ud(m,b,L)):(us&&N&&iR(b),b.flags|=1,Na(m,b,C,L),b.child)}function O$(m,b,C,N,L,K){return am(b),b.updateQueue=null,C=P8(b,N,C,L),j8(m),N=_R(),m!==null&&!ha?(CR(m,b,K),Ud(m,b,K)):(us&&N&&iR(b),b.flags|=1,Na(m,b,C,K),b.child)}function D$(m,b,C,N,L){if(am(b),b.stateNode===null){var K=vu,ge=C.contextType;typeof ge=="object"&&ge!==null&&(K=Va(ge)),K=new C(N,K),b.memoizedState=K.state!==null&&K.state!==void 0?K.state:null,K.updater=LR,b.stateNode=K,K._reactInternals=b,K=b.stateNode,K.props=N,K.state=b.memoizedState,K.refs={},mR(b),ge=C.contextType,K.context=typeof ge=="object"&&ge!==null?Va(ge):vu,K.state=b.memoizedState,ge=C.getDerivedStateFromProps,typeof ge=="function"&&(FR(b,C,ge,N),K.state=b.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof K.getSnapshotBeforeUpdate=="function"||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(ge=K.state,typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount(),ge!==K.state&&LR.enqueueReplaceState(K,K.state,null),Vv(b,N,K,L),qv(),K.state=b.memoizedState),typeof K.componentDidMount=="function"&&(b.flags|=4194308),N=!0}else if(m===null){K=b.stateNode;var De=b.memoizedProps,Xe=cm(C,De);K.props=Xe;var _t=K.context,Dt=C.contextType;ge=vu,typeof Dt=="object"&&Dt!==null&&(ge=Va(Dt));var zt=C.getDerivedStateFromProps;Dt=typeof zt=="function"||typeof K.getSnapshotBeforeUpdate=="function",De=b.pendingProps!==De,Dt||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(De||_t!==ge)&&S$(b,K,N,ge),ah=!1;var Tt=b.memoizedState;K.state=Tt,Vv(b,N,K,L),qv(),_t=b.memoizedState,De||Tt!==_t||ah?(typeof zt=="function"&&(FR(b,C,zt,N),_t=b.memoizedState),(Xe=ah||w$(b,C,Xe,N,Tt,_t,ge))?(Dt||typeof K.UNSAFE_componentWillMount!="function"&&typeof K.componentWillMount!="function"||(typeof K.componentWillMount=="function"&&K.componentWillMount(),typeof K.UNSAFE_componentWillMount=="function"&&K.UNSAFE_componentWillMount()),typeof K.componentDidMount=="function"&&(b.flags|=4194308)):(typeof K.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=N,b.memoizedState=_t),K.props=N,K.state=_t,K.context=ge,N=Xe):(typeof K.componentDidMount=="function"&&(b.flags|=4194308),N=!1)}else{K=b.stateNode,gR(m,b),ge=b.memoizedProps,Dt=cm(C,ge),K.props=Dt,zt=b.pendingProps,Tt=K.context,_t=C.contextType,Xe=vu,typeof _t=="object"&&_t!==null&&(Xe=Va(_t)),De=C.getDerivedStateFromProps,(_t=typeof De=="function"||typeof K.getSnapshotBeforeUpdate=="function")||typeof K.UNSAFE_componentWillReceiveProps!="function"&&typeof K.componentWillReceiveProps!="function"||(ge!==zt||Tt!==Xe)&&S$(b,K,N,Xe),ah=!1,Tt=b.memoizedState,K.state=Tt,Vv(b,N,K,L),qv();var Rt=b.memoizedState;ge!==zt||Tt!==Rt||ah||m!==null&&m.dependencies!==null&&$_(m.dependencies)?(typeof De=="function"&&(FR(b,C,De,N),Rt=b.memoizedState),(Dt=ah||w$(b,C,Dt,N,Tt,Rt,Xe)||m!==null&&m.dependencies!==null&&$_(m.dependencies))?(_t||typeof K.UNSAFE_componentWillUpdate!="function"&&typeof K.componentWillUpdate!="function"||(typeof K.componentWillUpdate=="function"&&K.componentWillUpdate(N,Rt,Xe),typeof K.UNSAFE_componentWillUpdate=="function"&&K.UNSAFE_componentWillUpdate(N,Rt,Xe)),typeof K.componentDidUpdate=="function"&&(b.flags|=4),typeof K.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof K.componentDidUpdate!="function"||ge===m.memoizedProps&&Tt===m.memoizedState||(b.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ge===m.memoizedProps&&Tt===m.memoizedState||(b.flags|=1024),b.memoizedProps=N,b.memoizedState=Rt),K.props=N,K.state=Rt,K.context=Xe,N=Dt):(typeof K.componentDidUpdate!="function"||ge===m.memoizedProps&&Tt===m.memoizedState||(b.flags|=4),typeof K.getSnapshotBeforeUpdate!="function"||ge===m.memoizedProps&&Tt===m.memoizedState||(b.flags|=1024),N=!1)}return K=N,sC(m,b),N=(b.flags&128)!==0,K||N?(K=b.stateNode,C=N&&typeof C.getDerivedStateFromError!="function"?null:K.render(),b.flags|=1,m!==null&&N?(b.child=v0(b,m.child,null,L),b.child=v0(b,null,C,L)):Na(m,b,C,L),b.memoizedState=K.state,m=b.child):m=Ud(m,b,L),m}function F$(m,b,C,N){return Ov(),b.flags|=256,Na(m,b,C,N),b.child}var zR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function UR(m){return{baseLanes:m,cachePool:C8()}}function qR(m,b,C){return m=m!==null?m.childLanes&~C:0,b&&(m|=Hl),m}function L$(m,b,C){var N=b.pendingProps,L=!1,K=(b.flags&128)!==0,ge;if((ge=K)||(ge=m!==null&&m.memoizedState===null?!1:(Ji.current&2)!==0),ge&&(L=!0,b.flags&=-129),ge=(b.flags&32)!==0,b.flags&=-33,m===null){if(us){if(L?uh(b):dh(),us){var De=hi,Xe;if(Xe=De){e:{for(Xe=De,De=xu;Xe.nodeType!==8;){if(!De){De=null;break e}if(Xe=jc(Xe.nextSibling),Xe===null){De=null;break e}}De=Xe}De!==null?(b.memoizedState={dehydrated:De,treeContext:tm!==null?{id:Dd,overflow:Fd}:null,retryLane:536870912,hydrationErrors:null},Xe=ml(18,null,null,0),Xe.stateNode=De,Xe.return=b,b.child=Xe,yo=b,hi=null,Xe=!0):Xe=!1}Xe||sm(b)}if(De=b.memoizedState,De!==null&&(De=De.dehydrated,De!==null))return EI(De)?b.lanes=32:b.lanes=536870912,null;zd(b)}return De=N.children,N=N.fallback,L?(dh(),L=b.mode,De=iC({mode:"hidden",children:De},L),N=em(N,L,C,null),De.return=b,N.return=b,De.sibling=N,b.child=De,L=b.child,L.memoizedState=UR(C),L.childLanes=qR(m,ge,C),b.memoizedState=zR,N):(uh(b),VR(b,De))}if(Xe=m.memoizedState,Xe!==null&&(De=Xe.dehydrated,De!==null)){if(K)b.flags&256?(uh(b),b.flags&=-257,b=WR(m,b,C)):b.memoizedState!==null?(dh(),b.child=m.child,b.flags|=128,b=null):(dh(),L=N.fallback,De=b.mode,N=iC({mode:"visible",children:N.children},De),L=em(L,De,C,null),L.flags|=2,N.return=b,L.return=b,N.sibling=L,b.child=N,v0(b,m.child,null,C),N=b.child,N.memoizedState=UR(C),N.childLanes=qR(m,ge,C),b.memoizedState=zR,b=L);else if(uh(b),EI(De)){if(ge=De.nextSibling&&De.nextSibling.dataset,ge)var _t=ge.dgst;ge=_t,N=Error(r(419)),N.stack="",N.digest=ge,Dv({value:N,source:null,stack:null}),b=WR(m,b,C)}else if(ha||Fv(m,b,C,!1),ge=(C&m.childLanes)!==0,ha||ge){if(ge=Bs,ge!==null&&(N=C&-C,N=(N&42)!==0?1:Ct(N),N=(N&(ge.suspendedLanes|C))!==0?0:N,N!==0&&N!==Xe.retryLane))throw Xe.retryLane=N,Ic(m,N),xl(ge,m,N),N$;De.data==="$?"||cI(),b=WR(m,b,C)}else De.data==="$?"?(b.flags|=192,b.child=m.child,b=null):(m=Xe.treeContext,hi=jc(De.nextSibling),yo=b,us=!0,rm=null,xu=!1,m!==null&&(ql[Vl++]=Dd,ql[Vl++]=Fd,ql[Vl++]=tm,Dd=m.id,Fd=m.overflow,tm=b),b=VR(b,N.children),b.flags|=4096);return b}return L?(dh(),L=N.fallback,De=b.mode,Xe=m.child,_t=Xe.sibling,N=Od(Xe,{mode:"hidden",children:N.children}),N.subtreeFlags=Xe.subtreeFlags&65011712,_t!==null?L=Od(_t,L):(L=em(L,De,C,null),L.flags|=2),L.return=b,N.return=b,N.sibling=L,b.child=N,N=L,L=b.child,De=m.child.memoizedState,De===null?De=UR(C):(Xe=De.cachePool,Xe!==null?(_t=Xi._currentValue,Xe=Xe.parent!==_t?{parent:_t,pool:_t}:Xe):Xe=C8(),De={baseLanes:De.baseLanes|C,cachePool:Xe}),L.memoizedState=De,L.childLanes=qR(m,ge,C),b.memoizedState=zR,N):(uh(b),C=m.child,m=C.sibling,C=Od(C,{mode:"visible",children:N.children}),C.return=b,C.sibling=null,m!==null&&(ge=b.deletions,ge===null?(b.deletions=[m],b.flags|=16):ge.push(m)),b.child=C,b.memoizedState=null,C)}function VR(m,b){return b=iC({mode:"visible",children:b},m.mode),b.return=m,m.child=b}function iC(m,b){return m=ml(22,m,null,b),m.lanes=0,m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},m}function WR(m,b,C){return v0(b,m.child,null,C),m=VR(b,b.pendingProps.children),m.flags|=2,b.memoizedState=null,m}function $$(m,b,C){m.lanes|=b;var N=m.alternate;N!==null&&(N.lanes|=b),cR(m.return,b,C)}function HR(m,b,C,N,L){var K=m.memoizedState;K===null?m.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:N,tail:C,tailMode:L}:(K.isBackwards=b,K.rendering=null,K.renderingStartTime=0,K.last=N,K.tail=C,K.tailMode=L)}function B$(m,b,C){var N=b.pendingProps,L=N.revealOrder,K=N.tail;if(Na(m,b,N.children,C),N=Ji.current,(N&2)!==0)N=N&1|2,b.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=b.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&$$(m,C,b);else if(m.tag===19)$$(m,C,b);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===b)break e;for(;m.sibling===null;){if(m.return===null||m.return===b)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}N&=1}switch(ne(Ji,N),L){case"forwards":for(C=b.child,L=null;C!==null;)m=C.alternate,m!==null&&tC(m)===null&&(L=C),C=C.sibling;C=L,C===null?(L=b.child,b.child=null):(L=C.sibling,C.sibling=null),HR(b,!1,L,C,K);break;case"backwards":for(C=null,L=b.child,b.child=null;L!==null;){if(m=L.alternate,m!==null&&tC(m)===null){b.child=L;break}m=L.sibling,L.sibling=C,C=L,L=m}HR(b,!0,C,null,K);break;case"together":HR(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function Ud(m,b,C){if(m!==null&&(b.dependencies=m.dependencies),gh|=b.lanes,(C&b.childLanes)===0)if(m!==null){if(Fv(m,b,C,!1),(C&b.childLanes)===0)return null}else return null;if(m!==null&&b.child!==m.child)throw Error(r(153));if(b.child!==null){for(m=b.child,C=Od(m,m.pendingProps),b.child=C,C.return=b;m.sibling!==null;)m=m.sibling,C=C.sibling=Od(m,m.pendingProps),C.return=b;C.sibling=null}return b.child}function GR(m,b){return(m.lanes&b)!==0?!0:(m=m.dependencies,!!(m!==null&&$_(m)))}function xge(m,b,C){switch(b.tag){case 3:he(b,b.stateNode.containerInfo),ih(b,Xi,m.memoizedState.cache),Ov();break;case 27:case 5:Le(b);break;case 4:he(b,b.stateNode.containerInfo);break;case 10:ih(b,b.type,b.memoizedProps.value);break;case 13:var N=b.memoizedState;if(N!==null)return N.dehydrated!==null?(uh(b),b.flags|=128,null):(C&b.child.childLanes)!==0?L$(m,b,C):(uh(b),m=Ud(m,b,C),m!==null?m.sibling:null);uh(b);break;case 19:var L=(m.flags&128)!==0;if(N=(C&b.childLanes)!==0,N||(Fv(m,b,C,!1),N=(C&b.childLanes)!==0),L){if(N)return B$(m,b,C);b.flags|=128}if(L=b.memoizedState,L!==null&&(L.rendering=null,L.tail=null,L.lastEffect=null),ne(Ji,Ji.current),N)break;return null;case 22:case 23:return b.lanes=0,j$(m,b,C);case 24:ih(b,Xi,m.memoizedState.cache)}return Ud(m,b,C)}function z$(m,b,C){if(m!==null)if(m.memoizedProps!==b.pendingProps)ha=!0;else{if(!GR(m,C)&&(b.flags&128)===0)return ha=!1,xge(m,b,C);ha=(m.flags&131072)!==0}else ha=!1,us&&(b.flags&1048576)!==0&&y8(b,L_,b.index);switch(b.lanes=0,b.tag){case 16:e:{m=b.pendingProps;var N=b.elementType,L=N._init;if(N=L(N._payload),b.type=N,typeof N=="function")nR(N)?(m=cm(N,m),b.tag=1,b=D$(null,b,N,m,C)):(b.tag=0,b=BR(null,b,N,m,C));else{if(N!=null){if(L=N.$$typeof,L===_){b.tag=11,b=R$(null,b,N,m,C);break e}else if(L===A){b.tag=14,b=I$(null,b,N,m,C);break e}}throw b=I(N)||N,Error(r(306,b,""))}}return b;case 0:return BR(m,b,b.type,b.pendingProps,C);case 1:return N=b.type,L=cm(N,b.pendingProps),D$(m,b,N,L,C);case 3:e:{if(he(b,b.stateNode.containerInfo),m===null)throw Error(r(387));N=b.pendingProps;var K=b.memoizedState;L=K.element,gR(m,b),Vv(b,N,null,C);var ge=b.memoizedState;if(N=ge.cache,ih(b,Xi,N),N!==K.cache&&uR(b,[Xi],C,!0),qv(),N=ge.element,K.isDehydrated)if(K={element:N,isDehydrated:!1,cache:ge.cache},b.updateQueue.baseState=K,b.memoizedState=K,b.flags&256){b=F$(m,b,N,C);break e}else if(N!==L){L=Wn(Error(r(424)),b),Dv(L),b=F$(m,b,N,C);break e}else{switch(m=b.stateNode.containerInfo,m.nodeType){case 9:m=m.body;break;default:m=m.nodeName==="HTML"?m.ownerDocument.body:m}for(hi=jc(m.firstChild),yo=b,us=!0,rm=null,xu=!0,C=v$(b,null,N,C),b.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling}else{if(Ov(),N===L){b=Ud(m,b,C);break e}Na(m,b,N,C)}b=b.child}return b;case 26:return sC(m,b),m===null?(C=WB(b.type,null,b.pendingProps,null))?b.memoizedState=C:us||(C=b.type,m=b.pendingProps,N=vC(Se.current).createElement(C),N[_e]=b,N[$e]=m,Ia(N,C,m),Sr(N),b.stateNode=N):b.memoizedState=WB(b.type,m.memoizedProps,b.pendingProps,m.memoizedState),null;case 27:return Le(b),m===null&&us&&(N=b.stateNode=UB(b.type,b.pendingProps,Se.current),yo=b,xu=!0,L=hi,xh(b.type)?(TI=L,hi=jc(N.firstChild)):hi=L),Na(m,b,b.pendingProps.children,C),sC(m,b),m===null&&(b.flags|=4194304),b.child;case 5:return m===null&&us&&((L=N=hi)&&(N=Kge(N,b.type,b.pendingProps,xu),N!==null?(b.stateNode=N,yo=b,hi=jc(N.firstChild),xu=!1,L=!0):L=!1),L||sm(b)),Le(b),L=b.type,K=b.pendingProps,ge=m!==null?m.memoizedProps:null,N=K.children,_I(L,K)?N=null:ge!==null&&_I(L,ge)&&(b.flags|=32),b.memoizedState!==null&&(L=SR(m,b,fge,null,null,C),fx._currentValue=L),sC(m,b),Na(m,b,N,C),b.child;case 6:return m===null&&us&&((m=C=hi)&&(C=Yge(C,b.pendingProps,xu),C!==null?(b.stateNode=C,yo=b,hi=null,m=!0):m=!1),m||sm(b)),null;case 13:return L$(m,b,C);case 4:return he(b,b.stateNode.containerInfo),N=b.pendingProps,m===null?b.child=v0(b,null,N,C):Na(m,b,N,C),b.child;case 11:return R$(m,b,b.type,b.pendingProps,C);case 7:return Na(m,b,b.pendingProps,C),b.child;case 8:return Na(m,b,b.pendingProps.children,C),b.child;case 12:return Na(m,b,b.pendingProps.children,C),b.child;case 10:return N=b.pendingProps,ih(b,b.type,N.value),Na(m,b,N.children,C),b.child;case 9:return L=b.type._context,N=b.pendingProps.children,am(b),L=Va(L),N=N(L),b.flags|=1,Na(m,b,N,C),b.child;case 14:return I$(m,b,b.type,b.pendingProps,C);case 15:return M$(m,b,b.type,b.pendingProps,C);case 19:return B$(m,b,C);case 31:return N=b.pendingProps,C=b.mode,N={mode:N.mode,children:N.children},m===null?(C=iC(N,C),C.ref=b.ref,b.child=C,C.return=b,b=C):(C=Od(m.child,N),C.ref=b.ref,b.child=C,C.return=b,b=C),b;case 22:return j$(m,b,C);case 24:return am(b),N=Va(Xi),m===null?(L=hR(),L===null&&(L=Bs,K=dR(),L.pooledCache=K,K.refCount++,K!==null&&(L.pooledCacheLanes|=C),L=K),b.memoizedState={parent:N,cache:L},mR(b),ih(b,Xi,L)):((m.lanes&C)!==0&&(gR(m,b),Vv(b,null,null,C),qv()),L=m.memoizedState,K=b.memoizedState,L.parent!==N?(L={parent:N,cache:N},b.memoizedState=L,b.lanes===0&&(b.memoizedState=b.updateQueue.baseState=L),ih(b,Xi,N)):(N=K.cache,ih(b,Xi,N),N!==L.cache&&uR(b,[Xi],C,!0))),Na(m,b,b.pendingProps.children,C),b.child;case 29:throw b.pendingProps}throw Error(r(156,b.tag))}function qd(m){m.flags|=4}function U$(m,b){if(b.type!=="stylesheet"||(b.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!ZB(b)){if(b=Wl.current,b!==null&&((ns&4194048)===ns?wu!==null:(ns&62914560)!==ns&&(ns&536870912)===0||b!==wu))throw zv=pR,k8;m.flags|=8192}}function aC(m,b){b!==null&&(m.flags|=4),m.flags&16384&&(b=m.tag!==22?W():536870912,m.lanes|=b,_0|=b)}function Xv(m,b){if(!us)switch(m.tailMode){case"hidden":b=m.tail;for(var C=null;b!==null;)b.alternate!==null&&(C=b),b=b.sibling;C===null?m.tail=null:C.sibling=null;break;case"collapsed":C=m.tail;for(var N=null;C!==null;)C.alternate!==null&&(N=C),C=C.sibling;N===null?b||m.tail===null?m.tail=null:m.tail.sibling=null:N.sibling=null}}function ii(m){var b=m.alternate!==null&&m.alternate.child===m.child,C=0,N=0;if(b)for(var L=m.child;L!==null;)C|=L.lanes|L.childLanes,N|=L.subtreeFlags&65011712,N|=L.flags&65011712,L.return=m,L=L.sibling;else for(L=m.child;L!==null;)C|=L.lanes|L.childLanes,N|=L.subtreeFlags,N|=L.flags,L.return=m,L=L.sibling;return m.subtreeFlags|=N,m.childLanes=C,b}function wge(m,b,C){var N=b.pendingProps;switch(aR(b),b.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ii(b),null;case 1:return ii(b),null;case 3:return C=b.stateNode,N=null,m!==null&&(N=m.memoizedState.cache),b.memoizedState.cache!==N&&(b.flags|=2048),$d(Xi),pe(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(m===null||m.child===null)&&(Pv(b)?qd(b):m===null||m.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,x8())),ii(b),null;case 26:return C=b.memoizedState,m===null?(qd(b),C!==null?(ii(b),U$(b,C)):(ii(b),b.flags&=-16777217)):C?C!==m.memoizedState?(qd(b),ii(b),U$(b,C)):(ii(b),b.flags&=-16777217):(m.memoizedProps!==N&&qd(b),ii(b),b.flags&=-16777217),null;case 27:He(b),C=Se.current;var L=b.type;if(m!==null&&b.stateNode!=null)m.memoizedProps!==N&&qd(b);else{if(!N){if(b.stateNode===null)throw Error(r(166));return ii(b),null}m=ae.current,Pv(b)?b8(b):(m=UB(L,N,C),b.stateNode=m,qd(b))}return ii(b),null;case 5:if(He(b),C=b.type,m!==null&&b.stateNode!=null)m.memoizedProps!==N&&qd(b);else{if(!N){if(b.stateNode===null)throw Error(r(166));return ii(b),null}if(m=ae.current,Pv(b))b8(b);else{switch(L=vC(Se.current),m){case 1:m=L.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:m=L.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":m=L.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":m=L.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":m=L.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof N.is=="string"?L.createElement("select",{is:N.is}):L.createElement("select"),N.multiple?m.multiple=!0:N.size&&(m.size=N.size);break;default:m=typeof N.is=="string"?L.createElement(C,{is:N.is}):L.createElement(C)}}m[_e]=b,m[$e]=N;e:for(L=b.child;L!==null;){if(L.tag===5||L.tag===6)m.appendChild(L.stateNode);else if(L.tag!==4&&L.tag!==27&&L.child!==null){L.child.return=L,L=L.child;continue}if(L===b)break e;for(;L.sibling===null;){if(L.return===null||L.return===b)break e;L=L.return}L.sibling.return=L.return,L=L.sibling}b.stateNode=m;e:switch(Ia(m,C,N),C){case"button":case"input":case"select":case"textarea":m=!!N.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&qd(b)}}return ii(b),b.flags&=-16777217,null;case 6:if(m&&b.stateNode!=null)m.memoizedProps!==N&&qd(b);else{if(typeof N!="string"&&b.stateNode===null)throw Error(r(166));if(m=Se.current,Pv(b)){if(m=b.stateNode,C=b.memoizedProps,N=null,L=yo,L!==null)switch(L.tag){case 27:case 5:N=L.memoizedProps}m[_e]=b,m=!!(m.nodeValue===C||N!==null&&N.suppressHydrationWarning===!0||OB(m.nodeValue,C)),m||sm(b)}else m=vC(m).createTextNode(N),m[_e]=b,b.stateNode=m}return ii(b),null;case 13:if(N=b.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(L=Pv(b),N!==null&&N.dehydrated!==null){if(m===null){if(!L)throw Error(r(318));if(L=b.memoizedState,L=L!==null?L.dehydrated:null,!L)throw Error(r(317));L[_e]=b}else Ov(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;ii(b),L=!1}else L=x8(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=L),L=!0;if(!L)return b.flags&256?(zd(b),b):(zd(b),null)}if(zd(b),(b.flags&128)!==0)return b.lanes=C,b;if(C=N!==null,m=m!==null&&m.memoizedState!==null,C){N=b.child,L=null,N.alternate!==null&&N.alternate.memoizedState!==null&&N.alternate.memoizedState.cachePool!==null&&(L=N.alternate.memoizedState.cachePool.pool);var K=null;N.memoizedState!==null&&N.memoizedState.cachePool!==null&&(K=N.memoizedState.cachePool.pool),K!==L&&(N.flags|=2048)}return C!==m&&C&&(b.child.flags|=8192),aC(b,b.updateQueue),ii(b),null;case 4:return pe(),m===null&&bI(b.stateNode.containerInfo),ii(b),null;case 10:return $d(b.type),ii(b),null;case 19:if(Z(Ji),L=b.memoizedState,L===null)return ii(b),null;if(N=(b.flags&128)!==0,K=L.rendering,K===null)if(N)Xv(L,!1);else{if(pi!==0||m!==null&&(m.flags&128)!==0)for(m=b.child;m!==null;){if(K=tC(m),K!==null){for(b.flags|=128,Xv(L,!1),m=K.updateQueue,b.updateQueue=m,aC(b,m),b.subtreeFlags=0,m=C,C=b.child;C!==null;)g8(C,m),C=C.sibling;return ne(Ji,Ji.current&1|2),b.child}m=m.sibling}L.tail!==null&&fe()>cC&&(b.flags|=128,N=!0,Xv(L,!1),b.lanes=4194304)}else{if(!N)if(m=tC(K),m!==null){if(b.flags|=128,N=!0,m=m.updateQueue,b.updateQueue=m,aC(b,m),Xv(L,!0),L.tail===null&&L.tailMode==="hidden"&&!K.alternate&&!us)return ii(b),null}else 2*fe()-L.renderingStartTime>cC&&C!==536870912&&(b.flags|=128,N=!0,Xv(L,!1),b.lanes=4194304);L.isBackwards?(K.sibling=b.child,b.child=K):(m=L.last,m!==null?m.sibling=K:b.child=K,L.last=K)}return L.tail!==null?(b=L.tail,L.rendering=b,L.tail=b.sibling,L.renderingStartTime=fe(),b.sibling=null,m=Ji.current,ne(Ji,N?m&1|2:m&1),b):(ii(b),null);case 22:case 23:return zd(b),xR(),N=b.memoizedState!==null,m!==null?m.memoizedState!==null!==N&&(b.flags|=8192):N&&(b.flags|=8192),N?(C&536870912)!==0&&(b.flags&128)===0&&(ii(b),b.subtreeFlags&6&&(b.flags|=8192)):ii(b),C=b.updateQueue,C!==null&&aC(b,C.retryQueue),C=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),N=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(N=b.memoizedState.cachePool.pool),N!==C&&(b.flags|=2048),m!==null&&Z(om),null;case 24:return C=null,m!==null&&(C=m.memoizedState.cache),b.memoizedState.cache!==C&&(b.flags|=2048),$d(Xi),ii(b),null;case 25:return null;case 30:return null}throw Error(r(156,b.tag))}function Sge(m,b){switch(aR(b),b.tag){case 1:return m=b.flags,m&65536?(b.flags=m&-65537|128,b):null;case 3:return $d(Xi),pe(),m=b.flags,(m&65536)!==0&&(m&128)===0?(b.flags=m&-65537|128,b):null;case 26:case 27:case 5:return He(b),null;case 13:if(zd(b),m=b.memoizedState,m!==null&&m.dehydrated!==null){if(b.alternate===null)throw Error(r(340));Ov()}return m=b.flags,m&65536?(b.flags=m&-65537|128,b):null;case 19:return Z(Ji),null;case 4:return pe(),null;case 10:return $d(b.type),null;case 22:case 23:return zd(b),xR(),m!==null&&Z(om),m=b.flags,m&65536?(b.flags=m&-65537|128,b):null;case 24:return $d(Xi),null;case 25:return null;default:return null}}function q$(m,b){switch(aR(b),b.tag){case 3:$d(Xi),pe();break;case 26:case 27:case 5:He(b);break;case 4:pe();break;case 13:zd(b);break;case 19:Z(Ji);break;case 10:$d(b.type);break;case 22:case 23:zd(b),xR(),m!==null&&Z(om);break;case 24:$d(Xi)}}function Jv(m,b){try{var C=b.updateQueue,N=C!==null?C.lastEffect:null;if(N!==null){var L=N.next;C=L;do{if((C.tag&m)===m){N=void 0;var K=C.create,ge=C.inst;N=K(),ge.destroy=N}C=C.next}while(C!==L)}}catch(De){Os(b,b.return,De)}}function fh(m,b,C){try{var N=b.updateQueue,L=N!==null?N.lastEffect:null;if(L!==null){var K=L.next;N=K;do{if((N.tag&m)===m){var ge=N.inst,De=ge.destroy;if(De!==void 0){ge.destroy=void 0,L=b;var Xe=C,_t=De;try{_t()}catch(Dt){Os(L,Xe,Dt)}}}N=N.next}while(N!==K)}}catch(Dt){Os(b,b.return,Dt)}}function V$(m){var b=m.updateQueue;if(b!==null){var C=m.stateNode;try{I8(b,C)}catch(N){Os(m,m.return,N)}}}function W$(m,b,C){C.props=cm(m.type,m.memoizedProps),C.state=m.memoizedState;try{C.componentWillUnmount()}catch(N){Os(m,b,N)}}function Qv(m,b){try{var C=m.ref;if(C!==null){switch(m.tag){case 26:case 27:case 5:var N=m.stateNode;break;case 30:N=m.stateNode;break;default:N=m.stateNode}typeof C=="function"?m.refCleanup=C(N):C.current=N}}catch(L){Os(m,b,L)}}function Su(m,b){var C=m.ref,N=m.refCleanup;if(C!==null)if(typeof N=="function")try{N()}catch(L){Os(m,b,L)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof C=="function")try{C(null)}catch(L){Os(m,b,L)}else C.current=null}function H$(m){var b=m.type,C=m.memoizedProps,N=m.stateNode;try{e:switch(b){case"button":case"input":case"select":case"textarea":C.autoFocus&&N.focus();break e;case"img":C.src?N.src=C.src:C.srcSet&&(N.srcset=C.srcSet)}}catch(L){Os(m,m.return,L)}}function KR(m,b,C){try{var N=m.stateNode;qge(N,m.type,C,b),N[$e]=b}catch(L){Os(m,m.return,L)}}function G$(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&xh(m.type)||m.tag===4}function YR(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||G$(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&xh(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function ZR(m,b,C){var N=m.tag;if(N===5||N===6)m=m.stateNode,b?(C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C).insertBefore(m,b):(b=C.nodeType===9?C.body:C.nodeName==="HTML"?C.ownerDocument.body:C,b.appendChild(m),C=C._reactRootContainer,C!=null||b.onclick!==null||(b.onclick=bC));else if(N!==4&&(N===27&&xh(m.type)&&(C=m.stateNode,b=null),m=m.child,m!==null))for(ZR(m,b,C),m=m.sibling;m!==null;)ZR(m,b,C),m=m.sibling}function oC(m,b,C){var N=m.tag;if(N===5||N===6)m=m.stateNode,b?C.insertBefore(m,b):C.appendChild(m);else if(N!==4&&(N===27&&xh(m.type)&&(C=m.stateNode),m=m.child,m!==null))for(oC(m,b,C),m=m.sibling;m!==null;)oC(m,b,C),m=m.sibling}function K$(m){var b=m.stateNode,C=m.memoizedProps;try{for(var N=m.type,L=b.attributes;L.length;)b.removeAttributeNode(L[0]);Ia(b,N,C),b[_e]=m,b[$e]=C}catch(K){Os(m,m.return,K)}}var Vd=!1,_i=!1,XR=!1,Y$=typeof WeakSet=="function"?WeakSet:Set,pa=null;function _ge(m,b){if(m=m.containerInfo,wI=kC,m=be(m),Oe(m)){if("selectionStart"in m)var C={start:m.selectionStart,end:m.selectionEnd};else e:{C=(C=m.ownerDocument)&&C.defaultView||window;var N=C.getSelection&&C.getSelection();if(N&&N.rangeCount!==0){C=N.anchorNode;var L=N.anchorOffset,K=N.focusNode;N=N.focusOffset;try{C.nodeType,K.nodeType}catch{C=null;break e}var ge=0,De=-1,Xe=-1,_t=0,Dt=0,zt=m,Tt=null;t:for(;;){for(var Rt;zt!==C||L!==0&&zt.nodeType!==3||(De=ge+L),zt!==K||N!==0&&zt.nodeType!==3||(Xe=ge+N),zt.nodeType===3&&(ge+=zt.nodeValue.length),(Rt=zt.firstChild)!==null;)Tt=zt,zt=Rt;for(;;){if(zt===m)break t;if(Tt===C&&++_t===L&&(De=ge),Tt===K&&++Dt===N&&(Xe=ge),(Rt=zt.nextSibling)!==null)break;zt=Tt,Tt=zt.parentNode}zt=Rt}C=De===-1||Xe===-1?null:{start:De,end:Xe}}else C=null}C=C||{start:0,end:0}}else C=null;for(SI={focusedElem:m,selectionRange:C},kC=!1,pa=b;pa!==null;)if(b=pa,m=b.child,(b.subtreeFlags&1024)!==0&&m!==null)m.return=b,pa=m;else for(;pa!==null;){switch(b=pa,K=b.alternate,m=b.flags,b.tag){case 0:break;case 11:case 15:break;case 1:if((m&1024)!==0&&K!==null){m=void 0,C=b,L=K.memoizedProps,K=K.memoizedState,N=C.stateNode;try{var cr=cm(C.type,L,C.elementType===C.type);m=N.getSnapshotBeforeUpdate(cr,K),N.__reactInternalSnapshotBeforeUpdate=m}catch(Jn){Os(C,C.return,Jn)}}break;case 3:if((m&1024)!==0){if(m=b.stateNode.containerInfo,C=m.nodeType,C===9)kI(m);else if(C===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":kI(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(r(163))}if(m=b.sibling,m!==null){m.return=b.return,pa=m;break}pa=b.return}}function Z$(m,b,C){var N=C.flags;switch(C.tag){case 0:case 11:case 15:hh(m,C),N&4&&Jv(5,C);break;case 1:if(hh(m,C),N&4)if(m=C.stateNode,b===null)try{m.componentDidMount()}catch(ge){Os(C,C.return,ge)}else{var L=cm(C.type,b.memoizedProps);b=b.memoizedState;try{m.componentDidUpdate(L,b,m.__reactInternalSnapshotBeforeUpdate)}catch(ge){Os(C,C.return,ge)}}N&64&&V$(C),N&512&&Qv(C,C.return);break;case 3:if(hh(m,C),N&64&&(m=C.updateQueue,m!==null)){if(b=null,C.child!==null)switch(C.child.tag){case 27:case 5:b=C.child.stateNode;break;case 1:b=C.child.stateNode}try{I8(m,b)}catch(ge){Os(C,C.return,ge)}}break;case 27:b===null&&N&4&&K$(C);case 26:case 5:hh(m,C),b===null&&N&4&&H$(C),N&512&&Qv(C,C.return);break;case 12:hh(m,C);break;case 13:hh(m,C),N&4&&Q$(m,C),N&64&&(m=C.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(C=Mge.bind(null,C),Zge(m,C))));break;case 22:if(N=C.memoizedState!==null||Vd,!N){b=b!==null&&b.memoizedState!==null||_i,L=Vd;var K=_i;Vd=N,(_i=b)&&!K?ph(m,C,(C.subtreeFlags&8772)!==0):hh(m,C),Vd=L,_i=K}break;case 30:break;default:hh(m,C)}}function X$(m){var b=m.alternate;b!==null&&(m.alternate=null,X$(b)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(b=m.stateNode,b!==null&&dn(b)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var Js=null,qo=!1;function Wd(m,b,C){for(C=C.child;C!==null;)J$(m,b,C),C=C.sibling}function J$(m,b,C){if($t&&typeof $t.onCommitFiberUnmount=="function")try{$t.onCommitFiberUnmount(Pt,C)}catch{}switch(C.tag){case 26:_i||Su(C,b),Wd(m,b,C),C.memoizedState?C.memoizedState.count--:C.stateNode&&(C=C.stateNode,C.parentNode.removeChild(C));break;case 27:_i||Su(C,b);var N=Js,L=qo;xh(C.type)&&(Js=C.stateNode,qo=!1),Wd(m,b,C),lx(C.stateNode),Js=N,qo=L;break;case 5:_i||Su(C,b);case 6:if(N=Js,L=qo,Js=null,Wd(m,b,C),Js=N,qo=L,Js!==null)if(qo)try{(Js.nodeType===9?Js.body:Js.nodeName==="HTML"?Js.ownerDocument.body:Js).removeChild(C.stateNode)}catch(K){Os(C,b,K)}else try{Js.removeChild(C.stateNode)}catch(K){Os(C,b,K)}break;case 18:Js!==null&&(qo?(m=Js,BB(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,C.stateNode),gx(m)):BB(Js,C.stateNode));break;case 4:N=Js,L=qo,Js=C.stateNode.containerInfo,qo=!0,Wd(m,b,C),Js=N,qo=L;break;case 0:case 11:case 14:case 15:_i||fh(2,C,b),_i||fh(4,C,b),Wd(m,b,C);break;case 1:_i||(Su(C,b),N=C.stateNode,typeof N.componentWillUnmount=="function"&&W$(C,b,N)),Wd(m,b,C);break;case 21:Wd(m,b,C);break;case 22:_i=(N=_i)||C.memoizedState!==null,Wd(m,b,C),_i=N;break;default:Wd(m,b,C)}}function Q$(m,b){if(b.memoizedState===null&&(m=b.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{gx(m)}catch(C){Os(b,b.return,C)}}function Cge(m){switch(m.tag){case 13:case 19:var b=m.stateNode;return b===null&&(b=m.stateNode=new Y$),b;case 22:return m=m.stateNode,b=m._retryCache,b===null&&(b=m._retryCache=new Y$),b;default:throw Error(r(435,m.tag))}}function JR(m,b){var C=Cge(m);b.forEach(function(N){var L=jge.bind(null,m,N);C.has(N)||(C.add(N),N.then(L,L))})}function gl(m,b){var C=b.deletions;if(C!==null)for(var N=0;N<C.length;N++){var L=C[N],K=m,ge=b,De=ge;e:for(;De!==null;){switch(De.tag){case 27:if(xh(De.type)){Js=De.stateNode,qo=!1;break e}break;case 5:Js=De.stateNode,qo=!1;break e;case 3:case 4:Js=De.stateNode.containerInfo,qo=!0;break e}De=De.return}if(Js===null)throw Error(r(160));J$(K,ge,L),Js=null,qo=!1,K=L.alternate,K!==null&&(K.return=null),L.return=null}if(b.subtreeFlags&13878)for(b=b.child;b!==null;)eB(b,m),b=b.sibling}var Mc=null;function eB(m,b){var C=m.alternate,N=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:gl(b,m),yl(m),N&4&&(fh(3,m,m.return),Jv(3,m),fh(5,m,m.return));break;case 1:gl(b,m),yl(m),N&512&&(_i||C===null||Su(C,C.return)),N&64&&Vd&&(m=m.updateQueue,m!==null&&(N=m.callbacks,N!==null&&(C=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=C===null?N:C.concat(N))));break;case 26:var L=Mc;if(gl(b,m),yl(m),N&512&&(_i||C===null||Su(C,C.return)),N&4){var K=C!==null?C.memoizedState:null;if(N=m.memoizedState,C===null)if(N===null)if(m.stateNode===null){e:{N=m.type,C=m.memoizedProps,L=L.ownerDocument||L;t:switch(N){case"title":K=L.getElementsByTagName("title")[0],(!K||K[rn]||K[_e]||K.namespaceURI==="http://www.w3.org/2000/svg"||K.hasAttribute("itemprop"))&&(K=L.createElement(N),L.head.insertBefore(K,L.querySelector("head > title"))),Ia(K,N,C),K[_e]=m,Sr(K),N=K;break e;case"link":var ge=KB("link","href",L).get(N+(C.href||""));if(ge){for(var De=0;De<ge.length;De++)if(K=ge[De],K.getAttribute("href")===(C.href==null||C.href===""?null:C.href)&&K.getAttribute("rel")===(C.rel==null?null:C.rel)&&K.getAttribute("title")===(C.title==null?null:C.title)&&K.getAttribute("crossorigin")===(C.crossOrigin==null?null:C.crossOrigin)){ge.splice(De,1);break t}}K=L.createElement(N),Ia(K,N,C),L.head.appendChild(K);break;case"meta":if(ge=KB("meta","content",L).get(N+(C.content||""))){for(De=0;De<ge.length;De++)if(K=ge[De],K.getAttribute("content")===(C.content==null?null:""+C.content)&&K.getAttribute("name")===(C.name==null?null:C.name)&&K.getAttribute("property")===(C.property==null?null:C.property)&&K.getAttribute("http-equiv")===(C.httpEquiv==null?null:C.httpEquiv)&&K.getAttribute("charset")===(C.charSet==null?null:C.charSet)){ge.splice(De,1);break t}}K=L.createElement(N),Ia(K,N,C),L.head.appendChild(K);break;default:throw Error(r(468,N))}K[_e]=m,Sr(K),N=K}m.stateNode=N}else YB(L,m.type,m.stateNode);else m.stateNode=GB(L,N,m.memoizedProps);else K!==N?(K===null?C.stateNode!==null&&(C=C.stateNode,C.parentNode.removeChild(C)):K.count--,N===null?YB(L,m.type,m.stateNode):GB(L,N,m.memoizedProps)):N===null&&m.stateNode!==null&&KR(m,m.memoizedProps,C.memoizedProps)}break;case 27:gl(b,m),yl(m),N&512&&(_i||C===null||Su(C,C.return)),C!==null&&N&4&&KR(m,m.memoizedProps,C.memoizedProps);break;case 5:if(gl(b,m),yl(m),N&512&&(_i||C===null||Su(C,C.return)),m.flags&32){L=m.stateNode;try{Yf(L,"")}catch(Rt){Os(m,m.return,Rt)}}N&4&&m.stateNode!=null&&(L=m.memoizedProps,KR(m,L,C!==null?C.memoizedProps:L)),N&1024&&(XR=!0);break;case 6:if(gl(b,m),yl(m),N&4){if(m.stateNode===null)throw Error(r(162));N=m.memoizedProps,C=m.stateNode;try{C.nodeValue=N}catch(Rt){Os(m,m.return,Rt)}}break;case 3:if(SC=null,L=Mc,Mc=xC(b.containerInfo),gl(b,m),Mc=L,yl(m),N&4&&C!==null&&C.memoizedState.isDehydrated)try{gx(b.containerInfo)}catch(Rt){Os(m,m.return,Rt)}XR&&(XR=!1,tB(m));break;case 4:N=Mc,Mc=xC(m.stateNode.containerInfo),gl(b,m),yl(m),Mc=N;break;case 12:gl(b,m),yl(m);break;case 13:gl(b,m),yl(m),m.child.flags&8192&&m.memoizedState!==null!=(C!==null&&C.memoizedState!==null)&&(sI=fe()),N&4&&(N=m.updateQueue,N!==null&&(m.updateQueue=null,JR(m,N)));break;case 22:L=m.memoizedState!==null;var Xe=C!==null&&C.memoizedState!==null,_t=Vd,Dt=_i;if(Vd=_t||L,_i=Dt||Xe,gl(b,m),_i=Dt,Vd=_t,yl(m),N&8192)e:for(b=m.stateNode,b._visibility=L?b._visibility&-2:b._visibility|1,L&&(C===null||Xe||Vd||_i||um(m)),C=null,b=m;;){if(b.tag===5||b.tag===26){if(C===null){Xe=C=b;try{if(K=Xe.stateNode,L)ge=K.style,typeof ge.setProperty=="function"?ge.setProperty("display","none","important"):ge.display="none";else{De=Xe.stateNode;var zt=Xe.memoizedProps.style,Tt=zt!=null&&zt.hasOwnProperty("display")?zt.display:null;De.style.display=Tt==null||typeof Tt=="boolean"?"":(""+Tt).trim()}}catch(Rt){Os(Xe,Xe.return,Rt)}}}else if(b.tag===6){if(C===null){Xe=b;try{Xe.stateNode.nodeValue=L?"":Xe.memoizedProps}catch(Rt){Os(Xe,Xe.return,Rt)}}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===m)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===m)break e;for(;b.sibling===null;){if(b.return===null||b.return===m)break e;C===b&&(C=null),b=b.return}C===b&&(C=null),b.sibling.return=b.return,b=b.sibling}N&4&&(N=m.updateQueue,N!==null&&(C=N.retryQueue,C!==null&&(N.retryQueue=null,JR(m,C))));break;case 19:gl(b,m),yl(m),N&4&&(N=m.updateQueue,N!==null&&(m.updateQueue=null,JR(m,N)));break;case 30:break;case 21:break;default:gl(b,m),yl(m)}}function yl(m){var b=m.flags;if(b&2){try{for(var C,N=m.return;N!==null;){if(G$(N)){C=N;break}N=N.return}if(C==null)throw Error(r(160));switch(C.tag){case 27:var L=C.stateNode,K=YR(m);oC(m,K,L);break;case 5:var ge=C.stateNode;C.flags&32&&(Yf(ge,""),C.flags&=-33);var De=YR(m);oC(m,De,ge);break;case 3:case 4:var Xe=C.stateNode.containerInfo,_t=YR(m);ZR(m,_t,Xe);break;default:throw Error(r(161))}}catch(Dt){Os(m,m.return,Dt)}m.flags&=-3}b&4096&&(m.flags&=-4097)}function tB(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var b=m;tB(b),b.tag===5&&b.flags&1024&&b.stateNode.reset(),m=m.sibling}}function hh(m,b){if(b.subtreeFlags&8772)for(b=b.child;b!==null;)Z$(m,b.alternate,b),b=b.sibling}function um(m){for(m=m.child;m!==null;){var b=m;switch(b.tag){case 0:case 11:case 14:case 15:fh(4,b,b.return),um(b);break;case 1:Su(b,b.return);var C=b.stateNode;typeof C.componentWillUnmount=="function"&&W$(b,b.return,C),um(b);break;case 27:lx(b.stateNode);case 26:case 5:Su(b,b.return),um(b);break;case 22:b.memoizedState===null&&um(b);break;case 30:um(b);break;default:um(b)}m=m.sibling}}function ph(m,b,C){for(C=C&&(b.subtreeFlags&8772)!==0,b=b.child;b!==null;){var N=b.alternate,L=m,K=b,ge=K.flags;switch(K.tag){case 0:case 11:case 15:ph(L,K,C),Jv(4,K);break;case 1:if(ph(L,K,C),N=K,L=N.stateNode,typeof L.componentDidMount=="function")try{L.componentDidMount()}catch(_t){Os(N,N.return,_t)}if(N=K,L=N.updateQueue,L!==null){var De=N.stateNode;try{var Xe=L.shared.hiddenCallbacks;if(Xe!==null)for(L.shared.hiddenCallbacks=null,L=0;L<Xe.length;L++)R8(Xe[L],De)}catch(_t){Os(N,N.return,_t)}}C&&ge&64&&V$(K),Qv(K,K.return);break;case 27:K$(K);case 26:case 5:ph(L,K,C),C&&N===null&&ge&4&&H$(K),Qv(K,K.return);break;case 12:ph(L,K,C);break;case 13:ph(L,K,C),C&&ge&4&&Q$(L,K);break;case 22:K.memoizedState===null&&ph(L,K,C),Qv(K,K.return);break;case 30:break;default:ph(L,K,C)}b=b.sibling}}function QR(m,b){var C=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),m=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(m=b.memoizedState.cachePool.pool),m!==C&&(m!=null&&m.refCount++,C!=null&&Lv(C))}function eI(m,b){m=null,b.alternate!==null&&(m=b.alternate.memoizedState.cache),b=b.memoizedState.cache,b!==m&&(b.refCount++,m!=null&&Lv(m))}function _u(m,b,C,N){if(b.subtreeFlags&10256)for(b=b.child;b!==null;)nB(m,b,C,N),b=b.sibling}function nB(m,b,C,N){var L=b.flags;switch(b.tag){case 0:case 11:case 15:_u(m,b,C,N),L&2048&&Jv(9,b);break;case 1:_u(m,b,C,N);break;case 3:_u(m,b,C,N),L&2048&&(m=null,b.alternate!==null&&(m=b.alternate.memoizedState.cache),b=b.memoizedState.cache,b!==m&&(b.refCount++,m!=null&&Lv(m)));break;case 12:if(L&2048){_u(m,b,C,N),m=b.stateNode;try{var K=b.memoizedProps,ge=K.id,De=K.onPostCommit;typeof De=="function"&&De(ge,b.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(Xe){Os(b,b.return,Xe)}}else _u(m,b,C,N);break;case 13:_u(m,b,C,N);break;case 23:break;case 22:K=b.stateNode,ge=b.alternate,b.memoizedState!==null?K._visibility&2?_u(m,b,C,N):ex(m,b):K._visibility&2?_u(m,b,C,N):(K._visibility|=2,x0(m,b,C,N,(b.subtreeFlags&10256)!==0)),L&2048&&QR(ge,b);break;case 24:_u(m,b,C,N),L&2048&&eI(b.alternate,b);break;default:_u(m,b,C,N)}}function x0(m,b,C,N,L){for(L=L&&(b.subtreeFlags&10256)!==0,b=b.child;b!==null;){var K=m,ge=b,De=C,Xe=N,_t=ge.flags;switch(ge.tag){case 0:case 11:case 15:x0(K,ge,De,Xe,L),Jv(8,ge);break;case 23:break;case 22:var Dt=ge.stateNode;ge.memoizedState!==null?Dt._visibility&2?x0(K,ge,De,Xe,L):ex(K,ge):(Dt._visibility|=2,x0(K,ge,De,Xe,L)),L&&_t&2048&&QR(ge.alternate,ge);break;case 24:x0(K,ge,De,Xe,L),L&&_t&2048&&eI(ge.alternate,ge);break;default:x0(K,ge,De,Xe,L)}b=b.sibling}}function ex(m,b){if(b.subtreeFlags&10256)for(b=b.child;b!==null;){var C=m,N=b,L=N.flags;switch(N.tag){case 22:ex(C,N),L&2048&&QR(N.alternate,N);break;case 24:ex(C,N),L&2048&&eI(N.alternate,N);break;default:ex(C,N)}b=b.sibling}}var tx=8192;function w0(m){if(m.subtreeFlags&tx)for(m=m.child;m!==null;)rB(m),m=m.sibling}function rB(m){switch(m.tag){case 26:w0(m),m.flags&tx&&m.memoizedState!==null&&c0e(Mc,m.memoizedState,m.memoizedProps);break;case 5:w0(m);break;case 3:case 4:var b=Mc;Mc=xC(m.stateNode.containerInfo),w0(m),Mc=b;break;case 22:m.memoizedState===null&&(b=m.alternate,b!==null&&b.memoizedState!==null?(b=tx,tx=16777216,w0(m),tx=b):w0(m));break;default:w0(m)}}function sB(m){var b=m.alternate;if(b!==null&&(m=b.child,m!==null)){b.child=null;do b=m.sibling,m.sibling=null,m=b;while(m!==null)}}function nx(m){var b=m.deletions;if((m.flags&16)!==0){if(b!==null)for(var C=0;C<b.length;C++){var N=b[C];pa=N,aB(N,m)}sB(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)iB(m),m=m.sibling}function iB(m){switch(m.tag){case 0:case 11:case 15:nx(m),m.flags&2048&&fh(9,m,m.return);break;case 3:nx(m);break;case 12:nx(m);break;case 22:var b=m.stateNode;m.memoizedState!==null&&b._visibility&2&&(m.return===null||m.return.tag!==13)?(b._visibility&=-3,lC(m)):nx(m);break;default:nx(m)}}function lC(m){var b=m.deletions;if((m.flags&16)!==0){if(b!==null)for(var C=0;C<b.length;C++){var N=b[C];pa=N,aB(N,m)}sB(m)}for(m=m.child;m!==null;){switch(b=m,b.tag){case 0:case 11:case 15:fh(8,b,b.return),lC(b);break;case 22:C=b.stateNode,C._visibility&2&&(C._visibility&=-3,lC(b));break;default:lC(b)}m=m.sibling}}function aB(m,b){for(;pa!==null;){var C=pa;switch(C.tag){case 0:case 11:case 15:fh(8,C,b);break;case 23:case 22:if(C.memoizedState!==null&&C.memoizedState.cachePool!==null){var N=C.memoizedState.cachePool.pool;N!=null&&N.refCount++}break;case 24:Lv(C.memoizedState.cache)}if(N=C.child,N!==null)N.return=C,pa=N;else e:for(C=m;pa!==null;){N=pa;var L=N.sibling,K=N.return;if(X$(N),N===C){pa=null;break e}if(L!==null){L.return=K,pa=L;break e}pa=K}}}var kge={getCacheForType:function(m){var b=Va(Xi),C=b.data.get(m);return C===void 0&&(C=m(),b.data.set(m,C)),C}},Ege=typeof WeakMap=="function"?WeakMap:Map,_s=0,Bs=null,Ur=null,ns=0,Cs=0,bl=null,mh=!1,S0=!1,tI=!1,Hd=0,pi=0,gh=0,dm=0,nI=0,Hl=0,_0=0,rx=null,Vo=null,rI=!1,sI=0,cC=1/0,uC=null,yh=null,Ra=0,bh=null,C0=null,k0=0,iI=0,aI=null,oB=null,sx=0,oI=null;function vl(){if((_s&2)!==0&&ns!==0)return ns&-ns;if(D.T!==null){var m=f0;return m!==0?m:pI()}return Q()}function lB(){Hl===0&&(Hl=(ns&536870912)===0||us?et():536870912);var m=Wl.current;return m!==null&&(m.flags|=32),Hl}function xl(m,b,C){(m===Bs&&(Cs===2||Cs===9)||m.cancelPendingCommit!==null)&&(E0(m,0),vh(m,ns,Hl,!1)),tt(m,C),((_s&2)===0||m!==Bs)&&(m===Bs&&((_s&2)===0&&(dm|=C),pi===4&&vh(m,ns,Hl,!1)),Cu(m))}function cB(m,b,C){if((_s&6)!==0)throw Error(r(327));var N=!C&&(b&124)===0&&(b&m.expiredLanes)===0||de(m,b),L=N?Nge(m,b):uI(m,b,!0),K=N;do{if(L===0){S0&&!N&&vh(m,b,0,!1);break}else{if(C=m.current.alternate,K&&!Tge(C)){L=uI(m,b,!1),K=!1;continue}if(L===2){if(K=b,m.errorRecoveryDisabledLanes&K)var ge=0;else ge=m.pendingLanes&-536870913,ge=ge!==0?ge:ge&536870912?536870912:0;if(ge!==0){b=ge;e:{var De=m;L=rx;var Xe=De.current.memoizedState.isDehydrated;if(Xe&&(E0(De,ge).flags|=256),ge=uI(De,ge,!1),ge!==2){if(tI&&!Xe){De.errorRecoveryDisabledLanes|=K,dm|=K,L=4;break e}K=Vo,Vo=L,K!==null&&(Vo===null?Vo=K:Vo.push.apply(Vo,K))}L=ge}if(K=!1,L!==2)continue}}if(L===1){E0(m,0),vh(m,b,0,!0);break}e:{switch(N=m,K=L,K){case 0:case 1:throw Error(r(345));case 4:if((b&4194048)!==b)break;case 6:vh(N,b,Hl,!mh);break e;case 2:Vo=null;break;case 3:case 5:break;default:throw Error(r(329))}if((b&62914560)===b&&(L=sI+300-fe(),10<L)){if(vh(N,b,Hl,!mh),Me(N,0,!0)!==0)break e;N.timeoutHandle=LB(uB.bind(null,N,C,Vo,uC,rI,b,Hl,dm,_0,mh,K,2,-0,0),L);break e}uB(N,C,Vo,uC,rI,b,Hl,dm,_0,mh,K,0,-0,0)}}break}while(!0);Cu(m)}function uB(m,b,C,N,L,K,ge,De,Xe,_t,Dt,zt,Tt,Rt){if(m.timeoutHandle=-1,zt=b.subtreeFlags,(zt&8192||(zt&16785408)===16785408)&&(dx={stylesheets:null,count:0,unsuspend:l0e},rB(b),zt=u0e(),zt!==null)){m.cancelPendingCommit=zt(yB.bind(null,m,b,K,C,N,L,ge,De,Xe,Dt,1,Tt,Rt)),vh(m,K,ge,!_t);return}yB(m,b,K,C,N,L,ge,De,Xe)}function Tge(m){for(var b=m;;){var C=b.tag;if((C===0||C===11||C===15)&&b.flags&16384&&(C=b.updateQueue,C!==null&&(C=C.stores,C!==null)))for(var N=0;N<C.length;N++){var L=C[N],K=L.getSnapshot;L=L.value;try{if(!qa(K(),L))return!1}catch{return!1}}if(C=b.child,b.subtreeFlags&16384&&C!==null)C.return=b,b=C;else{if(b===m)break;for(;b.sibling===null;){if(b.return===null||b.return===m)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function vh(m,b,C,N){b&=~nI,b&=~dm,m.suspendedLanes|=b,m.pingedLanes&=~b,N&&(m.warmLanes|=b),N=m.expirationTimes;for(var L=b;0<L;){var K=31-Ht(L),ge=1<<K;N[K]=-1,L&=~ge}C!==0&&Te(m,C,b)}function dC(){return(_s&6)===0?(ix(0),!1):!0}function lI(){if(Ur!==null){if(Cs===0)var m=Ur.return;else m=Ur,Ld=im=null,kR(m),b0=null,Yv=0,m=Ur;for(;m!==null;)q$(m.alternate,m),m=m.return;Ur=null}}function E0(m,b){var C=m.timeoutHandle;C!==-1&&(m.timeoutHandle=-1,Wge(C)),C=m.cancelPendingCommit,C!==null&&(m.cancelPendingCommit=null,C()),lI(),Bs=m,Ur=C=Od(m.current,null),ns=b,Cs=0,bl=null,mh=!1,S0=de(m,b),tI=!1,_0=Hl=nI=dm=gh=pi=0,Vo=rx=null,rI=!1,(b&8)!==0&&(b|=b&32);var N=m.entangledLanes;if(N!==0)for(m=m.entanglements,N&=b;0<N;){var L=31-Ht(N),K=1<<L;b|=m[L],N&=~K}return Hd=b,lr(),C}function dB(m,b){Lr=null,D.H=J_,b===Bv||b===U_?(b=A8(),Cs=3):b===k8?(b=A8(),Cs=4):Cs=b===N$?8:b!==null&&typeof b=="object"&&typeof b.then=="function"?6:1,bl=b,Ur===null&&(pi=1,rC(m,Wn(b,m.current)))}function fB(){var m=D.H;return D.H=J_,m===null?J_:m}function hB(){var m=D.A;return D.A=kge,m}function cI(){pi=4,mh||(ns&4194048)!==ns&&Wl.current!==null||(S0=!0),(gh&134217727)===0&&(dm&134217727)===0||Bs===null||vh(Bs,ns,Hl,!1)}function uI(m,b,C){var N=_s;_s|=2;var L=fB(),K=hB();(Bs!==m||ns!==b)&&(uC=null,E0(m,b)),b=!1;var ge=pi;e:do try{if(Cs!==0&&Ur!==null){var De=Ur,Xe=bl;switch(Cs){case 8:lI(),ge=6;break e;case 3:case 2:case 9:case 6:Wl.current===null&&(b=!0);var _t=Cs;if(Cs=0,bl=null,T0(m,De,Xe,_t),C&&S0){ge=0;break e}break;default:_t=Cs,Cs=0,bl=null,T0(m,De,Xe,_t)}}Age(),ge=pi;break}catch(Dt){dB(m,Dt)}while(!0);return b&&m.shellSuspendCounter++,Ld=im=null,_s=N,D.H=L,D.A=K,Ur===null&&(Bs=null,ns=0,lr()),ge}function Age(){for(;Ur!==null;)pB(Ur)}function Nge(m,b){var C=_s;_s|=2;var N=fB(),L=hB();Bs!==m||ns!==b?(uC=null,cC=fe()+500,E0(m,b)):S0=de(m,b);e:do try{if(Cs!==0&&Ur!==null){b=Ur;var K=bl;t:switch(Cs){case 1:Cs=0,bl=null,T0(m,b,K,1);break;case 2:case 9:if(E8(K)){Cs=0,bl=null,mB(b);break}b=function(){Cs!==2&&Cs!==9||Bs!==m||(Cs=7),Cu(m)},K.then(b,b);break e;case 3:Cs=7;break e;case 4:Cs=5;break e;case 7:E8(K)?(Cs=0,bl=null,mB(b)):(Cs=0,bl=null,T0(m,b,K,7));break;case 5:var ge=null;switch(Ur.tag){case 26:ge=Ur.memoizedState;case 5:case 27:var De=Ur;if(!ge||ZB(ge)){Cs=0,bl=null;var Xe=De.sibling;if(Xe!==null)Ur=Xe;else{var _t=De.return;_t!==null?(Ur=_t,fC(_t)):Ur=null}break t}}Cs=0,bl=null,T0(m,b,K,5);break;case 6:Cs=0,bl=null,T0(m,b,K,6);break;case 8:lI(),pi=6;break e;default:throw Error(r(462))}}Rge();break}catch(Dt){dB(m,Dt)}while(!0);return Ld=im=null,D.H=N,D.A=L,_s=C,Ur!==null?0:(Bs=null,ns=0,lr(),pi)}function Rge(){for(;Ur!==null&&!ye();)pB(Ur)}function pB(m){var b=z$(m.alternate,m,Hd);m.memoizedProps=m.pendingProps,b===null?fC(m):Ur=b}function mB(m){var b=m,C=b.alternate;switch(b.tag){case 15:case 0:b=O$(C,b,b.pendingProps,b.type,void 0,ns);break;case 11:b=O$(C,b,b.pendingProps,b.type.render,b.ref,ns);break;case 5:kR(b);default:q$(C,b),b=Ur=g8(b,Hd),b=z$(C,b,Hd)}m.memoizedProps=m.pendingProps,b===null?fC(m):Ur=b}function T0(m,b,C,N){Ld=im=null,kR(b),b0=null,Yv=0;var L=b.return;try{if(vge(m,L,b,C,ns)){pi=1,rC(m,Wn(C,m.current)),Ur=null;return}}catch(K){if(L!==null)throw Ur=L,K;pi=1,rC(m,Wn(C,m.current)),Ur=null;return}b.flags&32768?(us||N===1?m=!0:S0||(ns&536870912)!==0?m=!1:(mh=m=!0,(N===2||N===9||N===3||N===6)&&(N=Wl.current,N!==null&&N.tag===13&&(N.flags|=16384))),gB(b,m)):fC(b)}function fC(m){var b=m;do{if((b.flags&32768)!==0){gB(b,mh);return}m=b.return;var C=wge(b.alternate,b,Hd);if(C!==null){Ur=C;return}if(b=b.sibling,b!==null){Ur=b;return}Ur=b=m}while(b!==null);pi===0&&(pi=5)}function gB(m,b){do{var C=Sge(m.alternate,m);if(C!==null){C.flags&=32767,Ur=C;return}if(C=m.return,C!==null&&(C.flags|=32768,C.subtreeFlags=0,C.deletions=null),!b&&(m=m.sibling,m!==null)){Ur=m;return}Ur=m=C}while(m!==null);pi=6,Ur=null}function yB(m,b,C,N,L,K,ge,De,Xe){m.cancelPendingCommit=null;do hC();while(Ra!==0);if((_s&6)!==0)throw Error(r(327));if(b!==null){if(b===m.current)throw Error(r(177));if(K=b.lanes|b.childLanes,K|=Aa,we(m,C,K,ge,De,Xe),m===Bs&&(Ur=Bs=null,ns=0),C0=b,bh=m,k0=C,iI=K,aI=L,oB=N,(b.subtreeFlags&10256)!==0||(b.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,Pge(Be,function(){return SB(),null})):(m.callbackNode=null,m.callbackPriority=0),N=(b.flags&13878)!==0,(b.subtreeFlags&13878)!==0||N){N=D.T,D.T=null,L=z.p,z.p=2,ge=_s,_s|=4;try{_ge(m,b,C)}finally{_s=ge,z.p=L,D.T=N}}Ra=1,bB(),vB(),xB()}}function bB(){if(Ra===1){Ra=0;var m=bh,b=C0,C=(b.flags&13878)!==0;if((b.subtreeFlags&13878)!==0||C){C=D.T,D.T=null;var N=z.p;z.p=2;var L=_s;_s|=4;try{eB(b,m);var K=SI,ge=be(m.containerInfo),De=K.focusedElem,Xe=K.selectionRange;if(ge!==De&&De&&De.ownerDocument&&oe(De.ownerDocument.documentElement,De)){if(Xe!==null&&Oe(De)){var _t=Xe.start,Dt=Xe.end;if(Dt===void 0&&(Dt=_t),"selectionStart"in De)De.selectionStart=_t,De.selectionEnd=Math.min(Dt,De.value.length);else{var zt=De.ownerDocument||document,Tt=zt&&zt.defaultView||window;if(Tt.getSelection){var Rt=Tt.getSelection(),cr=De.textContent.length,Jn=Math.min(Xe.start,cr),Rs=Xe.end===void 0?Jn:Math.min(Xe.end,cr);!Rt.extend&&Jn>Rs&&(ge=Rs,Rs=Jn,Jn=ge);var gt=re(De,Jn),at=re(De,Rs);if(gt&&at&&(Rt.rangeCount!==1||Rt.anchorNode!==gt.node||Rt.anchorOffset!==gt.offset||Rt.focusNode!==at.node||Rt.focusOffset!==at.offset)){var St=zt.createRange();St.setStart(gt.node,gt.offset),Rt.removeAllRanges(),Jn>Rs?(Rt.addRange(St),Rt.extend(at.node,at.offset)):(St.setEnd(at.node,at.offset),Rt.addRange(St))}}}}for(zt=[],Rt=De;Rt=Rt.parentNode;)Rt.nodeType===1&&zt.push({element:Rt,left:Rt.scrollLeft,top:Rt.scrollTop});for(typeof De.focus=="function"&&De.focus(),De=0;De<zt.length;De++){var Lt=zt[De];Lt.element.scrollLeft=Lt.left,Lt.element.scrollTop=Lt.top}}kC=!!wI,SI=wI=null}finally{_s=L,z.p=N,D.T=C}}m.current=b,Ra=2}}function vB(){if(Ra===2){Ra=0;var m=bh,b=C0,C=(b.flags&8772)!==0;if((b.subtreeFlags&8772)!==0||C){C=D.T,D.T=null;var N=z.p;z.p=2;var L=_s;_s|=4;try{Z$(m,b.alternate,b)}finally{_s=L,z.p=N,D.T=C}}Ra=3}}function xB(){if(Ra===4||Ra===3){Ra=0,Ne();var m=bh,b=C0,C=k0,N=oB;(b.subtreeFlags&10256)!==0||(b.flags&10256)!==0?Ra=5:(Ra=0,C0=bh=null,wB(m,m.pendingLanes));var L=m.pendingLanes;if(L===0&&(yh=null),me(C),b=b.stateNode,$t&&typeof $t.onCommitFiberRoot=="function")try{$t.onCommitFiberRoot(Pt,b,void 0,(b.current.flags&128)===128)}catch{}if(N!==null){b=D.T,L=z.p,z.p=2,D.T=null;try{for(var K=m.onRecoverableError,ge=0;ge<N.length;ge++){var De=N[ge];K(De.value,{componentStack:De.stack})}}finally{D.T=b,z.p=L}}(k0&3)!==0&&hC(),Cu(m),L=m.pendingLanes,(C&4194090)!==0&&(L&42)!==0?m===oI?sx++:(sx=0,oI=m):sx=0,ix(0)}}function wB(m,b){(m.pooledCacheLanes&=b)===0&&(b=m.pooledCache,b!=null&&(m.pooledCache=null,Lv(b)))}function hC(m){return bB(),vB(),xB(),SB()}function SB(){if(Ra!==5)return!1;var m=bh,b=iI;iI=0;var C=me(k0),N=D.T,L=z.p;try{z.p=32>C?32:C,D.T=null,C=aI,aI=null;var K=bh,ge=k0;if(Ra=0,C0=bh=null,k0=0,(_s&6)!==0)throw Error(r(331));var De=_s;if(_s|=4,iB(K.current),nB(K,K.current,ge,C),_s=De,ix(0,!1),$t&&typeof $t.onPostCommitFiberRoot=="function")try{$t.onPostCommitFiberRoot(Pt,K)}catch{}return!0}finally{z.p=L,D.T=N,wB(m,b)}}function _B(m,b,C){b=Wn(C,b),b=$R(m.stateNode,b,2),m=lh(m,b,2),m!==null&&(tt(m,2),Cu(m))}function Os(m,b,C){if(m.tag===3)_B(m,m,C);else for(;b!==null;){if(b.tag===3){_B(b,m,C);break}else if(b.tag===1){var N=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(yh===null||!yh.has(N))){m=Wn(C,m),C=T$(2),N=lh(b,C,2),N!==null&&(A$(C,N,b,m),tt(N,2),Cu(N));break}}b=b.return}}function dI(m,b,C){var N=m.pingCache;if(N===null){N=m.pingCache=new Ege;var L=new Set;N.set(b,L)}else L=N.get(b),L===void 0&&(L=new Set,N.set(b,L));L.has(C)||(tI=!0,L.add(C),m=Ige.bind(null,m,b,C),b.then(m,m))}function Ige(m,b,C){var N=m.pingCache;N!==null&&N.delete(b),m.pingedLanes|=m.suspendedLanes&C,m.warmLanes&=~C,Bs===m&&(ns&C)===C&&(pi===4||pi===3&&(ns&62914560)===ns&&300>fe()-sI?(_s&2)===0&&E0(m,0):nI|=C,_0===ns&&(_0=0)),Cu(m)}function CB(m,b){b===0&&(b=W()),m=Ic(m,b),m!==null&&(tt(m,b),Cu(m))}function Mge(m){var b=m.memoizedState,C=0;b!==null&&(C=b.retryLane),CB(m,C)}function jge(m,b){var C=0;switch(m.tag){case 13:var N=m.stateNode,L=m.memoizedState;L!==null&&(C=L.retryLane);break;case 19:N=m.stateNode;break;case 22:N=m.stateNode._retryCache;break;default:throw Error(r(314))}N!==null&&N.delete(b),CB(m,C)}function Pge(m,b){return Ie(m,b)}var pC=null,A0=null,fI=!1,mC=!1,hI=!1,fm=0;function Cu(m){m!==A0&&m.next===null&&(A0===null?pC=A0=m:A0=A0.next=m),mC=!0,fI||(fI=!0,Dge())}function ix(m,b){if(!hI&&mC){hI=!0;do for(var C=!1,N=pC;N!==null;){if(m!==0){var L=N.pendingLanes;if(L===0)var K=0;else{var ge=N.suspendedLanes,De=N.pingedLanes;K=(1<<31-Ht(42|m)+1)-1,K&=L&~(ge&~De),K=K&201326741?K&201326741|1:K?K|2:0}K!==0&&(C=!0,AB(N,K))}else K=ns,K=Me(N,N===Bs?K:0,N.cancelPendingCommit!==null||N.timeoutHandle!==-1),(K&3)===0||de(N,K)||(C=!0,AB(N,K));N=N.next}while(C);hI=!1}}function Oge(){kB()}function kB(){mC=fI=!1;var m=0;fm!==0&&(Vge()&&(m=fm),fm=0);for(var b=fe(),C=null,N=pC;N!==null;){var L=N.next,K=EB(N,b);K===0?(N.next=null,C===null?pC=L:C.next=L,L===null&&(A0=C)):(C=N,(m!==0||(K&3)!==0)&&(mC=!0)),N=L}ix(m)}function EB(m,b){for(var C=m.suspendedLanes,N=m.pingedLanes,L=m.expirationTimes,K=m.pendingLanes&-62914561;0<K;){var ge=31-Ht(K),De=1<<ge,Xe=L[ge];Xe===-1?((De&C)===0||(De&N)!==0)&&(L[ge]=ht(De,b)):Xe<=b&&(m.expiredLanes|=De),K&=~De}if(b=Bs,C=ns,C=Me(m,m===b?C:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),N=m.callbackNode,C===0||m===b&&(Cs===2||Cs===9)||m.cancelPendingCommit!==null)return N!==null&&N!==null&&X(N),m.callbackNode=null,m.callbackPriority=0;if((C&3)===0||de(m,C)){if(b=C&-C,b===m.callbackPriority)return b;switch(N!==null&&X(N),me(C)){case 2:case 8:C=Pe;break;case 32:C=Be;break;case 268435456:C=ot;break;default:C=Be}return N=TB.bind(null,m),C=Ie(C,N),m.callbackPriority=b,m.callbackNode=C,b}return N!==null&&N!==null&&X(N),m.callbackPriority=2,m.callbackNode=null,2}function TB(m,b){if(Ra!==0&&Ra!==5)return m.callbackNode=null,m.callbackPriority=0,null;var C=m.callbackNode;if(hC()&&m.callbackNode!==C)return null;var N=ns;return N=Me(m,m===Bs?N:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),N===0?null:(cB(m,N,b),EB(m,fe()),m.callbackNode!=null&&m.callbackNode===C?TB.bind(null,m):null)}function AB(m,b){if(hC())return null;cB(m,b,!0)}function Dge(){Hge(function(){(_s&6)!==0?Ie(se,Oge):kB()})}function pI(){return fm===0&&(fm=et()),fm}function NB(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:Ed(""+m)}function RB(m,b){var C=b.ownerDocument.createElement("input");return C.name=b.name,C.value=b.value,m.id&&C.setAttribute("form",m.id),b.parentNode.insertBefore(C,b),m=new FormData(m),C.parentNode.removeChild(C),m}function Fge(m,b,C,N,L){if(b==="submit"&&C&&C.stateNode===L){var K=NB((L[$e]||null).action),ge=N.submitter;ge&&(b=(b=ge[$e]||null)?NB(b.formAction):ge.getAttribute("formAction"),b!==null&&(K=b,ge=null));var De=new Kg("action","action",null,N,L);m.push({event:De,listeners:[{instance:null,listener:function(){if(N.defaultPrevented){if(fm!==0){var Xe=ge?RB(L,ge):new FormData(L);PR(C,{pending:!0,data:Xe,method:L.method,action:K},null,Xe)}}else typeof K=="function"&&(De.preventDefault(),Xe=ge?RB(L,ge):new FormData(L),PR(C,{pending:!0,data:Xe,method:L.method,action:K},K,Xe))},currentTarget:L}]})}}for(var mI=0;mI<ln.length;mI++){var gI=ln[mI],Lge=gI.toLowerCase(),$ge=gI[0].toUpperCase()+gI.slice(1);Yt(Lge,"on"+$ge)}Yt(kt,"onAnimationEnd"),Yt(Mt,"onAnimationIteration"),Yt(jt,"onAnimationStart"),Yt("dblclick","onDoubleClick"),Yt("focusin","onFocus"),Yt("focusout","onBlur"),Yt(Ot,"onTransitionRun"),Yt(Xt,"onTransitionStart"),Yt(sn,"onTransitionCancel"),Yt(Kt,"onTransitionEnd"),gn("onMouseEnter",["mouseout","mouseover"]),gn("onMouseLeave",["mouseout","mouseover"]),gn("onPointerEnter",["pointerout","pointerover"]),gn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ax="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bge=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ax));function IB(m,b){b=(b&4)!==0;for(var C=0;C<m.length;C++){var N=m[C],L=N.event;N=N.listeners;e:{var K=void 0;if(b)for(var ge=N.length-1;0<=ge;ge--){var De=N[ge],Xe=De.instance,_t=De.currentTarget;if(De=De.listener,Xe!==K&&L.isPropagationStopped())break e;K=De,L.currentTarget=_t;try{K(L)}catch(Dt){nC(Dt)}L.currentTarget=null,K=Xe}else for(ge=0;ge<N.length;ge++){if(De=N[ge],Xe=De.instance,_t=De.currentTarget,De=De.listener,Xe!==K&&L.isPropagationStopped())break e;K=De,L.currentTarget=_t;try{K(L)}catch(Dt){nC(Dt)}L.currentTarget=null,K=Xe}}}}function qr(m,b){var C=b[wt];C===void 0&&(C=b[wt]=new Set);var N=m+"__bubble";C.has(N)||(MB(b,m,2,!1),C.add(N))}function yI(m,b,C){var N=0;b&&(N|=4),MB(C,m,N,b)}var gC="_reactListening"+Math.random().toString(36).slice(2);function bI(m){if(!m[gC]){m[gC]=!0,mn.forEach(function(C){C!=="selectionchange"&&(Bge.has(C)||yI(C,!1,m),yI(C,!0,m))});var b=m.nodeType===9?m:m.ownerDocument;b===null||b[gC]||(b[gC]=!0,yI("selectionchange",!1,b))}}function MB(m,b,C,N){switch(nz(b)){case 2:var L=h0e;break;case 8:L=p0e;break;default:L=MI}C=L.bind(null,b,C,m),L=void 0,!xv||b!=="touchstart"&&b!=="touchmove"&&b!=="wheel"||(L=!0),N?L!==void 0?m.addEventListener(b,C,{capture:!0,passive:L}):m.addEventListener(b,C,!0):L!==void 0?m.addEventListener(b,C,{passive:L}):m.addEventListener(b,C,!1)}function vI(m,b,C,N,L){var K=N;if((b&1)===0&&(b&2)===0&&N!==null)e:for(;;){if(N===null)return;var ge=N.tag;if(ge===3||ge===4){var De=N.stateNode.containerInfo;if(De===L)break;if(ge===4)for(ge=N.return;ge!==null;){var Xe=ge.tag;if((Xe===3||Xe===4)&&ge.stateNode.containerInfo===L)return;ge=ge.return}for(;De!==null;){if(ge=br(De),ge===null)return;if(Xe=ge.tag,Xe===5||Xe===6||Xe===26||Xe===27){N=K=ge;continue e}De=De.parentNode}}N=N.return}Xf(function(){var _t=K,Dt=Hg(C),zt=[];e:{var Tt=tn.get(m);if(Tt!==void 0){var Rt=Kg,cr=m;switch(m){case"keypress":if(eh(C)===0)break e;case"keydown":case"keyup":Rt=n0;break;case"focusin":cr="focus",Rt=th;break;case"focusout":cr="blur",Rt=th;break;case"beforeblur":case"afterblur":Rt=th;break;case"click":if(C.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=Xg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=k_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=Tv;break;case kt:case Mt:case jt:Rt=E_;break;case Kt:Rt=Av;break;case"scroll":case"scrollend":Rt=Yg;break;case"wheel":Rt=s0;break;case"copy":case"cut":case"paste":Rt=e0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=Ev;break;case"toggle":case"beforetoggle":Rt=N_}var Jn=(b&4)!==0,Rs=!Jn&&(m==="scroll"||m==="scrollend"),gt=Jn?Tt!==null?Tt+"Capture":null:Tt;Jn=[];for(var at=_t,St;at!==null;){var Lt=at;if(St=Lt.stateNode,Lt=Lt.tag,Lt!==5&&Lt!==26&&Lt!==27||St===null||gt===null||(Lt=Nd(at,gt),Lt!=null&&Jn.push(ox(at,Lt,St))),Rs)break;at=at.return}0<Jn.length&&(Tt=new Rt(Tt,cr,null,C,Dt),zt.push({event:Tt,listeners:Jn}))}}if((b&7)===0){e:{if(Tt=m==="mouseover"||m==="pointerover",Rt=m==="mouseout"||m==="pointerout",Tt&&C!==$l&&(cr=C.relatedTarget||C.fromElement)&&(br(cr)||cr[Ge]))break e;if((Rt||Tt)&&(Tt=Dt.window===Dt?Dt:(Tt=Dt.ownerDocument)?Tt.defaultView||Tt.parentWindow:window,Rt?(cr=C.relatedTarget||C.toElement,Rt=_t,cr=cr?br(cr):null,cr!==null&&(Rs=i(cr),Jn=cr.tag,cr!==Rs||Jn!==5&&Jn!==27&&Jn!==6)&&(cr=null)):(Rt=null,cr=_t),Rt!==cr)){if(Jn=Xg,Lt="onMouseLeave",gt="onMouseEnter",at="mouse",(m==="pointerout"||m==="pointerover")&&(Jn=Ev,Lt="onPointerLeave",gt="onPointerEnter",at="pointer"),Rs=Rt==null?Tt:Jr(Rt),St=cr==null?Tt:Jr(cr),Tt=new Jn(Lt,at+"leave",Rt,C,Dt),Tt.target=Rs,Tt.relatedTarget=St,Lt=null,br(Dt)===_t&&(Jn=new Jn(gt,at+"enter",cr,C,Dt),Jn.target=St,Jn.relatedTarget=Rs,Lt=Jn),Rs=Lt,Rt&&cr)t:{for(Jn=Rt,gt=cr,at=0,St=Jn;St;St=N0(St))at++;for(St=0,Lt=gt;Lt;Lt=N0(Lt))St++;for(;0<at-St;)Jn=N0(Jn),at--;for(;0<St-at;)gt=N0(gt),St--;for(;at--;){if(Jn===gt||gt!==null&&Jn===gt.alternate)break t;Jn=N0(Jn),gt=N0(gt)}Jn=null}else Jn=null;Rt!==null&&jB(zt,Tt,Rt,Jn,!1),cr!==null&&Rs!==null&&jB(zt,Rs,cr,Jn,!0)}}e:{if(Tt=_t?Jr(_t):window,Rt=Tt.nodeName&&Tt.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&Tt.type==="file")var Sn=Qp;else if(o0(Tt))if(zl)Sn=sh;else{Sn=Pd;var Br=O_}else Rt=Tt.nodeName,!Rt||Rt.toLowerCase()!=="input"||Tt.type!=="checkbox"&&Tt.type!=="radio"?_t&&vv(_t.elementType)&&(Sn=Qp):Sn=jv;if(Sn&&(Sn=Sn(m,_t))){Mv(zt,Sn,C,Dt);break e}Br&&Br(m,Tt,_t),m==="focusout"&&_t&&Tt.type==="number"&&_t.memoizedProps.value!=null&&Rc(Tt,"number",Tt.value)}switch(Br=_t?Jr(_t):window,m){case"focusin":(o0(Br)||Br.contentEditable==="true")&&(Ke=Br,it=_t,lt=null);break;case"focusout":lt=it=Ke=null;break;case"mousedown":mt=!0;break;case"contextmenu":case"mouseup":case"dragend":mt=!1,Qe(zt,C,Dt);break;case"selectionchange":if(ze)break;case"keydown":case"keyup":Qe(zt,C,Dt)}var Ln;if(Xp)e:{switch(m){case"compositionstart":var nr="onCompositionStart";break e;case"compositionend":nr="onCompositionEnd";break e;case"compositionupdate":nr="onCompositionUpdate";break e}nr=void 0}else jd?Iv(m,C)&&(nr="onCompositionEnd"):m==="keydown"&&C.keyCode===229&&(nr="onCompositionStart");nr&&(i0&&C.locale!=="ko"&&(jd||nr!=="onCompositionStart"?nr==="onCompositionEnd"&&jd&&(Ln=Qf()):(Bl=Dt,Gg="value"in Bl?Bl.value:Bl.textContent,jd=!0)),Br=yC(_t,nr),0<Br.length&&(nr=new t0(nr,m,null,C,Dt),zt.push({event:nr,listeners:Br}),Ln?nr.data=Ln:(Ln=I_(C),Ln!==null&&(nr.data=Ln)))),(Ln=QN?M_(m,C):eR(m,C))&&(nr=yC(_t,"onBeforeInput"),0<nr.length&&(Br=new t0("onBeforeInput","beforeinput",null,C,Dt),zt.push({event:Br,listeners:nr}),Br.data=Ln)),Fge(zt,m,_t,C,Dt)}IB(zt,b)})}function ox(m,b,C){return{instance:m,listener:b,currentTarget:C}}function yC(m,b){for(var C=b+"Capture",N=[];m!==null;){var L=m,K=L.stateNode;if(L=L.tag,L!==5&&L!==26&&L!==27||K===null||(L=Nd(m,C),L!=null&&N.unshift(ox(m,L,K)),L=Nd(m,b),L!=null&&N.push(ox(m,L,K))),m.tag===3)return N;m=m.return}return[]}function N0(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function jB(m,b,C,N,L){for(var K=b._reactName,ge=[];C!==null&&C!==N;){var De=C,Xe=De.alternate,_t=De.stateNode;if(De=De.tag,Xe!==null&&Xe===N)break;De!==5&&De!==26&&De!==27||_t===null||(Xe=_t,L?(_t=Nd(C,K),_t!=null&&ge.unshift(ox(C,_t,Xe))):L||(_t=Nd(C,K),_t!=null&&ge.push(ox(C,_t,Xe)))),C=C.return}ge.length!==0&&m.push({event:b,listeners:ge})}var zge=/\r\n?/g,Uge=/\u0000|\uFFFD/g;function PB(m){return(typeof m=="string"?m:""+m).replace(zge,`
`).replace(Uge,"")}function OB(m,b){return b=PB(b),PB(m)===b}function bC(){}function Ns(m,b,C,N,L,K){switch(C){case"children":typeof N=="string"?b==="body"||b==="textarea"&&N===""||Yf(m,N):(typeof N=="number"||typeof N=="bigint")&&b!=="body"&&Yf(m,""+N);break;case"className":Ea(m,"class",N);break;case"tabIndex":Ea(m,"tabindex",N);break;case"dir":case"role":case"viewBox":case"width":case"height":Ea(m,C,N);break;case"style":__(m,N,K);break;case"data":if(b!=="object"){Ea(m,"data",N);break}case"src":case"href":if(N===""&&(b!=="a"||C!=="href")){m.removeAttribute(C);break}if(N==null||typeof N=="function"||typeof N=="symbol"||typeof N=="boolean"){m.removeAttribute(C);break}N=Ed(""+N),m.setAttribute(C,N);break;case"action":case"formAction":if(typeof N=="function"){m.setAttribute(C,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof K=="function"&&(C==="formAction"?(b!=="input"&&Ns(m,b,"name",L.name,L,null),Ns(m,b,"formEncType",L.formEncType,L,null),Ns(m,b,"formMethod",L.formMethod,L,null),Ns(m,b,"formTarget",L.formTarget,L,null)):(Ns(m,b,"encType",L.encType,L,null),Ns(m,b,"method",L.method,L,null),Ns(m,b,"target",L.target,L,null)));if(N==null||typeof N=="symbol"||typeof N=="boolean"){m.removeAttribute(C);break}N=Ed(""+N),m.setAttribute(C,N);break;case"onClick":N!=null&&(m.onclick=bC);break;case"onScroll":N!=null&&qr("scroll",m);break;case"onScrollEnd":N!=null&&qr("scrollend",m);break;case"dangerouslySetInnerHTML":if(N!=null){if(typeof N!="object"||!("__html"in N))throw Error(r(61));if(C=N.__html,C!=null){if(L.children!=null)throw Error(r(60));m.innerHTML=C}}break;case"multiple":m.multiple=N&&typeof N!="function"&&typeof N!="symbol";break;case"muted":m.muted=N&&typeof N!="function"&&typeof N!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(N==null||typeof N=="function"||typeof N=="boolean"||typeof N=="symbol"){m.removeAttribute("xlink:href");break}C=Ed(""+N),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",C);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":N!=null&&typeof N!="function"&&typeof N!="symbol"?m.setAttribute(C,""+N):m.removeAttribute(C);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":N&&typeof N!="function"&&typeof N!="symbol"?m.setAttribute(C,""):m.removeAttribute(C);break;case"capture":case"download":N===!0?m.setAttribute(C,""):N!==!1&&N!=null&&typeof N!="function"&&typeof N!="symbol"?m.setAttribute(C,N):m.removeAttribute(C);break;case"cols":case"rows":case"size":case"span":N!=null&&typeof N!="function"&&typeof N!="symbol"&&!isNaN(N)&&1<=N?m.setAttribute(C,N):m.removeAttribute(C);break;case"rowSpan":case"start":N==null||typeof N=="function"||typeof N=="symbol"||isNaN(N)?m.removeAttribute(C):m.setAttribute(C,N);break;case"popover":qr("beforetoggle",m),qr("toggle",m),si(m,"popover",N);break;case"xlinkActuate":Zi(m,"http://www.w3.org/1999/xlink","xlink:actuate",N);break;case"xlinkArcrole":Zi(m,"http://www.w3.org/1999/xlink","xlink:arcrole",N);break;case"xlinkRole":Zi(m,"http://www.w3.org/1999/xlink","xlink:role",N);break;case"xlinkShow":Zi(m,"http://www.w3.org/1999/xlink","xlink:show",N);break;case"xlinkTitle":Zi(m,"http://www.w3.org/1999/xlink","xlink:title",N);break;case"xlinkType":Zi(m,"http://www.w3.org/1999/xlink","xlink:type",N);break;case"xmlBase":Zi(m,"http://www.w3.org/XML/1998/namespace","xml:base",N);break;case"xmlLang":Zi(m,"http://www.w3.org/XML/1998/namespace","xml:lang",N);break;case"xmlSpace":Zi(m,"http://www.w3.org/XML/1998/namespace","xml:space",N);break;case"is":si(m,"is",N);break;case"innerText":case"textContent":break;default:(!(2<C.length)||C[0]!=="o"&&C[0]!=="O"||C[1]!=="n"&&C[1]!=="N")&&(C=mo.get(C)||C,si(m,C,N))}}function xI(m,b,C,N,L,K){switch(C){case"style":__(m,N,K);break;case"dangerouslySetInnerHTML":if(N!=null){if(typeof N!="object"||!("__html"in N))throw Error(r(61));if(C=N.__html,C!=null){if(L.children!=null)throw Error(r(60));m.innerHTML=C}}break;case"children":typeof N=="string"?Yf(m,N):(typeof N=="number"||typeof N=="bigint")&&Yf(m,""+N);break;case"onScroll":N!=null&&qr("scroll",m);break;case"onScrollEnd":N!=null&&qr("scrollend",m);break;case"onClick":N!=null&&(m.onclick=bC);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nt.hasOwnProperty(C))e:{if(C[0]==="o"&&C[1]==="n"&&(L=C.endsWith("Capture"),b=C.slice(2,L?C.length-7:void 0),K=m[$e]||null,K=K!=null?K[C]:null,typeof K=="function"&&m.removeEventListener(b,K,L),typeof N=="function")){typeof K!="function"&&K!==null&&(C in m?m[C]=null:m.hasAttribute(C)&&m.removeAttribute(C)),m.addEventListener(b,N,L);break e}C in m?m[C]=N:N===!0?m.setAttribute(C,""):si(m,C,N)}}}function Ia(m,b,C){switch(b){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qr("error",m),qr("load",m);var N=!1,L=!1,K;for(K in C)if(C.hasOwnProperty(K)){var ge=C[K];if(ge!=null)switch(K){case"src":N=!0;break;case"srcSet":L=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,b));default:Ns(m,b,K,ge,C,null)}}L&&Ns(m,b,"srcSet",C.srcSet,C,null),N&&Ns(m,b,"src",C.src,C,null);return;case"input":qr("invalid",m);var De=K=ge=L=null,Xe=null,_t=null;for(N in C)if(C.hasOwnProperty(N)){var Dt=C[N];if(Dt!=null)switch(N){case"name":L=Dt;break;case"type":ge=Dt;break;case"checked":Xe=Dt;break;case"defaultChecked":_t=Dt;break;case"value":K=Dt;break;case"defaultValue":De=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,b));break;default:Ns(m,b,N,Dt,C,null)}}Hp(m,K,De,Xe,_t,ge,L,!1),po(m);return;case"select":qr("invalid",m),N=ge=K=null;for(L in C)if(C.hasOwnProperty(L)&&(De=C[L],De!=null))switch(L){case"value":K=De;break;case"defaultValue":ge=De;break;case"multiple":N=De;default:Ns(m,b,L,De,C,null)}b=K,C=ge,m.multiple=!!N,b!=null?kd(m,!!N,b,!1):C!=null&&kd(m,!!N,C,!0);return;case"textarea":qr("invalid",m),K=L=N=null;for(ge in C)if(C.hasOwnProperty(ge)&&(De=C[ge],De!=null))switch(ge){case"value":N=De;break;case"defaultValue":L=De;break;case"children":K=De;break;case"dangerouslySetInnerHTML":if(De!=null)throw Error(r(91));break;default:Ns(m,b,ge,De,C,null)}bv(m,N,L,K),po(m);return;case"option":for(Xe in C)if(C.hasOwnProperty(Xe)&&(N=C[Xe],N!=null))switch(Xe){case"selected":m.selected=N&&typeof N!="function"&&typeof N!="symbol";break;default:Ns(m,b,Xe,N,C,null)}return;case"dialog":qr("beforetoggle",m),qr("toggle",m),qr("cancel",m),qr("close",m);break;case"iframe":case"object":qr("load",m);break;case"video":case"audio":for(N=0;N<ax.length;N++)qr(ax[N],m);break;case"image":qr("error",m),qr("load",m);break;case"details":qr("toggle",m);break;case"embed":case"source":case"link":qr("error",m),qr("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_t in C)if(C.hasOwnProperty(_t)&&(N=C[_t],N!=null))switch(_t){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,b));default:Ns(m,b,_t,N,C,null)}return;default:if(vv(b)){for(Dt in C)C.hasOwnProperty(Dt)&&(N=C[Dt],N!==void 0&&xI(m,b,Dt,N,C,void 0));return}}for(De in C)C.hasOwnProperty(De)&&(N=C[De],N!=null&&Ns(m,b,De,N,C,null))}function qge(m,b,C,N){switch(b){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var L=null,K=null,ge=null,De=null,Xe=null,_t=null,Dt=null;for(Rt in C){var zt=C[Rt];if(C.hasOwnProperty(Rt)&&zt!=null)switch(Rt){case"checked":break;case"value":break;case"defaultValue":Xe=zt;default:N.hasOwnProperty(Rt)||Ns(m,b,Rt,null,N,zt)}}for(var Tt in N){var Rt=N[Tt];if(zt=C[Tt],N.hasOwnProperty(Tt)&&(Rt!=null||zt!=null))switch(Tt){case"type":K=Rt;break;case"name":L=Rt;break;case"checked":_t=Rt;break;case"defaultChecked":Dt=Rt;break;case"value":ge=Rt;break;case"defaultValue":De=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(r(137,b));break;default:Rt!==zt&&Ns(m,b,Tt,Rt,N,zt)}}mu(m,ge,De,Xe,_t,Dt,K,L);return;case"select":Rt=ge=De=Tt=null;for(K in C)if(Xe=C[K],C.hasOwnProperty(K)&&Xe!=null)switch(K){case"value":break;case"multiple":Rt=Xe;default:N.hasOwnProperty(K)||Ns(m,b,K,null,N,Xe)}for(L in N)if(K=N[L],Xe=C[L],N.hasOwnProperty(L)&&(K!=null||Xe!=null))switch(L){case"value":Tt=K;break;case"defaultValue":De=K;break;case"multiple":ge=K;default:K!==Xe&&Ns(m,b,L,K,N,Xe)}b=De,C=ge,N=Rt,Tt!=null?kd(m,!!C,Tt,!1):!!N!=!!C&&(b!=null?kd(m,!!C,b,!0):kd(m,!!C,C?[]:"",!1));return;case"textarea":Rt=Tt=null;for(De in C)if(L=C[De],C.hasOwnProperty(De)&&L!=null&&!N.hasOwnProperty(De))switch(De){case"value":break;case"children":break;default:Ns(m,b,De,null,N,L)}for(ge in N)if(L=N[ge],K=C[ge],N.hasOwnProperty(ge)&&(L!=null||K!=null))switch(ge){case"value":Tt=L;break;case"defaultValue":Rt=L;break;case"children":break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(r(91));break;default:L!==K&&Ns(m,b,ge,L,N,K)}Kf(m,Tt,Rt);return;case"option":for(var cr in C)if(Tt=C[cr],C.hasOwnProperty(cr)&&Tt!=null&&!N.hasOwnProperty(cr))switch(cr){case"selected":m.selected=!1;break;default:Ns(m,b,cr,null,N,Tt)}for(Xe in N)if(Tt=N[Xe],Rt=C[Xe],N.hasOwnProperty(Xe)&&Tt!==Rt&&(Tt!=null||Rt!=null))switch(Xe){case"selected":m.selected=Tt&&typeof Tt!="function"&&typeof Tt!="symbol";break;default:Ns(m,b,Xe,Tt,N,Rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jn in C)Tt=C[Jn],C.hasOwnProperty(Jn)&&Tt!=null&&!N.hasOwnProperty(Jn)&&Ns(m,b,Jn,null,N,Tt);for(_t in N)if(Tt=N[_t],Rt=C[_t],N.hasOwnProperty(_t)&&Tt!==Rt&&(Tt!=null||Rt!=null))switch(_t){case"children":case"dangerouslySetInnerHTML":if(Tt!=null)throw Error(r(137,b));break;default:Ns(m,b,_t,Tt,N,Rt)}return;default:if(vv(b)){for(var Rs in C)Tt=C[Rs],C.hasOwnProperty(Rs)&&Tt!==void 0&&!N.hasOwnProperty(Rs)&&xI(m,b,Rs,void 0,N,Tt);for(Dt in N)Tt=N[Dt],Rt=C[Dt],!N.hasOwnProperty(Dt)||Tt===Rt||Tt===void 0&&Rt===void 0||xI(m,b,Dt,Tt,N,Rt);return}}for(var gt in C)Tt=C[gt],C.hasOwnProperty(gt)&&Tt!=null&&!N.hasOwnProperty(gt)&&Ns(m,b,gt,null,N,Tt);for(zt in N)Tt=N[zt],Rt=C[zt],!N.hasOwnProperty(zt)||Tt===Rt||Tt==null&&Rt==null||Ns(m,b,zt,Tt,N,Rt)}var wI=null,SI=null;function vC(m){return m.nodeType===9?m:m.ownerDocument}function DB(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function FB(m,b){if(m===0)switch(b){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&b==="foreignObject"?0:m}function _I(m,b){return m==="textarea"||m==="noscript"||typeof b.children=="string"||typeof b.children=="number"||typeof b.children=="bigint"||typeof b.dangerouslySetInnerHTML=="object"&&b.dangerouslySetInnerHTML!==null&&b.dangerouslySetInnerHTML.__html!=null}var CI=null;function Vge(){var m=window.event;return m&&m.type==="popstate"?m===CI?!1:(CI=m,!0):(CI=null,!1)}var LB=typeof setTimeout=="function"?setTimeout:void 0,Wge=typeof clearTimeout=="function"?clearTimeout:void 0,$B=typeof Promise=="function"?Promise:void 0,Hge=typeof queueMicrotask=="function"?queueMicrotask:typeof $B<"u"?function(m){return $B.resolve(null).then(m).catch(Gge)}:LB;function Gge(m){setTimeout(function(){throw m})}function xh(m){return m==="head"}function BB(m,b){var C=b,N=0,L=0;do{var K=C.nextSibling;if(m.removeChild(C),K&&K.nodeType===8)if(C=K.data,C==="/$"){if(0<N&&8>N){C=N;var ge=m.ownerDocument;if(C&1&&lx(ge.documentElement),C&2&&lx(ge.body),C&4)for(C=ge.head,lx(C),ge=C.firstChild;ge;){var De=ge.nextSibling,Xe=ge.nodeName;ge[rn]||Xe==="SCRIPT"||Xe==="STYLE"||Xe==="LINK"&&ge.rel.toLowerCase()==="stylesheet"||C.removeChild(ge),ge=De}}if(L===0){m.removeChild(K),gx(b);return}L--}else C==="$"||C==="$?"||C==="$!"?L++:N=C.charCodeAt(0)-48;else N=0;C=K}while(C);gx(b)}function kI(m){var b=m.firstChild;for(b&&b.nodeType===10&&(b=b.nextSibling);b;){var C=b;switch(b=b.nextSibling,C.nodeName){case"HTML":case"HEAD":case"BODY":kI(C),dn(C);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(C.rel.toLowerCase()==="stylesheet")continue}m.removeChild(C)}}function Kge(m,b,C,N){for(;m.nodeType===1;){var L=C;if(m.nodeName.toLowerCase()!==b.toLowerCase()){if(!N&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(N){if(!m[rn])switch(b){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(K=m.getAttribute("rel"),K==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(K!==L.rel||m.getAttribute("href")!==(L.href==null||L.href===""?null:L.href)||m.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin)||m.getAttribute("title")!==(L.title==null?null:L.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(K=m.getAttribute("src"),(K!==(L.src==null?null:L.src)||m.getAttribute("type")!==(L.type==null?null:L.type)||m.getAttribute("crossorigin")!==(L.crossOrigin==null?null:L.crossOrigin))&&K&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(b==="input"&&m.type==="hidden"){var K=L.name==null?null:""+L.name;if(L.type==="hidden"&&m.getAttribute("name")===K)return m}else return m;if(m=jc(m.nextSibling),m===null)break}return null}function Yge(m,b,C){if(b==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!C||(m=jc(m.nextSibling),m===null))return null;return m}function EI(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState==="complete"}function Zge(m,b){var C=m.ownerDocument;if(m.data!=="$?"||C.readyState==="complete")b();else{var N=function(){b(),C.removeEventListener("DOMContentLoaded",N)};C.addEventListener("DOMContentLoaded",N),m._reactRetry=N}}function jc(m){for(;m!=null;m=m.nextSibling){var b=m.nodeType;if(b===1||b===3)break;if(b===8){if(b=m.data,b==="$"||b==="$!"||b==="$?"||b==="F!"||b==="F")break;if(b==="/$")return null}}return m}var TI=null;function zB(m){m=m.previousSibling;for(var b=0;m;){if(m.nodeType===8){var C=m.data;if(C==="$"||C==="$!"||C==="$?"){if(b===0)return m;b--}else C==="/$"&&b++}m=m.previousSibling}return null}function UB(m,b,C){switch(b=vC(C),m){case"html":if(m=b.documentElement,!m)throw Error(r(452));return m;case"head":if(m=b.head,!m)throw Error(r(453));return m;case"body":if(m=b.body,!m)throw Error(r(454));return m;default:throw Error(r(451))}}function lx(m){for(var b=m.attributes;b.length;)m.removeAttributeNode(b[0]);dn(m)}var Gl=new Map,qB=new Set;function xC(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var Gd=z.d;z.d={f:Xge,r:Jge,D:Qge,C:e0e,L:t0e,m:n0e,X:s0e,S:r0e,M:i0e};function Xge(){var m=Gd.f(),b=dC();return m||b}function Jge(m){var b=Cr(m);b!==null&&b.tag===5&&b.type==="form"?c$(b):Gd.r(m)}var R0=typeof document>"u"?null:document;function VB(m,b,C){var N=R0;if(N&&typeof b=="string"&&b){var L=Di(b);L='link[rel="'+m+'"][href="'+L+'"]',typeof C=="string"&&(L+='[crossorigin="'+C+'"]'),qB.has(L)||(qB.add(L),m={rel:m,crossOrigin:C,href:b},N.querySelector(L)===null&&(b=N.createElement("link"),Ia(b,"link",m),Sr(b),N.head.appendChild(b)))}}function Qge(m){Gd.D(m),VB("dns-prefetch",m,null)}function e0e(m,b){Gd.C(m,b),VB("preconnect",m,b)}function t0e(m,b,C){Gd.L(m,b,C);var N=R0;if(N&&m&&b){var L='link[rel="preload"][as="'+Di(b)+'"]';b==="image"&&C&&C.imageSrcSet?(L+='[imagesrcset="'+Di(C.imageSrcSet)+'"]',typeof C.imageSizes=="string"&&(L+='[imagesizes="'+Di(C.imageSizes)+'"]')):L+='[href="'+Di(m)+'"]';var K=L;switch(b){case"style":K=I0(m);break;case"script":K=M0(m)}Gl.has(K)||(m=u({rel:"preload",href:b==="image"&&C&&C.imageSrcSet?void 0:m,as:b},C),Gl.set(K,m),N.querySelector(L)!==null||b==="style"&&N.querySelector(cx(K))||b==="script"&&N.querySelector(ux(K))||(b=N.createElement("link"),Ia(b,"link",m),Sr(b),N.head.appendChild(b)))}}function n0e(m,b){Gd.m(m,b);var C=R0;if(C&&m){var N=b&&typeof b.as=="string"?b.as:"script",L='link[rel="modulepreload"][as="'+Di(N)+'"][href="'+Di(m)+'"]',K=L;switch(N){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":K=M0(m)}if(!Gl.has(K)&&(m=u({rel:"modulepreload",href:m},b),Gl.set(K,m),C.querySelector(L)===null)){switch(N){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(C.querySelector(ux(K)))return}N=C.createElement("link"),Ia(N,"link",m),Sr(N),C.head.appendChild(N)}}}function r0e(m,b,C){Gd.S(m,b,C);var N=R0;if(N&&m){var L=Qr(N).hoistableStyles,K=I0(m);b=b||"default";var ge=L.get(K);if(!ge){var De={loading:0,preload:null};if(ge=N.querySelector(cx(K)))De.loading=5;else{m=u({rel:"stylesheet",href:m,"data-precedence":b},C),(C=Gl.get(K))&&AI(m,C);var Xe=ge=N.createElement("link");Sr(Xe),Ia(Xe,"link",m),Xe._p=new Promise(function(_t,Dt){Xe.onload=_t,Xe.onerror=Dt}),Xe.addEventListener("load",function(){De.loading|=1}),Xe.addEventListener("error",function(){De.loading|=2}),De.loading|=4,wC(ge,b,N)}ge={type:"stylesheet",instance:ge,count:1,state:De},L.set(K,ge)}}}function s0e(m,b){Gd.X(m,b);var C=R0;if(C&&m){var N=Qr(C).hoistableScripts,L=M0(m),K=N.get(L);K||(K=C.querySelector(ux(L)),K||(m=u({src:m,async:!0},b),(b=Gl.get(L))&&NI(m,b),K=C.createElement("script"),Sr(K),Ia(K,"link",m),C.head.appendChild(K)),K={type:"script",instance:K,count:1,state:null},N.set(L,K))}}function i0e(m,b){Gd.M(m,b);var C=R0;if(C&&m){var N=Qr(C).hoistableScripts,L=M0(m),K=N.get(L);K||(K=C.querySelector(ux(L)),K||(m=u({src:m,async:!0,type:"module"},b),(b=Gl.get(L))&&NI(m,b),K=C.createElement("script"),Sr(K),Ia(K,"link",m),C.head.appendChild(K)),K={type:"script",instance:K,count:1,state:null},N.set(L,K))}}function WB(m,b,C,N){var L=(L=Se.current)?xC(L):null;if(!L)throw Error(r(446));switch(m){case"meta":case"title":return null;case"style":return typeof C.precedence=="string"&&typeof C.href=="string"?(b=I0(C.href),C=Qr(L).hoistableStyles,N=C.get(b),N||(N={type:"style",instance:null,count:0,state:null},C.set(b,N)),N):{type:"void",instance:null,count:0,state:null};case"link":if(C.rel==="stylesheet"&&typeof C.href=="string"&&typeof C.precedence=="string"){m=I0(C.href);var K=Qr(L).hoistableStyles,ge=K.get(m);if(ge||(L=L.ownerDocument||L,ge={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},K.set(m,ge),(K=L.querySelector(cx(m)))&&!K._p&&(ge.instance=K,ge.state.loading=5),Gl.has(m)||(C={rel:"preload",as:"style",href:C.href,crossOrigin:C.crossOrigin,integrity:C.integrity,media:C.media,hrefLang:C.hrefLang,referrerPolicy:C.referrerPolicy},Gl.set(m,C),K||a0e(L,m,C,ge.state))),b&&N===null)throw Error(r(528,""));return ge}if(b&&N!==null)throw Error(r(529,""));return null;case"script":return b=C.async,C=C.src,typeof C=="string"&&b&&typeof b!="function"&&typeof b!="symbol"?(b=M0(C),C=Qr(L).hoistableScripts,N=C.get(b),N||(N={type:"script",instance:null,count:0,state:null},C.set(b,N)),N):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,m))}}function I0(m){return'href="'+Di(m)+'"'}function cx(m){return'link[rel="stylesheet"]['+m+"]"}function HB(m){return u({},m,{"data-precedence":m.precedence,precedence:null})}function a0e(m,b,C,N){m.querySelector('link[rel="preload"][as="style"]['+b+"]")?N.loading=1:(b=m.createElement("link"),N.preload=b,b.addEventListener("load",function(){return N.loading|=1}),b.addEventListener("error",function(){return N.loading|=2}),Ia(b,"link",C),Sr(b),m.head.appendChild(b))}function M0(m){return'[src="'+Di(m)+'"]'}function ux(m){return"script[async]"+m}function GB(m,b,C){if(b.count++,b.instance===null)switch(b.type){case"style":var N=m.querySelector('style[data-href~="'+Di(C.href)+'"]');if(N)return b.instance=N,Sr(N),N;var L=u({},C,{"data-href":C.href,"data-precedence":C.precedence,href:null,precedence:null});return N=(m.ownerDocument||m).createElement("style"),Sr(N),Ia(N,"style",L),wC(N,C.precedence,m),b.instance=N;case"stylesheet":L=I0(C.href);var K=m.querySelector(cx(L));if(K)return b.state.loading|=4,b.instance=K,Sr(K),K;N=HB(C),(L=Gl.get(L))&&AI(N,L),K=(m.ownerDocument||m).createElement("link"),Sr(K);var ge=K;return ge._p=new Promise(function(De,Xe){ge.onload=De,ge.onerror=Xe}),Ia(K,"link",N),b.state.loading|=4,wC(K,C.precedence,m),b.instance=K;case"script":return K=M0(C.src),(L=m.querySelector(ux(K)))?(b.instance=L,Sr(L),L):(N=C,(L=Gl.get(K))&&(N=u({},C),NI(N,L)),m=m.ownerDocument||m,L=m.createElement("script"),Sr(L),Ia(L,"link",N),m.head.appendChild(L),b.instance=L);case"void":return null;default:throw Error(r(443,b.type))}else b.type==="stylesheet"&&(b.state.loading&4)===0&&(N=b.instance,b.state.loading|=4,wC(N,C.precedence,m));return b.instance}function wC(m,b,C){for(var N=C.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),L=N.length?N[N.length-1]:null,K=L,ge=0;ge<N.length;ge++){var De=N[ge];if(De.dataset.precedence===b)K=De;else if(K!==L)break}K?K.parentNode.insertBefore(m,K.nextSibling):(b=C.nodeType===9?C.head:C,b.insertBefore(m,b.firstChild))}function AI(m,b){m.crossOrigin==null&&(m.crossOrigin=b.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=b.referrerPolicy),m.title==null&&(m.title=b.title)}function NI(m,b){m.crossOrigin==null&&(m.crossOrigin=b.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=b.referrerPolicy),m.integrity==null&&(m.integrity=b.integrity)}var SC=null;function KB(m,b,C){if(SC===null){var N=new Map,L=SC=new Map;L.set(C,N)}else L=SC,N=L.get(C),N||(N=new Map,L.set(C,N));if(N.has(m))return N;for(N.set(m,null),C=C.getElementsByTagName(m),L=0;L<C.length;L++){var K=C[L];if(!(K[rn]||K[_e]||m==="link"&&K.getAttribute("rel")==="stylesheet")&&K.namespaceURI!=="http://www.w3.org/2000/svg"){var ge=K.getAttribute(b)||"";ge=m+ge;var De=N.get(ge);De?De.push(K):N.set(ge,[K])}}return N}function YB(m,b,C){m=m.ownerDocument||m,m.head.insertBefore(C,b==="title"?m.querySelector("head > title"):null)}function o0e(m,b,C){if(C===1||b.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof b.precedence!="string"||typeof b.href!="string"||b.href==="")break;return!0;case"link":if(typeof b.rel!="string"||typeof b.href!="string"||b.href===""||b.onLoad||b.onError)break;switch(b.rel){case"stylesheet":return m=b.disabled,typeof b.precedence=="string"&&m==null;default:return!0}case"script":if(b.async&&typeof b.async!="function"&&typeof b.async!="symbol"&&!b.onLoad&&!b.onError&&b.src&&typeof b.src=="string")return!0}return!1}function ZB(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}var dx=null;function l0e(){}function c0e(m,b,C){if(dx===null)throw Error(r(475));var N=dx;if(b.type==="stylesheet"&&(typeof C.media!="string"||matchMedia(C.media).matches!==!1)&&(b.state.loading&4)===0){if(b.instance===null){var L=I0(C.href),K=m.querySelector(cx(L));if(K){m=K._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(N.count++,N=_C.bind(N),m.then(N,N)),b.state.loading|=4,b.instance=K,Sr(K);return}K=m.ownerDocument||m,C=HB(C),(L=Gl.get(L))&&AI(C,L),K=K.createElement("link"),Sr(K);var ge=K;ge._p=new Promise(function(De,Xe){ge.onload=De,ge.onerror=Xe}),Ia(K,"link",C),b.instance=K}N.stylesheets===null&&(N.stylesheets=new Map),N.stylesheets.set(b,m),(m=b.state.preload)&&(b.state.loading&3)===0&&(N.count++,b=_C.bind(N),m.addEventListener("load",b),m.addEventListener("error",b))}}function u0e(){if(dx===null)throw Error(r(475));var m=dx;return m.stylesheets&&m.count===0&&RI(m,m.stylesheets),0<m.count?function(b){var C=setTimeout(function(){if(m.stylesheets&&RI(m,m.stylesheets),m.unsuspend){var N=m.unsuspend;m.unsuspend=null,N()}},6e4);return m.unsuspend=b,function(){m.unsuspend=null,clearTimeout(C)}}:null}function _C(){if(this.count--,this.count===0){if(this.stylesheets)RI(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var CC=null;function RI(m,b){m.stylesheets=null,m.unsuspend!==null&&(m.count++,CC=new Map,b.forEach(d0e,m),CC=null,_C.call(m))}function d0e(m,b){if(!(b.state.loading&4)){var C=CC.get(m);if(C)var N=C.get(null);else{C=new Map,CC.set(m,C);for(var L=m.querySelectorAll("link[data-precedence],style[data-precedence]"),K=0;K<L.length;K++){var ge=L[K];(ge.nodeName==="LINK"||ge.getAttribute("media")!=="not all")&&(C.set(ge.dataset.precedence,ge),N=ge)}N&&C.set(null,N)}L=b.instance,ge=L.getAttribute("data-precedence"),K=C.get(ge)||N,K===N&&C.set(null,L),C.set(ge,L),this.count++,N=_C.bind(this),L.addEventListener("load",N),L.addEventListener("error",N),K?K.parentNode.insertBefore(L,K.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(L,m.firstChild)),b.state.loading|=4}}var fx={$$typeof:S,Provider:null,Consumer:null,_currentValue:$,_currentValue2:$,_threadCount:0};function f0e(m,b,C,N,L,K,ge,De){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ve(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ve(0),this.hiddenUpdates=Ve(null),this.identifierPrefix=N,this.onUncaughtError=L,this.onCaughtError=K,this.onRecoverableError=ge,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=De,this.incompleteTransitions=new Map}function XB(m,b,C,N,L,K,ge,De,Xe,_t,Dt,zt){return m=new f0e(m,b,C,ge,De,Xe,_t,zt),b=1,K===!0&&(b|=24),K=ml(3,null,null,b),m.current=K,K.stateNode=m,b=dR(),b.refCount++,m.pooledCache=b,b.refCount++,K.memoizedState={element:N,isDehydrated:C,cache:b},mR(K),m}function JB(m){return m?(m=vu,m):vu}function QB(m,b,C,N,L,K){L=JB(L),N.context===null?N.context=L:N.pendingContext=L,N=oh(b),N.payload={element:C},K=K===void 0?null:K,K!==null&&(N.callback=K),C=lh(m,N,b),C!==null&&(xl(C,m,b),Uv(C,m,b))}function ez(m,b){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var C=m.retryLane;m.retryLane=C!==0&&C<b?C:b}}function II(m,b){ez(m,b),(m=m.alternate)&&ez(m,b)}function tz(m){if(m.tag===13){var b=Ic(m,67108864);b!==null&&xl(b,m,67108864),II(m,67108864)}}var kC=!0;function h0e(m,b,C,N){var L=D.T;D.T=null;var K=z.p;try{z.p=2,MI(m,b,C,N)}finally{z.p=K,D.T=L}}function p0e(m,b,C,N){var L=D.T;D.T=null;var K=z.p;try{z.p=8,MI(m,b,C,N)}finally{z.p=K,D.T=L}}function MI(m,b,C,N){if(kC){var L=jI(N);if(L===null)vI(m,b,N,EC,C),rz(m,N);else if(g0e(L,m,b,C,N))N.stopPropagation();else if(rz(m,N),b&4&&-1<m0e.indexOf(m)){for(;L!==null;){var K=Cr(L);if(K!==null)switch(K.tag){case 3:if(K=K.stateNode,K.current.memoizedState.isDehydrated){var ge=ve(K.pendingLanes);if(ge!==0){var De=K;for(De.pendingLanes|=2,De.entangledLanes|=2;ge;){var Xe=1<<31-Ht(ge);De.entanglements[1]|=Xe,ge&=~Xe}Cu(K),(_s&6)===0&&(cC=fe()+500,ix(0))}}break;case 13:De=Ic(K,2),De!==null&&xl(De,K,2),dC(),II(K,2)}if(K=jI(N),K===null&&vI(m,b,N,EC,C),K===L)break;L=K}L!==null&&N.stopPropagation()}else vI(m,b,N,null,C)}}function jI(m){return m=Hg(m),PI(m)}var EC=null;function PI(m){if(EC=null,m=br(m),m!==null){var b=i(m);if(b===null)m=null;else{var C=b.tag;if(C===13){if(m=a(b),m!==null)return m;m=null}else if(C===3){if(b.stateNode.current.memoizedState.isDehydrated)return b.tag===3?b.stateNode.containerInfo:null;m=null}else b!==m&&(m=null)}}return EC=m,null}function nz(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case se:return 2;case Pe:return 8;case Be:case je:return 32;case ot:return 268435456;default:return 32}default:return 32}}var OI=!1,wh=null,Sh=null,_h=null,hx=new Map,px=new Map,Ch=[],m0e="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rz(m,b){switch(m){case"focusin":case"focusout":wh=null;break;case"dragenter":case"dragleave":Sh=null;break;case"mouseover":case"mouseout":_h=null;break;case"pointerover":case"pointerout":hx.delete(b.pointerId);break;case"gotpointercapture":case"lostpointercapture":px.delete(b.pointerId)}}function mx(m,b,C,N,L,K){return m===null||m.nativeEvent!==K?(m={blockedOn:b,domEventName:C,eventSystemFlags:N,nativeEvent:K,targetContainers:[L]},b!==null&&(b=Cr(b),b!==null&&tz(b)),m):(m.eventSystemFlags|=N,b=m.targetContainers,L!==null&&b.indexOf(L)===-1&&b.push(L),m)}function g0e(m,b,C,N,L){switch(b){case"focusin":return wh=mx(wh,m,b,C,N,L),!0;case"dragenter":return Sh=mx(Sh,m,b,C,N,L),!0;case"mouseover":return _h=mx(_h,m,b,C,N,L),!0;case"pointerover":var K=L.pointerId;return hx.set(K,mx(hx.get(K)||null,m,b,C,N,L)),!0;case"gotpointercapture":return K=L.pointerId,px.set(K,mx(px.get(K)||null,m,b,C,N,L)),!0}return!1}function sz(m){var b=br(m.target);if(b!==null){var C=i(b);if(C!==null){if(b=C.tag,b===13){if(b=a(C),b!==null){m.blockedOn=b,J(m.priority,function(){if(C.tag===13){var N=vl();N=Ct(N);var L=Ic(C,N);L!==null&&xl(L,C,N),II(C,N)}});return}}else if(b===3&&C.stateNode.current.memoizedState.isDehydrated){m.blockedOn=C.tag===3?C.stateNode.containerInfo:null;return}}}m.blockedOn=null}function TC(m){if(m.blockedOn!==null)return!1;for(var b=m.targetContainers;0<b.length;){var C=jI(m.nativeEvent);if(C===null){C=m.nativeEvent;var N=new C.constructor(C.type,C);$l=N,C.target.dispatchEvent(N),$l=null}else return b=Cr(C),b!==null&&tz(b),m.blockedOn=C,!1;b.shift()}return!0}function iz(m,b,C){TC(m)&&C.delete(b)}function y0e(){OI=!1,wh!==null&&TC(wh)&&(wh=null),Sh!==null&&TC(Sh)&&(Sh=null),_h!==null&&TC(_h)&&(_h=null),hx.forEach(iz),px.forEach(iz)}function AC(m,b){m.blockedOn===b&&(m.blockedOn=null,OI||(OI=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,y0e)))}var NC=null;function az(m){NC!==m&&(NC=m,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){NC===m&&(NC=null);for(var b=0;b<m.length;b+=3){var C=m[b],N=m[b+1],L=m[b+2];if(typeof N!="function"){if(PI(N||C)===null)continue;break}var K=Cr(C);K!==null&&(m.splice(b,3),b-=3,PR(K,{pending:!0,data:L,method:C.method,action:N},N,L))}}))}function gx(m){function b(Xe){return AC(Xe,m)}wh!==null&&AC(wh,m),Sh!==null&&AC(Sh,m),_h!==null&&AC(_h,m),hx.forEach(b),px.forEach(b);for(var C=0;C<Ch.length;C++){var N=Ch[C];N.blockedOn===m&&(N.blockedOn=null)}for(;0<Ch.length&&(C=Ch[0],C.blockedOn===null);)sz(C),C.blockedOn===null&&Ch.shift();if(C=(m.ownerDocument||m).$$reactFormReplay,C!=null)for(N=0;N<C.length;N+=3){var L=C[N],K=C[N+1],ge=L[$e]||null;if(typeof K=="function")ge||az(C);else if(ge){var De=null;if(K&&K.hasAttribute("formAction")){if(L=K,ge=K[$e]||null)De=ge.formAction;else if(PI(L)!==null)continue}else De=ge.action;typeof De=="function"?C[N+1]=De:(C.splice(N,3),N-=3),az(C)}}}function DI(m){this._internalRoot=m}RC.prototype.render=DI.prototype.render=function(m){var b=this._internalRoot;if(b===null)throw Error(r(409));var C=b.current,N=vl();QB(C,N,m,b,null,null)},RC.prototype.unmount=DI.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var b=m.containerInfo;QB(m.current,2,null,m,null,null),dC(),b[Ge]=null}};function RC(m){this._internalRoot=m}RC.prototype.unstable_scheduleHydration=function(m){if(m){var b=Q();m={blockedOn:null,target:m,priority:b};for(var C=0;C<Ch.length&&b!==0&&b<Ch[C].priority;C++);Ch.splice(C,0,m),C===0&&sz(m)}};var oz=t.version;if(oz!=="19.1.0")throw Error(r(527,oz,"19.1.0"));z.findDOMNode=function(m){var b=m._reactInternals;if(b===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=l(b),m=m!==null?c(m):null,m=m===null?null:m.stateNode,m};var b0e={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var IC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!IC.isDisabled&&IC.supportsFiber)try{Pt=IC.inject(b0e),$t=IC}catch{}}return bx.createRoot=function(m,b){if(!s(m))throw Error(r(299));var C=!1,N="",L=_$,K=C$,ge=k$,De=null;return b!=null&&(b.unstable_strictMode===!0&&(C=!0),b.identifierPrefix!==void 0&&(N=b.identifierPrefix),b.onUncaughtError!==void 0&&(L=b.onUncaughtError),b.onCaughtError!==void 0&&(K=b.onCaughtError),b.onRecoverableError!==void 0&&(ge=b.onRecoverableError),b.unstable_transitionCallbacks!==void 0&&(De=b.unstable_transitionCallbacks)),b=XB(m,1,!1,null,null,C,N,L,K,ge,De,null),m[Ge]=b.current,bI(m),new DI(b)},bx.hydrateRoot=function(m,b,C){if(!s(m))throw Error(r(299));var N=!1,L="",K=_$,ge=C$,De=k$,Xe=null,_t=null;return C!=null&&(C.unstable_strictMode===!0&&(N=!0),C.identifierPrefix!==void 0&&(L=C.identifierPrefix),C.onUncaughtError!==void 0&&(K=C.onUncaughtError),C.onCaughtError!==void 0&&(ge=C.onCaughtError),C.onRecoverableError!==void 0&&(De=C.onRecoverableError),C.unstable_transitionCallbacks!==void 0&&(Xe=C.unstable_transitionCallbacks),C.formState!==void 0&&(_t=C.formState)),b=XB(m,1,!0,b,C??null,N,L,K,ge,De,Xe,_t),b.context=JB(null),C=b.current,N=vl(),N=Ct(N),L=oh(N),L.callback=null,lh(C,L,N),C=N,b.current.lanes=C,tt(b,C),Cu(b),m[Ge]=b.current,bI(m),new RC(b)},bx.version="19.1.0",bx}var yz;function P0e(){if(yz)return $I.exports;yz=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),$I.exports=j0e(),$I.exports}var O0e=P0e();const D0e=la(O0e);function bz(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function jl(...e){return t=>{let n=!1;const r=e.map(s=>{const i=bz(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():bz(e[s],null)}}}}function Tn(...e){return E.useCallback(jl(...e),e)}function rd(e){const t=F0e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find($0e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var WK=rd("Slot");function F0e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=z0e(s),o=B0e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?jl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var L0e=Symbol("radix.slottable");function $0e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===L0e}function B0e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function z0e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function HK(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=HK(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function GK(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=HK(e))&&(r&&(r+=" "),r+=t);return r}const vz=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,xz=GK,TD=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return xz(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=vz(u)||vz(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...p}=u;return Object.entries(p).every(g=>{let[y,v]=g;return Array.isArray(v)?v.includes({...i,...o}[y]):{...i,...o}[y]===v})?[...c,d,h]:c},[]);return xz(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},AD="-",U0e=e=>{const t=V0e(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(AD);return o[0]===""&&o.length!==1&&o.shift(),KK(o,t)||q0e(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},KK=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?KK(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(AD);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},wz=/^\[(.+)\]$/,q0e=e=>{if(wz.test(e)){const t=wz.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},V0e=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)AP(n[s],r,s,t);return r},AP=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:Sz(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(W0e(s)){AP(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{AP(a,Sz(t,i),n,r)})})},Sz=(e,t)=>{let n=e;return t.split(AD).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},W0e=e=>e.isThemeGetter,H0e=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},NP="!",RP=":",G0e=RP.length,K0e=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let g=0;g<s.length;g++){let y=s[g];if(a===0&&o===0){if(y===RP){i.push(s.slice(l,g)),l=g+G0e;continue}if(y==="/"){c=g;continue}}y==="["?a++:y==="]"?a--:y==="("?o++:y===")"&&o--}const u=i.length===0?s:s.substring(l),d=Y0e(u),h=d!==u,p=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:p}};if(t){const s=t+RP,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},Y0e=e=>e.endsWith(NP)?e.substring(0,e.length-1):e.startsWith(NP)?e.substring(1):e,Z0e=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},X0e=e=>({cache:H0e(e.cacheSize),parseClassName:K0e(e),sortModifiers:Z0e(e),...U0e(e)}),J0e=/\s+/,Q0e=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(J0e);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:y}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!y,x=r(v?g.substring(0,y):g);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(g),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),S=p?w+NP:w,_=S+x;if(a.includes(_))continue;a.push(_);const k=s(x,v);for(let T=0;T<k.length;++T){const A=k[T];a.push(S+A)}l=u+(l.length>0?" "+l:l)}return l};function eye(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=YK(t))&&(r&&(r+=" "),r+=n);return r}const YK=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=YK(e[r]))&&(n&&(n+=" "),n+=t);return n};function tye(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=X0e(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Q0e(l,n);return s(l,u),u}return function(){return i(eye.apply(null,arguments))}}const Qi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},ZK=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,XK=/^\((?:(\w[\w-]*):)?(.+)\)$/i,nye=/^\d+\/\d+$/,rye=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sye=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iye=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,aye=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oye=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,j0=e=>nye.test(e),$r=e=>!!e&&!Number.isNaN(Number(e)),Eh=e=>!!e&&Number.isInteger(Number(e)),qI=e=>e.endsWith("%")&&$r(e.slice(0,-1)),Kd=e=>rye.test(e),lye=()=>!0,cye=e=>sye.test(e)&&!iye.test(e),JK=()=>!1,uye=e=>aye.test(e),dye=e=>oye.test(e),fye=e=>!_n(e)&&!Cn(e),hye=e=>Mb(e,tY,JK),_n=e=>ZK.test(e),hm=e=>Mb(e,nY,cye),VI=e=>Mb(e,bye,$r),_z=e=>Mb(e,QK,JK),pye=e=>Mb(e,eY,dye),MC=e=>Mb(e,rY,uye),Cn=e=>XK.test(e),vx=e=>jb(e,nY),mye=e=>jb(e,vye),Cz=e=>jb(e,QK),gye=e=>jb(e,tY),yye=e=>jb(e,eY),jC=e=>jb(e,rY,!0),Mb=(e,t,n)=>{const r=ZK.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},jb=(e,t,n=!1)=>{const r=XK.exec(e);return r?r[1]?t(r[1]):n:!1},QK=e=>e==="position"||e==="percentage",eY=e=>e==="image"||e==="url",tY=e=>e==="length"||e==="size"||e==="bg-size",nY=e=>e==="length",bye=e=>e==="number",vye=e=>e==="family-name",rY=e=>e==="shadow",xye=()=>{const e=Qi("color"),t=Qi("font"),n=Qi("text"),r=Qi("font-weight"),s=Qi("tracking"),i=Qi("leading"),a=Qi("breakpoint"),o=Qi("container"),l=Qi("spacing"),c=Qi("radius"),u=Qi("shadow"),d=Qi("inset-shadow"),h=Qi("text-shadow"),p=Qi("drop-shadow"),g=Qi("blur"),y=Qi("perspective"),v=Qi("aspect"),x=Qi("ease"),w=Qi("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],k=()=>[..._(),Cn,_n],T=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],R=()=>[Cn,_n,l],M=()=>[j0,"full","auto",...R()],j=()=>[Eh,"none","subgrid",Cn,_n],F=()=>["auto",{span:["full",Eh,Cn,_n]},Eh,Cn,_n],P=()=>[Eh,"auto",Cn,_n],q=()=>["auto","min","max","fr",Cn,_n],I=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],V=()=>["start","end","center","stretch","center-safe","end-safe"],D=()=>["auto",...R()],z=()=>[j0,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...R()],$=()=>[e,Cn,_n],Y=()=>[..._(),Cz,_z,{position:[Cn,_n]}],B=()=>["no-repeat",{repeat:["","x","y","space","round"]}],G=()=>["auto","cover","contain",gye,hye,{size:[Cn,_n]}],Z=()=>[qI,vx,hm],ne=()=>["","none","full",c,Cn,_n],ae=()=>["",$r,vx,hm],le=()=>["solid","dashed","dotted","double"],Se=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ee=()=>[$r,qI,Cz,_z],he=()=>["","none",g,Cn,_n],pe=()=>["none",$r,Cn,_n],Le=()=>["none",$r,Cn,_n],He=()=>[$r,Cn,_n],Fe=()=>[j0,"full",...R()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Kd],breakpoint:[Kd],color:[lye],container:[Kd],"drop-shadow":[Kd],ease:["in","out","in-out"],font:[fye],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Kd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Kd],shadow:[Kd],spacing:["px",$r],text:[Kd],"text-shadow":[Kd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",j0,_n,Cn,v]}],container:["container"],columns:[{columns:[$r,_n,Cn,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:k()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:M()}],"inset-x":[{"inset-x":M()}],"inset-y":[{"inset-y":M()}],start:[{start:M()}],end:[{end:M()}],top:[{top:M()}],right:[{right:M()}],bottom:[{bottom:M()}],left:[{left:M()}],visibility:["visible","invisible","collapse"],z:[{z:[Eh,"auto",Cn,_n]}],basis:[{basis:[j0,"full","auto",o,...R()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[$r,j0,"auto","initial","none",_n]}],grow:[{grow:["",$r,Cn,_n]}],shrink:[{shrink:["",$r,Cn,_n]}],order:[{order:[Eh,"first","last","none",Cn,_n]}],"grid-cols":[{"grid-cols":j()}],"col-start-end":[{col:F()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":j()}],"row-start-end":[{row:F()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":q()}],"auto-rows":[{"auto-rows":q()}],gap:[{gap:R()}],"gap-x":[{"gap-x":R()}],"gap-y":[{"gap-y":R()}],"justify-content":[{justify:[...I(),"normal"]}],"justify-items":[{"justify-items":[...V(),"normal"]}],"justify-self":[{"justify-self":["auto",...V()]}],"align-content":[{content:["normal",...I()]}],"align-items":[{items:[...V(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...V(),{baseline:["","last"]}]}],"place-content":[{"place-content":I()}],"place-items":[{"place-items":[...V(),"baseline"]}],"place-self":[{"place-self":["auto",...V()]}],p:[{p:R()}],px:[{px:R()}],py:[{py:R()}],ps:[{ps:R()}],pe:[{pe:R()}],pt:[{pt:R()}],pr:[{pr:R()}],pb:[{pb:R()}],pl:[{pl:R()}],m:[{m:D()}],mx:[{mx:D()}],my:[{my:D()}],ms:[{ms:D()}],me:[{me:D()}],mt:[{mt:D()}],mr:[{mr:D()}],mb:[{mb:D()}],ml:[{ml:D()}],"space-x":[{"space-x":R()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":R()}],"space-y-reverse":["space-y-reverse"],size:[{size:z()}],w:[{w:[o,"screen",...z()]}],"min-w":[{"min-w":[o,"screen","none",...z()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...z()]}],h:[{h:["screen",...z()]}],"min-h":[{"min-h":["screen","none",...z()]}],"max-h":[{"max-h":["screen",...z()]}],"font-size":[{text:["base",n,vx,hm]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Cn,VI]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",qI,_n]}],"font-family":[{font:[mye,_n,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,Cn,_n]}],"line-clamp":[{"line-clamp":[$r,"none",Cn,VI]}],leading:[{leading:[i,...R()]}],"list-image":[{"list-image":["none",Cn,_n]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Cn,_n]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:$()}],"text-color":[{text:$()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...le(),"wavy"]}],"text-decoration-thickness":[{decoration:[$r,"from-font","auto",Cn,hm]}],"text-decoration-color":[{decoration:$()}],"underline-offset":[{"underline-offset":[$r,"auto",Cn,_n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:R()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Cn,_n]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Cn,_n]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Y()}],"bg-repeat":[{bg:B()}],"bg-size":[{bg:G()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Eh,Cn,_n],radial:["",Cn,_n],conic:[Eh,Cn,_n]},yye,pye]}],"bg-color":[{bg:$()}],"gradient-from-pos":[{from:Z()}],"gradient-via-pos":[{via:Z()}],"gradient-to-pos":[{to:Z()}],"gradient-from":[{from:$()}],"gradient-via":[{via:$()}],"gradient-to":[{to:$()}],rounded:[{rounded:ne()}],"rounded-s":[{"rounded-s":ne()}],"rounded-e":[{"rounded-e":ne()}],"rounded-t":[{"rounded-t":ne()}],"rounded-r":[{"rounded-r":ne()}],"rounded-b":[{"rounded-b":ne()}],"rounded-l":[{"rounded-l":ne()}],"rounded-ss":[{"rounded-ss":ne()}],"rounded-se":[{"rounded-se":ne()}],"rounded-ee":[{"rounded-ee":ne()}],"rounded-es":[{"rounded-es":ne()}],"rounded-tl":[{"rounded-tl":ne()}],"rounded-tr":[{"rounded-tr":ne()}],"rounded-br":[{"rounded-br":ne()}],"rounded-bl":[{"rounded-bl":ne()}],"border-w":[{border:ae()}],"border-w-x":[{"border-x":ae()}],"border-w-y":[{"border-y":ae()}],"border-w-s":[{"border-s":ae()}],"border-w-e":[{"border-e":ae()}],"border-w-t":[{"border-t":ae()}],"border-w-r":[{"border-r":ae()}],"border-w-b":[{"border-b":ae()}],"border-w-l":[{"border-l":ae()}],"divide-x":[{"divide-x":ae()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ae()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...le(),"hidden","none"]}],"divide-style":[{divide:[...le(),"hidden","none"]}],"border-color":[{border:$()}],"border-color-x":[{"border-x":$()}],"border-color-y":[{"border-y":$()}],"border-color-s":[{"border-s":$()}],"border-color-e":[{"border-e":$()}],"border-color-t":[{"border-t":$()}],"border-color-r":[{"border-r":$()}],"border-color-b":[{"border-b":$()}],"border-color-l":[{"border-l":$()}],"divide-color":[{divide:$()}],"outline-style":[{outline:[...le(),"none","hidden"]}],"outline-offset":[{"outline-offset":[$r,Cn,_n]}],"outline-w":[{outline:["",$r,vx,hm]}],"outline-color":[{outline:$()}],shadow:[{shadow:["","none",u,jC,MC]}],"shadow-color":[{shadow:$()}],"inset-shadow":[{"inset-shadow":["none",d,jC,MC]}],"inset-shadow-color":[{"inset-shadow":$()}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:$()}],"ring-offset-w":[{"ring-offset":[$r,hm]}],"ring-offset-color":[{"ring-offset":$()}],"inset-ring-w":[{"inset-ring":ae()}],"inset-ring-color":[{"inset-ring":$()}],"text-shadow":[{"text-shadow":["none",h,jC,MC]}],"text-shadow-color":[{"text-shadow":$()}],opacity:[{opacity:[$r,Cn,_n]}],"mix-blend":[{"mix-blend":[...Se(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Se()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[$r]}],"mask-image-linear-from-pos":[{"mask-linear-from":Ee()}],"mask-image-linear-to-pos":[{"mask-linear-to":Ee()}],"mask-image-linear-from-color":[{"mask-linear-from":$()}],"mask-image-linear-to-color":[{"mask-linear-to":$()}],"mask-image-t-from-pos":[{"mask-t-from":Ee()}],"mask-image-t-to-pos":[{"mask-t-to":Ee()}],"mask-image-t-from-color":[{"mask-t-from":$()}],"mask-image-t-to-color":[{"mask-t-to":$()}],"mask-image-r-from-pos":[{"mask-r-from":Ee()}],"mask-image-r-to-pos":[{"mask-r-to":Ee()}],"mask-image-r-from-color":[{"mask-r-from":$()}],"mask-image-r-to-color":[{"mask-r-to":$()}],"mask-image-b-from-pos":[{"mask-b-from":Ee()}],"mask-image-b-to-pos":[{"mask-b-to":Ee()}],"mask-image-b-from-color":[{"mask-b-from":$()}],"mask-image-b-to-color":[{"mask-b-to":$()}],"mask-image-l-from-pos":[{"mask-l-from":Ee()}],"mask-image-l-to-pos":[{"mask-l-to":Ee()}],"mask-image-l-from-color":[{"mask-l-from":$()}],"mask-image-l-to-color":[{"mask-l-to":$()}],"mask-image-x-from-pos":[{"mask-x-from":Ee()}],"mask-image-x-to-pos":[{"mask-x-to":Ee()}],"mask-image-x-from-color":[{"mask-x-from":$()}],"mask-image-x-to-color":[{"mask-x-to":$()}],"mask-image-y-from-pos":[{"mask-y-from":Ee()}],"mask-image-y-to-pos":[{"mask-y-to":Ee()}],"mask-image-y-from-color":[{"mask-y-from":$()}],"mask-image-y-to-color":[{"mask-y-to":$()}],"mask-image-radial":[{"mask-radial":[Cn,_n]}],"mask-image-radial-from-pos":[{"mask-radial-from":Ee()}],"mask-image-radial-to-pos":[{"mask-radial-to":Ee()}],"mask-image-radial-from-color":[{"mask-radial-from":$()}],"mask-image-radial-to-color":[{"mask-radial-to":$()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":_()}],"mask-image-conic-pos":[{"mask-conic":[$r]}],"mask-image-conic-from-pos":[{"mask-conic-from":Ee()}],"mask-image-conic-to-pos":[{"mask-conic-to":Ee()}],"mask-image-conic-from-color":[{"mask-conic-from":$()}],"mask-image-conic-to-color":[{"mask-conic-to":$()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Y()}],"mask-repeat":[{mask:B()}],"mask-size":[{mask:G()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Cn,_n]}],filter:[{filter:["","none",Cn,_n]}],blur:[{blur:he()}],brightness:[{brightness:[$r,Cn,_n]}],contrast:[{contrast:[$r,Cn,_n]}],"drop-shadow":[{"drop-shadow":["","none",p,jC,MC]}],"drop-shadow-color":[{"drop-shadow":$()}],grayscale:[{grayscale:["",$r,Cn,_n]}],"hue-rotate":[{"hue-rotate":[$r,Cn,_n]}],invert:[{invert:["",$r,Cn,_n]}],saturate:[{saturate:[$r,Cn,_n]}],sepia:[{sepia:["",$r,Cn,_n]}],"backdrop-filter":[{"backdrop-filter":["","none",Cn,_n]}],"backdrop-blur":[{"backdrop-blur":he()}],"backdrop-brightness":[{"backdrop-brightness":[$r,Cn,_n]}],"backdrop-contrast":[{"backdrop-contrast":[$r,Cn,_n]}],"backdrop-grayscale":[{"backdrop-grayscale":["",$r,Cn,_n]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[$r,Cn,_n]}],"backdrop-invert":[{"backdrop-invert":["",$r,Cn,_n]}],"backdrop-opacity":[{"backdrop-opacity":[$r,Cn,_n]}],"backdrop-saturate":[{"backdrop-saturate":[$r,Cn,_n]}],"backdrop-sepia":[{"backdrop-sepia":["",$r,Cn,_n]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":R()}],"border-spacing-x":[{"border-spacing-x":R()}],"border-spacing-y":[{"border-spacing-y":R()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Cn,_n]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[$r,"initial",Cn,_n]}],ease:[{ease:["linear","initial",x,Cn,_n]}],delay:[{delay:[$r,Cn,_n]}],animate:[{animate:["none",w,Cn,_n]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,Cn,_n]}],"perspective-origin":[{"perspective-origin":k()}],rotate:[{rotate:pe()}],"rotate-x":[{"rotate-x":pe()}],"rotate-y":[{"rotate-y":pe()}],"rotate-z":[{"rotate-z":pe()}],scale:[{scale:Le()}],"scale-x":[{"scale-x":Le()}],"scale-y":[{"scale-y":Le()}],"scale-z":[{"scale-z":Le()}],"scale-3d":["scale-3d"],skew:[{skew:He()}],"skew-x":[{"skew-x":He()}],"skew-y":[{"skew-y":He()}],transform:[{transform:[Cn,_n,"","none","gpu","cpu"]}],"transform-origin":[{origin:k()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Fe()}],"translate-x":[{"translate-x":Fe()}],"translate-y":[{"translate-y":Fe()}],"translate-z":[{"translate-z":Fe()}],"translate-none":["translate-none"],accent:[{accent:$()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:$()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Cn,_n]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":R()}],"scroll-mx":[{"scroll-mx":R()}],"scroll-my":[{"scroll-my":R()}],"scroll-ms":[{"scroll-ms":R()}],"scroll-me":[{"scroll-me":R()}],"scroll-mt":[{"scroll-mt":R()}],"scroll-mr":[{"scroll-mr":R()}],"scroll-mb":[{"scroll-mb":R()}],"scroll-ml":[{"scroll-ml":R()}],"scroll-p":[{"scroll-p":R()}],"scroll-px":[{"scroll-px":R()}],"scroll-py":[{"scroll-py":R()}],"scroll-ps":[{"scroll-ps":R()}],"scroll-pe":[{"scroll-pe":R()}],"scroll-pt":[{"scroll-pt":R()}],"scroll-pr":[{"scroll-pr":R()}],"scroll-pb":[{"scroll-pb":R()}],"scroll-pl":[{"scroll-pl":R()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Cn,_n]}],fill:[{fill:["none",...$()]}],"stroke-w":[{stroke:[$r,vx,hm,VI]}],stroke:[{stroke:["none",...$()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},wye=tye(xye);function Ye(...e){return wye(GK(e))}const IP=TD("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function rt({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?WK:"button";return f.jsx(i,{"data-slot":"button",className:Ye(IP({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sye=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_ye=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),kz=e=>{const t=_ye(e);return t.charAt(0).toUpperCase()+t.slice(1)},sY=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Cye={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kye=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...Cye,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:sY("lucide",s),...o},[...a.map(([c,u])=>E.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=(e,t)=>{const n=E.forwardRef(({className:r,...s},i)=>E.createElement(kye,{ref:i,iconNode:t,className:sY(`lucide-${Sye(kz(e))}`,`lucide-${e}`,r),...s}));return n.displayName=kz(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],iY=Bt("archive",Eye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tye=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],aY=Bt("arrow-down",Tye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aye=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Nye=Bt("arrow-left",Aye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rye=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Iye=Bt("arrow-right",Rye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mye=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],jye=Bt("arrow-up",Mye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pye=[["path",{d:"m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9",key:"csbz4o"}],["path",{d:"M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z",key:"113wfo"}]],Oye=Bt("axe",Pye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Fye=Bt("ban",Dye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lye=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],$ye=Bt("book-open-text",Lye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bye=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],Ly=Bt("bot",Bye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zye=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Pb=Bt("brain-circuit",zye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uye=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Ow=Bt("brain",Uye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qye=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Vye=Bt("calendar",qye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wye=[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]],Hye=Bt("captions",Wye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gye=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ao=Bt("check",Gye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kye=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Fl=Bt("chevron-down",Kye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yye=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Zye=Bt("chevron-left",Yye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xye=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],NT=Bt("chevron-right",Xye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jye=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],wp=Bt("chevron-up",Jye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qye=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],RT=Bt("chevrons-up-down",Qye);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ebe=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],tbe=Bt("chevrons-up",ebe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nbe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],No=Bt("circle-alert",nbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rbe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],sbe=Bt("circle-check-big",rbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ibe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],dS=Bt("circle-check",ibe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const abe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],obe=Bt("circle-stop",abe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lbe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],oY=Bt("circle",lbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cbe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],MP=Bt("circle-x",cbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ube=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],IT=Bt("clipboard",ube);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dbe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],fbe=Bt("clock",dbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hbe=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],ND=Bt("cloud-upload",hbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pbe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],fS=Bt("code",pbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mbe=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],gbe=Bt("cog",mbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ybe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],bbe=Bt("coins",ybe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vbe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],lY=Bt("copy",vbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xbe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],wbe=Bt("dollar-sign",xbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sbe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],cc=Bt("download",Sbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _be=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Cbe=Bt("ellipsis-vertical",_be);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kbe=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],Ebe=Bt("file-archive",kbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tbe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Abe=Bt("file-down",Tbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nbe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],Rbe=Bt("file-json",Nbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ibe=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],Mbe=Bt("file-question",Ibe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jbe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],jP=Bt("file-text",jbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pbe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Obe=Bt("file-up",Pbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dbe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],cY=Bt("file",Dbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fbe=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],uY=Bt("folder-git",Fbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lbe=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],dY=Bt("folder-plus",Lbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $be=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],Ez=Bt("folder-tree",$be);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bbe=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],zbe=Bt("folder-up",Bbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ube=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Zh=Bt("folder",Ube);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qbe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Vbe=Bt("funnel",qbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wbe=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],eu=Bt("git-branch",Wbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hbe=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],fY=Bt("git-commit-horizontal",Hbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gbe=[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]],RD=Bt("git-fork",Gbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kbe=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],hY=Bt("git-merge",Kbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ybe=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],ID=Bt("git-pull-request",Ybe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zbe=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Xbe=Bt("github",Zbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jbe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Dw=Bt("globe",Jbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qbe=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],eve=Bt("grip-vertical",Qbe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tve=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],MD=Bt("hard-drive",tve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nve=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],rve=Bt("history",nve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sve=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],ive=Bt("house",sve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ave=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],sd=Bt("image",ave);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ove=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],jD=Bt("info",ove);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lve=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Fw=Bt("key",lve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cve=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],pY=Bt("land-plot",cve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uve=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],dve=Bt("lightbulb",uve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fve=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],hve=Bt("list-restart",fve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pve=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Yn=Bt("loader-circle",pve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mve=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],gve=Bt("menu",mve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yve=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],bve=Bt("message-square-plus",yve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vve=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],Tz=Bt("message-square-text",vve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xve=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],PP=Bt("message-square",xve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wve=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Sve=Bt("music",wve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ve=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],PD=Bt("notebook-pen",_ve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cve=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],Xm=Bt("palette",Cve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Eve=Bt("panel-left-close",kve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],Ave=Bt("panel-right-close",Tve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nve=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],MT=Bt("paperclip",Nve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rve=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Ive=Bt("pause",Rve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mve=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],hS=Bt("pen",Mve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jve=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],OD=Bt("play",jve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pve=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],Az=Bt("plug",Pve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ove=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],al=Bt("plus",Ove);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dve=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],Nz=Bt("puzzle",Dve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fve=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]],Lve=Bt("rectangle-ellipsis",Fve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ve=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Jm=Bt("refresh-cw",$ve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bve=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],zve=Bt("rocket",Bve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uve=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],pS=Bt("rotate-ccw",Uve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qve=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],wc=Bt("save",qve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vve=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Ro=Bt("search",Vve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wve=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],Hve=Bt("send-horizontal",Wve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gve=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],$y=Bt("server",Gve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kve=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Xh=Bt("settings",Kve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yve=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Rz=Bt("shield-alert",Yve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zve=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],Xve=Bt("sliders-horizontal",Zve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jve=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],mY=Bt("sparkles",Jve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qve=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],Iz=Bt("sparkle",Qve);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const exe=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ku=Bt("square-pen",exe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const txe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],nxe=Bt("square",txe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rxe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Mz=Bt("star",rxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sxe=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],OP=Bt("tags",sxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ixe=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],axe=Bt("text",ixe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oxe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],to=Bt("trash-2",oxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lxe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],cxe=Bt("trash",lxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uxe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],DD=Bt("triangle-alert",uxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dxe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],gY=Bt("upload",dxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fxe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],jz=Bt("user-check",fxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hxe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],pxe=Bt("user",hxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mxe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Pz=Bt("users",mxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gxe=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],yxe=Bt("video",gxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bxe=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],vxe=Bt("wand-sparkles",bxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xxe=[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]],Lw=Bt("workflow",xxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wxe=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Jh=Bt("wrench",wxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sxe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Ri=Bt("x",Sxe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _xe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Cxe=Bt("zap",_xe),Oz=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Ye(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(We.Fragment,{children:i},s.id):null})})},Dz=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(p=>p(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},kxe=e=>e?Dz(e):Dz,Exe=e=>e;function Txe(e,t=Exe){const n=We.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return We.useDebugValue(n),n}const Fz=e=>{const t=kxe(e),n=r=>Txe(t,r);return Object.assign(n,t),n},Do=e=>e?Fz(e):Fz;var yY=Symbol.for("immer-nothing"),Lz=Symbol.for("immer-draftable"),ms=Symbol.for("immer-state");function ac(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var By=Object.getPrototypeOf;function zy(e){return!!e&&!!e[ms]}function _f(e){var t;return e?bY(e)||Array.isArray(e)||!!e[Lz]||!!((t=e.constructor)!=null&&t[Lz])||PT(e)||OT(e):!1}var Axe=Object.prototype.constructor.toString();function bY(e){if(!e||typeof e!="object")return!1;const t=By(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Axe}function $w(e,t){jT(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function jT(e){const t=e[ms];return t?t.type_:Array.isArray(e)?1:PT(e)?2:OT(e)?3:0}function DP(e,t){return jT(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function vY(e,t,n){const r=jT(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function Nxe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function PT(e){return e instanceof Map}function OT(e){return e instanceof Set}function ya(e){return e.copy_||e.base_}function FP(e,t){if(PT(e))return new Map(e);if(OT(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=bY(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[ms];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(By(e),r)}else{const r=By(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function FD(e,t=!1){return DT(e)||zy(e)||!_f(e)||(jT(e)>1&&(e.set=e.add=e.clear=e.delete=Rxe),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>FD(r,!0))),e}function Rxe(){ac(2)}function DT(e){return Object.isFrozen(e)}var LP={};function Qm(e){const t=LP[e];return t||ac(0,e),t}function Ixe(e,t){LP[e]||(LP[e]=t)}var Bw;function vk(){return Bw}function Mxe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $z(e,t){t&&(Qm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function $P(e){BP(e),e.drafts_.forEach(jxe),e.drafts_=null}function BP(e){e===Bw&&(Bw=e.parent_)}function Bz(e){return Bw=Mxe(Bw,e)}function jxe(e){const t=e[ms];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function zz(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[ms].modified_&&($P(t),ac(4)),_f(e)&&(e=xk(t,e),t.parent_||wk(t,e)),t.patches_&&Qm("Patches").generateReplacementPatches_(n[ms].base_,e,t.patches_,t.inversePatches_)):e=xk(t,n,[]),$P(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==yY?e:void 0}function xk(e,t,n){if(DT(t))return t;const r=t[ms];if(!r)return $w(t,(s,i)=>Uz(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return wk(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),$w(i,(o,l)=>Uz(e,r,s,o,l,n,a)),wk(e,s,!1),n&&e.patches_&&Qm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function Uz(e,t,n,r,s,i,a){if(zy(s)){const o=i&&t&&t.type_!==3&&!DP(t.assigned_,r)?i.concat(r):void 0,l=xk(e,s,o);if(vY(n,r,l),zy(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(_f(s)&&!DT(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;xk(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&wk(e,s)}}function wk(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&FD(t,n)}function Pxe(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:vk(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=LD;n&&(s=[r],i=zw);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var LD={get(e,t){if(t===ms)return e;const n=ya(e);if(!DP(n,t))return Oxe(e,n,t);const r=n[t];return e.finalized_||!_f(r)?r:r===WI(e.base_,t)?(HI(e),e.copy_[t]=Uw(r,e)):r},has(e,t){return t in ya(e)},ownKeys(e){return Reflect.ownKeys(ya(e))},set(e,t,n){const r=xY(ya(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=WI(ya(e),t),i=s==null?void 0:s[ms];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Nxe(n,s)&&(n!==void 0||DP(e.base_,t)))return!0;HI(e),rf(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return WI(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,HI(e),rf(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=ya(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){ac(11)},getPrototypeOf(e){return By(e.base_)},setPrototypeOf(){ac(12)}},zw={};$w(LD,(e,t)=>{zw[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});zw.deleteProperty=function(e,t){return zw.set.call(this,e,t,void 0)};zw.set=function(e,t,n){return LD.set.call(this,e[0],t,n,e[0])};function WI(e,t){const n=e[ms];return(n?ya(n):e)[t]}function Oxe(e,t,n){var s;const r=xY(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function xY(e,t){if(!(t in e))return;let n=By(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=By(n)}}function rf(e){e.modified_||(e.modified_=!0,e.parent_&&rf(e.parent_))}function HI(e){e.copy_||(e.copy_=FP(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Dxe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&ac(6),r!==void 0&&typeof r!="function"&&ac(7);let s;if(_f(t)){const i=Bz(this),a=Uw(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?$P(i):BP(i)}return $z(i,r),zz(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===yY&&(s=void 0),this.autoFreeze_&&FD(s,!0),r){const i=[],a=[];Qm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else ac(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){_f(e)||ac(8),zy(e)&&(e=Fxe(e));const t=Bz(this),n=Uw(e,void 0);return n[ms].isManual_=!0,BP(t),n}finishDraft(e,t){const n=e&&e[ms];(!n||!n.isManual_)&&ac(9);const{scope_:r}=n;return $z(r,t),zz(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=Qm("Patches").applyPatches_;return zy(e)?r(e,t):this.produce(e,s=>r(s,t))}};function Uw(e,t){const n=PT(e)?Qm("MapSet").proxyMap_(e,t):OT(e)?Qm("MapSet").proxySet_(e,t):Pxe(e,t);return(t?t.scope_:vk()).drafts_.push(n),n}function Fxe(e){return zy(e)||ac(10,e),wY(e)}function wY(e){if(!_f(e)||DT(e))return e;const t=e[ms];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=FP(e,t.scope_.immer_.useStrictShallowCopy_)}else n=FP(e,!0);return $w(n,(r,s)=>{vY(n,r,wY(s))}),t&&(t.finalized_=!1),n}function Lxe(){class e extends Map{constructor(l,c){super(),this[ms]={type_:2,parent_:c,scope_:c?c.scope_:vk(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return ya(this[ms]).size}has(l){return ya(this[ms]).has(l)}set(l,c){const u=this[ms];return a(u),(!ya(u).has(l)||ya(u).get(l)!==c)&&(n(u),rf(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[ms];return a(c),n(c),rf(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[ms];a(l),ya(l).size&&(n(l),rf(l),l.assigned_=new Map,$w(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[ms];ya(u).forEach((d,h,p)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[ms];a(c);const u=ya(c).get(l);if(c.finalized_||!_f(u)||u!==c.base_.get(l))return u;const d=Uw(u,c);return n(c),c.copy_.set(l,d),d}keys(){return ya(this[ms]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[ms]={type_:3,parent_:c,scope_:c?c.scope_:vk(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return ya(this[ms]).size}has(l){const c=this[ms];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[ms];return a(c),this.has(l)||(i(c),rf(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[ms];return a(c),i(c),rf(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[ms];a(l),ya(l).size&&(i(l),rf(l),l.copy_.clear())}values(){const l=this[ms];return a(l),i(l),l.copy_.values()}entries(){const l=this[ms];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(_f(l)){const c=Uw(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&ac(3,JSON.stringify(ya(o)))}Ixe("MapSet",{proxyMap_:t,proxySet_:s})}var Pl=new Dxe,$xe=Pl.produce;Pl.produceWithPatches.bind(Pl);Pl.setAutoFreeze.bind(Pl);Pl.setUseStrictShallowCopy.bind(Pl);Pl.applyPatches.bind(Pl);Pl.createDraft.bind(Pl);Pl.finishDraft.bind(Pl);const Bxe=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?$xe(s):s;return t(o,i,...a)},e(r.setState,n,r)),Fo=Bxe;function zxe(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Ae=zxe(),Wr={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},ey={blockRenderersChanged:"block.renderer.renderers.changed",registerBlockRendererRequest:"block.renderer.register.request",unregisterBlockRendererRequest:"block.renderer.unregister.request"},Ni=Do(Fo((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},blockRenderers:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Ae.emit(Wr.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Ae.emit(Wr.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Ae.emit(Wr.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Ae.emit(Wr.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Ae.emit(Wr.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Ae.emit(Wr.canvasControlsChanged,{controls:t().canvasControls})},registerBlockRenderer:n=>(e(r=>{r.blockRenderers[n.id]&&console.warn(`ControlRegistryStore: BlockRenderer with ID "${n.id}" already registered. Overwriting.`),r.blockRenderers[n.id]=n}),Ae.emit(ey.blockRenderersChanged,{renderers:t().blockRenderers}),()=>t().unregisterBlockRenderer(n.id)),unregisterBlockRenderer:n=>{e(r=>{r.blockRenderers[n]?delete r.blockRenderers[n]:console.warn(`ControlRegistryStore: BlockRenderer with ID "${n}" not found for unregistration.`)}),Ae.emit(ey.blockRenderersChanged,{renderers:t().blockRenderers})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Ae.emit(Wr.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Ae.emit(Wr.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Ae.emit(Wr.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Ae.emit(Wr.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Ae.emit(Wr.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Ae.emit(Wr.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:Wr.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:Wr.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:Wr.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:Wr.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:Wr.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:Wr.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:ey.registerBlockRendererRequest,handler:s=>{r.registerBlockRenderer(s.renderer)},storeId:n},{eventName:ey.unregisterBlockRendererRequest,handler:s=>{r.unregisterBlockRenderer(s.id)},storeId:n},{eventName:Wr.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:Wr.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:Wr.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:Wr.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:Wr.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:Wr.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var B2={exports:{}},Uxe=B2.exports,qz;function qxe(){return qz||(qz=1,function(e,t){(function(n,r){e.exports=r()})(Uxe,function(){var n=function(O,H){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(re,oe){re.__proto__=oe}||function(re,oe){for(var be in oe)Object.prototype.hasOwnProperty.call(oe,be)&&(re[be]=oe[be])})(O,H)},r=function(){return(r=Object.assign||function(O){for(var H,re=1,oe=arguments.length;re<oe;re++)for(var be in H=arguments[re])Object.prototype.hasOwnProperty.call(H,be)&&(O[be]=H[be]);return O}).apply(this,arguments)};function s(O,H,re){for(var oe,be=0,Oe=H.length;be<Oe;be++)!oe&&be in H||((oe=oe||Array.prototype.slice.call(H,0,be))[be]=H[be]);return O.concat(oe||Array.prototype.slice.call(H))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:jm,a=Object.keys,o=Array.isArray;function l(O,H){return typeof H!="object"||a(H).forEach(function(re){O[re]=H[re]}),O}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(O,H){return u.call(O,H)}function h(O,H){typeof H=="function"&&(H=H(c(O))),(typeof Reflect>"u"?a:Reflect.ownKeys)(H).forEach(function(re){g(O,re,H[re])})}var p=Object.defineProperty;function g(O,H,re,oe){p(O,H,l(re&&d(re,"get")&&typeof re.get=="function"?{get:re.get,set:re.set,configurable:!0}:{value:re,configurable:!0,writable:!0},oe))}function y(O){return{from:function(H){return O.prototype=Object.create(H.prototype),g(O.prototype,"constructor",O),{extend:h.bind(null,O.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(O,H,re){return x.call(O,H,re)}function S(O,H){return H(O)}function _(O){if(!O)throw new Error("Assertion Failed")}function k(O){i.setImmediate?setImmediate(O):setTimeout(O,0)}function T(O,H){if(typeof H=="string"&&d(O,H))return O[H];if(!H)return O;if(typeof H!="string"){for(var re=[],oe=0,be=H.length;oe<be;++oe){var Oe=T(O,H[oe]);re.push(Oe)}return re}var ze=H.indexOf(".");if(ze!==-1){var Ke=O[H.substr(0,ze)];return Ke==null?void 0:T(Ke,H.substr(ze+1))}}function A(O,H,re){if(O&&H!==void 0&&!("isFrozen"in Object&&Object.isFrozen(O)))if(typeof H!="string"&&"length"in H){_(typeof re!="string"&&"length"in re);for(var oe=0,be=H.length;oe<be;++oe)A(O,H[oe],re[oe])}else{var Oe,ze,Ke=H.indexOf(".");Ke!==-1?(Oe=H.substr(0,Ke),(ze=H.substr(Ke+1))===""?re===void 0?o(O)&&!isNaN(parseInt(Oe))?O.splice(Oe,1):delete O[Oe]:O[Oe]=re:A(Ke=!(Ke=O[Oe])||!d(O,Oe)?O[Oe]={}:Ke,ze,re)):re===void 0?o(O)&&!isNaN(parseInt(H))?O.splice(H,1):delete O[H]:O[H]=re}}function R(O){var H,re={};for(H in O)d(O,H)&&(re[H]=O[H]);return re}var M=[].concat;function j(O){return M.apply([],O)}var Pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(j([8,16,32,64].map(function(O){return["Int","Uint","Float"].map(function(H){return H+O+"Array"})}))).filter(function(O){return i[O]}),F=new Set(Pt.map(function(O){return i[O]})),P=null;function q(O){return P=new WeakMap,O=function H(re){if(!re||typeof re!="object")return re;var oe=P.get(re);if(oe)return oe;if(o(re)){oe=[],P.set(re,oe);for(var be=0,Oe=re.length;be<Oe;++be)oe.push(H(re[be]))}else if(F.has(re.constructor))oe=re;else{var ze,Ke=c(re);for(ze in oe=Ke===Object.prototype?{}:Object.create(Ke),P.set(re,oe),re)d(re,ze)&&(oe[ze]=H(re[ze]))}return oe}(O),P=null,O}var I={}.toString;function V(O){return I.call(O).slice(8,-1)}var D=typeof Symbol<"u"?Symbol.iterator:"@@iterator",z=typeof D=="symbol"?function(O){var H;return O!=null&&(H=O[D])&&H.apply(O)}:function(){return null};function $(O,H){return H=O.indexOf(H),0<=H&&O.splice(H,1),0<=H}var Y={};function B(O){var H,re,oe,be;if(arguments.length===1){if(o(O))return O.slice();if(this===Y&&typeof O=="string")return[O];if(be=z(O)){for(re=[];!(oe=be.next()).done;)re.push(oe.value);return re}if(O==null)return[O];if(typeof(H=O.length)!="number")return[O];for(re=new Array(H);H--;)re[H]=O[H];return re}for(H=arguments.length,re=new Array(H);H--;)re[H]=arguments[H];return re}var G=typeof Symbol<"u"?function(O){return O[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ut=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],go=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ut),Z={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ne(O,H){this.name=O,this.message=H}function ae(O,H){return O+". Errors: "+Object.keys(H).map(function(re){return H[re].toString()}).filter(function(re,oe,be){return be.indexOf(re)===oe}).join(`
`)}function le(O,H,re,oe){this.failures=H,this.failedKeys=oe,this.successCount=re,this.message=ae(O,H)}function Se(O,H){this.name="BulkError",this.failures=Object.keys(H).map(function(re){return H[re]}),this.failuresByPos=H,this.message=ae(O,this.failures)}y(ne).from(Error).extend({toString:function(){return this.name+": "+this.message}}),y(le).from(ne),y(Se).from(ne);var Ee=go.reduce(function(O,H){return O[H]=H+"Error",O},{}),he=ne,pe=go.reduce(function(O,H){var re=H+"Error";function oe(be,Oe){this.name=re,be?typeof be=="string"?(this.message="".concat(be).concat(Oe?`
 `+Oe:""),this.inner=Oe||null):typeof be=="object"&&(this.message="".concat(be.name," ").concat(be.message),this.inner=be):(this.message=Z[H]||re,this.inner=null)}return y(oe).from(he),O[H]=oe,O},{});pe.Syntax=SyntaxError,pe.Type=TypeError,pe.Range=RangeError;var Le=ut.reduce(function(O,H){return O[H+"Error"]=pe[H],O},{}),He=go.reduce(function(O,H){return["Syntax","Type","Range"].indexOf(H)===-1&&(O[H+"Error"]=pe[H]),O},{});function Fe(){}function Ie(O){return O}function X(O,H){return O==null||O===Ie?H:function(re){return H(O(re))}}function ye(O,H){return function(){O.apply(this,arguments),H.apply(this,arguments)}}function Ne(O,H){return O===Fe?H:function(){var re=O.apply(this,arguments);re!==void 0&&(arguments[0]=re);var oe=this.onsuccess,be=this.onerror;this.onsuccess=null,this.onerror=null;var Oe=H.apply(this,arguments);return oe&&(this.onsuccess=this.onsuccess?ye(oe,this.onsuccess):oe),be&&(this.onerror=this.onerror?ye(be,this.onerror):be),Oe!==void 0?Oe:re}}function fe(O,H){return O===Fe?H:function(){O.apply(this,arguments);var re=this.onsuccess,oe=this.onerror;this.onsuccess=this.onerror=null,H.apply(this,arguments),re&&(this.onsuccess=this.onsuccess?ye(re,this.onsuccess):re),oe&&(this.onerror=this.onerror?ye(oe,this.onerror):oe)}}function ce(O,H){return O===Fe?H:function(re){var oe=O.apply(this,arguments);l(re,oe);var be=this.onsuccess,Oe=this.onerror;return this.onsuccess=null,this.onerror=null,re=H.apply(this,arguments),be&&(this.onsuccess=this.onsuccess?ye(be,this.onsuccess):be),Oe&&(this.onerror=this.onerror?ye(Oe,this.onerror):Oe),oe===void 0?re===void 0?void 0:re:l(oe,re)}}function se(O,H){return O===Fe?H:function(){return H.apply(this,arguments)!==!1&&O.apply(this,arguments)}}function Pe(O,H){return O===Fe?H:function(){var re=O.apply(this,arguments);if(re&&typeof re.then=="function"){for(var oe=this,be=arguments.length,Oe=new Array(be);be--;)Oe[be]=arguments[be];return re.then(function(){return H.apply(oe,Oe)})}return H.apply(this,arguments)}}He.ModifyError=le,He.DexieError=ne,He.BulkError=Se;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function je(O){Be=O}var ot={},Et=100,Pt=typeof Promise>"u"?[]:function(){var O=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[O,c(O),O];var H=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[H,c(H),O]}(),ut=Pt[0],go=Pt[1],Pt=Pt[2],go=go&&go.then,$t=ut&&ut.constructor,Ft=!!Pt,Ht=function(O,H){de.push([O,H]),U&&(queueMicrotask(me),U=!1)},Ce=!0,U=!0,ee=[],xe=[],Re=Ie,ve={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Fe,pgp:!1,env:{},finalize:Fe},Me=ve,de=[],ht=0,et=[];function W(O){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var H=this._PSD=Me;if(typeof O!="function"){if(O!==ot)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&we(this,this._value))}this._state=null,this._value=null,++H.ref,function re(oe,be){try{be(function(Oe){if(oe._state===null){if(Oe===oe)throw new TypeError("A promise cannot be resolved with itself.");var ze=oe._lib&&Q();Oe&&typeof Oe.then=="function"?re(oe,function(Ke,it){Oe instanceof W?Oe._then(Ke,it):Oe.then(Ke,it)}):(oe._state=!0,oe._value=Oe,Te(oe)),ze&&J()}},we.bind(null,oe))}catch(Oe){we(oe,Oe)}}(this,O)}var Ve={get:function(){var O=Me,H=Gt;function re(oe,be){var Oe=this,ze=!O.global&&(O!==Me||H!==Gt),Ke=ze&&!Cr(),it=new W(function(lt,mt){Ue(Oe,new tt(Vt(oe,O,ze,Ke),Vt(be,O,ze,Ke),lt,mt,O))});return this._consoleTask&&(it._consoleTask=this._consoleTask),it}return re.prototype=ot,re},set:function(O){g(this,"then",O&&O.prototype===ot?Ve:{get:function(){return O},set:Ve.set})}};function tt(O,H,re,oe,be){this.onFulfilled=typeof O=="function"?O:null,this.onRejected=typeof H=="function"?H:null,this.resolve=re,this.reject=oe,this.psd=be}function we(O,H){var re,oe;xe.push(H),O._state===null&&(re=O._lib&&Q(),H=Re(H),O._state=!1,O._value=H,oe=O,ee.some(function(be){return be._value===oe._value})||ee.push(oe),Te(O),re&&J())}function Te(O){var H=O._listeners;O._listeners=[];for(var re=0,oe=H.length;re<oe;++re)Ue(O,H[re]);var be=O._PSD;--be.ref||be.finalize(),ht===0&&(++ht,Ht(function(){--ht==0&&te()},[]))}function Ue(O,H){if(O._state!==null){var re=O._state?H.onFulfilled:H.onRejected;if(re===null)return(O._state?H.resolve:H.reject)(O._value);++H.psd.ref,++ht,Ht(Ct,[re,O,H])}else O._listeners.push(H)}function Ct(O,H,re){try{var oe,be=H._value;!H._state&&xe.length&&(xe=[]),oe=Be&&H._consoleTask?H._consoleTask.run(function(){return O(be)}):O(be),H._state||xe.indexOf(be)!==-1||function(Oe){for(var ze=ee.length;ze;)if(ee[--ze]._value===Oe._value)return ee.splice(ze,1)}(H),re.resolve(oe)}catch(Oe){re.reject(Oe)}finally{--ht==0&&te(),--re.psd.ref||re.psd.finalize()}}function me(){nt(ve,function(){Q()&&J()})}function Q(){var O=Ce;return U=Ce=!1,O}function J(){var O,H,re;do for(;0<de.length;)for(O=de,de=[],re=O.length,H=0;H<re;++H){var oe=O[H];oe[0].apply(null,oe[1])}while(0<de.length);U=Ce=!0}function te(){var O=ee;ee=[],O.forEach(function(oe){oe._PSD.onunhandled.call(null,oe._value,oe)});for(var H=et.slice(0),re=H.length;re;)H[--re]()}function _e(O){return new W(ot,!1,O)}function $e(O,H){var re=Me;return function(){var oe=Q(),be=Me;try{return Sr(re,!0),O.apply(this,arguments)}catch(Oe){H&&H(Oe)}finally{Sr(be,!1),oe&&J()}}}h(W.prototype,{then:Ve,_then:function(O,H){Ue(this,new tt(null,null,O,H,Me))},catch:function(O){if(arguments.length===1)return this.then(null,O);var H=O,re=arguments[1];return typeof H=="function"?this.then(null,function(oe){return(oe instanceof H?re:_e)(oe)}):this.then(null,function(oe){return(oe&&oe.name===H?re:_e)(oe)})},finally:function(O){return this.then(function(H){return W.resolve(O()).then(function(){return H})},function(H){return W.resolve(O()).then(function(){return _e(H)})})},timeout:function(O,H){var re=this;return O<1/0?new W(function(oe,be){var Oe=setTimeout(function(){return be(new pe.Timeout(H))},O);re.then(oe,be).finally(clearTimeout.bind(null,Oe))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&g(W.prototype,Symbol.toStringTag,"Dexie.Promise"),ve.env=mn(),h(W,{all:function(){var O=B.apply(null,arguments).map(Jr);return new W(function(H,re){O.length===0&&H([]);var oe=O.length;O.forEach(function(be,Oe){return W.resolve(be).then(function(ze){O[Oe]=ze,--oe||H(O)},re)})})},resolve:function(O){return O instanceof W?O:O&&typeof O.then=="function"?new W(function(H,re){O.then(H,re)}):new W(ot,!0,O)},reject:_e,race:function(){var O=B.apply(null,arguments).map(Jr);return new W(function(H,re){O.map(function(oe){return W.resolve(oe).then(H,re)})})},PSD:{get:function(){return Me},set:function(O){return Me=O}},totalEchoes:{get:function(){return Gt}},newPSD:dn,usePSD:nt,scheduler:{get:function(){return Ht},set:function(O){Ht=O}},rejectionMapper:{get:function(){return Re},set:function(O){Re=O}},follow:function(O,H){return new W(function(re,oe){return dn(function(be,Oe){var ze=Me;ze.unhandleds=[],ze.onunhandled=Oe,ze.finalize=ye(function(){var Ke,it=this;Ke=function(){it.unhandleds.length===0?be():Oe(it.unhandleds[0])},et.push(function lt(){Ke(),et.splice(et.indexOf(lt),1)}),++ht,Ht(function(){--ht==0&&te()},[])},ze.finalize),O()},H,re,oe)})}}),$t&&($t.allSettled&&g(W,"allSettled",function(){var O=B.apply(null,arguments).map(Jr);return new W(function(H){O.length===0&&H([]);var re=O.length,oe=new Array(re);O.forEach(function(be,Oe){return W.resolve(be).then(function(ze){return oe[Oe]={status:"fulfilled",value:ze}},function(ze){return oe[Oe]={status:"rejected",reason:ze}}).then(function(){return--re||H(oe)})})})}),$t.any&&typeof AggregateError<"u"&&g(W,"any",function(){var O=B.apply(null,arguments).map(Jr);return new W(function(H,re){O.length===0&&re(new AggregateError([]));var oe=O.length,be=new Array(oe);O.forEach(function(Oe,ze){return W.resolve(Oe).then(function(Ke){return H(Ke)},function(Ke){be[ze]=Ke,--oe||re(new AggregateError(be))})})})}),$t.withResolvers&&(W.withResolvers=$t.withResolvers));var Ge={awaits:0,echoes:0,id:0},wt=0,Jt=[],jn=0,Gt=0,rn=0;function dn(O,H,re,oe){var be=Me,Oe=Object.create(be);return Oe.parent=be,Oe.ref=0,Oe.global=!1,Oe.id=++rn,ve.env,Oe.env=Ft?{Promise:W,PromiseProp:{value:W,configurable:!0,writable:!0},all:W.all,race:W.race,allSettled:W.allSettled,any:W.any,resolve:W.resolve,reject:W.reject}:{},H&&l(Oe,H),++be.ref,Oe.finalize=function(){--this.parent.ref||this.parent.finalize()},oe=nt(Oe,O,re,oe),Oe.ref===0&&Oe.finalize(),oe}function br(){return Ge.id||(Ge.id=++wt),++Ge.awaits,Ge.echoes+=Et,Ge.id}function Cr(){return!!Ge.awaits&&(--Ge.awaits==0&&(Ge.id=0),Ge.echoes=Ge.awaits*Et,!0)}function Jr(O){return Ge.echoes&&O&&O.constructor===$t?(br(),O.then(function(H){return Cr(),H},function(H){return Cr(),tr(H)})):O}function Qr(){var O=Jt[Jt.length-1];Jt.pop(),Sr(O,!1)}function Sr(O,H){var re,oe=Me;(H?!Ge.echoes||jn++&&O===Me:!jn||--jn&&O===Me)||queueMicrotask(H?(function(be){++Gt,Ge.echoes&&--Ge.echoes!=0||(Ge.echoes=Ge.awaits=Ge.id=0),Jt.push(Me),Sr(be,!0)}).bind(null,O):Qr),O!==Me&&(Me=O,oe===ve&&(ve.env=mn()),Ft&&(re=ve.env.Promise,H=O.env,(oe.global||O.global)&&(Object.defineProperty(i,"Promise",H.PromiseProp),re.all=H.all,re.race=H.race,re.resolve=H.resolve,re.reject=H.reject,H.allSettled&&(re.allSettled=H.allSettled),H.any&&(re.any=H.any))))}function mn(){var O=i.Promise;return Ft?{Promise:O,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:O.all,race:O.race,allSettled:O.allSettled,any:O.any,resolve:O.resolve,reject:O.reject}:{}}function nt(O,H,re,oe,be){var Oe=Me;try{return Sr(O,!0),H(re,oe,be)}finally{Sr(Oe,!1)}}function Vt(O,H,re,oe){return typeof O!="function"?O:function(){var be=Me;re&&br(),Sr(H,!0);try{return O.apply(this,arguments)}finally{Sr(be,!1),oe&&queueMicrotask(Cr)}}}function gn(O){Promise===$t&&Ge.echoes===0?jn===0?O():enqueueNativeMicroTask(O):setTimeout(O,0)}(""+go).indexOf("[native code]")===-1&&(br=Cr=Fe);var tr=W.reject,ps="",es="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",xi="String expected.",si=[],Ea="__dbnames",Zi="readonly",$s="readwrite";function fo(O,H){return O?H?function(){return O.apply(this,arguments)&&H.apply(this,arguments)}:O:H}var ho={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function hu(O){return typeof O!="string"||/\./.test(O)?function(H){return H}:function(H){return H[O]===void 0&&O in H&&delete(H=q(H))[O],H}}function Gf(){throw pe.Type()}function Fr(O,H){try{var re=qp(O),oe=qp(H);if(re!==oe)return re==="Array"?1:oe==="Array"?-1:re==="binary"?1:oe==="binary"?-1:re==="string"?1:oe==="string"?-1:re==="Date"?1:oe!=="Date"?NaN:-1;switch(re){case"number":case"Date":case"string":return H<O?1:O<H?-1:0;case"binary":return function(be,Oe){for(var ze=be.length,Ke=Oe.length,it=ze<Ke?ze:Ke,lt=0;lt<it;++lt)if(be[lt]!==Oe[lt])return be[lt]<Oe[lt]?-1:1;return ze===Ke?0:ze<Ke?-1:1}(Ta(O),Ta(H));case"Array":return function(be,Oe){for(var ze=be.length,Ke=Oe.length,it=ze<Ke?ze:Ke,lt=0;lt<it;++lt){var mt=Fr(be[lt],Oe[lt]);if(mt!==0)return mt}return ze===Ke?0:ze<Ke?-1:1}(O,H)}}catch{}return NaN}function qp(O){var H=typeof O;return H!="object"?H:ArrayBuffer.isView(O)?"binary":(O=V(O),O==="ArrayBuffer"?"binary":O)}function Ta(O){return O instanceof Uint8Array?O:ArrayBuffer.isView(O)?new Uint8Array(O.buffer,O.byteOffset,O.byteLength):new Uint8Array(O)}var Vp=(Ss.prototype._trans=function(O,H,re){var oe=this._tx||Me.trans,be=this.name,Oe=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(O==="readonly"?"read":"write"," ").concat(this.name));function ze(lt,mt,Qe){if(!Qe.schema[be])throw new pe.NotFound("Table "+be+" not part of transaction");return H(Qe.idbtrans,Qe)}var Ke=Q();try{var it=oe&&oe.db._novip===this.db._novip?oe===Me.trans?oe._promise(O,ze,re):dn(function(){return oe._promise(O,ze,re)},{trans:oe,transless:Me.transless||Me}):function lt(mt,Qe,yt,st){if(mt.idbdb&&(mt._state.openComplete||Me.letThrough||mt._vip)){var pt=mt._createTransaction(Qe,yt,mt._dbSchema);try{pt.create(),mt._state.PR1398_maxLoop=3}catch(bt){return bt.name===Ee.InvalidState&&mt.isOpen()&&0<--mt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),mt.close({disableAutoOpen:!1}),mt.open().then(function(){return lt(mt,Qe,yt,st)})):tr(bt)}return pt._promise(Qe,function(bt,ct){return dn(function(){return Me.trans=pt,st(bt,ct,pt)})}).then(function(bt){if(Qe==="readwrite")try{pt.idbtrans.commit()}catch{}return Qe==="readonly"?bt:pt._completion.then(function(){return bt})})}if(mt._state.openComplete)return tr(new pe.DatabaseClosed(mt._state.dbOpenError));if(!mt._state.isBeingOpened){if(!mt._state.autoOpen)return tr(new pe.DatabaseClosed);mt.open().catch(Fe)}return mt._state.dbReadyPromise.then(function(){return lt(mt,Qe,yt,st)})}(this.db,O,[this.name],ze);return Oe&&(it._consoleTask=Oe,it=it.catch(function(lt){return console.trace(lt),tr(lt)})),it}finally{Ke&&J()}},Ss.prototype.get=function(O,H){var re=this;return O&&O.constructor===Object?this.where(O).first(H):O==null?tr(new pe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(oe){return re.core.get({trans:oe,key:O}).then(function(be){return re.hook.reading.fire(be)})}).then(H)},Ss.prototype.where=function(O){if(typeof O=="string")return new this.db.WhereClause(this,O);if(o(O))return new this.db.WhereClause(this,"[".concat(O.join("+"),"]"));var H=a(O);if(H.length===1)return this.where(H[0]).equals(O[H[0]]);var re=this.schema.indexes.concat(this.schema.primKey).filter(function(Ke){if(Ke.compound&&H.every(function(lt){return 0<=Ke.keyPath.indexOf(lt)})){for(var it=0;it<H.length;++it)if(H.indexOf(Ke.keyPath[it])===-1)return!1;return!0}return!1}).sort(function(Ke,it){return Ke.keyPath.length-it.keyPath.length})[0];if(re&&this.db._maxKey!==ps){var Oe=re.keyPath.slice(0,H.length);return this.where(Oe).equals(Oe.map(function(it){return O[it]}))}!re&&Be&&console.warn("The query ".concat(JSON.stringify(O)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(H.join("+"),"]"));var oe=this.schema.idxByName;function be(Ke,it){return Fr(Ke,it)===0}var ze=H.reduce(function(Qe,it){var lt=Qe[0],mt=Qe[1],Qe=oe[it],yt=O[it];return[lt||Qe,lt||!Qe?fo(mt,Qe&&Qe.multi?function(st){return st=T(st,it),o(st)&&st.some(function(pt){return be(yt,pt)})}:function(st){return be(yt,T(st,it))}):mt]},[null,null]),Oe=ze[0],ze=ze[1];return Oe?this.where(Oe.name).equals(O[Oe.keyPath]).filter(ze):re?this.filter(ze):this.where(H).equals("")},Ss.prototype.filter=function(O){return this.toCollection().and(O)},Ss.prototype.count=function(O){return this.toCollection().count(O)},Ss.prototype.offset=function(O){return this.toCollection().offset(O)},Ss.prototype.limit=function(O){return this.toCollection().limit(O)},Ss.prototype.each=function(O){return this.toCollection().each(O)},Ss.prototype.toArray=function(O){return this.toCollection().toArray(O)},Ss.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ss.prototype.orderBy=function(O){return new this.db.Collection(new this.db.WhereClause(this,o(O)?"[".concat(O.join("+"),"]"):O))},Ss.prototype.reverse=function(){return this.toCollection().reverse()},Ss.prototype.mapToClass=function(O){var H,re=this.db,oe=this.name;function be(){return H!==null&&H.apply(this,arguments)||this}(this.schema.mappedClass=O).prototype instanceof Gf&&(function(it,lt){if(typeof lt!="function"&&lt!==null)throw new TypeError("Class extends value "+String(lt)+" is not a constructor or null");function mt(){this.constructor=it}n(it,lt),it.prototype=lt===null?Object.create(lt):(mt.prototype=lt.prototype,new mt)}(be,H=O),Object.defineProperty(be.prototype,"db",{get:function(){return re},enumerable:!1,configurable:!0}),be.prototype.table=function(){return oe},O=be);for(var Oe=new Set,ze=O.prototype;ze;ze=c(ze))Object.getOwnPropertyNames(ze).forEach(function(it){return Oe.add(it)});function Ke(it){if(!it)return it;var lt,mt=Object.create(O.prototype);for(lt in it)if(!Oe.has(lt))try{mt[lt]=it[lt]}catch{}return mt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Ke,this.hook("reading",Ke),O},Ss.prototype.defineClass=function(){return this.mapToClass(function(O){l(this,O)})},Ss.prototype.add=function(O,H){var re=this,oe=this.schema.primKey,be=oe.auto,Oe=oe.keyPath,ze=O;return Oe&&be&&(ze=hu(Oe)(O)),this._trans("readwrite",function(Ke){return re.core.mutate({trans:Ke,type:"add",keys:H!=null?[H]:null,values:[ze]})}).then(function(Ke){return Ke.numFailures?W.reject(Ke.failures[0]):Ke.lastResult}).then(function(Ke){if(Oe)try{A(O,Oe,Ke)}catch{}return Ke})},Ss.prototype.update=function(O,H){return typeof O!="object"||o(O)?this.where(":id").equals(O).modify(H):(O=T(O,this.schema.primKey.keyPath),O===void 0?tr(new pe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(O).modify(H))},Ss.prototype.put=function(O,H){var re=this,oe=this.schema.primKey,be=oe.auto,Oe=oe.keyPath,ze=O;return Oe&&be&&(ze=hu(Oe)(O)),this._trans("readwrite",function(Ke){return re.core.mutate({trans:Ke,type:"put",values:[ze],keys:H!=null?[H]:null})}).then(function(Ke){return Ke.numFailures?W.reject(Ke.failures[0]):Ke.lastResult}).then(function(Ke){if(Oe)try{A(O,Oe,Ke)}catch{}return Ke})},Ss.prototype.delete=function(O){var H=this;return this._trans("readwrite",function(re){return H.core.mutate({trans:re,type:"delete",keys:[O]})}).then(function(re){return re.numFailures?W.reject(re.failures[0]):void 0})},Ss.prototype.clear=function(){var O=this;return this._trans("readwrite",function(H){return O.core.mutate({trans:H,type:"deleteRange",range:ho})}).then(function(H){return H.numFailures?W.reject(H.failures[0]):void 0})},Ss.prototype.bulkGet=function(O){var H=this;return this._trans("readonly",function(re){return H.core.getMany({keys:O,trans:re}).then(function(oe){return oe.map(function(be){return H.hook.reading.fire(be)})})})},Ss.prototype.bulkAdd=function(O,H,re){var oe=this,be=Array.isArray(H)?H:void 0,Oe=(re=re||(be?void 0:H))?re.allKeys:void 0;return this._trans("readwrite",function(ze){var lt=oe.schema.primKey,Ke=lt.auto,lt=lt.keyPath;if(lt&&be)throw new pe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(be&&be.length!==O.length)throw new pe.InvalidArgument("Arguments objects and keys must have the same length");var it=O.length,lt=lt&&Ke?O.map(hu(lt)):O;return oe.core.mutate({trans:ze,type:"add",keys:be,values:lt,wantResults:Oe}).then(function(pt){var Qe=pt.numFailures,yt=pt.results,st=pt.lastResult,pt=pt.failures;if(Qe===0)return Oe?yt:st;throw new Se("".concat(oe.name,".bulkAdd(): ").concat(Qe," of ").concat(it," operations failed"),pt)})})},Ss.prototype.bulkPut=function(O,H,re){var oe=this,be=Array.isArray(H)?H:void 0,Oe=(re=re||(be?void 0:H))?re.allKeys:void 0;return this._trans("readwrite",function(ze){var lt=oe.schema.primKey,Ke=lt.auto,lt=lt.keyPath;if(lt&&be)throw new pe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(be&&be.length!==O.length)throw new pe.InvalidArgument("Arguments objects and keys must have the same length");var it=O.length,lt=lt&&Ke?O.map(hu(lt)):O;return oe.core.mutate({trans:ze,type:"put",keys:be,values:lt,wantResults:Oe}).then(function(pt){var Qe=pt.numFailures,yt=pt.results,st=pt.lastResult,pt=pt.failures;if(Qe===0)return Oe?yt:st;throw new Se("".concat(oe.name,".bulkPut(): ").concat(Qe," of ").concat(it," operations failed"),pt)})})},Ss.prototype.bulkUpdate=function(O){var H=this,re=this.core,oe=O.map(function(ze){return ze.key}),be=O.map(function(ze){return ze.changes}),Oe=[];return this._trans("readwrite",function(ze){return re.getMany({trans:ze,keys:oe,cache:"clone"}).then(function(Ke){var it=[],lt=[];O.forEach(function(Qe,yt){var st=Qe.key,pt=Qe.changes,bt=Ke[yt];if(bt){for(var ct=0,kt=Object.keys(pt);ct<kt.length;ct++){var Mt=kt[ct],jt=pt[Mt];if(Mt===H.schema.primKey.keyPath){if(Fr(jt,st)!==0)throw new pe.Constraint("Cannot update primary key in bulkUpdate()")}else A(bt,Mt,jt)}Oe.push(yt),it.push(st),lt.push(bt)}});var mt=it.length;return re.mutate({trans:ze,type:"put",keys:it,values:lt,updates:{keys:oe,changeSpecs:be}}).then(function(Qe){var yt=Qe.numFailures,st=Qe.failures;if(yt===0)return mt;for(var pt=0,bt=Object.keys(st);pt<bt.length;pt++){var ct,kt=bt[pt],Mt=Oe[Number(kt)];Mt!=null&&(ct=st[kt],delete st[kt],st[Mt]=ct)}throw new Se("".concat(H.name,".bulkUpdate(): ").concat(yt," of ").concat(mt," operations failed"),st)})})})},Ss.prototype.bulkDelete=function(O){var H=this,re=O.length;return this._trans("readwrite",function(oe){return H.core.mutate({trans:oe,type:"delete",keys:O})}).then(function(ze){var be=ze.numFailures,Oe=ze.lastResult,ze=ze.failures;if(be===0)return Oe;throw new Se("".concat(H.name,".bulkDelete(): ").concat(be," of ").concat(re," operations failed"),ze)})},Ss);function Ss(){}function po(O){function H(ze,Ke){if(Ke){for(var it=arguments.length,lt=new Array(it-1);--it;)lt[it-1]=arguments[it];return re[ze].subscribe.apply(null,lt),O}if(typeof ze=="string")return re[ze]}var re={};H.addEventType=Oe;for(var oe=1,be=arguments.length;oe<be;++oe)Oe(arguments[oe]);return H;function Oe(ze,Ke,it){if(typeof ze!="object"){var lt;Ke=Ke||se;var mt={subscribers:[],fire:it=it||Fe,subscribe:function(Qe){mt.subscribers.indexOf(Qe)===-1&&(mt.subscribers.push(Qe),mt.fire=Ke(mt.fire,Qe))},unsubscribe:function(Qe){mt.subscribers=mt.subscribers.filter(function(yt){return yt!==Qe}),mt.fire=mt.subscribers.reduce(Ke,it)}};return re[ze]=H[ze]=mt}a(lt=ze).forEach(function(Qe){var yt=lt[Qe];if(o(yt))Oe(Qe,lt[Qe][0],lt[Qe][1]);else{if(yt!=="asap")throw new pe.InvalidArgument("Invalid event config");var st=Oe(Qe,Ie,function(){for(var pt=arguments.length,bt=new Array(pt);pt--;)bt[pt]=arguments[pt];st.subscribers.forEach(function(ct){k(function(){ct.apply(null,bt)})})})}})}}function pu(O,H){return y(H).from({prototype:O}),H}function hl(O,H){return!(O.filter||O.algorithm||O.or)&&(H?O.justLimit:!O.replayFilter)}function Wp(O,H){O.filter=fo(O.filter,H)}function Di(O,H,re){var oe=O.replayFilter;O.replayFilter=oe?function(){return fo(oe(),H())}:H,O.justLimit=re&&!oe}function mu(O,H){if(O.isPrimKey)return H.primaryKey;var re=H.getIndexByKeyPath(O.index);if(!re)throw new pe.Schema("KeyPath "+O.index+" on object store "+H.name+" is not indexed");return re}function Hp(O,H,re){var oe=mu(O,H.schema);return H.openCursor({trans:re,values:!O.keysOnly,reverse:O.dir==="prev",unique:!!O.unique,query:{index:oe,range:O.range}})}function Rc(O,H,re,oe){var be=O.replayFilter?fo(O.filter,O.replayFilter()):O.filter;if(O.or){var Oe={},ze=function(Ke,it,lt){var mt,Qe;be&&!be(it,lt,function(yt){return it.stop(yt)},function(yt){return it.fail(yt)})||((Qe=""+(mt=it.primaryKey))=="[object ArrayBuffer]"&&(Qe=""+new Uint8Array(mt)),d(Oe,Qe)||(Oe[Qe]=!0,H(Ke,it,lt)))};return Promise.all([O.or._iterate(ze,re),kd(Hp(O,oe,re),O.algorithm,ze,!O.keysOnly&&O.valueMapper)])}return kd(Hp(O,oe,re),fo(O.algorithm,be),H,!O.keysOnly&&O.valueMapper)}function kd(O,H,re,oe){var be=$e(oe?function(Oe,ze,Ke){return re(oe(Oe),ze,Ke)}:re);return O.then(function(Oe){if(Oe)return Oe.start(function(){var ze=function(){return Oe.continue()};H&&!H(Oe,function(Ke){return ze=Ke},function(Ke){Oe.stop(Ke),ze=Fe},function(Ke){Oe.fail(Ke),ze=Fe})||be(Oe.value,Oe,function(Ke){return ze=Ke}),ze()})})}var Kf=(bv.prototype.execute=function(O){var H=this["@@propmod"];if(H.add!==void 0){var re=H.add;if(o(re))return s(s([],o(O)?O:[],!0),re).sort();if(typeof re=="number")return(Number(O)||0)+re;if(typeof re=="bigint")try{return BigInt(O)+re}catch{return BigInt(0)+re}throw new TypeError("Invalid term ".concat(re))}if(H.remove!==void 0){var oe=H.remove;if(o(oe))return o(O)?O.filter(function(be){return!oe.includes(be)}).sort():[];if(typeof oe=="number")return Number(O)-oe;if(typeof oe=="bigint")try{return BigInt(O)-oe}catch{return BigInt(0)-oe}throw new TypeError("Invalid subtrahend ".concat(oe))}return re=(re=H.replacePrefix)===null||re===void 0?void 0:re[0],re&&typeof O=="string"&&O.startsWith(re)?H.replacePrefix[1]+O.substring(re.length):O},bv);function bv(O){this["@@propmod"]=O}var Yf=(ts.prototype._read=function(O,H){var re=this._ctx;return re.error?re.table._trans(null,tr.bind(null,re.error)):re.table._trans("readonly",O).then(H)},ts.prototype._write=function(O){var H=this._ctx;return H.error?H.table._trans(null,tr.bind(null,H.error)):H.table._trans("readwrite",O,"locked")},ts.prototype._addAlgorithm=function(O){var H=this._ctx;H.algorithm=fo(H.algorithm,O)},ts.prototype._iterate=function(O,H){return Rc(this._ctx,O,H,this._ctx.table.core)},ts.prototype.clone=function(O){var H=Object.create(this.constructor.prototype),re=Object.create(this._ctx);return O&&l(re,O),H._ctx=re,H},ts.prototype.raw=function(){return this._ctx.valueMapper=null,this},ts.prototype.each=function(O){var H=this._ctx;return this._read(function(re){return Rc(H,O,re,H.table.core)})},ts.prototype.count=function(O){var H=this;return this._read(function(re){var oe=H._ctx,be=oe.table.core;if(hl(oe,!0))return be.count({trans:re,query:{index:mu(oe,be.schema),range:oe.range}}).then(function(ze){return Math.min(ze,oe.limit)});var Oe=0;return Rc(oe,function(){return++Oe,!1},re,be).then(function(){return Oe})}).then(O)},ts.prototype.sortBy=function(O,H){var re=O.split(".").reverse(),oe=re[0],be=re.length-1;function Oe(it,lt){return lt?Oe(it[re[lt]],lt-1):it[oe]}var ze=this._ctx.dir==="next"?1:-1;function Ke(it,lt){return Fr(Oe(it,be),Oe(lt,be))*ze}return this.toArray(function(it){return it.sort(Ke)}).then(H)},ts.prototype.toArray=function(O){var H=this;return this._read(function(re){var oe=H._ctx;if(oe.dir==="next"&&hl(oe,!0)&&0<oe.limit){var be=oe.valueMapper,Oe=mu(oe,oe.table.core.schema);return oe.table.core.query({trans:re,limit:oe.limit,values:!0,query:{index:Oe,range:oe.range}}).then(function(Ke){return Ke=Ke.result,be?Ke.map(be):Ke})}var ze=[];return Rc(oe,function(Ke){return ze.push(Ke)},re,oe.table.core).then(function(){return ze})},O)},ts.prototype.offset=function(O){var H=this._ctx;return O<=0||(H.offset+=O,hl(H)?Di(H,function(){var re=O;return function(oe,be){return re===0||(re===1?--re:be(function(){oe.advance(re),re=0}),!1)}}):Di(H,function(){var re=O;return function(){return--re<0}})),this},ts.prototype.limit=function(O){return this._ctx.limit=Math.min(this._ctx.limit,O),Di(this._ctx,function(){var H=O;return function(re,oe,be){return--H<=0&&oe(be),0<=H}},!0),this},ts.prototype.until=function(O,H){return Wp(this._ctx,function(re,oe,be){return!O(re.value)||(oe(be),H)}),this},ts.prototype.first=function(O){return this.limit(1).toArray(function(H){return H[0]}).then(O)},ts.prototype.last=function(O){return this.reverse().first(O)},ts.prototype.filter=function(O){var H;return Wp(this._ctx,function(re){return O(re.value)}),(H=this._ctx).isMatch=fo(H.isMatch,O),this},ts.prototype.and=function(O){return this.filter(O)},ts.prototype.or=function(O){return new this.db.WhereClause(this._ctx.table,O,this)},ts.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ts.prototype.desc=function(){return this.reverse()},ts.prototype.eachKey=function(O){var H=this._ctx;return H.keysOnly=!H.isMatch,this.each(function(re,oe){O(oe.key,oe)})},ts.prototype.eachUniqueKey=function(O){return this._ctx.unique="unique",this.eachKey(O)},ts.prototype.eachPrimaryKey=function(O){var H=this._ctx;return H.keysOnly=!H.isMatch,this.each(function(re,oe){O(oe.primaryKey,oe)})},ts.prototype.keys=function(O){var H=this._ctx;H.keysOnly=!H.isMatch;var re=[];return this.each(function(oe,be){re.push(be.key)}).then(function(){return re}).then(O)},ts.prototype.primaryKeys=function(O){var H=this._ctx;if(H.dir==="next"&&hl(H,!0)&&0<H.limit)return this._read(function(oe){var be=mu(H,H.table.core.schema);return H.table.core.query({trans:oe,values:!1,limit:H.limit,query:{index:be,range:H.range}})}).then(function(oe){return oe.result}).then(O);H.keysOnly=!H.isMatch;var re=[];return this.each(function(oe,be){re.push(be.primaryKey)}).then(function(){return re}).then(O)},ts.prototype.uniqueKeys=function(O){return this._ctx.unique="unique",this.keys(O)},ts.prototype.firstKey=function(O){return this.limit(1).keys(function(H){return H[0]}).then(O)},ts.prototype.lastKey=function(O){return this.reverse().firstKey(O)},ts.prototype.distinct=function(){var O=this._ctx,O=O.index&&O.table.schema.idxByName[O.index];if(!O||!O.multi)return this;var H={};return Wp(this._ctx,function(be){var oe=be.primaryKey.toString(),be=d(H,oe);return H[oe]=!0,!be}),this},ts.prototype.modify=function(O){var H=this,re=this._ctx;return this._write(function(oe){var be,Oe,ze;ze=typeof O=="function"?O:(be=a(O),Oe=be.length,function(ct){for(var kt=!1,Mt=0;Mt<Oe;++Mt){var jt=be[Mt],Ot=O[jt],Xt=T(ct,jt);Ot instanceof Kf?(A(ct,jt,Ot.execute(Xt)),kt=!0):Xt!==Ot&&(A(ct,jt,Ot),kt=!0)}return kt});var Ke=re.table.core,Qe=Ke.schema.primaryKey,it=Qe.outbound,lt=Qe.extractKey,mt=200,Qe=H.db._options.modifyChunkSize;Qe&&(mt=typeof Qe=="object"?Qe[Ke.name]||Qe["*"]||200:Qe);function yt(ct,jt){var Mt=jt.failures,jt=jt.numFailures;pt+=ct-jt;for(var Ot=0,Xt=a(Mt);Ot<Xt.length;Ot++){var sn=Xt[Ot];st.push(Mt[sn])}}var st=[],pt=0,bt=[];return H.clone().primaryKeys().then(function(ct){function kt(jt){var Ot=Math.min(mt,ct.length-jt);return Ke.getMany({trans:oe,keys:ct.slice(jt,jt+Ot),cache:"immutable"}).then(function(Xt){for(var sn=[],Kt=[],tn=it?[]:null,ln=[],Yt=0;Yt<Ot;++Yt){var bn=Xt[Yt],Wn={value:q(bn),primKey:ct[jt+Yt]};ze.call(Wn,Wn.value,Wn)!==!1&&(Wn.value==null?ln.push(ct[jt+Yt]):it||Fr(lt(bn),lt(Wn.value))===0?(Kt.push(Wn.value),it&&tn.push(ct[jt+Yt])):(ln.push(ct[jt+Yt]),sn.push(Wn.value)))}return Promise.resolve(0<sn.length&&Ke.mutate({trans:oe,type:"add",values:sn}).then(function(Xn){for(var vr in Xn.failures)ln.splice(parseInt(vr),1);yt(sn.length,Xn)})).then(function(){return(0<Kt.length||Mt&&typeof O=="object")&&Ke.mutate({trans:oe,type:"put",keys:tn,values:Kt,criteria:Mt,changeSpec:typeof O!="function"&&O,isAdditionalChunk:0<jt}).then(function(Xn){return yt(Kt.length,Xn)})}).then(function(){return(0<ln.length||Mt&&O===Wg)&&Ke.mutate({trans:oe,type:"delete",keys:ln,criteria:Mt,isAdditionalChunk:0<jt}).then(function(Xn){return yt(ln.length,Xn)})}).then(function(){return ct.length>jt+Ot&&kt(jt+mt)})})}var Mt=hl(re)&&re.limit===1/0&&(typeof O!="function"||O===Wg)&&{index:re.index,range:re.range};return kt(0).then(function(){if(0<st.length)throw new le("Error modifying one or more objects",st,pt,bt);return ct.length})})})},ts.prototype.delete=function(){var O=this._ctx,H=O.range;return hl(O)&&(O.isPrimKey||H.type===3)?this._write(function(re){var oe=O.table.core.schema.primaryKey,be=H;return O.table.core.count({trans:re,query:{index:oe,range:be}}).then(function(Oe){return O.table.core.mutate({trans:re,type:"deleteRange",range:be}).then(function(ze){var Ke=ze.failures;if(ze.lastResult,ze.results,ze=ze.numFailures,ze)throw new le("Could not delete some values",Object.keys(Ke).map(function(it){return Ke[it]}),Oe-ze);return Oe-ze})})}):this.modify(Wg)},ts);function ts(){}var Wg=function(O,H){return H.value=null};function __(O,H){return O<H?-1:O===H?0:1}function vv(O,H){return H<O?-1:O===H?0:1}function mo(O,H,re){return O=O instanceof Td?new O.Collection(O):O,O._ctx.error=new(re||TypeError)(H),O}function Zf(O){return new O.Collection(O,function(){return Hg("")}).limit(0)}function Ed(O,H,re,oe){var be,Oe,ze,Ke,it,lt,mt,Qe=re.length;if(!re.every(function(pt){return typeof pt=="string"}))return mo(O,xi);function yt(pt){be=pt==="next"?function(ct){return ct.toUpperCase()}:function(ct){return ct.toLowerCase()},Oe=pt==="next"?function(ct){return ct.toLowerCase()}:function(ct){return ct.toUpperCase()},ze=pt==="next"?__:vv;var bt=re.map(function(ct){return{lower:Oe(ct),upper:be(ct)}}).sort(function(ct,kt){return ze(ct.lower,kt.lower)});Ke=bt.map(function(ct){return ct.upper}),it=bt.map(function(ct){return ct.lower}),mt=(lt=pt)==="next"?"":oe}yt("next"),O=new O.Collection(O,function(){return $l(Ke[0],it[Qe-1]+oe)}),O._ondirectionchange=function(pt){yt(pt)};var st=0;return O._addAlgorithm(function(pt,bt,ct){var kt=pt.key;if(typeof kt!="string")return!1;var Mt=Oe(kt);if(H(Mt,it,st))return!0;for(var jt=null,Ot=st;Ot<Qe;++Ot){var Xt=function(sn,Kt,tn,ln,Yt,bn){for(var Wn=Math.min(sn.length,ln.length),Xn=-1,vr=0;vr<Wn;++vr){var Aa=Kt[vr];if(Aa!==ln[vr])return Yt(sn[vr],tn[vr])<0?sn.substr(0,vr)+tn[vr]+tn.substr(vr+1):Yt(sn[vr],ln[vr])<0?sn.substr(0,vr)+ln[vr]+tn.substr(vr+1):0<=Xn?sn.substr(0,Xn)+Kt[Xn]+tn.substr(Xn+1):null;Yt(sn[vr],Aa)<0&&(Xn=vr)}return Wn<ln.length&&bn==="next"?sn+tn.substr(sn.length):Wn<sn.length&&bn==="prev"?sn.substr(0,tn.length):Xn<0?null:sn.substr(0,Xn)+ln[Xn]+tn.substr(Xn+1)}(kt,Mt,Ke[Ot],it[Ot],ze,lt);Xt===null&&jt===null?st=Ot+1:(jt===null||0<ze(jt,Xt))&&(jt=Xt)}return bt(jt!==null?function(){pt.continue(jt+mt)}:ct),!1}),O}function $l(O,H,re,oe){return{type:2,lower:O,upper:H,lowerOpen:re,upperOpen:oe}}function Hg(O){return{type:1,lower:O,upper:O}}var Td=(Object.defineProperty(qs.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),qs.prototype.between=function(O,H,re,oe){re=re!==!1,oe=oe===!0;try{return 0<this._cmp(O,H)||this._cmp(O,H)===0&&(re||oe)&&(!re||!oe)?Zf(this):new this.Collection(this,function(){return $l(O,H,!re,!oe)})}catch{return mo(this,es)}},qs.prototype.equals=function(O){return O==null?mo(this,es):new this.Collection(this,function(){return Hg(O)})},qs.prototype.above=function(O){return O==null?mo(this,es):new this.Collection(this,function(){return $l(O,void 0,!0)})},qs.prototype.aboveOrEqual=function(O){return O==null?mo(this,es):new this.Collection(this,function(){return $l(O,void 0,!1)})},qs.prototype.below=function(O){return O==null?mo(this,es):new this.Collection(this,function(){return $l(void 0,O,!1,!0)})},qs.prototype.belowOrEqual=function(O){return O==null?mo(this,es):new this.Collection(this,function(){return $l(void 0,O)})},qs.prototype.startsWith=function(O){return typeof O!="string"?mo(this,xi):this.between(O,O+ps,!0,!0)},qs.prototype.startsWithIgnoreCase=function(O){return O===""?this.startsWith(O):Ed(this,function(H,re){return H.indexOf(re[0])===0},[O],ps)},qs.prototype.equalsIgnoreCase=function(O){return Ed(this,function(H,re){return H===re[0]},[O],"")},qs.prototype.anyOfIgnoreCase=function(){var O=B.apply(Y,arguments);return O.length===0?Zf(this):Ed(this,function(H,re){return re.indexOf(H)!==-1},O,"")},qs.prototype.startsWithAnyOfIgnoreCase=function(){var O=B.apply(Y,arguments);return O.length===0?Zf(this):Ed(this,function(H,re){return re.some(function(oe){return H.indexOf(oe)===0})},O,ps)},qs.prototype.anyOf=function(){var O=this,H=B.apply(Y,arguments),re=this._cmp;try{H.sort(re)}catch{return mo(this,es)}if(H.length===0)return Zf(this);var oe=new this.Collection(this,function(){return $l(H[0],H[H.length-1])});oe._ondirectionchange=function(Oe){re=Oe==="next"?O._ascending:O._descending,H.sort(re)};var be=0;return oe._addAlgorithm(function(Oe,ze,Ke){for(var it=Oe.key;0<re(it,H[be]);)if(++be===H.length)return ze(Ke),!1;return re(it,H[be])===0||(ze(function(){Oe.continue(H[be])}),!1)}),oe},qs.prototype.notEqual=function(O){return this.inAnyRange([[-1/0,O],[O,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},qs.prototype.noneOf=function(){var O=B.apply(Y,arguments);if(O.length===0)return new this.Collection(this);try{O.sort(this._ascending)}catch{return mo(this,es)}var H=O.reduce(function(re,oe){return re?re.concat([[re[re.length-1][1],oe]]):[[-1/0,oe]]},null);return H.push([O[O.length-1],this.db._maxKey]),this.inAnyRange(H,{includeLowers:!1,includeUppers:!1})},qs.prototype.inAnyRange=function(kt,H){var re=this,oe=this._cmp,be=this._ascending,Oe=this._descending,ze=this._min,Ke=this._max;if(kt.length===0)return Zf(this);if(!kt.every(function(Mt){return Mt[0]!==void 0&&Mt[1]!==void 0&&be(Mt[0],Mt[1])<=0}))return mo(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",pe.InvalidArgument);var it=!H||H.includeLowers!==!1,lt=H&&H.includeUppers===!0,mt,Qe=be;function yt(Mt,jt){return Qe(Mt[0],jt[0])}try{(mt=kt.reduce(function(Mt,jt){for(var Ot=0,Xt=Mt.length;Ot<Xt;++Ot){var sn=Mt[Ot];if(oe(jt[0],sn[1])<0&&0<oe(jt[1],sn[0])){sn[0]=ze(sn[0],jt[0]),sn[1]=Ke(sn[1],jt[1]);break}}return Ot===Xt&&Mt.push(jt),Mt},[])).sort(yt)}catch{return mo(this,es)}var st=0,pt=lt?function(Mt){return 0<be(Mt,mt[st][1])}:function(Mt){return 0<=be(Mt,mt[st][1])},bt=it?function(Mt){return 0<Oe(Mt,mt[st][0])}:function(Mt){return 0<=Oe(Mt,mt[st][0])},ct=pt,kt=new this.Collection(this,function(){return $l(mt[0][0],mt[mt.length-1][1],!it,!lt)});return kt._ondirectionchange=function(Mt){Qe=Mt==="next"?(ct=pt,be):(ct=bt,Oe),mt.sort(yt)},kt._addAlgorithm(function(Mt,jt,Ot){for(var Xt,sn=Mt.key;ct(sn);)if(++st===mt.length)return jt(Ot),!1;return!pt(Xt=sn)&&!bt(Xt)||(re._cmp(sn,mt[st][1])===0||re._cmp(sn,mt[st][0])===0||jt(function(){Qe===be?Mt.continue(mt[st][0]):Mt.continue(mt[st][1])}),!1)}),kt},qs.prototype.startsWithAnyOf=function(){var O=B.apply(Y,arguments);return O.every(function(H){return typeof H=="string"})?O.length===0?Zf(this):this.inAnyRange(O.map(function(H){return[H,H+ps]})):mo(this,"startsWithAnyOf() only works with strings")},qs);function qs(){}function pl(O){return $e(function(H){return Ad(H),O(H.target.error),!1})}function Ad(O){O.stopPropagation&&O.stopPropagation(),O.preventDefault&&O.preventDefault()}var Xf="storagemutated",Nd="x-storagemutated-1",ua=po(null,Xf),xv=(Ua.prototype._lock=function(){return _(!Me.global),++this._reculock,this._reculock!==1||Me.global||(Me.lockOwnerFor=this),this},Ua.prototype._unlock=function(){if(_(!Me.global),--this._reculock==0)for(Me.global||(Me.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var O=this._blockedFuncs.shift();try{nt(O[1],O[0])}catch{}}return this},Ua.prototype._locked=function(){return this._reculock&&Me.lockOwnerFor!==this},Ua.prototype.create=function(O){var H=this;if(!this.mode)return this;var re=this.db.idbdb,oe=this.db._state.dbOpenError;if(_(!this.idbtrans),!O&&!re)switch(oe&&oe.name){case"DatabaseClosedError":throw new pe.DatabaseClosed(oe);case"MissingAPIError":throw new pe.MissingAPI(oe.message,oe);default:throw new pe.OpenFailed(oe)}if(!this.active)throw new pe.TransactionInactive;return _(this._completion._state===null),(O=this.idbtrans=O||(this.db.core||re).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=$e(function(be){Ad(be),H._reject(O.error)}),O.onabort=$e(function(be){Ad(be),H.active&&H._reject(new pe.Abort(O.error)),H.active=!1,H.on("abort").fire(be)}),O.oncomplete=$e(function(){H.active=!1,H._resolve(),"mutatedParts"in O&&ua.storagemutated.fire(O.mutatedParts)}),this},Ua.prototype._promise=function(O,H,re){var oe=this;if(O==="readwrite"&&this.mode!=="readwrite")return tr(new pe.ReadOnly("Transaction is readonly"));if(!this.active)return tr(new pe.TransactionInactive);if(this._locked())return new W(function(Oe,ze){oe._blockedFuncs.push([function(){oe._promise(O,H,re).then(Oe,ze)},Me])});if(re)return dn(function(){var Oe=new W(function(ze,Ke){oe._lock();var it=H(ze,Ke,oe);it&&it.then&&it.then(ze,Ke)});return Oe.finally(function(){return oe._unlock()}),Oe._lib=!0,Oe});var be=new W(function(Oe,ze){var Ke=H(Oe,ze,oe);Ke&&Ke.then&&Ke.then(Oe,ze)});return be._lib=!0,be},Ua.prototype._root=function(){return this.parent?this.parent._root():this},Ua.prototype.waitFor=function(O){var H,re=this._root(),oe=W.resolve(O);re._waitingFor?re._waitingFor=re._waitingFor.then(function(){return oe}):(re._waitingFor=oe,re._waitingQueue=[],H=re.idbtrans.objectStore(re.storeNames[0]),function Oe(){for(++re._spinCount;re._waitingQueue.length;)re._waitingQueue.shift()();re._waitingFor&&(H.get(-1/0).onsuccess=Oe)}());var be=re._waitingFor;return new W(function(Oe,ze){oe.then(function(Ke){return re._waitingQueue.push($e(Oe.bind(null,Ke)))},function(Ke){return re._waitingQueue.push($e(ze.bind(null,Ke)))}).finally(function(){re._waitingFor===be&&(re._waitingFor=null)})})},Ua.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new pe.Abort))},Ua.prototype.table=function(O){var H=this._memoizedTables||(this._memoizedTables={});if(d(H,O))return H[O];var re=this.schema[O];if(!re)throw new pe.NotFound("Table "+O+" not part of transaction");return re=new this.db.Table(O,re,this),re.core=this.db.core.table(O),H[O]=re},Ua);function Ua(){}function Bl(O,H,re,oe,be,Oe,ze){return{name:O,keyPath:H,unique:re,multi:oe,auto:be,compound:Oe,src:(re&&!ze?"&":"")+(oe?"*":"")+(be?"++":"")+Gg(H)}}function Gg(O){return typeof O=="string"?O:O?"["+[].join.call(O,"+")+"]":""}function Jf(O,H,re){return{name:O,primKey:H,indexes:re,mappedClass:null,idxByName:(oe=function(be){return[be.name,be]},re.reduce(function(be,Oe,ze){return ze=oe(Oe,ze),ze&&(be[ze[0]]=ze[1]),be},{}))};var oe}var Qf=function(O){try{return O.only([[]]),Qf=function(){return[[]]},[[]]}catch{return Qf=function(){return ps},ps}};function eh(O){return O==null?function(){}:typeof O=="string"?(H=O).split(".").length===1?function(re){return re[H]}:function(re){return T(re,H)}:function(re){return T(re,O)};var H}function Gp(O){return[].slice.call(O)}var C_=0;function Fi(O){return O==null?":id":typeof O=="string"?O:"[".concat(O.join("+"),"]")}function Rd(O,H,it){function oe(ct){if(ct.type===3)return null;if(ct.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var st=ct.lower,pt=ct.upper,bt=ct.lowerOpen,ct=ct.upperOpen;return st===void 0?pt===void 0?null:H.upperBound(pt,!!ct):pt===void 0?H.lowerBound(st,!!bt):H.bound(st,pt,!!bt,!!ct)}function be(yt){var st,pt=yt.name;return{name:pt,schema:yt,mutate:function(bt){var ct=bt.trans,kt=bt.type,Mt=bt.keys,jt=bt.values,Ot=bt.range;return new Promise(function(Xt,sn){Xt=$e(Xt);var Kt=ct.objectStore(pt),tn=Kt.keyPath==null,ln=kt==="put"||kt==="add";if(!ln&&kt!=="delete"&&kt!=="deleteRange")throw new Error("Invalid operation type: "+kt);var Yt,bn=(Mt||jt||{length:1}).length;if(Mt&&jt&&Mt.length!==jt.length)throw new Error("Given keys array must have same length as given values array.");if(bn===0)return Xt({numFailures:0,failures:{},results:[],lastResult:void 0});function Wn(fa){++Aa,Ad(fa)}var Xn=[],vr=[],Aa=0;if(kt==="deleteRange"){if(Ot.type===4)return Xt({numFailures:Aa,failures:vr,results:[],lastResult:void 0});Ot.type===3?Xn.push(Yt=Kt.clear()):Xn.push(Yt=Kt.delete(oe(Ot)))}else{var tn=ln?tn?[jt,Mt]:[jt,null]:[Mt,null],lr=tn[0],wi=tn[1];if(ln)for(var Li=0;Li<bn;++Li)Xn.push(Yt=wi&&wi[Li]!==void 0?Kt[kt](lr[Li],wi[Li]):Kt[kt](lr[Li])),Yt.onerror=Wn;else for(Li=0;Li<bn;++Li)Xn.push(Yt=Kt[kt](lr[Li])),Yt.onerror=Wn}function Ic(fa){fa=fa.target.result,Xn.forEach(function(Ul,vu){return Ul.error!=null&&(vr[vu]=Ul.error)}),Xt({numFailures:Aa,failures:vr,results:kt==="delete"?Mt:Xn.map(function(Ul){return Ul.result}),lastResult:fa})}Yt.onerror=function(fa){Wn(fa),Ic(fa)},Yt.onsuccess=Ic})},getMany:function(bt){var ct=bt.trans,kt=bt.keys;return new Promise(function(Mt,jt){Mt=$e(Mt);for(var Ot,Xt=ct.objectStore(pt),sn=kt.length,Kt=new Array(sn),tn=0,ln=0,Yt=function(Xn){Xn=Xn.target,Kt[Xn._pos]=Xn.result,++ln===tn&&Mt(Kt)},bn=pl(jt),Wn=0;Wn<sn;++Wn)kt[Wn]!=null&&((Ot=Xt.get(kt[Wn]))._pos=Wn,Ot.onsuccess=Yt,Ot.onerror=bn,++tn);tn===0&&Mt(Kt)})},get:function(bt){var ct=bt.trans,kt=bt.key;return new Promise(function(Mt,jt){Mt=$e(Mt);var Ot=ct.objectStore(pt).get(kt);Ot.onsuccess=function(Xt){return Mt(Xt.target.result)},Ot.onerror=pl(jt)})},query:(st=lt,function(bt){return new Promise(function(ct,kt){ct=$e(ct);var Mt,jt,Ot,tn=bt.trans,Xt=bt.values,sn=bt.limit,Yt=bt.query,Kt=sn===1/0?void 0:sn,ln=Yt.index,Yt=Yt.range,tn=tn.objectStore(pt),ln=ln.isPrimaryKey?tn:tn.index(ln.name),Yt=oe(Yt);if(sn===0)return ct({result:[]});st?((Kt=Xt?ln.getAll(Yt,Kt):ln.getAllKeys(Yt,Kt)).onsuccess=function(bn){return ct({result:bn.target.result})},Kt.onerror=pl(kt)):(Mt=0,jt=!Xt&&"openKeyCursor"in ln?ln.openKeyCursor(Yt):ln.openCursor(Yt),Ot=[],jt.onsuccess=function(bn){var Wn=jt.result;return Wn?(Ot.push(Xt?Wn.value:Wn.primaryKey),++Mt===sn?ct({result:Ot}):void Wn.continue()):ct({result:Ot})},jt.onerror=pl(kt))})}),openCursor:function(bt){var ct=bt.trans,kt=bt.values,Mt=bt.query,jt=bt.reverse,Ot=bt.unique;return new Promise(function(Xt,sn){Xt=$e(Xt);var ln=Mt.index,Kt=Mt.range,tn=ct.objectStore(pt),tn=ln.isPrimaryKey?tn:tn.index(ln.name),ln=jt?Ot?"prevunique":"prev":Ot?"nextunique":"next",Yt=!kt&&"openKeyCursor"in tn?tn.openKeyCursor(oe(Kt),ln):tn.openCursor(oe(Kt),ln);Yt.onerror=pl(sn),Yt.onsuccess=$e(function(bn){var Wn,Xn,vr,Aa,lr=Yt.result;lr?(lr.___id=++C_,lr.done=!1,Wn=lr.continue.bind(lr),Xn=(Xn=lr.continuePrimaryKey)&&Xn.bind(lr),vr=lr.advance.bind(lr),Aa=function(){throw new Error("Cursor not stopped")},lr.trans=ct,lr.stop=lr.continue=lr.continuePrimaryKey=lr.advance=function(){throw new Error("Cursor not started")},lr.fail=$e(sn),lr.next=function(){var wi=this,Li=1;return this.start(function(){return Li--?wi.continue():wi.stop()}).then(function(){return wi})},lr.start=function(wi){function Li(){if(Yt.result)try{wi()}catch(fa){lr.fail(fa)}else lr.done=!0,lr.start=function(){throw new Error("Cursor behind last entry")},lr.stop()}var Ic=new Promise(function(fa,Ul){fa=$e(fa),Yt.onerror=pl(Ul),lr.fail=Ul,lr.stop=function(vu){lr.stop=lr.continue=lr.continuePrimaryKey=lr.advance=Aa,fa(vu)}});return Yt.onsuccess=$e(function(fa){Yt.onsuccess=Li,Li()}),lr.continue=Wn,lr.continuePrimaryKey=Xn,lr.advance=vr,Li(),Ic},Xt(lr)):Xt(null)},sn)})},count:function(bt){var ct=bt.query,kt=bt.trans,Mt=ct.index,jt=ct.range;return new Promise(function(Ot,Xt){var sn=kt.objectStore(pt),Kt=Mt.isPrimaryKey?sn:sn.index(Mt.name),sn=oe(jt),Kt=sn?Kt.count(sn):Kt.count();Kt.onsuccess=$e(function(tn){return Ot(tn.target.result)}),Kt.onerror=pl(Xt)})}}}var Oe,ze,Ke,mt=(ze=it,Ke=Gp((Oe=O).objectStoreNames),{schema:{name:Oe.name,tables:Ke.map(function(yt){return ze.objectStore(yt)}).map(function(yt){var st=yt.keyPath,ct=yt.autoIncrement,pt=o(st),bt={},ct={name:yt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:st==null,compound:pt,keyPath:st,autoIncrement:ct,unique:!0,extractKey:eh(st)},indexes:Gp(yt.indexNames).map(function(kt){return yt.index(kt)}).map(function(Ot){var Mt=Ot.name,jt=Ot.unique,Xt=Ot.multiEntry,Ot=Ot.keyPath,Xt={name:Mt,compound:o(Ot),keyPath:Ot,unique:jt,multiEntry:Xt,extractKey:eh(Ot)};return bt[Fi(Ot)]=Xt}),getIndexByKeyPath:function(kt){return bt[Fi(kt)]}};return bt[":id"]=ct.primaryKey,st!=null&&(bt[Fi(st)]=ct.primaryKey),ct})},hasGetAll:0<Ke.length&&"getAll"in ze.objectStore(Ke[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),it=mt.schema,lt=mt.hasGetAll,mt=it.tables.map(be),Qe={};return mt.forEach(function(yt){return Qe[yt.name]=yt}),{stack:"dbcore",transaction:O.transaction.bind(O),table:function(yt){if(!Qe[yt])throw new Error("Table '".concat(yt,"' not found"));return Qe[yt]},MIN_KEY:-1/0,MAX_KEY:Qf(H),schema:it}}function Kg(O,H,re,oe){var be=re.IDBKeyRange;return re.indexedDB,{dbcore:(oe=Rd(H,be,oe),O.dbcore.reduce(function(Oe,ze){return ze=ze.create,r(r({},Oe),ze(Oe))},oe))}}function gu(O,oe){var re=oe.db,oe=Kg(O._middlewares,re,O._deps,oe);O.core=oe.dbcore,O.tables.forEach(function(be){var Oe=be.name;O.core.schema.tables.some(function(ze){return ze.name===Oe})&&(be.core=O.core.table(Oe),O[Oe]instanceof O.Table&&(O[Oe].core=be.core))})}function Yg(O,H,re,oe){re.forEach(function(be){var Oe=oe[be];H.forEach(function(ze){var Ke=function it(lt,mt){return v(lt,mt)||(lt=c(lt))&&it(lt,mt)}(ze,be);(!Ke||"value"in Ke&&Ke.value===void 0)&&(ze===O.Transaction.prototype||ze instanceof O.Transaction?g(ze,be,{get:function(){return this.table(be)},set:function(it){p(this,be,{value:it,writable:!0,configurable:!0,enumerable:!0})}}):ze[be]=new O.Table(be,Oe))})})}function Kp(O,H){H.forEach(function(re){for(var oe in re)re[oe]instanceof O.Table&&delete re[oe]})}function wv(O,H){return O._cfg.version-H._cfg.version}function Yp(O,H,re,oe){var be=O._dbSchema;re.objectStoreNames.contains("$meta")&&!be.$meta&&(be.$meta=Jf("$meta",E_("")[0],[]),O._storeNames.push("$meta"));var Oe=O._createTransaction("readwrite",O._storeNames,be);Oe.create(re),Oe._completion.catch(oe);var ze=Oe._reject.bind(Oe),Ke=Me.transless||Me;dn(function(){return Me.trans=Oe,Me.transless=Ke,H!==0?(gu(O,re),lt=H,((it=Oe).storeNames.includes("$meta")?it.table("$meta").get("version").then(function(mt){return mt??lt}):W.resolve(lt)).then(function(mt){return yt=mt,st=Oe,pt=re,bt=[],mt=(Qe=O)._versions,ct=Qe._dbSchema=th(0,Qe.idbdb,pt),(mt=mt.filter(function(kt){return kt._cfg.version>=yt})).length!==0?(mt.forEach(function(kt){bt.push(function(){var Mt=ct,jt=kt._cfg.dbschema;Qg(Qe,Mt,pt),Qg(Qe,jt,pt),ct=Qe._dbSchema=jt;var Ot=Xg(Mt,jt);Ot.add.forEach(function(ln){Sv(pt,ln[0],ln[1].primKey,ln[1].indexes)}),Ot.change.forEach(function(ln){if(ln.recreate)throw new pe.Upgrade("Not yet support for changing primary key");var Yt=pt.objectStore(ln.name);ln.add.forEach(function(bn){return Jg(Yt,bn)}),ln.change.forEach(function(bn){Yt.deleteIndex(bn.name),Jg(Yt,bn)}),ln.del.forEach(function(bn){return Yt.deleteIndex(bn)})});var Xt=kt._cfg.contentUpgrade;if(Xt&&kt._cfg.version>yt){gu(Qe,pt),st._memoizedTables={};var sn=R(jt);Ot.del.forEach(function(ln){sn[ln]=Mt[ln]}),Kp(Qe,[Qe.Transaction.prototype]),Yg(Qe,[Qe.Transaction.prototype],a(sn),sn),st.schema=sn;var Kt,tn=G(Xt);return tn&&br(),Ot=W.follow(function(){var ln;(Kt=Xt(st))&&tn&&(ln=Cr.bind(null,null),Kt.then(ln,ln))}),Kt&&typeof Kt.then=="function"?W.resolve(Kt):Ot.then(function(){return Kt})}}),bt.push(function(Mt){var jt,Ot,Xt=kt._cfg.dbschema;jt=Xt,Ot=Mt,[].slice.call(Ot.db.objectStoreNames).forEach(function(sn){return jt[sn]==null&&Ot.db.deleteObjectStore(sn)}),Kp(Qe,[Qe.Transaction.prototype]),Yg(Qe,[Qe.Transaction.prototype],Qe._storeNames,Qe._dbSchema),st.schema=Qe._dbSchema}),bt.push(function(Mt){Qe.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Qe.idbdb.version/10)===kt._cfg.version?(Qe.idbdb.deleteObjectStore("$meta"),delete Qe._dbSchema.$meta,Qe._storeNames=Qe._storeNames.filter(function(jt){return jt!=="$meta"})):Mt.objectStore("$meta").put(kt._cfg.version,"version"))})}),function kt(){return bt.length?W.resolve(bt.shift()(st.idbtrans)).then(kt):W.resolve()}().then(function(){k_(ct,pt)})):W.resolve();var Qe,yt,st,pt,bt,ct}).catch(ze)):(a(be).forEach(function(mt){Sv(re,mt,be[mt].primKey,be[mt].indexes)}),gu(O,re),void W.follow(function(){return O.on.populate.fire(Oe)}).catch(ze));var it,lt})}function Zg(O,H){k_(O._dbSchema,H),H.db.version%10!=0||H.objectStoreNames.contains("$meta")||H.db.createObjectStore("$meta").add(Math.ceil(H.db.version/10-1),"version");var re=th(0,O.idbdb,H);Qg(O,O._dbSchema,H);for(var oe=0,be=Xg(re,O._dbSchema).change;oe<be.length;oe++){var Oe=function(ze){if(ze.change.length||ze.recreate)return console.warn("Unable to patch indexes of table ".concat(ze.name," because it has changes on the type of index or primary key.")),{value:void 0};var Ke=H.objectStore(ze.name);ze.add.forEach(function(it){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(ze.name,".").concat(it.src)),Jg(Ke,it)})}(be[oe]);if(typeof Oe=="object")return Oe.value}}function Xg(O,H){var re,oe={del:[],add:[],change:[]};for(re in O)H[re]||oe.del.push(re);for(re in H){var be=O[re],Oe=H[re];if(be){var ze={name:re,def:Oe,recreate:!1,del:[],add:[],change:[]};if(""+(be.primKey.keyPath||"")!=""+(Oe.primKey.keyPath||"")||be.primKey.auto!==Oe.primKey.auto)ze.recreate=!0,oe.change.push(ze);else{var Ke=be.idxByName,it=Oe.idxByName,lt=void 0;for(lt in Ke)it[lt]||ze.del.push(lt);for(lt in it){var mt=Ke[lt],Qe=it[lt];mt?mt.src!==Qe.src&&ze.change.push(Qe):ze.add.push(Qe)}(0<ze.del.length||0<ze.add.length||0<ze.change.length)&&oe.change.push(ze)}}else oe.add.push([re,Oe])}return oe}function Sv(O,H,re,oe){var be=O.db.createObjectStore(H,re.keyPath?{keyPath:re.keyPath,autoIncrement:re.auto}:{autoIncrement:re.auto});return oe.forEach(function(Oe){return Jg(be,Oe)}),be}function k_(O,H){a(O).forEach(function(re){H.db.objectStoreNames.contains(re)||(Be&&console.debug("Dexie: Creating missing table",re),Sv(H,re,O[re].primKey,O[re].indexes))})}function Jg(O,H){O.createIndex(H.name,H.keyPath,{unique:H.unique,multiEntry:H.multi})}function th(O,H,re){var oe={};return w(H.objectStoreNames,0).forEach(function(be){for(var Oe=re.objectStore(be),ze=Bl(Gg(lt=Oe.keyPath),lt||"",!0,!1,!!Oe.autoIncrement,lt&&typeof lt!="string",!0),Ke=[],it=0;it<Oe.indexNames.length;++it){var mt=Oe.index(Oe.indexNames[it]),lt=mt.keyPath,mt=Bl(mt.name,lt,!!mt.unique,!!mt.multiEntry,!1,lt&&typeof lt!="string",!1);Ke.push(mt)}oe[be]=Jf(be,ze,Ke)}),oe}function Qg(O,H,re){for(var oe=re.db.objectStoreNames,be=0;be<oe.length;++be){var Oe=oe[be],ze=re.objectStore(Oe);O._hasGetAll="getAll"in ze;for(var Ke=0;Ke<ze.indexNames.length;++Ke){var it=ze.indexNames[Ke],lt=ze.index(it).keyPath,mt=typeof lt=="string"?lt:"["+w(lt).join("+")+"]";!H[Oe]||(lt=H[Oe].idxByName[mt])&&(lt.name=it,delete H[Oe].idxByName[mt],H[Oe].idxByName[it]=lt)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(O._hasGetAll=!1)}function E_(O){return O.split(",").map(function(H,re){var oe=(H=H.trim()).replace(/([&*]|\+\+)/g,""),be=/^\[/.test(oe)?oe.match(/^\[(.*)\]$/)[1].split("+"):oe;return Bl(oe,be||null,/\&/.test(H),/\*/.test(H),/\+\+/.test(H),o(be),re===0)})}var XN=(e0.prototype._parseStoresSpec=function(O,H){a(O).forEach(function(re){if(O[re]!==null){var oe=E_(O[re]),be=oe.shift();if(be.unique=!0,be.multi)throw new pe.Schema("Primary key cannot be multi-valued");oe.forEach(function(Oe){if(Oe.auto)throw new pe.Schema("Only primary key can be marked as autoIncrement (++)");if(!Oe.keyPath)throw new pe.Schema("Index must have a name and cannot be an empty string")}),H[re]=Jf(re,be,oe)}})},e0.prototype.stores=function(re){var H=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,re):re;var re=H._versions,oe={},be={};return re.forEach(function(Oe){l(oe,Oe._cfg.storesSource),be=Oe._cfg.dbschema={},Oe._parseStoresSpec(oe,be)}),H._dbSchema=be,Kp(H,[H._allTables,H,H.Transaction.prototype]),Yg(H,[H._allTables,H,H.Transaction.prototype,this._cfg.tables],a(be),be),H._storeNames=a(be),this},e0.prototype.upgrade=function(O){return this._cfg.contentUpgrade=Pe(this._cfg.contentUpgrade||Fe,O),this},e0);function e0(){}function _v(O,H){var re=O._dbNamesDB;return re||(re=O._dbNamesDB=new zl(Ea,{addons:[],indexedDB:O,IDBKeyRange:H})).version(1).stores({dbnames:"name"}),re.table("dbnames")}function t0(O){return O&&typeof O.databases=="function"}function Cv(O){return dn(function(){return Me.letThrough=!0,O()})}function kv(O){return!("from"in O)}var da=function(O,H){if(!this){var re=new da;return O&&"d"in O&&l(re,O),re}l(this,arguments.length?{d:1,from:O,to:1<arguments.length?H:O}:{d:0})};function Zp(O,H,re){var oe=Fr(H,re);if(!isNaN(oe)){if(0<oe)throw RangeError();if(kv(O))return l(O,{from:H,to:re,d:1});var be=O.l,oe=O.r;if(Fr(re,O.from)<0)return be?Zp(be,H,re):O.l={from:H,to:re,d:1,l:null,r:null},A_(O);if(0<Fr(H,O.to))return oe?Zp(oe,H,re):O.r={from:H,to:re,d:1,l:null,r:null},A_(O);Fr(H,O.from)<0&&(O.from=H,O.l=null,O.d=oe?oe.d+1:1),0<Fr(re,O.to)&&(O.to=re,O.r=null,O.d=O.l?O.l.d+1:1),re=!O.r,be&&!O.l&&Id(O,be),oe&&re&&Id(O,oe)}}function Id(O,H){kv(H)||function re(oe,it){var Oe=it.from,ze=it.to,Ke=it.l,it=it.r;Zp(oe,Oe,ze),Ke&&re(oe,Ke),it&&re(oe,it)}(O,H)}function T_(O,H){var re=n0(H),oe=re.next();if(oe.done)return!1;for(var be=oe.value,Oe=n0(O),ze=Oe.next(be.from),Ke=ze.value;!oe.done&&!ze.done;){if(Fr(Ke.from,be.to)<=0&&0<=Fr(Ke.to,be.from))return!0;Fr(be.from,Ke.from)<0?be=(oe=re.next(Ke.from)).value:Ke=(ze=Oe.next(be.from)).value}return!1}function n0(O){var H=kv(O)?null:{s:0,n:O};return{next:function(re){for(var oe=0<arguments.length;H;)switch(H.s){case 0:if(H.s=1,oe)for(;H.n.l&&Fr(re,H.n.from)<0;)H={up:H,n:H.n.l,s:1};else for(;H.n.l;)H={up:H,n:H.n.l,s:1};case 1:if(H.s=2,!oe||Fr(re,H.n.to)<=0)return{value:H.n,done:!1};case 2:if(H.n.r){H.s=3,H={up:H,n:H.n.r,s:0};continue}case 3:H=H.up}return{done:!0}}}}function A_(O){var H,re,oe=(((H=O.r)===null||H===void 0?void 0:H.d)||0)-(((re=O.l)===null||re===void 0?void 0:re.d)||0),be=1<oe?"r":oe<-1?"l":"";be&&(H=be=="r"?"l":"r",re=r({},O),oe=O[be],O.from=oe.from,O.to=oe.to,O[be]=oe[be],re[be]=oe[H],(O[H]=re).d=Ev(re)),O.d=Ev(O)}function Ev(re){var H=re.r,re=re.l;return(H?re?Math.max(H.d,re.d):H.d:re?re.d:0)+1}function r0(O,H){return a(H).forEach(function(re){O[re]?Id(O[re],H[re]):O[re]=function oe(be){var Oe,ze,Ke={};for(Oe in be)d(be,Oe)&&(ze=be[Oe],Ke[Oe]=!ze||typeof ze!="object"||F.has(ze.constructor)?ze:oe(ze));return Ke}(H[re])}),O}function Tv(O,H){return O.all||H.all||Object.keys(O).some(function(re){return H[re]&&T_(H[re],O[re])})}h(da.prototype,((go={add:function(O){return Id(this,O),this},addKey:function(O){return Zp(this,O,O),this},addKeys:function(O){var H=this;return O.forEach(function(re){return Zp(H,re,re)}),this},hasKey:function(O){var H=n0(this).next(O).value;return H&&Fr(H.from,O)<=0&&0<=Fr(H.to,O)}})[D]=function(){return n0(this)},go));var Md={},Av={},Nv=!1;function s0(O){r0(Av,O),Nv||(Nv=!0,setTimeout(function(){Nv=!1,Rv(Av,!(Av={}))},0))}function Rv(O,H){H===void 0&&(H=!1);var re=new Set;if(O.all)for(var oe=0,be=Object.values(Md);oe<be.length;oe++)N_(ze=be[oe],O,re,H);else for(var Oe in O){var ze,Ke=/^idb\:\/\/(.*)\/(.*)\//.exec(Oe);Ke&&(Oe=Ke[1],Ke=Ke[2],(ze=Md["idb://".concat(Oe,"/").concat(Ke)])&&N_(ze,O,re,H))}re.forEach(function(it){return it()})}function N_(O,H,re,oe){for(var be=[],Oe=0,ze=Object.entries(O.queries.query);Oe<ze.length;Oe++){for(var Ke=ze[Oe],it=Ke[0],lt=[],mt=0,Qe=Ke[1];mt<Qe.length;mt++){var yt=Qe[mt];Tv(H,yt.obsSet)?yt.subscribers.forEach(function(ct){return re.add(ct)}):oe&&lt.push(yt)}oe&&be.push([it,lt])}if(oe)for(var st=0,pt=be;st<pt.length;st++){var bt=pt[st],it=bt[0],lt=bt[1];O.queries.query[it]=lt}}function JN(O){var H=O._state,re=O._deps.indexedDB;if(H.isBeingOpened||O.idbdb)return H.dbReadyPromise.then(function(){return H.dbOpenError?tr(H.dbOpenError):O});H.isBeingOpened=!0,H.dbOpenError=null,H.openComplete=!1;var oe=H.openCanceller,be=Math.round(10*O.verno),Oe=!1;function ze(){if(H.openCanceller!==oe)throw new pe.DatabaseClosed("db.open() was cancelled")}function Ke(){return new W(function(yt,st){if(ze(),!re)throw new pe.MissingAPI;var pt=O.name,bt=H.autoSchema||!be?re.open(pt):re.open(pt,be);if(!bt)throw new pe.MissingAPI;bt.onerror=pl(st),bt.onblocked=$e(O._fireOnBlocked),bt.onupgradeneeded=$e(function(ct){var kt;mt=bt.transaction,H.autoSchema&&!O._options.allowEmptyDB?(bt.onerror=Ad,mt.abort(),bt.result.close(),(kt=re.deleteDatabase(pt)).onsuccess=kt.onerror=$e(function(){st(new pe.NoSuchDatabase("Database ".concat(pt," doesnt exist")))})):(mt.onerror=pl(st),ct=ct.oldVersion>Math.pow(2,62)?0:ct.oldVersion,Qe=ct<1,O.idbdb=bt.result,Oe&&Zg(O,mt),Yp(O,ct/10,mt,st))},st),bt.onsuccess=$e(function(){mt=null;var ct,kt,Mt,jt,Ot,Xt=O.idbdb=bt.result,sn=w(Xt.objectStoreNames);if(0<sn.length)try{var Kt=Xt.transaction((jt=sn).length===1?jt[0]:jt,"readonly");if(H.autoSchema)kt=Xt,Mt=Kt,(ct=O).verno=kt.version/10,Mt=ct._dbSchema=th(0,kt,Mt),ct._storeNames=w(kt.objectStoreNames,0),Yg(ct,[ct._allTables],a(Mt),Mt);else if(Qg(O,O._dbSchema,Kt),((Ot=Xg(th(0,(Ot=O).idbdb,Kt),Ot._dbSchema)).add.length||Ot.change.some(function(tn){return tn.add.length||tn.change.length}))&&!Oe)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Xt.close(),be=Xt.version+1,Oe=!0,yt(Ke());gu(O,Kt)}catch{}si.push(O),Xt.onversionchange=$e(function(tn){H.vcFired=!0,O.on("versionchange").fire(tn)}),Xt.onclose=$e(function(tn){O.on("close").fire(tn)}),Qe&&(Ot=O._deps,Kt=pt,Xt=Ot.indexedDB,Ot=Ot.IDBKeyRange,t0(Xt)||Kt===Ea||_v(Xt,Ot).put({name:Kt}).catch(Fe)),yt()},st)}).catch(function(yt){switch(yt==null?void 0:yt.name){case"UnknownError":if(0<H.PR1398_maxLoop)return H.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Ke();break;case"VersionError":if(0<be)return be=0,Ke()}return W.reject(yt)})}var it,lt=H.dbReadyResolve,mt=null,Qe=!1;return W.race([oe,(typeof navigator>"u"?W.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(yt){function st(){return indexedDB.databases().finally(yt)}it=setInterval(st,100),st()}).finally(function(){return clearInterval(it)}):Promise.resolve()).then(Ke)]).then(function(){return ze(),H.onReadyBeingFired=[],W.resolve(Cv(function(){return O.on.ready.fire(O.vip)})).then(function yt(){if(0<H.onReadyBeingFired.length){var st=H.onReadyBeingFired.reduce(Pe,Fe);return H.onReadyBeingFired=[],W.resolve(Cv(function(){return st(O.vip)})).then(yt)}})}).finally(function(){H.openCanceller===oe&&(H.onReadyBeingFired=null,H.isBeingOpened=!1)}).catch(function(yt){H.dbOpenError=yt;try{mt&&mt.abort()}catch{}return oe===H.openCanceller&&O._close(),tr(yt)}).finally(function(){H.openComplete=!0,lt()}).then(function(){var yt;return Qe&&(yt={},O.tables.forEach(function(st){st.schema.indexes.forEach(function(pt){pt.name&&(yt["idb://".concat(O.name,"/").concat(st.name,"/").concat(pt.name)]=new da(-1/0,[[[]]]))}),yt["idb://".concat(O.name,"/").concat(st.name,"/")]=yt["idb://".concat(O.name,"/").concat(st.name,"/:dels")]=new da(-1/0,[[[]]])}),ua(Xf).fire(yt),Rv(yt,!0)),O})}function Xp(O){function H(Oe){return O.next(Oe)}var re=be(H),oe=be(function(Oe){return O.throw(Oe)});function be(Oe){return function(it){var Ke=Oe(it),it=Ke.value;return Ke.done?it:it&&typeof it.then=="function"?it.then(re,oe):o(it)?Promise.all(it).then(re,oe):re(it)}}return be(H)()}function yu(O,H,re){for(var oe=o(O)?O.slice():[O],be=0;be<re;++be)oe.push(H);return oe}var QN={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(O){return r(r({},O),{table:function(H){var re=O.table(H),oe=re.schema,be={},Oe=[];function ze(Qe,yt,st){var pt=Fi(Qe),bt=be[pt]=be[pt]||[],ct=Qe==null?0:typeof Qe=="string"?1:Qe.length,kt=0<yt,kt=r(r({},st),{name:kt?"".concat(pt,"(virtual-from:").concat(st.name,")"):st.name,lowLevelIndex:st,isVirtual:kt,keyTail:yt,keyLength:ct,extractKey:eh(Qe),unique:!kt&&st.unique});return bt.push(kt),kt.isPrimaryKey||Oe.push(kt),1<ct&&ze(ct===2?Qe[0]:Qe.slice(0,ct-1),yt+1,st),bt.sort(function(Mt,jt){return Mt.keyTail-jt.keyTail}),kt}H=ze(oe.primaryKey.keyPath,0,oe.primaryKey),be[":id"]=[H];for(var Ke=0,it=oe.indexes;Ke<it.length;Ke++){var lt=it[Ke];ze(lt.keyPath,0,lt)}function mt(Qe){var yt,st=Qe.query.index;return st.isVirtual?r(r({},Qe),{query:{index:st.lowLevelIndex,range:(yt=Qe.query.range,st=st.keyTail,{type:yt.type===1?2:yt.type,lower:yu(yt.lower,yt.lowerOpen?O.MAX_KEY:O.MIN_KEY,st),lowerOpen:!0,upper:yu(yt.upper,yt.upperOpen?O.MIN_KEY:O.MAX_KEY,st),upperOpen:!0})}}):Qe}return r(r({},re),{schema:r(r({},oe),{primaryKey:H,indexes:Oe,getIndexByKeyPath:function(Qe){return(Qe=be[Fi(Qe)])&&Qe[0]}}),count:function(Qe){return re.count(mt(Qe))},query:function(Qe){return re.query(mt(Qe))},openCursor:function(Qe){var yt=Qe.query.index,st=yt.keyTail,pt=yt.isVirtual,bt=yt.keyLength;return pt?re.openCursor(mt(Qe)).then(function(kt){return kt&&ct(kt)}):re.openCursor(Qe);function ct(kt){return Object.create(kt,{continue:{value:function(Mt){Mt!=null?kt.continue(yu(Mt,Qe.reverse?O.MAX_KEY:O.MIN_KEY,st)):Qe.unique?kt.continue(kt.key.slice(0,bt).concat(Qe.reverse?O.MIN_KEY:O.MAX_KEY,st)):kt.continue()}},continuePrimaryKey:{value:function(Mt,jt){kt.continuePrimaryKey(yu(Mt,O.MAX_KEY,st),jt)}},primaryKey:{get:function(){return kt.primaryKey}},key:{get:function(){var Mt=kt.key;return bt===1?Mt[0]:Mt.slice(0,bt)}},value:{get:function(){return kt.value}}})}}})}})}};function i0(O,H,re,oe){return re=re||{},oe=oe||"",a(O).forEach(function(be){var Oe,ze,Ke;d(H,be)?(Oe=O[be],ze=H[be],typeof Oe=="object"&&typeof ze=="object"&&Oe&&ze?(Ke=V(Oe))!==V(ze)?re[oe+be]=H[be]:Ke==="Object"?i0(Oe,ze,re,oe+be+"."):Oe!==ze&&(re[oe+be]=H[be]):Oe!==ze&&(re[oe+be]=H[be])):re[oe+be]=void 0}),a(H).forEach(function(be){d(O,be)||(re[oe+be]=H[be])}),re}function a0(O,H){return H.type==="delete"?H.keys:H.keys||H.values.map(O.extractKey)}var R_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(O){return r(r({},O),{table:function(H){var re=O.table(H),oe=re.schema.primaryKey;return r(r({},re),{mutate:function(be){var Oe=Me.trans,ze=Oe.table(H).hook,Ke=ze.deleting,it=ze.creating,lt=ze.updating;switch(be.type){case"add":if(it.fire===Fe)break;return Oe._promise("readwrite",function(){return mt(be)},!0);case"put":if(it.fire===Fe&&lt.fire===Fe)break;return Oe._promise("readwrite",function(){return mt(be)},!0);case"delete":if(Ke.fire===Fe)break;return Oe._promise("readwrite",function(){return mt(be)},!0);case"deleteRange":if(Ke.fire===Fe)break;return Oe._promise("readwrite",function(){return function Qe(yt,st,pt){return re.query({trans:yt,values:!1,query:{index:oe,range:st},limit:pt}).then(function(bt){var ct=bt.result;return mt({type:"delete",keys:ct,trans:yt}).then(function(kt){return 0<kt.numFailures?Promise.reject(kt.failures[0]):ct.length<pt?{failures:[],numFailures:0,lastResult:void 0}:Qe(yt,r(r({},st),{lower:ct[ct.length-1],lowerOpen:!0}),pt)})})}(be.trans,be.range,1e4)},!0)}return re.mutate(be);function mt(Qe){var yt,st,pt,bt=Me.trans,ct=Qe.keys||a0(oe,Qe);if(!ct)throw new Error("Keys missing");return(Qe=Qe.type==="add"||Qe.type==="put"?r(r({},Qe),{keys:ct}):r({},Qe)).type!=="delete"&&(Qe.values=s([],Qe.values)),Qe.keys&&(Qe.keys=s([],Qe.keys)),yt=re,pt=ct,((st=Qe).type==="add"?Promise.resolve([]):yt.getMany({trans:st.trans,keys:pt,cache:"immutable"})).then(function(kt){var Mt=ct.map(function(jt,Ot){var Xt,sn,Kt,tn=kt[Ot],ln={onerror:null,onsuccess:null};return Qe.type==="delete"?Ke.fire.call(ln,jt,tn,bt):Qe.type==="add"||tn===void 0?(Xt=it.fire.call(ln,jt,Qe.values[Ot],bt),jt==null&&Xt!=null&&(Qe.keys[Ot]=jt=Xt,oe.outbound||A(Qe.values[Ot],oe.keyPath,jt))):(Xt=i0(tn,Qe.values[Ot]),(sn=lt.fire.call(ln,Xt,jt,tn,bt))&&(Kt=Qe.values[Ot],Object.keys(sn).forEach(function(Yt){d(Kt,Yt)?Kt[Yt]=sn[Yt]:A(Kt,Yt,sn[Yt])}))),ln});return re.mutate(Qe).then(function(jt){for(var Ot=jt.failures,Xt=jt.results,sn=jt.numFailures,jt=jt.lastResult,Kt=0;Kt<ct.length;++Kt){var tn=(Xt||ct)[Kt],ln=Mt[Kt];tn==null?ln.onerror&&ln.onerror(Ot[Kt]):ln.onsuccess&&ln.onsuccess(Qe.type==="put"&&kt[Kt]?Qe.values[Kt]:tn)}return{failures:Ot,results:Xt,numFailures:sn,lastResult:jt}}).catch(function(jt){return Mt.forEach(function(Ot){return Ot.onerror&&Ot.onerror(jt)}),Promise.reject(jt)})})}}})}})}};function Iv(O,H,re){try{if(!H||H.keys.length<O.length)return null;for(var oe=[],be=0,Oe=0;be<H.keys.length&&Oe<O.length;++be)Fr(H.keys[be],O[Oe])===0&&(oe.push(re?q(H.values[be]):H.values[be]),++Oe);return oe.length===O.length?oe:null}catch{return null}}var I_={stack:"dbcore",level:-1,create:function(O){return{table:function(H){var re=O.table(H);return r(r({},re),{getMany:function(oe){if(!oe.cache)return re.getMany(oe);var be=Iv(oe.keys,oe.trans._cache,oe.cache==="clone");return be?W.resolve(be):re.getMany(oe).then(function(Oe){return oe.trans._cache={keys:oe.keys,values:oe.cache==="clone"?q(Oe):Oe},Oe})},mutate:function(oe){return oe.type!=="add"&&(oe.trans._cache=null),re.mutate(oe)}})}}}};function jd(O,H){return O.trans.mode==="readonly"&&!!O.subscr&&!O.trans.explicit&&O.trans.db._options.cache!=="disabled"&&!H.schema.primaryKey.outbound}function M_(O,H){switch(O){case"query":return H.values&&!H.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var eR={stack:"dbcore",level:0,name:"Observability",create:function(O){var H=O.schema.name,re=new da(O.MIN_KEY,O.MAX_KEY);return r(r({},O),{transaction:function(oe,be,Oe){if(Me.subscr&&be!=="readonly")throw new pe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Me.querier));return O.transaction(oe,be,Oe)},table:function(oe){var be=O.table(oe),Oe=be.schema,ze=Oe.primaryKey,Qe=Oe.indexes,Ke=ze.extractKey,it=ze.outbound,lt=ze.autoIncrement&&Qe.filter(function(st){return st.compound&&st.keyPath.includes(ze.keyPath)}),mt=r(r({},be),{mutate:function(st){function pt(Yt){return Yt="idb://".concat(H,"/").concat(oe,"/").concat(Yt),jt[Yt]||(jt[Yt]=new da)}var bt,ct,kt,Mt=st.trans,jt=st.mutatedParts||(st.mutatedParts={}),Ot=pt(""),Xt=pt(":dels"),sn=st.type,ln=st.type==="deleteRange"?[st.range]:st.type==="delete"?[st.keys]:st.values.length<50?[a0(ze,st).filter(function(Yt){return Yt}),st.values]:[],Kt=ln[0],tn=ln[1],ln=st.trans._cache;return o(Kt)?(Ot.addKeys(Kt),(ln=sn==="delete"||Kt.length===tn.length?Iv(Kt,ln):null)||Xt.addKeys(Kt),(ln||tn)&&(bt=pt,ct=ln,kt=tn,Oe.indexes.forEach(function(Yt){var bn=bt(Yt.name||"");function Wn(vr){return vr!=null?Yt.extractKey(vr):null}function Xn(vr){return Yt.multiEntry&&o(vr)?vr.forEach(function(Aa){return bn.addKey(Aa)}):bn.addKey(vr)}(ct||kt).forEach(function(vr,wi){var lr=ct&&Wn(ct[wi]),wi=kt&&Wn(kt[wi]);Fr(lr,wi)!==0&&(lr!=null&&Xn(lr),wi!=null&&Xn(wi))})}))):Kt?(tn={from:(tn=Kt.lower)!==null&&tn!==void 0?tn:O.MIN_KEY,to:(tn=Kt.upper)!==null&&tn!==void 0?tn:O.MAX_KEY},Xt.add(tn),Ot.add(tn)):(Ot.add(re),Xt.add(re),Oe.indexes.forEach(function(Yt){return pt(Yt.name).add(re)})),be.mutate(st).then(function(Yt){return!Kt||st.type!=="add"&&st.type!=="put"||(Ot.addKeys(Yt.results),lt&&lt.forEach(function(bn){for(var Wn=st.values.map(function(lr){return bn.extractKey(lr)}),Xn=bn.keyPath.findIndex(function(lr){return lr===ze.keyPath}),vr=0,Aa=Yt.results.length;vr<Aa;++vr)Wn[vr][Xn]=Yt.results[vr];pt(bn.name).addKeys(Wn)})),Mt.mutatedParts=r0(Mt.mutatedParts||{},jt),Yt})}}),Qe=function(pt){var bt=pt.query,pt=bt.index,bt=bt.range;return[pt,new da((pt=bt.lower)!==null&&pt!==void 0?pt:O.MIN_KEY,(bt=bt.upper)!==null&&bt!==void 0?bt:O.MAX_KEY)]},yt={get:function(st){return[ze,new da(st.key)]},getMany:function(st){return[ze,new da().addKeys(st.keys)]},count:Qe,query:Qe,openCursor:Qe};return a(yt).forEach(function(st){mt[st]=function(pt){var bt=Me.subscr,ct=!!bt,kt=jd(Me,be)&&M_(st,pt)?pt.obsSet={}:bt;if(ct){var Mt=function(tn){return tn="idb://".concat(H,"/").concat(oe,"/").concat(tn),kt[tn]||(kt[tn]=new da)},jt=Mt(""),Ot=Mt(":dels"),bt=yt[st](pt),ct=bt[0],bt=bt[1];if((st==="query"&&ct.isPrimaryKey&&!pt.values?Ot:Mt(ct.name||"")).add(bt),!ct.isPrimaryKey){if(st!=="count"){var Xt=st==="query"&&it&&pt.values&&be.query(r(r({},pt),{values:!1}));return be[st].apply(this,arguments).then(function(tn){if(st==="query"){if(it&&pt.values)return Xt.then(function(Wn){return Wn=Wn.result,jt.addKeys(Wn),tn});var ln=pt.values?tn.result.map(Ke):tn.result;(pt.values?jt:Ot).addKeys(ln)}else if(st==="openCursor"){var Yt=tn,bn=pt.values;return Yt&&Object.create(Yt,{key:{get:function(){return Ot.addKey(Yt.primaryKey),Yt.key}},primaryKey:{get:function(){var Wn=Yt.primaryKey;return Ot.addKey(Wn),Wn}},value:{get:function(){return bn&&jt.addKey(Yt.primaryKey),Yt.value}}})}return tn})}Ot.add(re)}}return be[st].apply(this,arguments)}}),mt}})}};function j_(O,H,re){if(re.numFailures===0)return H;if(H.type==="deleteRange")return null;var oe=H.keys?H.keys.length:"values"in H&&H.values?H.values.length:1;return re.numFailures===oe?null:(H=r({},H),o(H.keys)&&(H.keys=H.keys.filter(function(be,Oe){return!(Oe in re.failures)})),"values"in H&&o(H.values)&&(H.values=H.values.filter(function(be,Oe){return!(Oe in re.failures)})),H)}function o0(O,H){return re=O,((oe=H).lower===void 0||(oe.lowerOpen?0<Fr(re,oe.lower):0<=Fr(re,oe.lower)))&&(O=O,(H=H).upper===void 0||(H.upperOpen?Fr(O,H.upper)<0:Fr(O,H.upper)<=0));var re,oe}function Mv(O,H,yt,oe,be,Oe){if(!yt||yt.length===0)return O;var ze=H.query.index,Ke=ze.multiEntry,it=H.query.range,lt=oe.schema.primaryKey.extractKey,mt=ze.extractKey,Qe=(ze.lowLevelIndex||ze).extractKey,yt=yt.reduce(function(st,pt){var bt=st,ct=[];if(pt.type==="add"||pt.type==="put")for(var kt=new da,Mt=pt.values.length-1;0<=Mt;--Mt){var jt,Ot=pt.values[Mt],Xt=lt(Ot);kt.hasKey(Xt)||(jt=mt(Ot),(Ke&&o(jt)?jt.some(function(Yt){return o0(Yt,it)}):o0(jt,it))&&(kt.addKey(Xt),ct.push(Ot)))}switch(pt.type){case"add":var sn=new da().addKeys(H.values?st.map(function(bn){return lt(bn)}):st),bt=st.concat(H.values?ct.filter(function(bn){return bn=lt(bn),!sn.hasKey(bn)&&(sn.addKey(bn),!0)}):ct.map(function(bn){return lt(bn)}).filter(function(bn){return!sn.hasKey(bn)&&(sn.addKey(bn),!0)}));break;case"put":var Kt=new da().addKeys(pt.values.map(function(bn){return lt(bn)}));bt=st.filter(function(bn){return!Kt.hasKey(H.values?lt(bn):bn)}).concat(H.values?ct:ct.map(function(bn){return lt(bn)}));break;case"delete":var tn=new da().addKeys(pt.keys);bt=st.filter(function(bn){return!tn.hasKey(H.values?lt(bn):bn)});break;case"deleteRange":var ln=pt.range;bt=st.filter(function(bn){return!o0(lt(bn),ln)})}return bt},O);return yt===O?O:(yt.sort(function(st,pt){return Fr(Qe(st),Qe(pt))||Fr(lt(st),lt(pt))}),H.limit&&H.limit<1/0&&(yt.length>H.limit?yt.length=H.limit:O.length===H.limit&&yt.length<H.limit&&(be.dirty=!0)),Oe?Object.freeze(yt):yt)}function nh(O,H){return Fr(O.lower,H.lower)===0&&Fr(O.upper,H.upper)===0&&!!O.lowerOpen==!!H.lowerOpen&&!!O.upperOpen==!!H.upperOpen}function Jp(O,H){return function(re,oe,be,Oe){if(re===void 0)return oe!==void 0?-1:0;if(oe===void 0)return 1;if((oe=Fr(re,oe))===0){if(be&&Oe)return 0;if(be)return 1;if(Oe)return-1}return oe}(O.lower,H.lower,O.lowerOpen,H.lowerOpen)<=0&&0<=function(re,oe,be,Oe){if(re===void 0)return oe!==void 0?1:0;if(oe===void 0)return-1;if((oe=Fr(re,oe))===0){if(be&&Oe)return 0;if(be)return-1;if(Oe)return 1}return oe}(O.upper,H.upper,O.upperOpen,H.upperOpen)}function tR(O,H,re,oe){O.subscribers.add(re),oe.addEventListener("abort",function(){var be,Oe;O.subscribers.delete(re),O.subscribers.size===0&&(be=O,Oe=H,setTimeout(function(){be.subscribers.size===0&&$(Oe,be)},3e3))})}var l0={stack:"dbcore",level:0,name:"Cache",create:function(O){var H=O.schema.name;return r(r({},O),{transaction:function(re,oe,be){var Oe,ze,Ke=O.transaction(re,oe,be);return oe==="readwrite"&&(ze=(Oe=new AbortController).signal,be=function(it){return function(){if(Oe.abort(),oe==="readwrite"){for(var lt=new Set,mt=0,Qe=re;mt<Qe.length;mt++){var yt=Qe[mt],st=Md["idb://".concat(H,"/").concat(yt)];if(st){var pt=O.table(yt),bt=st.optimisticOps.filter(function(bn){return bn.trans===Ke});if(Ke._explicit&&it&&Ke.mutatedParts)for(var ct=0,kt=Object.values(st.queries.query);ct<kt.length;ct++)for(var Mt=0,jt=(sn=kt[ct]).slice();Mt<jt.length;Mt++)Tv((Kt=jt[Mt]).obsSet,Ke.mutatedParts)&&($(sn,Kt),Kt.subscribers.forEach(function(bn){return lt.add(bn)}));else if(0<bt.length){st.optimisticOps=st.optimisticOps.filter(function(bn){return bn.trans!==Ke});for(var Ot=0,Xt=Object.values(st.queries.query);Ot<Xt.length;Ot++)for(var sn,Kt,tn,ln=0,Yt=(sn=Xt[Ot]).slice();ln<Yt.length;ln++)(Kt=Yt[ln]).res!=null&&Ke.mutatedParts&&(it&&!Kt.dirty?(tn=Object.isFrozen(Kt.res),tn=Mv(Kt.res,Kt.req,bt,pt,Kt,tn),Kt.dirty?($(sn,Kt),Kt.subscribers.forEach(function(bn){return lt.add(bn)})):tn!==Kt.res&&(Kt.res=tn,Kt.promise=W.resolve({result:tn}))):(Kt.dirty&&$(sn,Kt),Kt.subscribers.forEach(function(bn){return lt.add(bn)})))}}}lt.forEach(function(bn){return bn()})}}},Ke.addEventListener("abort",be(!1),{signal:ze}),Ke.addEventListener("error",be(!1),{signal:ze}),Ke.addEventListener("complete",be(!0),{signal:ze})),Ke},table:function(re){var oe=O.table(re),be=oe.schema.primaryKey;return r(r({},oe),{mutate:function(Oe){var ze=Me.trans;if(be.outbound||ze.db._options.cache==="disabled"||ze.explicit||ze.idbtrans.mode!=="readwrite")return oe.mutate(Oe);var Ke=Md["idb://".concat(H,"/").concat(re)];return Ke?(ze=oe.mutate(Oe),Oe.type!=="add"&&Oe.type!=="put"||!(50<=Oe.values.length||a0(be,Oe).some(function(it){return it==null}))?(Ke.optimisticOps.push(Oe),Oe.mutatedParts&&s0(Oe.mutatedParts),ze.then(function(it){0<it.numFailures&&($(Ke.optimisticOps,Oe),(it=j_(0,Oe,it))&&Ke.optimisticOps.push(it),Oe.mutatedParts&&s0(Oe.mutatedParts))}),ze.catch(function(){$(Ke.optimisticOps,Oe),Oe.mutatedParts&&s0(Oe.mutatedParts)})):ze.then(function(it){var lt=j_(0,r(r({},Oe),{values:Oe.values.map(function(mt,Qe){var yt;return it.failures[Qe]?mt:(mt=(yt=be.keyPath)!==null&&yt!==void 0&&yt.includes(".")?q(mt):r({},mt),A(mt,be.keyPath,it.results[Qe]),mt)})}),it);Ke.optimisticOps.push(lt),queueMicrotask(function(){return Oe.mutatedParts&&s0(Oe.mutatedParts)})}),ze):oe.mutate(Oe)},query:function(Oe){if(!jd(Me,oe)||!M_("query",Oe))return oe.query(Oe);var ze=((lt=Me.trans)===null||lt===void 0?void 0:lt.db._options.cache)==="immutable",Qe=Me,Ke=Qe.requery,it=Qe.signal,lt=function(pt,bt,ct,kt){var Mt=Md["idb://".concat(pt,"/").concat(bt)];if(!Mt)return[];if(!(bt=Mt.queries[ct]))return[null,!1,Mt,null];var jt=bt[(kt.query?kt.query.index.name:null)||""];if(!jt)return[null,!1,Mt,null];switch(ct){case"query":var Ot=jt.find(function(Xt){return Xt.req.limit===kt.limit&&Xt.req.values===kt.values&&nh(Xt.req.query.range,kt.query.range)});return Ot?[Ot,!0,Mt,jt]:[jt.find(function(Xt){return("limit"in Xt.req?Xt.req.limit:1/0)>=kt.limit&&(!kt.values||Xt.req.values)&&Jp(Xt.req.query.range,kt.query.range)}),!1,Mt,jt];case"count":return Ot=jt.find(function(Xt){return nh(Xt.req.query.range,kt.query.range)}),[Ot,!!Ot,Mt,jt]}}(H,re,"query",Oe),mt=lt[0],Qe=lt[1],yt=lt[2],st=lt[3];return mt&&Qe?mt.obsSet=Oe.obsSet:(Qe=oe.query(Oe).then(function(pt){var bt=pt.result;if(mt&&(mt.res=bt),ze){for(var ct=0,kt=bt.length;ct<kt;++ct)Object.freeze(bt[ct]);Object.freeze(bt)}else pt.result=q(bt);return pt}).catch(function(pt){return st&&mt&&$(st,mt),Promise.reject(pt)}),mt={obsSet:Oe.obsSet,promise:Qe,subscribers:new Set,type:"query",req:Oe,dirty:!1},st?st.push(mt):(st=[mt],(yt=yt||(Md["idb://".concat(H,"/").concat(re)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Oe.query.index.name||""]=st)),tR(mt,st,Ke,it),mt.promise.then(function(pt){return{result:Mv(pt.result,Oe,yt==null?void 0:yt.optimisticOps,oe,mt,ze)}})}})}})}};function Qp(O,H){return new Proxy(O,{get:function(re,oe,be){return oe==="db"?H:Reflect.get(re,oe,be)}})}var zl=(Vs.prototype.version=function(O){if(isNaN(O)||O<.1)throw new pe.Type("Given version is not a positive number");if(O=Math.round(10*O)/10,this.idbdb||this._state.isBeingOpened)throw new pe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,O);var H=this._versions,re=H.filter(function(oe){return oe._cfg.version===O})[0];return re||(re=new this.Version(O),H.push(re),H.sort(wv),re.stores({}),this._state.autoSchema=!1,re)},Vs.prototype._whenReady=function(O){var H=this;return this.idbdb&&(this._state.openComplete||Me.letThrough||this._vip)?O():new W(function(re,oe){if(H._state.openComplete)return oe(new pe.DatabaseClosed(H._state.dbOpenError));if(!H._state.isBeingOpened){if(!H._state.autoOpen)return void oe(new pe.DatabaseClosed);H.open().catch(Fe)}H._state.dbReadyPromise.then(re,oe)}).then(O)},Vs.prototype.use=function(O){var H=O.stack,re=O.create,oe=O.level,be=O.name;return be&&this.unuse({stack:H,name:be}),O=this._middlewares[H]||(this._middlewares[H]=[]),O.push({stack:H,create:re,level:oe??10,name:be}),O.sort(function(Oe,ze){return Oe.level-ze.level}),this},Vs.prototype.unuse=function(O){var H=O.stack,re=O.name,oe=O.create;return H&&this._middlewares[H]&&(this._middlewares[H]=this._middlewares[H].filter(function(be){return oe?be.create!==oe:!!re&&be.name!==re})),this},Vs.prototype.open=function(){var O=this;return nt(ve,function(){return JN(O)})},Vs.prototype._close=function(){var O=this._state,H=si.indexOf(this);if(0<=H&&si.splice(H,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}O.isBeingOpened||(O.dbReadyPromise=new W(function(re){O.dbReadyResolve=re}),O.openCanceller=new W(function(re,oe){O.cancelOpen=oe}))},Vs.prototype.close=function(re){var H=(re===void 0?{disableAutoOpen:!0}:re).disableAutoOpen,re=this._state;H?(re.isBeingOpened&&re.cancelOpen(new pe.DatabaseClosed),this._close(),re.autoOpen=!1,re.dbOpenError=new pe.DatabaseClosed):(this._close(),re.autoOpen=this._options.autoOpen||re.isBeingOpened,re.openComplete=!1,re.dbOpenError=null)},Vs.prototype.delete=function(O){var H=this;O===void 0&&(O={disableAutoOpen:!0});var re=0<arguments.length&&typeof arguments[0]!="object",oe=this._state;return new W(function(be,Oe){function ze(){H.close(O);var Ke=H._deps.indexedDB.deleteDatabase(H.name);Ke.onsuccess=$e(function(){var it,lt,mt;it=H._deps,lt=H.name,mt=it.indexedDB,it=it.IDBKeyRange,t0(mt)||lt===Ea||_v(mt,it).delete(lt).catch(Fe),be()}),Ke.onerror=pl(Oe),Ke.onblocked=H._fireOnBlocked}if(re)throw new pe.InvalidArgument("Invalid closeOptions argument to db.delete()");oe.isBeingOpened?oe.dbReadyPromise.then(ze):ze()})},Vs.prototype.backendDB=function(){return this.idbdb},Vs.prototype.isOpen=function(){return this.idbdb!==null},Vs.prototype.hasBeenClosed=function(){var O=this._state.dbOpenError;return O&&O.name==="DatabaseClosed"},Vs.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Vs.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Vs.prototype,"tables",{get:function(){var O=this;return a(this._allTables).map(function(H){return O._allTables[H]})},enumerable:!1,configurable:!0}),Vs.prototype.transaction=function(){var O=(function(H,re,oe){var be=arguments.length;if(be<2)throw new pe.InvalidArgument("Too few arguments");for(var Oe=new Array(be-1);--be;)Oe[be-1]=arguments[be];return oe=Oe.pop(),[H,j(Oe),oe]}).apply(this,arguments);return this._transaction.apply(this,O)},Vs.prototype._transaction=function(O,H,re){var oe=this,be=Me.trans;be&&be.db===this&&O.indexOf("!")===-1||(be=null);var Oe,ze,Ke=O.indexOf("?")!==-1;O=O.replace("!","").replace("?","");try{if(ze=H.map(function(lt){if(lt=lt instanceof oe.Table?lt.name:lt,typeof lt!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return lt}),O=="r"||O===Zi)Oe=Zi;else{if(O!="rw"&&O!=$s)throw new pe.InvalidArgument("Invalid transaction mode: "+O);Oe=$s}if(be){if(be.mode===Zi&&Oe===$s){if(!Ke)throw new pe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");be=null}be&&ze.forEach(function(lt){if(be&&be.storeNames.indexOf(lt)===-1){if(!Ke)throw new pe.SubTransaction("Table "+lt+" not included in parent transaction.");be=null}}),Ke&&be&&!be.active&&(be=null)}}catch(lt){return be?be._promise(null,function(mt,Qe){Qe(lt)}):tr(lt)}var it=(function lt(mt,Qe,yt,st,pt){return W.resolve().then(function(){var bt=Me.transless||Me,ct=mt._createTransaction(Qe,yt,mt._dbSchema,st);if(ct.explicit=!0,bt={trans:ct,transless:bt},st)ct.idbtrans=st.idbtrans;else try{ct.create(),ct.idbtrans._explicit=!0,mt._state.PR1398_maxLoop=3}catch(jt){return jt.name===Ee.InvalidState&&mt.isOpen()&&0<--mt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),mt.close({disableAutoOpen:!1}),mt.open().then(function(){return lt(mt,Qe,yt,null,pt)})):tr(jt)}var kt,Mt=G(pt);return Mt&&br(),bt=W.follow(function(){var jt;(kt=pt.call(ct,ct))&&(Mt?(jt=Cr.bind(null,null),kt.then(jt,jt)):typeof kt.next=="function"&&typeof kt.throw=="function"&&(kt=Xp(kt)))},bt),(kt&&typeof kt.then=="function"?W.resolve(kt).then(function(jt){return ct.active?jt:tr(new pe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):bt.then(function(){return kt})).then(function(jt){return st&&ct._resolve(),ct._completion.then(function(){return jt})}).catch(function(jt){return ct._reject(jt),tr(jt)})})}).bind(null,this,Oe,ze,be,re);return be?be._promise(Oe,it,"lock"):Me.trans?nt(Me.transless,function(){return oe._whenReady(it)}):this._whenReady(it)},Vs.prototype.table=function(O){if(!d(this._allTables,O))throw new pe.InvalidTable("Table ".concat(O," does not exist"));return this._allTables[O]},Vs);function Vs(O,H){var re=this;this._middlewares={},this.verno=0;var oe=Vs.dependencies;this._options=H=r({addons:Vs.addons,autoOpen:!0,indexedDB:oe.indexedDB,IDBKeyRange:oe.IDBKeyRange,cache:"cloned"},H),this._deps={indexedDB:H.indexedDB,IDBKeyRange:H.IDBKeyRange},oe=H.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var be,Oe,ze,Ke,it,lt={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Fe,dbReadyPromise:null,cancelOpen:Fe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:H.autoOpen};lt.dbReadyPromise=new W(function(Qe){lt.dbReadyResolve=Qe}),lt.openCanceller=new W(function(Qe,yt){lt.cancelOpen=yt}),this._state=lt,this.name=O,this.on=po(this,"populate","blocked","versionchange","close",{ready:[Pe,Fe]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Qe){return function(yt,st){Vs.vip(function(){var pt,bt=re._state;bt.openComplete?(bt.dbOpenError||W.resolve().then(yt),st&&Qe(yt)):bt.onReadyBeingFired?(bt.onReadyBeingFired.push(yt),st&&Qe(yt)):(Qe(yt),pt=re,st||Qe(function ct(){pt.on.ready.unsubscribe(yt),pt.on.ready.unsubscribe(ct)}))})}}),this.Collection=(be=this,pu(Yf.prototype,function(kt,ct){this.db=be;var st=ho,pt=null;if(ct)try{st=ct()}catch(Mt){pt=Mt}var bt=kt._ctx,ct=bt.table,kt=ct.hook.reading.fire;this._ctx={table:ct,index:bt.index,isPrimKey:!bt.index||ct.schema.primKey.keyPath&&bt.index===ct.schema.primKey.name,range:st,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:pt,or:bt.or,valueMapper:kt!==Ie?kt:null}})),this.Table=(Oe=this,pu(Vp.prototype,function(Qe,yt,st){this.db=Oe,this._tx=st,this.name=Qe,this.schema=yt,this.hook=Oe._allTables[Qe]?Oe._allTables[Qe].hook:po(null,{creating:[Ne,Fe],reading:[X,Ie],updating:[ce,Fe],deleting:[fe,Fe]})})),this.Transaction=(ze=this,pu(xv.prototype,function(Qe,yt,st,pt,bt){var ct=this;this.db=ze,this.mode=Qe,this.storeNames=yt,this.schema=st,this.chromeTransactionDurability=pt,this.idbtrans=null,this.on=po(this,"complete","error","abort"),this.parent=bt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new W(function(kt,Mt){ct._resolve=kt,ct._reject=Mt}),this._completion.then(function(){ct.active=!1,ct.on.complete.fire()},function(kt){var Mt=ct.active;return ct.active=!1,ct.on.error.fire(kt),ct.parent?ct.parent._reject(kt):Mt&&ct.idbtrans&&ct.idbtrans.abort(),tr(kt)})})),this.Version=(Ke=this,pu(XN.prototype,function(Qe){this.db=Ke,this._cfg={version:Qe,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(it=this,pu(Td.prototype,function(Qe,yt,st){if(this.db=it,this._ctx={table:Qe,index:yt===":id"?null:yt,or:st},this._cmp=this._ascending=Fr,this._descending=function(pt,bt){return Fr(bt,pt)},this._max=function(pt,bt){return 0<Fr(pt,bt)?pt:bt},this._min=function(pt,bt){return Fr(pt,bt)<0?pt:bt},this._IDBKeyRange=it._deps.IDBKeyRange,!this._IDBKeyRange)throw new pe.MissingAPI})),this.on("versionchange",function(Qe){0<Qe.newVersion?console.warn("Another connection wants to upgrade database '".concat(re.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(re.name,"'. Closing db now to resume the delete request.")),re.close({disableAutoOpen:!1})}),this.on("blocked",function(Qe){!Qe.newVersion||Qe.newVersion<Qe.oldVersion?console.warn("Dexie.delete('".concat(re.name,"') was blocked")):console.warn("Upgrade '".concat(re.name,"' blocked by other connection holding version ").concat(Qe.oldVersion/10))}),this._maxKey=Qf(H.IDBKeyRange),this._createTransaction=function(Qe,yt,st,pt){return new re.Transaction(Qe,yt,st,re._options.chromeTransactionDurability,pt)},this._fireOnBlocked=function(Qe){re.on("blocked").fire(Qe),si.filter(function(yt){return yt.name===re.name&&yt!==re&&!yt._state.vcFired}).map(function(yt){return yt.on("versionchange").fire(Qe)})},this.use(I_),this.use(l0),this.use(eR),this.use(QN),this.use(R_);var mt=new Proxy(this,{get:function(Qe,yt,st){if(yt==="_vip")return!0;if(yt==="table")return function(bt){return Qp(re.table(bt),mt)};var pt=Reflect.get(Qe,yt,st);return pt instanceof Vp?Qp(pt,mt):yt==="tables"?pt.map(function(bt){return Qp(bt,mt)}):yt==="_createTransaction"?function(){return Qp(pt.apply(this,arguments),mt)}:pt}});this.vip=mt,oe.forEach(function(Qe){return Qe(re)})}var rh,go=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",P_=(c0.prototype.subscribe=function(O,H,re){return this._subscribe(O&&typeof O!="function"?O:{next:O,error:H,complete:re})},c0.prototype[go]=function(){return this},c0);function c0(O){this._subscribe=O}try{rh={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{rh={indexedDB:null,IDBKeyRange:null}}function O_(O){var H,re=!1,oe=new P_(function(be){var Oe=G(O),ze,Ke=!1,it={},lt={},mt={get closed(){return Ke},unsubscribe:function(){Ke||(Ke=!0,ze&&ze.abort(),Qe&&ua.storagemutated.unsubscribe(st))}};be.start&&be.start(mt);var Qe=!1,yt=function(){return gn(pt)},st=function(bt){r0(it,bt),Tv(lt,it)&&yt()},pt=function(){var bt,ct,kt;!Ke&&rh.indexedDB&&(it={},bt={},ze&&ze.abort(),ze=new AbortController,kt=function(Mt){var jt=Q();try{Oe&&br();var Ot=dn(O,Mt);return Ot=Oe?Ot.finally(Cr):Ot}finally{jt&&J()}}(ct={subscr:bt,signal:ze.signal,requery:yt,querier:O,trans:null}),Promise.resolve(kt).then(function(Mt){re=!0,H=Mt,Ke||ct.signal.aborted||(it={},function(jt){for(var Ot in jt)if(d(jt,Ot))return;return 1}(lt=bt)||Qe||(ua(Xf,st),Qe=!0),gn(function(){return!Ke&&be.next&&be.next(Mt)}))},function(Mt){re=!1,["DatabaseClosedError","AbortError"].includes(Mt==null?void 0:Mt.name)||Ke||gn(function(){Ke||be.error&&be.error(Mt)})}))};return setTimeout(yt,0),mt});return oe.hasValue=function(){return re},oe.getValue=function(){return H},oe}var Pd=zl;function jv(O){var H=bu;try{bu=!0,ua.storagemutated.fire(O),Rv(O,!0)}finally{bu=H}}h(Pd,r(r({},He),{delete:function(O){return new Pd(O,{addons:[]}).delete()},exists:function(O){return new Pd(O,{addons:[]}).open().then(function(H){return H.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(O){try{return H=Pd.dependencies,re=H.indexedDB,H=H.IDBKeyRange,(t0(re)?Promise.resolve(re.databases()).then(function(oe){return oe.map(function(be){return be.name}).filter(function(be){return be!==Ea})}):_v(re,H).toCollection().primaryKeys()).then(O)}catch{return tr(new pe.MissingAPI)}var H,re},defineClass:function(){return function(O){l(this,O)}},ignoreTransaction:function(O){return Me.trans?nt(Me.transless,O):O()},vip:Cv,async:function(O){return function(){try{var H=Xp(O.apply(this,arguments));return H&&typeof H.then=="function"?H:W.resolve(H)}catch(re){return tr(re)}}},spawn:function(O,H,re){try{var oe=Xp(O.apply(re,H||[]));return oe&&typeof oe.then=="function"?oe:W.resolve(oe)}catch(be){return tr(be)}},currentTransaction:{get:function(){return Me.trans||null}},waitFor:function(O,H){return H=W.resolve(typeof O=="function"?Pd.ignoreTransaction(O):O).timeout(H||6e4),Me.trans?Me.trans.waitFor(H):H},Promise:W,debug:{get:function(){return Be},set:function(O){je(O)}},derive:y,extend:l,props:h,override:S,Events:po,on:ua,liveQuery:O_,extendObservabilitySet:r0,getByKeyPath:T,setByKeyPath:A,delByKeyPath:function(O,H){typeof H=="string"?A(O,H,void 0):"length"in H&&[].map.call(H,function(re){A(O,re,void 0)})},shallowClone:R,deepClone:q,getObjectDiff:i0,cmp:Fr,asap:k,minKey:-1/0,addons:[],connections:si,errnames:Ee,dependencies:rh,cache:Md,semVer:"4.0.11",version:"4.0.11".split(".").map(function(O){return parseInt(O)}).reduce(function(O,H,re){return O+H/Math.pow(10,2*re)})})),Pd.maxKey=Qf(Pd.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(ua(Xf,function(O){bu||(O=new CustomEvent(Nd,{detail:O}),bu=!0,dispatchEvent(O),bu=!1)}),addEventListener(Nd,function(O){O=O.detail,bu||jv(O)}));var sh,bu=!1,qa=function(){};return typeof BroadcastChannel<"u"&&((qa=function(){(sh=new BroadcastChannel(Nd)).onmessage=function(O){return O.data&&jv(O.data)}})(),typeof sh.unref=="function"&&sh.unref(),ua(Xf,function(O){bu||sh.postMessage(O)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(O){if(!zl.disableBfCache&&O.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),sh!=null&&sh.close();for(var H=0,re=si;H<re.length;H++)re[H].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(O){!zl.disableBfCache&&O.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),qa(),jv({all:new da(-1/0,[[]])}))})),W.rejectionMapper=function(O,H){return!O||O instanceof ne||O instanceof TypeError||O instanceof SyntaxError||!O.name||!Le[O.name]?O:(H=new Le[O.name](H||O.message,O),"stack"in O&&g(H,"stack",{get:function(){return this.inner.stack}}),H)},je(Be),r(zl,Object.freeze({__proto__:null,Dexie:zl,liveQuery:O_,Entity:Gf,cmp:Fr,PropModification:Kf,replacePrefix:function(O,H){return new Kf({replacePrefix:[O,H]})},add:function(O){return new Kf({add:O})},remove:function(O){return new Kf({remove:O})},default:zl,RangeSet:da,mergeRanges:Id,rangesOverlap:T_}),{default:zl}),zl})}(B2)),B2.exports}var Vxe=qxe();const zP=la(Vxe),Vz=Symbol.for("Dexie"),Sk=globalThis[Vz]||(globalThis[Vz]=zP);if(zP.semVer!==Sk.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${zP.semVer} and ${Sk.semVer}`);const{liveQuery:Jbt,mergeRanges:Qbt,rangesOverlap:evt,RangeSet:tvt,cmp:nvt,Entity:rvt,PropModification:svt,replacePrefix:ivt,add:avt,remove:ovt}=Sk;class Wxe extends Sk{constructor(){super("LiteChatDatabase_Rewrite_v1");ue(this,"conversations");ue(this,"interactions");ue(this,"mods");ue(this,"appState");ue(this,"providerConfigs");ue(this,"apiKeys");ue(this,"syncRepos");ue(this,"projects");ue(this,"rules");ue(this,"tags");ue(this,"tagRuleLinks");ue(this,"promptTemplates");ue(this,"workflows");this.version(10).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic",workflows:"++id, &name, createdAt, updatedAt"}),this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const It=new Wxe,SY="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let dr=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=SY[n[e]&63];return t};const GI=Object.freeze(Object.defineProperty({__proto__:null,nanoid:dr,urlAlphabet:SY},Symbol.toStringTag,{value:"Module"})),mi=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class dt{static async loadConversations(){try{return(await It.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>mi(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await It.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await It.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await It.interactions.where({conversationId:t}).sortBy("index")).map(r=>mi(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await It.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await It.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await It.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await It.mods.orderBy("loadOrder").toArray()).map(n=>mi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await It.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await It.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await It.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await It.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=It.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>mi(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await It.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await It.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=It.apiKeys)==null?void 0:t.toArray())??[]).map(r=>mi(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await It.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await It.transaction("rw",[It.apiKeys,It.providerConfigs],async()=>{const n=await It.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await It.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await It.syncRepos.toArray()).map(n=>mi(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await It.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await It.transaction("rw",[It.syncRepos,It.conversations],async()=>{const n=await It.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await It.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await It.projects.orderBy("updatedAt").reverse().toArray()).map(n=>mi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await It.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await It.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await It.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await It.transaction("rw",[It.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await It.rules.orderBy("name").toArray()).map(n=>mi(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await It.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await It.transaction("rw",[It.rules,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("ruleId").equals(t).delete(),await It.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await It.tags.orderBy("name").toArray()).map(n=>mi(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await It.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await It.transaction("rw",[It.tags,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("tagId").equals(t).delete(),await It.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await It.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await It.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await It.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await It.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&s.key!=="settings:mcpServers"&&(n.settings[s.key.substring(9)]=s.value)})}if(t.importApiKeys&&(n.apiKeys=await It.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await It.providerConfigs.toArray()),t.importProjects&&(n.projects=await It.projects.toArray()),t.importConversations&&(n.conversations=await It.conversations.toArray(),n.interactions=await It.interactions.toArray()),t.importRulesAndTags&&(n.rules=await It.rules.toArray(),n.tags=await It.tags.toArray(),n.tagRuleLinks=await It.tagRuleLinks.toArray()),t.importMods&&(n.mods=await It.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await It.syncRepos.toArray()),t.importMcpServers){const s=(await It.appState.toArray()).find(i=>i.key==="settings:mcpServers");n.mcpServers=s?s.value:[]}if(t.importPromptTemplates){const r=await It.promptTemplates.toArray();n.promptTemplates=r.filter(s=>!s.type||s.type==="prompt")}if(t.importAgents){const r=await It.promptTemplates.toArray(),s=r.filter(o=>o.type==="agent"),i=s.map(o=>o.id),a=r.filter(o=>o.type==="task"&&i.includes(o.parentId));n.agents=[...s,...a]}return t.importWorkflows&&(n.workflows=await this.loadWorkflows()),n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await It.transaction("rw",[It.appState,It.apiKeys,It.providerConfigs,It.projects,It.conversations,It.interactions,It.rules,It.tags,It.tagRuleLinks,It.mods,It.syncRepos,It.promptTemplates,It.workflows],async()=>{if(n.importSettings&&await It.appState.clear(),n.importApiKeys&&await It.apiKeys.clear(),n.importProviderConfigs&&await It.providerConfigs.clear(),n.importProjects&&await It.projects.clear(),n.importConversations&&(await It.conversations.clear(),await It.interactions.clear()),n.importRulesAndTags&&(await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear()),n.importMods&&await It.mods.clear(),n.importSyncRepos&&await It.syncRepos.clear(),n.importMcpServers&&await It.appState.where("key").equals("settings:mcpServers").delete(),n.importPromptTemplates){const i=(await It.promptTemplates.toArray()).filter(a=>!a.type||a.type==="prompt").map(a=>a.id||dr());i.length>0&&await It.promptTemplates.where("id").anyOf(i).delete()}if(n.importAgents&&t.agents){const s=t.agents.filter(l=>l.type==="agent").map(l=>l.id||dr()),a=t.agents.filter(l=>l.type==="task").map(l=>l.id||dr()),o=[...s,...a];o.length>0&&await It.promptTemplates.where("id").anyOf(o).delete()}if(n.importWorkflows&&await It.workflows.clear(),n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await It.appState.bulkPut(r)}if(n.importApiKeys&&t.apiKeys&&await It.apiKeys.bulkPut(t.apiKeys.map(r=>mi(r))),n.importProviderConfigs&&t.providerConfigs&&await It.providerConfigs.bulkPut(t.providerConfigs.map(r=>mi(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await It.projects.bulkPut(t.projects.map(r=>mi(r))),n.importConversations&&t.conversations&&(await It.conversations.bulkPut(t.conversations.map(r=>mi(r,["lastSyncedAt"]))),t.interactions&&await It.interactions.bulkPut(t.interactions.map(r=>mi(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await It.rules.bulkPut(t.rules.map(r=>mi(r))),t.tags&&await It.tags.bulkPut(t.tags.map(r=>mi(r))),t.tagRuleLinks&&await It.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await It.mods.bulkPut(t.mods.map(r=>mi(r))),n.importSyncRepos&&t.syncRepos&&await It.syncRepos.bulkPut(t.syncRepos.map(r=>mi(r,["lastPulledAt","lastPushedAt"]))),n.importMcpServers&&t.mcpServers&&await It.appState.put({key:"settings:mcpServers",value:t.mcpServers}),n.importPromptTemplates&&t.promptTemplates&&await It.promptTemplates.bulkPut(t.promptTemplates.map(r=>mi({...r,id:r.id||dr()},["createdAt","updatedAt"]))),n.importAgents&&t.agents&&await It.promptTemplates.bulkPut(t.agents.map(r=>mi({...r,id:r.id||dr()},["createdAt","updatedAt"]))),n.importWorkflows&&t.workflows){const r=t.workflows.map(s=>({id:s.id||dr(),name:s.name,description:s.description,definition:JSON.stringify(s),createdAt:new Date(s.createdAt),updatedAt:new Date(s.updatedAt)}));await It.workflows.bulkPut(r)}})}static async loadPromptTemplates(){try{return(await It.promptTemplates.orderBy("name").toArray()).map(n=>mi(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await It.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await It.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async loadPromptTemplateById(t){try{const n=await It.promptTemplates.get(t);return n?mi(n,["createdAt","updatedAt"]):null}catch(n){throw console.error("PersistenceService: Error loading prompt template by ID:",n),n}}static async loadWorkflows(){try{return(await It.workflows.orderBy("name").toArray()).map(n=>({...JSON.parse(n.definition),id:n.id,name:n.name,description:n.description,createdAt:n.createdAt.toISOString(),updatedAt:n.updatedAt.toISOString()}))}catch(t){throw console.error("PersistenceService: Error loading workflows:",t),t}}static async saveWorkflow(t){try{const n={id:t.id,name:t.name,description:t.description,definition:JSON.stringify(t),createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)};return await It.workflows.put(n)}catch(n){throw console.error("PersistenceService: Error saving workflow:",n),n}}static async deleteWorkflow(t){try{await It.workflows.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting workflow:",n),n}}static async clearAllData(){try{await It.transaction("rw",[It.conversations,It.interactions,It.mods,It.appState,It.providerConfigs,It.apiKeys,It.syncRepos,It.projects,It.rules,It.tags,It.tagRuleLinks,It.promptTemplates,It.workflows],async()=>{await It.conversations.clear(),await It.interactions.clear(),await It.mods.clear(),await It.appState.clear(),await It.providerConfigs.clear(),await It.apiKeys.clear(),await It.syncRepos.clear(),await It.projects.clear(),await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear(),await It.promptTemplates.clear(),await It.workflows.clear()})}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const xn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var Nl=VK();const FT=la(Nl);function Hxe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const Gxe=e=>{switch(e){case"success":return Zxe;case"info":return Jxe;case"warning":return Xxe;case"error":return Qxe;default:return null}},Kxe=Array(12).fill(0),Yxe=({visible:e,className:t})=>We.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},We.createElement("div",{className:"sonner-spinner"},Kxe.map((n,r)=>We.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),Zxe=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Xxe=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Jxe=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Qxe=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},We.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ewe=We.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},We.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),We.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),twe=()=>{const[e,t]=We.useState(document.hidden);return We.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let UP=1;class nwe{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:UP++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],We.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(swe(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,g=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...g})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,g=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...g})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,g=typeof d=="object"&&!We.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...g})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,p=typeof u=="object"&&!We.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...p})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||UP++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Ko=new nwe,rwe=(e,t)=>{const n=(t==null?void 0:t.id)||UP++;return Ko.addToast({title:e,...t,id:n}),n},swe=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",iwe=rwe,awe=()=>Ko.toasts,owe=()=>Ko.getActiveToasts(),ke=Object.assign(iwe,{success:Ko.success,info:Ko.info,warning:Ko.warning,error:Ko.error,custom:Ko.custom,message:Ko.message,promise:Ko.promise,dismiss:Ko.dismiss,loading:Ko.loading},{getHistory:awe,getToasts:owe});Hxe("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function PC(e){return e.label!==void 0}const lwe=3,cwe="24px",uwe="16px",Wz=4e3,dwe=356,fwe=14,hwe=45,pwe=200;function ku(...e){return e.filter(Boolean).join(" ")}function mwe(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const gwe=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:p,setHeights:g,visibleToasts:y,heights:v,index:x,toasts:w,expanded:S,removeToast:_,defaultRichColors:k,closeButton:T,style:A,cancelButtonStyle:R,actionButtonStyle:M,className:j="",descriptionClassName:F="",duration:P,position:q,gap:I,expandByDefault:V,classNames:D,icons:z,closeButtonAriaLabel:$="Close toast"}=e,[Y,B]=We.useState(null),[G,Z]=We.useState(null),[ne,ae]=We.useState(!1),[le,Se]=We.useState(!1),[Ee,he]=We.useState(!1),[pe,Le]=We.useState(!1),[He,Fe]=We.useState(!1),[Ie,X]=We.useState(0),[ye,Ne]=We.useState(0),fe=We.useRef(d.duration||P||Wz),ce=We.useRef(null),se=We.useRef(null),Pe=x===0,Be=x+1<=y,je=d.type,ot=d.dismissible!==!1,Et=d.className||"",ut=d.descriptionClassName||"",Pt=We.useMemo(()=>v.findIndex(Te=>Te.toastId===d.id)||0,[v,d.id]),$t=We.useMemo(()=>{var Te;return(Te=d.closeButton)!=null?Te:T},[d.closeButton,T]),Ft=We.useMemo(()=>d.duration||P||Wz,[d.duration,P]),Ht=We.useRef(0),Ce=We.useRef(0),U=We.useRef(0),ee=We.useRef(null),[xe,Re]=q.split("-"),ve=We.useMemo(()=>v.reduce((Te,Ue,Ct)=>Ct>=Pt?Te:Te+Ue.height,0),[v,Pt]),Me=twe(),de=d.invert||u,ht=je==="loading";Ce.current=We.useMemo(()=>Pt*I+ve,[Pt,ve]),We.useEffect(()=>{fe.current=Ft},[Ft]),We.useEffect(()=>{ae(!0)},[]),We.useEffect(()=>{const Te=se.current;if(Te){const Ue=Te.getBoundingClientRect().height;return Ne(Ue),g(Ct=>[{toastId:d.id,height:Ue,position:d.position},...Ct]),()=>g(Ct=>Ct.filter(me=>me.toastId!==d.id))}},[g,d.id]),We.useLayoutEffect(()=>{if(!ne)return;const Te=se.current,Ue=Te.style.height;Te.style.height="auto";const Ct=Te.getBoundingClientRect().height;Te.style.height=Ue,Ne(Ct),g(me=>me.find(J=>J.toastId===d.id)?me.map(J=>J.toastId===d.id?{...J,height:Ct}:J):[{toastId:d.id,height:Ct,position:d.position},...me])},[ne,d.title,d.description,g,d.id]);const et=We.useCallback(()=>{Se(!0),X(Ce.current),g(Te=>Te.filter(Ue=>Ue.toastId!==d.id)),setTimeout(()=>{_(d)},pwe)},[d,_,g,Ce]);We.useEffect(()=>{if(d.promise&&je==="loading"||d.duration===1/0||d.type==="loading")return;let Te;return S||p||Me?(()=>{if(U.current<Ht.current){const me=new Date().getTime()-Ht.current;fe.current=fe.current-me}U.current=new Date().getTime()})():(()=>{fe.current!==1/0&&(Ht.current=new Date().getTime(),Te=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),et()},fe.current))})(),()=>clearTimeout(Te)},[S,p,d,je,Me,et]),We.useEffect(()=>{d.delete&&et()},[et,d.delete]);function W(){var Te;if(z!=null&&z.loading){var Ue;return We.createElement("div",{className:ku(D==null?void 0:D.loader,d==null||(Ue=d.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":je==="loading"},z.loading)}return We.createElement(Yxe,{className:ku(D==null?void 0:D.loader,d==null||(Te=d.classNames)==null?void 0:Te.loader),visible:je==="loading"})}const Ve=d.icon||(z==null?void 0:z[je])||Gxe(je);var tt,we;return We.createElement("li",{tabIndex:0,ref:se,className:ku(j,Et,D==null?void 0:D.toast,d==null||(t=d.classNames)==null?void 0:t.toast,D==null?void 0:D.default,D==null?void 0:D[je],d==null||(n=d.classNames)==null?void 0:n[je]),"data-sonner-toast":"","data-rich-colors":(tt=d.richColors)!=null?tt:k,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":ne,"data-promise":!!d.promise,"data-swiped":He,"data-removed":le,"data-visible":Be,"data-y-position":xe,"data-x-position":Re,"data-index":x,"data-front":Pe,"data-swiping":Ee,"data-dismissible":ot,"data-type":je,"data-invert":de,"data-swipe-out":pe,"data-swipe-direction":G,"data-expanded":!!(S||V&&ne),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${le?Ie:Ce.current}px`,"--initial-height":V?"auto":`${ye}px`,...A,...d.style},onDragEnd:()=>{he(!1),B(null),ee.current=null},onPointerDown:Te=>{ht||!ot||(ce.current=new Date,X(Ce.current),Te.target.setPointerCapture(Te.pointerId),Te.target.tagName!=="BUTTON"&&(he(!0),ee.current={x:Te.clientX,y:Te.clientY}))},onPointerUp:()=>{var Te,Ue,Ct;if(pe||!ot)return;ee.current=null;const me=Number(((Te=se.current)==null?void 0:Te.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Q=Number(((Ue=se.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),J=new Date().getTime()-((Ct=ce.current)==null?void 0:Ct.getTime()),te=Y==="x"?me:Q,_e=Math.abs(te)/J;if(Math.abs(te)>=hwe||_e>.11){X(Ce.current),d.onDismiss==null||d.onDismiss.call(d,d),Z(Y==="x"?me>0?"right":"left":Q>0?"down":"up"),et(),Le(!0);return}else{var $e,Ge;($e=se.current)==null||$e.style.setProperty("--swipe-amount-x","0px"),(Ge=se.current)==null||Ge.style.setProperty("--swipe-amount-y","0px")}Fe(!1),he(!1),B(null)},onPointerMove:Te=>{var Ue,Ct,me;if(!ee.current||!ot||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;const J=Te.clientY-ee.current.y,te=Te.clientX-ee.current.x;var _e;const $e=(_e=e.swipeDirections)!=null?_e:mwe(q);!Y&&(Math.abs(te)>1||Math.abs(J)>1)&&B(Math.abs(te)>Math.abs(J)?"x":"y");let Ge={x:0,y:0};const wt=Jt=>1/(1.5+Math.abs(Jt)/20);if(Y==="y"){if($e.includes("top")||$e.includes("bottom"))if($e.includes("top")&&J<0||$e.includes("bottom")&&J>0)Ge.y=J;else{const Jt=J*wt(J);Ge.y=Math.abs(Jt)<Math.abs(J)?Jt:J}}else if(Y==="x"&&($e.includes("left")||$e.includes("right")))if($e.includes("left")&&te<0||$e.includes("right")&&te>0)Ge.x=te;else{const Jt=te*wt(te);Ge.x=Math.abs(Jt)<Math.abs(te)?Jt:te}(Math.abs(Ge.x)>0||Math.abs(Ge.y)>0)&&Fe(!0),(Ct=se.current)==null||Ct.style.setProperty("--swipe-amount-x",`${Ge.x}px`),(me=se.current)==null||me.style.setProperty("--swipe-amount-y",`${Ge.y}px`)}},$t&&!d.jsx&&je!=="loading"?We.createElement("button",{"aria-label":$,"data-disabled":ht,"data-close-button":!0,onClick:ht||!ot?()=>{}:()=>{et(),d.onDismiss==null||d.onDismiss.call(d,d)},className:ku(D==null?void 0:D.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(we=z==null?void 0:z.close)!=null?we:ewe):null,(je||d.icon||d.promise)&&d.icon!==null&&((z==null?void 0:z[je])!==null||d.icon)?We.createElement("div",{"data-icon":"",className:ku(D==null?void 0:D.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||W():null,d.type!=="loading"?Ve:null):null,We.createElement("div",{"data-content":"",className:ku(D==null?void 0:D.content,d==null||(i=d.classNames)==null?void 0:i.content)},We.createElement("div",{"data-title":"",className:ku(D==null?void 0:D.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?We.createElement("div",{"data-description":"",className:ku(F,ut,D==null?void 0:D.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),We.isValidElement(d.cancel)?d.cancel:d.cancel&&PC(d.cancel)?We.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||R,onClick:Te=>{PC(d.cancel)&&ot&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,Te),et())},className:ku(D==null?void 0:D.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,We.isValidElement(d.action)?d.action:d.action&&PC(d.action)?We.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||M,onClick:Te=>{PC(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,Te),!Te.defaultPrevented&&et())},className:ku(D==null?void 0:D.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function Hz(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function ywe(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?uwe:cwe;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const bwe=We.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:p,style:g,visibleToasts:y=lwe,toastOptions:v,dir:x=Hz(),gap:w=fwe,icons:S,containerAriaLabel:_="Notifications"}=t,[k,T]=We.useState([]),A=We.useMemo(()=>Array.from(new Set([s].concat(k.filter(G=>G.position).map(G=>G.position)))),[k,s]),[R,M]=We.useState([]),[j,F]=We.useState(!1),[P,q]=We.useState(!1),[I,V]=We.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),D=We.useRef(null),z=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),$=We.useRef(null),Y=We.useRef(!1),B=We.useCallback(G=>{T(Z=>{var ne;return(ne=Z.find(ae=>ae.id===G.id))!=null&&ne.delete||Ko.dismiss(G.id),Z.filter(({id:ae})=>ae!==G.id)})},[]);return We.useEffect(()=>Ko.subscribe(G=>{if(G.dismiss){requestAnimationFrame(()=>{T(Z=>Z.map(ne=>ne.id===G.id?{...ne,delete:!0}:ne))});return}setTimeout(()=>{FT.flushSync(()=>{T(Z=>{const ne=Z.findIndex(ae=>ae.id===G.id);return ne!==-1?[...Z.slice(0,ne),{...Z[ne],...G},...Z.slice(ne+1)]:[G,...Z]})})})}),[k]),We.useEffect(()=>{if(d!=="system"){V(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?V("dark"):V("light")),typeof window>"u")return;const G=window.matchMedia("(prefers-color-scheme: dark)");try{G.addEventListener("change",({matches:Z})=>{V(Z?"dark":"light")})}catch{G.addListener(({matches:ne})=>{try{V(ne?"dark":"light")}catch(ae){console.error(ae)}})}},[d]),We.useEffect(()=>{k.length<=1&&F(!1)},[k]),We.useEffect(()=>{const G=Z=>{var ne;if(i.every(Se=>Z[Se]||Z.code===Se)){var le;F(!0),(le=D.current)==null||le.focus()}Z.code==="Escape"&&(document.activeElement===D.current||(ne=D.current)!=null&&ne.contains(document.activeElement))&&F(!1)};return document.addEventListener("keydown",G),()=>document.removeEventListener("keydown",G)},[i]),We.useEffect(()=>{if(D.current)return()=>{$.current&&($.current.focus({preventScroll:!0}),$.current=null,Y.current=!1)}},[D.current]),We.createElement("section",{ref:n,"aria-label":`${_} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((G,Z)=>{var ne;const[ae,le]=G.split("-");return k.length?We.createElement("ol",{key:G,dir:x==="auto"?Hz():x,tabIndex:-1,ref:D,className:l,"data-sonner-toaster":!0,"data-sonner-theme":I,"data-y-position":ae,"data-lifted":j&&k.length>1&&!a,"data-x-position":le,style:{"--front-toast-height":`${((ne=R[0])==null?void 0:ne.height)||0}px`,"--width":`${dwe}px`,"--gap":`${w}px`,...g,...ywe(c,u)},onBlur:Se=>{Y.current&&!Se.currentTarget.contains(Se.relatedTarget)&&(Y.current=!1,$.current&&($.current.focus({preventScroll:!0}),$.current=null))},onFocus:Se=>{Se.target instanceof HTMLElement&&Se.target.dataset.dismissible==="false"||Y.current||(Y.current=!0,$.current=Se.relatedTarget)},onMouseEnter:()=>F(!0),onMouseMove:()=>F(!0),onMouseLeave:()=>{P||F(!1)},onDragEnd:()=>F(!1),onPointerDown:Se=>{Se.target instanceof HTMLElement&&Se.target.dataset.dismissible==="false"||q(!0)},onPointerUp:()=>q(!1)},k.filter(Se=>!Se.position&&Z===0||Se.position===G).map((Se,Ee)=>{var he,pe;return We.createElement(gwe,{key:Se.id,icons:S,index:Ee,toast:Se,defaultRichColors:h,duration:(he=v==null?void 0:v.duration)!=null?he:p,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:y,closeButton:(pe=v==null?void 0:v.closeButton)!=null?pe:o,interacting:P,position:G,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:B,toasts:k.filter(Le=>Le.position==Se.position),heights:R.filter(Le=>Le.position==Se.position),setHeights:M,expandByDefault:a,gap:w,expanded:j,swipeDirections:t.swipeDirections})})):null}))}),en=Do(Fo((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Ae.emit(xn.statusChanged,{status:"loading"});try{const s=await dt.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Ae.emit(xn.loaded,{conversationId:n,interactions:o}),Ae.emit(xn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Ae.emit(xn.statusChanged,{status:"error"}),Ae.emit(xn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Ae.emit(xn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Ae.emit(xn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Ae.emit(xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Ae.emit(xn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},setActiveStreamBuffer:(n,r)=>{e(s=>{s.streamingInteractionIds.includes(n)&&(s.activeStreamBuffers[n]=r)}),Ae.emit(xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendStreamBuffer:(n,r)=>{e(s=>{s.streamingInteractionIds.includes(n)&&(s.activeStreamBuffers[n]===void 0?s.activeStreamBuffers[n]=r:s.activeStreamBuffers[n]+=r)}),Ae.emit(xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},removeActiveStreamBuffer:n=>{e(r=>{delete r.activeStreamBuffers[n]})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await dt.saveInteraction({...s,rating:r}),Ae.emit(xn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),ke.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Ae.emit(xn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Ae.emit(xn.statusChanged,{status:"idle"}),Ae.emit(xn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Ae.emit(xn.statusChanged,{status:s}),Ae.emit(xn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Ae.emit(xn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Ae.emit(xn.statusChanged,{status:"streaming"}),Ae.emit(xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Ae.emit(xn.statusChanged,{status:t().status}),Ae.emit(xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:xn.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:xn.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:xn.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:xn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:xn.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:xn.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),ic={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},Qh=Do(Fo((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:dr(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Ae.emit(ic.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Ae.emit(ic.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Ae.emit(ic.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:ic.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:ic.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:ic.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),_Y=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(_Y);const qw=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return _Y.has(s)};var CY="vercel.ai.error",vwe=Symbol.for(CY),kY,xwe=class EY extends Error{constructor({name:t,message:n,cause:r}){super(n),this[kY]=!0,this.name=t,this.cause=r}static isInstance(t){return EY.hasMarker(t,CY)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};kY=vwe;var ar=xwe,TY="AI_APICallError",AY=`vercel.ai.error.${TY}`,wwe=Symbol.for(AY),NY,oc=class extends ar{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:TY,message:e,cause:a}),this[NY]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return ar.hasMarker(e,AY)}};NY=wwe;var RY="AI_EmptyResponseBodyError",IY=`vercel.ai.error.${RY}`,Swe=Symbol.for(IY),MY,jY=class extends ar{constructor({message:e="Empty response body"}={}){super({name:RY,message:e}),this[MY]=!0}static isInstance(e){return ar.hasMarker(e,IY)}};MY=Swe;function mS(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var PY="AI_InvalidArgumentError",OY=`vercel.ai.error.${PY}`,_we=Symbol.for(OY),DY,FY=class extends ar{constructor({message:t,cause:n,argument:r}){super({name:PY,message:t,cause:n}),this[DY]=!0,this.argument=r}static isInstance(t){return ar.hasMarker(t,OY)}};DY=_we;var LY="AI_InvalidPromptError",$Y=`vercel.ai.error.${LY}`,Cwe=Symbol.for($Y),BY,qc=class extends ar{constructor({prompt:e,message:t,cause:n}){super({name:LY,message:`Invalid prompt: ${t}`,cause:n}),this[BY]=!0,this.prompt=e}static isInstance(e){return ar.hasMarker(e,$Y)}};BY=Cwe;var zY="AI_InvalidResponseDataError",UY=`vercel.ai.error.${zY}`,kwe=Symbol.for(UY),qY,pf=class extends ar{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:zY,message:t}),this[qY]=!0,this.data=e}static isInstance(e){return ar.hasMarker(e,UY)}};qY=kwe;var VY="AI_JSONParseError",WY=`vercel.ai.error.${VY}`,Ewe=Symbol.for(WY),HY,_k=class extends ar{constructor({text:e,cause:t}){super({name:VY,message:`JSON parsing failed: Text: ${e}.
Error message: ${mS(t)}`,cause:t}),this[HY]=!0,this.text=e}static isInstance(e){return ar.hasMarker(e,WY)}};HY=Ewe;var GY="AI_LoadAPIKeyError",KY=`vercel.ai.error.${GY}`,Twe=Symbol.for(KY),YY,OC=class extends ar{constructor({message:e}){super({name:GY,message:e}),this[YY]=!0}static isInstance(e){return ar.hasMarker(e,KY)}};YY=Twe;var ZY="AI_TooManyEmbeddingValuesForCallError",XY=`vercel.ai.error.${ZY}`,Awe=Symbol.for(XY),JY,LT=class extends ar{constructor(e){super({name:ZY,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[JY]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return ar.hasMarker(e,XY)}};JY=Awe;var QY="AI_TypeValidationError",eZ=`vercel.ai.error.${QY}`,Nwe=Symbol.for(eZ),tZ,Rwe=class qP extends ar{constructor({value:t,cause:n}){super({name:QY,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${mS(n)}`,cause:n}),this[tZ]=!0,this.value=t}static isInstance(t){return ar.hasMarker(t,eZ)}static wrap({value:t,cause:n}){return qP.isInstance(n)&&n.value===t?n:new qP({value:t,cause:n})}};tZ=Nwe;var Ck=Rwe,nZ="AI_UnsupportedFunctionalityError",rZ=`vercel.ai.error.${nZ}`,Iwe=Symbol.for(rZ),sZ,xr=class extends ar{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:nZ,message:t}),this[sZ]=!0,this.functionality=e}static isInstance(e){return ar.hasMarker(e,rZ)}};sZ=Iwe;let Mwe=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var $D={},$T={};$T.byteLength=Owe;$T.toByteArray=Fwe;$T.fromByteArray=Bwe;var $u=[],nc=[],jwe=typeof Uint8Array<"u"?Uint8Array:Array,KI="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var P0=0,Pwe=KI.length;P0<Pwe;++P0)$u[P0]=KI[P0],nc[KI.charCodeAt(P0)]=P0;nc[45]=62;nc[95]=63;function iZ(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function Owe(e){var t=iZ(e),n=t[0],r=t[1];return(n+r)*3/4-r}function Dwe(e,t,n){return(t+n)*3/4-n}function Fwe(e){var t,n=iZ(e),r=n[0],s=n[1],i=new jwe(Dwe(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=nc[e.charCodeAt(l)]<<18|nc[e.charCodeAt(l+1)]<<12|nc[e.charCodeAt(l+2)]<<6|nc[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=nc[e.charCodeAt(l)]<<2|nc[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=nc[e.charCodeAt(l)]<<10|nc[e.charCodeAt(l+1)]<<4|nc[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function Lwe(e){return $u[e>>18&63]+$u[e>>12&63]+$u[e>>6&63]+$u[e&63]}function $we(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(Lwe(r));return s.join("")}function Bwe(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push($we(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push($u[t>>2]+$u[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push($u[t>>10]+$u[t>>4&63]+$u[t<<2&63]+"=")),s.join("")}var BD={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */BD.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,p=e[t+d];for(d+=h,i=p&(1<<-u)-1,p>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(p?-1:1)*a*Math.pow(2,i-r)};BD.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,g=r?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+p]=o&255,p+=g,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+p]=a&255,p+=g,a/=256,c-=8);e[n+p-g]|=y*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=$T,n=BD,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=k,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const Ce=new i(1),U={foo:function(){return 42}};return Object.setPrototypeOf(U,i.prototype),Object.setPrototypeOf(Ce,U),Ce.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(Ce){if(Ce>s)throw new RangeError('The value "'+Ce+'" is invalid for option "size"');const U=new i(Ce);return Object.setPrototypeOf(U,u.prototype),U}function u(Ce,U,ee){if(typeof Ce=="number"){if(typeof U=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(Ce)}return d(Ce,U,ee)}u.poolSize=8192;function d(Ce,U,ee){if(typeof Ce=="string")return y(Ce,U);if(a.isView(Ce))return x(Ce);if(Ce==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ce);if(ut(Ce,a)||Ce&&ut(Ce.buffer,a)||typeof o<"u"&&(ut(Ce,o)||Ce&&ut(Ce.buffer,o)))return w(Ce,U,ee);if(typeof Ce=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const xe=Ce.valueOf&&Ce.valueOf();if(xe!=null&&xe!==Ce)return u.from(xe,U,ee);const Re=S(Ce);if(Re)return Re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Ce[Symbol.toPrimitive]=="function")return u.from(Ce[Symbol.toPrimitive]("string"),U,ee);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ce)}u.from=function(Ce,U,ee){return d(Ce,U,ee)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(Ce){if(typeof Ce!="number")throw new TypeError('"size" argument must be of type number');if(Ce<0)throw new RangeError('The value "'+Ce+'" is invalid for option "size"')}function p(Ce,U,ee){return h(Ce),Ce<=0?c(Ce):U!==void 0?typeof ee=="string"?c(Ce).fill(U,ee):c(Ce).fill(U):c(Ce)}u.alloc=function(Ce,U,ee){return p(Ce,U,ee)};function g(Ce){return h(Ce),c(Ce<0?0:_(Ce)|0)}u.allocUnsafe=function(Ce){return g(Ce)},u.allocUnsafeSlow=function(Ce){return g(Ce)};function y(Ce,U){if((typeof U!="string"||U==="")&&(U="utf8"),!u.isEncoding(U))throw new TypeError("Unknown encoding: "+U);const ee=T(Ce,U)|0;let xe=c(ee);const Re=xe.write(Ce,U);return Re!==ee&&(xe=xe.slice(0,Re)),xe}function v(Ce){const U=Ce.length<0?0:_(Ce.length)|0,ee=c(U);for(let xe=0;xe<U;xe+=1)ee[xe]=Ce[xe]&255;return ee}function x(Ce){if(ut(Ce,i)){const U=new i(Ce);return w(U.buffer,U.byteOffset,U.byteLength)}return v(Ce)}function w(Ce,U,ee){if(U<0||Ce.byteLength<U)throw new RangeError('"offset" is outside of buffer bounds');if(Ce.byteLength<U+(ee||0))throw new RangeError('"length" is outside of buffer bounds');let xe;return U===void 0&&ee===void 0?xe=new i(Ce):ee===void 0?xe=new i(Ce,U):xe=new i(Ce,U,ee),Object.setPrototypeOf(xe,u.prototype),xe}function S(Ce){if(u.isBuffer(Ce)){const U=_(Ce.length)|0,ee=c(U);return ee.length===0||Ce.copy(ee,0,0,U),ee}if(Ce.length!==void 0)return typeof Ce.length!="number"||Pt(Ce.length)?c(0):v(Ce);if(Ce.type==="Buffer"&&Array.isArray(Ce.data))return v(Ce.data)}function _(Ce){if(Ce>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return Ce|0}function k(Ce){return+Ce!=Ce&&(Ce=0),u.alloc(+Ce)}u.isBuffer=function(U){return U!=null&&U._isBuffer===!0&&U!==u.prototype},u.compare=function(U,ee){if(ut(U,i)&&(U=u.from(U,U.offset,U.byteLength)),ut(ee,i)&&(ee=u.from(ee,ee.offset,ee.byteLength)),!u.isBuffer(U)||!u.isBuffer(ee))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(U===ee)return 0;let xe=U.length,Re=ee.length;for(let ve=0,Me=Math.min(xe,Re);ve<Me;++ve)if(U[ve]!==ee[ve]){xe=U[ve],Re=ee[ve];break}return xe<Re?-1:Re<xe?1:0},u.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(U,ee){if(!Array.isArray(U))throw new TypeError('"list" argument must be an Array of Buffers');if(U.length===0)return u.alloc(0);let xe;if(ee===void 0)for(ee=0,xe=0;xe<U.length;++xe)ee+=U[xe].length;const Re=u.allocUnsafe(ee);let ve=0;for(xe=0;xe<U.length;++xe){let Me=U[xe];if(ut(Me,i))ve+Me.length>Re.length?(u.isBuffer(Me)||(Me=u.from(Me)),Me.copy(Re,ve)):i.prototype.set.call(Re,Me,ve);else if(u.isBuffer(Me))Me.copy(Re,ve);else throw new TypeError('"list" argument must be an Array of Buffers');ve+=Me.length}return Re};function T(Ce,U){if(u.isBuffer(Ce))return Ce.length;if(a.isView(Ce)||ut(Ce,a))return Ce.byteLength;if(typeof Ce!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ce);const ee=Ce.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&ee===0)return 0;let Re=!1;for(;;)switch(U){case"ascii":case"latin1":case"binary":return ee;case"utf8":case"utf-8":return Pe(Ce).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee*2;case"hex":return ee>>>1;case"base64":return ot(Ce).length;default:if(Re)return xe?-1:Pe(Ce).length;U=(""+U).toLowerCase(),Re=!0}}u.byteLength=T;function A(Ce,U,ee){let xe=!1;if((U===void 0||U<0)&&(U=0),U>this.length||((ee===void 0||ee>this.length)&&(ee=this.length),ee<=0)||(ee>>>=0,U>>>=0,ee<=U))return"";for(Ce||(Ce="utf8");;)switch(Ce){case"hex":return Z(this,U,ee);case"utf8":case"utf-8":return z(this,U,ee);case"ascii":return B(this,U,ee);case"latin1":case"binary":return G(this,U,ee);case"base64":return D(this,U,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,U,ee);default:if(xe)throw new TypeError("Unknown encoding: "+Ce);Ce=(Ce+"").toLowerCase(),xe=!0}}u.prototype._isBuffer=!0;function R(Ce,U,ee){const xe=Ce[U];Ce[U]=Ce[ee],Ce[ee]=xe}u.prototype.swap16=function(){const U=this.length;if(U%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let ee=0;ee<U;ee+=2)R(this,ee,ee+1);return this},u.prototype.swap32=function(){const U=this.length;if(U%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let ee=0;ee<U;ee+=4)R(this,ee,ee+3),R(this,ee+1,ee+2);return this},u.prototype.swap64=function(){const U=this.length;if(U%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let ee=0;ee<U;ee+=8)R(this,ee,ee+7),R(this,ee+1,ee+6),R(this,ee+2,ee+5),R(this,ee+3,ee+4);return this},u.prototype.toString=function(){const U=this.length;return U===0?"":arguments.length===0?z(this,0,U):A.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(U){if(!u.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:u.compare(this,U)===0},u.prototype.inspect=function(){let U="";const ee=e.INSPECT_MAX_BYTES;return U=this.toString("hex",0,ee).replace(/(.{2})/g,"$1 ").trim(),this.length>ee&&(U+=" ... "),"<Buffer "+U+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(U,ee,xe,Re,ve){if(ut(U,i)&&(U=u.from(U,U.offset,U.byteLength)),!u.isBuffer(U))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof U);if(ee===void 0&&(ee=0),xe===void 0&&(xe=U?U.length:0),Re===void 0&&(Re=0),ve===void 0&&(ve=this.length),ee<0||xe>U.length||Re<0||ve>this.length)throw new RangeError("out of range index");if(Re>=ve&&ee>=xe)return 0;if(Re>=ve)return-1;if(ee>=xe)return 1;if(ee>>>=0,xe>>>=0,Re>>>=0,ve>>>=0,this===U)return 0;let Me=ve-Re,de=xe-ee;const ht=Math.min(Me,de),et=this.slice(Re,ve),W=U.slice(ee,xe);for(let Ve=0;Ve<ht;++Ve)if(et[Ve]!==W[Ve]){Me=et[Ve],de=W[Ve];break}return Me<de?-1:de<Me?1:0};function M(Ce,U,ee,xe,Re){if(Ce.length===0)return-1;if(typeof ee=="string"?(xe=ee,ee=0):ee>2147483647?ee=2147483647:ee<-2147483648&&(ee=-2147483648),ee=+ee,Pt(ee)&&(ee=Re?0:Ce.length-1),ee<0&&(ee=Ce.length+ee),ee>=Ce.length){if(Re)return-1;ee=Ce.length-1}else if(ee<0)if(Re)ee=0;else return-1;if(typeof U=="string"&&(U=u.from(U,xe)),u.isBuffer(U))return U.length===0?-1:j(Ce,U,ee,xe,Re);if(typeof U=="number")return U=U&255,typeof i.prototype.indexOf=="function"?Re?i.prototype.indexOf.call(Ce,U,ee):i.prototype.lastIndexOf.call(Ce,U,ee):j(Ce,[U],ee,xe,Re);throw new TypeError("val must be string, number or Buffer")}function j(Ce,U,ee,xe,Re){let ve=1,Me=Ce.length,de=U.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(Ce.length<2||U.length<2)return-1;ve=2,Me/=2,de/=2,ee/=2}function ht(W,Ve){return ve===1?W[Ve]:W.readUInt16BE(Ve*ve)}let et;if(Re){let W=-1;for(et=ee;et<Me;et++)if(ht(Ce,et)===ht(U,W===-1?0:et-W)){if(W===-1&&(W=et),et-W+1===de)return W*ve}else W!==-1&&(et-=et-W),W=-1}else for(ee+de>Me&&(ee=Me-de),et=ee;et>=0;et--){let W=!0;for(let Ve=0;Ve<de;Ve++)if(ht(Ce,et+Ve)!==ht(U,Ve)){W=!1;break}if(W)return et}return-1}u.prototype.includes=function(U,ee,xe){return this.indexOf(U,ee,xe)!==-1},u.prototype.indexOf=function(U,ee,xe){return M(this,U,ee,xe,!0)},u.prototype.lastIndexOf=function(U,ee,xe){return M(this,U,ee,xe,!1)};function F(Ce,U,ee,xe){ee=Number(ee)||0;const Re=Ce.length-ee;xe?(xe=Number(xe),xe>Re&&(xe=Re)):xe=Re;const ve=U.length;xe>ve/2&&(xe=ve/2);let Me;for(Me=0;Me<xe;++Me){const de=parseInt(U.substr(Me*2,2),16);if(Pt(de))return Me;Ce[ee+Me]=de}return Me}function P(Ce,U,ee,xe){return Et(Pe(U,Ce.length-ee),Ce,ee,xe)}function q(Ce,U,ee,xe){return Et(Be(U),Ce,ee,xe)}function I(Ce,U,ee,xe){return Et(ot(U),Ce,ee,xe)}function V(Ce,U,ee,xe){return Et(je(U,Ce.length-ee),Ce,ee,xe)}u.prototype.write=function(U,ee,xe,Re){if(ee===void 0)Re="utf8",xe=this.length,ee=0;else if(xe===void 0&&typeof ee=="string")Re=ee,xe=this.length,ee=0;else if(isFinite(ee))ee=ee>>>0,isFinite(xe)?(xe=xe>>>0,Re===void 0&&(Re="utf8")):(Re=xe,xe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ve=this.length-ee;if((xe===void 0||xe>ve)&&(xe=ve),U.length>0&&(xe<0||ee<0)||ee>this.length)throw new RangeError("Attempt to write outside buffer bounds");Re||(Re="utf8");let Me=!1;for(;;)switch(Re){case"hex":return F(this,U,ee,xe);case"utf8":case"utf-8":return P(this,U,ee,xe);case"ascii":case"latin1":case"binary":return q(this,U,ee,xe);case"base64":return I(this,U,ee,xe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,U,ee,xe);default:if(Me)throw new TypeError("Unknown encoding: "+Re);Re=(""+Re).toLowerCase(),Me=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function D(Ce,U,ee){return U===0&&ee===Ce.length?t.fromByteArray(Ce):t.fromByteArray(Ce.slice(U,ee))}function z(Ce,U,ee){ee=Math.min(Ce.length,ee);const xe=[];let Re=U;for(;Re<ee;){const ve=Ce[Re];let Me=null,de=ve>239?4:ve>223?3:ve>191?2:1;if(Re+de<=ee){let ht,et,W,Ve;switch(de){case 1:ve<128&&(Me=ve);break;case 2:ht=Ce[Re+1],(ht&192)===128&&(Ve=(ve&31)<<6|ht&63,Ve>127&&(Me=Ve));break;case 3:ht=Ce[Re+1],et=Ce[Re+2],(ht&192)===128&&(et&192)===128&&(Ve=(ve&15)<<12|(ht&63)<<6|et&63,Ve>2047&&(Ve<55296||Ve>57343)&&(Me=Ve));break;case 4:ht=Ce[Re+1],et=Ce[Re+2],W=Ce[Re+3],(ht&192)===128&&(et&192)===128&&(W&192)===128&&(Ve=(ve&15)<<18|(ht&63)<<12|(et&63)<<6|W&63,Ve>65535&&Ve<1114112&&(Me=Ve))}}Me===null?(Me=65533,de=1):Me>65535&&(Me-=65536,xe.push(Me>>>10&1023|55296),Me=56320|Me&1023),xe.push(Me),Re+=de}return Y(xe)}const $=4096;function Y(Ce){const U=Ce.length;if(U<=$)return String.fromCharCode.apply(String,Ce);let ee="",xe=0;for(;xe<U;)ee+=String.fromCharCode.apply(String,Ce.slice(xe,xe+=$));return ee}function B(Ce,U,ee){let xe="";ee=Math.min(Ce.length,ee);for(let Re=U;Re<ee;++Re)xe+=String.fromCharCode(Ce[Re]&127);return xe}function G(Ce,U,ee){let xe="";ee=Math.min(Ce.length,ee);for(let Re=U;Re<ee;++Re)xe+=String.fromCharCode(Ce[Re]);return xe}function Z(Ce,U,ee){const xe=Ce.length;(!U||U<0)&&(U=0),(!ee||ee<0||ee>xe)&&(ee=xe);let Re="";for(let ve=U;ve<ee;++ve)Re+=$t[Ce[ve]];return Re}function ne(Ce,U,ee){const xe=Ce.slice(U,ee);let Re="";for(let ve=0;ve<xe.length-1;ve+=2)Re+=String.fromCharCode(xe[ve]+xe[ve+1]*256);return Re}u.prototype.slice=function(U,ee){const xe=this.length;U=~~U,ee=ee===void 0?xe:~~ee,U<0?(U+=xe,U<0&&(U=0)):U>xe&&(U=xe),ee<0?(ee+=xe,ee<0&&(ee=0)):ee>xe&&(ee=xe),ee<U&&(ee=U);const Re=this.subarray(U,ee);return Object.setPrototypeOf(Re,u.prototype),Re};function ae(Ce,U,ee){if(Ce%1!==0||Ce<0)throw new RangeError("offset is not uint");if(Ce+U>ee)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(U,ee,xe){U=U>>>0,ee=ee>>>0,xe||ae(U,ee,this.length);let Re=this[U],ve=1,Me=0;for(;++Me<ee&&(ve*=256);)Re+=this[U+Me]*ve;return Re},u.prototype.readUintBE=u.prototype.readUIntBE=function(U,ee,xe){U=U>>>0,ee=ee>>>0,xe||ae(U,ee,this.length);let Re=this[U+--ee],ve=1;for(;ee>0&&(ve*=256);)Re+=this[U+--ee]*ve;return Re},u.prototype.readUint8=u.prototype.readUInt8=function(U,ee){return U=U>>>0,ee||ae(U,1,this.length),this[U]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(U,ee){return U=U>>>0,ee||ae(U,2,this.length),this[U]|this[U+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(U,ee){return U=U>>>0,ee||ae(U,2,this.length),this[U]<<8|this[U+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(U,ee){return U=U>>>0,ee||ae(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+this[U+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(U,ee){return U=U>>>0,ee||ae(U,4,this.length),this[U]*16777216+(this[U+1]<<16|this[U+2]<<8|this[U+3])},u.prototype.readBigUInt64LE=Ft(function(U){U=U>>>0,Ne(U,"offset");const ee=this[U],xe=this[U+7];(ee===void 0||xe===void 0)&&fe(U,this.length-8);const Re=ee+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24,ve=this[++U]+this[++U]*2**8+this[++U]*2**16+xe*2**24;return BigInt(Re)+(BigInt(ve)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ft(function(U){U=U>>>0,Ne(U,"offset");const ee=this[U],xe=this[U+7];(ee===void 0||xe===void 0)&&fe(U,this.length-8);const Re=ee*2**24+this[++U]*2**16+this[++U]*2**8+this[++U],ve=this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+xe;return(BigInt(Re)<<BigInt(32))+BigInt(ve)}),u.prototype.readIntLE=function(U,ee,xe){U=U>>>0,ee=ee>>>0,xe||ae(U,ee,this.length);let Re=this[U],ve=1,Me=0;for(;++Me<ee&&(ve*=256);)Re+=this[U+Me]*ve;return ve*=128,Re>=ve&&(Re-=Math.pow(2,8*ee)),Re},u.prototype.readIntBE=function(U,ee,xe){U=U>>>0,ee=ee>>>0,xe||ae(U,ee,this.length);let Re=ee,ve=1,Me=this[U+--Re];for(;Re>0&&(ve*=256);)Me+=this[U+--Re]*ve;return ve*=128,Me>=ve&&(Me-=Math.pow(2,8*ee)),Me},u.prototype.readInt8=function(U,ee){return U=U>>>0,ee||ae(U,1,this.length),this[U]&128?(255-this[U]+1)*-1:this[U]},u.prototype.readInt16LE=function(U,ee){U=U>>>0,ee||ae(U,2,this.length);const xe=this[U]|this[U+1]<<8;return xe&32768?xe|4294901760:xe},u.prototype.readInt16BE=function(U,ee){U=U>>>0,ee||ae(U,2,this.length);const xe=this[U+1]|this[U]<<8;return xe&32768?xe|4294901760:xe},u.prototype.readInt32LE=function(U,ee){return U=U>>>0,ee||ae(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},u.prototype.readInt32BE=function(U,ee){return U=U>>>0,ee||ae(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},u.prototype.readBigInt64LE=Ft(function(U){U=U>>>0,Ne(U,"offset");const ee=this[U],xe=this[U+7];(ee===void 0||xe===void 0)&&fe(U,this.length-8);const Re=this[U+4]+this[U+5]*2**8+this[U+6]*2**16+(xe<<24);return(BigInt(Re)<<BigInt(32))+BigInt(ee+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24)}),u.prototype.readBigInt64BE=Ft(function(U){U=U>>>0,Ne(U,"offset");const ee=this[U],xe=this[U+7];(ee===void 0||xe===void 0)&&fe(U,this.length-8);const Re=(ee<<24)+this[++U]*2**16+this[++U]*2**8+this[++U];return(BigInt(Re)<<BigInt(32))+BigInt(this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+xe)}),u.prototype.readFloatLE=function(U,ee){return U=U>>>0,ee||ae(U,4,this.length),n.read(this,U,!0,23,4)},u.prototype.readFloatBE=function(U,ee){return U=U>>>0,ee||ae(U,4,this.length),n.read(this,U,!1,23,4)},u.prototype.readDoubleLE=function(U,ee){return U=U>>>0,ee||ae(U,8,this.length),n.read(this,U,!0,52,8)},u.prototype.readDoubleBE=function(U,ee){return U=U>>>0,ee||ae(U,8,this.length),n.read(this,U,!1,52,8)};function le(Ce,U,ee,xe,Re,ve){if(!u.isBuffer(Ce))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>Re||U<ve)throw new RangeError('"value" argument is out of bounds');if(ee+xe>Ce.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(U,ee,xe,Re){if(U=+U,ee=ee>>>0,xe=xe>>>0,!Re){const de=Math.pow(2,8*xe)-1;le(this,U,ee,xe,de,0)}let ve=1,Me=0;for(this[ee]=U&255;++Me<xe&&(ve*=256);)this[ee+Me]=U/ve&255;return ee+xe},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(U,ee,xe,Re){if(U=+U,ee=ee>>>0,xe=xe>>>0,!Re){const de=Math.pow(2,8*xe)-1;le(this,U,ee,xe,de,0)}let ve=xe-1,Me=1;for(this[ee+ve]=U&255;--ve>=0&&(Me*=256);)this[ee+ve]=U/Me&255;return ee+xe},u.prototype.writeUint8=u.prototype.writeUInt8=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,1,255,0),this[ee]=U&255,ee+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,2,65535,0),this[ee]=U&255,this[ee+1]=U>>>8,ee+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,2,65535,0),this[ee]=U>>>8,this[ee+1]=U&255,ee+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,4,4294967295,0),this[ee+3]=U>>>24,this[ee+2]=U>>>16,this[ee+1]=U>>>8,this[ee]=U&255,ee+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,4,4294967295,0),this[ee]=U>>>24,this[ee+1]=U>>>16,this[ee+2]=U>>>8,this[ee+3]=U&255,ee+4};function Se(Ce,U,ee,xe,Re){ye(U,xe,Re,Ce,ee,7);let ve=Number(U&BigInt(4294967295));Ce[ee++]=ve,ve=ve>>8,Ce[ee++]=ve,ve=ve>>8,Ce[ee++]=ve,ve=ve>>8,Ce[ee++]=ve;let Me=Number(U>>BigInt(32)&BigInt(4294967295));return Ce[ee++]=Me,Me=Me>>8,Ce[ee++]=Me,Me=Me>>8,Ce[ee++]=Me,Me=Me>>8,Ce[ee++]=Me,ee}function Ee(Ce,U,ee,xe,Re){ye(U,xe,Re,Ce,ee,7);let ve=Number(U&BigInt(4294967295));Ce[ee+7]=ve,ve=ve>>8,Ce[ee+6]=ve,ve=ve>>8,Ce[ee+5]=ve,ve=ve>>8,Ce[ee+4]=ve;let Me=Number(U>>BigInt(32)&BigInt(4294967295));return Ce[ee+3]=Me,Me=Me>>8,Ce[ee+2]=Me,Me=Me>>8,Ce[ee+1]=Me,Me=Me>>8,Ce[ee]=Me,ee+8}u.prototype.writeBigUInt64LE=Ft(function(U,ee=0){return Se(this,U,ee,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ft(function(U,ee=0){return Ee(this,U,ee,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(U,ee,xe,Re){if(U=+U,ee=ee>>>0,!Re){const ht=Math.pow(2,8*xe-1);le(this,U,ee,xe,ht-1,-ht)}let ve=0,Me=1,de=0;for(this[ee]=U&255;++ve<xe&&(Me*=256);)U<0&&de===0&&this[ee+ve-1]!==0&&(de=1),this[ee+ve]=(U/Me>>0)-de&255;return ee+xe},u.prototype.writeIntBE=function(U,ee,xe,Re){if(U=+U,ee=ee>>>0,!Re){const ht=Math.pow(2,8*xe-1);le(this,U,ee,xe,ht-1,-ht)}let ve=xe-1,Me=1,de=0;for(this[ee+ve]=U&255;--ve>=0&&(Me*=256);)U<0&&de===0&&this[ee+ve+1]!==0&&(de=1),this[ee+ve]=(U/Me>>0)-de&255;return ee+xe},u.prototype.writeInt8=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,1,127,-128),U<0&&(U=255+U+1),this[ee]=U&255,ee+1},u.prototype.writeInt16LE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,2,32767,-32768),this[ee]=U&255,this[ee+1]=U>>>8,ee+2},u.prototype.writeInt16BE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,2,32767,-32768),this[ee]=U>>>8,this[ee+1]=U&255,ee+2},u.prototype.writeInt32LE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,4,2147483647,-2147483648),this[ee]=U&255,this[ee+1]=U>>>8,this[ee+2]=U>>>16,this[ee+3]=U>>>24,ee+4},u.prototype.writeInt32BE=function(U,ee,xe){return U=+U,ee=ee>>>0,xe||le(this,U,ee,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),this[ee]=U>>>24,this[ee+1]=U>>>16,this[ee+2]=U>>>8,this[ee+3]=U&255,ee+4},u.prototype.writeBigInt64LE=Ft(function(U,ee=0){return Se(this,U,ee,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ft(function(U,ee=0){return Ee(this,U,ee,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function he(Ce,U,ee,xe,Re,ve){if(ee+xe>Ce.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("Index out of range")}function pe(Ce,U,ee,xe,Re){return U=+U,ee=ee>>>0,Re||he(Ce,U,ee,4),n.write(Ce,U,ee,xe,23,4),ee+4}u.prototype.writeFloatLE=function(U,ee,xe){return pe(this,U,ee,!0,xe)},u.prototype.writeFloatBE=function(U,ee,xe){return pe(this,U,ee,!1,xe)};function Le(Ce,U,ee,xe,Re){return U=+U,ee=ee>>>0,Re||he(Ce,U,ee,8),n.write(Ce,U,ee,xe,52,8),ee+8}u.prototype.writeDoubleLE=function(U,ee,xe){return Le(this,U,ee,!0,xe)},u.prototype.writeDoubleBE=function(U,ee,xe){return Le(this,U,ee,!1,xe)},u.prototype.copy=function(U,ee,xe,Re){if(!u.isBuffer(U))throw new TypeError("argument should be a Buffer");if(xe||(xe=0),!Re&&Re!==0&&(Re=this.length),ee>=U.length&&(ee=U.length),ee||(ee=0),Re>0&&Re<xe&&(Re=xe),Re===xe||U.length===0||this.length===0)return 0;if(ee<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("Index out of range");if(Re<0)throw new RangeError("sourceEnd out of bounds");Re>this.length&&(Re=this.length),U.length-ee<Re-xe&&(Re=U.length-ee+xe);const ve=Re-xe;return this===U&&typeof i.prototype.copyWithin=="function"?this.copyWithin(ee,xe,Re):i.prototype.set.call(U,this.subarray(xe,Re),ee),ve},u.prototype.fill=function(U,ee,xe,Re){if(typeof U=="string"){if(typeof ee=="string"?(Re=ee,ee=0,xe=this.length):typeof xe=="string"&&(Re=xe,xe=this.length),Re!==void 0&&typeof Re!="string")throw new TypeError("encoding must be a string");if(typeof Re=="string"&&!u.isEncoding(Re))throw new TypeError("Unknown encoding: "+Re);if(U.length===1){const Me=U.charCodeAt(0);(Re==="utf8"&&Me<128||Re==="latin1")&&(U=Me)}}else typeof U=="number"?U=U&255:typeof U=="boolean"&&(U=Number(U));if(ee<0||this.length<ee||this.length<xe)throw new RangeError("Out of range index");if(xe<=ee)return this;ee=ee>>>0,xe=xe===void 0?this.length:xe>>>0,U||(U=0);let ve;if(typeof U=="number")for(ve=ee;ve<xe;++ve)this[ve]=U;else{const Me=u.isBuffer(U)?U:u.from(U,Re),de=Me.length;if(de===0)throw new TypeError('The value "'+U+'" is invalid for argument "value"');for(ve=0;ve<xe-ee;++ve)this[ve+ee]=Me[ve%de]}return this};const He={};function Fe(Ce,U,ee){He[Ce]=class extends ee{constructor(){super(),Object.defineProperty(this,"message",{value:U.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Ce}]`,this.stack,delete this.name}get code(){return Ce}set code(Re){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Re,writable:!0})}toString(){return`${this.name} [${Ce}]: ${this.message}`}}}Fe("ERR_BUFFER_OUT_OF_BOUNDS",function(Ce){return Ce?`${Ce} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Fe("ERR_INVALID_ARG_TYPE",function(Ce,U){return`The "${Ce}" argument must be of type number. Received type ${typeof U}`},TypeError),Fe("ERR_OUT_OF_RANGE",function(Ce,U,ee){let xe=`The value of "${Ce}" is out of range.`,Re=ee;return Number.isInteger(ee)&&Math.abs(ee)>2**32?Re=Ie(String(ee)):typeof ee=="bigint"&&(Re=String(ee),(ee>BigInt(2)**BigInt(32)||ee<-(BigInt(2)**BigInt(32)))&&(Re=Ie(Re)),Re+="n"),xe+=` It must be ${U}. Received ${Re}`,xe},RangeError);function Ie(Ce){let U="",ee=Ce.length;const xe=Ce[0]==="-"?1:0;for(;ee>=xe+4;ee-=3)U=`_${Ce.slice(ee-3,ee)}${U}`;return`${Ce.slice(0,ee)}${U}`}function X(Ce,U,ee){Ne(U,"offset"),(Ce[U]===void 0||Ce[U+ee]===void 0)&&fe(U,Ce.length-(ee+1))}function ye(Ce,U,ee,xe,Re,ve){if(Ce>ee||Ce<U){const Me=typeof U=="bigint"?"n":"";let de;throw U===0||U===BigInt(0)?de=`>= 0${Me} and < 2${Me} ** ${(ve+1)*8}${Me}`:de=`>= -(2${Me} ** ${(ve+1)*8-1}${Me}) and < 2 ** ${(ve+1)*8-1}${Me}`,new He.ERR_OUT_OF_RANGE("value",de,Ce)}X(xe,Re,ve)}function Ne(Ce,U){if(typeof Ce!="number")throw new He.ERR_INVALID_ARG_TYPE(U,"number",Ce)}function fe(Ce,U,ee){throw Math.floor(Ce)!==Ce?(Ne(Ce,ee),new He.ERR_OUT_OF_RANGE("offset","an integer",Ce)):U<0?new He.ERR_BUFFER_OUT_OF_BOUNDS:new He.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${U}`,Ce)}const ce=/[^+/0-9A-Za-z-_]/g;function se(Ce){if(Ce=Ce.split("=")[0],Ce=Ce.trim().replace(ce,""),Ce.length<2)return"";for(;Ce.length%4!==0;)Ce=Ce+"=";return Ce}function Pe(Ce,U){U=U||1/0;let ee;const xe=Ce.length;let Re=null;const ve=[];for(let Me=0;Me<xe;++Me){if(ee=Ce.charCodeAt(Me),ee>55295&&ee<57344){if(!Re){if(ee>56319){(U-=3)>-1&&ve.push(239,191,189);continue}else if(Me+1===xe){(U-=3)>-1&&ve.push(239,191,189);continue}Re=ee;continue}if(ee<56320){(U-=3)>-1&&ve.push(239,191,189),Re=ee;continue}ee=(Re-55296<<10|ee-56320)+65536}else Re&&(U-=3)>-1&&ve.push(239,191,189);if(Re=null,ee<128){if((U-=1)<0)break;ve.push(ee)}else if(ee<2048){if((U-=2)<0)break;ve.push(ee>>6|192,ee&63|128)}else if(ee<65536){if((U-=3)<0)break;ve.push(ee>>12|224,ee>>6&63|128,ee&63|128)}else if(ee<1114112){if((U-=4)<0)break;ve.push(ee>>18|240,ee>>12&63|128,ee>>6&63|128,ee&63|128)}else throw new Error("Invalid code point")}return ve}function Be(Ce){const U=[];for(let ee=0;ee<Ce.length;++ee)U.push(Ce.charCodeAt(ee)&255);return U}function je(Ce,U){let ee,xe,Re;const ve=[];for(let Me=0;Me<Ce.length&&!((U-=2)<0);++Me)ee=Ce.charCodeAt(Me),xe=ee>>8,Re=ee%256,ve.push(Re),ve.push(xe);return ve}function ot(Ce){return t.toByteArray(se(Ce))}function Et(Ce,U,ee,xe){let Re;for(Re=0;Re<xe&&!(Re+ee>=U.length||Re>=Ce.length);++Re)U[Re+ee]=Ce[Re];return Re}function ut(Ce,U){return Ce instanceof U||Ce!=null&&Ce.constructor!=null&&Ce.constructor.name!=null&&Ce.constructor.name===U.name}function Pt(Ce){return Ce!==Ce}const $t=function(){const Ce="0123456789abcdef",U=new Array(256);for(let ee=0;ee<16;++ee){const xe=ee*16;for(let Re=0;Re<16;++Re)U[xe+Re]=Ce[ee]+Ce[Re]}return U}();function Ft(Ce){return typeof BigInt>"u"?Ht:Ce}function Ht(){throw new Error("BigInt not supported")}})($D);const un=$D.Buffer,zs=$D.Buffer;var pm={exports:{}},Gz;function zwe(){if(Gz)return pm.exports;Gz=1;const e=typeof un<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&un.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const p of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(const g in p){const y=p[g];y&&typeof y=="object"&&d.push(y)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return pm.exports=i,pm.exports.default=i,pm.exports.parse=i,pm.exports.safeParse=a,pm.exports.scan=s,pm.exports}var Uwe=zwe();const zD=la(Uwe);var qwe={};function Ys(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Vwe(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function Wwe(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function aZ(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,p=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,p)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=Hwe(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function Hwe(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function Ob(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var wg=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=Mwe(n,t);if(e==null)return s;if(n.includes(r))throw new FY({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},wa=wg();function Gwe(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function Kwe(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function z2(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function UD({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new OC({message:`${r} API key must be a string.`});if(typeof Wi>"u")throw new OC({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=qwe[t],e==null)throw new OC({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new OC({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var kk=Symbol.for("vercel.ai.validator");function Ywe(e){return{[kk]:!0,validate:e}}function Zwe(e){return typeof e=="object"&&e!==null&&kk in e&&e[kk]===!0&&"validate"in e}function Xwe(e){return Zwe(e)?e:Jwe(e)}function Jwe(e){return Ywe(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function Qwe({value:e,schema:t}){const n=Db({value:e,schema:t});if(!n.success)throw Ck.wrap({value:e,cause:n.error});return n.value}function Db({value:e,schema:t}){const n=Xwe(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:Ck.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:Ck.wrap({value:e,cause:r})}}}function e1e({text:e,schema:t}){try{const n=zD.parse(e);return t==null?n:Qwe({value:n,schema:t})}catch(n){throw _k.isInstance(n)||Ck.isInstance(n)?n:new _k({text:e,cause:n})}}function eg({text:e,schema:t}){try{const n=zD.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Db({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:_k.isInstance(n)?n:new _k({text:e,cause:n})}}}function Vm(e){try{return zD.parse(e),!0}catch{return!1}}function BT({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Db({value:t[e],schema:n});if(!r.success)throw new FY({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var t1e=()=>globalThis.fetch,Zs=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>oZ({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),n1e=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>oZ({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),oZ=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=t1e()})=>{try{const o=await a(e,{method:"POST",headers:Kwe(t),body:n.content,signal:i}),l=Ob(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw z2(u)||oc.isInstance(u)?u:new oc({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(z2(c)||oc.isInstance(c))?c:new oc({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(z2(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new oc({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function VP(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var Sp=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=Ob(r);if(a.trim()==="")return{responseHeaders:o,value:new oc({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=e1e({text:a,schema:e});return{responseHeaders:o,value:new oc({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new oc({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},_p=e=>async({response:t})=>{const n=Ob(t);if(t.body==null)throw new jY({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(aZ()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(eg({text:r,schema:e}))}}))}},lo=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=eg({text:s,schema:e}),a=Ob(t);if(!i.success)throw new oc({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},r1e=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=Ob(e);if(!e.body)throw new oc({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new oc({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:s1e,atob:i1e}=globalThis;function zT(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=i1e(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function id(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return s1e(t)}function gS(e){return e==null?void 0:e.replace(/\/$/,"")}var os;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(os||(os={}));var Kz;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(Kz||(Kz={}));const wn=os.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Lh=e=>{switch(typeof e){case"undefined":return wn.undefined;case"string":return wn.string;case"number":return Number.isNaN(e)?wn.nan:wn.number;case"boolean":return wn.boolean;case"function":return wn.function;case"bigint":return wn.bigint;case"symbol":return wn.symbol;case"object":return Array.isArray(e)?wn.array:e===null?wn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?wn.promise:typeof Map<"u"&&e instanceof Map?wn.map:typeof Set<"u"&&e instanceof Set?wn.set:typeof Date<"u"&&e instanceof Date?wn.date:wn.object;default:return wn.unknown}},Qt=os.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class tu extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof tu))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,os.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}tu.create=e=>new tu(e);const WP=(e,t)=>{let n;switch(e.code){case Qt.invalid_type:e.received===wn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Qt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,os.jsonStringifyReplacer)}`;break;case Qt.unrecognized_keys:n=`Unrecognized key(s) in object: ${os.joinValues(e.keys,", ")}`;break;case Qt.invalid_union:n="Invalid input";break;case Qt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${os.joinValues(e.options)}`;break;case Qt.invalid_enum_value:n=`Invalid enum value. Expected ${os.joinValues(e.options)}, received '${e.received}'`;break;case Qt.invalid_arguments:n="Invalid function arguments";break;case Qt.invalid_return_type:n="Invalid function return type";break;case Qt.invalid_date:n="Invalid date";break;case Qt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:os.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Qt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Qt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Qt.custom:n="Invalid input";break;case Qt.invalid_intersection_types:n="Intersection results could not be merged";break;case Qt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Qt.not_finite:n="Number must be finite";break;default:n=t.defaultError,os.assertNever(e)}return{message:n}};let a1e=WP;function o1e(){return a1e}const l1e=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function yn(e,t){const n=o1e(),r=l1e({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===WP?void 0:WP].filter(s=>!!s)});e.common.issues.push(r)}class Io{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return pr;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return Io.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return pr;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const pr=Object.freeze({status:"aborted"}),Wx=e=>({status:"dirty",value:e}),Sc=e=>({status:"valid",value:e}),Yz=e=>e.status==="aborted",Zz=e=>e.status==="dirty",Uy=e=>e.status==="valid",Ek=e=>typeof Promise<"u"&&e instanceof Promise;var In;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(In||(In={}));class ad{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Xz=(e,t)=>{if(Uy(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new tu(e.common.issues);return this._error=n,this._error}}};function Or(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Gr{get description(){return this._def.description}_getType(t){return Lh(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Lh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Io,ctx:{common:t.parent.common,data:t.data,parsedType:Lh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(Ek(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Lh(t)},s=this._parseSync({data:t,path:r.path,parent:r});return Xz(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Lh(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return Uy(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>Uy(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Lh(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(Ek(s)?s:Promise.resolve(s));return Xz(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Qt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new rg({schema:this,typeName:nn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Zu.create(this,this._def)}nullable(){return sg.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yu.create(this)}promise(){return jk.create(this,this._def)}or(t){return Ak.create([this,t],this._def)}and(t){return Nk.create(this,t,this._def)}transform(t){return new rg({...Or(this._def),schema:this,typeName:nn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new Pk({...Or(this._def),innerType:this,defaultValue:n,typeName:nn.ZodDefault})}brand(){return new dZ({typeName:nn.ZodBranded,type:this,...Or(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new Ok({...Or(this._def),innerType:this,catchValue:n,typeName:nn.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return VD.create(this,t)}readonly(){return Dk.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const c1e=/^c[^\s-]{8,}$/i,u1e=/^[0-9a-z]+$/,d1e=/^[0-9A-HJKMNP-TV-Z]{26}$/i,f1e=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,h1e=/^[a-z0-9_-]{21}$/i,p1e=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,m1e=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,g1e=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,y1e="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let YI;const b1e=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,v1e=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,x1e=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,w1e=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,S1e=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,_1e=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,lZ="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",C1e=new RegExp(`^${lZ}$`);function cZ(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function k1e(e){return new RegExp(`^${cZ(e)}$`)}function E1e(e){let t=`${lZ}T${cZ(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function T1e(e,t){return!!((t==="v4"||!t)&&b1e.test(e)||(t==="v6"||!t)&&x1e.test(e))}function A1e(e,t){if(!p1e.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function N1e(e,t){return!!((t==="v4"||!t)&&v1e.test(e)||(t==="v6"||!t)&&w1e.test(e))}class lf extends Gr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==wn.string){const i=this._getOrReturnCtx(t);return yn(i,{code:Qt.invalid_type,expected:wn.string,received:i.parsedType}),pr}const r=new Io;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?yn(s,{code:Qt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&yn(s,{code:Qt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")g1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"email",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")YI||(YI=new RegExp(y1e,"u")),YI.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"emoji",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")f1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"uuid",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")h1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"nanoid",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")c1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"cuid",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")u1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"cuid2",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")d1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"ulid",code:Qt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),yn(s,{validation:"url",code:Qt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"regex",code:Qt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?E1e(i).test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?C1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?k1e(i).test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?m1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"duration",code:Qt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?T1e(t.data,i.version)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"ip",code:Qt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?A1e(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"jwt",code:Qt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?N1e(t.data,i.version)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"cidr",code:Qt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?S1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"base64",code:Qt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?_1e.test(t.data)||(s=this._getOrReturnCtx(t,s),yn(s,{validation:"base64url",code:Qt.invalid_string,message:i.message}),r.dirty()):os.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Qt.invalid_string,...In.errToObj(r)})}_addCheck(t){return new lf({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...In.errToObj(t)})}url(t){return this._addCheck({kind:"url",...In.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...In.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...In.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...In.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...In.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...In.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...In.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...In.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...In.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...In.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...In.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...In.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...In.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...In.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...In.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...In.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...In.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...In.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...In.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...In.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...In.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...In.errToObj(n)})}nonempty(t){return this.min(1,In.errToObj(t))}trim(){return new lf({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new lf({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new lf({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}lf.create=e=>new lf({checks:[],typeName:nn.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Or(e)});function R1e(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class qy extends Gr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==wn.number){const i=this._getOrReturnCtx(t);return yn(i,{code:Qt.invalid_type,expected:wn.number,received:i.parsedType}),pr}let r;const s=new Io;for(const i of this._def.checks)i.kind==="int"?os.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?R1e(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.not_finite,message:i.message}),s.dirty()):os.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,In.toString(n))}gt(t,n){return this.setLimit("min",t,!1,In.toString(n))}lte(t,n){return this.setLimit("max",t,!0,In.toString(n))}lt(t,n){return this.setLimit("max",t,!1,In.toString(n))}setLimit(t,n,r,s){return new qy({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:In.toString(s)}]})}_addCheck(t){return new qy({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:In.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:In.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:In.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:In.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:In.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:In.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:In.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:In.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:In.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&os.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}qy.create=e=>new qy({checks:[],typeName:nn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Or(e)});class Vw extends Gr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==wn.bigint)return this._getInvalidInput(t);let r;const s=new Io;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),yn(r,{code:Qt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):os.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return yn(n,{code:Qt.invalid_type,expected:wn.bigint,received:n.parsedType}),pr}gte(t,n){return this.setLimit("min",t,!0,In.toString(n))}gt(t,n){return this.setLimit("min",t,!1,In.toString(n))}lte(t,n){return this.setLimit("max",t,!0,In.toString(n))}lt(t,n){return this.setLimit("max",t,!1,In.toString(n))}setLimit(t,n,r,s){return new Vw({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:In.toString(s)}]})}_addCheck(t){return new Vw({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:In.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:In.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:In.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:In.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:In.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Vw.create=e=>new Vw({checks:[],typeName:nn.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Or(e)});class HP extends Gr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==wn.boolean){const r=this._getOrReturnCtx(t);return yn(r,{code:Qt.invalid_type,expected:wn.boolean,received:r.parsedType}),pr}return Sc(t.data)}}HP.create=e=>new HP({typeName:nn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Or(e)});class Ww extends Gr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==wn.date){const i=this._getOrReturnCtx(t);return yn(i,{code:Qt.invalid_type,expected:wn.date,received:i.parsedType}),pr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return yn(i,{code:Qt.invalid_date}),pr}const r=new Io;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),yn(s,{code:Qt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):os.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Ww({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:In.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:In.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Ww.create=e=>new Ww({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:nn.ZodDate,...Or(e)});class Jz extends Gr{_parse(t){if(this._getType(t)!==wn.symbol){const r=this._getOrReturnCtx(t);return yn(r,{code:Qt.invalid_type,expected:wn.symbol,received:r.parsedType}),pr}return Sc(t.data)}}Jz.create=e=>new Jz({typeName:nn.ZodSymbol,...Or(e)});class GP extends Gr{_parse(t){if(this._getType(t)!==wn.undefined){const r=this._getOrReturnCtx(t);return yn(r,{code:Qt.invalid_type,expected:wn.undefined,received:r.parsedType}),pr}return Sc(t.data)}}GP.create=e=>new GP({typeName:nn.ZodUndefined,...Or(e)});class Tk extends Gr{_parse(t){if(this._getType(t)!==wn.null){const r=this._getOrReturnCtx(t);return yn(r,{code:Qt.invalid_type,expected:wn.null,received:r.parsedType}),pr}return Sc(t.data)}}Tk.create=e=>new Tk({typeName:nn.ZodNull,...Or(e)});class Hw extends Gr{constructor(){super(...arguments),this._any=!0}_parse(t){return Sc(t.data)}}Hw.create=e=>new Hw({typeName:nn.ZodAny,...Or(e)});class KP extends Gr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Sc(t.data)}}KP.create=e=>new KP({typeName:nn.ZodUnknown,...Or(e)});class ep extends Gr{_parse(t){const n=this._getOrReturnCtx(t);return yn(n,{code:Qt.invalid_type,expected:wn.never,received:n.parsedType}),pr}}ep.create=e=>new ep({typeName:nn.ZodNever,...Or(e)});class Qz extends Gr{_parse(t){if(this._getType(t)!==wn.undefined){const r=this._getOrReturnCtx(t);return yn(r,{code:Qt.invalid_type,expected:wn.void,received:r.parsedType}),pr}return Sc(t.data)}}Qz.create=e=>new Qz({typeName:nn.ZodVoid,...Or(e)});class Yu extends Gr{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==wn.array)return yn(n,{code:Qt.invalid_type,expected:wn.array,received:n.parsedType}),pr;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(yn(n,{code:a?Qt.too_big:Qt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(yn(n,{code:Qt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(yn(n,{code:Qt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new ad(n,a,n.path,o)))).then(a=>Io.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new ad(n,a,n.path,o)));return Io.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new Yu({...this._def,minLength:{value:t,message:In.toString(n)}})}max(t,n){return new Yu({...this._def,maxLength:{value:t,message:In.toString(n)}})}length(t,n){return new Yu({...this._def,exactLength:{value:t,message:In.toString(n)}})}nonempty(t){return this.min(1,t)}}Yu.create=(e,t)=>new Yu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:nn.ZodArray,...Or(t)});function K0(e){if(e instanceof qi){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Zu.create(K0(r))}return new qi({...e._def,shape:()=>t})}else return e instanceof Yu?new Yu({...e._def,type:K0(e.element)}):e instanceof Zu?Zu.create(K0(e.unwrap())):e instanceof sg?sg.create(K0(e.unwrap())):e instanceof tg?tg.create(e.items.map(t=>K0(t))):e}class qi extends Gr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=os.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==wn.object){const c=this._getOrReturnCtx(t);return yn(c,{code:Qt.invalid_type,expected:wn.object,received:c.parsedType}),pr}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof ep&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new ad(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof ep){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(yn(s,{code:Qt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new ad(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>Io.mergeObjectSync(r,c)):Io.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return In.errToObj,new qi({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:In.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new qi({...this._def,unknownKeys:"strip"})}passthrough(){return new qi({...this._def,unknownKeys:"passthrough"})}extend(t){return new qi({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new qi({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:nn.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new qi({...this._def,catchall:t})}pick(t){const n={};for(const r of os.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new qi({...this._def,shape:()=>n})}omit(t){const n={};for(const r of os.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new qi({...this._def,shape:()=>n})}deepPartial(){return K0(this)}partial(t){const n={};for(const r of os.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new qi({...this._def,shape:()=>n})}required(t){const n={};for(const r of os.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Zu;)i=i._def.innerType;n[r]=i}return new qi({...this._def,shape:()=>n})}keyof(){return uZ(os.objectKeys(this.shape))}}qi.create=(e,t)=>new qi({shape:()=>e,unknownKeys:"strip",catchall:ep.create(),typeName:nn.ZodObject,...Or(t)});qi.strictCreate=(e,t)=>new qi({shape:()=>e,unknownKeys:"strict",catchall:ep.create(),typeName:nn.ZodObject,...Or(t)});qi.lazycreate=(e,t)=>new qi({shape:e,unknownKeys:"strip",catchall:ep.create(),typeName:nn.ZodObject,...Or(t)});class Ak extends Gr{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new tu(o.ctx.common.issues));return yn(n,{code:Qt.invalid_union,unionErrors:a}),pr}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new tu(l));return yn(n,{code:Qt.invalid_union,unionErrors:o}),pr}}get options(){return this._def.options}}Ak.create=(e,t)=>new Ak({options:e,typeName:nn.ZodUnion,...Or(t)});const Qd=e=>e instanceof Ik?Qd(e.schema):e instanceof rg?Qd(e.innerType()):e instanceof Mk?[e.value]:e instanceof ng?e.options:e instanceof ZP?os.objectValues(e.enum):e instanceof Pk?Qd(e._def.innerType):e instanceof GP?[void 0]:e instanceof Tk?[null]:e instanceof Zu?[void 0,...Qd(e.unwrap())]:e instanceof sg?[null,...Qd(e.unwrap())]:e instanceof dZ||e instanceof Dk?Qd(e.unwrap()):e instanceof Ok?Qd(e._def.innerType):[];class qD extends Gr{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==wn.object)return yn(n,{code:Qt.invalid_type,expected:wn.object,received:n.parsedType}),pr;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(yn(n,{code:Qt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),pr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=Qd(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new qD({typeName:nn.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Or(r)})}}function YP(e,t){const n=Lh(e),r=Lh(t);if(e===t)return{valid:!0,data:e};if(n===wn.object&&r===wn.object){const s=os.objectKeys(t),i=os.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=YP(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===wn.array&&r===wn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=YP(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===wn.date&&r===wn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Nk extends Gr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(Yz(i)||Yz(a))return pr;const o=YP(i.value,a.value);return o.valid?((Zz(i)||Zz(a))&&n.dirty(),{status:n.value,value:o.data}):(yn(r,{code:Qt.invalid_intersection_types}),pr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Nk.create=(e,t,n)=>new Nk({left:e,right:t,typeName:nn.ZodIntersection,...Or(n)});class tg extends Gr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.array)return yn(r,{code:Qt.invalid_type,expected:wn.array,received:r.parsedType}),pr;if(r.data.length<this._def.items.length)return yn(r,{code:Qt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),pr;!this._def.rest&&r.data.length>this._def.items.length&&(yn(r,{code:Qt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new ad(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Io.mergeArray(n,a)):Io.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new tg({...this._def,rest:t})}}tg.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tg({items:e,typeName:nn.ZodTuple,rest:null,...Or(t)})};class Rk extends Gr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.object)return yn(r,{code:Qt.invalid_type,expected:wn.object,received:r.parsedType}),pr;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new ad(r,o,r.path,o)),value:a._parse(new ad(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Io.mergeObjectAsync(n,s):Io.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Gr?new Rk({keyType:t,valueType:n,typeName:nn.ZodRecord,...Or(r)}):new Rk({keyType:lf.create(),valueType:t,typeName:nn.ZodRecord,...Or(n)})}}class e9 extends Gr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.map)return yn(r,{code:Qt.invalid_type,expected:wn.map,received:r.parsedType}),pr;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new ad(r,o,r.path,[c,"key"])),value:i._parse(new ad(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return pr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return pr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}e9.create=(e,t,n)=>new e9({valueType:t,keyType:e,typeName:nn.ZodMap,...Or(n)});class Gw extends Gr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==wn.set)return yn(r,{code:Qt.invalid_type,expected:wn.set,received:r.parsedType}),pr;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(yn(r,{code:Qt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(yn(r,{code:Qt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return pr;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new ad(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new Gw({...this._def,minSize:{value:t,message:In.toString(n)}})}max(t,n){return new Gw({...this._def,maxSize:{value:t,message:In.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Gw.create=(e,t)=>new Gw({valueType:e,minSize:null,maxSize:null,typeName:nn.ZodSet,...Or(t)});class Ik extends Gr{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Ik.create=(e,t)=>new Ik({getter:e,typeName:nn.ZodLazy,...Or(t)});class Mk extends Gr{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return yn(n,{received:n.data,code:Qt.invalid_literal,expected:this._def.value}),pr}return{status:"valid",value:t.data}}get value(){return this._def.value}}Mk.create=(e,t)=>new Mk({value:e,typeName:nn.ZodLiteral,...Or(t)});function uZ(e,t){return new ng({values:e,typeName:nn.ZodEnum,...Or(t)})}class ng extends Gr{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return yn(n,{expected:os.joinValues(r),received:n.parsedType,code:Qt.invalid_type}),pr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return yn(n,{received:n.data,code:Qt.invalid_enum_value,options:r}),pr}return Sc(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return ng.create(t,{...this._def,...n})}exclude(t,n=this._def){return ng.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}ng.create=uZ;class ZP extends Gr{_parse(t){const n=os.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==wn.string&&r.parsedType!==wn.number){const s=os.objectValues(n);return yn(r,{expected:os.joinValues(s),received:r.parsedType,code:Qt.invalid_type}),pr}if(this._cache||(this._cache=new Set(os.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=os.objectValues(n);return yn(r,{received:r.data,code:Qt.invalid_enum_value,options:s}),pr}return Sc(t.data)}get enum(){return this._def.values}}ZP.create=(e,t)=>new ZP({values:e,typeName:nn.ZodNativeEnum,...Or(t)});class jk extends Gr{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==wn.promise&&n.common.async===!1)return yn(n,{code:Qt.invalid_type,expected:wn.promise,received:n.parsedType}),pr;const r=n.parsedType===wn.promise?n.data:Promise.resolve(n.data);return Sc(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}jk.create=(e,t)=>new jk({type:e,typeName:nn.ZodPromise,...Or(t)});class rg extends Gr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{yn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return pr;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?pr:l.status==="dirty"||n.value==="dirty"?Wx(l.value):l});{if(n.value==="aborted")return pr;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?pr:o.status==="dirty"||n.value==="dirty"?Wx(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?pr:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?pr:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Uy(a))return pr;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Uy(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):pr);os.assertNever(s)}}rg.create=(e,t,n)=>new rg({schema:e,typeName:nn.ZodEffects,effect:t,...Or(n)});rg.createWithPreprocess=(e,t,n)=>new rg({schema:t,effect:{type:"preprocess",transform:e},typeName:nn.ZodEffects,...Or(n)});class Zu extends Gr{_parse(t){return this._getType(t)===wn.undefined?Sc(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Zu.create=(e,t)=>new Zu({innerType:e,typeName:nn.ZodOptional,...Or(t)});class sg extends Gr{_parse(t){return this._getType(t)===wn.null?Sc(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}sg.create=(e,t)=>new sg({innerType:e,typeName:nn.ZodNullable,...Or(t)});class Pk extends Gr{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===wn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Pk.create=(e,t)=>new Pk({innerType:e,typeName:nn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Or(t)});class Ok extends Gr{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Ek(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new tu(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new tu(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Ok.create=(e,t)=>new Ok({innerType:e,typeName:nn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Or(t)});class t9 extends Gr{_parse(t){if(this._getType(t)!==wn.nan){const r=this._getOrReturnCtx(t);return yn(r,{code:Qt.invalid_type,expected:wn.nan,received:r.parsedType}),pr}return{status:"valid",value:t.data}}}t9.create=e=>new t9({typeName:nn.ZodNaN,...Or(e)});class dZ extends Gr{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class VD extends Gr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?pr:i.status==="dirty"?(n.dirty(),Wx(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?pr:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new VD({in:t,out:n,typeName:nn.ZodPipeline})}}class Dk extends Gr{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Uy(s)&&(s.value=Object.freeze(s.value)),s);return Ek(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Dk.create=(e,t)=>new Dk({innerType:e,typeName:nn.ZodReadonly,...Or(t)});function n9(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function fZ(e,t={},n){return e?Hw.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=n9(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=n9(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):Hw.create()}var nn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(nn||(nn={}));const Fk=(e,t={message:`Input not instance of ${e.name}`})=>fZ(n=>n instanceof e,t),qe=lf.create,Nt=qy.create,Kn=HP.create,I1e=Ww.create,M1e=Tk.create,Cf=Hw.create,Fb=KP.create;ep.create;const cn=Yu.create,Ze=qi.create,xs=Ak.create,UT=qD.create;Nk.create;tg.create;const tp=Rk.create,j1e=Ik.create,Pn=Mk.create,Ll=ng.create;jk.create;const va=Zu.create;sg.create;function P1e({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${id(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new xr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new xr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new xr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function r9(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function Lk(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var WD=Ze({error:Ze({message:qe(),type:qe().nullish(),param:Cf().nullish(),code:xs([qe(),Nt()]).nullish()})}),od=Sp({errorSchema:WD,errorToMessage:e=>e.error.message});function $k({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function O1e({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new xr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new xr({functionality:`Unsupported tool choice type: ${c}`})}}}var D1e=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:XP(this.modelId)}get defaultObjectGenerationMode(){return $1e(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,p,g,y,v,x,w,S;const _=e.type,k=[];i!=null&&k.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&k.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const T=this.settings.useLegacyFunctionCalling;if(T&&this.settings.parallelToolCalls===!0)throw new xr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(T&&this.supportsStructuredOutputs)throw new xr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:A,warnings:R}=P1e({prompt:t,useLegacyFunctionCalling:T,systemMessageMode:B1e(this.modelId)});k.push(...R);const M={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(p=d==null?void 0:d.openai)==null?void 0:p.maxCompletionTokens,store:(g=d==null?void 0:d.openai)==null?void 0:g.store,metadata:(y=d==null?void 0:d.openai)==null?void 0:y.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:A};switch(XP(this.modelId)?(M.temperature!=null&&(M.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),M.top_p!=null&&(M.top_p=void 0,k.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),M.frequency_penalty!=null&&(M.frequency_penalty=void 0,k.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),M.presence_penalty!=null&&(M.presence_penalty=void 0,k.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),M.logit_bias!=null&&(M.logit_bias=void 0,k.push({type:"other",message:"logitBias is not supported for reasoning models"})),M.logprobs!=null&&(M.logprobs=void 0,k.push({type:"other",message:"logprobs is not supported for reasoning models"})),M.top_logprobs!=null&&(M.top_logprobs=void 0,k.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),M.max_tokens!=null&&(M.max_completion_tokens==null&&(M.max_completion_tokens=M.max_tokens),M.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&M.temperature!=null&&(M.temperature=void 0,k.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),_){case"regular":{const{tools:j,tool_choice:F,functions:P,function_call:q,toolWarnings:I}=O1e({mode:e,useLegacyFunctionCalling:T,structuredOutputs:this.supportsStructuredOutputs});return{args:{...M,tools:j,tool_choice:F,functions:P,function_call:q},warnings:[...k,...I]}}case"object-json":return{args:{...M,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:k};case"object-tool":return{args:T?{...M,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...M,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:k};default:{const j=_;throw new Error(`Unsupported type: ${j}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:p}=await Zs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:c,failedResponseHandler:od,successfulResponseHandler:lo(F1e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:g,...y}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(S.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(S.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:wa(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(_=>{var k;return{toolCallType:"function",toolCallId:(k=_.id)!=null?k:wa(),toolName:_.function.name,args:_.function.arguments}}),finishReason:Lk(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:g,rawSettings:y},rawResponse:{headers:d,body:p},request:{body:JSON.stringify(c)},response:$k(h),warnings:u,logprobs:r9(v.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const y=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...y.response}),y.text&&x.enqueue({type:"text-delta",textDelta:y.text}),y.toolCalls)for(const w of y.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:y.finishReason,usage:y.usage,logprobs:y.logprobs,providerMetadata:y.providerMetadata}),x.close()}}),rawCall:y.rawCall,rawResponse:y.rawResponse,warnings:y.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Zs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:r,failedResponseHandler:od,successfulResponseHandler:_p(L1e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:p}=this.settings,g={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(y,v){var x,w,S,_,k,T,A,R,M,j,F,P;if(!y.success){c="error",v.enqueue({type:"error",error:y.error});return}const q=y.value;if("error"in q){c="error",v.enqueue({type:"error",error:q.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...$k(q)})),q.usage!=null){const{prompt_tokens:$,completion_tokens:Y,prompt_tokens_details:B,completion_tokens_details:G}=q.usage;u={promptTokens:$??void 0,completionTokens:Y??void 0},(G==null?void 0:G.reasoning_tokens)!=null&&(g.openai.reasoningTokens=G==null?void 0:G.reasoning_tokens),(G==null?void 0:G.accepted_prediction_tokens)!=null&&(g.openai.acceptedPredictionTokens=G==null?void 0:G.accepted_prediction_tokens),(G==null?void 0:G.rejected_prediction_tokens)!=null&&(g.openai.rejectedPredictionTokens=G==null?void 0:G.rejected_prediction_tokens),(B==null?void 0:B.cached_tokens)!=null&&(g.openai.cachedPromptTokens=B==null?void 0:B.cached_tokens)}const I=q.choices[0];if((I==null?void 0:I.finish_reason)!=null&&(c=Lk(I.finish_reason)),(I==null?void 0:I.delta)==null)return;const V=I.delta;V.content!=null&&v.enqueue({type:"text-delta",textDelta:V.content});const D=r9(I==null?void 0:I.logprobs);D!=null&&D.length&&(d===void 0&&(d=[]),d.push(...D));const z=p&&V.function_call!=null?[{type:"function",id:wa(),function:V.function_call,index:0}]:V.tool_calls;if(z!=null)for(const $ of z){const Y=$.index;if(l[Y]==null){if($.type!=="function")throw new pf({data:$,message:"Expected 'function' type."});if($.id==null)throw new pf({data:$,message:"Expected 'id' to be a string."});if(((x=$.function)==null?void 0:x.name)==null)throw new pf({data:$,message:"Expected 'function.name' to be a string."});l[Y]={id:$.id,type:"function",function:{name:$.function.name,arguments:(w=$.function.arguments)!=null?w:""},hasFinished:!1};const G=l[Y];((S=G.function)==null?void 0:S.name)!=null&&((_=G.function)==null?void 0:_.arguments)!=null&&(G.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:G.id,toolName:G.function.name,argsTextDelta:G.function.arguments}),Vm(G.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=G.id)!=null?k:wa(),toolName:G.function.name,args:G.function.arguments}),G.hasFinished=!0));continue}const B=l[Y];B.hasFinished||(((T=$.function)==null?void 0:T.arguments)!=null&&(B.function.arguments+=(R=(A=$.function)==null?void 0:A.arguments)!=null?R:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:B.id,toolName:B.function.name,argsTextDelta:(M=$.function.arguments)!=null?M:""}),((j=B.function)==null?void 0:j.name)!=null&&((F=B.function)==null?void 0:F.arguments)!=null&&Vm(B.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=B.id)!=null?P:wa(),toolName:B.function.name,args:B.function.arguments}),B.hasFinished=!0))}},flush(y){var v,x;y.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...g!=null?{providerMetadata:g}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},hZ=Ze({prompt_tokens:Nt().nullish(),completion_tokens:Nt().nullish(),prompt_tokens_details:Ze({cached_tokens:Nt().nullish()}).nullish(),completion_tokens_details:Ze({reasoning_tokens:Nt().nullish(),accepted_prediction_tokens:Nt().nullish(),rejected_prediction_tokens:Nt().nullish()}).nullish()}).nullish(),F1e=Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({message:Ze({role:Pn("assistant").nullish(),content:qe().nullish(),function_call:Ze({arguments:qe(),name:qe()}).nullish(),tool_calls:cn(Ze({id:qe().nullish(),type:Pn("function"),function:Ze({name:qe(),arguments:qe()})})).nullish()}),index:Nt(),logprobs:Ze({content:cn(Ze({token:qe(),logprob:Nt(),top_logprobs:cn(Ze({token:qe(),logprob:Nt()}))})).nullable()}).nullish(),finish_reason:qe().nullish()})),usage:hZ}),L1e=xs([Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({delta:Ze({role:Ll(["assistant"]).nullish(),content:qe().nullish(),function_call:Ze({name:qe().optional(),arguments:qe().optional()}).nullish(),tool_calls:cn(Ze({index:Nt(),id:qe().nullish(),type:Pn("function").nullish(),function:Ze({name:qe().nullish(),arguments:qe().nullish()})})).nullish()}).nullish(),logprobs:Ze({content:cn(Ze({token:qe(),logprob:Nt(),top_logprobs:cn(Ze({token:qe(),logprob:Nt()}))})).nullable()}).nullish(),finish_reason:qe().nullish(),index:Nt()})),usage:hZ}),WD]);function XP(e){return e.startsWith("o")}function $1e(e){return e.startsWith("gpt-4o-audio-preview")}function B1e(e){var t,n;return XP(e)?(n=(t=z1e[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var z1e={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function U1e({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new qc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new xr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new xr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new xr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function s9(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var q1e=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const p=e.type,g=[];a!=null&&g.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&g.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:y,stopSequences:v}=U1e({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:y,stop:x.length>0?x:void 0};switch(p){case"regular":{if((h=e.tools)!=null&&h.length)throw new xr({functionality:"tools"});if(e.toolChoice)throw new xr({functionality:"toolChoice"});return{args:w,warnings:g}}case"object-json":throw new xr({functionality:"object-json mode"});case"object-tool":throw new xr({functionality:"object-tool mode"});default:{const S=p;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Zs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:t,failedResponseHandler:od,successfulResponseHandler:lo(V1e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:Lk(l.finish_reason),logprobs:s9(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:$k(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Zs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:r,failedResponseHandler:od,successfulResponseHandler:_p(W1e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,p){if(!h.success){l="error",p.enqueue({type:"error",error:h.error});return}const g=h.value;if("error"in g){l="error",p.enqueue({type:"error",error:g.error});return}d&&(d=!1,p.enqueue({type:"response-metadata",...$k(g)})),g.usage!=null&&(c={promptTokens:g.usage.prompt_tokens,completionTokens:g.usage.completion_tokens});const y=g.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=Lk(y.finish_reason)),(y==null?void 0:y.text)!=null&&p.enqueue({type:"text-delta",textDelta:y.text});const v=s9(y==null?void 0:y.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},V1e=Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({text:qe(),finish_reason:qe(),logprobs:Ze({tokens:cn(qe()),token_logprobs:cn(Nt()),top_logprobs:cn(tp(qe(),Nt())).nullable()}).nullish()})),usage:Ze({prompt_tokens:Nt(),completion_tokens:Nt()})}),W1e=xs([Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({text:qe(),finish_reason:qe().nullish(),index:Nt(),logprobs:Ze({tokens:cn(qe()),token_logprobs:cn(Nt()),top_logprobs:cn(tp(qe(),Nt())).nullable()}).nullish()})),usage:Ze({prompt_tokens:Nt(),completion_tokens:Nt()}).nullish()}),WD]),H1e=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new LT({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Zs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ys(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:od,successfulResponseHandler:lo(G1e),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},G1e=Ze({data:cn(Ze({embedding:cn(Nt())})),usage:Ze({prompt_tokens:Nt()}).nullish()}),K1e={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Y1e=new Set(["gpt-image-1"]),Z1e=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:K1e[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const p=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:g,responseHeaders:y}=await Zs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ys(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...Y1e.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:od,successfulResponseHandler:lo(X1e),abortSignal:o,fetch:this.config.fetch});return{images:g.data.map(v=>v.b64_json),warnings:h,response:{timestamp:p,modelId:this.modelId,headers:y}}}},X1e=Ze({data:cn(Ze({b64_json:qe()}))}),J1e=Ze({include:cn(qe()).nullish(),language:qe().nullish(),prompt:qe().nullish(),temperature:Nt().min(0).max(1).nullish().default(0),timestampGranularities:cn(Ll(["word","segment"])).nullish().default(["segment"])}),i9={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},Q1e=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=BT({provider:"openai",providerOptions:n,schema:J1e}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([zT(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const p in h){const g=h[p];g!==void 0&&u.append(p,String(g))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await n1e({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),formData:l,failedResponseHandler:od,successfulResponseHandler:lo(eSe),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=u.language!=null&&u.language in i9?i9[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(g=>({text:g.word,startSecond:g.start,endSecond:g.end})))!=null?i:[],language:p,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},eSe=Ze({text:qe(),language:qe().nullish(),duration:Nt().nullish(),words:cn(Ze({word:qe(),start:Nt(),end:Nt()})).nullish()});function tSe({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${id(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new xr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new xr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function a9({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function nSe({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new xr({functionality:`Unsupported tool choice type: ${l}`})}}}var rSe=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,p,g;const y=[],v=wSe(this.modelId),x=e.type;i!=null&&y.push({type:"unsupported-setting",setting:"topK"}),l!=null&&y.push({type:"unsupported-setting",setting:"seed"}),a!=null&&y.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&y.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&y.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:S}=tSe({prompt:c,systemMessageMode:v.systemMessageMode});y.push(...S);const _=BT({provider:"openai",providerOptions:u,schema:SSe}),k=(h=_==null?void 0:_.strictSchemas)!=null?h:!0,T={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:k,name:(p=d.name)!=null?p:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:_==null?void 0:_.metadata,parallel_tool_calls:_==null?void 0:_.parallelToolCalls,previous_response_id:_==null?void 0:_.previousResponseId,store:_==null?void 0:_.store,user:_==null?void 0:_.user,instructions:_==null?void 0:_.instructions,...v.isReasoningModel&&((_==null?void 0:_.reasoningEffort)!=null||(_==null?void 0:_.reasoningSummary)!=null)&&{reasoning:{...(_==null?void 0:_.reasoningEffort)!=null&&{effort:_.reasoningEffort},...(_==null?void 0:_.reasoningSummary)!=null&&{summary:_.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(T.temperature!=null&&(T.temperature=void 0,y.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),T.top_p!=null&&(T.top_p=void 0,y.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:A,tool_choice:R,toolWarnings:M}=nSe({mode:e,strict:k});return{args:{...T,tools:A,tool_choice:R},warnings:[...y,...M]}}case"object-json":return{args:{...T,text:{format:e.schema!=null?{type:"json_schema",strict:k,name:(g=e.name)!=null?g:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:y};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:k}]},warnings:y};default:{const A=x;throw new Error(`Unsupported type: ${A}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await Zs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:l,failedResponseHandler:od,successfulResponseHandler:lo(Ze({id:qe(),created_at:Nt(),model:qe(),output:cn(UT("type",[Ze({type:Pn("message"),role:Pn("assistant"),content:cn(Ze({type:Pn("output_text"),text:qe(),annotations:cn(Ze({type:Pn("url_citation"),start_index:Nt(),end_index:Nt(),url:qe(),title:qe()}))}))}),Ze({type:Pn("function_call"),call_id:qe(),name:qe(),arguments:qe()}),Ze({type:Pn("web_search_call")}),Ze({type:Pn("computer_call")}),Ze({type:Pn("reasoning"),summary:cn(Ze({type:Pn("summary_text"),text:qe()}))})])),incomplete_details:Ze({reason:qe()}).nullable(),usage:pZ})),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),g=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),y=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:p.map(v=>v.text).join(`
`),sources:p.flatMap(v=>v.annotations.map(x=>{var w,S,_;return{sourceType:"url",id:(_=(S=(w=this.config).generateId)==null?void 0:S.call(w))!=null?_:wa(),url:x.url,title:x.title}})),finishReason:a9({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:g.length>0}),toolCalls:g.length>0?g:void 0,reasoning:y?y.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Zs({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:od,successfulResponseHandler:_p(fSe),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let p=!1;return{stream:s.pipeThrough(new TransformStream({transform(g,y){var v,x,w,S,_,k,T,A;if(!g.success){a="error",y.enqueue({type:"error",error:g.error});return}const R=g.value;if(bSe(R))R.item.type==="function_call"&&(h[R.output_index]={toolName:R.item.name,toolCallId:R.item.call_id},y.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:R.item.call_id,toolName:R.item.name,argsTextDelta:R.item.arguments}));else if(ySe(R)){const M=h[R.output_index];M!=null&&y.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:M.toolCallId,toolName:M.toolName,argsTextDelta:R.delta})}else gSe(R)?(d=R.response.id,y.enqueue({type:"response-metadata",id:R.response.id,timestamp:new Date(R.response.created_at*1e3),modelId:R.response.model})):hSe(R)?y.enqueue({type:"text-delta",textDelta:R.delta}):xSe(R)?y.enqueue({type:"reasoning",textDelta:R.delta}):pSe(R)&&R.item.type==="function_call"?(h[R.output_index]=void 0,p=!0,y.enqueue({type:"tool-call",toolCallType:"function",toolCallId:R.item.call_id,toolName:R.item.name,args:R.item.arguments})):mSe(R)?(a=a9({finishReason:(v=R.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:p}),o=R.response.usage.input_tokens,l=R.response.usage.output_tokens,c=(w=(x=R.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(_=(S=R.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?_:u):vSe(R)&&y.enqueue({type:"source",source:{sourceType:"url",id:(A=(T=(k=i.config).generateId)==null?void 0:T.call(k))!=null?A:wa(),url:R.annotation.url,title:R.annotation.title}})},flush(g){g.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},pZ=Ze({input_tokens:Nt(),input_tokens_details:Ze({cached_tokens:Nt().nullish()}).nullish(),output_tokens:Nt(),output_tokens_details:Ze({reasoning_tokens:Nt().nullish()}).nullish()}),sSe=Ze({type:Pn("response.output_text.delta"),delta:qe()}),iSe=Ze({type:Ll(["response.completed","response.incomplete"]),response:Ze({incomplete_details:Ze({reason:qe()}).nullish(),usage:pZ})}),aSe=Ze({type:Pn("response.created"),response:Ze({id:qe(),created_at:Nt(),model:qe()})}),oSe=Ze({type:Pn("response.output_item.done"),output_index:Nt(),item:UT("type",[Ze({type:Pn("message")}),Ze({type:Pn("function_call"),id:qe(),call_id:qe(),name:qe(),arguments:qe(),status:Pn("completed")})])}),lSe=Ze({type:Pn("response.function_call_arguments.delta"),item_id:qe(),output_index:Nt(),delta:qe()}),cSe=Ze({type:Pn("response.output_item.added"),output_index:Nt(),item:UT("type",[Ze({type:Pn("message")}),Ze({type:Pn("function_call"),id:qe(),call_id:qe(),name:qe(),arguments:qe()})])}),uSe=Ze({type:Pn("response.output_text.annotation.added"),annotation:Ze({type:Pn("url_citation"),url:qe(),title:qe()})}),dSe=Ze({type:Pn("response.reasoning_summary_text.delta"),item_id:qe(),output_index:Nt(),summary_index:Nt(),delta:qe()}),fSe=xs([sSe,iSe,aSe,oSe,lSe,cSe,uSe,dSe,Ze({type:qe()}).passthrough()]);function hSe(e){return e.type==="response.output_text.delta"}function pSe(e){return e.type==="response.output_item.done"}function mSe(e){return e.type==="response.completed"||e.type==="response.incomplete"}function gSe(e){return e.type==="response.created"}function ySe(e){return e.type==="response.function_call_arguments.delta"}function bSe(e){return e.type==="response.output_item.added"}function vSe(e){return e.type==="response.output_text.annotation.added"}function xSe(e){return e.type==="response.reasoning_summary_text.delta"}function wSe(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var SSe=Ze({metadata:Cf().nullish(),parallelToolCalls:Kn().nullish(),previousResponseId:qe().nullish(),store:Kn().nullish(),user:qe().nullish(),reasoningEffort:qe().nullish(),strictSchemas:Kn().nullish(),instructions:qe().nullish(),reasoningSummary:qe().nullish()}),_Se=Ze({});function CSe({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:_Se}}var kSe={webSearchPreview:CSe},ESe=Ze({instructions:qe().nullish(),speed:Nt().min(.25).max(4).default(1).nullish()}),TSe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=BT({provider:"openai",providerOptions:i,schema:ESe}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Zs({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:i,failedResponseHandler:od,successfulResponseHandler:r1e(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function mZ(e={}){var t,n,r;const s=(t=gS(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${UD({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new D1e(x,w,{provider:`${a}.chat`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new q1e(x,w,{provider:`${a}.completion`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new H1e(x,w,{provider:`${a}.embedding`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new Z1e(x,w,{provider:`${a}.image`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),h=x=>new Q1e(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),p=x=>new TSe(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),g=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},y=x=>new rSe(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return g(x,w)};return v.languageModel=g,v.chat=l,v.completion=c,v.responses=y,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=p,v.speechModel=p,v.tools=kSe,v}mZ({compatibility:"strict"});function rc(e){if(ASe(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,p={};if(n&&(p.description=n),r&&(p.required=r),c&&(p.format=c),u!==void 0&&(p.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(p.type=t.filter(g=>g!=="null")[0],p.nullable=!0):p.type=t:t==="null"?p.type="null":p.type=t),h!==void 0&&(p.enum=h),s!=null&&(p.properties=Object.entries(s).reduce((g,[y,v])=>(g[y]=rc(v),g),{})),i&&(p.items=Array.isArray(i)?i.map(rc):rc(i)),a&&(p.allOf=a.map(rc)),o)if(o.some(g=>typeof g=="object"&&(g==null?void 0:g.type)==="null")){const g=o.filter(y=>!(typeof y=="object"&&(y==null?void 0:y.type)==="null"));if(g.length===1){const y=rc(g[0]);typeof y=="object"&&(p.nullable=!0,Object.assign(p,y))}else p.anyOf=g.map(rc),p.nullable=!0}else p.anyOf=o.map(rc);return l&&(p.oneOf=l.map(rc)),d!==void 0&&(p.minLength=d),p}function ASe(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function NSe(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new xr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:id(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new xr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new xr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function o9(e){return e.includes("/")?e:`models/${e}`}var RSe=Ze({error:Ze({code:Nt().nullable(),message:qe(),status:qe()})}),JP=Sp({errorSchema:RSe,errorToMessage:e=>e.error.message});function ISe(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const p of a)p.type==="provider-defined"?o.push({type:"unsupported-tool",tool:p}):u.push({name:p.name,description:(i=p.description)!=null?i:"",parameters:rc(p.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const p=h;throw new xr({functionality:`Unsupported tool choice type: ${p}`})}}}function l9({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var MSe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,p,g;const y=e.type,v=[],x=BT({provider:"google",providerOptions:d,schema:DSe});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?rc(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:S,systemInstruction:_}=NSe(t);switch(y){case"regular":{const{tools:k,toolConfig:T,toolWarnings:A}=ISe(e,(p=this.settings.useSearchGrounding)!=null?p:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:S,systemInstruction:_,safetySettings:this.settings.safetySettings,tools:k,toolConfig:T,cachedContent:this.settings.cachedContent},warnings:[...v,...A]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?rc(e.schema):void 0},contents:S,systemInstruction:_,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(g=e.tool.description)!=null?g:"",parameters:rc(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const k=y;throw new Error(`Unsupported type: ${k}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=Ys(await VP(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await Zs({url:`${this.config.baseURL}/${o9(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:JP,successfulResponseHandler:lo(PSe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:p,...g}=a,y=d.candidates[0],v=y.content==null||typeof y.content!="object"||!("parts"in y.content)?[]:y.content.parts,x=c9({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:u9(v),reasoning:d9(v),files:(t=f9(v))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:x,finishReason:l9({finishReason:y.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:p,rawSettings:g},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=y.groundingMetadata)!=null?s:null,safetyRatings:(i=y.safetyRatings)!=null?i:null}},sources:h9({groundingMetadata:y.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=Ys(await VP(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Zs({url:`${this.config.baseURL}/${o9(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:JP,successfulResponseHandler:_p(OSe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let p=!1;return{stream:a.pipeThrough(new TransformStream({transform(g,y){var v,x,w,S,_,k;if(!g.success){y.enqueue({type:"error",error:g.error});return}const T=g.value,A=T.usageMetadata;A!=null&&(u={promptTokens:(v=A.promptTokenCount)!=null?v:NaN,completionTokens:(x=A.candidatesTokenCount)!=null?x:NaN});const R=(w=T.candidates)==null?void 0:w[0];if(R==null)return;const M=R.content;if(M!=null){const j=u9(M.parts);j!=null&&y.enqueue({type:"text-delta",textDelta:j});const F=d9(M.parts);if(F!=null)for(const I of F)y.enqueue({type:"reasoning",textDelta:I.text});const P=f9(M.parts);if(P!=null)for(const I of P)y.enqueue({type:"file",mimeType:I.inlineData.mimeType,data:I.inlineData.data});const q=c9({parts:M.parts,generateId:h});if(q!=null)for(const I of q)y.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:I.args}),y.enqueue({type:"tool-call",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,args:I.args}),p=!0}if(R.finishReason!=null){c=l9({finishReason:R.finishReason,hasToolCalls:p});const j=(S=h9({groundingMetadata:R.groundingMetadata,generateId:h}))!=null?S:[];for(const F of j)y.enqueue({type:"source",source:F});d={google:{groundingMetadata:(_=R.groundingMetadata)!=null?_:null,safetyRatings:(k=R.safetyRatings)!=null?k:null}}}},flush(g){g.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function c9({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function u9(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function d9(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function f9(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function h9({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var gZ=Ze({parts:cn(xs([Ze({functionCall:Ze({name:qe(),args:Fb()})}),Ze({inlineData:Ze({mimeType:qe(),data:qe()})}),Ze({text:qe().nullish(),thought:Kn().nullish()})])).nullish()}),jSe=Ze({web:Ze({uri:qe(),title:qe()}).nullish(),retrievedContext:Ze({uri:qe(),title:qe()}).nullish()}),yZ=Ze({webSearchQueries:cn(qe()).nullish(),retrievalQueries:cn(qe()).nullish(),searchEntryPoint:Ze({renderedContent:qe()}).nullish(),groundingChunks:cn(jSe).nullish(),groundingSupports:cn(Ze({segment:Ze({startIndex:Nt().nullish(),endIndex:Nt().nullish(),text:qe().nullish()}),segment_text:qe().nullish(),groundingChunkIndices:cn(Nt()).nullish(),supportChunkIndices:cn(Nt()).nullish(),confidenceScores:cn(Nt()).nullish(),confidenceScore:cn(Nt()).nullish()})).nullish(),retrievalMetadata:xs([Ze({webDynamicRetrievalScore:Nt()}),Ze({})]).nullish()}),bZ=Ze({category:qe().nullish(),probability:qe().nullish(),probabilityScore:Nt().nullish(),severity:qe().nullish(),severityScore:Nt().nullish(),blocked:Kn().nullish()}),PSe=Ze({candidates:cn(Ze({content:gZ.nullish().or(Ze({}).strict()),finishReason:qe().nullish(),safetyRatings:cn(bZ).nullish(),groundingMetadata:yZ.nullish()})),usageMetadata:Ze({promptTokenCount:Nt().nullish(),candidatesTokenCount:Nt().nullish(),totalTokenCount:Nt().nullish()}).nullish()}),OSe=Ze({candidates:cn(Ze({content:gZ.nullish(),finishReason:qe().nullish(),safetyRatings:cn(bZ).nullish(),groundingMetadata:yZ.nullish()})).nullish(),usageMetadata:Ze({promptTokenCount:Nt().nullish(),candidatesTokenCount:Nt().nullish(),totalTokenCount:Nt().nullish()}).nullish()}),DSe=Ze({responseModalities:cn(Ll(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ze({thinkingBudget:Nt().nullish(),includeThoughts:Kn().nullish()}).nullish()}),FSe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new LT({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=Ys(await VP(this.config.headers),t),{responseHeaders:s,value:i}=await Zs({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:JP,successfulResponseHandler:lo(LSe),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},LSe=Ze({embeddings:cn(Ze({values:cn(Nt())}))});function $Se(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function vZ(e={}){var t;const n=(t=gS(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":UD({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new MSe(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:wa,isSupportedUrl:$Se,fetch:e.fetch})},i=(o,l={})=>new FSe(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}vZ();var BSe=Object.defineProperty,zSe=Object.defineProperties,USe=Object.getOwnPropertyDescriptors,Bk=Object.getOwnPropertySymbols,xZ=Object.prototype.hasOwnProperty,wZ=Object.prototype.propertyIsEnumerable,p9=(e,t,n)=>t in e?BSe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ka=(e,t)=>{for(var n in t||(t={}))xZ.call(t,n)&&p9(e,n,t[n]);if(Bk)for(var n of Bk(t))wZ.call(t,n)&&p9(e,n,t[n]);return e},U2=(e,t)=>zSe(e,USe(t)),zk=(e,t)=>{var n={};for(var r in e)xZ.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Bk)for(var r of Bk(e))t.indexOf(r)<0&&wZ.call(e,r)&&(n[r]=e[r]);return n},qSe=Ze({type:Pn("reasoning.summary"),summary:qe()}),VSe=Ze({type:Pn("reasoning.encrypted"),data:qe()}),WSe=Ze({type:Pn("reasoning.text"),text:qe().nullish(),signature:qe().nullish()}),HSe=xs([qSe,VSe,WSe]),GSe=xs([HSe,Fb().transform(()=>null)]),HD=cn(GSe).transform(e=>e.filter(t=>!!t));function Th(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function KSe(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:Th(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=Th(o))!=null?n:Th(a[0].providerMetadata)});break}const l=Th(o),c=a.map(u=>{var d,h,p,g;const y=(d=Th(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:y};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${id(u.image)}`},cache_control:y};case"file":return{type:"file",file:{filename:String((g=(p=u.providerMetadata)==null?void 0:p.openrouter)==null?void 0:g.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${id(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:y};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const p=h;throw new Error(`Unsupported part: ${p}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:Th(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Th(o))!=null?r:Th(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function m9(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function Uk(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var GD=Ze({error:Ze({code:xs([qe(),Nt()]).nullable(),message:qe(),type:qe().nullable(),param:Cf().nullable()})}),qk=Sp({errorSchema:GD,errorToMessage:e=>e.error.message});function YSe(e){return"parameters"in e}var ZSe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const p=e.type,g=(h=d==null?void 0:d.openrouter)!=null?h:{},y=Ka(Ka(Ka({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:KSe(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),g);switch(p){case"regular":return Ka(Ka({},y),QSe(e));case"object-json":return U2(Ka({},y),{response_format:{type:"json_object"}});case"object-tool":return U2(Ka({},y),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=p;throw new xr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await Zs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:u,failedResponseHandler:qk,successfulResponseHandler:lo(XSe),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=u,{messages:g}=p,y=zk(p,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const S=Object.keys(w).length>0,_=(o=v.message.reasoning_details)!=null?o:[],k=_.length>0?_.map(T=>{var A;switch(T.type){case"reasoning.text":{if(T.text)return{type:"text",text:T.text,signature:(A=T.signature)!=null?A:void 0};break}case"reasoning.summary":{if(T.summary)return{type:"text",text:T.summary};break}case"reasoning.encrypted":{if(T.data)return{type:"redacted",data:T.data};break}}return null}).filter(T=>T!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return Ka({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:k,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(T=>{var A;return{toolCallType:"function",toolCallId:(A=T.id)!=null?A:wa(),toolName:T.function.name,args:T.function.arguments}}),finishReason:Uk(v.finish_reason),usage:x,rawCall:{rawPrompt:g,rawSettings:y},rawResponse:{headers:d},warnings:[],logprobs:m9(v.logprobs)},S?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await Zs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:U2(Ka({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?Ka({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:qk,successfulResponseHandler:_p(JSe),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=zk(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const p={},g=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(y,v){var x,w,S,_,k,T,A,R,M,j,F,P,q,I;if(!y.success){u="error",v.enqueue({type:"error",error:y.error});return}const V=y.value;if("error"in V){u="error",v.enqueue({type:"error",error:V.error});return}V.id&&v.enqueue({type:"response-metadata",id:V.id}),V.model&&v.enqueue({type:"response-metadata",modelId:V.model}),V.usage!=null&&(d={promptTokens:V.usage.prompt_tokens,completionTokens:V.usage.completion_tokens},p.promptTokens=V.usage.prompt_tokens,V.usage.prompt_tokens_details&&(p.promptTokensDetails={cachedTokens:(x=V.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),p.completionTokens=V.usage.completion_tokens,V.usage.completion_tokens_details&&(p.completionTokensDetails={reasoningTokens:(w=V.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),p.cost=V.usage.cost,p.totalTokens=V.usage.total_tokens);const D=V.choices[0];if((D==null?void 0:D.finish_reason)!=null&&(u=Uk(D.finish_reason)),(D==null?void 0:D.delta)==null)return;const z=D.delta;if(z.content!=null&&v.enqueue({type:"text-delta",textDelta:z.content}),z.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:z.reasoning}),z.reasoning_details&&z.reasoning_details.length>0)for(const Y of z.reasoning_details)switch(Y.type){case"reasoning.text":{Y.text&&v.enqueue({type:"reasoning",textDelta:Y.text}),Y.signature&&v.enqueue({type:"reasoning-signature",signature:Y.signature});break}case"reasoning.encrypted":{Y.data&&v.enqueue({type:"redacted-reasoning",data:Y.data});break}case"reasoning.summary":{Y.summary&&v.enqueue({type:"reasoning",textDelta:Y.summary});break}}const $=m9(D==null?void 0:D.logprobs);if($!=null&&$.length&&(h===void 0&&(h=[]),h.push(...$)),z.tool_calls!=null)for(const Y of z.tool_calls){const B=Y.index;if(c[B]==null){if(Y.type!=="function")throw new pf({data:Y,message:"Expected 'function' type."});if(Y.id==null)throw new pf({data:Y,message:"Expected 'id' to be a string."});if(((S=Y.function)==null?void 0:S.name)==null)throw new pf({data:Y,message:"Expected 'function.name' to be a string."});c[B]={id:Y.id,type:"function",function:{name:Y.function.name,arguments:(_=Y.function.arguments)!=null?_:""},sent:!1};const Z=c[B];if(Z==null)throw new Error("Tool call is missing");((k=Z.function)==null?void 0:k.name)!=null&&((T=Z.function)==null?void 0:T.arguments)!=null&&Vm(Z.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Z.id,toolName:Z.function.name,argsTextDelta:Z.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(A=Z.id)!=null?A:wa(),toolName:Z.function.name,args:Z.function.arguments}),Z.sent=!0);continue}const G=c[B];if(G==null)throw new Error("Tool call is missing");((R=Y.function)==null?void 0:R.arguments)!=null&&(G.function.arguments+=(j=(M=Y.function)==null?void 0:M.arguments)!=null?j:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:G.id,toolName:G.function.name,argsTextDelta:(F=Y.function.arguments)!=null?F:""}),((P=G.function)==null?void 0:P.name)!=null&&((q=G.function)==null?void 0:q.arguments)!=null&&Vm(G.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(I=G.id)!=null?I:wa(),toolName:G.function.name,args:G.function.arguments}),G.sent=!0)}},flush(y){var v;if(u==="tool-calls")for(const S of c)S.sent||(y.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=S.id)!=null?v:wa(),toolName:S.function.name,args:Vm(S.function.arguments)?S.function.arguments:"{}"}),S.sent=!0);const x={};g&&(p.totalTokens!==void 0||p.cost!==void 0||p.promptTokensDetails!==void 0||p.completionTokensDetails!==void 0)&&(x.openrouter={usage:p});const w=Object.keys(x).length>0&&g;y.enqueue(Ka({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},SZ=Ze({id:qe().optional(),model:qe().optional(),usage:Ze({prompt_tokens:Nt(),prompt_tokens_details:Ze({cached_tokens:Nt()}).nullish(),completion_tokens:Nt(),completion_tokens_details:Ze({reasoning_tokens:Nt()}).nullish(),total_tokens:Nt(),cost:Nt().optional()}).nullish()}),XSe=SZ.extend({choices:cn(Ze({message:Ze({role:Pn("assistant"),content:qe().nullable().optional(),reasoning:qe().nullable().optional(),reasoning_details:HD.nullish(),tool_calls:cn(Ze({id:qe().optional().nullable(),type:Pn("function"),function:Ze({name:qe(),arguments:qe()})})).optional()}),index:Nt(),logprobs:Ze({content:cn(Ze({token:qe(),logprob:Nt(),top_logprobs:cn(Ze({token:qe(),logprob:Nt()}))})).nullable()}).nullable().optional(),finish_reason:qe().optional().nullable()}))}),JSe=xs([SZ.extend({choices:cn(Ze({delta:Ze({role:Ll(["assistant"]).optional(),content:qe().nullish(),reasoning:qe().nullish().optional(),reasoning_details:HD.nullish(),tool_calls:cn(Ze({index:Nt(),id:qe().nullish(),type:Pn("function").optional(),function:Ze({name:qe().nullish(),arguments:qe().nullish()})})).nullish()}).nullish(),logprobs:Ze({content:cn(Ze({token:qe(),logprob:Nt(),top_logprobs:cn(Ze({token:qe(),logprob:Nt()}))})).nullable()}).nullish(),finish_reason:qe().nullable().optional(),index:Nt()}))}),GD]);function QSe(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>YSe(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function e_e({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new qc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new xr({functionality:"images"});case"file":throw new xr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new xr({functionality:"tool-call messages"});case"reasoning":throw new xr({functionality:"reasoning messages"});case"redacted-reasoning":throw new xr({functionality:"redacted reasoning messages"});case"file":throw new xr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new xr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function g9(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var t_e=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var p,g;const y=e.type,v=(p=h==null?void 0:h.openrouter)!=null?p:{},{prompt:x}=e_e({prompt:n,inputFormat:t}),w=Ka(Ka(Ka({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(y){case"regular":{if((g=e.tools)!=null&&g.length)throw new xr({functionality:"tools"});if(e.toolChoice)throw new xr({functionality:"toolChoice"});return w}case"object-json":throw new xr({functionality:"object-json mode"});case"object-tool":throw new xr({functionality:"object-tool mode"});default:{const S=y;throw new xr({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Zs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:a,failedResponseHandler:qk,successfulResponseHandler:lo(y9),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=zk(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:Uk(h.finish_reason),logprobs:g9(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Zs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:U2(Ka({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:qk,successfulResponseHandler:_p(y9),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=zk(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const p=h.choices[0];(p==null?void 0:p.finish_reason)!=null&&(o=Uk(p.finish_reason)),(p==null?void 0:p.text)!=null&&d.enqueue({type:"text-delta",textDelta:p.text});const g=g9(p==null?void 0:p.logprobs);g!=null&&g.length&&(c===void 0&&(c=[]),c.push(...g))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},y9=xs([Ze({id:qe().optional(),model:qe().optional(),choices:cn(Ze({text:qe(),reasoning:qe().nullish().optional(),reasoning_details:HD.nullish(),finish_reason:qe().nullish(),index:Nt(),logprobs:Ze({tokens:cn(qe()),token_logprobs:cn(Nt()),top_logprobs:cn(tp(qe(),Nt())).nullable()}).nullable().optional()})),usage:Ze({prompt_tokens:Nt(),completion_tokens:Nt()}).optional().nullable()}),GD]);function _Z(e={}){var t,n,r;const s=(n=gS((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>Ka({Authorization:`Bearer ${UD({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new ZSe(d,h,{provider:"openrouter.chat",url:({path:p})=>`${s}${p}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new t_e(d,h,{provider:"openrouter.completion",url:({path:p})=>`${s}${p}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}_Z({compatibility:"strict"});var mm={},ZI={},b9;function v9(){return b9||(b9=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(ZI)),ZI}var x9;function n_e(){return x9||(x9=1,function(e){var t=mm&&mm.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var p=Object.getOwnPropertyDescriptor(u,d);(!p||("get"in p?!u.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,p)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=mm&&mm.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=v9();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(v9(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const p=k=>{throw new s(`${k} at position ${h}`)},g=k=>{throw new i(`${k} at position ${h}`)},y=()=>(_(),h>=d&&p("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),v=()=>{const k=h;let T=!1;for(h++;h<d&&(c[h]!=='"'||T&&c[h-1]==="\\");)T=c[h]==="\\"?!T:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(k,++h-Number(T)))}catch(A){g(String(A))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(k,h-Number(T))+'"')}catch{return JSON.parse(c.substring(k,c.lastIndexOf("\\"))+'"')}p("Unterminated string literal")},x=()=>{h++,_();const k={};try{for(;c[h]!=="}";){if(_(),h>=d&&r.Allow.OBJ&u)return k;const T=v();_(),h++;try{const A=y();k[T]=A}catch(A){if(r.Allow.OBJ&u)return k;throw A}_(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return k;p("Expected '}' at end of object")}return h++,k},w=()=>{h++;const k=[];try{for(;c[h]!=="]";)k.push(y()),_(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return k;p("Expected ']' at end of array")}return h++,k},S=()=>{if(h===0){c==="-"&&g("Not sure what '-' is");try{return JSON.parse(c)}catch(T){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}g(String(T))}}const k=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&p("Unterminated number literal");try{return JSON.parse(c.substring(k,h))}catch{c.substring(k,h)==="-"&&p("Not sure what '-' is");try{return JSON.parse(c.substring(k,c.lastIndexOf("e")))}catch(A){g(String(A))}}},_=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return y()},l=a;e.parse=l}(mm)),mm}var r_e=n_e();function XI(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new xr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(id(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var s_e=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=r_e.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:wa(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function i_e({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var a_e=Ze({error:Ze({code:qe().nullable(),message:qe(),param:Cf().nullable(),type:qe()})}),QP=Sp({errorSchema:a_e,errorToMessage:e=>e.error.message});function o_e({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new xr({functionality:`Unsupported tool choice type: ${o}`})}}}function l_e(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var c_e=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},u_e=e=>async({response:t})=>{const n=Ob(t);if(t.body===null)throw new jY({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new c_e).pipeThrough(new TransformStream({transform(r,s){s.enqueue(eg({schema:e,text:r}))}}))}},d_e=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const p={format:i==null?void 0:i.type,model:this.modelId,options:l_e({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:g,toolWarnings:y}=o_e({mode:n});return{args:{...p,messages:XI(s),tools:g},type:d,warnings:[...h,...y]}}case"object-json":return{args:{...p,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:XI(s)},type:d,warnings:h};case"object-tool":return{args:{...p,messages:XI(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const g=d;throw new Error(`Unsupported type: ${g}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Zs({abortSignal:e.abortSignal,body:i,failedResponseHandler:QP,fetch:this.config.fetch,headers:Ys(this.config.headers(),e.headers),successfulResponseHandler:lo(f_e),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:wa(),toolCallType:"function",toolName:d.function.name}});return{finishReason:i_e({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const p=await this.doGenerate(e),g=new ReadableStream({start(y){if(y.enqueue({type:"response-metadata",...p.response}),p.text&&y.enqueue({textDelta:p.text,type:"text-delta"}),p.toolCalls)for(const v of p.toolCalls)y.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),y.enqueue({type:"tool-call",...v});y.enqueue({finishReason:p.finishReason,logprobs:p.logprobs,providerMetadata:p.providerMetadata,type:"finish",usage:p.usage}),y.close()}});return{rawCall:p.rawCall,rawResponse:p.rawResponse,stream:g,warnings:p.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Zs({abortSignal:e.abortSignal,body:t,failedResponseHandler:QP,fetch:this.config.fetch,headers:Ys(this.config.headers(),e.headers),successfulResponseHandler:u_e(h_e),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new s_e({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(p){p.enqueue({finishReason:u,type:"finish",usage:d})},async transform(p,g){if(!p.success){g.enqueue({error:p.error,type:"error"});return}const y=p.value;if(y.done){u=c.finish({controller:g}),d={completionTokens:y.eval_count,promptTokens:y.prompt_eval_count||0};return}h&&c.parse({controller:g,delta:y.message.content})||y.message.content!==null&&g.enqueue({textDelta:y.message.content,type:"text-delta"})}})),warnings:r}}},f_e=Ze({created_at:qe(),done:Pn(!0),done_reason:qe().optional().nullable(),eval_count:Nt(),eval_duration:Nt(),load_duration:Nt().optional(),message:Ze({content:qe(),role:qe(),tool_calls:cn(Ze({function:Ze({arguments:tp(Cf()),name:qe()}),id:qe().optional()})).optional().nullable()}),model:qe(),prompt_eval_count:Nt().optional(),prompt_eval_duration:Nt().optional(),total_duration:Nt()}),h_e=UT("done",[Ze({created_at:qe(),done:Pn(!1),message:Ze({content:qe(),role:qe()}),model:qe()}),Ze({created_at:qe(),done:Pn(!0),eval_count:Nt(),eval_duration:Nt(),load_duration:Nt().optional(),model:qe(),prompt_eval_count:Nt().optional(),prompt_eval_duration:Nt().optional(),total_duration:Nt()})]),p_e=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new LT({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Zs({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:QP,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:lo(m_e),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},m_e=Ze({embeddings:cn(cn(Nt())),prompt_eval_count:Nt().nullable()});function CZ(e={}){var t;const n=(t=gS(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new d_e(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new p_e(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}CZ();function xx(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function g_e(e){const t=[];for(const{role:n,content:r,...s}of e){const i=xx({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...xx(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=xx(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${id(a.image)}`},...l};case"file":throw new xr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=xx(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=xx(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function Vk({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Wk(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var y_e=Ze({error:Ze({message:qe(),type:qe().nullish(),param:Cf().nullish(),code:xs([qe(),Nt()]).nullish()})}),qT={errorSchema:y_e,errorToMessage:e=>e.error.message};function b_e({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new xr({functionality:`Unsupported tool choice type: ${l}`})}}}var v_e=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:qT;this.chunkSchema=w_e(i.errorSchema),this.failedResponseHandler=Sp(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,p,g,y,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(y=(p=l==null?void 0:l[this.providerOptionsName])==null?void 0:p.reasoningEffort)!=null?y:(g=l==null?void 0:l["openai-compatible"])==null?void 0:g.reasoningEffort,messages:g_e(t)};switch(x){case"regular":{const{tools:_,tool_choice:k,toolWarnings:T}=b_e({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:_,tool_choice:k},warnings:[...w,...T]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const _=x;throw new Error(`Unsupported type: ${_}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:p}=this.getArgs({...e}),g=JSON.stringify(h),{responseHeaders:y,value:v,rawValue:x}=await Zs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:lo(x_e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...S}=h,_=v.choices[0],k={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},T=(r=v.usage)==null?void 0:r.completion_tokens_details,A=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(T==null?void 0:T.reasoning_tokens)!=null&&(k[this.providerOptionsName].reasoningTokens=T==null?void 0:T.reasoning_tokens),(T==null?void 0:T.accepted_prediction_tokens)!=null&&(k[this.providerOptionsName].acceptedPredictionTokens=T==null?void 0:T.accepted_prediction_tokens),(T==null?void 0:T.rejected_prediction_tokens)!=null&&(k[this.providerOptionsName].rejectedPredictionTokens=T==null?void 0:T.rejected_prediction_tokens),(A==null?void 0:A.cached_tokens)!=null&&(k[this.providerOptionsName].cachedPromptTokens=A==null?void 0:A.cached_tokens),{text:(i=_.message.content)!=null?i:void 0,reasoning:(a=_.message.reasoning_content)!=null?a:void 0,toolCalls:(o=_.message.tool_calls)==null?void 0:o.map(R=>{var M;return{toolCallType:"function",toolCallId:(M=R.id)!=null?M:wa(),toolName:R.function.name,args:R.function.arguments}}),finishReason:Wk(_.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:k,rawCall:{rawPrompt:w,rawSettings:S},rawResponse:{headers:y,body:x},response:Vk(v),warnings:p,request:{body:g}}}async doStream(e){var t;if(this.settings.simulateStreaming){const y=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...y.response}),y.reasoning)if(Array.isArray(y.reasoning))for(const w of y.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:y.reasoning});if(y.text&&x.enqueue({type:"text-delta",textDelta:y.text}),y.toolCalls)for(const w of y.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:y.finishReason,usage:y.usage,logprobs:y.logprobs,providerMetadata:y.providerMetadata}),x.close()}}),rawCall:y.rawCall,rawResponse:y.rawResponse,warnings:y.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Zs({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:_p(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},p=!0,g=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(y,v){var x,w,S,_,k,T,A,R,M,j,F,P;if(!y.success){d="error",v.enqueue({type:"error",error:y.error});return}const q=y.value;if(i==null||i.processChunk(y.rawValue),"error"in q){d="error",v.enqueue({type:"error",error:q.error.message});return}if(p&&(p=!1,v.enqueue({type:"response-metadata",...Vk(q)})),q.usage!=null){const{prompt_tokens:D,completion_tokens:z,prompt_tokens_details:$,completion_tokens_details:Y}=q.usage;h.promptTokens=D??void 0,h.completionTokens=z??void 0,(Y==null?void 0:Y.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=Y==null?void 0:Y.reasoning_tokens),(Y==null?void 0:Y.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=Y==null?void 0:Y.accepted_prediction_tokens),(Y==null?void 0:Y.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=Y==null?void 0:Y.rejected_prediction_tokens),($==null?void 0:$.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=$==null?void 0:$.cached_tokens)}const I=q.choices[0];if((I==null?void 0:I.finish_reason)!=null&&(d=Wk(I.finish_reason)),(I==null?void 0:I.delta)==null)return;const V=I.delta;if(V.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:V.reasoning_content}),V.content!=null&&v.enqueue({type:"text-delta",textDelta:V.content}),V.tool_calls!=null)for(const D of V.tool_calls){const z=D.index;if(u[z]==null){if(D.type!=="function")throw new pf({data:D,message:"Expected 'function' type."});if(D.id==null)throw new pf({data:D,message:"Expected 'id' to be a string."});if(((x=D.function)==null?void 0:x.name)==null)throw new pf({data:D,message:"Expected 'function.name' to be a string."});u[z]={id:D.id,type:"function",function:{name:D.function.name,arguments:(w=D.function.arguments)!=null?w:""},hasFinished:!1};const Y=u[z];((S=Y.function)==null?void 0:S.name)!=null&&((_=Y.function)==null?void 0:_.arguments)!=null&&(Y.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Y.id,toolName:Y.function.name,argsTextDelta:Y.function.arguments}),Vm(Y.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(k=Y.id)!=null?k:wa(),toolName:Y.function.name,args:Y.function.arguments}),Y.hasFinished=!0));continue}const $=u[z];$.hasFinished||(((T=D.function)==null?void 0:T.arguments)!=null&&($.function.arguments+=(R=(A=D.function)==null?void 0:A.arguments)!=null?R:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:$.id,toolName:$.function.name,argsTextDelta:(M=D.function.arguments)!=null?M:""}),((j=$.function)==null?void 0:j.name)!=null&&((F=$.function)==null?void 0:F.arguments)!=null&&Vm($.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=$.id)!=null?P:wa(),toolName:$.function.name,args:$.function.arguments}),$.hasFinished=!0))}},flush(y){var v,x;const w={[g]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[g].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[g].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[g].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[g].cachedPromptTokens=h.promptTokensDetails.cachedTokens),y.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},kZ=Ze({prompt_tokens:Nt().nullish(),completion_tokens:Nt().nullish(),prompt_tokens_details:Ze({cached_tokens:Nt().nullish()}).nullish(),completion_tokens_details:Ze({reasoning_tokens:Nt().nullish(),accepted_prediction_tokens:Nt().nullish(),rejected_prediction_tokens:Nt().nullish()}).nullish()}).nullish(),x_e=Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({message:Ze({role:Pn("assistant").nullish(),content:qe().nullish(),reasoning_content:qe().nullish(),tool_calls:cn(Ze({id:qe().nullish(),type:Pn("function"),function:Ze({name:qe(),arguments:qe()})})).nullish()}),finish_reason:qe().nullish()})),usage:kZ}),w_e=e=>xs([Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({delta:Ze({role:Ll(["assistant"]).nullish(),content:qe().nullish(),reasoning_content:qe().nullish(),tool_calls:cn(Ze({index:Nt(),id:qe().nullish(),type:Pn("function").nullish(),function:Ze({name:qe().nullish(),arguments:qe().nullish()})})).nullish()}).nullish(),finish_reason:qe().nullish()})),usage:kZ}),e]);function S_e({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new qc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new xr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new xr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new xr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var __e=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:qT;this.chunkSchema=k_e(s.errorSchema),this.failedResponseHandler=Sp(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var p;const g=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=S_e({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(g){case"regular":{if((p=e.tools)!=null&&p.length)throw new xr({functionality:"tools"});if(e.toolChoice)throw new xr({functionality:"toolChoice"});return{args:S,warnings:y}}case"object-json":throw new xr({functionality:"object-json mode"});case"object-tool":throw new xr({functionality:"object-tool mode"});default:{const _=g;throw new Error(`Unsupported type: ${_}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Zs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:lo(C_e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:Wk(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:Vk(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Zs({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Ys(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:_p(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const p=d.value;if("error"in p){l="error",h.enqueue({type:"error",error:p.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...Vk(p)})),p.usage!=null&&(c={promptTokens:p.usage.prompt_tokens,completionTokens:p.usage.completion_tokens});const g=p.choices[0];(g==null?void 0:g.finish_reason)!=null&&(l=Wk(g.finish_reason)),(g==null?void 0:g.text)!=null&&h.enqueue({type:"text-delta",textDelta:g.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},C_e=Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({text:qe(),finish_reason:qe()})),usage:Ze({prompt_tokens:Nt(),completion_tokens:Nt()}).nullish()}),k_e=e=>xs([Ze({id:qe().nullish(),created:Nt().nullish(),model:qe().nullish(),choices:cn(Ze({text:qe(),finish_reason:qe().nullish(),index:Nt()})),usage:Ze({prompt_tokens:Nt(),completion_tokens:Nt()}).nullish()}),e]),E_e=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new LT({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Zs({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Ys(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Sp((r=this.config.errorStructure)!=null?r:qT),successfulResponseHandler:lo(T_e),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},T_e=Ze({data:cn(Ze({embedding:cn(Nt())})),usage:Ze({prompt_tokens:Nt()}).nullish()}),A_e=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const p=[];r!=null&&p.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&p.push({type:"unsupported-setting",setting:"seed"});const g=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:v}=await Zs({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Ys(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Sp((h=this.config.errorStructure)!=null?h:qT),successfulResponseHandler:lo(N_e),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(x=>x.b64_json),warnings:p,response:{timestamp:g,modelId:this.modelId,headers:v}}}},N_e=Ze({data:cn(Ze({b64_json:qe()}))});function R_e(e){const t=gS(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const p=new URL(`${t}${h}`);return e.queryParams&&(p.search=new URLSearchParams(e.queryParams).toString()),p.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new v_e(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new __e(d,h,s("completion")),l=(d,h={})=>new E_e(d,h,s("embedding")),c=(d,h={})=>new A_e(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const dw=(e,t)=>`${e}:${t}`,uc=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},Vy=e=>e==="openai"||e==="openrouter"||e==="google",Hk=e=>e==="ollama"||e==="openai-compatible",Wm=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",Zo=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],I_e={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},EZ=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function KD(e,t,n){try{switch(e.type){case"openai":return mZ({apiKey:n})(t);case"google":return vZ({apiKey:n})(t);case"openrouter":const s=_Z({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return CZ({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return R_e({baseURL:EZ(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function TZ(e,t,n){const s=Gn.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=KD(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:dw(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const AZ={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},wx=new Map,M_e=5*60*1e3,j_e=(e,t)=>{var i,a,o,l,c,u,d,h,p,g,y,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((p=e.pricing)==null?void 0:p.image)??"0",web_search:((g=e.pricing)==null?void 0:g.web_search)??"0",internal_reasoning:((y=e.pricing)==null?void 0:y.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??AZ[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function P_e(e,t){const n=`${e.id}-${e.baseURL||""}`,r=wx.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=EZ(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),ke.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let g=`(${u.status} ${u.statusText})`;try{const y=await u.text();g=y||g;try{const v=JSON.parse(y);g=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||g}catch{}}catch(y){console.warn("[ModelFetcher] Failed to read error response body:",y)}throw new Error(`API Error: ${g}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const p=h.map(g=>j_e(g,e.type));return p.sort((g,y)=>(g.name||g.id).localeCompare(y.name||y.id)),console.log(`[ModelFetcher] Fetched and mapped ${p.length} models for ${e.name}`),p}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),ke.error(`Failed to fetch models for ${e.name}: ${d}`),wx.delete(n),[]}})();return wx.set(n,s),setTimeout(()=>{wx.get(n)===s&&(wx.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},M_e),s}const $n={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",updateApiKeyRequest:"provider.update.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},JI="provider:lastModelSelection",w9="provider:globalModelSortOrder",Gn=Do(Fo((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(dw(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Ae.emit($n.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,getModelConfigById:n=>{var c;const{dbProviderConfigs:r,dbApiKeys:s}=t(),{providerId:i,modelId:a}=uc(n);if(!i||!a){console.warn(`[ProviderStore] Invalid combined ID for getModelConfigById: ${n}`);return}const o=r.find(u=>u.id===i);if(!o){console.warn(`[ProviderStore] Could not find provider config for ID: ${i}`);return}const l=(c=s.find(u=>u.id===o.apiKeyId))==null?void 0:c.value;return t().createAiModelConfig(o,a,l)},createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=KD(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:dw(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),dt.saveSetting("enableApiKeyManagement",n),Ae.emit($n.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await dt.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([dt.loadProviderConfigs(),dt.loadApiKeys(),dt.loadSetting(w9,[]),dt.loadSetting(JI,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await dt.saveSetting(JI,c),Ae.emit($n.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Ae.emit($n.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),ke.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),dt.saveSetting(JI,n),Ae.emit($n.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=dr(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await dt.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),ke.success(`API Key "${n}" added.`),Ae.emit($n.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),ke.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},updateApiKey:async(n,r,s,i)=>{const a=t().dbApiKeys.find(l=>l.id===n);if(!a)throw new Error(`API Key with id ${n} not found`);const o={...a,name:r,providerId:s,value:i,updatedAt:new Date};try{await dt.saveApiKey(o),e(l=>{const c=l.dbApiKeys.findIndex(u=>u.id===n);c!==-1&&(l.dbApiKeys[c]=o)}),ke.success(`API Key "${r}" updated.`),Ae.emit($n.apiKeysChanged,{apiKeys:t().dbApiKeys})}catch(l){throw console.error("ProviderStore: Error updating API key",l),ke.error(`Failed to update API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await dt.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),ke.success(`API Key "${r}" deleted.`),Ae.emit($n.apiKeysChanged,{apiKeys:t().dbApiKeys}),Ae.emit($n.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),ke.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=dr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await dt.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),ke.success(`Provider "${n.name}" added.`),Ae.emit($n.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),ke.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await dt.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs=[...a.dbProviderConfigs.slice(0,o),i,...a.dbProviderConfigs.slice(o+1)])}),t()._updateGloballyEnabledModelDefinitions(),Ae.emit($n.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),ke.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await dt.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Ae.emit($n.configsChanged,{providerConfigs:t().dbProviderConfigs}),ke.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),ke.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){ke.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await P_e(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),ke.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await dt.saveSetting(w9,r),t()._updateGloballyEnabledModelDefinitions(),Ae.emit($n.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Ae.emit($n.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Ae.emit($n.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=uc(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(I_e[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:AZ[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:dw(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:$n.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:$n.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:$n.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:$n.updateApiKeyRequest,handler:s=>r.updateApiKey(s.id,s.name,s.providerId,s.value),storeId:n},{eventName:$n.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:$n.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:$n.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:$n.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:$n.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:$n.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:$n.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:$n.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),on={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},O_e=`You are a helpful AI assistant used in LiteChat.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

##Key principles
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 


##Litechat codeblock support

### downloadable codeblocks

If you create gated blocks and you can infer a filepath or a name for it, you should create it as follow : 

\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\`

### MermaidJS diagrams

Litechat support MermaidJS diagrams. only valid uncommented diagrams are supported.
For example, if a user asks you a simple explanation on http request, you should use a sequence diagram like so : 
\`\`\`mermaid
sequenceDiagram
    participant Client as "Web Browser"
    participant Server as "Web Server"

    Note over Client,Server: User initiates HTTP request
    Client->>Server: HTTP Request (GET /index.html)
    Server->>Server: Process request
    Server->>Client: HTTP Response (200 OK, HTML content)
    Note over Client,Server: User receives response
\`\`\`

### Flow diagrams

LiteChat supports interactive workflow flow diagrams using the \`flow\` codeblock. These are particularly useful for visualizing workflows, processes, and step-by-step procedures.

**Functionality:**
- The \`flow\` block interprets a JSON object that defines nodes (steps) and edges (connections) in a workflow
- It renders an interactive React Flow diagram with custom node types for different step types
- Nodes can have different statuses (pending, running, success, error) with visual indicators
- Supports various node types: trigger, prompt, agent-task, human-in-the-loop, and generic steps
- Includes zoom, pan, minimap, and download capabilities

**Usage:**
To generate a flow diagram, enclose your flow definition within a markdown code block with the language identifier \`flow\`.

**Expected Content Format:**
The content inside the \`flow\` block must be a valid JSON object containing:
- \`type\`: Usually "workflow" for workflow diagrams
- \`name\`: Display name for the workflow
- \`nodes\`: Array of node objects defining the steps
- \`edges\`: Array of edge objects defining connections between steps

**Node Structure:**
Each node requires:
- \`id\`: Unique identifier for the node
- \`type\`: Node type ("trigger", "prompt", "agent-task", "human-in-the-loop", or custom)
- \`label\`: Display label for the node
- \`position\`: Object with \`x\` and \`y\` coordinates
- \`status\`: (Optional) Current status ("pending", "running", "success", "error")
- \`data\`: (Optional) Additional data like \`templateName\`, \`modelName\`, etc.

**Edge Structure:**
Each edge requires:
- \`id\`: Unique identifier for the edge
- \`source\`: ID of the source node
- \`target\`: ID of the target node
- \`type\`: (Optional) Edge type, defaults to "smoothstep"
- \`animated\`: (Optional) Boolean for animation
- \`style\`: (Optional) Styling object

**Examples:**

Simple process flow:
\`\`\`flow
{
  "type": "process",
  "name": "Order Processing System",
  "description": "E-commerce order fulfillment process",
  "background": {
    "variant": "dots",
    "gap": 20,
    "color": "#e5e7eb"
  },
  "nodes": [
    {
      "id": "start",
      "type": "input",
      "label": "New Order",
      "position": { "x": 0, "y": 100 },
      "status": "success",
      "style": {
        "backgroundColor": "#dcfce7",
        "borderColor": "#22c55e",
        "color": "#166534"
      }
    },
    {
      "id": "validate",
      "type": "default",
      "label": "Validate Payment",
      "position": { "x": 200, "y": 100 },
      "status": "running",
      "style": {
        "backgroundColor": "#dbeafe",
        "borderColor": "#3b82f6",
        "color": "#1e40af"
      }
    },
    {
      "id": "fulfill",
      "type": "default",
      "label": "Ship Order",
      "position": { "x": 400, "y": 100 },
      "status": "pending",
      "style": {
        "backgroundColor": "#fef3c7",
        "borderColor": "#f59e0b",
        "color": "#92400e"
      }
    },
    {
      "id": "complete",
      "type": "output",
      "label": "Order Complete",
      "position": { "x": 600, "y": 100 },
      "status": "pending",
      "style": {
        "backgroundColor": "#f3e8ff",
        "borderColor": "#8b5cf6",
        "color": "#6b21a8"
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "start",
      "target": "validate",
      "type": "smoothstep",
      "animated": true,
      "style": {
        "stroke": "#22c55e",
        "strokeWidth": 2
      },
      "markerEnd": {
        "type": "ArrowClosed",
        "color": "#22c55e"
      }
    },
    {
      "id": "e2",
      "source": "validate",
      "target": "fulfill",
      "type": "smoothstep",
      "style": {
        "stroke": "#3b82f6",
        "strokeWidth": 2
      },
      "markerEnd": {
        "type": "ArrowClosed",
        "color": "#3b82f6"
      }
    },
    {
      "id": "e3",
      "source": "fulfill",
      "target": "complete",
      "type": "smoothstep",
      "style": {
        "stroke": "#6b7280",
        "strokeWidth": 2,
        "strokeDasharray": "5,5"
      },
      "markerEnd": {
        "type": "ArrowClosed",
        "color": "#6b7280"
      }
    }
  ]
}
\`\`\`

Organizational flowchart:
\`\`\`flow
{
  "type": "flowchart",
  "name": "Decision Making Process",
  "description": "Company decision approval workflow",
  "background": {
    "variant": "lines",
    "gap": [40, 40],
    "color": "#f3f4f6"
  },
  "nodes": [
    {
      "id": "proposal",
      "type": "input",
      "label": "New Proposal",
      "position": { "x": 200, "y": 0 },
      "style": {
        "backgroundColor": "#eff6ff",
        "borderColor": "#2563eb",
        "borderWidth": 2,
        "borderRadius": 8
      }
    },
    {
      "id": "review",
      "type": "default",
      "label": "Team Review",
      "position": { "x": 200, "y": 150 },
      "style": {
        "backgroundColor": "#fef2f2",
        "borderColor": "#dc2626"
      }
    },
    {
      "id": "approve",
      "type": "default",
      "label": "Manager Approval",
      "position": { "x": 50, "y": 300 },
      "style": {
        "backgroundColor": "#f0fdf4",
        "borderColor": "#16a34a"
      }
    },
    {
      "id": "reject",
      "type": "default",
      "label": "Needs Revision",
      "position": { "x": 350, "y": 300 },
      "style": {
        "backgroundColor": "#fef2f2",
        "borderColor": "#dc2626"
      }
    },
    {
      "id": "implement",
      "type": "output",
      "label": "Implementation",
      "position": { "x": 50, "y": 450 },
      "style": {
        "backgroundColor": "#ecfdf5",
        "borderColor": "#059669"
      }
    },
    {
      "id": "revise",
      "type": "default",
      "label": "Back to Team",
      "position": { "x": 350, "y": 450 },
      "style": {
        "backgroundColor": "#fffbeb",
        "borderColor": "#d97706"
      }
    }
  ],
  "edges": [
    {
      "id": "e1",
      "source": "proposal",
      "target": "review",
      "type": "straight",
      "markerEnd": { "type": "ArrowClosed" }
    },
    {
      "id": "e2",
      "source": "review",
      "target": "approve",
      "type": "smoothstep",
      "label": "Approved",
      "style": { "stroke": "#16a34a" },
      "markerEnd": { "type": "ArrowClosed", "color": "#16a34a" }
    },
    {
      "id": "e3",
      "source": "review",
      "target": "reject",
      "type": "smoothstep",
      "label": "Rejected",
      "style": { "stroke": "#dc2626" },
      "markerEnd": { "type": "ArrowClosed", "color": "#dc2626" }
    },
    {
      "id": "e4",
      "source": "approve",
      "target": "implement",
      "type": "straight",
      "style": { "stroke": "#059669" },
      "markerEnd": { "type": "ArrowClosed", "color": "#059669" }
    },
    {
      "id": "e5",
      "source": "reject",
      "target": "revise",
      "type": "straight",
      "style": { "stroke": "#d97706" },
      "markerEnd": { "type": "ArrowClosed", "color": "#d97706" }
    },
    {
      "id": "e6",
      "source": "revise",
      "target": "review",
      "type": "bezier",
      "style": { 
        "stroke": "#6b7280",
        "strokeDasharray": "5,5"
      },
      "markerEnd": { "type": "Arrow", "color": "#6b7280" }
    }
  ]
}
\`\`\`

### Formedible codeblocks

For guided deterministic interaction with the user through a form, you can use the \`formedible\` codeblock.

**Functionality:**
- The \`formedible\` block interprets a JavaScript object literal that defines a form structure.
- It supports multi-page forms, various input field types (text, number, select, checkbox, etc.), progress indicators, and labels.
- For security reasons, the rendered forms are **read-only** and **cannot execute any custom code or callback functions** (like \`onSubmit\`). Their primary purpose is for previewing and understanding form layouts and data structures.

**Usage:**
To generate a formedible block, enclose your form definition within a markdown code block with the language identifier \`formedible\`.

**Expected Content Format:**
The content inside the \`formedible\` block must be a single JavaScript object literal containing the form's configuration. This object can include the following top-level keys:
- \`schema\`: A \`z.object()\` definition (e.g., \`z.object({ fieldName: z.string().min(1) })\`). You can use basic Zod types. Complex Zod methods or custom functions are not supported and will be ignored or cause parsing errors.
- \`fields\`: An array of field objects. Each field object requires \`name\` (string) and \`type\` (string). Supported types are: \`text\`, \`email\`, \`password\`, \`url\`, \`tel\`, \`textarea\`, \`select\`, \`checkbox\`, \`switch\`, \`number\`, \`date\`, \`slider\`, \`file\`. Additional properties like \`label\`, \`placeholder\`, \`description\`, \`options\`, \`min\`, \`max\`, \`step\`, \`accept\`, \`multiple\`, and \`page\` can be included.
- \`pages\`: (Optional) An array of page objects for multi-page forms. Each page object requires \`page\` (number). \`title\` and \`description\` are optional.
- \`progress\`: (Optional) An object to configure the progress bar, e.g., \`{ showSteps: true, showPercentage: true }\`.
- \`submitLabel\`, \`nextLabel\`, \`previousLabel\`: (Optional) Strings for navigation button labels.
- \`formClassName\`, \`fieldClassName\`: (Optional) Strings for CSS classes.
- \`formOptions\`: (Optional) An object for basic form options. Only \`defaultValues\`, \`asyncDebounceMs\`, and \`canSubmitWhenInvalid\` are supported. Any \`onSubmit\` or other callback functions will be ignored and replaced with a disabled toast message.

**Examples:**

simple: 
\`\`\`formedible
{
  schema: z.object({
    taskName: z.string().min(3, "Task name is required"),
    priority: z.enum(["low", "medium", "high"]),
    dueDate: z.string().optional(),
    isCompleted: z.boolean(),
  }),
  fields: [
    { name: "taskName", type: "text", label: "Task Name", placeholder: "e.g., Finish report" },
    { name: "priority", type: "select", label: "Priority", options: ["low", "medium", "high"] },
    { name: "dueDate", type: "date", label: "Due Date" },
    { name: "isCompleted", type: "checkbox", label: "Mark as Completed" },
  ],
  submitLabel: "Save Task",
  formOptions: {
    defaultValues: {
      taskName: "",
      priority: "medium",
      isCompleted: false,
    }
  }
}
\`\`\`
with pages :
\`\`\`formedible
{
  schema: z.object({
    firstName: z.string().min(1, "First name is required"),
    lastName: z.string().min(1, "Last name is required"),
    email: z.string().email("Invalid email"),
    age: z.number().min(18, "Must be 18 or older"),
    bio: z.string().min(10, "Bio must be at least 10 characters"),
    notifications: z.boolean(),
  }),
  fields: [
    { name: "firstName", type: "text", label: "First Name", page: 1 },
    { name: "lastName", type: "text", label: "Last Name", page: 1 },
    { name: "email", type: "email", label: "Email", page: 2 },
    { name: "age", type: "number", label: "Age", min: 18, max: 120, page: 2 },
    { name: "bio", type: "textarea", label: "Bio", page: 3 },
    { name: "notifications", type: "switch", label: "Enable notifications", page: 3 },
  ],
  pages: [
    { page: 1, title: "Personal Info", description: "Tell us about yourself" },
    { page: 2, title: "Contact Details", description: "How can we reach you?" },
    { page: 3, title: "Preferences", description: "Customize your experience" },
  ],
  progress: { showSteps: true, showPercentage: true },
  nextLabel: "Continue ",
  previousLabel: " Back",
  submitLabel: "Complete Registration",
  formOptions: {
    defaultValues: {
      firstName: "",
      lastName: "",
      email: "",
      age: 18,
      bio: "",
      notifications: true,
    },
  },
}
\`\`\``,QI="system",eM=O_e,tM=.7,nM=null,rM=null,sM=null,iM=0,aM=0,S9=!0,oM=!0,lM=!0,cM=!1,uM=!1,dM=15,_9=null,C9=null,fM=5,hM=null,pM=!0,mM=null,gM=768,yM=!1,bM=!1,k9=null,E9=null,vM=null,xM=16,wM="max-w-7xl",SM=null,_M=1e3,CM=!0,T9=!1,A9=!1,gr=Do(Fo((e,t)=>({theme:QI,globalSystemPrompt:eM,temperature:tM,maxTokens:nM,topP:rM,topK:sM,presencePenalty:iM,frequencyPenalty:aM,enableAdvancedSettings:S9,enableStreamingMarkdown:oM,enableStreamingCodeBlockParsing:lM,foldStreamingCodeBlocks:cM,foldUserMessagesOnCompletion:uM,streamingRenderFPS:dM,gitUserName:_9,gitUserEmail:C9,toolMaxSteps:fM,prismThemeUrl:hM,autoTitleEnabled:pM,autoTitleModelId:mM,autoTitlePromptMaxLength:gM,autoTitleIncludeFiles:yM,autoTitleIncludeRules:bM,forkCompactPrompt:k9,forkCompactModelId:E9,customFontFamily:vM,customFontSize:xM,chatMaxWidth:wM,customThemeColors:SM,autoScrollInterval:_M,enableAutoScrollOnStream:CM,autoSyncOnStreamComplete:T9,autoInitializeReposOnStartup:A9,setTheme:n=>{e({theme:n}),dt.saveSetting("theme",n),Ae.emit(on.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),dt.saveSetting("globalSystemPrompt",n),Ae.emit(on.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),dt.saveSetting("temperature",n),Ae.emit(on.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),dt.saveSetting("maxTokens",n),Ae.emit(on.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),dt.saveSetting("topP",n),Ae.emit(on.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),dt.saveSetting("topK",n),Ae.emit(on.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),dt.saveSetting("presencePenalty",n),Ae.emit(on.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),dt.saveSetting("frequencyPenalty",n),Ae.emit(on.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),dt.saveSetting("enableAdvancedSettings",n),Ae.emit(on.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),dt.saveSetting("enableStreamingMarkdown",n),Ae.emit(on.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),dt.saveSetting("enableStreamingCodeBlockParsing",n),Ae.emit(on.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),dt.saveSetting("foldStreamingCodeBlocks",n),Ae.emit(on.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),dt.saveSetting("foldUserMessagesOnCompletion",n),Ae.emit(on.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),dt.saveSetting("streamingRenderFPS",r),Ae.emit(on.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),dt.saveSetting("gitUserName",r),Ae.emit(on.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),dt.saveSetting("gitUserEmail",r),Ae.emit(on.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),dt.saveSetting("toolMaxSteps",r),Ae.emit(on.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),dt.saveSetting("prismThemeUrl",r),Ae.emit(on.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),dt.saveSetting("autoTitleEnabled",n),Ae.emit(on.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),dt.saveSetting("autoTitleModelId",n),Ae.emit(on.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),dt.saveSetting("autoTitlePromptMaxLength",r),Ae.emit(on.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),dt.saveSetting("autoTitleIncludeFiles",n),Ae.emit(on.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),dt.saveSetting("autoTitleIncludeRules",n),Ae.emit(on.autoTitleIncludeRulesChanged,{include:n})},setForkCompactPrompt:n=>{e({forkCompactPrompt:n}),dt.saveSetting("forkCompactPrompt",n)},setForkCompactModelId:n=>{e({forkCompactModelId:n}),dt.saveSetting("forkCompactModelId",n)},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),dt.saveSetting("customFontFamily",r),Ae.emit(on.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),dt.saveSetting("customFontSize",r),Ae.emit(on.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),dt.saveSetting("chatMaxWidth",n),Ae.emit(on.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),dt.saveSetting("customThemeColors",n),Ae.emit(on.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;dt.saveSetting("customThemeColors",s),Ae.emit(on.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),dt.saveSetting("autoScrollInterval",r),Ae.emit(on.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),dt.saveSetting("enableAutoScrollOnStream",n),Ae.emit(on.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),dt.saveSetting("autoSyncOnStreamComplete",n),Ae.emit(on.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),dt.saveSetting("autoInitializeReposOnStartup",n),Ae.emit(on.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k,T,A,R,M,j,F,P,q,I,V,D,z,$]=await Promise.all([dt.loadSetting("theme",QI),dt.loadSetting("temperature",tM),dt.loadSetting("maxTokens",nM),dt.loadSetting("topP",rM),dt.loadSetting("topK",sM),dt.loadSetting("presencePenalty",iM),dt.loadSetting("frequencyPenalty",aM),dt.loadSetting("globalSystemPrompt",eM),dt.loadSetting("enableAdvancedSettings",S9),dt.loadSetting("enableStreamingMarkdown",oM),dt.loadSetting("enableStreamingCodeBlockParsing",lM),dt.loadSetting("foldStreamingCodeBlocks",cM),dt.loadSetting("foldUserMessagesOnCompletion",uM),dt.loadSetting("streamingRenderFPS",dM),dt.loadSetting("gitUserName",_9),dt.loadSetting("gitUserEmail",C9),dt.loadSetting("toolMaxSteps",fM),dt.loadSetting("prismThemeUrl",hM),dt.loadSetting("autoTitleEnabled",pM),dt.loadSetting("autoTitleModelId",mM),dt.loadSetting("autoTitlePromptMaxLength",gM),dt.loadSetting("autoTitleIncludeFiles",yM),dt.loadSetting("autoTitleIncludeRules",bM),dt.loadSetting("forkCompactPrompt",k9),dt.loadSetting("forkCompactModelId",E9),dt.loadSetting("customFontFamily",vM),dt.loadSetting("customFontSize",xM),dt.loadSetting("chatMaxWidth",wM),dt.loadSetting("customThemeColors",SM),dt.loadSetting("autoScrollInterval",_M),dt.loadSetting("enableAutoScrollOnStream",CM),dt.loadSetting("autoSyncOnStreamComplete",T9),dt.loadSetting("autoInitializeReposOnStartup",A9)]),Y={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:p,foldUserMessagesOnCompletion:g,streamingRenderFPS:y,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:S,autoTitleEnabled:_,autoTitleModelId:k,autoTitlePromptMaxLength:T,autoTitleIncludeFiles:A,autoTitleIncludeRules:R,forkCompactPrompt:M,forkCompactModelId:j,customFontFamily:F,customFontSize:P,chatMaxWidth:q,customThemeColors:I,autoScrollInterval:V,enableAutoScrollOnStream:D,autoSyncOnStreamComplete:z,autoInitializeReposOnStartup:$};e(Y),Ae.emit(on.loaded,{settings:Y})}catch(n){console.error("SettingsStore: Error loading settings",n),Ae.emit(on.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(oM),t().setEnableStreamingCodeBlockParsing(lM),t().setFoldStreamingCodeBlocks(cM),t().setFoldUserMessagesOnCompletion(uM),t().setStreamingRenderFPS(dM),t().setAutoScrollInterval(_M),t().setEnableAutoScrollOnStream(CM),ke.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),ke.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(eM),t().setTemperature(tM),t().setMaxTokens(nM),t().setTopP(rM),t().setTopK(sM),t().setPresencePenalty(iM),t().setFrequencyPenalty(aM),t().setToolMaxSteps(fM),t().setAutoTitleEnabled(pM),t().setAutoTitleModelId(mM),t().setAutoTitlePromptMaxLength(gM),t().setAutoTitleIncludeFiles(yM),t().setAutoTitleIncludeRules(bM),ke.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),ke.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(QI),t().setPrismThemeUrl(hM),t().setCustomFontFamily(vM),t().setCustomFontSize(xM),t().setChatMaxWidth(wM),t().setCustomThemeColors(SM),ke.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),ke.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:on.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:on.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:on.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:on.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:on.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:on.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:on.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:on.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:on.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:on.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:on.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:on.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:on.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:on.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:on.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:on.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:on.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:on.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:on.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:on.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:on.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:on.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:on.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:on.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:on.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:on.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:on.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:on.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:on.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:on.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:on.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:on.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:on.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:on.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:on.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:on.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function Gk(e,t){const n=Ni.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function N9(){const e=en.getState(),t=Gn.getState(),n=gr.getState(),{providerId:r}=uc(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function D_e(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function R9(e){try{const t=e.type||"application/octet-stream",n=qw(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:D_e(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),ke.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function fw(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const I9=e=>Symbol.iterator in e,M9=e=>"entries"in e,j9=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},F_e=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function L_e(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!I9(e)||!I9(t)?j9({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):M9(e)&&M9(t)?j9(e,t):F_e(e,t)}function pn(e){const t=We.useRef(void 0);return n=>{const r=e(n);return L_e(t.current,r)?t.current:t.current=r}}var Wy=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(Wy||{});const an={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",enhancementStarted:"prompt.enhancement.started",enhancementCompleted:"prompt.enhancement.completed",enhancementFailed:"prompt.enhancement.failed",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",focusInputRequest:"prompt.input.focus.request",submitPromptRequest:"prompt.submit.request",enhancePromptRequest:"prompt.enhance.request",inputChanged:"prompt.inputChanged"},Pc=(e,t)=>{Ae.emit(an.parameterChanged,{params:{[e]:t}})},Qa=Do(Fo((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),Pc("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),Pc("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),Pc("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),Pc("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),Pc("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),Pc("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),Pc("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),Pc("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),Pc("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),Pc("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),Pc("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Ae.emit(an.parameterChanged,{params:s})),Ae.emit(an.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Ae.emit(an.parameterChanged,{params:r})),Ae.emit(an.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:an.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:an.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:an.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:an.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:an.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:an.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:an.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:an.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:an.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:an.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:an.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:an.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:an.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),$_e=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),d=Ni(pn(k=>k.promptControls)),h=en(pn(k=>k.status==="streaming")),{attachedFilesMetadata:p,clearAttachedFiles:g}=Qh(pn(k=>({attachedFilesMetadata:k.attachedFilesMetadata,clearAttachedFiles:k.clearAttachedFiles}))),y=Qa(k=>k.modelId),v=E.useMemo(()=>Object.values(d),[d]),x=E.useMemo(()=>v.filter(k=>k.renderer),[v]),w=E.useMemo(()=>v.filter(k=>k.triggerRenderer),[v]),S=E.useCallback(async k=>{var M,j;const T=((M=s==null?void 0:s.current)==null?void 0:M.getValue())??"",A=k!==void 0?k.trim():T.trim(),R=Qh.getState().attachedFilesMetadata;if(!(!A&&R.length===0)&&!(h||o)){l(!0);try{let F={},P={};for(const D of v){if(D.getParameters){const z=await D.getParameters();z&&(F={...F,...z})}if(D.getMetadata){const z=await D.getMetadata();z&&(P={...P,...z})}}R.length>0&&(P.attachedFiles=[...R]),!P.modelId&&y&&(P.modelId=y);let q={id:dr(),content:A,parameters:F,metadata:P};Ae.emit(an.submitted,{turnData:q});const I=await Gk(Wy.PROMPT_TURN_FINALIZE,{turnData:q});if(I===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const V=I&&typeof I=="object"?I.turnData:q;await t(V),g(),v.forEach(D=>{D.clearOnSubmit&&D.clearOnSubmit()}),(j=s.current)==null||j.clearValue(),u(!1)}catch(F){console.error("Error during prompt submission:",F),ke.error(`Failed to send message: ${F instanceof Error?F.message:String(F)}`)}finally{l(!1)}}},[s,h,o,v,t,g,y]);E.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var k;(k=s.current)==null||k.focus()})},[i,a,s]),E.useEffect(()=>{const k=()=>{requestAnimationFrame(()=>{var R;(R=s.current)==null||R.focus()})},T=R=>{s.current&&(s.current.setValue(R.text),u(R.text.trim().length>0))},A=async R=>{en.getState().status==="streaming"||o||await S(R.turnData.content)};return Ae.on(an.focusInputRequest,k),Ae.on(an.setInputTextRequest,T),Ae.on(an.submitPromptRequest,A),()=>{Ae.off(an.focusInputRequest,k),Ae.off(an.setInputTextRequest,T),Ae.off(an.submitPromptRequest,A)}},[s,S,o]);const _=E.useCallback(k=>{u(k.trim().length>0)},[]);return f.jsxs("div",{className:Ye("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(Oz,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:_,className:"flex-grow"}),f.jsx(rt,{type:"button",size:"icon",onClick:()=>S(void 0),disabled:h||o||!c&&p.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Hve,{className:"h-4 w-4"})})]})," ",f.jsx(Oz,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function B_e(e,t){const n=E.createContext(t),r=i=>{const{children:a,...o}=i,l=E.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=E.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Pi(e,t=[]){let n=[];function r(i,a){const o=E.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:p,...g}=d,y=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=E.useMemo(()=>g,Object.values(g));return f.jsx(y.Provider,{value:v,children:p})};c.displayName=i+"Provider";function u(d,h){var y;const p=((y=h==null?void 0:h[e])==null?void 0:y[l])||o,g=E.useContext(p);if(g)return g;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>E.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,z_e(s,...t)]}function z_e(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function U_e(e){const t=q_e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(W_e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function q_e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=G_e(s),o=H_e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?jl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var V_e=Symbol("radix.slottable");function W_e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===V_e}function H_e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function G_e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var K_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Zn=K_e.reduce((e,t)=>{const n=U_e(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function NZ(e,t){e&&Nl.flushSync(()=>e.dispatchEvent(t))}function Ms(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function YD(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e);E.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Y_e="DismissableLayer",e4="dismissableLayer.update",Z_e="dismissableLayer.pointerDownOutside",X_e="dismissableLayer.focusOutside",P9,RZ=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),VT=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(RZ),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=E.useState({}),g=Tn(t,A=>d(A)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=y.indexOf(v),w=u?y.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,_=w>=x,k=eCe(A=>{const R=A.target,M=[...c.branches].some(j=>j.contains(R));!_||M||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=tCe(A=>{const R=A.target;[...c.branches].some(j=>j.contains(R))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return YD(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(P9=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),O9(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=P9)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),O9())},[u,c]),E.useEffect(()=>{const A=()=>p({});return document.addEventListener(e4,A),()=>document.removeEventListener(e4,A)},[]),f.jsx(Zn.div,{...l,ref:g,style:{pointerEvents:S?_?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});VT.displayName=Y_e;var J_e="DismissableLayerBranch",Q_e=E.forwardRef((e,t)=>{const n=E.useContext(RZ),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(Zn.div,{...e,ref:s})});Q_e.displayName=J_e;function eCe(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){IZ(Z_e,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function tCe(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&IZ(X_e,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function O9(){const e=new CustomEvent(e4);document.dispatchEvent(e)}function IZ(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?NZ(s,i):s.dispatchEvent(i)}var di=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},nCe=qK[" useId ".trim().toString()]||(()=>{}),rCe=0;function _a(e){const[t,n]=E.useState(nCe());return di(()=>{n(r=>r??String(rCe++))},[e]),t?`radix-${t}`:""}const sCe=["top","right","bottom","left"],np=Math.min,Al=Math.max,Kk=Math.round,DC=Math.floor,Xu=e=>({x:e,y:e}),iCe={left:"right",right:"left",bottom:"top",top:"bottom"},aCe={start:"end",end:"start"};function t4(e,t,n){return Al(e,np(t,n))}function kf(e,t){return typeof e=="function"?e(t):e}function Ef(e){return e.split("-")[0]}function Lb(e){return e.split("-")[1]}function ZD(e){return e==="x"?"y":"x"}function XD(e){return e==="y"?"height":"width"}function rp(e){return["top","bottom"].includes(Ef(e))?"y":"x"}function JD(e){return ZD(rp(e))}function oCe(e,t,n){n===void 0&&(n=!1);const r=Lb(e),s=JD(e),i=XD(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=Yk(a)),[a,Yk(a)]}function lCe(e){const t=Yk(e);return[n4(e),t,n4(t)]}function n4(e){return e.replace(/start|end/g,t=>aCe[t])}function cCe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function uCe(e,t,n,r){const s=Lb(e);let i=cCe(Ef(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(n4)))),i}function Yk(e){return e.replace(/left|right|bottom|top/g,t=>iCe[t])}function dCe(e){return{top:0,right:0,bottom:0,left:0,...e}}function MZ(e){return typeof e!="number"?dCe(e):{top:e,right:e,bottom:e,left:e}}function Zk(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function D9(e,t,n){let{reference:r,floating:s}=e;const i=rp(t),a=JD(t),o=XD(a),l=Ef(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let p;switch(l){case"top":p={x:u,y:r.y-s.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-s.width,y:d};break;default:p={x:r.x,y:r.y}}switch(Lb(t)){case"start":p[a]-=h*(n&&c?-1:1);break;case"end":p[a]+=h*(n&&c?-1:1);break}return p}const fCe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=D9(c,r,l),h=r,p={},g=0;for(let y=0;y<o.length;y++){const{name:v,fn:x}=o[y],{x:w,y:S,data:_,reset:k}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=S??d,p={...p,[v]:{...p[v],..._}},k&&g<=50&&(g++,typeof k=="object"&&(k.placement&&(h=k.placement),k.rects&&(c=k.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):k.rects),{x:u,y:d}=D9(c,h,l)),y=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:p}};async function Kw(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=kf(t,e),g=MZ(p),v=o[h?d==="floating"?"reference":"floating":d],x=Zk(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),_=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},k=Zk(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-k.top+g.top)/_.y,bottom:(k.bottom-x.bottom+g.bottom)/_.y,left:(x.left-k.left+g.left)/_.x,right:(k.right-x.right+g.right)/_.x}}const hCe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=kf(e,t)||{};if(c==null)return{};const d=MZ(u),h={x:n,y:r},p=JD(s),g=XD(p),y=await a.getDimensions(c),v=p==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",_=i.reference[g]+i.reference[p]-h[p]-i.floating[g],k=h[p]-i.reference[p],T=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let A=T?T[S]:0;(!A||!await(a.isElement==null?void 0:a.isElement(T)))&&(A=o.floating[S]||i.floating[g]);const R=_/2-k/2,M=A/2-y[g]/2-1,j=np(d[x],M),F=np(d[w],M),P=j,q=A-y[g]-F,I=A/2-y[g]/2+R,V=t4(P,I,q),D=!l.arrow&&Lb(s)!=null&&I!==V&&i.reference[g]/2-(I<P?j:F)-y[g]/2<0,z=D?I<P?I-P:I-q:0;return{[p]:h[p]+z,data:{[p]:V,centerOffset:I-V-z,...D&&{alignmentOffset:z}},reset:D}}}),pCe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:y=!0,...v}=kf(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Ef(s),w=rp(o),S=Ef(o)===o,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),k=h||(S||!y?[Yk(o)]:lCe(o)),T=g!=="none";!h&&T&&k.push(...uCe(o,y,g,_));const A=[o,...k],R=await Kw(t,v),M=[];let j=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&M.push(R[x]),d){const I=oCe(s,a,_);M.push(R[I[0]],R[I[1]])}if(j=[...j,{placement:s,overflows:M}],!M.every(I=>I<=0)){var F,P;const I=(((F=i.flip)==null?void 0:F.index)||0)+1,V=A[I];if(V)return{data:{index:I,overflows:j},reset:{placement:V}};let D=(P=j.filter(z=>z.overflows[0]<=0).sort((z,$)=>z.overflows[1]-$.overflows[1])[0])==null?void 0:P.placement;if(!D)switch(p){case"bestFit":{var q;const z=(q=j.filter($=>{if(T){const Y=rp($.placement);return Y===w||Y==="y"}return!0}).map($=>[$.placement,$.overflows.filter(Y=>Y>0).reduce((Y,B)=>Y+B,0)]).sort(($,Y)=>$[1]-Y[1])[0])==null?void 0:q[0];z&&(D=z);break}case"initialPlacement":D=o;break}if(s!==D)return{reset:{placement:D}}}return{}}}};function F9(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function L9(e){return sCe.some(t=>e[t]>=0)}const mCe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=kf(e,t);switch(r){case"referenceHidden":{const i=await Kw(t,{...s,elementContext:"reference"}),a=F9(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:L9(a)}}}case"escaped":{const i=await Kw(t,{...s,altBoundary:!0}),a=F9(i,n.floating);return{data:{escapedOffsets:a,escaped:L9(a)}}}default:return{}}}}};async function gCe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Ef(n),o=Lb(n),l=rp(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=kf(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof g=="number"&&(p=o==="end"?g*-1:g),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const yCe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await gCe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},bCe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=kf(e,t),c={x:n,y:r},u=await Kw(t,l),d=rp(Ef(s)),h=ZD(d);let p=c[h],g=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=p+u[v],S=p-u[x];p=t4(w,p,S)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=g+u[v],S=g-u[x];g=t4(w,g,S)}const y=o.fn({...t,[h]:p,[d]:g});return{...y,data:{x:y.x-n,y:y.y-r,enabled:{[h]:i,[d]:a}}}}}},vCe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=kf(e,t),u={x:n,y:r},d=rp(s),h=ZD(d);let p=u[h],g=u[d];const y=kf(o,t),v=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(l){const S=h==="y"?"height":"width",_=i.reference[h]-i.floating[S]+v.mainAxis,k=i.reference[h]+i.reference[S]-v.mainAxis;p<_?p=_:p>k&&(p=k)}if(c){var x,w;const S=h==="y"?"width":"height",_=["top","left"].includes(Ef(s)),k=i.reference[d]-i.floating[S]+(_&&((x=a.offset)==null?void 0:x[d])||0)+(_?0:v.crossAxis),T=i.reference[d]+i.reference[S]+(_?0:((w=a.offset)==null?void 0:w[d])||0)-(_?v.crossAxis:0);g<k?g=k:g>T&&(g=T)}return{[h]:p,[d]:g}}}},xCe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=kf(e,t),u=await Kw(t,c),d=Ef(s),h=Lb(s),p=rp(s)==="y",{width:g,height:y}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=y-u.top-u.bottom,S=g-u.left-u.right,_=np(y-u[v],w),k=np(g-u[x],S),T=!t.middlewareData.shift;let A=_,R=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(R=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(A=w),T&&!h){const j=Al(u.left,0),F=Al(u.right,0),P=Al(u.top,0),q=Al(u.bottom,0);p?R=g-2*(j!==0||F!==0?j+F:Al(u.left,u.right)):A=y-2*(P!==0||q!==0?P+q:Al(u.top,u.bottom))}await l({...t,availableWidth:R,availableHeight:A});const M=await a.getDimensions(o.floating);return g!==M.width||y!==M.height?{reset:{rects:!0}}:{}}}};function WT(){return typeof window<"u"}function $b(e){return jZ(e)?(e.nodeName||"").toLowerCase():"#document"}function Il(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function pd(e){var t;return(t=(jZ(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function jZ(e){return WT()?e instanceof Node||e instanceof Il(e).Node:!1}function nu(e){return WT()?e instanceof Element||e instanceof Il(e).Element:!1}function ld(e){return WT()?e instanceof HTMLElement||e instanceof Il(e).HTMLElement:!1}function $9(e){return!WT()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Il(e).ShadowRoot}function yS(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=ru(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function wCe(e){return["table","td","th"].includes($b(e))}function HT(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function QD(e){const t=eF(),n=nu(e)?ru(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function SCe(e){let t=sp(e);for(;ld(t)&&!Hy(t);){if(QD(t))return t;if(HT(t))return null;t=sp(t)}return null}function eF(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Hy(e){return["html","body","#document"].includes($b(e))}function ru(e){return Il(e).getComputedStyle(e)}function GT(e){return nu(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function sp(e){if($b(e)==="html")return e;const t=e.assignedSlot||e.parentNode||$9(e)&&e.host||pd(e);return $9(t)?t.host:t}function PZ(e){const t=sp(e);return Hy(t)?e.ownerDocument?e.ownerDocument.body:e.body:ld(t)&&yS(t)?t:PZ(t)}function Yw(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=PZ(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=Il(s);if(i){const o=r4(a);return t.concat(a,a.visualViewport||[],yS(s)?s:[],o&&n?Yw(o):[])}return t.concat(s,Yw(s,[],n))}function r4(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function OZ(e){const t=ru(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=ld(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=Kk(n)!==i||Kk(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function tF(e){return nu(e)?e:e.contextElement}function yy(e){const t=tF(e);if(!ld(t))return Xu(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=OZ(t);let a=(i?Kk(n.width):n.width)/r,o=(i?Kk(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const _Ce=Xu(0);function DZ(e){const t=Il(e);return!eF()||!t.visualViewport?_Ce:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function CCe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Il(e)?!1:t}function ig(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=tF(e);let a=Xu(1);t&&(r?nu(r)&&(a=yy(r)):a=yy(e));const o=CCe(i,n,r)?DZ(i):Xu(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=Il(i),p=r&&nu(r)?Il(r):r;let g=h,y=r4(g);for(;y&&r&&p!==g;){const v=yy(y),x=y.getBoundingClientRect(),w=ru(y),S=x.left+(y.clientLeft+parseFloat(w.paddingLeft))*v.x,_=x.top+(y.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=_,g=Il(y),y=r4(g)}}return Zk({width:u,height:d,x:l,y:c})}function nF(e,t){const n=GT(e).scrollLeft;return t?t.left+n:ig(pd(e)).left+n}function FZ(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:nF(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function kCe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=pd(r),o=t?HT(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Xu(1);const u=Xu(0),d=ld(r);if((d||!d&&!i)&&(($b(r)!=="body"||yS(a))&&(l=GT(r)),ld(r))){const p=ig(r);c=yy(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const h=a&&!d&&!i?FZ(a,l,!0):Xu(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function ECe(e){return Array.from(e.getClientRects())}function TCe(e){const t=pd(e),n=GT(e),r=e.ownerDocument.body,s=Al(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=Al(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+nF(e);const o=-n.scrollTop;return ru(r).direction==="rtl"&&(a+=Al(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function ACe(e,t){const n=Il(e),r=pd(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=eF();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function NCe(e,t){const n=ig(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=ld(e)?yy(e):Xu(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function B9(e,t,n){let r;if(t==="viewport")r=ACe(e,n);else if(t==="document")r=TCe(pd(e));else if(nu(t))r=NCe(t,n);else{const s=DZ(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return Zk(r)}function LZ(e,t){const n=sp(e);return n===t||!nu(n)||Hy(n)?!1:ru(n).position==="fixed"||LZ(n,t)}function RCe(e,t){const n=t.get(e);if(n)return n;let r=Yw(e,[],!1).filter(o=>nu(o)&&$b(o)!=="body"),s=null;const i=ru(e).position==="fixed";let a=i?sp(e):e;for(;nu(a)&&!Hy(a);){const o=ru(a),l=QD(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||yS(a)&&!l&&LZ(e,a))?r=r.filter(u=>u!==a):s=o,a=sp(a)}return t.set(e,r),r}function ICe(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?HT(t)?[]:RCe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=B9(t,u,s);return c.top=Al(d.top,c.top),c.right=np(d.right,c.right),c.bottom=np(d.bottom,c.bottom),c.left=Al(d.left,c.left),c},B9(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function MCe(e){const{width:t,height:n}=OZ(e);return{width:t,height:n}}function jCe(e,t,n){const r=ld(t),s=pd(t),i=n==="fixed",a=ig(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Xu(0);if(r||!r&&!i)if(($b(t)!=="body"||yS(s))&&(o=GT(t)),r){const h=ig(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=nF(s));const c=s&&!r&&!i?FZ(s,o):Xu(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function kM(e){return ru(e).position==="static"}function z9(e,t){if(!ld(e)||ru(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return pd(e)===n&&(n=n.ownerDocument.body),n}function $Z(e,t){const n=Il(e);if(HT(e))return n;if(!ld(e)){let s=sp(e);for(;s&&!Hy(s);){if(nu(s)&&!kM(s))return s;s=sp(s)}return n}let r=z9(e,t);for(;r&&wCe(r)&&kM(r);)r=z9(r,t);return r&&Hy(r)&&kM(r)&&!QD(r)?n:r||SCe(e)||n}const PCe=async function(e){const t=this.getOffsetParent||$Z,n=this.getDimensions,r=await n(e.floating);return{reference:jCe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function OCe(e){return ru(e).direction==="rtl"}const DCe={convertOffsetParentRelativeRectToViewportRelativeRect:kCe,getDocumentElement:pd,getClippingRect:ICe,getOffsetParent:$Z,getElementRects:PCe,getClientRects:ECe,getDimensions:MCe,getScale:yy,isElement:nu,isRTL:OCe};function BZ(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function FCe(e,t){let n=null,r;const s=pd(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:p}=c;if(o||t(),!h||!p)return;const g=DC(d),y=DC(s.clientWidth-(u+h)),v=DC(s.clientHeight-(d+p)),x=DC(u),S={rootMargin:-g+"px "+-y+"px "+-v+"px "+-x+"px",threshold:Al(0,np(1,l))||1};let _=!0;function k(T){const A=T[0].intersectionRatio;if(A!==l){if(!_)return a();A?a(!1,A):r=setTimeout(()=>{a(!1,1e-7)},1e3)}A===1&&!BZ(c,e.getBoundingClientRect())&&a(),_=!1}try{n=new IntersectionObserver(k,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(k,S)}n.observe(e)}return a(!0),i}function rF(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=tF(e),u=s||i?[...c?Yw(c):[],...Yw(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?FCe(c,n):null;let h=-1,p=null;a&&(p=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=p)==null||S.observe(t)})),n()}),c&&!l&&p.observe(c),p.observe(t));let g,y=l?ig(e):null;l&&v();function v(){const x=ig(e);y&&!BZ(y,x)&&n(),y=x,g=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=p)==null||x.disconnect(),p=null,l&&cancelAnimationFrame(g)}}const LCe=yCe,$Ce=bCe,BCe=pCe,zCe=xCe,UCe=mCe,U9=hCe,qCe=vCe,VCe=(e,t,n)=>{const r=new Map,s={platform:DCe,...n},i={...s.platform,_c:r};return fCe(e,t,{...s,platform:i})};var q2=typeof document<"u"?E.useLayoutEffect:E.useEffect;function Xk(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Xk(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!Xk(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function zZ(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function q9(e,t){const n=zZ(e);return Math.round(t*n)/n}function EM(e){const t=E.useRef(e);return q2(()=>{t.current=e}),t}function sF(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=E.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=E.useState(r);Xk(h,r)||p(r);const[g,y]=E.useState(null),[v,x]=E.useState(null),w=E.useCallback($=>{$!==T.current&&(T.current=$,y($))},[]),S=E.useCallback($=>{$!==A.current&&(A.current=$,x($))},[]),_=i||g,k=a||v,T=E.useRef(null),A=E.useRef(null),R=E.useRef(u),M=l!=null,j=EM(l),F=EM(s),P=EM(c),q=E.useCallback(()=>{if(!T.current||!A.current)return;const $={placement:t,strategy:n,middleware:h};F.current&&($.platform=F.current),VCe(T.current,A.current,$).then(Y=>{const B={...Y,isPositioned:P.current!==!1};I.current&&!Xk(R.current,B)&&(R.current=B,Nl.flushSync(()=>{d(B)}))})},[h,t,n,F,P]);q2(()=>{c===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,d($=>({...$,isPositioned:!1})))},[c]);const I=E.useRef(!1);q2(()=>(I.current=!0,()=>{I.current=!1}),[]),q2(()=>{if(_&&(T.current=_),k&&(A.current=k),_&&k){if(j.current)return j.current(_,k,q);q()}},[_,k,q,j,M]);const V=E.useMemo(()=>({reference:T,floating:A,setReference:w,setFloating:S}),[w,S]),D=E.useMemo(()=>({reference:_,floating:k}),[_,k]),z=E.useMemo(()=>{const $={position:n,left:0,top:0};if(!D.floating)return $;const Y=q9(D.floating,u.x),B=q9(D.floating,u.y);return o?{...$,transform:"translate("+Y+"px, "+B+"px)",...zZ(D.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:Y,top:B}},[n,o,D.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:q,refs:V,elements:D,floatingStyles:z}),[u,q,V,D,z])}const WCe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?U9({element:r.current,padding:s}).fn(n):{}:r?U9({element:r,padding:s}).fn(n):{}}}},iF=(e,t)=>({...LCe(e),options:[e,t]}),aF=(e,t)=>({...$Ce(e),options:[e,t]}),oF=(e,t)=>({...qCe(e),options:[e,t]}),lF=(e,t)=>({...BCe(e),options:[e,t]}),cF=(e,t)=>({...zCe(e),options:[e,t]}),uF=(e,t)=>({...UCe(e),options:[e,t]}),dF=(e,t)=>({...WCe(e),options:[e,t]});var HCe="Arrow",UZ=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(Zn.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});UZ.displayName=HCe;var GCe=UZ;function Sg(e){const[t,n]=E.useState(void 0);return di(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var fF="Popper",[qZ,KT]=Pi(fF),[KCe,VZ]=qZ(fF),WZ=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(KCe,{scope:t,anchor:r,onAnchorChange:s,children:n})};WZ.displayName=fF;var HZ="PopperAnchor",GZ=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=VZ(HZ,n),a=E.useRef(null),o=Tn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(Zn.div,{...s,ref:o})});GZ.displayName=HZ;var hF="PopperContent",[YCe,ZCe]=qZ(hF),KZ=E.forwardRef((e,t)=>{var Ee,he,pe,Le,He,Fe;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...y}=e,v=VZ(hF,n),[x,w]=E.useState(null),S=Tn(t,Ie=>w(Ie)),[_,k]=E.useState(null),T=Sg(_),A=(T==null?void 0:T.width)??0,R=(T==null?void 0:T.height)??0,M=r+(i!=="center"?"-"+i:""),j=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},F=Array.isArray(c)?c:[c],P=F.length>0,q={padding:j,boundary:F.filter(JCe),altBoundary:P},{refs:I,floatingStyles:V,placement:D,isPositioned:z,middlewareData:$}=sF({strategy:"fixed",placement:M,whileElementsMounted:(...Ie)=>rF(...Ie,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[iF({mainAxis:s+R,alignmentAxis:a}),l&&aF({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?oF():void 0,...q}),l&&lF({...q}),cF({...q,apply:({elements:Ie,rects:X,availableWidth:ye,availableHeight:Ne})=>{const{width:fe,height:ce}=X.reference,se=Ie.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Ne}px`),se.setProperty("--radix-popper-anchor-width",`${fe}px`),se.setProperty("--radix-popper-anchor-height",`${ce}px`)}}),_&&dF({element:_,padding:o}),QCe({arrowWidth:A,arrowHeight:R}),h&&uF({strategy:"referenceHidden",...q})]}),[Y,B]=XZ(D),G=Ms(g);di(()=>{z&&(G==null||G())},[z,G]);const Z=(Ee=$.arrow)==null?void 0:Ee.x,ne=(he=$.arrow)==null?void 0:he.y,ae=((pe=$.arrow)==null?void 0:pe.centerOffset)!==0,[le,Se]=E.useState();return di(()=>{x&&Se(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:z?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:le,"--radix-popper-transform-origin":[(Le=$.transformOrigin)==null?void 0:Le.x,(He=$.transformOrigin)==null?void 0:He.y].join(" "),...((Fe=$.hide)==null?void 0:Fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(YCe,{scope:n,placedSide:Y,onArrowChange:k,arrowX:Z,arrowY:ne,shouldHideArrow:ae,children:f.jsx(Zn.div,{"data-side":Y,"data-align":B,...y,ref:S,style:{...y.style,animation:z?void 0:"none"}})})})});KZ.displayName=hF;var YZ="PopperArrow",XCe={top:"bottom",right:"left",bottom:"top",left:"right"},ZZ=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=ZCe(YZ,r),a=XCe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(GCe,{...s,ref:n,style:{...s.style,display:"block"}})})});ZZ.displayName=YZ;function JCe(e){return e!==null}var QCe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=XZ(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,p=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let g="",y="";return c==="bottom"?(g=a?d:`${h}px`,y=`${-l}px`):c==="top"?(g=a?d:`${h}px`,y=`${r.floating.height+l}px`):c==="right"?(g=`${-l}px`,y=a?d:`${p}px`):c==="left"&&(g=`${r.floating.width+l}px`,y=a?d:`${p}px`),{data:{x:g,y}}}});function XZ(e){const[t,n="center"]=e.split("-");return[t,n]}var JZ=WZ,QZ=GZ,eX=KZ,tX=ZZ,e2e="Portal",YT=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);di(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?FT.createPortal(f.jsx(Zn.div,{...r,ref:t}),a):null});YT.displayName=e2e;function t2e(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var ca=e=>{const{present:t,children:n}=e,r=n2e(t),s=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),i=Tn(r.ref,r2e(s));return typeof n=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};ca.displayName="Presence";function n2e(e){const[t,n]=E.useState(),r=E.useRef(null),s=E.useRef(e),i=E.useRef("none"),a=e?"mounted":"unmounted",[o,l]=t2e(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=FC(r.current);i.current=o==="mounted"?c:"none"},[o]),di(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,p=FC(c);e?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),di(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=p=>{const y=FC(r.current).includes(p.animationName);if(p.target===t&&y&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=p=>{p.target===t&&(i.current=FC(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function FC(e){return(e==null?void 0:e.animationName)||"none"}function r2e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var s2e=Symbol("radix.slottable");function i2e(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=s2e,t}var a2e=qK[" useInsertionEffect ".trim().toString()]||di;function pc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=o2e({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=E.useRef(e!==void 0);E.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=E.useCallback(u=>{var d;if(o){const h=l2e(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function o2e({defaultProp:e,onChange:t}){const[n,r]=E.useState(e),s=E.useRef(n),i=E.useRef(t);return a2e(()=>{i.current=t},[t]),E.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function l2e(e){return typeof e=="function"}var c2e=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),u2e="VisuallyHidden",nX=E.forwardRef((e,t)=>f.jsx(Zn.span,{...e,ref:t,style:{...c2e,...e.style}}));nX.displayName=u2e;var d2e=nX,[ZT,uvt]=Pi("Tooltip",[KT]),XT=KT(),rX="TooltipProvider",f2e=700,s4="tooltip.open",[h2e,pF]=ZT(rX),sX=e=>{const{__scopeTooltip:t,delayDuration:n=f2e,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=E.useRef(!0),o=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(h2e,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:E.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};sX.displayName=rX;var Zw="Tooltip",[p2e,bS]=ZT(Zw),iX=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=pF(Zw,e.__scopeTooltip),c=XT(t),[u,d]=E.useState(null),h=_a(),p=E.useRef(0),g=a??l.disableHoverableContent,y=o??l.delayDuration,v=E.useRef(!1),[x,w]=pc({prop:r,defaultProp:s??!1,onChange:A=>{A?(l.onOpen(),document.dispatchEvent(new CustomEvent(s4))):l.onClose(),i==null||i(A)},caller:Zw}),S=E.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),_=E.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,w(!0)},[w]),k=E.useCallback(()=>{window.clearTimeout(p.current),p.current=0,w(!1)},[w]),T=E.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,w(!0),p.current=0},y)},[y,w]);return E.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),f.jsx(JZ,{...c,children:f.jsx(p2e,{scope:t,contentId:h,open:x,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayedRef.current?T():_()},[l.isOpenDelayedRef,T,_]),onTriggerLeave:E.useCallback(()=>{g?k():(window.clearTimeout(p.current),p.current=0)},[k,g]),onOpen:_,onClose:k,disableHoverableContent:g,children:n})})};iX.displayName=Zw;var i4="TooltipTrigger",aX=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=bS(i4,n),i=pF(i4,n),a=XT(n),o=E.useRef(null),l=Tn(t,o,s.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),d=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(QZ,{asChild:!0,...a,children:f.jsx(Zn.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});aX.displayName=i4;var mF="TooltipPortal",[m2e,g2e]=ZT(mF,{forceMount:void 0}),oX=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=bS(mF,t);return f.jsx(m2e,{scope:t,forceMount:n,children:f.jsx(ca,{present:n||i.open,children:f.jsx(YT,{asChild:!0,container:s,children:r})})})};oX.displayName=mF;var Gy="TooltipContent",lX=E.forwardRef((e,t)=>{const n=g2e(Gy,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=bS(Gy,e.__scopeTooltip);return f.jsx(ca,{present:r||a.open,children:a.disableHoverableContent?f.jsx(cX,{side:s,...i,ref:t}):f.jsx(y2e,{side:s,...i,ref:t})})}),y2e=E.forwardRef((e,t)=>{const n=bS(Gy,e.__scopeTooltip),r=pF(Gy,e.__scopeTooltip),s=E.useRef(null),i=Tn(t,s),[a,o]=E.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=E.useCallback(()=>{o(null),d(!1)},[d]),p=E.useCallback((g,y)=>{const v=g.currentTarget,x={x:g.clientX,y:g.clientY},w=w2e(x,v.getBoundingClientRect()),S=S2e(x,w),_=_2e(y.getBoundingClientRect()),k=k2e([...S,..._]);o(k),d(!0)},[d]);return E.useEffect(()=>()=>h(),[h]),E.useEffect(()=>{if(l&&u){const g=v=>p(v,u),y=v=>p(v,l);return l.addEventListener("pointerleave",g),u.addEventListener("pointerleave",y),()=>{l.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",y)}}},[l,u,p,h]),E.useEffect(()=>{if(a){const g=y=>{const v=y.target,x={x:y.clientX,y:y.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),S=!C2e(x,a);w?h():S&&(h(),c())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,u,a,c,h]),f.jsx(cX,{...e,ref:i})}),[b2e,v2e]=ZT(Zw,{isInside:!1}),x2e=i2e("TooltipContent"),cX=E.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=bS(Gy,n),c=XT(n),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(s4,u),()=>document.removeEventListener(s4,u)),[u]),E.useEffect(()=>{if(l.trigger){const d=h=>{const p=h.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(VT,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(eX,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(x2e,{children:r}),f.jsx(b2e,{scope:n,isInside:!0,children:f.jsx(d2e,{id:l.contentId,role:"tooltip",children:s||r})})]})})});lX.displayName=Gy;var uX="TooltipArrow",dX=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=XT(n);return v2e(uX,n).isInside?null:f.jsx(tX,{...s,...r,ref:t})});dX.displayName=uX;function w2e(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function S2e(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function _2e(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function C2e(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function k2e(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),E2e(t)}function E2e(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var T2e=sX,A2e=iX,N2e=aX,R2e=oX,I2e=lX,M2e=dX;function Er({delayDuration:e=0,...t}){return f.jsx(T2e,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function Tr({...e}){return f.jsx(Er,{children:f.jsx(A2e,{"data-slot":"tooltip",...e})})}function Ar({...e}){return f.jsx(N2e,{"data-slot":"tooltip-trigger",...e})}function Nr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(R2e,{children:f.jsxs(I2e,{"data-slot":"tooltip-content",sideOffset:t,className:Ye("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(M2e,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}class j2e{static findRendererForLanguage(t,n){const r=Object.values(n);if(r.length===0)return null;const s=r.filter(l=>{var c;return(c=l.supportedLanguages)==null?void 0:c.includes(t||"")}),i=r.filter(l=>!l.supportedLanguages||l.supportedLanguages.length===0);return[...s,...i].sort((l,c)=>(c.priority||0)-(l.priority||0))[0]||null}static renderBlock(t){const n=Ni.getState().blockRenderers,r=this.findRendererForLanguage(t.lang,n);if(!r)return null;try{return r.renderer(t)}catch(s){return console.error(`[BlockRendererService] Error rendering block with renderer ${r.id}:`,s),null}}static getRegisteredRenderers(){return Ni.getState().blockRenderers}static hasRendererForLanguage(t){const n=Ni.getState().blockRenderers;return this.findRendererForLanguage(t,n)!==null}}const Bb=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s})=>{const i=Ni(pn(l=>l.blockRenderers)),a=E.useMemo(()=>dr(),[]),o=E.useMemo(()=>{const l={lang:e,code:t,filepath:n,isStreaming:r,blockId:a,interactionId:s},c=j2e.findRendererForLanguage(e,i);if(!c){const u=e?`language-${e}`:"language-plaintext";return f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:`${u} block p-4 font-mono text-sm leading-relaxed`,children:t})})]})}try{return c.renderer(l)}catch(u){return console.error(`[UniversalBlockRenderer] Error rendering block with renderer ${c.id}:`,u),f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsxs("div",{className:"text-sm font-medium text-destructive",children:[e?e.toUpperCase():"CODE"," (Render Error)"]})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:"block p-4 font-mono text-sm leading-relaxed",children:t})})]})}},[e,t,n,r,a,i]);return f.jsx(f.Fragment,{children:o})};var vt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(vt||(vt={}));const V9={[vt.EPERM]:"Operation not permitted",[vt.ENOENT]:"No such file or directory",[vt.EINTR]:"Interrupted system call",[vt.EIO]:"Input/output error",[vt.ENXIO]:"No such device or address",[vt.EBADF]:"Bad file descriptor",[vt.EAGAIN]:"Resource temporarily unavailable",[vt.ENOMEM]:"Cannot allocate memory",[vt.EACCES]:"Permission denied",[vt.EFAULT]:"Bad address",[vt.ENOTBLK]:"Block device required",[vt.EBUSY]:"Resource busy or locked",[vt.EEXIST]:"File exists",[vt.EXDEV]:"Invalid cross-device link",[vt.ENODEV]:"No such device",[vt.ENOTDIR]:"File is not a directory",[vt.EISDIR]:"File is a directory",[vt.EINVAL]:"Invalid argument",[vt.ENFILE]:"Too many open files in system",[vt.EMFILE]:"Too many open files",[vt.ETXTBSY]:"Text file busy",[vt.EFBIG]:"File is too big",[vt.ENOSPC]:"No space left on disk",[vt.ESPIPE]:"Illegal seek",[vt.EROFS]:"Cannot modify a read-only file system",[vt.EMLINK]:"Too many links",[vt.EPIPE]:"Broken pipe",[vt.EDOM]:"Numerical argument out of domain",[vt.ERANGE]:"Numerical result out of range",[vt.EDEADLK]:"Resource deadlock would occur",[vt.ENAMETOOLONG]:"File name too long",[vt.ENOLCK]:"No locks available",[vt.ENOSYS]:"Function not implemented",[vt.ENOTEMPTY]:"Directory is not empty",[vt.ELOOP]:"Too many levels of symbolic links",[vt.ENOMSG]:"No message of desired type",[vt.EBADE]:"Invalid exchange",[vt.EBADR]:"Invalid request descriptor",[vt.EXFULL]:"Exchange full",[vt.ENOANO]:"No anode",[vt.EBADRQC]:"Invalid request code",[vt.ENOSTR]:"Device not a stream",[vt.ENODATA]:"No data available",[vt.ETIME]:"Timer expired",[vt.ENOSR]:"Out of streams resources",[vt.ENONET]:"Machine is not on the network",[vt.EREMOTE]:"Object is remote",[vt.ENOLINK]:"Link has been severed",[vt.ECOMM]:"Communication error on send",[vt.EPROTO]:"Protocol error",[vt.EBADMSG]:"Bad message",[vt.EOVERFLOW]:"Value too large for defined data type",[vt.EBADFD]:"File descriptor in bad state",[vt.ESTRPIPE]:"Streams pipe error",[vt.ENOTSOCK]:"Socket operation on non-socket",[vt.EDESTADDRREQ]:"Destination address required",[vt.EMSGSIZE]:"Message too long",[vt.EPROTOTYPE]:"Protocol wrong type for socket",[vt.ENOPROTOOPT]:"Protocol not available",[vt.EPROTONOSUPPORT]:"Protocol not supported",[vt.ESOCKTNOSUPPORT]:"Socket type not supported",[vt.ENOTSUP]:"Operation is not supported",[vt.ENETDOWN]:"Network is down",[vt.ENETUNREACH]:"Network is unreachable",[vt.ENETRESET]:"Network dropped connection on reset",[vt.ETIMEDOUT]:"Connection timed out",[vt.ECONNREFUSED]:"Connection refused",[vt.EHOSTDOWN]:"Host is down",[vt.EHOSTUNREACH]:"No route to host",[vt.EALREADY]:"Operation already in progress",[vt.EINPROGRESS]:"Operation now in progress",[vt.ESTALE]:"Stale file handle",[vt.EREMOTEIO]:"Remote I/O error",[vt.EDQUOT]:"Disk quota exceeded"};class Je extends Error{static fromJSON(t){const n=new Je(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Je(vt[t],V9[vt[t]],n,r)}constructor(t,n=V9[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=vt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var TM={exports:{}},W9;function P2e(){return W9||(W9=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new s(u,d||l,h),g=n?n+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],p]:l._events[g].push(p):(l._events[g]=p,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,g=new Array(p);h<p;h++)g[h]=d[h].fn;return g},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,p,g){var y=n?n+c:c;if(!this._events[y])return!1;var v=this._events[y],x=arguments.length,w,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,p),!0;case 6:return v.fn.call(v.context,u,d,h,p,g),!0}for(S=1,w=new Array(x-1);S<x;S++)w[S-1]=arguments[S];v.fn.apply(v.context,w)}else{var _=v.length,k;for(S=0;S<_;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),x){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,u);break;case 3:v[S].fn.call(v[S].context,u,d);break;case 4:v[S].fn.call(v[S].context,u,d,h);break;default:if(!w)for(k=1,w=new Array(x-1);k<x;k++)w[k-1]=arguments[k];v[S].fn.apply(v[S].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var p=n?n+c:c;if(!this._events[p])return this;if(!u)return a(this,p),this;var g=this._events[p];if(g.fn)g.fn===u&&(!h||g.once)&&(!d||g.context===d)&&a(this,p);else{for(var y=0,v=[],x=g.length;y<x;y++)(g[y].fn!==u||h&&!g[y].once||d&&g[y].context!==d)&&v.push(g[y]);v.length?this._events[p]=v.length===1?v[0]:v:a(this,p)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(TM)),TM.exports}var O2e=P2e();const gF=la(O2e);var LK;let D2e=class extends gF{constructor(n){super();ue(this,LK,"List");ue(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(LK=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function H9(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function ks(e){throw e}const G9=Intl.NumberFormat("en",{notation:"compact"});G9.format.bind(G9);function _g(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function F2e(e){try{return JSON.parse(e),!0}catch{return!1}}function a4(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function yF(e){return e.at(0).toUpperCase()+e.slice(1)}const L2e=new TextEncoder;function Rm(e){return L2e.encode(e)}const K9=new TextDecoder;function bF(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return K9.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),K9.decode(t)}function Xw(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=Xw(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function $2e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var B2e={};let z2e="process"in globalThis&&"env"in globalThis.process&&B2e.U_DEBUG=="true";function Jw(...e){z2e&&console.debug("[U]",...e)}const Y9=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],U2e=[...Y9,...Y9.map(e=>yF(e)),"char"],vF=/^(u?int|float)(8|16|32|64|128)$/i;function fX(e){return e=="char"?"uint8":e.toLowerCase()}function xF(e){return vF.test(e.toString())}function o4(e){return e=="char"||vF.test(e.toString().toLowerCase())}function q2e(e){if(!o4(e))throw new TypeError("Not a valid primitive type: "+e)}const Z9=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function hX(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function V2e(e){return e!=null&&typeof e=="object"&&"struct"in e}function JT(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Zc(e){return typeof e=="function"&&Symbol.metadata in e&&V2e(e[Symbol.metadata])}function vS(e){return e!=null&&typeof e=="object"&&Zc(e.constructor)}function pX(e){if(!vS(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function wF(e){return vS(e)||Zc(e)}function mX(e){if(!wF(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function SF(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function Ks(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=Ks(e[i]);return s}if(typeof e=="string")return q2e(e),+fX(e).match(vF)[2]/8;if(SF(e))return e[Symbol.size];mX(e);const t=Zc(e)?e:e.constructor;JT(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Zc(e))return r;for(const s of n.members.values()){const i=e[s.name];if(vS(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,Ks(i)):r+=Ks(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=Ks(wF(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function W2e(e,t){var i;mX(e);const n=Zc(e)?e:e.constructor;JT(n);const{struct:r}=n[Symbol.metadata];if(Zc(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??ks(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=Ks(wF(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function H2e(e,t){return Math.ceil(e/t)*t}function Cg(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of hX(r)){if(!o4(l)&&!Zc(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!xF(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:o4(l)?fX(l):l,length:c,decl:u});const d=typeof c=="string"||Zc(l)&&l[Symbol.metadata].struct.isDynamic?0:Ks(l)*(c||1);a||(a=Zc(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=H2e(i,e.align||1),Jw("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function Qw(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return hX(r).push({name:s,type:e,length:t}),n}}function gX(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:ks(new Error("Array lengths must be natural numbers"))}function ja(e){if(SF(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();pX(e),JT(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=Ks(e),s=new Uint8Array(r),i=new DataView(s.buffer);Jw("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=gX(e,l);Jw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=vS(d)?Ks(d):Ks(l.type),!xF(l.type)){s.set(d?ja(d):new Uint8Array(Ks(l.type)),a);continue}const h=`set${yF(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&Z9,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&Z9,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function QT(e,t){const n=$2e(t);if(SF(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);pX(e),JT(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);Jw("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=gX(e,l);Jw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,p=d[h]===null||d[h]===void 0,g=p&&Zc(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!vS(d[h])&&!g&&(o+=Ks(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!xF(l.type)){if(g&&Zc(l.type))d[h]??(d[h]=new l.type);else if(p)continue;QT(d[h],new Uint8Array(n.subarray(a))),o+=Ks(d[h]);continue}c&&c!=-1&&(d||(d=[]));const y=`get${yF(l.type)}`;if(y=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(y=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(y=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(y=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(y=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[y](a,!r.bigEndian)}}}function G2e(e){function t(n,r){return typeof n=="number"||typeof n=="string"?Qw(e,n):Qw(e)(n,r)}return t}const sr=Object.fromEntries(U2e.map(e=>[e,G2e(e)]));function K2e(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const lu={root:"/",pwd:"/",credentials:K2e({uid:0,gid:0}),descriptors:new Map};function yX(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Tf(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:lu.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=yX(n,!r),r?`/${n}`:n.length?n:"/"}function Y2e(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=yX(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function ds(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?Y2e(t):"."}function bX(e,t){if(e===t||(e=Tf.call(this,e),t=Tf.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function rs(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function Ky(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function Mu(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var er;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(er||(er={}));er.EMERG+"",er.ALERT+"",er.CRIT+"",er.ERR+"",er.WARN+"",er.NOTICE+"",er.INFO+"",er.DEBUG+"";const Z2e=new D2e;function X2e(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};Z2e.add(n),ike(n)}function J2e(e,t){var n,r;if(!(e instanceof Je))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+ds(i,e.path)}function Cp(e){return function(t,n={}){return X2e(e,J2e(t,n)),t}}Cp(er.EMERG);const Q2e=Cp(er.ALERT),eA=Cp(er.CRIT),Xo=Cp(er.ERR),Ja=Cp(er.WARN),_F=Cp(er.NOTICE),vX=Cp(er.INFO),hw=Cp(er.DEBUG);function eke(e,t){return`\x1B[${t}m${e}\x1B[0m`}function tke(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[eke(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}er.EMERG+"",er.ALERT+"",er.CRIT+"",er.ERR+"",er.WARN+"",er.NOTICE+"",er.INFO+"",er.DEBUG+"",er.EMERG+"",er.ALERT+"",er.CRIT+"",er.ERR+"",er.WARN+"",er.NOTICE+"",er.INFO+"",er.DEBUG+"";er.EMERG+"",er.ALERT+"",er.CRIT+"",er.ERR+"",er.WARN+"",er.NOTICE+"",er.INFO+"",er.DEBUG+"",er.EMERG+"",er.ALERT+"",er.CRIT+"",er.ERR+"",er.WARN+"",er.NOTICE+"",er.INFO+"",er.DEBUG+"";let nke=e=>[...tke(e),e.message];function rke(e){const t=nke(e);return typeof t=="string"?[t]:Array.from(t)}let ske=console.error;function ike(e){e.level>ake||ske(...rke(e))}let ake=er.ALERT;function CF(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function oke(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function lke(e,t){if(typeof t!="object"||t===null)throw Xo(new Je(vt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){hw("Using default for option: "+n);continue}throw Xo(new Je(vt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw Xo(new Je(vt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function xX(e){return e!=null&&typeof e=="object"&&"backend"in e&&CF(e.backend)}const kF=0,ia=4,bi=2,V2=1,EF=1,cke=2,uke=4,wX=0,Xa=1,mf=2,tA=64,nA=128,dke=256,rA=512,ag=1024,fke=65536,hke=262144,pke=131072,sA=1052672,mke=4096,gke=32768,yke=16384,bke=2048,Is=61440,kg=49152,Of=40960,Xc=32768,Eg=24576,Vi=16384,Tg=8192,Ag=4096,xS=2048,wS=1024,vke=512,xke=448,SX=256,_X=128,CX=64,wke=56,kX=32,EX=16,TX=8,Ske=7,AX=4,NX=2,RX=1,_ke=0,Mo=4294967295,IX=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:EF,COPYFILE_FICLONE:cke,COPYFILE_FICLONE_FORCE:uke,F_OK:kF,O_APPEND:ag,O_CREAT:tA,O_DIRECT:yke,O_DIRECTORY:fke,O_DSYNC:mke,O_EXCL:nA,O_NOATIME:hke,O_NOCTTY:dke,O_NOFOLLOW:pke,O_NONBLOCK:bke,O_RDONLY:wX,O_RDWR:mf,O_SYMLINK:gke,O_SYNC:sA,O_TRUNC:rA,O_WRONLY:Xa,R_OK:ia,S_IFBLK:Eg,S_IFCHR:Tg,S_IFDIR:Vi,S_IFIFO:Ag,S_IFLNK:Of,S_IFMT:Is,S_IFREG:Xc,S_IFSOCK:kg,S_IRGRP:kX,S_IROTH:AX,S_IRUSR:SX,S_IRWXG:wke,S_IRWXO:Ske,S_IRWXU:xke,S_ISGID:wS,S_ISUID:xS,S_ISVTX:vke,S_IWGRP:EX,S_IWOTH:NX,S_IWUSR:_X,S_IXGRP:TX,S_IXOTH:RX,S_IXUSR:CX,UV_FS_O_FILEMAP:_ke,W_OK:bi,X_OK:V2,size_max:Mo},Symbol.toStringTag,{value:"Module"})),LC=BigInt(1e3);class MX{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Xc),(this.mode&Is)==0&&(this.mode=this.mode|this._convert(Xc)),Object.assign(this,u)}isFile(){return(this.mode&Is)===Xc}isDirectory(){return(this.mode&Is)===Vi}isSymbolicLink(){return(this.mode&Is)===Of}isSocket(){return(this.mode&Is)===kg}isBlockDevice(){return(this.mode&Is)===Eg}isCharacterDevice(){return(this.mode&Is)===Tg}isFIFO(){return(this.mode&Is)===Ag}toJSON(){return _g(this,l4)}hasAccess(t,n){return bs(n,this._isBigint?new Df(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*LC}get mtimeNs(){return BigInt(this.mtimeMs)*LC}get ctimeNs(){return BigInt(this.ctimeMs)*LC}get birthtimeNs(){return BigInt(this.birthtimeMs)*LC}}function jX(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<Mo?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<Mo?e.gid=n:r=!1,r}class Df extends MX{constructor(){super(...arguments),this._isBigint=!1}}class Ng extends MX{constructor(){super(...arguments),this._isBigint=!0}}function Cke(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class kke{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=Mo,this.ffree=Mo}}class Eke{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(Mo),this.ffree=BigInt(Mo)}}var Ls=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,p=n.length-1;p>=0;p--){var g={};for(var y in r)g[y]=y==="access"?{}:r[y];for(var y in r.access)g.access[y]=r.access[y];g.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],g);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Qn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},TF=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const wl=0,Tke=1024;let X9=(()=>{var e,t;let n=[Cg()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,p=[],g=[],y,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,S){this.keySize=Qn(this,o,0),this.valueSize=(Qn(this,l),Qn(this,u,0)),this._key=(Qn(this,d),Qn(this,p,"")),this._value=(Qn(this,g),Qn(this,v,new Uint8Array(Tke))),Qn(this,x),w&&(this.key=w),S&&(this.value=S)}},TF(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=sr).uint32.bind(e)],c=[(t=sr).uint32.bind(t)],h=[sr.char("keySize")],y=[sr.uint8("valueSize")],Ls(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,_)=>{S.keySize=_}},metadata:w},o,l),Ls(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,_)=>{S.valueSize=_}},metadata:w},u,d),Ls(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,_)=>{S._key=_}},metadata:w},p,g),Ls(null,null,y,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,_)=>{S._value=_}},metadata:w},v,x),Ls(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Qn(i,s)})(),i})(),ip=(()=>{var e;let t=[Cg()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const p=this.get(d);if(p){p.value=h;return}this.data.push(new X9(d,h)),this.size++}remove(d){const h=this.data.findIndex(p=>p.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Qn(this,a,0),this.data=(Qn(this,o),Qn(this,c,[])),Qn(this,u)}},TF(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=sr).uint32.bind(e)],l=[Qw(X9,"size")],Ls(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,p)=>{h.size=p}},metadata:d},a,o),Ls(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,p)=>{h.data=p}},metadata:d},c,u),Ls(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Qn(s,r)})(),s})();const l4=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],Ake=4;var Jo;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(Jo||(Jo={}));let zi=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,p,g,y;let v=[Cg()],x,w=[],S,_,k=[],T=[],A,R=[],M=[],j,F=[],P=[],q,I=[],V=[],D,z=[],$=[],Y,B=[],G=[],Z,ne=[],ae=[],le,Se=[],Ee=[],he,pe=[],Le=[],He,Fe=[],Ie=[],X,ye=[],Ne=[],fe,ce=[],se=[],Pe,Be=[],je=[],ot,Et=[],ut=[],Pt,$t=[],Ft=[],Ht,Ce=[],U=[],ee,xe=[],Re=[],ve,Me=[],de=[];var ht=S=class{constructor(et){if(this.data=Qn(this,k,a4(0,Mo)),this.__data_old=(Qn(this,T),Qn(this,R,0)),this.size=(Qn(this,M),Qn(this,F,0)),this.mode=(Qn(this,P),Qn(this,I,0)),this.nlink=(Qn(this,V),Qn(this,z,1)),this.uid=(Qn(this,$),Qn(this,B,0)),this.gid=(Qn(this,G),Qn(this,ne,0)),this.atimeMs=(Qn(this,ae),Qn(this,Se,Date.now())),this.birthtimeMs=(Qn(this,Ee),Qn(this,pe,Date.now())),this.mtimeMs=(Qn(this,Le),Qn(this,Fe,Date.now())),this.ctimeMs=(Qn(this,Ie),Qn(this,ye,Date.now())),this.ino=(Qn(this,Ne),Qn(this,ce,a4(0,Mo))),this.__ino_old=(Qn(this,se),Qn(this,Be,0)),this.flags=(Qn(this,je),Qn(this,Et,0)),this.__after_flags=(Qn(this,ut),Qn(this,$t,0)),this.version=(Qn(this,Ft),Qn(this,Ce,0)),this.__padding=(Qn(this,U),Qn(this,xe,[])),this.attributes=(Qn(this,Re),Qn(this,Me,new ip)),Qn(this,de),!!et){if(!("byteLength"in et)){Object.assign(this,et);return}if(et.byteLength<Ks(ht))throw eA(new Je(vt.EIO,"Buffer is too small to create an inode"));QT(this,et)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{..._g(this,l4),attributes:this.attributes}}toStats(){return new Df(this)}update(et){if(!et)return!1;let W=!1;for(const Ve of l4)et[Ve]!==void 0&&(Ve=="ino"||Ve=="data"||this[Ve]!==et[Ve]&&(Ve=="atimeMs"&&this.flags&Jo.NoAtime||(this[Ve]=et[Ve],W=!0)));return et.attributes&&(this.attributes=et.attributes,W=!0),W&&(this.ctimeMs=Date.now()),W}};return TF(S,"Inode"),(()=>{const et=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;_=[(e=sr).uint32.bind(e)],A=[(t=sr).uint32.bind(t)],j=[(n=sr).uint32.bind(n)],q=[(r=sr).uint16.bind(r)],D=[(s=sr).uint32.bind(s)],Y=[(i=sr).uint32.bind(i)],Z=[(a=sr).uint32.bind(a)],le=[(o=sr).float64.bind(o)],he=[(l=sr).float64.bind(l)],He=[(c=sr).float64.bind(c)],X=[(u=sr).float64.bind(u)],fe=[(d=sr).uint32.bind(d)],Pe=[(h=sr).uint32.bind(h)],ot=[(p=sr).uint32.bind(p)],Pt=[(g=sr).uint16.bind(g)],Ht=[(y=sr).uint32.bind(y)],ee=[sr.uint8(48)],ve=[Qw(ip)],Ls(null,null,_,{kind:"field",name:"data",static:!1,private:!1,access:{has:W=>"data"in W,get:W=>W.data,set:(W,Ve)=>{W.data=Ve}},metadata:et},k,T),Ls(null,null,A,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:W=>"__data_old"in W,get:W=>W.__data_old,set:(W,Ve)=>{W.__data_old=Ve}},metadata:et},R,M),Ls(null,null,j,{kind:"field",name:"size",static:!1,private:!1,access:{has:W=>"size"in W,get:W=>W.size,set:(W,Ve)=>{W.size=Ve}},metadata:et},F,P),Ls(null,null,q,{kind:"field",name:"mode",static:!1,private:!1,access:{has:W=>"mode"in W,get:W=>W.mode,set:(W,Ve)=>{W.mode=Ve}},metadata:et},I,V),Ls(null,null,D,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:W=>"nlink"in W,get:W=>W.nlink,set:(W,Ve)=>{W.nlink=Ve}},metadata:et},z,$),Ls(null,null,Y,{kind:"field",name:"uid",static:!1,private:!1,access:{has:W=>"uid"in W,get:W=>W.uid,set:(W,Ve)=>{W.uid=Ve}},metadata:et},B,G),Ls(null,null,Z,{kind:"field",name:"gid",static:!1,private:!1,access:{has:W=>"gid"in W,get:W=>W.gid,set:(W,Ve)=>{W.gid=Ve}},metadata:et},ne,ae),Ls(null,null,le,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:W=>"atimeMs"in W,get:W=>W.atimeMs,set:(W,Ve)=>{W.atimeMs=Ve}},metadata:et},Se,Ee),Ls(null,null,he,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:W=>"birthtimeMs"in W,get:W=>W.birthtimeMs,set:(W,Ve)=>{W.birthtimeMs=Ve}},metadata:et},pe,Le),Ls(null,null,He,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:W=>"mtimeMs"in W,get:W=>W.mtimeMs,set:(W,Ve)=>{W.mtimeMs=Ve}},metadata:et},Fe,Ie),Ls(null,null,X,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:W=>"ctimeMs"in W,get:W=>W.ctimeMs,set:(W,Ve)=>{W.ctimeMs=Ve}},metadata:et},ye,Ne),Ls(null,null,fe,{kind:"field",name:"ino",static:!1,private:!1,access:{has:W=>"ino"in W,get:W=>W.ino,set:(W,Ve)=>{W.ino=Ve}},metadata:et},ce,se),Ls(null,null,Pe,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:W=>"__ino_old"in W,get:W=>W.__ino_old,set:(W,Ve)=>{W.__ino_old=Ve}},metadata:et},Be,je),Ls(null,null,ot,{kind:"field",name:"flags",static:!1,private:!1,access:{has:W=>"flags"in W,get:W=>W.flags,set:(W,Ve)=>{W.flags=Ve}},metadata:et},Et,ut),Ls(null,null,Pt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:W=>"__after_flags"in W,get:W=>W.__after_flags,set:(W,Ve)=>{W.__after_flags=Ve}},metadata:et},$t,Ft),Ls(null,null,Ht,{kind:"field",name:"version",static:!1,private:!1,access:{has:W=>"version"in W,get:W=>W.version,set:(W,Ve)=>{W.version=Ve}},metadata:et},Ce,U),Ls(null,null,ee,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:W=>"__padding"in W,get:W=>W.__padding,set:(W,Ve)=>{W.__padding=Ve}},metadata:et},xe,Re),Ls(null,null,ve,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:W=>"attributes"in W,get:W=>W.attributes,set:(W,Ve)=>{W.attributes=Ve}},metadata:et},Me,de),Ls(null,x={value:S},v,{kind:"class",name:S.name,metadata:et},null,w),ht=S=x.value,et&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:et}),Qn(S,w)})(),ht=S})();function Nke(e){return(e.mode&Is)===Xc}function su(e){return(e.mode&Is)===Vi}function Yy(e){return(e.mode&Is)===Of}function Rke(e){return(e.mode&Is)===kg}function e1(e){return(e.mode&Is)===Eg}function t1(e){return(e.mode&Is)===Tg}function Ike(e){return(e.mode&Is)===Ag}function bs(e,t,n){const r=(e==null?void 0:e.credentials)||lu.credentials;if(Yy(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&SX&&(s|=ia),t.mode&_X&&(s|=bi),t.mode&CX&&(s|=V2)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&kX&&(s|=ia),t.mode&EX&&(s|=bi),t.mode&TX&&(s|=V2)),t.mode&AX&&(s|=ia),t.mode&NX&&(s|=bi),t.mode&RX&&(s|=V2),(s&n)===n}const J9=1;class Jk extends Map{constructor(){super(...arguments),this.maxSize=Mo}toJSON(){return{version:J9,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*Ks(zi);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Je.With("ENOENT",t);if((n.mode&Is)!=Vi)throw Je.With("ENOTDIR",t);const r={};for(const s of this.keys())rs(s)==t&&s!=t&&(r[Ky(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&Is)!=Vi)continue;const s={};for(const i of this.keys())rs(i)==n&&i!=n&&(s[Ky(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=J9)throw new Je(vt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=a4(1,Mo)),r=="/"&&(s.ino=0),this.set(r,new zi(s));return this}static parse(t){if(!F2e(t))throw new Je(vt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new Jk;return r.fromJSON(n),r}}const AM=4096;let AF=class c4{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===c4.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===c4.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=AM){const l=o+AM>a?a-o:AM,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function bo(e){return JSON.parse(bF(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Kl(e){return Rm(JSON.stringify(e))}function kp(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Je(vt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function Qk(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Je(vt.EINVAL,"Invalid time.")}}function Un(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Je(vt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Je(vt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Je(vt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Tf(e)}function gf(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:kp("mode"in e?e==null?void 0:e.mode:null,r)}}class Mke{constructor(t,n,r,s){ue(this,"id");ue(this,"_size");ue(this,"options");ue(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=Xw(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=Xw(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var NM,RM,IM;(NM=Promise.withResolvers)!==null&&NM!==void 0||(Promise.withResolvers=(Ja("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(RM=Symbol.dispose)!==null&&RM!==void 0||(Symbol.dispose=(Ja("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(IM=Symbol.asyncDispose)!==null&&IM!==void 0||(Symbol.asyncDispose=(Ja("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class PX{constructor(t){this.store=t}}class jke extends PX{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class u4 extends PX{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new Mke(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw Xo(Je.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Ja("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class Pke{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof u4))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof u4))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Ds=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Fs=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class OX extends AF{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=bX(t,s);if(a.startsWith(".."))continue;let o=ds(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Ja("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,hw(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ds(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,ja(a)),s.has(i)&&await r.set(a.data,Kl(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=Fs(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ds(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,ja(a)),s.has(i)&&r.setSync(a.data,Kl(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{Fs(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new Jk,s=Ds(n,this.transaction(),!0),i=[["/",0]],a=H9(Je.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new zi(await s.get(l));if(r.set(o,c),c.mode&Vi){const u=bo((t=await s.get(c.data))!==null&&t!==void 0?t:ks(Je.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([ds(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=Fs(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new Jk,s=Ds(n,this.transaction(),!1),i=[["/",0]],a=H9(Je.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new zi(s.getSync(l));if(r.set(o,c),c.mode&Vi){const u=bo((t=s.getSync(c.data))!==null&&t!==void 0?t:ks(Je.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([ds(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{Fs(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ds(a,this.transaction(),!0),l=Mu(t),c=Mu(n),u=await this.findInode(o,l.dir,"rename"),d=bo((r=await o.get(u.data))!==null&&r!==void 0?r:ks(Je.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Je.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&Xo(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Je(vt.EBUSY,l.dir);const p=c.dir==l.dir,g=p?u:await this.findInode(o,c.dir,"rename"),y=p?d:bo((s=await o.get(g.data))!==null&&s!==void 0?s:ks(Je.With("ENODATA",c.dir,"rename")));if(y[c.base]){const v=new zi((i=await o.get(y[c.base]))!==null&&i!==void 0?i:ks(Je.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Je.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(y[c.base])}y[c.base]=h,await o.set(u.data,Kl(d)),await o.set(g.data,Kl(y)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=Fs(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ds(a,this.transaction(),!1),l=Mu(t),c=Mu(n),u=this.findInodeSync(o,l.dir,"rename"),d=bo((r=o.getSync(u.data))!==null&&r!==void 0?r:ks(Je.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Je.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&Xo(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Je(vt.EBUSY,l.dir);const p=c.dir===l.dir,g=p?u:this.findInodeSync(o,c.dir,"rename"),y=p?d:bo((s=o.getSync(g.data))!==null&&s!==void 0?s:ks(Je.With("ENODATA",c.dir,"rename")));if(y[c.base]){const v=new zi((i=o.getSync(y[c.base]))!==null&&i!==void 0?i:ks(Je.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Je.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(y[c.base])}y[c.base]=h,o.setSync(u.data,Kl(d)),o.setSync(g.data,Kl(y)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{Fs(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ds(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=Fs(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Ds(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{Fs(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ds(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ja(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=Fs(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Ds(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ja(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{Fs(r)}}async createFile(t,n){return n.mode|=Xc,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Xc,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Je.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Je.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Vi,await this.commitNew(t,n,Rm("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Vi,this.commitNewSync(t,n,Rm("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ds(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(bo((n=await s.get(i.data))!==null&&n!==void 0?n:ks(Je.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=Fs(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Ds(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(bo((n=s.getSync(i.data))!==null&&n!==void 0?n:ks(Je.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{Fs(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ds(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,ja(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Fs(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Ds(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,ja(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Fs(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ds(s,this.transaction(),!0),a=rs(n),o=await this.findInode(i,a,"link"),l=bo((r=await i.get(o.data))!==null&&r!==void 0?r:ks(Je.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[Ky(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,ja(c)),await i.set(o.data,Kl(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=Fs(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Ds(s,this.transaction(),!1),a=rs(n),o=this.findInodeSync(i,a,"link"),l=bo((r=i.getSync(o.data))!==null&&r!==void 0?r:ks(Je.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[Ky(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,ja(c)),i.setSync(o.data,Kl(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{Fs(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ds(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:ks(Je.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&Xo(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=Fs(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Ds(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:ks(Je.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&Xo(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{Fs(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ds(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=Xw((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Fs(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Ds(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=Xw((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Fs(i)}}transaction(){return new Pke(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ds(t,this.transaction(),!0);if(await n.get(wl))return;const r=new zi({ino:wl,data:1,mode:511|Vi});await n.set(r.data,Rm("{}")),this._add(wl,"/"),await n.set(wl,ja(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=Fs(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Ds(t,this.transaction(),!1);if(n.getSync(wl))return;const r=new zi({ino:wl,data:1,mode:511|Vi});n.setSync(r.data,Rm("{}")),this._add(wl,"/"),n.setSync(wl,ja(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{Fs(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Ja("Attempted to populate tables after initialization");return}hw("Populating tables with existing store metadata");const n=Ds(t,this.transaction(),!0),r=await n.get(wl);if(!r){_F("Store does not have a root inode");const o=new zi({ino:wl,data:1,mode:511|Vi});await n.set(o.data,Rm("{}")),this._add(wl,"/"),await n.set(wl,ja(o)),await n.commit();return}if(r.length<Ks(zi)){eA("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",wl]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Ja("Store is missing data for inode: "+l);continue}if(c.length<Ks(zi)){Ja(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new zi(c);if((u.mode&Vi)!=Vi||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Ja("Store is missing directory data: "+u.data);continue}const h=bo(d);for(const[p,g]of Object.entries(h))a.push([ds(o,p),g])}hw(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=Fs(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Je.With("ENOENT",n,r);return new zi((s=await t.get(i))!==null&&s!==void 0?s:ks(Je.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Je.With("ENOENT",n,r);return new zi((s=t.getSync(i))!==null&&s!==void 0?s:ks(Je.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>Mo)throw Xo(new Je(vt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Je.With("EEXIST",t,s);const o=Ds(a,this.transaction(),!0),{dir:l,base:c}=Mu(t),u=await this.findInode(o,l,s),d=bo((i=await o.get(u.data))!==null&&i!==void 0?i:ks(Je.With("ENOENT",l,s)));if(d[c])throw Je.With("EEXIST",t,s);const h=this.allocNew(t,s),p=new zi({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(p.ino,ja(p)),await o.set(p.data,r),d[c]=p.ino,await o.set(u.data,Kl(d)),await o.commit(),p}catch(o){a.error=o,a.hasError=!0}finally{const o=Fs(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Je.With("EEXIST",t,s);const o=Ds(a,this.transaction(),!1),{dir:l,base:c}=Mu(t),u=this.findInodeSync(o,l,s),d=bo((i=o.getSync(u.data))!==null&&i!==void 0?i:ks(Je.With("ENOENT",l,s)));if(d[c])throw Je.With("EEXIST",t,s);const h=this.allocNew(t,s),p=new zi({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(p.ino,ja(p)),o.setSync(p.data,r),d[c]=p.ino,o.setSync(u.data,Kl(d)),o.commitSync(),p}catch(o){a.error=o,a.hasError=!0}finally{Fs(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ds(i,this.transaction(),!0),{dir:l,base:c}=Mu(t),u=await this.findInode(o,l,a),d=bo((r=await o.get(u.data))!==null&&r!==void 0?r:ks(Je.With("ENOENT",l,a)));if(!d[c])throw Je.With("ENOENT",t,a);const h=d[c],p=new zi((s=await o.get(h))!==null&&s!==void 0?s:ks(Je.With("ENOENT",t,a)));if(delete d[c],!n&&su(p))throw Je.With("EISDIR",t,a);await o.set(u.data,Kl(d)),p.nlink>1?(p.update({nlink:p.nlink-1}),await o.set(p.ino,ja(p))):(await o.remove(p.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=Fs(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Ds(i,this.transaction(),!1),{dir:l,base:c}=Mu(t),u=this.findInodeSync(o,l,a),d=bo((r=o.getSync(u.data))!==null&&r!==void 0?r:ks(Je.With("ENOENT",l,a))),h=d[c];if(!h)throw Je.With("ENOENT",t,a);const p=new zi((s=o.getSync(h))!==null&&s!==void 0?s:ks(Je.With("ENOENT",t,a)));if(delete d[c],!n&&su(p))throw Je.With("EISDIR",t,a);o.setSync(u.data,Kl(d)),p.nlink>1?(p.update({nlink:p.nlink-1}),o.setSync(p.ino,ja(p))):(o.removeSync(p.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{Fs(i)}}}class Oke extends jke{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class Dke extends Map{constructor(t=Mo,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new Oke(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const Fke={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new OX(new Dke(e,t));return n.checkRootSync(),n}},Lke=Fke;let aa=!0;class Q9 extends gF{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Yl(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Yl(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);$C(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);$C(this.output,0),Yl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Yl(this.output,-s.length,0),Yl(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Yl(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Yl(this.output,-this._cursor,0),Yl(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);$C(this.output,0),Yl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Yl(this.output,-r.length,0),Yl(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&($C(this.output,0),Yl(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Ja("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Ja("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function $ke(e,t,n,r){return"input"in e?new Q9(e.input,e.output,e.completer,e.terminal):new Q9(e,t,n,r)}function $C(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Yl(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class eE{get position(){return this.flag&ag?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&sA||this.inode.flags&Jo.Sync)}sync(){if(this.closed)throw Je.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Je.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Je.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Je.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Je.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Je.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&Xa||this.flag&mf))throw new Je(vt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Je.With("EBADF",this.path,"write");if(!(this.flag&Xa||this.flag&mf))throw new Je(vt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&Jo.Immutable)throw new Je(vt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!t1(this.inode)&&!e1(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Je.With("EBADF",this.path,"read");if(this.flag&Xa)throw new Je(vt.EPERM,"File not opened with a readable mode");this.inode.flags&Jo.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!t1(this.inode)&&!e1(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Je.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>Is?-61441:Is)|t,(this._isSync||t>Is)&&this.sync()}chown(t,n){if(this.closed)throw Je.With("EBADF",this.path,"chown");this.dirty=!0,jX(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Je.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Je.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Je.With("EBADF",this.path,"streamWrite");if(this.inode.flags&Jo.Immutable)throw new Je(vt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function tE(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:lu.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function co(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:lu.descriptors).get(t);if(!s)throw new Je(vt.EBADF);return s}function DX(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:lu.descriptors).delete(t)}const Bke=/[rwasx]{1,2}\+?/;function yf(e){if(typeof e=="number")return e;if(!Bke.test(e))throw new Je(vt.EINVAL,"Invalid flag string: "+e);return zke(e)}function zke(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Je(vt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?wX:tA;return e.includes("w")&&(t|=rA),e.includes("a")&&(t|=ag),e.includes("+")?t|=mf:e.includes("r")||(t|=Xa),e.includes("s")&&(t|=sA),e.includes("x")&&(t|=nA),t}function FX(e){let t=0;return e&Xa||(t|=ia),(e&Xa||e&mf)&&(t|=bi),t}const n1=new Map;NF("/",Lke.create({label:"root"}));function NF(e,t){if(e[0]!="/"&&(e="/"+e),e=Tf.call(this,e),n1.has(e))throw Xo(new Je(vt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,n1.set(e,t),vX(`Mounted ${t.name} on ${e}`),hw(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function LX(e){if(e[0]!="/"&&(e="/"+e),e=Tf.call(this,e),!n1.has(e)){Ja(e+" is already unmounted");return}n1.delete(e),_F("Unmounted "+e)}function Dr(e,t){const n=(t==null?void 0:t.root)||lu.root;e=Un(ds(n,e));const r=[...n1].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(qke(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw Q2e(new Je(vt.EIO,"No file system",e))}function MM(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function vs(e,t){typeof e.stack=="string"&&(e.stack=MM(e.stack,t));try{e.message=MM(e.message,t)}catch{}return e.path&&(e.path=MM(e.path,t)),e}function $X(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||Mo),files:(t?BigInt:Number)(n.totalNodes||Mo),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function Uke(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:lu;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Je(vt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=ds(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Je.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Je(vt.EPERM,"Can not chroot() outside of current root");l.root=c}function qke(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class BX extends gF{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Je.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Je.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Je.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Je.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Je.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class zX extends BX{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?ds(t.root,n):n,Wke(this.realpath,this)}close(){super.emit("close"),Hke(this.realpath,this)}[Symbol.dispose](){this.close()}}class Vke extends BX{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=ap(this.path);Cke(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=ap(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const Vh=new Map;function Wke(e,t){const n=Un(e);Vh.has(n)||Vh.set(n,new Set),Vh.get(n).add(t)}function Hke(e,t){const n=Un(e);Vh.has(n)&&(Vh.get(n).delete(t),Vh.get(n).size===0&&Vh.delete(n))}function $a(e,t,n){var r;e&&(n=ds((r=e.root)!==null&&r!==void 0?r:"/",n)),n=Un(n);for(let s=n;s!="/";s=rs(s)){const i=Vh.get(s);if(i)for(const a of i)a.emit("change",t,bX.call(a._context,s,n)||Ky(n))}}var SS=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},_S=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function Gke(e,t){e=Un(e),t=Un(t);const n=Dr(e,this),r=Dr(t,this);if(!ap.call(this,rs(e)).hasAccess(bi,this))throw Je.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),$a(this,"rename",e.toString()),$a(this,"change",t.toString());return}PF.call(this,t,jF(e)),MF.call(this,e),$a(this,"rename",e.toString())}catch(s){throw vs(s,{[n.path]:e,[r.path]:t})}}function RF(e){e=Un(e);try{const{fs:t,path:n}=Dr(Ep.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==vt.ENOENT)return!1;throw t}}function ap(e,t){e=Un(e);const{fs:n,path:r}=Dr(Ep.call(this,e),this);try{const s=n.statSync(r);if(aa&&!bs(this,s,ia))throw Je.With("EACCES",r,"stat");return t!=null&&t.bigint?new Ng(s):new Df(s)}catch(s){throw vs(s,{[r]:e})}}function IF(e,t){e=Un(e);const{fs:n,path:r}=Dr(e,this);try{const s=n.statSync(r);if(aa&&!bs(this,s,ia))throw Je.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Ng(s):new Df(s)}catch(s){throw vs(s,{[r]:e})}}function Kke(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=SS(n,Rg.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Je(vt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{_S(n)}}function MF(e){e=Un(e);const{fs:t,path:n}=Dr(e,this);try{if(aa&&!bs(this,t.statSync(n),bi))throw Je.With("EACCES",n,"unlink");t.unlinkSync(n),$a(this,"rename",e.toString())}catch(r){throw vs(r,{[n]:e})}}function Rg(e,t){var n;e=Un(e);const r=kp(t.mode,420),s=yf(t.flag);e=t.preserveSymlinks?e:Ep.call(this,e);const{fs:i,path:a}=Dr(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&tA))throw Je.With("ENOENT",e,"_open");const c=i.statSync(rs(a));if(!bs(this,c,bi))throw Je.With("EACCES",rs(e),"_open");if(!su(c))throw Je.With("ENOTDIR",rs(e),"_open");if(!t.allowDirectory&&r&Vi)throw Je.With("EISDIR",e,"_open");if(!bs(this,c,bi))throw Je.With("EACCES",rs(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:lu.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&xS?c.uid:u,gid:c.mode&wS?c.gid:d});return new eE(this,e,i,a,s,h)}if(!bs(this,o,r)||!bs(this,o,FX(s)))throw Je.With("EACCES",e,"_open");if(s&nA)throw Je.With("EEXIST",e,"_open");const l=new eE(this,e,i,a,s,o);if(s&rA&&l.truncate(0),!t.allowDirectory&&o.mode&Vi)throw Je.With("EISDIR",e,"_open");return l}function iA(e,t,n=kF){return tE(Rg.call(this,e,{flag:t,mode:n}))}function aA(e,t,n){return tE(Rg.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function UX(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=SS(r,typeof e=="number"?co(this,e):Rg.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{_S(r)}}function jF(e,t={}){const n=gf(t,null,"r",420);if(yf(n.flag)&Xa)throw new Je(vt.EINVAL,"Flag passed to readFile must allow for reading");const s=zs.from(UX.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function PF(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=gf(n,"utf8","w+",420),i=yf(s.flag);if(!(i&Xa||i&mf))throw new Je(vt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Je(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?zs.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Je(vt.EINVAL,"Data not specified");SS(r,typeof e=="number"?co(this,e):Rg.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),$a(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{_S(r)}}function Yke(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=gf(n,"utf8","a+",420),i=yf(s.flag);if(!(i&ag))throw new Je(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Je(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?zs.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);SS(r,Rg.call(this,typeof e=="number"?co(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{_S(r)}}function Zke(e,t){const n=co(this,e).stat();return t!=null&&t.bigint?new Ng(n):new Df(n)}function Ig(e){co(this,e).close(),DX(this,e)}function Xke(e,t=0){if(t||(t=0),t<0)throw new Je(vt.EINVAL);co(this,e).truncate(t)}function Jke(e){co(this,e).sync()}function Qke(e){co(this,e).datasync()}function eEe(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=zs.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=co(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return $a(this,"change",c.path),u}function tEe(e,t,n,r,s){const i=co(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function OF(e,t,n){co(this,e).chown(t,n)}function DF(e,t){const n=kp(t,-1);if(n<0)throw new Je(vt.EINVAL,"Invalid mode.");co(this,e).chmod(n)}function FF(e,t,n){co(this,e).utimes(Qk(t),Qk(n))}function qX(e){e=Un(e);const{fs:t,path:n}=Dr(Ep.call(this,e),this);try{const r=t.statSync(n);if(!su(r))throw Je.With("ENOTDIR",n,"rmdir");if(aa&&!bs(this,r,bi))throw Je.With("EACCES",n,"rmdir");t.rmdirSync(n),$a(this,"rename",e.toString())}catch(r){throw vs(r,{[n]:e})}}function LF(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:lu.credentials;t=typeof t=="object"?t:{mode:t};const a=kp(t==null?void 0:t.mode,511);e=Ep.call(this,e);const{fs:o,path:l,root:c}=Dr(e,this),u={[l]:e},d=(h,p)=>{if(!bs(this,p,bi))throw Je.With("EACCES",rs(h),"mkdir");const g=o.mkdirSync(h,{mode:a,uid:p.mode&xS?p.uid:s,gid:p.mode&wS?p.gid:i});return $a(this,"rename",h),g};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(rs(l)));return}const h=[];for(let g=l,y=e;!o.existsSync(g);g=rs(g),y=rs(y))h.unshift(g),u[g]=y;if(!h.length)return;const p=[o.statSync(rs(h[0]))];for(const[g,y]of h.entries())p.push(d(y,p[g]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw vs(h,u)}}function zb(e,t){t=typeof t=="object"?t:{encoding:t},e=Un(e);const{fs:n,path:r}=Dr(Ep.call(this,e),this);let s;try{const a=n.statSync(r);if(aa&&!bs(this,a,ia))throw Je.With("EACCES",r,"readdir");if(!su(a))throw Je.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw vs(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(ds(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new r1(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(zs.from(a)):i.push(a),!(!su(o)||!(t!=null&&t.recursive)))for(const l of zb.call(this,ds(e,a),t))l instanceof r1?(l.path=ds(a,l.path),i.push(l)):zs.isBuffer(l)?i.push(zs.from(ds(a,bF(l)))):i.push(ds(a,l))}return i}function nEe(e,t){if(e=Un(e),!ap(rs(e)).hasAccess(ia,this))throw Je.With("EACCES",rs(e),"link");if(t=Un(t),!ap(rs(t)).hasAccess(bi,this))throw Je.With("EACCES",rs(t),"link");const{fs:n,path:r}=Dr(e,this),s=Dr(t,this);if(n!=s.fs)throw Je.With("EXDEV",t,"link");try{if(aa&&!bs(this,n.statSync(r),ia))throw Je.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw vs(i,{[r]:e,[s.path]:t})}}function rEe(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Je(vt.EINVAL,"Invalid type: "+n);t=Un(t);const s=SS(r,Rg.call(this,t,{flag:"wx",mode:420}),!1);s.write(Rm(Un(e,!0))),s.chmod(Of)}catch(s){r.error=s,r.hasError=!0}finally{_S(r)}}function d4(e,t){const n=zs.from(UX.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function sEe(e,t,n){const r=iA.call(this,e,"r+");OF.call(this,r,t,n),Ig.call(this,r)}function iEe(e,t,n){const r=aA.call(this,e,"r+");OF.call(this,r,t,n),Ig.call(this,r)}function aEe(e,t){const n=iA.call(this,e,"r+");DF.call(this,n,t),Ig.call(this,n)}function oEe(e,t){const n=aA.call(this,e,"r+");DF.call(this,n,t),Ig.call(this,n)}function VX(e,t,n){const r=iA.call(this,e,"r+");FF.call(this,r,t,n),Ig.call(this,r)}function lEe(e,t,n){const r=aA.call(this,e,"r+");FF.call(this,r,t,n),Ig.call(this,r)}function f4(e,t,n){try{const l=Dr(t,e),c=l.fs.statSync(l.path);if(!Yy(c))return{...l,fullPath:t,stats:c};const u=Tf.call(e,rs(t),d4.call(e,t).toString());return f4(e,u)}catch{}const{base:r,dir:s}=Mu(t),i=s=="/"?"/":Ep.call(e,s),a=ds(i,r),o=Dr(a,e);try{const l=o.fs.statSync(o.path);if(!Yy(l))return{...o,fullPath:a,stats:l};const c=Tf.call(e,i,d4.call(e,a).toString());return f4(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw vs(l,{[o.path]:a})}}function Ep(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Un(e);const{fullPath:s}=f4(this,e);if(r=="utf8"||r=="utf-8")return s;const i=zs.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function cEe(e,t=384){if(!bs(this,ap.call(this,e),t))throw new Je(vt.EACCES)}function WX(e,t){e=Un(e);let n;try{n=IF.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&Is){case Vi:if(t!=null&&t.recursive)for(const r of zb.call(this,e))WX.call(this,ds(e,r),t);qX.call(this,e);break;case Xc:case Of:case Eg:case Tg:MF.call(this,e);break;case Ag:case kg:default:throw new Je(vt.EPERM,"File type not supported",e,"rm")}}function uEe(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return LF.call(this,s),n=="buffer"?zs.from(s):s}function HX(e,t,n){if(e=Un(e),t=Un(t),n&&n&EF&&RF(t))throw new Je(vt.EEXIST,"Destination file already exists",t,"copyFile");PF.call(this,t,jF(e)),$a(this,"rename",t.toString())}function dEe(e,t,n){const r=co(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function fEe(e,t,n){const r=co(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function hEe(e,t){return e=Un(e),new $F(e,this)}function GX(e,t,n){e=Un(e),t=Un(t);const r=IF.call(this,e);if(n!=null&&n.errorOnExist&&RF.call(this,t))throw new Je(vt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Is){case Vi:if(!(n!=null&&n.recursive))throw new Je(vt.EISDIR,e+" is a directory (not copied)",e,"cp");LF.call(this,t,{recursive:!0});for(const s of zb.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(ds(e,s.name),ds(t,s.name))||GX.call(this,ds(e,s.name),ds(t,s.name),n);break;case Xc:case Of:HX.call(this,e,t);break;case Eg:case Tg:case Ag:case kg:default:throw new Je(vt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&VX.call(this,t,r.atime,r.mtime)}function pEe(e,t){e=Un(e);const{fs:n}=Dr(e,this);return $X(n,t==null?void 0:t.bigint)}function mEe(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=zb(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(ap(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class r1{get name(){return Ky(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return Nke(this.stats)}isDirectory(){return su(this.stats)}isBlockDevice(){return e1(this.stats)}isCharacterDevice(){return t1(this.stats)}isSymbolicLink(){return Yy(this.stats)}isFIFO(){return Ike(this.stats)}isSocket(){return Rke(this.stats)}}class $F{checkClosed(){if(this.closed)throw new Je(vt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await jg.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=zb.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var jM={exports:{}},PM={exports:{}},OM={},e7;function Tp(){return e7||(e7=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=y;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=w.indexOf("=");_===-1&&(_=S);var k=_===S?0:4-_%4;return[_,k]}function u(w){var S=c(w),_=S[0],k=S[1];return(_+k)*3/4-k}function d(w,S,_){return(S+_)*3/4-_}function h(w){var S,_=c(w),k=_[0],T=_[1],A=new i(d(w,k,T)),R=0,M=T>0?k-4:k,j;for(j=0;j<M;j+=4)S=s[w.charCodeAt(j)]<<18|s[w.charCodeAt(j+1)]<<12|s[w.charCodeAt(j+2)]<<6|s[w.charCodeAt(j+3)],A[R++]=S>>16&255,A[R++]=S>>8&255,A[R++]=S&255;return T===2&&(S=s[w.charCodeAt(j)]<<2|s[w.charCodeAt(j+1)]>>4,A[R++]=S&255),T===1&&(S=s[w.charCodeAt(j)]<<10|s[w.charCodeAt(j+1)]<<4|s[w.charCodeAt(j+2)]>>2,A[R++]=S>>8&255,A[R++]=S&255),A}function p(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function g(w,S,_){for(var k,T=[],A=S;A<_;A+=3)k=(w[A]<<16&16711680)+(w[A+1]<<8&65280)+(w[A+2]&255),T.push(p(k));return T.join("")}function y(w){for(var S,_=w.length,k=_%3,T=[],A=16383,R=0,M=_-k;R<M;R+=A)T.push(g(w,R,R+A>M?M:R+A));return k===1?(S=w[_-1],T.push(r[S>>2]+r[S<<4&63]+"==")):k===2&&(S=(w[_-2]<<8)+w[_-1],T.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),T.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,S,_,k,T){var A,R,M=T*8-k-1,j=(1<<M)-1,F=j>>1,P=-7,q=_?T-1:0,I=_?-1:1,V=w[S+q];for(q+=I,A=V&(1<<-P)-1,V>>=-P,P+=M;P>0;A=A*256+w[S+q],q+=I,P-=8);for(R=A&(1<<-P)-1,A>>=-P,P+=k;P>0;R=R*256+w[S+q],q+=I,P-=8);if(A===0)A=1-F;else{if(A===j)return R?NaN:(V?-1:1)*(1/0);R=R+Math.pow(2,k),A=A-F}return(V?-1:1)*R*Math.pow(2,A-k)},v.write=function(w,S,_,k,T,A){var R,M,j,F=A*8-T-1,P=(1<<F)-1,q=P>>1,I=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,V=k?0:A-1,D=k?1:-1,z=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(M=isNaN(S)?1:0,R=P):(R=Math.floor(Math.log(S)/Math.LN2),S*(j=Math.pow(2,-R))<1&&(R--,j*=2),R+q>=1?S+=I/j:S+=I*Math.pow(2,1-q),S*j>=2&&(R++,j/=2),R+q>=P?(M=0,R=P):R+q>=1?(M=(S*j-1)*Math.pow(2,T),R=R+q):(M=S*Math.pow(2,q-1)*Math.pow(2,T),R=0));T>=8;w[_+V]=M&255,V+=D,M/=256,T-=8);for(R=R<<T|M,F+=T;F>0;w[_+V]=R&255,V+=D,R/=256,F-=8);w[_+V-D]|=z*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const S=n,_=v,k=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=P,w.SlowBuffer=ne,w.INSPECT_MAX_BYTES=50;const T=2147483647;w.kMaxLength=T;const{Uint8Array:A,ArrayBuffer:R,SharedArrayBuffer:M}=globalThis;P.TYPED_ARRAY_SUPPORT=j(),!P.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function j(){try{const Q=new A(1),J={foo:function(){return 42}};return Object.setPrototypeOf(J,A.prototype),Object.setPrototypeOf(Q,J),Q.foo()===42}catch{return!1}}Object.defineProperty(P.prototype,"parent",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.buffer}}),Object.defineProperty(P.prototype,"offset",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.byteOffset}});function F(Q){if(Q>T)throw new RangeError('The value "'+Q+'" is invalid for option "size"');const J=new A(Q);return Object.setPrototypeOf(J,P.prototype),J}function P(Q,J,te){if(typeof Q=="number"){if(typeof J=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return D(Q)}return q(Q,J,te)}P.poolSize=8192;function q(Q,J,te){if(typeof Q=="string")return z(Q,J);if(R.isView(Q))return Y(Q);if(Q==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Q);if(we(Q,R)||Q&&we(Q.buffer,R)||typeof M<"u"&&(we(Q,M)||Q&&we(Q.buffer,M)))return B(Q,J,te);if(typeof Q=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _e=Q.valueOf&&Q.valueOf();if(_e!=null&&_e!==Q)return P.from(_e,J,te);const $e=G(Q);if($e)return $e;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Q[Symbol.toPrimitive]=="function")return P.from(Q[Symbol.toPrimitive]("string"),J,te);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Q)}P.from=function(Q,J,te){return q(Q,J,te)},Object.setPrototypeOf(P.prototype,A.prototype),Object.setPrototypeOf(P,A);function I(Q){if(typeof Q!="number")throw new TypeError('"size" argument must be of type number');if(Q<0)throw new RangeError('The value "'+Q+'" is invalid for option "size"')}function V(Q,J,te){return I(Q),Q<=0?F(Q):J!==void 0?typeof te=="string"?F(Q).fill(J,te):F(Q).fill(J):F(Q)}P.alloc=function(Q,J,te){return V(Q,J,te)};function D(Q){return I(Q),F(Q<0?0:Z(Q)|0)}P.allocUnsafe=function(Q){return D(Q)},P.allocUnsafeSlow=function(Q){return D(Q)};function z(Q,J){if((typeof J!="string"||J==="")&&(J="utf8"),!P.isEncoding(J))throw new TypeError("Unknown encoding: "+J);const te=ae(Q,J)|0;let _e=F(te);const $e=_e.write(Q,J);return $e!==te&&(_e=_e.slice(0,$e)),_e}function $(Q){const J=Q.length<0?0:Z(Q.length)|0,te=F(J);for(let _e=0;_e<J;_e+=1)te[_e]=Q[_e]&255;return te}function Y(Q){if(we(Q,A)){const J=new A(Q);return B(J.buffer,J.byteOffset,J.byteLength)}return $(Q)}function B(Q,J,te){if(J<0||Q.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(Q.byteLength<J+(te||0))throw new RangeError('"length" is outside of buffer bounds');let _e;return J===void 0&&te===void 0?_e=new A(Q):te===void 0?_e=new A(Q,J):_e=new A(Q,J,te),Object.setPrototypeOf(_e,P.prototype),_e}function G(Q){if(P.isBuffer(Q)){const J=Z(Q.length)|0,te=F(J);return te.length===0||Q.copy(te,0,0,J),te}if(Q.length!==void 0)return typeof Q.length!="number"||Te(Q.length)?F(0):$(Q);if(Q.type==="Buffer"&&Array.isArray(Q.data))return $(Q.data)}function Z(Q){if(Q>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return Q|0}function ne(Q){return+Q!=Q&&(Q=0),P.alloc(+Q)}P.isBuffer=function(J){return J!=null&&J._isBuffer===!0&&J!==P.prototype},P.compare=function(J,te){if(we(J,A)&&(J=P.from(J,J.offset,J.byteLength)),we(te,A)&&(te=P.from(te,te.offset,te.byteLength)),!P.isBuffer(J)||!P.isBuffer(te))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(J===te)return 0;let _e=J.length,$e=te.length;for(let Ge=0,wt=Math.min(_e,$e);Ge<wt;++Ge)if(J[Ge]!==te[Ge]){_e=J[Ge],$e=te[Ge];break}return _e<$e?-1:$e<_e?1:0},P.isEncoding=function(J){switch(String(J).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},P.concat=function(J,te){if(!Array.isArray(J))throw new TypeError('"list" argument must be an Array of Buffers');if(J.length===0)return P.alloc(0);let _e;if(te===void 0)for(te=0,_e=0;_e<J.length;++_e)te+=J[_e].length;const $e=P.allocUnsafe(te);let Ge=0;for(_e=0;_e<J.length;++_e){let wt=J[_e];if(we(wt,A))Ge+wt.length>$e.length?(P.isBuffer(wt)||(wt=P.from(wt)),wt.copy($e,Ge)):A.prototype.set.call($e,wt,Ge);else if(P.isBuffer(wt))wt.copy($e,Ge);else throw new TypeError('"list" argument must be an Array of Buffers');Ge+=wt.length}return $e};function ae(Q,J){if(P.isBuffer(Q))return Q.length;if(R.isView(Q)||we(Q,R))return Q.byteLength;if(typeof Q!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Q);const te=Q.length,_e=arguments.length>2&&arguments[2]===!0;if(!_e&&te===0)return 0;let $e=!1;for(;;)switch(J){case"ascii":case"latin1":case"binary":return te;case"utf8":case"utf-8":return ht(Q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return te*2;case"hex":return te>>>1;case"base64":return Ve(Q).length;default:if($e)return _e?-1:ht(Q).length;J=(""+J).toLowerCase(),$e=!0}}P.byteLength=ae;function le(Q,J,te){let _e=!1;if((J===void 0||J<0)&&(J=0),J>this.length||((te===void 0||te>this.length)&&(te=this.length),te<=0)||(te>>>=0,J>>>=0,te<=J))return"";for(Q||(Q="utf8");;)switch(Q){case"hex":return Pe(this,J,te);case"utf8":case"utf-8":return ye(this,J,te);case"ascii":return ce(this,J,te);case"latin1":case"binary":return se(this,J,te);case"base64":return X(this,J,te);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,J,te);default:if(_e)throw new TypeError("Unknown encoding: "+Q);Q=(Q+"").toLowerCase(),_e=!0}}P.prototype._isBuffer=!0;function Se(Q,J,te){const _e=Q[J];Q[J]=Q[te],Q[te]=_e}P.prototype.swap16=function(){const J=this.length;if(J%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let te=0;te<J;te+=2)Se(this,te,te+1);return this},P.prototype.swap32=function(){const J=this.length;if(J%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let te=0;te<J;te+=4)Se(this,te,te+3),Se(this,te+1,te+2);return this},P.prototype.swap64=function(){const J=this.length;if(J%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let te=0;te<J;te+=8)Se(this,te,te+7),Se(this,te+1,te+6),Se(this,te+2,te+5),Se(this,te+3,te+4);return this},P.prototype.toString=function(){const J=this.length;return J===0?"":arguments.length===0?ye(this,0,J):le.apply(this,arguments)},P.prototype.toLocaleString=P.prototype.toString,P.prototype.equals=function(J){if(!P.isBuffer(J))throw new TypeError("Argument must be a Buffer");return this===J?!0:P.compare(this,J)===0},P.prototype.inspect=function(){let J="";const te=w.INSPECT_MAX_BYTES;return J=this.toString("hex",0,te).replace(/(.{2})/g,"$1 ").trim(),this.length>te&&(J+=" ... "),"<Buffer "+J+">"},k&&(P.prototype[k]=P.prototype.inspect),P.prototype.compare=function(J,te,_e,$e,Ge){if(we(J,A)&&(J=P.from(J,J.offset,J.byteLength)),!P.isBuffer(J))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof J);if(te===void 0&&(te=0),_e===void 0&&(_e=J?J.length:0),$e===void 0&&($e=0),Ge===void 0&&(Ge=this.length),te<0||_e>J.length||$e<0||Ge>this.length)throw new RangeError("out of range index");if($e>=Ge&&te>=_e)return 0;if($e>=Ge)return-1;if(te>=_e)return 1;if(te>>>=0,_e>>>=0,$e>>>=0,Ge>>>=0,this===J)return 0;let wt=Ge-$e,Jt=_e-te;const jn=Math.min(wt,Jt),Gt=this.slice($e,Ge),rn=J.slice(te,_e);for(let dn=0;dn<jn;++dn)if(Gt[dn]!==rn[dn]){wt=Gt[dn],Jt=rn[dn];break}return wt<Jt?-1:Jt<wt?1:0};function Ee(Q,J,te,_e,$e){if(Q.length===0)return-1;if(typeof te=="string"?(_e=te,te=0):te>2147483647?te=2147483647:te<-2147483648&&(te=-2147483648),te=+te,Te(te)&&(te=$e?0:Q.length-1),te<0&&(te=Q.length+te),te>=Q.length){if($e)return-1;te=Q.length-1}else if(te<0)if($e)te=0;else return-1;if(typeof J=="string"&&(J=P.from(J,_e)),P.isBuffer(J))return J.length===0?-1:he(Q,J,te,_e,$e);if(typeof J=="number")return J=J&255,typeof A.prototype.indexOf=="function"?$e?A.prototype.indexOf.call(Q,J,te):A.prototype.lastIndexOf.call(Q,J,te):he(Q,[J],te,_e,$e);throw new TypeError("val must be string, number or Buffer")}function he(Q,J,te,_e,$e){let Ge=1,wt=Q.length,Jt=J.length;if(_e!==void 0&&(_e=String(_e).toLowerCase(),_e==="ucs2"||_e==="ucs-2"||_e==="utf16le"||_e==="utf-16le")){if(Q.length<2||J.length<2)return-1;Ge=2,wt/=2,Jt/=2,te/=2}function jn(rn,dn){return Ge===1?rn[dn]:rn.readUInt16BE(dn*Ge)}let Gt;if($e){let rn=-1;for(Gt=te;Gt<wt;Gt++)if(jn(Q,Gt)===jn(J,rn===-1?0:Gt-rn)){if(rn===-1&&(rn=Gt),Gt-rn+1===Jt)return rn*Ge}else rn!==-1&&(Gt-=Gt-rn),rn=-1}else for(te+Jt>wt&&(te=wt-Jt),Gt=te;Gt>=0;Gt--){let rn=!0;for(let dn=0;dn<Jt;dn++)if(jn(Q,Gt+dn)!==jn(J,dn)){rn=!1;break}if(rn)return Gt}return-1}P.prototype.includes=function(J,te,_e){return this.indexOf(J,te,_e)!==-1},P.prototype.indexOf=function(J,te,_e){return Ee(this,J,te,_e,!0)},P.prototype.lastIndexOf=function(J,te,_e){return Ee(this,J,te,_e,!1)};function pe(Q,J,te,_e){te=Number(te)||0;const $e=Q.length-te;_e?(_e=Number(_e),_e>$e&&(_e=$e)):_e=$e;const Ge=J.length;_e>Ge/2&&(_e=Ge/2);let wt;for(wt=0;wt<_e;++wt){const Jt=parseInt(J.substr(wt*2,2),16);if(Te(Jt))return wt;Q[te+wt]=Jt}return wt}function Le(Q,J,te,_e){return tt(ht(J,Q.length-te),Q,te,_e)}function He(Q,J,te,_e){return tt(et(J),Q,te,_e)}function Fe(Q,J,te,_e){return tt(Ve(J),Q,te,_e)}function Ie(Q,J,te,_e){return tt(W(J,Q.length-te),Q,te,_e)}P.prototype.write=function(J,te,_e,$e){if(te===void 0)$e="utf8",_e=this.length,te=0;else if(_e===void 0&&typeof te=="string")$e=te,_e=this.length,te=0;else if(isFinite(te))te=te>>>0,isFinite(_e)?(_e=_e>>>0,$e===void 0&&($e="utf8")):($e=_e,_e=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ge=this.length-te;if((_e===void 0||_e>Ge)&&(_e=Ge),J.length>0&&(_e<0||te<0)||te>this.length)throw new RangeError("Attempt to write outside buffer bounds");$e||($e="utf8");let wt=!1;for(;;)switch($e){case"hex":return pe(this,J,te,_e);case"utf8":case"utf-8":return Le(this,J,te,_e);case"ascii":case"latin1":case"binary":return He(this,J,te,_e);case"base64":return Fe(this,J,te,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ie(this,J,te,_e);default:if(wt)throw new TypeError("Unknown encoding: "+$e);$e=(""+$e).toLowerCase(),wt=!0}},P.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(Q,J,te){return J===0&&te===Q.length?S.fromByteArray(Q):S.fromByteArray(Q.slice(J,te))}function ye(Q,J,te){te=Math.min(Q.length,te);const _e=[];let $e=J;for(;$e<te;){const Ge=Q[$e];let wt=null,Jt=Ge>239?4:Ge>223?3:Ge>191?2:1;if($e+Jt<=te){let jn,Gt,rn,dn;switch(Jt){case 1:Ge<128&&(wt=Ge);break;case 2:jn=Q[$e+1],(jn&192)===128&&(dn=(Ge&31)<<6|jn&63,dn>127&&(wt=dn));break;case 3:jn=Q[$e+1],Gt=Q[$e+2],(jn&192)===128&&(Gt&192)===128&&(dn=(Ge&15)<<12|(jn&63)<<6|Gt&63,dn>2047&&(dn<55296||dn>57343)&&(wt=dn));break;case 4:jn=Q[$e+1],Gt=Q[$e+2],rn=Q[$e+3],(jn&192)===128&&(Gt&192)===128&&(rn&192)===128&&(dn=(Ge&15)<<18|(jn&63)<<12|(Gt&63)<<6|rn&63,dn>65535&&dn<1114112&&(wt=dn))}}wt===null?(wt=65533,Jt=1):wt>65535&&(wt-=65536,_e.push(wt>>>10&1023|55296),wt=56320|wt&1023),_e.push(wt),$e+=Jt}return fe(_e)}const Ne=4096;function fe(Q){const J=Q.length;if(J<=Ne)return String.fromCharCode.apply(String,Q);let te="",_e=0;for(;_e<J;)te+=String.fromCharCode.apply(String,Q.slice(_e,_e+=Ne));return te}function ce(Q,J,te){let _e="";te=Math.min(Q.length,te);for(let $e=J;$e<te;++$e)_e+=String.fromCharCode(Q[$e]&127);return _e}function se(Q,J,te){let _e="";te=Math.min(Q.length,te);for(let $e=J;$e<te;++$e)_e+=String.fromCharCode(Q[$e]);return _e}function Pe(Q,J,te){const _e=Q.length;(!J||J<0)&&(J=0),(!te||te<0||te>_e)&&(te=_e);let $e="";for(let Ge=J;Ge<te;++Ge)$e+=Ue[Q[Ge]];return $e}function Be(Q,J,te){const _e=Q.slice(J,te);let $e="";for(let Ge=0;Ge<_e.length-1;Ge+=2)$e+=String.fromCharCode(_e[Ge]+_e[Ge+1]*256);return $e}P.prototype.slice=function(J,te){const _e=this.length;J=~~J,te=te===void 0?_e:~~te,J<0?(J+=_e,J<0&&(J=0)):J>_e&&(J=_e),te<0?(te+=_e,te<0&&(te=0)):te>_e&&(te=_e),te<J&&(te=J);const $e=this.subarray(J,te);return Object.setPrototypeOf($e,P.prototype),$e};function je(Q,J,te){if(Q%1!==0||Q<0)throw new RangeError("offset is not uint");if(Q+J>te)throw new RangeError("Trying to access beyond buffer length")}P.prototype.readUintLE=P.prototype.readUIntLE=function(J,te,_e){J=J>>>0,te=te>>>0,_e||je(J,te,this.length);let $e=this[J],Ge=1,wt=0;for(;++wt<te&&(Ge*=256);)$e+=this[J+wt]*Ge;return $e},P.prototype.readUintBE=P.prototype.readUIntBE=function(J,te,_e){J=J>>>0,te=te>>>0,_e||je(J,te,this.length);let $e=this[J+--te],Ge=1;for(;te>0&&(Ge*=256);)$e+=this[J+--te]*Ge;return $e},P.prototype.readUint8=P.prototype.readUInt8=function(J,te){return J=J>>>0,te||je(J,1,this.length),this[J]},P.prototype.readUint16LE=P.prototype.readUInt16LE=function(J,te){return J=J>>>0,te||je(J,2,this.length),this[J]|this[J+1]<<8},P.prototype.readUint16BE=P.prototype.readUInt16BE=function(J,te){return J=J>>>0,te||je(J,2,this.length),this[J]<<8|this[J+1]},P.prototype.readUint32LE=P.prototype.readUInt32LE=function(J,te){return J=J>>>0,te||je(J,4,this.length),(this[J]|this[J+1]<<8|this[J+2]<<16)+this[J+3]*16777216},P.prototype.readUint32BE=P.prototype.readUInt32BE=function(J,te){return J=J>>>0,te||je(J,4,this.length),this[J]*16777216+(this[J+1]<<16|this[J+2]<<8|this[J+3])},P.prototype.readBigUInt64LE=Ct(function(J){J=J>>>0,Re(J,"offset");const te=this[J],_e=this[J+7];(te===void 0||_e===void 0)&&ve(J,this.length-8);const $e=te+this[++J]*2**8+this[++J]*2**16+this[++J]*2**24,Ge=this[++J]+this[++J]*2**8+this[++J]*2**16+_e*2**24;return BigInt($e)+(BigInt(Ge)<<BigInt(32))}),P.prototype.readBigUInt64BE=Ct(function(J){J=J>>>0,Re(J,"offset");const te=this[J],_e=this[J+7];(te===void 0||_e===void 0)&&ve(J,this.length-8);const $e=te*2**24+this[++J]*2**16+this[++J]*2**8+this[++J],Ge=this[++J]*2**24+this[++J]*2**16+this[++J]*2**8+_e;return(BigInt($e)<<BigInt(32))+BigInt(Ge)}),P.prototype.readIntLE=function(J,te,_e){J=J>>>0,te=te>>>0,_e||je(J,te,this.length);let $e=this[J],Ge=1,wt=0;for(;++wt<te&&(Ge*=256);)$e+=this[J+wt]*Ge;return Ge*=128,$e>=Ge&&($e-=Math.pow(2,8*te)),$e},P.prototype.readIntBE=function(J,te,_e){J=J>>>0,te=te>>>0,_e||je(J,te,this.length);let $e=te,Ge=1,wt=this[J+--$e];for(;$e>0&&(Ge*=256);)wt+=this[J+--$e]*Ge;return Ge*=128,wt>=Ge&&(wt-=Math.pow(2,8*te)),wt},P.prototype.readInt8=function(J,te){return J=J>>>0,te||je(J,1,this.length),this[J]&128?(255-this[J]+1)*-1:this[J]},P.prototype.readInt16LE=function(J,te){J=J>>>0,te||je(J,2,this.length);const _e=this[J]|this[J+1]<<8;return _e&32768?_e|4294901760:_e},P.prototype.readInt16BE=function(J,te){J=J>>>0,te||je(J,2,this.length);const _e=this[J+1]|this[J]<<8;return _e&32768?_e|4294901760:_e},P.prototype.readInt32LE=function(J,te){return J=J>>>0,te||je(J,4,this.length),this[J]|this[J+1]<<8|this[J+2]<<16|this[J+3]<<24},P.prototype.readInt32BE=function(J,te){return J=J>>>0,te||je(J,4,this.length),this[J]<<24|this[J+1]<<16|this[J+2]<<8|this[J+3]},P.prototype.readBigInt64LE=Ct(function(J){J=J>>>0,Re(J,"offset");const te=this[J],_e=this[J+7];(te===void 0||_e===void 0)&&ve(J,this.length-8);const $e=this[J+4]+this[J+5]*2**8+this[J+6]*2**16+(_e<<24);return(BigInt($e)<<BigInt(32))+BigInt(te+this[++J]*2**8+this[++J]*2**16+this[++J]*2**24)}),P.prototype.readBigInt64BE=Ct(function(J){J=J>>>0,Re(J,"offset");const te=this[J],_e=this[J+7];(te===void 0||_e===void 0)&&ve(J,this.length-8);const $e=(te<<24)+this[++J]*2**16+this[++J]*2**8+this[++J];return(BigInt($e)<<BigInt(32))+BigInt(this[++J]*2**24+this[++J]*2**16+this[++J]*2**8+_e)}),P.prototype.readFloatLE=function(J,te){return J=J>>>0,te||je(J,4,this.length),_.read(this,J,!0,23,4)},P.prototype.readFloatBE=function(J,te){return J=J>>>0,te||je(J,4,this.length),_.read(this,J,!1,23,4)},P.prototype.readDoubleLE=function(J,te){return J=J>>>0,te||je(J,8,this.length),_.read(this,J,!0,52,8)},P.prototype.readDoubleBE=function(J,te){return J=J>>>0,te||je(J,8,this.length),_.read(this,J,!1,52,8)};function ot(Q,J,te,_e,$e,Ge){if(!P.isBuffer(Q))throw new TypeError('"buffer" argument must be a Buffer instance');if(J>$e||J<Ge)throw new RangeError('"value" argument is out of bounds');if(te+_e>Q.length)throw new RangeError("Index out of range")}P.prototype.writeUintLE=P.prototype.writeUIntLE=function(J,te,_e,$e){if(J=+J,te=te>>>0,_e=_e>>>0,!$e){const Jt=Math.pow(2,8*_e)-1;ot(this,J,te,_e,Jt,0)}let Ge=1,wt=0;for(this[te]=J&255;++wt<_e&&(Ge*=256);)this[te+wt]=J/Ge&255;return te+_e},P.prototype.writeUintBE=P.prototype.writeUIntBE=function(J,te,_e,$e){if(J=+J,te=te>>>0,_e=_e>>>0,!$e){const Jt=Math.pow(2,8*_e)-1;ot(this,J,te,_e,Jt,0)}let Ge=_e-1,wt=1;for(this[te+Ge]=J&255;--Ge>=0&&(wt*=256);)this[te+Ge]=J/wt&255;return te+_e},P.prototype.writeUint8=P.prototype.writeUInt8=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,1,255,0),this[te]=J&255,te+1},P.prototype.writeUint16LE=P.prototype.writeUInt16LE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,2,65535,0),this[te]=J&255,this[te+1]=J>>>8,te+2},P.prototype.writeUint16BE=P.prototype.writeUInt16BE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,2,65535,0),this[te]=J>>>8,this[te+1]=J&255,te+2},P.prototype.writeUint32LE=P.prototype.writeUInt32LE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,4,4294967295,0),this[te+3]=J>>>24,this[te+2]=J>>>16,this[te+1]=J>>>8,this[te]=J&255,te+4},P.prototype.writeUint32BE=P.prototype.writeUInt32BE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,4,4294967295,0),this[te]=J>>>24,this[te+1]=J>>>16,this[te+2]=J>>>8,this[te+3]=J&255,te+4};function Et(Q,J,te,_e,$e){xe(J,_e,$e,Q,te,7);let Ge=Number(J&BigInt(4294967295));Q[te++]=Ge,Ge=Ge>>8,Q[te++]=Ge,Ge=Ge>>8,Q[te++]=Ge,Ge=Ge>>8,Q[te++]=Ge;let wt=Number(J>>BigInt(32)&BigInt(4294967295));return Q[te++]=wt,wt=wt>>8,Q[te++]=wt,wt=wt>>8,Q[te++]=wt,wt=wt>>8,Q[te++]=wt,te}function ut(Q,J,te,_e,$e){xe(J,_e,$e,Q,te,7);let Ge=Number(J&BigInt(4294967295));Q[te+7]=Ge,Ge=Ge>>8,Q[te+6]=Ge,Ge=Ge>>8,Q[te+5]=Ge,Ge=Ge>>8,Q[te+4]=Ge;let wt=Number(J>>BigInt(32)&BigInt(4294967295));return Q[te+3]=wt,wt=wt>>8,Q[te+2]=wt,wt=wt>>8,Q[te+1]=wt,wt=wt>>8,Q[te]=wt,te+8}P.prototype.writeBigUInt64LE=Ct(function(J,te=0){return Et(this,J,te,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeBigUInt64BE=Ct(function(J,te=0){return ut(this,J,te,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeIntLE=function(J,te,_e,$e){if(J=+J,te=te>>>0,!$e){const jn=Math.pow(2,8*_e-1);ot(this,J,te,_e,jn-1,-jn)}let Ge=0,wt=1,Jt=0;for(this[te]=J&255;++Ge<_e&&(wt*=256);)J<0&&Jt===0&&this[te+Ge-1]!==0&&(Jt=1),this[te+Ge]=(J/wt>>0)-Jt&255;return te+_e},P.prototype.writeIntBE=function(J,te,_e,$e){if(J=+J,te=te>>>0,!$e){const jn=Math.pow(2,8*_e-1);ot(this,J,te,_e,jn-1,-jn)}let Ge=_e-1,wt=1,Jt=0;for(this[te+Ge]=J&255;--Ge>=0&&(wt*=256);)J<0&&Jt===0&&this[te+Ge+1]!==0&&(Jt=1),this[te+Ge]=(J/wt>>0)-Jt&255;return te+_e},P.prototype.writeInt8=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,1,127,-128),J<0&&(J=255+J+1),this[te]=J&255,te+1},P.prototype.writeInt16LE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,2,32767,-32768),this[te]=J&255,this[te+1]=J>>>8,te+2},P.prototype.writeInt16BE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,2,32767,-32768),this[te]=J>>>8,this[te+1]=J&255,te+2},P.prototype.writeInt32LE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,4,2147483647,-2147483648),this[te]=J&255,this[te+1]=J>>>8,this[te+2]=J>>>16,this[te+3]=J>>>24,te+4},P.prototype.writeInt32BE=function(J,te,_e){return J=+J,te=te>>>0,_e||ot(this,J,te,4,2147483647,-2147483648),J<0&&(J=4294967295+J+1),this[te]=J>>>24,this[te+1]=J>>>16,this[te+2]=J>>>8,this[te+3]=J&255,te+4},P.prototype.writeBigInt64LE=Ct(function(J,te=0){return Et(this,J,te,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),P.prototype.writeBigInt64BE=Ct(function(J,te=0){return ut(this,J,te,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pt(Q,J,te,_e,$e,Ge){if(te+_e>Q.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("Index out of range")}function $t(Q,J,te,_e,$e){return J=+J,te=te>>>0,$e||Pt(Q,J,te,4),_.write(Q,J,te,_e,23,4),te+4}P.prototype.writeFloatLE=function(J,te,_e){return $t(this,J,te,!0,_e)},P.prototype.writeFloatBE=function(J,te,_e){return $t(this,J,te,!1,_e)};function Ft(Q,J,te,_e,$e){return J=+J,te=te>>>0,$e||Pt(Q,J,te,8),_.write(Q,J,te,_e,52,8),te+8}P.prototype.writeDoubleLE=function(J,te,_e){return Ft(this,J,te,!0,_e)},P.prototype.writeDoubleBE=function(J,te,_e){return Ft(this,J,te,!1,_e)},P.prototype.copy=function(J,te,_e,$e){if(!P.isBuffer(J))throw new TypeError("argument should be a Buffer");if(_e||(_e=0),!$e&&$e!==0&&($e=this.length),te>=J.length&&(te=J.length),te||(te=0),$e>0&&$e<_e&&($e=_e),$e===_e||J.length===0||this.length===0)return 0;if(te<0)throw new RangeError("targetStart out of bounds");if(_e<0||_e>=this.length)throw new RangeError("Index out of range");if($e<0)throw new RangeError("sourceEnd out of bounds");$e>this.length&&($e=this.length),J.length-te<$e-_e&&($e=J.length-te+_e);const Ge=$e-_e;return this===J&&typeof A.prototype.copyWithin=="function"?this.copyWithin(te,_e,$e):A.prototype.set.call(J,this.subarray(_e,$e),te),Ge},P.prototype.fill=function(J,te,_e,$e){if(typeof J=="string"){if(typeof te=="string"?($e=te,te=0,_e=this.length):typeof _e=="string"&&($e=_e,_e=this.length),$e!==void 0&&typeof $e!="string")throw new TypeError("encoding must be a string");if(typeof $e=="string"&&!P.isEncoding($e))throw new TypeError("Unknown encoding: "+$e);if(J.length===1){const wt=J.charCodeAt(0);($e==="utf8"&&wt<128||$e==="latin1")&&(J=wt)}}else typeof J=="number"?J=J&255:typeof J=="boolean"&&(J=Number(J));if(te<0||this.length<te||this.length<_e)throw new RangeError("Out of range index");if(_e<=te)return this;te=te>>>0,_e=_e===void 0?this.length:_e>>>0,J||(J=0);let Ge;if(typeof J=="number")for(Ge=te;Ge<_e;++Ge)this[Ge]=J;else{const wt=P.isBuffer(J)?J:P.from(J,$e),Jt=wt.length;if(Jt===0)throw new TypeError('The value "'+J+'" is invalid for argument "value"');for(Ge=0;Ge<_e-te;++Ge)this[Ge+te]=wt[Ge%Jt]}return this};const Ht={};function Ce(Q,J,te){Ht[Q]=class extends te{constructor(){super(),Object.defineProperty(this,"message",{value:J.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Q}]`,this.stack,delete this.name}get code(){return Q}set code($e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:$e,writable:!0})}toString(){return`${this.name} [${Q}]: ${this.message}`}}}Ce("ERR_BUFFER_OUT_OF_BOUNDS",function(Q){return Q?`${Q} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ce("ERR_INVALID_ARG_TYPE",function(Q,J){return`The "${Q}" argument must be of type number. Received type ${typeof J}`},TypeError),Ce("ERR_OUT_OF_RANGE",function(Q,J,te){let _e=`The value of "${Q}" is out of range.`,$e=te;return Number.isInteger(te)&&Math.abs(te)>2**32?$e=U(String(te)):typeof te=="bigint"&&($e=String(te),(te>BigInt(2)**BigInt(32)||te<-(BigInt(2)**BigInt(32)))&&($e=U($e)),$e+="n"),_e+=` It must be ${J}. Received ${$e}`,_e},RangeError);function U(Q){let J="",te=Q.length;const _e=Q[0]==="-"?1:0;for(;te>=_e+4;te-=3)J=`_${Q.slice(te-3,te)}${J}`;return`${Q.slice(0,te)}${J}`}function ee(Q,J,te){Re(J,"offset"),(Q[J]===void 0||Q[J+te]===void 0)&&ve(J,Q.length-(te+1))}function xe(Q,J,te,_e,$e,Ge){if(Q>te||Q<J){const wt=typeof J=="bigint"?"n":"";let Jt;throw J===0||J===BigInt(0)?Jt=`>= 0${wt} and < 2${wt} ** ${(Ge+1)*8}${wt}`:Jt=`>= -(2${wt} ** ${(Ge+1)*8-1}${wt}) and < 2 ** ${(Ge+1)*8-1}${wt}`,new Ht.ERR_OUT_OF_RANGE("value",Jt,Q)}ee(_e,$e,Ge)}function Re(Q,J){if(typeof Q!="number")throw new Ht.ERR_INVALID_ARG_TYPE(J,"number",Q)}function ve(Q,J,te){throw Math.floor(Q)!==Q?(Re(Q,te),new Ht.ERR_OUT_OF_RANGE("offset","an integer",Q)):J<0?new Ht.ERR_BUFFER_OUT_OF_BOUNDS:new Ht.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${J}`,Q)}const Me=/[^+/0-9A-Za-z-_]/g;function de(Q){if(Q=Q.split("=")[0],Q=Q.trim().replace(Me,""),Q.length<2)return"";for(;Q.length%4!==0;)Q=Q+"=";return Q}function ht(Q,J){J=J||1/0;let te;const _e=Q.length;let $e=null;const Ge=[];for(let wt=0;wt<_e;++wt){if(te=Q.charCodeAt(wt),te>55295&&te<57344){if(!$e){if(te>56319){(J-=3)>-1&&Ge.push(239,191,189);continue}else if(wt+1===_e){(J-=3)>-1&&Ge.push(239,191,189);continue}$e=te;continue}if(te<56320){(J-=3)>-1&&Ge.push(239,191,189),$e=te;continue}te=($e-55296<<10|te-56320)+65536}else $e&&(J-=3)>-1&&Ge.push(239,191,189);if($e=null,te<128){if((J-=1)<0)break;Ge.push(te)}else if(te<2048){if((J-=2)<0)break;Ge.push(te>>6|192,te&63|128)}else if(te<65536){if((J-=3)<0)break;Ge.push(te>>12|224,te>>6&63|128,te&63|128)}else if(te<1114112){if((J-=4)<0)break;Ge.push(te>>18|240,te>>12&63|128,te>>6&63|128,te&63|128)}else throw new Error("Invalid code point")}return Ge}function et(Q){const J=[];for(let te=0;te<Q.length;++te)J.push(Q.charCodeAt(te)&255);return J}function W(Q,J){let te,_e,$e;const Ge=[];for(let wt=0;wt<Q.length&&!((J-=2)<0);++wt)te=Q.charCodeAt(wt),_e=te>>8,$e=te%256,Ge.push($e),Ge.push(_e);return Ge}function Ve(Q){return S.toByteArray(de(Q))}function tt(Q,J,te,_e){let $e;for($e=0;$e<_e&&!($e+te>=J.length||$e>=Q.length);++$e)J[$e+te]=Q[$e];return $e}function we(Q,J){return Q instanceof J||Q!=null&&Q.constructor!=null&&Q.constructor.name!=null&&Q.constructor.name===J.name}function Te(Q){return Q!==Q}const Ue=function(){const Q="0123456789abcdef",J=new Array(256);for(let te=0;te<16;++te){const _e=te*16;for(let $e=0;$e<16;++$e)J[_e+$e]=Q[te]+Q[$e]}return J}();function Ct(Q){return typeof BigInt>"u"?me:Q}function me(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(OM)),OM}var DM,t7;function ci(){if(t7)return DM;t7=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return DM={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},DM}var FM={exports:{}},LM,n7;function KX(){return n7||(n7=1,LM={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),LM}var $M,r7;function Lo(){if(r7)return $M;r7=1;const{format:e,inspect:t}=KX(),{AggregateError:n}=ci(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const S=v[0]==="-"?1:0;for(;w>=S+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const S=(x.match(/%[dfijoOs]/g)||[]).length;return c(S===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${S}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class S extends w{constructor(...k){super(d(v,x,k))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=v,S.prototype[s]=!0,l[v]=S}function p(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function g(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class y extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let S="The ";v.endsWith(" argument")?S+=`${v} `:S+=`"${v}" ${v.includes(".")?"property":"argument"} `,S+="must be ";const _=[],k=[],T=[];for(const R of x)c(typeof R=="string","All expected entries have to be of type string"),i.includes(R)?_.push(R.toLowerCase()):a.test(R)?k.push(R):(c(R!=="object",'The value "object" should be written as "Object"'),T.push(R));if(k.length>0){const R=_.indexOf("object");R!==-1&&(_.splice(_,R,1),k.push("Object"))}if(_.length>0){switch(_.length){case 1:S+=`of type ${_[0]}`;break;case 2:S+=`one of type ${_[0]} or ${_[1]}`;break;default:{const R=_.pop();S+=`one of type ${_.join(", ")}, or ${R}`}}(k.length>0||T.length>0)&&(S+=" or ")}if(k.length>0){switch(k.length){case 1:S+=`an instance of ${k[0]}`;break;case 2:S+=`an instance of ${k[0]} or ${k[1]}`;break;default:{const R=k.pop();S+=`an instance of ${k.join(", ")}, or ${R}`}}T.length>0&&(S+=" or ")}switch(T.length){case 0:break;case 1:T[0].toLowerCase()!==T[0]&&(S+="an "),S+=`${T[0]}`;break;case 2:S+=`one of ${T[0]} or ${T[1]}`;break;default:{const R=T.pop();S+=`one of ${T.join(", ")}, or ${R}`}}if(w==null)S+=`. Received ${w}`;else if(typeof w=="function"&&w.name)S+=`. Received function ${w.name}`;else if(typeof w=="object"){var A;if((A=w.constructor)!==null&&A!==void 0&&A.name)S+=`. Received an instance of ${w.constructor.name}`;else{const R=t(w,{depth:-1});S+=`. Received ${R}`}}else{let R=t(w,{colors:!1});R.length>25&&(R=`${R.slice(0,25)}...`),S+=`. Received type ${typeof w} (${R})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let S=t(x);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var S;const _=w!=null&&(S=w.constructor)!==null&&S!==void 0&&S.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${_}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(S=>`"${S}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const S=v.pop();x+=`The ${v.join(", ")}, and ${S} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let S;if(Number.isInteger(w)&&Math.abs(w)>2**32)S=u(String(w));else if(typeof w=="bigint"){S=String(w);const _=BigInt(2)**BigInt(32);(w>_||w<-_)&&(S=u(S)),S+="n"}else S=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),$M={AbortError:y,aggregateTwoErrors:p(g),hideStackFrames:p,codes:l},$M}var Sx={exports:{}},s7;function s1(){if(s7)return Sx.exports;s7=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Sx.exports=e,Sx.exports.AbortSignal=t,Sx.exports.default=e,Sx.exports}var BC={exports:{}},i7;function oA(){if(i7)return BC.exports;i7=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(k,T,A){return Function.prototype.apply.call(k,T,A)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))}:n=function(k){return Object.getOwnPropertyNames(k)};function r(_){console&&console.warn&&console.warn(_)}var s=Number.isNaN||function(k){return k!==k};function i(){i.init.call(this)}BC.exports=i,BC.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(_){if(typeof _!="number"||_<0||s(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");a=_}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this};function l(_){return _._maxListeners===void 0?i.defaultMaxListeners:_._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(k){for(var T=[],A=1;A<arguments.length;A++)T.push(arguments[A]);var R=k==="error",M=this._events;if(M!==void 0)R=R&&M.error===void 0;else if(!R)return!1;if(R){var j;if(T.length>0&&(j=T[0]),j instanceof Error)throw j;var F=new Error("Unhandled error."+(j?" ("+j.message+")":""));throw F.context=j,F}var P=M[k];if(P===void 0)return!1;if(typeof P=="function")t(P,this,T);else for(var q=P.length,I=g(P,q),A=0;A<q;++A)t(I[A],this,T);return!0};function c(_,k,T,A){var R,M,j;if(o(T),M=_._events,M===void 0?(M=_._events=Object.create(null),_._eventsCount=0):(M.newListener!==void 0&&(_.emit("newListener",k,T.listener?T.listener:T),M=_._events),j=M[k]),j===void 0)j=M[k]=T,++_._eventsCount;else if(typeof j=="function"?j=M[k]=A?[T,j]:[j,T]:A?j.unshift(T):j.push(T),R=l(_),R>0&&j.length>R&&!j.warned){j.warned=!0;var F=new Error("Possible EventEmitter memory leak detected. "+j.length+" "+String(k)+" listeners added. Use emitter.setMaxListeners() to increase limit");F.name="MaxListenersExceededWarning",F.emitter=_,F.type=k,F.count=j.length,r(F)}return _}i.prototype.addListener=function(k,T){return c(this,k,T,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(k,T){return c(this,k,T,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(_,k,T){var A={fired:!1,wrapFn:void 0,target:_,type:k,listener:T},R=u.bind(A);return R.listener=T,A.wrapFn=R,R}i.prototype.once=function(k,T){return o(T),this.on(k,d(this,k,T)),this},i.prototype.prependOnceListener=function(k,T){return o(T),this.prependListener(k,d(this,k,T)),this},i.prototype.removeListener=function(k,T){var A,R,M,j,F;if(o(T),R=this._events,R===void 0)return this;if(A=R[k],A===void 0)return this;if(A===T||A.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete R[k],R.removeListener&&this.emit("removeListener",k,A.listener||T));else if(typeof A!="function"){for(M=-1,j=A.length-1;j>=0;j--)if(A[j]===T||A[j].listener===T){F=A[j].listener,M=j;break}if(M<0)return this;M===0?A.shift():y(A,M),A.length===1&&(R[k]=A[0]),R.removeListener!==void 0&&this.emit("removeListener",k,F||T)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(k){var T,A,R;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[k]),this;if(arguments.length===0){var M=Object.keys(A),j;for(R=0;R<M.length;++R)j=M[R],j!=="removeListener"&&this.removeAllListeners(j);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=A[k],typeof T=="function")this.removeListener(k,T);else if(T!==void 0)for(R=T.length-1;R>=0;R--)this.removeListener(k,T[R]);return this};function h(_,k,T){var A=_._events;if(A===void 0)return[];var R=A[k];return R===void 0?[]:typeof R=="function"?T?[R.listener||R]:[R]:T?v(R):g(R,R.length)}i.prototype.listeners=function(k){return h(this,k,!0)},i.prototype.rawListeners=function(k){return h(this,k,!1)},i.listenerCount=function(_,k){return typeof _.listenerCount=="function"?_.listenerCount(k):p.call(_,k)},i.prototype.listenerCount=p;function p(_){var k=this._events;if(k!==void 0){var T=k[_];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function g(_,k){for(var T=new Array(k),A=0;A<k;++A)T[A]=_[A];return T}function y(_,k){for(;k+1<_.length;k++)_[k]=_[k+1];_.pop()}function v(_){for(var k=new Array(_.length),T=0;T<k.length;++T)k[T]=_[T].listener||_[T];return k}function x(_,k){return new Promise(function(T,A){function R(j){_.removeListener(k,M),A(j)}function M(){typeof _.removeListener=="function"&&_.removeListener("error",R),T([].slice.call(arguments))}S(_,k,M,{once:!0}),k!=="error"&&w(_,R,{once:!0})})}function w(_,k,T){typeof _.on=="function"&&S(_,"error",k,T)}function S(_,k,T,A){if(typeof _.on=="function")A.once?_.once(k,T):_.on(k,T);else if(typeof _.addEventListener=="function")_.addEventListener(k,function R(M){A.once&&_.removeEventListener(k,R),T(M)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}return BC.exports}var a7;function rl(){return a7||(a7=1,function(e){const t=Tp(),{format:n,inspect:r}=KX(),{codes:{ERR_INVALID_ARG_TYPE:s}}=Lo(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=ci(),l=globalThis.AbortSignal||s1().AbortSignal,c=globalThis.AbortController||s1().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},p=(y,v)=>{if(y!==void 0&&(y===null||typeof y!="object"||!("aborted"in y)))throw new s(v,"AbortSignal",y)},g=(y,v)=>{if(typeof y!="function")throw new s(v,"Function",y)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(y){let v=!1;return function(...x){v||(v=!0,y.apply(this,x))}},createDeferredPromise:function(){let y,v;return{promise:new Promise((w,S)=>{y=w,v=S}),resolve:y,reject:v}},promisify(y){return new Promise((v,x)=>{y((w,...S)=>w?x(w):v(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(y){return y instanceof u},isArrayBufferView(y){return ArrayBuffer.isView(y)}},isBlob:h,deprecate(y,v){return y},addAbortListener:oA().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);p(v,"signal"),g(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var S;(S=w)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(S=>{p(S,"signals"),S.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(FM)),FM.exports}var zC={},BM,o7;function CS(){if(o7)return BM;o7=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:p}=ci(),{hideStackFrames:g,codes:{ERR_SOCKET_BAD_PORT:y,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=Lo(),{normalizeEncoding:_}=rl(),{isAsyncFunction:k,isArrayBufferView:T}=rl().types,A={};function R(se){return se===(se|0)}function M(se){return se===se>>>0}const j=/^[0-7]+$/,F="must be a 32-bit unsigned integer or an octal string";function P(se,Pe,Be){if(typeof se>"u"&&(se=Be),typeof se=="string"){if(u(j,se)===null)throw new x(Pe,se,F);se=l(se,8)}return V(se,Pe),se}const q=g((se,Pe,Be=o,je=a)=>{if(typeof se!="number")throw new v(Pe,"number",se);if(!s(se))throw new w(Pe,"an integer",se);if(se<Be||se>je)throw new w(Pe,`>= ${Be} && <= ${je}`,se)}),I=g((se,Pe,Be=-2147483648,je=2147483647)=>{if(typeof se!="number")throw new v(Pe,"number",se);if(!s(se))throw new w(Pe,"an integer",se);if(se<Be||se>je)throw new w(Pe,`>= ${Be} && <= ${je}`,se)}),V=g((se,Pe,Be=!1)=>{if(typeof se!="number")throw new v(Pe,"number",se);if(!s(se))throw new w(Pe,"an integer",se);const je=Be?1:0,ot=4294967295;if(se<je||se>ot)throw new w(Pe,`>= ${je} && <= ${ot}`,se)});function D(se,Pe){if(typeof se!="string")throw new v(Pe,"string",se)}function z(se,Pe,Be=void 0,je){if(typeof se!="number")throw new v(Pe,"number",se);if(Be!=null&&se<Be||je!=null&&se>je||(Be!=null||je!=null)&&i(se))throw new w(Pe,`${Be!=null?`>= ${Be}`:""}${Be!=null&&je!=null?" && ":""}${je!=null?`<= ${je}`:""}`,se)}const $=g((se,Pe,Be)=>{if(!t(Be,se)){const ot="must be one of: "+n(r(Be,Et=>typeof Et=="string"?`'${Et}'`:d(Et)),", ");throw new x(Pe,se,ot)}});function Y(se,Pe){if(typeof se!="boolean")throw new v(Pe,"boolean",se)}function B(se,Pe,Be){return se==null||!c(se,Pe)?Be:se[Pe]}const G=g((se,Pe,Be=null)=>{const je=B(Be,"allowArray",!1),ot=B(Be,"allowFunction",!1);if(!B(Be,"nullable",!1)&&se===null||!je&&e(se)||typeof se!="object"&&(!ot||typeof se!="function"))throw new v(Pe,"Object",se)}),Z=g((se,Pe)=>{if(se!=null&&typeof se!="object"&&typeof se!="function")throw new v(Pe,"a dictionary",se)}),ne=g((se,Pe,Be=0)=>{if(!e(se))throw new v(Pe,"Array",se);if(se.length<Be){const je=`must be longer than ${Be}`;throw new x(Pe,se,je)}});function ae(se,Pe){ne(se,Pe);for(let Be=0;Be<se.length;Be++)D(se[Be],`${Pe}[${Be}]`)}function le(se,Pe){ne(se,Pe);for(let Be=0;Be<se.length;Be++)Y(se[Be],`${Pe}[${Be}]`)}function Se(se,Pe){ne(se,Pe);for(let Be=0;Be<se.length;Be++){const je=se[Be],ot=`${Pe}[${Be}]`;if(je==null)throw new v(ot,"AbortSignal",je);He(je,ot)}}function Ee(se,Pe="signal"){if(D(se,Pe),A[se]===void 0)throw A[h(se)]!==void 0?new S(se+" (signals must use all capital letters)"):new S(se)}const he=g((se,Pe="buffer")=>{if(!T(se))throw new v(Pe,["Buffer","TypedArray","DataView"],se)});function pe(se,Pe){const Be=_(Pe),je=se.length;if(Be==="hex"&&je%2!==0)throw new x("encoding",Pe,`is invalid for data of length ${je}`)}function Le(se,Pe="Port",Be=!0){if(typeof se!="number"&&typeof se!="string"||typeof se=="string"&&p(se).length===0||+se!==+se>>>0||se>65535||se===0&&!Be)throw new y(Pe,se,Be);return se|0}const He=g((se,Pe)=>{if(se!==void 0&&(se===null||typeof se!="object"||!("aborted"in se)))throw new v(Pe,"AbortSignal",se)}),Fe=g((se,Pe)=>{if(typeof se!="function")throw new v(Pe,"Function",se)}),Ie=g((se,Pe)=>{if(typeof se!="function"||k(se))throw new v(Pe,"Function",se)}),X=g((se,Pe)=>{if(se!==void 0)throw new v(Pe,"undefined",se)});function ye(se,Pe,Be){if(!t(Be,se))throw new v(Pe,`('${n(Be,"|")}')`,se)}const Ne=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function fe(se,Pe){if(typeof se>"u"||!u(Ne,se))throw new x(Pe,se,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function ce(se){if(typeof se=="string")return fe(se,"hints"),se;if(e(se)){const Pe=se.length;let Be="";if(Pe===0)return Be;for(let je=0;je<Pe;je++){const ot=se[je];fe(ot,"hints"),Be+=ot,je!==Pe-1&&(Be+=", ")}return Be}throw new x("hints",se,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return BM={isInt32:R,isUint32:M,parseFileMode:P,validateArray:ne,validateStringArray:ae,validateBooleanArray:le,validateAbortSignalArray:Se,validateBoolean:Y,validateBuffer:he,validateDictionary:Z,validateEncoding:pe,validateFunction:Fe,validateInt32:I,validateInteger:q,validateNumber:z,validateObject:G,validateOneOf:$,validatePlainFunction:Ie,validatePort:Le,validateSignalName:Ee,validateString:D,validateUint32:V,validateUndefined:X,validateUnion:ye,validateAbortSignal:He,validateLinkHeaderValue:ce},BM}var UC={exports:{}},zM={},l7;function Mg(){return l7||(l7=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(_){if(s===setTimeout)return setTimeout(_,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(_,0);try{return s(_,0)}catch{try{return s.call(null,_,0)}catch{return s.call(this,_,0)}}}function c(_){if(i===clearTimeout)return clearTimeout(_);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(_);try{return i(_)}catch{try{return i.call(null,_)}catch{return i.call(this,_)}}}var u=[],d=!1,h,p=-1;function g(){!d||!h||(d=!1,h.length?u=h.concat(u):p=-1,u.length&&y())}function y(){if(!d){var _=l(g);d=!0;for(var k=u.length;k;){for(h=u,u=[];++p<k;)h&&h[p].run();p=-1,k=u.length}h=null,d=!1,c(_)}}r.nextTick=function(_){var k=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)k[T-1]=arguments[T];u.push(new v(_,k)),u.length===1&&!d&&l(y)};function v(_,k){this.fun=_,this.array=k}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(_){return[]},r.binding=function(_){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(_){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const S=t(w);e.default=S,e.process=S}(zM)),zM}var UM,c7;function Ff(){if(c7)return UM;c7=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=ci(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(B,G=!1){var Z;return!!(B&&typeof B.pipe=="function"&&typeof B.on=="function"&&(!G||typeof B.pause=="function"&&typeof B.resume=="function")&&(!B._writableState||((Z=B._readableState)===null||Z===void 0?void 0:Z.readable)!==!1)&&(!B._writableState||B._readableState))}function d(B){var G;return!!(B&&typeof B.write=="function"&&typeof B.on=="function"&&(!B._readableState||((G=B._writableState)===null||G===void 0?void 0:G.writable)!==!1))}function h(B){return!!(B&&typeof B.pipe=="function"&&B._readableState&&typeof B.on=="function"&&typeof B.write=="function")}function p(B){return B&&(B._readableState||B._writableState||typeof B.write=="function"&&typeof B.on=="function"||typeof B.pipe=="function"&&typeof B.on=="function")}function g(B){return!!(B&&!p(B)&&typeof B.pipeThrough=="function"&&typeof B.getReader=="function"&&typeof B.cancel=="function")}function y(B){return!!(B&&!p(B)&&typeof B.getWriter=="function"&&typeof B.abort=="function")}function v(B){return!!(B&&!p(B)&&typeof B.readable=="object"&&typeof B.writable=="object")}function x(B){return g(B)||y(B)||v(B)}function w(B,G){return B==null?!1:G===!0?typeof B[e]=="function":G===!1?typeof B[t]=="function":typeof B[e]=="function"||typeof B[t]=="function"}function S(B){if(!p(B))return null;const G=B._writableState,Z=B._readableState,ne=G||Z;return!!(B.destroyed||B[r]||ne!=null&&ne.destroyed)}function _(B){if(!d(B))return null;if(B.writableEnded===!0)return!0;const G=B._writableState;return G!=null&&G.errored?!1:typeof(G==null?void 0:G.ended)!="boolean"?null:G.ended}function k(B,G){if(!d(B))return null;if(B.writableFinished===!0)return!0;const Z=B._writableState;return Z!=null&&Z.errored?!1:typeof(Z==null?void 0:Z.finished)!="boolean"?null:!!(Z.finished||G===!1&&Z.ended===!0&&Z.length===0)}function T(B){if(!u(B))return null;if(B.readableEnded===!0)return!0;const G=B._readableState;return!G||G.errored?!1:typeof(G==null?void 0:G.ended)!="boolean"?null:G.ended}function A(B,G){if(!u(B))return null;const Z=B._readableState;return Z!=null&&Z.errored?!1:typeof(Z==null?void 0:Z.endEmitted)!="boolean"?null:!!(Z.endEmitted||G===!1&&Z.ended===!0&&Z.length===0)}function R(B){return B&&B[i]!=null?B[i]:typeof(B==null?void 0:B.readable)!="boolean"?null:S(B)?!1:u(B)&&B.readable&&!A(B)}function M(B){return B&&B[a]!=null?B[a]:typeof(B==null?void 0:B.writable)!="boolean"?null:S(B)?!1:d(B)&&B.writable&&!_(B)}function j(B,G){return p(B)?S(B)?!0:!((G==null?void 0:G.readable)!==!1&&R(B)||(G==null?void 0:G.writable)!==!1&&M(B)):null}function F(B){var G,Z;return p(B)?B.writableErrored?B.writableErrored:(G=(Z=B._writableState)===null||Z===void 0?void 0:Z.errored)!==null&&G!==void 0?G:null:null}function P(B){var G,Z;return p(B)?B.readableErrored?B.readableErrored:(G=(Z=B._readableState)===null||Z===void 0?void 0:Z.errored)!==null&&G!==void 0?G:null:null}function q(B){if(!p(B))return null;if(typeof B.closed=="boolean")return B.closed;const G=B._writableState,Z=B._readableState;return typeof(G==null?void 0:G.closed)=="boolean"||typeof(Z==null?void 0:Z.closed)=="boolean"?(G==null?void 0:G.closed)||(Z==null?void 0:Z.closed):typeof B._closed=="boolean"&&I(B)?B._closed:null}function I(B){return typeof B._closed=="boolean"&&typeof B._defaultKeepAlive=="boolean"&&typeof B._removedConnection=="boolean"&&typeof B._removedContLen=="boolean"}function V(B){return typeof B._sent100=="boolean"&&I(B)}function D(B){var G;return typeof B._consuming=="boolean"&&typeof B._dumped=="boolean"&&((G=B.req)===null||G===void 0?void 0:G.upgradeOrConnect)===void 0}function z(B){if(!p(B))return null;const G=B._writableState,Z=B._readableState,ne=G||Z;return!ne&&V(B)||!!(ne&&ne.autoDestroy&&ne.emitClose&&ne.closed===!1)}function $(B){var G;return!!(B&&((G=B[o])!==null&&G!==void 0?G:B.readableDidRead||B.readableAborted))}function Y(B){var G,Z,ne,ae,le,Se,Ee,he,pe,Le;return!!(B&&((G=(Z=(ne=(ae=(le=(Se=B[s])!==null&&Se!==void 0?Se:B.readableErrored)!==null&&le!==void 0?le:B.writableErrored)!==null&&ae!==void 0?ae:(Ee=B._readableState)===null||Ee===void 0?void 0:Ee.errorEmitted)!==null&&ne!==void 0?ne:(he=B._writableState)===null||he===void 0?void 0:he.errorEmitted)!==null&&Z!==void 0?Z:(pe=B._readableState)===null||pe===void 0?void 0:pe.errored)!==null&&G!==void 0?G:!((Le=B._writableState)===null||Le===void 0)&&Le.errored))}return UM={isDestroyed:S,kIsDestroyed:r,isDisturbed:$,kIsDisturbed:o,isErrored:Y,kIsErrored:s,isReadable:R,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:q,isDuplexNodeStream:h,isFinished:j,isIterable:w,isReadableNodeStream:u,isReadableStream:g,isReadableEnded:T,isReadableFinished:A,isReadableErrored:P,isNodeStream:p,isWebStream:x,isWritable:M,isWritableNodeStream:d,isWritableStream:y,isWritableEnded:_,isWritableFinished:k,isWritableErrored:F,isServerRequest:D,isServerResponse:V,willEmitClose:z,isTransformStream:v},UM}var u7;function Ap(){if(u7)return UC.exports;u7=1;const e=Mg(),{AbortError:t,codes:n}=Lo(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=rl(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=CS(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:p}=ci(),{isClosed:g,isReadable:y,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:S,isWritable:_,isWritableNodeStream:k,isWritableStream:T,isWritableFinished:A,isWritableErrored:R,isNodeStream:M,willEmitClose:j,kIsClosedPromise:F}=Ff();let P;function q($){return $.setHeader&&typeof $.abort=="function"}const I=()=>{};function V($,Y,B){var G,Z;if(arguments.length===2?(B=Y,Y=i):Y==null?Y=i:c(Y,"options"),l(B,"callback"),o(Y.signal,"options.signal"),B=a(B),x($)||T($))return D($,Y,B);if(!M($))throw new r("stream",["ReadableStream","WritableStream","Stream"],$);const ne=(G=Y.readable)!==null&&G!==void 0?G:v($),ae=(Z=Y.writable)!==null&&Z!==void 0?Z:k($),le=$._writableState,Se=$._readableState,Ee=()=>{$.writable||Le()};let he=j($)&&v($)===ne&&k($)===ae,pe=A($,!1);const Le=()=>{pe=!0,$.destroyed&&(he=!1),!(he&&(!$.readable||ne))&&(!ne||He)&&B.call($)};let He=w($,!1);const Fe=()=>{He=!0,$.destroyed&&(he=!1),!(he&&(!$.writable||ae))&&(!ae||pe)&&B.call($)},Ie=se=>{B.call($,se)};let X=g($);const ye=()=>{X=!0;const se=R($)||S($);if(se&&typeof se!="boolean")return B.call($,se);if(ne&&!He&&v($,!0)&&!w($,!1))return B.call($,new s);if(ae&&!pe&&!A($,!1))return B.call($,new s);B.call($)},Ne=()=>{X=!0;const se=R($)||S($);if(se&&typeof se!="boolean")return B.call($,se);B.call($)},fe=()=>{$.req.on("finish",Le)};q($)?($.on("complete",Le),he||$.on("abort",ye),$.req?fe():$.on("request",fe)):ae&&!le&&($.on("end",Ee),$.on("close",Ee)),!he&&typeof $.aborted=="boolean"&&$.on("aborted",ye),$.on("end",Fe),$.on("finish",Le),Y.error!==!1&&$.on("error",Ie),$.on("close",ye),X?e.nextTick(ye):le!=null&&le.errorEmitted||Se!=null&&Se.errorEmitted?he||e.nextTick(Ne):(!ne&&(!he||y($))&&(pe||_($)===!1)||!ae&&(!he||_($))&&(He||y($)===!1)||Se&&$.req&&$.aborted)&&e.nextTick(Ne);const ce=()=>{B=I,$.removeListener("aborted",ye),$.removeListener("complete",Le),$.removeListener("abort",ye),$.removeListener("request",fe),$.req&&$.req.removeListener("finish",Le),$.removeListener("end",Ee),$.removeListener("close",Ee),$.removeListener("finish",Le),$.removeListener("end",Fe),$.removeListener("error",Ie),$.removeListener("close",ye)};if(Y.signal&&!X){const se=()=>{const Pe=B;ce(),Pe.call($,new t(void 0,{cause:Y.signal.reason}))};if(Y.signal.aborted)e.nextTick(se);else{P=P||rl().addAbortListener;const Pe=P(Y.signal,se),Be=B;B=a((...je)=>{Pe[p](),Be.apply($,je)})}}return ce}function D($,Y,B){let G=!1,Z=I;if(Y.signal)if(Z=()=>{G=!0,B.call($,new t(void 0,{cause:Y.signal.reason}))},Y.signal.aborted)e.nextTick(Z);else{P=P||rl().addAbortListener;const ae=P(Y.signal,Z),le=B;B=a((...Se)=>{ae[p](),le.apply($,Se)})}const ne=(...ae)=>{G||e.nextTick(()=>B.apply($,ae))};return h($[F].promise,ne,ne),I}function z($,Y){var B;let G=!1;return Y===null&&(Y=i),(B=Y)!==null&&B!==void 0&&B.cleanup&&(u(Y.cleanup,"cleanup"),G=Y.cleanup),new d((Z,ne)=>{const ae=V($,Y,le=>{G&&ae(),le?ne(le):Z()})})}return UC.exports=V,UC.exports.finished=z,UC.exports}var qM,d7;function Ub(){if(d7)return qM;d7=1;const e=Mg(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=Lo(),{Symbol:s}=ci(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=Ff(),c=s("kDestroy"),u=s("kConstruct");function d(j,F,P){j&&(j.stack,F&&!F.errored&&(F.errored=j),P&&!P.errored&&(P.errored=j))}function h(j,F){const P=this._readableState,q=this._writableState,I=q||P;return q!=null&&q.destroyed||P!=null&&P.destroyed?(typeof F=="function"&&F(),this):(d(j,q,P),q&&(q.destroyed=!0),P&&(P.destroyed=!0),I.constructed?p(this,j,F):this.once(c,function(V){p(this,t(V,j),F)}),this)}function p(j,F,P){let q=!1;function I(V){if(q)return;q=!0;const D=j._readableState,z=j._writableState;d(V,z,D),z&&(z.closed=!0),D&&(D.closed=!0),typeof P=="function"&&P(V),V?e.nextTick(g,j,V):e.nextTick(y,j)}try{j._destroy(F||null,I)}catch(V){I(V)}}function g(j,F){v(j,F),y(j)}function y(j){const F=j._readableState,P=j._writableState;P&&(P.closeEmitted=!0),F&&(F.closeEmitted=!0),(P!=null&&P.emitClose||F!=null&&F.emitClose)&&j.emit("close")}function v(j,F){const P=j._readableState,q=j._writableState;q!=null&&q.errorEmitted||P!=null&&P.errorEmitted||(q&&(q.errorEmitted=!0),P&&(P.errorEmitted=!0),j.emit("error",F))}function x(){const j=this._readableState,F=this._writableState;j&&(j.constructed=!0,j.closed=!1,j.closeEmitted=!1,j.destroyed=!1,j.errored=null,j.errorEmitted=!1,j.reading=!1,j.ended=j.readable===!1,j.endEmitted=j.readable===!1),F&&(F.constructed=!0,F.destroyed=!1,F.closed=!1,F.closeEmitted=!1,F.errored=null,F.errorEmitted=!1,F.finalCalled=!1,F.prefinished=!1,F.ended=F.writable===!1,F.ending=F.writable===!1,F.finished=F.writable===!1)}function w(j,F,P){const q=j._readableState,I=j._writableState;if(I!=null&&I.destroyed||q!=null&&q.destroyed)return this;q!=null&&q.autoDestroy||I!=null&&I.autoDestroy?j.destroy(F):F&&(F.stack,I&&!I.errored&&(I.errored=F),q&&!q.errored&&(q.errored=F),P?e.nextTick(v,j,F):v(j,F))}function S(j,F){if(typeof j._construct!="function")return;const P=j._readableState,q=j._writableState;P&&(P.constructed=!1),q&&(q.constructed=!1),j.once(u,F),!(j.listenerCount(u)>1)&&e.nextTick(_,j)}function _(j){let F=!1;function P(q){if(F){w(j,q??new n);return}F=!0;const I=j._readableState,V=j._writableState,D=V||I;I&&(I.constructed=!0),V&&(V.constructed=!0),D.destroyed?j.emit(c,q):q?w(j,q,!0):e.nextTick(k,j)}try{j._construct(q=>{e.nextTick(P,q)})}catch(q){e.nextTick(P,q)}}function k(j){j.emit(u)}function T(j){return(j==null?void 0:j.setHeader)&&typeof j.abort=="function"}function A(j){j.emit("close")}function R(j,F){j.emit("error",F),e.nextTick(A,j)}function M(j,F){!j||a(j)||(!F&&!o(j)&&(F=new r),l(j)?(j.socket=null,j.destroy(F)):T(j)?j.abort():T(j.req)?j.req.abort():typeof j.destroy=="function"?j.destroy(F):typeof j.close=="function"?j.close():F?e.nextTick(R,j,F):e.nextTick(A,j),j.destroyed||(j[i]=!0))}return qM={construct:S,destroyer:M,destroy:h,undestroy:x,errorOrDestroy:w},qM}var VM,f7;function BF(){if(f7)return VM;f7=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=ci(),{EventEmitter:n}=oA();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(y){i.writable&&i.write(y)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function p(y){g(),n.listenerCount(this,"error")===0&&this.emit("error",y)}s(o,"error",p),s(i,"error",p);function g(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",p),i.removeListener("error",p),o.removeListener("end",g),o.removeListener("close",g),i.removeListener("close",g)}return o.on("end",g),o.on("close",g),i.on("close",g),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return VM={Stream:r,prependListener:s},VM}var WM={exports:{}},h7;function lA(){return h7||(h7=1,function(e){const{SymbolDispose:t}=ci(),{AbortError:n,codes:r}=Lo(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=Ff(),o=Ap(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,p){if(u(h,"signal"),!s(p)&&!i(p))throw new l("stream",["ReadableStream","WritableStream","Stream"],p);return e.exports.addAbortSignalNoValidate(h,p)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const p=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)p();else{c=c||rl().addAbortListener;const g=c(d,p);o(h,g[t])}return h}}(WM)),WM.exports}var HM,p7;function gEe(){if(p7)return HM;p7=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=ci(),{Buffer:s}=Tp(),{inspect:i}=rl();return HM=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},HM}var GM,m7;function cA(){if(m7)return GM;m7=1;const{MathFloor:e,NumberIsInteger:t}=ci(),{validateInteger:n}=CS(),{ERR_INVALID_ARG_VALUE:r}=Lo().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,p){const g=a(d,p,h);if(g!=null){if(!t(g)||g<0){const y=p?`options.${h}`:"options.highWaterMark";throw new r(y,g)}return e(g)}return o(u.objectMode)}return GM={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},GM}var KM={},qC={exports:{}},g7;function zF(){return g7||(g7=1,function(e,t){var n=Tp(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(qC,qC.exports)),qC.exports}var y7;function yEe(){if(y7)return KM;y7=1;var e=zF().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}KM.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=p,this.end=g,w=3;break;default:this.write=y,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,S;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<x.length?w?w+this.text(x,S):this.text(x,S):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,S){var _=w.length-1;if(_<S)return 0;var k=i(w[_]);return k>=0?(k>0&&(x.lastNeed=k-1),k):--_<S||k===-2?0:(k=i(w[_]),k>=0?(k>0&&(x.lastNeed=k-2),k):--_<S||k===-2?0:(k=i(w[_]),k>=0?(k>0&&(k===2?k=0:x.lastNeed=k-3),k):0))}function o(x,w,S){if((w[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var w=this.lastTotal-this.lastNeed,S=o(this,x);if(S!==void 0)return S;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var S=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=S;var _=x.length-(S-this.lastNeed);return x.copy(this.lastChar,0,_),x.toString("utf8",w,_)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"":w}function d(x,w){if((x.length-w)%2===0){var S=x.toString("utf16le",w);if(S){var _=S.charCodeAt(S.length-1);if(_>=55296&&_<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function p(x,w){var S=(x.length-w)%3;return S===0?x.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-S))}function g(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function y(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return KM}var YM,b7;function YX(){if(b7)return YM;b7=1;const e=Mg(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=ci(),{Buffer:s}=Tp(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=Lo().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const p=new l({objectMode:!0,highWaterMark:1,...u});let g=!1;p._read=function(){g||(g=!0,v())},p._destroy=function(x,w){t(y(x),()=>e.nextTick(w,x),S=>e.nextTick(w,S||x))};async function y(x){const w=x!=null,S=typeof d.throw=="function";if(w&&S){const{value:_,done:k}=await d.throw(x);if(await _,k)return}if(typeof d.return=="function"){const{value:_}=await d.return();await _}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)p.push(null);else{const S=x&&typeof x.then=="function"?await x:x;if(S===null)throw g=!1,new a;if(p.push(S))continue;g=!1}}catch(x){p.destroy(x)}break}}return p}return YM=o,YM}var ZM,v7;function uA(){if(v7)return ZM;v7=1;const e=Mg(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=ci();ZM=je,je.ReadableState=Be;const{EventEmitter:p}=oA(),{Stream:g,prependListener:y}=BF(),{Buffer:v}=Tp(),{addAbortSignal:x}=lA(),w=Ap();let S=rl().debuglog("stream",me=>{S=me});const _=gEe(),k=Ub(),{getHighWaterMark:T,getDefaultHighWaterMark:A}=cA(),{aggregateTwoErrors:R,codes:{ERR_INVALID_ARG_TYPE:M,ERR_METHOD_NOT_IMPLEMENTED:j,ERR_OUT_OF_RANGE:F,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:q},AbortError:I}=Lo(),{validateObject:V}=CS(),D=h("kPaused"),{StringDecoder:z}=yEe(),$=YX();o(je.prototype,g.prototype),o(je,g);const Y=()=>{},{errorOrDestroy:B}=k,G=1,Z=2,ne=4,ae=8,le=16,Se=32,Ee=64,he=128,pe=256,Le=512,He=1024,Fe=2048,Ie=4096,X=8192,ye=16384,Ne=32768,fe=65536,ce=1<<17,se=1<<18;function Pe(me){return{enumerable:!1,get(){return(this.state&me)!==0},set(Q){Q?this.state|=me:this.state&=~me}}}i(Be.prototype,{objectMode:Pe(G),ended:Pe(Z),endEmitted:Pe(ne),reading:Pe(ae),constructed:Pe(le),sync:Pe(Se),needReadable:Pe(Ee),emittedReadable:Pe(he),readableListening:Pe(pe),resumeScheduled:Pe(Le),errorEmitted:Pe(He),emitClose:Pe(Fe),autoDestroy:Pe(Ie),destroyed:Pe(X),closed:Pe(ye),closeEmitted:Pe(Ne),multiAwaitDrain:Pe(fe),readingMore:Pe(ce),dataEmitted:Pe(se)});function Be(me,Q,J){typeof J!="boolean"&&(J=Q instanceof Af()),this.state=Fe|Ie|le|Se,me&&me.objectMode&&(this.state|=G),J&&me&&me.readableObjectMode&&(this.state|=G),this.highWaterMark=me?T(this,me,"readableHighWaterMark",J):A(!1),this.buffer=new _,this.length=0,this.pipes=[],this.flowing=null,this[D]=null,me&&me.emitClose===!1&&(this.state&=-2049),me&&me.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=me&&me.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,me&&me.encoding&&(this.decoder=new z(me.encoding),this.encoding=me.encoding)}function je(me){if(!(this instanceof je))return new je(me);const Q=this instanceof Af();this._readableState=new Be(me,this,Q),me&&(typeof me.read=="function"&&(this._read=me.read),typeof me.destroy=="function"&&(this._destroy=me.destroy),typeof me.construct=="function"&&(this._construct=me.construct),me.signal&&!Q&&x(me.signal,this)),g.call(this,me),k.construct(this,()=>{this._readableState.needReadable&&U(this,this._readableState)})}je.prototype.destroy=k.destroy,je.prototype._undestroy=k.undestroy,je.prototype._destroy=function(me,Q){Q(me)},je.prototype[p.captureRejectionSymbol]=function(me){this.destroy(me)},je.prototype[u]=function(){let me;return this.destroyed||(me=this.readableEnded?null:new I,this.destroy(me)),new l((Q,J)=>w(this,te=>te&&te!==me?J(te):Q(null)))},je.prototype.push=function(me,Q){return ot(this,me,Q,!1)},je.prototype.unshift=function(me,Q){return ot(this,me,Q,!0)};function ot(me,Q,J,te){S("readableAddChunk",Q);const _e=me._readableState;let $e;if((_e.state&G)===0&&(typeof Q=="string"?(J=J||_e.defaultEncoding,_e.encoding!==J&&(te&&_e.encoding?Q=v.from(Q,J).toString(_e.encoding):(Q=v.from(Q,J),J=""))):Q instanceof v?J="":g._isUint8Array(Q)?(Q=g._uint8ArrayToBuffer(Q),J=""):Q!=null&&($e=new M("chunk",["string","Buffer","Uint8Array"],Q))),$e)B(me,$e);else if(Q===null)_e.state&=-9,Ft(me,_e);else if((_e.state&G)!==0||Q&&Q.length>0)if(te)if((_e.state&ne)!==0)B(me,new q);else{if(_e.destroyed||_e.errored)return!1;Et(me,_e,Q,!0)}else if(_e.ended)B(me,new P);else{if(_e.destroyed||_e.errored)return!1;_e.state&=-9,_e.decoder&&!J?(Q=_e.decoder.write(Q),_e.objectMode||Q.length!==0?Et(me,_e,Q,!1):U(me,_e)):Et(me,_e,Q,!1)}else te||(_e.state&=-9,U(me,_e));return!_e.ended&&(_e.length<_e.highWaterMark||_e.length===0)}function Et(me,Q,J,te){Q.flowing&&Q.length===0&&!Q.sync&&me.listenerCount("data")>0?((Q.state&fe)!==0?Q.awaitDrainWriters.clear():Q.awaitDrainWriters=null,Q.dataEmitted=!0,me.emit("data",J)):(Q.length+=Q.objectMode?1:J.length,te?Q.buffer.unshift(J):Q.buffer.push(J),(Q.state&Ee)!==0&&Ht(me)),U(me,Q)}je.prototype.isPaused=function(){const me=this._readableState;return me[D]===!0||me.flowing===!1},je.prototype.setEncoding=function(me){const Q=new z(me);this._readableState.decoder=Q,this._readableState.encoding=this._readableState.decoder.encoding;const J=this._readableState.buffer;let te="";for(const _e of J)te+=Q.write(_e);return J.clear(),te!==""&&J.push(te),this._readableState.length=te.length,this};const ut=1073741824;function Pt(me){if(me>ut)throw new F("size","<= 1GiB",me);return me--,me|=me>>>1,me|=me>>>2,me|=me>>>4,me|=me>>>8,me|=me>>>16,me++,me}function $t(me,Q){return me<=0||Q.length===0&&Q.ended?0:(Q.state&G)!==0?1:r(me)?Q.flowing&&Q.length?Q.buffer.first().length:Q.length:me<=Q.length?me:Q.ended?Q.length:0}je.prototype.read=function(me){S("read",me),me===void 0?me=NaN:n(me)||(me=s(me,10));const Q=this._readableState,J=me;if(me>Q.highWaterMark&&(Q.highWaterMark=Pt(me)),me!==0&&(Q.state&=-129),me===0&&Q.needReadable&&((Q.highWaterMark!==0?Q.length>=Q.highWaterMark:Q.length>0)||Q.ended))return S("read: emitReadable",Q.length,Q.ended),Q.length===0&&Q.ended?tt(this):Ht(this),null;if(me=$t(me,Q),me===0&&Q.ended)return Q.length===0&&tt(this),null;let te=(Q.state&Ee)!==0;if(S("need readable",te),(Q.length===0||Q.length-me<Q.highWaterMark)&&(te=!0,S("length less than watermark",te)),Q.ended||Q.reading||Q.destroyed||Q.errored||!Q.constructed)te=!1,S("reading, ended or constructing",te);else if(te){S("do read"),Q.state|=ae|Se,Q.length===0&&(Q.state|=Ee);try{this._read(Q.highWaterMark)}catch($e){B(this,$e)}Q.state&=-33,Q.reading||(me=$t(J,Q))}let _e;return me>0?_e=Ve(me,Q):_e=null,_e===null?(Q.needReadable=Q.length<=Q.highWaterMark,me=0):(Q.length-=me,Q.multiAwaitDrain?Q.awaitDrainWriters.clear():Q.awaitDrainWriters=null),Q.length===0&&(Q.ended||(Q.needReadable=!0),J!==me&&Q.ended&&tt(this)),_e!==null&&!Q.errorEmitted&&!Q.closeEmitted&&(Q.dataEmitted=!0,this.emit("data",_e)),_e};function Ft(me,Q){if(S("onEofChunk"),!Q.ended){if(Q.decoder){const J=Q.decoder.end();J&&J.length&&(Q.buffer.push(J),Q.length+=Q.objectMode?1:J.length)}Q.ended=!0,Q.sync?Ht(me):(Q.needReadable=!1,Q.emittedReadable=!0,Ce(me))}}function Ht(me){const Q=me._readableState;S("emitReadable",Q.needReadable,Q.emittedReadable),Q.needReadable=!1,Q.emittedReadable||(S("emitReadable",Q.flowing),Q.emittedReadable=!0,e.nextTick(Ce,me))}function Ce(me){const Q=me._readableState;S("emitReadable_",Q.destroyed,Q.length,Q.ended),!Q.destroyed&&!Q.errored&&(Q.length||Q.ended)&&(me.emit("readable"),Q.emittedReadable=!1),Q.needReadable=!Q.flowing&&!Q.ended&&Q.length<=Q.highWaterMark,ht(me)}function U(me,Q){!Q.readingMore&&Q.constructed&&(Q.readingMore=!0,e.nextTick(ee,me,Q))}function ee(me,Q){for(;!Q.reading&&!Q.ended&&(Q.length<Q.highWaterMark||Q.flowing&&Q.length===0);){const J=Q.length;if(S("maybeReadMore read 0"),me.read(0),J===Q.length)break}Q.readingMore=!1}je.prototype._read=function(me){throw new j("_read()")},je.prototype.pipe=function(me,Q){const J=this,te=this._readableState;te.pipes.length===1&&(te.multiAwaitDrain||(te.multiAwaitDrain=!0,te.awaitDrainWriters=new c(te.awaitDrainWriters?[te.awaitDrainWriters]:[]))),te.pipes.push(me),S("pipe count=%d opts=%j",te.pipes.length,Q);const $e=(!Q||Q.end!==!1)&&me!==e.stdout&&me!==e.stderr?wt:Qr;te.endEmitted?e.nextTick($e):J.once("end",$e),me.on("unpipe",Ge);function Ge(Sr,mn){S("onunpipe"),Sr===J&&mn&&mn.hasUnpiped===!1&&(mn.hasUnpiped=!0,Gt())}function wt(){S("onend"),me.end()}let Jt,jn=!1;function Gt(){S("cleanup"),me.removeListener("close",Cr),me.removeListener("finish",Jr),Jt&&me.removeListener("drain",Jt),me.removeListener("error",br),me.removeListener("unpipe",Ge),J.removeListener("end",wt),J.removeListener("end",Qr),J.removeListener("data",dn),jn=!0,Jt&&te.awaitDrainWriters&&(!me._writableState||me._writableState.needDrain)&&Jt()}function rn(){jn||(te.pipes.length===1&&te.pipes[0]===me?(S("false write response, pause",0),te.awaitDrainWriters=me,te.multiAwaitDrain=!1):te.pipes.length>1&&te.pipes.includes(me)&&(S("false write response, pause",te.awaitDrainWriters.size),te.awaitDrainWriters.add(me)),J.pause()),Jt||(Jt=xe(J,me),me.on("drain",Jt))}J.on("data",dn);function dn(Sr){S("ondata");const mn=me.write(Sr);S("dest.write",mn),mn===!1&&rn()}function br(Sr){if(S("onerror",Sr),Qr(),me.removeListener("error",br),me.listenerCount("error")===0){const mn=me._writableState||me._readableState;mn&&!mn.errorEmitted?B(me,Sr):me.emit("error",Sr)}}y(me,"error",br);function Cr(){me.removeListener("finish",Jr),Qr()}me.once("close",Cr);function Jr(){S("onfinish"),me.removeListener("close",Cr),Qr()}me.once("finish",Jr);function Qr(){S("unpipe"),J.unpipe(me)}return me.emit("pipe",J),me.writableNeedDrain===!0?rn():te.flowing||(S("pipe resume"),J.resume()),me};function xe(me,Q){return function(){const te=me._readableState;te.awaitDrainWriters===Q?(S("pipeOnDrain",1),te.awaitDrainWriters=null):te.multiAwaitDrain&&(S("pipeOnDrain",te.awaitDrainWriters.size),te.awaitDrainWriters.delete(Q)),(!te.awaitDrainWriters||te.awaitDrainWriters.size===0)&&me.listenerCount("data")&&me.resume()}}je.prototype.unpipe=function(me){const Q=this._readableState,J={hasUnpiped:!1};if(Q.pipes.length===0)return this;if(!me){const _e=Q.pipes;Q.pipes=[],this.pause();for(let $e=0;$e<_e.length;$e++)_e[$e].emit("unpipe",this,{hasUnpiped:!1});return this}const te=t(Q.pipes,me);return te===-1?this:(Q.pipes.splice(te,1),Q.pipes.length===0&&this.pause(),me.emit("unpipe",this,J),this)},je.prototype.on=function(me,Q){const J=g.prototype.on.call(this,me,Q),te=this._readableState;return me==="data"?(te.readableListening=this.listenerCount("readable")>0,te.flowing!==!1&&this.resume()):me==="readable"&&!te.endEmitted&&!te.readableListening&&(te.readableListening=te.needReadable=!0,te.flowing=!1,te.emittedReadable=!1,S("on readable",te.length,te.reading),te.length?Ht(this):te.reading||e.nextTick(ve,this)),J},je.prototype.addListener=je.prototype.on,je.prototype.removeListener=function(me,Q){const J=g.prototype.removeListener.call(this,me,Q);return me==="readable"&&e.nextTick(Re,this),J},je.prototype.off=je.prototype.removeListener,je.prototype.removeAllListeners=function(me){const Q=g.prototype.removeAllListeners.apply(this,arguments);return(me==="readable"||me===void 0)&&e.nextTick(Re,this),Q};function Re(me){const Q=me._readableState;Q.readableListening=me.listenerCount("readable")>0,Q.resumeScheduled&&Q[D]===!1?Q.flowing=!0:me.listenerCount("data")>0?me.resume():Q.readableListening||(Q.flowing=null)}function ve(me){S("readable nexttick read 0"),me.read(0)}je.prototype.resume=function(){const me=this._readableState;return me.flowing||(S("resume"),me.flowing=!me.readableListening,Me(this,me)),me[D]=!1,this};function Me(me,Q){Q.resumeScheduled||(Q.resumeScheduled=!0,e.nextTick(de,me,Q))}function de(me,Q){S("resume",Q.reading),Q.reading||me.read(0),Q.resumeScheduled=!1,me.emit("resume"),ht(me),Q.flowing&&!Q.reading&&me.read(0)}je.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[D]=!0,this};function ht(me){const Q=me._readableState;for(S("flow",Q.flowing);Q.flowing&&me.read()!==null;);}je.prototype.wrap=function(me){let Q=!1;me.on("data",te=>{!this.push(te)&&me.pause&&(Q=!0,me.pause())}),me.on("end",()=>{this.push(null)}),me.on("error",te=>{B(this,te)}),me.on("close",()=>{this.destroy()}),me.on("destroy",()=>{this.destroy()}),this._read=()=>{Q&&me.resume&&(Q=!1,me.resume())};const J=a(me);for(let te=1;te<J.length;te++){const _e=J[te];this[_e]===void 0&&typeof me[_e]=="function"&&(this[_e]=me[_e].bind(me))}return this},je.prototype[d]=function(){return et(this)},je.prototype.iterator=function(me){return me!==void 0&&V(me,"options"),et(this,me)};function et(me,Q){typeof me.read!="function"&&(me=je.wrap(me,{objectMode:!0}));const J=W(me,Q);return J.stream=me,J}async function*W(me,Q){let J=Y;function te(Ge){this===me?(J(),J=Y):J=Ge}me.on("readable",te);let _e;const $e=w(me,{writable:!1},Ge=>{_e=Ge?R(_e,Ge):null,J(),J=Y});try{for(;;){const Ge=me.destroyed?null:me.read();if(Ge!==null)yield Ge;else{if(_e)throw _e;if(_e===null)return;await new l(te)}}}catch(Ge){throw _e=R(_e,Ge),_e}finally{(_e||(Q==null?void 0:Q.destroyOnReturn)!==!1)&&(_e===void 0||me._readableState.autoDestroy)?k.destroyer(me,null):(me.off("readable",te),$e())}}i(je.prototype,{readable:{__proto__:null,get(){const me=this._readableState;return!!me&&me.readable!==!1&&!me.destroyed&&!me.errorEmitted&&!me.endEmitted},set(me){this._readableState&&(this._readableState.readable=!!me)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(me){this._readableState&&(this._readableState.flowing=me)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(me){this._readableState&&(this._readableState.destroyed=me)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[D]!==!1},set(me){this[D]=!!me}}}),je._fromList=Ve;function Ve(me,Q){if(Q.length===0)return null;let J;return Q.objectMode?J=Q.buffer.shift():!me||me>=Q.length?(Q.decoder?J=Q.buffer.join(""):Q.buffer.length===1?J=Q.buffer.first():J=Q.buffer.concat(Q.length),Q.buffer.clear()):J=Q.buffer.consume(me,Q.decoder),J}function tt(me){const Q=me._readableState;S("endReadable",Q.endEmitted),Q.endEmitted||(Q.ended=!0,e.nextTick(we,Q,me))}function we(me,Q){if(S("endReadableNT",me.endEmitted,me.length),!me.errored&&!me.closeEmitted&&!me.endEmitted&&me.length===0){if(me.endEmitted=!0,Q.emit("end"),Q.writable&&Q.allowHalfOpen===!1)e.nextTick(Te,Q);else if(me.autoDestroy){const J=Q._writableState;(!J||J.autoDestroy&&(J.finished||J.writable===!1))&&Q.destroy()}}}function Te(me){me.writable&&!me.writableEnded&&!me.destroyed&&me.end()}je.from=function(me,Q){return $(je,me,Q)};let Ue;function Ct(){return Ue===void 0&&(Ue={}),Ue}return je.fromWeb=function(me,Q){return Ct().newStreamReadableFromReadableStream(me,Q)},je.toWeb=function(me,Q){return Ct().newReadableStreamFromStreamReadable(me,Q)},je.wrap=function(me,Q){var J,te;return new je({objectMode:(J=(te=me.readableObjectMode)!==null&&te!==void 0?te:me.objectMode)!==null&&J!==void 0?J:!0,...Q,destroy(_e,$e){k.destroyer(me,_e),$e(_e)}}).wrap(me)},ZM}var XM,x7;function UF(){if(x7)return XM;x7=1;const e=Mg(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=ci();XM=V,V.WritableState=q;const{EventEmitter:u}=oA(),d=BF().Stream,{Buffer:h}=Tp(),p=Ub(),{addAbortSignal:g}=lA(),{getHighWaterMark:y,getDefaultHighWaterMark:v}=cA(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:_,ERR_STREAM_DESTROYED:k,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:A,ERR_STREAM_WRITE_AFTER_END:R,ERR_UNKNOWN_ENCODING:M}=Lo().codes,{errorOrDestroy:j}=p;a(V.prototype,d.prototype),a(V,d);function F(){}const P=l("kOnFinished");function q(Ie,X,ye){typeof ye!="boolean"&&(ye=X instanceof Af()),this.objectMode=!!(Ie&&Ie.objectMode),ye&&(this.objectMode=this.objectMode||!!(Ie&&Ie.writableObjectMode)),this.highWaterMark=Ie?y(this,Ie,"writableHighWaterMark",ye):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Ne=!!(Ie&&Ie.decodeStrings===!1);this.decodeStrings=!Ne,this.defaultEncoding=Ie&&Ie.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=B.bind(void 0,X),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,I(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Ie||Ie.emitClose!==!1,this.autoDestroy=!Ie||Ie.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function I(Ie){Ie.buffered=[],Ie.bufferedIndex=0,Ie.allBuffers=!0,Ie.allNoop=!0}q.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(q.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function V(Ie){const X=this instanceof Af();if(!X&&!r(V,this))return new V(Ie);this._writableState=new q(Ie,this,X),Ie&&(typeof Ie.write=="function"&&(this._write=Ie.write),typeof Ie.writev=="function"&&(this._writev=Ie.writev),typeof Ie.destroy=="function"&&(this._destroy=Ie.destroy),typeof Ie.final=="function"&&(this._final=Ie.final),typeof Ie.construct=="function"&&(this._construct=Ie.construct),Ie.signal&&g(Ie.signal,this)),d.call(this,Ie),p.construct(this,()=>{const ye=this._writableState;ye.writing||ae(this,ye),he(this,ye)})}s(V,c,{__proto__:null,value:function(Ie){return r(this,Ie)?!0:this!==V?!1:Ie&&Ie._writableState instanceof q}}),V.prototype.pipe=function(){j(this,new _)};function D(Ie,X,ye,Ne){const fe=Ie._writableState;if(typeof ye=="function")Ne=ye,ye=fe.defaultEncoding;else{if(!ye)ye=fe.defaultEncoding;else if(ye!=="buffer"&&!h.isEncoding(ye))throw new M(ye);typeof Ne!="function"&&(Ne=F)}if(X===null)throw new A;if(!fe.objectMode)if(typeof X=="string")fe.decodeStrings!==!1&&(X=h.from(X,ye),ye="buffer");else if(X instanceof h)ye="buffer";else if(d._isUint8Array(X))X=d._uint8ArrayToBuffer(X),ye="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],X);let ce;return fe.ending?ce=new R:fe.destroyed&&(ce=new k("write")),ce?(e.nextTick(Ne,ce),j(Ie,ce,!0),ce):(fe.pendingcb++,z(Ie,fe,X,ye,Ne))}V.prototype.write=function(Ie,X,ye){return D(this,Ie,X,ye)===!0},V.prototype.cork=function(){this._writableState.corked++},V.prototype.uncork=function(){const Ie=this._writableState;Ie.corked&&(Ie.corked--,Ie.writing||ae(this,Ie))},V.prototype.setDefaultEncoding=function(X){if(typeof X=="string"&&(X=o(X)),!h.isEncoding(X))throw new M(X);return this._writableState.defaultEncoding=X,this};function z(Ie,X,ye,Ne,fe){const ce=X.objectMode?1:ye.length;X.length+=ce;const se=X.length<X.highWaterMark;return se||(X.needDrain=!0),X.writing||X.corked||X.errored||!X.constructed?(X.buffered.push({chunk:ye,encoding:Ne,callback:fe}),X.allBuffers&&Ne!=="buffer"&&(X.allBuffers=!1),X.allNoop&&fe!==F&&(X.allNoop=!1)):(X.writelen=ce,X.writecb=fe,X.writing=!0,X.sync=!0,Ie._write(ye,Ne,X.onwrite),X.sync=!1),se&&!X.errored&&!X.destroyed}function $(Ie,X,ye,Ne,fe,ce,se){X.writelen=Ne,X.writecb=se,X.writing=!0,X.sync=!0,X.destroyed?X.onwrite(new k("write")):ye?Ie._writev(fe,X.onwrite):Ie._write(fe,ce,X.onwrite),X.sync=!1}function Y(Ie,X,ye,Ne){--X.pendingcb,Ne(ye),ne(X),j(Ie,ye)}function B(Ie,X){const ye=Ie._writableState,Ne=ye.sync,fe=ye.writecb;if(typeof fe!="function"){j(Ie,new S);return}ye.writing=!1,ye.writecb=null,ye.length-=ye.writelen,ye.writelen=0,X?(X.stack,ye.errored||(ye.errored=X),Ie._readableState&&!Ie._readableState.errored&&(Ie._readableState.errored=X),Ne?e.nextTick(Y,Ie,ye,X,fe):Y(Ie,ye,X,fe)):(ye.buffered.length>ye.bufferedIndex&&ae(Ie,ye),Ne?ye.afterWriteTickInfo!==null&&ye.afterWriteTickInfo.cb===fe?ye.afterWriteTickInfo.count++:(ye.afterWriteTickInfo={count:1,cb:fe,stream:Ie,state:ye},e.nextTick(G,ye.afterWriteTickInfo)):Z(Ie,ye,1,fe))}function G({stream:Ie,state:X,count:ye,cb:Ne}){return X.afterWriteTickInfo=null,Z(Ie,X,ye,Ne)}function Z(Ie,X,ye,Ne){for(!X.ending&&!Ie.destroyed&&X.length===0&&X.needDrain&&(X.needDrain=!1,Ie.emit("drain"));ye-- >0;)X.pendingcb--,Ne();X.destroyed&&ne(X),he(Ie,X)}function ne(Ie){if(Ie.writing)return;for(let fe=Ie.bufferedIndex;fe<Ie.buffered.length;++fe){var X;const{chunk:ce,callback:se}=Ie.buffered[fe],Pe=Ie.objectMode?1:ce.length;Ie.length-=Pe,se((X=Ie.errored)!==null&&X!==void 0?X:new k("write"))}const ye=Ie[P].splice(0);for(let fe=0;fe<ye.length;fe++){var Ne;ye[fe]((Ne=Ie.errored)!==null&&Ne!==void 0?Ne:new k("end"))}I(Ie)}function ae(Ie,X){if(X.corked||X.bufferProcessing||X.destroyed||!X.constructed)return;const{buffered:ye,bufferedIndex:Ne,objectMode:fe}=X,ce=ye.length-Ne;if(!ce)return;let se=Ne;if(X.bufferProcessing=!0,ce>1&&Ie._writev){X.pendingcb-=ce-1;const Pe=X.allNoop?F:je=>{for(let ot=se;ot<ye.length;++ot)ye[ot].callback(je)},Be=X.allNoop&&se===0?ye:t(ye,se);Be.allBuffers=X.allBuffers,$(Ie,X,!0,X.length,Be,"",Pe),I(X)}else{do{const{chunk:Pe,encoding:Be,callback:je}=ye[se];ye[se++]=null;const ot=fe?1:Pe.length;$(Ie,X,!1,ot,Pe,Be,je)}while(se<ye.length&&!X.writing);se===ye.length?I(X):se>256?(ye.splice(0,se),X.bufferedIndex=0):X.bufferedIndex=se}X.bufferProcessing=!1}V.prototype._write=function(Ie,X,ye){if(this._writev)this._writev([{chunk:Ie,encoding:X}],ye);else throw new w("_write()")},V.prototype._writev=null,V.prototype.end=function(Ie,X,ye){const Ne=this._writableState;typeof Ie=="function"?(ye=Ie,Ie=null,X=null):typeof X=="function"&&(ye=X,X=null);let fe;if(Ie!=null){const ce=D(this,Ie,X);ce instanceof n&&(fe=ce)}return Ne.corked&&(Ne.corked=1,this.uncork()),fe||(!Ne.errored&&!Ne.ending?(Ne.ending=!0,he(this,Ne,!0),Ne.ended=!0):Ne.finished?fe=new T("end"):Ne.destroyed&&(fe=new k("end"))),typeof ye=="function"&&(fe||Ne.finished?e.nextTick(ye,fe):Ne[P].push(ye)),this};function le(Ie){return Ie.ending&&!Ie.destroyed&&Ie.constructed&&Ie.length===0&&!Ie.errored&&Ie.buffered.length===0&&!Ie.finished&&!Ie.writing&&!Ie.errorEmitted&&!Ie.closeEmitted}function Se(Ie,X){let ye=!1;function Ne(fe){if(ye){j(Ie,fe??S());return}if(ye=!0,X.pendingcb--,fe){const ce=X[P].splice(0);for(let se=0;se<ce.length;se++)ce[se](fe);j(Ie,fe,X.sync)}else le(X)&&(X.prefinished=!0,Ie.emit("prefinish"),X.pendingcb++,e.nextTick(pe,Ie,X))}X.sync=!0,X.pendingcb++;try{Ie._final(Ne)}catch(fe){Ne(fe)}X.sync=!1}function Ee(Ie,X){!X.prefinished&&!X.finalCalled&&(typeof Ie._final=="function"&&!X.destroyed?(X.finalCalled=!0,Se(Ie,X)):(X.prefinished=!0,Ie.emit("prefinish")))}function he(Ie,X,ye){le(X)&&(Ee(Ie,X),X.pendingcb===0&&(ye?(X.pendingcb++,e.nextTick((Ne,fe)=>{le(fe)?pe(Ne,fe):fe.pendingcb--},Ie,X)):le(X)&&(X.pendingcb++,pe(Ie,X))))}function pe(Ie,X){X.pendingcb--,X.finished=!0;const ye=X[P].splice(0);for(let Ne=0;Ne<ye.length;Ne++)ye[Ne]();if(Ie.emit("finish"),X.autoDestroy){const Ne=Ie._readableState;(!Ne||Ne.autoDestroy&&(Ne.endEmitted||Ne.readable===!1))&&Ie.destroy()}}i(V.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Ie){this._writableState&&(this._writableState.destroyed=Ie)}},writable:{__proto__:null,get(){const Ie=this._writableState;return!!Ie&&Ie.writable!==!1&&!Ie.destroyed&&!Ie.errored&&!Ie.ending&&!Ie.ended},set(Ie){this._writableState&&(this._writableState.writable=!!Ie)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Ie=this._writableState;return Ie?!Ie.destroyed&&!Ie.ending&&Ie.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Le=p.destroy;V.prototype.destroy=function(Ie,X){const ye=this._writableState;return!ye.destroyed&&(ye.bufferedIndex<ye.buffered.length||ye[P].length)&&e.nextTick(ne,ye),Le.call(this,Ie,X),this},V.prototype._undestroy=p.undestroy,V.prototype._destroy=function(Ie,X){X(Ie)},V.prototype[u.captureRejectionSymbol]=function(Ie){this.destroy(Ie)};let He;function Fe(){return He===void 0&&(He={}),He}return V.fromWeb=function(Ie,X){return Fe().newStreamWritableFromWritableStream(Ie,X)},V.toWeb=function(Ie){return Fe().newWritableStreamFromStreamWritable(Ie)},XM}var JM,w7;function bEe(){if(w7)return JM;w7=1;const e=Mg(),t=Tp(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=Ff(),d=Ap(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:g}}=Lo(),{destroyer:y}=Ub(),v=Af(),x=uA(),w=UF(),{createDeferredPromise:S}=rl(),_=YX(),k=globalThis.Blob||t.Blob,T=typeof k<"u"?function(q){return q instanceof k}:function(q){return!1},A=globalThis.AbortController||s1().AbortController,{FunctionPrototypeCall:R}=ci();class M extends v{constructor(q){super(q),(q==null?void 0:q.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(q==null?void 0:q.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}JM=function P(q,I){if(l(q))return q;if(a(q))return F({readable:q});if(o(q))return F({writable:q});if(i(q))return F({writable:!1,readable:!1});if(c(q))return F({readable:x.fromWeb(q)});if(u(q))return F({writable:w.fromWeb(q)});if(typeof q=="function"){const{value:D,write:z,final:$,destroy:Y}=j(q);if(s(D))return _(M,D,{objectMode:!0,write:z,final:$,destroy:Y});const B=D==null?void 0:D.then;if(typeof B=="function"){let G;const Z=R(B,D,ne=>{if(ne!=null)throw new g("nully","body",ne)},ne=>{y(G,ne)});return G=new M({objectMode:!0,readable:!1,write:z,final(ne){$(async()=>{try{await Z,e.nextTick(ne,null)}catch(ae){e.nextTick(ne,ae)}})},destroy:Y})}throw new g("Iterable, AsyncIterable or AsyncFunction",I,D)}if(T(q))return P(q.arrayBuffer());if(s(q))return _(M,q,{objectMode:!0,writable:!1});if(c(q==null?void 0:q.readable)&&u(q==null?void 0:q.writable))return M.fromWeb(q);if(typeof(q==null?void 0:q.writable)=="object"||typeof(q==null?void 0:q.readable)=="object"){const D=q!=null&&q.readable?a(q==null?void 0:q.readable)?q==null?void 0:q.readable:P(q.readable):void 0,z=q!=null&&q.writable?o(q==null?void 0:q.writable)?q==null?void 0:q.writable:P(q.writable):void 0;return F({readable:D,writable:z})}const V=q==null?void 0:q.then;if(typeof V=="function"){let D;return R(V,q,z=>{z!=null&&D.push(z),D.push(null)},z=>{y(D,z)}),D=new M({objectMode:!0,writable:!1,read(){}})}throw new p(I,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],q)};function j(P){let{promise:q,resolve:I}=S();const V=new A,D=V.signal;return{value:P(async function*(){for(;;){const $=q;q=null;const{chunk:Y,done:B,cb:G}=await $;if(e.nextTick(G),B)return;if(D.aborted)throw new h(void 0,{cause:D.reason});({promise:q,resolve:I}=S()),yield Y}}(),{signal:D}),write($,Y,B){const G=I;I=null,G({chunk:$,done:!1,cb:B})},final($){const Y=I;I=null,Y({done:!0,cb:$})},destroy($,Y){V.abort(),Y($)}}}function F(P){const q=P.readable&&typeof P.readable.read!="function"?x.wrap(P.readable):P.readable,I=P.writable;let V=!!n(q),D=!!r(I),z,$,Y,B,G;function Z(ne){const ae=B;B=null,ae?ae(ne):ne&&G.destroy(ne)}return G=new M({readableObjectMode:!!(q!=null&&q.readableObjectMode),writableObjectMode:!!(I!=null&&I.writableObjectMode),readable:V,writable:D}),D&&(d(I,ne=>{D=!1,ne&&y(q,ne),Z(ne)}),G._write=function(ne,ae,le){I.write(ne,ae)?le():z=le},G._final=function(ne){I.end(),$=ne},I.on("drain",function(){if(z){const ne=z;z=null,ne()}}),I.on("finish",function(){if($){const ne=$;$=null,ne()}})),V&&(d(q,ne=>{V=!1,ne&&y(q,ne),Z(ne)}),q.on("readable",function(){if(Y){const ne=Y;Y=null,ne()}}),q.on("end",function(){G.push(null)}),G._read=function(){for(;;){const ne=q.read();if(ne===null){Y=G._read;return}if(!G.push(ne))return}}),G._destroy=function(ne,ae){!ne&&B!==null&&(ne=new h),Y=null,z=null,$=null,B===null?ae(ne):(B=ae,y(I,ne),y(q,ne))},G}return JM}var QM,S7;function Af(){if(S7)return QM;S7=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ci();QM=a;const s=uA(),i=UF();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=bEe()),c(u,"body")},QM}var ej,_7;function ZX(){if(_7)return ej;_7=1;const{ObjectSetPrototypeOf:e,Symbol:t}=ci();ej=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=Lo().codes,r=Af(),{getHighWaterMark:s}=cA();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,p=this._writableState,g=h.length;this._transform(c,u,(y,v)=>{if(y){d(y);return}v!=null&&this.push(v),p.ended||g===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},ej}var tj,C7;function XX(){if(C7)return tj;C7=1;const{ObjectSetPrototypeOf:e}=ci();tj=n;const t=ZX();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},tj}var nj,k7;function qF(){if(k7)return nj;k7=1;const e=Mg(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=ci(),i=Ap(),{once:a}=rl(),o=Ub(),l=Af(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:p,ERR_STREAM_PREMATURE_CLOSE:g},AbortError:y}=Lo(),{validateFunction:v,validateAbortSignal:x}=CS(),{isIterable:w,isReadable:S,isReadableNodeStream:_,isNodeStream:k,isTransformStream:T,isWebStream:A,isReadableStream:R,isReadableFinished:M}=Ff(),j=globalThis.AbortController||s1().AbortController;let F,P,q;function I(ne,ae,le){let Se=!1;ne.on("close",()=>{Se=!0});const Ee=i(ne,{readable:ae,writable:le},he=>{Se=!he});return{destroy:he=>{Se||(Se=!0,o.destroyer(ne,he||new p("pipe")))},cleanup:Ee}}function V(ne){return v(ne[ne.length-1],"streams[stream.length - 1]"),ne.pop()}function D(ne){if(w(ne))return ne;if(_(ne))return z(ne);throw new u("val",["Readable","Iterable","AsyncIterable"],ne)}async function*z(ne){P||(P=uA()),yield*P.prototype[r].call(ne)}async function $(ne,ae,le,{end:Se}){let Ee,he=null;const pe=Fe=>{if(Fe&&(Ee=Fe),he){const Ie=he;he=null,Ie()}},Le=()=>new n((Fe,Ie)=>{Ee?Ie(Ee):he=()=>{Ee?Ie(Ee):Fe()}});ae.on("drain",pe);const He=i(ae,{readable:!1},pe);try{ae.writableNeedDrain&&await Le();for await(const Fe of ne)ae.write(Fe)||await Le();Se&&(ae.end(),await Le()),le()}catch(Fe){le(Ee!==Fe?c(Ee,Fe):Fe)}finally{He(),ae.off("drain",pe)}}async function Y(ne,ae,le,{end:Se}){T(ae)&&(ae=ae.writable);const Ee=ae.getWriter();try{for await(const he of ne)await Ee.ready,Ee.write(he).catch(()=>{});await Ee.ready,Se&&await Ee.close(),le()}catch(he){try{await Ee.abort(he),le(he)}catch(pe){le(pe)}}}function B(...ne){return G(ne,a(V(ne)))}function G(ne,ae,le){if(ne.length===1&&t(ne[0])&&(ne=ne[0]),ne.length<2)throw new h("streams");const Se=new j,Ee=Se.signal,he=le==null?void 0:le.signal,pe=[];x(he,"options.signal");function Le(){fe(new y)}q=q||rl().addAbortListener;let He;he&&(He=q(he,Le));let Fe,Ie;const X=[];let ye=0;function Ne(Be){fe(Be,--ye===0)}function fe(Be,je){var ot;if(Be&&(!Fe||Fe.code==="ERR_STREAM_PREMATURE_CLOSE")&&(Fe=Be),!(!Fe&&!je)){for(;X.length;)X.shift()(Fe);(ot=He)===null||ot===void 0||ot[s](),Se.abort(),je&&(Fe||pe.forEach(Et=>Et()),e.nextTick(ae,Fe,Ie))}}let ce;for(let Be=0;Be<ne.length;Be++){const je=ne[Be],ot=Be<ne.length-1,Et=Be>0,ut=ot||(le==null?void 0:le.end)!==!1,Pt=Be===ne.length-1;if(k(je)){let $t=function(Ft){Ft&&Ft.name!=="AbortError"&&Ft.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Ne(Ft)};if(ut){const{destroy:Ft,cleanup:Ht}=I(je,ot,Et);X.push(Ft),S(je)&&Pt&&pe.push(Ht)}je.on("error",$t),S(je)&&Pt&&pe.push(()=>{je.removeListener("error",$t)})}if(Be===0)if(typeof je=="function"){if(ce=je({signal:Ee}),!w(ce))throw new d("Iterable, AsyncIterable or Stream","source",ce)}else w(je)||_(je)||T(je)?ce=je:ce=l.from(je);else if(typeof je=="function"){if(T(ce)){var se;ce=D((se=ce)===null||se===void 0?void 0:se.readable)}else ce=D(ce);if(ce=je(ce,{signal:Ee}),ot){if(!w(ce,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,ce)}else{var Pe;F||(F=XX());const $t=new F({objectMode:!0}),Ft=(Pe=ce)===null||Pe===void 0?void 0:Pe.then;if(typeof Ft=="function")ye++,Ft.call(ce,U=>{Ie=U,U!=null&&$t.write(U),ut&&$t.end(),e.nextTick(Ne)},U=>{$t.destroy(U),e.nextTick(Ne,U)});else if(w(ce,!0))ye++,$(ce,$t,Ne,{end:ut});else if(R(ce)||T(ce)){const U=ce.readable||ce;ye++,$(U,$t,Ne,{end:ut})}else throw new d("AsyncIterable or Promise","destination",ce);ce=$t;const{destroy:Ht,cleanup:Ce}=I(ce,!1,!0);X.push(Ht),Pt&&pe.push(Ce)}}else if(k(je)){if(_(ce)){ye+=2;const $t=Z(ce,je,Ne,{end:ut});S(je)&&Pt&&pe.push($t)}else if(T(ce)||R(ce)){const $t=ce.readable||ce;ye++,$($t,je,Ne,{end:ut})}else if(w(ce))ye++,$(ce,je,Ne,{end:ut});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ce);ce=je}else if(A(je)){if(_(ce))ye++,Y(D(ce),je,Ne,{end:ut});else if(R(ce)||w(ce))ye++,Y(ce,je,Ne,{end:ut});else if(T(ce))ye++,Y(ce.readable,je,Ne,{end:ut});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],ce);ce=je}else ce=l.from(je)}return(Ee!=null&&Ee.aborted||he!=null&&he.aborted)&&e.nextTick(Le),ce}function Z(ne,ae,le,{end:Se}){let Ee=!1;if(ae.on("close",()=>{Ee||le(new g)}),ne.pipe(ae,{end:!1}),Se){let he=function(){Ee=!0,ae.end()};M(ne)?e.nextTick(he):ne.once("end",he)}else le();return i(ne,{readable:!0,writable:!1},he=>{const pe=ne._readableState;he&&he.code==="ERR_STREAM_PREMATURE_CLOSE"&&pe&&pe.ended&&!pe.errored&&!pe.errorEmitted?ne.once("end",le).once("error",le):le(he)}),i(ae,{readable:!1,writable:!0},le)}return nj={pipelineImpl:G,pipeline:B},nj}var rj,E7;function JX(){if(E7)return rj;E7=1;const{pipeline:e}=qF(),t=Af(),{destroyer:n}=Ub(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=Ff(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=Lo(),p=Ap();return rj=function(...y){if(y.length===0)throw new h("streams");if(y.length===1)return t.from(y[0]);const v=[...y];if(typeof y[0]=="function"&&(y[0]=t.from(y[0])),typeof y[y.length-1]=="function"){const F=y.length-1;y[F]=t.from(y[F])}for(let F=0;F<y.length;++F)if(!(!r(y[F])&&!a(y[F]))){if(F<y.length-1&&!(s(y[F])||c(y[F])||o(y[F])))throw new d(`streams[${F}]`,v[F],"must be readable");if(F>0&&!(i(y[F])||l(y[F])||o(y[F])))throw new d(`streams[${F}]`,v[F],"must be writable")}let x,w,S,_,k;function T(F){const P=_;_=null,P?P(F):F?k.destroy(F):!j&&!M&&k.destroy()}const A=y[0],R=e(y,T),M=!!(i(A)||l(A)||o(A)),j=!!(s(R)||c(R)||o(R));if(k=new t({writableObjectMode:!!(A!=null&&A.writableObjectMode),readableObjectMode:!!(R!=null&&R.readableObjectMode),writable:M,readable:j}),M){if(r(A))k._write=function(P,q,I){A.write(P,q)?I():x=I},k._final=function(P){A.end(),w=P},A.on("drain",function(){if(x){const P=x;x=null,P()}});else if(a(A)){const q=(o(A)?A.writable:A).getWriter();k._write=async function(I,V,D){try{await q.ready,q.write(I).catch(()=>{}),D()}catch(z){D(z)}},k._final=async function(I){try{await q.ready,q.close().catch(()=>{}),w=I}catch(V){I(V)}}}const F=o(R)?R.readable:R;p(F,()=>{if(w){const P=w;w=null,P()}})}if(j){if(r(R))R.on("readable",function(){if(S){const F=S;S=null,F()}}),R.on("end",function(){k.push(null)}),k._read=function(){for(;;){const F=R.read();if(F===null){S=k._read;return}if(!k.push(F))return}};else if(a(R)){const P=(o(R)?R.readable:R).getReader();k._read=async function(){for(;;)try{const{value:q,done:I}=await P.read();if(!k.push(q))return;if(I){k.push(null);return}}catch{return}}}}return k._destroy=function(F,P){!F&&_!==null&&(F=new u),S=null,x=null,w=null,_===null?P(F):(_=P,r(R)&&n(R,F))},k},rj}var T7;function vEe(){if(T7)return zC;T7=1;const e=globalThis.AbortController||s1().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=Lo(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=CS(),c=ci().Symbol("kWeak"),u=ci().Symbol("kResistStopPropagation"),{finished:d}=Ap(),h=JX(),{addAbortSignalNoValidate:p}=lA(),{isWritable:g,isNodeStream:y}=Ff(),{deprecate:v}=rl(),{ArrayPrototypePush:x,Boolean:w,MathFloor:S,Number:_,NumberIsNaN:k,Promise:T,PromiseReject:A,PromiseResolve:R,PromisePrototypeThen:M,Symbol:j}=ci(),F=j("kEmpty"),P=j("kEof");function q(he,pe){if(pe!=null&&l(pe,"options"),(pe==null?void 0:pe.signal)!=null&&a(pe.signal,"options.signal"),y(he)&&!g(he))throw new t("stream",he,"must be writable");const Le=h(this,he);return pe!=null&&pe.signal&&p(pe.signal,Le),Le}function I(he,pe){if(typeof he!="function")throw new n("fn",["Function","AsyncFunction"],he);pe!=null&&l(pe,"options"),(pe==null?void 0:pe.signal)!=null&&a(pe.signal,"options.signal");let Le=1;(pe==null?void 0:pe.concurrency)!=null&&(Le=S(pe.concurrency));let He=Le-1;return(pe==null?void 0:pe.highWaterMark)!=null&&(He=S(pe.highWaterMark)),o(Le,"options.concurrency",1),o(He,"options.highWaterMark",0),He+=Le,(async function*(){const Ie=rl().AbortSignalAny([pe==null?void 0:pe.signal].filter(w)),X=this,ye=[],Ne={signal:Ie};let fe,ce,se=!1,Pe=0;function Be(){se=!0,je()}function je(){Pe-=1,ot()}function ot(){ce&&!se&&Pe<Le&&ye.length<He&&(ce(),ce=null)}async function Et(){try{for await(let ut of X){if(se)return;if(Ie.aborted)throw new i;try{if(ut=he(ut,Ne),ut===F)continue;ut=R(ut)}catch(Pt){ut=A(Pt)}Pe+=1,M(ut,je,Be),ye.push(ut),fe&&(fe(),fe=null),!se&&(ye.length>=He||Pe>=Le)&&await new T(Pt=>{ce=Pt})}ye.push(P)}catch(ut){const Pt=A(ut);M(Pt,je,Be),ye.push(Pt)}finally{se=!0,fe&&(fe(),fe=null)}}Et();try{for(;;){for(;ye.length>0;){const ut=await ye[0];if(ut===P)return;if(Ie.aborted)throw new i;ut!==F&&(yield ut),ye.shift(),ot()}await new T(ut=>{fe=ut})}}finally{se=!0,ce&&(ce(),ce=null)}}).call(this)}function V(he=void 0){return he!=null&&l(he,"options"),(he==null?void 0:he.signal)!=null&&a(he.signal,"options.signal"),(async function*(){let Le=0;for await(const Fe of this){var He;if(he!=null&&(He=he.signal)!==null&&He!==void 0&&He.aborted)throw new i({cause:he.signal.reason});yield[Le++,Fe]}}).call(this)}async function D(he,pe=void 0){for await(const Le of B.call(this,he,pe))return!0;return!1}async function z(he,pe=void 0){if(typeof he!="function")throw new n("fn",["Function","AsyncFunction"],he);return!await D.call(this,async(...Le)=>!await he(...Le),pe)}async function $(he,pe){for await(const Le of B.call(this,he,pe))return Le}async function Y(he,pe){if(typeof he!="function")throw new n("fn",["Function","AsyncFunction"],he);async function Le(He,Fe){return await he(He,Fe),F}for await(const He of I.call(this,Le,pe));}function B(he,pe){if(typeof he!="function")throw new n("fn",["Function","AsyncFunction"],he);async function Le(He,Fe){return await he(He,Fe)?He:F}return I.call(this,Le,pe)}class G extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function Z(he,pe,Le){var He;if(typeof he!="function")throw new n("reducer",["Function","AsyncFunction"],he);Le!=null&&l(Le,"options"),(Le==null?void 0:Le.signal)!=null&&a(Le.signal,"options.signal");let Fe=arguments.length>1;if(Le!=null&&(He=Le.signal)!==null&&He!==void 0&&He.aborted){const fe=new i(void 0,{cause:Le.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(fe)),fe}const Ie=new e,X=Ie.signal;if(Le!=null&&Le.signal){const fe={once:!0,[c]:this,[u]:!0};Le.signal.addEventListener("abort",()=>Ie.abort(),fe)}let ye=!1;try{for await(const fe of this){var Ne;if(ye=!0,Le!=null&&(Ne=Le.signal)!==null&&Ne!==void 0&&Ne.aborted)throw new i;Fe?pe=await he(pe,fe,{signal:X}):(pe=fe,Fe=!0)}if(!ye&&!Fe)throw new G}finally{Ie.abort()}return pe}async function ne(he){he!=null&&l(he,"options"),(he==null?void 0:he.signal)!=null&&a(he.signal,"options.signal");const pe=[];for await(const He of this){var Le;if(he!=null&&(Le=he.signal)!==null&&Le!==void 0&&Le.aborted)throw new i(void 0,{cause:he.signal.reason});x(pe,He)}return pe}function ae(he,pe){const Le=I.call(this,he,pe);return(async function*(){for await(const Fe of Le)yield*Fe}).call(this)}function le(he){if(he=_(he),k(he))return 0;if(he<0)throw new s("number",">= 0",he);return he}function Se(he,pe=void 0){return pe!=null&&l(pe,"options"),(pe==null?void 0:pe.signal)!=null&&a(pe.signal,"options.signal"),he=le(he),(async function*(){var He;if(pe!=null&&(He=pe.signal)!==null&&He!==void 0&&He.aborted)throw new i;for await(const Ie of this){var Fe;if(pe!=null&&(Fe=pe.signal)!==null&&Fe!==void 0&&Fe.aborted)throw new i;he--<=0&&(yield Ie)}}).call(this)}function Ee(he,pe=void 0){return pe!=null&&l(pe,"options"),(pe==null?void 0:pe.signal)!=null&&a(pe.signal,"options.signal"),he=le(he),(async function*(){var He;if(pe!=null&&(He=pe.signal)!==null&&He!==void 0&&He.aborted)throw new i;for await(const Ie of this){var Fe;if(pe!=null&&(Fe=pe.signal)!==null&&Fe!==void 0&&Fe.aborted)throw new i;if(he-- >0&&(yield Ie),he<=0)return}}).call(this)}return zC.streamReturningOperators={asIndexedPairs:v(V,"readable.asIndexedPairs will be removed in a future version."),drop:Se,filter:B,flatMap:ae,map:I,take:Ee,compose:q},zC.promiseReturningOperators={every:z,forEach:Y,reduce:Z,toArray:ne,some:D,find:$},zC}var sj,A7;function QX(){if(A7)return sj;A7=1;const{ArrayPrototypePop:e,Promise:t}=ci(),{isIterable:n,isNodeStream:r,isWebStream:s}=Ff(),{pipelineImpl:i}=qF(),{finished:a}=Ap();eJ();function o(...l){return new t((c,u)=>{let d,h;const p=l[l.length-1];if(p&&typeof p=="object"&&!r(p)&&!n(p)&&!s(p)){const g=e(l);d=g.signal,h=g.end}i(l,(g,y)=>{g?u(g):c(y)},{signal:d,end:h})})}return sj={finished:a,pipeline:o},sj}var N7;function eJ(){if(N7)return PM.exports;N7=1;const{Buffer:e}=Tp(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ci(),{promisify:{custom:s}}=rl(),{streamReturningOperators:i,promiseReturningOperators:a}=vEe(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=Lo(),l=JX(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=cA(),{pipeline:d}=qF(),{destroyer:h}=Ub(),p=Ap(),g=QX(),y=Ff(),v=PM.exports=BF().Stream;v.isDestroyed=y.isDestroyed,v.isDisturbed=y.isDisturbed,v.isErrored=y.isErrored,v.isReadable=y.isReadable,v.isWritable=y.isWritable,v.Readable=uA();for(const w of n(i)){let _=function(...k){if(new.target)throw o();return v.Readable.from(r(S,this,k))};const S=i[w];t(_,"name",{__proto__:null,value:S.name}),t(_,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let _=function(...k){if(new.target)throw o();return r(S,this,k)};const S=a[w];t(_,"name",{__proto__:null,value:S.name}),t(_,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:_,enumerable:!1,configurable:!0,writable:!0})}v.Writable=UF(),v.Duplex=Af(),v.Transform=ZX(),v.PassThrough=XX(),v.pipeline=d;const{addAbortSignal:x}=lA();return v.addAbortSignal=x,v.finished=p,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return g}}),t(d,s,{__proto__:null,enumerable:!0,get(){return g.pipeline}}),t(p,s,{__proto__:null,enumerable:!0,get(){return g.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},PM.exports}var R7;function xEe(){return R7||(R7=1,function(e){const t=eJ(),n=QX(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(jM)),jM.exports}var tJ=xEe();class VF extends tJ.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Je(vt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Je(vt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class WF extends tJ.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Ja(new Je(vt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Ja(new Je(vt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Je(vt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Je(vt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Je(vt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var _c=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Cc=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class ao{get position(){return this.flag&ag?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=co(t,n);Object.assign(this,_g(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&sA||this.inode.flags&Jo.Sync)}_emitChange(){$a(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Je.With("EBADF",this.path,"chown");this.dirty=!0,jX(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=kp(t,-1);if(n<0)throw new Je(vt.EINVAL,"Invalid mode");if(this.closed)throw Je.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>Is?-61441:Is)|n,(this._isSync||n>Is)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Je.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Je.With("EBADF",this.path,"truncate");if(t<0)throw new Je(vt.EINVAL);if(this.dirty=!0,!(this.flag&Xa||this.flag&mf))throw new Je(vt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Je.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=Qk(t),this.inode.mtimeMs=Qk(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=gf(n,"utf8","a",420);if(!(yf(r.flag)&ag))throw new Je(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Je(vt.EINVAL,"Encoding not specified");const i=typeof t=="string"?zs.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Je.With("EBADF",this.path,"read");if(this.flag&Xa)throw new Je(vt.EPERM,"File not opened with a readable mode");this.inode.flags&Jo.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!t1(this.inode)&&!e1(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=gf(t,null,"r",292);if(yf(n.flag)&Xa)throw new Je(vt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=zs.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Je.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Je.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&Jo.Immutable)throw new Je(vt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&Xa)throw Je.With("EBADF",this.path,"readLines");return $ke({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Je.With("EBADF",this.path,"stat");if(!bs(this.context,this.inode,ia))throw Je.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Ng(this.inode):new Df(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Je.With("EBADF",this.path,"write");if(this.inode.flags&Jo.Immutable)throw new Je(vt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&Xa||this.flag&mf))throw new Je(vt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!t1(this.inode)&&!e1(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=zs.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=gf(n,"utf8","w",420),s=yf(r.flag);if(!(s&Xa||s&mf))throw new Je(vt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Je(vt.EINVAL,"Encoding not specified");const i=typeof t=="string"?zs.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Je.With("EBADF",this.path,"close");await this.sync(),this.dispose(),DX(this.context,this.fd)}dispose(t){if(this.closed)throw Je.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Je.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&Xa)throw Je.With("EBADF",this.path,"createReadStream");return new VF(t,this)}createWriteStream(t={}){if(this.closed)throw Je.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&Jo.Immutable)throw new Je(vt.EPERM,"File is immutable",this.path,"createWriteStream");return new WF(t,this)}}async function nJ(e,t){e=Un(e),t=Un(t);const n=Dr(e,this),r=Dr(t,this);if(!(await qb.call(this,rs(e))).hasAccess(bi,this))throw Je.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),$a(this,"rename",e.toString()),$a(this,"change",t.toString());return}await pA.call(this,t,await hA(e)),await fA.call(this,e),$a(this,"rename",e.toString())}catch(s){throw vs(s,{[n.path]:e,[r.path]:t})}}async function kS(e){try{const{fs:t,path:n}=Dr(await Np.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Je&&t.code=="ENOENT")return!1;throw t}}async function qb(e,t){e=Un(e);const{fs:n,path:r}=Dr(await Np.call(this,e),this);try{const s=await n.stat(r);if(aa&&!bs(this,s,ia))throw Je.With("EACCES",r,"stat");return t!=null&&t.bigint?new Ng(s):new Df(s)}catch(s){throw vs(s,{[r]:e})}}async function dA(e,t){e=Un(e);const{fs:n,path:r}=Dr(e,this);try{const s=await n.stat(r);if(aa&&!bs(this,s,ia))throw Je.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Ng(s):new Df(s)}catch(s){throw vs(s,{[r]:e})}}async function rJ(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await _c(n,await kc.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Cc(n);r&&await r}}async function fA(e){e=Un(e);const{fs:t,path:n}=Dr(e,this);try{if(aa&&!bs(this,await t.stat(n),bi))throw Je.With("EACCES",n,"unlink");await t.unlink(n),$a(this,"rename",e.toString())}catch(r){throw vs(r,{[n]:e})}}async function Vb(e,t,n){var r;t=Un(t);const s=kp(n.mode,420),i=yf(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await rE(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&tA))throw Je.With("ENOENT",a,"_open");const d=await o.stat(rs(l));if(!bs(e,d,bi))throw Je.With("EACCES",rs(a),"_open");if(!su(d))throw Je.With("ENOTDIR",rs(a),"_open");const{euid:h,egid:p}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:lu.credentials,g=await o.createFile(l,{mode:s,uid:d.mode&xS?d.uid:h,gid:d.mode&wS?d.gid:p});return new ao(e,tE(new eE(e,t,o,l,i,g)))}if(!bs(e,c,FX(i)))throw Je.With("EACCES",a,"_open");if(i&nA)throw Je.With("EEXIST",a,"_open");const u=new ao(e,tE(new eE(e,t,o,l,i,c)));return i&rA&&await u.truncate(0),u}async function kc(e,t="r",n=420){return await Vb(this,e,{flag:t,mode:n})}async function hA(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=gf(t,null,"r",292);return await _c(n,typeof e=="object"&&"fd"in e?e:await kc.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=Cc(n);r&&await r}}async function pA(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=gf(n,"utf8","w+",420),i=_c(r,e instanceof ao?e:await kc.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Je(vt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function sJ(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=gf(n,"utf8","a",420);if(!(yf(s.flag)&ag))throw new Je(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Je(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?zs.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await _c(r,typeof e=="object"&&"fd"in e?e:await kc.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function HF(e){e=await Np.call(this,e);const{fs:t,path:n}=Dr(e,this);try{const r=await t.stat(n);if(!r)throw Je.With("ENOENT",e,"rmdir");if(!su(r))throw Je.With("ENOTDIR",n,"rmdir");if(aa&&!bs(this,r,bi))throw Je.With("EACCES",n,"rmdir");await t.rmdir(n),$a(this,"rename",e.toString())}catch(r){throw vs(r,{[n]:e})}}async function mA(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:lu.credentials;t=typeof t=="object"?t:{mode:t};const a=kp(t==null?void 0:t.mode,511);e=await Np.call(this,e);const{fs:o,path:l,root:c}=Dr(e,this),u={[l]:e},d=async(h,p)=>{if(!bs(this,p,bi))throw Je.With("EACCES",rs(h),"mkdir");const g=await o.mkdir(h,{mode:a,uid:p.mode&xS?p.uid:s,gid:p.mode&wS?p.gid:i});return $a(this,"rename",h),g};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(rs(l)));return}const h=[];for(let g=l,y=e;!await o.exists(g);g=rs(g),y=rs(y))h.unshift(g),u[g]=y;if(!h.length)return;const p=[await o.stat(rs(h[0]))];for(const[g,y]of h.entries())p.push(await d(y,p[g]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw vs(h,u)}}async function jg(e,t){t=typeof t=="object"?t:{encoding:t},e=await Np.call(this,e);const{fs:n,path:r}=Dr(e,this),s=await n.stat(r).catch(l=>ks(vs(l,{[r]:e})));if(!s)throw Je.With("ENOENT",e,"readdir");if(!bs(this,s,ia))throw Je.With("EACCES",e,"readdir");if(!su(s))throw Je.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>ks(vs(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(ds(r,l)).catch(u=>{if(u.code!="ENOENT")throw vs(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new r1(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(zs.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!su(c))))for(const u of await jg.call(this,ds(e,l),t))u instanceof r1?(u.path=ds(l,u.path),a.push(u)):zs.isBuffer(u)?a.push(zs.from(ds(l,bF(u)))):a.push(ds(l,u))};return await Promise.all(i.map(o)),a}async function iJ(e,t){e=Un(e),t=Un(t);const{fs:n,path:r}=Dr(e,this),s=Dr(t,this);if(n!=s.fs)throw Je.With("EXDEV",t,"link");try{if(aa&&!bs(this,await n.stat(rs(r)),ia))throw Je.With("EACCES",rs(r),"link");if(aa&&!(await qb.call(this,rs(t))).hasAccess(bi,this))throw Je.With("EACCES",rs(t),"link");if(aa&&!bs(this,await n.stat(r),ia))throw Je.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw vs(i,{[s.path]:t,[r]:e})}}async function aJ(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Je(vt.EINVAL,"Invalid symlink type: "+n);if(t=Un(t),await kS.call(this,t))throw Je.With("EEXIST",t,"symlink");const s=_c(r,await Vb(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(Un(e,!0)),await s.chmod(Of)}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function nE(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await _c(n,await Vb(this,Un(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=Cc(n);r&&await r}}async function oJ(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await _c(r,await kc.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function lJ(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await _c(r,await Vb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function cJ(e,t){const n={stack:[],error:void 0,hasError:!1};try{await _c(n,await kc.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Cc(n);r&&await r}}async function uJ(e,t){const n={stack:[],error:void 0,hasError:!1};try{await _c(n,await Vb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Cc(n);r&&await r}}async function GF(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await _c(r,await kc.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function dJ(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await _c(r,await Vb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=Cc(r);s&&await s}}async function rE(e,t,n){if(n){const l=Dr(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Dr(t,e),c=await l.fs.stat(l.path);if(!Yy(c))return{...l,fullPath:t,stats:c};const u=Tf.call(e,rs(t),(await nE.call(e,t)).toString());return await rE(e,u)}catch{}const{base:r,dir:s}=Mu(t),i=s=="/"?"/":await Np.call(e,s),a=ds(i,r),o=Dr(a,e);try{const l=await o.fs.stat(o.path);if(!Yy(l))return{...o,fullPath:a,stats:l};const c=Tf.call(e,i,(await nE.call(e,a)).toString());return await rE(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw vs(l,{[o.path]:a})}}async function Np(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Un(e);const{fullPath:s}=await rE(this,e);if(r=="utf8"||r=="utf-8")return s;const i=zs.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function wEe(e,t={}){const n=new zX(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function fJ(e,t=kF){if(!(await qb.call(this,e)).hasAccess(t,this))throw new Je(vt.EACCES)}async function KF(e,t){e=Un(e);const n=await dA.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&Is){case Vi:if(t!=null&&t.recursive)for(const r of await jg.call(this,e))await KF.call(this,ds(e,r),t);await HF.call(this,e);break;case Xc:case Of:case Eg:case Tg:await fA.call(this,e);break;case Ag:case kg:default:throw new Je(vt.EPERM,"File type not supported",e,"rm")}}async function hJ(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await mA.call(this,s),n=="buffer"?zs.from(s):s}async function YF(e,t,n){if(e=Un(e),t=Un(t),n&&n&EF&&await kS.call(this,t))throw new Je(vt.EEXIST,"Destination file already exists",t,"copyFile");await pA.call(this,t,await hA.call(this,e)),$a(this,"rename",t.toString())}function pJ(e,t){return e=Un(e),Promise.resolve(new $F(e,this))}async function ZF(e,t,n){e=Un(e),t=Un(t);const r=await dA.call(this,e);if(n!=null&&n.errorOnExist&&await kS.call(this,t))throw new Je(vt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&Is){case Vi:{if(!(n!=null&&n.recursive))throw new Je(vt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([jg.call(this,e,{withFileTypes:!0}),mA.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(ds(e,a.name),ds(t,a.name))||await ZF.call(this,ds(e,a.name),ds(t,a.name),n)};await Promise.all(s.map(i));break}case Xc:case Of:await YF.call(this,e,t);break;case Eg:case Tg:case Ag:case kg:default:throw new Je(vt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await GF.call(this,t,r.atime,r.mtime)}async function mJ(e,t){e=Un(e);const{fs:n}=Dr(e,this);return Promise.resolve($X(n,t==null?void 0:t.bigint))}function gJ(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await jg(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await qb(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const SEe=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:ao,access:fJ,appendFile:sJ,chmod:cJ,chown:oJ,constants:IX,copyFile:YF,cp:ZF,exists:kS,glob:gJ,lchmod:uJ,lchown:lJ,link:iJ,lstat:dA,lutimes:dJ,mkdir:mA,mkdtemp:hJ,open:kc,opendir:pJ,readFile:hA,readdir:jg,readlink:nE,realpath:Np,rename:nJ,rm:KF,rmdir:HF,stat:qb,statfs:mJ,symlink:aJ,truncate:rJ,unlink:fA,utimes:GF,watch:wEe,writeFile:pA},Symbol.toStringTag,{value:"Module"})),wr=()=>{};async function _Ee(e){const t=[];for await(const n of e)t.push(n);return t}function CEe(e,t,n=wr){nJ.call(this,e,t).then(()=>n()).catch(n)}function kEe(e,t=wr){kS.call(this,e).then(t).catch(()=>t(!1))}function EEe(e,t,n=wr){n=typeof t=="function"?t:n,qb.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function TEe(e,t,n=wr){n=typeof t=="function"?t:n,dA.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function AEe(e,t=0,n=wr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;rJ.call(this,e,r).then(()=>n()).catch(n)}function NEe(e,t=wr){fA.call(this,e).then(()=>t()).catch(t)}function REe(e,t,n,r=wr){const s=kp(n,420);r=typeof n=="function"?n:r,kc.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function IEe(e,t,n=wr){n=typeof t=="function"?t:n,hA.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function MEe(e,t,n,r=wr){r=typeof n=="function"?n:r,pA.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function jEe(e,t,n,r=wr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,sJ.call(this,e,t,s).then(()=>r()).catch(r)}function PEe(e,t,n=wr){n=typeof t=="function"?t:n,new ao(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Ng(r):r)).catch(n)}function OEe(e,t=wr){new ao(this,e).close().then(()=>t()).catch(t)}function DEe(e,t,n=wr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new ao(this,e);if(r<0)throw new Je(vt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function FEe(e,t=wr){new ao(this,e).sync().then(()=>t()).catch(t)}function LEe(e,t=wr){new ao(this,e).datasync().then(()=>t()).catch(t)}function $Ee(e,t,n,r,s,i=wr){let a,o,l,c,u;const d=new ao(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Je(vt.EINVAL,"Invalid arguments"));return}a=zs.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:p})=>h(void 0,p,a.toString(u))).catch(h)}else{a=zs.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:p})=>h(void 0,p,a)).catch(h)}}function BEe(e,t,n,r,s,i=wr){new ao(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function zEe(e,t,n,r=wr){new ao(this,e).chown(t,n).then(()=>r()).catch(r)}function UEe(e,t,n){new ao(this,e).chmod(t).then(()=>n()).catch(n)}function qEe(e,t,n,r=wr){new ao(this,e).utimes(t,n).then(()=>r()).catch(r)}function VEe(e,t=wr){HF.call(this,e).then(()=>t()).catch(t)}function WEe(e,t,n=wr){mA.call(this,e,t).then(()=>n()).catch(n)}function HEe(e,t,n=wr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};jg.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function GEe(e,t,n=wr){iJ.call(this,e,t).then(()=>n()).catch(n)}function KEe(e,t,n,r=wr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,aJ.call(this,e,t,s).then(()=>r()).catch(r)}function YEe(e,t,n=wr){n=typeof t=="function"?t:n,nE.call(this,e).then(r=>n(void 0,r)).catch(n)}function ZEe(e,t,n,r=wr){oJ.call(this,e,t,n).then(()=>r()).catch(r)}function XEe(e,t,n,r=wr){lJ.call(this,e,t,n).then(()=>r()).catch(r)}function JEe(e,t,n=wr){cJ.call(this,e,t).then(()=>n()).catch(n)}function QEe(e,t,n=wr){uJ.call(this,e,t).then(()=>n()).catch(n)}function eTe(e,t,n,r=wr){GF.call(this,e,t,n).then(()=>r()).catch(r)}function tTe(e,t,n,r=wr){dJ.call(this,e,t,n).then(()=>r()).catch(r)}function nTe(e,t,n=wr){n=typeof t=="function"?t:n,Np.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function rTe(e,t,n=wr){const r=typeof t=="number"?t:ia;n=typeof t=="function"?t:n,fJ.call(this,e,r).then(()=>n()).catch(n)}const ty=new Map;function sTe(e,t,n){const r=Un(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Je(vt.EINVAL,"No listener specified",e.toString(),"watchFile");if(ty.has(r)){const a=ty.get(r);a&&a.listeners.add(n);return}const i=new Vke(this,r,s);i.on("change",(a,o)=>{const l=ty.get(r);if(l)for(const c of l.listeners)c(a,o)}),ty.set(r,{watcher:i,listeners:new Set})}function iTe(e,t=wr){const n=Un(e),r=ty.get(n);r&&(t&&t!==wr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),ty.delete(n)))}function aTe(e,t,n){const r=new zX(this,Un(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||wr),r}function oTe(e,t){t=typeof t=="object"?t:{encoding:t};const n=kc.call(this,e,"r",t==null?void 0:t.mode);return new VF({...t,autoClose:!0},n)}function lTe(e,t){t=typeof t=="object"?t:{encoding:t};const n=kc.call(this,e,"w",t==null?void 0:t.mode);return new WF(t,n)}function cTe(e,t,n=wr){n=typeof t=="function"?t:n,KF.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function uTe(e,t,n=wr){n=typeof t=="function"?t:n,hJ.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function dTe(e,t,n,r=wr){r=typeof n=="function"?n:r,YF.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function fTe(e,t,n,r=wr){r=typeof n=="function"?n:r,new ao(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function hTe(e,t,n,r=wr){r=typeof n=="function"?n:r,new ao(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function pTe(e,t,n=wr){n=typeof t=="function"?t:n,pJ.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function mTe(e,t,n,r=wr){r=typeof n=="function"?n:r,ZF.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function gTe(e,t,n=wr){n=typeof t=="function"?t:n,mJ.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function yTe(e,t){const n=await kc.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function bTe(e,t,n=wr){n=typeof t=="function"?t:n;const r=gJ.call(this,e,typeof t=="function"?void 0:t);_Ee(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var gm=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,p=n.length-1;p>=0;p--){var g={};for(var y in r)g[y]=y==="access"?{}:r[y];for(var y in r.access)g.access[y]=r.access[y];g.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],g);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Sl=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},vTe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},sE;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(sE||(sE={}));let yJ=(()=>{var e,t,n,r,s;let i=[Cg()],a,o=[],l,c,u=[],d=[],h,p=[],g=[],y,v=[],x=[],w,S=[],_=[],k,T=[],A=[],R,M=[],j=[];return l=class{constructor(F=ks(new Je(vt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Sl(this,u,0),this.extsize=(Sl(this,d),Sl(this,p,0)),this.nextents=(Sl(this,g),Sl(this,v,0)),this.projid=(Sl(this,x),Sl(this,S,0)),this.cowextsize=(Sl(this,_),Sl(this,T,0)),this.pad=(Sl(this,A),Sl(this,M,[])),Sl(this,j),this.extsize=F.size,this.nextents=1,this.projid=F.uid,this.cowextsize=F.size;for(const P of Object.keys(Jo))F.flags&Jo[P]&&P in sE&&(this.xflags|=sE[P])}},vTe(l,"fsxattr"),(()=>{const F=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=sr).uint32.bind(e)],h=[(t=sr).uint32.bind(t)],y=[(n=sr).uint32.bind(n)],w=[(r=sr).uint32.bind(r)],k=[(s=sr).uint32.bind(s)],R=[sr.char(8)],gm(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:P=>"xflags"in P,get:P=>P.xflags,set:(P,q)=>{P.xflags=q}},metadata:F},u,d),gm(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:P=>"extsize"in P,get:P=>P.extsize,set:(P,q)=>{P.extsize=q}},metadata:F},p,g),gm(null,null,y,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:P=>"nextents"in P,get:P=>P.nextents,set:(P,q)=>{P.nextents=q}},metadata:F},v,x),gm(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:P=>"projid"in P,get:P=>P.projid,set:(P,q)=>{P.projid=q}},metadata:F},S,_),gm(null,null,k,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:P=>"cowextsize"in P,get:P=>P.cowextsize,set:(P,q)=>{P.cowextsize=q}},metadata:F},T,A),gm(null,null,R,{kind:"field",name:"pad",static:!1,private:!1,access:{has:P=>"pad"in P,get:P=>P.pad,set:(P,q)=>{P.pad=q}},metadata:F},M,j),gm(null,a={value:l},i,{kind:"class",name:l.name,metadata:F},null,o),l=a.value,F&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:F}),Sl(l,o)})(),l})();var Gs;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(Gs||(Gs={}));var Wc;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(Wc||(Wc={}));async function xTe(e,t,...n){e=Un(e);const{fs:r,path:s}=Dr(e,this);try{const i=new zi(await r.stat(s));switch(t){case Gs.GetFlags:case Wc.GetFlags:return i.flags;case Gs.SetFlags:case Wc.SetFlags:i.flags=n[0],await r.touch(s,i);return;case Gs.GetVersion:case Wc.GetVersion:return i.version;case Gs.SetVersion:case Wc.SetVersion:i.version=n[0],await r.touch(s,i);return;case Gs.Fiemap:break;case Gs.GetXattr:return new yJ(i);case Gs.SetXattr:break;case Gs.GetLabel:return r.label;case Gs.SetLabel:r.label=n[0];return;case Gs.GetUUID:return r.uuid;case Gs.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw vs(i,{[s]:e})}throw new Je(vt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function wTe(e,t,...n){e=Un(e);const{fs:r,path:s}=Dr(e,this);try{const i=new zi(r.statSync(s));switch(t){case Gs.GetFlags:case Wc.GetFlags:return i.flags;case Gs.SetFlags:case Wc.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case Gs.GetVersion:case Wc.GetVersion:return i.version;case Gs.SetVersion:case Wc.SetVersion:i.version=n[0],r.touchSync(s,i);return;case Gs.Fiemap:break;case Gs.GetXattr:return new yJ(i);case Gs.SetXattr:break;case Gs.GetLabel:return r.label;case Gs.SetLabel:r.label=n[0];return;case Gs.GetUUID:return r.uuid;case Gs.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw vs(i,{[s]:e})}throw new Je(vt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const STe=[];function Wb(e,t,n,r){if(!t.startsWith("user.")&&!STe.includes(t))throw new Je(vt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function _Te(e,t,n={}){var r;e=Un(e);const{fs:s,path:i}=Dr(e,this);Wb(this,t,e,"xattr.get");try{const a=await s.stat(i);if(aa&&!bs(this,a,ia))throw Je.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new ip);const o=a.attributes.get(t);if(!o)throw Je.With("ENODATA",i,"xattr.get");const l=zs.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw vs(a,{[i]:e})}}function CTe(e,t,n={}){var r;e=Un(e),Wb(this,t,e,"xattr.get");const{fs:s,path:i}=Dr(e,this);try{const a=s.statSync(i);if(aa&&!bs(this,a,ia))throw Je.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new ip);const o=a.attributes.get(t);if(!o)throw Je.With("ENODATA",i,"xattr.get");const l=zs.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw vs(a,{[i]:e})}}async function kTe(e,t,n,r={}){var s;e=Un(e);const{fs:i,path:a}=Dr(e,this);Wb(this,t,e,"xattr.set");try{const o=await i.stat(a);if(aa&&!bs(this,o,bi))throw Je.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new ip);const l=o.attributes.get(t);if(r.create&&l)throw Je.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Je.With("ENODATA",a,"xattr.set");o.attributes.set(t,zs.from(n)),await i.touch(a,_g(o,"attributes"))}catch(o){throw vs(o,{[a]:e})}}function ETe(e,t,n,r={}){var s;e=Un(e);const{fs:i,path:a}=Dr(e,this);Wb(this,t,e,"xattr.set");try{const o=i.statSync(a);if(aa&&!bs(this,o,bi))throw Je.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new ip);const l=o.attributes.get(t);if(r.create&&l)throw Je.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Je.With("ENODATA",a,"xattr.set");o.attributes.set(t,zs.from(n)),i.touchSync(a,_g(o,"attributes"))}catch(o){throw vs(o,{[a]:e})}}async function TTe(e,t){var n;e=Un(e);const{fs:r,path:s}=Dr(e,this);Wb(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(aa&&!bs(this,i,bi))throw Je.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new ip),!i.attributes.get(t))throw Je.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,_g(i,"attributes"))}catch(i){throw vs(i,{[s]:e})}}function ATe(e,t){var n;e=Un(e);const{fs:r,path:s}=Dr(e,this);Wb(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(aa&&!bs(this,i,bi))throw Je.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new ip),!i.attributes.get(t))throw Je.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,_g(i,"attributes"))}catch(i){throw vs(i,{[s]:e})}}async function NTe(e){e=Un(e);const{fs:t,path:n}=Dr(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw vs(r,{[n]:e})}}function RTe(e){e=Un(e);const{fs:t,path:n}=Dr(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw vs(r,{[n]:e})}}const ITe=Object.freeze(Object.defineProperty({__proto__:null,get:_Te,getSync:CTe,list:NTe,listSync:RTe,remove:TTe,removeSync:ATe,set:kTe,setSync:ETe},Symbol.toStringTag,{value:"Module"})),ka=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:Eke,Dir:$F,Dirent:r1,get IOC(){return Gs},get IOC32(){return Wc},ReadStream:VF,Stats:Df,StatsFs:kke,WriteStream:WF,access:rTe,accessSync:cEe,appendFile:jEe,appendFileSync:Yke,chmod:JEe,chmodSync:aEe,chown:ZEe,chownSync:sEe,chroot:Uke,close:OEe,closeSync:Ig,constants:IX,copyFile:dTe,copyFileSync:HX,cp:mTe,cpSync:GX,createReadStream:oTe,createWriteStream:lTe,exists:kEe,existsSync:RF,fchmod:UEe,fchmodSync:DF,fchown:zEe,fchownSync:OF,fdatasync:LEe,fdatasyncSync:Qke,fstat:PEe,fstatSync:Zke,fsync:FEe,fsyncSync:Jke,ftruncate:DEe,ftruncateSync:Xke,futimes:qEe,futimesSync:FF,glob:bTe,globSync:mEe,ioctl:xTe,ioctlSync:wTe,lchmod:QEe,lchmodSync:oEe,lchown:XEe,lchownSync:iEe,link:GEe,linkSync:nEe,lopenSync:aA,lstat:TEe,lstatSync:IF,lutimes:tTe,lutimesSync:lEe,mkdir:WEe,mkdirSync:LF,mkdtemp:uTe,mkdtempSync:uEe,mount:NF,open:REe,openAsBlob:yTe,openSync:iA,opendir:pTe,opendirSync:hEe,promises:SEe,read:BEe,readFile:IEe,readFileSync:jF,readSync:tEe,readdir:HEe,readdirSync:zb,readlink:YEe,readlinkSync:d4,readv:fTe,readvSync:dEe,realpath:nTe,realpathSync:Ep,rename:CEe,renameSync:Gke,rm:cTe,rmSync:WX,rmdir:VEe,rmdirSync:qX,stat:EEe,statSync:ap,statfs:gTe,statfsSync:pEe,symlink:KEe,symlinkSync:rEe,truncate:AEe,truncateSync:Kke,umount:LX,unlink:NEe,unlinkSync:MF,unwatchFile:iTe,utimes:eTe,utimesSync:VX,watch:aTe,watchFile:sTe,write:$Ee,writeFile:MEe,writeFileSync:PF,writeSync:eEe,writev:hTe,writevSync:fEe,xattr:ITe},Symbol.toStringTag,{value:"Module"}));function I7(e){return xX(e)||CF(e)||e instanceof AF}async function bJ(e,t=0){if(typeof e!="object"||e==null)throw Xo(new Je(vt.EINVAL,"Invalid options on mount configuration"));if(!I7(e))throw Xo(new Je(vt.EINVAL,"Invalid mount configuration"));if(e instanceof AF)return await e.ready(),e;CF(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&I7(i)){if(vX("Resolving nested mount configuration: "+s),t>10)throw Xo(new Je(vt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await bJ(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw Xo(new Je(vt.EPERM,"Backend not available: "+n.name));lke(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function MTe(e){if(!xX(e))throw new TypeError("Invalid single mount point configuration");const t=await bJ(e);LX("/"),NF("/",t)}const jTe=["delete"];Math.max(...jTe.map(e=>e.length));oke("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const vJ=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;vJ[e]=t}function PTe(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^vJ[(t^e[n])&255];return(t^4294967295)>>>0}var Hs=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,p=n.length-1;p>=0;p--){var g={};for(var y in r)g[y]=y==="access"?{}:r[y];for(var y in r.access)g.access[y]=r.access[y];g.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],g);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},fr=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},XF=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let M7=(()=>{var e,t,n,r;let s=[Cg()],i,a=[],o,l,c=[],u=[],d,h=[],p=[],g,y=[],v=[],x,w=[],S=[];return o=class{constructor(){this.id=fr(this,c,0),this.offset_=(fr(this,u),fr(this,h,0)),this.offset=(fr(this,p),fr(this,y,0)),this.size=(fr(this,v),fr(this,w,0)),fr(this,S)}},XF(o,"MetadataEntry"),(()=>{const _=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=sr).uint32.bind(e)],d=[(t=sr).uint32.bind(t)],g=[(n=sr).uint32.bind(n)],x=[(r=sr).uint32.bind(r)],Hs(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:k=>"id"in k,get:k=>k.id,set:(k,T)=>{k.id=T}},metadata:_},c,u),Hs(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:k=>"offset_"in k,get:k=>k.offset_,set:(k,T)=>{k.offset_=T}},metadata:_},h,p),Hs(null,null,g,{kind:"field",name:"offset",static:!1,private:!1,access:{has:k=>"offset"in k,get:k=>k.offset,set:(k,T)=>{k.offset=T}},metadata:_},y,v),Hs(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:k=>"size"in k,get:k=>k.size,set:(k,T)=>{k.size=T}},metadata:_},w,S),Hs(null,i={value:o},s,{kind:"class",name:o.name,metadata:_},null,a),o=i.value,_&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_}),fr(o,a)})(),o})();const j7=255;let ym=(()=>{var e,t,n,r;let s=[Cg()],i,a=[],o,l,c=[],u=[],d,h=[],p=[],g,y=[],v=[],x,w=[],S=[],_,k=[],T=[];var A=o=class{constructor(R=ks(new Je(vt.EINVAL,"Metadata block must be initialized with a superblock")),M=0){if(this.superblock=R,this.offset=M,this.checksum=fr(this,c,0),this.timestamp=(fr(this,u),fr(this,h,Date.now())),this.previous_offset_=(fr(this,p),fr(this,y,0)),this.previous_offset=(fr(this,v),fr(this,w,0)),this._previous=fr(this,S),this.entries=fr(this,k,Array.from({length:j7},()=>new M7)),fr(this,T),this.superblock=R,this.offset=M,!!M&&(QT(this,R.store._buffer.subarray(M,M+Ks(A))),!xJ(this)))throw eA(new Je(vt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+M.toString(16)))}get previous(){var R;if(this.previous_offset)return(R=this._previous)!==null&&R!==void 0||(this._previous=new A(this.superblock,this.previous_offset)),this._previous}};return XF(o,"MetadataBlock"),(()=>{const R=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=sr).uint32.bind(e)],d=[(t=sr).uint32.bind(t)],g=[(n=sr).uint32.bind(n)],x=[(r=sr).uint32.bind(r)],_=[Qw(M7,j7)],Hs(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:M=>"checksum"in M,get:M=>M.checksum,set:(M,j)=>{M.checksum=j}},metadata:R},c,u),Hs(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:M=>"timestamp"in M,get:M=>M.timestamp,set:(M,j)=>{M.timestamp=j}},metadata:R},h,p),Hs(null,null,g,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:M=>"previous_offset_"in M,get:M=>M.previous_offset_,set:(M,j)=>{M.previous_offset_=j}},metadata:R},y,v),Hs(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:M=>"previous_offset"in M,get:M=>M.previous_offset,set:(M,j)=>{M.previous_offset=j}},metadata:R},w,S),Hs(null,null,_,{kind:"field",name:"entries",static:!1,private:!1,access:{has:M=>"entries"in M,get:M=>M.entries,set:(M,j)=>{M.entries=j}},metadata:R},k,T),Hs(null,i={value:o},s,{kind:"class",name:o.name,metadata:R},null,a),A=o=i.value,R&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:R}),fr(o,a)})(),A=o})();const P7=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[Cg()],h,p=[],g,y,v=[],x=[],w,S=[],_=[],k,T=[],A=[],R,M=[],j=[],F,P=[],q=[],I,V=[],D=[],z,$=[],Y=[],B,G=[],Z=[],ne,ae=[],le=[],Se,Ee=[],he=[],pe,Le=[],He=[],Fe,Ie=[],X=[],ye,Ne=[],fe=[];var ce=g=class{constructor(se=ks(new Je(vt.EINVAL,"Super block must be initialized with a store"))){if(this.store=se,this.checksum=fr(this,v,0),this.magic=(fr(this,x),fr(this,S,P7)),this.version=(fr(this,_),fr(this,T,1)),this.inode_format=(fr(this,A),fr(this,M,Ake)),this.flags=(fr(this,j),fr(this,P,0)),this.used_bytes=(fr(this,q),fr(this,V,BigInt(0))),this.total_bytes=(fr(this,D),fr(this,$,BigInt(0))),this.uuid=(fr(this,Y),fr(this,G,BigInt(0))),this.metadata_block_size=(fr(this,Z),fr(this,ae,Ks(ym))),this.metadata_offset_=(fr(this,le),fr(this,Ee,0)),this.metadata_offset=(fr(this,he),fr(this,Le,0)),this.metadata=fr(this,He),this.label=fr(this,Ie,""),this._padding=(fr(this,X),fr(this,Ne,new Array(132).fill(0))),fr(this,fe),this.store=se,se._view.getUint32(W2e(ce,"magic"),!0)!=P7){Ja("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new ym(this),this.metadata.offset=Ks(ce),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(Ks(ce)+Ks(ym)),this.total_bytes=BigInt(se._buffer.byteLength),se._write(this),se._write(this.metadata);return}if(QT(this,se._buffer.subarray(0,Ks(ce))),!xJ(this))throw eA(new Je(vt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new ym(this,this.metadata_offset)}rotateMetadata(){const se=new ym(this);return se.offset=Number(this.used_bytes),se.previous_offset=this.metadata_offset,this.metadata=se,this.metadata_offset=se.offset,this.store._write(se),this.used_bytes+=BigInt(Ks(ym)),this.store._write(this),se}isUnused(se,Pe){if(!Pe)return!0;if(se+Pe>this.total_bytes||se<Ks(ce))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(se<Be.offset+Ks(ym)&&se+Pe>Be.offset)return!1;for(const je of Be.entries)if(je.offset&&(se>=je.offset&&se<je.offset+je.size||se+Pe>je.offset&&se+Pe<=je.offset+je.size||se<=je.offset&&se+Pe>=je.offset+je.size))return!1}return!0}};return XF(g,"SuperBlock"),(()=>{const se=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;y=[(e=sr).uint32.bind(e)],w=[(t=sr).uint32.bind(t)],k=[(n=sr).uint16.bind(n)],R=[(r=sr).uint16.bind(r)],F=[(s=sr).uint32.bind(s)],I=[(i=sr).uint64.bind(i)],z=[(a=sr).uint64.bind(a)],B=[(o=sr).uint128.bind(o)],ne=[(l=sr).uint32.bind(l)],Se=[(c=sr).uint32.bind(c)],pe=[(u=sr).uint32.bind(u)],Fe=[sr.char(64)],ye=[sr.char(132)],Hs(null,null,y,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Pe=>"checksum"in Pe,get:Pe=>Pe.checksum,set:(Pe,Be)=>{Pe.checksum=Be}},metadata:se},v,x),Hs(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Pe=>"magic"in Pe,get:Pe=>Pe.magic,set:(Pe,Be)=>{Pe.magic=Be}},metadata:se},S,_),Hs(null,null,k,{kind:"field",name:"version",static:!1,private:!1,access:{has:Pe=>"version"in Pe,get:Pe=>Pe.version,set:(Pe,Be)=>{Pe.version=Be}},metadata:se},T,A),Hs(null,null,R,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Pe=>"inode_format"in Pe,get:Pe=>Pe.inode_format,set:(Pe,Be)=>{Pe.inode_format=Be}},metadata:se},M,j),Hs(null,null,F,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Pe=>"flags"in Pe,get:Pe=>Pe.flags,set:(Pe,Be)=>{Pe.flags=Be}},metadata:se},P,q),Hs(null,null,I,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Pe=>"used_bytes"in Pe,get:Pe=>Pe.used_bytes,set:(Pe,Be)=>{Pe.used_bytes=Be}},metadata:se},V,D),Hs(null,null,z,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Pe=>"total_bytes"in Pe,get:Pe=>Pe.total_bytes,set:(Pe,Be)=>{Pe.total_bytes=Be}},metadata:se},$,Y),Hs(null,null,B,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Pe=>"uuid"in Pe,get:Pe=>Pe.uuid,set:(Pe,Be)=>{Pe.uuid=Be}},metadata:se},G,Z),Hs(null,null,ne,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Pe=>"metadata_block_size"in Pe,get:Pe=>Pe.metadata_block_size,set:(Pe,Be)=>{Pe.metadata_block_size=Be}},metadata:se},ae,le),Hs(null,null,Se,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Pe=>"metadata_offset_"in Pe,get:Pe=>Pe.metadata_offset_,set:(Pe,Be)=>{Pe.metadata_offset_=Be}},metadata:se},Ee,he),Hs(null,null,pe,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Pe=>"metadata_offset"in Pe,get:Pe=>Pe.metadata_offset,set:(Pe,Be)=>{Pe.metadata_offset=Be}},metadata:se},Le,He),Hs(null,null,Fe,{kind:"field",name:"label",static:!1,private:!1,access:{has:Pe=>"label"in Pe,get:Pe=>Pe.label,set:(Pe,Be)=>{Pe.label=Be}},metadata:se},Ie,X),Hs(null,null,ye,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Pe=>"_padding"in Pe,get:Pe=>Pe._padding,set:(Pe,Be)=>{Pe._padding=Be}},metadata:se},Ne,fe),Hs(null,h={value:g},d,{kind:"class",name:g.name,metadata:se},null,p),ce=g=h.value,se&&Object.defineProperty(g,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:se}),fr(g,p)})(),ce=g})();function xJ(e){const t=ja(e),n=PTe(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=ka;function OTe(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function h4(e,t,n){if(e instanceof Je)return e;const r=e instanceof DOMException?vt[OTe(e)]:vt.EIO,s=new Je(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function ny(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(h4(e.error))}})}class DTe extends u4{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await ny(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await ny(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await ny(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),ny(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(h4(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(h4(this.tx.error)),this.tx.abort(),t}}async function FTe(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Ja("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await ny(n)}class LTe{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new DTe(t,this)}}const $Te={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await ny(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await FTe(e.storeName||"zenfs",e.idbFactory),n=new LTe(t),r=new OX(n);if(e!=null&&e.disableAsyncCache)return _F("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},BTe=$Te,hn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function VC(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ij={exports:{}},O7;function zTe(){return O7||(O7=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof VC=="function"&&VC;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var p=s[c]={exports:{}};r[c][0].call(p.exports,function(g){var y=r[c][1][g];return a(y||g)},p,p.exports,n,r,s,i)}return s[c].exports}for(var o=typeof VC=="function"&&VC,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,p,g,y,v=[],x=0,w=l.length,S=w,_=i.getTypeOf(l)!=="string";x<l.length;)S=w-x,d=_?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,p=(3&c)<<4|u>>4,g=1<S?(15&u)<<2|d>>6:64,y=2<S?63&d:64,v.push(o.charAt(h)+o.charAt(p)+o.charAt(g)+o.charAt(y));return v.join("")},s.decode=function(l){var c,u,d,h,p,g,y=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|S):new Array(0|S);y<l.length;)c=o.indexOf(l.charAt(y++))<<2|(h=o.indexOf(l.charAt(y++)))>>4,u=(15&h)<<4|(p=o.indexOf(l.charAt(y++)))>>2,d=(3&p)<<6|(g=o.indexOf(l.charAt(y++))),w[v++]=c,p!==64&&(w[v++]=u),g!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,p,g){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=p,this.compressedContent=g}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var p=a,g=h+d;c^=-1;for(var y=h;y<g;y++)c=c>>>8^p[255&(c^u[y])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var p=a,g=h+d;c^=-1;for(var y=h;y<g;y++)c=c>>>8^p[255&(c^u.charCodeAt(y))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(p,g){var y,v="";for(y=0;y<g;y++)v+=String.fromCharCode(255&p),p>>>=8;return v}function a(p,g,y,v,x,w){var S,_,k=p.file,T=p.compression,A=w!==c.utf8encode,R=o.transformTo("string",w(k.name)),M=o.transformTo("string",c.utf8encode(k.name)),j=k.comment,F=o.transformTo("string",w(j)),P=o.transformTo("string",c.utf8encode(j)),q=M.length!==k.name.length,I=P.length!==j.length,V="",D="",z="",$=k.dir,Y=k.date,B={crc32:0,compressedSize:0,uncompressedSize:0};g&&!y||(B.crc32=p.crc32,B.compressedSize=p.compressedSize,B.uncompressedSize=p.uncompressedSize);var G=0;g&&(G|=8),A||!q&&!I||(G|=2048);var Z=0,ne=0;$&&(Z|=16),x==="UNIX"?(ne=798,Z|=function(le,Se){var Ee=le;return le||(Ee=Se?16893:33204),(65535&Ee)<<16}(k.unixPermissions,$)):(ne=20,Z|=function(le){return 63&(le||0)}(k.dosPermissions)),S=Y.getUTCHours(),S<<=6,S|=Y.getUTCMinutes(),S<<=5,S|=Y.getUTCSeconds()/2,_=Y.getUTCFullYear()-1980,_<<=4,_|=Y.getUTCMonth()+1,_<<=5,_|=Y.getUTCDate(),q&&(D=i(1,1)+i(u(R),4)+M,V+="up"+i(D.length,2)+D),I&&(z=i(1,1)+i(u(F),4)+P,V+="uc"+i(z.length,2)+z);var ae="";return ae+=`
\0`,ae+=i(G,2),ae+=T.magic,ae+=i(S,2),ae+=i(_,2),ae+=i(B.crc32,4),ae+=i(B.compressedSize,4),ae+=i(B.uncompressedSize,4),ae+=i(R.length,2),ae+=i(V.length,2),{fileRecord:d.LOCAL_FILE_HEADER+ae+R+V,dirRecord:d.CENTRAL_FILE_HEADER+i(ne,2)+ae+i(F.length,2)+"\0\0\0\0"+i(Z,4)+i(v,4)+R+V+F}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(p,g,y,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=y,this.encodeFileName=v,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(p){var g=p.meta.percent||0,y=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,l.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:y?(g+100*(y-v-1))/y:100}}))},h.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var g=this.streamFiles&&!p.file.dir;if(g){var y=a(p,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(p){this.accumulate=!1;var g=this.streamFiles&&!p.file.dir,y=a(p,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),g)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var p=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var y=this.bytesWritten-p,v=function(x,w,S,_,k){var T=o.transformTo("string",k(_));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(S,4)+i(T.length,2)+T}(this.dirRecords.length,y,p,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(p){this._sources.push(p);var g=this;return p.on("data",function(y){g.processChunk(y)}),p.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),p.on("error",function(y){g.error(y)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(p){var g=this._sources;if(!l.prototype.error.call(this,p))return!1;for(var y=0;y<g.length;y++)try{g[y].error(p)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var p=this._sources,g=0;g<p.length;g++)p[g].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,p){d++;var g=function(w,S){var _=w||S,k=i[_];if(!k)throw new Error(_+" is not a valid compression method !");return k}(p.options.compression,l.compression),y=p.options.compressionOptions||l.compressionOptions||{},v=p.dir,x=p.date;p._compressWorker(g,y).withStreamInfo("file",{name:h,dir:v,date:x,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(p,g){var y=h.decompressed.getContentWorker().pipe(new c);y.on("error",function(v){g(v)}).on("end",function(){y.streamInfo.crc32!==h.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}r.exports=function(h,p){var g=this;return p=i.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,p.optimizedBinaryString,p.base64).then(function(y){var v=new l(p);return v.load(y),v}).then(function(y){var v=[a.Promise.resolve(y)],x=y.files;if(p.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(y){for(var v=y.shift(),x=v.files,w=0;w<x.length;w++){var S=x[w],_=S.fileNameStr,k=i.resolve(S.fileNameStr);g.file(k,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:p.createFolders}),S.dir||(g.file(k).unsafeOriginalName=_)}return v.zipComment.length&&(g.comment=v.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof un<"u",newBufferFrom:function(i,a){if(un.from&&un.from!==Uint8Array.from)return un.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new un(i,a)},allocBuffer:function(i){if(un.alloc)return un.alloc(i);var a=new un(i);return a.fill(0),a},isBuffer:function(i){return un.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(k,T,A){var R,M=o.getTypeOf(T),j=o.extend(A||{},u);j.date=j.date||new Date,j.compression!==null&&(j.compression=j.compression.toUpperCase()),typeof j.unixPermissions=="string"&&(j.unixPermissions=parseInt(j.unixPermissions,8)),j.unixPermissions&&16384&j.unixPermissions&&(j.dir=!0),j.dosPermissions&&16&j.dosPermissions&&(j.dir=!0),j.dir&&(k=x(k)),j.createFolders&&(R=v(k))&&w.call(this,R,!0);var F=M==="string"&&j.binary===!1&&j.base64===!1;A&&A.binary!==void 0||(j.binary=!F),(T instanceof d&&T.uncompressedSize===0||j.dir||!T||T.length===0)&&(j.base64=!1,j.binary=!0,T="",j.compression="STORE",M="string");var P=null;P=T instanceof d||T instanceof l?T:g.isNode&&g.isStream(T)?new y(k,T):o.prepareContent(k,T,j.binary,j.optimizedBinaryString,j.base64);var q=new h(k,P,j);this.files[k]=q}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),p=n("./generate"),g=n("./nodejsUtils"),y=n("./nodejs/NodejsStreamInputAdapter"),v=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var T=k.lastIndexOf("/");return 0<T?k.substring(0,T):""},x=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},w=function(k,T){return T=T!==void 0?T:u.createFolders,k=x(k),this.files[k]||i.call(this,k,null,{dir:!0,createFolders:T}),this.files[k]};function S(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var _={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var T,A,R;for(T in this.files)R=this.files[T],(A=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&k(A,R)},filter:function(k){var T=[];return this.forEach(function(A,R){k(A,R)&&T.push(R)}),T},file:function(k,T,A){if(arguments.length!==1)return k=this.root+k,i.call(this,k,T,A),this;if(S(k)){var R=k;return this.filter(function(j,F){return!F.dir&&R.test(j)})}var M=this.files[this.root+k];return M&&!M.dir?M:null},folder:function(k){if(!k)return this;if(S(k))return this.filter(function(M,j){return j.dir&&k.test(M)});var T=this.root+k,A=w.call(this,T),R=this.clone();return R.root=A.name,R},remove:function(k){k=this.root+k;var T=this.files[k];if(T||(k.slice(-1)!=="/"&&(k+="/"),T=this.files[k]),T&&!T.dir)delete this.files[k];else for(var A=this.filter(function(M,j){return j.name.slice(0,k.length)===k}),R=0;R<A.length;R++)delete this.files[A[R].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var T,A={};try{if((A=o.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");o.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var R=A.comment||this.comment||"";T=p.generateWorker(this,A,R)}catch(M){(T=new l("error")).error(M)}return new c(T,A.type||"string",A.mimeType)},generateAsync:function(k,T){return this.generateInternalStream(k).accumulate(T)},generateNodeStream:function(k,T){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(T)}};r.exports=_},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(g,y){return new u.Promise(function(v,x){var w=[],S=g._internalType,_=g._outputType,k=g._mimeType;g.on("data",function(T,A){w.push(T),y&&y(A)}).on("error",function(T){w=[],x(T)}).on("end",function(){try{var T=function(A,R,M){switch(A){case"blob":return i.newBlob(i.transformTo("arraybuffer",R),M);case"base64":return l.encode(R);default:return i.transformTo(A,R)}}(_,function(A,R){var M,j=0,F=null,P=0;for(M=0;M<R.length;M++)P+=R[M].length;switch(A){case"string":return R.join("");case"array":return Array.prototype.concat.apply([],R);case"uint8array":for(F=new Uint8Array(P),M=0;M<R.length;M++)F.set(R[M],j),j+=R[M].length;return F;case"nodebuffer":return un.concat(R);default:throw new Error("concat : unsupported type '"+A+"'")}}(S,w),k);v(T)}catch(A){x(A)}w=[]}).resume()})}function p(g,y,v){var x=y;switch(y){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=y,this._mimeType=v,i.checkSupport(x),this._worker=g.pipe(new a(x)),g.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}p.prototype={accumulate:function(g){return h(this,g)},on:function(g,y){var v=this;return g==="data"?this._worker.on(g,function(x){y.call(v,x.data,x.meta)}):this._worker.on(g,function(){i.delay(y,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},g)}},r.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof un<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(p){return a.nodebuffer?o.newBufferFrom(p,"utf-8"):function(g){var y,v,x,w,S,_=g.length,k=0;for(w=0;w<_;w++)(64512&(v=g.charCodeAt(w)))==55296&&w+1<_&&(64512&(x=g.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),k+=v<128?1:v<2048?2:v<65536?3:4;for(y=a.uint8array?new Uint8Array(k):new Array(k),w=S=0;S<k;w++)(64512&(v=g.charCodeAt(w)))==55296&&w+1<_&&(64512&(x=g.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?y[S++]=v:(v<2048?y[S++]=192|v>>>6:(v<65536?y[S++]=224|v>>>12:(y[S++]=240|v>>>18,y[S++]=128|v>>>12&63),y[S++]=128|v>>>6&63),y[S++]=128|63&v);return y}(p)},s.utf8decode=function(p){return a.nodebuffer?i.transformTo("nodebuffer",p).toString("utf-8"):function(g){var y,v,x,w,S=g.length,_=new Array(2*S);for(y=v=0;y<S;)if((x=g[y++])<128)_[v++]=x;else if(4<(w=c[x]))_[v++]=65533,y+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&y<S;)x=x<<6|63&g[y++],w--;1<w?_[v++]=65533:x<65536?_[v++]=x:(x-=65536,_[v++]=55296|x>>10&1023,_[v++]=56320|1023&x)}return _.length!==v&&(_.subarray?_=_.subarray(0,v):_.length=v),i.applyFromCharCode(_)}(p=i.transformTo(a.uint8array?"uint8array":"array",p))},i.inherits(d,l),d.prototype.processChunk=function(p){var g=i.transformTo(a.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var y=g;(g=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),g.set(y,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var v=function(w,S){var _;for((S=S||w.length)>w.length&&(S=w.length),_=S-1;0<=_&&(192&w[_])==128;)_--;return _<0||_===0?S:_+c[w[_]]>S?_:S}(g),x=g;v!==g.length&&(a.uint8array?(x=g.subarray(0,v),this.leftOver=g.subarray(v,g.length)):(x=g.slice(0,v),this.leftOver=g.slice(v,g.length))),this.push({data:s.utf8decode(x),meta:p.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(p){this.push({data:s.utf8encode(p.data),meta:p.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(y){return y}function u(y,v){for(var x=0;x<y.length;++x)v[x]=255&y.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(y,v){s.checkSupport("blob");try{return new Blob([y],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(y),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(y,v,x){var w=[],S=0,_=y.length;if(_<=x)return String.fromCharCode.apply(null,y);for(;S<_;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,y.slice(S,Math.min(S+x,_)))):w.push(String.fromCharCode.apply(null,y.subarray(S,Math.min(S+x,_)))),S+=x;return w.join("")},stringifyByChar:function(y){for(var v="",x=0;x<y.length;x++)v+=String.fromCharCode(y[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(y){var v=65536,x=s.getTypeOf(y),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(y,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(y)}function p(y,v){for(var x=0;x<y.length;x++)v[x]=y[x];return v}s.applyFromCharCode=h;var g={};g.string={string:c,array:function(y){return u(y,new Array(y.length))},arraybuffer:function(y){return g.string.uint8array(y).buffer},uint8array:function(y){return u(y,new Uint8Array(y.length))},nodebuffer:function(y){return u(y,o.allocBuffer(y.length))}},g.array={string:h,array:c,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(y)}},g.arraybuffer={string:function(y){return h(new Uint8Array(y))},array:function(y){return p(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:c,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return o.newBufferFrom(new Uint8Array(y))}},g.uint8array={string:h,array:function(y){return p(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:c,nodebuffer:function(y){return o.newBufferFrom(y)}},g.nodebuffer={string:h,array:function(y){return p(y,new Array(y.length))},arraybuffer:function(y){return g.nodebuffer.uint8array(y).buffer},uint8array:function(y){return p(y,new Uint8Array(y.length))},nodebuffer:c},s.transformTo=function(y,v){if(v=v||"",!y)return v;s.checkSupport(y);var x=s.getTypeOf(v);return g[x][y](v)},s.resolve=function(y){for(var v=y.split("/"),x=[],w=0;w<v.length;w++){var S=v[w];S==="."||S===""&&w!==0&&w!==v.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},s.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(y)?"nodebuffer":i.uint8array&&y instanceof Uint8Array?"uint8array":i.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(y){if(!i[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(y){var v,x,w="";for(x=0;x<(y||"").length;x++)w+="\\x"+((v=y.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(y,v,x){setImmediate(function(){y.apply(x||null,v||[])})},s.inherits=function(y,v){function x(){}x.prototype=v.prototype,y.prototype=new x},s.extend=function(){var y,v,x={};for(y=0;y<arguments.length;y++)for(v in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],v)&&x[v]===void 0&&(x[v]=arguments[y][v]);return x},s.prepareContent=function(y,v,x,w,S){return l.Promise.resolve(v).then(function(_){return i.blob&&(_ instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(_))!==-1)&&typeof FileReader<"u"?new l.Promise(function(k,T){var A=new FileReader;A.onload=function(R){k(R.target.result)},A.onerror=function(R){T(R.target.error)},A.readAsArrayBuffer(_)}):_}).then(function(_){var k=s.getTypeOf(_);return k?(k==="arraybuffer"?_=s.transformTo("uint8array",_):k==="string"&&(S?_=a.decode(_):x&&w!==!0&&(_=function(T){return u(T,i.uint8array?new Uint8Array(T.length):new Array(T.length))}(_))),_):l.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var p=this.reader.index;this.reader.setIndex(d);var g=this.reader.readString(4)===h;return this.reader.setIndex(p),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",p=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,p,g=this.zip64EndOfCentralSize-44;0<g;)d=this.reader.readInt(2),h=this.reader.readInt(4),p=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var g=h-p;if(0<g)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(p,g){this.options=p,this.loadOptions=g}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var g,y;if(p.skip(22),this.fileNameLength=p.readInt(2),y=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,g,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var g=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(g),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var g,y,v,x=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<x;)g=p.readInt(2),y=p.readInt(2),v=p.readData(y),this.extraFields[g]={id:g,length:y,value:v};p.setIndex(x)},handleUTF8:function(){var p=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var y=a.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var g=i(p.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:c.utf8decode(g.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var g=i(p.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:c.utf8decode(g.readData(p.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(g,y,v){this.name=g,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=y,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(g){var y=null,v="string";try{if(!g)throw new Error("No output type specified.");var x=(v=g.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),y=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(y=y.pipe(new l.Utf8EncodeWorker)),!w&&x&&(y=y.pipe(new l.Utf8DecodeWorker))}catch(S){(y=new u("error")).error(S)}return new a(y,v,"")},async:function(g,y){return this.internalStream(g).accumulate(y)},nodeStream:function(g,y){return this.internalStream(g||"nodebuffer").toNodejsStream(y)},_compressWorker:function(g,y){if(this._data instanceof c&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,g,y)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<d.length;p++)i.prototype[d[p]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(g),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var y=i.document.createElement("script");y.onreadystatechange=function(){g(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},i.document.documentElement.appendChild(y)}:function(){setTimeout(g,0)};else{var h=new i.MessageChannel;h.port1.onmessage=g,a=function(){h.port2.postMessage(0)}}var p=[];function g(){var y,v;o=!0;for(var x=p.length;x;){for(v=p,p=[],y=-1;++y<x;)v[y]();x=p.length}o=!1}r.exports=function(y){p.push(y)!==1||o||a()}}).call(this,typeof jm<"u"?jm:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&y(this,x)}function h(x,w,S){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function p(x,w,S){i(function(){var _;try{_=w(S)}catch(k){return o.reject(x,k)}_===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,_)})}function g(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function y(x,w){var S=!1;function _(A){S||(S=!0,o.reject(x,A))}function k(A){S||(S=!0,o.resolve(x,A))}var T=v(function(){w(k,_)});T.status==="error"&&_(T.value)}function v(x,w){var S={};try{S.value=x(w),S.status="success"}catch(_){S.status="error",S.value=_}return S}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(S){return w.resolve(x()).then(function(){return S})},function(S){return w.resolve(x()).then(function(){throw S})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?p(S,this.state===c?x:w,this.outcome):this.queue.push(new h(S,x,w)),S},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){p(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){p(this.promise,this.onRejected,x)},o.resolve=function(x,w){var S=v(g,w);if(S.status==="error")return o.reject(x,S.value);var _=S.value;if(_)y(x,_);else{x.state=c,x.outcome=w;for(var k=-1,T=x.queue.length;++k<T;)x.queue[k].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var S=-1,_=x.queue.length;++S<_;)x.queue[S].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,_=!1;if(!S)return this.resolve([]);for(var k=new Array(S),T=0,A=-1,R=new this(a);++A<S;)M(x[A],A);return R;function M(j,F){w.resolve(j).then(function(P){k[F]=P,++T!==S||_||(_=!0,o.resolve(R,k))},function(P){_||(_=!0,o.reject(R,P))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,_=!1;if(!S)return this.resolve([]);for(var k=-1,T=new this(a);++k<S;)A=x[k],w.resolve(A).then(function(R){_||(_=!0,o.resolve(T,R))},function(R){_||(_=!0,o.reject(T,R))});var A;return T}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,p=0,g=8;function y(x){if(!(this instanceof y))return new y(x);this.options=a.assign({level:h,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(S!==d)throw new Error(l[S]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var _;if(_=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(S=i.deflateSetDictionary(this.strm,_))!==d)throw new Error(l[S]);this._dict_set=!0}}function v(x,w){var S=new y(w);if(S.push(x,!0),S.err)throw S.msg||l[S.err];return S.result}y.prototype.push=function(x,w){var S,_,k=this.strm,T=this.options.chunkSize;if(this.ended)return!1;_=w===~~w?w:w===!0?4:0,typeof x=="string"?k.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?k.input=new Uint8Array(x):k.input=x,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(T),k.next_out=0,k.avail_out=T),(S=i.deflate(k,_))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||_!==4&&_!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&S!==1);return _===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):_!==2||(this.onEnd(d),!(k.avail_out=0))},y.prototype.onData=function(x){this.chunks.push(x)},y.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=y,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function p(y){if(!(this instanceof p))return new p(y);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},y||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||y&&y.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function g(y,v){var x=new p(v);if(x.push(y,!0),x.err)throw x.msg||c[x.err];return x.result}p.prototype.push=function(y,v){var x,w,S,_,k,T,A=this.strm,R=this.options.chunkSize,M=this.options.dictionary,j=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof y=="string"?A.input=o.binstring2buf(y):h.call(y)==="[object ArrayBuffer]"?A.input=new Uint8Array(y):A.input=y,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(R),A.next_out=0,A.avail_out=R),(x=i.inflate(A,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&M&&(T=typeof M=="string"?o.string2buf(M):h.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,x=i.inflateSetDictionary(this.strm,T)),x===l.Z_BUF_ERROR&&j===!0&&(x=l.Z_OK,j=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&x!==l.Z_STREAM_END&&(A.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(A.output,A.next_out),_=A.next_out-S,k=o.buf2string(A.output,S),A.next_out=_,A.avail_out=R-_,_&&a.arraySet(A.output,A.output,S,_,0),this.onData(k)):this.onData(a.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(j=!0)}while((0<A.avail_in||A.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(A.avail_out=0))},p.prototype.onData=function(y){this.chunks.push(y)},p.prototype.onEnd=function(y){y===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},s.Inflate=p,s.inflate=g,s.inflateRaw=function(y,v){return(v=v||{}).raw=!0,g(y,v)},s.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var p=0;p<d;p++)l[h+p]=c[u+p]},flattenChunks:function(l){var c,u,d,h,p,g;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(g=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)p=l[c],g.set(p,h),h+=p.length;return g}},o={arraySet:function(l,c,u,d,h){for(var p=0;p<d;p++)l[h+p]=c[u+p]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var p="",g=0;g<h;g++)p+=String.fromCharCode(d[g]);return p}l[254]=l[254]=1,s.string2buf=function(d){var h,p,g,y,v,x=d.length,w=0;for(y=0;y<x;y++)(64512&(p=d.charCodeAt(y)))==55296&&y+1<x&&(64512&(g=d.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),y++),w+=p<128?1:p<2048?2:p<65536?3:4;for(h=new i.Buf8(w),y=v=0;v<w;y++)(64512&(p=d.charCodeAt(y)))==55296&&y+1<x&&(64512&(g=d.charCodeAt(y+1)))==56320&&(p=65536+(p-55296<<10)+(g-56320),y++),p<128?h[v++]=p:(p<2048?h[v++]=192|p>>>6:(p<65536?h[v++]=224|p>>>12:(h[v++]=240|p>>>18,h[v++]=128|p>>>12&63),h[v++]=128|p>>>6&63),h[v++]=128|63&p);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),p=0,g=h.length;p<g;p++)h[p]=d.charCodeAt(p);return h},s.buf2string=function(d,h){var p,g,y,v,x=h||d.length,w=new Array(2*x);for(p=g=0;p<x;)if((y=d[p++])<128)w[g++]=y;else if(4<(v=l[y]))w[g++]=65533,p+=v-1;else{for(y&=v===2?31:v===3?15:7;1<v&&p<x;)y=y<<6|63&d[p++],v--;1<v?w[g++]=65533:y<65536?w[g++]=y:(y-=65536,w[g++]=55296|y>>10&1023,w[g++]=56320|1023&y)}return u(w,g)},s.utf8border=function(d,h){var p;for((h=h||d.length)>d.length&&(h=d.length),p=h-1;0<=p&&(192&d[p])==128;)p--;return p<0||p===0?h:p+l[d[p]]>h?p:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,p=0,g=-2,y=-1,v=4,x=2,w=8,S=9,_=286,k=30,T=19,A=2*_+1,R=15,M=3,j=258,F=j+M+1,P=42,q=113,I=1,V=2,D=3,z=4;function $(X,ye){return X.msg=u[ye],ye}function Y(X){return(X<<1)-(4<X?9:0)}function B(X){for(var ye=X.length;0<=--ye;)X[ye]=0}function G(X){var ye=X.state,Ne=ye.pending;Ne>X.avail_out&&(Ne=X.avail_out),Ne!==0&&(a.arraySet(X.output,ye.pending_buf,ye.pending_out,Ne,X.next_out),X.next_out+=Ne,ye.pending_out+=Ne,X.total_out+=Ne,X.avail_out-=Ne,ye.pending-=Ne,ye.pending===0&&(ye.pending_out=0))}function Z(X,ye){o._tr_flush_block(X,0<=X.block_start?X.block_start:-1,X.strstart-X.block_start,ye),X.block_start=X.strstart,G(X.strm)}function ne(X,ye){X.pending_buf[X.pending++]=ye}function ae(X,ye){X.pending_buf[X.pending++]=ye>>>8&255,X.pending_buf[X.pending++]=255&ye}function le(X,ye){var Ne,fe,ce=X.max_chain_length,se=X.strstart,Pe=X.prev_length,Be=X.nice_match,je=X.strstart>X.w_size-F?X.strstart-(X.w_size-F):0,ot=X.window,Et=X.w_mask,ut=X.prev,Pt=X.strstart+j,$t=ot[se+Pe-1],Ft=ot[se+Pe];X.prev_length>=X.good_match&&(ce>>=2),Be>X.lookahead&&(Be=X.lookahead);do if(ot[(Ne=ye)+Pe]===Ft&&ot[Ne+Pe-1]===$t&&ot[Ne]===ot[se]&&ot[++Ne]===ot[se+1]){se+=2,Ne++;do;while(ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&ot[++se]===ot[++Ne]&&se<Pt);if(fe=j-(Pt-se),se=Pt-j,Pe<fe){if(X.match_start=ye,Be<=(Pe=fe))break;$t=ot[se+Pe-1],Ft=ot[se+Pe]}}while((ye=ut[ye&Et])>je&&--ce!=0);return Pe<=X.lookahead?Pe:X.lookahead}function Se(X){var ye,Ne,fe,ce,se,Pe,Be,je,ot,Et,ut=X.w_size;do{if(ce=X.window_size-X.lookahead-X.strstart,X.strstart>=ut+(ut-F)){for(a.arraySet(X.window,X.window,ut,ut,0),X.match_start-=ut,X.strstart-=ut,X.block_start-=ut,ye=Ne=X.hash_size;fe=X.head[--ye],X.head[ye]=ut<=fe?fe-ut:0,--Ne;);for(ye=Ne=ut;fe=X.prev[--ye],X.prev[ye]=ut<=fe?fe-ut:0,--Ne;);ce+=ut}if(X.strm.avail_in===0)break;if(Pe=X.strm,Be=X.window,je=X.strstart+X.lookahead,ot=ce,Et=void 0,Et=Pe.avail_in,ot<Et&&(Et=ot),Ne=Et===0?0:(Pe.avail_in-=Et,a.arraySet(Be,Pe.input,Pe.next_in,Et,je),Pe.state.wrap===1?Pe.adler=l(Pe.adler,Be,Et,je):Pe.state.wrap===2&&(Pe.adler=c(Pe.adler,Be,Et,je)),Pe.next_in+=Et,Pe.total_in+=Et,Et),X.lookahead+=Ne,X.lookahead+X.insert>=M)for(se=X.strstart-X.insert,X.ins_h=X.window[se],X.ins_h=(X.ins_h<<X.hash_shift^X.window[se+1])&X.hash_mask;X.insert&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[se+M-1])&X.hash_mask,X.prev[se&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=se,se++,X.insert--,!(X.lookahead+X.insert<M)););}while(X.lookahead<F&&X.strm.avail_in!==0)}function Ee(X,ye){for(var Ne,fe;;){if(X.lookahead<F){if(Se(X),X.lookahead<F&&ye===d)return I;if(X.lookahead===0)break}if(Ne=0,X.lookahead>=M&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+M-1])&X.hash_mask,Ne=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),Ne!==0&&X.strstart-Ne<=X.w_size-F&&(X.match_length=le(X,Ne)),X.match_length>=M)if(fe=o._tr_tally(X,X.strstart-X.match_start,X.match_length-M),X.lookahead-=X.match_length,X.match_length<=X.max_lazy_match&&X.lookahead>=M){for(X.match_length--;X.strstart++,X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+M-1])&X.hash_mask,Ne=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart,--X.match_length!=0;);X.strstart++}else X.strstart+=X.match_length,X.match_length=0,X.ins_h=X.window[X.strstart],X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+1])&X.hash_mask;else fe=o._tr_tally(X,0,X.window[X.strstart]),X.lookahead--,X.strstart++;if(fe&&(Z(X,!1),X.strm.avail_out===0))return I}return X.insert=X.strstart<M-1?X.strstart:M-1,ye===h?(Z(X,!0),X.strm.avail_out===0?D:z):X.last_lit&&(Z(X,!1),X.strm.avail_out===0)?I:V}function he(X,ye){for(var Ne,fe,ce;;){if(X.lookahead<F){if(Se(X),X.lookahead<F&&ye===d)return I;if(X.lookahead===0)break}if(Ne=0,X.lookahead>=M&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+M-1])&X.hash_mask,Ne=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),X.prev_length=X.match_length,X.prev_match=X.match_start,X.match_length=M-1,Ne!==0&&X.prev_length<X.max_lazy_match&&X.strstart-Ne<=X.w_size-F&&(X.match_length=le(X,Ne),X.match_length<=5&&(X.strategy===1||X.match_length===M&&4096<X.strstart-X.match_start)&&(X.match_length=M-1)),X.prev_length>=M&&X.match_length<=X.prev_length){for(ce=X.strstart+X.lookahead-M,fe=o._tr_tally(X,X.strstart-1-X.prev_match,X.prev_length-M),X.lookahead-=X.prev_length-1,X.prev_length-=2;++X.strstart<=ce&&(X.ins_h=(X.ins_h<<X.hash_shift^X.window[X.strstart+M-1])&X.hash_mask,Ne=X.prev[X.strstart&X.w_mask]=X.head[X.ins_h],X.head[X.ins_h]=X.strstart),--X.prev_length!=0;);if(X.match_available=0,X.match_length=M-1,X.strstart++,fe&&(Z(X,!1),X.strm.avail_out===0))return I}else if(X.match_available){if((fe=o._tr_tally(X,0,X.window[X.strstart-1]))&&Z(X,!1),X.strstart++,X.lookahead--,X.strm.avail_out===0)return I}else X.match_available=1,X.strstart++,X.lookahead--}return X.match_available&&(fe=o._tr_tally(X,0,X.window[X.strstart-1]),X.match_available=0),X.insert=X.strstart<M-1?X.strstart:M-1,ye===h?(Z(X,!0),X.strm.avail_out===0?D:z):X.last_lit&&(Z(X,!1),X.strm.avail_out===0)?I:V}function pe(X,ye,Ne,fe,ce){this.good_length=X,this.max_lazy=ye,this.nice_length=Ne,this.max_chain=fe,this.func=ce}function Le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*A),this.dyn_dtree=new a.Buf16(2*(2*k+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),B(this.dyn_ltree),B(this.dyn_dtree),B(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(R+1),this.heap=new a.Buf16(2*_+1),B(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*_+1),B(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function He(X){var ye;return X&&X.state?(X.total_in=X.total_out=0,X.data_type=x,(ye=X.state).pending=0,ye.pending_out=0,ye.wrap<0&&(ye.wrap=-ye.wrap),ye.status=ye.wrap?P:q,X.adler=ye.wrap===2?0:1,ye.last_flush=d,o._tr_init(ye),p):$(X,g)}function Fe(X){var ye=He(X);return ye===p&&function(Ne){Ne.window_size=2*Ne.w_size,B(Ne.head),Ne.max_lazy_match=i[Ne.level].max_lazy,Ne.good_match=i[Ne.level].good_length,Ne.nice_match=i[Ne.level].nice_length,Ne.max_chain_length=i[Ne.level].max_chain,Ne.strstart=0,Ne.block_start=0,Ne.lookahead=0,Ne.insert=0,Ne.match_length=Ne.prev_length=M-1,Ne.match_available=0,Ne.ins_h=0}(X.state),ye}function Ie(X,ye,Ne,fe,ce,se){if(!X)return g;var Pe=1;if(ye===y&&(ye=6),fe<0?(Pe=0,fe=-fe):15<fe&&(Pe=2,fe-=16),ce<1||S<ce||Ne!==w||fe<8||15<fe||ye<0||9<ye||se<0||v<se)return $(X,g);fe===8&&(fe=9);var Be=new Le;return(X.state=Be).strm=X,Be.wrap=Pe,Be.gzhead=null,Be.w_bits=fe,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=ce+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+M-1)/M),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<ce+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ye,Be.strategy=se,Be.method=Ne,Fe(X)}i=[new pe(0,0,0,0,function(X,ye){var Ne=65535;for(Ne>X.pending_buf_size-5&&(Ne=X.pending_buf_size-5);;){if(X.lookahead<=1){if(Se(X),X.lookahead===0&&ye===d)return I;if(X.lookahead===0)break}X.strstart+=X.lookahead,X.lookahead=0;var fe=X.block_start+Ne;if((X.strstart===0||X.strstart>=fe)&&(X.lookahead=X.strstart-fe,X.strstart=fe,Z(X,!1),X.strm.avail_out===0)||X.strstart-X.block_start>=X.w_size-F&&(Z(X,!1),X.strm.avail_out===0))return I}return X.insert=0,ye===h?(Z(X,!0),X.strm.avail_out===0?D:z):(X.strstart>X.block_start&&(Z(X,!1),X.strm.avail_out),I)}),new pe(4,4,8,4,Ee),new pe(4,5,16,8,Ee),new pe(4,6,32,32,Ee),new pe(4,4,16,16,he),new pe(8,16,32,32,he),new pe(8,16,128,128,he),new pe(8,32,128,256,he),new pe(32,128,258,1024,he),new pe(32,258,258,4096,he)],s.deflateInit=function(X,ye){return Ie(X,ye,w,15,8,0)},s.deflateInit2=Ie,s.deflateReset=Fe,s.deflateResetKeep=He,s.deflateSetHeader=function(X,ye){return X&&X.state?X.state.wrap!==2?g:(X.state.gzhead=ye,p):g},s.deflate=function(X,ye){var Ne,fe,ce,se;if(!X||!X.state||5<ye||ye<0)return X?$(X,g):g;if(fe=X.state,!X.output||!X.input&&X.avail_in!==0||fe.status===666&&ye!==h)return $(X,X.avail_out===0?-5:g);if(fe.strm=X,Ne=fe.last_flush,fe.last_flush=ye,fe.status===P)if(fe.wrap===2)X.adler=0,ne(fe,31),ne(fe,139),ne(fe,8),fe.gzhead?(ne(fe,(fe.gzhead.text?1:0)+(fe.gzhead.hcrc?2:0)+(fe.gzhead.extra?4:0)+(fe.gzhead.name?8:0)+(fe.gzhead.comment?16:0)),ne(fe,255&fe.gzhead.time),ne(fe,fe.gzhead.time>>8&255),ne(fe,fe.gzhead.time>>16&255),ne(fe,fe.gzhead.time>>24&255),ne(fe,fe.level===9?2:2<=fe.strategy||fe.level<2?4:0),ne(fe,255&fe.gzhead.os),fe.gzhead.extra&&fe.gzhead.extra.length&&(ne(fe,255&fe.gzhead.extra.length),ne(fe,fe.gzhead.extra.length>>8&255)),fe.gzhead.hcrc&&(X.adler=c(X.adler,fe.pending_buf,fe.pending,0)),fe.gzindex=0,fe.status=69):(ne(fe,0),ne(fe,0),ne(fe,0),ne(fe,0),ne(fe,0),ne(fe,fe.level===9?2:2<=fe.strategy||fe.level<2?4:0),ne(fe,3),fe.status=q);else{var Pe=w+(fe.w_bits-8<<4)<<8;Pe|=(2<=fe.strategy||fe.level<2?0:fe.level<6?1:fe.level===6?2:3)<<6,fe.strstart!==0&&(Pe|=32),Pe+=31-Pe%31,fe.status=q,ae(fe,Pe),fe.strstart!==0&&(ae(fe,X.adler>>>16),ae(fe,65535&X.adler)),X.adler=1}if(fe.status===69)if(fe.gzhead.extra){for(ce=fe.pending;fe.gzindex<(65535&fe.gzhead.extra.length)&&(fe.pending!==fe.pending_buf_size||(fe.gzhead.hcrc&&fe.pending>ce&&(X.adler=c(X.adler,fe.pending_buf,fe.pending-ce,ce)),G(X),ce=fe.pending,fe.pending!==fe.pending_buf_size));)ne(fe,255&fe.gzhead.extra[fe.gzindex]),fe.gzindex++;fe.gzhead.hcrc&&fe.pending>ce&&(X.adler=c(X.adler,fe.pending_buf,fe.pending-ce,ce)),fe.gzindex===fe.gzhead.extra.length&&(fe.gzindex=0,fe.status=73)}else fe.status=73;if(fe.status===73)if(fe.gzhead.name){ce=fe.pending;do{if(fe.pending===fe.pending_buf_size&&(fe.gzhead.hcrc&&fe.pending>ce&&(X.adler=c(X.adler,fe.pending_buf,fe.pending-ce,ce)),G(X),ce=fe.pending,fe.pending===fe.pending_buf_size)){se=1;break}se=fe.gzindex<fe.gzhead.name.length?255&fe.gzhead.name.charCodeAt(fe.gzindex++):0,ne(fe,se)}while(se!==0);fe.gzhead.hcrc&&fe.pending>ce&&(X.adler=c(X.adler,fe.pending_buf,fe.pending-ce,ce)),se===0&&(fe.gzindex=0,fe.status=91)}else fe.status=91;if(fe.status===91)if(fe.gzhead.comment){ce=fe.pending;do{if(fe.pending===fe.pending_buf_size&&(fe.gzhead.hcrc&&fe.pending>ce&&(X.adler=c(X.adler,fe.pending_buf,fe.pending-ce,ce)),G(X),ce=fe.pending,fe.pending===fe.pending_buf_size)){se=1;break}se=fe.gzindex<fe.gzhead.comment.length?255&fe.gzhead.comment.charCodeAt(fe.gzindex++):0,ne(fe,se)}while(se!==0);fe.gzhead.hcrc&&fe.pending>ce&&(X.adler=c(X.adler,fe.pending_buf,fe.pending-ce,ce)),se===0&&(fe.status=103)}else fe.status=103;if(fe.status===103&&(fe.gzhead.hcrc?(fe.pending+2>fe.pending_buf_size&&G(X),fe.pending+2<=fe.pending_buf_size&&(ne(fe,255&X.adler),ne(fe,X.adler>>8&255),X.adler=0,fe.status=q)):fe.status=q),fe.pending!==0){if(G(X),X.avail_out===0)return fe.last_flush=-1,p}else if(X.avail_in===0&&Y(ye)<=Y(Ne)&&ye!==h)return $(X,-5);if(fe.status===666&&X.avail_in!==0)return $(X,-5);if(X.avail_in!==0||fe.lookahead!==0||ye!==d&&fe.status!==666){var Be=fe.strategy===2?function(je,ot){for(var Et;;){if(je.lookahead===0&&(Se(je),je.lookahead===0)){if(ot===d)return I;break}if(je.match_length=0,Et=o._tr_tally(je,0,je.window[je.strstart]),je.lookahead--,je.strstart++,Et&&(Z(je,!1),je.strm.avail_out===0))return I}return je.insert=0,ot===h?(Z(je,!0),je.strm.avail_out===0?D:z):je.last_lit&&(Z(je,!1),je.strm.avail_out===0)?I:V}(fe,ye):fe.strategy===3?function(je,ot){for(var Et,ut,Pt,$t,Ft=je.window;;){if(je.lookahead<=j){if(Se(je),je.lookahead<=j&&ot===d)return I;if(je.lookahead===0)break}if(je.match_length=0,je.lookahead>=M&&0<je.strstart&&(ut=Ft[Pt=je.strstart-1])===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]){$t=je.strstart+j;do;while(ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&ut===Ft[++Pt]&&Pt<$t);je.match_length=j-($t-Pt),je.match_length>je.lookahead&&(je.match_length=je.lookahead)}if(je.match_length>=M?(Et=o._tr_tally(je,1,je.match_length-M),je.lookahead-=je.match_length,je.strstart+=je.match_length,je.match_length=0):(Et=o._tr_tally(je,0,je.window[je.strstart]),je.lookahead--,je.strstart++),Et&&(Z(je,!1),je.strm.avail_out===0))return I}return je.insert=0,ot===h?(Z(je,!0),je.strm.avail_out===0?D:z):je.last_lit&&(Z(je,!1),je.strm.avail_out===0)?I:V}(fe,ye):i[fe.level].func(fe,ye);if(Be!==D&&Be!==z||(fe.status=666),Be===I||Be===D)return X.avail_out===0&&(fe.last_flush=-1),p;if(Be===V&&(ye===1?o._tr_align(fe):ye!==5&&(o._tr_stored_block(fe,0,0,!1),ye===3&&(B(fe.head),fe.lookahead===0&&(fe.strstart=0,fe.block_start=0,fe.insert=0))),G(X),X.avail_out===0))return fe.last_flush=-1,p}return ye!==h?p:fe.wrap<=0?1:(fe.wrap===2?(ne(fe,255&X.adler),ne(fe,X.adler>>8&255),ne(fe,X.adler>>16&255),ne(fe,X.adler>>24&255),ne(fe,255&X.total_in),ne(fe,X.total_in>>8&255),ne(fe,X.total_in>>16&255),ne(fe,X.total_in>>24&255)):(ae(fe,X.adler>>>16),ae(fe,65535&X.adler)),G(X),0<fe.wrap&&(fe.wrap=-fe.wrap),fe.pending!==0?p:1)},s.deflateEnd=function(X){var ye;return X&&X.state?(ye=X.state.status)!==P&&ye!==69&&ye!==73&&ye!==91&&ye!==103&&ye!==q&&ye!==666?$(X,g):(X.state=null,ye===q?$(X,-3):p):g},s.deflateSetDictionary=function(X,ye){var Ne,fe,ce,se,Pe,Be,je,ot,Et=ye.length;if(!X||!X.state||(se=(Ne=X.state).wrap)===2||se===1&&Ne.status!==P||Ne.lookahead)return g;for(se===1&&(X.adler=l(X.adler,ye,Et,0)),Ne.wrap=0,Et>=Ne.w_size&&(se===0&&(B(Ne.head),Ne.strstart=0,Ne.block_start=0,Ne.insert=0),ot=new a.Buf8(Ne.w_size),a.arraySet(ot,ye,Et-Ne.w_size,Ne.w_size,0),ye=ot,Et=Ne.w_size),Pe=X.avail_in,Be=X.next_in,je=X.input,X.avail_in=Et,X.next_in=0,X.input=ye,Se(Ne);Ne.lookahead>=M;){for(fe=Ne.strstart,ce=Ne.lookahead-(M-1);Ne.ins_h=(Ne.ins_h<<Ne.hash_shift^Ne.window[fe+M-1])&Ne.hash_mask,Ne.prev[fe&Ne.w_mask]=Ne.head[Ne.ins_h],Ne.head[Ne.ins_h]=fe,fe++,--ce;);Ne.strstart=fe,Ne.lookahead=M-1,Se(Ne)}return Ne.strstart+=Ne.lookahead,Ne.block_start=Ne.strstart,Ne.insert=Ne.lookahead,Ne.lookahead=0,Ne.match_length=Ne.prev_length=M-1,Ne.match_available=0,X.next_in=Be,X.input=je,X.avail_in=Pe,Ne.wrap=se,p},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,p,g,y,v,x,w,S,_,k,T,A,R,M,j,F,P,q,I,V;o=i.state,l=i.next_in,I=i.input,c=l+(i.avail_in-5),u=i.next_out,V=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),p=o.dmax,g=o.wsize,y=o.whave,v=o.wnext,x=o.window,w=o.hold,S=o.bits,_=o.lencode,k=o.distcode,T=(1<<o.lenbits)-1,A=(1<<o.distbits)-1;e:do{S<15&&(w+=I[l++]<<S,S+=8,w+=I[l++]<<S,S+=8),R=_[w&T];t:for(;;){if(w>>>=M=R>>>24,S-=M,(M=R>>>16&255)===0)V[u++]=65535&R;else{if(!(16&M)){if((64&M)==0){R=_[(65535&R)+(w&(1<<M)-1)];continue t}if(32&M){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}j=65535&R,(M&=15)&&(S<M&&(w+=I[l++]<<S,S+=8),j+=w&(1<<M)-1,w>>>=M,S-=M),S<15&&(w+=I[l++]<<S,S+=8,w+=I[l++]<<S,S+=8),R=k[w&A];n:for(;;){if(w>>>=M=R>>>24,S-=M,!(16&(M=R>>>16&255))){if((64&M)==0){R=k[(65535&R)+(w&(1<<M)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(F=65535&R,S<(M&=15)&&(w+=I[l++]<<S,(S+=8)<M&&(w+=I[l++]<<S,S+=8)),p<(F+=w&(1<<M)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=M,S-=M,(M=u-d)<F){if(y<(M=F-M)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(q=x,(P=0)===v){if(P+=g-M,M<j){for(j-=M;V[u++]=x[P++],--M;);P=u-F,q=V}}else if(v<M){if(P+=g+v-M,(M-=v)<j){for(j-=M;V[u++]=x[P++],--M;);if(P=0,v<j){for(j-=M=v;V[u++]=x[P++],--M;);P=u-F,q=V}}}else if(P+=v-M,M<j){for(j-=M;V[u++]=x[P++],--M;);P=u-F,q=V}for(;2<j;)V[u++]=q[P++],V[u++]=q[P++],V[u++]=q[P++],j-=3;j&&(V[u++]=q[P++],1<j&&(V[u++]=q[P++]))}else{for(P=u-F;V[u++]=V[P++],V[u++]=V[P++],V[u++]=V[P++],2<(j-=3););j&&(V[u++]=V[P++],1<j&&(V[u++]=V[P++]))}break}}break}}while(l<c&&u<h);l-=j=S>>3,w&=(1<<(S-=j<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=S}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,p=-2,g=1,y=852,v=592;function x(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(P){var q;return P&&P.state?(q=P.state,P.total_in=P.total_out=q.total=0,P.msg="",q.wrap&&(P.adler=1&q.wrap),q.mode=g,q.last=0,q.havedict=0,q.dmax=32768,q.head=null,q.hold=0,q.bits=0,q.lencode=q.lendyn=new i.Buf32(y),q.distcode=q.distdyn=new i.Buf32(v),q.sane=1,q.back=-1,h):p}function _(P){var q;return P&&P.state?((q=P.state).wsize=0,q.whave=0,q.wnext=0,S(P)):p}function k(P,q){var I,V;return P&&P.state?(V=P.state,q<0?(I=0,q=-q):(I=1+(q>>4),q<48&&(q&=15)),q&&(q<8||15<q)?p:(V.window!==null&&V.wbits!==q&&(V.window=null),V.wrap=I,V.wbits=q,_(P))):p}function T(P,q){var I,V;return P?(V=new w,(P.state=V).window=null,(I=k(P,q))!==h&&(P.state=null),I):p}var A,R,M=!0;function j(P){if(M){var q;for(A=new i.Buf32(512),R=new i.Buf32(32),q=0;q<144;)P.lens[q++]=8;for(;q<256;)P.lens[q++]=9;for(;q<280;)P.lens[q++]=7;for(;q<288;)P.lens[q++]=8;for(c(u,P.lens,0,288,A,0,P.work,{bits:9}),q=0;q<32;)P.lens[q++]=5;c(d,P.lens,0,32,R,0,P.work,{bits:5}),M=!1}P.lencode=A,P.lenbits=9,P.distcode=R,P.distbits=5}function F(P,q,I,V){var D,z=P.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new i.Buf8(z.wsize)),V>=z.wsize?(i.arraySet(z.window,q,I-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(V<(D=z.wsize-z.wnext)&&(D=V),i.arraySet(z.window,q,I-V,D,z.wnext),(V-=D)?(i.arraySet(z.window,q,I-V,V,0),z.wnext=V,z.whave=z.wsize):(z.wnext+=D,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=D))),0}s.inflateReset=_,s.inflateReset2=k,s.inflateResetKeep=S,s.inflateInit=function(P){return T(P,15)},s.inflateInit2=T,s.inflate=function(P,q){var I,V,D,z,$,Y,B,G,Z,ne,ae,le,Se,Ee,he,pe,Le,He,Fe,Ie,X,ye,Ne,fe,ce=0,se=new i.Buf8(4),Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return p;(I=P.state).mode===12&&(I.mode=13),$=P.next_out,D=P.output,B=P.avail_out,z=P.next_in,V=P.input,Y=P.avail_in,G=I.hold,Z=I.bits,ne=Y,ae=B,ye=h;e:for(;;)switch(I.mode){case g:if(I.wrap===0){I.mode=13;break}for(;Z<16;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(2&I.wrap&&G===35615){se[I.check=0]=255&G,se[1]=G>>>8&255,I.check=o(I.check,se,2,0),Z=G=0,I.mode=2;break}if(I.flags=0,I.head&&(I.head.done=!1),!(1&I.wrap)||(((255&G)<<8)+(G>>8))%31){P.msg="incorrect header check",I.mode=30;break}if((15&G)!=8){P.msg="unknown compression method",I.mode=30;break}if(Z-=4,X=8+(15&(G>>>=4)),I.wbits===0)I.wbits=X;else if(X>I.wbits){P.msg="invalid window size",I.mode=30;break}I.dmax=1<<X,P.adler=I.check=1,I.mode=512&G?10:12,Z=G=0;break;case 2:for(;Z<16;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(I.flags=G,(255&I.flags)!=8){P.msg="unknown compression method",I.mode=30;break}if(57344&I.flags){P.msg="unknown header flags set",I.mode=30;break}I.head&&(I.head.text=G>>8&1),512&I.flags&&(se[0]=255&G,se[1]=G>>>8&255,I.check=o(I.check,se,2,0)),Z=G=0,I.mode=3;case 3:for(;Z<32;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}I.head&&(I.head.time=G),512&I.flags&&(se[0]=255&G,se[1]=G>>>8&255,se[2]=G>>>16&255,se[3]=G>>>24&255,I.check=o(I.check,se,4,0)),Z=G=0,I.mode=4;case 4:for(;Z<16;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}I.head&&(I.head.xflags=255&G,I.head.os=G>>8),512&I.flags&&(se[0]=255&G,se[1]=G>>>8&255,I.check=o(I.check,se,2,0)),Z=G=0,I.mode=5;case 5:if(1024&I.flags){for(;Z<16;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}I.length=G,I.head&&(I.head.extra_len=G),512&I.flags&&(se[0]=255&G,se[1]=G>>>8&255,I.check=o(I.check,se,2,0)),Z=G=0}else I.head&&(I.head.extra=null);I.mode=6;case 6:if(1024&I.flags&&(Y<(le=I.length)&&(le=Y),le&&(I.head&&(X=I.head.extra_len-I.length,I.head.extra||(I.head.extra=new Array(I.head.extra_len)),i.arraySet(I.head.extra,V,z,le,X)),512&I.flags&&(I.check=o(I.check,V,le,z)),Y-=le,z+=le,I.length-=le),I.length))break e;I.length=0,I.mode=7;case 7:if(2048&I.flags){if(Y===0)break e;for(le=0;X=V[z+le++],I.head&&X&&I.length<65536&&(I.head.name+=String.fromCharCode(X)),X&&le<Y;);if(512&I.flags&&(I.check=o(I.check,V,le,z)),Y-=le,z+=le,X)break e}else I.head&&(I.head.name=null);I.length=0,I.mode=8;case 8:if(4096&I.flags){if(Y===0)break e;for(le=0;X=V[z+le++],I.head&&X&&I.length<65536&&(I.head.comment+=String.fromCharCode(X)),X&&le<Y;);if(512&I.flags&&(I.check=o(I.check,V,le,z)),Y-=le,z+=le,X)break e}else I.head&&(I.head.comment=null);I.mode=9;case 9:if(512&I.flags){for(;Z<16;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(G!==(65535&I.check)){P.msg="header crc mismatch",I.mode=30;break}Z=G=0}I.head&&(I.head.hcrc=I.flags>>9&1,I.head.done=!0),P.adler=I.check=0,I.mode=12;break;case 10:for(;Z<32;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}P.adler=I.check=x(G),Z=G=0,I.mode=11;case 11:if(I.havedict===0)return P.next_out=$,P.avail_out=B,P.next_in=z,P.avail_in=Y,I.hold=G,I.bits=Z,2;P.adler=I.check=1,I.mode=12;case 12:if(q===5||q===6)break e;case 13:if(I.last){G>>>=7&Z,Z-=7&Z,I.mode=27;break}for(;Z<3;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}switch(I.last=1&G,Z-=1,3&(G>>>=1)){case 0:I.mode=14;break;case 1:if(j(I),I.mode=20,q!==6)break;G>>>=2,Z-=2;break e;case 2:I.mode=17;break;case 3:P.msg="invalid block type",I.mode=30}G>>>=2,Z-=2;break;case 14:for(G>>>=7&Z,Z-=7&Z;Z<32;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if((65535&G)!=(G>>>16^65535)){P.msg="invalid stored block lengths",I.mode=30;break}if(I.length=65535&G,Z=G=0,I.mode=15,q===6)break e;case 15:I.mode=16;case 16:if(le=I.length){if(Y<le&&(le=Y),B<le&&(le=B),le===0)break e;i.arraySet(D,V,z,le,$),Y-=le,z+=le,B-=le,$+=le,I.length-=le;break}I.mode=12;break;case 17:for(;Z<14;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(I.nlen=257+(31&G),G>>>=5,Z-=5,I.ndist=1+(31&G),G>>>=5,Z-=5,I.ncode=4+(15&G),G>>>=4,Z-=4,286<I.nlen||30<I.ndist){P.msg="too many length or distance symbols",I.mode=30;break}I.have=0,I.mode=18;case 18:for(;I.have<I.ncode;){for(;Z<3;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}I.lens[Pe[I.have++]]=7&G,G>>>=3,Z-=3}for(;I.have<19;)I.lens[Pe[I.have++]]=0;if(I.lencode=I.lendyn,I.lenbits=7,Ne={bits:I.lenbits},ye=c(0,I.lens,0,19,I.lencode,0,I.work,Ne),I.lenbits=Ne.bits,ye){P.msg="invalid code lengths set",I.mode=30;break}I.have=0,I.mode=19;case 19:for(;I.have<I.nlen+I.ndist;){for(;pe=(ce=I.lencode[G&(1<<I.lenbits)-1])>>>16&255,Le=65535&ce,!((he=ce>>>24)<=Z);){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(Le<16)G>>>=he,Z-=he,I.lens[I.have++]=Le;else{if(Le===16){for(fe=he+2;Z<fe;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(G>>>=he,Z-=he,I.have===0){P.msg="invalid bit length repeat",I.mode=30;break}X=I.lens[I.have-1],le=3+(3&G),G>>>=2,Z-=2}else if(Le===17){for(fe=he+3;Z<fe;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}Z-=he,X=0,le=3+(7&(G>>>=he)),G>>>=3,Z-=3}else{for(fe=he+7;Z<fe;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}Z-=he,X=0,le=11+(127&(G>>>=he)),G>>>=7,Z-=7}if(I.have+le>I.nlen+I.ndist){P.msg="invalid bit length repeat",I.mode=30;break}for(;le--;)I.lens[I.have++]=X}}if(I.mode===30)break;if(I.lens[256]===0){P.msg="invalid code -- missing end-of-block",I.mode=30;break}if(I.lenbits=9,Ne={bits:I.lenbits},ye=c(u,I.lens,0,I.nlen,I.lencode,0,I.work,Ne),I.lenbits=Ne.bits,ye){P.msg="invalid literal/lengths set",I.mode=30;break}if(I.distbits=6,I.distcode=I.distdyn,Ne={bits:I.distbits},ye=c(d,I.lens,I.nlen,I.ndist,I.distcode,0,I.work,Ne),I.distbits=Ne.bits,ye){P.msg="invalid distances set",I.mode=30;break}if(I.mode=20,q===6)break e;case 20:I.mode=21;case 21:if(6<=Y&&258<=B){P.next_out=$,P.avail_out=B,P.next_in=z,P.avail_in=Y,I.hold=G,I.bits=Z,l(P,ae),$=P.next_out,D=P.output,B=P.avail_out,z=P.next_in,V=P.input,Y=P.avail_in,G=I.hold,Z=I.bits,I.mode===12&&(I.back=-1);break}for(I.back=0;pe=(ce=I.lencode[G&(1<<I.lenbits)-1])>>>16&255,Le=65535&ce,!((he=ce>>>24)<=Z);){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(pe&&(240&pe)==0){for(He=he,Fe=pe,Ie=Le;pe=(ce=I.lencode[Ie+((G&(1<<He+Fe)-1)>>He)])>>>16&255,Le=65535&ce,!(He+(he=ce>>>24)<=Z);){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}G>>>=He,Z-=He,I.back+=He}if(G>>>=he,Z-=he,I.back+=he,I.length=Le,pe===0){I.mode=26;break}if(32&pe){I.back=-1,I.mode=12;break}if(64&pe){P.msg="invalid literal/length code",I.mode=30;break}I.extra=15&pe,I.mode=22;case 22:if(I.extra){for(fe=I.extra;Z<fe;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}I.length+=G&(1<<I.extra)-1,G>>>=I.extra,Z-=I.extra,I.back+=I.extra}I.was=I.length,I.mode=23;case 23:for(;pe=(ce=I.distcode[G&(1<<I.distbits)-1])>>>16&255,Le=65535&ce,!((he=ce>>>24)<=Z);){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if((240&pe)==0){for(He=he,Fe=pe,Ie=Le;pe=(ce=I.distcode[Ie+((G&(1<<He+Fe)-1)>>He)])>>>16&255,Le=65535&ce,!(He+(he=ce>>>24)<=Z);){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}G>>>=He,Z-=He,I.back+=He}if(G>>>=he,Z-=he,I.back+=he,64&pe){P.msg="invalid distance code",I.mode=30;break}I.offset=Le,I.extra=15&pe,I.mode=24;case 24:if(I.extra){for(fe=I.extra;Z<fe;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}I.offset+=G&(1<<I.extra)-1,G>>>=I.extra,Z-=I.extra,I.back+=I.extra}if(I.offset>I.dmax){P.msg="invalid distance too far back",I.mode=30;break}I.mode=25;case 25:if(B===0)break e;if(le=ae-B,I.offset>le){if((le=I.offset-le)>I.whave&&I.sane){P.msg="invalid distance too far back",I.mode=30;break}Se=le>I.wnext?(le-=I.wnext,I.wsize-le):I.wnext-le,le>I.length&&(le=I.length),Ee=I.window}else Ee=D,Se=$-I.offset,le=I.length;for(B<le&&(le=B),B-=le,I.length-=le;D[$++]=Ee[Se++],--le;);I.length===0&&(I.mode=21);break;case 26:if(B===0)break e;D[$++]=I.length,B--,I.mode=21;break;case 27:if(I.wrap){for(;Z<32;){if(Y===0)break e;Y--,G|=V[z++]<<Z,Z+=8}if(ae-=B,P.total_out+=ae,I.total+=ae,ae&&(P.adler=I.check=I.flags?o(I.check,D,ae,$-ae):a(I.check,D,ae,$-ae)),ae=B,(I.flags?G:x(G))!==I.check){P.msg="incorrect data check",I.mode=30;break}Z=G=0}I.mode=28;case 28:if(I.wrap&&I.flags){for(;Z<32;){if(Y===0)break e;Y--,G+=V[z++]<<Z,Z+=8}if(G!==(4294967295&I.total)){P.msg="incorrect length check",I.mode=30;break}Z=G=0}I.mode=29;case 29:ye=1;break e;case 30:ye=-3;break e;case 31:return-4;case 32:default:return p}return P.next_out=$,P.avail_out=B,P.next_in=z,P.avail_in=Y,I.hold=G,I.bits=Z,(I.wsize||ae!==P.avail_out&&I.mode<30&&(I.mode<27||q!==4))&&F(P,P.output,P.next_out,ae-P.avail_out)?(I.mode=31,-4):(ne-=P.avail_in,ae-=P.avail_out,P.total_in+=ne,P.total_out+=ae,I.total+=ae,I.wrap&&ae&&(P.adler=I.check=I.flags?o(I.check,D,ae,P.next_out-ae):a(I.check,D,ae,P.next_out-ae)),P.data_type=I.bits+(I.last?64:0)+(I.mode===12?128:0)+(I.mode===20||I.mode===15?256:0),(ne==0&&ae===0||q===4)&&ye===h&&(ye=-5),ye)},s.inflateEnd=function(P){if(!P||!P.state)return p;var q=P.state;return q.window&&(q.window=null),P.state=null,h},s.inflateGetHeader=function(P,q){var I;return P&&P.state?(2&(I=P.state).wrap)==0?p:((I.head=q).done=!1,h):p},s.inflateSetDictionary=function(P,q){var I,V=q.length;return P&&P.state?(I=P.state).wrap!==0&&I.mode!==11?p:I.mode===11&&a(1,q,V,0)!==I.check?-3:F(P,q,V,V)?(I.mode=31,-4):(I.havedict=1,h):p},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,p,g,y,v,x){var w,S,_,k,T,A,R,M,j,F=x.bits,P=0,q=0,I=0,V=0,D=0,z=0,$=0,Y=0,B=0,G=0,Z=null,ne=0,ae=new i.Buf16(16),le=new i.Buf16(16),Se=null,Ee=0;for(P=0;P<=15;P++)ae[P]=0;for(q=0;q<p;q++)ae[d[h+q]]++;for(D=F,V=15;1<=V&&ae[V]===0;V--);if(V<D&&(D=V),V===0)return g[y++]=20971520,g[y++]=20971520,x.bits=1,0;for(I=1;I<V&&ae[I]===0;I++);for(D<I&&(D=I),P=Y=1;P<=15;P++)if(Y<<=1,(Y-=ae[P])<0)return-1;if(0<Y&&(u===0||V!==1))return-1;for(le[1]=0,P=1;P<15;P++)le[P+1]=le[P]+ae[P];for(q=0;q<p;q++)d[h+q]!==0&&(v[le[d[h+q]]++]=q);if(A=u===0?(Z=Se=v,19):u===1?(Z=a,ne-=257,Se=o,Ee-=257,256):(Z=l,Se=c,-1),P=I,T=y,$=q=G=0,_=-1,k=(B=1<<(z=D))-1,u===1&&852<B||u===2&&592<B)return 1;for(;;){for(R=P-$,j=v[q]<A?(M=0,v[q]):v[q]>A?(M=Se[Ee+v[q]],Z[ne+v[q]]):(M=96,0),w=1<<P-$,I=S=1<<z;g[T+(G>>$)+(S-=w)]=R<<24|M<<16|j|0,S!==0;);for(w=1<<P-1;G&w;)w>>=1;if(w!==0?(G&=w-1,G+=w):G=0,q++,--ae[P]==0){if(P===V)break;P=d[h+v[q]]}if(D<P&&(G&k)!==_){for($===0&&($=D),T+=I,Y=1<<(z=P-$);z+$<V&&!((Y-=ae[z+$])<=0);)z++,Y<<=1;if(B+=1<<z,u===1&&852<B||u===2&&592<B)return 1;g[_=G&k]=D<<24|z<<16|T-y|0}}return G!==0&&(g[T+G]=P-$<<24|64<<16|0),x.bits=D,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(ce){for(var se=ce.length;0<=--se;)ce[se]=0}var c=0,u=29,d=256,h=d+1+u,p=30,g=19,y=2*h+1,v=15,x=16,w=7,S=256,_=16,k=17,T=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=new Array(2*(h+2));l(F);var P=new Array(2*p);l(P);var q=new Array(512);l(q);var I=new Array(256);l(I);var V=new Array(u);l(V);var D,z,$,Y=new Array(p);function B(ce,se,Pe,Be,je){this.static_tree=ce,this.extra_bits=se,this.extra_base=Pe,this.elems=Be,this.max_length=je,this.has_stree=ce&&ce.length}function G(ce,se){this.dyn_tree=ce,this.max_code=0,this.stat_desc=se}function Z(ce){return ce<256?q[ce]:q[256+(ce>>>7)]}function ne(ce,se){ce.pending_buf[ce.pending++]=255&se,ce.pending_buf[ce.pending++]=se>>>8&255}function ae(ce,se,Pe){ce.bi_valid>x-Pe?(ce.bi_buf|=se<<ce.bi_valid&65535,ne(ce,ce.bi_buf),ce.bi_buf=se>>x-ce.bi_valid,ce.bi_valid+=Pe-x):(ce.bi_buf|=se<<ce.bi_valid&65535,ce.bi_valid+=Pe)}function le(ce,se,Pe){ae(ce,Pe[2*se],Pe[2*se+1])}function Se(ce,se){for(var Pe=0;Pe|=1&ce,ce>>>=1,Pe<<=1,0<--se;);return Pe>>>1}function Ee(ce,se,Pe){var Be,je,ot=new Array(v+1),Et=0;for(Be=1;Be<=v;Be++)ot[Be]=Et=Et+Pe[Be-1]<<1;for(je=0;je<=se;je++){var ut=ce[2*je+1];ut!==0&&(ce[2*je]=Se(ot[ut]++,ut))}}function he(ce){var se;for(se=0;se<h;se++)ce.dyn_ltree[2*se]=0;for(se=0;se<p;se++)ce.dyn_dtree[2*se]=0;for(se=0;se<g;se++)ce.bl_tree[2*se]=0;ce.dyn_ltree[2*S]=1,ce.opt_len=ce.static_len=0,ce.last_lit=ce.matches=0}function pe(ce){8<ce.bi_valid?ne(ce,ce.bi_buf):0<ce.bi_valid&&(ce.pending_buf[ce.pending++]=ce.bi_buf),ce.bi_buf=0,ce.bi_valid=0}function Le(ce,se,Pe,Be){var je=2*se,ot=2*Pe;return ce[je]<ce[ot]||ce[je]===ce[ot]&&Be[se]<=Be[Pe]}function He(ce,se,Pe){for(var Be=ce.heap[Pe],je=Pe<<1;je<=ce.heap_len&&(je<ce.heap_len&&Le(se,ce.heap[je+1],ce.heap[je],ce.depth)&&je++,!Le(se,Be,ce.heap[je],ce.depth));)ce.heap[Pe]=ce.heap[je],Pe=je,je<<=1;ce.heap[Pe]=Be}function Fe(ce,se,Pe){var Be,je,ot,Et,ut=0;if(ce.last_lit!==0)for(;Be=ce.pending_buf[ce.d_buf+2*ut]<<8|ce.pending_buf[ce.d_buf+2*ut+1],je=ce.pending_buf[ce.l_buf+ut],ut++,Be===0?le(ce,je,se):(le(ce,(ot=I[je])+d+1,se),(Et=A[ot])!==0&&ae(ce,je-=V[ot],Et),le(ce,ot=Z(--Be),Pe),(Et=R[ot])!==0&&ae(ce,Be-=Y[ot],Et)),ut<ce.last_lit;);le(ce,S,se)}function Ie(ce,se){var Pe,Be,je,ot=se.dyn_tree,Et=se.stat_desc.static_tree,ut=se.stat_desc.has_stree,Pt=se.stat_desc.elems,$t=-1;for(ce.heap_len=0,ce.heap_max=y,Pe=0;Pe<Pt;Pe++)ot[2*Pe]!==0?(ce.heap[++ce.heap_len]=$t=Pe,ce.depth[Pe]=0):ot[2*Pe+1]=0;for(;ce.heap_len<2;)ot[2*(je=ce.heap[++ce.heap_len]=$t<2?++$t:0)]=1,ce.depth[je]=0,ce.opt_len--,ut&&(ce.static_len-=Et[2*je+1]);for(se.max_code=$t,Pe=ce.heap_len>>1;1<=Pe;Pe--)He(ce,ot,Pe);for(je=Pt;Pe=ce.heap[1],ce.heap[1]=ce.heap[ce.heap_len--],He(ce,ot,1),Be=ce.heap[1],ce.heap[--ce.heap_max]=Pe,ce.heap[--ce.heap_max]=Be,ot[2*je]=ot[2*Pe]+ot[2*Be],ce.depth[je]=(ce.depth[Pe]>=ce.depth[Be]?ce.depth[Pe]:ce.depth[Be])+1,ot[2*Pe+1]=ot[2*Be+1]=je,ce.heap[1]=je++,He(ce,ot,1),2<=ce.heap_len;);ce.heap[--ce.heap_max]=ce.heap[1],function(Ft,Ht){var Ce,U,ee,xe,Re,ve,Me=Ht.dyn_tree,de=Ht.max_code,ht=Ht.stat_desc.static_tree,et=Ht.stat_desc.has_stree,W=Ht.stat_desc.extra_bits,Ve=Ht.stat_desc.extra_base,tt=Ht.stat_desc.max_length,we=0;for(xe=0;xe<=v;xe++)Ft.bl_count[xe]=0;for(Me[2*Ft.heap[Ft.heap_max]+1]=0,Ce=Ft.heap_max+1;Ce<y;Ce++)tt<(xe=Me[2*Me[2*(U=Ft.heap[Ce])+1]+1]+1)&&(xe=tt,we++),Me[2*U+1]=xe,de<U||(Ft.bl_count[xe]++,Re=0,Ve<=U&&(Re=W[U-Ve]),ve=Me[2*U],Ft.opt_len+=ve*(xe+Re),et&&(Ft.static_len+=ve*(ht[2*U+1]+Re)));if(we!==0){do{for(xe=tt-1;Ft.bl_count[xe]===0;)xe--;Ft.bl_count[xe]--,Ft.bl_count[xe+1]+=2,Ft.bl_count[tt]--,we-=2}while(0<we);for(xe=tt;xe!==0;xe--)for(U=Ft.bl_count[xe];U!==0;)de<(ee=Ft.heap[--Ce])||(Me[2*ee+1]!==xe&&(Ft.opt_len+=(xe-Me[2*ee+1])*Me[2*ee],Me[2*ee+1]=xe),U--)}}(ce,se),Ee(ot,$t,ce.bl_count)}function X(ce,se,Pe){var Be,je,ot=-1,Et=se[1],ut=0,Pt=7,$t=4;for(Et===0&&(Pt=138,$t=3),se[2*(Pe+1)+1]=65535,Be=0;Be<=Pe;Be++)je=Et,Et=se[2*(Be+1)+1],++ut<Pt&&je===Et||(ut<$t?ce.bl_tree[2*je]+=ut:je!==0?(je!==ot&&ce.bl_tree[2*je]++,ce.bl_tree[2*_]++):ut<=10?ce.bl_tree[2*k]++:ce.bl_tree[2*T]++,ot=je,$t=(ut=0)===Et?(Pt=138,3):je===Et?(Pt=6,3):(Pt=7,4))}function ye(ce,se,Pe){var Be,je,ot=-1,Et=se[1],ut=0,Pt=7,$t=4;for(Et===0&&(Pt=138,$t=3),Be=0;Be<=Pe;Be++)if(je=Et,Et=se[2*(Be+1)+1],!(++ut<Pt&&je===Et)){if(ut<$t)for(;le(ce,je,ce.bl_tree),--ut!=0;);else je!==0?(je!==ot&&(le(ce,je,ce.bl_tree),ut--),le(ce,_,ce.bl_tree),ae(ce,ut-3,2)):ut<=10?(le(ce,k,ce.bl_tree),ae(ce,ut-3,3)):(le(ce,T,ce.bl_tree),ae(ce,ut-11,7));ot=je,$t=(ut=0)===Et?(Pt=138,3):je===Et?(Pt=6,3):(Pt=7,4)}}l(Y);var Ne=!1;function fe(ce,se,Pe,Be){ae(ce,(c<<1)+(Be?1:0),3),function(je,ot,Et,ut){pe(je),ne(je,Et),ne(je,~Et),i.arraySet(je.pending_buf,je.window,ot,Et,je.pending),je.pending+=Et}(ce,se,Pe)}s._tr_init=function(ce){Ne||(function(){var se,Pe,Be,je,ot,Et=new Array(v+1);for(je=Be=0;je<u-1;je++)for(V[je]=Be,se=0;se<1<<A[je];se++)I[Be++]=je;for(I[Be-1]=je,je=ot=0;je<16;je++)for(Y[je]=ot,se=0;se<1<<R[je];se++)q[ot++]=je;for(ot>>=7;je<p;je++)for(Y[je]=ot<<7,se=0;se<1<<R[je]-7;se++)q[256+ot++]=je;for(Pe=0;Pe<=v;Pe++)Et[Pe]=0;for(se=0;se<=143;)F[2*se+1]=8,se++,Et[8]++;for(;se<=255;)F[2*se+1]=9,se++,Et[9]++;for(;se<=279;)F[2*se+1]=7,se++,Et[7]++;for(;se<=287;)F[2*se+1]=8,se++,Et[8]++;for(Ee(F,h+1,Et),se=0;se<p;se++)P[2*se+1]=5,P[2*se]=Se(se,5);D=new B(F,A,d+1,h,v),z=new B(P,R,0,p,v),$=new B(new Array(0),M,0,g,w)}(),Ne=!0),ce.l_desc=new G(ce.dyn_ltree,D),ce.d_desc=new G(ce.dyn_dtree,z),ce.bl_desc=new G(ce.bl_tree,$),ce.bi_buf=0,ce.bi_valid=0,he(ce)},s._tr_stored_block=fe,s._tr_flush_block=function(ce,se,Pe,Be){var je,ot,Et=0;0<ce.level?(ce.strm.data_type===2&&(ce.strm.data_type=function(ut){var Pt,$t=4093624447;for(Pt=0;Pt<=31;Pt++,$t>>>=1)if(1&$t&&ut.dyn_ltree[2*Pt]!==0)return a;if(ut.dyn_ltree[18]!==0||ut.dyn_ltree[20]!==0||ut.dyn_ltree[26]!==0)return o;for(Pt=32;Pt<d;Pt++)if(ut.dyn_ltree[2*Pt]!==0)return o;return a}(ce)),Ie(ce,ce.l_desc),Ie(ce,ce.d_desc),Et=function(ut){var Pt;for(X(ut,ut.dyn_ltree,ut.l_desc.max_code),X(ut,ut.dyn_dtree,ut.d_desc.max_code),Ie(ut,ut.bl_desc),Pt=g-1;3<=Pt&&ut.bl_tree[2*j[Pt]+1]===0;Pt--);return ut.opt_len+=3*(Pt+1)+5+5+4,Pt}(ce),je=ce.opt_len+3+7>>>3,(ot=ce.static_len+3+7>>>3)<=je&&(je=ot)):je=ot=Pe+5,Pe+4<=je&&se!==-1?fe(ce,se,Pe,Be):ce.strategy===4||ot===je?(ae(ce,2+(Be?1:0),3),Fe(ce,F,P)):(ae(ce,4+(Be?1:0),3),function(ut,Pt,$t,Ft){var Ht;for(ae(ut,Pt-257,5),ae(ut,$t-1,5),ae(ut,Ft-4,4),Ht=0;Ht<Ft;Ht++)ae(ut,ut.bl_tree[2*j[Ht]+1],3);ye(ut,ut.dyn_ltree,Pt-1),ye(ut,ut.dyn_dtree,$t-1)}(ce,ce.l_desc.max_code+1,ce.d_desc.max_code+1,Et+1),Fe(ce,ce.dyn_ltree,ce.dyn_dtree)),he(ce),Be&&pe(ce)},s._tr_tally=function(ce,se,Pe){return ce.pending_buf[ce.d_buf+2*ce.last_lit]=se>>>8&255,ce.pending_buf[ce.d_buf+2*ce.last_lit+1]=255&se,ce.pending_buf[ce.l_buf+ce.last_lit]=255&Pe,ce.last_lit++,se===0?ce.dyn_ltree[2*Pe]++:(ce.matches++,se--,ce.dyn_ltree[2*(I[Pe]+d+1)]++,ce.dyn_dtree[2*Z(se)]++),ce.last_lit===ce.lit_bufsize-1},s._tr_align=function(ce){ae(ce,2,3),le(ce,S,F),function(se){se.bi_valid===16?(ne(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}(ce)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,p={},g=!1,y=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(_){Wi.nextTick(function(){w(_)})}:function(){if(a.postMessage&&!a.importScripts){var _=!0,k=a.onmessage;return a.onmessage=function(){_=!1},a.postMessage("","*"),a.onmessage=k,_}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(_){a.postMessage(d+_,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(_){w(_.data)},function(_){u.port2.postMessage(_)}):y&&"onreadystatechange"in y.createElement("script")?(c=y.documentElement,function(_){var k=y.createElement("script");k.onreadystatechange=function(){w(_),k.onreadystatechange=null,c.removeChild(k),k=null},c.appendChild(k)}):function(_){setTimeout(w,0,_)},v.setImmediate=function(_){typeof _!="function"&&(_=new Function(""+_));for(var k=new Array(arguments.length-1),T=0;T<k.length;T++)k[T]=arguments[T+1];var A={callback:_,args:k};return p[h]=A,l(h),h++},v.clearImmediate=x}function x(_){delete p[_]}function w(_){if(g)setTimeout(w,0,_);else{var k=p[_];if(k){g=!0;try{(function(T){var A=T.callback,R=T.args;switch(R.length){case 0:A();break;case 1:A(R[0]);break;case 2:A(R[0],R[1]);break;case 3:A(R[0],R[1],R[2]);break;default:A.apply(o,R)}})(k)}finally{x(_),g=!1}}}}function S(_){_.source===a&&typeof _.data=="string"&&_.data.indexOf(d)===0&&w(+_.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof jm<"u"?jm:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(ij)),ij.exports}var UTe=zTe();const JF=la(UTe),i1=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},Hr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},cd=(...e)=>Hr(e.map(t=>t.trim()).filter(Boolean).join("/")),gA=e=>{const t=Hr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},Ai=e=>{const t=Hr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},p4=(e,t)=>Hr(e==="/"?`/${t}`:`${e}/${t}`);var aj,D7;function qTe(){if(D7)return aj;D7=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Wi>"u"||typeof Wi.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(S,_){i=S,a=_})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,p=function(S,_,k){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?_?a(_):i(k):typeof r=="function"&&r(_,k),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},g=function(S){if(l)return p(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=Wi.domain);var _=s.maxExecutionTime||h.maxExecutionTime;if(_&&(d=setTimeout(function(){h.queues[t]&&p(S,new Error("Maximum execution time is exceeded "+t))},_)),n.length===1){var k=!1;try{n(function(T,A){k||(k=!0,p(S,T,A))})}catch(T){k||(k=!0,p(S,T))}}else h._promiseTry(function(){return n()}).then(function(T){p(S,void 0,T)},function(T){p(S,T)})};h.domainReentrant&&Wi.domain&&(g=Wi.domain.bind(g));var y=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],g(!0);else if(h.domainReentrant&&Wi.domain&&Wi.domain===h.domains[t])g(!1);else if(h.queues[t].length>=y)p(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){g(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,p(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&p(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},aj=e,aj}var oj,F7;function VTe(){return F7||(F7=1,oj=qTe()),oj}var WTe=VTe();const a1=la(WTe);var WC={exports:{}},L7;function HTe(){return L7||(L7=1,typeof Object.create=="function"?WC.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:WC.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),WC.exports}var lj,$7;function GTe(){if($7)return lj;$7=1;var e=zF().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},lj=t,lj}var cj,B7;function KTe(){if(B7)return cj;B7=1;var e=HTe(),t=GTe(),n=zF().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,p){return u===0?d&h|~d&p:u===2?d&h|d&p|h&p:d^h^p}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,p=this._b|0,g=this._c|0,y=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var S=~~(w/20),_=o(h)+c(S,p,g,y)+v+d[w]+r[S]|0;v=y,y=g,g=l(p),p=h,h=_}this._a=h+this._a|0,this._b=p+this._b|0,this._c=g+this._c|0,this._d=y+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},cj=i,cj}var YTe=KTe();const wJ=la(YTe);var uj,z7;function ZTe(){if(z7)return uj;z7=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Wi.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,p=c<h?c:h,g=-1,y=0;y<=p;++y){if(y===p){if(h>p){if(a.charCodeAt(u+y)===47)return a.slice(u+y+1);if(y===0)return a.slice(u+y)}else c>p&&(i.charCodeAt(o+y)===47?g=y:y===0&&(g=0));break}var v=i.charCodeAt(o+y),x=a.charCodeAt(u+y);if(v!==x)break;v===47&&(g=y)}var w="";for(y=o+g+1;y<=l;++y)(y===l||i.charCodeAt(y)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+g):(u+=g,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var p=i.charCodeAt(u);if(p===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(p===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,p=!0,g=i.length-1,y=0;g>=c;--g){if(o=i.charCodeAt(g),o===47){if(!p){d=g+1;break}continue}h===-1&&(p=!1,h=g+1),o===46?u===-1?u=g:y!==1&&(y=1):u!==-1&&(y=-1)}return u===-1||h===-1||y===0||y===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,uj=r,uj}var Ut=ZTe(),dj={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var U7;function XTe(){return U7||(U7=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var R=0,M=new Array(256),j=0;j!=256;++j)R=j,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,M[j]=R;return typeof Int32Array<"u"?new Int32Array(M):M}var r=n();function s(R){var M=0,j=0,F=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)P[F]=R[F];for(F=0;F!=256;++F)for(j=R[F],M=256+F;M<4096;M+=256)j=P[M]=j>>>8^R[j&255];var q=[];for(F=1;F!=16;++F)q[F-1]=typeof Int32Array<"u"?P.subarray(F*256,F*256+256):P.slice(F*256,F*256+256);return q}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],p=i[7],g=i[8],y=i[9],v=i[10],x=i[11],w=i[12],S=i[13],_=i[14];function k(R,M){for(var j=M^-1,F=0,P=R.length;F<P;)j=j>>>8^r[(j^R.charCodeAt(F++))&255];return~j}function T(R,M){for(var j=M^-1,F=R.length-15,P=0;P<F;)j=_[R[P++]^j&255]^S[R[P++]^j>>8&255]^w[R[P++]^j>>16&255]^x[R[P++]^j>>>24]^v[R[P++]]^y[R[P++]]^g[R[P++]]^p[R[P++]]^h[R[P++]]^d[R[P++]]^u[R[P++]]^c[R[P++]]^l[R[P++]]^o[R[P++]]^a[R[P++]]^r[R[P++]];for(F+=15;P<F;)j=j>>>8^r[(j^R[P++])&255];return~j}function A(R,M){for(var j=M^-1,F=0,P=R.length,q=0,I=0;F<P;)q=R.charCodeAt(F++),q<128?j=j>>>8^r[(j^q)&255]:q<2048?(j=j>>>8^r[(j^(192|q>>6&31))&255],j=j>>>8^r[(j^(128|q&63))&255]):q>=55296&&q<57344?(q=(q&1023)+64,I=R.charCodeAt(F++)&1023,j=j>>>8^r[(j^(240|q>>8&7))&255],j=j>>>8^r[(j^(128|q>>2&63))&255],j=j>>>8^r[(j^(128|I>>6&15|(q&3)<<4))&255],j=j>>>8^r[(j^(128|I&63))&255]):(j=j>>>8^r[(j^(224|q>>12&15))&255],j=j>>>8^r[(j^(128|q>>6&63))&255],j=j>>>8^r[(j^(128|q&63))&255]);return~j}t.table=r,t.bstr=k,t.buf=T,t.str=A})}(dj)),dj}var JTe=XTe();const QTe=la(JTe);var fj={},q7;function Rp(){return q7||(q7=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(fj)),fj}var O0={},Oc={},bm={},V7;function eAe(){if(V7)return bm;V7=1;var e=Rp(),t=4,n=0,r=1,s=2;function i(U){for(var ee=U.length;--ee>=0;)U[ee]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,p=h+1+d,g=30,y=19,v=2*p+1,x=15,w=16,S=7,_=256,k=16,T=17,A=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,q=new Array((p+2)*2);i(q);var I=new Array(g*2);i(I);var V=new Array(P);i(V);var D=new Array(u-c+1);i(D);var z=new Array(d);i(z);var $=new Array(g);i($);function Y(U,ee,xe,Re,ve){this.static_tree=U,this.extra_bits=ee,this.extra_base=xe,this.elems=Re,this.max_length=ve,this.has_stree=U&&U.length}var B,G,Z;function ne(U,ee){this.dyn_tree=U,this.max_code=0,this.stat_desc=ee}function ae(U){return U<256?V[U]:V[256+(U>>>7)]}function le(U,ee){U.pending_buf[U.pending++]=ee&255,U.pending_buf[U.pending++]=ee>>>8&255}function Se(U,ee,xe){U.bi_valid>w-xe?(U.bi_buf|=ee<<U.bi_valid&65535,le(U,U.bi_buf),U.bi_buf=ee>>w-U.bi_valid,U.bi_valid+=xe-w):(U.bi_buf|=ee<<U.bi_valid&65535,U.bi_valid+=xe)}function Ee(U,ee,xe){Se(U,xe[ee*2],xe[ee*2+1])}function he(U,ee){var xe=0;do xe|=U&1,U>>>=1,xe<<=1;while(--ee>0);return xe>>>1}function pe(U){U.bi_valid===16?(le(U,U.bi_buf),U.bi_buf=0,U.bi_valid=0):U.bi_valid>=8&&(U.pending_buf[U.pending++]=U.bi_buf&255,U.bi_buf>>=8,U.bi_valid-=8)}function Le(U,ee){var xe=ee.dyn_tree,Re=ee.max_code,ve=ee.stat_desc.static_tree,Me=ee.stat_desc.has_stree,de=ee.stat_desc.extra_bits,ht=ee.stat_desc.extra_base,et=ee.stat_desc.max_length,W,Ve,tt,we,Te,Ue,Ct=0;for(we=0;we<=x;we++)U.bl_count[we]=0;for(xe[U.heap[U.heap_max]*2+1]=0,W=U.heap_max+1;W<v;W++)Ve=U.heap[W],we=xe[xe[Ve*2+1]*2+1]+1,we>et&&(we=et,Ct++),xe[Ve*2+1]=we,!(Ve>Re)&&(U.bl_count[we]++,Te=0,Ve>=ht&&(Te=de[Ve-ht]),Ue=xe[Ve*2],U.opt_len+=Ue*(we+Te),Me&&(U.static_len+=Ue*(ve[Ve*2+1]+Te)));if(Ct!==0){do{for(we=et-1;U.bl_count[we]===0;)we--;U.bl_count[we]--,U.bl_count[we+1]+=2,U.bl_count[et]--,Ct-=2}while(Ct>0);for(we=et;we!==0;we--)for(Ve=U.bl_count[we];Ve!==0;)tt=U.heap[--W],!(tt>Re)&&(xe[tt*2+1]!==we&&(U.opt_len+=(we-xe[tt*2+1])*xe[tt*2],xe[tt*2+1]=we),Ve--)}}function He(U,ee,xe){var Re=new Array(x+1),ve=0,Me,de;for(Me=1;Me<=x;Me++)Re[Me]=ve=ve+xe[Me-1]<<1;for(de=0;de<=ee;de++){var ht=U[de*2+1];ht!==0&&(U[de*2]=he(Re[ht]++,ht))}}function Fe(){var U,ee,xe,Re,ve,Me=new Array(x+1);for(xe=0,Re=0;Re<d-1;Re++)for(z[Re]=xe,U=0;U<1<<R[Re];U++)D[xe++]=Re;for(D[xe-1]=Re,ve=0,Re=0;Re<16;Re++)for($[Re]=ve,U=0;U<1<<M[Re];U++)V[ve++]=Re;for(ve>>=7;Re<g;Re++)for($[Re]=ve<<7,U=0;U<1<<M[Re]-7;U++)V[256+ve++]=Re;for(ee=0;ee<=x;ee++)Me[ee]=0;for(U=0;U<=143;)q[U*2+1]=8,U++,Me[8]++;for(;U<=255;)q[U*2+1]=9,U++,Me[9]++;for(;U<=279;)q[U*2+1]=7,U++,Me[7]++;for(;U<=287;)q[U*2+1]=8,U++,Me[8]++;for(He(q,p+1,Me),U=0;U<g;U++)I[U*2+1]=5,I[U*2]=he(U,5);B=new Y(q,R,h+1,p,x),G=new Y(I,M,0,g,x),Z=new Y(new Array(0),j,0,y,S)}function Ie(U){var ee;for(ee=0;ee<p;ee++)U.dyn_ltree[ee*2]=0;for(ee=0;ee<g;ee++)U.dyn_dtree[ee*2]=0;for(ee=0;ee<y;ee++)U.bl_tree[ee*2]=0;U.dyn_ltree[_*2]=1,U.opt_len=U.static_len=0,U.last_lit=U.matches=0}function X(U){U.bi_valid>8?le(U,U.bi_buf):U.bi_valid>0&&(U.pending_buf[U.pending++]=U.bi_buf),U.bi_buf=0,U.bi_valid=0}function ye(U,ee,xe,Re){X(U),le(U,xe),le(U,~xe),e.arraySet(U.pending_buf,U.window,ee,xe,U.pending),U.pending+=xe}function Ne(U,ee,xe,Re){var ve=ee*2,Me=xe*2;return U[ve]<U[Me]||U[ve]===U[Me]&&Re[ee]<=Re[xe]}function fe(U,ee,xe){for(var Re=U.heap[xe],ve=xe<<1;ve<=U.heap_len&&(ve<U.heap_len&&Ne(ee,U.heap[ve+1],U.heap[ve],U.depth)&&ve++,!Ne(ee,Re,U.heap[ve],U.depth));)U.heap[xe]=U.heap[ve],xe=ve,ve<<=1;U.heap[xe]=Re}function ce(U,ee,xe){var Re,ve,Me=0,de,ht;if(U.last_lit!==0)do Re=U.pending_buf[U.d_buf+Me*2]<<8|U.pending_buf[U.d_buf+Me*2+1],ve=U.pending_buf[U.l_buf+Me],Me++,Re===0?Ee(U,ve,ee):(de=D[ve],Ee(U,de+h+1,ee),ht=R[de],ht!==0&&(ve-=z[de],Se(U,ve,ht)),Re--,de=ae(Re),Ee(U,de,xe),ht=M[de],ht!==0&&(Re-=$[de],Se(U,Re,ht)));while(Me<U.last_lit);Ee(U,_,ee)}function se(U,ee){var xe=ee.dyn_tree,Re=ee.stat_desc.static_tree,ve=ee.stat_desc.has_stree,Me=ee.stat_desc.elems,de,ht,et=-1,W;for(U.heap_len=0,U.heap_max=v,de=0;de<Me;de++)xe[de*2]!==0?(U.heap[++U.heap_len]=et=de,U.depth[de]=0):xe[de*2+1]=0;for(;U.heap_len<2;)W=U.heap[++U.heap_len]=et<2?++et:0,xe[W*2]=1,U.depth[W]=0,U.opt_len--,ve&&(U.static_len-=Re[W*2+1]);for(ee.max_code=et,de=U.heap_len>>1;de>=1;de--)fe(U,xe,de);W=Me;do de=U.heap[1],U.heap[1]=U.heap[U.heap_len--],fe(U,xe,1),ht=U.heap[1],U.heap[--U.heap_max]=de,U.heap[--U.heap_max]=ht,xe[W*2]=xe[de*2]+xe[ht*2],U.depth[W]=(U.depth[de]>=U.depth[ht]?U.depth[de]:U.depth[ht])+1,xe[de*2+1]=xe[ht*2+1]=W,U.heap[1]=W++,fe(U,xe,1);while(U.heap_len>=2);U.heap[--U.heap_max]=U.heap[1],Le(U,ee),He(xe,et,U.bl_count)}function Pe(U,ee,xe){var Re,ve=-1,Me,de=ee[0*2+1],ht=0,et=7,W=4;for(de===0&&(et=138,W=3),ee[(xe+1)*2+1]=65535,Re=0;Re<=xe;Re++)Me=de,de=ee[(Re+1)*2+1],!(++ht<et&&Me===de)&&(ht<W?U.bl_tree[Me*2]+=ht:Me!==0?(Me!==ve&&U.bl_tree[Me*2]++,U.bl_tree[k*2]++):ht<=10?U.bl_tree[T*2]++:U.bl_tree[A*2]++,ht=0,ve=Me,de===0?(et=138,W=3):Me===de?(et=6,W=3):(et=7,W=4))}function Be(U,ee,xe){var Re,ve=-1,Me,de=ee[0*2+1],ht=0,et=7,W=4;for(de===0&&(et=138,W=3),Re=0;Re<=xe;Re++)if(Me=de,de=ee[(Re+1)*2+1],!(++ht<et&&Me===de)){if(ht<W)do Ee(U,Me,U.bl_tree);while(--ht!==0);else Me!==0?(Me!==ve&&(Ee(U,Me,U.bl_tree),ht--),Ee(U,k,U.bl_tree),Se(U,ht-3,2)):ht<=10?(Ee(U,T,U.bl_tree),Se(U,ht-3,3)):(Ee(U,A,U.bl_tree),Se(U,ht-11,7));ht=0,ve=Me,de===0?(et=138,W=3):Me===de?(et=6,W=3):(et=7,W=4)}}function je(U){var ee;for(Pe(U,U.dyn_ltree,U.l_desc.max_code),Pe(U,U.dyn_dtree,U.d_desc.max_code),se(U,U.bl_desc),ee=y-1;ee>=3&&U.bl_tree[F[ee]*2+1]===0;ee--);return U.opt_len+=3*(ee+1)+5+5+4,ee}function ot(U,ee,xe,Re){var ve;for(Se(U,ee-257,5),Se(U,xe-1,5),Se(U,Re-4,4),ve=0;ve<Re;ve++)Se(U,U.bl_tree[F[ve]*2+1],3);Be(U,U.dyn_ltree,ee-1),Be(U,U.dyn_dtree,xe-1)}function Et(U){var ee=4093624447,xe;for(xe=0;xe<=31;xe++,ee>>>=1)if(ee&1&&U.dyn_ltree[xe*2]!==0)return n;if(U.dyn_ltree[9*2]!==0||U.dyn_ltree[10*2]!==0||U.dyn_ltree[13*2]!==0)return r;for(xe=32;xe<h;xe++)if(U.dyn_ltree[xe*2]!==0)return r;return n}var ut=!1;function Pt(U){ut||(Fe(),ut=!0),U.l_desc=new ne(U.dyn_ltree,B),U.d_desc=new ne(U.dyn_dtree,G),U.bl_desc=new ne(U.bl_tree,Z),U.bi_buf=0,U.bi_valid=0,Ie(U)}function $t(U,ee,xe,Re){Se(U,(a<<1)+(Re?1:0),3),ye(U,ee,xe)}function Ft(U){Se(U,o<<1,3),Ee(U,_,q),pe(U)}function Ht(U,ee,xe,Re){var ve,Me,de=0;U.level>0?(U.strm.data_type===s&&(U.strm.data_type=Et(U)),se(U,U.l_desc),se(U,U.d_desc),de=je(U),ve=U.opt_len+3+7>>>3,Me=U.static_len+3+7>>>3,Me<=ve&&(ve=Me)):ve=Me=xe+5,xe+4<=ve&&ee!==-1?$t(U,ee,xe,Re):U.strategy===t||Me===ve?(Se(U,(o<<1)+(Re?1:0),3),ce(U,q,I)):(Se(U,(l<<1)+(Re?1:0),3),ot(U,U.l_desc.max_code+1,U.d_desc.max_code+1,de+1),ce(U,U.dyn_ltree,U.dyn_dtree)),Ie(U),Re&&X(U)}function Ce(U,ee,xe){return U.pending_buf[U.d_buf+U.last_lit*2]=ee>>>8&255,U.pending_buf[U.d_buf+U.last_lit*2+1]=ee&255,U.pending_buf[U.l_buf+U.last_lit]=xe&255,U.last_lit++,ee===0?U.dyn_ltree[xe*2]++:(U.matches++,ee--,U.dyn_ltree[(D[xe]+h+1)*2]++,U.dyn_dtree[ae(ee)*2]++),U.last_lit===U.lit_bufsize-1}return bm._tr_init=Pt,bm._tr_stored_block=$t,bm._tr_flush_block=Ht,bm._tr_tally=Ce,bm._tr_align=Ft,bm}var hj,W7;function SJ(){if(W7)return hj;W7=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return hj=e,hj}var pj,H7;function _J(){if(H7)return pj;H7=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return pj=n,pj}var mj,G7;function QF(){return G7||(G7=1,mj={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),mj}var K7;function tAe(){if(K7)return Oc;K7=1;var e=Rp(),t=eAe(),n=SJ(),r=_J(),s=QF(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,p=-3,g=-5,y=-1,v=1,x=2,w=3,S=4,_=0,k=2,T=8,A=9,R=15,M=8,j=29,F=256,P=F+1+j,q=30,I=19,V=2*P+1,D=15,z=3,$=258,Y=$+z+1,B=32,G=42,Z=69,ne=73,ae=91,le=103,Se=113,Ee=666,he=1,pe=2,Le=3,He=4,Fe=3;function Ie(W,Ve){return W.msg=s[Ve],Ve}function X(W){return(W<<1)-(W>4?9:0)}function ye(W){for(var Ve=W.length;--Ve>=0;)W[Ve]=0}function Ne(W){var Ve=W.state,tt=Ve.pending;tt>W.avail_out&&(tt=W.avail_out),tt!==0&&(e.arraySet(W.output,Ve.pending_buf,Ve.pending_out,tt,W.next_out),W.next_out+=tt,Ve.pending_out+=tt,W.total_out+=tt,W.avail_out-=tt,Ve.pending-=tt,Ve.pending===0&&(Ve.pending_out=0))}function fe(W,Ve){t._tr_flush_block(W,W.block_start>=0?W.block_start:-1,W.strstart-W.block_start,Ve),W.block_start=W.strstart,Ne(W.strm)}function ce(W,Ve){W.pending_buf[W.pending++]=Ve}function se(W,Ve){W.pending_buf[W.pending++]=Ve>>>8&255,W.pending_buf[W.pending++]=Ve&255}function Pe(W,Ve,tt,we){var Te=W.avail_in;return Te>we&&(Te=we),Te===0?0:(W.avail_in-=Te,e.arraySet(Ve,W.input,W.next_in,Te,tt),W.state.wrap===1?W.adler=n(W.adler,Ve,Te,tt):W.state.wrap===2&&(W.adler=r(W.adler,Ve,Te,tt)),W.next_in+=Te,W.total_in+=Te,Te)}function Be(W,Ve){var tt=W.max_chain_length,we=W.strstart,Te,Ue,Ct=W.prev_length,me=W.nice_match,Q=W.strstart>W.w_size-Y?W.strstart-(W.w_size-Y):0,J=W.window,te=W.w_mask,_e=W.prev,$e=W.strstart+$,Ge=J[we+Ct-1],wt=J[we+Ct];W.prev_length>=W.good_match&&(tt>>=2),me>W.lookahead&&(me=W.lookahead);do if(Te=Ve,!(J[Te+Ct]!==wt||J[Te+Ct-1]!==Ge||J[Te]!==J[we]||J[++Te]!==J[we+1])){we+=2,Te++;do;while(J[++we]===J[++Te]&&J[++we]===J[++Te]&&J[++we]===J[++Te]&&J[++we]===J[++Te]&&J[++we]===J[++Te]&&J[++we]===J[++Te]&&J[++we]===J[++Te]&&J[++we]===J[++Te]&&we<$e);if(Ue=$-($e-we),we=$e-$,Ue>Ct){if(W.match_start=Ve,Ct=Ue,Ue>=me)break;Ge=J[we+Ct-1],wt=J[we+Ct]}}while((Ve=_e[Ve&te])>Q&&--tt!==0);return Ct<=W.lookahead?Ct:W.lookahead}function je(W){var Ve=W.w_size,tt,we,Te,Ue,Ct;do{if(Ue=W.window_size-W.lookahead-W.strstart,W.strstart>=Ve+(Ve-Y)){e.arraySet(W.window,W.window,Ve,Ve,0),W.match_start-=Ve,W.strstart-=Ve,W.block_start-=Ve,we=W.hash_size,tt=we;do Te=W.head[--tt],W.head[tt]=Te>=Ve?Te-Ve:0;while(--we);we=Ve,tt=we;do Te=W.prev[--tt],W.prev[tt]=Te>=Ve?Te-Ve:0;while(--we);Ue+=Ve}if(W.strm.avail_in===0)break;if(we=Pe(W.strm,W.window,W.strstart+W.lookahead,Ue),W.lookahead+=we,W.lookahead+W.insert>=z)for(Ct=W.strstart-W.insert,W.ins_h=W.window[Ct],W.ins_h=(W.ins_h<<W.hash_shift^W.window[Ct+1])&W.hash_mask;W.insert&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[Ct+z-1])&W.hash_mask,W.prev[Ct&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=Ct,Ct++,W.insert--,!(W.lookahead+W.insert<z)););}while(W.lookahead<Y&&W.strm.avail_in!==0)}function ot(W,Ve){var tt=65535;for(tt>W.pending_buf_size-5&&(tt=W.pending_buf_size-5);;){if(W.lookahead<=1){if(je(W),W.lookahead===0&&Ve===i)return he;if(W.lookahead===0)break}W.strstart+=W.lookahead,W.lookahead=0;var we=W.block_start+tt;if((W.strstart===0||W.strstart>=we)&&(W.lookahead=W.strstart-we,W.strstart=we,fe(W,!1),W.strm.avail_out===0)||W.strstart-W.block_start>=W.w_size-Y&&(fe(W,!1),W.strm.avail_out===0))return he}return W.insert=0,Ve===l?(fe(W,!0),W.strm.avail_out===0?Le:He):(W.strstart>W.block_start&&(fe(W,!1),W.strm.avail_out===0),he)}function Et(W,Ve){for(var tt,we;;){if(W.lookahead<Y){if(je(W),W.lookahead<Y&&Ve===i)return he;if(W.lookahead===0)break}if(tt=0,W.lookahead>=z&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+z-1])&W.hash_mask,tt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),tt!==0&&W.strstart-tt<=W.w_size-Y&&(W.match_length=Be(W,tt)),W.match_length>=z)if(we=t._tr_tally(W,W.strstart-W.match_start,W.match_length-z),W.lookahead-=W.match_length,W.match_length<=W.max_lazy_match&&W.lookahead>=z){W.match_length--;do W.strstart++,W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+z-1])&W.hash_mask,tt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart;while(--W.match_length!==0);W.strstart++}else W.strstart+=W.match_length,W.match_length=0,W.ins_h=W.window[W.strstart],W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+1])&W.hash_mask;else we=t._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++;if(we&&(fe(W,!1),W.strm.avail_out===0))return he}return W.insert=W.strstart<z-1?W.strstart:z-1,Ve===l?(fe(W,!0),W.strm.avail_out===0?Le:He):W.last_lit&&(fe(W,!1),W.strm.avail_out===0)?he:pe}function ut(W,Ve){for(var tt,we,Te;;){if(W.lookahead<Y){if(je(W),W.lookahead<Y&&Ve===i)return he;if(W.lookahead===0)break}if(tt=0,W.lookahead>=z&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+z-1])&W.hash_mask,tt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),W.prev_length=W.match_length,W.prev_match=W.match_start,W.match_length=z-1,tt!==0&&W.prev_length<W.max_lazy_match&&W.strstart-tt<=W.w_size-Y&&(W.match_length=Be(W,tt),W.match_length<=5&&(W.strategy===v||W.match_length===z&&W.strstart-W.match_start>4096)&&(W.match_length=z-1)),W.prev_length>=z&&W.match_length<=W.prev_length){Te=W.strstart+W.lookahead-z,we=t._tr_tally(W,W.strstart-1-W.prev_match,W.prev_length-z),W.lookahead-=W.prev_length-1,W.prev_length-=2;do++W.strstart<=Te&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+z-1])&W.hash_mask,tt=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart);while(--W.prev_length!==0);if(W.match_available=0,W.match_length=z-1,W.strstart++,we&&(fe(W,!1),W.strm.avail_out===0))return he}else if(W.match_available){if(we=t._tr_tally(W,0,W.window[W.strstart-1]),we&&fe(W,!1),W.strstart++,W.lookahead--,W.strm.avail_out===0)return he}else W.match_available=1,W.strstart++,W.lookahead--}return W.match_available&&(we=t._tr_tally(W,0,W.window[W.strstart-1]),W.match_available=0),W.insert=W.strstart<z-1?W.strstart:z-1,Ve===l?(fe(W,!0),W.strm.avail_out===0?Le:He):W.last_lit&&(fe(W,!1),W.strm.avail_out===0)?he:pe}function Pt(W,Ve){for(var tt,we,Te,Ue,Ct=W.window;;){if(W.lookahead<=$){if(je(W),W.lookahead<=$&&Ve===i)return he;if(W.lookahead===0)break}if(W.match_length=0,W.lookahead>=z&&W.strstart>0&&(Te=W.strstart-1,we=Ct[Te],we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te])){Ue=W.strstart+$;do;while(we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te]&&we===Ct[++Te]&&Te<Ue);W.match_length=$-(Ue-Te),W.match_length>W.lookahead&&(W.match_length=W.lookahead)}if(W.match_length>=z?(tt=t._tr_tally(W,1,W.match_length-z),W.lookahead-=W.match_length,W.strstart+=W.match_length,W.match_length=0):(tt=t._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++),tt&&(fe(W,!1),W.strm.avail_out===0))return he}return W.insert=0,Ve===l?(fe(W,!0),W.strm.avail_out===0?Le:He):W.last_lit&&(fe(W,!1),W.strm.avail_out===0)?he:pe}function $t(W,Ve){for(var tt;;){if(W.lookahead===0&&(je(W),W.lookahead===0)){if(Ve===i)return he;break}if(W.match_length=0,tt=t._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++,tt&&(fe(W,!1),W.strm.avail_out===0))return he}return W.insert=0,Ve===l?(fe(W,!0),W.strm.avail_out===0?Le:He):W.last_lit&&(fe(W,!1),W.strm.avail_out===0)?he:pe}function Ft(W,Ve,tt,we,Te){this.good_length=W,this.max_lazy=Ve,this.nice_length=tt,this.max_chain=we,this.func=Te}var Ht;Ht=[new Ft(0,0,0,0,ot),new Ft(4,4,8,4,Et),new Ft(4,5,16,8,Et),new Ft(4,6,32,32,Et),new Ft(4,4,16,16,ut),new Ft(8,16,32,32,ut),new Ft(8,16,128,128,ut),new Ft(8,32,128,256,ut),new Ft(32,128,258,1024,ut),new Ft(32,258,258,4096,ut)];function Ce(W){W.window_size=2*W.w_size,ye(W.head),W.max_lazy_match=Ht[W.level].max_lazy,W.good_match=Ht[W.level].good_length,W.nice_match=Ht[W.level].nice_length,W.max_chain_length=Ht[W.level].max_chain,W.strstart=0,W.block_start=0,W.lookahead=0,W.insert=0,W.match_length=W.prev_length=z-1,W.match_available=0,W.ins_h=0}function U(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(V*2),this.dyn_dtree=new e.Buf16((2*q+1)*2),this.bl_tree=new e.Buf16((2*I+1)*2),ye(this.dyn_ltree),ye(this.dyn_dtree),ye(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(D+1),this.heap=new e.Buf16(2*P+1),ye(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*P+1),ye(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ee(W){var Ve;return!W||!W.state?Ie(W,h):(W.total_in=W.total_out=0,W.data_type=k,Ve=W.state,Ve.pending=0,Ve.pending_out=0,Ve.wrap<0&&(Ve.wrap=-Ve.wrap),Ve.status=Ve.wrap?G:Se,W.adler=Ve.wrap===2?0:1,Ve.last_flush=i,t._tr_init(Ve),u)}function xe(W){var Ve=ee(W);return Ve===u&&Ce(W.state),Ve}function Re(W,Ve){return!W||!W.state||W.state.wrap!==2?h:(W.state.gzhead=Ve,u)}function ve(W,Ve,tt,we,Te,Ue){if(!W)return h;var Ct=1;if(Ve===y&&(Ve=6),we<0?(Ct=0,we=-we):we>15&&(Ct=2,we-=16),Te<1||Te>A||tt!==T||we<8||we>15||Ve<0||Ve>9||Ue<0||Ue>S)return Ie(W,h);we===8&&(we=9);var me=new U;return W.state=me,me.strm=W,me.wrap=Ct,me.gzhead=null,me.w_bits=we,me.w_size=1<<me.w_bits,me.w_mask=me.w_size-1,me.hash_bits=Te+7,me.hash_size=1<<me.hash_bits,me.hash_mask=me.hash_size-1,me.hash_shift=~~((me.hash_bits+z-1)/z),me.window=new e.Buf8(me.w_size*2),me.head=new e.Buf16(me.hash_size),me.prev=new e.Buf16(me.w_size),me.lit_bufsize=1<<Te+6,me.pending_buf_size=me.lit_bufsize*4,me.pending_buf=new e.Buf8(me.pending_buf_size),me.d_buf=1*me.lit_bufsize,me.l_buf=3*me.lit_bufsize,me.level=Ve,me.strategy=Ue,me.method=tt,xe(W)}function Me(W,Ve){return ve(W,Ve,T,R,M,_)}function de(W,Ve){var tt,we,Te,Ue;if(!W||!W.state||Ve>c||Ve<0)return W?Ie(W,h):h;if(we=W.state,!W.output||!W.input&&W.avail_in!==0||we.status===Ee&&Ve!==l)return Ie(W,W.avail_out===0?g:h);if(we.strm=W,tt=we.last_flush,we.last_flush=Ve,we.status===G)if(we.wrap===2)W.adler=0,ce(we,31),ce(we,139),ce(we,8),we.gzhead?(ce(we,(we.gzhead.text?1:0)+(we.gzhead.hcrc?2:0)+(we.gzhead.extra?4:0)+(we.gzhead.name?8:0)+(we.gzhead.comment?16:0)),ce(we,we.gzhead.time&255),ce(we,we.gzhead.time>>8&255),ce(we,we.gzhead.time>>16&255),ce(we,we.gzhead.time>>24&255),ce(we,we.level===9?2:we.strategy>=x||we.level<2?4:0),ce(we,we.gzhead.os&255),we.gzhead.extra&&we.gzhead.extra.length&&(ce(we,we.gzhead.extra.length&255),ce(we,we.gzhead.extra.length>>8&255)),we.gzhead.hcrc&&(W.adler=r(W.adler,we.pending_buf,we.pending,0)),we.gzindex=0,we.status=Z):(ce(we,0),ce(we,0),ce(we,0),ce(we,0),ce(we,0),ce(we,we.level===9?2:we.strategy>=x||we.level<2?4:0),ce(we,Fe),we.status=Se);else{var Ct=T+(we.w_bits-8<<4)<<8,me=-1;we.strategy>=x||we.level<2?me=0:we.level<6?me=1:we.level===6?me=2:me=3,Ct|=me<<6,we.strstart!==0&&(Ct|=B),Ct+=31-Ct%31,we.status=Se,se(we,Ct),we.strstart!==0&&(se(we,W.adler>>>16),se(we,W.adler&65535)),W.adler=1}if(we.status===Z)if(we.gzhead.extra){for(Te=we.pending;we.gzindex<(we.gzhead.extra.length&65535)&&!(we.pending===we.pending_buf_size&&(we.gzhead.hcrc&&we.pending>Te&&(W.adler=r(W.adler,we.pending_buf,we.pending-Te,Te)),Ne(W),Te=we.pending,we.pending===we.pending_buf_size));)ce(we,we.gzhead.extra[we.gzindex]&255),we.gzindex++;we.gzhead.hcrc&&we.pending>Te&&(W.adler=r(W.adler,we.pending_buf,we.pending-Te,Te)),we.gzindex===we.gzhead.extra.length&&(we.gzindex=0,we.status=ne)}else we.status=ne;if(we.status===ne)if(we.gzhead.name){Te=we.pending;do{if(we.pending===we.pending_buf_size&&(we.gzhead.hcrc&&we.pending>Te&&(W.adler=r(W.adler,we.pending_buf,we.pending-Te,Te)),Ne(W),Te=we.pending,we.pending===we.pending_buf_size)){Ue=1;break}we.gzindex<we.gzhead.name.length?Ue=we.gzhead.name.charCodeAt(we.gzindex++)&255:Ue=0,ce(we,Ue)}while(Ue!==0);we.gzhead.hcrc&&we.pending>Te&&(W.adler=r(W.adler,we.pending_buf,we.pending-Te,Te)),Ue===0&&(we.gzindex=0,we.status=ae)}else we.status=ae;if(we.status===ae)if(we.gzhead.comment){Te=we.pending;do{if(we.pending===we.pending_buf_size&&(we.gzhead.hcrc&&we.pending>Te&&(W.adler=r(W.adler,we.pending_buf,we.pending-Te,Te)),Ne(W),Te=we.pending,we.pending===we.pending_buf_size)){Ue=1;break}we.gzindex<we.gzhead.comment.length?Ue=we.gzhead.comment.charCodeAt(we.gzindex++)&255:Ue=0,ce(we,Ue)}while(Ue!==0);we.gzhead.hcrc&&we.pending>Te&&(W.adler=r(W.adler,we.pending_buf,we.pending-Te,Te)),Ue===0&&(we.status=le)}else we.status=le;if(we.status===le&&(we.gzhead.hcrc?(we.pending+2>we.pending_buf_size&&Ne(W),we.pending+2<=we.pending_buf_size&&(ce(we,W.adler&255),ce(we,W.adler>>8&255),W.adler=0,we.status=Se)):we.status=Se),we.pending!==0){if(Ne(W),W.avail_out===0)return we.last_flush=-1,u}else if(W.avail_in===0&&X(Ve)<=X(tt)&&Ve!==l)return Ie(W,g);if(we.status===Ee&&W.avail_in!==0)return Ie(W,g);if(W.avail_in!==0||we.lookahead!==0||Ve!==i&&we.status!==Ee){var Q=we.strategy===x?$t(we,Ve):we.strategy===w?Pt(we,Ve):Ht[we.level].func(we,Ve);if((Q===Le||Q===He)&&(we.status=Ee),Q===he||Q===Le)return W.avail_out===0&&(we.last_flush=-1),u;if(Q===pe&&(Ve===a?t._tr_align(we):Ve!==c&&(t._tr_stored_block(we,0,0,!1),Ve===o&&(ye(we.head),we.lookahead===0&&(we.strstart=0,we.block_start=0,we.insert=0))),Ne(W),W.avail_out===0))return we.last_flush=-1,u}return Ve!==l?u:we.wrap<=0?d:(we.wrap===2?(ce(we,W.adler&255),ce(we,W.adler>>8&255),ce(we,W.adler>>16&255),ce(we,W.adler>>24&255),ce(we,W.total_in&255),ce(we,W.total_in>>8&255),ce(we,W.total_in>>16&255),ce(we,W.total_in>>24&255)):(se(we,W.adler>>>16),se(we,W.adler&65535)),Ne(W),we.wrap>0&&(we.wrap=-we.wrap),we.pending!==0?u:d)}function ht(W){var Ve;return!W||!W.state?h:(Ve=W.state.status,Ve!==G&&Ve!==Z&&Ve!==ne&&Ve!==ae&&Ve!==le&&Ve!==Se&&Ve!==Ee?Ie(W,h):(W.state=null,Ve===Se?Ie(W,p):u))}function et(W,Ve){var tt=Ve.length,we,Te,Ue,Ct,me,Q,J,te;if(!W||!W.state||(we=W.state,Ct=we.wrap,Ct===2||Ct===1&&we.status!==G||we.lookahead))return h;for(Ct===1&&(W.adler=n(W.adler,Ve,tt,0)),we.wrap=0,tt>=we.w_size&&(Ct===0&&(ye(we.head),we.strstart=0,we.block_start=0,we.insert=0),te=new e.Buf8(we.w_size),e.arraySet(te,Ve,tt-we.w_size,we.w_size,0),Ve=te,tt=we.w_size),me=W.avail_in,Q=W.next_in,J=W.input,W.avail_in=tt,W.next_in=0,W.input=Ve,je(we);we.lookahead>=z;){Te=we.strstart,Ue=we.lookahead-(z-1);do we.ins_h=(we.ins_h<<we.hash_shift^we.window[Te+z-1])&we.hash_mask,we.prev[Te&we.w_mask]=we.head[we.ins_h],we.head[we.ins_h]=Te,Te++;while(--Ue);we.strstart=Te,we.lookahead=z-1,je(we)}return we.strstart+=we.lookahead,we.block_start=we.strstart,we.insert=we.lookahead,we.lookahead=0,we.match_length=we.prev_length=z-1,we.match_available=0,W.next_in=Q,W.input=J,W.avail_in=me,we.wrap=Ct,u}return Oc.deflateInit=Me,Oc.deflateInit2=ve,Oc.deflateReset=xe,Oc.deflateResetKeep=ee,Oc.deflateSetHeader=Re,Oc.deflate=de,Oc.deflateEnd=ht,Oc.deflateSetDictionary=et,Oc.deflateInfo="pako deflate (from Nodeca project)",Oc}var vm={},Y7;function CJ(){if(Y7)return vm;Y7=1;var e=Rp(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,vm.string2buf=function(a){var o,l,c,u,d,h=a.length,p=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),p+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(p),d=0,u=0;d<p;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return vm.buf2binstring=function(a){return i(a,a.length)},vm.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},vm.buf2string=function(a,o){var l,c,u,d,h=o||a.length,p=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){p[c++]=u;continue}if(d=r[u],d>4){p[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){p[c++]=65533;continue}u<65536?p[c++]=u:(u-=65536,p[c++]=55296|u>>10&1023,p[c++]=56320|u&1023)}return i(p,c)},vm.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},vm}var gj,Z7;function kJ(){if(Z7)return gj;Z7=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return gj=e,gj}var X7;function nAe(){if(X7)return O0;X7=1;var e=tAe(),t=Rp(),n=CJ(),r=QF(),s=kJ(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,p=8;function g(w){if(!(this instanceof g))return new g(w);this.options=t.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var _=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(_!==l)throw new Error(r[_]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var k;if(typeof S.dictionary=="string"?k=n.string2buf(S.dictionary):i.call(S.dictionary)==="[object ArrayBuffer]"?k=new Uint8Array(S.dictionary):k=S.dictionary,_=e.deflateSetDictionary(this.strm,k),_!==l)throw new Error(r[_]);this._dict_set=!0}}g.prototype.push=function(w,S){var _=this.strm,k=this.options.chunkSize,T,A;if(this.ended)return!1;A=S===~~S?S:S===!0?o:a,typeof w=="string"?_.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?_.input=new Uint8Array(w):_.input=w,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new t.Buf8(k),_.next_out=0,_.avail_out=k),T=e.deflate(_,A),T!==c&&T!==l)return this.onEnd(T),this.ended=!0,!1;(_.avail_out===0||_.avail_in===0&&(A===o||A===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(_.output,_.next_out))):this.onData(t.shrinkBuf(_.output,_.next_out)))}while((_.avail_in>0||_.avail_out===0)&&T!==c);return A===o?(T=e.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l):(A===u&&(this.onEnd(l),_.avail_out=0),!0)},g.prototype.onData=function(w){this.chunks.push(w)},g.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function y(w,S){var _=new g(S);if(_.push(w,!0),_.err)throw _.msg||r[_.err];return _.result}function v(w,S){return S=S||{},S.raw=!0,y(w,S)}function x(w,S){return S=S||{},S.gzip=!0,y(w,S)}return O0.Deflate=g,O0.deflate=y,O0.deflateRaw=v,O0.gzip=x,O0}var D0={},Zl={},yj,J7;function rAe(){if(J7)return yj;J7=1;var e=30,t=12;return yj=function(r,s){var i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k,T,A,R,M,j,F,P,q;i=r.state,a=r.next_in,P=r.input,o=a+(r.avail_in-5),l=r.next_out,q=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,p=i.whave,g=i.wnext,y=i.window,v=i.hold,x=i.bits,w=i.lencode,S=i.distcode,_=(1<<i.lenbits)-1,k=(1<<i.distbits)-1;e:do{x<15&&(v+=P[a++]<<x,x+=8,v+=P[a++]<<x,x+=8),T=w[v&_];t:for(;;){if(A=T>>>24,v>>>=A,x-=A,A=T>>>16&255,A===0)q[l++]=T&65535;else if(A&16){R=T&65535,A&=15,A&&(x<A&&(v+=P[a++]<<x,x+=8),R+=v&(1<<A)-1,v>>>=A,x-=A),x<15&&(v+=P[a++]<<x,x+=8,v+=P[a++]<<x,x+=8),T=S[v&k];n:for(;;){if(A=T>>>24,v>>>=A,x-=A,A=T>>>16&255,A&16){if(M=T&65535,A&=15,x<A&&(v+=P[a++]<<x,x+=8,x<A&&(v+=P[a++]<<x,x+=8)),M+=v&(1<<A)-1,M>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=A,x-=A,A=l-c,M>A){if(A=M-A,A>p&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(j=0,F=y,g===0){if(j+=h-A,A<R){R-=A;do q[l++]=y[j++];while(--A);j=l-M,F=q}}else if(g<A){if(j+=h+g-A,A-=g,A<R){R-=A;do q[l++]=y[j++];while(--A);if(j=0,g<R){A=g,R-=A;do q[l++]=y[j++];while(--A);j=l-M,F=q}}}else if(j+=g-A,A<R){R-=A;do q[l++]=y[j++];while(--A);j=l-M,F=q}for(;R>2;)q[l++]=F[j++],q[l++]=F[j++],q[l++]=F[j++],R-=3;R&&(q[l++]=F[j++],R>1&&(q[l++]=F[j++]))}else{j=l-M;do q[l++]=q[j++],q[l++]=q[j++],q[l++]=q[j++],R-=3;while(R>2);R&&(q[l++]=q[j++],R>1&&(q[l++]=q[j++]))}}else if((A&64)===0){T=S[(T&65535)+(v&(1<<A)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((A&64)===0){T=w[(T&65535)+(v&(1<<A)-1)];continue t}else if(A&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);R=x>>3,a-=R,x-=R<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},yj}var bj,Q7;function sAe(){if(Q7)return bj;Q7=1;var e=Rp(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return bj=function(h,p,g,y,v,x,w,S){var _=S.bits,k=0,T=0,A=0,R=0,M=0,j=0,F=0,P=0,q=0,I=0,V,D,z,$,Y,B=null,G=0,Z,ne=new e.Buf16(t+1),ae=new e.Buf16(t+1),le=null,Se=0,Ee,he,pe;for(k=0;k<=t;k++)ne[k]=0;for(T=0;T<y;T++)ne[p[g+T]]++;for(M=_,R=t;R>=1&&ne[R]===0;R--);if(M>R&&(M=R),R===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,S.bits=1,0;for(A=1;A<R&&ne[A]===0;A++);for(M<A&&(M=A),P=1,k=1;k<=t;k++)if(P<<=1,P-=ne[k],P<0)return-1;if(P>0&&(h===s||R!==1))return-1;for(ae[1]=0,k=1;k<t;k++)ae[k+1]=ae[k]+ne[k];for(T=0;T<y;T++)p[g+T]!==0&&(w[ae[p[g+T]]++]=T);if(h===s?(B=le=w,Z=19):h===i?(B=o,G-=257,le=l,Se-=257,Z=256):(B=c,le=u,Z=-1),I=0,T=0,k=A,Y=x,j=M,F=0,z=-1,q=1<<M,$=q-1,h===i&&q>n||h===a&&q>r)return 1;for(;;){Ee=k-F,w[T]<Z?(he=0,pe=w[T]):w[T]>Z?(he=le[Se+w[T]],pe=B[G+w[T]]):(he=96,pe=0),V=1<<k-F,D=1<<j,A=D;do D-=V,v[Y+(I>>F)+D]=Ee<<24|he<<16|pe|0;while(D!==0);for(V=1<<k-1;I&V;)V>>=1;if(V!==0?(I&=V-1,I+=V):I=0,T++,--ne[k]===0){if(k===R)break;k=p[g+w[T]]}if(k>M&&(I&$)!==z){for(F===0&&(F=M),Y+=A,j=k-F,P=1<<j;j+F<R&&(P-=ne[j+F],!(P<=0));)j++,P<<=1;if(q+=1<<j,h===i&&q>n||h===a&&q>r)return 1;z=I&$,v[z]=M<<24|j<<16|Y-x|0}}return I!==0&&(v[Y+I]=k-F<<24|64<<16|0),S.bits=M,0},bj}var eU;function iAe(){if(eU)return Zl;eU=1;var e=Rp(),t=SJ(),n=_J(),r=rAe(),s=sAe(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,p=2,g=-2,y=-3,v=-4,x=-5,w=8,S=1,_=2,k=3,T=4,A=5,R=6,M=7,j=8,F=9,P=10,q=11,I=12,V=13,D=14,z=15,$=16,Y=17,B=18,G=19,Z=20,ne=21,ae=22,le=23,Se=24,Ee=25,he=26,pe=27,Le=28,He=29,Fe=30,Ie=31,X=32,ye=852,Ne=592,fe=15,ce=fe;function se(ve){return(ve>>>24&255)+(ve>>>8&65280)+((ve&65280)<<8)+((ve&255)<<24)}function Pe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(ve){var Me;return!ve||!ve.state?g:(Me=ve.state,ve.total_in=ve.total_out=Me.total=0,ve.msg="",Me.wrap&&(ve.adler=Me.wrap&1),Me.mode=S,Me.last=0,Me.havedict=0,Me.dmax=32768,Me.head=null,Me.hold=0,Me.bits=0,Me.lencode=Me.lendyn=new e.Buf32(ye),Me.distcode=Me.distdyn=new e.Buf32(Ne),Me.sane=1,Me.back=-1,d)}function je(ve){var Me;return!ve||!ve.state?g:(Me=ve.state,Me.wsize=0,Me.whave=0,Me.wnext=0,Be(ve))}function ot(ve,Me){var de,ht;return!ve||!ve.state||(ht=ve.state,Me<0?(de=0,Me=-Me):(de=(Me>>4)+1,Me<48&&(Me&=15)),Me&&(Me<8||Me>15))?g:(ht.window!==null&&ht.wbits!==Me&&(ht.window=null),ht.wrap=de,ht.wbits=Me,je(ve))}function Et(ve,Me){var de,ht;return ve?(ht=new Pe,ve.state=ht,ht.window=null,de=ot(ve,Me),de!==d&&(ve.state=null),de):g}function ut(ve){return Et(ve,ce)}var Pt=!0,$t,Ft;function Ht(ve){if(Pt){var Me;for($t=new e.Buf32(512),Ft=new e.Buf32(32),Me=0;Me<144;)ve.lens[Me++]=8;for(;Me<256;)ve.lens[Me++]=9;for(;Me<280;)ve.lens[Me++]=7;for(;Me<288;)ve.lens[Me++]=8;for(s(a,ve.lens,0,288,$t,0,ve.work,{bits:9}),Me=0;Me<32;)ve.lens[Me++]=5;s(o,ve.lens,0,32,Ft,0,ve.work,{bits:5}),Pt=!1}ve.lencode=$t,ve.lenbits=9,ve.distcode=Ft,ve.distbits=5}function Ce(ve,Me,de,ht){var et,W=ve.state;return W.window===null&&(W.wsize=1<<W.wbits,W.wnext=0,W.whave=0,W.window=new e.Buf8(W.wsize)),ht>=W.wsize?(e.arraySet(W.window,Me,de-W.wsize,W.wsize,0),W.wnext=0,W.whave=W.wsize):(et=W.wsize-W.wnext,et>ht&&(et=ht),e.arraySet(W.window,Me,de-ht,et,W.wnext),ht-=et,ht?(e.arraySet(W.window,Me,de-ht,ht,0),W.wnext=ht,W.whave=W.wsize):(W.wnext+=et,W.wnext===W.wsize&&(W.wnext=0),W.whave<W.wsize&&(W.whave+=et))),0}function U(ve,Me){var de,ht,et,W,Ve,tt,we,Te,Ue,Ct,me,Q,J,te,_e=0,$e,Ge,wt,Jt,jn,Gt,rn,dn,br=new e.Buf8(4),Cr,Jr,Qr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ve||!ve.state||!ve.output||!ve.input&&ve.avail_in!==0)return g;de=ve.state,de.mode===I&&(de.mode=V),Ve=ve.next_out,et=ve.output,we=ve.avail_out,W=ve.next_in,ht=ve.input,tt=ve.avail_in,Te=de.hold,Ue=de.bits,Ct=tt,me=we,dn=d;e:for(;;)switch(de.mode){case S:if(de.wrap===0){de.mode=V;break}for(;Ue<16;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(de.wrap&2&&Te===35615){de.check=0,br[0]=Te&255,br[1]=Te>>>8&255,de.check=n(de.check,br,2,0),Te=0,Ue=0,de.mode=_;break}if(de.flags=0,de.head&&(de.head.done=!1),!(de.wrap&1)||(((Te&255)<<8)+(Te>>8))%31){ve.msg="incorrect header check",de.mode=Fe;break}if((Te&15)!==w){ve.msg="unknown compression method",de.mode=Fe;break}if(Te>>>=4,Ue-=4,rn=(Te&15)+8,de.wbits===0)de.wbits=rn;else if(rn>de.wbits){ve.msg="invalid window size",de.mode=Fe;break}de.dmax=1<<rn,ve.adler=de.check=1,de.mode=Te&512?P:I,Te=0,Ue=0;break;case _:for(;Ue<16;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(de.flags=Te,(de.flags&255)!==w){ve.msg="unknown compression method",de.mode=Fe;break}if(de.flags&57344){ve.msg="unknown header flags set",de.mode=Fe;break}de.head&&(de.head.text=Te>>8&1),de.flags&512&&(br[0]=Te&255,br[1]=Te>>>8&255,de.check=n(de.check,br,2,0)),Te=0,Ue=0,de.mode=k;case k:for(;Ue<32;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}de.head&&(de.head.time=Te),de.flags&512&&(br[0]=Te&255,br[1]=Te>>>8&255,br[2]=Te>>>16&255,br[3]=Te>>>24&255,de.check=n(de.check,br,4,0)),Te=0,Ue=0,de.mode=T;case T:for(;Ue<16;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}de.head&&(de.head.xflags=Te&255,de.head.os=Te>>8),de.flags&512&&(br[0]=Te&255,br[1]=Te>>>8&255,de.check=n(de.check,br,2,0)),Te=0,Ue=0,de.mode=A;case A:if(de.flags&1024){for(;Ue<16;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}de.length=Te,de.head&&(de.head.extra_len=Te),de.flags&512&&(br[0]=Te&255,br[1]=Te>>>8&255,de.check=n(de.check,br,2,0)),Te=0,Ue=0}else de.head&&(de.head.extra=null);de.mode=R;case R:if(de.flags&1024&&(Q=de.length,Q>tt&&(Q=tt),Q&&(de.head&&(rn=de.head.extra_len-de.length,de.head.extra||(de.head.extra=new Array(de.head.extra_len)),e.arraySet(de.head.extra,ht,W,Q,rn)),de.flags&512&&(de.check=n(de.check,ht,Q,W)),tt-=Q,W+=Q,de.length-=Q),de.length))break e;de.length=0,de.mode=M;case M:if(de.flags&2048){if(tt===0)break e;Q=0;do rn=ht[W+Q++],de.head&&rn&&de.length<65536&&(de.head.name+=String.fromCharCode(rn));while(rn&&Q<tt);if(de.flags&512&&(de.check=n(de.check,ht,Q,W)),tt-=Q,W+=Q,rn)break e}else de.head&&(de.head.name=null);de.length=0,de.mode=j;case j:if(de.flags&4096){if(tt===0)break e;Q=0;do rn=ht[W+Q++],de.head&&rn&&de.length<65536&&(de.head.comment+=String.fromCharCode(rn));while(rn&&Q<tt);if(de.flags&512&&(de.check=n(de.check,ht,Q,W)),tt-=Q,W+=Q,rn)break e}else de.head&&(de.head.comment=null);de.mode=F;case F:if(de.flags&512){for(;Ue<16;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(Te!==(de.check&65535)){ve.msg="header crc mismatch",de.mode=Fe;break}Te=0,Ue=0}de.head&&(de.head.hcrc=de.flags>>9&1,de.head.done=!0),ve.adler=de.check=0,de.mode=I;break;case P:for(;Ue<32;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}ve.adler=de.check=se(Te),Te=0,Ue=0,de.mode=q;case q:if(de.havedict===0)return ve.next_out=Ve,ve.avail_out=we,ve.next_in=W,ve.avail_in=tt,de.hold=Te,de.bits=Ue,p;ve.adler=de.check=1,de.mode=I;case I:if(Me===c||Me===u)break e;case V:if(de.last){Te>>>=Ue&7,Ue-=Ue&7,de.mode=pe;break}for(;Ue<3;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}switch(de.last=Te&1,Te>>>=1,Ue-=1,Te&3){case 0:de.mode=D;break;case 1:if(Ht(de),de.mode=Z,Me===u){Te>>>=2,Ue-=2;break e}break;case 2:de.mode=Y;break;case 3:ve.msg="invalid block type",de.mode=Fe}Te>>>=2,Ue-=2;break;case D:for(Te>>>=Ue&7,Ue-=Ue&7;Ue<32;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if((Te&65535)!==(Te>>>16^65535)){ve.msg="invalid stored block lengths",de.mode=Fe;break}if(de.length=Te&65535,Te=0,Ue=0,de.mode=z,Me===u)break e;case z:de.mode=$;case $:if(Q=de.length,Q){if(Q>tt&&(Q=tt),Q>we&&(Q=we),Q===0)break e;e.arraySet(et,ht,W,Q,Ve),tt-=Q,W+=Q,we-=Q,Ve+=Q,de.length-=Q;break}de.mode=I;break;case Y:for(;Ue<14;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(de.nlen=(Te&31)+257,Te>>>=5,Ue-=5,de.ndist=(Te&31)+1,Te>>>=5,Ue-=5,de.ncode=(Te&15)+4,Te>>>=4,Ue-=4,de.nlen>286||de.ndist>30){ve.msg="too many length or distance symbols",de.mode=Fe;break}de.have=0,de.mode=B;case B:for(;de.have<de.ncode;){for(;Ue<3;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}de.lens[Qr[de.have++]]=Te&7,Te>>>=3,Ue-=3}for(;de.have<19;)de.lens[Qr[de.have++]]=0;if(de.lencode=de.lendyn,de.lenbits=7,Cr={bits:de.lenbits},dn=s(i,de.lens,0,19,de.lencode,0,de.work,Cr),de.lenbits=Cr.bits,dn){ve.msg="invalid code lengths set",de.mode=Fe;break}de.have=0,de.mode=G;case G:for(;de.have<de.nlen+de.ndist;){for(;_e=de.lencode[Te&(1<<de.lenbits)-1],$e=_e>>>24,Ge=_e>>>16&255,wt=_e&65535,!($e<=Ue);){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(wt<16)Te>>>=$e,Ue-=$e,de.lens[de.have++]=wt;else{if(wt===16){for(Jr=$e+2;Ue<Jr;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(Te>>>=$e,Ue-=$e,de.have===0){ve.msg="invalid bit length repeat",de.mode=Fe;break}rn=de.lens[de.have-1],Q=3+(Te&3),Te>>>=2,Ue-=2}else if(wt===17){for(Jr=$e+3;Ue<Jr;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}Te>>>=$e,Ue-=$e,rn=0,Q=3+(Te&7),Te>>>=3,Ue-=3}else{for(Jr=$e+7;Ue<Jr;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}Te>>>=$e,Ue-=$e,rn=0,Q=11+(Te&127),Te>>>=7,Ue-=7}if(de.have+Q>de.nlen+de.ndist){ve.msg="invalid bit length repeat",de.mode=Fe;break}for(;Q--;)de.lens[de.have++]=rn}}if(de.mode===Fe)break;if(de.lens[256]===0){ve.msg="invalid code -- missing end-of-block",de.mode=Fe;break}if(de.lenbits=9,Cr={bits:de.lenbits},dn=s(a,de.lens,0,de.nlen,de.lencode,0,de.work,Cr),de.lenbits=Cr.bits,dn){ve.msg="invalid literal/lengths set",de.mode=Fe;break}if(de.distbits=6,de.distcode=de.distdyn,Cr={bits:de.distbits},dn=s(o,de.lens,de.nlen,de.ndist,de.distcode,0,de.work,Cr),de.distbits=Cr.bits,dn){ve.msg="invalid distances set",de.mode=Fe;break}if(de.mode=Z,Me===u)break e;case Z:de.mode=ne;case ne:if(tt>=6&&we>=258){ve.next_out=Ve,ve.avail_out=we,ve.next_in=W,ve.avail_in=tt,de.hold=Te,de.bits=Ue,r(ve,me),Ve=ve.next_out,et=ve.output,we=ve.avail_out,W=ve.next_in,ht=ve.input,tt=ve.avail_in,Te=de.hold,Ue=de.bits,de.mode===I&&(de.back=-1);break}for(de.back=0;_e=de.lencode[Te&(1<<de.lenbits)-1],$e=_e>>>24,Ge=_e>>>16&255,wt=_e&65535,!($e<=Ue);){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(Ge&&(Ge&240)===0){for(Jt=$e,jn=Ge,Gt=wt;_e=de.lencode[Gt+((Te&(1<<Jt+jn)-1)>>Jt)],$e=_e>>>24,Ge=_e>>>16&255,wt=_e&65535,!(Jt+$e<=Ue);){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}Te>>>=Jt,Ue-=Jt,de.back+=Jt}if(Te>>>=$e,Ue-=$e,de.back+=$e,de.length=wt,Ge===0){de.mode=he;break}if(Ge&32){de.back=-1,de.mode=I;break}if(Ge&64){ve.msg="invalid literal/length code",de.mode=Fe;break}de.extra=Ge&15,de.mode=ae;case ae:if(de.extra){for(Jr=de.extra;Ue<Jr;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}de.length+=Te&(1<<de.extra)-1,Te>>>=de.extra,Ue-=de.extra,de.back+=de.extra}de.was=de.length,de.mode=le;case le:for(;_e=de.distcode[Te&(1<<de.distbits)-1],$e=_e>>>24,Ge=_e>>>16&255,wt=_e&65535,!($e<=Ue);){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if((Ge&240)===0){for(Jt=$e,jn=Ge,Gt=wt;_e=de.distcode[Gt+((Te&(1<<Jt+jn)-1)>>Jt)],$e=_e>>>24,Ge=_e>>>16&255,wt=_e&65535,!(Jt+$e<=Ue);){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}Te>>>=Jt,Ue-=Jt,de.back+=Jt}if(Te>>>=$e,Ue-=$e,de.back+=$e,Ge&64){ve.msg="invalid distance code",de.mode=Fe;break}de.offset=wt,de.extra=Ge&15,de.mode=Se;case Se:if(de.extra){for(Jr=de.extra;Ue<Jr;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}de.offset+=Te&(1<<de.extra)-1,Te>>>=de.extra,Ue-=de.extra,de.back+=de.extra}if(de.offset>de.dmax){ve.msg="invalid distance too far back",de.mode=Fe;break}de.mode=Ee;case Ee:if(we===0)break e;if(Q=me-we,de.offset>Q){if(Q=de.offset-Q,Q>de.whave&&de.sane){ve.msg="invalid distance too far back",de.mode=Fe;break}Q>de.wnext?(Q-=de.wnext,J=de.wsize-Q):J=de.wnext-Q,Q>de.length&&(Q=de.length),te=de.window}else te=et,J=Ve-de.offset,Q=de.length;Q>we&&(Q=we),we-=Q,de.length-=Q;do et[Ve++]=te[J++];while(--Q);de.length===0&&(de.mode=ne);break;case he:if(we===0)break e;et[Ve++]=de.length,we--,de.mode=ne;break;case pe:if(de.wrap){for(;Ue<32;){if(tt===0)break e;tt--,Te|=ht[W++]<<Ue,Ue+=8}if(me-=we,ve.total_out+=me,de.total+=me,me&&(ve.adler=de.check=de.flags?n(de.check,et,me,Ve-me):t(de.check,et,me,Ve-me)),me=we,(de.flags?Te:se(Te))!==de.check){ve.msg="incorrect data check",de.mode=Fe;break}Te=0,Ue=0}de.mode=Le;case Le:if(de.wrap&&de.flags){for(;Ue<32;){if(tt===0)break e;tt--,Te+=ht[W++]<<Ue,Ue+=8}if(Te!==(de.total&4294967295)){ve.msg="incorrect length check",de.mode=Fe;break}Te=0,Ue=0}de.mode=He;case He:dn=h;break e;case Fe:dn=y;break e;case Ie:return v;case X:default:return g}return ve.next_out=Ve,ve.avail_out=we,ve.next_in=W,ve.avail_in=tt,de.hold=Te,de.bits=Ue,(de.wsize||me!==ve.avail_out&&de.mode<Fe&&(de.mode<pe||Me!==l))&&Ce(ve,ve.output,ve.next_out,me-ve.avail_out),Ct-=ve.avail_in,me-=ve.avail_out,ve.total_in+=Ct,ve.total_out+=me,de.total+=me,de.wrap&&me&&(ve.adler=de.check=de.flags?n(de.check,et,me,ve.next_out-me):t(de.check,et,me,ve.next_out-me)),ve.data_type=de.bits+(de.last?64:0)+(de.mode===I?128:0)+(de.mode===Z||de.mode===z?256:0),(Ct===0&&me===0||Me===l)&&dn===d&&(dn=x),dn}function ee(ve){if(!ve||!ve.state)return g;var Me=ve.state;return Me.window&&(Me.window=null),ve.state=null,d}function xe(ve,Me){var de;return!ve||!ve.state||(de=ve.state,(de.wrap&2)===0)?g:(de.head=Me,Me.done=!1,d)}function Re(ve,Me){var de=Me.length,ht,et,W;return!ve||!ve.state||(ht=ve.state,ht.wrap!==0&&ht.mode!==q)?g:ht.mode===q&&(et=1,et=t(et,Me,de,0),et!==ht.check)?y:(W=Ce(ve,Me,de,de),W?(ht.mode=Ie,v):(ht.havedict=1,d))}return Zl.inflateReset=je,Zl.inflateReset2=ot,Zl.inflateResetKeep=Be,Zl.inflateInit=ut,Zl.inflateInit2=Et,Zl.inflate=U,Zl.inflateEnd=ee,Zl.inflateGetHeader=xe,Zl.inflateSetDictionary=Re,Zl.inflateInfo="pako inflate (from Nodeca project)",Zl}var vj,tU;function EJ(){return tU||(tU=1,vj={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),vj}var xj,nU;function aAe(){if(nU)return xj;nU=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return xj=e,xj}var rU;function oAe(){if(rU)return D0;rU=1;var e=iAe(),t=Rp(),n=CJ(),r=EJ(),s=QF(),i=kJ(),a=aAe(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var p=e.inflateInit2(this.strm,h.windowBits);if(p!==r.Z_OK)throw new Error(s[p]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(p=e.inflateSetDictionary(this.strm,h.dictionary),p!==r.Z_OK)))throw new Error(s[p])}l.prototype.push=function(d,h){var p=this.strm,g=this.options.chunkSize,y=this.options.dictionary,v,x,w,S,_,k=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?p.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?p.input=new Uint8Array(d):p.input=d,p.next_in=0,p.avail_in=p.input.length;do{if(p.avail_out===0&&(p.output=new t.Buf8(g),p.next_out=0,p.avail_out=g),v=e.inflate(p,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&y&&(v=e.inflateSetDictionary(this.strm,y)),v===r.Z_BUF_ERROR&&k===!0&&(v=r.Z_OK,k=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;p.next_out&&(p.avail_out===0||v===r.Z_STREAM_END||p.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(p.output,p.next_out),S=p.next_out-w,_=n.buf2string(p.output,w),p.next_out=S,p.avail_out=g-S,S&&t.arraySet(p.output,p.output,w,S,0),this.onData(_)):this.onData(t.shrinkBuf(p.output,p.next_out))),p.avail_in===0&&p.avail_out===0&&(k=!0)}while((p.avail_in>0||p.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),p.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var p=new l(h);if(p.push(d,!0),p.err)throw p.msg||s[p.err];return p.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return D0.Inflate=l,D0.inflate=c,D0.inflateRaw=u,D0.ungzip=c,D0}var wj,sU;function lAe(){if(sU)return wj;sU=1;var e=Rp().assign,t=nAe(),n=oAe(),r=EJ(),s={};return e(s,t,n,r),wj=s,wj}var cAe=lAe();const e5=la(cAe);var Sj,iU;function uAe(){if(iU)return Sj;iU=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return Sj=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},Sj}var dAe=uAe();const _j=la(dAe);var Cj,aU;function fAe(){if(aU)return Cj;aU=1;var e={};function t(z){return Array.isArray(z)?z:[z]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const p=h,g=(z,$,Y)=>Object.defineProperty(z,$,{value:Y}),y=/([0-z])-([0-z])/g,v=()=>!1,x=z=>z.replace(y,($,Y,B)=>Y.charCodeAt(0)<=B.charCodeAt(0)?$:n),w=z=>{const{length:$}=z;return z.slice(0,$-$%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(z,$,Y)=>$+(Y.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(z,$)=>{const{length:Y}=$;return $.slice(0,Y-Y%2)+r}],[/[\\$.|*+(){^]/g,z=>`\\${z}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(z,$,Y)=>$+6<Y.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(z,$,Y)=>{const B=Y.replace(/\\\*/g,"[^\\/]*");return $+B}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(z,$,Y,B,G)=>$===s?`\\[${Y}${w(B)}${G}`:G==="]"&&B.length%2===0?`[${x(Y)}${B}]`:"[]"],[/(?:[^*])$/,z=>/\/$/.test(z)?`${z}$`:`${z}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(z,$)=>`${$?`${$}[^/]+`:"[^/]*"}(?=$|\\/$)`]],_=Object.create(null),k=(z,$)=>{let Y=_[z];return Y||(Y=S.reduce((B,[G,Z])=>B.replace(G,Z.bind(z)),z),_[z]=Y),$?new RegExp(Y,"i"):new RegExp(Y)},T=z=>typeof z=="string",A=z=>z&&T(z)&&!i.test(z)&&!a.test(z)&&z.indexOf("#")!==0,R=z=>z.split(c);class M{constructor($,Y,B,G){this.origin=$,this.pattern=Y,this.negative=B,this.regex=G}}const j=(z,$)=>{const Y=z;let B=!1;z.indexOf("!")===0&&(B=!0,z=z.substr(1)),z=z.replace(o,"!").replace(l,"#");const G=k(z,$);return new M(Y,z,B,G)},F=(z,$)=>{throw new $(z)},P=(z,$,Y)=>T(z)?z?P.isNotRelative(z)?Y(`path should be a \`path.relative()\`d string, but got "${$}"`,RangeError):!0:Y("path must not be empty",TypeError):Y(`path must be a string, but got \`${$}\``,TypeError),q=z=>u.test(z);P.isNotRelative=q,P.convert=z=>z;class I{constructor({ignorecase:$=!0,ignoreCase:Y=$,allowRelativePaths:B=!1}={}){g(this,p,!0),this._rules=[],this._ignoreCase=Y,this._allowRelativePaths=B,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern($){if($&&$[p]){this._rules=this._rules.concat($._rules),this._added=!0;return}if(A($)){const Y=j($,this._ignoreCase);this._added=!0,this._rules.push(Y)}}add($){return this._added=!1,t(T($)?R($):$).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern($){return this.add($)}_testOne($,Y){let B=!1,G=!1;return this._rules.forEach(Z=>{const{negative:ne}=Z;if(G===ne&&B!==G||ne&&!B&&!G&&!Y)return;Z.regex.test($)&&(B=!ne,G=ne)}),{ignored:B,unignored:G}}_test($,Y,B,G){const Z=$&&P.convert($);return P(Z,$,this._allowRelativePaths?v:F),this._t(Z,Y,B,G)}_t($,Y,B,G){if($ in Y)return Y[$];if(G||(G=$.split(d)),G.pop(),!G.length)return Y[$]=this._testOne($,B);const Z=this._t(G.join(d)+d,Y,B,G);return Y[$]=Z.ignored?Z:this._testOne($,B)}ignores($){return this._test($,this._ignoreCache,!1).ignored}createFilter(){return $=>!this.ignores($)}filter($){return t($).filter(this.createFilter())}test($){return this._test($,this._testCache,!0)}}const V=z=>new I(z),D=z=>P(z&&P.convert(z),z,v);if(V.isPathValid=D,V.default=V,Cj=V,typeof Wi<"u"&&(e&&e.IGNORE_TEST_WIN32||Wi.platform==="win32")){const z=Y=>/^\\\\\?\\/.test(Y)||/["<>|\u0000-\u001F]+/u.test(Y)?Y:Y.replace(/\\/g,"/");P.convert=z;const $=/^[a-z]:\//i;P.isNotRelative=Y=>$.test(Y)||q(Y)}return Cj}var hAe=fAe();const pAe=la(hAe);var kj,oU;function mAe(){if(oU)return kj;oU=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return kj=n,kj}var gAe=mAe();const Vu=la(gAe);var Ej,lU;function yAe(){return lU||(lU=1,Ej=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",p=-1,g=0,y=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},S=function(A,R,M){return{x:A,y:R,k:M}},_=function(A,R){return{elem:A,t:R}},k=function(A,R,M){var j,F,P;for(R>M?j=c[A-1+l]:j=c[A+1+l],P=Math.max(R,M),F=P-A;F<s&&P<i&&n[F]===r[P];)++F,++P;return c[A+l]=u.length,u[u.length]=new S(F,P,j),P},T=function(A){var R,M,j;for(R=M=0,j=A.length-1;j>=0;--j)for(;R<A[j].x||M<A[j].y;)A[j].y-A[j].x>M-R?(a?d[d.length]=new _(r[M],p):d[d.length]=new _(r[M],y),++M):A[j].y-A[j].x<M-R?(a?d[d.length]=new _(n[R],y):d[d.length]=new _(n[R],p),++R):(d[d.length]=new _(n[R],g),h+=n[R],++R,++M)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var A,R,M,j,F,P,q,I;for(A=i-s,R=s+i+3,M={},q=0;q<R;++q)M[q]=-1,c[q]=-1;j=-1;do{for(++j,I=-j;I<=A-1;++I)M[I+l]=k(I,M[I-1+l]+1,M[I+1+l]);for(I=A+j;I>=A+1;--I)M[I+l]=k(I,M[I-1+l]+1,M[I+1+l]);M[A+l]=k(A,M[A-1+l]+1,M[A+1+l])}while(M[A+l]!==i);for(o=A+2*j,F=c[A+l],P=[];F!==-1;)P[P.length]=new S(u[F].x,u[F].y,null),F=u[F].k;T(P)}}}),Ej}var Tj,cU;function bAe(){if(cU)return Tj;cU=1;var e=yAe();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,p=l.length-1;p>=0;--p)l[p].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[p].t===o.SES_DELETE?d--:l[p].t===o.SES_ADD&&h--;var g={file1index:-1,file2index:-1,chain:null};return u?(u.chain=g,c):g}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h($,Y){d.push([$.file1[0],Y,$.file1[1],$.file2[0],$.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function($,Y){return $[0]-Y[0]});var p=[],g=0;function y($){$>g&&(p.push([1,g,$-g]),g=$)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],S=w[0],_=S+w[2];v<d.length-1;){var k=d[v+1],T=k[0];if(T>_)break;_=Math.max(_,T+k[2]),v++}if(y(S),x==v)w[4]>0&&p.push([w[1],w[3],w[4]]);else{var A={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var R=w[1],M=A[R],j=w[0],F=j+w[2],P=w[3],q=P+w[4];M[0]=Math.min(P,M[0]),M[1]=Math.max(q,M[1]),M[2]=Math.min(j,M[2]),M[3]=Math.max(F,M[3])}var I=A[0][0]+(S-A[0][2]),V=A[0][1]+(_-A[0][3]),D=A[2][0]+(S-A[2][2]),z=A[2][1]+(_-A[2][3]);p.push([-1,I,V-I,S,_-S,D,z-D])}g=_}return y(a.length),p}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function p(w){for(var S=0;S<w.length;S++)d.push(w[S])}function g(w){if(w[2]!=w[6])return!0;for(var S=w[1],_=w[5],k=0;k<w[2];k++)if(i[k+S]!=o[k+_])return!0;return!1}for(var y=0;y<u.length;y++){var v=u[y],x=v[0];x==-1?g(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):p(c[0].slice(v[1],v[1]+v[2])):p(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return Tj=s,Tj}var vAe=bAe();const xAe=la(vAe);class is extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new is(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class ES extends is{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=ES.code,this.data={filepaths:t}}}ES.code="UnmergedPathsError";class kr extends is{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=kr.code,this.data={message:t}}}kr.code="InternalError";class Hb extends is{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=Hb.code,this.data={filepath:t}}}Hb.code="UnsafeFilepathError";class Bu{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function yA(e,t){return-(e<t)||+(e>t)}function TJ(e,t){return yA(e.path,t.path)}function AJ(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const Eu=2**32;function uU(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function Zy(e){const[t,n]=uU(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=uU(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%Eu,ctimeNanoseconds:n%Eu,mtimeSeconds:r%Eu,mtimeNanoseconds:s%Eu,dev:e.dev%Eu,ino:e.ino%Eu,mode:AJ(e.mode%Eu),uid:e.uid%Eu,gid:e.gid%Eu,size:e.size>-1?e.size%Eu:0}}function wAe(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let Aj=null;async function Nf(e){return Aj===null&&(Aj=await _Ae()),Aj?NJ(e):SAe(e)}function SAe(e){return new wJ().update(e).digest("hex")}async function NJ(e){const t=await crypto.subtle.digest("SHA-1",e);return wAe(t)}async function _Ae(){try{if(await NJ(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function CAe(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function kAe(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(un.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Im{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(un.isBuffer(t))return Im.fromBuffer(t);if(t===null)return new Im(null);throw new kr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new kr("Index file is empty (.git/index)");const n=new Im,r=new Bu(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new kr(`Invalid dircache magic file number: ${s}`);const i=await Nf(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new kr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new kr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=CAe(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new kr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new Hb(u.path);let p=8-(r.tell()-12)%8;for(p===0&&(p=8);p--;){const g=r.readUInt8();if(g!==0)throw new kr(`Expected 1-8 null characters but got '${g}' after ${u.path}`);if(r.eof())throw new kr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(TJ)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=Zy(n);const i=un.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=un.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=un.alloc(r),i=new Bu(s),a=Zy(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(kAe(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=un.alloc(12),n=new Bu(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(Im._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(Im._entryToBuffer(l));r=await Promise.all(r);const s=un.concat(r),i=un.concat([t,s]),a=await Nf(i);return un.concat([i,un.from(a,"hex")])}}function iE(e,t,n=!0,r=!0){const s=Zy(e),i=Zy(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let Nj=null;const Rj=Symbol("IndexCache");function EAe(){return{map:new Map,stats:new Map}}async function TAe(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await Im.from(s);n.map.set(t,i),n.stats.set(t,r)}async function AAe(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:iE(r,s)}class Ca{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[Rj]||(r[Rj]=EAe());const a=`${n}/index`;Nj===null&&(Nj=new a1({maxPending:1/0}));let o,l=[];return await Nj.acquire(a,async()=>{const c=r[Rj];await AAe(t,a,c)&&await TAe(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new ES(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function aE(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function Xy(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function RJ(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:aE(s),metadata:{},children:[]};t.set(s,i),i.parent=n(Xy(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:aE(s),metadata:i,parent:n(Xy(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function NAe(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new kr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class RAe{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=Ca.acquire({fs:t,gitdir:n,cache:r},async function(i){return RJ(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(yA),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:Zy(r.metadata);t._type=r.type==="tree"?"tree":NAe(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const bA=Symbol("GitWalkSymbol");function Gb(){const e=Object.create(null);return Object.defineProperty(e,bA,{value:function({fs:t,gitdir:n,cache:r}){return new RAe({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class Ps extends is{constructor(t){super(`Could not find ${t}.`),this.code=this.name=Ps.code,this.data={what:t}}}Ps.code="NotFoundError";class $o extends is{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=$o.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}$o.code="ObjectTypeError";class op extends is{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=op.code,this.data={value:t}}}op.code="InvalidOidError";class TS extends is{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=TS.code,this.data={remote:t}}}TS.code="NoRefspecError";class oE{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new oE(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class lE{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new kr("Invalid refspec");return new lE({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class t5{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(lE.from(r));return new t5(n)}add(t){const n=lE.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function IAe(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const MAe=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},_x=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},dU={core:{filemode:_x,bare:_x,logallrefupdates:_x,symlinks:_x,ignorecase:_x,bigFileThreshold:MAe}},jAe=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,PAe=/^[A-Za-z0-9-.]+$/,OAe=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,DAe=/^[A-Za-z][A-Za-z-]*$/,FAe=/^(.*?)( *[#;].*)$/,LAe=e=>{const t=jAe.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},$Ae=e=>{const t=OAe.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=BAe(r),i=zAe(s);return[n,i]}return null},BAe=e=>{const t=FAe.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return fU(n)&&fU(r)?`${n}${r}`:n},fU=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,zAe=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),hU=e=>e!=null?e.toLowerCase():null,m4=(e,t,n)=>[hU(e),t,hU(n)].filter(r=>r!=null).join("."),pU=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:m4(n,s,r),sectionPath:m4(n,s,null),isSection:!!n}},UAe=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class n5{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=LAe(o),c=l!=null;if(c)[n,r]=l;else{const d=$Ae(o);d!=null&&([i,a]=d)}const u=m4(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new n5(t)}async get(t,n=!1){const r=pU(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=dU[i]&&dU[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=pU(t),u=UAe(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(p=>p.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(PAe.test(s)&&DAe.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const p={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(p,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class Ki{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return n5.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const HC=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],qAe=["config","description","index","shallow","commondir"];let Ij;async function Ah(e,t){return Ij===void 0&&(Ij=new a1),Ij.acquire(e,t)}class Zt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new op(v);const u=await Ki.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new TS(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=t5.from(o),h=new Map;if(c){const v=await Zt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Zt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Zt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const p=d.translate([...s.keys()]);for(const[v,x]of p){const w=s.get(v);h.set(x,w)}const g=d.translate([...i.keys()]);for(const[v,x]of g){const w=i.get(v),S=d.translateOne(w);S&&h.set(x,`ref: ${S}`)}const y=[];if(l){for(const v of d.localNamespaces()){const x=(await Zt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||y.push(w)}y.length>0&&await Zt.deleteRefs({fs:t,gitdir:n,refs:y})}for(const[v,x]of h)await Ah(v,async()=>t.write(Ut.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:y}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new op(s);await Ah(r,async()=>t.write(Ut.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await Ah(r,async()=>t.write(Ut.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Zt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm(Ut.join(n,o))));let s=await Ah("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=oE.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await Ah("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Zt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Zt.packedRefs({fs:t,gitdir:n}),a=HC(r).filter(o=>!qAe.includes(o));for(const o of a){const l=await Ah(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Zt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new Ps(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Zt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Zt.packedRefs({fs:t,gitdir:n}),i=HC(r);for(const a of i)if(await Ah(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new Ps(r)}static async expandAgainstMap({ref:t,map:n}){const r=HC(t);for(const s of r)if(await n.has(s))return s;throw new Ps(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Zt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=HC(t);for(const a of i){const o=s.get(a);if(o)return Zt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new Ps(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Ah("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return oE.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Zt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(IAe),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Zt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Zt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Zt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function VAe(e,t){return yA(mU(e),mU(t))}function mU(e){return e.mode==="040000"?e.path+"/":e.path}function IJ(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new kr(`Unexpected GitTree entry mode: ${e}`)}function WAe(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new kr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new kr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=IJ(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new Hb(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function HAe(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new kr(`Could not understand file mode: ${e}`)}function GAe(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=HAe(e.mode),e.type||(e.type=IJ(e.mode)),e}class ol{constructor(t){if(un.isBuffer(t))this._entries=WAe(t);else if(Array.isArray(t))this._entries=t.map(GAe);else throw new kr("invalid type passed to GitTree constructor");this._entries.sort(TJ)}static from(t){return new ol(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(VAe),un.concat(t.map(n=>{const r=un.from(n.mode.replace(/^0/,"")),s=un.from(" "),i=un.from(n.path,"utf8"),a=un.from([0]),o=un.from(n.oid,"hex");return un.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class Kb{static wrap({type:t,object:n}){return un.concat([un.from(`${t} ${n.byteLength.toString()}\0`),un.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new kr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:un.from(t.slice(r+1))}}}async function MJ({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function KAe(e,t){const n=new Bu(e),r=gU(n);if(r!==t.byteLength)throw new kr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=gU(n);let i;const a=bU(n,t);if(a.byteLength===s)i=a;else{i=un.alloc(s);const o=new Bu(i);for(o.copy(a);!n.eof();)o.copy(bU(n,t));const l=o.tell();if(s!==l)throw new kr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function gU(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function yU(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function bU(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=yU(e,n&s,4);let o=yU(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function YAe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function jJ(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:YAe(e)}class PJ{constructor(t){if(typeof un>"u")throw new Error("Missing Buffer dependency");this.stream=jJ(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?un.alloc(0):(n&&(n=un.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>ZAe(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=un.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function ZAe(e){return e.reduce((t,n)=>t+n.length,0)}async function XAe(e,t){const n=new PJ(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new kr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new kr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await JAe(n),d=new e5.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new kr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new kr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const p=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:p,reference:u,ofs:c})}}}}async function JAe(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=un.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function OJ(e){return e5.inflate(e)}function QAe(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function eNe(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class Jy{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new Bu(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new kr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new kr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new Jy({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await XAe([t],async({data:v,type:x,reference:w,offset:S,num:_})=>{u===null&&(u=_);const k=Math.floor((u-_)*100/u);k!==d&&r&&await r({phase:"Receiving objects",loaded:u-_,total:u}),d=k,x=s[x],["commit","tree","blob","tag"].includes(x)?i[S]={type:x,offset:S}:x==="ofs-delta"?i[S]={type:x,offset:S}:x==="ref-delta"&&(i[S]={type:x,offset:S})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],S=i[x],_=QTe.buf(t.slice(x,w))>>>0;S.end=w,S.crc=_}const p=new Jy({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let g=0;const y=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(g*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:g,total:u}),g++,d=x;const w=i[v];if(!w.oid)try{p.readDepth=0,p.externalReadDepth=0;const{type:S,object:_}=await p.readSlice({start:v});y[p.readDepth]+=1;const k=await Nf(Kb.wrap({type:S,object:_}));w.oid=k,o.push(k),c.set(k,v),l[k]=w.crc}catch{continue}}return o.sort(),p}async toBuffer(){const t=[],n=(c,u)=>{t.push(un.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new Bu(un.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new Bu(un.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new Bu(un.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=un.concat(t),o=await Nf(a),l=un.alloc(20);return l.write(o,"hex"),un.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new kr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new kr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new Bu(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new kr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=eNe(s,l));let d=null,h=null;if(o==="ofs_delta"){const g=QAe(s),y=t-g;({object:d,type:o}=await this.readSlice({start:y}))}if(o==="ref_delta"){const g=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:g}))}const p=r.slice(s.tell());if(h=un.from(await OJ(p)),h.byteLength!==c)throw new kr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=un.from(KAe(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const GC=Symbol("PackfileCache");async function tNe({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return Jy.fromIdx({idx:i,getExternalRefDelta:n})}function r5({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[GC]||(t[GC]=new Map);let a=t[GC].get(n);return a||(a=tNe({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[GC].set(n,a)),a}async function nNe({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir(Ut.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await r5({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new kr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function ni({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>ni({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:un.from("tree 0\0")}),a||(a=await MJ({fs:e,gitdir:n,oid:r})),!a){if(a=await nNe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new Ps(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=un.from(await OJ(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await Nf(a.object);if(o!==r)throw new kr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=Kb.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new kr(`invalid requested format "${s}"`)}class cu extends is{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=cu.code,this.data={noun:t,where:n,canForce:r}}}cu.code="AlreadyExistsError";class AS extends is{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=AS.code,this.data={nouns:t,short:n,matches:r}}}AS.code="AmbiguousError";class NS extends is{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=NS.code,this.data={filepaths:t}}}NS.code="CheckoutConflictError";class RS extends is{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=RS.code,this.data={ref:t,oid:n}}}RS.code="CommitNotFetchedError";class IS extends is{constructor(){super("Empty response from git server."),this.code=this.name=IS.code,this.data={}}}IS.code="EmptyServerResponseError";class MS extends is{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=MS.code,this.data={}}}MS.code="FastForwardError";class jS extends is{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=jS.code,this.data={prettyDetails:t,result:n}}}jS.code="GitPushError";class Qy extends is{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=Qy.code,this.data={statusCode:t,statusMessage:n,response:r}}}Qy.code="HttpError";class lp extends is{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=lp.code,this.data={reason:t}}}lp.code="InvalidFilepathError";class iu extends is{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=iu.code,this.data={ref:t,suggestion:n}}}iu.code="InvalidRefNameError";class PS extends is{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=PS.code,this.data={depth:t}}}PS.code="MaxDepthError";class Yb extends is{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=Yb.code,this.data={}}}Yb.code="MergeNotSupportedError";class Zb extends is{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=Zb.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}Zb.code="MergeConflictError";class oo extends is{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=oo.code,this.data={role:t}}}oo.code="MissingNameError";class sl extends is{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=sl.code,this.data={parameter:t}}}sl.code="MissingParameterError";class OS extends is{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=OS.code,this.data={errors:t},this.errors=t}}OS.code="MultipleGitError";class Pg extends is{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=Pg.code,this.data={expected:t,actual:n}}}Pg.code="ParseError";class eb extends is{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=eb.code,this.data={reason:t}}}eb.code="PushRejectedError";class Wh extends is{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=Wh.code,this.data={capability:t,parameter:n}}}Wh.code="RemoteCapabilityError";class DS extends is{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=DS.code,this.data={preview:t,response:n}}}DS.code="SmartHttpError";class FS extends is{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=FS.code,this.data={url:t,transport:n,suggestion:r}}}FS.code="UnknownTransportError";class LS extends is{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=LS.code,this.data={url:t}}}LS.code="UrlParseError";class Xb extends is{constructor(){super("The operation was canceled."),this.code=this.name=Xb.code,this.data={}}}Xb.code="UserCanceledError";class $S extends is{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=$S.code,this.data={filepath:t}}}$S.code="IndexResetError";class BS extends is{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=BS.code,this.data={ref:t}}}BS.code="NoCommitError";var rNe=Object.freeze({__proto__:null,AlreadyExistsError:cu,AmbiguousError:AS,CheckoutConflictError:NS,CommitNotFetchedError:RS,EmptyServerResponseError:IS,FastForwardError:MS,GitPushError:jS,HttpError:Qy,InternalError:kr,InvalidFilepathError:lp,InvalidOidError:op,InvalidRefNameError:iu,MaxDepthError:PS,MergeNotSupportedError:Yb,MergeConflictError:Zb,MissingNameError:oo,MissingParameterError:sl,MultipleGitError:OS,NoRefspecError:TS,NotFoundError:Ps,ObjectTypeError:$o,ParseError:Pg,PushRejectedError:eb,RemoteCapabilityError:Wh,SmartHttpError:DS,UnknownTransportError:FS,UnsafeFilepathError:Hb,UrlParseError:LS,UserCanceledError:Xb,UnmergedPathsError:ES,IndexResetError:$S,NoCommitError:BS});function g4({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=sNe(r),`${e} <${t}> ${n} ${r}`}function sNe(e){const t=iNe(aNe(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function iNe(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function aNe(e){return e===0?e:-e}function sf(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function cE(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:oNe(s)}}function oNe(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),lNe(r)}function lNe(e){return e===0?e:-e}class ko{constructor(t){if(typeof t=="string")this._tag=t;else if(un.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=ko.render(t);else throw new kr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new ko(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${g4(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=cE(r.tagger)),r.committer&&(r.committer=cE(r.committer)),r}withoutSignature(){const t=sf(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return sf(t)}payload(){return this.withoutSignature()+`
`}toObject(){return un.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=sf(i);const a=s+i;return ko.from(a)}}function Mj(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function cNe(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class ti{constructor(t){if(typeof t=="string")this._commit=t;else if(un.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=ti.render(t);else throw new kr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=ti.justHeaders(t),s=ti.justMessage(t),i=sf(r+`
gpgsig`+Mj(n)+`
`+s);return new ti(i)}static from(t){return new ti(t)}toObject(){return un.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return ti.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return sf(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=ti.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=cE(r.author)),r.committer&&(r.committer=cE(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new kr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${g4(r)}
`;const s=t.committer||t.author;return n+=`committer ${g4(s)}
`,t.gpgsig&&(n+="gpgsig"+Mj(t.gpgsig)),n}static render(t){return ti.renderHeaders(t)+`
`+sf(t.message)}render(){return this._commit}withoutSignature(){const t=sf(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return sf(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return cNe(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=ti.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=sf(a);const l=ti.justHeaders(t._commit)+`
gpgsig`+Mj(a)+`
`+i;return ti.from(l)}}async function tb({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:ol.from([]),oid:r};const{type:s,object:i}=await ni({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=ko.from(i).parse().object,tb({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=ti.from(i).parse().tree,tb({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new $o(r,s,"tree");return{tree:ol.from(i),oid:r}}class uNe{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Zt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof Ps&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await tb({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await ni({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new $o(l,c,o.type);const d=ol.from(u);for(const h of d)a.set(Ut.join(n,h.path),h);return d.entries().map(h=>Ut.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=AJ(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await ni({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function lc({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,bA,{value:function({fs:n,gitdir:r,cache:s}){return new uNe({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class dNe{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir(Ut.join(s,n));return i===null?null:i.map(a=>Ut.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=Zy(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await Ca.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Wi<"u"?Wi.platform!=="win32":!0;if(!l||iE(c,l,d,h)){const p=await t.content();p===void 0?a=void 0:(a=await Nf(Kb.wrap({type:"blob",object:p})),l&&a===l.oid&&(!d||c.mode===l.mode)&&iE(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await Ki.get({fs:t,gitdir:n}),this.config)}}function zS(){const e=Object.create(null);return Object.defineProperty(e,bA,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new dNe({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function fNe(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const DJ=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class hNe{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*pNe(e){const t=new hNe;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function cp({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=DJ(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(p=>p[bA]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=fNe(0,l.length),d=async p=>{u.map(v=>{const x=p[v];p[v]=x&&new l[v].ConstructEntry(x)});const y=(await Promise.all(u.map(v=>{const x=p[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:p,children:pNe(y)}},h=async p=>{const{entries:g,children:y}=await d(p),v=g.find(w=>w&&w._fullpath)._fullpath,x=await i(v,g);if(x!==null){let w=await o(h,y);return w=w.filter(S=>S!==void 0),a(x,w)}};return h(c)}async function y4(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=Ut.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?y4(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function mNe(e){return gNe(e)&&vU(e.then)&&vU(e.catch)}function gNe(e){return e&&typeof e=="object"}function vU(e){return typeof e=="function"}function xU(e){return mNe((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const wU=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function SU(e,t){if(xU(t))for(const n of wU)e[`_${n}`]=t[n].bind(t);else for(const n of wU)e[`_${n}`]=_j(t[n].bind(t));xU(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=y4.bind(null,e):t.rm?e._rm=_j(t.rm.bind(t)):t.rmdir.length>2?e._rm=_j(t.rmdir.bind(t)):e._rm=y4.bind(null,e)}class An{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?SU(this,t.promises):SU(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=un.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(Xy(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=Xy(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(yA),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return un.isBuffer(r)?r:un.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function ft(e,t){if(t===void 0)throw new sl(e)}async function uE(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function yNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),commit:r="HEAD",cache:s={}}){try{ft("fs",e),ft("dir",t),ft("gitdir",n);const i=new An(e),a=[lc({ref:r}),zS(),Gb()];let o=[];await Ca.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await cp({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const p=!await uE(d,h),g=o.includes(c),y=!await uE(h,u);if(p||g)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(y)return!1;throw new $S(c)}});await Ca.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class Jb{static async isIgnored({fs:t,dir:n,gitdir:r=Ut.join(n,".git"),filepath:s}){if(aE(s)===".git")return!0;if(s===".")return!1;let i="";const a=Ut.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:Ut.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:Ut.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(g){if(g.code==="NOENT")continue}const h=pAe().add(i);h.add(d);const p=Xy(u.filepath);if(p!=="."&&h.ignores(p))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function bNe({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let jj=null;async function FJ(e){return jj===null&&(jj=xNe()),jj?vNe(e):e5.deflate(e)}async function vNe(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function xNe(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function dl({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=Kb.wrap({type:n,object:r})),i=await Nf(r),r=un.from(await FJ(r))),a||await bNe({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function LJ(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function wNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{ft("fs",e),ft("dir",t),ft("gitdir",n),ft("filepath",r);const o=new An(e);await Ca.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await Ki.get({fs:o,gitdir:n})).get("core.autocrlf");return b4({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function b4({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await Jb.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const p=await n.lstat(Ut.join(e,h));if(!p)throw new Ps(h);if(p.isDirectory()){const g=await n.readdir(Ut.join(e,h));if(a){const y=g.map(v=>b4({dir:e,gitdir:t,fs:n,filepath:[Ut.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(y)}else for(const y of g)await b4({dir:e,gitdir:t,fs:n,filepath:[Ut.join(h,y)],index:s,force:i,parallel:a,autocrlf:o})}else{const g=p.isSymbolicLink()?await n.readlink(Ut.join(e,h)).then(LJ):await n.read(Ut.join(e,h),{autocrlf:o});if(g===null)throw new Ps(h);const y=await dl({fs:n,gitdir:t,type:"blob",object:g});s.insert({filepath:h,stats:p,oid:y})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new OS(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function o1({fs:e,gitdir:t,path:n}){return(await Ki.get({fs:e,gitdir:t})).get(n)}function $J(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function up({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await o1({fs:e,gitdir:t,path:"user.name"}),email:await o1({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=$J({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function nb({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await o1({fs:e,gitdir:t,path:"user.name"}),email:await o1({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=$J({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function BJ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await ni({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=ko.from(i).parse().object,BJ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new $o(r,s,"commit");return{commit:ti.from(i),oid:r}}async function rb({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await BJ({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function vA({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:p}){let g=!1;d||(d=await Zt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let y,v;try{y=await Zt.resolve({fs:e,gitdir:r,ref:d}),v=await rb({fs:e,gitdir:r,oid:y,cache:{}})}catch{g=!0}if(l&&g)throw new BS(d);const x=l?await up({fs:e,gitdir:r,author:i,commit:v.commit}):await up({fs:e,gitdir:r,author:i});if(!x)throw new oo("author");const w=l?await nb({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await nb({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new oo("committer");return Ca.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const k=RJ(S.entries).get(".");if(p||(p=await zJ({fs:e,gitdir:r,inode:k,dryRun:c})),h?h=await Promise.all(h.map(R=>Zt.resolve({fs:e,gitdir:r,ref:R}))):l?h=v.commit.parent:h=y?[y]:[],!s)if(l)s=v.commit.message;else throw new sl("message");let T=ti.from({tree:p,parent:h,author:x,committer:w,message:s});o&&(T=await ti.sign(T,n,o));const A=await dl({fs:e,gitdir:r,type:"commit",object:T.toObject(),dryRun:c});return!u&&!c&&await Zt.writeRef({fs:e,gitdir:r,ref:d,value:A}),A})}async function zJ({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await zJ({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=ol.from(i);return await dl({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function US({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new lp("leading-slash");if(s.endsWith("/"))throw new lp("trailing-slash");const i=r,a=await tb({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await UJ({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function UJ({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await ni({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new $o(i,c,"tree",a);return r=ol.from(u),UJ({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new Ps(`file or directory found at "${i}:${a}"`)}async function Qb({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await US({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await tb({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function qS({fs:e,gitdir:t,tree:n}){const r=ol.from(n).toObject();return await dl({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function SNe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Zt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof Ps))throw x}let p=(await Qb({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)p=p.filter(x=>x.path!==i);else for(const x of p)if(x.path===i)throw new cu("note",i);typeof a=="string"&&(a=un.from(a,"utf8"));const g=await dl({fs:e,gitdir:r,type:"blob",object:a,format:"content"});p.push({mode:"100644",path:i,oid:g,type:"blob"});const y=await qS({fs:e,gitdir:r,tree:p});return await vA({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:y,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function _Ne({fs:e,onSign:t,dir:n,gitdir:r=Ut.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{ft("fs",e),ft("gitdir",r),ft("oid",i),ft("note",a),u&&ft("onSign",t);const h=new An(e),p=await up({fs:h,gitdir:r,author:l});if(!p)throw new oo("author");const g=await nb({fs:h,gitdir:r,author:p,committer:c});if(!g)throw new oo("committer");return await SNe({fs:new An(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:p,committer:g,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function qJ({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==Vu.clean(n))throw new iu(n,Vu.clean(n));const i=await Ki.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new cu("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await Ki.save({fs:e,gitdir:t,config:i})}async function CNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),remote:r,url:s,force:i=!1}){try{return ft("fs",e),ft("gitdir",n),ft("remote",r),ft("url",s),await qJ({fs:new An(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function kNe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Zt.exists({fs:e,gitdir:r,ref:s}))throw new cu("tag",s);const d=await Zt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await ni({fs:e,cache:t,gitdir:r,oid:d});let p=ko.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(p=await ko.sign(p,n,c));const g=await dl({fs:e,gitdir:r,type:"tag",object:p.toObject()});await Zt.writeRef({fs:e,gitdir:r,ref:s,value:g})}async function ENe({fs:e,onSign:t,dir:n,gitdir:r=Ut.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{ft("fs",e),ft("gitdir",r),ft("ref",s),c&&ft("onSign",t);const h=new An(e),p=await up({fs:h,gitdir:r,author:i});if(!p)throw new oo("tagger");return await kNe({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:p,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function TNe({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==Vu.clean(n))throw new iu(n,Vu.clean(n));const a=`refs/heads/${n}`;if(!i&&await Zt.exists({fs:e,gitdir:t,ref:a}))throw new cu("branch",n,!1);let o;try{o=await Zt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Zt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Zt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function ANe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return ft("fs",e),ft("gitdir",n),ft("ref",r),await TNe({fs:new An(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const VJ=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function s5({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:p=!0}){let g;if(r)try{g=await Zt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{g="0000000000000000000000000000000000000000"}let y;try{y=await Zt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(y=await Zt.resolve({fs:e,gitdir:i,ref:x}),p){const w=await Ki.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await Ki.save({fs:e,gitdir:i,config:w})}await Zt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:y})}if(!c){let v;try{v=await NNe({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(k){throw k instanceof Ps&&k.data.what===y?new RS(o,y):k}const x=v.filter(([k])=>k==="conflict").map(([k,T])=>T);if(x.length>0)throw new NS(x);const w=v.filter(([k])=>k==="error").map(([k,T])=>T);if(w.length>0)throw new kr(w.join(", "));if(d){r&&await r({previousHead:g,newHead:y,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const _=v.length;await Ca.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(v.filter(([T])=>T==="delete"||T==="delete-index").map(async function([T,A]){const R=`${s}/${A}`;T==="delete"&&await e.rm(R),k.delete({filepath:A}),n&&await n({phase:"Updating workdir",loaded:++S,total:_})}))}),await Ca.acquire({fs:e,gitdir:i,cache:t},async function(k){for(const[T,A]of v)if(T==="rmdir"||T==="rmdir-index"){const R=`${s}/${A}`;try{T==="rmdir-index"&&k.delete({filepath:A}),await e.rmdir(R),n&&await n({phase:"Updating workdir",loaded:++S,total:_})}catch(M){if(M.code==="ENOTEMPTY")console.log(`Did not delete ${A} because directory is not empty`);else throw M}}}),await Promise.all(v.filter(([k])=>k==="mkdir"||k==="mkdir-index").map(async function([k,T]){const A=`${s}/${T}`;await e.mkdir(A),n&&await n({phase:"Updating workdir",loaded:++S,total:_})})),await Ca.acquire({fs:e,gitdir:i,cache:t},async function(k){await Promise.all(v.filter(([T])=>T==="create"||T==="create-index"||T==="update"||T==="mkdir-index").map(async function([T,A,R,M,j]){const F=`${s}/${A}`;try{if(T!=="create-index"&&T!=="mkdir-index"){const{object:q}=await ni({fs:e,cache:t,gitdir:i,oid:R});if(j&&await e.rm(F),M===33188)await e.write(F,q);else if(M===33261)await e.write(F,q,{mode:511});else if(M===40960)await e.writelink(F,q);else throw new kr(`Invalid mode 0o${M.toString(8)} detected in blob ${R}`)}const P=await e.lstat(F);M===33261&&(P.mode=493),T==="mkdir-index"&&(P.mode=57344),k.insert({filepath:A,stats:P,oid:R}),n&&await n({phase:"Updating workdir",loaded:++S,total:_})}catch(P){console.log(P)}}))}),r&&await r({previousHead:g,newHead:y,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Zt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Zt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Zt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:y})}}async function NNe({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return cp({fs:e,cache:t,dir:r,gitdir:s,trees:[lc({ref:i}),zS(),Gb()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(g=>VJ(c,g)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=DJ(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function WJ({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=Ut.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:p={}}){try{ft("fs",e),ft("dir",r),ft("gitdir",s);const g=a||"HEAD";return await s5({fs:new An(e),cache:p,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:g,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(g){throw g.caller="git.checkout",g}}const RNe=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function Om(e){const t=RNe.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function Ip({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Zt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Zt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:Om(s)}function INe(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function HJ({username:e="",password:t=""}){return`Basic ${un.from(`${e}:${t}`).toString("base64")}`}async function VS(e,t){const n=jJ(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function dE(e){let t=0;const n=[];await VS(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function _U(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function v4(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class Ei{static flush(){return un.from("0000","utf8")}static delim(){return un.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=un.from(t));const n=t.length+4,r=v4(4,n);return un.concat([un.from(r,"utf8"),t])}static streamReader(t){const n=new PJ(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function CU(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function kU(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=Ei.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new IS;if(a.includes("version 2"))return CU(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Pg(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return CU(i);const[l,c]=Pj(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=Pj(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[p,g]=Pj(h.toString("utf8")," "," ");r.set(g,p)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function Pj(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new Pg(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const EU=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,TU=(e,t)=>{(t.username||t.password)&&(e.Authorization=HJ(t)),t.headers&&Object.assign(e,t.headers)},Oj=async e=>{try{const t=un.from(await dE(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class fE{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=_U(l);const p=a?EU(a,d):d;(h.username||h.password)&&(c.Authorization=HJ(h)),u===2&&(c["Git-Protocol"]="version=2");let g,y,v=!1;do if(g=await t.request({onProgress:n,method:"GET",url:`${p}/info/refs?service=${o}`,headers:c}),y=!1,g.statusCode===401||g.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new Xb;h&&(TU(c,h),v=!0,y=!0)}}else g.statusCode===200&&v&&s&&await s(d,h);while(y);if(g.statusCode!==200){const{response:x}=await Oj(g);throw new Qy(g.statusCode,g.statusMessage,x)}if(g.headers["content-type"]===`application/x-${o}-advertisement`){const x=await kU(g.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:S}=await Oj(g);try{const _=await kU([S],{service:o});return _.auth=h,_}catch{throw new DS(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=_U(i);c&&(i=c.url),r&&(i=EU(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,TU(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=Oj(u);throw new Qy(u.statusCode,u.statusMessage,d)}return u}}function MNe({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class xA{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",fE),n.set("https",fE);const r=MNe({url:t});if(!r)throw new LS(t);if(n.has(r.transport))return n.get(r.transport);throw new FS(t,r.transport,r.transport==="ssh"?INe(t):void 0)}}let xm=null;class l1{static async read({fs:t,gitdir:n}){xm===null&&(xm=new a1);const r=Ut.join(n,"shallow"),s=new Set;return await xm.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){xm===null&&(xm=new a1);const s=Ut.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await xm.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await xm.acquire(s,async function(){await t.rm(s)})}}async function jNe({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function PNe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir(Ut.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await r5({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new kr(l.error);if(l.offsets.has(r))return!0}return!1}async function AU({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>ni({fs:e,cache:t,gitdir:n,oid:o});let a=await jNe({fs:e,gitdir:n,oid:r});return a||(a=await PNe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function ONe(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function GJ(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const wA={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class W2{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function DNe(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function KJ(e){const t=new W2;let n="";return(async()=>(await VS(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=DNe(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class YJ{static demux(t){const n=Ei.streamReader(t),r=new W2,s=new W2,i=new W2,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function FNe(e){const{packetlines:t,packfile:n,progress:r}=YJ.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{VS(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const p=h.slice(-41).trim();p.length!==40&&u(new op(p)),s.push(p)}else if(h.startsWith("unshallow")){const p=h.slice(-41).trim();p.length!==40&&u(new op(p)),i.push(p)}else if(h.startsWith("ACK")){const[,p,g]=h.split(" ");a.push({oid:p,status:g}),g||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function LNe({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(Ei.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(Ei.encode(`shallow ${c}
`));s!==null&&o.push(Ei.encode(`deepen ${s}
`)),i!==null&&o.push(Ei.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(Ei.encode(`deepen-not ${c}
`));o.push(Ei.flush());for(const c of n)o.push(Ei.encode(`have ${c}
`));return o.push(Ei.encode(`done
`)),o}async function i5({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:p,depth:g=null,since:y=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:_={},prune:k=!1,pruneTags:T=!1}){const A=c||await Ip({fs:e,gitdir:l,test:!0}),R=await Ki.get({fs:e,gitdir:l}),M=d||A&&await R.get(`branch.${A}.remote`)||"origin",j=h||await R.get(`remote.${M}.url`);if(typeof j>"u")throw new sl("remote OR url");const F=u||A&&await R.get(`branch.${A}.merge`)||c||"HEAD";p===void 0&&(p=await R.get("http.corsProxy"));const P=xA.getRemoteHelperFor({url:j}),q=await P.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:p,service:"git-upload-pack",url:j,headers:_,protocolVersion:1}),I=q.auth,V=q.refs;if(V.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(g!==null&&!q.capabilities.has("shallow"))throw new Wh("shallow","depth");if(y!==null&&!q.capabilities.has("deepen-since"))throw new Wh("deepen-since","since");if(v.length>0&&!q.capabilities.has("deepen-not"))throw new Wh("deepen-not","exclude");if(x===!0&&!q.capabilities.has("deepen-relative"))throw new Wh("deepen-relative","relative");const{oid:D,fullref:z}=Zt.resolveAgainstMap({ref:F,map:V});for(const Fe of V.keys())Fe===z||Fe==="HEAD"||Fe.startsWith("refs/heads/")||w&&Fe.startsWith("refs/tags/")||V.delete(Fe);const $=GJ([...q.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${wA.agent}`]);x&&$.push("deepen-relative");const Y=S?[D]:V.values(),B=S?[A]:await Zt.listRefs({fs:e,gitdir:l,filepath:"refs"});let G=[];for(let Fe of B)try{Fe=await Zt.expand({fs:e,gitdir:l,ref:Fe});const Ie=await Zt.resolve({fs:e,gitdir:l,ref:Fe});await AU({fs:e,cache:t,gitdir:l,oid:Ie})&&G.push(Ie)}catch{}G=[...new Set(G)];const Z=await l1.read({fs:e,gitdir:l}),ne=q.capabilities.has("shallow")?[...Z]:[],ae=LNe({capabilities:$,wants:Y,haves:G,shallows:ne,depth:g,since:y,exclude:v}),le=un.from(await dE(ae)),Se=await P.connect({http:n,onProgress:r,corsProxy:p,service:"git-upload-pack",url:j,auth:I,body:[le],headers:_}),Ee=await FNe(Se.body);Se.headers&&(Ee.headers=Se.headers);for(const Fe of Ee.shallows)if(!Z.has(Fe))try{const{object:Ie}=await ni({fs:e,cache:t,gitdir:l,oid:Fe}),X=new ti(Ie),ye=await Promise.all(X.headers().parent.map(fe=>AU({fs:e,cache:t,gitdir:l,oid:fe})));ye.length===0||ye.every(fe=>fe)||Z.add(Fe)}catch{Z.add(Fe)}for(const Fe of Ee.unshallows)Z.delete(Fe);if(await l1.write({fs:e,gitdir:l,oids:Z}),S){const Fe=new Map([[z,D]]),Ie=new Map;let X=10,ye=z;for(;X--;){const ce=q.symrefs.get(ye);if(ce===void 0)break;Ie.set(ye,ce),ye=ce}const Ne=V.get(ye);Ne&&Fe.set(ye,Ne);const{pruned:fe}=await Zt.updateRemoteRefs({fs:e,gitdir:l,remote:M,refs:Fe,symrefs:Ie,tags:w,prune:k});k&&(Ee.pruned=fe)}else{const{pruned:Fe}=await Zt.updateRemoteRefs({fs:e,gitdir:l,remote:M,refs:V,symrefs:q.symrefs,tags:w,prune:k,pruneTags:T});k&&(Ee.pruned=Fe)}if(Ee.HEAD=q.symrefs.get("HEAD"),Ee.HEAD===void 0){const{oid:Fe}=Zt.resolveAgainstMap({ref:"HEAD",map:V});for(const[Ie,X]of V.entries())if(Ie!=="HEAD"&&X===Fe){Ee.HEAD=Ie;break}}const he=z.startsWith("refs/tags")?"tag":"branch";if(Ee.FETCH_HEAD={oid:D,description:`${he} '${Om(z)}' of ${j}`},r||s){const Fe=KJ(Ee.progress);VS(Fe,async Ie=>{if(s&&await s(Ie),r){const X=Ie.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);X&&await r({phase:X[1].trim(),loaded:parseInt(X[2],10),total:parseInt(X[3],10)})}})}const pe=un.from(await dE(Ee.packfile));if(Se.body.error)throw Se.body.error;const Le=pe.slice(-20).toString("hex"),He={defaultBranch:Ee.HEAD,fetchHead:Ee.FETCH_HEAD.oid,fetchHeadDescription:Ee.FETCH_HEAD.description};if(Ee.headers&&(He.headers=Ee.headers),k&&(He.pruned=Ee.pruned),Le!==""&&!ONe(pe)){He.packfile=`objects/pack/pack-${Le}.pack`;const Fe=Ut.join(l,He.packfile);await e.write(Fe,pe);const Ie=ye=>ni({fs:e,cache:t,gitdir:l,oid:ye}),X=await Jy.fromPack({pack:pe,getExternalRefDelta:Ie,onProgress:r});await e.write(Fe.replace(/\.pack$/,".idx"),await X.toBuffer())}return He}async function ZJ({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:Ut.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function $Ne({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:p,remote:g,depth:y,since:v,exclude:x,relative:w,singleBranch:S,noCheckout:_,noTags:k,headers:T}){try{if(await ZJ({fs:e,gitdir:u}),await qJ({fs:e,gitdir:u,remote:g,url:d,force:!1}),h){const M=await Ki.get({fs:e,gitdir:u});await M.set("http.corsProxy",h),await Ki.save({fs:e,gitdir:u,config:M})}const{defaultBranch:A,fetchHead:R}=await i5({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:p,remote:g,corsProxy:h,depth:y,since:v,exclude:x,relative:w,singleBranch:S,headers:T,tags:!k});if(R===null)return;p=p||A,p=p.replace("refs/heads/",""),await s5({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:p,remote:g,noCheckout:_})}catch(A){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),A}}async function BNe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=Ut.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:p="origin",depth:g=void 0,since:y=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:S=!1,noTags:_=!1,headers:k={},cache:T={}}){try{return ft("fs",e),ft("http",t),ft("gitdir",c),S||ft("dir",l),ft("url",u),await $Ne({fs:new An(e),cache:T,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:p,depth:g,since:y,exclude:v,relative:x,singleBranch:w,noCheckout:S,noTags:_,headers:k})}catch(A){throw A.caller="git.clone",A}}async function zNe({fs:e,onSign:t,dir:n,gitdir:r=Ut.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:p,cache:g={}}){try{ft("fs",e),l||ft("message",s),o&&ft("onSign",t);const y=new An(e);return await vA({fs:y,cache:g,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:p})}catch(y){throw y.caller="git.commit",y}}async function UNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),fullname:r=!1,test:s=!1}){try{return ft("fs",e),ft("gitdir",n),await Ip({fs:new An(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function qNe({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Zt.exists({fs:e,gitdir:t,ref:n}))throw new Ps(n);const s=await Zt.expand({fs:e,gitdir:t,ref:n}),i=await Ip({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Zt.resolve({fs:e,gitdir:t,ref:s});await Zt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Zt.deleteRef({fs:e,gitdir:t,ref:s});const a=Om(n),o=await Ki.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await Ki.save({fs:e,gitdir:t,config:o})}async function VNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r}){try{return ft("fs",e),ft("ref",r),await qNe({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function WNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r}){try{ft("fs",e),ft("ref",r),await Zt.deleteRef({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function HNe({fs:e,gitdir:t,remote:n}){const r=await Ki.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await Ki.save({fs:e,gitdir:t,config:r})}async function GNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),remote:r}){try{return ft("fs",e),ft("remote",r),await HNe({fs:new An(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function KNe({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Zt.deleteRef({fs:e,gitdir:t,ref:n})}async function YNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r}){try{return ft("fs",e),ft("ref",r),await KNe({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function ZNe({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function XNe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir(Ut.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await r5({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new kr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function JNe({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>ni({fs:e,cache:t,gitdir:n,oid:o}),i=await ZNe({fs:e,gitdir:n,oid:r}),a=await XNe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new AS("oids",r,i):new Ps(`an object matching "${r}"`)}async function QNe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,cache:s={}}){try{return ft("fs",e),ft("gitdir",n),ft("oid",r),await JNe({fs:new An(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function eRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r}){try{return ft("fs",e),ft("gitdir",n),ft("ref",r),await Zt.expand({fs:new An(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function a5({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await ni({fs:e,cache:t,gitdir:n,oid:c}),h=ti.from(d),{parent:p}=h.parseHeaders();for(const g of p)(!s[g]||!s[g].has(u))&&l.set(g+":"+u,{oid:g,index:u})}catch{}a=Array.from(l.values())}return[]}const Dj=/^.*(\r?\n|$)/gm;function tRe({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(Dj),l=s.match(Dj),c=a.match(Dj),u=xAe(o,l,c),d=7;let h="",p=!0;for(const g of u)g.ok&&(h+=g.ok.join("")),g.conflict&&(p=!1,h+=`${"<".repeat(d)} ${n}
`,h+=g.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=g.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:p,mergedText:h}}async function nRe({fs:e,cache:t,dir:n,gitdir:r=Ut.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:p}){const g=lc({ref:i}),y=lc({ref:a}),v=lc({ref:o}),x=[],w=[],S=[],_=[],k=await cp({fs:e,cache:t,dir:n,gitdir:r,trees:[g,y,v],map:async function(T,[A,R,M]){const j=aE(T),F=await uE(A,R),P=await uE(M,R);switch(`${F}-${P}`){case"false-false":return{mode:await R.mode(),path:j,oid:await R.oid(),type:await R.type()};case"false-true":return M?{mode:await M.mode(),path:j,oid:await M.oid(),type:await M.type()}:void 0;case"true-false":return A?{mode:await A.mode(),path:j,oid:await A.oid(),type:await A.type()}:void 0;case"true-true":{if(A&&R&&M&&await A.type()==="blob"&&await R.type()==="blob"&&await M.type()==="blob")return rRe({fs:e,gitdir:r,path:j,ours:A,base:R,theirs:M,ourName:l,baseName:c,theirName:u,mergeDriver:p}).then(async q=>{if(q.cleanMerge)h||s.insert({filepath:T,oid:q.mergeResult.oid,stage:0});else if(x.push(T),w.push(T),!h){const I=await R.oid(),V=await A.oid(),D=await M.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:I,stage:1}),s.insert({filepath:T,oid:V,stage:2}),s.insert({filepath:T,oid:D,stage:3})}return q.mergeResult});if(R&&!A&&M&&await R.type()==="blob"&&await M.type()==="blob"){if(x.push(T),S.push(T),!h){const q=await R.oid(),I=await M.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:q,stage:1}),s.insert({filepath:T,oid:I,stage:3})}return{mode:await M.mode(),oid:await M.oid(),type:"blob",path:j}}if(R&&A&&!M&&await R.type()==="blob"&&await A.type()==="blob"){if(x.push(T),_.push(T),!h){const q=await R.oid(),I=await A.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:q,stage:1}),s.insert({filepath:T,oid:I,stage:2})}return{mode:await A.mode(),oid:await A.oid(),type:"blob",path:j}}if(R&&!A&&!M&&await R.type()==="blob")return;throw new Yb}}},reduce:x.length!==0&&(!n||h)?void 0:async(T,A)=>{const R=A.filter(Boolean);if(T&&!(T&&T.type==="tree"&&R.length===0)){if(R.length>0){const j=new ol(R).toObject(),F=await dl({fs:e,gitdir:r,type:"tree",object:j,dryRun:d});T.oid=F}return T}}});return x.length!==0?(n&&!h&&await cp({fs:e,cache:t,dir:n,gitdir:r,trees:[lc({ref:k.oid})],map:async function(T,[A]){const R=`${n}/${T}`;if(await A.type()==="blob"){const M=await A.mode(),j=new TextDecoder().decode(await A.content());await e.write(R,j,{mode:M})}return!0}}),new Zb(x,w,S,_)):k.oid}async function rRe({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=tRe}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const p=un.from(await r.content()).toString("utf8"),g=un.from(await s.content()).toString("utf8"),y=un.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[g,p,y],path:n}),w=await dl({fs:e,gitdir:t,type:"blob",object:un.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function XJ({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:p,signingKey:g,onSign:y,mergeDriver:v}){s===void 0&&(s=await Ip({fs:e,gitdir:r,fullname:!0})),s=await Zt.expand({fs:e,gitdir:r,ref:s}),i=await Zt.expand({fs:e,gitdir:r,ref:i});const x=await Zt.resolve({fs:e,gitdir:r,ref:s}),w=await Zt.resolve({fs:e,gitdir:r,ref:i}),S=await a5({fs:e,cache:t,gitdir:r,oids:[x,w]});if(S.length!==1)throw new Yb;const _=S[0];if(_===w)return{oid:x,alreadyMerged:!0};if(a&&_===x)return!l&&!c&&await Zt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new MS;const k=await Ca.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async A=>nRe({fs:e,cache:t,dir:n,gitdir:r,index:A,ourOid:x,theirOid:w,baseOid:_,ourName:Om(s),baseName:"base",theirName:Om(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(k instanceof Zb)throw k;return d||(d=`Merge branch '${Om(i)}' into ${Om(s)}`),{oid:await vA({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:k,parent:[x,w],author:h,committer:p,signingKey:g,onSign:y,dryRun:l,noUpdateBranch:c}),tree:k,mergeCommit:!0}}}async function JJ({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:p,prune:g,pruneTags:y,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:S,headers:_,author:k,committer:T,signingKey:A}){try{if(!u){const j=await Ip({fs:e,gitdir:c});if(!j)throw new sl("ref");u=j}const{fetchHead:R,fetchHeadDescription:M}=await i5({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:p,singleBranch:S,headers:_,prune:g,pruneTags:y});await XJ({fs:e,cache:t,gitdir:c,ours:u,theirs:R,fastForward:v,fastForwardOnly:x,message:`Merge ${M}`,author:k,committer:T,signingKey:A,dryRun:!1,noUpdateBranch:!1}),await s5({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(R){throw R.caller="git.pull",R}}async function sRe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=Ut.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:p,singleBranch:g,headers:y={},cache:v={}}){try{ft("fs",e),ft("http",t),ft("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await JJ({fs:new An(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:p,singleBranch:g,headers:y,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function iRe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=Ut.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:p,depth:g=null,since:y=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:_={},prune:k=!1,pruneTags:T=!1,cache:A={}}){try{return ft("fs",e),ft("http",t),ft("gitdir",l),await i5({fs:new An(e),cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:p,depth:g,since:y,exclude:v,relative:x,tags:w,singleBranch:S,headers:_,prune:k,pruneTags:T})}catch(R){throw R.caller="git.fetch",R}}async function aRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oids:r,cache:s={}}){try{return ft("fs",e),ft("gitdir",n),ft("oids",r),await a5({fs:new An(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function QJ({fs:e,filepath:t}){if(await e.exists(Ut.join(t,".git")))return t;{const n=Xy(t);if(n===t)throw new Ps(`git root for ${t}`);return QJ({fs:e,filepath:n})}}async function oRe({fs:e,filepath:t}){try{return ft("fs",e),ft("filepath",t),await QJ({fs:new An(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function lRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),path:r}){try{return ft("fs",e),ft("gitdir",n),ft("path",r),await o1({fs:new An(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function cRe({fs:e,gitdir:t,path:n}){return(await Ki.get({fs:e,gitdir:t})).getall(n)}async function uRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),path:r}){try{return ft("fs",e),ft("gitdir",n),ft("path",r),await cRe({fs:new An(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function dRe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{ft("http",e),ft("url",i);const c=await xA.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const p=d.split("/"),g=p.pop();let y=u;for(const v of p)y[v]=y[v]||{},y=y[v];y[g]=h}for(const[d,h]of c.symrefs){const p=d.split("/"),g=p.pop();let y=u;for(const v of p)y[v]=y[v]||{},y=y[v];y[g]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function eQ(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function fRe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{ft("http",e),ft("url",i);const u=await xA.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[p,g]=h.split("=");g?d[p]=g:d[p]=!0}return{protocolVersion:1,capabilities:d,refs:eQ(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function hRe({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=Kb.wrap({type:e,object:t})),r=await Nf(t)),{oid:r,object:t}}async function pRe({object:e}){try{ft("object",e),typeof e=="string"?e=un.from(e,"utf8"):e=un.from(e);const t="blob",{oid:n,object:r}=await hRe({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function mRe({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=Ut.join(r,i);const a=await e.read(i),o=c=>ni({fs:e,cache:t,gitdir:s,oid:c}),l=await Jy.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function gRe({fs:e,onProgress:t,dir:n,gitdir:r=Ut.join(n,".git"),filepath:s,cache:i={}}){try{return ft("fs",e),ft("dir",n),ft("gitdir",n),ft("filepath",s),await mRe({fs:new An(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function yRe({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:Ut.join(n,".git"),defaultBranch:s="master"}){try{return ft("fs",e),ft("gitdir",r),t||ft("dir",n),await ZJ({fs:new An(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function tQ({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await l1.read({fs:e,gitdir:n});if(!r)throw new sl("oid");if(!s)throw new sl("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new PS(i);const u=o.shift(),{type:d,object:h}=await ni({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new $o(u,d,"commit");const p=ti.from(h).parse();for(const g of p.parent)if(g===s)return!0;if(!a.has(u))for(const g of p.parent)l.has(g)||(o.push(g),l.add(g))}return!1}async function bRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return ft("fs",e),ft("gitdir",n),ft("oid",r),ft("ancestor",s),await tQ({fs:new An(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function vRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r}){try{return ft("fs",e),ft("dir",t),ft("gitdir",n),ft("filepath",r),Jb.isIgnored({fs:new An(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function xRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),remote:r}){try{return ft("fs",e),ft("gitdir",n),Zt.listBranches({fs:new An(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function wRe({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Zt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await nQ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return Ca.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function nQ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await Qb({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await nQ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:Ut.join(i,o.path)}):s.push(Ut.join(i,o.path))}async function SRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r,cache:s={}}){try{return ft("fs",e),ft("gitdir",n),await wRe({fs:new An(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function _Re({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Zt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof Ps)return[]}return(await Qb({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function CRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return ft("fs",e),ft("gitdir",n),ft("ref",r),await _Re({fs:new An(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function kRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r}){try{return ft("fs",e),ft("gitdir",n),Zt.listRefs({fs:new An(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function ERe({fs:e,gitdir:t}){const n=await Ki.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function TRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git")}){try{return ft("fs",e),ft("gitdir",n),await ERe({fs:new An(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function ARe(e){const t=Ei.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function NRe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(Ei.encode(`command=ls-refs
`)),r.push(Ei.encode(`agent=${wA.agent}
`)),(n||t||e)&&r.push(Ei.delim()),n&&r.push(Ei.encode("peel")),t&&r.push(Ei.encode("symrefs")),e&&r.push(Ei.encode(`ref-prefix ${e}`)),r.push(Ei.flush()),r}async function RRe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{ft("http",e),ft("url",i);const h=await fE.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return eQ(h,c,u,d);const p=await NRe({prefix:c,symrefs:u,peelTags:d}),g=await fE.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:p});return ARe(g.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function IRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git")}){try{return ft("fs",e),ft("gitdir",n),Zt.listTags({fs:new An(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function MRe(e,t){return e.committer.timestamp-t.committer.timestamp}const jRe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function NU({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===jRe)return;const i=r;let a;const o=await tb({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await rQ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function rQ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=Ut.join(o,c.path),a.push(u)):c.type==="tree"&&(u=ni({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return rQ({fs:e,cache:t,gitdir:n,tree:ol.from(d),fileId:s,oid:i,filepaths:a,parentPath:Ut.join(o,c.path)})})),u});return await Promise.all(l),a}async function PRe({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await l1.read({fs:e,gitdir:n}),h=await Zt.resolve({fs:e,gitdir:n,ref:s}),p=[await rb({fs:e,cache:t,gitdir:n,oid:h})];let g,y,v;function x(w){v&&r&&u.push(w)}for(;p.length>0;){const w=p.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let S;try{S=await US({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),y&&g!==S&&u.push(y),g=S,y=w,v=!0}catch(_){if(_ instanceof Ps){let k=l&&g;if(k&&(k=await NU({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:g}),k))if(Array.isArray(k)){if(y){const T=await NU({fs:e,cache:t,gitdir:n,oid:y.commit.tree,fileId:g});if(Array.isArray(T))if(k=k.filter(A=>T.indexOf(A)===-1),k.length===1)k=k[0],r=k,y&&u.push(y);else{k=!1,y&&u.push(y);break}}}else r=k,y&&u.push(y);if(!k){if(v&&g&&(u.push(y),!o))break;if(!o&&!l)throw _}y=w,v=!1}else throw _}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const S of w.commit.parent){const _=await rb({fs:e,cache:t,gitdir:n,oid:S});p.map(k=>k.oid).includes(_.oid)||p.push(_)}p.length===0&&x(w),p.sort((S,_)=>MRe(S.commit,_.commit))}return u}async function ORe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return ft("fs",e),ft("gitdir",n),ft("ref",s),await PRe({fs:new An(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function DRe({fs:e,onSign:t,dir:n,gitdir:r=Ut.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:p,signingKey:g,cache:y={},mergeDriver:v}){try{ft("fs",e),g&&ft("onSign",t);const x=new An(e),w=await up({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new oo("author");const S=await nb({fs:x,gitdir:r,author:w,committer:p});if(!S&&(!o||!a))throw new oo("committer");return await XJ({fs:x,cache:y,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:S,signingKey:g,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const FRe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function sQ({fs:e,cache:t,dir:n,gitdir:r=Ut.join(n,".git"),oids:s}){const i=new wJ,a=[];function o(u,d){const h=un.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=FRe[u];let p=d.length,g=p>15?128:0;const y=p&15;p=p>>>4;let v=(g|h|y).toString(16);for(o(v,"hex");g;)g=p>127?128:0,v=g|p&127,o(v4(2,v),"hex"),p=p>>>7;o(un.from(await FJ(d)))}o("PACK"),o("00000002","hex"),o(v4(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await ni({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function LRe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await sQ({fs:e,cache:t,gitdir:n,oids:r}),a=un.from(await dE(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write(Ut.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function $Re({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return ft("fs",e),ft("gitdir",n),ft("oids",r),await LRe({fs:new An(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function BRe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=Ut.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:p=!1,pruneTags:g=!1,fastForward:y=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:S={},author:_,committer:k,signingKey:T,cache:A={}}){try{ft("fs",e),ft("gitdir",l);const R=new An(e),M=await up({fs:R,gitdir:l,author:_});if(!M)throw new oo("author");const j=await nb({fs:R,gitdir:l,author:M,committer:k});if(!j)throw new oo("committer");return await JJ({fs:R,cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:y,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:S,author:M,committer:j,signingKey:T,prune:p,pruneTags:g})}catch(R){throw R.caller="git.pull",R}}async function zRe({fs:e,cache:t,dir:n,gitdir:r=Ut.join(n,".git"),start:s,finish:i}){const a=await l1.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Zt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Zt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:p}=await ni({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const y=ko.from(p).headers().object;return u(y)}if(h!=="commit")throw new $o(d,h,"commit");if(!a.has(d)){const y=ti.from(p).headers().parent;for(d of y)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function Fj({fs:e,cache:t,dir:n,gitdir:r=Ut.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await ni({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=ko.from(c).headers().object;await a(d)}else if(l==="commit"){const d=ti.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=ol.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function URe(e){const t={};let n="";const r=Ei.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new Pg('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function qRe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(Ei.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(Ei.flush()),n}async function VRe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:p,force:g=!1,delete:y=!1,corsProxy:v,headers:x={}}){const w=u||await Ip({fs:e,gitdir:c});if(typeof w>"u")throw new sl("ref");const S=await Ki.get({fs:e,gitdir:c});h=h||await S.get(`branch.${w}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${w}.remote`)||"origin";const _=p||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof _>"u")throw new sl("remote OR url");const k=d||await S.get(`branch.${w}.merge`);if(typeof _>"u")throw new sl("remoteRef");v===void 0&&(v=await S.get("http.corsProxy"));const T=await Zt.expand({fs:e,gitdir:c,ref:w}),A=y?"0000000000000000000000000000000000000000":await Zt.resolve({fs:e,gitdir:c,ref:T}),R=xA.getRemoteHelperFor({url:_}),M=await R.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:_,headers:x,protocolVersion:1}),j=M.auth;let F;if(!k)F=T;else try{F=await Zt.expandAgainstMap({ref:k,map:M.refs})}catch(Z){if(Z instanceof Ps)F=k.startsWith("refs/")?k:`refs/heads/${k}`;else throw Z}const P=M.refs.get(F)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:_,localRef:{ref:y?"(delete)":T,oid:A},remoteRef:{ref:F,oid:P}}))throw new Xb;const q=!M.capabilities.has("no-thin");let I=new Set;if(!y){const Z=[...M.refs.values()];let ne=new Set;if(P!=="0000000000000000000000000000000000000000"){const ae=await a5({fs:e,cache:t,gitdir:c,oids:[A,P]});for(const le of ae)Z.push(le);q&&(ne=await Fj({fs:e,cache:t,gitdir:c,oids:ae}))}if(!Z.includes(A)){const ae=await zRe({fs:e,cache:t,gitdir:c,start:[A],finish:Z});I=await Fj({fs:e,cache:t,gitdir:c,oids:ae})}if(q){try{const ae=await Zt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:le}=await Zt.resolveAgainstMap({ref:ae.replace(`refs/remotes/${h}/`,""),fullref:ae,map:M.refs}),Se=[le];for(const Ee of await Fj({fs:e,cache:t,gitdir:c,oids:Se}))ne.add(Ee)}catch{}for(const ae of ne)I.delete(ae)}if(A===P&&(g=!0),!g){if(T.startsWith("refs/tags")&&P!=="0000000000000000000000000000000000000000")throw new eb("tag-exists");if(A!=="0000000000000000000000000000000000000000"&&P!=="0000000000000000000000000000000000000000"&&!await tQ({fs:e,cache:t,gitdir:c,oid:A,ancestor:P,depth:-1}))throw new eb("not-fast-forward")}}const V=GJ([...M.capabilities],["report-status","side-band-64k",`agent=${wA.agent}`]),D=await qRe({capabilities:V,triplets:[{oldoid:P,oid:A,fullRef:F}]}),z=y?[]:await sQ({fs:e,cache:t,gitdir:c,oids:[...I]}),$=await R.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:_,auth:j,headers:x,body:[...D,...z]}),{packfile:Y,progress:B}=await YJ.demux($.body);if(s){const Z=KJ(B);VS(Z,async ne=>{await s(ne)})}const G=await URe(Y);if($.headers&&(G.headers=$.headers),h&&G.ok&&G.refs[F].ok&&!T.startsWith("refs/tags")){const Z=`refs/remotes/${h}/${F.replace("refs/heads","")}`;y?await Zt.deleteRef({fs:e,gitdir:c,ref:Z}):await Zt.writeRef({fs:e,gitdir:c,ref:Z,value:A})}if(G.ok&&Object.values(G.refs).every(Z=>Z.ok))return G;{const Z=Object.entries(G.refs).filter(([ne,ae])=>!ae.ok).map(([ne,ae])=>`
  - ${ne}: ${ae.error}`).join("");throw new jS(Z,G)}}async function WRe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=Ut.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:p,force:g=!1,delete:y=!1,corsProxy:v,headers:x={},cache:w={}}){try{return ft("fs",e),ft("http",t),ft("gitdir",c),await VRe({fs:new An(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:p,force:g,delete:y,corsProxy:v,headers:x})}catch(S){throw S.caller="git.push",S}}async function iQ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await ni({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=ko.from(i).parse().object,iQ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new $o(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function aQ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await US({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await iQ({fs:e,cache:t,gitdir:n,oid:r})}async function HRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return ft("fs",e),ft("gitdir",n),ft("oid",r),await aQ({fs:new An(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function oQ({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,cache:s={}}){try{return ft("fs",e),ft("gitdir",n),ft("oid",r),await rb({fs:new An(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function GRe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Zt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await aQ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function KRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return ft("fs",e),ft("gitdir",n),ft("ref",r),ft("oid",s),await GRe({fs:new An(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function YRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{ft("fs",e),ft("gitdir",n),ft("oid",r);const l=new An(e);i!==void 0&&(r=await US({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await ni({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=ti.from(u.object).parse();break;case"tree":u.object=ol.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=ko.from(u.object).parse();break;default:throw new $o(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function ZRe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await ni({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new $o(r,s,"tag");const a=ko.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function XRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,cache:s={}}){try{return ft("fs",e),ft("gitdir",n),ft("oid",r),await ZRe({fs:new An(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function JRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return ft("fs",e),ft("gitdir",n),ft("oid",r),await Qb({fs:new An(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function QRe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r,cache:s={}}){try{ft("fs",e),ft("gitdir",n),ft("filepath",r),await Ca.acquire({fs:new An(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function eIe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Zt.resolve({gitdir:r,fs:e,ref:s})}catch(g){if(!(g instanceof Ps))throw g}let d=(await Qb({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(g=>g.path!==i);const h=await qS({fs:e,gitdir:r,tree:d});return await vA({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function tIe({fs:e,onSign:t,dir:n,gitdir:r=Ut.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{ft("fs",e),ft("gitdir",r),ft("oid",i);const u=new An(e),d=await up({fs:u,gitdir:r,author:a});if(!d)throw new oo("author");const h=await nb({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new oo("committer");return await eIe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function nIe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==Vu.clean(r))throw new iu(r,Vu.clean(r));if(n!==Vu.clean(n))throw new iu(n,Vu.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Zt.exists({fs:e,gitdir:t,ref:a}))throw new cu("branch",r,!1);const l=await Zt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Zt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Zt.deleteRef({fs:e,gitdir:t,ref:i});const u=await Ip({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Zt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function rIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return ft("fs",e),ft("gitdir",n),ft("ref",r),ft("oldref",s),await nIe({fs:new An(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function lQ({gitdir:e,type:t,object:n}){return Nf(Kb.wrap({type:t,object:n}))}async function sIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{ft("fs",e),ft("gitdir",n),ft("filepath",r);const a=new An(e);let o,l;try{o=await Zt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await US({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read(Ut.join(t,r));u&&(l=await lQ({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat(Ut.join(t,r)))),await Ca.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function iIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r,depth:s}){try{return ft("fs",e),ft("gitdir",n),ft("ref",r),await Zt.resolve({fs:new An(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function aIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),path:r,value:s,append:i=!1}){try{ft("fs",e),ft("gitdir",n),ft("path",r);const a=new An(e),o=await Ki.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await Ki.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function cQ({fs:e,gitdir:t,commit:n}){const r=ti.from(n).toObject();return await dl({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class hE{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=hE.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const oIe={stage:Gb,workdir:zS};let Lj;async function sb(e,t){return Lj===void 0&&(Lj=new a1),Lj.acquire(e,t)}async function lIe(e,t,n,r,s=null){const i=Ut.join(n,r),a=await e.lstat(i);if(!a)throw new Ps(i);if(a.isDirectory())throw new kr(`${i}: file expected, but found directory`);const o=s?await MJ({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await sb({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(LJ):await e.read(i);if(c===null)throw new Ps(i);l=await dl({fs:e,gitdir:t,type:"blob",object:c})}),l}async function cIe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await qS({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await lIe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function RU({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(p=>typeof p=="string"?oIe[p]():p),a=[],u=await cp({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(p,[g,y])=>{if(!(p==="."||await Jb.isIgnored({fs:e,dir:t,gitdir:n,filepath:p}))&&y)return(!g||await g.oid()!==await y.oid()&&await y.oid()!==void 0)&&a.push([g,y]),{mode:await y.mode(),path:p,oid:await y.oid(),type:await y.type()}},reduce:async(p,g)=>(g=g.filter(Boolean),p?(p.children=g,p):g.length>0?g:void 0),iterate:async(p,g)=>{const y=[];for(const v of g){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?y.push(v):a.push([null,w])):x&&(w?y.push(v):a.push([x,null]))}return y.length?Promise.all(y.map(p)):[]}});if(a.length===0||u.length===0)return null;const h=(await cIe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(p=>({mode:p.mode,path:p.path,oid:p.oid,type:p.type}));return qS({fs:e,gitdir:n,tree:h})}async function uIe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await cp({fs:e,cache:{},dir:t,gitdir:n,trees:[lc({ref:s}),lc({ref:r})],map:async(c,[u,d])=>{if(c==="."||await Jb.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const g=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:g,filepath:c}}const p=await d.oid();if(!u||await u.oid()!==p)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:p,stats:await e.lstat(Ut.join(t,c))}),{method:"write",filepath:c,oid:p})}});await sb({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=Ut.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await ni({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await Ca.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class bf{constructor({fs:t,dir:n,gitdir:r=Ut.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return Ut.join(this.gitdir,bf.refStash)}get refLogsStashPath(){return Ut.join(this.gitdir,bf.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await up({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new oo("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return cQ({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new iu(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?rb({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Zt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:bf.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=hE.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await sb({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return hE.getStashReflogEntry(r,t)}}async function dIe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new bf({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await Ip({fs:e,gitdir:n,fullname:!1}),a=await Zt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await oQ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=lc({ref:"HEAD"});const h=await RU({fs:e,dir:t,gitdir:n,treePair:[lc({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=Gb()}const p=await RU({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(p){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:p,parent:[c[c.length-1]]});c.push(v),u=p}if(!u||!h&&!p)throw new Ps("changes, nothing to stash");const g=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,y=await s.writeStashCommit({message:g,tree:u,parent:c});return await s.writeStashRef(y),await s.writeStashReflogEntry({stashCommit:y,message:g}),await WJ({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),y}async function uQ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new bf({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await rb({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await uIe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function dQ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new bf({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await sb(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await sb({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function fIe({fs:e,dir:t,gitdir:n}){return new bf({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function hIe({fs:e,dir:t,gitdir:n}){const r=new bf({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await sb(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function pIe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await uQ({fs:e,dir:t,gitdir:n,refIdx:r}),await dQ({fs:e,dir:t,gitdir:n,refIdx:r})}async function mIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){ft("fs",e),ft("dir",t),ft("gitdir",n),ft("op",r);const a={push:dIe,apply:uQ,drop:dQ,list:fIe,clear:hIe,pop:pIe},o=["apply","drop","pop"];try{const l=new An(e);["refs","logs","logs/refs"].map(d=>Ut.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new iu(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function gIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),filepath:r,cache:s={}}){try{ft("fs",e),ft("gitdir",n),ft("filepath",r);const i=new An(e);if(await Jb.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await yIe({fs:i,cache:s,gitdir:n}),l=await fQ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await Ca.acquire({fs:i,gitdir:n,cache:s},async function(y){for(const v of y)if(v.path===r)return v;return null}),u=await i.lstat(Ut.join(t,r)),d=l!==null,h=c!==null,p=u!==null,g=async()=>{if(h&&!iE(c,u))return c.oid;{const y=await i.read(Ut.join(t,r)),v=await lQ({gitdir:n,type:"blob",object:y});return h&&c.oid===v&&u.size!==-1&&Ca.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!p&&!h)return"absent";if(!d&&!p&&h)return"*absent";if(!d&&p&&!h)return"*added";if(!d&&p&&h)return await g()===c.oid?"added":"*added";if(d&&!p&&!h)return"deleted";if(d&&!p&&h)return l===c.oid,"*deleted";if(d&&p&&!h)return await g()===l?"*undeleted":"*undeletemodified";if(d&&p&&h){const y=await g();return y===l?y===c.oid?"unmodified":"*unmodified":y===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function fQ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await ni({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=ol.from(l);return fQ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new $o(a.oid,o,"blob",s.join("/"))}return null}async function yIe({fs:e,cache:t,gitdir:n}){let r;try{r=await Zt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof Ps)return[]}const{tree:s}=await Qb({fs:e,cache:t,gitdir:n,oid:r});return s}async function bIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{ft("fs",e),ft("gitdir",n),ft("ref",r);const l=new An(e);return await cp({fs:l,cache:a,dir:t,gitdir:n,trees:[lc({ref:r}),zS(),Gb()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await Jb.isIgnored({fs:l,dir:t,filepath:c})||!s.some(T=>VJ(c,T)))return null;if(i&&!i(c))return;const[p,g,y]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[p,g,y].includes("blob");if((p==="tree"||p==="special")&&!v)return;if(p==="commit")return null;if((g==="tree"||g==="special")&&!v)return;if(y==="commit")return null;if((y==="tree"||y==="special")&&!v)return;const x=p==="blob"?await u.oid():void 0,w=y==="blob"?await h.oid():void 0;let S;p!=="blob"&&g==="blob"&&y!=="blob"?S="42":g==="blob"&&(S=await d.oid());const _=[void 0,x,S,w],k=_.map(T=>_.indexOf(T));return k.shift(),[c,...k]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function vIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r,object:s,force:i=!1}){try{ft("fs",e),ft("gitdir",n),ft("ref",r);const a=new An(e);if(r===void 0)throw new sl("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Zt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Zt.exists({fs:a,gitdir:n,ref:r}))throw new cu("tag",r);await Zt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function xIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{ft("fs",e),ft("gitdir",n),ft("filepath",s);const u=new An(e);if(l)return await Ca.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const p=await u.lstat(Ut.join(t,s));if(p){if(p.isDirectory())throw new lp("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat(Ut.join(t,s)),!d)throw new Ps(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new lp("directory")}return await Ca.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new Ps(`file at "${s}" in index and "add" not set`);let p;if(i)p={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{p=d;const g=p.isSymbolicLink()?await u.readlink(Ut.join(t,s)):await u.read(Ut.join(t,s));i=await dl({fs:u,gitdir:n,type:"blob",format:"content",object:g})}return h.insert({filepath:s,oid:i,stats:p}),i})}catch(u){throw u.caller="git.updateIndex",u}}function wIe(){try{return wA.version}catch(e){throw e.caller="git.version",e}}async function SIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return ft("fs",e),ft("gitdir",n),ft("trees",r),await cp({fs:new An(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function _Ie({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),blob:r}){try{return ft("fs",e),ft("gitdir",n),ft("blob",r),await dl({fs:new An(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function CIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),commit:r}){try{return ft("fs",e),ft("gitdir",n),ft("commit",r),await cQ({fs:new An(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function kIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new An(e);if(i==="parsed"){switch(r){case"commit":s=ti.from(s).toObject();break;case"tree":s=ol.from(s).toObject();break;case"blob":s=un.from(s,o);break;case"tag":s=ko.from(s).toObject();break;default:throw new $o(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await dl({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function EIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{ft("fs",e),ft("gitdir",n),ft("ref",r),ft("value",s);const o=new An(e);if(r!==Vu.clean(r))throw new iu(r,Vu.clean(r));if(!i&&await Zt.exists({fs:o,gitdir:n,ref:r}))throw new cu("ref",r);a?await Zt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Zt.resolve({fs:o,gitdir:n,ref:s}),await Zt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function TIe({fs:e,gitdir:t,tag:n}){const r=ko.from(n).toObject();return await dl({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function AIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),tag:r}){try{return ft("fs",e),ft("gitdir",n),ft("tag",r),await TIe({fs:new An(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function NIe({fs:e,dir:t,gitdir:n=Ut.join(t,".git"),tree:r}){try{return ft("fs",e),ft("gitdir",n),ft("tree",r),await qS({fs:new An(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var ra={Errors:rNe,STAGE:Gb,TREE:lc,WORKDIR:zS,add:wNe,abortMerge:yNe,addNote:_Ne,addRemote:CNe,annotatedTag:ENe,branch:ANe,checkout:WJ,clone:BNe,commit:zNe,getConfig:lRe,getConfigAll:uRe,setConfig:aIe,currentBranch:UNe,deleteBranch:VNe,deleteRef:WNe,deleteRemote:GNe,deleteTag:YNe,expandOid:QNe,expandRef:eRe,fastForward:sRe,fetch:iRe,findMergeBase:aRe,findRoot:oRe,getRemoteInfo:dRe,getRemoteInfo2:fRe,hashBlob:pRe,indexPack:gRe,init:yRe,isDescendent:bRe,isIgnored:vRe,listBranches:xRe,listFiles:SRe,listNotes:CRe,listRefs:kRe,listRemotes:TRe,listServerRefs:RRe,listTags:IRe,log:ORe,merge:DRe,packObjects:$Re,pull:BRe,push:WRe,readBlob:HRe,readCommit:oQ,readNote:KRe,readObject:YRe,readTag:XRe,readTree:JRe,remove:QRe,removeNote:tIe,renameBranch:rIe,resetIndex:sIe,updateIndex:xIe,resolveRef:iIe,status:gIe,statusMatrix:bIe,tag:vIe,version:wIe,walk:SIe,writeBlob:_Ie,writeCommit:CIe,writeObject:kIe,writeRef:EIe,writeTag:AIe,writeTree:NIe,stash:mIe};function RIe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function IIe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:RIe(e)}async function MIe(e,t){const n=IIe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function jIe(e){let t=0;const n=[];await MIe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function PIe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function OIe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await jIe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?PIe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var c1={request:OIe};const u1="https://cors.isomorphic-git.org",ib=new Map,hQ=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=gr.getState();if(!n||!r)return ke.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await ra.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await ra.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await ra.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await ra.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),ke.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},d1=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=ib.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return ke.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(ib.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(ke.error("Authentication cancelled: Password/token not provided."),null)},f1=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),ib.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),ib.delete(n)),null},h1=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!ib.has(n)&&t.username&&t.password&&(ib.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},by=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},DIe=async(e,t)=>{const n=ka,r=Hr(e),s=cd(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},pQ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??ka,a=Hr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(cd(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=gA(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await ra.getRemoteInfo({http:c1,url:t,corsProxy:u1,onAuth:p=>d1(p,r),onAuthFailure:f1,onAuthSuccess:h1})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${by(h)}`)}await ra.clone({fs:i,http:c1,dir:a,corsProxy:u1,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>d1(h,r),onAuthFailure:f1,onAuthSuccess:h1,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(cd(a,".git"));const d=await ra.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await ra.checkout({fs:i,dir:a,ref:u})),ke.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=by(l);if(l instanceof Error&&l.message.includes("already cloned")||ke.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},mQ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ka,r=Hr(e);try{await ra.init({fs:n,dir:r}),ke.success(`Initialized empty Git repository in "${Ai(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),ke.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},o5=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ka,s=Hr(e);try{if(!await hQ(s,r))throw new Error("Git user configuration is missing or invalid.");if(await ra.add({fs:r,dir:s,filepath:"."}),!(await ra.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){ke.info("No changes detected to commit.");return}const l=await ra.commit({fs:r,dir:s,message:t,author:{name:gr.getState().gitUserName,email:gr.getState().gitUserEmail}});ke.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),ke.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},SA=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??ka,i=Hr(e);try{if(!await hQ(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await ra.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await ra.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await ra.fetch({fs:s,http:c1,dir:i,corsProxy:u1,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>d1(c,n),onAuthFailure:f1,onAuthSuccess:h1}),await ra.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${by(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${by(l)}`)}}await ra.pull({fs:s,http:c1,dir:i,ref:t,singleBranch:!0,author:{name:gr.getState().gitUserName,email:gr.getState().gitUserEmail},corsProxy:u1,onAuth:l=>d1(l,n),onAuthFailure:f1,onAuthSuccess:h1}),ke.success(`Pulled changes successfully for "${Ai(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?ke.info(`Branch "${t}" is already up-to-date.`):ke.error(`Git pull failed: ${by(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},l5=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??ka,i=Hr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await ra.push({fs:s,http:c1,dir:i,corsProxy:u1,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>d1(c,n),onAuthFailure:f1,onAuthSuccess:h1});if(l!=null&&l.ok)ke.success(`Pushed changes successfully for "${Ai(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))ke.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(ke.error(`Push rejected for "${Ai(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||ke.error(`Git push failed: ${by(l)}`),l}},gQ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ka,r=Hr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await ra.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);ke.info(`Git Status for "${Ai(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),ke.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},og=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ka,r=Hr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),ke.error(`Error creating directory "${Ai(r)}": ${s instanceof Error?s.message:String(s)}`),s}},FIe=async e=>{try{const t={backend:BTe,name:`litechat_vfs_${e}`};return await MTe(t),ka}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),ke.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},c5=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ka,r=Hr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await og(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=cd(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),ke.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},Mp=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ka,r=Hr(e);try{const s=await n.promises.readFile(r);return Ae.emit(hn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),ke.error(`Error reading file "${Ai(r)}": ${s instanceof Error?s.message:String(s)}`),s}},_A=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ka,s=Hr(e),i=gA(s);try{i!=="/"&&await og(i,{fsInstance:r}),await r.promises.writeFile(s,t),Ae.emit(hn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),ke.error(`Error writing file "${Ai(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},u5=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??ka,s=Hr(e);if(s==="/")throw ke.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Ae.emit(hn.fileDeleted,{path:s})):(await r.promises.unlink(s),Ae.emit(hn.fileDeleted,{path:s})),ke.success(`"${Ai(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),ke.error(`Error deleting "${Ai(s)}": ${i instanceof Error?i.message:String(i)}`),i}},yQ=async(e,t)=>{await og(e,t)},LIe=async(e,t,n)=>{try{const r=await Mp(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=Hr(e);a.download=t||Ai(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||ke.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},bQ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ka,s=Hr(t);let i=0,a=0;const o=Array.from(e);try{await og(s,{fsInstance:r});for(const l of o){const c=cd(s,l.name);try{const u=await l.arrayBuffer();await _A(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?ke.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&ke.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":Ai(s)}.`)}},$Ie=async(e,t,n)=>{const r=ka;if(!e.name.toLowerCase().endsWith(".zip")){ke.error("Please select a valid ZIP file.");return}const s=Hr(t);let i;try{await og(s,{fsInstance:r}),i=await JF.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=cd(s,d.name);if(d.dir)await og(h,{fsInstance:r});else{const p=await d.async("uint8array");await _A(h,p,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?ke.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):ke.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":Ai(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),ke.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},IU=async(e,t="/",n)=>{const r=ka,s=new JF,i=Hr(t),a=Ai(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){ke.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?ke.error(`Cannot export: Path "${a}" not found.`):ke.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,p)=>{const g=await c5(h,{fsInstance:r});for(const y of g)if(y.isDirectory){if(y.name===".git")continue;const v=p.folder(y.name);if(v)await o(y.path,v);else throw new Error(`Failed to create subfolder ${y.name} in zip.`)}else{const v=await Mp(y.path,{fsInstance:r});p.file(y.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),ke.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||ke.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},vQ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ka,s=Hr(e),i=Hr(t);if(s==="/"||i==="/")throw ke.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=gA(i);a!=="/"&&await og(a,{fsInstance:r}),await r.promises.rename(s,i),ke.success(`Renamed "${Ai(s)}" to "${Ai(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||ke.error(`Rename failed: Original item "${Ai(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?ke.error(`Rename failed: An item named "${Ai(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||ke.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},BIe=1024*5,zIe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},MU=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},xQ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!0),p=e.type||"application/octet-stream",g=qw(e.name,p),y=p.startsWith("image/"),v=p.startsWith("audio/"),x=p.startsWith("video/"),w=e.source==="vfs";E.useEffect(()=>{let M=null;return a(null),e.source==="direct"&&!g&&e.contentBase64?(M=zIe(e.contentBase64,p),M||a("Failed to decode file content for preview."),s(M)):s(null),e.source==="direct"&&g&&e.contentText&&e.contentText.length>BIe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&g&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{M&&(URL.revokeObjectURL(M),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,p,g]);const S=async()=>{if(e.source==="vfs"){ke.info("File is already in VFS.");return}const M=MU(e);if(!M){ke.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await bQ([M],"/"),ke.success(`"${e.name}" added to VFS root.`)}catch(j){console.error("Failed to add file to VFS:",j),ke.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},_=async()=>{u(!0);try{let M;if(e.source==="vfs"&&e.path){const P=await Mp(e.path);M=new Blob([P],{type:p})}else{const P=MU(e);if(!P)throw new Error("Could not reconstruct file data.");M=P}const j=URL.createObjectURL(M),F=document.createElement("a");F.href=j,F.download=e.name,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(j)}catch(M){console.error("Failed to download file:",M),ke.error(`Download failed: ${M instanceof Error?M.message:String(M)}`)}finally{u(!1)}},k=()=>h(M=>!M),T=()=>w?f.jsx(MD,{className:"h-5 w-5 text-cyan-500"}):g?f.jsx(jP,{className:"h-5 w-5 text-blue-500"}):y?f.jsx(sd,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(Sve,{className:"h-5 w-5 text-green-500"}):x?f.jsx(yxe,{className:"h-5 w-5 text-orange-500"}):f.jsx(Mbe,{className:"h-5 w-5 text-muted-foreground"}),A=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(No,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):g&&e.contentText!==void 0?f.jsx(Bb,{lang:p==="text/markdown"?"markdown":"text",code:e.contentText,filepath:e.name}):y&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),R=E.useMemo(()=>{let M="File";return w?M="VFS File":g?M="Text":y?M="Image":v?M="Audio":x&&(M="Video"),`${M} (${i1(e.size)})`},[w,g,y,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[T(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",i1(e.size),")"]}),w&&e.path&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Nr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:_,disabled:c,"aria-label":"Download file",children:c?f.jsx(Yn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(cc,{className:"h-3.5 w-3.5"})})}),f.jsx(Nr,{children:"Download File"})]})}),f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:k,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(RT,{className:"h-3.5 w-3.5"})})}),f.jsx(Nr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Yn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(ND,{className:"h-3.5 w-3.5"})})}),f.jsx(Nr,{children:"Add to VFS"})]})}),f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(Ri,{className:"h-3.5 w-3.5"})})}),f.jsx(Nr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:k,children:R}):f.jsx("div",{className:Ye("p-2 max-h-80 overflow-y-auto"),children:A()})]})},wQ=6048e5,UIe=864e5,SQ=6e4,_Q=36e5,KC=43200,jU=1440,PU=Symbol.for("constructDateFrom");function Ii(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&PU in e?e[PU](t):e instanceof Date?new e.constructor(t):new Date(t)}function Kr(e,t){return Ii(t||e,e)}function CQ(e,t,n){const r=Kr(e,n==null?void 0:n.in);return isNaN(t)?Ii(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function kQ(e,t,n){const r=Kr(e,n==null?void 0:n.in);if(isNaN(t))return Ii(e,NaN);if(!t)return r;const s=r.getDate(),i=Ii(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let qIe={};function ev(){return qIe}function ab(e,t){var o,l,c,u;const n=ev(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Kr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function p1(e,t){return ab(e,{...t,weekStartsOn:1})}function EQ(e,t){const n=Kr(e,t==null?void 0:t.in),r=n.getFullYear(),s=Ii(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=p1(s),a=Ii(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=p1(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function pE(e){const t=Kr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function jp(e,...t){const n=Ii.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function m1(e,t){const n=Kr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function TQ(e,t,n){const[r,s]=jp(n==null?void 0:n.in,e,t),i=m1(r),a=m1(s),o=+i-pE(i),l=+a-pE(a);return Math.round((o-l)/UIe)}function VIe(e,t){const n=EQ(e,t),r=Ii(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),p1(r)}function WIe(e,t,n){return CQ(e,t*7,n)}function HIe(e,t,n){return kQ(e,t*12,n)}function GIe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=Ii.bind(null,s));const i=Kr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),Ii(r,n||NaN)}function KIe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=Ii.bind(null,s));const i=Kr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),Ii(r,n||NaN)}function H2(e,t){const n=+Kr(e)-+Kr(t);return n<0?-1:n>0?1:n}function YIe(e){return Ii(e,Date.now())}function ZIe(e,t,n){const[r,s]=jp(n==null?void 0:n.in,e,t);return+m1(r)==+m1(s)}function AQ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function XIe(e){return!(!AQ(e)&&typeof e!="number"||isNaN(+Kr(e)))}function NQ(e,t,n){const[r,s]=jp(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function JIe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function QIe(e,t){return+Kr(e)-+Kr(t)}function eMe(e,t){const n=Kr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function RQ(e,t){const n=Kr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function tMe(e,t){const n=Kr(e,t==null?void 0:t.in);return+eMe(n,t)==+RQ(n,t)}function nMe(e,t,n){const[r,s,i]=jp(n==null?void 0:n.in,e,e,t),a=H2(s,i),o=Math.abs(NQ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=H2(s,i)===-a;tMe(r)&&o===1&&H2(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function rMe(e,t,n){const r=QIe(e,t)/1e3;return JIe(n==null?void 0:n.roundingMethod)(r)}function sMe(e,t){const[n,r]=jp(e,t.start,t.end);return{start:n,end:r}}function iMe(e,t){const{start:n,end:r}=sMe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(Ii(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function aMe(e,t){const n=Kr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function oMe(e,t){const n=Kr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function IQ(e,t){const n=Kr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function MQ(e,t){var o,l,c,u;const n=ev(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Kr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function lMe(e,t){return MQ(e,{...t,weekStartsOn:1})}const cMe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},uMe=(e,t,n)=>{let r;const s=cMe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function $j(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const dMe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fMe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},hMe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pMe={date:$j({formats:dMe,defaultWidth:"full"}),time:$j({formats:fMe,defaultWidth:"full"}),dateTime:$j({formats:hMe,defaultWidth:"full"})},mMe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},gMe=(e,t,n,r)=>mMe[e];function Cx(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const yMe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bMe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vMe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},xMe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wMe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},SMe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_Me=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},CMe={ordinalNumber:_Me,era:Cx({values:yMe,defaultWidth:"wide"}),quarter:Cx({values:bMe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Cx({values:vMe,defaultWidth:"wide"}),day:Cx({values:xMe,defaultWidth:"wide"}),dayPeriod:Cx({values:wMe,defaultWidth:"wide",formattingValues:SMe,defaultFormattingWidth:"wide"})};function kx(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?EMe(o,d=>d.test(a)):kMe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function kMe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function EMe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function TMe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const AMe=/^(\d+)(th|st|nd|rd)?/i,NMe=/\d+/i,RMe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},IMe={any:[/^b/i,/^(a|c)/i]},MMe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},jMe={any:[/1/i,/2/i,/3/i,/4/i]},PMe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},OMe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DMe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},FMe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},LMe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$Me={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},BMe={ordinalNumber:TMe({matchPattern:AMe,parsePattern:NMe,valueCallback:e=>parseInt(e,10)}),era:kx({matchPatterns:RMe,defaultMatchWidth:"wide",parsePatterns:IMe,defaultParseWidth:"any"}),quarter:kx({matchPatterns:MMe,defaultMatchWidth:"wide",parsePatterns:jMe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:kx({matchPatterns:PMe,defaultMatchWidth:"wide",parsePatterns:OMe,defaultParseWidth:"any"}),day:kx({matchPatterns:DMe,defaultMatchWidth:"wide",parsePatterns:FMe,defaultParseWidth:"any"}),dayPeriod:kx({matchPatterns:LMe,defaultMatchWidth:"any",parsePatterns:$Me,defaultParseWidth:"any"})},CA={code:"en-US",formatDistance:uMe,formatLong:pMe,formatRelative:gMe,localize:CMe,match:BMe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function zMe(e,t){const n=Kr(e,t==null?void 0:t.in);return TQ(n,IQ(n))+1}function jQ(e,t){const n=Kr(e,t==null?void 0:t.in),r=+p1(n)-+VIe(n);return Math.round(r/wQ)+1}function PQ(e,t){var u,d,h,p;const n=Kr(e,t==null?void 0:t.in),r=n.getFullYear(),s=ev(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(h=s.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=Ii((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=ab(a,t),l=Ii((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=ab(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function UMe(e,t){var o,l,c,u;const n=ev(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=PQ(e,t),i=Ii((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),ab(i,t)}function OQ(e,t){const n=Kr(e,t==null?void 0:t.in),r=+ab(n,t)-+UMe(n,t);return Math.round(r/wQ)+1}function Es(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Nh={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Es(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Es(n+1,2)},d(e,t){return Es(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Es(e.getHours()%12||12,t.length)},H(e,t){return Es(e.getHours(),t.length)},m(e,t){return Es(e.getMinutes(),t.length)},s(e,t){return Es(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return Es(s,t.length)}},F0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},OU={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Nh.y(e,t)},Y:function(e,t,n,r){const s=PQ(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return Es(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):Es(i,t.length)},R:function(e,t){const n=EQ(e);return Es(n,t.length)},u:function(e,t){const n=e.getFullYear();return Es(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Es(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Es(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Nh.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Es(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=OQ(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):Es(s,t.length)},I:function(e,t,n){const r=jQ(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Es(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Nh.d(e,t)},D:function(e,t,n){const r=zMe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Es(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Es(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Es(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return Es(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=F0.noon:r===0?s=F0.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=F0.evening:r>=12?s=F0.afternoon:r>=4?s=F0.morning:s=F0.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Nh.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Nh.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Es(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Es(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Nh.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Nh.s(e,t)},S:function(e,t){return Nh.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return FU(r);case"XXXX":case"XX":return _m(r);case"XXXXX":case"XXX":default:return _m(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return FU(r);case"xxxx":case"xx":return _m(r);case"xxxxx":case"xxx":default:return _m(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+DU(r,":");case"OOOO":default:return"GMT"+_m(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+DU(r,":");case"zzzz":default:return"GMT"+_m(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return Es(r,t.length)},T:function(e,t,n){return Es(+e,t.length)}};function DU(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+Es(i,2)}function FU(e,t){return e%60===0?(e>0?"-":"+")+Es(Math.abs(e)/60,2):_m(e,t)}function _m(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Es(Math.trunc(r/60),2),i=Es(r%60,2);return n+s+t+i}const LU=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},DQ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},qMe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return LU(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",LU(r,t)).replace("{{time}}",DQ(s,t))},VMe={p:DQ,P:qMe},WMe=/^D+$/,HMe=/^Y+$/,GMe=["D","DD","YY","YYYY"];function KMe(e){return WMe.test(e)}function YMe(e){return HMe.test(e)}function ZMe(e,t,n){const r=XMe(e,t,n);if(console.warn(r),GMe.includes(e))throw new RangeError(r)}function XMe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JMe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QMe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eje=/^'([^]*?)'?$/,tje=/''/g,nje=/[a-zA-Z]/;function zu(e,t,n){var u,d,h,p,g,y,v,x;const r=ev(),s=(n==null?void 0:n.locale)??r.locale??CA,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((y=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:y.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=Kr(e,n==null?void 0:n.in);if(!XIe(o))throw new RangeError("Invalid time value");let l=t.match(QMe).map(w=>{const S=w[0];if(S==="p"||S==="P"){const _=VMe[S];return _(w,s.formatLong)}return w}).join("").match(JMe).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const S=w[0];if(S==="'")return{isToken:!1,value:rje(w)};if(OU[S])return{isToken:!0,value:w};if(S.match(nje))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const S=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&YMe(S)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&KMe(S))&&ZMe(S,t,String(e));const _=OU[S[0]];return _(o,S,s.localize,c)}).join("")}function rje(e){const t=e.match(eje);return t?t[1].replace(tje,"'"):e}function sje(e,t,n){const r=ev(),s=(n==null?void 0:n.locale)??r.locale??CA,i=2520,a=H2(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=jp(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=rMe(c,l),d=(pE(c)-pE(l))/1e3,h=Math.round((u-d)/60);let p;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<jU){const g=Math.round(h/60);return s.formatDistance("aboutXHours",g,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<KC){const g=Math.round(h/jU);return s.formatDistance("xDays",g,o)}else if(h<KC*2)return p=Math.round(h/KC),s.formatDistance("aboutXMonths",p,o)}if(p=nMe(c,l),p<12){const g=Math.round(h/KC);return s.formatDistance("xMonths",g,o)}else{const g=p%12,y=Math.trunc(p/12);return g<3?s.formatDistance("aboutXYears",y,o):g<9?s.formatDistance("overXYears",y,o):s.formatDistance("almostXYears",y+1,o)}}function FQ(e,t){return sje(e,YIe(e),t)}function ije(e,t){const n=Kr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=Ii(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function aje(e,t){return Kr(e,t==null?void 0:t.in).getMonth()}function oje(e,t){return Kr(e,t==null?void 0:t.in).getFullYear()}function lje(e,t){return+Kr(e)>+Kr(t)}function cje(e,t){return+Kr(e)<+Kr(t)}function uje(e,t,n){const[r,s]=jp(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function dje(e,t,n){const[r,s]=jp(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function fje(e,t){const n=()=>Ii(t==null?void 0:t.in,NaN),s=gje(e);let i;if(s.date){const c=yje(s.date,2);i=bje(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=vje(s.time),isNaN(o)))return n();if(s.timezone){if(l=xje(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=Kr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return Kr(a+o+l,t==null?void 0:t.in)}const YC={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},hje=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,pje=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,mje=/^([+-])(\d{2})(?::?(\d{2}))?$/;function gje(e){const t={},n=e.split(YC.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],YC.timeZoneDelimiter.test(t.date)&&(t.date=e.split(YC.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=YC.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function yje(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function bje(e,t){if(t===null)return new Date(NaN);const n=e.match(hje);if(!n)return new Date(NaN);const r=!!n[4],s=Ex(n[1]),i=Ex(n[2])-1,a=Ex(n[3]),o=Ex(n[4]),l=Ex(n[5])-1;if(r)return kje(t,o,l)?wje(t,o,l):new Date(NaN);{const c=new Date(0);return!_je(t,i,a)||!Cje(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function Ex(e){return e?parseInt(e):1}function vje(e){const t=e.match(pje);if(!t)return NaN;const n=Bj(t[1]),r=Bj(t[2]),s=Bj(t[3]);return Eje(n,r,s)?n*_Q+r*SQ+s*1e3:NaN}function Bj(e){return e&&parseFloat(e.replace(",","."))||0}function xje(e){if(e==="Z")return 0;const t=e.match(mje);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return Tje(r,s)?n*(r*_Q+s*SQ):NaN}function wje(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const Sje=[31,null,31,30,31,30,31,31,30,31,30,31];function LQ(e){return e%400===0||e%4===0&&e%100!==0}function _je(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Sje[t]||(LQ(e)?29:28))}function Cje(e,t){return t>=1&&t<=(LQ(e)?366:365)}function kje(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Eje(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function Tje(e,t){return t>=0&&t<=59}function Aje(e,t,n){const r=Kr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=Ii(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=ije(a);return r.setMonth(t,Math.min(i,o)),r}function Nje(e,t,n){const r=Kr(e,n==null?void 0:n.in);return isNaN(+r)?Ii(e,NaN):(r.setFullYear(t),r)}const Nn=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:a,size:o,onClick:s,disabled:i,className:Ye("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Ye("h-3.5 w-3.5",n)}):t})}),f.jsx(Nr,{side:r,children:f.jsx("p",{children:e})})]})})},$U={};function Rje(e){let t=$U[e];if(t)return t;t=$U[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function ob(e,t){typeof t!="string"&&(t=ob.defaultChars);const n=Rje(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+=""}return s})}ob.defaultChars=";/?:@&=+$,#";ob.componentChars="";const BU={};function Ije(e){let t=BU[e];if(t)return t;t=BU[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function WS(e,t,n){typeof t!="string"&&(n=t,t=WS.defaultChars),typeof n>"u"&&(n=!0);const r=Ije(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}WS.defaultChars=";/?:@&=+$,-_.!~*'()#";WS.componentChars="-_.!~*'()";function d5(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function mE(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const Mje=/^([a-z0-9.+-]+:)/i,jje=/:[0-9]*$/,Pje=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Oje=["<",">",'"',"`"," ","\r",`
`,"	"],Dje=["{","}","|","\\","^","`"].concat(Oje),Fje=["'"].concat(Dje),zU=["%","/","?",";","#"].concat(Fje),UU=["/","?","#"],Lje=255,qU=/^[+a-z0-9A-Z_-]{0,63}$/,$je=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,VU={javascript:!0,"javascript:":!0},WU={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function f5(e,t){if(e&&e instanceof mE)return e;const n=new mE;return n.parse(e,t),n}mE.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=Pje.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=Mje.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&VU[a])&&(i=i.substr(2),this.slashes=!0)),!VU[a]&&(s||a&&!WU[a])){let c=-1;for(let g=0;g<UU.length;g++)r=i.indexOf(UU[g]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let g=0;g<zU.length;g++)r=i.indexOf(zU[g]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const p=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!p){const g=this.hostname.split(/\./);for(let y=0,v=g.length;y<v;y++){const x=g[y];if(x&&!x.match(qU)){let w="";for(let S=0,_=x.length;S<_;S++)x.charCodeAt(S)>127?w+="x":w+=x[S];if(!w.match(qU)){const S=g.slice(0,y),_=g.slice(y+1),k=x.match($je);k&&(S.push(k[1]),_.unshift(k[2])),_.length&&(i=_.join(".")+i),this.hostname=S.join(".");break}}}}this.hostname.length>Lje&&(this.hostname=""),p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),WU[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};mE.prototype.parseHost=function(e){let t=jje.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const Bje=Object.freeze(Object.defineProperty({__proto__:null,decode:ob,encode:WS,format:d5,parse:f5},Symbol.toStringTag,{value:"Module"})),$Q=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,BQ=/[\0-\x1F\x7F-\x9F]/,zje=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,h5=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,zQ=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,UQ=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,Uje=Object.freeze(Object.defineProperty({__proto__:null,Any:$Q,Cc:BQ,Cf:zje,P:h5,S:zQ,Z:UQ},Symbol.toStringTag,{value:"Module"})),qje=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),Vje=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var zj;const Wje=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Hje=(zj=String.fromCodePoint)!==null&&zj!==void 0?zj:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function Gje(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=Wje.get(e))!==null&&t!==void 0?t:e}var Sa;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Sa||(Sa={}));const Kje=32;var Hh;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Hh||(Hh={}));function x4(e){return e>=Sa.ZERO&&e<=Sa.NINE}function Yje(e){return e>=Sa.UPPER_A&&e<=Sa.UPPER_F||e>=Sa.LOWER_A&&e<=Sa.LOWER_F}function Zje(e){return e>=Sa.UPPER_A&&e<=Sa.UPPER_Z||e>=Sa.LOWER_A&&e<=Sa.LOWER_Z||x4(e)}function Xje(e){return e===Sa.EQUALS||Zje(e)}var ga;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(ga||(ga={}));var Uh;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(Uh||(Uh={}));class Jje{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=ga.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Uh.Strict}startEntity(t){this.decodeMode=t,this.state=ga.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case ga.EntityStart:return t.charCodeAt(n)===Sa.NUM?(this.state=ga.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=ga.NamedEntity,this.stateNamedEntity(t,n));case ga.NumericStart:return this.stateNumericStart(t,n);case ga.NumericDecimal:return this.stateNumericDecimal(t,n);case ga.NumericHex:return this.stateNumericHex(t,n);case ga.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|Kje)===Sa.LOWER_X?(this.state=ga.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=ga.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(x4(s)||Yje(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(x4(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Sa.SEMI)this.consumed+=1;else if(this.decodeMode===Uh.Strict)return 0;return this.emitCodePoint(Gje(this.result),this.consumed),this.errors&&(t!==Sa.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&Hh.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=Qje(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===Uh.Attribute&&(i===0||Xje(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&Hh.VALUE_LENGTH)>>14,i!==0){if(a===Sa.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==Uh.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&Hh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~Hh.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case ga.NamedEntity:return this.result!==0&&(this.decodeMode!==Uh.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case ga.NumericDecimal:return this.emitNumericEntity(0,2);case ga.NumericHex:return this.emitNumericEntity(0,3);case ga.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case ga.EntityStart:return 0}}}function qQ(e){let t="";const n=new Jje(e,r=>t+=Hje(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function Qje(e,t,n,r){const s=(t&Hh.BRANCH_LENGTH)>>7,i=t&Hh.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const e3e=qQ(qje);qQ(Vje);function VQ(e,t=Uh.Legacy){return e3e(e,t)}function t3e(e){return Object.prototype.toString.call(e)}function p5(e){return t3e(e)==="[object String]"}const n3e=Object.prototype.hasOwnProperty;function r3e(e,t){return n3e.call(e,t)}function kA(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function WQ(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function m5(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function gE(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const HQ=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,s3e=/&([a-z#][a-z0-9]{1,31});/gi,i3e=new RegExp(HQ.source+"|"+s3e.source,"gi"),a3e=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function o3e(e,t){if(t.charCodeAt(0)===35&&a3e.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return m5(r)?gE(r):e}const n=VQ(e);return n!==e?n:e}function l3e(e){return e.indexOf("\\")<0?e:e.replace(HQ,"$1")}function lb(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(i3e,function(t,n,r){return n||o3e(t,r)})}const c3e=/[&<>"]/,u3e=/[&<>"]/g,d3e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function f3e(e){return d3e[e]}function dp(e){return c3e.test(e)?e.replace(u3e,f3e):e}const h3e=/[.?*+^$[\]\\(){}|-]/g;function p3e(e){return e.replace(h3e,"\\$&")}function Us(e){switch(e){case 9:case 32:return!0}return!1}function g1(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function y1(e){return h5.test(e)||zQ.test(e)}function b1(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function EA(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const m3e={mdurl:Bje,ucmicro:Uje},g3e=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:WQ,assign:kA,escapeHtml:dp,escapeRE:p3e,fromCodePoint:gE,has:r3e,isMdAsciiPunct:b1,isPunctChar:y1,isSpace:Us,isString:p5,isValidEntityCode:m5,isWhiteSpace:g1,lib:m3e,normalizeReference:EA,unescapeAll:lb,unescapeMd:l3e},Symbol.toStringTag,{value:"Module"}));function y3e(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function b3e(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=lb(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=lb(e.slice(t,s)),i.pos=s,i.ok=!0),i}function v3e(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=lb(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=lb(e.slice(t,i)),a}const x3e=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:b3e,parseLinkLabel:y3e,parseLinkTitle:v3e},Symbol.toStringTag,{value:"Module"})),md={};md.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+dp(i.content)+"</code>"};md.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+dp(e[t].content)+`</code></pre>
`};md.fence=function(e,t,n,r,s){const i=e[t],a=i.info?lb(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||dp(i.content):c=dp(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};md.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};md.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};md.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};md.text=function(e,t){return dp(e[t].content)};md.html_block=function(e,t){return e[t].content};md.html_inline=function(e,t){return e[t].content};function tv(){this.rules=kA({},md)}tv.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+dp(t.attrs[n][0])+'="'+dp(t.attrs[n][1])+'"';return s};tv.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};tv.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};tv.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};tv.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function ll(){this.__rules__=[],this.__cache__=null}ll.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};ll.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};ll.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};ll.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};ll.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};ll.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};ll.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};ll.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};ll.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};ll.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function uu(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}uu.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};uu.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};uu.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};uu.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};uu.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function GQ(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}GQ.prototype.Token=uu;const w3e=/\r\n?|\n/g,S3e=/\0/g;function _3e(e){let t;t=e.src.replace(w3e,`
`),t=t.replace(S3e,""),e.src=t}function C3e(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function k3e(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function E3e(e){return/^<a[>\s]/i.test(e)}function T3e(e){return/^<\/a\s*>/i.test(e)}function A3e(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(E3e(o.content)&&i>0&&i--,T3e(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let p=0;p<c.length;p++){const g=c[p].url,y=e.md.normalizeLink(g);if(!e.md.validateLink(y))continue;let v=c[p].text;c[p].schema?c[p].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[p].index;if(x>h){const k=new e.Token("text","",0);k.content=l.slice(h,x),k.level=d,u.push(k)}const w=new e.Token("link_open","a",1);w.attrs=[["href",y]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const S=new e.Token("text","",0);S.content=v,S.level=d,u.push(S);const _=new e.Token("link_close","a",-1);_.level=--d,_.markup="linkify",_.info="auto",u.push(_),h=c[p].lastIndex}if(h<l.length){const p=new e.Token("text","",0);p.content=l.slice(h),p.level=d,u.push(p)}t[n].children=s=WQ(s,a,u)}}}}const KQ=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,N3e=/\((c|tm|r)\)/i,R3e=/\((c|tm|r)\)/ig,I3e={c:"",r:"",tm:""};function M3e(e,t){return I3e[t.toLowerCase()]}function j3e(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(R3e,M3e)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function P3e(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&KQ.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function O3e(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(N3e.test(e.tokens[t].content)&&j3e(e.tokens[t].children),KQ.test(e.tokens[t].content)&&P3e(e.tokens[t].children))}const D3e=/['"]/,HU=/['"]/g,GU="";function ZC(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function F3e(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){HU.lastIndex=l;const u=HU.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const p=u[0]==="'";let g=32;if(u.index-1>=0)g=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){g=e[n].content.charCodeAt(e[n].content.length-1);break}let y=32;if(l<c)y=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){y=e[n].content.charCodeAt(0);break}const v=b1(g)||y1(String.fromCharCode(g)),x=b1(y)||y1(String.fromCharCode(y)),w=g1(g),S=g1(y);if(S?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(S||x||(h=!1)),y===34&&u[0]==='"'&&g>=48&&g<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){p&&(i.content=ZC(i.content,u.index,GU));continue}if(h)for(n=r.length-1;n>=0;n--){let _=r[n];if(r[n].level<a)break;if(_.single===p&&r[n].level===a){_=r[n];let k,T;p?(k=t.md.options.quotes[2],T=t.md.options.quotes[3]):(k=t.md.options.quotes[0],T=t.md.options.quotes[1]),i.content=ZC(i.content,u.index,T),e[_.token].content=ZC(e[_.token].content,_.pos,k),l+=T.length-1,_.token===s&&(l+=k.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:p,level:a}):h&&p&&(i.content=ZC(i.content,u.index,GU))}}}function L3e(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!D3e.test(e.tokens[t].content)||F3e(e.tokens[t].children,e)}function $3e(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const Uj=[["normalize",_3e],["block",C3e],["inline",k3e],["linkify",A3e],["replacements",O3e],["smartquotes",L3e],["text_join",$3e]];function g5(){this.ruler=new ll;for(let e=0;e<Uj.length;e++)this.ruler.push(Uj[e][0],Uj[e][1])}g5.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};g5.prototype.State=GQ;function gd(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Us(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}gd.prototype.push=function(e,t,n){const r=new uu(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};gd.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};gd.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};gd.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Us(r))break}return t};gd.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Us(this.src.charCodeAt(--t)))return t+1;return t};gd.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};gd.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};gd.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Us(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};gd.prototype.Token=uu;const B3e=65536;function qj(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function KU(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function z3e(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Us(o)||a===45&&Us(o))return!1;for(;i<e.eMarks[s];){const _=e.src.charCodeAt(i);if(_!==124&&_!==45&&_!==58&&!Us(_))return!1;i++}let l=qj(e,t+1),c=l.split("|");const u=[];for(let _=0;_<c.length;_++){const k=c[_].trim();if(!k){if(_===0||_===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(k))return!1;k.charCodeAt(k.length-1)===58?u.push(k.charCodeAt(0)===58?"center":"right"):k.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=qj(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=KU(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const p=e.md.block.ruler.getRules("blockquote"),g=e.push("table_open","table",1),y=[t,0];g.map=y;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let _=0;_<c.length;_++){const k=e.push("th_open","th",1);u[_]&&(k.attrs=[["style","text-align:"+u[_]]]);const T=e.push("inline","",0);T.content=c[_].trim(),T.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,S=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let _=!1;for(let T=0,A=p.length;T<A;T++)if(p[T](e,s,n,!0)){_=!0;break}if(_||(l=qj(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=KU(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>B3e))break;if(s===t+2){const T=e.push("tbody_open","tbody",1);T.map=w=[t+2,0]}const k=e.push("tr_open","tr",1);k.map=[s,s+1];for(let T=0;T<d;T++){const A=e.push("td_open","td",1);u[T]&&(A.attrs=[["style","text-align:"+u[T]]]);const R=e.push("inline","",0);R.content=c[T]?c[T].trim():"",R.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),y[1]=s,e.parentType=h,e.line=s,!0}function U3e(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function q3e(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const p=e.push("fence","code",0);return p.info=u,p.content=e.getLines(t+1,d,l,!0),p.markup=c,p.map=[t,e.line],!0}function V3e(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let p=!1,g;for(g=t;g<n;g++){const S=e.sCount[g]<e.blkIndent;if(s=e.bMarks[g]+e.tShift[g],i=e.eMarks[g],s>=i)break;if(e.src.charCodeAt(s++)===62&&!S){let k=e.sCount[g]+1,T,A;e.src.charCodeAt(s)===32?(s++,k++,A=!1,T=!0):e.src.charCodeAt(s)===9?(T=!0,(e.bsCount[g]+k)%4===3?(s++,k++,A=!1):A=!0):T=!1;let R=k;for(o.push(e.bMarks[g]),e.bMarks[g]=s;s<i;){const M=e.src.charCodeAt(s);if(Us(M))M===9?R+=4-(R+e.bsCount[g]+(A?1:0))%4:R++;else break;s++}p=s>=i,l.push(e.bsCount[g]),e.bsCount[g]=e.sCount[g]+1+(T?1:0),c.push(e.sCount[g]),e.sCount[g]=R-k,u.push(e.tShift[g]),e.tShift[g]=s-e.bMarks[g];continue}if(p)break;let _=!1;for(let k=0,T=d.length;k<T;k++)if(d[k](e,g,n,!0)){_=!0;break}if(_){e.lineMax=g,e.blkIndent!==0&&(o.push(e.bMarks[g]),l.push(e.bsCount[g]),u.push(e.tShift[g]),c.push(e.sCount[g]),e.sCount[g]-=e.blkIndent);break}o.push(e.bMarks[g]),l.push(e.bsCount[g]),u.push(e.tShift[g]),c.push(e.sCount[g]),e.sCount[g]=-1}const y=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,g);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=y,!0}function W3e(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Us(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function YU(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Us(i))return-1}return r}function ZU(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Us(i))?-1:s}function H3e(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function G3e(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,p;if((p=ZU(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,p-1)),u&&h!==1)return!1}else if((p=YU(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(p)>=e.eMarks[l])return!1;if(r)return!0;const g=e.src.charCodeAt(p-1),y=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(g);let x=!1;const w=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){i=p,s=e.eMarks[l];const _=e.sCount[l]+p-(e.bMarks[l]+e.tShift[l]);let k=_;for(;i<s;){const V=e.src.charCodeAt(i);if(V===9)k+=4-(k+e.bsCount[l])%4;else if(V===32)k++;else break;i++}const T=i;let A;T>=s?A=1:A=k-_,A>4&&(A=1);const R=_+A;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(g);const M=[l,0];o.map=M,d&&(o.info=e.src.slice(a,p-1));const j=e.tight,F=e.tShift[l],P=e.sCount[l],q=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=R,e.tight=!0,e.tShift[l]=T-e.bMarks[l],e.sCount[l]=k,T>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=q,e.tShift[l]=F,e.sCount[l]=P,e.tight=j,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(g),l=e.line,M[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let I=!1;for(let V=0,D=w.length;V<D;V++)if(w[V](e,l,n,!0)){I=!0;break}if(I)break;if(d){if(p=ZU(e,l),p<0)break;a=e.bMarks[l]+e.tShift[l]}else if(p=YU(e,l),p<0)break;if(g!==e.src.charCodeAt(p-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(g),v[1]=l,e.line=l,e.parentType=S,c&&H3e(e,y),!0}function K3e(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const S=e.lineMax;if(w>=S||e.isEmpty(w))return null;let _=!1;if(e.sCount[w]-e.blkIndent>3&&(_=!0),e.sCount[w]<0&&(_=!0),!_){const A=e.md.block.ruler.getRules("reference"),R=e.parentType;e.parentType="reference";let M=!1;for(let j=0,F=A.length;j<F;j++)if(A[j](e,w,S,!0)){M=!0;break}if(e.parentType=R,M)return null}const k=e.bMarks[w]+e.tShift[w],T=e.eMarks[w];return e.src.slice(k,T+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Us(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,p=a,g=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Us(w))break}let y=e.md.helpers.parseLinkTitle(l,s,i);for(;y.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,y=e.md.helpers.parseLinkTitle(l,s,i,y)}let v;for(s<i&&g!==s&&y.ok?(v=y.str,s=y.pos):(v="",s=h,a=p);s<i;){const w=l.charCodeAt(s);if(!Us(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=p;s<i;){const w=l.charCodeAt(s);if(!Us(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=EA(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const Y3e=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Z3e="[a-zA-Z_:][a-zA-Z0-9:._-]*",X3e="[^\"'=<>`\\x00-\\x20]+",J3e="'[^']*'",Q3e='"[^"]*"',ePe="(?:"+X3e+"|"+J3e+"|"+Q3e+")",tPe="(?:\\s+"+Z3e+"(?:\\s*=\\s*"+ePe+")?)",YQ="<[A-Za-z][A-Za-z0-9\\-]*"+tPe+"*\\s*\\/?>",ZQ="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",nPe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",rPe="<[?][\\s\\S]*?[?]>",sPe="<![A-Za-z][^>]*>",iPe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",aPe=new RegExp("^(?:"+YQ+"|"+ZQ+"|"+nPe+"|"+rPe+"|"+sPe+"|"+iPe+")"),oPe=new RegExp("^(?:"+YQ+"|"+ZQ+")"),L0=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Y3e.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(oPe.source+"\\s*$"),/^$/,!1]];function lPe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<L0.length&&!L0[o][0].test(a);o++);if(o===L0.length)return!1;if(r)return L0[o][2];let l=t+1;if(!L0[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),L0[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function cPe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Us(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Us(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function uPe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let p=e.bMarks[o]+e.tShift[o];const g=e.eMarks[o];if(p<g&&(a=e.src.charCodeAt(p),(a===45||a===61)&&(p=e.skipChars(p,a),p=e.skipSpaces(p),p>=g))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let p=0,g=r.length;p<g;p++)if(r[p](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function dPe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const XC=[["table",z3e,["paragraph","reference"]],["code",U3e],["fence",q3e,["paragraph","reference","blockquote","list"]],["blockquote",V3e,["paragraph","reference","blockquote","list"]],["hr",W3e,["paragraph","reference","blockquote","list"]],["list",G3e,["paragraph","reference","blockquote"]],["reference",K3e],["html_block",lPe,["paragraph","reference","blockquote"]],["heading",cPe,["paragraph","reference","blockquote"]],["lheading",uPe],["paragraph",dPe]];function TA(){this.ruler=new ll;for(let e=0;e<XC.length;e++)this.ruler.push(XC[e][0],XC[e][1],{alt:(XC[e][2]||[]).slice()})}TA.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};TA.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};TA.prototype.State=gd;function HS(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}HS.prototype.pushPending=function(){const e=new uu("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};HS.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new uu(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};HS.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=b1(s)||y1(String.fromCharCode(s)),c=b1(o)||y1(String.fromCharCode(o)),u=g1(s),d=g1(o),h=!d&&(!c||u||l),p=!u&&(!l||d||c);return{can_open:h&&(t||!p||l),can_close:p&&(t||!h||c),length:a}};HS.prototype.Token=uu;function fPe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function hPe(e,t){let n=e.pos;for(;n<e.posMax&&!fPe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const pPe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function mPe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(pPe);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function gPe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Us(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const y5=[];for(let e=0;e<256;e++)y5.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){y5[e.charCodeAt(0)]=1});function yPe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Us(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&y5[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function bPe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function vPe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function XU(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function xPe(e){const t=e.tokens_meta,n=e.tokens_meta.length;XU(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&XU(e,t[r].delimiters)}const XQ={tokenize:vPe,postProcess:xPe};function wPe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function JU(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function SPe(e){const t=e.tokens_meta,n=e.tokens_meta.length;JU(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&JU(e,t[r].delimiters)}const JQ={tokenize:wPe,postProcess:SPe};function _Pe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,p=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(p<0)return!1;let g=p+1;if(g<d&&e.src.charCodeAt(g)===40){for(c=!1,g++;g<d&&(n=e.src.charCodeAt(g),!(!Us(n)&&n!==10));g++);if(g>=d)return!1;if(l=g,s=e.md.helpers.parseLinkDestination(e.src,g,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?g=s.pos:a="",l=g;g<d&&(n=e.src.charCodeAt(g),!(!Us(n)&&n!==10));g++);if(s=e.md.helpers.parseLinkTitle(e.src,g,e.posMax),g<d&&l!==g&&s.ok)for(o=s.str,g=s.pos;g<d&&(n=e.src.charCodeAt(g),!(!Us(n)&&n!==10));g++);}(g>=d||e.src.charCodeAt(g)!==41)&&(c=!0),g++}if(c){if(typeof e.env.references>"u")return!1;if(g<d&&e.src.charCodeAt(g)===91?(l=g+1,g=e.md.helpers.parseLinkLabel(e,g),g>=0?r=e.src.slice(l,g++):g=p+1):g=p+1,r||(r=e.src.slice(h,p)),i=e.env.references[EA(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=p;const y=e.push("link_open","a",1),v=[["href",a]];y.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=g,e.posMax=d,!0}function CPe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const p=e.pos+2,g=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(g<0)return!1;if(i=g+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Us(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Us(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Us(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=g+1):i=g+1,s||(s=e.src.slice(p,g)),a=e.env.references[EA(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(p,g);const y=[];e.md.inline.parse(r,e.md,e.env,y);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=y,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const kPe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,EPe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function TPe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(EPe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(kPe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function APe(e){return/^<a[>\s]/i.test(e)}function NPe(e){return/^<\/a\s*>/i.test(e)}function RPe(e){const t=e|32;return t>=97&&t<=122}function IPe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!RPe(s))return!1;const i=e.src.slice(r).match(aPe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],APe(a.content)&&e.linkLevel++,NPe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const MPe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,jPe=/^&([a-z][a-z0-9]{1,31});/i;function PPe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(MPe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=m5(a)?gE(a):gE(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(jPe);if(i){const a=VQ(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function QU(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const p=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+p,i[c]=p,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function OPe(e){const t=e.tokens_meta,n=e.tokens_meta.length;QU(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&QU(t[r].delimiters)}function DPe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const Vj=[["text",hPe],["linkify",mPe],["newline",gPe],["escape",yPe],["backticks",bPe],["strikethrough",XQ.tokenize],["emphasis",JQ.tokenize],["link",_Pe],["image",CPe],["autolink",TPe],["html_inline",IPe],["entity",PPe]],Wj=[["balance_pairs",OPe],["strikethrough",XQ.postProcess],["emphasis",JQ.postProcess],["fragments_join",DPe]];function GS(){this.ruler=new ll;for(let e=0;e<Vj.length;e++)this.ruler.push(Vj[e][0],Vj[e][1]);this.ruler2=new ll;for(let e=0;e<Wj.length;e++)this.ruler2.push(Wj[e][0],Wj[e][1])}GS.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};GS.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};GS.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};GS.prototype.State=HS;function FPe(e){const t={};e=e||{},t.src_Any=$Q.source,t.src_Cc=BQ.source,t.src_Z=UQ.source,t.src_P=h5.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function w4(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function AA(e){return Object.prototype.toString.call(e)}function LPe(e){return AA(e)==="[object String]"}function $Pe(e){return AA(e)==="[object Object]"}function BPe(e){return AA(e)==="[object RegExp]"}function eq(e){return AA(e)==="[object Function]"}function zPe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const QQ={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function UPe(e){return Object.keys(e||{}).reduce(function(t,n){return t||QQ.hasOwnProperty(n)},!1)}const qPe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},VPe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",WPe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function HPe(e){e.__index__=-1,e.__text_cache__=""}function GPe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function tq(){return function(e,t){t.normalize(e)}}function yE(e){const t=e.re=FPe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(VPe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,$Pe(l)){BPe(l.validate)?c.validate=GPe(l.validate):eq(l.validate)?c.validate=l.validate:i(o,l),eq(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=tq();return}if(LPe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:tq()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(zPe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),HPe(e)}function KPe(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function S4(e,t){const n=new KPe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function Ol(e,t){if(!(this instanceof Ol))return new Ol(e,t);t||UPe(e)&&(t=e,e={}),this.__opts__=w4({},QQ,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=w4({},qPe,e),this.__compiled__={},this.__tlds__=WPe,this.__tlds_replaced__=!1,this.re={},yE(this)}Ol.prototype.add=function(t,n){return this.__schemas__[t]=n,yE(this),this};Ol.prototype.set=function(t){return this.__opts__=w4(this.__opts__,t),this};Ol.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};Ol.prototype.pretest=function(t){return this.re.pretest.test(t)};Ol.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};Ol.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(S4(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(S4(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};Ol.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,S4(this,0)):null};Ol.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),yE(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,yE(this),this)};Ol.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};Ol.prototype.onCompile=function(){};const vy=2147483647,Wu=36,b5=1,v1=26,YPe=38,ZPe=700,eee=72,tee=128,nee="-",XPe=/^xn--/,JPe=/[^\0-\x7F]/,QPe=/[\x2E\u3002\uFF0E\uFF61]/g,e4e={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Hj=Wu-b5,Hu=Math.floor,Gj=String.fromCharCode;function $h(e){throw new RangeError(e4e[e])}function t4e(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function ree(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(QPe,".");const s=e.split("."),i=t4e(s,t).join(".");return r+i}function see(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const n4e=e=>String.fromCodePoint(...e),r4e=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:Wu},nq=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},iee=function(e,t,n){let r=0;for(e=n?Hu(e/ZPe):e>>1,e+=Hu(e/t);e>Hj*v1>>1;r+=Wu)e=Hu(e/Hj);return Hu(r+(Hj+1)*e/(e+YPe))},aee=function(e){const t=[],n=e.length;let r=0,s=tee,i=eee,a=e.lastIndexOf(nee);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&$h("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=Wu;;d+=Wu){o>=n&&$h("invalid-input");const h=r4e(e.charCodeAt(o++));h>=Wu&&$h("invalid-input"),h>Hu((vy-r)/u)&&$h("overflow"),r+=h*u;const p=d<=i?b5:d>=i+v1?v1:d-i;if(h<p)break;const g=Wu-p;u>Hu(vy/g)&&$h("overflow"),u*=g}const c=t.length+1;i=iee(r-l,c,l==0),Hu(r/c)>vy-s&&$h("overflow"),s+=Hu(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},oee=function(e){const t=[];e=see(e);const n=e.length;let r=tee,s=0,i=eee;for(const l of e)l<128&&t.push(Gj(l));const a=t.length;let o=a;for(a&&t.push(nee);o<n;){let l=vy;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>Hu((vy-s)/c)&&$h("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>vy&&$h("overflow"),u===r){let d=s;for(let h=Wu;;h+=Wu){const p=h<=i?b5:h>=i+v1?v1:h-i;if(d<p)break;const g=d-p,y=Wu-p;t.push(Gj(nq(p+g%y,0))),d=Hu(g/y)}t.push(Gj(nq(d,0))),i=iee(s,c,o===a),s=0,++o}++s,++r}return t.join("")},s4e=function(e){return ree(e,function(t){return XPe.test(t)?aee(t.slice(4).toLowerCase()):t})},i4e=function(e){return ree(e,function(t){return JPe.test(t)?"xn--"+oee(t):t})},lee={version:"2.3.1",ucs2:{decode:see,encode:n4e},decode:aee,encode:oee,toASCII:i4e,toUnicode:s4e},a4e={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},o4e={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},l4e={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},c4e={default:a4e,zero:o4e,commonmark:l4e},u4e=/^(vbscript|javascript|file|data):/,d4e=/^data:image\/(gif|png|jpeg|webp);/;function f4e(e){const t=e.trim().toLowerCase();return u4e.test(t)?d4e.test(t):!0}const cee=["http:","https:","mailto:"];function h4e(e){const t=f5(e,!0);if(t.hostname&&(!t.protocol||cee.indexOf(t.protocol)>=0))try{t.hostname=lee.toASCII(t.hostname)}catch{}return WS(d5(t))}function p4e(e){const t=f5(e,!0);if(t.hostname&&(!t.protocol||cee.indexOf(t.protocol)>=0))try{t.hostname=lee.toUnicode(t.hostname)}catch{}return ob(d5(t),ob.defaultChars+"%")}function cl(e,t){if(!(this instanceof cl))return new cl(e,t);t||p5(e)||(t=e||{},e="default"),this.inline=new GS,this.block=new TA,this.core=new g5,this.renderer=new tv,this.linkify=new Ol,this.validateLink=f4e,this.normalizeLink=h4e,this.normalizeLinkText=p4e,this.utils=g3e,this.helpers=kA({},x3e),this.options={},this.configure(e),t&&this.set(t)}cl.prototype.set=function(e){return kA(this.options,e),this};cl.prototype.configure=function(e){const t=this;if(p5(e)){const n=e;if(e=c4e[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};cl.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};cl.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};cl.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};cl.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};cl.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};cl.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};cl.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const Kj=new cl({html:!1,linkify:!0,breaks:!0});function NA(e){return E.useMemo(()=>{var n;if(!e)return[];try{const r=Kj.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;s.push({type:"block",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=Kj.renderer.render(l,Kj.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const m4e=({markdownContent:e,interactionId:t})=>{const n=NA(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(Bb,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},x1=We.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0,interactionId:s})=>{var v,x;const i=gr(w=>w.foldUserMessagesOnCompletion),[a,o]=E.useState(r&&i),[l,c]=E.useState(!1);E.useEffect(()=>{r&&i&&o(!0)},[r,i]);const u=t?FQ(new Date(t),{addSuffix:!0}):"Sending...",d=((v=e.metadata)==null?void 0:v.attachedFiles)&&e.metadata.attachedFiles.length>0,h=e.content&&e.content.trim().length>0,p=E.useCallback(()=>o(w=>!w),[]),g=E.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),c(!0),ke.success("User prompt copied!"),setTimeout(()=>c(!1),1500)}catch(w){ke.error("Failed to copy prompt."),console.error("Clipboard copy failed:",w)}},[e.content]),y=E.useMemo(()=>{var S;let w="";return h&&(w+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),h&&d&&(w+=" + "),d&&(w+=`${(S=e.metadata.attachedFiles)==null?void 0:S.length} file(s)`),w||"[Empty Prompt]"},[h,d,e.content,e.metadata]);return f.jsxs("div",{className:Ye("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Ye("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(pxe,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[h&&f.jsx(Nn,{tooltipText:"Copy Prompt",onClick:g,"aria-label":"Copy user prompt",icon:l?f.jsx(Ao,{className:"text-green-500"}):f.jsx(IT,{}),className:"h-5 w-5"}),(h||d)&&f.jsx(Nn,{tooltipText:a?"Unfold":"Fold",onClick:p,"aria-label":a?"Unfold prompt":"Fold prompt",icon:a?f.jsx(Fl,{}):f.jsx(wp,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:u})})]}),!a&&f.jsxs(f.Fragment,{children:[d&&f.jsx("div",{className:"mb-2 space-y-1",children:(x=e.metadata.attachedFiles)==null?void 0:x.map(w=>f.jsx(xQ,{fileMeta:w,isReadOnly:!0},w.id))}),f.jsx(m4e,{markdownContent:e.content,interactionId:s})]}),a&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:p,children:y})]})});x1.displayName="UserPromptDisplay";const g4e=(e,t,n,r)=>typeof e=="string"?e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null:e.type==="block"?f.jsx(Bb,{lang:e.lang,code:e.code,filepath:e.filepath,isStreaming:n,interactionId:r},`block-${t}`):null,y4e=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s}=gr(pn(h=>({enableStreamingMarkdown:h.enableStreamingMarkdown}))),i=NA(s?t:null),a=Ni(pn(h=>Object.values(h.canvasControls))),o=E.useCallback((h,p)=>a.filter(g=>g.type==="tool-call-step"&&g.targetSlot===h&&g.renderer).map(g=>g.renderer?f.jsx(We.Fragment,{children:g.renderer(p)},g.id):null).filter(Boolean),[a]),{toolCallStrings:l,toolResultStrings:c}=en(pn(h=>{var g,y;const p=h.interactions.find(v=>v.id===e);return{toolCallStrings:(g=p==null?void 0:p.metadata)==null?void 0:g.toolCalls,toolResultStrings:(y=p==null?void 0:p.metadata)==null?void 0:y.toolResults}})),u=E.useMemo(()=>{if(!l)return[];try{const h=l.map(g=>JSON.parse(g)),p=(c==null?void 0:c.map(g=>JSON.parse(g)))??[];return h.map(g=>{const y=p.find(v=>v.toolCallId===g.toolCallId);return{call:g,result:y}})}catch(h){return console.error("[StreamingContentView] Error parsing tool call/result strings:",h),[]}},[l,c]),d=E.useMemo(()=>s?i.map((h,p)=>g4e(h,p,n&&p===i.length-1,e)).filter(Boolean):[],[s,i,n,e]);return!s&&!t&&u.length===0?n?f.jsx("div",{className:Ye("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Ye("streaming-content-view overflow-wrap-anywhere",r),children:[u.map(({call:h,result:p},g)=>{const y={interactionId:e,toolCall:h,toolResult:p,canvasContextType:"tool-call-step"};return f.jsx(We.Fragment,{children:o("tool-call-content",y)},`tool-step-${h.toolCallId||g}`)}),s?d:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new cl().render(t)}}):null]})},b4e=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(Nn,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(nxe,{}),variant:r,size:n,className:t}),v4e="modulepreload",x4e=function(e){return"/"+e},rq={},zr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=x4e(c),c in rq)return;rq[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":v4e,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((p,g)=>{h.addEventListener("load",p),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},w4e=Symbol("Let zodToJsonSchema decide on which parser to use"),sq={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},S4e=e=>typeof e=="string"?{...sq,name:e}:{...sq,...e},_4e=e=>{const t=S4e(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function uee(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function Ts(e,t,n,r,s){e[t]=n,uee(e,t,r,s)}function C4e(){return{}}function k4e(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==nn.ZodAny&&(n.items=hs(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&Ts(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&Ts(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(Ts(n,"minItems",e.exactLength.value,e.exactLength.message,t),Ts(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function E4e(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?Ts(n,"minimum",r.value,r.message,t):Ts(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ts(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ts(n,"maximum",r.value,r.message,t):Ts(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ts(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ts(n,"multipleOf",r.value,r.message,t);break}return n}function T4e(){return{type:"boolean"}}function dee(e,t){return hs(e.type._def,t)}const A4e=(e,t)=>hs(e.innerType._def,t);function fee(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>fee(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return N4e(e,t)}}const N4e=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":Ts(n,"minimum",r.value,r.message,t);break;case"max":Ts(n,"maximum",r.value,r.message,t);break}return n};function R4e(e,t){return{...hs(e.innerType._def,t),default:e.defaultValue()}}function I4e(e,t){return t.effectStrategy==="input"?hs(e.schema._def,t):{}}function M4e(e){return{type:"string",enum:Array.from(e.values)}}const j4e=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function P4e(e,t){const n=[hs(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),hs(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(j4e(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function O4e(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let Yj;const Dc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Yj===void 0&&(Yj=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Yj),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function hee(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":Ts(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":Ts(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Fc(n,"email",r.message,t);break;case"format:idn-email":Fc(n,"idn-email",r.message,t);break;case"pattern:zod":vo(n,Dc.email,r.message,t);break}break;case"url":Fc(n,"uri",r.message,t);break;case"uuid":Fc(n,"uuid",r.message,t);break;case"regex":vo(n,r.regex,r.message,t);break;case"cuid":vo(n,Dc.cuid,r.message,t);break;case"cuid2":vo(n,Dc.cuid2,r.message,t);break;case"startsWith":vo(n,RegExp(`^${Zj(r.value,t)}`),r.message,t);break;case"endsWith":vo(n,RegExp(`${Zj(r.value,t)}$`),r.message,t);break;case"datetime":Fc(n,"date-time",r.message,t);break;case"date":Fc(n,"date",r.message,t);break;case"time":Fc(n,"time",r.message,t);break;case"duration":Fc(n,"duration",r.message,t);break;case"length":Ts(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),Ts(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{vo(n,RegExp(Zj(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&Fc(n,"ipv4",r.message,t),r.version!=="v4"&&Fc(n,"ipv6",r.message,t);break}case"base64url":vo(n,Dc.base64url,r.message,t);break;case"jwt":vo(n,Dc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&vo(n,Dc.ipv4Cidr,r.message,t),r.version!=="v4"&&vo(n,Dc.ipv6Cidr,r.message,t);break}case"emoji":vo(n,Dc.emoji(),r.message,t);break;case"ulid":{vo(n,Dc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Fc(n,"binary",r.message,t);break}case"contentEncoding:base64":{Ts(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{vo(n,Dc.base64,r.message,t);break}}break}case"nanoid":vo(n,Dc.nanoid,r.message,t)}return n}function Zj(e,t){return t.patternStrategy==="escape"?F4e(e):e}const D4e=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function F4e(e){let t="";for(let n=0;n<e.length;n++)D4e.has(e[n])||(t+="\\"),t+=e[n];return t}function Fc(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ts(e,"format",t,n,r)}function vo(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:iq(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ts(e,"pattern",iq(t,r),n,r)}function iq(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function pee(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===nn.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:hs(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:hs(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===nn.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=hee(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===nn.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===nn.ZodBranded&&e.keyType._def.type._def.typeName===nn.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=dee(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function L4e(e,t){if(t.mapStrategy==="record")return pee(e,t);const n=hs(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=hs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function $4e(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function B4e(){return{not:{}}}function z4e(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const bE={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function U4e(e,t){if(t.target==="openApi3")return aq(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in bE&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=bE[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return aq(e,t)}const aq=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>hs(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function q4e(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:bE[e.innerType._def.typeName],nullable:!0}:{type:[bE[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=hs(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=hs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function V4e(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",uee(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?Ts(n,"minimum",r.value,r.message,t):Ts(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),Ts(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?Ts(n,"maximum",r.value,r.message,t):Ts(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),Ts(n,"maximum",r.value,r.message,t));break;case"multipleOf":Ts(n,"multipleOf",r.value,r.message,t);break}return n}function W4e(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=G4e(l);c&&n&&(l instanceof Zu&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=hs(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=H4e(e,t);return a!==void 0&&(r.additionalProperties=a),r}function H4e(e,t){if(e.catchall._def.typeName!=="ZodNever")return hs(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function G4e(e){try{return e.isOptional()}catch{return!0}}const K4e=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return hs(e.innerType._def,t);const n=hs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},Y4e=(e,t)=>{if(t.pipeStrategy==="input")return hs(e.in._def,t);if(t.pipeStrategy==="output")return hs(e.out._def,t);const n=hs(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=hs(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function Z4e(e,t){return hs(e.type._def,t)}function X4e(e,t){const r={type:"array",uniqueItems:!0,items:hs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&Ts(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&Ts(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function J4e(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>hs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:hs(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>hs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function Q4e(){return{not:{}}}function eOe(){return{}}const tOe=(e,t)=>hs(e.innerType._def,t),nOe=(e,t,n)=>{switch(t){case nn.ZodString:return hee(e,n);case nn.ZodNumber:return V4e(e,n);case nn.ZodObject:return W4e(e,n);case nn.ZodBigInt:return E4e(e,n);case nn.ZodBoolean:return T4e();case nn.ZodDate:return fee(e,n);case nn.ZodUndefined:return Q4e();case nn.ZodNull:return z4e(n);case nn.ZodArray:return k4e(e,n);case nn.ZodUnion:case nn.ZodDiscriminatedUnion:return U4e(e,n);case nn.ZodIntersection:return P4e(e,n);case nn.ZodTuple:return J4e(e,n);case nn.ZodRecord:return pee(e,n);case nn.ZodLiteral:return O4e(e,n);case nn.ZodEnum:return M4e(e);case nn.ZodNativeEnum:return $4e(e);case nn.ZodNullable:return q4e(e,n);case nn.ZodOptional:return K4e(e,n);case nn.ZodMap:return L4e(e,n);case nn.ZodSet:return X4e(e,n);case nn.ZodLazy:return()=>e.getter()._def;case nn.ZodPromise:return Z4e(e,n);case nn.ZodNaN:case nn.ZodNever:return B4e();case nn.ZodEffects:return I4e(e,n);case nn.ZodAny:return C4e();case nn.ZodUnknown:return eOe();case nn.ZodDefault:return R4e(e,n);case nn.ZodBranded:return dee(e,n);case nn.ZodReadonly:return tOe(e,n);case nn.ZodCatch:return A4e(e,n);case nn.ZodPipeline:return Y4e(e,n);case nn.ZodFunction:case nn.ZodVoid:case nn.ZodSymbol:return;default:return(r=>{})()}};function hs(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==w4e)return l}if(r&&!n){const l=rOe(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=nOe(e,e.typeName,t),a=typeof i=="function"?hs(i(),t):i;if(a&&iOe(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const rOe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:sOe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},sOe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},iOe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),aOe=(e,t)=>{const n=_4e(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:hs(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=hs(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var w1={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},S1={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},_1={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},C1={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},k1={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},oOe=[w1,S1,_1,C1,k1];w1.code+"",S1.code+"",_1.code+"",C1.code+"",k1.code+"";w1.name+"",w1.code,S1.name+"",S1.code,_1.name+"",_1.code,C1.name+"",C1.code,k1.name+"",k1.code;oOe.map(e=>e.code);function lOe(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function cOe(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=eg({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=eg({text:lOe(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var uOe={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},dOe={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},fOe={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},hOe={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},pOe={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},mOe={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},gOe={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},yOe={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},bOe={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},vOe={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},xOe={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},wOe={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},SOe={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},_Oe={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},COe={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},kOe={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},RA=[uOe,dOe,fOe,hOe,pOe,mOe,gOe,yOe,bOe,vOe,xOe,wOe,SOe,_Oe,COe,kOe];Object.fromEntries(RA.map(e=>[e.code,e]));Object.fromEntries(RA.map(e=>[e.name,e.code]));RA.map(e=>e.code);function Ha(e,t){const n=RA.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function EOe(e,t){var n;const r=(n=void 0)!=null?n:!1;return mee(aOe(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var _4=Symbol.for("vercel.ai.schema");function mee(e,{validate:t}={}){return{[_4]:!0,_type:void 0,[kk]:!0,jsonSchema:e,validate:t}}function TOe(e){return typeof e=="object"&&e!==null&&_4 in e&&e[_4]===!0&&"jsonSchema"in e&&"validate"in e}function IA(e){return TOe(e)?e:EOe(e)}const ry=globalThis||void 0||self;var AOe=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof ry=="object"?ry:{},Dm="1.9.0",oq=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function NOe(e){var t=new Set([e]),n=new Set,r=e.match(oq);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(oq);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var ROe=NOe(Dm),IOe=Dm.split(".")[0],E1=Symbol.for("opentelemetry.js.api."+IOe),T1=AOe;function v5(e,t,n,r){var s;r===void 0&&(r=!1);var i=T1[E1]=(s=T1[E1])!==null&&s!==void 0?s:{version:Dm};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==Dm){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+Dm);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+Dm+"."),!0}function A1(e){var t,n,r=(t=T1[E1])===null||t===void 0?void 0:t.version;if(!(!r||!ROe(r)))return(n=T1[E1])===null||n===void 0?void 0:n[e]}function x5(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Dm+".");var n=T1[E1];n&&delete n[e]}var MOe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},jOe=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},POe=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Tx("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Tx("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Tx("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Tx("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Tx("verbose",this._namespace,t)},e}();function Tx(e,t,n){var r=A1("diag");if(r)return n.unshift(t),r[e].apply(r,jOe([],MOe(n),!1))}var kl;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(kl||(kl={}));function OOe(e,t){e<kl.NONE?e=kl.NONE:e>kl.ALL&&(e=kl.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",kl.ERROR),warn:n("warn",kl.WARN),info:n("info",kl.INFO),debug:n("debug",kl.DEBUG),verbose:n("verbose",kl.VERBOSE)}}var DOe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},FOe=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},LOe="diag",vE=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=A1("diag");if(o)return o[s].apply(o,FOe([],DOe(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:kl.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=A1("diag"),d=OOe((o=i.logLevel)!==null&&o!==void 0?o:kl.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return v5("diag",d,n,!0)};n.setLogger=r,n.disable=function(){x5(LOe,n)},n.createComponentLogger=function(s){return new POe(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function $Oe(e){return Symbol.for(e)}var BOe=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),zOe=new BOe,UOe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},qOe=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},VOe=function(){function e(){}return e.prototype.active=function(){return zOe},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,qOe([r],UOe(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),WOe=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},HOe=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},Xj="context",GOe=new VOe,gee=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return v5(Xj,t,vE.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,HOe([t,n,r],WOe(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return A1(Xj)||GOe},e.prototype.disable=function(){this._getContextManager().disable(),x5(Xj,vE.instance())},e}(),C4;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(C4||(C4={}));var yee="0000000000000000",bee="00000000000000000000000000000000",KOe={traceId:bee,spanId:yee,traceFlags:C4.NONE},pw=function(){function e(t){t===void 0&&(t=KOe),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),w5=$Oe("OpenTelemetry Context Key SPAN");function S5(e){return e.getValue(w5)||void 0}function YOe(){return S5(gee.getInstance().active())}function _5(e,t){return e.setValue(w5,t)}function ZOe(e){return e.deleteValue(w5)}function XOe(e,t){return _5(e,new pw(t))}function vee(e){var t;return(t=S5(e))===null||t===void 0?void 0:t.spanContext()}var JOe=/^([0-9a-f]{32})$/i,QOe=/^[0-9a-f]{16}$/i;function eDe(e){return JOe.test(e)&&e!==bee}function tDe(e){return QOe.test(e)&&e!==yee}function xee(e){return eDe(e.traceId)&&tDe(e.spanId)}function nDe(e){return new pw(e)}var Jj=gee.getInstance(),wee=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=Jj.active());var s=!!(n!=null&&n.root);if(s)return new pw;var i=r&&vee(r);return rDe(i)&&xee(i)?new pw(i):new pw},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??Jj.active(),c=this.startSpan(t,i,l),u=_5(l,c);return Jj.with(u,o,void 0,c)}},e}();function rDe(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var sDe=new wee,iDe=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):sDe},e}(),aDe=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new wee},e}(),oDe=new aDe,lq=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new iDe(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:oDe},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),xE;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(xE||(xE={}));var Qj="trace",lDe=function(){function e(){this._proxyTracerProvider=new lq,this.wrapSpanContext=nDe,this.isSpanContextValid=xee,this.deleteSpan=ZOe,this.getSpan=S5,this.getActiveSpan=YOe,this.getSpanContext=vee,this.setSpan=_5,this.setSpanContext=XOe}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=v5(Qj,this._proxyTracerProvider,vE.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return A1(Qj)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){x5(Qj,vE.instance()),this._proxyTracerProvider=new lq},e}(),cDe=lDe.getInstance(),uDe=Object.defineProperty,C5=(e,t)=>{for(var n in t)uDe(e,n,{get:t[n],enumerable:!0})};function wE(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function cq(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function uq({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var See="AI_InvalidArgumentError",_ee=`vercel.ai.error.${See}`,dDe=Symbol.for(_ee),Cee,zc=class extends ar{constructor({parameter:e,value:t,message:n}){super({name:See,message:`Invalid argument for parameter ${e}: ${n}`}),this[Cee]=!0,this.parameter=e,this.value=t}static isInstance(e){return ar.hasMarker(e,_ee)}};Cee=dDe;var kee="AI_RetryError",Eee=`vercel.ai.error.${kee}`,fDe=Symbol.for(Eee),Tee,dq=class extends ar{constructor({message:e,reason:t,errors:n}){super({name:kee,message:e}),this[Tee]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return ar.hasMarker(e,Eee)}};Tee=fDe;var hDe=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>Aee(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function Aee(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(z2(i)||t===0)throw i;const a=Gwe(i),o=[...s,i],l=o.length;if(l>t)throw new dq({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&oc.isInstance(i)&&i.isRetryable===!0&&l<=t)return await Wwe(n),Aee(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new dq({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function pDe({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new zc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new zc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:hDe({maxRetries:t})}}function k4({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function mDe({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var gDe={startSpan(){return JC},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(JC);if(typeof n=="function")return n(JC);if(typeof r=="function")return r(JC)}},JC={spanContext(){return yDe},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},yDe={traceId:"",spanId:"",traceFlags:0};function bDe({isEnabled:e=!1,tracer:t}={}){return e?t||cDe.getTracer("ai"):gDe}function E4({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:xE.ERROR,message:a.message})):i.setStatus({code:xE.ERROR})}finally{i.end()}throw a}})}function sy({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var vDe=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=id(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=zT(this.base64Data)),this.uint8ArrayData}},xDe=class extends vDe{constructor(e){super(e),this.type="file"}},wDe=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],SDe=e=>{const t=typeof e=="string"?zT(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function _De(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?SDe(e):e}function CDe({data:e,signatures:t}){const n=_De(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var Nee="AI_NoObjectGeneratedError",Ree=`vercel.ai.error.${Nee}`,kDe=Symbol.for(Ree),Iee,fq=class extends ar{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:Nee,message:e,cause:t}),this[Iee]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return ar.hasMarker(e,Ree)}};Iee=kDe;var Mee="AI_DownloadError",jee=`vercel.ai.error.${Mee}`,EDe=Symbol.for(jee),Pee,e3=class extends ar{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:Mee,message:s,cause:r}),this[Pee]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return ar.hasMarker(e,jee)}};Pee=EDe;async function TDe({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new e3({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw e3.isInstance(r)?r:new e3({url:n,cause:r})}}var Oee="AI_InvalidDataContentError",Dee=`vercel.ai.error.${Oee}`,ADe=Symbol.for(Dee),Fee,hq=class extends ar{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:Oee,message:n,cause:t}),this[Fee]=!0,this.content=e}static isInstance(e){return ar.hasMarker(e,Dee)}};Fee=ADe;var Lee=xs([qe(),Fk(Uint8Array),Fk(ArrayBuffer),fZ(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function k5(e){return typeof e=="string"?e:e instanceof ArrayBuffer?id(new Uint8Array(e)):id(e)}function SE(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return zT(e)}catch(t){throw new hq({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new hq({content:e})}function NDe(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var $ee="AI_InvalidMessageRoleError",Bee=`vercel.ai.error.${$ee}`,RDe=Symbol.for(Bee),zee,IDe=class extends ar{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:$ee,message:t}),this[zee]=!0,this.role=e}static isInstance(e){return ar.hasMarker(e,Bee)}};zee=RDe;function MDe(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function jDe({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=TDe}){const s=await ODe(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>PDe(i,s))]}function PDe(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>DDe(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:k5(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new IDe({role:c})}}}async function ODe(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function DDe(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=MDe(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=SE(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=SE(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=CDe({data:c,signatures:wDe}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?k5(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function FDe({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new zc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new zc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new zc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new zc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new zc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new zc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new zc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new zc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function pq(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:SE(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:NDe(SE(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var Uee="AI_MessageConversionError",qee=`vercel.ai.error.${Uee}`,LDe=Symbol.for(qee),Vee,t3=class extends ar{constructor({originalMessage:e,message:t}){super({name:Uee,message:t}),this[Vee]=!0,this.originalMessage=e}static isInstance(e){return ar.hasMarker(e,qee)}};Vee=LDe;function $De(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...pq(d)]:u});else{const h=o.parts.filter(p=>p.type==="text").map(p=>({type:"text",text:p.text}));i.push({role:"user",content:d?[...h,...pq(d)]:h})}break}case"assistant":{if(o.parts!=null){let g=function(){const w=[];for(const _ of x)switch(_.type){case"file":case"text":{w.push(_);break}case"reasoning":{for(const k of _.details)switch(k.type){case"text":w.push({type:"reasoning",text:k.text,signature:k.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:k.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:_.toolInvocation.toolCallId,toolName:_.toolInvocation.toolName,args:_.toolInvocation.args});break;default:{const k=_;throw new Error(`Unsupported part: ${k}`)}}i.push({role:"assistant",content:w});const S=x.filter(_=>_.type==="tool-invocation").map(_=>_.toolInvocation);S.length>0&&i.push({role:"tool",content:S.map(_=>{if(!("result"in _))throw new t3({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(_)});const{toolCallId:k,toolName:T,result:A}=_,R=s[T];return(R==null?void 0:R.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:k,toolName:T,result:R.experimental_toToolResultContent(A),experimental_content:R.experimental_toToolResultContent(A)}:{type:"tool-result",toolCallId:k,toolName:T,result:A}})}),x=[],v=!1,y++},y=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&g(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==y&&g(),x.push(w),v=!0;break}}g();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const p=h.reduce((g,y)=>{var v;return Math.max(g,(v=y.step)!=null?v:0)},0);for(let g=0;g<=p;g++){const y=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===g});y.length!==0&&(i.push({role:"assistant",content:[...l&&u&&g===0?[{type:"text",text:u}]:[],...y.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:y.map(v=>{if(!("result"in v))throw new t3({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:S}=v,_=s[w];return(_==null?void 0:_.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:_.experimental_toToolResultContent(S),experimental_content:_.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:x,toolName:w,result:S}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new t3({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var T4=j1e(()=>xs([M1e(),qe(),Nt(),Kn(),tp(qe(),T4),cn(T4)])),vi=tp(qe(),tp(qe(),T4)),BDe=cn(xs([Ze({type:Pn("text"),text:qe()}),Ze({type:Pn("image"),data:qe(),mimeType:qe().optional()})])),Wee=Ze({type:Pn("text"),text:qe(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),zDe=Ze({type:Pn("image"),image:xs([Lee,Fk(URL)]),mimeType:qe().optional(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),Hee=Ze({type:Pn("file"),data:xs([Lee,Fk(URL)]),filename:qe().optional(),mimeType:qe(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),UDe=Ze({type:Pn("reasoning"),text:qe(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),qDe=Ze({type:Pn("redacted-reasoning"),data:qe(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),VDe=Ze({type:Pn("tool-call"),toolCallId:qe(),toolName:qe(),args:Fb(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),WDe=Ze({type:Pn("tool-result"),toolCallId:qe(),toolName:qe(),result:Fb(),content:BDe.optional(),isError:Kn().optional(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),HDe=Ze({role:Pn("system"),content:qe(),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),GDe=Ze({role:Pn("user"),content:xs([qe(),cn(xs([Wee,zDe,Hee]))]),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),KDe=Ze({role:Pn("assistant"),content:xs([qe(),cn(xs([Wee,Hee,UDe,qDe,VDe]))]),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),YDe=Ze({role:Pn("tool"),content:cn(WDe),providerOptions:vi.optional(),experimental_providerMetadata:vi.optional()}),ZDe=xs([HDe,GDe,KDe,YDe]);function XDe({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new qc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new qc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new qc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new qc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=JDe(e.messages)==="ui-messages"?$De(e.messages,{tools:t}):e.messages;if(r.length===0)throw new qc({prompt:e,message:"messages must not be empty"});const s=Db({value:r,schema:cn(ZDe)});if(!s.success)throw new qc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function JDe(e){if(!Array.isArray(e))throw new qc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(QDe);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new qc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function QDe(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function eFe({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function tFe(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var nFe="JSON schema:",rFe="You MUST answer with a JSON object that matches the JSON schema above.",sFe="You MUST answer with JSON.";function iFe({prompt:e,schema:t,schemaPrefix:n=t!=null?nFe:void 0,schemaSuffix:r=t!=null?rFe:sFe}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function n3(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function aFe(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(oFe)}));return JSON.stringify(t)}function oFe(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?k5(e.image):e.image}:e}wg({prefix:"aiobj",size:24});var Wo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function mq(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function lFe(){let e=[],t=null,n=!1,r=mq();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=mq(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function cFe(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}wg({prefix:"aiobj",size:24});var Gee="AI_NoOutputSpecifiedError",Kee=`vercel.ai.error.${Gee}`,uFe=Symbol.for(Kee),Yee,dFe=class extends ar{constructor({message:e="No output specified."}={}){super({name:Gee,message:e}),this[Yee]=!0}static isInstance(e){return ar.hasMarker(e,Kee)}};Yee=uFe;var Zee="AI_ToolExecutionError",Xee=`vercel.ai.error.${Zee}`,fFe=Symbol.for(Xee),Jee,hFe=class extends ar{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${mS(r)}`}){super({name:Zee,message:s,cause:r}),this[Jee]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return ar.hasMarker(e,Xee)}};Jee=fFe;function pFe(e){return e!=null&&Object.keys(e).length>0}function mFe({tools:e,toolChoice:t,activeTools:n}){return pFe(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:IA(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var gFe=/^([\s\S]*?)(\s+)(\S*)$/;function yFe(e){const t=e.match(gFe);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var Qee="AI_InvalidToolArgumentsError",ete=`vercel.ai.error.${Qee}`,bFe=Symbol.for(ete),tte,nte=class extends ar{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${mS(n)}`}){super({name:Qee,message:r,cause:n}),this[tte]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return ar.hasMarker(e,ete)}};tte=bFe;var rte="AI_NoSuchToolError",ste=`vercel.ai.error.${rte}`,vFe=Symbol.for(ste),ite,A4=class extends ar{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:rte,message:n}),this[ite]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return ar.hasMarker(e,ste)}};ite=vFe;var ate="AI_ToolCallRepairError",ote=`vercel.ai.error.${ate}`,xFe=Symbol.for(ote),lte,wFe=class extends ar{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${mS(e)}`}){super({name:ate,message:n,cause:e}),this[lte]=!0,this.originalError=t}static isInstance(e){return ar.hasMarker(e,ote)}};lte=xFe;async function SFe({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new A4({toolName:e.toolName});try{return await gq({toolCall:e,tools:t})}catch(i){if(n==null||!(A4.isInstance(i)||nte.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>IA(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new wFe({cause:o,originalError:i})}if(a==null)throw i;return await gq({toolCall:a,tools:t})}}async function gq({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new A4({toolName:e.toolName,availableTools:Object.keys(t)});const s=IA(r.parameters),i=e.args.trim()===""?Db({value:{},schema:s}):eg({text:e.args,schema:s});if(i.success===!1)throw new nte({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function _Fe(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function yq({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}wg({prefix:"aitxt",size:24});wg({prefix:"msg",size:24});var CFe={};C5(CFe,{object:()=>RFe,text:()=>NFe});var cte="AI_InvalidStreamPartError",ute=`vercel.ai.error.${cte}`,kFe=Symbol.for(ute),dte,EFe=class extends ar{constructor({chunk:e,message:t}){super({name:cte,message:t}),this[dte]=!0,this.chunk=e}static isInstance(e){return ar.hasMarker(e,ute)}};dte=kFe;var TFe="AI_MCPClientError",fte=`vercel.ai.error.${TFe}`,AFe=Symbol.for(fte),hte,ba=class extends ar{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[hte]=!0}static isInstance(e){return ar.hasMarker(e,fte)}};hte=AFe;var NFe=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),RFe=({schema:e})=>{const t=IA(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:iFe({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=cOe(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=eg({text:n});if(!s.success)throw new fq({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=Db({value:s.value,schema:t});if(!i.success)throw new fq({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function IFe(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function MFe({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function E5(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(p=>({result:p,reader:n})),i.then(p=>({result:p,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function jFe({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let p=!1,g;function y(){p&&h.size===0&&(g!=null&&c.enqueue(g),c.close())}const v=new TransformStream({async transform(x,w){const S=x.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new xDe({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const _=await SFe({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(_);const k=e[_.toolName];if(k.execute!=null){const T=wa();h.add(T),E4({name:"ai.toolCall",attributes:sy({telemetry:s,attributes:{...k4({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":_.toolName,"ai.toolCall.id":_.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(_.args)}}}),tracer:r,fn:async A=>k.execute(_.args,{toolCallId:_.toolCallId,messages:a,abortSignal:o}).then(R=>{c.enqueue({..._,type:"tool-result",result:R}),h.delete(T),y();try{A.setAttributes(sy({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(R)}}}))}catch{}},R=>{c.enqueue({type:"error",error:new hFe({toolCallId:_.toolCallId,toolName:_.toolName,toolArgs:_.args,cause:R})}),h.delete(T),y()})})}}catch(_){c.enqueue({type:"error",error:_})}break}case"finish":{g={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:eFe(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const _=S;throw new Error(`Unhandled chunk type: ${_}`)}}},flush(){p=!0,y()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var PFe=wg({prefix:"aitxt",size:24}),OFe=wg({prefix:"msg",size:24});function DFe({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=OFe,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:p,experimental_providerMetadata:g,providerOptions:y=g,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:S,experimental_transform:_,onChunk:k,onError:T,onFinish:A,onStepFinish:R,_internal:{now:M=cFe,generateId:j=PFe,currentDate:F=()=>new Date}={},...P}){return new LFe({model:e,telemetry:p,headers:l,settings:P,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:IFe(_),activeTools:w,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:y,onChunk:k,onError:T,onFinish:A,onStepFinish:R,now:M,currentDate:F,generateId:j,generateMessageId:u})}function FFe(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var LFe=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:p,repairToolCall:g,maxSteps:y,output:v,continueSteps:x,providerOptions:w,now:S,currentDate:_,generateId:k,generateMessageId:T,onChunk:A,onError:R,onFinish:M,onStepFinish:j}){this.warningsPromise=new Wo,this.usagePromise=new Wo,this.finishReasonPromise=new Wo,this.providerMetadataPromise=new Wo,this.textPromise=new Wo,this.reasoningPromise=new Wo,this.reasoningDetailsPromise=new Wo,this.sourcesPromise=new Wo,this.filesPromise=new Wo,this.toolCallsPromise=new Wo,this.toolResultsPromise=new Wo,this.requestPromise=new Wo,this.responsePromise=new Wo,this.stepsPromise=new Wo;var F;if(y<1)throw new zc({parameter:"maxSteps",value:y,message:"maxSteps must be at least 1"});this.output=v;let P="",q="",I="",V=[],D=[],z,$=[];const Y=[],B={id:k(),timestamp:_(),modelId:e.modelId,messages:[]};let G=[],Z=[],ne,ae,le="initial";const Se=[];let Ee;const he=new TransformStream({async transform(fe,ce){ce.enqueue(fe);const{part:se}=fe;if((se.type==="text-delta"||se.type==="reasoning"||se.type==="source"||se.type==="tool-call"||se.type==="tool-result"||se.type==="tool-call-streaming-start"||se.type==="tool-call-delta")&&await(A==null?void 0:A({chunk:se})),se.type==="error"&&await(R==null?void 0:R({error:se.error})),se.type==="text-delta"&&(P+=se.textDelta,q+=se.textDelta,I+=se.textDelta),se.type==="reasoning"&&(z==null?(z={type:"text",text:se.textDelta},V.push(z)):z.text+=se.textDelta),se.type==="reasoning-signature"){if(z==null)throw new ar({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});z.signature=se.signature,z=void 0}if(se.type==="redacted-reasoning"&&V.push({type:"redacted",data:se.data}),se.type==="file"&&D.push(se),se.type==="source"&&(Y.push(se.source),$.push(se.source)),se.type==="tool-call"&&G.push(se),se.type==="tool-result"&&Z.push(se),se.type==="step-finish"){const Pe=yq({text:q,files:D,reasoning:V,tools:c??{},toolCalls:G,toolResults:Z,messageId:se.messageId,generateMessageId:T}),Be=Se.length;let je="done";Be+1<y&&(x&&se.finishReason==="length"&&G.length===0?je="continue":G.length>0&&Z.length===G.length&&(je="tool-result"));const ot={stepType:le,text:P,reasoning:_Fe(V),reasoningDetails:V,files:D,sources:$,toolCalls:G,toolResults:Z,finishReason:se.finishReason,usage:se.usage,warnings:se.warnings,logprobs:se.logprobs,request:se.request,response:{...se.response,messages:[...B.messages,...Pe]},providerMetadata:se.experimental_providerMetadata,experimental_providerMetadata:se.experimental_providerMetadata,isContinued:se.isContinued};await(j==null?void 0:j(ot)),Se.push(ot),G=[],Z=[],P="",$=[],V=[],D=[],z=void 0,je!=="done"&&(le=je),je!=="continue"&&(B.messages.push(...Pe),q="")}se.type==="finish"&&(B.id=se.response.id,B.timestamp=se.response.timestamp,B.modelId=se.response.modelId,B.headers=se.response.headers,ae=se.usage,ne=se.finishReason)},async flush(fe){var ce;try{if(Se.length===0)return;const se=Se[Se.length-1];Ne.warningsPromise.resolve(se.warnings),Ne.requestPromise.resolve(se.request),Ne.responsePromise.resolve(se.response),Ne.toolCallsPromise.resolve(se.toolCalls),Ne.toolResultsPromise.resolve(se.toolResults),Ne.providerMetadataPromise.resolve(se.experimental_providerMetadata),Ne.reasoningPromise.resolve(se.reasoning),Ne.reasoningDetailsPromise.resolve(se.reasoningDetails);const Pe=ne??"unknown",Be=ae??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Ne.finishReasonPromise.resolve(Pe),Ne.usagePromise.resolve(Be),Ne.textPromise.resolve(I),Ne.sourcesPromise.resolve(Y),Ne.filesPromise.resolve(se.files),Ne.stepsPromise.resolve(Se),await(M==null?void 0:M({finishReason:Pe,logprobs:void 0,usage:Be,text:I,reasoning:se.reasoning,reasoningDetails:se.reasoningDetails,files:se.files,sources:se.sources,toolCalls:se.toolCalls,toolResults:se.toolResults,request:(ce=se.request)!=null?ce:{},response:se.response,warnings:se.warnings,providerMetadata:se.providerMetadata,experimental_providerMetadata:se.experimental_providerMetadata,steps:Se})),Ee.setAttributes(sy({telemetry:t,attributes:{"ai.response.finishReason":Pe,"ai.response.text":{output:()=>I},"ai.response.toolCalls":{output:()=>{var je;return(je=se.toolCalls)!=null&&je.length?JSON.stringify(se.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(se){fe.error(se)}finally{Ee.end()}}}),pe=lFe();this.addStream=pe.addStream,this.closeStream=pe.close;let Le=pe.stream;for(const fe of h)Le=Le.pipeThrough(fe({tools:c,stopStream(){pe.terminate()}}));this.baseStream=Le.pipeThrough(FFe(v)).pipeThrough(he);const{maxRetries:He,retry:Fe}=pDe({maxRetries:s}),Ie=bDe(t),X=mDe({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:He}}),ye=XDe({prompt:{system:(F=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?F:a,prompt:o,messages:l},tools:c}),Ne=this;E4({name:"ai.streamText",attributes:sy({telemetry:t,attributes:{...k4({operationId:"ai.streamText",telemetry:t}),...X,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":y}}),tracer:Ie,endWhenDone:!1,fn:async fe=>{Ee=fe;async function ce({currentStep:se,responseMessages:Pe,usage:Be,stepType:je,previousStepText:ot,hasLeadingWhitespace:Et,messageId:ut}){var Pt;const $t=Pe.length===0?ye.type:"messages",Ft=[...ye.messages,...Pe],Ht=await jDe({prompt:{type:$t,system:ye.system,messages:Ft},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Pt=e.supportsUrl)==null?void 0:Pt.bind(e)}),Ce={type:"regular",...mFe({tools:c,toolChoice:u,activeTools:p})},{result:{stream:U,warnings:ee,rawResponse:xe,request:Re},doStreamSpan:ve,startTimestampMs:Me}=await Fe(()=>E4({name:"ai.streamText.doStream",attributes:sy({telemetry:t,attributes:{...k4({operationId:"ai.streamText.doStream",telemetry:t}),...X,"ai.prompt.format":{input:()=>$t},"ai.prompt.messages":{input:()=>aFe(Ht)},"ai.prompt.tools":{input:()=>{var Gt;return(Gt=Ce.tools)==null?void 0:Gt.map(rn=>JSON.stringify(rn))}},"ai.prompt.toolChoice":{input:()=>Ce.toolChoice!=null?JSON.stringify(Ce.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Ie,endWhenDone:!1,fn:async Gt=>({startTimestampMs:S(),doStreamSpan:Gt,result:await e.doStream({mode:Ce,...FDe(r),inputFormat:$t,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:Ht,providerMetadata:w,abortSignal:i,headers:n})})})),de=jFe({tools:c,generatorStream:U,toolCallStreaming:d,tracer:Ie,telemetry:t,system:a,messages:Ft,repairToolCall:g,abortSignal:i}),ht=Re??{},et=[],W=[],Ve=[],tt=[];let we,Te="unknown",Ue={promptTokens:0,completionTokens:0,totalTokens:0},Ct,me=!0,Q="",J=je==="continue"?ot:"",te,_e={id:k(),timestamp:_(),modelId:e.modelId},$e="",Ge=!1,wt=!0,Jt=!1;async function jn({controller:Gt,chunk:rn}){Gt.enqueue(rn),Q+=rn.textDelta,J+=rn.textDelta,Ge=!0,Jt=rn.textDelta.trimEnd()!==rn.textDelta}Ne.addStream(de.pipeThrough(new TransformStream({async transform(Gt,rn){var dn,br,Cr;if(me){const Qr=S()-Me;me=!1,ve.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":Qr}),ve.setAttributes({"ai.response.msToFirstChunk":Qr}),rn.enqueue({type:"step-start",messageId:ut,request:ht,warnings:ee??[]})}if(Gt.type==="text-delta"&&Gt.textDelta.length===0)return;const Jr=Gt.type;switch(Jr){case"text-delta":{if(x){const Qr=wt&&Et?Gt.textDelta.trimStart():Gt.textDelta;if(Qr.length===0)break;wt=!1,$e+=Qr;const Sr=yFe($e);Sr!=null&&($e=Sr.suffix,await jn({controller:rn,chunk:{type:"text-delta",textDelta:Sr.prefix+Sr.whitespace}}))}else await jn({controller:rn,chunk:Gt});break}case"reasoning":{rn.enqueue(Gt),we==null?(we={type:"text",text:Gt.textDelta},Ve.push(we)):we.text+=Gt.textDelta;break}case"reasoning-signature":{if(rn.enqueue(Gt),we==null)throw new EFe({chunk:Gt,message:"reasoning-signature without reasoning"});we.signature=Gt.signature,we=void 0;break}case"redacted-reasoning":{rn.enqueue(Gt),Ve.push({type:"redacted",data:Gt.data});break}case"tool-call":{rn.enqueue(Gt),et.push(Gt);break}case"tool-result":{rn.enqueue(Gt),W.push(Gt);break}case"response-metadata":{_e={id:(dn=Gt.id)!=null?dn:_e.id,timestamp:(br=Gt.timestamp)!=null?br:_e.timestamp,modelId:(Cr=Gt.modelId)!=null?Cr:_e.modelId};break}case"finish":{Ue=Gt.usage,Te=Gt.finishReason,Ct=Gt.experimental_providerMetadata,te=Gt.logprobs;const Qr=S()-Me;ve.addEvent("ai.stream.finish"),ve.setAttributes({"ai.response.msToFinish":Qr,"ai.response.avgCompletionTokensPerSecond":1e3*Ue.completionTokens/Qr});break}case"file":{tt.push(Gt),rn.enqueue(Gt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{rn.enqueue(Gt);break}case"error":{rn.enqueue(Gt),Te="error";break}default:{const Qr=Jr;throw new Error(`Unknown chunk type: ${Qr}`)}}},async flush(Gt){const rn=et.length>0?JSON.stringify(et):void 0;let dn="done";se+1<y&&(x&&Te==="length"&&et.length===0?dn="continue":et.length>0&&W.length===et.length&&(dn="tool-result")),x&&$e.length>0&&(dn!=="continue"||je==="continue"&&!Ge)&&(await jn({controller:Gt,chunk:{type:"text-delta",textDelta:$e}}),$e="");try{ve.setAttributes(sy({telemetry:t,attributes:{"ai.response.finishReason":Te,"ai.response.text":{output:()=>Q},"ai.response.toolCalls":{output:()=>rn},"ai.response.id":_e.id,"ai.response.model":_e.modelId,"ai.response.timestamp":_e.timestamp.toISOString(),"ai.usage.promptTokens":Ue.promptTokens,"ai.usage.completionTokens":Ue.completionTokens,"gen_ai.response.finish_reasons":[Te],"gen_ai.response.id":_e.id,"gen_ai.response.model":_e.modelId,"gen_ai.usage.input_tokens":Ue.promptTokens,"gen_ai.usage.output_tokens":Ue.completionTokens}}))}catch{}finally{ve.end()}Gt.enqueue({type:"step-finish",finishReason:Te,usage:Ue,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:te,request:ht,response:{..._e,headers:xe==null?void 0:xe.headers},warnings:ee,isContinued:dn==="continue",messageId:ut});const br=tFe(Be,Ue);if(dn==="done")Gt.enqueue({type:"finish",finishReason:Te,usage:br,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:te,response:{..._e,headers:xe==null?void 0:xe.headers}}),Ne.closeStream();else{if(je==="continue"){const Cr=Pe[Pe.length-1];typeof Cr.content=="string"?Cr.content+=Q:Cr.content.push({text:Q,type:"text"})}else Pe.push(...yq({text:Q,files:tt,reasoning:Ve,tools:c??{},toolCalls:et,toolResults:W,messageId:ut,generateMessageId:T}));await ce({currentStep:se+1,responseMessages:Pe,usage:br,stepType:dn,previousStepText:J,hasLeadingWhitespace:Jt,messageId:dn==="continue"?ut:T()})}}})))}await ce({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:T()})}}).catch(fe=>{Ne.addStream(new ReadableStream({start(ce){ce.enqueue({type:"error",error:fe}),ce.close()}})),Ne.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return n3(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return n3(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await MFe({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new dFe;return n3(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Ha("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Ha("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Ha("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Ha("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Ha("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Ha("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Ha("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Ha("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Ha("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Ha("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Ha("error",e(i.error)));break}case"step-start":{a.enqueue(Ha("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Ha("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Ha("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){uq({response:e,status:t,statusText:n,headers:cq(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){uq({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:cq(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?E5(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:wE(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:wE(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var pte="2024-11-05",$Fe=[pte,"2024-10-07"],BFe=Ze({name:qe(),version:qe()}).passthrough(),T5=Ze({_meta:va(Ze({}).passthrough())}).passthrough(),N1=T5,zFe=Ze({method:qe(),params:va(T5)}),UFe=Ze({experimental:va(Ze({}).passthrough()),logging:va(Ze({}).passthrough()),prompts:va(Ze({listChanged:va(Kn())}).passthrough()),resources:va(Ze({subscribe:va(Kn()),listChanged:va(Kn())}).passthrough()),tools:va(Ze({listChanged:va(Kn())}).passthrough())}).passthrough(),qFe=N1.extend({protocolVersion:qe(),capabilities:UFe,serverInfo:BFe,instructions:va(qe())}),VFe=N1.extend({nextCursor:va(qe())}),WFe=Ze({name:qe(),description:va(qe()),inputSchema:Ze({type:Pn("object"),properties:va(Ze({}).passthrough())}).passthrough()}).passthrough(),HFe=VFe.extend({tools:cn(WFe)}),GFe=Ze({type:Pn("text"),text:qe()}).passthrough(),KFe=Ze({type:Pn("image"),data:qe().base64(),mimeType:qe()}).passthrough(),mte=Ze({uri:qe(),mimeType:va(qe())}).passthrough(),YFe=mte.extend({text:qe()}),ZFe=mte.extend({blob:qe().base64()}),XFe=Ze({type:Pn("resource"),resource:xs([YFe,ZFe])}).passthrough(),JFe=N1.extend({content:cn(xs([GFe,KFe,XFe])),isError:Kn().default(!1).optional()}).or(N1.extend({toolResult:Fb()})),MA="2.0",QFe=Ze({jsonrpc:Pn(MA),id:xs([qe(),Nt().int()])}).merge(zFe).strict(),e5e=Ze({jsonrpc:Pn(MA),id:xs([qe(),Nt().int()]),result:N1}).strict(),t5e=Ze({jsonrpc:Pn(MA),id:xs([qe(),Nt().int()]),error:Ze({code:Nt().int(),message:qe(),data:va(Fb())})}).strict(),n5e=Ze({jsonrpc:Pn(MA)}).merge(Ze({method:qe(),params:va(T5)})).strict(),r5e=xs([QFe,n5e,e5e,t5e]),s5e=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new ba({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(aZ()).getReader(),u=async()=>{var d,h,p;try{for(;;){const{done:g,value:y}=await c.read();if(g){if(this.connected)throw this.connected=!1,new ba({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=y;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new ba({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=r5e.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const S=new ba({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,S)}}}catch(g){if(g instanceof Error&&g.name==="AbortError")return;(p=this.onerror)==null||p.call(this,g),t(g)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new ba({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new ba({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function i5e(e){if(e.type!=="sse")throw new ba({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new s5e(e)}function a5e(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var o5e="1.0.0";async function bq(e){const t=new l5e(e);return await t.init(),t}var l5e=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,a5e(e)?this.transport=e:this.transport=i5e(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new ba({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:o5e}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:pte,capabilities:{},clientInfo:this.clientInfo}},resultSchema:qFe});if(e===void 0)throw new ba({message:"Server sent invalid initialize result"});if(!$Fe.includes(e.protocolVersion))throw new ba({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new ba({message:"Server does not support tools"});break;default:throw new ba({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new ba({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new ba({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new ba({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:HFe,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:JFe,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?mee({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new ba({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new ba({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new ba({message:e.error.message,cause:e.error}))}},c5e={};C5(c5e,{mergeIntoDataStream:()=>f5e,toDataStream:()=>u5e,toDataStreamResponse:()=>d5e});function gte(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function A5(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&vq((s=n.data)==null?void 0:s.chunk,r);return}vq(n,r)}})).pipeThrough(gte(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Ha("text",n))}}))}function u5e(e,t){return A5(e,t).pipeThrough(new TextEncoderStream)}function d5e(e,t){var n;const r=A5(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?E5(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:wE(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function f5e(e,t){t.dataStream.merge(A5(e,t.callbacks))}function vq(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var h5e={};C5(h5e,{mergeIntoDataStream:()=>g5e,toDataStream:()=>p5e,toDataStreamResponse:()=>m5e});function N5(e,t){const n=y5e();return Vwe(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(gte(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Ha("text",r))}}))}function p5e(e,t){return N5(e,t).pipeThrough(new TextEncoderStream)}function m5e(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=N5(e,i).pipeThrough(new TextEncoderStream),o=s?E5(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:wE(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function g5e(e,t){t.dataStream.merge(N5(e,t.callbacks))}function y5e(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class b5e{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await DFe(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const v5e=".litechat/conversations",yte="/synced_repos";async function x5e(e,t,n,r=!1){n(t.id,"syncing");const s=Hr(`${yte}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(cd(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||ke.info(`Pulling latest changes for "${t.name}"...`),await SA(s,a,i,{fsInstance:e}),r||ke.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||ke.info(`Cloning repository "${t.name}"...`),await pQ(s,t.remoteUrl,a,i,{fsInstance:e}),r||ke.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function w5e(e,t,n,r,s,i,a,o=!1){var h,p;r(t.id,"syncing");const l=Hr(`${yte}/${n.id}`),c=cd(l,v5e,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(cd(l,".git"))}catch(w){if(w.code==="ENOENT"){ke.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||ke.info(`Pulling latest changes for "${n.name}"...`),await SA(l,d,u,{fsInstance:e});let g=null,y=null;try{const w=await Mp(c,{fsInstance:e}),S=new TextDecoder().decode(w);g=JSON.parse(S),y=(h=g==null?void 0:g.conversation)!=null&&h.updatedAt?new Date(g.conversation.updatedAt).getTime():null,isNaN(y??NaN)&&(y=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),ke.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((p=t.lastSyncedAt)==null?void 0:p.getTime())??0;if(!g||v>(y??0)||v>x&&v>=(y??0)){o||ke.info("Local changes detected. Pushing to remote...");const w=await dt.loadInteractionsForConversation(t.id),{lastSyncedAt:S,..._}=t,k=JSON.stringify({conversation:_,interactions:w},null,2);await _A(c,k,{fsInstance:e}),await o5(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await l5(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||ke.success("Conversation synced successfully (pushed).")}else if(y&&y>v){o||ke.info("Remote changes detected. Updating local conversation...");const w={...g.conversation,createdAt:new Date(g.conversation.createdAt),updatedAt:new Date(g.conversation.updatedAt),lastSyncedAt:new Date};await dt.saveConversation(w),await dt.deleteInteractionsForConversation(t.id);const S=g.interactions.map(_=>dt.saveInteraction({..._,conversationId:t.id,startedAt:_.startedAt?new Date(_.startedAt):null,endedAt:_.endedAt?new Date(_.endedAt):null}));await Promise.all(S),i()===t.id&&a()==="conversation"&&await en.getState().loadInteractions(t.id),r(t.id,"idle"),o||ke.success("Conversation synced successfully (pulled).")}else o||ke.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(g){console.error(`Sync failed for conversation ${t.id}:`,g),r(t.id,"error",g.message)}}const Da={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},rr={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},no=Do(Fo((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await dt.loadProjects();e({projects:n,isLoading:!1}),Ae.emit(Da.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Ae.emit(Da.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=dr(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=Hr(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await dt.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Ae.emit(Da.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=Hr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await dt.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Ae.emit(Da.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await dt.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Ae.emit(rr.loadConversationsRequest,void 0),Ae.emit(Da.deleted,{projectId:n}),ke.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=gr.getState(),s=Gn.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Da.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:Da.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:Da.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:Da.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),Rh=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},S5e=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${zu(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${zu(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${i1(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class iy{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>dt.saveInteraction({...u,conversationId:l,id:dr()}));await Promise.all(c),await r(l,"conversation"),ke.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),ke.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=On.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await dt.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=S5e(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");Rh(i,a),ke.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),ke.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=no.getState(),{conversations:s}=On.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const p=n.find(x=>x.id===h);if(!p)throw new Error(`Project ${h} not found in state.`);const g=n.filter(x=>x.parentId===h),y=s.filter(x=>x.projectId===h),v=[];for(const x of g)v.push(await a(x.id));for(const x of y){const w=await dt.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:p,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;Rh(c,d),ke.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),ke.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=On.getState().conversations,n=[];for(const a of t){const o=await dt.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;Rh(s,i),ke.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await dt.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_full_config_${zu(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Rh(s,a),ke.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),ke.error(`Export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportPromptTemplates(){try{const n=(await dt.loadPromptTemplates()).filter(l=>!l.type||l.type==="prompt"),r={version:1,exportedAt:new Date().toISOString(),promptTemplates:n},s=JSON.stringify(r,null,2),i=new Blob([s],{type:"application/json"}),o=`litechat_prompt_templates_${zu(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Rh(i,o),ke.success(`Exported ${n.length} prompt templates.`)}catch(t){throw console.error("ImportExportService: Error exporting prompt templates",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportAgents(){try{const t=await dt.loadPromptTemplates(),n=t.filter(u=>u.type==="agent"),r=n.map(u=>u.id),s=t.filter(u=>u.type==="task"&&u.parentId&&r.includes(u.parentId)),i={version:1,exportedAt:new Date().toISOString(),agents:[...n,...s]},a=JSON.stringify(i,null,2),o=new Blob([a],{type:"application/json"}),c=`litechat_agents_${zu(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Rh(o,c),ke.success(`Exported ${n.length} agents with ${s.length} tasks.`)}catch(t){throw console.error("ImportExportService: Error exporting agents",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportMcpServers(){try{const t=await dt.loadSetting("mcpServers",[]),n={version:1,exportedAt:new Date().toISOString(),mcpServers:t},r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_mcp_servers_${zu(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Rh(s,a),ke.success(`Exported ${t.length} MCP server configurations.`)}catch(t){throw console.error("ImportExportService: Error exporting MCP servers",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await dt.importAllData(s,n),ke.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),ke.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}static async importPromptTemplates(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.promptTemplates||!Array.isArray(r.promptTemplates))throw new Error("Invalid prompt templates file format.");let s=0;for(const i of r.promptTemplates)try{await dt.savePromptTemplate({...i,id:i.id||dr(),createdAt:i.createdAt?new Date(i.createdAt):new Date,updatedAt:new Date}),s++}catch(a){console.warn(`Failed to import template ${i.name}:`,a)}ke.success(`Imported ${s} prompt templates.`)}catch(n){throw console.error("ImportExportService: Error importing prompt templates",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importAgents(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.agents||!Array.isArray(r.agents))throw new Error("Invalid agents file format.");let s=0,i=0;for(const a of r.agents)try{await dt.savePromptTemplate({...a,id:a.id||dr(),createdAt:a.createdAt?new Date(a.createdAt):new Date,updatedAt:new Date}),a.type==="agent"?s++:a.type==="task"&&i++}catch(o){console.warn(`Failed to import ${a.type} ${a.name}:`,o)}ke.success(`Imported ${s} agents with ${i} tasks.`)}catch(n){throw console.error("ImportExportService: Error importing agents",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importMcpServers(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.mcpServers||!Array.isArray(r.mcpServers))throw new Error("Invalid MCP servers file format.");await dt.saveSetting("mcpServers",r.mcpServers),ke.success(`Imported ${r.mcpServers.length} MCP server configurations.`)}catch(n){throw console.error("ImportExportService: Error importing MCP servers",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportWorkflows(){try{const t=await dt.loadWorkflows(),n={version:1,exportedAt:new Date().toISOString(),workflows:t},r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_workflows_${zu(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Rh(s,a),ke.success(`Exported ${t.length} workflows.`)}catch(t){throw console.error("ImportExportService: Error exporting workflows",t),ke.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async importWorkflows(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.workflows||!Array.isArray(r.workflows))throw new Error("Invalid workflows file format.");let s=0;for(const i of r.workflows)try{await dt.saveWorkflow({...i,id:i.id||dr(),createdAt:i.createdAt?i.createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),s++}catch(a){console.warn(`Failed to import workflow ${i.name}:`,a)}ke.success(`Imported ${s} workflows.`)}catch(n){throw console.error("ImportExportService: Error importing workflows",n),ke.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}}const Tu="sync_repos",gs={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},oi=Do(Fo((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Ae.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Ae.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&ke.error(`VFS Error: ${n}`)}),Ae.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Ae.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Ae.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Ae.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Ae.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Ae.emit(hn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Ae.emit(hn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Ae.emit(hn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Ae.emit(hn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Ae.emit(hn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((p,g)=>{const y=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(y),v.configuredVfsKey===s&&v.fs?p(v.fs):g(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(y),g(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await FIe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const y=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${y}`),e({initializingKey:null,loading:!1}),new Error(y)}if(a)return u(h),d(s),e({initializingKey:null}),Ae.emit(hn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const p="vfs-root";let g=t().nodes[p];try{await h.promises.stat("/")}catch(y){if(y.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw y}if(!g||g.path!=="/"){const y=Date.now();g={id:p,parentId:null,name:"",path:"/",type:"folder",createdAt:y,lastModified:y},c([g])}return e(y=>{y.rootId=g.id,y.currentParentId=g.id}),await t().fetchNodes(g.id),h}catch(h){const p=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${p}`,h),t().initializingKey===s&&(l(p),a||(u(null),d(null))),new Error(p)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],p=h?h.path:"/",g=await c5(p,{fsInstance:a}),y=n??l??"",v=new Set(g.map(k=>k.path)),S=(t().childrenMap[y]||[]).map(k=>t().nodes[k]).filter(Boolean).filter(k=>!v.has(k.path)).map(k=>k.id);S.length>0&&t()._removeNodes(S);const _=g.map(k=>{const T=Object.values(t().nodes).find(R=>R.path===k.path),A=Date.now();return{id:(T==null?void 0:T.id)||dr(),parentId:n,name:k.name,path:k.path,type:k.isDirectory?"folder":"file",size:k.size,createdAt:(T==null?void 0:T.createdAt)??A,lastModified:k.lastModified.getTime(),mimeType:k.isDirectory?void 0:k.mimeType}});_.length>0&&i(_),e(k=>{const T=_.map(A=>A.id);(!k.childrenMap[y]||JSON.stringify(k.childrenMap[y].sort())!==JSON.stringify(T.sort()))&&(k.childrenMap[y]=T)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=Hr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=Hr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],p=h?h.path:"/",g=p4(p,r.trim());try{throw await a.promises.stat(g),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await yQ(g,{fsInstance:a});const y=Date.now(),x={id:dr(),parentId:n,name:r.trim(),path:g,type:"folder",createdAt:y,lastModified:y};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await bQ(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await u5(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const p=h.parentId?o[h.parentId]:o[c||""],g=p?p.path:"/",y=p4(g,r.trim());try{throw await l.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await vQ(h.path,y,{fsInstance:l});const v={name:r.trim(),path:y,lastModified:Date.now()};a(n,v)}catch(p){console.error("Failed to rename item:",p),i(p.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await Mp(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Ae.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Ae.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Ae.emit(hn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:hn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:hn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:hn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:hn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:hn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:hn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:hn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:hn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:hn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:hn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:hn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:hn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:hn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),_5e="/synced_repos",On=Do(Fo((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),oi.getState().initializingKey===Tu&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),oi.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{Ae.off(hn.fsInstanceChanged,o),Ae.off(hn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{oi.getState().configuredVfsKey===Tu&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${Tu}.`),a(),r(u.fsInstance))},l=u=>{const d=oi.getState();d.configuredVfsKey===Tu&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${Tu}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${Tu}.`),a(),r(d.fs)))};Ae.on(hn.fsInstanceChanged,o),Ae.on(hn.loadingStateChanged,l);const c=oi.getState();if(c.configuredVfsKey===Tu&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${Tu}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${Tu}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),Ae.emit(hn.initializeVFSRequest,{vfsKey:Tu,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([dt.loadConversations(),dt.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Ae.emit(rr.conversationsLoaded,{conversations:n}),Ae.emit(rr.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Ae.emit(rr.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=dr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await dt.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Ae.emit(rr.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(g=>g in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,p=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||p>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await dt.saveConversation(a),Ae.emit(rr.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await dt.deleteConversation(n),await dt.deleteInteractionsForConversation(n),Ae.emit(rr.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Ae.emit(xn.setCurrentConversationIdRequest,{id:null}),Ae.emit(rr.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Ae.emit(xn.setCurrentConversationIdRequest,{id:a}),Ae.emit(xn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Ae.emit(rr.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await iy.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await iy.exportConversation(n,r)},exportProject:async n=>{await iy.exportProject(n)},exportAllConversations:async()=>{await iy.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await dt.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Ae.emit(rr.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Ae.emit(rr.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=dr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await dt.saveSyncRepo(o),Ae.emit(gs.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");ke.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),ke.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await dt.saveSyncRepo(a),Ae.emit(gs.repoChanged,{repoId:n,action:"updated"}),ke.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),ke.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await dt.deleteSyncRepo(n);const i=Hr(`${_5e}/${n}`);try{await u5(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Ae.emit(gs.repoChanged,{repoId:n,action:"deleted"}),ke.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),ke.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Ae.emit(rr.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Ae.emit(gs.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||ke.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await x5e(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||ke.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||ke.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||ke.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await w5e(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Cy);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Cy);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Cy);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:rr.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:rr.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:rr.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:rr.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:rr.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:rr.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:rr.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:rr.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:rr.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:rr.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:rr.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:rr.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:rr.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:rr.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:rr.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:rr.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:rr.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),ta={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",forkConversationRequest:"canvas.interaction.fork.conversation.request",forkConversationWithModelRequest:"canvas.interaction.fork.conversation.with.model.request",forkConversationCompactRequest:"canvas.interaction.fork.conversation.compact.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request",editCodeBlockRequest:"canvas.codeblock.edit.request"},Bh={async submitPrompt(e){var j,F,P,q,I,V;console.log("[ConversationService] submitPrompt called",e);const t=en.getState(),n=no.getState(),r=Qa.getState(),s=On.getState(),i=gr.getState(),a=t.currentConversationId;if(!a){ke.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(D=>D.conversationId===a).length===0&&i.autoTitleEnabled&&((j=e.metadata)==null?void 0:j.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,p=t.interactions.filter(D=>D.parentId===null&&D.status==="COMPLETED").sort((D,z)=>D.index-z.index).map(D=>{var z;if(D.type==="message.assistant_regen"&&((z=D.metadata)!=null&&z.regeneratedFromId)){const $=t.interactions.find(Y=>Y.id===D.metadata.regeneratedFromId);if($&&$.prompt&&$.type==="message.user_assistant")return{...D,prompt:$.prompt,type:"message.user_assistant"}}return D.type==="message.user_assistant"&&D.prompt?D:null}).filter(Boolean),g=fw(p);let y=e.content;const v=[],x=((F=e.metadata)==null?void 0:F.effectiveRulesContent)??[],w=x.filter(D=>D.type==="system").map(D=>D.content),S=x.filter(D=>D.type==="before").map(D=>D.content),_=x.filter(D=>D.type==="after").map(D=>D.content);S.length>0&&(y=`${S.join(`
`)}

${y}`),_.length>0&&(y=`${y}

    ${_.join(`
`)}`),y&&v.push({type:"text",text:y});const k=((P=e.metadata)==null?void 0:P.attachedFiles)??[];if(k.length>0){const D=await this._processFilesForPrompt(k,a);v.unshift(...D)}v.length>0?g.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let A=((q=e.metadata)==null?void 0:q.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(A=`${A?`${A}

        `:""}${w.join(`
`)}`);const R={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(R).forEach(D=>{(R[D]===null||R[D]===void 0)&&delete R[D]});const M={system:A,messages:g,parameters:R,metadata:{...(({turnSystemPrompt:D,activeTagIds:z,activeRuleIds:$,effectiveRulesContent:Y,autoTitleEnabledForTurn:B,...G})=>({...G,effectivelyAppliedTagIds:z,effectivelyAppliedRuleIds:$}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(I=e.metadata.attachedFiles)==null?void 0:I.map(({contentBase64:D,contentText:z,...$})=>$)}};try{const D=Rl.startInteraction(M,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const z=(((V=e.metadata)==null?void 0:V.effectiveRulesContent)??[]).map($=>({id:$.sourceRuleId||dr(),name:$.sourceRuleId?`Rule ${$.sourceRuleId.substring(0,4)}`:"Context Rule",content:$.content,type:$.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,z).catch($=>{console.error("[ConversationService] Background title generation failed:",$)})}await D}catch(D){throw console.error("[ConversationService] Error starting interaction:",D),ke.error(`Failed to start interaction: ${D instanceof Error?D.message:String(D)}`),D}},async generateConversationTitle(e,t,n){var o,l;const r=gr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:dr(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await Rl.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var P,q,I,V;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=en.getState(),n=no.getState(),r=Qa.getState(),s=On.getState(),i=t.interactions.find(D=>D.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){ke.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),p=i.index,g=t.interactions.filter(D=>D.conversationId===c&&D.index<p&&D.status==="COMPLETED"&&D.type==="message.user_assistant"&&D.parentId===null).sort((D,z)=>D.index-z.index),y=fw(g);let v=l.content;const x=[],w=((P=l.metadata)==null?void 0:P.effectiveRulesContent)??[],S=w.filter(D=>D.type==="system").map(D=>D.content),_=w.filter(D=>D.type==="before").map(D=>D.content),k=w.filter(D=>D.type==="after").map(D=>D.content);_.length>0&&(v=`${_.join(`
`)}

${v}`),k.length>0&&(v=`${v}

    ${k.join(`
`)}`),v&&x.push({type:"text",text:v});const T=((q=l.metadata)==null?void 0:q.attachedFiles)??[];if(T.length>0){const D=await this._processFilesForPrompt(T,c);x.unshift(...D)}x.length>0?y.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let R=((I=l.metadata)==null?void 0:I.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(R=`${R?`${R}

        `:""}${S.join(`
`)}`);const M={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(M).forEach(D=>{(M[D]===null||M[D]===void 0)&&delete M[D]});const j={system:R,messages:y,parameters:M,metadata:{...(({turnSystemPrompt:D,activeTagIds:z,activeRuleIds:$,effectiveRulesContent:Y,autoTitleEnabledForTurn:B,...G})=>({...G,effectivelyAppliedTagIds:z,effectivelyAppliedRuleIds:$}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:T.map(({contentBase64:D,contentText:z,...$})=>$)}};let F=null;try{if(F=await Rl.startInteraction(j,c,l,"message.assistant_regen"),!F)throw new Error("Failed to create new interaction for regeneration.");const D={};let z=!1;F.index!==o&&(D.index=o,z=!0),F.parentId!==a&&(D.parentId=a,z=!0);let $=F;z&&(t._updateInteractionInState(F.id,D),$={...F,...D},await dt.saveInteraction($)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify($)));const Y=[];let B=i;for(;B;){Y.push(B);const Z=(V=B.metadata)==null?void 0:V.regeneratedFromId;Z?B=t.interactions.find(ne=>ne.id===Z):B=null}const G=Y.sort((Z,ne)=>{var Se,Ee;const ae=((Se=Z.startedAt)==null?void 0:Se.getTime())??0,le=((Ee=ne.startedAt)==null?void 0:Ee.getTime())??0;return ae-le});for(let Z=0;Z<G.length;Z++){const ne=G[Z],ae={parentId:$.id,index:Z};console.log(`[ConversationService] Updating old version ${ne.id} to be child of ${$.id} with childIndex ${Z}`,JSON.parse(JSON.stringify(ae))),t._updateInteractionInState(ne.id,ae),await dt.saveInteraction({...ne,...ae})}}catch(D){throw console.error("[ConversationService] Error during regeneration process:",D),ke.error(`Failed to regenerate response: ${D instanceof Error?D.message:String(D)}`),D}},_pendingForks:new Set,_pendingCompactForks:new Set,async forkConversation(e){if(console.log(`[ConversationService] forkConversation called for ID: ${e}`),this._pendingForks.has(e)){console.warn(`[ConversationService] Fork already in progress for ${e}`),ke.info("Fork already in progress for this interaction.");return}this._pendingForks.add(e);try{const t=en.getState(),n=On.getState(),r=t.interactions.find(l=>l.id===e);if(!r){ke.error("Cannot fork: Interaction not found.");return}const s=n.getConversationById(r.conversationId);if(!s){ke.error("Cannot fork: Original conversation not found.");return}const i=t.interactions.filter(l=>l.conversationId===r.conversationId&&l.index<=r.index&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),a=`Fork: ${s.title}`,o=await n.addConversation({title:a,projectId:s.projectId,metadata:s.metadata});for(let l=0;l<i.length;l++){const c=i[l],u={...c,id:dr(),conversationId:o,index:l,parentId:null,startedAt:new Date,endedAt:c.endedAt?new Date:null,metadata:{...c.metadata,forkedFromId:c.id}};await dt.saveInteraction(u)}await n.selectItem(o,"conversation"),Ae.emit(an.focusInputRequest,void 0),ke.success(`Conversation forked successfully: "${a}"`)}catch(t){throw console.error("[ConversationService] Error during fork process:",t),ke.error(`Failed to fork conversation: ${t instanceof Error?t.message:String(t)}`),t}finally{this._pendingForks.delete(e)}},async forkConversationCompact(e,t){if(console.log(`[ConversationService] forkConversationCompact called for ID: ${e} with model: ${t}`),this._pendingCompactForks.has(e)){console.warn(`[ConversationService] Compact fork already in progress for ${e}`),ke.info("Compact fork already in progress for this interaction.");return}this._pendingCompactForks.add(e);try{const n=en.getState(),r=On.getState(),s=gr.getState(),i=n.interactions.find(T=>T.id===e);if(!i){ke.error("Cannot fork compact: Interaction not found.");return}const a=r.getConversationById(i.conversationId);if(!a){ke.error("Cannot fork compact: Original conversation not found.");return}const o=n.interactions.filter(T=>T.conversationId===i.conversationId&&T.index<=i.index&&T.parentId===null&&(T.type==="message.user_assistant"||T.type==="message.assistant_regen")).sort((T,A)=>T.index-A.index),l=fw(o),c=T=>typeof T=="string"?T:Array.isArray(T)?T.map(A=>A.type==="text"?A.text:A.type==="image"?"[Image attached]":`[${A.type||"Content"} attached]`).join(" "):typeof T=="object"&&T!==null?"text"in T&&typeof T.text=="string"?T.text:"[Non-text content]":String(T),u=l.map(T=>`**${T.role.toUpperCase()}:** ${c(T.content)}`).join(`

`),d=s.forkCompactPrompt,p=d?`${d}

Here is our conversation history to summarize:

${u}`:`Please provide a comprehensive but concise summary of our previous conversation. Include:
1. The main topics discussed
2. Key decisions or conclusions reached
3. Important context that would be needed to continue the conversation
4. Any specific technical details, code, or data that were mentioned

Keep the summary detailed enough that we can seamlessly continue our discussion, but compact enough to be efficient.

Here is our conversation history to summarize:

${u}`,g=s.forkCompactModelId||t,y={system:"You are an expert at creating comprehensive conversation summaries. Provide a detailed but concise summary that captures all important context and information needed to continue the conversation seamlessly.",messages:[{role:"user",content:p}],parameters:{temperature:.3,max_tokens:2e3},metadata:{modelId:g,isCompactGeneration:!0},tools:void 0,toolChoice:"none"},v=`Compact: ${a.title}`,x=await r.addConversation({title:v,projectId:a.projectId,metadata:a.metadata}),w=`Please provide a comprehensive summary of our previous conversation titled "${a.title}". Include the main topics, key decisions, and important context needed to continue seamlessly.`,S={id:dr(),conversationId:x,type:"message.user_assistant",prompt:{id:dr(),content:w,parameters:{},metadata:{isResumeMessage:!0,originalConversationId:i.conversationId,compactedFromInteractionId:e}},response:"Compacting...",status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{isResumeMessage:!0,originalConversationId:i.conversationId,compactedFromInteractionId:e,isCompactingInProgress:!0},index:0,parentId:null};await dt.saveInteraction(S),en.getState()._addInteractionToState(S),await r.selectItem(x,"conversation"),await new Promise(T=>{const A=R=>{R.conversationId===x&&(Ae.off(xn.loaded,A),T())};Ae.on(xn.loaded,A),setTimeout(()=>{Ae.off(xn.loaded,A),T()},2e3)});const k={id:dr(),content:`[Internal compact generation for conversation ${e}]`,parameters:y.parameters,metadata:{...y.metadata,originalConversationId:i.conversationId,compactedFromInteractionId:e,targetUserInteractionId:S.id,targetConversationId:x}};await Rl.startInteraction(y,x,k,"conversation.compact"),Ae.emit(an.focusInputRequest,void 0),ke.success(`Conversation compacted and forked: "${v}"`)}catch(n){throw console.error("[ConversationService] Error during compact fork process:",n),ke.error(`Failed to fork and compact conversation: ${n instanceof Error?n.message:String(n)}`),n}finally{this._pendingCompactForks.delete(e)}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=On.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{ke.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=R9(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await Mp(i.path,{fsInstance:s});a=R9({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{oi.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(oi.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=oi.getState().fs;l&&(i(),t(l))}},i=()=>{Ae.off(hn.fsInstanceChanged,r),Ae.off(hn.loadingStateChanged,s)};Ae.on(hn.fsInstanceChanged,r),Ae.on(hn.loadingStateChanged,s);const a=oi.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Ae.emit(hn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},Rl={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Ae.on(ta.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=en.getState().interactions.find(s=>s.id===t);if(!n){ke.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){ke.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),ke.success("Response copied!")}catch(s){ke.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Ae.on(ta.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=en.getState().interactions.find(o=>o.id===t);if(!n){ke.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=en.getState();if(r.status==="streaming"){ke.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){ke.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),await Bh.regenerateInteraction(t)}catch(o){ke.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Ae.on(ta.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=en.getState().interactions.find(l=>l.id===t);if(!r){ke.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=en.getState();if(s.status==="streaming"){ke.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){ke.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=Qa.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{await Bh.regenerateInteraction(t)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){ke.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Ae.on(ta.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e,s=en.getState().interactions.find(c=>c.id===t);if(!s){ke.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=en.getState();if(i.status==="streaming"){ke.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){ke.info("Can only race from the last response in the conversation.");return}if(n.length<2){ke.error("Need at least 2 models to race");return}try{const c=Qa.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),ke.info(`Starting race with ${n.length} models...`);const d=n.map((y,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(y),await Bh.regenerateInteraction(t),x({success:!0,modelId:y,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:y,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const p=h.filter(y=>y.success).length,g=h.length-p;p>0?ke.success(`Race completed! ${p} models responded${g>0?`, ${g} failed`:""}`):ke.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){ke.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Ae.on(ta.forkConversationRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received forkConversationRequest for ${t}`),!en.getState().interactions.find(i=>i.id===t)){ke.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(en.getState().status==="streaming"){ke.info("Cannot fork while another response is streaming.");return}try{await Bh.forkConversation(t)}catch(i){ke.error(`Failed to fork conversation: ${String(i)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,i)}}),Ae.on(ta.forkConversationWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationWithModelRequest for ${t} with model ${n}`),!en.getState().interactions.find(a=>a.id===t)){ke.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(en.getState().status==="streaming"){ke.info("Cannot fork while another response is streaming.");return}try{console.log(`[InteractionService] Creating fork conversation first, then setting model to ${n}`),await Bh.forkConversation(t),await new Promise(a=>requestAnimationFrame(a)),console.log(`[InteractionService] Setting global model to ${n} for the new forked conversation`),Ae.emit($n.selectModelRequest,{modelId:n})}catch(a){ke.error(`Failed to fork conversation: ${String(a)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,a)}}),Ae.on(ta.forkConversationCompactRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationCompactRequest for ${t} with model ${n}`),!en.getState().interactions.find(a=>a.id===t)){ke.error(`Fork compact failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork compact request for unknown interaction ${t}`);return}if(en.getState().status==="streaming"){ke.info("Cannot fork compact while another response is streaming.");return}try{console.log(`[InteractionService] Creating compact fork conversation with model ${n}`),await Bh.forkConversationCompact(t,n)}catch(a){ke.error(`Failed to fork and compact conversation: ${String(a)}`),console.error(`[InteractionService] Error forking and compacting conversation ${t}:`,a)}}),Ae.on(ta.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){ke.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),ke.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){ke.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var I,V,D,z,$,Y,B,G,Z,ne,ae,le,Se,Ee;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await Gk(Wy.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=n.id||dr(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=en.getState(),u=l.interactions.filter(he=>he.conversationId===t),d=r==="conversation.title_generation"||r==="conversation.compact"?-1:u.reduce((he,pe)=>Math.max(he,pe.index),-1)+1,h=null,p=performance.now();this._interactionStartTimes.set(a,p);const g={id:a,conversationId:t,startedAt:new Date,endedAt:null,type:r,status:"STREAMING",prompt:{...n},response:null,index:d,parentId:h,metadata:{...n.metadata||{},...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0}};r!=="conversation.title_generation"&&r!=="conversation.compact"?(l._addInteractionToState(g),l._addStreamingId(a)):(l._addInteractionToState(g),l._addStreamingId(a),console.log(`[InteractionService] Added ${r} interaction ${a} to state.`)),dt.saveInteraction({...g}).catch(he=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,he)}),Ae.emit(xn.started,{interactionId:a,conversationId:t,type:g.type});const y=(I=i.metadata)==null?void 0:I.modelId;if(!y)return await this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=uc(y);if(!v||!x)return await this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${y}`),r),null;const w=Gn.getState().dbProviderConfigs.find(he=>he.id===v);if(!w)return await this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const S=Gn.getState().getApiKeyForProvider(v),_=KD(w,x,S);if(!_)return await this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${y} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${y}`);const k=r!=="conversation.title_generation"&&r!=="conversation.compact"?(((V=i.metadata)==null?void 0:V.enabledTools)??[]).reduce((he,pe)=>{if(pe.startsWith("mcp_")){const Le=globalThis.mcpToolsModuleInstance;if(Le&&Le.mcpClients){const He=pe.substring(4).split("_");if(He.length>=2){const Fe=He[0],Ie=He.slice(1).join("_");for(const[,X]of Le.mcpClients)if(X.name===Fe&&X.tools[Ie]){const ye=Ni.getState().getRegisteredTools(),Ne=`mcp_${Fe}_${Ie}`,fe=ye[Ne];if(fe&&fe.definition){const ce={description:fe.definition.description,parameters:fe.definition.parameters,execute:async se=>{if(fe.implementation)return await fe.implementation(se,N9());throw console.error(`[InteractionService] MCP tool ${Ie} has no implementation`),new Error(`MCP tool ${Ie} has no implementation`)}};he[pe]=ce}else console.warn(`[InteractionService] MCP tool ${Ne} not found in control registry`);break}}}}else{const He=Ni.getState().getRegisteredTools()[pe];if(He&&He.implementation){const Fe={description:He.definition.description,parameters:He.definition.parameters,execute:async Ie=>{const X=en.getState().currentConversationId,ye=X?On.getState().getConversationById(X):null;let Ne;ye&&ye.projectId?typeof ye.projectId=="string"?Ne=ye.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${X} is not a string (type: ${typeof ye.projectId}). Defaulting VFS key to "orphan". Value:`,ye.projectId),Ne="orphan"):Ne="orphan";let fe;try{if(Ae.emit(hn.initializeVFSRequest,{vfsKey:Ne,options:{force:!0}}),await new Promise(ce=>setTimeout(ce,100)),fe=oi.getState().fs,oi.getState().configuredVfsKey!==Ne||!fe)throw new Error(`Filesystem for key "${Ne}" not ready after request.`)}catch(ce){throw new Error(`Filesystem error: ${ce.message}`)}try{const ce=N9(),se=He.definition.parameters.parse(Ie),Pe=He.implementation,Be={...ce,fsInstance:fe};return await Pe(se,Be)}catch(ce){throw ce instanceof tu?new Error(`Invalid arguments: ${ce.errors.map(se=>`${se.path.join(".")} (${se.message})`).join(", ")}`):new Error(ce instanceof Error?ce.message:String(ce))}}};he[pe]=Fe}}return he},{}):void 0,{getSelectedModel:T}=Gn.getState(),A=T(),R=((z=(D=A==null?void 0:A.metadata)==null?void 0:D.supported_parameters)==null?void 0:z.includes("tools"))??!1,M=((($=i.metadata)==null?void 0:$.enabledTools)??[]).filter(he=>he.startsWith("mcp_")).length,j=(((Y=i.metadata)==null?void 0:Y.enabledTools)??[]).filter(he=>!he.startsWith("mcp_")).length;!R&&(M>0||j>0)&&console.warn(`[InteractionService] Model ${(A==null?void 0:A.name)||"unknown"} does not support tools. Ignoring ${M+j} enabled tools.`);const F=((B=i.parameters)==null?void 0:B.maxSteps)??gr.getState().toolMaxSteps,P={model:_,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(G=i.parameters)==null?void 0:G.temperature,maxTokens:(Z=i.parameters)==null?void 0:Z.max_tokens,topP:(ne=i.parameters)==null?void 0:ne.top_p,topK:(ae=i.parameters)==null?void 0:ae.top_k,presencePenalty:(le=i.parameters)==null?void 0:le.presence_penalty,frequencyPenalty:(Se=i.parameters)==null?void 0:Se.frequency_penalty,maxSteps:F,...R&&k&&Object.keys(k).length>0&&{tools:k},...((Ee=i.parameters)==null?void 0:Ee.providerOptions)&&{providerOptions:i.parameters.providerOptions},...R&&i.toolChoice&&{toolChoice:i.toolChoice}},q={onChunk:he=>this._handleChunk(a,he),onReasoningChunk:he=>this._handleReasoningChunk(a,he),onToolCall:he=>this._handleToolCall(a,he),onToolResult:he=>this._handleToolResult(a,he),onFinish:he=>this._handleFinish(a,he,r).catch(pe=>{console.error(`[InteractionService] Error in finish handler for ${a}:`,pe)}),onError:he=>this._handleError(a,he,r).catch(pe=>{console.error(`[InteractionService] Error in error handler for ${a}:`,pe)})};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),b5e.executeInteraction(a,P,q).catch(he=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,he);const pe=en.getState().interactions.find(Le=>Le.id===a);pe&&pe.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",he instanceof Error?he:new Error(String(he)),r).catch(Le=>{console.error("[InteractionService] Error during finalization after execution error:",Le)})}),g},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),ke.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=en.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant").catch(s=>{console.error("[InteractionService] Error during forced finalization:",s)}))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await Gk(Wy.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;en.getState().appendInteractionResponseChunk(e,s),Ae.emit(xn.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){en.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),en.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),en.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},async _handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),await this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},async _handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";await this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},async _finalizeInteraction(e,t,n,r="message.user_assistant",s){var k,T,A,R,M;const i=en.getState(),a=i.interactions.find(j=>j.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"&&r!=="conversation.compact"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),p=this._firstChunkTimestamps.get(e),g=h?Math.round(d-h):void 0,y=h&&p?Math.round(p-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:y,generationTime:g,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const j=x.response.trim().replace(/^"|"$/g,"");a&&j&&Ae.emit(rr.updateConversationRequest,{id:a.conversationId,updates:{title:j}})}if(r==="prompt.enhance"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const j=x.response.trim();if(j){const{PromptEnhancementService:F}=await zr(async()=>{const{PromptEnhancementService:P}=await Promise.resolve().then(()=>BZe);return{PromptEnhancementService:P}},void 0);await F.handleEnhancementCompletion(e,j)}}if(r==="conversation.compact"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const j=x.response.trim(),F=(k=a==null?void 0:a.metadata)==null?void 0:k.targetUserInteractionId,P=(T=a==null?void 0:a.metadata)==null?void 0:T.targetConversationId,q=(A=a==null?void 0:a.metadata)==null?void 0:A.combineSourceInteractionId;if((R=a==null?void 0:a.metadata)!=null&&R.isCombineGeneration&&q){console.log(`[InteractionService] Combine completion handler triggered for ${e} targeting ${q}`);try{const I=en.getState(),V=I.interactions.find(D=>{var z,$;return D.parentId===q&&((z=D.metadata)==null?void 0:z.isCombineGeneration)===!0&&(($=D.metadata)==null?void 0:$.isCompactingInProgress)===!0});if(V){const D={...V.metadata,isCompactingInProgress:!1,combineGeneratedAt:new Date().toISOString()};I._updateInteractionInState(V.id,{response:j,status:"COMPLETED",endedAt:new Date,metadata:D});const z=I.interactions.find($=>$.id===V.id);z&&await dt.saveInteraction(z),Ae.emit(xn.updated,{interactionId:V.id,updates:{response:j,status:"COMPLETED",endedAt:new Date,metadata:D}}),I._removeStreamingId(V.id)}}catch(I){console.error("[InteractionService] Error updating combine interaction:",I)}}else if(j&&F&&P)try{await On.getState().selectItem(P,"conversation");const V=en.getState();V.currentConversationId!==P&&await V.loadInteractions(P);const D=V.interactions.find($=>$.id===F);if(!D)throw new Error(`Target interaction ${F} not found after loading conversation ${P}`);const z={...D,response:j,status:"COMPLETED",endedAt:new Date,metadata:{...D.metadata,isCompactingInProgress:!1,isRaceCombining:!1,compactGeneratedAt:new Date().toISOString(),combinedResponse:(M=D.metadata)!=null&&M.isRaceCombining?!0:void 0}};await dt.saveInteraction(z),V._updateInteractionInState(F,{response:j,status:"COMPLETED",endedAt:new Date,metadata:z.metadata}),Ae.emit(xn.updated,{interactionId:F,updates:{response:j,status:"COMPLETED",endedAt:new Date,metadata:z.metadata}}),V._removeStreamingId(F)}catch(I){console.error(`[InteractionService] Error updating user interaction ${F} with compact summary:`,I);try{await On.getState().selectItem(P,"conversation");const D=en.getState(),z=D.interactions.find(B=>B.id===F),$={response:"Error generating compact summary. Please try again.",status:"ERROR",endedAt:new Date,metadata:{...(z==null?void 0:z.metadata)||{},isCompactingInProgress:!1,compactError:I instanceof Error?I.message:String(I)}};D._updateInteractionInState(F,$),Ae.emit(xn.updated,{interactionId:F,updates:$}),D._removeStreamingId(F);const Y=D.interactions.find(B=>B.id===F);Y&&await dt.saveInteraction(Y)}catch(V){console.error(`[InteractionService] Fallback update also failed for ${F}:`,V)}}}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=en.getState().interactions.find(j=>j.id===e);w?dt.saveInteraction({...w}).catch(j=>{console.error(`[InteractionService] Failed final persistence for ${e}`,j)}):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],_=[];try{S=c.calls.map(j=>JSON.parse(j)),_=c.results.map(j=>JSON.parse(j))}catch(j){console.error("[InteractionService] Failed to parse tool strings for event emitter:",j)}Ae.emit(xn.completed,{interaction:w,interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:_}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e)}},_E=We.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var I;const{interaction:s,interactionStatus:i}=en(pn(V=>{const D=V.interactions.find(z=>z.id===e);return{interaction:D,interactionStatus:D==null?void 0:D.status}})),a=gr(V=>V.streamingRenderFPS),[o,l]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!0),[p,g]=E.useState(!1),y=E.useRef(null),v=E.useRef(0),x=E.useRef(null);E.useEffect(()=>{const V=1e3/a;let D=!0;const z=$=>{if(!D)return;if(en.getState().streamingInteractionIds.includes(e)){if($-v.current>=V){const B=en.getState().activeStreamBuffers[e]??"",G=en.getState().activeReasoningBuffers[e]??"";l(B),u(G),v.current=$}y.current=requestAnimationFrame(z)}else{const B=en.getState().activeStreamBuffers[e]??"",G=en.getState().activeReasoningBuffers[e]??"";l(B),u(G),y.current=null}};return y.current=requestAnimationFrame(z),()=>{D=!1,y.current&&(cancelAnimationFrame(y.current),y.current=null)}},[e,a]),E.useEffect(()=>{if(i&&i!=="STREAMING"){const V=en.getState().activeStreamBuffers[e]??"",D=en.getState().activeReasoningBuffers[e]??"";l(V),u(D),y.current&&(cancelAnimationFrame(y.current),y.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:S}=Gn(pn(V=>({dbProviderConfigs:V.dbProviderConfigs,getAllAvailableModelDefsForProvider:V.getAllAvailableModelDefsForProvider}))),_=E.useMemo(()=>{var Z;const V=(Z=s==null?void 0:s.metadata)==null?void 0:Z.modelId;if(!V)return"Loading Model...";const{providerId:D,modelId:z}=uc(V);if(!D||!z)return V;const $=w.find(ne=>ne.id===D),Y=($==null?void 0:$.name)??D,G=S(D).find(ne=>ne.id===z);return`${(G==null?void 0:G.name)??z} (${Y})`},[(I=s==null?void 0:s.metadata)==null?void 0:I.modelId,w,S]),k=E.useCallback(()=>h(V=>!V),[]),T=E.useCallback(()=>{g(!1)},[]),A=E.useCallback(()=>{g(!0)},[]),R=E.useCallback(()=>{p?T():A()},[p,T,A]);if(!s)return r?f.jsxs("div",{className:Ye("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Ye("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const M=()=>{Rl.abortInteraction(e)},j=n==null?void 0:n("header-actions",s,{isFolded:p,toggleFold:R}),F=n==null?void 0:n("actions",s),P=n==null?void 0:n("content",s),q=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Ye("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(x1,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1,interactionId:s.id}),f.jsxs("div",{className:Ye("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[q,f.jsxs("div",{className:Ye("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-[var(--z-sticky)] p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(Ly,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",_,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:j})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!p&&f.jsxs(f.Fragment,{children:[P,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:k,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Pb,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(Nn,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:V=>{V.stopPropagation(),k()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(Fl,{}):f.jsx(wp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(y4e,{interactionId:e,markdownContent:o,isStreaming:!0})]}),p&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:R,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Ye("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-[var(--z-sticky)]"),children:[F,f.jsx(b4e,{onStop:M,"aria-label":"Stop Generation"})]})]})});_E.displayName="StreamingInteractionCard";const xq=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,C5e=({type:e})=>{switch(e){case"message.workflow_step":return f.jsx(vxe,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"});default:return f.jsx(Ly,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"})}},k5e=({interactionType:e,displayModelName:t,timeAgo:n,promptTokens:r,completionTokens:s,timeToFirstToken:i,generationTime:a,headerActionsSlot:o})=>{const l=r!==void 0&&s!==void 0?r+s:void 0;return f.jsxs("div",{className:Ye("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-[var(--z-sticky)] p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(C5e,{type:e}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",t,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:o})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[l!==void 0&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsxs(Ar,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(bbe,{className:"h-3 w-3"}),f.jsx("span",{children:l.toLocaleString()})]}),f.jsxs(Nr,{side:"bottom",children:["Tokens: ",r??"?"," (Prompt) +"," ",s??"?"," (Completion) = ",l]})]})}),i!==void 0&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsxs(Ar,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Cxe,{className:"h-3 w-3"}),f.jsx("span",{children:xq(i)})]}),f.jsx(Nr,{side:"bottom",children:"Time to First Token"})]})}),a!==void 0&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsxs(Ar,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(fbe,{className:"h-3 w-3"}),f.jsx("span",{children:xq(a)})]}),f.jsx(Nr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:n})})]})},E5e=({markdownContent:e,interactionId:t})=>{const n=NA(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(Bb,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},T5e=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=E.useState(!0),[d,h]=E.useState(!1),p=Ni(pn(k=>Object.values(k.canvasControls))),g=E.useCallback((k,T)=>p.filter(A=>A.type==="tool-call-step"&&A.targetSlot===k&&A.renderer).map(A=>A.renderer?f.jsx(We.Fragment,{children:A.renderer(T)},A.id):null).filter(Boolean),[p]),y=E.useMemo(()=>{if(!n)return[];const k=n.map(A=>JSON.parse(A)),T=(r==null?void 0:r.map(A=>JSON.parse(A)))??[];return k.map(A=>{const R=T.find(M=>M.toolCallId===A.toolCallId);return{call:A,result:R}})},[n,r]),v=E.useCallback(()=>u(k=>!k),[]),x=E.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),ke.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(k){ke.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",k)}},[s]),w=!!s,S=t&&(typeof t!="string"||t.trim().length>0),_=y&&y.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",_?`[${y==null?void 0:y.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:_||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Pb,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(Nn,{tooltipText:"Copy Reasoning",onClick:k=>{k.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(Ao,{className:"text-green-500"}):f.jsx(IT,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(Nn,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:k=>{k.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(Fl,{}):f.jsx(wp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),y.map(({call:k,result:T},A)=>{const R={interactionId:e,toolCall:k,toolResult:T,canvasContextType:"tool-call-step"};return f.jsx(We.Fragment,{children:g("tool-call-content",R)},`tool-step-${k.toolCallId||A}`)}),S&&typeof t=="string"&&f.jsx(E5e,{markdownContent:t,interactionId:e}),!S&&!_&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},as={startRequest:"workflow.start.request",runNextStepRequest:"workflow.runNextStep.request",resumeRequest:"workflow.resume.request",cancelRequest:"workflow.cancel.request",started:"workflow.started",paused:"workflow.paused",resumed:"workflow.resumed",stepCompleted:"workflow.step.completed",completed:"workflow.completed",error:"workflow.error",stepStarting:"workflow.step.starting",stateChanged:"workflow.state.changed",flowUpdated:"workflow.flow.updated"};function QC(e,t="normal",n){return{timestamp:new Date().toISOString(),priority:t,sequence:n,runId:e}}const xy=Do(Fo((e,t)=>({activeRun:null,pausePayload:null,_handleWorkflowStarted:n=>{e(r=>{r.activeRun=n,r.pausePayload=null})},_updateRun:(n,r,s)=>{e(i=>{i.activeRun&&i.activeRun.runId===n&&(i.activeRun.status=r,s&&s(i.activeRun))})},_handleStepCompleted:(n,r,s)=>{t()._updateRun(n,"RUNNING",i=>{i.stepOutputs[r]=s,i.currentStepIndex+=1})},_handleWorkflowPaused:n=>{t()._updateRun(n.runId,"PAUSED"),e({pausePayload:n})},_handleWorkflowResumed:n=>{t()._updateRun(n,"RUNNING"),e({pausePayload:null})},_handleWorkflowCompleted:n=>{t()._updateRun(n,"COMPLETED",r=>{r.completedAt=new Date().toISOString()}),setTimeout(()=>e({activeRun:null,pausePayload:null}),5e3)},_handleWorkflowError:(n,r)=>{t()._updateRun(n,"ERROR",s=>{s.error=r,s.completedAt=new Date().toISOString()}),e({pausePayload:null})},_handleWorkflowCancelled:n=>{var r;((r=t().activeRun)==null?void 0:r.runId)===n&&e({activeRun:null,pausePayload:null})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:as.started,handler:r=>n._handleWorkflowStarted(r.run),storeId:"WorkflowStore"},{eventName:as.stepCompleted,handler:r=>n._handleStepCompleted(r.runId,r.stepId,r.output),storeId:"WorkflowStore"},{eventName:as.paused,handler:r=>n._handleWorkflowPaused(r),storeId:"WorkflowStore"},{eventName:as.resumed,handler:r=>n._handleWorkflowResumed(r.runId),storeId:"WorkflowStore"},{eventName:as.completed,handler:r=>n._handleWorkflowCompleted(r.runId),storeId:"WorkflowStore"},{eventName:as.error,handler:r=>n._handleWorkflowError(r.runId,r.error),storeId:"WorkflowStore"},{eventName:as.cancelRequest,handler:r=>n._handleWorkflowCancelled(r.runId),storeId:"WorkflowStore"}]}})));function Mi({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Ye("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}var A5e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],N5e=A5e.reduce((e,t)=>{const n=rd(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),R5e="Label",bte=E.forwardRef((e,t)=>f.jsx(N5e.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));bte.displayName=R5e;var I5e=bte;function At({className:e,...t}){return f.jsx(I5e,{"data-slot":"label",className:Ye("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const M5e=({run:e})=>{const[t,n]=E.useState(()=>{if(!e)return"";try{return JSON.stringify(e.stepOutputs,null,2)}catch{return""}});if(!e)return null;const r=e.template.steps[e.currentStepIndex],s=()=>{let i=t;try{i=JSON.parse(t)}catch{}Ae.emit(as.resumeRequest,{runId:e.runId,resumeData:i})};return f.jsxs("div",{className:"p-4 border-t space-y-3",children:[f.jsx("h3",{className:"font-semibold text-base",children:"Action Required"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:r.instructionsForHuman||"Please review the data below and click Continue."}),f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{htmlFor:`hitl-data-${e.runId}`,children:"Data (edit if needed)"}),f.jsx(Mi,{id:`hitl-data-${e.runId}`,value:t,onChange:i=>n(i.target.value),rows:8,className:"font-mono text-xs"})]}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx(rt,{variant:"outline",onClick:()=>Ae.emit(as.cancelRequest,{runId:e.runId}),children:"Cancel Workflow"}),f.jsx(rt,{onClick:s,children:"Continue"})]})]})},j5e=TD("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function jA({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Ye(j5e({variant:t}),e),...n})}function R5({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Ye("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function PA({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Ye("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var P5e=E.createContext(void 0);function Og(e){const t=E.useContext(P5e);return e||t||"ltr"}function R1(e,[t,n]){return Math.min(n,Math.max(t,e))}function O5e(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var I5="ScrollArea",[vte,yvt]=Pi(I5),[D5e,Ec]=vte(I5),xte=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=E.useState(null),[c,u]=E.useState(null),[d,h]=E.useState(null),[p,g]=E.useState(null),[y,v]=E.useState(null),[x,w]=E.useState(0),[S,_]=E.useState(0),[k,T]=E.useState(!1),[A,R]=E.useState(!1),M=Tn(t,F=>l(F)),j=Og(s);return f.jsx(D5e,{scope:n,type:r,dir:j,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:k,onScrollbarXEnabledChange:T,scrollbarY:y,onScrollbarYChange:v,scrollbarYEnabled:A,onScrollbarYEnabledChange:R,onCornerWidthChange:w,onCornerHeightChange:_,children:f.jsx(Zn.div,{dir:j,...a,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});xte.displayName=I5;var wte="ScrollAreaViewport",Ste=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=Ec(wte,n),o=E.useRef(null),l=Tn(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(Zn.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Ste.displayName=wte;var yd="ScrollAreaScrollbar",_te=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ec(yd,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return E.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(F5e,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(L5e,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(Cte,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(M5,{...r,ref:t}):null});_te.displayName=yd;var F5e=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ec(yd,e.__scopeScrollArea),[i,a]=E.useState(!1);return E.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(ca,{present:n||i,children:f.jsx(Cte,{"data-state":i?"visible":"hidden",...r,ref:t})})}),L5e=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ec(yd,e.__scopeScrollArea),i=e.orientation==="horizontal",a=DA(()=>l("SCROLL_END"),100),[o,l]=O5e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),E.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const p=c[u];d!==p&&(l("SCROLL"),a()),d=p};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(ca,{present:n||o!=="hidden",children:f.jsx(M5,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Cte=E.forwardRef((e,t)=>{const n=Ec(yd,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=E.useState(!1),o=e.orientation==="horizontal",l=DA(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return cb(n.viewport,l),cb(n.content,l),f.jsx(ca,{present:r||i,children:f.jsx(M5,{"data-state":i?"visible":"hidden",...s,ref:t})})}),M5=E.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=Ec(yd,e.__scopeScrollArea),i=E.useRef(null),a=E.useRef(0),[o,l]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=Nte(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,p){return V5e(h,a.current,o,p)}return n==="horizontal"?f.jsx($5e,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,p=wq(h,o,s.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(B5e,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,p=wq(h,o);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),$5e=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Ec(yd,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Tn(t,l,i.onScrollbarXChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(Ete,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":OA(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),Ite(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:kE(a.paddingLeft),paddingEnd:kE(a.paddingRight)}})}})}),B5e=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Ec(yd,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Tn(t,l,i.onScrollbarYChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(Ete,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":OA(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),Ite(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:kE(a.paddingTop),paddingEnd:kE(a.paddingBottom)}})}})}),[z5e,kte]=vte(yd),Ete=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,p=Ec(yd,n),[g,y]=E.useState(null),v=Tn(t,M=>y(M)),x=E.useRef(null),w=E.useRef(""),S=p.viewport,_=r.content-r.viewport,k=Ms(u),T=Ms(l),A=DA(d,10);function R(M){if(x.current){const j=M.clientX-x.current.left,F=M.clientY-x.current.top;c({x:j,y:F})}}return E.useEffect(()=>{const M=j=>{const F=j.target;(g==null?void 0:g.contains(F))&&k(j,_)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[S,g,_,k]),E.useEffect(T,[r,T]),cb(g,A),cb(p.content,A),f.jsx(z5e,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:Ms(i),onThumbPointerUp:Ms(a),onThumbPositionChange:T,onThumbPointerDown:Ms(o),children:f.jsx(Zn.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),x.current=g.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),R(M))}),onPointerMove:Wt(e.onPointerMove,R),onPointerUp:Wt(e.onPointerUp,M=>{const j=M.target;j.hasPointerCapture(M.pointerId)&&j.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=w.current,p.viewport&&(p.viewport.style.scrollBehavior=""),x.current=null})})})}),CE="ScrollAreaThumb",Tte=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=kte(CE,e.__scopeScrollArea);return f.jsx(ca,{present:n||s.hasThumb,children:f.jsx(U5e,{ref:t,...r})})}),U5e=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=Ec(CE,n),a=kte(CE,n),{onThumbPositionChange:o}=a,l=Tn(t,d=>a.onThumbChange(d)),c=E.useRef(void 0),u=DA(()=>{c.current&&(c.current(),c.current=void 0)},100);return E.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const p=W5e(d,o);c.current=p,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(Zn.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const p=d.target.getBoundingClientRect(),g=d.clientX-p.left,y=d.clientY-p.top;a.onThumbPointerDown({x:g,y})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});Tte.displayName=CE;var j5="ScrollAreaCorner",Ate=E.forwardRef((e,t)=>{const n=Ec(j5,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(q5e,{...e,ref:t}):null});Ate.displayName=j5;var q5e=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=Ec(j5,n),[i,a]=E.useState(0),[o,l]=E.useState(0),c=!!(i&&o);return cb(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),cb(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(Zn.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function kE(e){return e?parseInt(e,10):0}function Nte(e,t){const n=e/t;return isNaN(n)?0:n}function OA(e){const t=Nte(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function V5e(e,t,n,r="ltr"){const s=OA(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return Rte([l,c],d)(e)}function wq(e,t,n="ltr"){const r=OA(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=R1(e,l);return Rte([0,a],[0,o])(c)}function Rte(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function Ite(e,t){return e>0&&e<t}var W5e=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function DA(e,t){const n=Ms(e),r=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),E.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function cb(e,t){const n=Ms(t);di(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var H5e=xte,G5e=Ste,K5e=Ate;function ul({className:e,children:t,...n}){return f.jsxs(H5e,{"data-slot":"scroll-area",className:Ye("relative",e),...n,children:[f.jsx(G5e,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(Y5e,{}),f.jsx(K5e,{})]})}function Y5e({className:e,orientation:t="vertical",...n}){return f.jsx(_te,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Ye("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx(Tte,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}const wy=new WeakMap,G2=new WeakMap,EE={current:[]};let r3=!1,mw=0;const Hx=new Set,e2=new Map;function Mte(e){const t=Array.from(e).sort((n,r)=>n instanceof vf&&n.options.deps.includes(r)?1:r instanceof vf&&r.options.deps.includes(n)?-1:0);for(const n of t){if(EE.current.includes(n))continue;EE.current.push(n),n.recompute();const r=G2.get(n);if(r)for(const s of r){const i=wy.get(s);i&&Mte(i)}}}function Z5e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function X5e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function jte(e){if(mw>0&&!e2.has(e)&&e2.set(e,e.prevState),Hx.add(e),!(mw>0)&&!r3)try{for(r3=!0;Hx.size>0;){const t=Array.from(Hx);Hx.clear();for(const n of t){const r=e2.get(n)??n.prevState;n.prevState=r,Z5e(n)}for(const n of t){const r=wy.get(n);r&&(EE.current.push(n),Mte(r))}for(const n of t){const r=wy.get(n);if(r)for(const s of r)X5e(s)}}}finally{r3=!1,EE.current=[],e2.clear()}}function Nu(e){mw++;try{e()}finally{if(mw--,mw===0){const t=Array.from(Hx)[0];t&&jte(t)}}}function J5e(e){return typeof e=="function"}class N4{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):J5e(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),jte(this)}}class vf{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof vf&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof vf)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof N4){let r=wy.get(n);r||(r=new Set,wy.set(n,r)),r.add(this);let s=G2.get(this);s||(s=new Set,G2.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof vf)this.unregisterFromGraph(n.options.deps);else if(n instanceof N4){const r=wy.get(n);r&&r.delete(this);const s=G2.get(this);s&&s.delete(n)}}}function FA(e,t){return typeof e=="function"?e(t):e}function Gx(e,t){return P5(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function t2(e,t,n){const r=P5(t);function s(i){if(!r.length)return FA(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function Q5e(e,t){const n=P5(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const e6e=/^(\d+)$/gm,t6e=/\.(\d+)(?=\.)/gm,n6e=/^(\d+)\./gm,r6e=/\.(\d+$)/gm,s6e=/\.{2,}/gm,R4="__int__",n2=`${R4}$1`;function P5(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(e6e,n2).replace(t6e,`.${n2}.`).replace(n6e,`${n2}.`).replace(r6e,`.${n2}`).replace(s6e,".").split(".").map(t=>t.indexOf(R4)===0?parseInt(t.substring(R4.length),10):t)}function i6e(e){return!(Array.isArray(e)&&e.length===0)}function I4(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=p=>({...p,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function M4(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const j4=e=>!!e&&typeof e=="object"&&"fields"in e;function Y0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!Y0(e[s],t[s]))return!1;return!0}const Sq=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},_q=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function a6e(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const Cq=e=>{const t=a6e(e);return{form:t,fields:t}},Sy={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:Cq(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:Cq(r.issues)}},Pte=e=>!!e&&"~standard"in e,TE={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function r2(e){function t(d,h,p,g){const y=r(d,h,p,g);({insert:()=>o(y,d,h),remove:()=>l(y),swap:()=>g!==void 0&&u(y,d,h,g),move:()=>g!==void 0&&c(y,d,h,g)})[p]()}function n(d,h){return`${d}[${h}]`}function r(d,h,p,g){const y=[n(d,h)];if(p==="swap")y.push(n(d,g));else if(p==="move"){const[v,x]=[Math.min(h,g),Math.max(h,g)];for(let w=v;w<=x;w++)y.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)y.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>y.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(p,g)=>{const y=parseInt(g,10);return`[${h==="up"?y+1:Math.max(0,y-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(g=>{const y=s(g.toString(),h),v=e.getFieldMeta(y);v?e.setFieldMeta(g,v):e.setFieldMeta(g,a())})}const a=()=>TE,o=(d,h,p)=>{i(d,"down"),d.forEach(g=>{g.toString().startsWith(n(h,p))&&e.setFieldMeta(g,a())})},l=d=>{i(d,"up")},c=(d,h,p,g)=>{const y=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,p))).map(v=>[v,e.getFieldMeta(v)]));i(d,p<g?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,g))).forEach(v=>{const x=v.replace(n(h,g),n(h,p)),w=y.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,p,g)=>{d.forEach(y=>{if(!y.toString().startsWith(n(h,p)))return;const v=y.toString().replace(n(h,p),n(h,g)),[x,w]=[e.getFieldMeta(y),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(y,w)})};return{handleArrayFieldMetaShift:t}}function s3(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class o6e{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!Y0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!Y0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||Nu(()=>{this.baseStore.setState(()=>s3(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return s3({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return Nu(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(p=>h.startsWith(p))),u=[];return Nu(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=M4(r,this.options);let i=!1;const a={};return Nu(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:p}=K2(d),g=s2(u.cause);for(const y of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(y);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,S=p==null?void 0:p[y],{newErrorValue:_,newSource:k}=Sq({newFormValidatorError:S,isPreviousErrorFromFormValidator:(w==null?void 0:w[g])==="form",previousErrorValue:x==null?void 0:x[g]});k==="form"&&(a[y]={...a[y],[g]:S}),(x==null?void 0:x[g])!==_&&this.setFieldMeta(y,T=>({...T,errorMap:{...T.errorMap,[g]:_},errorSourceMap:{...T.errorSourceMap,[g]:k}}))}((o=this.state.errorMap)==null?void 0:o[g])!==h&&this.baseStore.setState(y=>({...y,errorMap:{...y.errorMap,[g]:h}})),(h||p)&&(i=!0)}const c=s2("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=I4(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=s2(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async p=>{let g;try{g=await new Promise((w,S)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(_){S(_)}},c.debounceMs)})}catch(w){g=w}const{formError:y,fieldErrors:v}=K2(g);v&&(a=a?{...a,...v}:v);const x=s2(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(w);if(!S)continue;const{errorMap:_,errorSourceMap:k}=S,T=a==null?void 0:a[w],{newErrorValue:A,newSource:R}=Sq({newFormValidatorError:T,isPreviousErrorFromFormValidator:(k==null?void 0:k[x])==="form",previousErrorValue:_==null?void 0:_[x]});(_==null?void 0:_[x])!==A&&this.setFieldMeta(w,M=>({...M,errorMap:{...M.errorMap,[x]:A},errorSourceMap:{...M.errorSourceMap,[x]:R}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:y}})),p(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const g={...l[d]||{},[u]:h};l[d]=g}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>Gx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:FA(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=TE,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;Nu(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:t2(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=Q5e(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),r2(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),r2(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return t2(t2(o,`${s}`,c),`${i}`,l)},a),r2(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),r2(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:TE},values:this.options.defaultValues?t2(s.values,r,Gx(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>Sy.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>Sy.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new N4(s3({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new vf({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const p={};for(const g of Object.keys(d.fieldMetaBase)){const y=d.fieldMetaBase[g],v=u==null?void 0:u.fieldMetaBase[g],x=c==null?void 0:c[g],w=Gx(d.values,g);let S=x==null?void 0:x.errors;if(!v||y.errorMap!==v.errorMap){S=Object.values(y.errorMap??{}).filter(R=>R!==void 0);const A=(a=this.getFieldInfo(g))==null?void 0:a.instance;A&&!A.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const _=!i6e(S??[]),k=!y.isDirty,T=Y0(w,Gx(this.options.defaultValues,g))||Y0(w,(l=(o=this.getFieldInfo(g))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===k&&x.isValid===_&&x.isDefaultValue===T&&x.errors===S&&y===v){p[g]=x,h++;continue}p[g]={...y,errors:S,isPristine:k,isValid:_,isDefaultValue:T}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:p}}),this.store=new vf({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],p=s[1],g=Object.values(p).filter(Boolean),y=g.some($=>$.isValidating),v=g.every($=>$.isValid),x=g.some($=>$.isTouched),w=g.some($=>$.isBlurred),S=g.every($=>$.isDefaultValue),_=x&&((a=h.errorMap)==null?void 0:a.onMount),k=g.some($=>$.isDirty),T=!k,A=!!((o=h.errorMap)!=null&&o.onMount||g.some($=>{var Y;return(Y=$==null?void 0:$.errorMap)==null?void 0:Y.onMount})),R=!!y;let M=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(M=Object.values(h.errorMap).reduce(($,Y)=>Y===void 0?$:Y&&j4(Y)?($.push(Y.form),$):($.push(Y),$),[]));const j=M.length===0,F=v&&j,P=this.options.canSubmitWhenInvalid??!1,q=h.submissionAttempts===0&&!x&&!A||!R&&!h.isSubmitting&&F||P;let I=h.errorMap;if(_&&(M=M.filter($=>$!==h.errorMap.onMount),I=Object.assign(I,{onMount:void 0})),u&&d&&u.errorMap===I&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===M&&u.isFieldsValidating===y&&u.isFieldsValid===v&&u.isFormValid===j&&u.isValid===F&&u.canSubmit===q&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===T&&u.isDefaultValue===S&&u.isDirty===k&&Y0(d,h))return u;let V={...h,errorMap:I,fieldMeta:this.fieldMetaDerived.state,errors:M,isFieldsValidating:y,isFieldsValid:v,isFormValid:j,isValid:F,canSubmit:q,isTouched:x,isBlurred:w,isPristine:T,isDefaultValue:S,isDirty:k};const D=((l=this.options.transform)==null?void 0:l.deps)??[];if(D.length!==this.prevTransformArray.length||D.some(($,Y)=>$!==this.prevTransformArray[Y])){const $=Object.assign({},this,{state:V});(c=this.options.transform)==null||c.fn($),V=$.state,this.prevTransformArray=D}return V}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return Pte(t.validate)?Sy[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),Nu(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}Nu(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,p,g;(g=(p=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:p.onSubmit)==null||g.call(p,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),Nu(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){Nu(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(j4(r)){const{formError:i,fieldErrors:a}=K2(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function K2(e){if(e){if(j4(e)){const t=K2(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function s2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class l6e{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=Gx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=M4(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=M4(n,d.options);return h.forEach(p=>{p.field=d}),u.concat(h)},[]);let l=!1;Nu(()=>{const u=(d,h)=>{var p;const g=i2(h.cause),y=h.validate?kq(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[g],{newErrorValue:x,newSource:w}=_q({formLevelError:v,fieldLevelError:y});((p=d.state.meta.errorMap)==null?void 0:p[g])!==x&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[g]:x},errorSourceMap:{...S.errorSourceMap,[g]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=i2("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=I4(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,p)=>{const g=I4(n,p.options);return g.forEach(y=>{y.field=p}),h.concat(g)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(p=>({...p,isValidating:!0}));const l=[],c=[],u=(h,p,g)=>{const y=i2(p.cause),v=h.getInfo().validationMetaMap[y];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[y]={lastAbortController:x},g.push(new Promise(async w=>{var S;let _;try{_=await new Promise((M,j)=>{this.timeoutIds.validations[p.cause]&&clearTimeout(this.timeoutIds.validations[p.cause]),this.timeoutIds.validations[p.cause]=setTimeout(async()=>{if(x.signal.aborted)return M(void 0);try{M(await this.runValidator({validate:p.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(F){j(F)}},p.debounceMs)})}catch(M){_=M}if(x.signal.aborted)return w(void 0);const k=kq(_),T=(S=i[this.name])==null?void 0:S[y],{newErrorValue:A,newSource:R}=_q({formLevelError:T,fieldLevelError:k});h.setMeta(M=>({...M,errorMap:{...M==null?void 0:M.errorMap,[y]:A},errorSourceMap:{...M.errorSourceMap,[y]:R}})),w(A)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(p=>({...p,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[i2(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>Sy.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>Sy.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new vf({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...TE,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return Pte(t.validate)?Sy[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function kq(e){if(e)return e}function i2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var i3={exports:{}},a3={},o3={exports:{}},l3={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eq;function c6e(){if(Eq)return l3;Eq=1;var e=Ib();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var p=h(),g=r({inst:{value:p,getSnapshot:h}}),y=g[0].inst,v=g[1];return i(function(){y.value=p,y.getSnapshot=h,l(y)&&v({inst:y})},[d,p,h]),s(function(){return l(y)&&v({inst:y}),d(function(){l(y)&&v({inst:y})})},[d]),a(p),p}function l(d){var h=d.getSnapshot;d=d.value;try{var p=h();return!n(d,p)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return l3.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,l3}var Tq;function u6e(){return Tq||(Tq=1,o3.exports=c6e()),o3.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Aq;function d6e(){if(Aq)return a3;Aq=1;var e=Ib(),t=u6e();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return a3.useSyncExternalStoreWithSelector=function(c,u,d,h,p){var g=i(null);if(g.current===null){var y={hasValue:!1,value:null};g.current=y}else y=g.current;g=o(function(){function x(T){if(!w){if(w=!0,S=T,T=h(T),p!==void 0&&y.hasValue){var A=y.value;if(p(A,T))return _=A}return _=T}if(A=_,r(S,T))return A;var R=h(T);return p!==void 0&&p(A,R)?(S=T,A):(S=T,_=R)}var w=!1,S,_,k=d===void 0?null:d;return[function(){return x(u())},k===null?void 0:function(){return x(k())}]},[u,d,h,p]);var v=s(c,g[0],g[1]);return a(function(){y.hasValue=!0,y.value=v},[v]),l(v),v},a3}var Nq;function f6e(){return Nq||(Nq=1,i3.exports=d6e()),i3.exports}var Ote=f6e();const h6e=la(Ote);function O5(e,t=n=>n){return Ote.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,p6e)}function p6e(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const AE=typeof window<"u"?E.useLayoutEffect:E.useEffect;function m6e(e){const[t]=E.useState(()=>{const r=new l6e({...e,form:e.form,name:e.name});return r.Field=Dte,r});return AE(t.mount,[t]),AE(()=>{t.update(e)}),O5(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const Dte=({children:e,...t})=>{const n=m6e(t),r=E.useMemo(()=>FA(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function g6e({form:e,selector:t,children:n}){const r=O5(e.store,t);return FA(n,r)}function Xs(e){const[t]=E.useState(()=>{const n=new o6e(e),r=n;return r.Field=function(i){return f.jsx(Dte,{...i,form:n})},r.Subscribe=s=>f.jsx(g6e,{form:n,selector:s.selector,children:s.children}),r});return AE(t.mount,[]),O5(t.store,n=>n.isSubmitting),AE(()=>{t.update(e)}),t}var D5="Progress",F5=100,[y6e,bvt]=Pi(D5),[b6e,v6e]=y6e(D5),Fte=E.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=x6e,...a}=e;(s||s===0)&&!Rq(s)&&console.error(w6e(`${s}`,"Progress"));const o=Rq(s)?s:F5;r!==null&&!Iq(r,o)&&console.error(S6e(`${r}`,"Progress"));const l=Iq(r,o)?r:null,c=NE(l)?i(l,o):void 0;return f.jsx(b6e,{scope:n,value:l,max:o,children:f.jsx(Zn.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":NE(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Bte(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});Fte.displayName=D5;var Lte="ProgressIndicator",$te=E.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=v6e(Lte,n);return f.jsx(Zn.div,{"data-state":Bte(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});$te.displayName=Lte;function x6e(e,t){return`${Math.round(e/t*100)}%`}function Bte(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function NE(e){return typeof e=="number"}function Rq(e){return NE(e)&&!isNaN(e)&&e>0}function Iq(e,t){return NE(e)&&!isNaN(e)&&e<=t&&e>=0}function w6e(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${F5}\`.`}function S6e(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${F5} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var zte=Fte,_6e=$te;const ub=E.forwardRef(({className:e,value:t,...n},r)=>f.jsx(zte,{ref:r,className:Ye("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(_6e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));ub.displayName=zte.displayName;function vn({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Ye("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}const Kx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,p=g=>{u(g.target.value)};return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[t&&f.jsx(At,{htmlFor:l,className:Ye("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(vn,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:p,placeholder:r,className:Ye(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((g,y)=>f.jsx("p",{children:typeof g=="string"?g:(g==null?void 0:g.message)||"Invalid"},y))})]})},C6e=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ye("space-y-1.5",o),children:[t&&f.jsx(At,{htmlFor:e.name,className:Ye("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Mi,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Ye(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]});function k6e(e){const t=e+"CollectionProvider",[n,r]=Pi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=y=>{const{scope:v,children:x}=y,w=We.useRef(null),S=We.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=rd(o),c=We.forwardRef((y,v)=>{const{scope:x,children:w}=y,S=i(o,x),_=Tn(v,S.collectionRef);return f.jsx(l,{ref:_,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=rd(u),p=We.forwardRef((y,v)=>{const{scope:x,children:w,...S}=y,_=We.useRef(null),k=Tn(v,_),T=i(u,x);return We.useEffect(()=>(T.itemMap.set(_,{ref:_,...S}),()=>void T.itemMap.delete(_))),f.jsx(h,{[d]:"",ref:k,children:w})});p.displayName=u;function g(y){const v=i(e+"CollectionConsumer",y);return We.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,A)=>S.indexOf(T.ref.current)-S.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:p},g,r]}var E6e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Oi=E6e.reduce((e,t)=>{const n=rd(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function T6e(e,t){e&&Nl.flushSync(()=>e.dispatchEvent(t))}var A6e="DismissableLayer",P4="dismissableLayer.update",N6e="dismissableLayer.pointerDownOutside",R6e="dismissableLayer.focusOutside",Mq,Ute=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),qte=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(Ute),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=E.useState({}),g=Tn(t,A=>d(A)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=y.indexOf(v),w=u?y.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,_=w>=x,k=j6e(A=>{const R=A.target,M=[...c.branches].some(j=>j.contains(R));!_||M||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=P6e(A=>{const R=A.target;[...c.branches].some(j=>j.contains(R))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return YD(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Mq=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),jq(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Mq)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),jq())},[u,c]),E.useEffect(()=>{const A=()=>p({});return document.addEventListener(P4,A),()=>document.removeEventListener(P4,A)},[]),f.jsx(Oi.div,{...l,ref:g,style:{pointerEvents:S?_?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});qte.displayName=A6e;var I6e="DismissableLayerBranch",M6e=E.forwardRef((e,t)=>{const n=E.useContext(Ute),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(Oi.div,{...e,ref:s})});M6e.displayName=I6e;function j6e(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Vte(N6e,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function P6e(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&Vte(R6e,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function jq(){const e=new CustomEvent(P4);document.dispatchEvent(e)}function Vte(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?T6e(s,i):s.dispatchEvent(i)}var c3=0;function LA(){E.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Pq()),document.body.insertAdjacentElement("beforeend",e[1]??Pq()),c3++,()=>{c3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),c3--}},[])}function Pq(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var u3="focusScope.autoFocusOnMount",d3="focusScope.autoFocusOnUnmount",Oq={bubbles:!1,cancelable:!0},O6e="FocusScope",Wte=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Ms(s),u=Ms(i),d=E.useRef(null),h=Tn(t,y=>l(y)),p=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let y=function(S){if(p.paused||!o)return;const _=S.target;o.contains(_)?d.current=_:jh(d.current,{select:!0})},v=function(S){if(p.paused||!o)return;const _=S.relatedTarget;_!==null&&(o.contains(_)||jh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&jh(o)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,p.paused]),E.useEffect(()=>{if(o){Fq.add(p);const y=document.activeElement;if(!o.contains(y)){const x=new CustomEvent(u3,Oq);o.addEventListener(u3,c),o.dispatchEvent(x),x.defaultPrevented||(D6e(z6e(Hte(o)),{select:!0}),document.activeElement===y&&jh(o))}return()=>{o.removeEventListener(u3,c),setTimeout(()=>{const x=new CustomEvent(d3,Oq);o.addEventListener(d3,u),o.dispatchEvent(x),x.defaultPrevented||jh(y??document.body,{select:!0}),o.removeEventListener(d3,u),Fq.remove(p)},0)}}},[o,c,u,p]);const g=E.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,x=document.activeElement;if(v&&x){const w=y.currentTarget,[S,_]=F6e(w);S&&_?!y.shiftKey&&x===_?(y.preventDefault(),n&&jh(S,{select:!0})):y.shiftKey&&x===S&&(y.preventDefault(),n&&jh(_,{select:!0})):x===w&&y.preventDefault()}},[n,r,p.paused]);return f.jsx(Oi.div,{tabIndex:-1,...a,ref:h,onKeyDown:g})});Wte.displayName=O6e;function D6e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(jh(r,{select:t}),document.activeElement!==n)return}function F6e(e){const t=Hte(e),n=Dq(t,e),r=Dq(t.reverse(),e);return[n,r]}function Hte(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Dq(e,t){for(const n of e)if(!L6e(n,{upTo:t}))return n}function L6e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function $6e(e){return e instanceof HTMLInputElement&&"select"in e}function jh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&$6e(e)&&t&&e.select()}}var Fq=B6e();function B6e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Lq(e,t),e.unshift(t)},remove(t){var n;e=Lq(e,t),(n=e[0])==null||n.resume()}}}function Lq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function z6e(e){return e.filter(t=>t.tagName!=="A")}var U6e="Arrow",Gte=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(Oi.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Gte.displayName=U6e;var q6e=Gte,L5="Popper",[Kte,Yte]=Pi(L5),[V6e,Zte]=Kte(L5),Xte=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(V6e,{scope:t,anchor:r,onAnchorChange:s,children:n})};Xte.displayName=L5;var Jte="PopperAnchor",Qte=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Zte(Jte,n),a=E.useRef(null),o=Tn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(Oi.div,{...s,ref:o})});Qte.displayName=Jte;var $5="PopperContent",[W6e,H6e]=Kte($5),ene=E.forwardRef((e,t)=>{var Ee,he,pe,Le,He,Fe;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...y}=e,v=Zte($5,n),[x,w]=E.useState(null),S=Tn(t,Ie=>w(Ie)),[_,k]=E.useState(null),T=Sg(_),A=(T==null?void 0:T.width)??0,R=(T==null?void 0:T.height)??0,M=r+(i!=="center"?"-"+i:""),j=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},F=Array.isArray(c)?c:[c],P=F.length>0,q={padding:j,boundary:F.filter(K6e),altBoundary:P},{refs:I,floatingStyles:V,placement:D,isPositioned:z,middlewareData:$}=sF({strategy:"fixed",placement:M,whileElementsMounted:(...Ie)=>rF(...Ie,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[iF({mainAxis:s+R,alignmentAxis:a}),l&&aF({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?oF():void 0,...q}),l&&lF({...q}),cF({...q,apply:({elements:Ie,rects:X,availableWidth:ye,availableHeight:Ne})=>{const{width:fe,height:ce}=X.reference,se=Ie.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Ne}px`),se.setProperty("--radix-popper-anchor-width",`${fe}px`),se.setProperty("--radix-popper-anchor-height",`${ce}px`)}}),_&&dF({element:_,padding:o}),Y6e({arrowWidth:A,arrowHeight:R}),h&&uF({strategy:"referenceHidden",...q})]}),[Y,B]=rne(D),G=Ms(g);di(()=>{z&&(G==null||G())},[z,G]);const Z=(Ee=$.arrow)==null?void 0:Ee.x,ne=(he=$.arrow)==null?void 0:he.y,ae=((pe=$.arrow)==null?void 0:pe.centerOffset)!==0,[le,Se]=E.useState();return di(()=>{x&&Se(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:z?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:le,"--radix-popper-transform-origin":[(Le=$.transformOrigin)==null?void 0:Le.x,(He=$.transformOrigin)==null?void 0:He.y].join(" "),...((Fe=$.hide)==null?void 0:Fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(W6e,{scope:n,placedSide:Y,onArrowChange:k,arrowX:Z,arrowY:ne,shouldHideArrow:ae,children:f.jsx(Oi.div,{"data-side":Y,"data-align":B,...y,ref:S,style:{...y.style,animation:z?void 0:"none"}})})})});ene.displayName=$5;var tne="PopperArrow",G6e={top:"bottom",right:"left",bottom:"top",left:"right"},nne=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=H6e(tne,r),a=G6e[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(q6e,{...s,ref:n,style:{...s.style,display:"block"}})})});nne.displayName=tne;function K6e(e){return e!==null}var Y6e=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=rne(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,p=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let g="",y="";return c==="bottom"?(g=a?d:`${h}px`,y=`${-l}px`):c==="top"?(g=a?d:`${h}px`,y=`${r.floating.height+l}px`):c==="right"?(g=`${-l}px`,y=a?d:`${p}px`):c==="left"&&(g=`${r.floating.width+l}px`,y=a?d:`${p}px`),{data:{x:g,y}}}});function rne(e){const[t,n="center"]=e.split("-");return[t,n]}var Z6e=Xte,X6e=Qte,J6e=ene,Q6e=nne,eLe="Portal",sne=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);di(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?FT.createPortal(f.jsx(Oi.div,{...r,ref:t}),a):null});sne.displayName=eLe;function KS(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var ine=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),tLe="VisuallyHidden",nLe=E.forwardRef((e,t)=>f.jsx(Oi.span,{...e,ref:t,style:{...ine,...e.style}}));nLe.displayName=tLe;var rLe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},$0=new WeakMap,a2=new WeakMap,o2={},f3=0,ane=function(e){return e&&(e.host||ane(e.parentNode))},sLe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=ane(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},iLe=function(e,t,n,r){var s=sLe(t,Array.isArray(e)?e:[e]);o2[n]||(o2[n]=new WeakMap);var i=o2[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var p=h.getAttribute(r),g=p!==null&&p!=="false",y=($0.get(h)||0)+1,v=(i.get(h)||0)+1;$0.set(h,y),i.set(h,v),a.push(h),y===1&&g&&a2.set(h,!0),v===1&&h.setAttribute(n,"true"),g||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),f3++,function(){a.forEach(function(d){var h=$0.get(d)-1,p=i.get(d)-1;$0.set(d,h),i.set(d,p),h||(a2.has(d)||d.removeAttribute(r),a2.delete(d)),p||d.removeAttribute(n)}),f3--,f3||($0=new WeakMap,$0=new WeakMap,a2=new WeakMap,o2={})}},$A=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=rLe(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),iLe(r,s,n,"aria-hidden")):function(){return null}},Uu=function(){return Uu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Uu.apply(this,arguments)};function one(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function aLe(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Y2="right-scroll-bar-position",Z2="width-before-scroll-bar",oLe="with-scroll-bars-hidden",lLe="--removed-body-scroll-bar-size";function h3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function cLe(e,t){var n=E.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var uLe=typeof window<"u"?E.useLayoutEffect:E.useEffect,$q=new WeakMap;function dLe(e,t){var n=cLe(null,function(r){return e.forEach(function(s){return h3(s,r)})});return uLe(function(){var r=$q.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||h3(o,null)}),i.forEach(function(o){s.has(o)||h3(o,a)})}$q.set(n,e)},[e]),n}function fLe(e){return e}function hLe(e,t){t===void 0&&(t=fLe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function pLe(e){e===void 0&&(e={});var t=hLe(null);return t.options=Uu({async:!0,ssr:!1},e),t}var lne=function(e){var t=e.sideCar,n=one(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,Uu({},n))};lne.isSideCarExport=!0;function mLe(e,t){return e.useMedium(t),lne}var cne=pLe(),p3=function(){},BA=E.forwardRef(function(e,t){var n=E.useRef(null),r=E.useState({onScrollCapture:p3,onWheelCapture:p3,onTouchMoveCapture:p3}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,p=e.noIsolation,g=e.inert,y=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=one(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,k=dLe([n,t]),T=Uu(Uu({},S),s);return E.createElement(E.Fragment,null,u&&E.createElement(_,{sideCar:cne,removeScrollBar:c,shards:d,noIsolation:p,inert:g,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:w}),a?E.cloneElement(E.Children.only(o),Uu(Uu({},T),{ref:k})):E.createElement(x,Uu({},T,{className:l,ref:k}),o))});BA.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};BA.classNames={fullWidth:Z2,zeroRight:Y2};var gLe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function yLe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=gLe();return t&&e.setAttribute("nonce",t),e}function bLe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function vLe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var xLe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=yLe())&&(bLe(t,n),vLe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},wLe=function(){var e=xLe();return function(t,n){E.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},une=function(){var e=wLe(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},SLe={left:0,top:0,right:0,gap:0},m3=function(e){return parseInt(e||"",10)||0},_Le=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[m3(n),m3(r),m3(s)]},CLe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return SLe;var t=_Le(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},kLe=une(),_y="data-scroll-locked",ELe=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(oLe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(_y,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Y2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Z2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Y2," .").concat(Y2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Z2," .").concat(Z2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(_y,`] {
    `).concat(lLe,": ").concat(o,`px;
  }
`)},Bq=function(){var e=parseInt(document.body.getAttribute(_y)||"0",10);return isFinite(e)?e:0},TLe=function(){E.useEffect(function(){return document.body.setAttribute(_y,(Bq()+1).toString()),function(){var e=Bq()-1;e<=0?document.body.removeAttribute(_y):document.body.setAttribute(_y,e.toString())}},[])},ALe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;TLe();var i=E.useMemo(function(){return CLe(s)},[s]);return E.createElement(kLe,{styles:ELe(i,!t,s,n?"":"!important")})},O4=!1;if(typeof window<"u")try{var l2=Object.defineProperty({},"passive",{get:function(){return O4=!0,!0}});window.addEventListener("test",l2,l2),window.removeEventListener("test",l2,l2)}catch{O4=!1}var B0=O4?{passive:!1}:!1,NLe=function(e){return e.tagName==="TEXTAREA"},dne=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!NLe(e)&&n[t]==="visible")},RLe=function(e){return dne(e,"overflowY")},ILe=function(e){return dne(e,"overflowX")},zq=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=fne(e,r);if(s){var i=hne(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},MLe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},jLe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},fne=function(e,t){return e==="v"?RLe(t):ILe(t)},hne=function(e,t){return e==="v"?MLe(t):jLe(t)},PLe=function(e,t){return e==="h"&&t==="rtl"?-1:1},OLe=function(e,t,n,r,s){var i=PLe(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var p=hne(e,o),g=p[0],y=p[1],v=p[2],x=y-v-i*g;(g||x)&&fne(e,o)&&(d+=x,h+=g),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},c2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Uq=function(e){return[e.deltaX,e.deltaY]},qq=function(e){return e&&"current"in e?e.current:e},DLe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},FLe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},LLe=0,z0=[];function $Le(e){var t=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),s=E.useState(LLe++)[0],i=E.useState(une)[0],a=E.useRef(e);E.useEffect(function(){a.current=e},[e]),E.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var y=aLe([e.lockRef.current],(e.shards||[]).map(qq),!0).filter(Boolean);return y.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),y.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=E.useCallback(function(y,v){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!a.current.allowPinchZoom;var x=c2(y),w=n.current,S="deltaX"in y?y.deltaX:w[0]-x[0],_="deltaY"in y?y.deltaY:w[1]-x[1],k,T=y.target,A=Math.abs(S)>Math.abs(_)?"h":"v";if("touches"in y&&A==="h"&&T.type==="range")return!1;var R=zq(A,T);if(!R)return!0;if(R?k=A:(k=A==="v"?"h":"v",R=zq(A,T)),!R)return!1;if(!r.current&&"changedTouches"in y&&(S||_)&&(r.current=k),!k)return!0;var M=r.current||k;return OLe(M,v,y,M==="h"?S:_)},[]),l=E.useCallback(function(y){var v=y;if(!(!z0.length||z0[z0.length-1]!==i)){var x="deltaY"in v?Uq(v):c2(v),w=t.current.filter(function(k){return k.name===v.type&&(k.target===v.target||v.target===k.shadowParent)&&DLe(k.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(a.current.shards||[]).map(qq).filter(Boolean).filter(function(k){return k.contains(v.target)}),_=S.length>0?o(v,S[0]):!a.current.noIsolation;_&&v.cancelable&&v.preventDefault()}}},[]),c=E.useCallback(function(y,v,x,w){var S={name:y,delta:v,target:x,should:w,shadowParent:BLe(x)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(_){return _!==S})},1)},[]),u=E.useCallback(function(y){n.current=c2(y),r.current=void 0},[]),d=E.useCallback(function(y){c(y.type,Uq(y),y.target,o(y,e.lockRef.current))},[]),h=E.useCallback(function(y){c(y.type,c2(y),y.target,o(y,e.lockRef.current))},[]);E.useEffect(function(){return z0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,B0),document.addEventListener("touchmove",l,B0),document.addEventListener("touchstart",u,B0),function(){z0=z0.filter(function(y){return y!==i}),document.removeEventListener("wheel",l,B0),document.removeEventListener("touchmove",l,B0),document.removeEventListener("touchstart",u,B0)}},[]);var p=e.removeScrollBar,g=e.inert;return E.createElement(E.Fragment,null,g?E.createElement(i,{styles:FLe(s)}):null,p?E.createElement(ALe,{gapMode:e.gapMode}):null)}function BLe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const zLe=mLe(cne,$Le);var YS=E.forwardRef(function(e,t){return E.createElement(BA,Uu({},e,{ref:t,sideCar:zLe}))});YS.classNames=BA.classNames;var ULe=[" ","Enter","ArrowUp","ArrowDown"],qLe=[" ","Enter"],lg="Select",[zA,UA,VLe]=k6e(lg),[nv,vvt]=Pi(lg,[VLe,Yte]),qA=Yte(),[WLe,Pp]=nv(lg),[HLe,GLe]=nv(lg),pne=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:p,form:g}=e,y=qA(t),[v,x]=E.useState(null),[w,S]=E.useState(null),[_,k]=E.useState(!1),T=Og(c),[A,R]=pc({prop:r,defaultProp:s??!1,onChange:i,caller:lg}),[M,j]=pc({prop:a,defaultProp:o,onChange:l,caller:lg}),F=E.useRef(null),P=v?g||!!v.closest("form"):!0,[q,I]=E.useState(new Set),V=Array.from(q).map(D=>D.props.value).join(";");return f.jsx(Z6e,{...y,children:f.jsxs(WLe,{required:p,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:_,onValueNodeHasChildrenChange:k,contentId:_a(),value:M,onValueChange:j,open:A,onOpenChange:R,dir:T,triggerPointerDownPosRef:F,disabled:h,children:[f.jsx(zA.Provider,{scope:t,children:f.jsx(HLe,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(D=>{I(z=>new Set(z).add(D))},[]),onNativeOptionRemove:E.useCallback(D=>{I(z=>{const $=new Set(z);return $.delete(D),$})},[]),children:n})}),P?f.jsxs(Dne,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:M,onChange:D=>j(D.target.value),disabled:h,form:g,children:[M===void 0?f.jsx("option",{value:""}):null,Array.from(q)]},V):null]})})};pne.displayName=lg;var mne="SelectTrigger",gne=E.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=qA(n),a=Pp(mne,n),o=a.disabled||r,l=Tn(t,a.onTriggerChange),c=UA(n),u=E.useRef("touch"),[d,h,p]=Lne(y=>{const v=c().filter(S=>!S.disabled),x=v.find(S=>S.value===a.value),w=$ne(v,y,x);w!==void 0&&a.onValueChange(w.value)}),g=y=>{o||(a.onOpenChange(!0),p()),y&&(a.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return f.jsx(X6e,{asChild:!0,...i,children:f.jsx(Oi.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Fne(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,y=>{y.currentTarget.focus(),u.current!=="mouse"&&g(y)}),onPointerDown:Wt(s.onPointerDown,y=>{u.current=y.pointerType;const v=y.target;v.hasPointerCapture(y.pointerId)&&v.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(g(y),y.preventDefault())}),onKeyDown:Wt(s.onKeyDown,y=>{const v=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&h(y.key),!(v&&y.key===" ")&&ULe.includes(y.key)&&(g(),y.preventDefault())})})})});gne.displayName=mne;var yne="SelectValue",bne=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=Pp(yne,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=Tn(t,l.onValueNodeChange);return di(()=>{c(u)},[c,u]),f.jsx(Oi.span,{...o,ref:d,style:{pointerEvents:"none"},children:Fne(l.value)?f.jsx(f.Fragment,{children:a}):i})});bne.displayName=yne;var KLe="SelectIcon",vne=E.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(Oi.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});vne.displayName=KLe;var YLe="SelectPortal",xne=e=>f.jsx(sne,{asChild:!0,...e});xne.displayName=YLe;var cg="SelectContent",wne=E.forwardRef((e,t)=>{const n=Pp(cg,e.__scopeSelect),[r,s]=E.useState();if(di(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?Nl.createPortal(f.jsx(Sne,{scope:e.__scopeSelect,children:f.jsx(zA.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(_ne,{...e,ref:t})});wne.displayName=cg;var Lc=10,[Sne,Op]=nv(cg),ZLe="SelectContentImpl",XLe=rd("SelectContent.RemoveScroll"),_ne=E.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:y,avoidCollisions:v,...x}=e,w=Pp(cg,n),[S,_]=E.useState(null),[k,T]=E.useState(null),A=Tn(t,Ee=>_(Ee)),[R,M]=E.useState(null),[j,F]=E.useState(null),P=UA(n),[q,I]=E.useState(!1),V=E.useRef(!1);E.useEffect(()=>{if(S)return $A(S)},[S]),LA();const D=E.useCallback(Ee=>{const[he,...pe]=P().map(Fe=>Fe.ref.current),[Le]=pe.slice(-1),He=document.activeElement;for(const Fe of Ee)if(Fe===He||(Fe==null||Fe.scrollIntoView({block:"nearest"}),Fe===he&&k&&(k.scrollTop=0),Fe===Le&&k&&(k.scrollTop=k.scrollHeight),Fe==null||Fe.focus(),document.activeElement!==He))return},[P,k]),z=E.useCallback(()=>D([R,S]),[D,R,S]);E.useEffect(()=>{q&&z()},[q,z]);const{onOpenChange:$,triggerPointerDownPosRef:Y}=w;E.useEffect(()=>{if(S){let Ee={x:0,y:0};const he=Le=>{var He,Fe;Ee={x:Math.abs(Math.round(Le.pageX)-(((He=Y.current)==null?void 0:He.x)??0)),y:Math.abs(Math.round(Le.pageY)-(((Fe=Y.current)==null?void 0:Fe.y)??0))}},pe=Le=>{Ee.x<=10&&Ee.y<=10?Le.preventDefault():S.contains(Le.target)||$(!1),document.removeEventListener("pointermove",he),Y.current=null};return Y.current!==null&&(document.addEventListener("pointermove",he),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",he),document.removeEventListener("pointerup",pe,{capture:!0})}}},[S,$,Y]),E.useEffect(()=>{const Ee=()=>$(!1);return window.addEventListener("blur",Ee),window.addEventListener("resize",Ee),()=>{window.removeEventListener("blur",Ee),window.removeEventListener("resize",Ee)}},[$]);const[B,G]=Lne(Ee=>{const he=P().filter(He=>!He.disabled),pe=he.find(He=>He.ref.current===document.activeElement),Le=$ne(he,Ee,pe);Le&&setTimeout(()=>Le.ref.current.focus())}),Z=E.useCallback((Ee,he,pe)=>{const Le=!V.current&&!pe;(w.value!==void 0&&w.value===he||Le)&&(M(Ee),Le&&(V.current=!0))},[w.value]),ne=E.useCallback(()=>S==null?void 0:S.focus(),[S]),ae=E.useCallback((Ee,he,pe)=>{const Le=!V.current&&!pe;(w.value!==void 0&&w.value===he||Le)&&F(Ee)},[w.value]),le=r==="popper"?D4:Cne,Se=le===D4?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:y,avoidCollisions:v}:{};return f.jsx(Sne,{scope:n,content:S,viewport:k,onViewportChange:T,itemRefCallback:Z,selectedItem:R,onItemLeave:ne,itemTextRefCallback:ae,focusSelectedItem:z,selectedItemText:j,position:r,isPositioned:q,searchRef:B,children:f.jsx(YS,{as:XLe,allowPinchZoom:!0,children:f.jsx(Wte,{asChild:!0,trapped:w.open,onMountAutoFocus:Ee=>{Ee.preventDefault()},onUnmountAutoFocus:Wt(s,Ee=>{var he;(he=w.trigger)==null||he.focus({preventScroll:!0}),Ee.preventDefault()}),children:f.jsx(qte,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:Ee=>Ee.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(le,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Ee=>Ee.preventDefault(),...x,...Se,onPlaced:()=>I(!0),ref:A,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,Ee=>{const he=Ee.ctrlKey||Ee.altKey||Ee.metaKey;if(Ee.key==="Tab"&&Ee.preventDefault(),!he&&Ee.key.length===1&&G(Ee.key),["ArrowUp","ArrowDown","Home","End"].includes(Ee.key)){let Le=P().filter(He=>!He.disabled).map(He=>He.ref.current);if(["ArrowUp","End"].includes(Ee.key)&&(Le=Le.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ee.key)){const He=Ee.target,Fe=Le.indexOf(He);Le=Le.slice(Fe+1)}setTimeout(()=>D(Le)),Ee.preventDefault()}})})})})})})});_ne.displayName=ZLe;var JLe="SelectItemAlignedPosition",Cne=E.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Pp(cg,n),a=Op(cg,n),[o,l]=E.useState(null),[c,u]=E.useState(null),d=Tn(t,A=>u(A)),h=UA(n),p=E.useRef(!1),g=E.useRef(!0),{viewport:y,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,S=E.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&y&&v&&x){const A=i.trigger.getBoundingClientRect(),R=c.getBoundingClientRect(),M=i.valueNode.getBoundingClientRect(),j=x.getBoundingClientRect();if(i.dir!=="rtl"){const He=j.left-R.left,Fe=M.left-He,Ie=A.left-Fe,X=A.width+Ie,ye=Math.max(X,R.width),Ne=window.innerWidth-Lc,fe=R1(Fe,[Lc,Math.max(Lc,Ne-ye)]);o.style.minWidth=X+"px",o.style.left=fe+"px"}else{const He=R.right-j.right,Fe=window.innerWidth-M.right-He,Ie=window.innerWidth-A.right-Fe,X=A.width+Ie,ye=Math.max(X,R.width),Ne=window.innerWidth-Lc,fe=R1(Fe,[Lc,Math.max(Lc,Ne-ye)]);o.style.minWidth=X+"px",o.style.right=fe+"px"}const F=h(),P=window.innerHeight-Lc*2,q=y.scrollHeight,I=window.getComputedStyle(c),V=parseInt(I.borderTopWidth,10),D=parseInt(I.paddingTop,10),z=parseInt(I.borderBottomWidth,10),$=parseInt(I.paddingBottom,10),Y=V+D+q+$+z,B=Math.min(v.offsetHeight*5,Y),G=window.getComputedStyle(y),Z=parseInt(G.paddingTop,10),ne=parseInt(G.paddingBottom,10),ae=A.top+A.height/2-Lc,le=P-ae,Se=v.offsetHeight/2,Ee=v.offsetTop+Se,he=V+D+Ee,pe=Y-he;if(he<=ae){const He=F.length>0&&v===F[F.length-1].ref.current;o.style.bottom="0px";const Fe=c.clientHeight-y.offsetTop-y.offsetHeight,Ie=Math.max(le,Se+(He?ne:0)+Fe+z),X=he+Ie;o.style.height=X+"px"}else{const He=F.length>0&&v===F[0].ref.current;o.style.top="0px";const Ie=Math.max(ae,V+y.offsetTop+(He?Z:0)+Se)+pe;o.style.height=Ie+"px",y.scrollTop=he-ae+y.offsetTop}o.style.margin=`${Lc}px 0`,o.style.minHeight=B+"px",o.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[h,i.trigger,i.valueNode,o,c,y,v,x,i.dir,r]);di(()=>S(),[S]);const[_,k]=E.useState();di(()=>{c&&k(window.getComputedStyle(c).zIndex)},[c]);const T=E.useCallback(A=>{A&&g.current===!0&&(S(),w==null||w(),g.current=!1)},[S,w]);return f.jsx(e8e,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:T,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_},children:f.jsx(Oi.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Cne.displayName=JLe;var QLe="SelectPopperPosition",D4=E.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Lc,...i}=e,a=qA(n);return f.jsx(J6e,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});D4.displayName=QLe;var[e8e,B5]=nv(cg,{}),F4="SelectViewport",kne=E.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=Op(F4,n),a=B5(F4,n),o=Tn(t,i.onViewportChange),l=E.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(zA.Slot,{scope:n,children:f.jsx(Oi.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const g=window.innerHeight-Lc*2,y=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(y,v);if(x<g){const w=x+p,S=Math.min(g,w),_=w-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=_>0?_:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});kne.displayName=F4;var Ene="SelectGroup",[t8e,n8e]=nv(Ene),r8e=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=_a();return f.jsx(t8e,{scope:n,id:s,children:f.jsx(Oi.div,{role:"group","aria-labelledby":s,...r,ref:t})})});r8e.displayName=Ene;var Tne="SelectLabel",s8e=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=n8e(Tne,n);return f.jsx(Oi.div,{id:s.id,...r,ref:t})});s8e.displayName=Tne;var RE="SelectItem",[i8e,Ane]=nv(RE),Nne=E.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=Pp(RE,n),l=Op(RE,n),c=o.value===r,[u,d]=E.useState(i??""),[h,p]=E.useState(!1),g=Tn(t,w=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,w,r,s)}),y=_a(),v=E.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(i8e,{scope:n,value:r,disabled:s,textId:y,isSelected:c,onItemTextChange:E.useCallback(w=>{d(S=>S||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(zA.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(Oi.div,{role:"option","aria-labelledby":y,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:g,onFocus:Wt(a.onFocus,()=>p(!0)),onBlur:Wt(a.onBlur,()=>p(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var S;v.current=w.pointerType,s?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var S;w.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var _;((_=l.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(qLe.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});Nne.displayName=RE;var Yx="SelectItemText",Rne=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=Pp(Yx,n),o=Op(Yx,n),l=Ane(Yx,n),c=GLe(Yx,n),[u,d]=E.useState(null),h=Tn(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),p=u==null?void 0:u.textContent,g=E.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:y,onNativeOptionRemove:v}=c;return di(()=>(y(g),()=>v(g)),[y,v,g]),f.jsxs(f.Fragment,{children:[f.jsx(Oi.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Nl.createPortal(i.children,a.valueNode):null]})});Rne.displayName=Yx;var Ine="SelectItemIndicator",Mne=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return Ane(Ine,n).isSelected?f.jsx(Oi.span,{"aria-hidden":!0,...r,ref:t}):null});Mne.displayName=Ine;var L4="SelectScrollUpButton",jne=E.forwardRef((e,t)=>{const n=Op(L4,e.__scopeSelect),r=B5(L4,e.__scopeSelect),[s,i]=E.useState(!1),a=Tn(t,r.onScrollButtonChange);return di(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(One,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});jne.displayName=L4;var $4="SelectScrollDownButton",Pne=E.forwardRef((e,t)=>{const n=Op($4,e.__scopeSelect),r=B5($4,e.__scopeSelect),[s,i]=E.useState(!1),a=Tn(t,r.onScrollButtonChange);return di(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(One,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});Pne.displayName=$4;var One=E.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=Op("SelectScrollButton",n),a=E.useRef(null),o=UA(n),l=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>l(),[l]),di(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(Oi.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),a8e="SelectSeparator",o8e=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(Oi.div,{"aria-hidden":!0,...r,ref:t})});o8e.displayName=a8e;var B4="SelectArrow",l8e=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=qA(n),i=Pp(B4,n),a=Op(B4,n);return i.open&&a.position==="popper"?f.jsx(Q6e,{...s,...r,ref:t}):null});l8e.displayName=B4;var c8e="SelectBubbleInput",Dne=E.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=E.useRef(null),i=Tn(r,s),a=KS(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(Oi.select,{...n,style:{...ine,...n.style},ref:i,defaultValue:t})});Dne.displayName=c8e;function Fne(e){return e===""||e===void 0}function Lne(e){const t=Ms(e),n=E.useRef(""),r=E.useRef(0),s=E.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=E.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function $ne(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=u8e(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function u8e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var d8e=pne,f8e=gne,h8e=bne,p8e=vne,m8e=xne,g8e=wne,y8e=kne,b8e=Nne,v8e=Rne,x8e=Mne,w8e=jne,S8e=Pne;function mc({...e}){return f.jsx(d8e,{"data-slot":"select",...e})}function gc({...e}){return f.jsx(h8e,{"data-slot":"select-value",...e})}function yc({className:e,size:t="default",children:n,...r}){return f.jsxs(f8e,{"data-slot":"select-trigger","data-size":t,className:Ye("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(p8e,{asChild:!0,children:f.jsx(Fl,{className:"size-4 opacity-50"})})]})}function bc({className:e,children:t,position:n="popper",...r}){return f.jsx(m8e,{children:f.jsxs(g8e,{"data-slot":"select-content",className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(_8e,{}),f.jsx(y8e,{className:Ye("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(C8e,{})]})})}function yi({className:e,children:t,...n}){return f.jsxs(b8e,{"data-slot":"select-item",className:Ye("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(x8e,{children:f.jsx(Ao,{className:"size-4"})})}),f.jsx(v8e,{children:t})]})}function _8e({className:e,...t}){return f.jsx(w8e,{"data-slot":"select-scroll-up-button",className:Ye("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(wp,{className:"size-4"})})}function C8e({className:e,...t}){return f.jsx(S8e,{"data-slot":"select-scroll-down-button",className:Ye("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Fl,{className:"size-4"})})}const k8e=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ye("space-y-1.5",o),children:[t&&f.jsx(At,{htmlFor:e.name+"-trigger",className:Ye("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(mc,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(yc,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Ye(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(gc,{placeholder:n||"Select an option"})}),f.jsx(bc,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(yi,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]});var E8e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],z5=E8e.reduce((e,t)=>{const n=rd(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),VA="Checkbox",[T8e,xvt]=Pi(VA),[A8e,U5]=T8e(VA);function N8e(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,p]=pc({prop:n,defaultProp:s??!1,onChange:l,caller:VA}),[g,y]=E.useState(null),[v,x]=E.useState(null),w=E.useRef(!1),S=g?!!a||!!g.closest("form"):!0,_={checked:h,disabled:i,setChecked:p,control:g,setControl:y,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:Kh(s)?!1:s,isFormControl:S,bubbleInput:v,setBubbleInput:x};return f.jsx(A8e,{scope:t,..._,children:R8e(d)?d(_):r})}var Bne="CheckboxTrigger",zne=E.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:p,bubbleInput:g}=U5(Bne,e),y=Tn(s,u),v=E.useRef(l);return E.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(z5.button,{type:"button",role:"checkbox","aria-checked":Kh(l)?"mixed":l,"aria-required":c,"data-state":Gne(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:y,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>Kh(w)?!0:!w),g&&p&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});zne.displayName=Bne;var Une=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(N8e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(zne,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(Hne,{__scopeCheckbox:n})]})})});Une.displayName=VA;var qne="CheckboxIndicator",Vne=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=U5(qne,n);return f.jsx(ca,{present:r||Kh(i.checked)||i.checked===!0,children:f.jsx(z5.span,{"data-state":Gne(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});Vne.displayName=qne;var Wne="CheckboxBubbleInput",Hne=E.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:p}=U5(Wne,e),g=Tn(n,p),y=KS(i),v=Sg(r);E.useEffect(()=>{const w=h;if(!w)return;const S=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(S,"checked").set,T=!s.current;if(y!==i&&k){const A=new Event("click",{bubbles:T});w.indeterminate=Kh(i),k.call(w,Kh(i)?!1:i),w.dispatchEvent(A)}},[h,y,i,s]);const x=E.useRef(Kh(i)?!1:i);return f.jsx(z5.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:g,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Hne.displayName=Wne;function R8e(e){return typeof e=="function"}function Kh(e){return e==="indeterminate"}function Gne(e){return Kh(e)?"indeterminate":e?"checked":"unchecked"}function au({className:e,...t}){return f.jsx(Une,{"data-slot":"checkbox",className:Ye("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(Vne,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(Ao,{className:"size-3.5"})})})}const I8e=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ye("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(au,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(At,{htmlFor:e.name,className:Ye("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]});var M8e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Kne=M8e.reduce((e,t)=>{const n=rd(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),WA="Switch",[j8e,wvt]=Pi(WA),[P8e,O8e]=j8e(WA),Yne=E.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,p]=E.useState(null),g=Tn(t,S=>p(S)),y=E.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=pc({prop:s,defaultProp:i??!1,onChange:c,caller:WA});return f.jsxs(P8e,{scope:n,checked:x,disabled:o,children:[f.jsx(Kne.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":Qne(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:g,onClick:Wt(e.onClick,S=>{w(_=>!_),v&&(y.current=S.isPropagationStopped(),y.current||S.stopPropagation())})}),v&&f.jsx(Jne,{control:h,bubbles:!y.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});Yne.displayName=WA;var Zne="SwitchThumb",Xne=E.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=O8e(Zne,n);return f.jsx(Kne.span,{"data-state":Qne(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});Xne.displayName=Zne;var D8e="SwitchBubbleInput",Jne=E.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=Tn(a,i),l=KS(n),c=Sg(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&p){const g=new Event("click",{bubbles:r});p.call(u,n),u.dispatchEvent(g)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Jne.displayName=D8e;function Qne(e){return e?"checked":"unchecked"}var F8e=Yne,L8e=Xne;function Eo({className:e,...t}){return f.jsx(F8e,{"data-slot":"switch",className:Ye("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(L8e,{"data-slot":"switch-thumb",className:Ye("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const $8e=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ye("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Eo,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(At,{htmlFor:e.name,className:Ye("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),B8e=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:p}=e,g=d.value,y=x=>{const w=x.target.value;if(w==="")h(void 0);else{const S=parseFloat(w);h(isNaN(S)?w:S)}};let v="";return(typeof g=="number"||typeof g=="string")&&(v=g),f.jsxs("div",{className:Ye("space-y-1.5",a),children:[t&&f.jsx(At,{htmlFor:u,className:Ye("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(vn,{id:u,name:u,type:"number",value:v,onBlur:p,onChange:y,placeholder:r,min:o,max:l,step:c,className:Ye(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},g3={},Zx={};function gw(e,t){try{const r=(g3[e]||(g3[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in Zx?Zx[r]:Vq(r,r.split(":"))}catch{if(e in Zx)return Zx[e];const n=e==null?void 0:e.match(z8e);return n?Vq(e,n.slice(1)):NaN}}const z8e=/([+-]\d\d):?(\d\d)?/;function Vq(e,t){const n=+t[0],r=+(t[1]||0);return Zx[e]=n>0?n*60+r:n*60-r}class Gu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(gw(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),ere(this),z4(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new Gu(...n,t):new Gu(Date.now(),t)}withTimeZone(t){return new Gu(+this,t)}getTimezoneOffset(){return-gw(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),z4(this),+this}[Symbol.for("constructDateFrom")](t){return new Gu(+new Date(t),this.timeZone)}}const Wq=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!Wq.test(e))return;const t=e.replace(Wq,"$1UTC");Gu.prototype[t]&&(e.startsWith("get")?Gu.prototype[e]=function(){return this.internal[t]()}:(Gu.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),U8e(this),+this},Gu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),z4(this),+this}))});function z4(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function U8e(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),ere(e)}function ere(e){const t=gw(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=gw(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const p=gw(e.timeZone,e),g=l-p;g&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+g),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+g))}}class Za extends Gu{static tz(t,...n){return n.length?new Za(...n,t):new Za(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${q8e(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new Za(+this,t)}[Symbol.for("constructDateFrom")](t){return new Za(+new Date(t),this.timeZone)}}function q8e(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var qn;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(qn||(qn={}));var ai;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(ai||(ai={}));var Hc;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(Hc||(Hc={}));var El;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(El||(El={}));const Hq=5,V8e=4;function W8e(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,Hq*7-1);return t.getMonth(e)===t.getMonth(i)?Hq:V8e}function tre(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function H8e(e,t){const n=tre(e,t),r=W8e(e,t);return t.addDays(n,r*7-1)}class Lf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?Za.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new Za(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):CQ(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):kQ(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):WIe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):HIe(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):TQ(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):NQ(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):iMe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):H8e(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):lMe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):RQ(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):MQ(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):oMe(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):zu(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):jQ(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):aje(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):oje(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):OQ(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):lje(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):cje(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):AQ(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):ZIe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):uje(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):dje(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):GIe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):KIe(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):Aje(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):Nje(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):tre(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):m1(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):p1(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):aMe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):ab(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):IQ(r)},this.options={locale:CA,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const bd=new Lf;class nre{constructor(t,n,r=bd){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class G8e{constructor(t,n){this.date=t,this.weeks=n}}class K8e{constructor(t,n){this.days=n,this.weekNumber=t}}function cf(e,t,n=!1,r=bd){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function rre(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function q5(e){return!!(e&&typeof e=="object"&&"from"in e)}function sre(e){return!!(e&&typeof e=="object"&&"after"in e)}function ire(e){return!!(e&&typeof e=="object"&&"before"in e)}function are(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function ore(e,t){return Array.isArray(e)&&e.every(t.isDate)}function uf(e,t,n=bd){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(ore(o,n))return o.includes(e);if(q5(o))return cf(o,e,!1,n);if(are(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(rre(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return sre(o)?i(e,o.after)>0:ire(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function Y8e(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:p,isAfter:g}=n,y=t.startMonth&&d(t.startMonth),v=t.endMonth&&p(t.endMonth),x={[ai.focused]:[],[ai.outside]:[],[ai.disabled]:[],[ai.hidden]:[],[ai.today]:[]},w={};for(const S of e){const{date:_,displayMonth:k}=S,T=!!(k&&!u(_,k)),A=!!(y&&h(_,y)),R=!!(v&&g(_,v)),M=!!(r&&uf(_,r,n)),j=!!(s&&uf(_,s,n))||A||R||!o&&!a&&T||o&&a===!1&&T,F=c(_,l??n.today());T&&x.outside.push(S),M&&x.disabled.push(S),j&&x.hidden.push(S),F&&x.today.push(S),i&&Object.keys(i).forEach(P=>{const q=i==null?void 0:i[P];q&&uf(_,q,n)&&(w[P]?w[P].push(S):w[P]=[S])})}return S=>{const _={[ai.focused]:!1,[ai.disabled]:!1,[ai.hidden]:!1,[ai.outside]:!1,[ai.today]:!1},k={};for(const T in x){const A=x[T];_[T]=A.some(R=>R===S)}for(const T in w)k[T]=w[T].some(A=>A===S);return{..._,...k}}}function Z8e(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[ai[i]]?s.push(t[ai[i]]):t[Hc[i]]&&s.push(t[Hc[i]]),s),[t[qn.Day]])}function X8e(e){return We.createElement("button",{...e})}function J8e(e){return We.createElement("span",{...e})}function Q8e(e){const{size:t=24,orientation:n="left",className:r}=e;return We.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&We.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&We.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&We.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&We.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function e$e(e){const{day:t,modifiers:n,...r}=e;return We.createElement("td",{...r})}function t$e(e){const{day:t,modifiers:n,...r}=e,s=We.useRef(null);return We.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),We.createElement("button",{ref:s,...r})}function n$e(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[qn.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return We.createElement("span",{"data-disabled":i.disabled,className:s[qn.DropdownRoot]},We.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>We.createElement(r.Option,{key:l,value:l,disabled:u},c))),We.createElement("span",{className:s[qn.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,We.createElement(r.Chevron,{orientation:"down",size:18,className:s[qn.Chevron]})))}function r$e(e){return We.createElement("div",{...e})}function s$e(e){return We.createElement("div",{...e})}function i$e(e){const{calendarMonth:t,displayIndex:n,...r}=e;return We.createElement("div",{...r},e.children)}function a$e(e){const{calendarMonth:t,displayIndex:n,...r}=e;return We.createElement("div",{...r})}function o$e(e){return We.createElement("table",{...e})}function l$e(e){return We.createElement("div",{...e})}const lre=E.createContext(void 0);function ZS(){const e=E.useContext(lre);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function c$e(e){const{components:t}=ZS();return We.createElement(t.Dropdown,{...e})}function u$e(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=ZS(),u=E.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=E.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return We.createElement("nav",{...i},We.createElement(a.PreviousMonthButton,{type:"button",className:o[qn.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},We.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[qn.Chevron],orientation:"left"})),We.createElement(a.NextMonthButton,{type:"button",className:o[qn.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},We.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[qn.Chevron]})))}function d$e(e){const{components:t}=ZS();return We.createElement(t.Button,{...e})}function f$e(e){return We.createElement("option",{...e})}function h$e(e){const{components:t}=ZS();return We.createElement(t.Button,{...e})}function p$e(e){const{rootRef:t,...n}=e;return We.createElement("div",{...n,ref:t})}function m$e(e){return We.createElement("select",{...e})}function g$e(e){const{week:t,...n}=e;return We.createElement("tr",{...n})}function y$e(e){return We.createElement("th",{...e})}function b$e(e){return We.createElement("thead",{"aria-hidden":!0},We.createElement("tr",{...e}))}function v$e(e){const{week:t,...n}=e;return We.createElement("th",{...n})}function x$e(e){return We.createElement("th",{...e})}function w$e(e){return We.createElement("tbody",{...e})}function S$e(e){const{components:t}=ZS();return We.createElement(t.Dropdown,{...e})}const _$e=Object.freeze(Object.defineProperty({__proto__:null,Button:X8e,CaptionLabel:J8e,Chevron:Q8e,Day:e$e,DayButton:t$e,Dropdown:n$e,DropdownNav:r$e,Footer:s$e,Month:i$e,MonthCaption:a$e,MonthGrid:o$e,Months:l$e,MonthsDropdown:c$e,Nav:u$e,NextMonthButton:d$e,Option:f$e,PreviousMonthButton:h$e,Root:p$e,Select:m$e,Week:g$e,WeekNumber:v$e,WeekNumberHeader:x$e,Weekday:y$e,Weekdays:b$e,Weeks:w$e,YearsDropdown:S$e},Symbol.toStringTag,{value:"Module"}));function C$e(e){return{..._$e,...e}}function k$e(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function V5(){const e={};for(const t in qn)e[qn[t]]=`rdp-${qn[t]}`;for(const t in ai)e[ai[t]]=`rdp-${ai[t]}`;for(const t in Hc)e[Hc[t]]=`rdp-${Hc[t]}`;for(const t in El)e[El[t]]=`rdp-${El[t]}`;return e}function cre(e,t,n){return(n??new Lf(t)).format(e,"LLLL y")}const E$e=cre;function T$e(e,t,n){return(n??new Lf(t)).format(e,"d")}function A$e(e,t=bd){return t.format(e,"LLLL")}function N$e(e,t=bd){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function R$e(){return""}function I$e(e,t,n){return(n??new Lf(t)).format(e,"cccccc")}function ure(e,t=bd){return t.format(e,"yyyy")}const M$e=ure,j$e=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:cre,formatDay:T$e,formatMonthCaption:E$e,formatMonthDropdown:A$e,formatWeekNumber:N$e,formatWeekNumberHeader:R$e,formatWeekdayName:I$e,formatYearCaption:M$e,formatYearDropdown:ure},Symbol.toStringTag,{value:"Module"}));function P$e(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...j$e,...e}}function O$e(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const p=r.formatMonthDropdown(h,s),g=c(h),y=t&&h<i(t)||n&&h>i(n)||!1;return{value:g,label:p,disabled:y}})}function D$e(e,t={},n={}){let r={...t==null?void 0:t[qn.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function F$e(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function L$e(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let p=u;for(;l(p,d)||c(p,d);)h.push(p),p=a(p,1);return h.map(g=>{const y=n.formatYearDropdown(g,r);return{value:o(g),label:y,disabled:!1}})}function dre(e,t,n){return(n??new Lf(t)).format(e,"LLLL y")}const $$e=dre;function B$e(e,t,n,r){let s=(r??new Lf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function fre(e,t,n,r){let s=(r??new Lf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const z$e=fre;function U$e(){return""}function q$e(e){return"Choose the Month"}function V$e(e){return"Go to the Next Month"}function W$e(e){return"Go to the Previous Month"}function H$e(e,t,n){return(n??new Lf(t)).format(e,"cccc")}function G$e(e,t){return`Week ${e}`}function K$e(e){return"Week Number"}function Y$e(e){return"Choose the Year"}const Z$e=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:$$e,labelDay:z$e,labelDayButton:fre,labelGrid:dre,labelGridcell:B$e,labelMonthDropdown:q$e,labelNav:U$e,labelNext:V$e,labelPrevious:W$e,labelWeekNumber:G$e,labelWeekNumberHeader:K$e,labelWeekday:H$e,labelYearDropdown:Y$e},Symbol.toStringTag,{value:"Module"})),XS=e=>e instanceof HTMLElement?e:null,y3=e=>[...e.querySelectorAll("[data-animated-month]")??[]],X$e=e=>XS(e.querySelector("[data-animated-month]")),b3=e=>XS(e.querySelector("[data-animated-caption]")),v3=e=>XS(e.querySelector("[data-animated-weeks]")),J$e=e=>XS(e.querySelector("[data-animated-nav]")),Q$e=e=>XS(e.querySelector("[data-animated-weekdays]"));function eBe(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=E.useRef(null),o=E.useRef(r),l=E.useRef(!1);E.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[El.caption_after_enter]:n[El.caption_before_enter],p=d?n[El.weeks_after_enter]:n[El.weeks_before_enter],g=a.current,y=e.current.cloneNode(!0);if(y instanceof HTMLElement?(y3(y).forEach(S=>{if(!(S instanceof HTMLElement))return;const _=X$e(S);_&&S.contains(_)&&S.removeChild(_);const k=b3(S);k&&k.classList.remove(h);const T=v3(S);T&&T.classList.remove(p)}),a.current=y):a.current=null,l.current||u||s)return;const v=g instanceof HTMLElement?y3(g):[],x=y3(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=J$e(e.current);w&&(w.style.zIndex="1"),x.forEach((S,_)=>{const k=v[_];if(!k)return;S.style.position="relative",S.style.overflow="hidden";const T=b3(S);T&&T.classList.add(h);const A=v3(S);A&&A.classList.add(p);const R=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),T&&T.classList.remove(h),A&&A.classList.remove(p),S.style.position="",S.style.overflow="",S.contains(k)&&S.removeChild(k)};k.style.pointerEvents="none",k.style.position="absolute",k.style.overflow="hidden",k.setAttribute("aria-hidden","true");const M=Q$e(k);M&&(M.style.opacity="0");const j=b3(k);j&&(j.classList.add(d?n[El.caption_before_exit]:n[El.caption_after_exit]),j.addEventListener("animationend",R));const F=v3(k);F&&F.classList.add(d?n[El.weeks_before_exit]:n[El.weeks_after_exit]),S.insertBefore(k,S.firstChild)})}})}function tBe(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:p,endOfMonth:g,endOfWeek:y,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:S}=r,_=l?x(s,r):a?w(s):S(s),k=l?h(i):a?p(g(i)):y(g(i)),T=u(k,_),A=d(i,s)+1,R=[];for(let F=0;F<=T;F++){const P=c(_,F);if(t&&v(P,t))break;R.push(P)}const j=(l?35:42)*A;if(o&&R.length<j){const F=j-R.length;for(let P=0;P<F;P++){const q=c(R[R.length-1],1);R.push(q)}}return R}function nBe(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function rBe(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function Gq(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function sBe(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:p}=r,g=e.reduce((y,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):p(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),S=t.filter(A=>A>=x&&A<=w),_=n.broadcastCalendar?35:42;if(n.fixedWeeks&&S.length<_){const A=t.filter(R=>{const M=_-S.length;return R>w&&R<=s(w,M)});S.push(...A)}const k=S.reduce((A,R)=>{const M=n.ISOWeek?c(R):u(R),j=A.find(P=>P.weekNumber===M),F=new nre(R,v,r);return j?j.days.push(F):A.push(new K8e(M,[F])),A},[]),T=new G8e(v,k);return y.push(T),y},[]);return n.reverseMonths?g.reverse():g}function iBe(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:p,fromMonth:g,toMonth:y}=e;!n&&g&&(n=g),!n&&h&&(n=t.newDate(h,0,1)),!r&&y&&(r=y),!r&&p&&(r=u(p,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):p?r=u(p,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function aBe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function oBe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function lBe(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function HA(e,t){const[n,r]=E.useState(e);return[t===void 0?n:t,r]}function cBe(e,t){const[n,r]=iBe(e,t),{startOfMonth:s,endOfMonth:i}=t,a=Gq(e,t),[o,l]=HA(a,e.month?a:void 0);E.useEffect(()=>{const T=Gq(e,t);l(T)},[e.timeZone]);const c=rBe(o,r,e,t),u=tBe(c,e.endMonth?i(e.endMonth):void 0,e,t),d=sBe(c,u,e,t),h=lBe(d),p=nBe(d),g=oBe(o,n,e,t),y=aBe(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=T=>h.some(A=>A.days.some(R=>R.isEqualTo(T))),S=T=>{if(v)return;let A=s(T);n&&A<s(n)&&(A=s(n)),r&&A>s(r)&&(A=s(r)),l(A),x==null||x(A)};return{months:d,weeks:h,days:p,navStart:n,navEnd:r,previousMonth:g,nextMonth:y,goToMonth:S,goToDay:T=>{w(T)||S(T.date)}}}var ju;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(ju||(ju={}));function Kq(e){return!e[ai.disabled]&&!e[ai.hidden]&&!e[ai.outside]}function uBe(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);Kq(o)&&(o[ai.focused]&&i<ju.FocusedModifier?(s=a,i=ju.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<ju.LastFocused?(s=a,i=ju.LastFocused):n(a.date)&&i<ju.Selected?(s=a,i=ju.Selected):o[ai.today]&&i<ju.Today&&(s=a,i=ju.Today))}return s||(s=e.find(a=>Kq(t(a)))),s}function dBe(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:p,endOfISOWeek:g,endOfWeek:y,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:S,startOfWeek:_}=a;let T={day:c,week:d,month:u,year:h,startOfWeek:A=>l?w(A,a):o?S(A):_(A),endOfWeek:A=>l?p(A):o?g(A):y(A)}[e](n,t==="after"?1:-1);return t==="before"&&r?T=v([r,T]):t==="after"&&s&&(T=x([s,T])),T}function hre(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=dBe(e,t,n.date,r,s,i,a),c=!!(i.disabled&&uf(l,i.disabled,a)),u=!!(i.hidden&&uf(l,i.hidden,a)),d=l,h=new nre(l,d,a);return!c&&!u?h:hre(e,t,h,r,s,i,a,o+1)}function fBe(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=E.useState(),l=uBe(t.days,n,r||(()=>!1),a),[c,u]=E.useState(i?l:void 0);return{isFocusTarget:y=>!!(l!=null&&l.isEqualTo(y)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(y,v)=>{if(!c)return;const x=hre(y,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function hBe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=HA(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=p=>(o==null?void 0:o.some(g=>l(g,p)))??!1,{min:u,max:d}=e;return{selected:o,select:(p,g,y)=>{let v=[...o??[]];if(c(p)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,p))}else(o==null?void 0:o.length)===d?v=[p]:v=[...v,p];return s||a(v),s==null||s(v,p,g,y),v},isSelected:c}}function pBe(e,t,n=0,r=0,s=!1,i=bd){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function mBe(e,t,n=bd){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function Yq(e,t,n=bd){return cf(e,t.from,!1,n)||cf(e,t.to,!1,n)||cf(t,e.from,!1,n)||cf(t,e.to,!1,n)}function gBe(e,t,n=bd){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?cf(e,o,!1,n):ore(o,n)?o.some(l=>cf(e,l,!1,n)):q5(o)?o.from&&o.to?Yq(e,{from:o.from,to:o.to},n):!1:are(o)?mBe(e,o.dayOfWeek,n):rre(o)?n.isAfter(o.before,o.after)?Yq(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):uf(e.from,o,n)||uf(e.to,o,n):sre(o)||ire(o)?uf(e.from,o,n)||uf(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function yBe(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=HA(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,p,g)=>{const{min:y,max:v}=e,x=h?pBe(h,c,y,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&gBe({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,p,g),x},isSelected:h=>c&&cf(c,h,!1,t)}}function bBe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=HA(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,p)=>{let g=d;return!r&&o&&o&&l(d,o)&&(g=void 0),s||a(g),s==null||s(g,d,h,p),g},isSelected:d=>o?l(o,d):!1}}function vBe(e,t){const n=bBe(e,t),r=hBe(e,t),s=yBe(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function xBe(e){var ht;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Za(t.today,t.timeZone)),t.month&&(t.month=new Za(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Za(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Za(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Za(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Za(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(ht=t.selected)==null?void 0:ht.map(et=>new Za(et,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Za(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Za(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=E.useMemo(()=>{const et={...CA,...t.locale};return{dateLib:new Lf({locale:et,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:C$e(t.components),formatters:P$e(t.formatters),labels:{...Z$e,...t.labels},locale:et,classNames:{...V5(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:p,onDayFocus:g,onDayKeyDown:y,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:S,showWeekNumber:_,styles:k}=t,{formatCaption:T,formatDay:A,formatMonthDropdown:R,formatWeekNumber:M,formatWeekNumberHeader:j,formatWeekdayName:F,formatYearDropdown:P}=r,q=cBe(t,i),{days:I,months:V,navStart:D,navEnd:z,previousMonth:$,nextMonth:Y,goToMonth:B}=q,G=Y8e(I,t,i),{isSelected:Z,select:ne,selected:ae}=vBe(t,i)??{},{blur:le,focused:Se,isFocusTarget:Ee,moveFocus:he,setFocused:pe}=fBe(t,q,G,Z??(()=>!1),i),{labelDayButton:Le,labelGridcell:He,labelGrid:Fe,labelMonthDropdown:Ie,labelNav:X,labelPrevious:ye,labelNext:Ne,labelWeekday:fe,labelWeekNumber:ce,labelWeekNumberHeader:se,labelYearDropdown:Pe}=s,Be=E.useMemo(()=>F$e(i,t.ISOWeek),[i,t.ISOWeek]),je=c!==void 0||p!==void 0,ot=E.useCallback(()=>{$&&(B($),S==null||S($))},[$,B,S]),Et=E.useCallback(()=>{Y&&(B(Y),w==null||w(Y))},[B,Y,w]),ut=E.useCallback((et,W)=>Ve=>{Ve.preventDefault(),Ve.stopPropagation(),pe(et),ne==null||ne(et.date,W,Ve),p==null||p(et.date,W,Ve)},[ne,p,pe]),Pt=E.useCallback((et,W)=>Ve=>{pe(et),g==null||g(et.date,W,Ve)},[g,pe]),$t=E.useCallback((et,W)=>Ve=>{le(),h==null||h(et.date,W,Ve)},[le,h]),Ft=E.useCallback((et,W)=>Ve=>{const tt={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[Ve.shiftKey?"year":"month","before"],PageDown:[Ve.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(tt[Ve.key]){Ve.preventDefault(),Ve.stopPropagation();const[we,Te]=tt[Ve.key];he(we,Te)}y==null||y(et.date,W,Ve)},[he,y,t.dir]),Ht=E.useCallback((et,W)=>Ve=>{v==null||v(et.date,W,Ve)},[v]),Ce=E.useCallback((et,W)=>Ve=>{x==null||x(et.date,W,Ve)},[x]),U=E.useCallback(et=>W=>{const Ve=Number(W.target.value),tt=i.setMonth(i.startOfMonth(et),Ve);B(tt)},[i,B]),ee=E.useCallback(et=>W=>{const Ve=Number(W.target.value),tt=i.setYear(i.startOfMonth(et),Ve);B(tt)},[i,B]),{className:xe,style:Re}=E.useMemo(()=>({className:[o[qn.Root],t.className].filter(Boolean).join(" "),style:{...k==null?void 0:k[qn.Root],...t.style}}),[o,t.className,t.style,k]),ve=k$e(t),Me=E.useRef(null);eBe(Me,!!t.animate,{classNames:o,months:V,focused:Se,dateLib:i});const de={dayPickerProps:t,selected:ae,select:ne,isSelected:Z,months:V,nextMonth:Y,previousMonth:$,goToMonth:B,getModifiers:G,components:n,classNames:o,styles:k,labels:s,formatters:r};return We.createElement(lre.Provider,{value:de},We.createElement(n.Root,{rootRef:t.animate?Me:void 0,className:xe,style:Re,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...ve},We.createElement(n.Months,{className:o[qn.Months],style:k==null?void 0:k[qn.Months]},!t.hideNavigation&&!u&&We.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[qn.Nav],style:k==null?void 0:k[qn.Nav],"aria-label":X(),onPreviousClick:ot,onNextClick:Et,previousMonth:$,nextMonth:Y}),V.map((et,W)=>{const Ve=O$e(et.date,D,z,r,i),tt=L$e(D,z,r,i);return We.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[qn.Month],style:k==null?void 0:k[qn.Month],key:W,displayIndex:W,calendarMonth:et},u==="around"&&!t.hideNavigation&&W===0&&We.createElement(n.PreviousMonthButton,{type:"button",className:o[qn.PreviousMonthButton],tabIndex:$?void 0:-1,"aria-disabled":$?void 0:!0,"aria-label":ye($),onClick:ot,"data-animated-button":t.animate?"true":void 0},We.createElement(n.Chevron,{disabled:$?void 0:!0,className:o[qn.Chevron],orientation:t.dir==="rtl"?"right":"left"})),We.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[qn.MonthCaption],style:k==null?void 0:k[qn.MonthCaption],calendarMonth:et,displayIndex:W},l!=null&&l.startsWith("dropdown")?We.createElement(n.DropdownNav,{className:o[qn.Dropdowns],style:k==null?void 0:k[qn.Dropdowns]},l==="dropdown"||l==="dropdown-months"?We.createElement(n.MonthsDropdown,{className:o[qn.MonthsDropdown],"aria-label":Ie(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:U(et.date),options:Ve,style:k==null?void 0:k[qn.Dropdown],value:i.getMonth(et.date)}):We.createElement("span",null,R(et.date,i)),l==="dropdown"||l==="dropdown-years"?We.createElement(n.YearsDropdown,{className:o[qn.YearsDropdown],"aria-label":Pe(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:ee(et.date),options:tt,style:k==null?void 0:k[qn.Dropdown],value:i.getYear(et.date)}):We.createElement("span",null,P(et.date,i)),We.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},T(et.date,i.options,i))):We.createElement(n.CaptionLabel,{className:o[qn.CaptionLabel],role:"status","aria-live":"polite"},T(et.date,i.options,i))),u==="around"&&!t.hideNavigation&&W===d-1&&We.createElement(n.NextMonthButton,{type:"button",className:o[qn.NextMonthButton],tabIndex:Y?void 0:-1,"aria-disabled":Y?void 0:!0,"aria-label":Ne(Y),onClick:Et,"data-animated-button":t.animate?"true":void 0},We.createElement(n.Chevron,{disabled:Y?void 0:!0,className:o[qn.Chevron],orientation:t.dir==="rtl"?"left":"right"})),W===d-1&&u==="after"&&!t.hideNavigation&&We.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[qn.Nav],style:k==null?void 0:k[qn.Nav],"aria-label":X(),onPreviousClick:ot,onNextClick:Et,previousMonth:$,nextMonth:Y}),We.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":Fe(et.date,i.options,i)||void 0,className:o[qn.MonthGrid],style:k==null?void 0:k[qn.MonthGrid]},!t.hideWeekdays&&We.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[qn.Weekdays],style:k==null?void 0:k[qn.Weekdays]},_&&We.createElement(n.WeekNumberHeader,{"aria-label":se(i.options),className:o[qn.WeekNumberHeader],style:k==null?void 0:k[qn.WeekNumberHeader],scope:"col"},j()),Be.map((we,Te)=>We.createElement(n.Weekday,{"aria-label":fe(we,i.options,i),className:o[qn.Weekday],key:Te,style:k==null?void 0:k[qn.Weekday],scope:"col"},F(we,i.options,i)))),We.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[qn.Weeks],style:k==null?void 0:k[qn.Weeks]},et.weeks.map((we,Te)=>We.createElement(n.Week,{className:o[qn.Week],key:we.weekNumber,style:k==null?void 0:k[qn.Week],week:we},_&&We.createElement(n.WeekNumber,{week:we,style:k==null?void 0:k[qn.WeekNumber],"aria-label":ce(we.weekNumber,{locale:a}),className:o[qn.WeekNumber],scope:"row",role:"rowheader"},M(we.weekNumber,i)),we.days.map(Ue=>{const{date:Ct}=Ue,me=G(Ue);if(me[ai.focused]=!me.hidden&&!!(Se!=null&&Se.isEqualTo(Ue)),me[Hc.selected]=(Z==null?void 0:Z(Ct))||me.selected,q5(ae)){const{from:_e,to:$e}=ae;me[Hc.range_start]=!!(_e&&$e&&i.isSameDay(Ct,_e)),me[Hc.range_end]=!!(_e&&$e&&i.isSameDay(Ct,$e)),me[Hc.range_middle]=cf(ae,Ct,!0,i)}const Q=D$e(me,k,t.modifiersStyles),J=Z8e(me,o,t.modifiersClassNames),te=!je&&!me.hidden?He(Ct,me,i.options,i):void 0;return We.createElement(n.Day,{key:`${i.format(Ct,"yyyy-MM-dd")}_${i.format(Ue.displayMonth,"yyyy-MM")}`,day:Ue,modifiers:me,className:J.join(" "),style:Q,role:"gridcell","aria-selected":me.selected||void 0,"aria-label":te,"data-day":i.format(Ct,"yyyy-MM-dd"),"data-month":Ue.outside?i.format(Ct,"yyyy-MM"):void 0,"data-selected":me.selected||void 0,"data-disabled":me.disabled||void 0,"data-hidden":me.hidden||void 0,"data-outside":Ue.outside||void 0,"data-focused":me.focused||void 0,"data-today":me.today||void 0},!me.hidden&&je?We.createElement(n.DayButton,{className:o[qn.DayButton],style:k==null?void 0:k[qn.DayButton],type:"button",day:Ue,modifiers:me,disabled:me.disabled||void 0,tabIndex:Ee(Ue)?0:-1,"aria-label":Le(Ct,me,i.options,i),onClick:ut(Ue,me),onBlur:$t(Ue,me),onFocus:Pt(Ue,me),onKeyDown:Ft(Ue,me),onMouseEnter:Ht(Ue,me),onMouseLeave:Ce(Ue,me)},A(Ct,i.options,i)):!me.hidden&&A(Ue.date,i.options,i))}))))))})),t.footer&&We.createElement(n.Footer,{className:o[qn.Footer],style:k==null?void 0:k[qn.Footer],role:"status","aria-live":"polite"},t.footer)))}function wBe({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=V5();return f.jsx(xBe,{showOutsideDays:n,className:Ye("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Ye("w-fit",l.root),months:Ye("flex gap-4 flex-col md:flex-row relative",l.months),month:Ye("flex flex-col w-full gap-4",l.month),nav:Ye("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Ye(IP({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Ye(IP({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Ye("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Ye("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Ye("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Ye("absolute inset-0 opacity-0",l.dropdown),caption_label:Ye("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Ye("flex",l.weekdays),weekday:Ye("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Ye("flex w-full mt-2",l.week),week_number_header:Ye("select-none w-(--cell-size)",l.week_number_header),week_number:Ye("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Ye("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Ye("rounded-l-md bg-accent",l.range_start),range_middle:Ye("rounded-none",l.range_middle),range_end:Ye("rounded-r-md bg-accent",l.range_end),today:Ye("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Ye("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Ye("text-muted-foreground opacity-50",l.disabled),hidden:Ye("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Ye(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx(Zye,{className:Ye("size-4",c),...d}):u==="right"?f.jsx(NT,{className:Ye("size-4",c),...d}):f.jsx(Fl,{className:Ye("size-4",c),...d}),DayButton:SBe,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function SBe({className:e,day:t,modifiers:n,...r}){const s=V5(),i=E.useRef(null);return E.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(rt,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Ye("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}var _Be=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$f=_Be.reduce((e,t)=>{const n=rd(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function CBe(e,t){e&&Nl.flushSync(()=>e.dispatchEvent(t))}var kBe="DismissableLayer",U4="dismissableLayer.update",EBe="dismissableLayer.pointerDownOutside",TBe="dismissableLayer.focusOutside",Zq,pre=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),mre=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(pre),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=E.useState({}),g=Tn(t,A=>d(A)),y=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=y.indexOf(v),w=u?y.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,_=w>=x,k=RBe(A=>{const R=A.target,M=[...c.branches].some(j=>j.contains(R));!_||M||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=IBe(A=>{const R=A.target;[...c.branches].some(j=>j.contains(R))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return YD(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Zq=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Xq(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Zq)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Xq())},[u,c]),E.useEffect(()=>{const A=()=>p({});return document.addEventListener(U4,A),()=>document.removeEventListener(U4,A)},[]),f.jsx($f.div,{...l,ref:g,style:{pointerEvents:S?_?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,k.onPointerDownCapture)})});mre.displayName=kBe;var ABe="DismissableLayerBranch",NBe=E.forwardRef((e,t)=>{const n=E.useContext(pre),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx($f.div,{...e,ref:s})});NBe.displayName=ABe;function RBe(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){gre(EBe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function IBe(e,t=globalThis==null?void 0:globalThis.document){const n=Ms(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&gre(TBe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Xq(){const e=new CustomEvent(U4);document.dispatchEvent(e)}function gre(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?CBe(s,i):s.dispatchEvent(i)}var x3="focusScope.autoFocusOnMount",w3="focusScope.autoFocusOnUnmount",Jq={bubbles:!1,cancelable:!0},MBe="FocusScope",yre=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Ms(s),u=Ms(i),d=E.useRef(null),h=Tn(t,y=>l(y)),p=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let y=function(S){if(p.paused||!o)return;const _=S.target;o.contains(_)?d.current=_:Ph(d.current,{select:!0})},v=function(S){if(p.paused||!o)return;const _=S.relatedTarget;_!==null&&(o.contains(_)||Ph(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&Ph(o)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,p.paused]),E.useEffect(()=>{if(o){eV.add(p);const y=document.activeElement;if(!o.contains(y)){const x=new CustomEvent(x3,Jq);o.addEventListener(x3,c),o.dispatchEvent(x),x.defaultPrevented||(jBe(LBe(bre(o)),{select:!0}),document.activeElement===y&&Ph(o))}return()=>{o.removeEventListener(x3,c),setTimeout(()=>{const x=new CustomEvent(w3,Jq);o.addEventListener(w3,u),o.dispatchEvent(x),x.defaultPrevented||Ph(y??document.body,{select:!0}),o.removeEventListener(w3,u),eV.remove(p)},0)}}},[o,c,u,p]);const g=E.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,x=document.activeElement;if(v&&x){const w=y.currentTarget,[S,_]=PBe(w);S&&_?!y.shiftKey&&x===_?(y.preventDefault(),n&&Ph(S,{select:!0})):y.shiftKey&&x===S&&(y.preventDefault(),n&&Ph(_,{select:!0})):x===w&&y.preventDefault()}},[n,r,p.paused]);return f.jsx($f.div,{tabIndex:-1,...a,ref:h,onKeyDown:g})});yre.displayName=MBe;function jBe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Ph(r,{select:t}),document.activeElement!==n)return}function PBe(e){const t=bre(e),n=Qq(t,e),r=Qq(t.reverse(),e);return[n,r]}function bre(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Qq(e,t){for(const n of e)if(!OBe(n,{upTo:t}))return n}function OBe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function DBe(e){return e instanceof HTMLInputElement&&"select"in e}function Ph(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&DBe(e)&&t&&e.select()}}var eV=FBe();function FBe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=tV(e,t),e.unshift(t)},remove(t){var n;e=tV(e,t),(n=e[0])==null||n.resume()}}}function tV(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function LBe(e){return e.filter(t=>t.tagName!=="A")}var $Be="Arrow",vre=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx($f.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});vre.displayName=$Be;var BBe=vre,W5="Popper",[xre,wre]=Pi(W5),[zBe,Sre]=xre(W5),_re=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(zBe,{scope:t,anchor:r,onAnchorChange:s,children:n})};_re.displayName=W5;var Cre="PopperAnchor",kre=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Sre(Cre,n),a=E.useRef(null),o=Tn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx($f.div,{...s,ref:o})});kre.displayName=Cre;var H5="PopperContent",[UBe,qBe]=xre(H5),Ere=E.forwardRef((e,t)=>{var Ee,he,pe,Le,He,Fe;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...y}=e,v=Sre(H5,n),[x,w]=E.useState(null),S=Tn(t,Ie=>w(Ie)),[_,k]=E.useState(null),T=Sg(_),A=(T==null?void 0:T.width)??0,R=(T==null?void 0:T.height)??0,M=r+(i!=="center"?"-"+i:""),j=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},F=Array.isArray(c)?c:[c],P=F.length>0,q={padding:j,boundary:F.filter(WBe),altBoundary:P},{refs:I,floatingStyles:V,placement:D,isPositioned:z,middlewareData:$}=sF({strategy:"fixed",placement:M,whileElementsMounted:(...Ie)=>rF(...Ie,{animationFrame:p==="always"}),elements:{reference:v.anchor},middleware:[iF({mainAxis:s+R,alignmentAxis:a}),l&&aF({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?oF():void 0,...q}),l&&lF({...q}),cF({...q,apply:({elements:Ie,rects:X,availableWidth:ye,availableHeight:Ne})=>{const{width:fe,height:ce}=X.reference,se=Ie.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Ne}px`),se.setProperty("--radix-popper-anchor-width",`${fe}px`),se.setProperty("--radix-popper-anchor-height",`${ce}px`)}}),_&&dF({element:_,padding:o}),HBe({arrowWidth:A,arrowHeight:R}),h&&uF({strategy:"referenceHidden",...q})]}),[Y,B]=Nre(D),G=Ms(g);di(()=>{z&&(G==null||G())},[z,G]);const Z=(Ee=$.arrow)==null?void 0:Ee.x,ne=(he=$.arrow)==null?void 0:he.y,ae=((pe=$.arrow)==null?void 0:pe.centerOffset)!==0,[le,Se]=E.useState();return di(()=>{x&&Se(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:I.setFloating,"data-radix-popper-content-wrapper":"",style:{...V,transform:z?V.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:le,"--radix-popper-transform-origin":[(Le=$.transformOrigin)==null?void 0:Le.x,(He=$.transformOrigin)==null?void 0:He.y].join(" "),...((Fe=$.hide)==null?void 0:Fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(UBe,{scope:n,placedSide:Y,onArrowChange:k,arrowX:Z,arrowY:ne,shouldHideArrow:ae,children:f.jsx($f.div,{"data-side":Y,"data-align":B,...y,ref:S,style:{...y.style,animation:z?void 0:"none"}})})})});Ere.displayName=H5;var Tre="PopperArrow",VBe={top:"bottom",right:"left",bottom:"top",left:"right"},Are=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=qBe(Tre,r),a=VBe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(BBe,{...s,ref:n,style:{...s.style,display:"block"}})})});Are.displayName=Tre;function WBe(e){return e!==null}var HBe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Nre(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,p=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let g="",y="";return c==="bottom"?(g=a?d:`${h}px`,y=`${-l}px`):c==="top"?(g=a?d:`${h}px`,y=`${r.floating.height+l}px`):c==="right"?(g=`${-l}px`,y=a?d:`${p}px`):c==="left"&&(g=`${r.floating.width+l}px`,y=a?d:`${p}px`),{data:{x:g,y}}}});function Nre(e){const[t,n="center"]=e.split("-");return[t,n]}var GBe=_re,Rre=kre,KBe=Ere,YBe=Are,ZBe="Portal",Ire=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);di(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?FT.createPortal(f.jsx($f.div,{...r,ref:t}),a):null});Ire.displayName=ZBe;var GA="Popover",[Mre,Svt]=Pi(GA,[wre]),JS=wre(),[XBe,Dp]=Mre(GA),jre=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=JS(t),l=E.useRef(null),[c,u]=E.useState(!1),[d,h]=pc({prop:r,defaultProp:s??!1,onChange:i,caller:GA});return f.jsx(GBe,{...o,children:f.jsx(XBe,{scope:t,contentId:_a(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:E.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:c,onCustomAnchorAdd:E.useCallback(()=>u(!0),[]),onCustomAnchorRemove:E.useCallback(()=>u(!1),[]),modal:a,children:n})})};jre.displayName=GA;var Pre="PopoverAnchor",JBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Dp(Pre,n),i=JS(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return E.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(Rre,{...i,...r,ref:t})});JBe.displayName=Pre;var Ore="PopoverTrigger",Dre=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Dp(Ore,n),i=JS(n),a=Tn(t,s.triggerRef),o=f.jsx($f.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":zre(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(Rre,{asChild:!0,...i,children:o})});Dre.displayName=Ore;var G5="PopoverPortal",[QBe,eze]=Mre(G5,{forceMount:void 0}),Fre=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=Dp(G5,t);return f.jsx(QBe,{scope:t,forceMount:n,children:f.jsx(ca,{present:n||i.open,children:f.jsx(Ire,{asChild:!0,container:s,children:r})})})};Fre.displayName=G5;var db="PopoverContent",Lre=E.forwardRef((e,t)=>{const n=eze(db,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=Dp(db,e.__scopePopover);return f.jsx(ca,{present:r||i.open,children:i.modal?f.jsx(nze,{...s,ref:t}):f.jsx(rze,{...s,ref:t})})});Lre.displayName=db;var tze=rd("PopoverContent.RemoveScroll"),nze=E.forwardRef((e,t)=>{const n=Dp(db,e.__scopePopover),r=E.useRef(null),s=Tn(t,r),i=E.useRef(!1);return E.useEffect(()=>{const a=r.current;if(a)return $A(a)},[]),f.jsx(YS,{as:tze,allowPinchZoom:!0,children:f.jsx($re,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),rze=E.forwardRef((e,t)=>{const n=Dp(db,e.__scopePopover),r=E.useRef(!1),s=E.useRef(!1);return f.jsx($re,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),$re=E.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=Dp(db,n),p=JS(n);return LA(),f.jsx(yre,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(mre,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(KBe,{"data-state":zre(h.open),role:"dialog",id:h.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Bre="PopoverClose",sze=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Dp(Bre,n);return f.jsx($f.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});sze.displayName=Bre;var ize="PopoverArrow",aze=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=JS(n);return f.jsx(YBe,{...s,...r,ref:t})});aze.displayName=ize;function zre(e){return e?"open":"closed"}var oze=jre,lze=Dre,cze=Fre,uze=Lre;function Tc({...e}){return f.jsx(oze,{"data-slot":"popover",...e})}function Ac({...e}){return f.jsx(lze,{"data-slot":"popover-trigger",...e})}function Nc({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(cze,{children:f.jsx(uze,{"data-slot":"popover-content",align:t,sideOffset:n,className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}const dze=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=We.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?fje(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[t&&f.jsx(At,{htmlFor:e.name+"-trigger",className:Ye("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(Tc,{open:o,onOpenChange:l,children:[f.jsx(Ac,{asChild:!0,children:f.jsxs(rt,{id:e.name+"-trigger",variant:"outline",className:Ye("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(Vye,{className:"mr-2 h-4 w-4"}),c?zu(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(Nc,{className:"w-auto p-0",children:f.jsx(wBe,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})};function nV(e){const t=fze(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(pze);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function fze(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=gze(s),o=mze(i,s.props);return s.type!==E.Fragment&&(o.ref=r?jl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var hze=Symbol("radix.slottable");function pze(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===hze}function mze(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function gze(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function K5(e){const t=e+"CollectionProvider",[n,r]=Pi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=y=>{const{scope:v,children:x}=y,w=We.useRef(null),S=We.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=nV(o),c=We.forwardRef((y,v)=>{const{scope:x,children:w}=y,S=i(o,x),_=Tn(v,S.collectionRef);return f.jsx(l,{ref:_,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=nV(u),p=We.forwardRef((y,v)=>{const{scope:x,children:w,...S}=y,_=We.useRef(null),k=Tn(v,_),T=i(u,x);return We.useEffect(()=>(T.itemMap.set(_,{ref:_,...S}),()=>void T.itemMap.delete(_))),f.jsx(h,{[d]:"",ref:k,children:w})});p.displayName=u;function g(y){const v=i(e+"CollectionConsumer",y);return We.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,A)=>S.indexOf(T.ref.current)-S.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:p},g,r]}var Ure=["PageUp","PageDown"],qre=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Vre={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},rv="Slider",[q4,yze,bze]=K5(rv),[Wre,_vt]=Pi(rv,[bze]),[vze,KA]=Wre(rv),Hre=E.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:g,...y}=e,v=E.useRef(new Set),x=E.useRef(0),S=a==="horizontal"?xze:wze,[_=[],k]=pc({prop:u,defaultProp:c,onChange:F=>{var q;(q=[...v.current][x.current])==null||q.focus(),d(F)}}),T=E.useRef(_);function A(F){const P=Eze(_,F);j(F,P)}function R(F){j(F,x.current)}function M(){const F=T.current[x.current];_[x.current]!==F&&h(_)}function j(F,P,{commit:q}={commit:!1}){const I=Rze(i),V=Ize(Math.round((F-r)/i)*i+r,I),D=R1(V,[r,s]);k((z=[])=>{const $=Cze(z,D,P);if(Nze($,l*i)){x.current=$.indexOf(D);const Y=String($)!==String(z);return Y&&q&&h($),Y?$:z}else return z})}return f.jsx(vze,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:_,orientation:a,form:g,children:f.jsx(q4.Provider,{scope:e.__scopeSlider,children:f.jsx(q4.Slot,{scope:e.__scopeSlider,children:f.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...y,ref:t,onPointerDown:Wt(y.onPointerDown,()=>{o||(T.current=_)}),min:r,max:s,inverted:p,onSlideStart:o?void 0:A,onSlideMove:o?void 0:R,onSlideEnd:o?void 0:M,onHomeKeyDown:()=>!o&&j(r,0,{commit:!0}),onEndKeyDown:()=>!o&&j(s,_.length-1,{commit:!0}),onStepKeyDown:({event:F,direction:P})=>{if(!o){const V=Ure.includes(F.key)||F.shiftKey&&qre.includes(F.key)?10:1,D=x.current,z=_[D],$=i*V*P;j(z+$,D,{commit:!0})}}})})})})});Hre.displayName=rv;var[Gre,Kre]=Wre(rv,{startEdge:"left",endEdge:"right",size:"width",direction:1}),xze=E.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=E.useState(null),p=Tn(t,S=>h(S)),g=E.useRef(void 0),y=Og(s),v=y==="ltr",x=v&&!i||!v&&i;function w(S){const _=g.current||d.getBoundingClientRect(),k=[0,_.width],A=Y5(k,x?[n,r]:[r,n]);return g.current=_,A(S-_.left)}return f.jsx(Gre,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(Yre,{dir:y,"data-orientation":"horizontal",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const _=w(S.clientX);a==null||a(_)},onSlideMove:S=>{const _=w(S.clientX);o==null||o(_)},onSlideEnd:()=>{g.current=void 0,l==null||l()},onStepKeyDown:S=>{const k=Vre[x?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:k?-1:1})}})})}),wze=E.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=E.useRef(null),d=Tn(t,u),h=E.useRef(void 0),p=!s;function g(y){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],S=Y5(x,p?[r,n]:[n,r]);return h.current=v,S(y-v.top)}return f.jsx(Gre,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:f.jsx(Yre,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:y=>{const v=g(y.clientY);i==null||i(v)},onSlideMove:y=>{const v=g(y.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:y=>{const x=Vre[p?"from-bottom":"from-top"].includes(y.key);l==null||l({event:y,direction:x?-1:1})}})})}),Yre=E.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=KA(rv,n);return f.jsx(Zn.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):Ure.concat(qre).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),Zre="SliderTrack",Xre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=KA(Zre,n);return f.jsx(Zn.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});Xre.displayName=Zre;var V4="SliderRange",Jre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=KA(V4,n),i=Kre(V4,n),a=E.useRef(null),o=Tn(t,a),l=s.values.length,c=s.values.map(h=>tse(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(Zn.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});Jre.displayName=V4;var W4="SliderThumb",Qre=E.forwardRef((e,t)=>{const n=yze(e.__scopeSlider),[r,s]=E.useState(null),i=Tn(t,o=>s(o)),a=E.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(Sze,{...e,ref:i,index:a})}),Sze=E.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=KA(W4,n),o=Kre(W4,n),[l,c]=E.useState(null),u=Tn(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=Sg(l),p=a.values[r],g=p===void 0?0:tse(p,a.min,a.max),y=kze(r,a.values.length),v=h==null?void 0:h[o.size],x=v?Tze(v,g,o.direction):0;return E.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${g}% + ${x}px)`},children:[f.jsx(q4.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(Zn.span,{role:"slider","aria-label":e["aria-label"]||y,"aria-valuemin":a.min,"aria-valuenow":p,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:p===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(ese,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:p},r)]})});Qre.displayName=W4;var _ze="RadioBubbleInput",ese=E.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=E.useRef(null),i=Tn(s,r),a=KS(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(Zn.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});ese.displayName=_ze;function Cze(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function tse(e,t,n){const i=100/(n-t)*(e-t);return R1(i,[0,100])}function kze(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Eze(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function Tze(e,t,n){const r=e/2,i=Y5([0,50],[0,r]);return(r-i(t)*n)*n}function Aze(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function Nze(e,t){if(t>0){const n=Aze(e);return Math.min(...n)>=t}return!0}function Y5(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function Rze(e){return(String(e).split(".")[1]||"").length}function Ize(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var Mze=Hre,jze=Xre,Pze=Jre,Oze=Qre;function ay({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=E.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(Mze,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Ye("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx(jze,{"data-slot":"slider-track",className:Ye("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(Pze,{"data-slot":"slider-range",className:Ye("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(Oze,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}const Dze=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:p,state:g,handleChange:y,handleBlur:v}=e,x=typeof g.value=="number"?g.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Ye("space-y-1.5",u),children:[t&&f.jsxs(At,{htmlFor:p,className:Ye("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",g.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(ay,{id:p,name:p,value:[x],onValueChange:S=>y(S[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Ye(d,g.meta.errors.length?"border-destructive":"")}),g.meta.isTouched&&g.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:g.meta.errors.map((S,_)=>f.jsx("p",{children:typeof S=="string"?S:(S==null?void 0:S.message)||"Invalid"},_))})]})},Fze=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=g=>{var v;const y=((v=g.target.files)==null?void 0:v[0])??null;l(y),c()},h=()=>{l(null);const g=document.getElementById(a);g&&(g.value=""),c()},p=()=>{const g=document.getElementById(a);g==null||g.click()};return f.jsxs("div",{className:Ye("space-y-1.5",s),children:[t&&f.jsx(At,{className:"text-sm font-medium cursor-pointer",onClick:p,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(vn,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(MT,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(rt,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(Ri,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:p,className:Ye("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(ND,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((g,y)=>f.jsx("p",{children:typeof g=="string"?g:(g==null?void 0:g.message)||"Invalid"},y))})]})},Lze={text:Kx,email:Kx,password:Kx,url:Kx,textarea:C6e,select:k8e,checkbox:I8e,switch:$8e,number:B8e,date:dze,slider:Dze,file:Fze},$ze=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Ye("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(ub,{value:e,className:"h-2"})]}),Bze=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function Dg(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:p,autoSubmitOnChange:g=!1,autoSubmitDebounceMs:y=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1,showSubmitButton:S=!0}=e,[_,k]=E.useState(1),T={...Lze,...u},A=E.useMemo(()=>{const B={};return t.forEach(G=>{const Z=G.page||1;B[Z]||(B[Z]=[]),B[Z].push(G)}),B},[t]),R=Math.max(...Object.keys(A).map(Number),1),M=R>1,j=M?(_-1)/(R-1)*100:100,F={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async B=>{try{const G=await h.onSubmit(B);return P.reset(),G}catch(G){throw G}}}},P=Xs(F);We.useEffect(()=>{const B=[];let G,Z,ne;if(h!=null&&h.onChange||g){const ae=P.store.subscribe(()=>{const le=P,Se=le.state.values;h!=null&&h.onChange&&le.state.isValid&&(clearTimeout(Z),Z=setTimeout(()=>{h.onChange({value:Se,formApi:le})},300)),g&&!v&&!x&&(clearTimeout(G),G=setTimeout(()=>{P.state.canSubmit&&P.handleSubmit()},y))});B.push(ae)}if(h!=null&&h.onBlur){let ae=null;const le=Ee=>{const pe=Ee.target.getAttribute("name");pe&&ae===pe&&(clearTimeout(ne),ne=setTimeout(()=>{const Le=P,He=Le.state.values;h.onBlur({value:He,formApi:Le})},100))},Se=Ee=>{ae=Ee.target.getAttribute("name")};document.addEventListener("blur",le,!0),document.addEventListener("focus",Se,!0),B.push(()=>{document.removeEventListener("blur",le,!0),document.removeEventListener("focus",Se,!0)})}return B.push(()=>{clearTimeout(G),clearTimeout(Z),clearTimeout(ne)}),()=>{B.forEach(ae=>ae())}},[P,g,y,v,x,h==null?void 0:h.onChange,h==null?void 0:h.onBlur]);const q=()=>A[_]||[],I=()=>l.find(B=>B.page===_),V=()=>{if(_<R){const B=_+1;k(B),p==null||p(B,"next")}},D=()=>{if(_>1){const B=_-1;k(B),p==null||p(B,"previous")}},z=_===R,$=_===1;return{form:P,Form:({className:B,children:G,onSubmit:Z})=>{const ne=pe=>{pe.preventDefault(),pe.stopPropagation(),Z?Z(pe):z?P.handleSubmit():V()},ae=Ye("space-y-6",a,B),le=pe=>{const{name:Le,type:He,label:Fe,placeholder:Ie,description:X,options:ye,min:Ne,max:fe,step:ce,accept:se,multiple:Pe,component:Be,wrapper:je,conditional:ot,validation:Et}=pe;return f.jsx(P.Field,{name:Le,validators:Et?{onChange:Et}:void 0,children:ut=>{const Pt=ut.form.state.values;if(ot&&!ot(Pt))return null;const $t={fieldApi:ut,label:Fe,placeholder:Ie,description:X,wrapperClassName:o,min:Ne,max:fe,step:ce,accept:se,multiple:Pe,disabled:v||x||ut.form.state.isSubmitting},Ft=Be||T[He]||Kx,Ht=He==="select"?{...$t,options:ye||[]}:{...$t,type:["text","email","password","url"].includes(He)?He:void 0},Ce=f.jsx(Ft,{...Ht}),U=je||d;return U?f.jsx(U,{field:pe,children:Ce}):Ce}},Le)},Se=()=>{const pe=q(),Le=I(),He=pe.map(Ie=>le(Ie)).filter(Boolean),Fe=(Le==null?void 0:Le.component)||Bze;return f.jsx(Fe,{title:Le==null?void 0:Le.title,description:Le==null?void 0:Le.description,page:_,totalPages:R,children:He})},Ee=()=>{if(!M||!c)return null;const pe=c.component||$ze;return f.jsx(pe,{value:j,currentPage:_,totalPages:R,className:c.className})},he=()=>S?M?f.jsx(P.Subscribe,{selector:pe=>({canSubmit:pe.canSubmit,isSubmitting:pe.isSubmitting}),children:pe=>{const{canSubmit:Le,isSubmitting:He}=pe;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(rt,{type:"button",variant:"outline",onClick:D,disabled:$||v||x,className:$?"invisible":"",children:i}),f.jsx(rt,{type:"submit",disabled:(!Le||He||v||x)&&z,className:"flex-1 max-w-xs",children:x&&z?"Loading...":He&&z?"Submitting...":z?r:s})]})}}):f.jsx(P.Subscribe,{selector:pe=>({canSubmit:pe.canSubmit,isSubmitting:pe.isSubmitting}),children:pe=>{const{canSubmit:Le,isSubmitting:He}=pe;return f.jsx(rt,{type:"submit",disabled:!Le||He||v||x,className:"w-full",children:x?"Loading...":He?"Submitting...":r})}}):null;return f.jsx("form",{onSubmit:ne,className:ae,children:G||f.jsxs(f.Fragment,{children:[Ee(),Se(),he()]})})},currentPage:_,totalPages:R,goToNextPage:V,goToPreviousPage:D,setCurrentPage:k,isFirstPage:$,isLastPage:z,progressValue:j}}const zze=Ze({correctedJson:qe().min(2,"JSON cannot be empty.").refine(e=>{try{return JSON.parse(e),!0}catch{return!1}},{message:"Must be a valid JSON string."})}),Uze=({runId:e,rawAssistantResponse:t})=>{const n=[{name:"correctedJson",type:"textarea",label:"Corrected JSON Data",placeholder:'{ "key": "value", "another_key": 123 }',description:"Enter the valid JSON that should have been produced by the assistant."}];let r="";try{t&&(r=JSON.stringify(JSON.parse(t),null,2))}catch{r=t||""}const{Form:s}=Dg({fields:n,schema:zze,submitLabel:"Resume Workflow",formOptions:{defaultValues:{correctedJson:r},onSubmit:({value:i})=>{Ae.emit(as.resumeRequest,{runId:e,resumeData:JSON.parse(i.correctedJson)})}}});return f.jsxs("div",{className:"p-4 border-l-4 border-yellow-500 bg-yellow-500/10 rounded-r-lg space-y-4",children:[f.jsxs(jA,{children:[f.jsx(dve,{className:"h-4 w-4"}),f.jsx(R5,{children:"Action Required: Correct Data"}),f.jsx(PA,{children:"The workflow paused because it couldn't automatically extract structured data. Please review the raw response below and provide the correct data in JSON format."})]}),t&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{className:"font-semibold",children:"Raw Assistant Response (from last attempt)"}),f.jsx(ul,{className:"h-48 border rounded-md bg-background p-3",children:f.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:t})})]}),f.jsx(s,{})]})},qze=({interaction:e})=>{const{activeRun:t,pausePayload:n}=xy(d=>({activeRun:d.activeRun,pausePayload:d.pausePayload}));if(!t||t.mainInteractionId!==e.id)return null;const r=t.template.name||"Workflow",s=t.status,i=t.currentStepIndex,a=t.template.steps.length;let o=Yn,l=`${r}: Initializing...`,c="text-muted-foreground";switch(s){case"RUNNING":case"STREAMING":o=Yn,l=`${r}: Running step ${i+1} of ${a}...`,c="text-blue-500";break;case"PAUSED":(n==null?void 0:n.pauseReason)==="data-correction"?(o=jz,l=`${r}: Paused - Awaiting data correction`,c="text-yellow-500"):(o=jz,l=`${r}: Paused - Awaiting your input`,c="text-yellow-500");break;case"COMPLETED":o=dS,l=`${r}: Completed successfully.`,c="text-green-500";break;case"ERROR":o=MP,l=`${r}: Failed.`,c="text-red-500";break;case"CANCELLED":o=MP,l=`${r}: Cancelled.`,c="text-muted-foreground";break}const u=()=>s!=="PAUSED"||!n?null:n.pauseReason==="data-correction"?f.jsx(Uze,{runId:n.runId,step:n.step,rawAssistantResponse:n.rawAssistantResponse}):n.pauseReason==="human-in-the-loop"?f.jsx(M5e,{run:t}):null;return f.jsxs("div",{className:"p-4 space-y-4",children:[f.jsxs("div",{className:`flex items-center gap-3 font-semibold text-lg ${c}`,children:[f.jsx(o,{className:`h-6 w-6 ${s==="RUNNING"||s==="STREAMING"?"animate-spin":""}`}),f.jsx("h2",{children:l})]}),u(),s==="ERROR"&&(t==null?void 0:t.error)&&f.jsxs("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md text-destructive text-sm",children:[f.jsx("strong",{children:"Error:"})," ",t.error]})]})},H4=We.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var j,F,P,q,I,V,D,z,$,Y,B,G;const[s,i]=E.useState(!1),a=E.useRef(null),o=E.useCallback(()=>{i(!1)},[]),l=E.useCallback(()=>{i(!0)},[]),c=E.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Gn(pn(Z=>({dbProviderConfigs:Z.dbProviderConfigs,getAllAvailableModelDefsForProvider:Z.getAllAvailableModelDefsForProvider}))),h=e.endedAt?FQ(new Date(e.endedAt),{addSuffix:!0}):"Processing...",p=E.useMemo(()=>{var pe;const Z=(pe=e.metadata)==null?void 0:pe.modelId;if(!Z)return"Unknown Model";const{providerId:ne,modelId:ae}=uc(Z);if(!ne||!ae)return Z;const le=u.find(Le=>Le.id===ne),Se=(le==null?void 0:le.name)??ne,he=d(ne).find(Le=>Le.id===ae);return`${(he==null?void 0:he.name)??ae} (${Se})`},[(j=e.metadata)==null?void 0:j.modelId,u,d]),g=e.status==="COMPLETED",y=g||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((F=e.metadata)==null?void 0:F.toolCalls)&&e.metadata.toolCalls.length>0,S=((P=e.metadata)==null?void 0:P.toolResults)&&e.metadata.toolResults.length>0,_=!!((q=e.metadata)!=null&&q.reasoning),k=x||w||S||_,T=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),A=n==null?void 0:n("actions",e),R=n==null?void 0:n("content",e),M=n==null?void 0:n("menu",e);return e.type==="workflow.run"?f.jsxs("div",{ref:a,className:Ye("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(x1,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:g,interactionId:e.id}),f.jsx("div",{className:Ye("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:f.jsx(qze,{interaction:e})})]}):f.jsxs("div",{ref:a,className:Ye("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(x1,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:g,interactionId:e.id}),f.jsxs("div",{className:Ye("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[M,f.jsx(k5e,{interactionType:e.type,displayModelName:p,timeAgo:h,isFolded:s,toggleFold:c,canFold:k,promptTokens:(I=e.metadata)==null?void 0:I.promptTokens,completionTokens:(V=e.metadata)==null?void 0:V.completionTokens,timeToFirstToken:(D=e.metadata)==null?void 0:D.timeToFirstToken,generationTime:(z=e.metadata)==null?void 0:z.generationTime,headerActionsSlot:T&&T.length>0?f.jsx(f.Fragment,{children:T}):void 0}),R,f.jsx(T5e,{interactionId:e.id,response:e.response,toolCalls:($=e.metadata)==null?void 0:$.toolCalls,toolResults:(Y=e.metadata)==null?void 0:Y.toolResults,reasoning:(B=e.metadata)==null?void 0:B.reasoning,isError:v,errorMessage:(G=e.metadata)==null?void 0:G.error,isFolded:s,toggleFold:c})]}),y&&A&&A.length>0&&f.jsx("div",{className:Ye("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-[var(--z-sticky)]"),children:A})]})});H4.displayName="InteractionCard";const Vze=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=E.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx(_E,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(H4,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d,h;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(Iz,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(Iz,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(pY,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(PD,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(h=a.metadata)!=null&&h.workflowTab?f.jsx(Lw,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(rve,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(rt,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx(_E,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(H4,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};function Zr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Ye("bg-accent animate-pulse rounded-md",e),...t})}const Wze=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function Ba({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Ye("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function ro({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Ye("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function so({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Ye("leading-none font-semibold",e),...t})}function dc({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Ye("text-muted-foreground text-sm",e),...t})}function za({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Ye("px-6",e),...t})}function nse({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Ye("flex items-center px-6 [.border-t]:pt-6",e),...t})}const Ir={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},Hze=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(Ba,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(ro,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(so,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx(Iye,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx(za,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),rse=()=>{const e=(r,s)=>{Ae.emit(Ir.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Ae.emit(Ir.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(Xm,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(OP,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx(MD,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx($y,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(Fw,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(eu,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(Hze,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},rV=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(Wze,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx(rse,{})]}),Z5=E.createContext({});function X5(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const J5=typeof window<"u",sse=J5?E.useLayoutEffect:E.useEffect,YA=E.createContext(null),Q5=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Gze extends E.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Kze({children:e,isPresent:t,anchorX:n}){const r=E.useId(),s=E.useRef(null),i=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=E.useContext(Q5);return E.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const p=document.createElement("style");return a&&(p.nonce=a),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(p)&&document.head.removeChild(p)}},[t]),f.jsx(Gze,{isPresent:t,childRef:s,sizeRef:i,children:E.cloneElement(e,{ref:s})})}const Yze=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=X5(Zze),c=E.useId();let u=!0,d=E.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const p of l.values())if(!p)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),E.useMemo(()=>{l.forEach((h,p)=>l.set(p,!1))},[n]),E.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(Kze,{isPresent:n,anchorX:o,children:e})),f.jsx(YA.Provider,{value:d,children:e})};function Zze(){return new Map}function ise(e=!0){const t=E.useContext(YA);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=E.useId();E.useEffect(()=>{if(e)return s(i)},[e]);const a=E.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const u2=e=>e.key||"";function sV(e){const t=[];return E.Children.forEach(e,n=>{E.isValidElement(n)&&t.push(n)}),t}const Xze=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=ise(a),u=E.useMemo(()=>sV(e),[e]),d=a&&!l?[]:u.map(u2),h=E.useRef(!0),p=E.useRef(u),g=X5(()=>new Map),[y,v]=E.useState(u),[x,w]=E.useState(u);sse(()=>{h.current=!1,p.current=u;for(let k=0;k<x.length;k++){const T=u2(x[k]);d.includes(T)?g.delete(T):g.get(T)!==!0&&g.set(T,!1)}},[x,d.length,d.join("-")]);const S=[];if(u!==y){let k=[...u];for(let T=0;T<x.length;T++){const A=x[T],R=u2(A);d.includes(R)||(k.splice(T,0,A),S.push(A))}return i==="wait"&&S.length&&(k=S),w(sV(k)),v(u),null}const{forceRender:_}=E.useContext(Z5);return f.jsx(f.Fragment,{children:x.map(k=>{const T=u2(k),A=a&&!l?!1:u===x||d.includes(T),R=()=>{if(g.has(T))g.set(T,!0);else return;let M=!0;g.forEach(j=>{j||(M=!1)}),M&&(_==null||_(),w(p.current),a&&(c==null||c()),r&&r())};return f.jsx(Yze,{isPresent:A,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:A?void 0:R,anchorX:o,children:k},T)})})},d2=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],iV={value:null};function Jze(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,p=!1)=>{const y=p&&s?n:r;return h&&a.add(d),y.has(d)||y.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&iV.value&&iV.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Rf={},Qze=40;function ase(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=d2.reduce((S,_)=>(S[_]=Jze(i,t?_:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:p,postRender:g}=a,y=()=>{const S=Rf.useManualTiming?s.timestamp:performance.now();n=!1,Rf.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,Qze),1)),s.timestamp=S,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),p.process(s),g.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(y))},v=()=>{n=!0,r=!0,s.isProcessing||e(y)};return{schedule:d2.reduce((S,_)=>{const k=a[_];return S[_]=(T,A=!1,R=!1)=>(n||v(),k.schedule(T,A,R)),S},{}),cancel:S=>{for(let _=0;_<d2.length;_++)a[d2[_]].cancel(S)},state:s,steps:a}}const fc=e=>e,{schedule:ui,cancel:fp,state:Oa,steps:S3}=ase(typeof requestAnimationFrame<"u"?requestAnimationFrame:fc,!0),ose=E.createContext({strict:!1}),aV={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},fb={};for(const e in aV)fb[e]={isEnabled:t=>aV[e].some(n=>!!t[n])};function e9e(e){for(const t in e)fb[t]={...fb[t],...e[t]}}const t9e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function IE(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||t9e.has(e)}let lse=e=>!IE(e);function n9e(e){e&&(lse=t=>t.startsWith("on")?!IE(t):e(t))}try{n9e(require("@emotion/is-prop-valid").default)}catch{}function r9e(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(lse(s)||n===!0&&IE(s)||!t&&!IE(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function s9e(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const ZA=E.createContext({});function XA(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function I1(e){return typeof e=="string"||Array.isArray(e)}const e6=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],t6=["initial",...e6];function JA(e){return XA(e.animate)||t6.some(t=>I1(e[t]))}function cse(e){return!!(JA(e)||e.variants)}function i9e(e,t){if(JA(e)){const{initial:n,animate:r}=e;return{initial:n===!1||I1(n)?n:void 0,animate:I1(r)?r:void 0}}return e.inherit!==!1?t:{}}function a9e(e){const{initial:t,animate:n}=i9e(e,E.useContext(ZA));return E.useMemo(()=>({initial:t,animate:n}),[oV(t),oV(n)])}function oV(e){return Array.isArray(e)?e.join(" "):e}const o9e=Symbol.for("motionComponentSymbol");function oy(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function l9e(e,t,n){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):oy(n)&&(n.current=r))},[t])}const n6=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),c9e="framerAppearId",use="data-"+n6(c9e),dse=E.createContext({}),{schedule:r6}=ase(queueMicrotask,!1);function u9e(e,t,n,r,s){var y,v;const{visualElement:i}=E.useContext(ZA),a=E.useContext(ose),o=E.useContext(YA),l=E.useContext(Q5).reducedMotion,c=E.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=E.useContext(dse);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&d9e(c.current,n,s,d);const h=E.useRef(!1);E.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const p=n[use],g=E.useRef(!!p&&!((y=window.MotionHandoffIsComplete)!=null&&y.call(window,p))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,p)));return sse(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),r6.render(u.render),g.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(!g.current&&u.animationState&&u.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,p)}),g.current=!1))}),u}function d9e(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:fse(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&oy(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function fse(e){if(e)return e.options.allowProjection!==!1?e.projection:fse(e.parent)}let s6=()=>{};function f9e({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&e9e(e);function i(o,l){let c;const u={...E.useContext(Q5),...o,layoutId:h9e(o)},{isStatic:d}=u,h=a9e(o),p=r(o,d);if(!d&&J5){p9e();const g=m9e(u);c=g.MeasureLayout,h.visualElement=u9e(s,p,u,t,g.ProjectionNode)}return f.jsxs(ZA.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,l9e(p,h.visualElement,l),p,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=E.forwardRef(i);return a[o9e]=s,a}function h9e({layoutId:e}){const t=E.useContext(Z5).id;return t&&e!==void 0?t+"-"+e:e}function p9e(e,t){E.useContext(ose).strict}function m9e(e){const{drag:t,layout:n}=fb;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const hse=e=>t=>typeof t=="string"&&t.startsWith(e),i6=hse("--"),g9e=hse("var(--"),a6=e=>g9e(e)?y9e.test(e.split("/*")[0].trim()):!1,y9e=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,M1={};function b9e(e){for(const t in e)M1[t]=e[t],i6(t)&&(M1[t].isCSSVariable=!0)}const sv=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],iv=new Set(sv);function pse(e,{layout:t,layoutId:n}){return iv.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!M1[e]||e==="opacity")}const eo=e=>!!(e&&e.getVelocity),mse=(e,t)=>t&&typeof e=="number"?t.transform(e):e,If=(e,t,n)=>n>t?t:n<e?e:n,av={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},j1={...av,transform:e=>If(0,1,e)},f2={...av,default:1},lV={...av,transform:Math.round},QS=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Oh=QS("deg"),Ju=QS("%"),ur=QS("px"),v9e=QS("vh"),x9e=QS("vw"),cV={...Ju,parse:e=>Ju.parse(e)/100,transform:e=>Ju.transform(e*100)},w9e={rotate:Oh,rotateX:Oh,rotateY:Oh,rotateZ:Oh,scale:f2,scaleX:f2,scaleY:f2,scaleZ:f2,skew:Oh,skewX:Oh,skewY:Oh,distance:ur,translateX:ur,translateY:ur,translateZ:ur,x:ur,y:ur,z:ur,perspective:ur,transformPerspective:ur,opacity:j1,originX:cV,originY:cV,originZ:ur},o6={borderWidth:ur,borderTopWidth:ur,borderRightWidth:ur,borderBottomWidth:ur,borderLeftWidth:ur,borderRadius:ur,radius:ur,borderTopLeftRadius:ur,borderTopRightRadius:ur,borderBottomRightRadius:ur,borderBottomLeftRadius:ur,width:ur,maxWidth:ur,height:ur,maxHeight:ur,top:ur,right:ur,bottom:ur,left:ur,padding:ur,paddingTop:ur,paddingRight:ur,paddingBottom:ur,paddingLeft:ur,margin:ur,marginTop:ur,marginRight:ur,marginBottom:ur,marginLeft:ur,backgroundPositionX:ur,backgroundPositionY:ur,...w9e,zIndex:lV,fillOpacity:j1,strokeOpacity:j1,numOctaves:lV},S9e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},_9e=sv.length;function C9e(e,t,n){let r="",s=!0;for(let i=0;i<_9e;i++){const a=sv[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=mse(o,o6[a]);if(!l){s=!1;const u=S9e[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function l6(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(iv.has(l)){a=!0;continue}else if(i6(l)){s[l]=c;continue}else{const u=mse(c,o6[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=C9e(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const c6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function gse(e,t,n){for(const r in t)!eo(t[r])&&!pse(r,n)&&(e[r]=t[r])}function k9e({transformTemplate:e},t){return E.useMemo(()=>{const n=c6();return l6(n,t,e),Object.assign({},n.vars,n.style)},[t])}function E9e(e,t){const n=e.style||{},r={};return gse(r,n,e),Object.assign(r,k9e(e,t)),r}function T9e(e,t){const n={},r=E9e(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const A9e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function u6(e){return typeof e!="string"||e.includes("-")?!1:!!(A9e.indexOf(e)>-1||/[A-Z]/u.test(e))}const N9e={offset:"stroke-dashoffset",array:"stroke-dasharray"},R9e={offset:"strokeDashoffset",array:"strokeDasharray"};function I9e(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?N9e:R9e;e[i.offset]=ur.transform(-r);const a=ur.transform(t),o=ur.transform(n);e[i.array]=`${a} ${o}`}function yse(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(l6(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&I9e(d,s,i,a,!1)}const bse=()=>({...c6(),attrs:{}}),vse=e=>typeof e=="string"&&e.toLowerCase()==="svg";function M9e(e,t,n,r){const s=E.useMemo(()=>{const i=bse();return yse(i,t,vse(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};gse(i,e.style,e),s.style={...i,...s.style}}return s}function j9e(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(u6(n)?M9e:T9e)(r,i,a,n),c=r9e(r,typeof n=="string",e),u=n!==E.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=E.useMemo(()=>eo(d)?d.get():d,[d]);return E.createElement(n,{...u,children:h})}}function uV(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function d6(e,t,n,r){if(typeof t=="function"){const[s,i]=uV(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=uV(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function X2(e){return eo(e)?e.get():e}function P9e({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:O9e(n,r,s,e),renderState:t()}}const xse=e=>(t,n)=>{const r=E.useContext(ZA),s=E.useContext(YA),i=()=>P9e(e,t,r,s);return n?i():X5(i)};function O9e(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=X2(i[h]);let{initial:a,animate:o}=e;const l=JA(e),c=cse(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!XA(d)){const h=Array.isArray(d)?d:[d];for(let p=0;p<h.length;p++){const g=d6(e,h[p]);if(g){const{transitionEnd:y,transition:v,...x}=g;for(const w in x){let S=x[w];if(Array.isArray(S)){const _=u?S.length-1:0;S=S[_]}S!==null&&(s[w]=S)}for(const w in y)s[w]=y[w]}}}return s}function f6(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(eo(r[a])||t.style&&eo(t.style[a])||pse(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const D9e={useVisualState:xse({scrapeMotionValuesFromProps:f6,createRenderState:c6})};function wse(e,t,n){const r=f6(e,t,n);for(const s in e)if(eo(e[s])||eo(t[s])){const i=sv.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const F9e={useVisualState:xse({scrapeMotionValuesFromProps:wse,createRenderState:bse})};function L9e(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...u6(r)?F9e:D9e,preloadedFeatures:e,useRender:j9e(s),createVisualElement:t,Component:r};return f9e(a)}}function P1(e,t,n){const r=e.getProps();return d6(r,t,n!==void 0?n:r.custom,e)}const G4=e=>Array.isArray(e);let J2;function $9e(){J2=void 0}const el={now:()=>(J2===void 0&&el.set(Oa.isProcessing||Rf.useManualTiming?Oa.timestamp:performance.now()),J2),set:e=>{J2=e,queueMicrotask($9e)}};function h6(e,t){e.indexOf(t)===-1&&e.push(t)}function p6(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class m6{constructor(){this.subscriptions=[]}add(t){return h6(this.subscriptions,t),()=>p6(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Sse(e,t){return t?e*(1e3/t):0}const dV=30,B9e=e=>!isNaN(parseFloat(e));class z9e{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=el.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=el.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=B9e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new m6);const r=this.events[t].add(n);return t==="change"?()=>{r(),ui.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=el.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>dV)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,dV);return Sse(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function O1(e,t){return new z9e(e,t)}function U9e(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,O1(n))}function q9e(e){return G4(e)?e[e.length-1]||0:e}function V9e(e,t){const n=P1(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=q9e(i[a]);U9e(e,a,o)}}function W9e(e){return!!(eo(e)&&e.add)}function K4(e,t){const n=e.getValue("willChange");if(W9e(n))return n.add(t);if(!n&&Rf.WillChange){const r=new Rf.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function _se(e){return e.props[use]}const H9e=e=>e!==null;function G9e(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(H9e),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const K9e={type:"spring",stiffness:500,damping:25,restSpeed:10},Y9e=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Z9e={type:"keyframes",duration:.8},X9e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},J9e=(e,{keyframes:t})=>t.length>2?Z9e:iv.has(e)?e.startsWith("scale")?Y9e(t[1]):K9e:X9e;function Q9e({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function g6(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Qu=e=>e*1e3,ed=e=>e/1e3,yw=e=>Math.round(e*1e5)/1e5,y6=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function e7e(e){return e==null}const t7e=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,b6=(e,t)=>n=>!!(typeof n=="string"&&t7e.test(n)&&n.startsWith(e)||t&&!e7e(n)&&Object.prototype.hasOwnProperty.call(n,t)),Cse=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(y6);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},n7e=e=>If(0,255,e),_3={...av,transform:e=>Math.round(n7e(e))},Fm={test:b6("rgb","red"),parse:Cse("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+_3.transform(e)+", "+_3.transform(t)+", "+_3.transform(n)+", "+yw(j1.transform(r))+")"};function r7e(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Y4={test:b6("#"),parse:r7e,transform:Fm.transform},ly={test:b6("hsl","hue"),parse:Cse("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Ju.transform(yw(t))+", "+Ju.transform(yw(n))+", "+yw(j1.transform(r))+")"},Ya={test:e=>Fm.test(e)||Y4.test(e)||ly.test(e),parse:e=>Fm.test(e)?Fm.parse(e):ly.test(e)?ly.parse(e):Y4.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Fm.transform(e):ly.transform(e)},s7e=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function i7e(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(y6))==null?void 0:t.length)||0)+(((n=e.match(s7e))==null?void 0:n.length)||0)>0}const kse="number",Ese="color",a7e="var",o7e="var(",fV="${}",l7e=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function D1(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(l7e,l=>(Ya.test(l)?(r.color.push(i),s.push(Ese),n.push(Ya.parse(l))):l.startsWith(o7e)?(r.var.push(i),s.push(a7e),n.push(l)):(r.number.push(i),s.push(kse),n.push(parseFloat(l))),++i,fV)).split(fV);return{values:n,split:o,indexes:r,types:s}}function Tse(e){return D1(e).values}function Ase(e){const{split:t,types:n}=D1(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===kse?i+=yw(s[a]):o===Ese?i+=Ya.transform(s[a]):i+=s[a]}return i}}const c7e=e=>typeof e=="number"?0:e;function u7e(e){const t=Tse(e);return Ase(e)(t.map(c7e))}const hp={test:i7e,parse:Tse,createTransformer:Ase,getAnimatableNone:u7e};function C3(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function d7e({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=C3(l,o,e+1/3),i=C3(l,o,e),a=C3(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function ME(e,t){return n=>n>0?t:e}const li=(e,t,n)=>e+(t-e)*n,k3=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},f7e=[Y4,Fm,ly],h7e=e=>f7e.find(t=>t.test(e));function hV(e){const t=h7e(e);if(!t)return!1;let n=t.parse(e);return t===ly&&(n=d7e(n)),n}const pV=(e,t)=>{const n=hV(e),r=hV(t);if(!n||!r)return ME(e,t);const s={...n};return i=>(s.red=k3(n.red,r.red,i),s.green=k3(n.green,r.green,i),s.blue=k3(n.blue,r.blue,i),s.alpha=li(n.alpha,r.alpha,i),Fm.transform(s))},Z4=new Set(["none","hidden"]);function p7e(e,t){return Z4.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const m7e=(e,t)=>n=>t(e(n)),e_=(...e)=>e.reduce(m7e);function g7e(e,t){return n=>li(e,t,n)}function v6(e){return typeof e=="number"?g7e:typeof e=="string"?a6(e)?ME:Ya.test(e)?pV:v7e:Array.isArray(e)?Nse:typeof e=="object"?Ya.test(e)?pV:y7e:ME}function Nse(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>v6(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function y7e(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=v6(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function b7e(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const v7e=(e,t)=>{const n=hp.createTransformer(t),r=D1(e),s=D1(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Z4.has(e)&&!s.values.length||Z4.has(t)&&!r.values.length?p7e(e,t):e_(Nse(b7e(r,s),s.values),n):ME(e,t)};function Rse(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?li(e,t,n):v6(e)(e,t)}const x7e=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ui.update(t,!0),stop:()=>fp(t),now:()=>Oa.isProcessing?Oa.timestamp:el.now()}},Ise=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},jE=2e4;function x6(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<jE;)t+=n,r=e.next(t);return t>=jE?1/0:t}function w7e(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(x6(r),jE);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:ed(s)}}const S7e=5;function Mse(e,t,n){const r=Math.max(t-S7e,0);return Sse(n-e(r),t-r)}const gi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},mV=.001;function _7e({duration:e=gi.duration,bounce:t=gi.bounce,velocity:n=gi.velocity,mass:r=gi.mass}){let s,i,a=1-t;a=If(gi.minDamping,gi.maxDamping,a),e=If(gi.minDuration,gi.maxDuration,ed(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,p=X4(c,a),g=Math.exp(-d);return mV-h/p*g},i=c=>{const d=c*a*e,h=d*n+n,p=Math.pow(a,2)*Math.pow(c,2)*e,g=Math.exp(-d),y=X4(Math.pow(c,2),a);return(-s(c)+mV>0?-1:1)*((h-p)*g)/y}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=k7e(s,i,o);if(e=Qu(e),isNaN(l))return{stiffness:gi.stiffness,damping:gi.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const C7e=12;function k7e(e,t,n){let r=n;for(let s=1;s<C7e;s++)r=r-e(r)/t(r);return r}function X4(e,t){return e*Math.sqrt(1-t*t)}const E7e=["duration","bounce"],T7e=["stiffness","damping","mass"];function gV(e,t){return t.some(n=>e[n]!==void 0)}function A7e(e){let t={velocity:gi.velocity,stiffness:gi.stiffness,damping:gi.damping,mass:gi.mass,isResolvedFromDuration:!1,...e};if(!gV(e,T7e)&&gV(e,E7e))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*If(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:gi.mass,stiffness:s,damping:i}}else{const n=_7e(e);t={...t,...n,mass:gi.mass},t.isResolvedFromDuration=!0}return t}function PE(e=gi.visualDuration,t=gi.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=A7e({...n,velocity:-ed(n.velocity||0)}),g=h||0,y=c/(2*Math.sqrt(l*u)),v=a-i,x=ed(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?gi.restSpeed.granular:gi.restSpeed.default),s||(s=w?gi.restDelta.granular:gi.restDelta.default);let S;if(y<1){const k=X4(x,y);S=T=>{const A=Math.exp(-y*x*T);return a-A*((g+y*x*v)/k*Math.sin(k*T)+v*Math.cos(k*T))}}else if(y===1)S=k=>a-Math.exp(-x*k)*(v+(g+x*v)*k);else{const k=x*Math.sqrt(y*y-1);S=T=>{const A=Math.exp(-y*x*T),R=Math.min(k*T,300);return a-A*((g+y*x*v)*Math.sinh(R)+k*v*Math.cosh(R))/k}}const _={calculatedDuration:p&&d||null,next:k=>{const T=S(k);if(p)o.done=k>=d;else{let A=k===0?g:0;y<1&&(A=k===0?Qu(g):Mse(S,k,T));const R=Math.abs(A)<=r,M=Math.abs(a-T)<=s;o.done=R&&M}return o.value=o.done?a:T,o},toString:()=>{const k=Math.min(x6(_),jE),T=Ise(A=>_.next(k*A).value,k,30);return k+"ms "+T},toTransition:()=>{}};return _}PE.applyToOptions=e=>{const t=w7e(e,100,PE);return e.ease=t.ease,e.duration=Qu(t.duration),e.type="keyframes",e};function J4({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},p=R=>o!==void 0&&R<o||l!==void 0&&R>l,g=R=>o===void 0?l:l===void 0||Math.abs(o-R)<Math.abs(l-R)?o:l;let y=n*t;const v=d+y,x=a===void 0?v:a(v);x!==v&&(y=x-d);const w=R=>-y*Math.exp(-R/r),S=R=>x+w(R),_=R=>{const M=w(R),j=S(R);h.done=Math.abs(M)<=c,h.value=h.done?x:j};let k,T;const A=R=>{p(h.value)&&(k=R,T=PE({keyframes:[h.value,g(h.value)],velocity:Mse(S,R,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return A(0),{calculatedDuration:null,next:R=>{let M=!1;return!T&&k===void 0&&(M=!0,_(R),A(R)),k!==void 0&&R>=k?T.next(R-k):(!M&&_(R),h)}}}const F1=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function N7e(e,t,n){const r=[],s=n||Rf.mix||Rse,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||fc:t;o=e_(l,o)}r.push(o)}return r}function R7e(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(s6(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=N7e(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=F1(e[d],e[d+1],u);return o[d](h)};return n?u=>c(If(e[0],e[i-1],u)):c}function I7e(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=F1(0,t,r);e.push(li(n,1,s))}}function M7e(e){const t=[0];return I7e(t,e.length-1),t}function j7e(e,t){return e.map(n=>n*t)}const jse=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,P7e=1e-7,O7e=12;function D7e(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=jse(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>P7e&&++o<O7e);return a}function t_(e,t,n,r){if(e===t&&n===r)return fc;const s=i=>D7e(i,0,1,e,n);return i=>i===0||i===1?i:jse(s(i),t,r)}const F7e=t_(.42,0,1,1),L7e=t_(0,0,.58,1),Pse=t_(.42,0,.58,1),$7e=e=>Array.isArray(e)&&typeof e[0]!="number",Ose=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Dse=e=>t=>1-e(1-t),Fse=t_(.33,1.53,.69,.99),w6=Dse(Fse),Lse=Ose(w6),$se=e=>(e*=2)<1?.5*w6(e):.5*(2-Math.pow(2,-10*(e-1))),S6=e=>1-Math.sin(Math.acos(e)),Bse=Dse(S6),zse=Ose(S6),Use=e=>Array.isArray(e)&&typeof e[0]=="number",B7e={linear:fc,easeIn:F7e,easeInOut:Pse,easeOut:L7e,circIn:S6,circInOut:zse,circOut:Bse,backIn:w6,backInOut:Lse,backOut:Fse,anticipate:$se},z7e=e=>typeof e=="string",yV=e=>{if(Use(e)){s6(e.length===4);const[t,n,r,s]=e;return t_(t,n,r,s)}else if(z7e(e))return B7e[e];return e};function U7e(e,t){return e.map(()=>t||Pse).splice(0,e.length-1)}function bw({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=$7e(r)?r.map(yV):yV(r),i={done:!1,value:t[0]},a=j7e(n&&n.length===t.length?n:M7e(t),e),o=R7e(a,t,{ease:Array.isArray(s)?s:U7e(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const q7e=e=>e!==null;function _6(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(q7e),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const V7e={decay:J4,inertia:J4,tween:bw,keyframes:bw,spring:PE};function qse(e){typeof e.type=="string"&&(e.type=V7e[e.type])}class C6{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const W7e=e=>e/100;class Vse extends C6{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==el.now()&&this.tick(el.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;qse(t);const{type:n=bw,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||bw;l!==bw&&typeof o[0]!="number"&&(this.mixKeyframes=e_(W7e,Rse(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=x6(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:p,type:g,onUpdate:y,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,_=r;if(d){const R=Math.min(this.currentTime,s)/o;let M=Math.floor(R),j=R%1;!j&&R>=1&&(j=1),j===1&&M--,M=Math.min(M,d+1),!!(M%2)&&(h==="reverse"?(j=1-j,p&&(j-=p/o)):h==="mirror"&&(_=a)),S=If(0,1,j)*o}const k=w?{done:!1,value:u[0]}:_.next(S);i&&(k.value=i(k.value));let{done:T}=k;!w&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return A&&g!==J4&&(k.value=_6(u,this.options,v,this.speed)),y&&y(k.value),A&&this.finish(),k}then(t,n){return this.finished.then(t,n)}get duration(){return ed(this.calculatedDuration)}get time(){return ed(this.currentTime)}set time(t){t=Qu(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(el.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=ed(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=x7e,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(el.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function H7e(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Lm=e=>e*180/Math.PI,Q4=e=>{const t=Lm(Math.atan2(e[1],e[0]));return eO(t)},G7e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Q4,rotateZ:Q4,skewX:e=>Lm(Math.atan(e[1])),skewY:e=>Lm(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},eO=e=>(e=e%360,e<0&&(e+=360),e),bV=Q4,vV=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),xV=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),K7e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:vV,scaleY:xV,scale:e=>(vV(e)+xV(e))/2,rotateX:e=>eO(Lm(Math.atan2(e[6],e[5]))),rotateY:e=>eO(Lm(Math.atan2(-e[2],e[0]))),rotateZ:bV,rotate:bV,skewX:e=>Lm(Math.atan(e[4])),skewY:e=>Lm(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function wV(e){return e.includes("scale")?1:0}function tO(e,t){if(!e||e==="none")return wV(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=K7e,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=G7e,s=o}if(!s)return wV(t);const i=r[t],a=s[1].split(",").map(Z7e);return typeof i=="function"?i(a):a[i]}const Y7e=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return tO(n,t)};function Z7e(e){return parseFloat(e.trim())}const SV=e=>e===av||e===ur,X7e=new Set(["x","y","z"]),J7e=sv.filter(e=>!X7e.has(e));function Q7e(e){const t=[];return J7e.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Hm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>tO(t,"x"),y:(e,{transform:t})=>tO(t,"y")};Hm.translateX=Hm.x;Hm.translateY=Hm.y;const Gm=new Set;let nO=!1,rO=!1,sO=!1;function Wse(){if(rO){const e=Array.from(Gm).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=Q7e(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}rO=!1,nO=!1,Gm.forEach(e=>e.complete(sO)),Gm.clear()}function Hse(){Gm.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(rO=!0)})}function eUe(){sO=!0,Hse(),Wse(),sO=!1}class k6{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Gm.add(this),nO||(nO=!0,ui.read(Hse),ui.resolveKeyframes(Wse))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}H7e(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Gm.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Gm.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const tUe=e=>e.startsWith("--");function nUe(e,t,n){tUe(t)?e.style.setProperty(t,n):e.style[t]=n}function E6(e){let t;return()=>(t===void 0&&(t=e()),t)}const rUe=E6(()=>window.ScrollTimeline!==void 0),sUe={};function iUe(e,t){const n=E6(e);return()=>sUe[t]??n()}const Gse=iUe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Xx=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,_V={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Xx([0,.65,.55,1]),circOut:Xx([.55,0,1,.45]),backIn:Xx([.31,.01,.66,-.59]),backOut:Xx([.33,1.53,.69,.99])};function Kse(e,t){if(e)return typeof e=="function"?Gse()?Ise(e,t):"ease-out":Use(e)?Xx(e):Array.isArray(e)?e.map(n=>Kse(n,t)||_V.easeOut):_V[e]}function aUe(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=Kse(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function Yse(e){return typeof e=="function"&&"applyToOptions"in e}function oUe({type:e,...t}){return Yse(e)&&Gse()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class lUe extends C6{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,s6(typeof t.type!="string");const c=oUe(t);this.animation=aUe(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=_6(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):nUe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return ed(Number(t))}get time(){return ed(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Qu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&rUe()?(this.animation.timeline=t,fc):n(this)}}const Zse={anticipate:$se,backInOut:Lse,circInOut:zse};function cUe(e){return e in Zse}function uUe(e){typeof e.ease=="string"&&cUe(e.ease)&&(e.ease=Zse[e.ease])}const CV=10;class dUe extends lUe{constructor(t){uUe(t),qse(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new Vse({...a,autoplay:!1}),l=Qu(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-CV).value,o.sample(l).value,CV),o.stop()}}const kV=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(hp.test(e)||e==="0")&&!e.startsWith("url("));function fUe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function hUe(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=kV(s,t),o=kV(i,t);return!a||!o?!1:fUe(e)||(n==="spring"||Yse(n))&&r}const pUe=new Set(["opacity","clipPath","filter","transform"]),mUe=E6(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function gUe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return mUe()&&n&&pUe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const yUe=40;class bUe extends C6{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var g;super(),this.stop=()=>{var y,v;this._animation?(this._animation.stop(),(y=this.stopTimeline)==null||y.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=el.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},p=(u==null?void 0:u.KeyframeResolver)||k6;this.keyframeResolver=new p(o,(y,v,x)=>this.onKeyframesResolved(y,v,h,!x),l,c,u),(g=this.keyframeResolver)==null||g.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=el.now(),hUe(t,i,a,o)||((Rf.instantAnimations||!l)&&(u==null||u(_6(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>yUe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},p=!c&&gUe(h)?new dUe({...h,element:h.motionValue.owner.current}):new Vse(h);p.finished.then(()=>this.notifyFinished()).catch(fc),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||eUe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const T6=(e,t,n,r={},s,i)=>a=>{const o=g6(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Qu(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};Q9e(o)||Object.assign(u,J9e(e,u)),u.duration&&(u.duration=Qu(u.duration)),u.repeatDelay&&(u.repeatDelay=Qu(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Rf.instantAnimations||Rf.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=G9e(u.keyframes,o);if(h!==void 0){ui.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new bUe(u)},Xse=new Set(["width","height","top","left","right","bottom",...sv]);function vUe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function Jse(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&vUe(c,u))continue;const p={delay:n,...g6(i||{},u)},g=d.get();if(g!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===g&&!p.velocity)continue;let y=!1;if(window.MotionHandoffAnimation){const x=_se(e);if(x){const w=window.MotionHandoffAnimation(x,u,ui);w!==null&&(p.startTime=w,y=!0)}}K4(e,u),d.start(T6(u,d,h,e.shouldReduceMotion&&Xse.has(u)?{type:!1}:p,e,y));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{ui.update(()=>{a&&V9e(e,a)})}),l}function iO(e,t,n={}){var l;const r=P1(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(Jse(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return xUe(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function xUe(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(wUe).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(iO(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function wUe(e,t){return e.sortNodePosition(t)}function SUe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>iO(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=iO(e,t,n);else{const s=typeof t=="function"?P1(e,t,n.custom):t;r=Promise.all(Jse(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function Qse(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const _Ue=t6.length;function eie(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?eie(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<_Ue;n++){const r=t6[n],s=e.props[r];(I1(s)||s===!1)&&(t[r]=s)}return t}const CUe=[...e6].reverse(),kUe=e6.length;function EUe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>SUe(e,n,r)))}function TUe(e){let t=EUe(e),n=EV(),r=!0;const s=l=>(c,u)=>{var h;const d=P1(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:p,transitionEnd:g,...y}=d;c={...c,...y,...g}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=eie(e.parent)||{},d=[],h=new Set;let p={},g=1/0;for(let v=0;v<kUe;v++){const x=CUe[v],w=n[x],S=c[x]!==void 0?c[x]:u[x],_=I1(S),k=x===l?w.isActive:null;k===!1&&(g=v);let T=S===u[x]&&S!==c[x]&&_;if(T&&r&&e.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...p},!w.isActive&&k===null||!S&&!w.prevProp||XA(S)||typeof S=="boolean")continue;const A=AUe(w.prevProp,S);let R=A||x===l&&w.isActive&&!T&&_||v>g&&_,M=!1;const j=Array.isArray(S)?S:[S];let F=j.reduce(s(x),{});k===!1&&(F={});const{prevResolvedValues:P={}}=w,q={...P,...F},I=z=>{R=!0,h.has(z)&&(M=!0,h.delete(z)),w.needsAnimating[z]=!0;const $=e.getValue(z);$&&($.liveStyle=!1)};for(const z in q){const $=F[z],Y=P[z];if(p.hasOwnProperty(z))continue;let B=!1;G4($)&&G4(Y)?B=!Qse($,Y):B=$!==Y,B?$!=null?I(z):h.add(z):$!==void 0&&h.has(z)?I(z):w.protectedKeys[z]=!0}w.prevProp=S,w.prevResolvedValues=F,w.isActive&&(p={...p,...F}),r&&e.blockInitialAnimation&&(R=!1),R&&(!(T&&A)||M)&&d.push(...j.map(z=>({animation:z,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=P1(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),S=e.getValue(x);S&&(S.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let y=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(y=!1),r=!1,y?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var p;return(p=h.animationState)==null?void 0:p.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=EV(),r=!0}}}function AUe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Qse(t,e):!1}function wm(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function EV(){return{animate:wm(!0),whileInView:wm(),whileHover:wm(),whileTap:wm(),whileDrag:wm(),whileFocus:wm(),exit:wm()}}class Fp{constructor(t){this.isMounted=!1,this.node=t}update(){}}class NUe extends Fp{constructor(t){super(t),t.animationState||(t.animationState=TUe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();XA(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let RUe=0;class IUe extends Fp{constructor(){super(...arguments),this.id=RUe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const MUe={animation:{Feature:NUe},exit:{Feature:IUe}};function L1(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const A6=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function n_(e){return{point:{x:e.pageX,y:e.pageY}}}const jUe=e=>t=>A6(t)&&e(t,n_(t));function vw(e,t,n,r){return L1(e,t,jUe(n),r)}function tie({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function PUe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function OUe(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const nie=1e-4,DUe=1-nie,FUe=1+nie,rie=.01,LUe=0-rie,$Ue=0+rie;function wo(e){return e.max-e.min}function BUe(e,t,n){return Math.abs(e-t)<=n}function TV(e,t,n,r=.5){e.origin=r,e.originPoint=li(t.min,t.max,e.origin),e.scale=wo(n)/wo(t),e.translate=li(n.min,n.max,e.origin)-e.originPoint,(e.scale>=DUe&&e.scale<=FUe||isNaN(e.scale))&&(e.scale=1),(e.translate>=LUe&&e.translate<=$Ue||isNaN(e.translate))&&(e.translate=0)}function xw(e,t,n,r){TV(e.x,t.x,n.x,r?r.originX:void 0),TV(e.y,t.y,n.y,r?r.originY:void 0)}function AV(e,t,n){e.min=n.min+t.min,e.max=e.min+wo(t)}function zUe(e,t,n){AV(e.x,t.x,n.x),AV(e.y,t.y,n.y)}function NV(e,t,n){e.min=t.min-n.min,e.max=e.min+wo(t)}function ww(e,t,n){NV(e.x,t.x,n.x),NV(e.y,t.y,n.y)}const RV=()=>({translate:0,scale:1,origin:0,originPoint:0}),cy=()=>({x:RV(),y:RV()}),IV=()=>({min:0,max:0}),Ci=()=>({x:IV(),y:IV()});function tc(e){return[e("x"),e("y")]}function E3(e){return e===void 0||e===1}function aO({scale:e,scaleX:t,scaleY:n}){return!E3(e)||!E3(t)||!E3(n)}function Cm(e){return aO(e)||sie(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function sie(e){return MV(e.x)||MV(e.y)}function MV(e){return e&&e!=="0%"}function OE(e,t,n){const r=e-n,s=t*r;return n+s}function jV(e,t,n,r,s){return s!==void 0&&(e=OE(e,s,r)),OE(e,n,r)+t}function oO(e,t=0,n=1,r,s){e.min=jV(e.min,t,n,r,s),e.max=jV(e.max,t,n,r,s)}function iie(e,{x:t,y:n}){oO(e.x,t.translate,t.scale,t.originPoint),oO(e.y,n.translate,n.scale,n.originPoint)}const PV=.999999999999,OV=1.0000000000001;function UUe(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&dy(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,iie(e,a)),r&&Cm(i.latestValues)&&dy(e,i.latestValues))}t.x<OV&&t.x>PV&&(t.x=1),t.y<OV&&t.y>PV&&(t.y=1)}function uy(e,t){e.min=e.min+t,e.max=e.max+t}function DV(e,t,n,r,s=.5){const i=li(e.min,e.max,s);oO(e,t,n,i,r)}function dy(e,t){DV(e.x,t.x,t.scaleX,t.scale,t.originX),DV(e.y,t.y,t.scaleY,t.scale,t.originY)}function aie(e,t){return tie(OUe(e.getBoundingClientRect(),t))}function qUe(e,t,n){const r=aie(e,n),{scroll:s}=t;return s&&(uy(r.x,s.offset.x),uy(r.y,s.offset.y)),r}const oie=({current:e})=>e?e.ownerDocument.defaultView:null,FV=(e,t)=>Math.abs(e-t);function VUe(e,t){const n=FV(e.x,t.x),r=FV(e.y,t.y);return Math.sqrt(n**2+r**2)}class lie{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=A3(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=VUe(d.offset,{x:0,y:0})>=3;if(!h&&!p)return;const{point:g}=d,{timestamp:y}=Oa;this.history.push({...g,timestamp:y});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=T3(h,this.transformPagePoint),ui.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:g,resumeAnimation:y}=this.handlers;if(this.dragSnapToOrigin&&y&&y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=A3(d.type==="pointercancel"?this.lastMoveEventInfo:T3(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,v),g&&g(d,v)},!A6(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=n_(t),o=T3(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=Oa;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,A3(o,this.history)),this.removeListeners=e_(vw(this.contextWindow,"pointermove",this.handlePointerMove),vw(this.contextWindow,"pointerup",this.handlePointerUp),vw(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),fp(this.updatePoint)}}function T3(e,t){return t?{point:t(e.point)}:e}function LV(e,t){return{x:e.x-t.x,y:e.y-t.y}}function A3({point:e},t){return{point:e,delta:LV(e,cie(t)),offset:LV(e,WUe(t)),velocity:HUe(t,.1)}}function WUe(e){return e[0]}function cie(e){return e[e.length-1]}function HUe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=cie(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>Qu(t)));)n--;if(!r)return{x:0,y:0};const i=ed(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function GUe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?li(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?li(n,e,r.max):Math.min(e,n)),e}function $V(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function KUe(e,{top:t,left:n,bottom:r,right:s}){return{x:$V(e.x,n,s),y:$V(e.y,t,r)}}function BV(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function YUe(e,t){return{x:BV(e.x,t.x),y:BV(e.y,t.y)}}function ZUe(e,t){let n=.5;const r=wo(e),s=wo(t);return s>r?n=F1(t.min,t.max-r,e.min):r>s&&(n=F1(e.min,e.max-s,t.min)),If(0,1,n)}function XUe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const lO=.35;function JUe(e=lO){return e===!1?e=0:e===!0&&(e=lO),{x:zV(e,"left","right"),y:zV(e,"top","bottom")}}function zV(e,t,n){return{min:UV(e,t),max:UV(e,n)}}function UV(e,t){return typeof e=="number"?e:e[t]||0}const $c={x:!1,y:!1};function uie(){return $c.x||$c.y}function QUe(e){return e==="x"||e==="y"?$c[e]?null:($c[e]=!0,()=>{$c[e]=!1}):$c.x||$c.y?null:($c.x=$c.y=!0,()=>{$c.x=$c.y=!1})}const eqe=new WeakMap;class tqe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ci(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(n_(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:p,onDragStart:g}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=QUe(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),tc(v=>{let x=this.getAxisMotionValue(v).get()||0;if(Ju.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[v];S&&(x=wo(S)*(parseFloat(x)/100))}}this.originPoint[v]=x}),g&&ui.postRender(()=>g(u,d)),K4(this.visualElement,"transform");const{animationState:y}=this.visualElement;y&&y.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:g,onDrag:y}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(p&&this.currentDirection===null){this.currentDirection=nqe(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),y&&y(u,d)},o=(u,d)=>this.stop(u,d),l=()=>tc(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new lie(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:oie(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ui.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!h2(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=GUe(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&oy(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=KUe(r.layoutBox,t):this.constraints=!1,this.elastic=JUe(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&tc(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=XUe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!oy(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=qUe(r,s.root,this.visualElement.getTransformPagePoint());let a=YUe(s.layout.layoutBox,i);if(n){const o=n(PUe(a));this.hasMutatedConstraints=!!o,o&&(a=tie(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=tc(u=>{if(!h2(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,p=s?40:1e7,g={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,g)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return K4(this.visualElement,t),r.start(T6(t,r,0,n,this.visualElement,!1))}stopAnimation(){tc(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){tc(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){tc(n=>{const{drag:r}=this.getProps();if(!h2(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-li(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!oy(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};tc(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=ZUe({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),tc(a=>{if(!h2(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(li(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;eqe.set(this.visualElement,this);const t=this.visualElement.current,n=vw(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();oy(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ui.read(r);const a=L1(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(tc(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=lO,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function h2(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function nqe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class rqe extends Fp{constructor(t){super(t),this.removeGroupControls=fc,this.removeListeners=fc,this.controls=new tqe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||fc}unmount(){this.removeGroupControls(),this.removeListeners()}}const qV=e=>(t,n)=>{e&&ui.postRender(()=>e(t,n))};class sqe extends Fp{constructor(){super(...arguments),this.removePointerDownListener=fc}onPointerDown(t){this.session=new lie(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oie(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:qV(t),onStart:qV(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ui.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=vw(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Q2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function VV(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Ax={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ur.test(e))e=parseFloat(e);else return e;const n=VV(e,t.target.x),r=VV(e,t.target.y);return`${n}% ${r}%`}},iqe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=hp.parse(e);if(s.length>5)return r;const i=hp.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=li(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class aqe extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;b9e(oqe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Q2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ui.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),r6.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function die(e){const[t,n]=ise(),r=E.useContext(Z5);return f.jsx(aqe,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(dse),isPresent:t,safeToRemove:n})}const oqe={borderRadius:{...Ax,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ax,borderTopRightRadius:Ax,borderBottomLeftRadius:Ax,borderBottomRightRadius:Ax,boxShadow:iqe};function lqe(e,t,n){const r=eo(e)?e:O1(e);return r.start(T6("",r,t,n)),r.animation}function cqe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const uqe=(e,t)=>e.depth-t.depth;class dqe{constructor(){this.children=[],this.isDirty=!1}add(t){h6(this.children,t),this.isDirty=!0}remove(t){p6(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(uqe),this.isDirty=!1,this.children.forEach(t)}}function fqe(e,t){const n=el.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(fp(r),e(i-t))};return ui.setup(r,!0),()=>fp(r)}const fie=["TopLeft","TopRight","BottomLeft","BottomRight"],hqe=fie.length,WV=e=>typeof e=="string"?parseFloat(e):e,HV=e=>typeof e=="number"||ur.test(e);function pqe(e,t,n,r,s,i){s?(e.opacity=li(0,n.opacity??1,mqe(r)),e.opacityExit=li(t.opacity??1,0,gqe(r))):i&&(e.opacity=li(t.opacity??1,n.opacity??1,r));for(let a=0;a<hqe;a++){const o=`border${fie[a]}Radius`;let l=GV(t,o),c=GV(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||HV(l)===HV(c)?(e[o]=Math.max(li(WV(l),WV(c),r),0),(Ju.test(c)||Ju.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=li(t.rotate||0,n.rotate||0,r))}function GV(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const mqe=hie(0,.5,Bse),gqe=hie(.5,.95,fc);function hie(e,t,n){return r=>r<e?0:r>t?1:n(F1(e,t,r))}function KV(e,t){e.min=t.min,e.max=t.max}function Xl(e,t){KV(e.x,t.x),KV(e.y,t.y)}function YV(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function ZV(e,t,n,r,s){return e-=t,e=OE(e,1/n,r),s!==void 0&&(e=OE(e,1/s,r)),e}function yqe(e,t=0,n=1,r=.5,s,i=e,a=e){if(Ju.test(t)&&(t=parseFloat(t),t=li(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=li(i.min,i.max,r);e===i&&(o-=t),e.min=ZV(e.min,t,n,o,s),e.max=ZV(e.max,t,n,o,s)}function XV(e,t,[n,r,s],i,a){yqe(e,t[n],t[r],t[s],t.scale,i,a)}const bqe=["x","scaleX","originX"],vqe=["y","scaleY","originY"];function JV(e,t,n,r){XV(e.x,t,bqe,n?n.x:void 0,r?r.x:void 0),XV(e.y,t,vqe,n?n.y:void 0,r?r.y:void 0)}function QV(e){return e.translate===0&&e.scale===1}function pie(e){return QV(e.x)&&QV(e.y)}function eW(e,t){return e.min===t.min&&e.max===t.max}function xqe(e,t){return eW(e.x,t.x)&&eW(e.y,t.y)}function tW(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function mie(e,t){return tW(e.x,t.x)&&tW(e.y,t.y)}function nW(e){return wo(e.x)/wo(e.y)}function rW(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class wqe{constructor(){this.members=[]}add(t){h6(this.members,t),t.scheduleRender()}remove(t){if(p6(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Sqe(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:p,skewY:g}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),p&&(r+=`skewX(${p}deg) `),g&&(r+=`skewY(${g}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const N3=["","X","Y","Z"],_qe={visibility:"hidden"},sW=1e3;let Cqe=0;function R3(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function gie(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=_se(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ui,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&gie(r)}function yie({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=Cqe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Tqe),this.nodes.forEach(Mqe),this.nodes.forEach(jqe),this.nodes.forEach(Aqe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new dqe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new m6),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=cqe(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=fqe(d,250),Q2.hasAnimatedSinceResize&&(Q2.hasAnimatedSinceResize=!1,this.nodes.forEach(aW))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||c.getDefaultTransition()||Lqe,{onLayoutAnimationStart:y,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!mie(this.targetLayout,p),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const S={...g6(g,"layout"),onPlay:y,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||aW(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),fp(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Pqe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&gie(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(iW);return}this.isUpdating||this.nodes.forEach(Rqe),this.isUpdating=!1,this.nodes.forEach(Iqe),this.nodes.forEach(kqe),this.nodes.forEach(Eqe),this.clearAllSnapshots();const o=el.now();Oa.delta=If(0,1e3/60,o-Oa.timestamp),Oa.timestamp=o,Oa.isProcessing=!0,S3.update.process(Oa),S3.preRender.process(Oa),S3.render.process(Oa),Oa.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,r6.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Nqe),this.sharedNodes.forEach(Oqe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ui.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ui.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!wo(this.snapshot.measuredBox.x)&&!wo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ci(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!pie(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||Cm(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),$qe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return Ci();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(Bqe))){const{scroll:u}=this.root;u&&(uy(o.x,u.offset.x),uy(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=Ci();if(Xl(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Xl(o,a),uy(o.x,d.offset.x),uy(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=Ci();Xl(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&dy(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Cm(u.latestValues)&&dy(l,u.latestValues)}return Cm(this.latestValues)&&dy(l,this.latestValues),l}removeTransform(a){const o=Ci();Xl(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Cm(c.latestValues))continue;aO(c.latestValues)&&c.updateSnapshot();const u=Ci(),d=c.measurePageBox();Xl(u,d),JV(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Cm(this.latestValues)&&JV(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Oa.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=Oa.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ci(),this.relativeTargetOrigin=Ci(),ww(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),Xl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ci(),this.targetWithTransforms=Ci()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),zUe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xl(this.target,this.layout.layoutBox),iie(this.target,this.targetDelta)):Xl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ci(),this.relativeTargetOrigin=Ci(),ww(this.relativeTargetOrigin,this.target,p.target),Xl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||aO(this.parent.latestValues)||sie(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var g;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(g=this.parent)!=null&&g.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Oa.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Xl(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;UUe(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Ci());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(YV(this.prevProjectionDelta.x,this.projectionDelta.x),YV(this.prevProjectionDelta.y,this.projectionDelta.y)),xw(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!rW(this.projectionDelta.x,this.prevProjectionDelta.x)||!rW(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=cy(),this.projectionDelta=cy(),this.projectionDeltaWithTransform=cy()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=cy();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Ci(),p=l?l.source:void 0,g=this.layout?this.layout.source:void 0,y=p!==g,v=this.getStack(),x=!v||v.members.length<=1,w=!!(y&&!x&&this.options.crossfade===!0&&!this.path.some(Fqe));this.animationProgress=0;let S;this.mixTargetDelta=_=>{const k=_/1e3;oW(d.x,a.x,k),oW(d.y,a.y,k),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(ww(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Dqe(this.relativeTarget,this.relativeTargetOrigin,h,k),S&&xqe(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=Ci()),Xl(S,this.relativeTarget)),y&&(this.animationValues=u,pqe(u,c,this.latestValues,k,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(fp(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ui.update(()=>{Q2.hasAnimatedSinceResize=!0,this.currentAnimation=lqe(0,sW,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(sW),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&bie(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Ci();const d=wo(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=wo(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Xl(o,l),dy(o,u),xw(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new wqe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&R3("z",a,c,this.animationValues);for(let u=0;u<N3.length;u++)R3(`rotate${N3[u]}`,a,c,this.animationValues),R3(`skew${N3[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return _qe;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=X2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=X2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Cm(this.latestValues)&&(p.transform=l?l({},""):"none",this.hasProjected=!1),p}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=Sqe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in M1){if(u[p]===void 0)continue;const{correct:g,applyTo:y,isCSSVariable:v}=M1[p],x=o.transform==="none"?u[p]:g(u[p],c);if(y){const w=y.length;for(let S=0;S<w;S++)o[y[S]]=x}else v?this.options.visualElement.renderState.vars[p]=x:o[p]=x}return this.options.layoutId&&(o.pointerEvents=c===this?X2(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(iW),this.root.sharedNodes.clear()}}}function kqe(e){e.updateLayout()}function Eqe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?tc(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],p=wo(h);h.min=r[d].min,h.max=h.min+p}):bie(i,t.layoutBox,r)&&tc(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],p=wo(r[d]);h.max=h.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+p)});const o=cy();xw(o,r,t.layoutBox);const l=cy();a?xw(l,e.applyTransform(s,!0),t.measuredBox):xw(l,r,t.layoutBox);const c=!pie(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:p}=d;if(h&&p){const g=Ci();ww(g,t.layoutBox,h.layoutBox);const y=Ci();ww(y,r,p.layoutBox),mie(g,y)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=y,e.relativeTargetOrigin=g,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function Tqe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Aqe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Nqe(e){e.clearSnapshot()}function iW(e){e.clearMeasurements()}function Rqe(e){e.isLayoutDirty=!1}function Iqe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function aW(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Mqe(e){e.resolveTargetDelta()}function jqe(e){e.calcProjection()}function Pqe(e){e.resetSkewAndRotation()}function Oqe(e){e.removeLeadSnapshot()}function oW(e,t,n){e.translate=li(t.translate,0,n),e.scale=li(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function lW(e,t,n,r){e.min=li(t.min,n.min,r),e.max=li(t.max,n.max,r)}function Dqe(e,t,n,r){lW(e.x,t.x,n.x,r),lW(e.y,t.y,n.y,r)}function Fqe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Lqe={duration:.45,ease:[.4,0,.1,1]},cW=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),uW=cW("applewebkit/")&&!cW("chrome/")?Math.round:fc;function dW(e){e.min=uW(e.min),e.max=uW(e.max)}function $qe(e){dW(e.x),dW(e.y)}function bie(e,t,n){return e==="position"||e==="preserve-aspect"&&!BUe(nW(t),nW(n),.2)}function Bqe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const zqe=yie({attachResizeListener:(e,t)=>L1(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),I3={current:void 0},vie=yie({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!I3.current){const e=new zqe({});e.mount(window),e.setOptions({layoutScroll:!0}),I3.current=e}return I3.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Uqe={pan:{Feature:sqe},drag:{Feature:rqe,ProjectionNode:vie,MeasureLayout:die}};function qqe(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function xie(e,t){const n=qqe(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function fW(e){return!(e.pointerType==="touch"||uie())}function Vqe(e,t,n={}){const[r,s,i]=xie(e,n),a=o=>{if(!fW(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{fW(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function hW(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ui.postRender(()=>i(t,n_(t)))}class Wqe extends Fp{mount(){const{current:t}=this.node;t&&(this.unmount=Vqe(t,(n,r)=>(hW(this.node,r,"Start"),s=>hW(this.node,s,"End"))))}unmount(){}}class Hqe extends Fp{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=e_(L1(this.node.current,"focus",()=>this.onFocus()),L1(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const wie=(e,t)=>t?e===t?!0:wie(e,t.parentElement):!1,Gqe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Kqe(e){return Gqe.has(e.tagName)||e.tabIndex!==-1}const Jx=new WeakSet;function pW(e){return t=>{t.key==="Enter"&&e(t)}}function M3(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Yqe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=pW(()=>{if(Jx.has(n))return;M3(n,"down");const s=pW(()=>{M3(n,"up")}),i=()=>M3(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function mW(e){return A6(e)&&!uie()}function Zqe(e,t,n={}){const[r,s,i]=xie(e,n),a=o=>{const l=o.currentTarget;if(!mW(o)||Jx.has(l))return;Jx.add(l);const c=t(l,o),u=(p,g)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!mW(p)||!Jx.has(l))&&(Jx.delete(l),typeof c=="function"&&c(p,{success:g}))},d=p=>{u(p,l===window||l===document||n.useGlobalTarget||wie(l,p.target))},h=p=>{u(p,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>Yqe(c,s)),!Kqe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function gW(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ui.postRender(()=>i(t,n_(t)))}class Xqe extends Fp{mount(){const{current:t}=this.node;t&&(this.unmount=Zqe(t,(n,r)=>(gW(this.node,r,"Start"),(s,{success:i})=>gW(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const cO=new WeakMap,j3=new WeakMap,Jqe=e=>{const t=cO.get(e.target);t&&t(e)},Qqe=e=>{e.forEach(Jqe)};function eVe({root:e,...t}){const n=e||document;j3.has(n)||j3.set(n,{});const r=j3.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(Qqe,{root:e,...t})),r[s]}function tVe(e,t,n){const r=eVe(t);return cO.set(e,n),r.observe(e),()=>{cO.delete(e),r.unobserve(e)}}const nVe={some:0,all:1};class rVe extends Fp{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:nVe[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return tVe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(sVe(t,n))&&this.startObserver()}unmount(){}}function sVe({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const iVe={inView:{Feature:rVe},tap:{Feature:Xqe},focus:{Feature:Hqe},hover:{Feature:Wqe}},aVe={layout:{ProjectionNode:vie,MeasureLayout:die}},uO={current:null},Sie={current:!1};function oVe(){if(Sie.current=!0,!!J5)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>uO.current=e.matches;e.addListener(t),t()}else uO.current=!1}const lVe=new WeakMap;function cVe(e,t,n){for(const r in t){const s=t[r],i=n[r];if(eo(s))e.addValue(r,s);else if(eo(i))e.addValue(r,O1(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,O1(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const _ie=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),Cie=e=>/^0[^.\s]+$/u.test(e),uVe={test:e=>e==="auto",parse:e=>e},kie=e=>t=>t.test(e),Eie=[av,ur,Ju,Oh,x9e,v9e,uVe],yW=e=>Eie.find(kie(e)),dVe=[...Eie,Ya,hp],fVe=e=>dVe.find(kie(e)),hVe=new Set(["brightness","contrast","saturate","opacity"]);function pVe(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(y6)||[];if(!r)return e;const s=n.replace(r,"");let i=hVe.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const mVe=/\b([a-z-]*)\(.*?\)/gu,dO={...hp,getAnimatableNone:e=>{const t=e.match(mVe);return t?t.map(pVe).join(" "):e}},gVe={...o6,color:Ya,backgroundColor:Ya,outlineColor:Ya,fill:Ya,stroke:Ya,borderColor:Ya,borderTopColor:Ya,borderRightColor:Ya,borderBottomColor:Ya,borderLeftColor:Ya,filter:dO,WebkitFilter:dO},Tie=e=>gVe[e];function Aie(e,t){let n=Tie(e);return n!==dO&&(n=hp),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const bW=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class yVe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=k6,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=el.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,ui.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=JA(n),this.isVariantNode=cse(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const p=d[h];l[h]!==void 0&&eo(p)&&p.set(l[h],!1)}}mount(t){this.current=t,lVe.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),Sie.current||oVe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:uO.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),fp(this.notifyUpdate),fp(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=iv.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ui.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in fb){const n=fb[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ci()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<bW.length;r++){const s=bW[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=cVe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=O1(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(_ie(r)||Cie(r))?r=parseFloat(r):!fVe(r)&&hp.test(n)&&(r=Aie(t,n)),this.setBaseTarget(t,eo(r)?r.get():r)),eo(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=d6(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!eo(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new m6),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const bVe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function vVe(e){const t=bVe.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function Nie(e,t,n=1){const[r,s]=vVe(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return _ie(a)?parseFloat(a):a}return a6(s)?Nie(s,t,n+1):s}function xVe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Cie(e):!0}const wVe=new Set(["auto","none","0"]);function SVe(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!wVe.has(i)&&D1(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=Aie(n,s)}class _Ve extends k6{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),a6(c))){const u=Nie(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Xse.has(r)||t.length!==2)return;const[s,i]=t,a=yW(s),o=yW(i);if(a!==o)if(SV(a)&&SV(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else Hm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||xVe(t[s]))&&r.push(s);r.length&&SVe(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Hm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=Hm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class Rie extends yVe{constructor(){super(...arguments),this.KeyframeResolver=_Ve}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;eo(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Iie(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function CVe(e){return window.getComputedStyle(e)}class kVe extends Rie{constructor(){super(...arguments),this.type="html",this.renderInstance=Iie}readValueFromInstance(t,n){if(iv.has(n))return Y7e(t,n);{const r=CVe(t),s=(i6(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return aie(t,n)}build(t,n,r){l6(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return f6(t,n,r)}}const Mie=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function EVe(e,t,n,r){Iie(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(Mie.has(s)?s:n6(s),t.attrs[s])}class TVe extends Rie{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ci}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(iv.has(n)){const r=Tie(n);return r&&r.default||0}return n=Mie.has(n)?n:n6(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return wse(t,n,r)}build(t,n,r){yse(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){EVe(t,n,r,s)}mount(t){this.isSVGTag=vse(t.tagName),super.mount(t)}}const AVe=(e,t)=>u6(e)?new TVe(t):new kVe(t,{allowProjection:e!==E.Fragment}),NVe=L9e({...MUe,...iVe,...Uqe,...aVe},AVe),Fu=s9e(NVe),Gi=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,RVe=Zo.map(e=>e.value),p2=Ze({keyName:qe().min(1,"Key Name is required."),providerType:Ll(RVe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:qe().min(1,"API Key Value is required.")}),fO=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a,isEditMode:o=!1,editId:l})=>{const c=E.useRef(null),u=Xs({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:p2,onChangeAsyncDebounceMs:500},onSubmit:async({value:h})=>{await r(h.keyName,h.providerType,h.keyValue,l)}});E.useEffect(()=>{u.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,u]);const d=(h,p)=>{var x,w;if(!h)return;const g=(x=Zo.find(S=>S.value===h))==null?void 0:x.label,y=u.getFieldValue("providerType"),v=(w=Zo.find(S=>S.value===y))==null?void 0:w.label;g&&(!(p!=null&&p.trim())||p===v)&&u.setFieldValue("keyName",g),requestAnimationFrame(()=>{var S;(S=c.current)==null||S.focus()})};return f.jsxs("form",{onSubmit:h=>{h.preventDefault(),h.stopPropagation(),u.handleSubmit()},className:Ye("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(u.Field,{name:"providerType",validators:{onChange:p2.shape.providerType},children:h=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:h.name,children:"Provider Type"}),f.jsxs(mc,{value:h.state.value??"",onValueChange:p=>{const g=p;h.handleChange(g),h.handleBlur(),d(g,u.getFieldValue("keyName"))},disabled:i||u.state.isSubmitting,children:[f.jsx(yc,{id:h.name,children:f.jsx(gc,{placeholder:"Select Provider Type"})}),f.jsx(bc,{children:Zo.map(p=>f.jsx(yi,{value:p.value,children:p.label},p.value))})]}),f.jsx(Gi,{field:h})]})}),f.jsx(u.Field,{name:"keyName",validators:{onChange:p2.shape.keyName},children:h=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:h.name,children:"Key Name"}),f.jsx(vn,{id:h.name,value:h.state.value??"",onChange:p=>h.handleChange(p.target.value),onBlur:h.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||u.state.isSubmitting}),f.jsx(Gi,{field:h})]})}),f.jsx(u.Field,{name:"keyValue",validators:{onChange:p2.shape.keyValue},children:h=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:h.name,children:"API Key Value"}),f.jsx(vn,{ref:c,id:h.name,type:"password",value:h.state.value??"",onChange:p=>h.handleChange(p.target.value),onBlur:h.handleBlur,placeholder:"Enter your API key",disabled:i||u.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Gi,{field:h})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(rt,{variant:"ghost",size:"sm",onClick:s,disabled:i||u.state.isSubmitting,type:"button",children:[f.jsx(Ri,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(u.Subscribe,{selector:h=>[h.canSubmit,h.isSubmitting,h.isValidating,h.isValid],children:([h,p,g,y])=>f.jsxs(rt,{type:"submit",size:"sm",disabled:i||!h||p||g||!y,children:[(p||g)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"}),p||g?"Saving...":o?"Update API Key":"Save API Key"]})})]})]})},IVe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(mc,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(yc,{className:Ye("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(gc,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(Fw,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(bc,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(yi,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(yi,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function $1({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[f.jsx(At,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(vn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Ye(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(Gi,{field:c})]})}})}function Sw({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[f.jsx(At,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(mc,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(yc,{id:u.name,onBlur:u.handleBlur,className:Ye(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(gc,{placeholder:s})}),f.jsx(bc,{className:l,children:r.map(h=>f.jsx(yi,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(Gi,{field:u})]})}})}function Mm({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Ye("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(At,{htmlFor:c.name,className:Ye("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(Eo,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Ye(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(Gi,{field:c})]})}})}const MVe=Zo.map(e=>e.value),jVe=Ze({name:qe().min(1,"Provider Name is required."),type:Ll(MVe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:Kn(),apiKeyId:qe().nullable(),baseURL:qe().url().nullable().or(Pn("")),autoFetchModels:Kn()}).refine(e=>Hk(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>Vy(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),PVe=Zo.map(e=>({value:e.value,label:e.label})),jie=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=Xs({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=Zo[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:jVe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!Hk(x.type)?null:x.baseURL};await t(w)}}),c=E.useRef(l.state.values);E.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,S=c.current;if(n&&S)for(const _ in w){const k=_;w[k]!==S[k]&&n(k,w[k])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),E.useEffect(()=>{var S,_;const x=(e==null?void 0:e.type)||((S=Zo[0])==null?void 0:S.value),w={name:(e==null?void 0:e.name)||((_=Zo.find(k=>k.value===x))==null?void 0:_.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??Wm(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=Vy(u??null),h=Hk(u??null),p=Wm(u??null),g=E.useCallback(x=>{var S,_;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",Wm(x));const k=(S=Zo.find(R=>R.value===x))==null?void 0:S.label,T=(_=Zo.find(R=>R.value===w))==null?void 0:_.label,A=l.state.values.name;k&&(!(A!=null&&A.trim())||A===T)&&l.setFieldValue("name",k)}},[l]);E.useEffect(()=>{const x=l.state.values.type;x!==void 0&&g(x)},[l.state.values.type,g]);const y=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Ye("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(Sw,{form:l,name:"type",label:"Provider Type",options:PVe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx($1,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(At,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx(IVe,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:y,disabled:a||i||!u}),f.jsx(Gi,{field:x})]})}),h&&f.jsx($1,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),p&&f.jsx(Mm,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx(Mm,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(rt,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(Ri,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,S,_])=>f.jsxs(rt,{type:"submit",size:"sm",disabled:a||i||!x||w||!_||S,children:[(i||w||S)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"})," ",i||w||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},Pie=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=E.useState(!1),[l,c]=E.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:Wm(r)});E.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=E.useCallback((h,p)=>new Promise(g=>{c(y=>{var w,S;const v={...y,[h]:p},x=y.name||"";if(h==="type"){const _=p,k=(w=Zo.find(A=>A.value===y.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=_?Wm(_):!1;const T=(S=Zo.find(A=>A.value===_))==null?void 0:S.label;if(T&&(!x.trim()||x===k)&&(v.name=T),_&&Vy(_)){const A=(e||[]).filter(R=>R.providerId===_);A.length>0&&(v.apiKeyId=A[0].id)}}return v}),g(void 0)}),[e]),d=E.useCallback(async()=>{var h,p;if(!((h=l.name)!=null&&h.trim())||!l.type){ke.error("Provider Name and Type are required.");return}o(!0);try{const g=l.type,y=l.autoFetchModels??Wm(g),v={name:l.name.trim(),type:g,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((p=l.baseURL)==null?void 0:p.trim())||null,enabledModels:null,autoFetchModels:y,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(g){console.error("Failed to add provider (from form component):",g)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(jie,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},af=We.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Ye("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));af.displayName="Lnk";const OVe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},DVe=TD("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function cs({className:e,variant:t,asChild:n=!1,...r}){const s=n?WK:"span";return f.jsx(s,{"data-slot":"badge",className:Ye(DVe({variant:t}),e),...r})}const FVe=()=>{const[e,t]=E.useState(!1);E.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((g,y)=>{g.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:g},`${g}-${y}`)):d.push(g)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((g,y)=>{h.test(g)?c.push(f.jsx("span",{className:"text-sm text-muted",children:g},`paren-${d}-${y}`)):c.push(g)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(Fu.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(cs,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(mY,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(Fu.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(Fu.div,{variants:r,className:"pt-2",children:[f.jsx(cs,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(cs,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};function U0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((g,y)=>r[y]!==g)))return s;r=d;let p;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(p=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const g=Math.round((Date.now()-u)*100)/100,y=Math.round((Date.now()-p)*100)/100,v=y/16,x=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c ${x(y,5)} /${x(g,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function P3(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const LVe=(e,t)=>Math.abs(e-t)<=1,$Ve=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},vW=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},BVe=e=>e,zVe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},UVe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(vW(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(vW(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},xW={passive:!0},wW=typeof window>"u"?!0:"onscrollend"in window,qVe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&wW?()=>{}:$Ve(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,xW);const c=e.options.useScrollendEvent&&wW;return c&&n.addEventListener("scrollend",l,xW),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},VVe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},WVe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class HVe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:BVe,rangeExtractor:zVe,onChange:()=>{},measureElement:VVe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=U0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=U0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=U0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),p=h?h.end+this.options.gap:r+s,g=o.get(d),y=typeof g=="number"?g:this.options.estimateSize(u),v=p+y,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:p,size:y,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=U0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?GVe({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=U0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=U0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return P3(r[Oie(0,r.length-1,s=>P3(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=P3(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();LVe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const Oie=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function GVe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=Oie(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const SW=typeof document<"u"?E.useLayoutEffect:E.useEffect;function KVe(e){const t=E.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?Nl.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=E.useState(()=>new HVe(n));return r.setOptions(n),SW(()=>r._didMount(),[]),SW(()=>r._willUpdate()),r}function N6(e){return KVe({observeElementRect:UVe,observeElementOffset:qVe,scrollToFn:WVe,...e})}const R6=({currentCapabilityFilters:e,onCapabilityFilterChange:t,currentSelectedProviders:n,onProviderFilterChange:r,currentEnabledFilter:s,onEnabledFilterChange:i,currentMinInputPrice:a,currentMaxInputPrice:o,currentMinOutputPrice:l,currentMaxOutputPrice:c,onPriceFilterChange:u,allProviders:d,showCapabilityFilters:h=!0,showProviderFilter:p=!1,showStatusFilter:g=!1,showPriceFilters:y=!1,disabled:v=!1,totalActiveFilters:x})=>{const[w,S]=E.useState(!1),_=E.useCallback(A=>{t({...e,[A]:!e[A]})},[e,t]),k=E.useCallback((A,R)=>{if(!n||!r)return;const M=new Set(n);R?M.add(A):M.delete(A),r(M)},[n,r]),T=E.useCallback((A,R)=>{if(!u)return;u(A==="minInput"?R:a??"",A==="maxInput"?R:o??"",A==="minOutput"?R:l??"",A==="maxOutput"?R:c??"")},[u,a,o,l,c]);return f.jsxs(Tc,{open:w,onOpenChange:S,children:[f.jsx(Ac,{asChild:!0,children:f.jsxs(rt,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:v,children:[f.jsx(Vbe,{className:"h-4 w-4 mr-1"}),"Filters",x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsxs(Nc,{className:"p-4 space-y-4 w-72 bg-popover shadow-lg relative",style:{zIndex:9999,pointerEvents:"auto"},onMouseDown:A=>A.preventDefault(),onClick:A=>A.stopPropagation(),onPointerDown:A=>A.stopPropagation(),onPointerDownCapture:A=>A.stopPropagation(),align:"end",children:[g&&s!==void 0&&i&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(At,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(rt,{variant:s==="all"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("all")},children:"All"}),f.jsxs(rt,{variant:s==="enabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("enabled")},children:[f.jsx(Ao,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(rt,{variant:s==="disabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("disabled")},children:[f.jsx(Fye,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),p&&n&&d&&r&&f.jsxs("div",{onClick:A=>A.stopPropagation(),children:[f.jsx(At,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(ul,{className:"h-32 border rounded-md p-1",children:d.map(A=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(au,{id:`filter-provider-${A.id}`,checked:n.has(A.id),onCheckedChange:R=>{k(A.id,!!R)}}),f.jsxs(At,{htmlFor:`filter-provider-${A.id}`,className:"text-sm font-normal cursor-pointer",children:[A.name," (",A.type,")"]})]},A.id))})]}),h&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(At,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(Nn,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Pb,{}),onClick:A=>{A.stopPropagation(),_("reasoning")},variant:e.reasoning?"secondary":"outline",className:Ye(e.reasoning&&"text-primary")}),f.jsx(Nn,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(Ro,{}),onClick:A=>{A.stopPropagation(),_("webSearch")},variant:e.webSearch?"secondary":"outline",className:Ye(e.webSearch&&"text-primary")}),f.jsx(Nn,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(Jh,{}),onClick:A=>{A.stopPropagation(),_("tools")},variant:e.tools?"secondary":"outline",className:Ye(e.tools&&"text-primary")}),f.jsx(Nn,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(sd,{}),onClick:A=>{A.stopPropagation(),_("multimodal")},variant:e.multimodal?"secondary":"outline",className:Ye(e.multimodal&&"text-primary")})]})]}),y&&a!==void 0&&u&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsxs(At,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(wbe,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:a,onChange:A=>{A.stopPropagation(),T("minInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:o,onChange:A=>{A.stopPropagation(),T("maxInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:l,onChange:A=>{A.stopPropagation(),T("minOutput",A.target.value)},className:"h-8 text-xs"}),f.jsx(vn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:c,onChange:A=>{A.stopPropagation(),T("maxOutput",A.target.value)},className:"h-8 text-xs"})]})]})]})]})},_W=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},I6=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=E.useState(null),u=E.useCallback(V=>{if(V){const D=V.querySelector("[data-radix-scroll-area-viewport]");if(D)c(D);else{const z=new MutationObserver(()=>{const $=V.querySelector("[data-radix-scroll-area-viewport]");$&&(c($),z.disconnect())});return z.observe(V,{childList:!0,subtree:!0}),()=>z.disconnect()}}else c(null)},[]),[d,h]=E.useState(""),[p,g]=E.useState("all"),[y,v]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[x,w]=E.useState(""),[S,_]=E.useState(""),[k,T]=E.useState(""),[A,R]=E.useState(""),M=E.useMemo(()=>{let V=[...t];if(p==="enabled"?V=V.filter(le=>n.has(le.id)):p==="disabled"&&(V=V.filter(le=>!n.has(le.id))),d.trim()){const le=d.toLowerCase();V=V.filter(Se=>Se.name.toLowerCase().includes(le)||Se.id.toLowerCase().includes(le))}const D=Object.entries(y).filter(([,le])=>le).map(([le])=>le);D.length>0&&(V=V.filter(le=>{var he;const Se=new Set(le.supported_parameters??[]),Ee=new Set(((he=le.architecture)==null?void 0:he.input_modalities)??[]);return D.every(pe=>{switch(pe){case"reasoning":return Se.has("reasoning");case"webSearch":return Se.has("web_search")||Se.has("web_search_options");case"tools":return Se.has("tools");case"multimodal":return Array.from(Ee).some(Le=>Le!=="text");default:return!0}})}));const z=parseFloat(x),$=parseFloat(S),Y=parseFloat(k),B=parseFloat(A),G=!isNaN(z),Z=!isNaN($),ne=!isNaN(Y),ae=!isNaN(B);return(G||Z||ne||ae)&&(V=V.filter(le=>{var ye,Ne;const Se=_W((ye=le.pricing)==null?void 0:ye.prompt),Ee=_W((Ne=le.pricing)==null?void 0:Ne.completion),he=G?z/1e6:-1/0,pe=Z?$/1e6:1/0,Le=ne?Y/1e6:-1/0,He=ae?B/1e6:1/0,Fe=Se!==null&&Se>=he&&Se<=pe,Ie=Ee!==null&&Ee>=Le&&Ee<=He;let X=!0;return(G||Z)&&X&&(X=Fe),(ne||ae)&&X&&(X=Ie),X})),V},[t,d,p,n,y,x,S,k,A]),j=N6({count:M.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),F=E.useCallback(V=>{v(V)},[]),P=E.useCallback(V=>{g(V)},[]),q=E.useCallback((V,D,z,$)=>{w(V),_(D),T(z),R($)},[]),I=E.useMemo(()=>(p!=="all"?1:0)+Object.values(y).filter(Boolean).length+(x||S||k||A?1:0),[p,y,x,S,k,A]);return s?f.jsxs("div",{className:Ye("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{value:d,onChange:V=>h(V.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsx(R6,{currentCapabilityFilters:y,onCapabilityFilterChange:F,currentEnabledFilter:p,onEnabledFilterChange:P,currentMinInputPrice:x,currentMaxInputPrice:S,currentMinOutputPrice:k,currentMaxOutputPrice:A,onPriceFilterChange:q,showStatusFilter:!0,showCapabilityFilters:!0,showPriceFilters:!0,disabled:i,totalActiveFilters:I})]}),f.jsxs(ul,{className:Ye("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${j.getTotalSize()}px`,width:"100%",position:"relative"},children:M.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):j.getVirtualItems().map(V=>{var z,$,Y,B,G,Z,ne,ae;const D=M[V.index];return D?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${V.size}px`,transform:`translateY(${V.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(Eo,{id:`enable-model-${e}-${D.id}`,checked:n.has(D.id),onCheckedChange:le=>r(D.id,le),disabled:i,"aria-label":`Enable model ${D.name||D.id}`,className:"flex-shrink-0",onClick:le=>le.stopPropagation()}),f.jsxs(At,{htmlFor:`enable-model-${e}-${D.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2 flex justify-between items-center",title:D.name||D.id,onClick:o?()=>o(D.id):void 0,children:[f.jsx("span",{className:"truncate",children:D.name||D.id}),f.jsxs("div",{className:"flex gap-1 ml-2 flex-shrink-0",children:[((z=D.supported_parameters)==null?void 0:z.includes("reasoning"))&&f.jsx(Ow,{className:"h-3.5 w-3.5 text-purple-500"}),((($=D.supported_parameters)==null?void 0:$.includes("web_search"))||((Y=D.supported_parameters)==null?void 0:Y.includes("web_search_options")))&&f.jsx(Dw,{className:"h-3.5 w-3.5 text-blue-500"}),((B=D.supported_parameters)==null?void 0:B.includes("tools"))&&f.jsx(Jh,{className:"h-3.5 w-3.5 text-orange-500"}),((Z=(G=D.architecture)==null?void 0:G.input_modalities)==null?void 0:Z.some(le=>le!=="text"))&&f.jsx(sd,{className:"h-3.5 w-3.5 text-green-500"}),((ae=(ne=D.architecture)==null?void 0:ne.output_modalities)==null?void 0:ae.includes("image"))&&f.jsx(Xm,{className:"h-3.5 w-3.5 text-pink-500"})]})]})]},D.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},YVe=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=E.useState(!1);return E.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(Ba,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(ro,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(dS,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(so,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx(NT,{className:"h-4 w-4"})})]}),!c&&f.jsx(dc,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(Xze,{children:c&&f.jsx(Fu.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs(za,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},ZVe=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Gn(pn(ne=>({apiKeys:ne.dbApiKeys,addApiKey:ne.addApiKey,providers:ne.dbProviderConfigs,addProviderConfig:ne.addProviderConfig,updateProviderConfig:ne.updateProviderConfig,getAllAvailableModelDefsForProvider:ne.getAllAvailableModelDefsForProvider,isLoading:ne.isLoading,enableApiKeyManagement:ne.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=On(pn(ne=>({addConversation:ne.addConversation,selectItem:ne.selectItem}))),[u,d]=E.useState(!1),[h,p]=E.useState(!1),[g,y]=E.useState(!1),[v,x]=E.useState(!1),[w,S]=E.useState(!1),_=E.useMemo(()=>!o||e.length>0,[o,e]),k=E.useMemo(()=>n.length>0,[n]),T=E.useMemo(()=>n.some(ne=>ne.isEnabled&&ne.enabledModels&&ne.enabledModels.length>0),[n]),A=E.useMemo(()=>{const ne=[...n].sort((ae,le)=>le.createdAt.getTime()-ae.createdAt.getTime());return ne.length>0?ne[0]:null},[n]),R=E.useMemo(()=>A?i(A.id):[],[A,i]),M=E.useMemo(()=>new Set((A==null?void 0:A.enabledModels)??[]),[A]),{initialProviderTypeForForm:j,initialProviderNameForForm:F,initialApiKeyIdForForm:P}=E.useMemo(()=>{var ne;if(k)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const le=[...e].sort((Se,Ee)=>Ee.createdAt.getTime()-Se.createdAt.getTime()).find(Se=>Vy(Se.providerId));if(le){const Se=le.providerId,Ee=((ne=Zo.find(he=>he.value===Se))==null?void 0:ne.label)||Se;return{initialProviderTypeForForm:Se,initialProviderNameForForm:Ee,initialApiKeyIdForForm:le.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,k]),q=E.useCallback(async(ne,ae,le)=>{d(!0);try{await t(ne,ae,le),ke.success("API key added successfully!")}finally{d(!1)}},[t]),I=E.useCallback(async ne=>{p(!0);try{const ae={...ne,apiKeyId:ne.apiKeyId??(Vy(ne.type)?P??null:null)},le=await r(ae);return ke.success("Provider added successfully!"),le}finally{p(!1)}},[r,P]),V=E.useCallback(async(ne,ae)=>{if(!A)return;x(!0);const le=new Set(A.enabledModels??[]);ae?le.add(ne):le.delete(ne);const Se=Array.from(le);try{await s(A.id,{enabledModels:Se}),ke.success(ae?"Model enabled successfully!":"Model disabled successfully!")}catch(Ee){ke.error("Failed to update model status."),console.error("Failed to save model toggle:",Ee)}finally{x(!1)}},[A,s]),D=E.useCallback(async()=>{y(!0),S(!0);try{await new Promise(ae=>setTimeout(ae,800));const ne=await l({title:"New Chat"});await c(ne,"conversation"),ke.success("Welcome to your first chat!")}catch(ne){ke.error("Failed to start your first chat."),console.error("Failed to start first chat:",ne),y(!1),S(!1)}},[l,c]),z=()=>{Ae.emit(Ir.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},$=[_,k,T].filter(Boolean).length,Y=o?3:2,B=$/Y*100,G=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(af,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(af,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(af,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(af,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(af,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(af,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:_,content:f.jsx(fO,{onSave:q,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:j}),icon:f.jsx(Fw,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:k,content:f.jsx(Pie,{apiKeys:e,onAddProvider:I,onCancel:()=>{},initialType:j,initialName:F,initialApiKeyId:P}),icon:f.jsx($y,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(A==null?void 0:A.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:T,content:A?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx(I6,{providerId:A.id,allAvailableModels:R,enabledModelIds:M,onToggleModel:V,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(No,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Pb,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(Fu.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(ub,{value:g?void 0:100,className:"h-2"})}),f.jsxs(rt,{onClick:D,disabled:g||!T,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(bve,{className:"mr-2 h-4 w-4"}),g?"Launching...":"Start First Chat"]}),f.jsx(rse,{})]}),contentClassName:"p-4",icon:f.jsx(zve,{className:"h-4 w-4"})}],Z=G.findIndex(ne=>!ne.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(Fu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Zr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Zr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Zr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Zr,{className:"h-20 w-full mb-6"}),f.jsx(Zr,{className:"h-20 w-full mb-6"}),f.jsx(Zr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(Fu.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(OVe,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(FVe,{})]}),f.jsxs(Fu.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(Er,{children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(ub,{value:B,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(B),"%"]})]})}),f.jsx(Nr,{children:f.jsxs("p",{children:["Steps completed: ",$," of ",Y]})})]})}),G.map((ne,ae)=>{const le=ae===Z;return f.jsx(Fu.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:ae*.1,duration:.3},children:f.jsx(YVe,{stepNumber:ae+1,title:ne.title,description:ne.description,isComplete:ne.id!=="start-chat"&&ne.isComplete,isActive:le,openOnComplete:ne.id==="enable-models",contentClassName:ne.id==="add-provider"||ne.id==="api-key"?"p-0 border-none shadow-none bg-transparent":ne.contentClassName,icon:ne.icon,children:ne.content})},ne.id)})]}),!a&&!k&&Z===-1&&f.jsxs(Fu.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(No,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(rt,{variant:"outline",size:"sm",onClick:z,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},m2=["conversation.title_generation","conversation.compact"],XVe=({conversationId:e,interactions:t,status:n,className:r})=>{const s=E.useRef(null),i=E.useRef(null),[a,o]=E.useState(!1),l=E.useRef(null),c=en(I=>I.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=gr(pn(I=>({chatMaxWidth:I.chatMaxWidth,autoScrollInterval:I.autoScrollInterval,enableAutoScrollOnStream:I.enableAutoScrollOnStream}))),p=gr(I=>I.setEnableAutoScrollOnStream),g=E.useMemo(()=>I=>({isLoading:I.isLoading}),[]),y=E.useMemo(()=>I=>({conversationCount:I.conversations.length,isConversationLoading:I.isLoading}),[]),{isLoading:v}=Gn(pn(g)),{conversationCount:x,isConversationLoading:w}=On(pn(y)),{projectCount:S,isProjectLoading:_}=no(pn(I=>({projectCount:I.projects.length,isProjectLoading:I.isLoading}))),k=E.useMemo(()=>v||w||_?!1:x===0&&S===0,[x,S,v,w,_]),T=E.useMemo(()=>t.filter(D=>D.parentId===null&&!m2.includes(D.type)).sort((D,z)=>D.index-z.index).map(D=>{const z=t.filter($=>$.parentId===D.id&&!m2.includes($.type)).sort(($,Y)=>$.index-Y.index);return[D,...z]}),[t]),A=Ni(pn(I=>Object.values(I.canvasControls))),R=E.useCallback((I,V,D,z)=>A.filter(Y=>{const B=Y.type===I,G=Y.targetSlot===V,Z=!!Y.renderer;return B&&G&&Z}).map(Y=>{if(Y.renderer){const G={...{interaction:D,interactionId:D==null?void 0:D.id,responseContent:typeof(D==null?void 0:D.response)=="string"?D.response:void 0,canvasContextType:I},...z};return f.jsx(We.Fragment,{children:Y.renderer(G)},Y.id)}return null}).filter(Boolean),[A]),M=(I="smooth")=>{if(i.current){i.current.scrollTo({top:i.current.scrollHeight,behavior:I});return}if(s.current){const V=s.current.querySelector("[data-radix-scroll-area-viewport]");if(V){i.current=V,V.scrollTo({top:V.scrollHeight,behavior:I});return}}s.current&&s.current.scrollTo({top:s.current.scrollHeight,behavior:I})};E.useEffect(()=>{if(i.current){const{scrollHeight:I,clientHeight:V,scrollTop:D}=i.current;(I-V<=D+150||n!=="streaming")&&requestAnimationFrame(()=>{M(n==="streaming"?"smooth":"auto")})}},[T.length,n,c]),E.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{M("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),E.useEffect(()=>{const I=i.current;if(!I)return;const V=()=>{if(!i.current)return;const{scrollHeight:D,clientHeight:z,scrollTop:$}=i.current,Y=$<D-z-z*.5;o(Y)};return I.addEventListener("scroll",V,{passive:!0}),V(),()=>{i.current&&i.current.removeEventListener("scroll",V)}},[]),E.useEffect(()=>{if(s.current){const I=s.current.querySelector("[data-radix-scroll-area-viewport]");I&&(i.current=I)}},[]);const j=E.useMemo(()=>{const I=[];return[...t].sort((z,$)=>{var Y,B;return z.index!==$.index?z.index-$.index:z.parentId===null&&$.parentId!==null?-1:z.parentId!==null&&$.parentId===null?1:z.parentId!==null&&$.parentId!==null&&z.parentId===$.parentId?z.index-$.index:(((Y=z.startedAt)==null?void 0:Y.getTime())??0)-(((B=$.startedAt)==null?void 0:B.getTime())??0)}).filter(z=>z.parentId===null&&!m2.includes(z.type)).forEach(z=>{var G,Z;let $=null;if(z.type==="message.user_assistant"&&z.prompt)$=z.prompt;else if(z.type==="message.workflow_step"&&z.prompt)$=z.prompt;else if(z.type==="message.assistant_regen"&&((G=z.metadata)!=null&&G.regeneratedFromId)){let ne,ae=z;const le=new Set;for(;ae&&!le.has(ae.id);){if(le.add(ae.id),ae.type==="message.user_assistant"&&ae.prompt){ne=ae;break}if((Z=ae.metadata)!=null&&Z.regeneratedFromId)ae=t.find(Se=>Se.id===ae.metadata.regeneratedFromId);else break}ne?$=ne.prompt:z.prompt?$=z.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${z.id} of type ${z.type}. Displaying turn without prompt.`)}if($)I.push(f.jsx(x1,{turnData:$,timestamp:z.startedAt,isAssistantComplete:z.status==="COMPLETED"||z.status==="ERROR",interactionId:z.id},`prompt-${z.id}`));else if(z.type!=="message.user_assistant"&&z.type!=="message.assistant_regen"&&z.type!=="message.workflow_step"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",z.id,z.type);return}const Y=t.filter(ne=>ne.parentId===z.id&&!m2.includes(ne.type)).sort((ne,ae)=>ne.index-ae.index),B=[z,...Y];B.length>0&&I.push(f.jsx(Vze,{interactionGroup:B,renderSlot:(ne,ae,le)=>R("interaction",ne,ae,le),activeStreamingInteractionId:c.find(ne=>B.some(ae=>ae.id===ne))},`tabs-${z.id}`))}),I},[t,R,c]),F=E.useMemo(()=>c.filter(I=>!t.some(V=>V.id===I)).map(I=>f.jsx(_E,{interactionId:I,renderSlot:(V,D,z)=>R("interaction",V,D,z)},`${I}-streaming-new`)),[c,t,R]),P=()=>v||w||_?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Zr,{className:"h-24 w-full"}),f.jsx(Zr,{className:"h-32 w-full"}),f.jsx(Zr,{className:"h-20 w-full"})]}):e?T.length===0&&n!=="streaming"&&c.length===0?f.jsx(rV,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[j,F]}):f.jsx(rV,{}),q=u||"max-w-7xl";return f.jsx("div",{className:Ye("flex-grow relative",r),children:k?f.jsx(ul,{className:"h-full w-full",children:f.jsx("div",{className:Ye("mx-auto w-full",q),children:f.jsx(ZVe,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(ul,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Ye("mx-auto w-full",q),children:P()})}),a&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-[var(--z-sticky)] h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>M(),"aria-label":"Scroll to bottom",children:f.jsx(aY,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-[var(--z-sticky)] h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>p(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(Ive,{className:"h-4 w-4"}):f.jsx(OD,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},JVe=We.memo(XVe),q0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Ye(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(We.Fragment,{children:a?a():null},i.id)})})},B1=Do(Fo((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Ae.emit(Ir.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Ae.emit(Ir.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Ae.emit(Ir.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Ae.emit(Ir.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Ae.emit(Ir.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Ae.emit(Ir.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Ir.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Ir.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Ir.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Ir.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Ir.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Ir.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var QVe=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(p){(Array.isArray(e)?e:[e]).forEach(g=>{let y=g==="class",v=y&&i?s.map(x=>i[x]||x):s;y?(l.classList.remove(...v),l.classList.add(i&&i[p]?i[p]:p)):l.setAttribute(g,p)}),d(p)}function d(p){o&&c.includes(p)&&(l.style.colorScheme=p)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let p=localStorage.getItem(t)||n,g=a&&p==="system"?h():p;u(g)}catch{}},eWe=E.createContext(void 0),tWe={setTheme:e=>{},themes:[]},nWe=()=>{var e;return(e=E.useContext(eWe))!=null?e:tWe};E.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return E.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${QVe.toString()})(${u})`}})});const rWe=({...e})=>{const{theme:t="system"}=nWe();return f.jsx(bwe,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})},Die=E.memo(E.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=E.useRef(null),[c,u]=E.useState(e);E.useImperativeHandle(o,()=>({getValue:()=>c,setValue:p=>{u(p),i&&i(p),Ae.emit(an.inputChanged,{value:p}),requestAnimationFrame(()=>{const g=l.current;g&&(g.style.height="auto",g.style.height=`${g.scrollHeight}px`,g.style.overflowY=g.scrollHeight>250?"auto":"hidden")})},focus:()=>{var p;return(p=l.current)==null?void 0:p.focus()},clearValue:()=>{u(""),i&&i(""),Ae.emit(an.inputChanged,{value:""}),requestAnimationFrame(()=>{const p=l.current;p&&(p.style.height="auto",p.style.height=`${p.scrollHeight}px`,p.style.overflowY="hidden")})}}));const d=p=>{var g;if(p.key==="Enter"&&!p.shiftKey&&!n){p.preventDefault();const y=Qh.getState().attachedFilesMetadata.length>0;(c.trim().length>0||y)&&(t(),(g=o==null?void 0:o.current)==null||g.clearValue())}},h=p=>{const g=p.target.value;u(g),i&&i(g),Ae.emit(an.inputChanged,{value:g})};return E.useEffect(()=>{const p=l.current;if(p){p.style.height="auto";const g=p.scrollHeight,y=250;p.style.height=`${Math.min(g,y)}px`,p.style.overflowY=g>y?"auto":"hidden"}},[c]),E.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),E.useEffect(()=>{const p=g=>{u(g.text),i&&i(g.text),Ae.emit(an.inputChanged,{value:g.text}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})};return Ae.on(an.setInputTextRequest,p),()=>{Ae.off(an.setInputTextRequest,p)}},[i]),f.jsx(Mi,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Ye("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));Die.displayName="InputArea";const Ui={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},pp=Do(Fo((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await dt.loadMods();e({dbMods:n,isLoading:!1}),Ae.emit(Ui.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Ae.emit(Ui.loadingStateChanged,{isLoading:!1,error:r}),ke.error(r)}},addDbMod:async n=>{const r=dr(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await dt.saveMod(s),ke.success(`Mod "${s.name}" added.`),Ae.emit(Ui.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Ae.emit(Ui.loadingStateChanged,{isLoading:t().isLoading,error:a}),ke.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await dt.saveMod(a),ke.success(`Mod "${a.name}" updated.`),Ae.emit(Ui.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Ae.emit(Ui.loadingStateChanged,{isLoading:t().isLoading,error:l}),ke.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await dt.deleteMod(n),ke.success(`Mod "${s}" deleted.`),Ae.emit(Ui.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Ae.emit(Ui.loadingStateChanged,{isLoading:t().isLoading,error:a}),ke.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Ae.emit(Ui.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Ae.emit(Ui.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Ae.emit(Ui.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Ui.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:Ui.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:Ui.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:Ui.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),Lp={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function hO(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Ae.emit(Wr.registerPromptControlRequest,{control:s}),()=>Ae.emit(Wr.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Ae.emit(Wr.registerChatControlRequest,{control:i}),()=>Ae.emit(Wr.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Ae.emit(Wr.registerCanvasControlRequest,{control:s}),()=>Ae.emit(Wr.unregisterCanvasControlRequest,{id:s.id})),registerBlockRenderer:s=>(Ae.emit(ey.registerBlockRendererRequest,{renderer:s}),()=>Ae.emit(ey.unregisterBlockRendererRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Ae.emit(Wr.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Ae.emit(Wr.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Ae.on(s,i),()=>Ae.off(s,i)),emit:(s,i)=>{Ae.emit(s,i)},addMiddleware:(s,i)=>(Ae.emit(Wr.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Ae.emit(Wr.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(pp.getState()._addSettingsTab(s),()=>pp.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=en.getState(),i=On.getState(),a=gr.getState(),o=Gn.getState(),{providerId:l}=uc(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{ke[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Ae.emit(Wr.registerModalProviderRequest,{modalId:s,provider:i}),()=>Ae.emit(Wr.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>oi.getState().initializeVFS(s,{force:!0})}}async function sWe(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=hO(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),ke.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=hO(r));const o={id:r.id,name:r.name,api:i,error:a};return Ae.emit(o.error?Ui.modError:Ui.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Ae.emit(Lp.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const _r={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},CW=null;class iWe{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return CW!==null}static getBundledConfig(){return CW}}class z1{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){ke.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=On.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Ae.emit(gs.bulkSyncStarted,{progress:a}),ke.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;Ae.emit(gs.bulkSyncCompleted,{progress:a,success:!o}),o?(ke.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):ke.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),ke.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Ae.emit(gs.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=On.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){ke.info("No conversations need syncing");return}ke.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=On.getState().syncRepos;if(n.length===0){ke.info("No repositories configured");return}ke.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),ke.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",Ae.emit(gs.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Ae.emit(gs.bulkSyncProgress,{progress:r}),await On.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Ae.emit(gs.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",Ae.emit(gs.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Ae.emit(gs.bulkSyncProgress,{progress:r}),await On.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Ae.emit(gs.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}ue(z1,"isRunning",!1),ue(z1,"abortController",null);const Cy=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:z1},Symbol.toStringTag,{value:"Module"}));class Fie{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=On.getState(),n=gr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await z1.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await z1.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}ue(Fie,"hasRunStartupSync",!1);function aWe(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),ke.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),ke.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function oWe(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await iWe.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(on.loadSettingsRequest,void 0),t.emit($n.loadInitialDataRequest,void 0),t.emit(_r.loadRulesAndTagsRequest,void 0),t.emit(rr.loadConversationsRequest,void 0),t.emit(Da.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(on.loaded,()=>{r=!0,c(),l()}),u=t.on($n.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(_r.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(rr.conversationsLoaded,()=>{a=!0,h(),l()}),p=t.on(Da.loaded,()=>{o=!0,p(),l()})}),Ae.emit(Lp.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{Fie.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function lWe(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=aWe(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),ke.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Ae.emit(Lp.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function cWe(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),ke.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Ae.emit(Lp.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function uWe(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(Ui.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(Ui.dbModsLoaded,()=>{i(),s()})});const n=pp.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await sWe(n);pp.getState().setLoadedMods(r),Ae.emit(Lp.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function dWe(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(an.initializePromptStateRequest,{effectiveSettings:i}),Ae.emit(Lp.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function fWe(e,t){console.log("[Init] LiteChat Full Initialization START"),Rl.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(on.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit($n.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(_r.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(rr.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(Da.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(Ui.loadDbModsRequest,void 0),setLoadedMods:pp.getState().setLoadedMods,getConversationById:On.getState().getConversationById,getEffectiveProjectSettings:no.getState().getEffectiveProjectSettings,initializePromptState:Qa.getState().initializePromptState,selectedItemId:On.getState().selectedItemId,selectedItemType:On.getState().selectedItemType};let r=[];try{await oWe(n,t),r=await lWe(e,t),cWe(r,t),await uWe(n,t),dWe(n,t),Ae.emit(Lp.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),ke.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),B1.getState().setGlobalError("Initialization sequence failed."),s}return r}const Lie=Do(Fo((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([dt.loadRules(),dt.loadTags(),dt.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Ae.emit(_r.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),ke.error("Failed to load rules and tags."),Ae.emit(_r.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=dr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await dt.saveRule(i),ke.success(`Rule "${i.name}" added.`),Ae.emit(_r.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),ke.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw ke.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await dt.saveRule(i),ke.success(`Rule "${i.name}" updated.`),Ae.emit(_r.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),ke.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw ke.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await dt.deleteRule(n),ke.success(`Rule "${r.name}" deleted.`),Ae.emit(_r.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),ke.error("Failed to delete rule."),a}},addTag:async n=>{const r=dr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await dt.saveTag(i),ke.success(`Tag "${i.name}" added.`),Ae.emit(_r.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),ke.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw ke.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await dt.saveTag(i),ke.success(`Tag "${i.name}" updated.`),Ae.emit(_r.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),ke.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw ke.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await dt.deleteTag(n),ke.success(`Tag "${r.name}" deleted.`),Ae.emit(_r.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),ke.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){ke.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await dt.saveTagRuleLink(i),ke.success("Tag linked to rule."),_r.linkSaved&&Ae.emit(_r.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),ke.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||ke.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await dt.deleteTagRuleLink(s),ke.success("Tag unlinked from rule."),_r.linkDeleted&&Ae.emit(_r.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Ae.emit(_r.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),ke.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:_r.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:_r.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:_r.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:_r.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:_r.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:_r.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:_r.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:_r.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:_r.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),Fa={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"};function QA(e,t){if(e==null)return e;switch(t){case"number":const n=parseFloat(e);return isNaN(n)?void 0:n;case"boolean":return String(e).toLowerCase()==="true";case"array":if(Array.isArray(e))return e;try{const r=JSON.parse(e);return Array.isArray(r)?r:[String(e)]}catch{return String(e).split(",").map(r=>r.trim())}case"string":default:return String(e)}}function hWe(e,t){return e.replace(/\{\{\s*([\w_.-]+)\s*\}\}/g,(n,r)=>{const s=t[r];return s==null?n:Array.isArray(s)?s.map(i=>i===null?"null":typeof i=="object"?JSON.stringify(i):String(i)).join(", "):typeof s=="object"?JSON.stringify(s):String(s)})}async function $ie(e,t){const n=e.variables||[],r={...t};for(const o of n){let l=r[o.name];if(l==null&&o.default!==void 0&&(l=QA(o.default,o.type),r[o.name]=l),o.required){if(l==null||l==="")throw new Error(`Required variable "${o.name}" is missing or empty.`);if(Array.isArray(l)&&l.length===0)throw new Error(`Required variable "${o.name}" cannot be an empty array.`)}}const s=hWe(e.prompt,r),i=e.tools||[],a=e.rules||[];return{content:s,selectedTools:i,selectedRules:a}}const tl=Do(Fo((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await dt.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),Ae.emit(Fa.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),ke.error(r)}},addPromptTemplate:async n=>{const r={id:dr(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await dt.savePromptTemplate(r),Ae.emit(Fa.promptTemplateAdded,{promptTemplate:r}),ke.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),ke.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){ke.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await dt.savePromptTemplate(i),Ae.emit(Fa.promptTemplateUpdated,{promptTemplate:i}),ke.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),ke.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){ke.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await dt.deletePromptTemplate(n),Ae.emit(Fa.promptTemplateDeleted,{id:n}),ke.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),ke.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{return await $ie(s,r)}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw ke.error(a),i}},getTemplatesByType:n=>t().promptTemplates.filter(r=>(r.type||"prompt")===n),getAgents:()=>t().promptTemplates.filter(n=>(n.type||"prompt")==="agent"),getTasksForAgent:n=>t().promptTemplates.filter(r=>(r.type||"prompt")==="task"&&r.parentId===n),getAvailableFollowUps:(n,r)=>{const s=t().promptTemplates,i=s.find(a=>a.id===n);return r==="task"&&(i!=null&&i.parentId)?s.filter(a=>(a.type||"prompt")==="task"&&a.parentId===i.parentId&&a.id!==n):s.filter(a=>(a.type||"prompt")==="prompt"&&a.id!==n)},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Fa.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:Fa.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:Fa.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:Fa.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:Fa.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),Rr={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},Qx=3,ew=2e3,tw=1e4,nw=128e3,pWe={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:Qx,retryDelay:ew,connectionTimeout:tw,maxResponseSize:nw,bridgeConfig:{}},Tl=Do(Fo((e,t)=>({...pWe,setServers:n=>{e(r=>{r.servers=n,r.error=null}),dt.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),Ae.emit(Rr.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;dt.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),Ae.emit(Rr.serverAdded,{server:r}),Ae.emit(Rr.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;dt.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),Ae.emit(Rr.serverUpdated,{server:s}),Ae.emit(Rr.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;dt.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),Ae.emit(Rr.serverDeleted,{serverId:n}),Ae.emit(Rr.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),Ae.emit(Rr.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&Ae.emit(Rr.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),Ae.emit(Rr.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),dt.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),Ae.emit(Rr.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),dt.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),Ae.emit(Rr.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),dt.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),Ae.emit(Rr.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),dt.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),Ae.emit(Rr.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),dt.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),Ae.emit(Rr.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([dt.loadSetting("mcpServers",[]),dt.loadSetting("mcpRetryAttempts",Qx),dt.loadSetting("mcpRetryDelay",ew),dt.loadSetting("mcpConnectionTimeout",tw),dt.loadSetting("mcpMaxResponseSize",nw),dt.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),Ae.emit(Rr.serversChanged,{servers:n||[]}),Ae.emit(Rr.retryAttemptsChanged,{attempts:r}),Ae.emit(Rr.retryDelayChanged,{delay:s}),Ae.emit(Rr.connectionTimeoutChanged,{timeout:i}),Ae.emit(Rr.maxResponseSizeChanged,{size:a}),Ae.emit(Rr.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=Qx,n.retryDelay=ew,n.connectionTimeout=tw,n.maxResponseSize=nw,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([dt.saveSetting("mcpServers",[]),dt.saveSetting("mcpRetryAttempts",Qx),dt.saveSetting("mcpRetryDelay",ew),dt.saveSetting("mcpConnectionTimeout",tw),dt.saveSetting("mcpMaxResponseSize",nw)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),Ae.emit(Rr.serversChanged,{servers:[]}),Ae.emit(Rr.retryAttemptsChanged,{attempts:Qx}),Ae.emit(Rr.retryDelayChanged,{delay:ew}),Ae.emit(Rr.connectionTimeoutChanged,{timeout:tw}),Ae.emit(Rr.maxResponseSizeChanged,{size:nw})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Rr.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:Rr.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:Rr.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:Rr.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:Rr.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:Rr.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:Rr.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:Rr.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:Rr.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:Rr.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),mWe=[gr,Gn,Lie,On,no,en,Qh,Qa,pp,B1,oi,Ni,tl,Tl,xy];class Bie{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];mWe.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Ae.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}ue(Bie,"isInitialized",!1);const gWe=()=>{const[e,t]=E.useState({}),n=Ni(r=>r.modalProviders);return E.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Ae.emit(Ir.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Ae.emit(Ir.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Ae.on(Ir.openModalRequest,r),Ae.on(Ir.closeModalRequest,s),()=>{Ae.off(Ir.openModalRequest,r),Ae.off(Ir.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Ae.emit(Ir.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})};class ki extends Error{constructor(n,r="UNKNOWN_ERROR",s={}){super(ki.formatMessage(n,r,s));ue(this,"code");ue(this,"context");ue(this,"timestamp");ue(this,"isWorkflowError",!0);this.name="WorkflowError",this.code=r,this.context=s,this.timestamp=new Date().toISOString(),Error.captureStackTrace&&Error.captureStackTrace(this,ki)}static fromError(n,r="UNKNOWN_ERROR",s={}){if(n instanceof ki)return new ki(n.message,n.code,{...n.context,...s});const i=n instanceof Error?n.message:String(n),a=new ki(i,r,s);return n instanceof Error&&n.stack&&(a.stack=n.stack),a}static formatMessage(n,r,s){const i=[`[${r}] ${n}`];if(s.runId&&i.push(`(Run: ${s.runId})`),s.stepId||s.stepIndex!==void 0){const a=s.stepId?`Step: ${s.stepId}`:`Step[${s.stepIndex}]`;i.push(`(${a})`)}return i.join(" ")}getUserMessage(){switch(this.code){case"TEMPLATE_NOT_FOUND":return"Template not found. Please check that the selected template still exists.";case"MODEL_NOT_AVAILABLE":return"The selected AI model is not available. Please check your model configuration.";case"TEMPLATE_COMPILATION_FAILED":return"Failed to compile template. Please check template variables and format.";case"TRANSFORM_STEP_FAILED":return"Data transformation failed. Please check your JSONPath queries.";case"JSONPATH_INVALID":return`Invalid JSONPath query: "${this.context.query}". Please check the syntax.`;case"OUTPUT_PARSING_FAILED":return"Failed to parse AI response. The output format may be incorrect.";case"CONVERSATION_NOT_FOUND":return"Conversation not found. Please ensure you have an active conversation.";default:return this.message}}getDebugInfo(){return{message:this.message,code:this.code,context:this.context,timestamp:this.timestamp,stack:this.stack}}toJSON(){return{name:this.name,message:this.message,code:this.code,context:this.context,timestamp:this.timestamp}}}class yWe{generateInitialFlow(t){console.log("[WorkflowFlowGenerator] Generating initial flow for run:",{runId:t.runId,templateName:t.template.name,stepCount:t.template.steps.length});const n={type:"workflow",name:t.template.name,nodes:[{id:"initial",type:"trigger",label:"User Input",position:{x:0,y:0},status:"running",data:{modelName:"Default Model",templateName:"Initial Processing"}},...t.template.steps.map((s,i)=>({id:s.id,type:s.type,label:s.name||`Step ${i+1}`,position:{x:(i+1)*400,y:0},status:"pending",data:s.type==="transform"?{transformType:"Data Transform"}:{modelName:this.getModelName(s.modelId),templateName:this.getTemplateName(s.templateId)}}))],edges:this.generateEdges(t.template.steps),metadata:{runId:t.runId,startedAt:t.startedAt,currentStep:"initial",totalSteps:t.template.steps.length}},r=JSON.stringify(n,null,2);return console.log("[WorkflowFlowGenerator] Generated flow JSON:",{jsonLength:r.length,nodeCount:n.nodes.length,edgeCount:n.edges.length,jsonPreview:r.substring(0,300)+(r.length>300?"...":"")}),r}updateNodeStatus(t,n,r){try{const s=JSON.parse(t),i=s.nodes.findIndex(a=>a.id===n);return i!==-1&&(s.nodes[i]={...s.nodes[i],status:r},s.edges=s.edges.map(a=>({...a,animated:this.shouldAnimateEdge(a,s.nodes)})),s.metadata&&(s.metadata.currentStep=n,s.metadata.lastUpdated=new Date().toISOString())),JSON.stringify(s,null,2)}catch(s){return console.error("Failed to update node status:",s),t}}addStepOutput(t,n,r){try{const s=JSON.parse(t),i=s.nodes.findIndex(a=>a.id===n);return i!==-1&&(s.nodes[i]={...s.nodes[i],data:{...s.nodes[i].data,output:r,hasOutput:!0}},s.metadata&&(s.metadata.stepOutputs||(s.metadata.stepOutputs={}),s.metadata.stepOutputs[n]=r)),JSON.stringify(s,null,2)}catch(s){return console.error("Failed to add step output:",s),t}}finalizeWorkflow(t,n){try{const r=JSON.parse(t);return r.nodes=r.nodes.map(s=>({...s,status:s.status==="error"?"error":"success"})),r.edges=r.edges.map(s=>({...s,animated:!1})),r.metadata&&(r.metadata.status="completed",r.metadata.completedAt=new Date().toISOString(),r.metadata.finalOutput=n),JSON.stringify(r,null,2)}catch(r){return console.error("Failed to finalize workflow:",r),t}}getModelName(t){if(!t)return"Default Model";try{const s=Gn.getState().getGloballyEnabledModelDefinitions().find(i=>i.id===t);return(s==null?void 0:s.name)||t}catch{return t}}getTemplateName(t){if(!t)return"No Template";try{const{promptTemplates:n}=tl.getState(),r=n.find(s=>s.id===t);return(r==null?void 0:r.name)||"Unknown Template"}catch{return"Unknown Template"}}generateEdges(t){const n=[];t.length>0&&n.push({id:`initial-${t[0].id}`,source:"initial",target:t[0].id,animated:!0,type:"smoothstep",style:{stroke:"#1f2937",strokeWidth:2}});for(let r=0;r<t.length-1;r++){const s=t[r],i=t[r+1];n.push({id:`${s.id}-${i.id}`,source:s.id,target:i.id,animated:!1,type:"smoothstep",style:{stroke:"#1f2937",strokeWidth:2}})}return n}shouldAnimateEdge(t,n){const r=n.find(i=>i.id===t.source),s=n.find(i=>i.id===t.target);return(r==null?void 0:r.status)==="running"||(r==null?void 0:r.status)==="success"&&(s==null?void 0:s.status)==="running"}createFlowFromWorkflowState(t,n){var s;const r={type:"workflow",name:t.template.name,nodes:[{id:"initial",type:"trigger",label:"User Input",position:{x:0,y:0},status:n.initial||"completed",data:{modelName:"Default Model",templateName:"Initial Processing"}},...t.template.steps.map((i,a)=>({id:i.id,type:i.type,label:i.name||`Step ${a+1}`,position:{x:(a+1)*400,y:0},status:n[i.id]||"pending",data:i.type==="transform"?{transformType:"Data Transform"}:{modelName:this.getModelName(i.modelId),templateName:this.getTemplateName(i.templateId)}}))],edges:[],metadata:{runId:t.runId,startedAt:t.startedAt,currentStep:t.currentStepIndex>=0?(s=t.template.steps[t.currentStepIndex])==null?void 0:s.id:"initial",totalSteps:t.template.steps.length,stepOutputs:t.stepOutputs}};return r.edges=this.generateEdges(t.template.steps).map(i=>({...i,animated:this.shouldAnimateEdge(i,r.nodes)})),JSON.stringify(r,null,2)}}const jr={isInitialized:!1,activeWorkflowConfig:null,flowGenerator:new yWe,_extractFlowContent:e=>{const t=e.match(/```flow\n([\s\S]*?)\n```/);return{fullMatch:(t==null?void 0:t[0])||"",flowContent:(t==null?void 0:t[1])||"",hasFlow:!!t}},_updateFlowInContent:(e,t)=>jr._extractFlowContent(e).hasFlow?e.replace(/```flow\n[\s\S]*?\n```/,`\`\`\`flow
${t}
\`\`\``):e,_updateStepStatusInFlow:(e,t)=>{const n=jr._extractFlowContent(e);if(n.hasFlow){const r=jr.flowGenerator.updateNodeStatus(n.flowContent,t.stepId,t.status);return jr._updateFlowInContent(e,r)}return e},_addStepOutputToFlow:(e,t,n)=>{const r=jr._extractFlowContent(e);if(r.hasFlow){const s=jr.flowGenerator.addStepOutput(r.flowContent,t,n);return jr._updateFlowInContent(e,s)}return e},_finalizeFlowVisualization:(e,t)=>{const n=jr._extractFlowContent(e);if(n.hasFlow){const r=jr.flowGenerator.finalizeWorkflow(n.flowContent,t);return jr._updateFlowInContent(e,r)}return e},initialize:()=>{jr.isInitialized||(Ae.on(as.startRequest,jr.handleWorkflowStartRequest),Ae.on(xn.completed,jr.handleInteractionCompleted),Ae.on(as.stepCompleted,jr.handleStepCompleted),Ae.on(as.resumeRequest,jr.handleWorkflowResumeRequest),jr.isInitialized=!0,console.log("[WorkflowService] Initialized - workflows start immediately on request."))},_resolveJsonPath:(e,t)=>{t.startsWith("$.")&&(t=t.substring(2));try{return t.split(".").reduce((n,r)=>{if(n!=null){if(r.includes("[")&&r.includes("]")){const s=r.match(/^([^[]*)/),i=s?s[1]:"",a=r.match(/\[(\d+)\]/g);if(!a)return;let o=i?n[i]:n;for(const l of a){const c=l.slice(1,-1),u=parseInt(c,10);if(isNaN(u)||o===null||o===void 0)return;o=o[u]}return o}return n[r]}},e)}catch(n){console.warn(`[WorkflowService] JSONPath resolution failed for ${t}:`,n);return}},_validateJsonQuery:(e,t)=>{if(!e.trim())return{isValid:!1,error:"Query cannot be empty"};if(e.startsWith('"')&&e.endsWith('"'))return{isValid:!0,result:e.slice(1,-1)};if(!isNaN(Number(e)))return{isValid:!0,result:Number(e)};if(e==="true"||e==="false")return{isValid:!0,result:e==="true"};if(!e.startsWith("$."))return{isValid:!1,error:'Query must start with "$." or be a static value ("text", number, true/false)'};if(/[^a-zA-Z0-9_.$\[\]]/.test(e.replace(/\[(\d+)\]/g,"")))return{isValid:!1,error:"Invalid characters in query"};try{return{isValid:!0,result:jr._resolveJsonPath(t,e)}}catch(r){return{isValid:!1,error:`Query execution failed: ${r instanceof Error?r.message:"Unknown error"}`}}},_buildTransformContext:(e,t)=>{const n=[];e.stepOutputs.trigger&&(n[0]=e.stepOutputs.trigger);for(let s=0;s<t;s++){const i=e.template.steps[s];i&&e.stepOutputs[i.id]?n[s+1]=e.stepOutputs[i.id]:console.warn(`[WorkflowService] No output found for step at index ${s} (${i==null?void 0:i.id})`)}return{workflow:e.template,initial_step:e.stepOutputs.trigger||{},outputs:n}},_executeTransformStep:async(e,t,n)=>{var u;const r=n+1,s=e.template.steps[r];if(!s)throw new ki(`Transform step "${t.name}" has no following step to provide data for`,"STEP_NOT_FOUND",{runId:e.runId,stepId:t.id,stepIndex:n,stepType:"transform"});if((s.type==="prompt"||s.type==="agent-task")&&!s.templateId)throw new ki(`Transform step "${t.name}" has following step "${s.name}" (type: ${s.type}) that requires a template but has no templateId`,"TEMPLATE_NOT_FOUND",{runId:e.runId,stepId:t.id,stepIndex:n,stepType:"transform",nextStepType:s.type});let a;if((s.type==="prompt"||s.type==="agent-task")&&s.templateId&&(a=await dt.loadPromptTemplateById(s.templateId)),!((u=a==null?void 0:a.variables)!=null&&u.length)){console.warn(`[WorkflowService] Transform step "${t.name}": Next step "${s.name}" (type: ${s.type}) has no template variables. Passing raw output from previous step.`);const d=jr._buildTransformContext(e,n);return d.outputs[d.outputs.length-1]||d.initial_step}const o=jr._buildTransformContext(e,n),l={},c=t.transformMappings||{};for(const d of a.variables){const h=d.name,p=c[h];if(!p){console.warn(`[WorkflowService] Transform step "${t.name}": No mapping configured for field "${h}"`);continue}try{let g;if(p.startsWith('"')&&p.endsWith('"'))g=p.slice(1,-1);else if(!isNaN(Number(p)))g=Number(p);else if(p==="true"||p==="false")g=p==="true";else if(p.startsWith("$."))g=jr._resolveJsonPath(o,p),g===void 0&&console.warn(`[WorkflowService] Transform step "${t.name}": Query "${p}" for field "${h}" returned undefined`);else throw new ki(`Invalid query format: "${p}". Must be a JSON path starting with "$." or a static value.`,"JSONPATH_INVALID",{runId:e.runId,stepId:t.id,stepIndex:n,stepType:"transform",query:p});l[h]=g}catch(g){const y=ki.fromError(g,"TRANSFORM_STEP_FAILED",{runId:e.runId,stepId:t.id,stepIndex:n,stepType:"transform",query:p,expectedFields:[h]});throw console.error(`[WorkflowService] Transform error for field "${h}":`,y),y}}return l},_compileStepPrompt:async(e,t,n)=>{if(!e.templateId)throw new ki(`Step "${e.name}" has no templateId specified`,"TEMPLATE_NOT_FOUND",{runId:t.runId,stepId:e.id,stepIndex:n,stepType:e.type});const r=await dt.loadPromptTemplateById(e.templateId);if(!r)throw new ki(`Template "${e.templateId}" not found for step "${e.name}"`,"TEMPLATE_NOT_FOUND",{runId:t.runId,stepId:e.id,stepIndex:n,stepType:e.type,templateId:e.templateId});let s={};if(n===0)s=t.stepOutputs.trigger||{};else{const i=n-1,a=t.template.steps[i];a&&t.stepOutputs[a.id]?s=t.stepOutputs[a.id]:console.warn(`[WorkflowService] No output found for previous step at index ${i}`)}try{return await $ie(r,s)}catch(i){throw ki.fromError(i,"TEMPLATE_COMPILATION_FAILED",{runId:t.runId,stepId:e.id,stepIndex:n,stepType:e.type,templateId:e.templateId})}},_parseStepOutput:(e,t)=>{var n,r;if(!t.structuredOutput)return e.response||"No output";if((r=(n=e.metadata)==null?void 0:n.toolCalls)!=null&&r.length)try{const s=JSON.parse(e.metadata.toolCalls[0]);if(s.toolName==="structured_output"||s.name==="structured_output")return s.arguments||s.args}catch{}try{const s=/```json\s*([\s\S]*?)\s*```/,i=(e.response??"").match(s);return i!=null&&i[1]?JSON.parse(i[1]):JSON.parse(e.response??"{}")}catch{throw new Error("Could not parse structured output from response")}},handleWorkflowStartRequest:async e=>{console.log("[WorkflowService] Workflow start request received",e);const{template:t,initialPrompt:n,conversationId:r}=e;if(!r)throw new ki("No conversation ID provided for workflow start","CONVERSATION_NOT_FOUND",{templateId:t==null?void 0:t.id});if(!t)throw new ki("No workflow template provided","WORKFLOW_NOT_FOUND");if(!t.steps||t.steps.length===0)throw new ki(`Workflow "${t.name}" has no steps defined`,"WORKFLOW_NOT_FOUND",{templateId:t.id});console.log("[WorkflowService] Starting workflow immediately with initial prompt");const s={id:dr(),content:n,parameters:{},metadata:{modelId:Qa.getState().modelId||void 0}},{promptObject:i}=await jr.buildCompletePromptObject(r,n,s);await jr.handleWorkflowConversion(i,r,{template:t,initialPrompt:n,conversationId:r})},handleWorkflowConversion:async(e,t,n)=>{var r;try{const{template:s}=n;if(!s.steps||s.steps.length===0)throw new Error("Workflow template has no steps");const i=en.getState(),a=e.messages[e.messages.length-1];if(!a||a.role!=="user")throw new Error("Could not find user message in prompt");let o="";typeof a.content=="string"?o=a.content:Array.isArray(a.content)&&(o=a.content.filter(x=>x.type==="text").map(x=>x.text).join(""));const l={id:"",content:o,parameters:e.parameters||{},metadata:{...e.metadata,modelId:((r=e.metadata)==null?void 0:r.modelId)||""}},c=dr(),u=dr(),h=i.interactions.filter(x=>x.conversationId===t).reduce((x,w)=>Math.max(x,w.index),-1)+1,p={id:c,conversationId:t,type:"message.user_assistant",prompt:{id:c,content:o,parameters:{},metadata:{isWorkflowRun:!0,workflowName:s.name,workflowTemplateId:s.id,workflowRunId:u}},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{isWorkflowRun:!0,workflowName:s.name,workflowTemplateId:s.id,workflowRunId:u,toolCalls:[],toolResults:[]},index:h,parentId:null};i._addInteractionToState(p),i._addStreamingId(p.id),i.setActiveStreamBuffer(p.id,`# ${s.name}

Workflow starting with ${s.steps.length} step${s.steps.length>1?"s":""}...`),await dt.saveInteraction(p),Ae.emit(xn.added,{interaction:p}),Ae.emit(xn.started,{interactionId:p.id,conversationId:p.conversationId,type:p.type});const g={runId:u,conversationId:t,mainInteractionId:c,template:s,status:"RUNNING",currentStepIndex:-1,stepOutputs:{},startedAt:new Date().toISOString()},y=jr.flowGenerator.generateInitialFlow(g);console.log("[WorkflowService] Generated initial flow content:",{flowContentLength:y.length,flowContentPreview:y.substring(0,200)+(y.length>200?"...":"")});const v=`# ${s.name}

Workflow starting with ${s.steps.length} step${s.steps.length>1?"s":""}...

\`\`\`flow
${y}
\`\`\``;console.log("[WorkflowService] Setting stream buffer with full content:",{fullContentLength:v.length,mainInteractionId:p.id}),i.setActiveStreamBuffer(p.id,v),await jr.createTriggerStep(p,g,l),Ae.emit(as.started,{run:g,metadata:QC(g.runId,"high",1)})}catch(s){console.error("[WorkflowService] Error during workflow conversion:",s)}},createTriggerStep:async(e,t,n)=>{var r;try{const s=t.template.steps[0],i={...n.parameters};if(s&&s.type!=="transform"&&s.type!=="human-in-the-loop")if(s.templateId){const{promptTemplates:u}=tl.getState(),d=u.find(h=>h.id===s.templateId);if(d&&d.variables&&d.variables.length>0){const{schema:h}=jr._createStructuredOutputSchema(d.variables);i.structured_output=h,console.log(`[WorkflowService] Trigger step will output structured data for step "${s.name}" variables:`,d.variables.map(p=>p.name))}}else s.structuredOutput&&(i.structured_output=s.structuredOutput.jsonSchema,console.log(`[WorkflowService] Trigger step will output structured data for next step: ${s.name}`));else(s==null?void 0:s.type)==="transform"&&console.log(`[WorkflowService] Trigger step will output free-form data for transform step "${s.name}" - no format constraints`);const a={...n,id:dr(),parameters:i,metadata:{...n.metadata,modelId:((r=n.metadata)==null?void 0:r.modelId)||Qa.getState().modelId,isWorkflowStep:!0,workflowRunId:t.runId,workflowStepId:"trigger",workflowMainInteractionId:e.id,workflowTab:!0,workflowStepIndex:0}};if(s!=null&&s.templateId&&i.structured_output){const u=On.getState(),d=no.getState(),h=u.getConversationById(t.conversationId),p=(h==null?void 0:h.projectId)??null,y=d.getEffectiveProjectSettings(p).systemPrompt||"You are a helpful AI assistant.",{promptTemplates:v}=tl.getState(),x=v.find(w=>w.id===s.templateId);if(x&&x.variables&&x.variables.length>0){const{specification:w}=jr._createStructuredOutputSchema(x.variables);a.metadata.turnSystemPrompt=`${y}

You are part of a workflow system. ${w}`}else a.metadata.turnSystemPrompt=`${y}

You are part of a workflow system. You ABSOLUTELY MUST respect the following output format when answering to not break the workflow:

${JSON.stringify(i.structured_output,null,2)}`}const{promptObject:o}=await jr.buildCompletePromptObject(t.conversationId,n.content,a),l={...o,metadata:{...o.metadata,modelId:a.metadata.modelId}},c=await Rl.startInteraction(l,t.conversationId,a,"message.user_assistant");if(c){const u={parentId:e.id,index:0};en.getState()._updateInteractionInState(c.id,u),await dt.saveInteraction({...c,...u}),console.log(`[WorkflowService] Initial step created as child ${c.id} of main ${e.id}`)}else throw new ki("Failed to create initial step interaction","STEP_CREATION_FAILED",{runId:t.runId,stepType:"trigger"})}catch(s){const i=ki.fromError(s,"TRIGGER_STEP_FAILED",{runId:t.runId});throw console.error(`[WorkflowService] ${i.message}:`,i),Ae.emit(as.error,{runId:t.runId,error:i.message}),i}},createWorkflowStep:async(e,t)=>{var n,r,s,i;try{const a=e.template.steps[t];if(!a)throw new ki(`Step at index ${t} not found`,"STEP_NOT_FOUND",{runId:e.runId,stepIndex:t});const o=a.name||`Step ${t+1}`;Ae.emit(as.stepStarting,{runId:e.runId,step:a,stepIndex:t,metadata:QC(e.runId,"normal",t+2)});const l=en.getState(),c=l.activeStreamBuffers[e.mainInteractionId]||"",u=jr._updateStepStatusInFlow(c,{stepId:a.id,status:"running"});if(u!==c?l.setActiveStreamBuffer(e.mainInteractionId,u):l.appendStreamBuffer(e.mainInteractionId,`

---
 **Executing: ${o}**`),a.type==="human-in-the-loop"){l.appendStreamBuffer(e.mainInteractionId,`
 **Paused:** ${a.instructionsForHuman||"Requires human input."}`),l._updateInteractionInState(e.mainInteractionId,{status:"AWAITING_INPUT"}),l._removeStreamingId(e.mainInteractionId),Ae.emit(as.paused,{runId:e.runId,step:a,pauseReason:"human-in-the-loop",dataForReview:e.stepOutputs,metadata:QC(e.runId,"normal",t+10)});return}if(a.type==="transform")try{const _=await jr._executeTransformStep(e,a,t),k=l.activeStreamBuffers[e.mainInteractionId]||"",T=jr._updateStepStatusInFlow(k,{stepId:a.id,status:"success"});T!==k?l.setActiveStreamBuffer(e.mainInteractionId,T):l.appendStreamBuffer(e.mainInteractionId,`
 **Completed: ${o}** - Data transformed`),Ae.emit(as.stepCompleted,{runId:e.runId,stepId:a.id,output:_,metadata:QC(e.runId,"normal",t+20)});return}catch(_){const k=ki.fromError(_,"TRANSFORM_STEP_FAILED",{runId:e.runId,stepId:a.id,stepIndex:t,stepType:"transform"});console.error(`[WorkflowService] ${k.message}:`,k);const T=l.activeStreamBuffers[e.mainInteractionId]||"",A=jr._updateStepStatusInFlow(T,{stepId:a.id,status:"error"});A!==T?l.setActiveStreamBuffer(e.mainInteractionId,A):l.appendStreamBuffer(e.mainInteractionId,`
 **Error in ${o}:** ${k.getUserMessage()}`);const R={response:` **Workflow Error**

Transform step "${o}" failed: ${k.getUserMessage()}`,status:"ERROR",endedAt:new Date};l._updateInteractionInState(e.mainInteractionId,R),l._removeStreamingId(e.mainInteractionId);const M=l.interactions.find(j=>j.id===e.mainInteractionId);M&&dt.saveInteraction({...M,...R}).catch(console.error),Ae.emit(as.error,{runId:e.runId,error:k.getUserMessage()});return}if(a.modelId&&!Gn.getState().getGloballyEnabledModelDefinitions().some(A=>A.id===a.modelId))throw new ki(`Model "${a.modelId}" is not available or enabled`,"MODEL_NOT_AVAILABLE",{runId:e.runId,stepId:a.id,stepIndex:t,stepType:a.type,modelId:a.modelId});const d=await jr._compileStepPrompt(a,e,t),h=a.modelId??Qa.getState().modelId;if(!h)throw new Error(`Could not determine a valid AI model ID for step "${o}".`);console.log(`[WorkflowService] Step "${o}" configuration:`,{modelId:h,hasStructuredOutput:!!a.structuredOutput,structuredOutputSchema:(n=a.structuredOutput)==null?void 0:n.schema,enabledTools:((r=d.selectedTools)==null?void 0:r.length)||0,selectedRules:((s=d.selectedRules)==null?void 0:s.length)||0});const p=t+1,g=e.template.steps[p],y={};if(g&&g.type!=="transform"&&g.type!=="human-in-the-loop")if(g.templateId){const{promptTemplates:_}=tl.getState(),k=_.find(T=>T.id===g.templateId);if(k&&k.variables&&k.variables.length>0){const{schema:T,specification:A}=jr._createStructuredOutputSchema(k.variables);y.structured_output=T,console.log(`[WorkflowService] Step "${o}" will output structured data for next step "${g.name}" variables:`,k.variables.map(R=>R.name)),y.outputSpecification=A}}else g.structuredOutput&&(y.structured_output=g.structuredOutput.jsonSchema,console.log(`[WorkflowService] Step "${o}" will output structured data for next step: ${g.name}`));else(g==null?void 0:g.type)==="transform"&&console.log(`[WorkflowService] Step "${o}" will output free-form data for transform step "${g.name}" - no format constraints`);const v={id:dr(),content:d.content,parameters:y,metadata:{modelId:h,isWorkflowStep:!0,workflowRunId:e.runId,workflowStepId:a.id,workflowMainInteractionId:e.mainInteractionId,workflowTab:!0,workflowStepIndex:t+1,enabledTools:d.selectedTools,effectiveRulesContent:(i=d.selectedRules)==null?void 0:i.map(_=>({sourceRuleId:_,content:"/* Rule content will be resolved */",type:"before"}))}};if(y.structured_output){const{promptTemplates:_}=tl.getState(),k=_.find(T=>T.id===a.templateId);if(k){const T=On.getState(),A=no.getState(),R=T.getConversationById(e.conversationId),M=(R==null?void 0:R.projectId)??null,F=A.getEffectiveProjectSettings(M).systemPrompt||"You are a helpful AI assistant.",P=k.prompt||"",q=P?`${F}

${P}`:F;y.outputSpecification?v.metadata.turnSystemPrompt=`${q}

You are part of a workflow system. ${y.outputSpecification}`:v.metadata.turnSystemPrompt=`${q}

You are part of a workflow system. You ABSOLUTELY MUST respect the following output format when answering to not break the workflow:

${JSON.stringify(y.structured_output,null,2)}`}}const{promptObject:x}=await jr.buildCompletePromptObject(e.conversationId,d.content,v),w={...x,metadata:{...x.metadata,modelId:v.metadata.modelId}},S=await Rl.startInteraction(w,e.conversationId,v,"message.assistant_regen");if(S){const _={parentId:e.mainInteractionId,index:t+1};en.getState()._updateInteractionInState(S.id,_),await dt.saveInteraction({...S,..._})}}catch(a){console.error(`[WorkflowService] Error creating step ${t}:`,a);const o=a instanceof Error?a.message:String(a),l=en.getState(),c={response:` **Workflow Error**

Failed to create step ${t+1}: ${o}`,status:"ERROR",endedAt:new Date};l._updateInteractionInState(e.mainInteractionId,c),l._removeStreamingId(e.mainInteractionId);const u=l.interactions.find(d=>d.id===e.mainInteractionId);u&&dt.saveInteraction({...u,...c}).catch(console.error),Ae.emit(as.error,{runId:e.runId,error:o})}},handleInteractionCompleted:e=>{var n;const{interaction:t}=e;!((n=t==null?void 0:t.metadata)!=null&&n.isWorkflowStep)||!t.metadata.workflowRunId||setTimeout(()=>{const{workflowRunId:r,workflowStepId:s}=t.metadata,i=xy.getState().activeRun;if(!i||i.runId!==r){console.warn(`[WorkflowService] Mismatched or no active run for ${r}`);return}if(e.status==="ERROR"||e.status==="CANCELLED"){const d=`Step failed with status ${e.status}. ${t.response||""}`;console.error(`[WorkflowService] Step error for run ${i.runId}:`,d),en.getState().appendStreamBuffer(i.mainInteractionId,`
 **Error:** ${d}`),Ae.emit(as.error,{runId:i.runId,error:d});return}if(s==="trigger"){let d;const h=i.template.steps[0];if((h==null?void 0:h.type)==="transform")console.log(`[WorkflowService] Trigger step output will be free-form for transform step "${h.name}"`),d=t.response??"No output";else try{const x={structuredOutput:{jsonSchema:{}}};d=jr._parseStepOutput(t,x)}catch(x){console.warn("[WorkflowService] Initial step structured output parsing failed:",x),d=t.response??"No output"}const g=en.getState(),y=g.activeStreamBuffers[i.mainInteractionId]||"",v=y.match(/```flow\n([\s\S]*?)\n```/);if(v&&v[1]){const x=jr.flowGenerator.updateNodeStatus(v[1],"initial","success"),w=y.replace(/```flow\n[\s\S]*?\n```/,`\`\`\`flow
${x}
\`\`\``);g.setActiveStreamBuffer(i.mainInteractionId,w)}else g.appendStreamBuffer(i.mainInteractionId,`
 **Finished: Initial User Prompt**`);Ae.emit(as.stepCompleted,{runId:i.runId,stepId:"trigger",output:d});return}const a=i.template.steps.find(d=>d.id===s);if(!a){console.error(`[WorkflowService] Could not find step ${s} in template`);return}let o;try{o=jr._parseStepOutput(t,a)}catch{Ae.emit(as.paused,{runId:i.runId,step:a,pauseReason:"data-correction",rawAssistantResponse:t.response});return}const l=en.getState(),c=l.activeStreamBuffers[i.mainInteractionId]||"",u=c.match(/```flow\n([\s\S]*?)\n```/);if(u&&u[1]){const d=jr.flowGenerator.updateNodeStatus(u[1],s,"success"),h=c.replace(/```flow\n[\s\S]*?\n```/,`\`\`\`flow
${d}
\`\`\``);l.setActiveStreamBuffer(i.mainInteractionId,h)}else{const d=a.name||"Unnamed Step";l.appendStreamBuffer(i.mainInteractionId,`
 **Finished: ${d}**`)}Ae.emit(as.stepCompleted,{runId:i.runId,stepId:s,output:o})},100)},handleStepCompleted:e=>{const{runId:t}=e;setTimeout(()=>{var r;const n=xy.getState().activeRun;if(!n||n.runId!==t||n.status!=="RUNNING"){console.log("[WorkflowService] Step completion ignored - no active run or status changed");return}if(n.currentStepIndex>=n.template.steps.length){const s=en.getState(),i=s.interactions.find(p=>p.id===n.mainInteractionId),a=((r=i==null?void 0:i.prompt)==null?void 0:r.content)||"No input";let o=`# ${n.template.name}

`;o+=`**Original Input:** ${a}

`,o+=`---

`,Object.entries(n.stepOutputs).forEach(([p,g])=>{if(p==="trigger")o+=`## Initial Processing

`;else{const y=n.template.steps.find(x=>x.id===p);if((y==null?void 0:y.type)==="transform")return;const v=(y==null?void 0:y.name)||p;o+=`## ${v}

`}typeof g=="object"&&g!==null?Object.entries(g).forEach(([y,v])=>{o+=`**${y}:** ${v}

`}):o+=`${g}

`,o+=`---

`}),o+=" **Workflow completed successfully**";const l=s.activeStreamBuffers[n.mainInteractionId]||"",c=l.match(/```flow\n([\s\S]*?)\n```/);let u=o;if(c&&c[1]){const p=jr.flowGenerator.finalizeWorkflow(c[1],n.stepOutputs);u=l.replace(/```flow\n[\s\S]*?\n```/,`\`\`\`flow
${p}
\`\`\``).replace(/Workflow starting with.*?\.\.\./,` **Workflow completed successfully**

**Summary:**
${o}`)}const d={response:u,status:"COMPLETED",endedAt:new Date};s._updateInteractionInState(n.mainInteractionId,d),s._removeStreamingId(n.mainInteractionId);const h=s.interactions.find(p=>p.id===n.mainInteractionId);h&&dt.saveInteraction({...h,...d}).catch(console.error),Ae.emit(as.completed,{runId:n.runId,finalOutput:n.stepOutputs}),console.log(`[WorkflowService] Workflow completed: ${t}`);return}jr.createWorkflowStep(n,n.currentStepIndex)},0)},handleWorkflowResumeRequest:async e=>{console.log("[WorkflowService] Workflow resume request received",e);const{runId:t,resumeData:n}=e,r=xy.getState().activeRun;if(!r||r.runId!==t){console.warn(`[WorkflowService] Cannot resume run ${t}, not active`);return}const s=r.template.steps[r.currentStepIndex];if(!s){console.error(`[WorkflowService] Cannot resume, no step at index ${r.currentStepIndex}`);return}Ae.emit(as.stepCompleted,{runId:r.runId,stepId:s.id,output:n})},async buildCompletePromptObject(e,t,n){const r=en.getState(),s=no.getState(),i=Qa.getState(),a=On.getState(),o=Ni.getState(),l=a.getConversationById(e),c=(l==null?void 0:l.projectId)??null,u=s.getEffectiveProjectSettings(c),d=Object.values(o.promptControls);let h={},p={...n.metadata};for(const M of d){if(M.getParameters){const j=await M.getParameters();j&&(h={...h,...j})}if(M.getMetadata){const j=await M.getMetadata();j&&(p={...p,...j})}}const y=r.interactions.filter(M=>M.conversationId===e&&M.parentId===null&&M.status==="COMPLETED").sort((M,j)=>M.index-j.index).map(M=>{var j;if(M.type==="message.assistant_regen"&&((j=M.metadata)!=null&&j.regeneratedFromId)){const F=r.interactions.find(P=>P.id===M.metadata.regeneratedFromId);if(F&&F.prompt&&F.type==="message.user_assistant")return{...M,prompt:F.prompt,type:"message.user_assistant"}}return M.type==="message.user_assistant"&&M.prompt?M:null}).filter(Boolean),v=fw(y);v.push({role:"user",content:t});let w=(p==null?void 0:p.turnSystemPrompt)??u.systemPrompt??void 0;const _=((p==null?void 0:p.effectiveRulesContent)??[]).filter(M=>M.type==="system").map(M=>M.content);_.length>0&&(w=`${w?`${w}

`:""}${_.join(`
`)}`);const k={temperature:i.temperature,max_tokens:i.maxTokens,top_p:i.topP,top_k:i.topK,presence_penalty:i.presencePenalty,frequency_penalty:i.frequencyPenalty,...h,...n.parameters??{}};Object.keys(k).forEach(M=>{(k[M]===null||k[M]===void 0)&&delete k[M]});const T={...p,modelId:p.modelId||i.modelId||void 0},A={...n,content:t,parameters:k,metadata:T};return{promptObject:{system:w,messages:v,parameters:k,metadata:T},turnData:A}},_createStructuredOutputSchema:e=>{const t={type:"object",properties:{},required:[],additionalProperties:!1};e.forEach(s=>{t.properties[s.name]={type:s.type==="number"?"number":"string",description:s.description||`The ${s.name} value`},s.required&&t.required.push(s.name)});const n=e.reduce((s,i)=>{const a=i.type==="number"?42:`"your ${i.name} here"`;return s[i.name]=a,s},{}),r=`You must respond with a JSON object containing the actual values (not schema definitions). 

Expected format:
${JSON.stringify(n,null,2)}

Required fields: ${t.required.join(", ")}
${e.map(s=>`- ${s.name}: ${s.description||`The ${s.name} value`}`).join(`
`)}

IMPORTANT: Provide the actual values, not schema definitions with "type" and "description" fields.
IMPORTANT: Keep your response as they would be in normal condition you can use all of LiteChat capabilities, do not shorten or simplify the response but make sure to provide a valid json output.`;return{schema:t,specification:r}}};let kW=[],EW=null,Yd=!1;const bWe=({controls:e=[]})=>{const[t,n]=E.useState(!0),[r,s]=E.useState(!1),i=E.useRef(null),a=E.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=On(pn(M=>({selectedItemId:M.selectedItemId,selectedItemType:M.selectedItemType,getConversationById:M.getConversationById}))),{getEffectiveProjectSettings:u}=no(pn(M=>({getEffectiveProjectSettings:M.getEffectiveProjectSettings}))),{interactions:d,status:h}=en(pn(M=>({interactions:M.interactions,status:M.status}))),{globalError:p,isSidebarCollapsed:g,isChatControlPanelOpen:y}=B1(pn(M=>({globalError:M.globalError,isSidebarCollapsed:M.isSidebarCollapsed,isChatControlPanelOpen:M.isChatControlPanelOpen}))),v=Ni(pn(M=>Object.values(M.chatControls))),x=E.useMemo(()=>v.filter(M=>(M.panel??"main")==="sidebar"&&(M.show?M.show():!0)),[v]),w=E.useMemo(()=>v.filter(M=>M.panel==="sidebar-footer"&&(M.show?M.show():!0)),[v]),S=E.useMemo(()=>v.filter(M=>M.panel==="header"&&(M.show?M.show():!0)),[v]),_=E.useCallback(()=>{s(M=>!M)},[]);E.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),E.useEffect(()=>{a.current||(a.current=hO({id:"core-litechat-app",name:"LiteChat App Core"}));const M=a.current;Bie.initialize(),jr.initialize(),EW||(EW=(async()=>{if(Yd){n(!1);return}n(!0);try{kW=await fWe(e,M),Yd=!0}catch(F){console.error("[LiteChat] App: Top-level initialization error:",F),Yd=!1}finally{n(!1)}})().then(()=>kW))},[e]);const k=E.useRef({itemId:null,itemType:null,effectiveSettingsString:""});E.useEffect(()=>{if(t||!Yd||!a.current)return;const M=a.current,j={itemId:o,itemType:l};let F=null;if(l==="project")F=o;else if(l==="conversation"&&o){const I=c(o);F=(I==null?void 0:I.projectId)??null}const P=u(F),q=JSON.stringify(P);(j.itemId!==k.current.itemId||j.itemType!==k.current.itemType||q!==k.current.effectiveSettingsString)&&(M.emit(an.initializePromptStateRequest,{effectiveSettings:P}),M.emit(Ir.contextChanged,{selectedItemId:o,selectedItemType:l}),k.current={...j,effectiveSettingsString:q})},[o,l,c,u,t,Yd]),E.useEffect(()=>{if(t||!Yd||!a.current)return;const M=a.current,j=()=>{let V=null;if(l==="project")V=o;else if(l==="conversation"&&o){const z=c(o);V=(z==null?void 0:z.projectId)??null}const D=u(V);M.emit(an.initializePromptStateRequest,{effectiveSettings:D})},F=M.on(on.loaded,j),P=M.on(Da.updated,j),q=M.on(on.globalSystemPromptChanged,j),I=M.on(on.temperatureChanged,j);return()=>{F(),P(),q(),I()}},[o,l,c,u,t,Yd]),E.useEffect(()=>{if(t||!Yd||!a.current)return;const M=a.current;let j=null;if(y["core-vfs-modal-panel"]||l==="project")if(l==="project")j=o;else if(l==="conversation"){const q=c(o);j=(q==null?void 0:q.projectId)??"orphan"}else j="orphan";else if(l==="conversation"){const q=c(o);j=(q==null?void 0:q.projectId)??"orphan"}let P=null;typeof j=="string"?P=j:j===null?P=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof j}, Value:`,j,"Defaulting to 'orphan'."),P="orphan"),oi.getState().vfsKey!==P&&M.emit(hn.setVfsKeyRequest,{key:P})},[o,l,c,t,Yd,y]);const T=async M=>{const j=On.getState(),F=await j.addConversation(M);return console.log("New conversation ID:",F),await j.selectItem(F,"conversation"),console.log("conv selected:",F),F},A=E.useCallback(async M=>{var q;if(!a.current){ke.error("Application core not ready. Please try again.");return}const j=On.getState();let F=j.selectedItemType==="conversation"?j.selectedItemId:null;const P=j.selectedItemType==="project"?j.selectedItemId:j.selectedItemType==="conversation"?((q=j.getConversationById(j.selectedItemId))==null?void 0:q.projectId)??null:null;if(!F)try{F=await T({title:"New Chat",projectId:P}),console.log("New conversation ID 2:",F)}catch(I){console.error("[LiteChat] App: Failed to create new conversation",I),ke.error("Failed to start new chat.");return}try{const I=Qa.getState(),V={...M,metadata:{...M.metadata,modelId:I.modelId}};await Bh.submitPrompt(V)}catch(I){console.error("[LiteChat] App: Error submitting prompt:",I),ke.error("Failed to send message.")}},[]),R=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Yn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(gWe,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Ye("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",g?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Ye(g?"hidden":"block"),children:f.jsx(q0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Ye(g?"block":"hidden"),children:f.jsx(q0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Ye("flex-shrink-0 border-t border-border p-2",g?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(q0,{controls:w,panelId:"sidebar-footer",renderMode:g?"icon":"full",className:Ye("flex",g?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-[var(--z-sidebar)] flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:_}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-[var(--z-sticky)] flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:_,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(Ri,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(q0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(q0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Ye("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:_,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(Ri,{className:"h-6 w-6"}):f.jsx(gve,{className:"h-6 w-6"})}),f.jsx(q0,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(JVe,{conversationId:R,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),p&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",p]}),f.jsx($_e,{InputAreaRenderer:Die,onSubmit:A,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(rWe,{richColors:!0,position:"bottom-right",closeButton:!0})]})},vWe="prism-theme-link",xWe="prism-default-light-theme-link",wWe="prism-default-dark-theme-link",SWe="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",_We="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",O3=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},CWe=()=>{const{prismThemeUrl:e,theme:t}=gr(pn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=E.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=E.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return E.useEffect(()=>{if(typeof window>"u")return;const s=O3(xWe),i=O3(wWe),a=O3(vWe);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=SWe,i.href=_We,e?(a.href=e,a.disabled=!1):r==="dark"?i.disabled=!1:s.disabled=!1,()=>{}},[e,r]),null},D3=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),F3=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],kWe=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=gr(pn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return E.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),F3.forEach(a=>{i.style.removeProperty(`--${D3(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&F3.includes(a)){const l=`--${D3(a)}`;i.style.setProperty(l,o)}else if(F3.includes(a)){const l=`--${D3(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},EWe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},TW="0.1.0-dev",AW="https://github.com/DimitriGilbert/LiteChat",NW=({textToCopy:e,label:t,className:n})=>{const[r,s]=E.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),ke.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){ke.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(rt,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(Ao,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(lY,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class TWe extends E.Component{constructor(){super(...arguments);ue(this,"state",{hasError:!1,error:null,errorInfo:null});ue(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),ke.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${AW}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){ke.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${AW}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${TW}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${TW}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground z-[9999]",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(EWe,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(rt,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(NW,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(NW,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(rt,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(fS,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const zie=(e,t)=>{if(!t)return null;let n=eu,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Yn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=No,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=DD,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=dS,r="text-green-500",s=`Synced with ${t}`;break;default:n=eu,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(n,{className:Ye("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Nr,{side:"right",children:s})]})})},Uie=E.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:p,handleStartEditing:g,handleSaveEdit:y,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const S=e.id===n,_=e.itemType==="project",k=e.id===h&&e.itemType===p,[T,A]=E.useState(_?e.name:e.title),R=E.useRef(null),[M,j]=E.useState(!1);E.useEffect(()=>{if(k){const Ee=_?e.name:e.title;A(Ee),requestAnimationFrame(()=>{var he,pe;(he=R.current)==null||he.focus(),(pe=R.current)==null||pe.select()})}},[k,e,_]),E.useEffect(()=>{if(!k){const Ee=_?e.name:e.title;T!==Ee&&A(Ee)}},[_?e.name:e.title,k,T,_]);const F=_&&u.has(e.id),P=_,q=!_&&e.syncRepoId?r[e.id]:void 0,I=!_&&e.syncRepoId?s.get(e.syncRepoId):void 0,V=!_&&I?zie(q,I):null,D=Ee=>{Ee.stopPropagation(),Ae.emit(Ir.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},z=()=>{k||(_&&d(e.id),i(e.id,e.itemType))},$=Ee=>{Ee.stopPropagation(),_?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,Ee):a(e.id,Ee)},Y=Ee=>{Ee.stopPropagation(),g(e)},B=()=>{A(w),v(e.itemType==="project"&&w==="New Project")},G=async()=>{if(x)return;const Ee=T.trim();await y(e.id,e.itemType,Ee)},Z=()=>{var pe;if(x)return;const Ee=T.trim(),he=e.itemType==="project"&&w==="New Project";if(!Ee){w!=="New Project"?(ke.error("Name cannot be empty."),A(w),(pe=R.current)==null||pe.focus()):B();return}Ee!==w||he?G():B()},ne=Ee=>{Ee.key==="Enter"?(Ee.preventDefault(),G()):Ee.key==="Escape"&&(Ee.preventDefault(),B())},ae=_?e.name:e.title,le=x?Yn:Ao,Se=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Ye("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!k&&"hover:bg-muted/50 hover:text-primary/80",S&&!k?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",k&&"bg-muted ring-1 ring-primary",!k&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:z,title:k?"":ae,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[P&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:Ee=>{Ee.stopPropagation(),d(e.id)},children:F?f.jsx(Fl,{className:"h-3 w-3 text-muted-foreground"}):f.jsx(NT,{className:"h-3 w-3 text-muted-foreground"})}),!P&&f.jsx("span",{className:"w-3 flex-shrink-0"}),_?f.jsx(Zh,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(PP,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),k?f.jsx(vn,{ref:R,value:T,onChange:Ee=>A(Ee.target.value),onKeyDown:ne,onBlur:Z,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:Ee=>Ee.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:ae}),V]}),f.jsx("div",{className:Ye("items-center flex-shrink-0 ml-1",k||M?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:Ee=>Ee.stopPropagation(),children:k?f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:"Save (Enter)",onClick:Ee=>{Ee.stopPropagation(),G()},disabled:x||!T.trim(),"aria-label":"Save changes",icon:f.jsx(le,{}),iconClassName:Se,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(Nn,{tooltipText:"Cancel (Esc)",onClick:Ee=>{Ee.stopPropagation(),B()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(Ri,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[_&&f.jsx(Nn,{tooltipText:"Project Settings",onClick:D,"aria-label":`Settings for ${ae}`,icon:f.jsx(gbe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(Nn,{tooltipText:"Edit",onClick:Y,"aria-label":`Edit ${ae}`,icon:f.jsx(hS,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),_?f.jsx(Nn,{tooltipText:"Export Project (JSON)",onClick:Ee=>c(e.id,Ee),"aria-label":`Export project ${ae}`,icon:f.jsx(Rbe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs(Tc,{open:M,onOpenChange:j,children:[f.jsx(Ac,{asChild:!0,children:f.jsx(Nn,{tooltipText:"Export Conversation","aria-label":`Export ${ae}`,icon:f.jsx(cc,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})}),f.jsx(Nc,{className:"w-auto p-0.5",onClick:Ee=>Ee.stopPropagation(),children:f.jsxs("div",{className:"flex gap-0.5",children:[f.jsx(rt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:Ee=>{l(e.id,"json",Ee),j(!1)},children:"JSON"}),f.jsx(rt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:Ee=>{l(e.id,"md",Ee),j(!1)},children:"MD"})]})})]}),f.jsx(Nn,{tooltipText:"Delete",onClick:$,"aria-label":`Delete ${ae}`,icon:f.jsx(to,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});Uie.displayName="ConversationItemRenderer";function AWe({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(""),[c,u]=E.useState(!1),d=E.useCallback(g=>{s(g.id),a(g.itemType);const y=g.itemType==="project"?g.name:g.title;l(y),u(!1)},[]),h=E.useCallback(g=>{const y=r,v=g??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&y&&n(y).catch(x=>{console.error("Failed to delete new project on cancel:",x),ke.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),p=E.useCallback(async(g,y,v)=>{if(g!==r||y!==i||c)return;const x=v==null?void 0:v.trim();if(!x){ke.error("Name cannot be empty.");return}if(x===o&&!(y==="project"&&o==="New Project")){h();return}u(!0);try{y==="project"?await e(g,{name:x}):await t(g,{title:x}),ke.success("Item renamed successfully."),s(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),ke.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:p,handleCancelEdit:h,originalNameToCompare:o}}const qie=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],p=a.get(e)||[];for(const g of p)if(g.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const g of h)if(qie(g.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},NWe=({module:e})=>{const t=E.useRef(null),n=E.useRef(null),[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!On.getState().isLoading&&!no.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const ye=t.current;if(ye){const Ne=ye.querySelector("[data-radix-scroll-area-viewport]");if(Ne&&n.current!==Ne?(n.current=Ne,r||s(!0),i({})):!Ne&&n.current&&(n.current=null,s(!1)),!n.current){const fe=new MutationObserver(()=>{const ce=ye.querySelector("[data-radix-scroll-area-viewport]");ce&&n.current!==ce&&(n.current=ce,s(!0),i({}),fe.disconnect())});return fe.observe(ye,{childList:!0,subtree:!0}),()=>fe.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:p,deleteConversation:g,exportConversation:y,exportProject:v,getConversationById:x}=On(pn(ye=>({selectedItemId:ye.selectedItemId,selectedItemType:ye.selectedItemType,conversations:ye.conversations,syncRepos:ye.syncRepos,conversationSyncStatus:ye.conversationSyncStatus,selectItem:ye.selectItem,addConversation:ye.addConversation,updateConversation:ye.updateConversation,deleteConversation:ye.deleteConversation,exportConversation:ye.exportConversation,exportProject:ye.exportProject,getConversationById:ye.getConversationById}))),{projects:w,addProject:S,updateProject:_,deleteProject:k,getProjectById:T}=no(pn(ye=>({projects:ye.projects,addProject:ye.addProject,updateProject:ye.updateProject,deleteProject:ye.deleteProject,getProjectById:ye.getProjectById}))),A=e.isLoading,[R,M]=We.useState(new Set),[j,F]=E.useState(""),P=AWe({updateProject:_,updateConversation:p,deleteProject:k}),{editingItemId:q,editingItemType:I,isSavingEdit:V,handleStartEditing:D,handleSaveEdit:z,handleCancelEdit:$,originalNameToCompare:Y}=P,B=E.useCallback(ye=>{M(Ne=>{const fe=new Set(Ne);return fe.has(ye)?fe.delete(ye):fe.add(ye),fe})},[]),G=E.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const ye=x(a);return(ye==null?void 0:ye.projectId)??null}return null},[a,o,x]),Z=E.useCallback(async()=>{if(!q)try{const ye=G(),Ne=await h({title:"New Chat",projectId:ye});d(Ne,"conversation")}catch(ye){console.error("Failed to create new chat:",ye),ke.error("Failed to create new chat.")}},[q,G,h,d]),ne=E.useCallback(async()=>{if(!q)try{const ye=G(),Ne=await S({name:"New Project",parentId:ye});d(Ne,"project"),ye&&M(fe=>new Set(fe).add(ye)),setTimeout(()=>{const fe=T(Ne);fe&&D({...fe,itemType:"project"})},50)}catch(ye){console.error("Failed to create new project:",ye)}},[q,G,S,d,T,D]),ae=E.useCallback((ye,Ne)=>{ye===q&&Ne===I||(q&&(ye!==q||Ne!==I)&&$(),(ye!==a||Ne!==o)&&d(ye,Ne))},[q,I,a,o,$,d]),le=E.useCallback((ye,Ne)=>{Ne.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&g(ye).catch(fe=>{console.error("Failed to delete conversation:",fe),ke.error("Failed to delete conversation.")})},[g]),Se=E.useCallback((ye,Ne)=>{Ne.stopPropagation(),k(ye).catch(fe=>{console.error("Failed to delete project:",fe),ke.error("Failed to delete project.")})},[k]),Ee=E.useCallback(async(ye,Ne,fe)=>{fe.stopPropagation();try{await y(ye,Ne)}catch(ce){console.error(`Failed to export conversation as ${Ne}:`,ce)}},[y]),he=E.useCallback(async(ye,Ne)=>{Ne.stopPropagation();try{await v(ye)}catch(fe){console.error("Failed to export project:",fe)}},[v]),pe=E.useMemo(()=>new Map((c||[]).map(ye=>[ye.id,ye.name])),[c]),{projectsById:Le,conversationsByProjectId:He,projectsByParentId:Fe}=E.useMemo(()=>{const ye=new Map(w.map(ce=>[ce.id,ce])),Ne=new Map;l.forEach(ce=>{const se=ce.projectId??null;Ne.has(se)||Ne.set(se,[]),Ne.get(se).push(ce)});const fe=new Map;return w.forEach(ce=>{const se=ce.parentId??null;fe.has(se)||fe.set(se,[]),fe.get(se).push(ce)}),{projectsById:ye,conversationsByProjectId:Ne,projectsByParentId:fe}},[w,l]),Ie=E.useMemo(()=>{const ye=[],Ne=j.toLowerCase(),fe={};function ce(se,Pe){const Be=(Fe.get(se)||[]).filter(Et=>qie(Et.id,"project",Ne,w,l,Le,He,Fe,fe)),je=(He.get(se)||[]).filter(Et=>Et.title.toLowerCase().includes(Ne)),ot=[...Be,...je];ot.sort((Et,ut)=>new Date(ut.updatedAt).getTime()-new Date(Et.updatedAt).getTime()),ot.forEach(Et=>{"path"in Et?(ye.push({id:`project-${Et.id}`,originalId:Et.id,type:"project",level:Pe,data:Et,updatedAt:Et.updatedAt}),R.has(Et.id)&&ce(Et.id,Pe+1)):ye.push({id:`conversation-${Et.id}`,originalId:Et.id,type:"conversation",level:Pe,data:Et,updatedAt:Et.updatedAt})})}return ce(null,0),ye},[w,l,j,R,Le,He,Fe]),X=N6({count:Ie.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(af,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(rt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Xbe,{className:"h-4 w-4"})})}),f.jsx(af,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(rt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(cc,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{size:"sm",variant:"ghost",onClick:ne,"aria-label":"New Project",disabled:A||!!q,className:"h-7 w-7 p-0",children:f.jsx(dY,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"bottom",children:"New Project"})]})}),f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{size:"sm",variant:"ghost",onClick:Z,"aria-label":"New Chat",disabled:A||!!q,className:"h-7 w-7 p-0",children:f.jsx(al,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(Ro,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter...",value:j,onChange:ye=>F(ye.target.value),className:"h-8 text-xs pl-8",disabled:A})]}),f.jsxs(ul,{className:"flex-grow",ref:t,children:[A&&Ie.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!A&&Ie.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:j.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${X.getTotalSize()}px`,width:"100%",position:"relative"},children:X.getVirtualItems().map(ye=>{const Ne=Ie[ye.index];if(!Ne)return null;const fe={...Ne.data,itemType:Ne.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${ye.size}px`,transform:`translateY(${ye.start}px)`},className:"px-1",children:f.jsx(Uie,{item:fe,level:Ne.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:pe,onSelectItem:()=>ae(Ne.originalId,Ne.type),onDeleteConversation:le,onDeleteProject:Se,onExportConversation:Ee,onExportProject:he,expandedProjects:R,toggleProjectExpansion:B,editingItemId:q,editingItemType:I,handleStartEditing:D,handleSaveEdit:z,handleCancelEdit:$,isSavingEdit:V,originalNameToCompare:Y})},Ne.id)})}),!r&&!A&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},RWe=({module:e})=>{const{selectedItemType:t}=On(pn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Yn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(Zh,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(Tz,{className:"h-5 w-5 text-primary"}):f.jsx(Tz,{className:"h-5 w-5 text-muted-foreground"})};class IWe{constructor(){ue(this,"id","core-conversation-list");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"isLoading",!0);ue(this,"conversationsLoading",!0);ue(this,"projectsLoading",!0);ue(this,"notifyComponentUpdate",null);ue(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=On.getState().isLoading,this.projectsLoading=no.getState().isLoading,this.updateCombinedLoadingState(),t.emit(rr.loadConversationsRequest,void 0),t.emit(Da.loadProjectsRequest,void 0);const n=t.on(rr.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(Da.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(rr.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(Da.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>We.createElement(NWe,{module:this}),iconRenderer:()=>We.createElement(RWe,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const RW=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(Xh,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:"Settings"})]})})};var L3="focusScope.autoFocusOnMount",$3="focusScope.autoFocusOnUnmount",IW={bubbles:!1,cancelable:!0},MWe="FocusScope",M6=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Ms(s),u=Ms(i),d=E.useRef(null),h=Tn(t,y=>l(y)),p=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let y=function(S){if(p.paused||!o)return;const _=S.target;o.contains(_)?d.current=_:Dh(d.current,{select:!0})},v=function(S){if(p.paused||!o)return;const _=S.relatedTarget;_!==null&&(o.contains(_)||Dh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const k of S)k.removedNodes.length>0&&Dh(o)};document.addEventListener("focusin",y),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,p.paused]),E.useEffect(()=>{if(o){jW.add(p);const y=document.activeElement;if(!o.contains(y)){const x=new CustomEvent(L3,IW);o.addEventListener(L3,c),o.dispatchEvent(x),x.defaultPrevented||(jWe(LWe(Vie(o)),{select:!0}),document.activeElement===y&&Dh(o))}return()=>{o.removeEventListener(L3,c),setTimeout(()=>{const x=new CustomEvent($3,IW);o.addEventListener($3,u),o.dispatchEvent(x),x.defaultPrevented||Dh(y??document.body,{select:!0}),o.removeEventListener($3,u),jW.remove(p)},0)}}},[o,c,u,p]);const g=E.useCallback(y=>{if(!n&&!r||p.paused)return;const v=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,x=document.activeElement;if(v&&x){const w=y.currentTarget,[S,_]=PWe(w);S&&_?!y.shiftKey&&x===_?(y.preventDefault(),n&&Dh(S,{select:!0})):y.shiftKey&&x===S&&(y.preventDefault(),n&&Dh(_,{select:!0})):x===w&&y.preventDefault()}},[n,r,p.paused]);return f.jsx(Zn.div,{tabIndex:-1,...a,ref:h,onKeyDown:g})});M6.displayName=MWe;function jWe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Dh(r,{select:t}),document.activeElement!==n)return}function PWe(e){const t=Vie(e),n=MW(t,e),r=MW(t.reverse(),e);return[n,r]}function Vie(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function MW(e,t){for(const n of e)if(!OWe(n,{upTo:t}))return n}function OWe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function DWe(e){return e instanceof HTMLInputElement&&"select"in e}function Dh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&DWe(e)&&t&&e.select()}}var jW=FWe();function FWe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=PW(e,t),e.unshift(t)},remove(t){var n;e=PW(e,t),(n=e[0])==null||n.resume()}}}function PW(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function LWe(e){return e.filter(t=>t.tagName!=="A")}function $We(e){const t=BWe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(UWe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function BWe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=VWe(s),o=qWe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?jl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var zWe=Symbol("radix.slottable");function UWe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===zWe}function qWe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function VWe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var eN="Dialog",[Wie,kvt]=Pi(eN),[WWe,du]=Wie(eN),Hie=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=E.useRef(null),l=E.useRef(null),[c,u]=pc({prop:r,defaultProp:s??!1,onChange:i,caller:eN});return f.jsx(WWe,{scope:t,triggerRef:o,contentRef:l,contentId:_a(),titleId:_a(),descriptionId:_a(),open:c,onOpenChange:u,onOpenToggle:E.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};Hie.displayName=eN;var Gie="DialogTrigger",HWe=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=du(Gie,n),i=Tn(t,s.triggerRef);return f.jsx(Zn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":O6(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});HWe.displayName=Gie;var j6="DialogPortal",[GWe,Kie]=Wie(j6,{forceMount:void 0}),Yie=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=du(j6,t);return f.jsx(GWe,{scope:t,forceMount:n,children:E.Children.map(r,a=>f.jsx(ca,{present:n||i.open,children:f.jsx(YT,{asChild:!0,container:s,children:a})}))})};Yie.displayName=j6;var DE="DialogOverlay",Zie=E.forwardRef((e,t)=>{const n=Kie(DE,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=du(DE,e.__scopeDialog);return i.modal?f.jsx(ca,{present:r||i.open,children:f.jsx(YWe,{...s,ref:t})}):null});Zie.displayName=DE;var KWe=$We("DialogOverlay.RemoveScroll"),YWe=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=du(DE,n);return f.jsx(YS,{as:KWe,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(Zn.div,{"data-state":O6(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),ug="DialogContent",Xie=E.forwardRef((e,t)=>{const n=Kie(ug,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=du(ug,e.__scopeDialog);return f.jsx(ca,{present:r||i.open,children:i.modal?f.jsx(ZWe,{...s,ref:t}):f.jsx(XWe,{...s,ref:t})})});Xie.displayName=ug;var ZWe=E.forwardRef((e,t)=>{const n=du(ug,e.__scopeDialog),r=E.useRef(null),s=Tn(t,n.contentRef,r);return E.useEffect(()=>{const i=r.current;if(i)return $A(i)},[]),f.jsx(Jie,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),XWe=E.forwardRef((e,t)=>{const n=du(ug,e.__scopeDialog),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(Jie,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Jie=E.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=du(ug,n),l=E.useRef(null),c=Tn(t,l);return LA(),f.jsxs(f.Fragment,{children:[f.jsx(M6,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(VT,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":O6(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(JWe,{titleId:o.titleId}),f.jsx(eHe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),P6="DialogTitle",Qie=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=du(P6,n);return f.jsx(Zn.h2,{id:s.titleId,...r,ref:t})});Qie.displayName=P6;var eae="DialogDescription",tae=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=du(eae,n);return f.jsx(Zn.p,{id:s.descriptionId,...r,ref:t})});tae.displayName=eae;var nae="DialogClose",rae=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=du(nae,n);return f.jsx(Zn.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});rae.displayName=nae;function O6(e){return e?"open":"closed"}var sae="DialogTitleWarning",[Evt,iae]=B_e(sae,{contentName:ug,titleName:P6,docsSlug:"dialog"}),JWe=({titleId:e})=>{const t=iae(sae),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return E.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},QWe="DialogDescriptionWarning",eHe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${iae(QWe).contentName}}.`;return E.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},aae=Hie,oae=Yie,lae=Zie,cae=Xie,tHe=Qie,nHe=tae,uae=rae;function vd({...e}){return f.jsx(aae,{"data-slot":"dialog",...e})}function rHe({...e}){return f.jsx(oae,{"data-slot":"dialog-portal",...e})}function sHe({...e}){return f.jsx(uae,{"data-slot":"dialog-close",...e})}function iHe({className:e,...t}){return f.jsx(lae,{"data-slot":"dialog-overlay",className:Ye("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function xd({className:e,children:t,...n}){return f.jsxs(rHe,{"data-slot":"dialog-portal",children:[f.jsx(iHe,{}),f.jsxs(cae,{"data-slot":"dialog-content",className:Ye("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs(uae,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(Ri,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function wd({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Ye("flex flex-col gap-2 text-center sm:text-left",e),...t})}function Fg({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Ye("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function Sd({className:e,...t}){return f.jsx(tHe,{"data-slot":"dialog-title",className:Ye("text-lg leading-none font-semibold",e),...t})}function Bf({className:e,...t}){return f.jsx(nHe,{"data-slot":"dialog-description",className:Ye("text-muted-foreground text-sm",e),...t})}var B3="rovingFocusGroup.onEntryFocus",aHe={bubbles:!1,cancelable:!0},r_="RovingFocusGroup",[pO,dae,oHe]=K5(r_),[lHe,ov]=Pi(r_,[oHe]),[cHe,uHe]=lHe(r_),fae=E.forwardRef((e,t)=>f.jsx(pO.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(pO.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(dHe,{...e,ref:t})})}));fae.displayName=r_;var dHe=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=E.useRef(null),p=Tn(t,h),g=Og(i),[y,v]=pc({prop:a,defaultProp:o??null,onChange:l,caller:r_}),[x,w]=E.useState(!1),S=Ms(c),_=dae(n),k=E.useRef(!1),[T,A]=E.useState(0);return E.useEffect(()=>{const R=h.current;if(R)return R.addEventListener(B3,S),()=>R.removeEventListener(B3,S)},[S]),f.jsx(cHe,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:y,onItemFocus:E.useCallback(R=>v(R),[v]),onItemShiftTab:E.useCallback(()=>w(!0),[]),onFocusableItemAdd:E.useCallback(()=>A(R=>R+1),[]),onFocusableItemRemove:E.useCallback(()=>A(R=>R-1),[]),children:f.jsx(Zn.div,{tabIndex:x||T===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{k.current=!0}),onFocus:Wt(e.onFocus,R=>{const M=!k.current;if(R.target===R.currentTarget&&M&&!x){const j=new CustomEvent(B3,aHe);if(R.currentTarget.dispatchEvent(j),!j.defaultPrevented){const F=_().filter(D=>D.focusable),P=F.find(D=>D.active),q=F.find(D=>D.id===y),V=[P,q,...F].filter(Boolean).map(D=>D.ref.current);mae(V,u)}}k.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),hae="RovingFocusGroupItem",pae=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=_a(),c=i||l,u=uHe(hae,n),d=u.currentTabStopId===c,h=dae(n),{onFocusableItemAdd:p,onFocusableItemRemove:g,currentTabStopId:y}=u;return E.useEffect(()=>{if(r)return p(),()=>g()},[r,p,g]),f.jsx(pO.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(Zn.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=pHe(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(_=>_.focusable).map(_=>_.ref.current);if(x==="last")S.reverse();else if(x==="prev"||x==="next"){x==="prev"&&S.reverse();const _=S.indexOf(v.currentTarget);S=u.loop?mHe(S,_+1):S.slice(_+1)}setTimeout(()=>mae(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:y!=null}):a})})});pae.displayName=hae;var fHe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function hHe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function pHe(e,t,n){const r=hHe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return fHe[r]}function mae(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function mHe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var D6=fae,F6=pae,tN="Tabs",[gHe,Tvt]=Pi(tN,[ov]),gae=ov(),[yHe,L6]=gHe(tN),yae=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=Og(o),[d,h]=pc({prop:r,onChange:s,defaultProp:i??"",caller:tN});return f.jsx(yHe,{scope:n,baseId:_a(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(Zn.div,{dir:u,"data-orientation":a,...c,ref:t})})});yae.displayName=tN;var bae="TabsList",vae=E.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=L6(bae,n),a=gae(n);return f.jsx(D6,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(Zn.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});vae.displayName=bae;var xae="TabsTrigger",wae=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=L6(xae,n),o=gae(n),l=Cae(a.baseId,r),c=kae(a.baseId,r),u=r===a.value;return f.jsx(F6,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(Zn.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});wae.displayName=xae;var Sae="TabsContent",_ae=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=L6(Sae,n),l=Cae(o.baseId,r),c=kae(o.baseId,r),u=r===o.value,d=E.useRef(u);return E.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(ca,{present:s||u,children:({present:h})=>f.jsx(Zn.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});_ae.displayName=Sae;function Cae(e,t){return`${e}-trigger-${t}`}function kae(e,t){return`${e}-content-${t}`}var bHe=yae,vHe=vae,xHe=wae,wHe=_ae;function SHe({className:e,...t}){return f.jsx(bHe,{"data-slot":"tabs",className:Ye("flex flex-col gap-2",e),...t})}function _He({className:e,...t}){return f.jsx(vHe,{"data-slot":"tabs-list",className:Ye("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function CHe({className:e,...t}){return f.jsx(xHe,{"data-slot":"tabs-trigger",className:Ye("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function kHe({className:e,...t}){return f.jsx(wHe,{"data-slot":"tabs-content",className:Ye("flex-1 outline-none",e),...t})}const jo=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var p;const[l,c]=E.useState(n??t??((p=e[0])==null?void 0:p.value));E.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=g=>{c(g),r&&r(g)},d=Ye("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:g})=>{const v=Ye(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(ul,{className:v,children:g}):f.jsx("div",{className:v,children:g})};return f.jsxs(SHe,{value:l,onValueChange:u,defaultValue:t,className:Ye("flex flex-col h-full",s),children:[f.jsx(_He,{className:Ye("flex-shrink-0 sticky top-0 bg-background z-[var(--z-sticky)] flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(g=>f.jsx(CHe,{value:g.value,disabled:g.disabled,className:d,children:g.label},g.value))}),f.jsx(h,{children:e.map(g=>f.jsx(kHe,{value:g.value,className:"data-[state=inactive]:hidden h-full [transform:translateZ(0)]",children:g.content},g.value))})]})},Eae=E.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=pp(pn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=E.useMemo(()=>[...r.map(h=>{const p=h.component;return{value:h.id,label:h.title,content:f.jsx(p,{}),order:h.order??999}})].sort((h,p)=>(h.order??999)-(p.order??999)),[r]),i=E.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=E.useState(i());E.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),ke.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(vd,{open:e,onOpenChange:l,children:f.jsxs(xd,{className:Ye("min-w-[95vw] h-[95vh] flex flex-col p-0"),children:[f.jsxs(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 flex-shrink-0",children:[f.jsx(Sd,{className:"p-2",children:"Settings"}),f.jsx(Bf,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(jo,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow pb-4 md:pb-6",scrollable:!0},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(Fg,{className:"flex-shrink-0 border-t p-2 md:p-3 pt-1 md:pt-2 mt-auto",children:f.jsx(rt,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});Eae.displayName="SettingsModalComponent";const EHe=Eae;class THe{constructor(){ue(this,"id","core-settings-trigger");ue(this,"modalId","settingsModal");ue(this,"unregisterChatControlCallback",null);ue(this,"unregisterModalProviderCallback",null);ue(this,"modApiRef",null);ue(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Ir.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});ue(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Ir.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>We.createElement(RW,{module:this}),iconRenderer:()=>We.createElement(RW,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>We.createElement(EHe,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const AHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(Ave,{className:"h-4 w-4"}):f.jsx(Eve,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class NHe{constructor(){ue(this,"id","core-sidebar-toggle");ue(this,"unregisterCallback",null);ue(this,"notifyComponentUpdate",null);ue(this,"modApiRef",null);ue(this,"getIsSidebarCollapsed",()=>B1.getState().isSidebarCollapsed);ue(this,"toggleSidebar",t=>{var s,i;const n=B1.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Ir.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(AHe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function hb({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:p=>{const g=x=>{const w=x.target.value;if(w===""&&a)p.handleChange(null);else{const S=parseFloat(w);isNaN(S)?w===""&&!a&&p.handleChange(w):p.handleChange(S)}},y=typeof p.state.value=="number"?p.state.value.toString():(p.state.value===null&&a,""),v=x=>{p.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Ye("space-y-1.5",i),children:[" ",f.jsx(At,{htmlFor:p.name,className:"text-sm",children:n}),f.jsx(vn,{id:p.name,name:p.name,type:"number",value:y,onBlur:v,onChange:g,placeholder:r,disabled:s??p.form.state.isSubmitting,min:o,max:l,step:c,className:Ye(u,p.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(Gi,{field:p})]})}})}function Gc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...p}){return f.jsx(e.Field,{name:t,children:g=>{const y=typeof g.state.value=="number"?g.state.value:u??0,v=y.toFixed(i);return f.jsxs("div",{className:Ye("space-y-1.5",l),children:[f.jsxs(At,{htmlFor:g.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",g.state.value,")"]})]}),f.jsx(ay,{id:g.name,name:g.name,value:[y],onValueChange:x=>g.handleChange(x[0]),onBlur:g.handleBlur,disabled:o??g.form.state.isSubmitting,min:u,max:d,step:h,className:Ye(c,g.state.meta.errors.length?"border-destructive":""),...p}),f.jsx(Gi,{field:g})]})}})}const RHe=Ze({temperature:Nt().min(0).max(1),topP:Nt().min(0).max(1),maxTokens:Nt().min(1).nullable(),topK:Nt().min(1).nullable(),presencePenalty:Nt().min(-2).max(2),frequencyPenalty:Nt().min(-2).max(2)}),IHe=({module:e,className:t})=>{const n=Xs({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:RHe,onChangeAsyncDebounceMs:500}});E.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=We.useState({});E.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=E.useCallback((u,d,h)=>{var p;((p=n.getFieldMeta(u))==null?void 0:p.errors.length)===0&&d(h)},[n,e]),i=E.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const p=n.getFieldValue(u);d(p)}},[n,e]),a=E.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,p,g="N/A")=>{var y;return!l||p===void 0?null:f.jsxs(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,p??null),disabled:d===null,children:["Use Default (",((y=p==null?void 0:p.toFixed)==null?void 0:y.call(p,2))??g,")"]})};return f.jsxs("div",{className:Ye("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(Gc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Gc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(hb,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(hb,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Gc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Gc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},MHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(Tc,{children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(Xve,{className:"h-4 w-4"})})})}),f.jsx(Nr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(Nc,{className:"w-auto p-0",align:"start",children:f.jsx(IHe,{module:e})})]}):null};class jHe{constructor(){ue(this,"id","core-parameters");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"temperature",null);ue(this,"topP",null);ue(this,"maxTokens",null);ue(this,"topK",null);ue(this,"presencePenalty",null);ue(this,"frequencyPenalty",null);ue(this,"defaultTemperature",null);ue(this,"defaultTopP",null);ue(this,"defaultMaxTokens",null);ue(this,"defaultTopK",null);ue(this,"defaultPresencePenalty",null);ue(this,"defaultFrequencyPenalty",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"supportedParams",new Set);ue(this,"notifyComponentUpdate",null);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(an.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(an.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(an.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(an.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(an.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(an.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on($n.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(on.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(an.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=gr.getState(),n=Qa.getState();this.isStreaming=en.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Gn.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=uc(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=TZ(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=gr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(MHe,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const PHe=({module:e})=>{const t=E.useRef(null),[,n]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=E.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),p=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(p&&s){const g=new FileReader,y=new Promise((x,w)=>{g.onload=()=>x(g.result),g.onerror=S=>w(S)});g.readAsDataURL(u);const v=await y;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),ke.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(MT,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:o})]})})]})},OHe=({module:e})=>{const[,t]=E.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Ye("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(xQ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},Tae=20,DHe=Tae*1024*1024;class FHe{constructor(){ue(this,"id","core-file-attachment");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"isStreaming",!1);ue(this,"modelSupportsNonText",!0);ue(this,"attachedFiles",[]);ue(this,"notifyComponentUpdate",null);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);ue(this,"getAttachedFiles",()=>this.attachedFiles);ue(this,"isLikelyTextFile",(t,n)=>qw(t,n));ue(this,"onFileAdd",t=>{var r;if(t.size>DHe){ke.error(`File "${t.name}" exceeds the ${Tae}MB limit.`);return}if(!qw(t.name,t.type)&&!this.modelSupportsNonText){ke.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(ic.addAttachedFileRequest,t)});ue(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(ic.removeAttachedFileRequest,{attachmentId:t})});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=en.getState().status==="streaming",this.attachedFiles=Qh.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on($n.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(ic.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Gn.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(PHe,{module:this}),renderer:()=>We.createElement(OHe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const LHe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=Qh.getState().addAttachedFile,a=()=>{const o=oi.getState().selectedFileIds;if(o.size===0){ke.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(ke.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):ke.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:Ye("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx(MD,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs(rt,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(MT,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Nr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function zf({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Ye("w-full caption-bottom text-sm",e),...t})})}function $p({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Ye("[&_tr]:border-b",e),...t})}function Uf({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Ye("[&_tr:last-child]:border-0",e),...t})}function js({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Ye("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Pr({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Ye("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function zn({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Ye("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function $He({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Ye("text-muted-foreground mt-4 text-sm",e),...t})}const Aae=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(Zh,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(vn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(rt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"h-4 w-4"})}),f.jsx(rt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Ri,{className:"h-4 w-4"})})]})]}):f.jsxs(js,{className:"bg-muted/30",children:[f.jsx(zn,{className:"px-2 py-1"}),f.jsx(zn,{className:"px-2 py-1",children:f.jsx(Zh,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(zn,{className:"py-1 px-2",colSpan:3,children:f.jsx(vn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(zn,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Ri,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};function BHe(e){const t=zHe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(qHe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function zHe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=WHe(s),o=VHe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?jl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var UHe=Symbol("radix.slottable");function qHe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===UHe}function VHe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function WHe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var mO=["Enter"," "],HHe=["ArrowDown","PageUp","Home"],Nae=["ArrowUp","PageDown","End"],GHe=[...HHe,...Nae],KHe={ltr:[...mO,"ArrowRight"],rtl:[...mO,"ArrowLeft"]},YHe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},s_="Menu",[U1,ZHe,XHe]=K5(s_),[Lg,nN]=Pi(s_,[XHe,KT,ov]),rN=KT(),Rae=ov(),[JHe,$g]=Lg(s_),[QHe,i_]=Lg(s_),Iae=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=rN(t),[l,c]=E.useState(null),u=E.useRef(!1),d=Ms(i),h=Og(s);return E.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),f.jsx(JZ,{...o,children:f.jsx(JHe,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(QHe,{scope:t,onClose:E.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};Iae.displayName=s_;var eGe="MenuAnchor",$6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=rN(n);return f.jsx(QZ,{...s,...r,ref:t})});$6.displayName=eGe;var B6="MenuPortal",[tGe,Mae]=Lg(B6,{forceMount:void 0}),jae=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=$g(B6,t);return f.jsx(tGe,{scope:t,forceMount:n,children:f.jsx(ca,{present:n||i.open,children:f.jsx(YT,{asChild:!0,container:s,children:r})})})};jae.displayName=B6;var hc="MenuContent",[nGe,z6]=Lg(hc),Pae=E.forwardRef((e,t)=>{const n=Mae(hc,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=$g(hc,e.__scopeMenu),a=i_(hc,e.__scopeMenu);return f.jsx(U1.Provider,{scope:e.__scopeMenu,children:f.jsx(ca,{present:r||i.open,children:f.jsx(U1.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(rGe,{...s,ref:t}):f.jsx(sGe,{...s,ref:t})})})})}),rGe=E.forwardRef((e,t)=>{const n=$g(hc,e.__scopeMenu),r=E.useRef(null),s=Tn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return $A(i)},[]),f.jsx(U6,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),sGe=E.forwardRef((e,t)=>{const n=$g(hc,e.__scopeMenu);return f.jsx(U6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),iGe=BHe("MenuContent.ScrollLock"),U6=E.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...y}=e,v=$g(hc,n),x=i_(hc,n),w=rN(n),S=Rae(n),_=ZHe(n),[k,T]=E.useState(null),A=E.useRef(null),R=Tn(t,A,v.onContentChange),M=E.useRef(0),j=E.useRef(""),F=E.useRef(0),P=E.useRef(null),q=E.useRef("right"),I=E.useRef(0),V=g?YS:E.Fragment,D=g?{as:iGe,allowPinchZoom:!0}:void 0,z=Y=>{var Ee,he;const B=j.current+Y,G=_().filter(pe=>!pe.disabled),Z=document.activeElement,ne=(Ee=G.find(pe=>pe.ref.current===Z))==null?void 0:Ee.textValue,ae=G.map(pe=>pe.textValue),le=yGe(ae,B,ne),Se=(he=G.find(pe=>pe.textValue===le))==null?void 0:he.ref.current;(function pe(Le){j.current=Le,window.clearTimeout(M.current),Le!==""&&(M.current=window.setTimeout(()=>pe(""),1e3))})(B),Se&&setTimeout(()=>Se.focus())};E.useEffect(()=>()=>window.clearTimeout(M.current),[]),LA();const $=E.useCallback(Y=>{var G,Z;return q.current===((G=P.current)==null?void 0:G.side)&&vGe(Y,(Z=P.current)==null?void 0:Z.area)},[]);return f.jsx(nGe,{scope:n,searchRef:j,onItemEnter:E.useCallback(Y=>{$(Y)&&Y.preventDefault()},[$]),onItemLeave:E.useCallback(Y=>{var B;$(Y)||((B=A.current)==null||B.focus(),T(null))},[$]),onTriggerLeave:E.useCallback(Y=>{$(Y)&&Y.preventDefault()},[$]),pointerGraceTimerRef:F,onPointerGraceIntentChange:E.useCallback(Y=>{P.current=Y},[]),children:f.jsx(V,{...D,children:f.jsx(M6,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,Y=>{var B;Y.preventDefault(),(B=A.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(VT,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,children:f.jsx(D6,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:T,onEntryFocus:Wt(l,Y=>{x.isUsingKeyboardRef.current||Y.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(eX,{role:"menu","aria-orientation":"vertical","data-state":Zae(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...y,ref:R,style:{outline:"none",...y.style},onKeyDown:Wt(y.onKeyDown,Y=>{const G=Y.target.closest("[data-radix-menu-content]")===Y.currentTarget,Z=Y.ctrlKey||Y.altKey||Y.metaKey,ne=Y.key.length===1;G&&(Y.key==="Tab"&&Y.preventDefault(),!Z&&ne&&z(Y.key));const ae=A.current;if(Y.target!==ae||!GHe.includes(Y.key))return;Y.preventDefault();const Se=_().filter(Ee=>!Ee.disabled).map(Ee=>Ee.ref.current);Nae.includes(Y.key)&&Se.reverse(),mGe(Se)}),onBlur:Wt(e.onBlur,Y=>{Y.currentTarget.contains(Y.target)||(window.clearTimeout(M.current),j.current="")}),onPointerMove:Wt(e.onPointerMove,q1(Y=>{const B=Y.target,G=I.current!==Y.clientX;if(Y.currentTarget.contains(B)&&G){const Z=Y.clientX>I.current?"right":"left";q.current=Z,I.current=Y.clientX}}))})})})})})})});Pae.displayName=hc;var aGe="MenuGroup",q6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(Zn.div,{role:"group",...r,ref:t})});q6.displayName=aGe;var oGe="MenuLabel",Oae=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(Zn.div,{...r,ref:t})});Oae.displayName=oGe;var FE="MenuItem",OW="menu.itemSelect",sN=E.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=E.useRef(null),a=i_(FE,e.__scopeMenu),o=z6(FE,e.__scopeMenu),l=Tn(t,i),c=E.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(OW,{bubbles:!0,cancelable:!0});d.addEventListener(OW,p=>r==null?void 0:r(p),{once:!0}),NZ(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(Dae,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||mO.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});sN.displayName=FE;var Dae=E.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=z6(FE,n),o=Rae(n),l=E.useRef(null),c=Tn(t,l),[u,d]=E.useState(!1),[h,p]=E.useState("");return E.useEffect(()=>{const g=l.current;g&&p((g.textContent??"").trim())},[i.children]),f.jsx(U1.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(F6,{asChild:!0,...o,focusable:!r,children:f.jsx(Zn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,q1(g=>{r?a.onItemLeave(g):(a.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,q1(g=>a.onItemLeave(g))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),lGe="MenuCheckboxItem",Fae=E.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(Uae,{scope:e.__scopeMenu,checked:n,children:f.jsx(sN,{role:"menuitemcheckbox","aria-checked":LE(n)?"mixed":n,...s,ref:t,"data-state":W6(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r(LE(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Fae.displayName=lGe;var Lae="MenuRadioGroup",[cGe,uGe]=Lg(Lae,{value:void 0,onValueChange:()=>{}}),$ae=E.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Ms(r);return f.jsx(cGe,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(q6,{...s,ref:t})})});$ae.displayName=Lae;var Bae="MenuRadioItem",zae=E.forwardRef((e,t)=>{const{value:n,...r}=e,s=uGe(Bae,e.__scopeMenu),i=n===s.value;return f.jsx(Uae,{scope:e.__scopeMenu,checked:i,children:f.jsx(sN,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":W6(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});zae.displayName=Bae;var V6="MenuItemIndicator",[Uae,dGe]=Lg(V6,{checked:!1}),qae=E.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=dGe(V6,n);return f.jsx(ca,{present:r||LE(i.checked)||i.checked===!0,children:f.jsx(Zn.span,{...s,ref:t,"data-state":W6(i.checked)})})});qae.displayName=V6;var fGe="MenuSeparator",Vae=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(Zn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Vae.displayName=fGe;var hGe="MenuArrow",Wae=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=rN(n);return f.jsx(tX,{...s,...r,ref:t})});Wae.displayName=hGe;var pGe="MenuSub",[Avt,Hae]=Lg(pGe),rw="MenuSubTrigger",Gae=E.forwardRef((e,t)=>{const n=$g(rw,e.__scopeMenu),r=i_(rw,e.__scopeMenu),s=Hae(rw,e.__scopeMenu),i=z6(rw,e.__scopeMenu),a=E.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=E.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return E.useEffect(()=>u,[u]),E.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx($6,{asChild:!0,...c,children:f.jsx(Dae,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":Zae(n.open),...e,ref:jl(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,q1(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,q1(d=>{var p,g;u();const h=(p=n.content)==null?void 0:p.getBoundingClientRect();if(h){const y=(g=n.content)==null?void 0:g.dataset.side,v=y==="right",x=v?-5:5,w=h[v?"left":"right"],S=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:w,y:h.bottom}],side:y}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var p;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||KHe[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});Gae.displayName=rw;var Kae="MenuSubContent",Yae=E.forwardRef((e,t)=>{const n=Mae(hc,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=$g(hc,e.__scopeMenu),a=i_(hc,e.__scopeMenu),o=Hae(Kae,e.__scopeMenu),l=E.useRef(null),c=Tn(t,l);return f.jsx(U1.Provider,{scope:e.__scopeMenu,children:f.jsx(ca,{present:r||i.open,children:f.jsx(U1.Slot,{scope:e.__scopeMenu,children:f.jsx(U6,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),h=YHe[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(p=o.trigger)==null||p.focus(),u.preventDefault())})})})})})});Yae.displayName=Kae;function Zae(e){return e?"open":"closed"}function LE(e){return e==="indeterminate"}function W6(e){return LE(e)?"indeterminate":e?"checked":"unchecked"}function mGe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function gGe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function yGe(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=gGe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function bGe(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function vGe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return bGe(n,t)}function q1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Xae=Iae,Jae=$6,Qae=jae,eoe=Pae,toe=q6,noe=Oae,roe=sN,soe=Fae,ioe=$ae,aoe=zae,ooe=qae,loe=Vae,coe=Wae,uoe=Gae,doe=Yae,H6="ContextMenu",[xGe,Nvt]=Pi(H6,[nN]),Bo=nN(),[wGe,foe]=xGe(H6),hoe=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=E.useState(!1),l=Bo(t),c=Ms(r),u=E.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(wGe,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(Xae,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};hoe.displayName=H6;var poe="ContextMenuTrigger",moe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=foe(poe,n),a=Bo(n),o=E.useRef({x:0,y:0}),l=E.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=E.useRef(0),u=E.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return E.useEffect(()=>u,[u]),E.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Jae,{...a,virtualRef:l}),f.jsx(Zn.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,g2(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,g2(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,g2(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,g2(u))})]})});moe.displayName=poe;var SGe="ContextMenuPortal",goe=e=>{const{__scopeContextMenu:t,...n}=e,r=Bo(t);return f.jsx(Qae,{...r,...n})};goe.displayName=SGe;var yoe="ContextMenuContent",boe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=foe(yoe,n),i=Bo(n),a=E.useRef(!1);return f.jsx(eoe,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});boe.displayName=yoe;var _Ge="ContextMenuGroup",CGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(toe,{...s,...r,ref:t})});CGe.displayName=_Ge;var kGe="ContextMenuLabel",EGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(noe,{...s,...r,ref:t})});EGe.displayName=kGe;var TGe="ContextMenuItem",voe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(roe,{...s,...r,ref:t})});voe.displayName=TGe;var AGe="ContextMenuCheckboxItem",NGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(soe,{...s,...r,ref:t})});NGe.displayName=AGe;var RGe="ContextMenuRadioGroup",IGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(ioe,{...s,...r,ref:t})});IGe.displayName=RGe;var MGe="ContextMenuRadioItem",jGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(aoe,{...s,...r,ref:t})});jGe.displayName=MGe;var PGe="ContextMenuItemIndicator",OGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(ooe,{...s,...r,ref:t})});OGe.displayName=PGe;var DGe="ContextMenuSeparator",xoe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(loe,{...s,...r,ref:t})});xoe.displayName=DGe;var FGe="ContextMenuArrow",LGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(coe,{...s,...r,ref:t})});LGe.displayName=FGe;var $Ge="ContextMenuSubTrigger",BGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(uoe,{...s,...r,ref:t})});BGe.displayName=$Ge;var zGe="ContextMenuSubContent",UGe=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=Bo(n);return f.jsx(doe,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});UGe.displayName=zGe;function g2(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var qGe=hoe,VGe=moe,WGe=goe,HGe=boe,GGe=voe,KGe=xoe;function DW({...e}){return f.jsx(qGe,{"data-slot":"context-menu",...e})}function FW({...e}){return f.jsx(VGe,{"data-slot":"context-menu-trigger",...e})}function LW({className:e,...t}){return f.jsx(WGe,{children:f.jsx(HGe,{"data-slot":"context-menu-content",className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function _l({className:e,inset:t,variant:n="default",...r}){return f.jsx(GGe,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Ye("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function $W({className:e,...t}){return f.jsx(KGe,{"data-slot":"context-menu-separator",className:Ye("bg-border -mx-1 my-1 h-px",e),...t})}const YGe=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:p,setNewName:g,renameInputRef:y,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:S,handleGitStatus:_})=>{const k=e.type==="folder",T=F=>{F.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(k?o(e):l(!n,e.id))},A=F=>{F.key==="Enter"?d():F.key==="Escape"&&u()},R=k?r?uY:Zh:cY,M=k?r?"text-green-400":"text-yellow-400":"text-blue-400",j=f.jsxs(js,{className:Ye("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!k&&"cursor-pointer"),onClick:T,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(zn,{className:"px-2 py-1",children:f.jsx(au,{checked:n,onCheckedChange:F=>l(!!F,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||k})}),f.jsx(zn,{className:"px-2 py-1",children:f.jsx(R,{className:Ye("h-5 w-5",M)})}),f.jsx(zn,{className:"py-1 px-2",children:t?f.jsx(vn,{ref:y,value:s,onChange:F=>g(F.target.value),onBlur:d,onKeyDown:A,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:F=>F.stopPropagation(),disabled:i}):f.jsx("span",{className:Ye("truncate",k&&"cursor-pointer hover:underline"),title:e.name,onClick:F=>{k&&(F.stopPropagation(),o(e))},children:e.name})}),f.jsx(zn,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?i1(e.size):""}),f.jsx(zn,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(zn,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Ye("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:"Save (Enter)",onClick:F=>{F.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(Nn,{tooltipText:"Cancel (Esc)",onClick:F=>{F.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(Ri,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:"Rename",onClick:F=>{F.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(Ku,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Nn,{tooltipText:k?"Download folder (.zip)":"Download file",onClick:F=>{F.stopPropagation(),h(e)},"aria-label":k?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(cc,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(Nn,{tooltipText:"Delete",onClick:F=>{F.stopPropagation(),p(e)},"aria-label":`Delete ${k?"folder":"file"}`,disabled:i,icon:f.jsx(to,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return k?f.jsxs(DW,{children:[f.jsx(FW,{disabled:t||i,asChild:!0,children:j}),f.jsxs(LW,{children:[f.jsx(_l,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx($W,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(_l,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(hY,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(_l,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(fY,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(_l,{onSelect:()=>S(e.path),disabled:i,children:[f.jsx(ID,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(_l,{onSelect:()=>_(e.path),disabled:i,children:[f.jsx(jD,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(_l,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(eu,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx($W,{}),f.jsxs(_l,{onSelect:()=>c(e),disabled:i,children:[f.jsx(Ku,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(_l,{onSelect:()=>h(e),disabled:i,children:[f.jsx(cc,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(_l,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>p(e),disabled:i,children:[f.jsx(to,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(DW,{children:[f.jsx(FW,{disabled:t||i,asChild:!0,children:j}),f.jsxs(LW,{children:[f.jsxs(_l,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(_l,{onSelect:()=>c(e),disabled:i,children:[f.jsx(Ku,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(_l,{onSelect:()=>h(e),disabled:i,children:[f.jsx(cc,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(_l,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>p(e),disabled:i,children:[f.jsx(to,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},ZGe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:p,handleDownload:g,handleDelete:y,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:_,handleGitInit:k,handleGitPull:T,handleGitCommit:A,handleGitPush:R,handleGitStatus:M})=>{const j=E.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(zf,{className:"w-full text-sm",children:[f.jsx($p,{className:"sticky top-0 bg-card z-[var(--z-sticky)]",children:f.jsxs(js,{className:"hover:bg-card",children:[f.jsx(Pr,{className:"w-[40px] px-2"}),f.jsx(Pr,{className:"w-[40px] px-2"}),f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Pr,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Pr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(Uf,{children:[r&&f.jsx(Aae,{newFolderName:s,setNewFolderName:x,handleCreateFolder:p,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),j.map(F=>{const P=t===F.path,q=i.has(F.id),I=_[F.path]??!1;return f.jsx(YGe,{entry:F,isEditingThis:P,isChecked:q,isGitRepo:I,newName:P?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:g,handleDelete:y,setNewName:v,renameInputRef:w,handleGitInit:k,handleGitPull:T,handleGitCommit:A,handleGitPush:R,handleGitStatus:M},F.id)}),e.length===0&&!r&&!a&&f.jsx(js,{children:f.jsx(zn,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},XGe=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:p,handleCloneClick:g,fileInputRef:y,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:S})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:y,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:S,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(rt,{variant:"ghost",size:"icon",onClick:_=>{_.preventDefault(),_.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(ive,{className:"h-4 w-4"})}),f.jsx(rt,{variant:"ghost",size:"icon",onClick:_=>{_.preventDefault(),_.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(zbe,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(rt,{variant:"ghost",size:"icon",onClick:_=>{_.preventDefault(),_.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Jm,{className:"h-4 w-4"})}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:_=>{_.preventDefault(),_.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(dY,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:_=>{_.preventDefault(),_.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(ND,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:_=>{_.preventDefault(),_.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Zh,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:_=>{_.preventDefault(),_.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Ebe,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:_=>{_.preventDefault(),_.stopPropagation(),g()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(eu,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:_=>{_.preventDefault(),_.stopPropagation(),p()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(iY,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),woe=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(vd,{open:e,onOpenChange:t,children:f.jsxs(xd,{className:Ye(c),children:[f.jsxs(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 flex-shrink-0",children:[f.jsx(Sd,{className:"p-2",children:n}),r&&f.jsx(Bf,{children:r})]}),f.jsx("div",{className:Ye("py-4",u),children:s}),f.jsxs(Fg,{className:"p-2 md:p-3 pt-1 md:pt-2",children:[f.jsx(sHe,{asChild:!0,children:f.jsx(rt,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(rt,{onClick:d,disabled:o||l,children:[o&&f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},JGe=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(woe,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(At,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(vn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(At,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(vn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),QGe=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(woe,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(At,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(vn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var iN="DropdownMenu",[eKe,Rvt]=Pi(iN,[nN]),zo=nN(),[tKe,Soe]=eKe(iN),_oe=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=zo(t),c=E.useRef(null),[u,d]=pc({prop:s,defaultProp:i??!1,onChange:a,caller:iN});return f.jsx(tKe,{scope:t,triggerId:_a(),triggerRef:c,contentId:_a(),open:u,onOpenChange:d,onOpenToggle:E.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(Xae,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};_oe.displayName=iN;var Coe="DropdownMenuTrigger",koe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=Soe(Coe,n),a=zo(n);return f.jsx(Jae,{asChild:!0,...a,children:f.jsx(Zn.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:jl(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});koe.displayName=Coe;var nKe="DropdownMenuPortal",Eoe=e=>{const{__scopeDropdownMenu:t,...n}=e,r=zo(t);return f.jsx(Qae,{...r,...n})};Eoe.displayName=nKe;var Toe="DropdownMenuContent",Aoe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Soe(Toe,n),i=zo(n),a=E.useRef(!1);return f.jsx(eoe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Aoe.displayName=Toe;var rKe="DropdownMenuGroup",sKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(toe,{...s,...r,ref:t})});sKe.displayName=rKe;var iKe="DropdownMenuLabel",aKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(noe,{...s,...r,ref:t})});aKe.displayName=iKe;var oKe="DropdownMenuItem",Noe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(roe,{...s,...r,ref:t})});Noe.displayName=oKe;var lKe="DropdownMenuCheckboxItem",cKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(soe,{...s,...r,ref:t})});cKe.displayName=lKe;var uKe="DropdownMenuRadioGroup",dKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(ioe,{...s,...r,ref:t})});dKe.displayName=uKe;var fKe="DropdownMenuRadioItem",hKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(aoe,{...s,...r,ref:t})});hKe.displayName=fKe;var pKe="DropdownMenuItemIndicator",mKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(ooe,{...s,...r,ref:t})});mKe.displayName=pKe;var gKe="DropdownMenuSeparator",Roe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(loe,{...s,...r,ref:t})});Roe.displayName=gKe;var yKe="DropdownMenuArrow",bKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(coe,{...s,...r,ref:t})});bKe.displayName=yKe;var vKe="DropdownMenuSubTrigger",xKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(uoe,{...s,...r,ref:t})});xKe.displayName=vKe;var wKe="DropdownMenuSubContent",SKe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=zo(n);return f.jsx(doe,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});SKe.displayName=wKe;var _Ke=_oe,CKe=koe,kKe=Eoe,EKe=Aoe,TKe=Noe,AKe=Roe;function NKe({...e}){return f.jsx(_Ke,{"data-slot":"dropdown-menu",...e})}function RKe({...e}){return f.jsx(CKe,{"data-slot":"dropdown-menu-trigger",...e})}function IKe({className:e,sideOffset:t=4,...n}){return f.jsx(kKe,{children:f.jsx(EKe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Ye("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function Au({className:e,inset:t,variant:n="default",...r}){return f.jsx(TKe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Ye("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function BW({className:e,...t}){return f.jsx(AKe,{"data-slot":"dropdown-menu-separator",className:Ye("bg-border -mx-1 my-1 h-px",e),...t})}const MKe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:p,handleDownload:g,handleDelete:y,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:_,handleGitInit:k,handleGitPull:T,handleGitCommit:A,handleGitPush:R,handleGitStatus:M})=>{const j=F=>{F.key==="Enter"?d():F.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(Aae,{newFolderName:s,setNewFolderName:x,handleCreateFolder:p,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(F=>{const P=t===F.path,q=i.has(F.id),I=_[F.path]??!1,V=F.type==="folder",D=V?I?uY:Zh:cY,z=V?I?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Ye("flex items-center justify-between p-2 border rounded-md",P&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!P&&"hover:bg-muted/50",!P&&"cursor-pointer"),onClick:()=>{P||a||(V?o(F):l(!q,F.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!V&&f.jsx(au,{checked:q,onCheckedChange:$=>l(!!$,F.id),"aria-label":`Select ${F.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:$=>$.stopPropagation()}),V&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(D,{className:Ye("h-5 w-5 flex-shrink-0",z)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[P?f.jsx(vn,{ref:w,value:n,onChange:$=>v($.target.value),onBlur:d,onKeyDown:j,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:$=>$.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:F.name,children:F.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:F.type==="file"&&F.size!==void 0?i1(F.size):F.type==="folder"?I?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:P?f.jsxs(f.Fragment,{children:[f.jsx(rt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:$=>{$.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"h-4 w-4"})}),f.jsx(rt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:$=>{$.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(Ri,{className:"h-4 w-4"})})]}):f.jsxs(NKe,{children:[f.jsx(RKe,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:$=>$.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(Cbe,{className:"h-4 w-4"})})}),f.jsxs(IKe,{align:"end",onClick:$=>$.stopPropagation(),children:[V&&f.jsx(Au,{onSelect:()=>o(F),children:"Open Folder"}),!V&&f.jsxs(Au,{onSelect:()=>l(!q,F.id),children:[q?"Deselect":"Select"," File"]}),f.jsxs(Au,{onSelect:()=>c(F),children:[f.jsx(Ku,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(Au,{onSelect:()=>g(F),children:[f.jsx(cc,{className:"mr-2 h-4 w-4"})," Download"," ",V?"as ZIP":""]}),V&&f.jsx(BW,{}),V&&I&&f.jsxs(f.Fragment,{children:[f.jsxs(Au,{onSelect:()=>T(F.path),children:[f.jsx(hY,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(Au,{onSelect:()=>A(F.path),children:[f.jsx(fY,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(Au,{onSelect:()=>R(F.path),children:[f.jsx(ID,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(Au,{onSelect:()=>M(F.path),children:[f.jsx(jD,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),V&&!I&&f.jsxs(Au,{onSelect:()=>k(F.path),children:[f.jsx(eu,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(BW,{}),f.jsxs(Au,{className:"text-red-600 focus:text-red-600",onSelect:()=>y(F),children:[f.jsx(to,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},F.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},G6=E.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=oi(pn(Te=>({nodes:Te.nodes,childrenMap:Te.childrenMap,currentParentId:Te.currentParentId,selectedFileIds:Te.selectedFileIds,loading:Te.loading,operationLoading:Te.operationLoading,error:Te.error,rootId:Te.rootId,vfsKey:Te.vfsKey,configuredVfsKey:Te.configuredVfsKey,initializingKey:Te.initializingKey}))),[d,h]=E.useState(""),[p,g]=E.useState(null),[y,v]=E.useState(!1),[x,w]=E.useState(""),[S,_]=E.useState({}),[k,T]=E.useState(!1),[A,R]=E.useState(""),[M,j]=E.useState(""),[F,P]=E.useState(!1),[q,I]=E.useState(!1),[V,D]=E.useState(null),[z,$]=E.useState(""),[Y,B]=E.useState(!1),[G,Z]=E.useState({}),ne=E.useRef(null),ae=E.useRef(null),le=E.useRef(null),Se=E.useRef(null),Ee=E.useRef(null),he=n?e[n]:null,pe=he?he.path:"/",He=(t[n||a||""]||[]).map(Te=>e[Te]).filter(Te=>!!Te).sort((Te,Ue)=>Te.type==="folder"&&Ue.type==="file"?-1:Te.type==="file"&&Ue.type==="folder"?1:Te.name.localeCompare(Ue.name)),Fe=E.useMemo(()=>He.filter(Te=>Te.type==="folder").map(Te=>Te.path),[He]),Ie=r||u!==null||l!==c,X=s||F||Y||Object.values(G).some(Boolean);E.useEffect(()=>{n!==null&&!t[n]&&!Ie&&c===l?Ae.emit(hn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Ie&&c===l&&Ae.emit(hn.fetchNodesRequest,{parentId:a})},[n,t,a,Ie,c,l]),E.useEffect(()=>{var Te,Ue;p&&((Te=Se.current)==null||Te.focus(),(Ue=Se.current)==null||Ue.select())},[p]),E.useEffect(()=>{var Te;y&&((Te=Ee.current)==null||Te.focus())},[y]),E.useEffect(()=>{(async()=>{if(Ie||Fe.length===0)return;const Ue={};let Ct=!1;for(const me of Fe)try{const Q=await DIe(me);S[me]!==Q&&(Ue[me]=Q,Ct=!0)}catch(Q){console.error(`Error checking git status for ${me}:`,Q),S[me]!==!1&&(Ue[me]=!1,Ct=!0)}Ct&&_(me=>({...me,...Ue}))})()},[Fe,Ie,S]);const ye=E.useCallback(async(Te,Ue,Ct)=>{if(!(X||Ie)){Ct!==!1&&Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Ae.emit(Te,Ue)}catch(me){console.error("[FileManager Operation Error]:",me),Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:me instanceof Error?me.message:String(me)})}finally{Ct!==!1&&Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[X,Ie,r,s,i]),Ne=E.useCallback(Te=>{X||Ie||p||Te.type==="folder"&&ye(hn.setCurrentPathRequest,{path:Te.path},!1)},[X,Ie,p,ye]),fe=E.useCallback(()=>{if(X||Ie||pe==="/")return;const Te=gA(pe);ye(hn.setCurrentPathRequest,{path:Te},!1)},[X,Ie,pe,ye]),ce=E.useCallback(()=>{X||Ie||pe==="/"||ye(hn.setCurrentPathRequest,{path:"/"},!1)},[X,Ie,pe,ye]),se=E.useCallback(()=>{Ie||ye(hn.fetchNodesRequest,{parentId:n},!1)},[ye,n,Ie]),Pe=E.useCallback((Te,Ue)=>{const Ct=e[Ue];Ct&&Ct.type==="file"?Te?Ae.emit(hn.selectFileRequest,{fileId:Ue}):Ae.emit(hn.deselectFileRequest,{fileId:Ue}):Ct&&Ct.type==="folder"&&ke.info("Folders cannot be attached to the prompt.")},[e]),Be=E.useCallback(Te=>{X||Ie||y||(g(Te.path),h(Te.name),v(!1))},[X,Ie,y]),je=E.useCallback(()=>{g(null),h("")},[]),ot=E.useCallback(async()=>{if(!p||!d.trim()){je();return}const Te=Object.values(e).find(Ue=>Ue.path===p);Te&&Te.name!==d.trim()&&await ye(hn.renameNodeRequest,{id:Te.id,newName:d.trim()}),je()},[p,d,e,je,ye]),Et=E.useCallback(()=>{X||Ie||p||(v(!0),w(""),g(null))},[X,Ie,p]),ut=E.useCallback(()=>{v(!1),w("")},[]),Pt=E.useCallback(async()=>{if(!x.trim()){ut();return}await ye(hn.createDirectoryRequest,{parentId:n,name:x.trim()}),ut()},[x,n,ut,ye]),$t=()=>{var Te;return(Te=ne.current)==null?void 0:Te.click()},Ft=()=>{var Te;return(Te=ae.current)==null?void 0:Te.click()},Ht=()=>{var Te;return(Te=le.current)==null?void 0:Te.click()},Ce=E.useCallback(async Te=>{const Ue=Te.target.files;Ue&&Ue.length>0&&(await ye(hn.uploadFilesRequest,{parentId:n,files:Ue}),Te.target&&(Te.target.value=""))},[n,ye]),U=E.useCallback(async Te=>{var Ct;const Ue=(Ct=Te.target.files)==null?void 0:Ct[0];if(Ue){Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await $Ie(Ue,pe),Ae.emit(hn.fetchNodesRequest,{parentId:n})}catch(me){console.error("Archive upload error:",me)}finally{Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),Te.target&&(Te.target.value="")}}},[pe,n,r,i]),ee=E.useCallback(async Te=>{window.confirm(`Delete ${Te.type} "${Te.name}"?${Te.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await ye(hn.deleteNodesRequest,{ids:[Te.id]})},[ye]),xe=E.useCallback(async Te=>{Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Te.type==="file"?await LIe(Te.path):await IU(`${Te.name}.zip`,Te.path)}catch(Ue){console.error("Download error:",Ue)}finally{Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),Re=E.useCallback(async()=>{if(He.length!==0){Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const Te=Ai(pe)||"root";await IU(`${Te}_export.zip`,pe)}catch(Te){console.error("Download all error:",Te)}finally{Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[pe,He.length,r,i]),ve=E.useCallback(async(Te,Ue)=>{if(!(G[Te]||Ie||s)){Z(Ct=>({...Ct,[Te]:!0})),Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await Ue()}catch(Ct){console.error(`[FileManager Git Op Error @ ${Te}]:`,Ct)}finally{Z(Ct=>({...Ct,[Te]:!1}))}}},[G,Ie,s,r]),Me=E.useCallback(Te=>{ve(Te,async()=>{await mQ(Te),_(Ue=>({...Ue,[Te]:!0}))})},[ve]),de=E.useCallback(Te=>{ke.info("Pulling default branch (auth not implemented yet)..."),ve(Te,()=>SA(Te,"main"))},[ve]),ht=E.useCallback(Te=>{D(Te),$(""),I(!0)},[]),et=E.useCallback(Te=>{ke.info("Pushing default branch (auth not implemented yet)..."),ve(Te,()=>l5(Te,"main"))},[ve]),W=E.useCallback(Te=>{ve(Te,()=>gQ(Te))},[ve]),Ve=E.useCallback(()=>{R(""),j(""),T(!0)},[]),tt=E.useCallback(async()=>{if(!A.trim()){ke.error("Repository URL cannot be empty.");return}P(!0),Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const Te=Ai(A.trim().replace(/\.git$/,""))||"cloned_repo",Ue=p4(pe,Te);await pQ(Ue,A.trim(),M.trim()||void 0),T(!1),Ae.emit(hn.fetchNodesRequest,{parentId:n})}catch{}finally{P(!1)}},[A,M,pe,n,r,s]),we=E.useCallback(async()=>{if(!V||!z.trim()){ke.error("Commit message cannot be empty.");return}B(!0),Ae.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await o5(V,z.trim()),I(!1)}catch{}finally{B(!1)}},[V,z,r,s]);return Ie?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Yn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Ie?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(rt,{variant:"outline",size:"sm",onClick:()=>Ae.emit(hn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Ye("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(XGe,{currentPath:pe,isAnyLoading:X||Ie,isOperationLoading:s,entries:He,editingPath:p,creatingFolder:y,handleNavigateHome:ce,handleNavigateUp:fe,handleRefresh:se,startCreatingFolder:Et,handleUploadClick:$t,handleFolderUploadClick:Ft,handleArchiveUploadClick:Ht,handleDownloadAll:Re,handleCloneClick:Ve,fileInputRef:ne,folderInputRef:ae,archiveInputRef:le,handleFileChange:Ce,handleArchiveChange:U}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(ZGe,{entries:He,editingPath:p,newName:d,creatingFolder:y,newFolderName:x,selectedFileIds:o,isOperationLoading:X,handleNavigate:Ne,handleCheckboxChange:Pe,startEditing:Be,cancelEditing:je,handleRename:ot,cancelCreatingFolder:ut,handleCreateFolder:Pt,handleDownload:xe,handleDelete:ee,setNewName:h,setNewFolderName:w,renameInputRef:Se,newFolderInputRef:Ee,gitRepoStatus:S,handleGitInit:Me,handleGitPull:de,handleGitCommit:ht,handleGitPush:et,handleGitStatus:W})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx(MKe,{entries:He,editingPath:p,newName:d,creatingFolder:y,newFolderName:x,selectedFileIds:o,isOperationLoading:X,handleNavigate:Ne,handleCheckboxChange:Pe,startEditing:Be,cancelEditing:je,handleRename:ot,cancelCreatingFolder:ut,handleCreateFolder:Pt,handleDownload:xe,handleDelete:ee,setNewName:h,setNewFolderName:w,renameInputRef:Se,newFolderInputRef:Ee,gitRepoStatus:S,handleGitInit:Me,handleGitPull:de,handleGitCommit:ht,handleGitPush:et,handleGitStatus:W})}),f.jsx(JGe,{isOpen:k,onOpenChange:T,cloneRepoUrl:A,setCloneRepoUrl:R,cloneBranch:M,setCloneBranch:j,isCloning:F,onSubmitClone:tt,currentPath:pe}),f.jsx(QGe,{isOpen:q,onOpenChange:I,commitPath:V,commitMessage:z,setCommitMessage:$,isCommitting:Y,onSubmitCommit:we})]})});G6.displayName="FileManager";const jKe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(Pz,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(Pz,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(Zh,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,PKe=({module:e,isOpen:t,onClose:n})=>{const[r,s]=E.useState(e.getSelectedFileIdsCount()),[i,a]=E.useState(null);E.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Ae.on(hn.selectionChanged,u),Ae.on(rr.selectedItemChanged,d),()=>{Ae.off(hn.selectionChanged,u),Ae.off(rr.selectedItemChanged,d)}},[]);const o=oi.getState().vfsKey,l=()=>{const u=oi.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){ke.info("No files selected in VFS to attach.");return}let h=0;u.forEach(p=>{const g=d[p];g&&g.type==="file"&&(Ae.emit(ic.addAttachedFileRequest,{source:"vfs",name:g.name,type:g.mimeType||"application/octet-stream",size:g.size,path:g.path}),h++)}),h>0?(ke.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):ke.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(vd,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(xd,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 border-b flex-shrink-0",children:[f.jsx(Sd,{className:"p-2",children:"Virtual Filesystem"}),f.jsx(Bf,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(jKe,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(G6,{})}),f.jsxs(Fg,{className:"p-2 md:p-3 pt-1 md:pt-2 border-t flex-shrink-0",children:[f.jsx(rt,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(rt,{onClick:l,disabled:r===0,children:[f.jsx(MT,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class OKe{constructor(){ue(this,"id","core-vfs");ue(this,"modalId","core-vfs-modal-panel");ue(this,"unregisterCallbacks",[]);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"notifyTriggerUpdate",null);ue(this,"isModalOpenByManager",!1);ue(this,"getEnableVfs",()=>oi.getState().enableVfs);ue(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);ue(this,"getSelectedFileIdsCount",()=>oi.getState().selectedFileIds.size);ue(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Ir.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Ir.openModalRequest,{modalId:this.modalId})});ue(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(hn.clearSelectionRequest,void 0)});ue(this,"getVfsNodes",()=>oi.getState().nodes);ue(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Ir.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Ir.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=On.getState(),r=oi.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=On.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=On.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(hn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>We.createElement(LHe,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>We.createElement(PKe,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const DKe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=E.useState(null),[c,u]=E.useState("idle"),[d,h]=E.useState(!1),[p,g]=E.useState(!1);E.useEffect(()=>{if(r==="conversation"&&n){const T=e.getConversationById(n);l((T==null?void 0:T.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const y=We.useMemo(()=>new Map(s.map(T=>[T.id,T.name])),[s]),v=o?y.get(o):void 0,x=E.useCallback(async T=>{if(!n||r!=="conversation")return;h(!0);const A=T==="none"?null:T;await e.linkConversationToRepo(n,A),h(!1)},[n,r,e]),w=E.useCallback(async()=>{!n||!o||(g(!0),await e.syncConversation(n),g(!1))},[n,o,e]),S=zie(c,v),_=!o||p||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(Tc,{children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||p,"aria-label":"Configure Git Sync",children:c==="syncing"||p||d?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(eu,{className:"h-4 w-4"})})})}),f.jsx(Nr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(Nc,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(At,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(mc,{value:o??"none",onValueChange:x,disabled:d||p||a,children:[f.jsx(yc,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(gc,{placeholder:"Select repository..."})}),f.jsxs(bc,{children:[f.jsx(yi,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(T=>f.jsx(yi,{value:T.id,children:T.name},T.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),f.jsxs(rt,{size:"sm",variant:"outline",onClick:w,disabled:_,className:"h-8",children:[p||c==="syncing"?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(ID,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},sw=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Ye("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Ye("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Ye("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Ye(a),children:n})]}),FKe=Ze({gitUserName:qe().min(1,"User name cannot be empty."),gitUserEmail:qe().email("Invalid email address.")});function zW({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const LKe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=gr(pn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=Xs({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:FKe},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),ke.success("Git user configuration updated!")}catch(a){ke.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return E.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(sw,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:i.name,children:"Git User Name"}),f.jsx(vn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(zW,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:i.name,children:"Git User Email"}),f.jsx(vn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(zW,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(rt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},$Ke=We.memo(LKe);var BKe="Separator",UW="horizontal",zKe=["horizontal","vertical"],Ioe=E.forwardRef((e,t)=>{const{decorative:n,orientation:r=UW,...s}=e,i=UKe(r)?r:UW,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(Zn.div,{"data-orientation":i,...o,...s,ref:t})});Ioe.displayName=BKe;function UKe(e){return zKe.includes(e)}var qKe=Ioe;function dg({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(qKe,{"data-slot":"separator-root",decorative:n,orientation:t,className:Ye("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const VKe=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=E.useState(null),[u,d]=E.useState(!1);E.useEffect(()=>{const S=A=>{A&&A.progress&&(c(A.progress),d(!0))},_=A=>{A&&A.progress&&c(A.progress)},k=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},2e3))},T=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Ae.on(gs.bulkSyncStarted,S),Ae.on(gs.bulkSyncProgress,_),Ae.on(gs.bulkSyncCompleted,k),Ae.on(gs.bulkSyncFailed,T),()=>{Ae.off(gs.bulkSyncStarted,S),Ae.off(gs.bulkSyncProgress,_),Ae.off(gs.bulkSyncCompleted,k),Ae.off(gs.bulkSyncFailed,T)}},[]);const h=s||u,p=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,g=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,y=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},v=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},x=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},w=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return f.jsxs(Ba,{className:"w-full",children:[f.jsxs(ro,{className:"pb-3",children:[f.jsxs(so,{className:"flex items-center gap-2",children:[f.jsx(eu,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx(dc,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs(za,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Ye("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(dg,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(cs,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(ub,{value:p,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(ub,{value:g,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(No,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,_)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},_)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(dg,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(Er,{children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs(rt,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(cc,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Nr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(Er,{children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs(rt,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(gY,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Nr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(Er,{children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs(rt,{onClick:y,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(Jm,{className:Ye("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Nr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(rt,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(obe,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},WKe=Ze({name:qe().min(1,"Repository Name is required."),remoteUrl:qe().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:qe().min(1,"Branch name is required (e.g., main)."),username:qe().nullable().optional(),password:qe().nullable().optional()}),y2={name:"",remoteUrl:"",branch:"main",username:null,password:null},HKe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=On(pn(_=>({syncRepos:_.syncRepos,addSyncRepo:_.addSyncRepo,updateSyncRepo:_.updateSyncRepo,repoInitializationStatus:_.repoInitializationStatus,isLoading:_.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=gr(pn(_=>({autoSyncOnStreamComplete:_.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:_.setAutoSyncOnStreamComplete}))),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState({});E.useEffect(()=>{const _=k=>{k&&k.action==="deleted"&&k.repoId&&h(T=>({...T,[k.repoId]:!1}))};return Ae.on(gs.repoChanged,_),()=>Ae.off(gs.repoChanged,_)},[]);const p=Xs({defaultValues:y2,validators:{onChangeAsync:WKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:_})=>{var k,T,A,R;if(!((k=_.name)!=null&&k.trim())||!((T=_.remoteUrl)!=null&&T.trim())){ke.error("Repository Name and Remote URL are required.");return}try{const M={name:_.name.trim(),remoteUrl:_.remoteUrl.trim(),branch:((A=_.branch)==null?void 0:A.trim())||"main",username:((R=_.username)==null?void 0:R.trim())||null,password:_.password||null};c?await n(c,M):await t(M),g()}catch(M){console.error("Failed to save sync repo:",M)}}}),g=E.useCallback(()=>{p.reset(y2),l(!1),u(null)},[p]);E.useEffect(()=>{if(c){const _=e.find(k=>k.id===c);_?(p.reset({name:_.name,remoteUrl:_.remoteUrl,branch:_.branch||"main",username:_.username??null,password:_.password??null}),l(!1)):g()}else o||p.reset(y2)},[c,e,p,o,g]);const y=_=>{u(_.id),l(!1)},v=E.useCallback((_,k)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${k}"? This will unlink it from any conversations and remove the local copy.`)){h(T=>({...T,[_]:!0}));try{Ae.emit(rr.deleteSyncRepoRequest,{id:_}),c===_&&g()}catch(T){console.error("Failed to delete sync repo:",T),h(A=>({...A,[_]:!1}))}}},[c,g]),x=E.useCallback(_=>{Ae.emit(rr.initializeOrSyncRepoRequest,{repoId:_})},[]),w=()=>{u(null),p.reset(y2),l(!0)},S=()=>f.jsxs("form",{onSubmit:_=>{_.preventDefault(),_.stopPropagation(),p.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(p.Field,{name:"name",children:_=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(At,{htmlFor:_.name,children:"Name"}),f.jsx(vn,{id:_.name,value:_.state.value??"",onChange:k=>_.handleChange(k.target.value),onBlur:_.handleBlur,placeholder:"e.g., My Backup",disabled:p.state.isSubmitting}),f.jsx(Gi,{field:_})]})}),f.jsx(p.Field,{name:"remoteUrl",children:_=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(At,{htmlFor:_.name,children:"Remote URL (HTTPS)"}),f.jsx(vn,{id:_.name,type:"url",value:_.state.value??"",onChange:k=>_.handleChange(k.target.value),onBlur:_.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:p.state.isSubmitting}),f.jsx(Gi,{field:_})]})}),f.jsx(p.Field,{name:"branch",children:_=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(At,{htmlFor:_.name,children:"Branch"}),f.jsx(vn,{id:_.name,value:_.state.value??"",onChange:k=>_.handleChange(k.target.value),onBlur:_.handleBlur,placeholder:"main",disabled:p.state.isSubmitting}),f.jsx(Gi,{field:_})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(At,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(jA,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(DD,{className:"h-4 w-4"}),f.jsx(R5,{children:"Security Warning"}),f.jsx(PA,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(p.Field,{name:"username",children:_=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:_.name,children:"Username"}),f.jsx(vn,{id:_.name,value:_.state.value??"",onChange:k=>_.handleChange(k.target.value),onBlur:_.handleBlur,placeholder:"Git Username (Optional)",disabled:p.state.isSubmitting,autoComplete:"off"}),f.jsx(Gi,{field:_})]})}),f.jsx(p.Field,{name:"password",children:_=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:_.name,children:"Password / Token"}),f.jsx(vn,{id:_.name,type:"password",value:_.state.value??"",onChange:k=>_.handleChange(k.target.value),onBlur:_.handleBlur,placeholder:"Password or PAT (Optional)",disabled:p.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Gi,{field:_})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(rt,{variant:"ghost",size:"sm",onClick:g,disabled:p.state.isSubmitting,type:"button",children:[f.jsx(Ri,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(p.Subscribe,{selector:_=>[_.canSubmit,_.isSubmitting,_.isValidating,_.isValid],children:([_,k,T,A])=>f.jsxs(rt,{variant:"secondary",size:"sm",type:"submit",disabled:k||!_||!A||T,children:[(k||T)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"})," ",k||T?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(Eo,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(Eo,{id:"auto-init-repos-toggle",checked:gr(_=>_.autoInitializeReposOnStartup),onCheckedChange:gr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(VKe,{onSyncAll:async()=>{await On.getState().syncAllConversations()},onSyncPending:async()=>{await On.getState().syncPendingConversations()},onInitializeRepos:async()=>{await On.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:_}=await zr(async()=>{const{BulkSyncService:k}=await Promise.resolve().then(()=>Cy);return{BulkSyncService:k}},void 0);_.abort()},totalRepos:e.length,totalConversations:On.getState().conversations.filter(_=>_.syncRepoId).length,pendingConversations:On.getState().conversations.filter(_=>{const k=On.getState().conversationSyncStatus[_.id];return _.syncRepoId&&k==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(rt,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(al,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Zr,{className:"h-10 w-full"}),f.jsx(Zr,{className:"h-10 w-full"}),f.jsx(Zr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Pr,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Pr,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:e.map(_=>{const k=d[_.id],T=c===_.id,A=!!_.username||!!_.password,R=r[_.id]||"idle",M=R==="syncing",j=k||p.state.isSubmitting||!!c||M;let F=null,P="Initialize/Sync Repository";return R==="syncing"?(F=f.jsx(Yn,{className:"h-4 w-4 animate-spin mr-1"}),P="Initializing/Syncing..."):R==="idle"?(F=f.jsx(dS,{className:"h-4 w-4 text-green-500 mr-1"}),P="Sync Successful / Ready"):R==="error"?(F=f.jsx(No,{className:"h-4 w-4 text-destructive mr-1"}),P="Sync Failed"):F=f.jsx(Jm,{className:"h-4 w-4 mr-1"}),f.jsxs(js,{className:Ye(T?"bg-muted/50":"",j&&!T?"opacity-70":""),children:[f.jsx(zn,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:_.name}),f.jsx(zn,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:_.remoteUrl}),f.jsx(zn,{className:"hidden lg:table-cell",children:_.branch||"main"}),f.jsx(zn,{className:"text-xs hidden lg:table-cell",children:A?"Configured":"None"}),f.jsxs(zn,{className:"text-right space-x-1",children:[f.jsx(Nn,{tooltipText:P,onClick:()=>x(_.id),"aria-label":`Initialize or Sync repo ${_.name}`,disabled:j,icon:F,variant:"outline",className:"h-8 w-8"}),f.jsx(Nn,{tooltipText:"Edit",onClick:()=>y(_),"aria-label":`Edit repo ${_.name}`,disabled:j,icon:f.jsx(hS,{}),className:"h-8 w-8"}),f.jsx(Nn,{tooltipText:"Delete",onClick:()=>v(_.id,_.name),"aria-label":`Delete repo ${_.name}`,disabled:j,icon:k?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(to,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},_.id)})})]})})]})]})},GKe=We.memo(HKe),KKe=()=>{const e=E.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx($Ke,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(GKe,{})}],[]);return f.jsx(jo,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},YKe=We.memo(KKe);class ZKe{constructor(){ue(this,"id","core-git-sync");ue(this,"unregisterPromptControlCallback",null);ue(this,"unregisterSettingsTabCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"selectedItemId",null);ue(this,"selectedItemType",null);ue(this,"syncRepos",[]);ue(this,"conversationSyncStatus",{});ue(this,"isStreaming",!1);ue(this,"autoSyncEnabled",!1);ue(this,"isBulkSyncing",!1);ue(this,"bulkSyncProgress",null);ue(this,"notifyComponentUpdate",null);ue(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(rr.linkConversationToRepoRequest,{conversationId:t,repoId:n})});ue(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(rr.syncConversationRequest,{conversationId:t})});ue(this,"getConversationById",t=>On.getState().getConversationById(t));ue(this,"syncAllConversations",async()=>{await On.getState().syncAllConversations()});ue(this,"syncPendingConversations",async()=>{await On.getState().syncPendingConversations()});ue(this,"initializeAllRepositories",async()=>{await On.getState().initializeAllRepositories()});ue(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await zr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>Cy);return{BulkSyncService:n}},void 0);t.abort()});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Ir.contextChanged,p=>{var g;this.selectedItemId=p.selectedItemId,this.selectedItemType=p.selectedItemType,(g=this.notifyComponentUpdate)==null||g.call(this)}),r=t.on(gs.repoChanged,()=>{var p;this.syncRepos=On.getState().syncRepos,(p=this.notifyComponentUpdate)==null||p.call(this)}),s=t.on(rr.conversationSyncStatusChanged,p=>{var g;typeof p=="object"&&p&&"conversationId"in p&&"status"in p&&(this.conversationSyncStatus={...this.conversationSyncStatus,[p.conversationId]:p.status},(g=this.notifyComponentUpdate)==null||g.call(this))}),i=t.on(xn.statusChanged,p=>{var g;typeof p=="object"&&p&&"status"in p&&(this.isStreaming=p.status==="streaming",(g=this.notifyComponentUpdate)==null||g.call(this))}),a=t.on(xn.completed,async p=>{typeof p=="object"&&p&&"interactionId"in p&&"status"in p&&p.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(on.autoSyncOnStreamCompleteChanged,p=>{var g;typeof p=="object"&&p&&"enabled"in p&&(this.autoSyncEnabled=p.enabled,(g=this.notifyComponentUpdate)==null||g.call(this))}),l=t.on(gs.bulkSyncStarted,p=>{var g;typeof p=="object"&&p&&"progress"in p&&(this.isBulkSyncing=!0,this.bulkSyncProgress=p.progress,(g=this.notifyComponentUpdate)==null||g.call(this))}),c=t.on(gs.bulkSyncProgress,p=>{var g;typeof p=="object"&&p&&"progress"in p&&(this.bulkSyncProgress=p.progress,(g=this.notifyComponentUpdate)==null||g.call(this))}),u=t.on(gs.bulkSyncCompleted,p=>{var g;typeof p=="object"&&p&&"progress"in p&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(g=this.notifyComponentUpdate)==null||g.call(this))}),d=t.on(gs.bulkSyncFailed,p=>{var g;typeof p=="object"&&p&&"progress"in p&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(g=this.notifyComponentUpdate)==null||g.call(this))}),h=t.on(rr.conversationUpdated,p=>{var g;typeof p=="object"&&p&&"conversationId"in p&&"updates"in p&&p.conversationId===this.selectedItemId&&p.updates.syncRepoId!==void 0&&(this.loadInitialState(),(g=this.notifyComponentUpdate)==null||g.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=On.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=en.getState().status==="streaming",this.autoSyncEnabled=gr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(DKe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:YKe,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const XKe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=On(pn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(Er,{delayDuration:100,children:f.jsxs(Tc,{children:[f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(eu,{className:"h-4 w-4"})})})}),f.jsx(Nr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(Nc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Yn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(Jm,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Ye("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(cs,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Yn,{className:"h-3 w-3 animate-spin"}):f.jsx(Jm,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings  Git  Sync Repositories to add one."})]})})]})})};class JKe{constructor(){ue(this,"id","core-manual-git-sync-sidebar");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"syncRepos",[]);ue(this,"repoInitializationStatus",{});ue(this,"isSyncing",!1);ue(this,"notifyComponentUpdate",null);ue(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await zr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>Cy);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});ue(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(rr.initializeOrSyncRepoRequest,{repoId:t})});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(gs.repoChanged,()=>{var i;this.syncRepos=On.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(gs.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(rr.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=On.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(XKe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const QKe=Ze({path:qe().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),eYe=Ze({path:qe().describe("The path of the file to read within the VFS."),encoding:Ll(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),tYe=Ze({path:qe().describe("The path where the file should be written."),content:qe().describe("The content to write to the file."),encoding:Ll(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),nYe=Ze({path:qe().describe("The path of the file or directory to delete."),recursive:Kn().optional().default(!1).describe("Whether to delete directories recursively.")}),rYe=Ze({path:qe().describe("The path of the directory to create (including parents).")}),sYe=Ze({oldPath:qe().describe("The current path of the item to rename."),newName:qe().describe("The new name for the item.")});class iYe{constructor(){ue(this,"id","core-vfs-tools");ue(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:QKe};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=Hr(l||"/");try{const h=await c5(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(p=>({name:p.name,type:p.isDirectory?"folder":"file",size:p.size,lastModified:p.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:eYe};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=Hr(l);try{const p=await Mp(h,{fsInstance:d});let g;return c==="base64"?g=btoa(String.fromCharCode(...p)):g=new TextDecoder().decode(p),{success:!0,path:h,content:g,encoding:c}}catch(p){return{success:!1,path:h,error:p.message}}}));const s={description:"Write content to a file in the VFS.",parameters:tYe};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const p=Hr(l);try{let g;if(u==="base64"){const y=atob(c),v=y.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=y.charCodeAt(w);g=x}else g=c;return await _A(p,g,{fsInstance:h}),{success:!0,path:p}}catch(g){return{success:!1,path:p,error:g.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:nYe};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=Hr(l);try{return await u5(h,c,{fsInstance:d}),{success:!0,path:h}}catch(p){return{success:!1,path:h,error:p.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:rYe};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=Hr(l);try{return await yQ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:sYe};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=Hr(l),p=Hr(h.substring(0,h.lastIndexOf("/"))||"/"),g=cd(p,c);try{return await vQ(h,g,{fsInstance:d}),{success:!0,oldPath:h,newPath:g}}catch(y){return{success:!1,oldPath:h,newName:c,error:y.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const aYe=Ze({path:qe().describe("The directory path within the VFS to initialize as a Git repository.")}),oYe=Ze({path:qe().describe("The directory path of the Git repository within the VFS to commit."),message:qe().describe("The commit message.")}),lYe=Ze({path:qe().describe("The directory path of the Git repository within the VFS to pull from."),branch:qe().optional().describe("The branch name to pull.")}),cYe=Ze({path:qe().describe("The directory path of the Git repository within the VFS to push."),branch:qe().optional().describe("The branch name to push.")}),uYe=Ze({path:qe().describe("The directory path of the Git repository within the VFS to check status.")});class dYe{constructor(){ue(this,"id","core-git-tools");ue(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:aYe};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await mQ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:oYe};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=gr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await o5(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:lYe};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await SA(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:cYe};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await l5(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:uYe};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await gQ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class fYe{constructor(){ue(this,"id","core-mcp-tools");ue(this,"unregisterCallbacks",[]);ue(this,"mcpToolUnregisterCallbacks",[]);ue(this,"mcpClients",new Map);ue(this,"modApi");ue(this,"connectionAttempts",new Map);ue(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,Ae.emit(Rr.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};Ae.on(Rr.serversChanged,t),this.unregisterCallbacks.push(()=>{Ae.off(Rr.serversChanged,t)})}getRetryConfig(){const t=Tl.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=Tl.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),ke.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),ke.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),Tl.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),ke.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";ke.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return bq({transport:n})}async getBridgeUrl(){const n=Tl.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async p=>{const g=`${Date.now()}_${++h}`,y=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:g,method:"tools/call",params:{name:p.name,arguments:p.arguments}})});if(!y.ok)throw new Error(`Tool call failed: ${y.status} ${y.statusText}`);const v=await y.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return bq({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,S]of Object.entries(d.parameters.properties)){let _;switch(S.type){case"string":_=qe();break;case"number":_=Nt();break;case"boolean":_=Kn();break;case"array":_=cn(Cf());break;case"object":_=Ze({}).passthrough();break;default:_=Cf()}S.description&&(_=_.describe(S.description)),x.includes(w)||(_=_.optional()),v[w]=_}h=Ze(v)}else h=Ze({});const p={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},g=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(S=>S.type==="text"?S.text:S.type==="image"?`[Image: ${S.mimeType||"unknown format"}]`:JSON.stringify(S)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},y=this.modApi.registerTool(u,p,g);this.mcpToolUnregisterCallbacks.push(y),Ae.emit(Rr.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),Tl.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};ke.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=Tl.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=Tl.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ze({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(p=>p.type==="text"?p.text:p.type==="image"?`[Image: ${p.mimeType||"unknown format"}]`:JSON.stringify(p)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=Tl.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),Ae.emit(Rr.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;Ae.emit(Rr.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const hYe=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",Moe=({enabledTools:e,onToggleTool:t,onToggleAll:n,disabled:r=!1,className:s,maxSteps:i,onMaxStepsChange:a,globalDefaultMaxSteps:o=5,showMaxSteps:l=!1,disabledMessage:c})=>{const u=Ni(x=>x.tools),[d,h]=E.useState(""),p=E.useMemo(()=>Object.entries(u).map(([x,{definition:w,modId:S}])=>({name:x,description:w.description??"No description provided.",modId:S})).sort((x,w)=>x.name.localeCompare(w.name)),[u]),g=E.useMemo(()=>{const x=d.trim().toLowerCase();return x?p.filter(w=>w.name.toLowerCase().includes(x)||w.description.toLowerCase().includes(x)||w.modId.toLowerCase().includes(x)):p},[p,d]),y=E.useCallback(x=>{if(!a)return;const w=x.target.value;if(w===""){a(null);return}const S=parseInt(w,10);if(isNaN(S))a(null);else{const _=Math.max(1,Math.min(20,S));a(_)}},[a]),v=i===null?"":String(i);return f.jsxs("div",{className:Ye("p-4 max-w-2xl space-y-3",s),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter tools...",value:d,onChange:x=>h(x.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(At,{className:"text-xs text-muted-foreground",children:[g.length," tools shown (",e.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(rt,{variant:"outline",size:"sm",onClick:()=>n(!0,p.map(x=>x.name)),disabled:r||p.length===0,children:"Enable All"}),f.jsx(rt,{variant:"outline",size:"sm",onClick:()=>n(!1,p.map(x=>x.name)),disabled:r||p.length===0||e.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:r&&c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:c}):p.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):g.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(ul,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:g.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(Eo,{id:`tool-switch-${x.name}`,checked:e.has(x.name),onCheckedChange:w=>t(x.name,w),className:"flex-shrink-0",disabled:r}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(At,{htmlFor:`tool-switch-${x.name}`,className:Ye("block text-sm font-medium",r?"cursor-not-allowed":"cursor-pointer"),children:x.name}),f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:hYe(x.description)})}),f.jsx(Nr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:x.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",x.modId]}),f.jsx("div",{className:"text-xs",children:x.description})]})})]})]})]},x.name))})})}),l&&f.jsxs("div",{className:"pt-2",children:[f.jsx(At,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(vn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:y,className:"w-20 h-8 text-xs mt-1",placeholder:String(o),disabled:r}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},pYe=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=E.useCallback((h,p)=>{e.setEnabledTools(g=>{const y=new Set(g);return p?y.add(h):y.delete(h),y})},[e]),c=E.useCallback((h,p)=>{e.setEnabledTools(()=>h?new Set(p):new Set)},[e]),u=a!=="conversation"||!i;return f.jsx(Moe,{enabledTools:s,onToggleTool:l,onToggleAll:c,disabled:u,className:r,maxSteps:t,onMaxStepsChange:n,globalDefaultMaxSteps:o,showMaxSteps:!0,disabledMessage:"Select a conversation to manage tools."})},mYe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();E.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=p=>{r(p),!p&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(Tc,{open:n,onOpenChange:u,children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(Jh,{className:"h-4 w-4"})})})}),f.jsx(Nr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(Nc,{className:"w-auto p-0",align:"start",children:f.jsx(pYe,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class gYe{constructor(){ue(this,"id","core-tool-selector");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"transientEnabledTools",new Set);ue(this,"transientMaxStepsOverride",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"selectedItemId",null);ue(this,"selectedItemType",null);ue(this,"allToolsCount",0);ue(this,"globalDefaultMaxSteps",5);ue(this,"notifyComponentUpdate",null);ue(this,"getEnabledTools",()=>this.transientEnabledTools);ue(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"getSelectedItemId",()=>this.selectedItemId);ue(this,"getSelectedItemType",()=>this.selectedItemType);ue(this,"getAllToolsCount",()=>this.allToolsCount);ue(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);ue(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(xn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on($n.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Ir.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(on.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on(Wr.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=en.getState().status==="streaming",this.selectedItemId=On.getState().selectedItemId,this.selectedItemType=On.getState().selectedItemType,this.allToolsCount=Object.keys(Ni.getState().tools).length,this.globalDefaultMaxSteps=gr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Gn.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>We.createElement(mYe,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var qW=1,yYe=.9,bYe=.8,vYe=.17,z3=.1,U3=.999,xYe=.9999,wYe=.99,SYe=/[\\\/_+.#"@\[\(\{&]/,_Ye=/[\\\/_+.#"@\[\(\{&]/g,CYe=/[\s-]/,joe=/[\s-]/g;function gO(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?qW:wYe;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,p,g;c>=0;)d=gO(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=qW:SYe.test(e.charAt(c-1))?(d*=bYe,p=e.slice(s,c-1).match(_Ye),p&&s>0&&(d*=Math.pow(U3,p.length))):CYe.test(e.charAt(c-1))?(d*=yYe,g=e.slice(s,c-1).match(joe),g&&s>0&&(d*=Math.pow(U3,g.length))):(d*=vYe,s>0&&(d*=Math.pow(U3,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=xYe)),(d<z3&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=gO(e,t,n,r,c+1,i+2,a),h*z3>d&&(d=h*z3)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function VW(e){return e.toLowerCase().replace(joe," ")}function kYe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,gO(e,t,VW(e),VW(t),0,0,{})}var Nx='[cmdk-group=""]',q3='[cmdk-group-items=""]',EYe='[cmdk-group-heading=""]',Poe='[cmdk-item=""]',WW=`${Poe}:not([aria-disabled="true"])`,yO="cmdk-item-select",Z0="data-value",TYe=(e,t,n)=>kYe(e,t,n),Ooe=E.createContext(void 0),a_=()=>E.useContext(Ooe),Doe=E.createContext(void 0),K6=()=>E.useContext(Doe),Foe=E.createContext(void 0),Loe=E.forwardRef((e,t)=>{let n=X0(()=>{var Z,ne;return{search:"",value:(ne=(Z=e.value)!=null?Z:e.defaultValue)!=null?ne:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=X0(()=>new Set),s=X0(()=>new Map),i=X0(()=>new Map),a=X0(()=>new Set),o=$oe(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:p,loop:g,disablePointerSelection:y=!1,vimBindings:v=!0,...x}=e,w=_a(),S=_a(),_=_a(),k=E.useRef(null),T=LYe();fg(()=>{if(u!==void 0){let Z=u.trim();n.current.value=Z,A.emit()}},[u]),fg(()=>{T(6,q)},[]);let A=E.useMemo(()=>({subscribe:Z=>(a.current.add(Z),()=>a.current.delete(Z)),snapshot:()=>n.current,setState:(Z,ne,ae)=>{var le,Se,Ee,he;if(!Object.is(n.current[Z],ne)){if(n.current[Z]=ne,Z==="search")P(),j(),T(1,F);else if(Z==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let pe=document.getElementById(_);pe?pe.focus():(le=document.getElementById(w))==null||le.focus()}if(T(7,()=>{var pe;n.current.selectedItemId=(pe=I())==null?void 0:pe.id,A.emit()}),ae||T(5,q),((Se=o.current)==null?void 0:Se.value)!==void 0){let pe=ne??"";(he=(Ee=o.current).onValueChange)==null||he.call(Ee,pe);return}}A.emit()}},emit:()=>{a.current.forEach(Z=>Z())}}),[]),R=E.useMemo(()=>({value:(Z,ne,ae)=>{var le;ne!==((le=i.current.get(Z))==null?void 0:le.value)&&(i.current.set(Z,{value:ne,keywords:ae}),n.current.filtered.items.set(Z,M(ne,ae)),T(2,()=>{j(),A.emit()}))},item:(Z,ne)=>(r.current.add(Z),ne&&(s.current.has(ne)?s.current.get(ne).add(Z):s.current.set(ne,new Set([Z]))),T(3,()=>{P(),j(),n.current.value||F(),A.emit()}),()=>{i.current.delete(Z),r.current.delete(Z),n.current.filtered.items.delete(Z);let ae=I();T(4,()=>{P(),(ae==null?void 0:ae.getAttribute("id"))===Z&&F(),A.emit()})}),group:Z=>(s.current.has(Z)||s.current.set(Z,new Set),()=>{i.current.delete(Z),s.current.delete(Z)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:_,labelId:S,listInnerRef:k}),[]);function M(Z,ne){var ae,le;let Se=(le=(ae=o.current)==null?void 0:ae.filter)!=null?le:TYe;return Z?Se(Z,n.current.search,ne):0}function j(){if(!n.current.search||o.current.shouldFilter===!1)return;let Z=n.current.filtered.items,ne=[];n.current.filtered.groups.forEach(le=>{let Se=s.current.get(le),Ee=0;Se.forEach(he=>{let pe=Z.get(he);Ee=Math.max(pe,Ee)}),ne.push([le,Ee])});let ae=k.current;V().sort((le,Se)=>{var Ee,he;let pe=le.getAttribute("id"),Le=Se.getAttribute("id");return((Ee=Z.get(Le))!=null?Ee:0)-((he=Z.get(pe))!=null?he:0)}).forEach(le=>{let Se=le.closest(q3);Se?Se.appendChild(le.parentElement===Se?le:le.closest(`${q3} > *`)):ae.appendChild(le.parentElement===ae?le:le.closest(`${q3} > *`))}),ne.sort((le,Se)=>Se[1]-le[1]).forEach(le=>{var Se;let Ee=(Se=k.current)==null?void 0:Se.querySelector(`${Nx}[${Z0}="${encodeURIComponent(le[0])}"]`);Ee==null||Ee.parentElement.appendChild(Ee)})}function F(){let Z=V().find(ae=>ae.getAttribute("aria-disabled")!=="true"),ne=Z==null?void 0:Z.getAttribute(Z0);A.setState("value",ne||void 0)}function P(){var Z,ne,ae,le;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Se=0;for(let Ee of r.current){let he=(ne=(Z=i.current.get(Ee))==null?void 0:Z.value)!=null?ne:"",pe=(le=(ae=i.current.get(Ee))==null?void 0:ae.keywords)!=null?le:[],Le=M(he,pe);n.current.filtered.items.set(Ee,Le),Le>0&&Se++}for(let[Ee,he]of s.current)for(let pe of he)if(n.current.filtered.items.get(pe)>0){n.current.filtered.groups.add(Ee);break}n.current.filtered.count=Se}function q(){var Z,ne,ae;let le=I();le&&(((Z=le.parentElement)==null?void 0:Z.firstChild)===le&&((ae=(ne=le.closest(Nx))==null?void 0:ne.querySelector(EYe))==null||ae.scrollIntoView({block:"nearest"})),le.scrollIntoView({block:"nearest"}))}function I(){var Z;return(Z=k.current)==null?void 0:Z.querySelector(`${Poe}[aria-selected="true"]`)}function V(){var Z;return Array.from(((Z=k.current)==null?void 0:Z.querySelectorAll(WW))||[])}function D(Z){let ne=V()[Z];ne&&A.setState("value",ne.getAttribute(Z0))}function z(Z){var ne;let ae=I(),le=V(),Se=le.findIndex(he=>he===ae),Ee=le[Se+Z];(ne=o.current)!=null&&ne.loop&&(Ee=Se+Z<0?le[le.length-1]:Se+Z===le.length?le[0]:le[Se+Z]),Ee&&A.setState("value",Ee.getAttribute(Z0))}function $(Z){let ne=I(),ae=ne==null?void 0:ne.closest(Nx),le;for(;ae&&!le;)ae=Z>0?DYe(ae,Nx):FYe(ae,Nx),le=ae==null?void 0:ae.querySelector(WW);le?A.setState("value",le.getAttribute(Z0)):z(Z)}let Y=()=>D(V().length-1),B=Z=>{Z.preventDefault(),Z.metaKey?Y():Z.altKey?$(1):z(1)},G=Z=>{Z.preventDefault(),Z.metaKey?D(0):Z.altKey?$(-1):z(-1)};return E.createElement(Zn.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:Z=>{var ne;(ne=x.onKeyDown)==null||ne.call(x,Z);let ae=Z.nativeEvent.isComposing||Z.keyCode===229;if(!(Z.defaultPrevented||ae))switch(Z.key){case"n":case"j":{v&&Z.ctrlKey&&B(Z);break}case"ArrowDown":{B(Z);break}case"p":case"k":{v&&Z.ctrlKey&&G(Z);break}case"ArrowUp":{G(Z);break}case"Home":{Z.preventDefault(),D(0);break}case"End":{Z.preventDefault(),Y();break}case"Enter":{Z.preventDefault();let le=I();if(le){let Se=new Event(yO);le.dispatchEvent(Se)}}}}},E.createElement("label",{"cmdk-label":"",htmlFor:R.inputId,id:R.labelId,style:BYe},l),aN(e,Z=>E.createElement(Doe.Provider,{value:A},E.createElement(Ooe.Provider,{value:R},Z))))}),AYe=E.forwardRef((e,t)=>{var n,r;let s=_a(),i=E.useRef(null),a=E.useContext(Foe),o=a_(),l=$oe(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;fg(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=Boe(s,i,[e.value,e.children,i],e.keywords),d=K6(),h=mp(T=>T.value&&T.value===u.current),p=mp(T=>c||o.filter()===!1?!0:T.search?T.filtered.items.get(s)>0:!0);E.useEffect(()=>{let T=i.current;if(!(!T||e.disabled))return T.addEventListener(yO,g),()=>T.removeEventListener(yO,g)},[p,e.onSelect,e.disabled]);function g(){var T,A;y(),(A=(T=l.current).onSelect)==null||A.call(T,u.current)}function y(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:v,value:x,onSelect:w,forceMount:S,keywords:_,...k}=e;return E.createElement(Zn.div,{ref:jl(i,t),...k,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:y,onClick:v?void 0:g},e.children)}),NYe=E.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=_a(),o=E.useRef(null),l=E.useRef(null),c=_a(),u=a_(),d=mp(p=>s||u.filter()===!1?!0:p.search?p.filtered.groups.has(a):!0);fg(()=>u.group(a),[]),Boe(a,o,[e.value,e.heading,l]);let h=E.useMemo(()=>({id:a,forceMount:s}),[s]);return E.createElement(Zn.div,{ref:jl(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&E.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),aN(e,p=>E.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},E.createElement(Foe.Provider,{value:h},p))))}),RYe=E.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=E.useRef(null),i=mp(a=>!a.search);return!n&&!i?null:E.createElement(Zn.div,{ref:jl(s,t),...r,"cmdk-separator":"",role:"separator"})}),IYe=E.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=K6(),a=mp(c=>c.search),o=mp(c=>c.selectedItemId),l=a_();return E.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),E.createElement(Zn.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),MYe=E.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=E.useRef(null),a=E.useRef(null),o=mp(c=>c.selectedItemId),l=a_();return E.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let p=c.offsetHeight;u.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),E.createElement(Zn.div,{ref:jl(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},aN(e,c=>E.createElement("div",{ref:jl(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),jYe=E.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return E.createElement(aae,{open:n,onOpenChange:r},E.createElement(oae,{container:a},E.createElement(lae,{"cmdk-overlay":"",className:s}),E.createElement(cae,{"aria-label":e.label,"cmdk-dialog":"",className:i},E.createElement(Loe,{ref:t,...o}))))}),PYe=E.forwardRef((e,t)=>mp(n=>n.filtered.count===0)?E.createElement(Zn.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),OYe=E.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return E.createElement(Zn.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},aN(e,a=>E.createElement("div",{"aria-hidden":!0},a)))}),lv=Object.assign(Loe,{List:MYe,Item:AYe,Input:IYe,Group:NYe,Separator:RYe,Dialog:jYe,Empty:PYe,Loading:OYe});function DYe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function FYe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function $oe(e){let t=E.useRef(e);return fg(()=>{t.current=e}),t}var fg=typeof window>"u"?E.useEffect:E.useLayoutEffect;function X0(e){let t=E.useRef();return t.current===void 0&&(t.current=e()),t}function mp(e){let t=K6(),n=()=>e(t.snapshot());return E.useSyncExternalStore(t.subscribe,n,n)}function Boe(e,t,n,r=[]){let s=E.useRef(),i=a_();return fg(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(Z0,o),s.current=o}),s}var LYe=()=>{let[e,t]=E.useState(),n=X0(()=>new Map);return fg(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function $Ye(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function aN({asChild:e,children:t},n){return e&&E.isValidElement(t)?E.cloneElement($Ye(t),{ref:t.ref},n(t.props.children)):n(t)}var BYe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function zYe({className:e,...t}){return f.jsx(lv,{"data-slot":"command",className:Ye("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function UYe({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(Ro,{className:"size-4 shrink-0 opacity-50"}),f.jsx(lv.Input,{"data-slot":"command-input",className:Ye("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function qYe({className:e,...t}){return f.jsx(lv.List,{"data-slot":"command-list",className:Ye("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function VYe({...e}){return f.jsx(lv.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function WYe({className:e,...t}){return f.jsx(lv.Group,{"data-slot":"command-group",className:Ye("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function HYe({className:e,...t}){return f.jsx(lv.Item,{"data-slot":"command-item",className:Ye("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const Bp=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=E.useMemo(()=>{let w=e;if(l.trim()){const _=l.toLowerCase();w=e.filter(k=>k.name.toLowerCase().includes(_)||k.providerName.toLowerCase().includes(_)||k.id.toLowerCase().includes(_))}const S=Object.entries(u).filter(([,_])=>_).map(([_])=>_);return S.length===0?w:w.filter(_=>{var R,M,j;const k=new Set(((R=_.metadataSummary)==null?void 0:R.supported_parameters)??[]),T=new Set(((M=_.metadataSummary)==null?void 0:M.input_modalities)??[]),A=new Set(((j=_.metadataSummary)==null?void 0:j.output_modalities)??[]);return S.every(F=>{switch(F){case"reasoning":return k.has("reasoning");case"webSearch":return k.has("web_search")||k.has("web_search_options");case"tools":return k.has("tools");case"multimodal":return Array.from(T).some(P=>P!=="text");case"imageGeneration":return A.has("image");default:return!0}})})},[e,l,u]),p=E.useMemo(()=>e.find(w=>w.id===t),[e,t]),g=E.useCallback(w=>{const S=w===t?null:w;n==null||n(S),o(!1),c("")},[t,n]),y=w=>{d(S=>({...S,[w]:!S[w]}))};if(i)return f.jsx(Zr,{className:Ye("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(Tc,{open:a,onOpenChange:o,children:[f.jsx(Ac,{asChild:!0,children:f.jsxs(rt,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Ye("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:p?`${p.name} (${p.providerName})`:"Select Model..."}),f.jsx(RT,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(Nc,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden",zIndex:9999,pointerEvents:"auto"},onMouseDown:w=>w.preventDefault(),onClick:w=>w.stopPropagation(),onPointerDown:w=>w.stopPropagation(),onPointerDownCapture:w=>w.stopPropagation(),children:f.jsxs(zYe,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(Ro,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(UYe,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(rt,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>y("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(Ow,{className:"h-4 w-4"})}),f.jsx(rt,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>y("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(Dw,{className:"h-4 w-4"})}),f.jsx(rt,{variant:u.tools?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>y("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Jh,{className:"h-4 w-4"})}),f.jsx(rt,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>y("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(sd,{className:"h-4 w-4"})}),f.jsx(rt,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>y("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(Xm,{className:"h-4 w-4"})})]})]}),f.jsxs(qYe,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(VYe,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(WYe,{children:h.map(w=>{var S,_,k,T,A,R,M,j,F,P,q,I;return f.jsx(HYe,{value:w.id,onSelect:g,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((_=(S=w.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:_.includes("reasoning"))&&f.jsx(Ow,{className:"h-3.5 w-3.5 text-purple-500"}),(((T=(k=w.metadataSummary)==null?void 0:k.supported_parameters)==null?void 0:T.includes("web_search"))||((R=(A=w.metadataSummary)==null?void 0:A.supported_parameters)==null?void 0:R.includes("web_search_options")))&&f.jsx(Dw,{className:"h-3.5 w-3.5 text-blue-500"}),((j=(M=w.metadataSummary)==null?void 0:M.supported_parameters)==null?void 0:j.includes("tools"))&&f.jsx(Jh,{className:"h-3.5 w-3.5 text-orange-500"}),((P=(F=w.metadataSummary)==null?void 0:F.input_modalities)==null?void 0:P.some(V=>V!=="text"))&&f.jsx(sd,{className:"h-3.5 w-3.5 text-green-500"}),((I=(q=w.metadataSummary)==null?void 0:q.output_modalities)==null?void 0:I.includes("image"))&&f.jsx(Xm,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},V3=Ze({systemPrompt:qe().nullable(),modelId:qe().nullable()}),GYe=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Gn(pn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=Xs({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:V3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return E.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:V3.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(Mi,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(Gi,{field:d}),f.jsx(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:V3.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(Bp,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(Gi,{field:d}),f.jsxs(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,p,g])=>f.jsxs(rt,{type:"submit",size:"sm",disabled:i||!d||h||p||!g,children:[(h||p)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"}),h||p?"Saving...":"Save Prompt Settings"]})})})]})};function V0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const KYe=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(At,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(ay,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(V0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(At,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(ay,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(V0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(vn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(V0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(vn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(V0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(At,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(ay,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(V0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(At,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(ay,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(V0,{field:l})]})})]}),HW=Ze({syncRepoId:qe().nullable()}),YYe=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=Xs({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:HW,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return E.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:HW.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(mc,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(yc,{id:l.name,children:f.jsx(gc,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(bc,{children:[f.jsx(yi,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(yi,{value:c.id,children:c.name},c.id))]})]}),f.jsx(Gi,{field:l}),f.jsx(rt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(rt,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},ZYe=({projectId:e})=>{const t=E.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(G6,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(At,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(At,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(jo,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Ye("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},XYe=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=E.useState(""),a=E.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(ul,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(au,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(At,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},JYe=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=E.useMemo(()=>new Set(e??[]),[e]),i=E.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(At,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(XYe,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},QYe=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=E.useState(""),o=E.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(ul,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(au,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(At,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},eZe=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=E.useMemo(()=>new Set(e??[]),[e]),a=E.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(At,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(QYe,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},tZe=Ze({temperature:Nt().min(0).max(1),topP:Nt().min(0).max(1),maxTokens:Nt().min(1).nullable(),topK:Nt().min(1).nullable(),presencePenalty:Nt().min(-2).max(2),frequencyPenalty:Nt().min(-2).max(2)}),nZe=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=no(pn(D=>({getProjectById:D.getProjectById,updateProject:D.updateProject}))),a=no(D=>D.getEffectiveProjectSettings),o=On(D=>D.syncRepos),l=gr(pn(D=>({globalSystemPrompt:D.globalSystemPrompt,temperature:D.temperature,maxTokens:D.maxTokens,topP:D.topP,topK:D.topK,presencePenalty:D.presencePenalty,frequencyPenalty:D.frequencyPenalty}))),c=Gn(D=>D.selectedModelId),u=oi(D=>D.setVfsKey),[d,h]=E.useState(null),[p,g]=E.useState(null),[y,v]=E.useState(null),[x,w]=E.useState(null),[S,_]=E.useState(null),[k,T]=E.useState(!1),[A,R]=E.useState("prompt"),{project:M,effectiveSettings:j}=E.useMemo(()=>{const D=n?s(n):null,z=n?a(n):null;return{project:D,effectiveSettings:z}},[n,s,a]),F=Xs({defaultValues:{temperature:(M==null?void 0:M.temperature)??.7,topP:(M==null?void 0:M.topP)??1,maxTokens:(M==null?void 0:M.maxTokens)??null,topK:(M==null?void 0:M.topK)??null,presencePenalty:(M==null?void 0:M.presencePenalty)??0,frequencyPenalty:(M==null?void 0:M.presencePenalty)??0},validators:{onChangeAsync:tZe,onChangeAsyncDebounceMs:500}}),P=E.useCallback(D=>{var $;if(!D)return null;const z=s(D);return z?(($=z.metadata)==null?void 0:$.syncRepoId)!==void 0?z.metadata.syncRepoId:P(z.parentId):null},[s]),q=n?P(n):null;E.useEffect(()=>{var D;e&&n&&M&&j?(u(n),h(M.systemPrompt??null),g(M.modelId??null),v(((D=M.metadata)==null?void 0:D.syncRepoId)??null),w(M.defaultTagIds??null),_(M.defaultRuleIds??null),F.reset({temperature:M.temperature??.7,topP:M.topP??1,maxTokens:M.maxTokens??null,topK:M.topK??null,presencePenalty:M.presencePenalty??0,frequencyPenalty:M.frequencyPenalty??0}),R("prompt")):e||(u(null),h(null),g(null),v(null),w(null),_(null),F.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,M,j,u,F]);const I=async()=>{if(!(!n||!M)){T(!0);try{const D=M.parentId?a(M.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},z=M.parentId?P(M.parentId):null,$={},Y={...M.metadata??{}},B=F.state.values;d!==D.systemPrompt?$.systemPrompt=d:$.systemPrompt=void 0,p!==D.modelId?$.modelId=p:$.modelId=void 0,B.temperature!==D.temperature?$.temperature=B.temperature:$.temperature=void 0,B.maxTokens!==D.maxTokens?$.maxTokens=B.maxTokens:$.maxTokens=void 0,B.topP!==D.topP?$.topP=B.topP:$.topP=void 0,B.topK!==D.topK?$.topK=B.topK:$.topK=void 0,B.presencePenalty!==D.presencePenalty?$.presencePenalty=B.presencePenalty:$.presencePenalty=void 0,B.frequencyPenalty!==D.frequencyPenalty?$.frequencyPenalty=B.frequencyPenalty:$.frequencyPenalty=void 0,y!==z?Y.syncRepoId=y:delete Y.syncRepoId,JSON.stringify(x)!==JSON.stringify(D.defaultTagIds)?$.defaultTagIds=x:$.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(D.defaultRuleIds)?$.defaultRuleIds=S:$.defaultRuleIds=void 0,$.metadata=Y,await i(n,$),ke.success(`Project "${M.name}" settings updated.`),t()}catch(D){ke.error("Failed to save project settings."),console.error("Failed to save project settings:",D)}finally{T(!1)}}},V=E.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(GYe,{initialSystemPrompt:d,initialModelId:p,onSave:({systemPrompt:D,modelId:z})=>{h(D),g(z)},effectiveSystemPrompt:(j==null?void 0:j.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(j==null?void 0:j.modelId)??c,isParentSaving:k})},{value:"params",label:"Parameters",content:f.jsx(KYe,{form:F,effectiveTemperature:(j==null?void 0:j.temperature)??l.temperature,effectiveMaxTokens:(j==null?void 0:j.maxTokens)??l.maxTokens,effectiveTopP:(j==null?void 0:j.topP)??l.topP??1,effectiveTopK:(j==null?void 0:j.topK)??l.topK,effectivePresencePenalty:(j==null?void 0:j.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(j==null?void 0:j.frequencyPenalty)??l.frequencyPenalty??0,isSaving:k})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(JYe,{defaultRuleIds:S,setDefaultRuleIds:_,isSaving:k,allRules:r.getAllRules()}),f.jsx(eZe,{defaultTagIds:x,setDefaultTagIds:w,isSaving:k,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(YYe,{initialSyncRepoId:y,onSave:({syncRepoId:D})=>{v(D)},effectiveSyncRepoId:q,syncRepos:o,isParentSaving:k})},{value:"vfs",label:"Filesystem",content:f.jsx(ZYe,{projectId:n,projectName:(M==null?void 0:M.name)??null,isSaving:k})}],[d,p,y,x,S,F,j,l,c,k,q,o,n,M==null?void 0:M.name,r]);return f.jsx(vd,{open:e,onOpenChange:t,children:f.jsxs(xd,{className:Ye("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 flex-shrink-0",children:[f.jsxs(Sd,{className:"p-2",children:["Project Settings: ",M==null?void 0:M.name]}),f.jsx(Bf,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(jo,{tabs:V,initialValue:A,onValueChange:R,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(Fg,{className:"flex-shrink-0 border-t p-2 md:p-3 pt-1 md:pt-2 mt-auto",children:[f.jsx(rt,{variant:"outline",onClick:t,disabled:k,children:"Cancel"}),f.jsxs(rt,{onClick:I,disabled:k,children:[k&&f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class rZe{constructor(){ue(this,"id","core-project-settings");ue(this,"modalId","projectSettingsModal");ue(this,"unregisterModalProviderCallback",null);ue(this,"modApiRef",null);ue(this,"eventUnsubscribers",[]);ue(this,"allRules",[]);ue(this,"allTags",[]);ue(this,"tagRuleLinks",[]);ue(this,"getAllRules",()=>this.allRules);ue(this,"getAllTags",()=>this.allTags);ue(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ue(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Ir.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});ue(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Ir.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(_r.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(_r.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>We.createElement(nZe,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Y6=We.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Gn(h=>h.getGloballyEnabledModelDefinitions()),d=E.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(Bp,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});Y6.displayName="GlobalModelSelector";class sZe{constructor(){ue(this,"id","core-global-model-selector");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"selectedModelId",null);ue(this,"isStreaming",!1);ue(this,"isLoadingProviders",!0);ue(this,"globallyEnabledModels",[]);ue(this,"notifyComponentUpdate",null);ue(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit($n.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(an.setModelIdRequest,{id:t})});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=en.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(xn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on($n.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(an.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on($n.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Gn.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Gn.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(an.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on($n.initialDataLoaded,()=>{var u,d;const o=Gn.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(an.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>We.createElement(Y6,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const iZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();E.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]);const c=E.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=E.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=p=>{p&&i(e.getTurnSystemPrompt()),r(p)},h=l.trim().length>0;return f.jsxs(Tc,{open:n,onOpenChange:d,children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(axe,{className:"h-4 w-4"})})})}),f.jsx(Nr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(Nc,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(At,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(Mi,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:p=>i(p.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(rt,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(rt,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class aZe{constructor(){ue(this,"id","core-system-prompt");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"turnSystemPromptValue","");ue(this,"effectiveSystemPrompt",null);ue(this,"isStreaming",!1);ue(this,"notifyComponentUpdate",null);ue(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);ue(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=en.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Ir.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Da.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(on.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=On.getState(),n=no.getState(),r=gr.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(iZe,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const oZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=E.useState(!1),[i,a]=E.useState(n??""),[o,l]=E.useState(""),[c,u]=E.useState([]),d=E.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),ke.success("Structured output applied for next turn.")}catch{ke.error("Invalid JSON format.")}},[i,e]),h=E.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),ke.info("Structured output cleared.")},[e]),p=E.useCallback(()=>{if(!o.trim()){ke.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(S=>[...S,w]),l(""),ke.success(`"${w.name}" saved to library.`)}catch{ke.error("Cannot save invalid JSON to library.")}},[i,o]),g=E.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),ke.success(`Loaded "${w.name}" from library.`)},[e]),y=E.useCallback(w=>{u(S=>S.filter(_=>_.id!==w)),ke.info("Item removed from library.")},[]);E.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(At,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(Mi,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(At,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(vn,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(rt,{size:"sm",variant:"outline",onClick:p,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx(wc,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(rt,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(rt,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(rt,{size:"sm",variant:"outline",onClick:()=>g(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(rt,{size:"icon",variant:"ghost",onClick:()=>y(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(to,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(Tc,{open:r,onOpenChange:s,children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(fS,{className:"h-4 w-4"})})})}),f.jsx(Nr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(Nc,{className:"w-[450px] p-0",align:"start",children:f.jsx(jo,{tabs:v,defaultValue:"entry"})})]})},lZe=({module:e})=>{const[,t]=E.useState({});return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(oZe,{module:e}):null};class cZe{constructor(){ue(this,"id","core-structured-output");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"structuredOutputJson",null);ue(this,"isVisible",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getStructuredOutputJson",()=>this.structuredOutputJson);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(an.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Qa.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on($n.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(an.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Gn.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(lZe,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(an.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const uZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=E.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(oY,{className:Ye("h-3 w-3 fill-current",l)})})}),f.jsx(Nr,{side:"top",children:u})]})})},zoe=4,dZe=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/zoe)};class fZe{constructor(){ue(this,"id","core-usage-display");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"currentInputText","");ue(this,"historyTokens",0);ue(this,"attachedFiles",[]);ue(this,"selectedModelId",null);ue(this,"contextLength",0);ue(this,"notifyComponentUpdate",null);ue(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/zoe)});ue(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());ue(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(an.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(ic.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on($n.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(xn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Ir.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=Qh.getState(),n=Gn.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=en.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=dZe(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Gn.getState(),{providerId:r,modelId:s}=uc(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=TZ(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(uZe,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const hZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Pb,{className:Ye("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Nr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class pZe{constructor(){ue(this,"id","core-reasoning");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"reasoningEnabled",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getReasoningEnabled",()=>this.reasoningEnabled);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(an.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Qa.getState().reasoningEnabled,this.isStreaming=en.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on($n.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(an.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Gn.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(hZe,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(an.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const mZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(Ro,{className:Ye("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Nr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class gZe{constructor(){ue(this,"id","core-web-search");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"webSearchEnabled",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getWebSearchEnabled",()=>this.webSearchEnabled);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(an.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Qa.getState().webSearchEnabled,this.isStreaming=en.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on($n.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(an.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Gn.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(mZe,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(an.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Uoe=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=E.useState(""),[c,u]=E.useState(""),d=E.useMemo(()=>{const S=o.toLowerCase();return S?i.filter(_=>{var k;return _.name.toLowerCase().includes(S)||((k=_.description)==null?void 0:k.toLowerCase().includes(S))}):i},[i,o]),h=E.useMemo(()=>{const S=c.toLowerCase();return S?s.filter(_=>_.name.toLowerCase().includes(S)||_.content.toLowerCase().includes(S)||_.type.toLowerCase().includes(S)):s},[s,c]),p=E.useCallback((S,_)=>{n(S,_)},[n]),g=E.useCallback((S,_)=>{r(S,_)},[r]),y=()=>{Ae.emit(Ir.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"})},v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter tags...",value:o,onChange:S=>l(S.target.value),className:"pl-8 h-9"})]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:y,className:"h-9 px-3",title:"Open Rules Settings",children:[f.jsx(Xh,{className:"h-4 w-4 mr-1"}),"Manage"]})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(S=>{const _=a(S.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(au,{id:`tag-activate-${S.id}`,checked:e.has(S.id),onCheckedChange:k=>p(S.id,!!k),className:"mt-0.5"}),f.jsxs(At,{htmlFor:`tag-activate-${S.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:S.name}),S.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:S.description}),_.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",_.map(k=>k.name).join(", ")]})]})]})},S.id)})})})]}),w=[{value:"rules",label:"Activate Rules",content:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter rules...",value:c,onChange:S=>u(S.target.value),className:"pl-8 h-9"})]}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:y,className:"h-9 px-3",title:"Open Rules Settings",children:[f.jsx(Xh,{className:"h-4 w-4 mr-1"}),"Manage"]})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(S=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(au,{id:`rule-activate-${S.id}`,checked:t.has(S.id),onCheckedChange:_=>g(S.id,!!_),className:"mt-0.5"}),f.jsxs(At,{htmlFor:`rule-activate-${S.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:S.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",S.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",S.content]})]})]})},S.id))})})]})},{value:"tags",label:"Activate Tags",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(jo,{tabs:w,defaultValue:"rules",scrollable:!1})})},yZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=E.useCallback((v,x)=>{e.setActiveTagIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),h=E.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),p=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},g=s.size>0||i.size>0,y=a;return f.jsxs(Tc,{open:n,onOpenChange:r,children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:o?f.jsx(Ac,{asChild:!0,children:f.jsx(rt,{variant:g?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:y,"aria-label":"Configure Rules & Tags for Next Turn",onClick:p,children:f.jsx(Rz,{className:"h-4 w-4"})})}):f.jsx(rt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:y,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:p,children:f.jsx(Rz,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",children:o?g?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(Nc,{className:"w-auto p-0",align:"start",children:f.jsx(Uoe,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function bZe({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Ye("space-y-1.5",a),children:[f.jsx(At,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Mi,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Ye(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(Gi,{field:u})]})}})}const vZe=Ze({name:qe().min(1,"Rule Name is required."),content:qe().min(1,"Rule Content is required."),type:Ll(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),xZe=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],wZe=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=Xs({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:vZe,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx($1,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(Sw,{form:s,name:"type",label:"Rule Type",options:xZe,placeholder:"Select Type",disabled:t})]}),f.jsx(bZe,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(rt,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(Ri,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(rt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},SZe=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{children:"Type"}),f.jsx(Pr,{children:"Content Preview"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(js,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Zr,{className:"h-10 w-full"})})}),f.jsx(js,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Zr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(js,{children:f.jsx(zn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(js,{children:[f.jsx(zn,{className:"font-medium",children:a.name}),f.jsx(zn,{className:"capitalize",children:a.type}),f.jsx(zn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(zn,{className:"text-right space-x-1",children:[f.jsx(Nn,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(hS,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(Nn,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(to,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},_Ze=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),[u,d]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},p=x=>{o(x),i(!0)},g=E.useCallback(()=>{i(!1),o(null),c(!1)},[]),y=E.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),g()}catch{}finally{c(!1)}},[e,a,g]),v=E.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&g()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,g]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(rt,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(al,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(wZe,{initialData:a??void 0,isSavingExt:l,onSave:y,onCancel:g}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(SZe,{rules:n,isLoading:r,isDeleting:u,onEdit:p,onDelete:v})]})]})},W3=Ze({name:qe().min(1,"Tag Name is required."),description:qe().nullable()}),CZe=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=Xs({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:W3,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:W3.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:i.name,children:"Tag Name"}),f.jsx(vn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(Gi,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:W3.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(Mi,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(Gi,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(rt,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(Ri,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(rt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(wc,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},kZe=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{children:"Description"}),f.jsx(Pr,{children:"Linked Rules"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(js,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Zr,{className:"h-10 w-full"})})}),f.jsx(js,{children:f.jsx(zn,{colSpan:4,children:f.jsx(Zr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(js,{children:f.jsx(zn,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(js,{children:[f.jsx(zn,{className:"font-medium",children:o.name}),f.jsx(zn,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(zn,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(zn,{className:"text-right space-x-1",children:[f.jsx(Nn,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(hS,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(Nn,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(to,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},EZe=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=E.useState(!1),[o,l]=E.useState(""),c=E.useRef(null);E.useEffect(()=>{const y=v=>{c.current&&!c.current.contains(v.target)&&a(!1)};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]);const u=E.useMemo(()=>[...t].sort((y,v)=>y.name.localeCompare(v.name)),[t]),d=E.useMemo(()=>{const y=o.toLowerCase();return y?u.filter(v=>v.name.toLowerCase().includes(y)||v.content.toLowerCase().includes(y)||v.type.toLowerCase().includes(y)):u},[u,o]),h=E.useCallback(y=>{const v=n.has(y);r(e.id,y,!v),l("")},[n,r,e.id]),p=E.useCallback((y,v)=>{v.stopPropagation(),r(e.id,y,!1)},[r,e.id]),g=E.useMemo(()=>u.filter(y=>n.has(y.id)),[u,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(At,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs("div",{className:"relative",ref:c,children:[f.jsxs(rt,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,onClick:()=>a(!i),children:[f.jsx("span",{className:"truncate",children:g.length>0?`${g.length} rule(s) selected`:"Select rules..."}),f.jsx(RT,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]}),i&&f.jsxs("div",{className:"absolute top-full left-0 right-0 z-[var(--z-popover)] mt-1 rounded-md border bg-popover text-popover-foreground shadow-md",children:[f.jsx("div",{className:"p-2",children:f.jsx(vn,{placeholder:"Search rules...",value:o,onChange:y=>l(y.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:d.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:t.length===0?"No rules defined.":"No rules found."}):d.map(y=>{const v=n.has(y.id);return f.jsxs("div",{onClick:()=>h(y.id),className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",children:[f.jsx(Ao,{className:Ye("mr-2 h-4 w-4",v?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:y.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]}),g.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:g.map(y=>f.jsxs(cs,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:y.name}),f.jsx(rt,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:v=>p(y.id,v),disabled:s,"aria-label":`Unlink rule ${y.name}`,children:f.jsx(Ri,{className:"h-3 w-3"})})]},y.id))})]})},TZe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[p,g]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const y=()=>{u(null),l(!0)},v=A=>{u(A),l(!0)},x=E.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=E.useCallback(async A=>{h(!0);try{c?e.updateTag(c.id,A):e.addTag(A),c||x()}catch{}finally{h(!1)}},[e,c,x]),S=E.useCallback(async A=>{g(R=>({...R,[A]:!0}));try{e.deleteTag(A),(c==null?void 0:c.id)===A&&x()}catch{}finally{g(R=>({...R,[A]:!1}))}},[e,c,x]),_=E.useCallback(async(A,R,M)=>{try{M?e.linkTagToRule(A,R):e.unlinkTagFromRule(A,R)}catch{}},[e]),k=E.useMemo(()=>{const A=new Map;return n.forEach(R=>{A.set(R.id,i(R.id))}),A},[n,i]),T=E.useMemo(()=>c?new Set(s.filter(A=>A.tagId===c.id).map(A=>A.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(rt,{onClick:y,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(al,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(CZe,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(EZe,{tag:c,allRules:r,linkedRuleIds:T,onLinkChange:_,disabled:d})]}),f.jsx(dg,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(kZe,{tags:n,rulesByTagId:k,isLoading:a,isDeleting:p,onEdit:v,onDelete:S})]})]})},AZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=E.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx(_Ze,{module:e})},{value:"tags",label:"Tags",content:f.jsx(TZe,{module:e})}],[e]);return f.jsx(jo,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class NZe{constructor(){ue(this,"id","core-rules-tags");ue(this,"unregisterPromptControlCallback",null);ue(this,"unregisterSettingsTabCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"allRules",[]);ue(this,"allTags",[]);ue(this,"tagRuleLinks",[]);ue(this,"transientActiveTagIds",new Set);ue(this,"transientActiveRuleIds",new Set);ue(this,"isStreaming",!1);ue(this,"hasRulesOrTags",!1);ue(this,"isLoadingRules",!0);ue(this,"notifyComponentUpdate",null);ue(this,"notifySettingsComponentUpdate",null);ue(this,"getAllRules",()=>this.allRules);ue(this,"getAllTags",()=>this.allTags);ue(this,"getTagRuleLinks",()=>this.tagRuleLinks);ue(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ue(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));ue(this,"getTagById",t=>this.allTags.find(n=>n.id===t));ue(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});ue(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(_r.addRuleRequest,t)});ue(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(_r.updateRuleRequest,{id:t,updates:n})});ue(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(_r.deleteRuleRequest,{id:t})});ue(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(_r.addTagRequest,t)});ue(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(_r.updateTagRequest,{id:t,updates:n})});ue(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(_r.deleteTagRequest,{id:t})});ue(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(_r.linkTagToRuleRequest,{tagId:t,ruleId:n})});ue(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(_r.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});ue(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Ir.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);ue(this,"getIsLoadingRules",()=>this.isLoadingRules);ue(this,"getActiveTagIds",()=>this.transientActiveTagIds);ue(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);ue(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ue(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(_r.loadRulesAndTagsRequest,void 0);const n=t.on(xn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(_r.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>We.createElement(yZe,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>We.createElement(AZe,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const RZe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=E.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(Hye,{className:Ye("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Nr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class IZe{constructor(){ue(this,"id","core-auto-title");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"turnAutoTitleEnabled",!1);ue(this,"isStreaming",!1);ue(this,"isFirstInteraction",!1);ue(this,"globalAutoTitleEnabled",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsFirstInteraction",()=>this.isFirstInteraction);ue(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);ue(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=en.getState().status==="streaming",this.globalAutoTitleEnabled=gr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(xn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Ir.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(xn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(on.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=en.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>We.createElement(RZe,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function MZe(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class jZe{constructor(){ue(this,"id","core-url-parameters");ue(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(Lp.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),ke.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=MZe();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){ke.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(rr.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(rr.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(rr.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Gn.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(an.setModelIdRequest,{id:o}),t.emit($n.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);ke.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else ke.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){ke.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await Mp(l,{fsInstance:o}),u=await o.promises.stat(l),d=Ai(l),h="application/octet-stream",p=qw(d,h);let g={};if(p)g.contentText=new TextDecoder().decode(c);else{let y="";const v=c.byteLength;for(let x=0;x<v;x++)y+=String.fromCharCode(c[x]);g.contentBase64=window.btoa(y)}t.emit(ic.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...g}),ke.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?ke.warning(`VFS file not found: ${l}`):ke.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(an.inputChanged,{value:n.query}),ke.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=Qh.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:dr(),content:n.query,parameters:a,metadata:o};t.emit(an.submitted,{turnData:c});const u=await Gk(Wy.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){ke.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await Bh.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(ke.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){ke.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const PZe=({module:e})=>{const[t,n]=E.useState(!1),[,r]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=E.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx(rt,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(Xm,{className:Ye("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Nr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class OZe{constructor(){ue(this,"id","core-image-generation");ue(this,"modApiRef",null);ue(this,"isImageGenerationEnabled",null);ue(this,"unregisterCallback",null);ue(this,"notifyComponentUpdate",null);ue(this,"eventUnsubscribers",[]);ue(this,"isVisible",!1);ue(this,"isStreaming",!1);ue(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(an.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=en.getState().status==="streaming",this.updateVisibility();const n=t.on($n.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(xn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Gn.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(PZe,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(an.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(an.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const DZe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState([]),[i,a]=E.useState(250),[o,l]=E.useState(120),[c,u]=E.useState(!1),[d,h]=E.useState(null),[p,g]=E.useState(`You are a helpful assistant that analyzes and combines multiple AI model responses. Below are responses from different models to the same prompt. Please provide a comprehensive combined response that incorporates the best insights from each model while maintaining coherence and accuracy.

Please analyze the responses and provide a single, well-structured answer that combines their strengths.`),[y,v]=E.useState(""),[x,w]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),[,S]=E.useState({}),{status:_}=en(pn(V=>({status:V.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>S({})),()=>e.setNotifyCallback(null)},[e]);const k=E.useMemo(()=>{let V=e.globallyEnabledModels;if(y.trim()){const z=y.toLowerCase();V=e.globallyEnabledModels.filter($=>$.name.toLowerCase().includes(z)||$.providerName.toLowerCase().includes(z)||$.id.toLowerCase().includes(z))}const D=Object.entries(x).filter(([,z])=>z).map(([z])=>z);return D.length===0?V:V.filter(z=>{var G,Z,ne;const $=new Set(((G=z.metadataSummary)==null?void 0:G.supported_parameters)??[]),Y=new Set(((Z=z.metadataSummary)==null?void 0:Z.input_modalities)??[]),B=new Set(((ne=z.metadataSummary)==null?void 0:ne.output_modalities)??[]);return D.every(ae=>{switch(ae){case"reasoning":return $.has("reasoning");case"webSearch":return $.has("web_search")||$.has("web_search_options");case"tools":return $.has("tools");case"multimodal":return Array.from(Y).some(le=>le!=="text");case"imageGeneration":return B.has("image");default:return!0}})})},[e.globallyEnabledModels,y,x]),T=V=>{w(D=>({...D,[V]:!D[V]}))},R=Object.values(x).filter(Boolean).length,M=(V,D)=>{s(z=>D?[...z,V]:z.filter($=>$!==V))},j=()=>{if(r.length<1){ke.error("Please select at least 1 model to race");return}if(c&&!d){ke.error("Please select a model for combining");return}e.setRaceMode(!0,{modelIds:r,staggerMs:i,raceTimeoutSec:o,combineEnabled:c,combineModelId:d||void 0,combinePrompt:p}),n(!1),ke.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250),l(120),v(""),w({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),u(!1),h(null),g(`You are a helpful assistant that analyzes and combines multiple AI model responses. Below are responses from different models to the same prompt. Please provide a comprehensive combined response that incorporates the best insights from each model while maintaining coherence and accuracy.

Please analyze the responses and provide a single, well-structured answer that combines their strengths.`)},F=()=>{e.setRaceMode(!1),ke.info("Race mode disabled")},P=V=>{if(V.stopPropagation(),e.isRaceModeActive){F();return}if(_==="streaming"){ke.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){ke.info("Need at least 2 models enabled to race");return}n(!0)},q=_!=="streaming"&&e.globallyEnabledModels.length>=2,I=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":_==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:I(),onClick:P,"aria-label":"Race Multiple Models Against Each Other",disabled:!q,icon:f.jsx(pY,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(vd,{open:t,onOpenChange:n,children:f.jsxs(xd,{className:"min-w-[85vw] max min-h-[75vh] flex flex-col p-4",children:[f.jsxs(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 flex-shrink-0",children:[f.jsx(Sd,{className:"p-2",children:"Race Models"}),f.jsx(Bf,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"space-y-2",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Search models...",value:y,onChange:V=>v(V.target.value),className:"pl-8 h-9"})]}),f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx(rt,{variant:x.reasoning?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.reasoning&&"text-primary"),onClick:()=>T("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(Ow,{className:"h-4 w-4"})}),f.jsx(rt,{variant:x.webSearch?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.webSearch&&"text-primary"),onClick:()=>T("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(Dw,{className:"h-4 w-4"})}),f.jsx(rt,{variant:x.tools?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.tools&&"text-primary"),onClick:()=>T("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Jh,{className:"h-4 w-4"})}),f.jsx(rt,{variant:x.multimodal?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.multimodal&&"text-primary"),onClick:()=>T("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(sd,{className:"h-4 w-4"})}),f.jsx(rt,{variant:x.imageGeneration?"secondary":"ghost",size:"sm",className:Ye("h-7 w-7 p-0",x.imageGeneration&&"text-primary"),onClick:()=>T("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(Xm,{className:"h-4 w-4"})})]}),R>0&&f.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:R})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(At,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(ul,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:k.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:R>0?"No models match all active filters.":e.globallyEnabledModels.length===0?"No models available.":"No models match search."}):k.map(V=>{var D,z,$,Y,B,G,Z,ne,ae,le,Se,Ee;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(au,{id:`model-${V.id}`,checked:r.includes(V.id),onCheckedChange:he=>M(V.id,he===!0)}),f.jsxs(At,{htmlFor:`model-${V.id}`,className:"text-sm cursor-pointer flex-1 min-w-0 flex justify-between items-center",children:[f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:V.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",V.providerName,")"]})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((z=(D=V.metadataSummary)==null?void 0:D.supported_parameters)==null?void 0:z.includes("reasoning"))&&f.jsx(Ow,{className:"h-3.5 w-3.5 text-purple-500"}),(((Y=($=V.metadataSummary)==null?void 0:$.supported_parameters)==null?void 0:Y.includes("web_search"))||((G=(B=V.metadataSummary)==null?void 0:B.supported_parameters)==null?void 0:G.includes("web_search_options")))&&f.jsx(Dw,{className:"h-3.5 w-3.5 text-blue-500"}),((ne=(Z=V.metadataSummary)==null?void 0:Z.supported_parameters)==null?void 0:ne.includes("tools"))&&f.jsx(Jh,{className:"h-3.5 w-3.5 text-orange-500"}),((le=(ae=V.metadataSummary)==null?void 0:ae.input_modalities)==null?void 0:le.some(he=>he!=="text"))&&f.jsx(sd,{className:"h-3.5 w-3.5 text-green-500"}),((Ee=(Se=V.metadataSummary)==null?void 0:Se.output_modalities)==null?void 0:Ee.includes("image"))&&f.jsx(Xm,{className:"h-3.5 w-3.5 text-pink-500"})]})]})]},V.id)})})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(At,{htmlFor:"stagger-ms",children:"Stagger (ms)"}),f.jsx(vn,{id:"stagger-ms",type:"number",value:i,onChange:V=>a(parseInt(V.target.value,10)),className:"mt-1"})]}),f.jsxs("div",{children:[f.jsx(At,{htmlFor:"race-timeout",children:"Timeout (s)"}),f.jsx(vn,{id:"race-timeout",type:"number",value:o,onChange:V=>l(parseInt(V.target.value,10)||120),className:"mt-1"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"combine-switch",children:"Combine Models"}),f.jsx(Eo,{id:"combine-switch",checked:c,onCheckedChange:V=>u(V)})]}),c&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"combine-model-selector",children:"Combine with Model"}),f.jsx(Bp,{models:e.globallyEnabledModels,value:d,onChange:V=>h(V),isLoading:e.isLoadingProviders})]}),c&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"combine-prompt",children:"Combine Prompt"}),f.jsx(Mi,{id:"combine-prompt",value:p,onChange:V=>g(V.target.value),placeholder:"Enter a prompt to combine models",className:"w-full"})]})]}),f.jsxs(Fg,{className:"flex-shrink-0 p-2 md:p-3 pt-1 md:pt-2",children:[f.jsx(rt,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(rt,{onClick:j,disabled:r.length<1||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class FZe{constructor(){ue(this,"id","race-prompt-control");ue(this,"eventUnsubscribers",[]);ue(this,"modApi",null);ue(this,"notifyComponentUpdate",null);ue(this,"isRaceMode",!1);ue(this,"raceConfig",{modelIds:[],staggerMs:250,raceTimeoutSec:120,combineEnabled:!1});ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Gn.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on($n.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on($n.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(Wy.INTERACTION_BEFORE_START,a=>{if(this.isRaceMode){const o={...this.raceConfig};return this.setRaceMode(!1),this.handleRaceConversion(a.prompt,a.conversationId,o),!1}return a});this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n){var r;this.isRaceMode=t,t&&n?this.raceConfig={...n,raceTimeoutSec:n.raceTimeoutSec||120}:this.raceConfig={modelIds:[],staggerMs:250,raceTimeoutSec:120,combineEnabled:!1},(r=this.notifyComponentUpdate)==null||r.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceConversion(t,n,r){var s,i;try{const{modelIds:a,staggerMs:o,combineEnabled:l,combineModelId:c}=r;if(a.length===0)throw new Error("No additional models selected for race");if(l&&!c)throw new Error("Combine model not selected");const u=en.getState(),d=t.messages[t.messages.length-1];if(!d||d.role!=="user")throw new Error("Could not find user message in prompt");let h="";typeof d.content=="string"?h=d.content:Array.isArray(d.content)&&(h=d.content.filter(y=>y.type==="text").map(y=>y.text).join(""));const p={id:"",content:h,parameters:t.parameters||{},metadata:{...t.metadata,modelId:((s=t.metadata)==null?void 0:s.modelId)||""}},g=(i=t.metadata)==null?void 0:i.modelId;if(!g)throw new Error("No model ID available in prompt metadata");if(l){const{nanoid:y}=await zr(async()=>{const{nanoid:j}=await Promise.resolve().then(()=>GI);return{nanoid:j}},void 0),v=y(),x={...p,id:v,metadata:{...p.metadata,modelId:c,isRaceCombining:!0,raceParticipantCount:a.length+1,raceConfig:r}},S=u.interactions.filter(j=>j.conversationId===n).reduce((j,F)=>Math.max(j,F.index),-1)+1,_={id:v,conversationId:n,type:"message.user_assistant",prompt:{...x},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...x.metadata,isRaceCombining:!0,raceParticipantCount:a.length+1,toolCalls:[],toolResults:[]},index:S,parentId:null};u._addInteractionToState(_),u._addStreamingId(_.id),u.setActiveStreamBuffer(_.id," Starting race with "+(a.length+1)+` models...

 Collecting responses for combination...`),await dt.saveInteraction(_),Ae.emit(xn.added,{interaction:_}),Ae.emit(xn.started,{interactionId:_.id,conversationId:_.conversationId,type:_.type});const T=[g,...a].map((j,F)=>new Promise(P=>{setTimeout(async()=>{try{const q=y(),I={...p,id:q,metadata:{...p.metadata,modelId:j,raceTab:!0,raceParticipantIndex:F+1,raceMainInteractionId:_.id}},V={...t,metadata:{...t.metadata,modelId:j}},D=await Rl.startInteraction(V,n,I,"message.assistant_regen");if(D){const z={parentId:_.id,index:F+1};u._updateInteractionInState(D.id,z),await dt.saveInteraction({...D,...z})}P({interaction:D,modelId:j})}catch(q){console.error(`[RacePromptControlModule] Error creating child interaction for ${j}:`,q),P({interaction:null,modelId:j})}},F*o)})),M=(await Promise.all(T)).filter(j=>j.interaction!==null).map(j=>j.interaction.id);await this.waitForRaceCompletion(_.id,M,r.raceTimeoutSec)}else{const{nanoid:y}=await zr(async()=>{const{nanoid:T}=await Promise.resolve().then(()=>GI);return{nanoid:T}},void 0),v=y(),x={...p,id:v,metadata:{...p.metadata,modelId:g,raceTab:!0,raceParticipantIndex:1,raceMainInteractionId:v}},w=await Rl.startInteraction(t,n,x,"message.user_assistant");if(!w)throw new Error("Could not create main race interaction");const S=a.map((T,A)=>new Promise(R=>{setTimeout(async()=>{try{const M=y(),j={...p,id:M,metadata:{...p.metadata,modelId:T,raceTab:!0,raceParticipantIndex:A+2,raceMainInteractionId:w.id}},F={...t,metadata:{...t.metadata,modelId:T}},P=await Rl.startInteraction(F,n,j,"message.assistant_regen");if(P){const q={parentId:w.id,index:A+1};u._updateInteractionInState(P.id,q),await dt.saveInteraction({...P,...q})}R({interaction:P,modelId:T})}catch(M){console.error(`[RacePromptControlModule] Error creating child interaction for ${T}:`,M),R({interaction:null,modelId:T})}},A*o)})),k=(await Promise.all(S)).filter(T=>T.interaction!==null);ke.success(`Race started! Original model + ${k.length} additional race models responding in tabs.`)}}catch(a){ke.error(`Race conversion failed: ${String(a)}`),console.error("[RacePromptControlModule] Error during race conversion:",a)}}async waitForRaceCompletion(t,n,r=120){return new Promise(s=>{let i=0;const a=n.length;let o=null;const l=()=>{o&&(clearTimeout(o),o=null),Ae.off(xn.completed,c)},c=u=>{if(n.includes(u.interactionId)&&(u.status==="COMPLETED"||u.status==="ERROR")){i++;const d=en.getState(),h=` Race progress: ${i}/${a} models completed

 ${i===a?"Combining responses...":"Waiting for remaining responses..."}`;d.setActiveStreamBuffer(t,h);const p={metadata:{isRaceCombining:!0,raceCompletedCount:i,raceParticipantCount:a}};d._updateInteractionInState(t,p),i===a&&(l(),this.startCombineProcess(t,n),s())}};Ae.on(xn.completed,c),o=setTimeout(()=>{console.warn(`[RacePromptControlModule] Race timed out for main interaction ${t}.`),l();const u=en.getState(),d=` Race timed out. Only ${i}/${a} models responded within ${r} seconds.`;u.setActiveStreamBuffer(t,d),u._updateInteractionInState(t,{status:"ERROR",endedAt:new Date,metadata:{isRaceCombining:!1,combineError:"Race timed out"}}),u._removeStreamingId(t),s()},r*1e3)})}async startCombineProcess(t,n){var r;try{const s=en.getState(),i=s.interactions.find(v=>v.id===t),a=(r=i==null?void 0:i.metadata)==null?void 0:r.raceConfig,{combineModelId:o,combinePrompt:l}=a||{};if(!o)throw new Error("Combine model not configured");const c=s.currentConversationId;if(!c)throw new Error("No current conversation ID available for combine process");const u=n.map((v,x)=>{var T;const w=s.interactions.find(A=>A.id===v),S=((T=w==null?void 0:w.metadata)==null?void 0:T.modelId)||`Model ${x+1}`,_=(w==null?void 0:w.response)||"No response",k=(w==null?void 0:w.status)||"UNKNOWN";return`**${S}** (${k}):
${_}`}).join(`

---

`),p={system:"You are an expert at analyzing and synthesizing multiple AI responses into comprehensive, unified answers.",messages:[{role:"user",content:`${l||`Please analyze and combine the following AI responses to provide a comprehensive, well-structured answer. 

Take the best insights from each response, resolve any contradictions, and present a unified, clear, and complete answer. If responses differ significantly, explain the different perspectives and provide your reasoned conclusion.

Focus on accuracy, completeness, and clarity in your combined response.`}

Here are the responses to combine:

${u}`}],parameters:{temperature:.3,max_tokens:4e3},metadata:{modelId:o,isCompactGeneration:!0}},{nanoid:g}=await zr(async()=>{const{nanoid:v}=await Promise.resolve().then(()=>GI);return{nanoid:v}},void 0),y={id:g(),content:`[Internal combine generation for race interaction ${t}]`,parameters:p.parameters,metadata:{modelId:o,targetUserInteractionId:t,targetConversationId:c}};await Rl.startInteraction(p,c,y,"conversation.compact")}catch(s){const i=en.getState();i._updateInteractionInState(t,{response:` Failed to combine responses: ${String(s)}`,status:"ERROR",endedAt:new Date,metadata:{isRaceCombining:!1,combineError:String(s)}}),i._removeStreamingId(t)}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(DZe,{module:this})})}}const LZe=Ze({selectedModelId:qe().min(1,"Please select a model"),originalPrompt:qe().min(1,"Please enter a prompt to enhance"),customSystemPrompt:qe().optional()}),$Ze=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState("setup"),[,i]=E.useState({}),[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState(null),{status:h}=en(pn(k=>({status:k.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]),E.useEffect(()=>{const k=()=>{o(!0),d(null)},T=R=>{o(!1),c(R.enhancedPrompt),s("result"),ke.success("Prompt enhancement completed!")},A=R=>{o(!1),d(R.error),ke.error(`Enhancement failed: ${R.error}`)};return Ae.on(an.enhancementStarted,k),Ae.on(an.enhancementCompleted,T),Ae.on(an.enhancementFailed,A),()=>{Ae.off(an.enhancementStarted,k),Ae.off(an.enhancementCompleted,T),Ae.off(an.enhancementFailed,A)}},[]);const p=({fieldApi:k,label:T})=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"model-selector",children:T}),f.jsx(Bp,{models:e.globallyEnabledModels,value:k.state.value,onChange:k.handleChange,isLoading:e.isLoadingProviders,className:"w-full"}),k.state.meta.isTouched&&k.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:k.state.meta.errors.map((A,R)=>f.jsx("p",{children:String(A)},R))})]}),{Form:g}=Dg({schema:LZe,fields:[{name:"selectedModelId",type:"custom",label:"Select Enhancement Model",component:p},{name:"originalPrompt",type:"textarea",label:"Original Prompt",placeholder:"Enter the prompt you want to enhance...",description:"This will be enhanced using AI"},{name:"customSystemPrompt",type:"textarea",label:"Custom System Prompt (Optional)",placeholder:"Leave empty to use default prompt engineering instructions...",description:"Custom instructions for how to enhance the prompt"}],defaultComponents:{custom:p},submitLabel:a?"Enhancing...":"Enhance Prompt",formOptions:{defaultValues:{selectedModelId:"",originalPrompt:e.currentPromptText,customSystemPrompt:""},onSubmit:async({value:k})=>{var T;if(!k.selectedModelId){ke.error("Please select a model");return}if(!k.originalPrompt.trim()){ke.error("Please enter a prompt to enhance");return}Ae.emit(an.enhancePromptRequest,{prompt:k.originalPrompt.trim(),modelId:k.selectedModelId,systemPrompt:((T=k.customSystemPrompt)==null?void 0:T.trim())||void 0})}}}),y=()=>{Ae.emit(an.setInputTextRequest,{text:l}),n(!1),ke.success("Enhanced prompt applied!"),v()},v=()=>{s("setup"),o(!1),c(""),d(null)},x=k=>{if(k.stopPropagation(),h==="streaming"){ke.info("Cannot enhance prompt while another response is streaming");return}if(e.globallyEnabledModels.length===0){ke.info("No models available for prompt enhancement");return}n(!0)},w=h!=="streaming"&&e.globallyEnabledModels.length>0,S=()=>h==="streaming"?"Cannot enhance prompt while streaming":e.globallyEnabledModels.length===0?"No models available for enhancement":"Improve your prompt with AI assistance",_=[{value:"setup",label:"Setup",content:f.jsx("div",{className:"space-y-4",children:f.jsx(g,{})})},{value:"result",label:"Result",content:f.jsx("div",{className:"space-y-4",children:u?f.jsx("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:f.jsxs("p",{className:"text-sm text-destructive",children:["Enhancement failed: ",u]})}):l?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{children:"Enhanced Prompt"}),f.jsx("div",{className:"p-3 bg-primary/5 border border-primary/20 rounded-lg text-sm",children:l})]}),f.jsx(rt,{onClick:y,className:"w-full",children:"Use Enhanced Prompt"})]}):f.jsx("div",{className:"text-center text-muted-foreground py-8",children:a?"Enhancing your prompt...":"No enhancement result yet. Run the enhancement first."})})}];return f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:S(),onClick:x,"aria-label":"Improve Prompt with AI",disabled:!w,icon:f.jsx(mY,{}),className:"h-5 w-5 md:h-6 md:w-6"}),f.jsx(vd,{open:t,onOpenChange:n,children:f.jsxs(xd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col p-4",children:[f.jsxs(wd,{children:[f.jsx(Sd,{children:"Improve Prompt"}),f.jsx(Bf,{children:"Use AI to enhance your prompt for better results. Select a model and optionally customize the enhancement instructions."})]}),f.jsx("div",{className:"flex-1 min-h-0",children:f.jsx(jo,{tabs:_,initialValue:r,onValueChange:s,scrollable:!1})})]})})]})};class qoe{static initialize(){Ae.on(an.enhancePromptRequest,async t=>{await this.handlePromptEnhancement(t)})}static async handlePromptEnhancement(t){try{const{prompt:n,modelId:r,systemPrompt:s}=t,i=en.getState(),a=i.currentConversationId;if(!a){ke.error("No active conversation for prompt enhancement");return}const o=dr();Ae.emit(an.enhancementStarted,{interactionId:o,originalPrompt:n});const l=i.interactions.filter(v=>v.conversationId===a&&v.status==="COMPLETED"&&v.type==="message.user_assistant"&&v.parentId===null).sort((v,x)=>v.index-x.index),c=fw(l),d=s||`You are an expert prompt engineer. Your task is to improve and enhance the given user prompt to make it more effective, specific, and likely to produce better results from AI models.

Please analyze the user's prompt and enhance it by:
1. Making it more specific and detailed
2. Adding relevant context or constraints if helpful
3. Improving clarity and structure
4. Suggesting better formatting if needed
5. Maintaining the original intent and requirements

Return ONLY the enhanced prompt without any explanations, comments, or additional text.`,h={role:"user",content:[{type:"text",text:`Please enhance this prompt:

${n}`}]},p={system:d,messages:[...c,h],parameters:{temperature:.3,max_tokens:1e3},metadata:{modelId:r,isPromptEnhancement:!0}},g={id:o,content:`Enhance prompt: ${n}`,parameters:{temperature:.3,max_tokens:1e3},metadata:{modelId:r,isPromptEnhancement:!0,originalPrompt:n}};if(!await Rl.startInteraction(p,a,g,"prompt.enhance"))throw new Error("Failed to create prompt enhancement interaction");ke.info("Enhancing your prompt...")}catch(n){const r=n instanceof Error?n.message:String(n);console.error("[PromptEnhancementService] Error during prompt enhancement:",n),Ae.emit(an.enhancementFailed,{interactionId:"unknown",error:r}),ke.error(`Prompt enhancement failed: ${r}`)}}static async handleEnhancementCompletion(t,n){try{Ae.emit(an.enhancementCompleted,{interactionId:t,enhancedPrompt:n}),ke.success("Prompt enhanced successfully!")}catch(r){console.error("[PromptEnhancementService] Error handling enhancement completion:",r)}}}const BZe=Object.freeze(Object.defineProperty({__proto__:null,PromptEnhancementService:qoe},Symbol.toStringTag,{value:"Module"}));class zZe{constructor(){ue(this,"id","improve-prompt-control");ue(this,"eventUnsubscribers",[]);ue(this,"modApi",null);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!1);ue(this,"currentPromptText","")}async initialize(t){this.modApi=t,qoe.initialize();const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on($n.globallyEnabledModelsUpdated,o=>{var u;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Gn.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0),l&&((u=this.notifyComponentUpdate)==null||u.call(this))}),s=t.on($n.initialDataLoaded,()=>{var u;const o=Gn.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((u=this.notifyComponentUpdate)==null||u.call(this))}),i=t.on(an.inputTextStateChanged,o=>{this.currentPromptText=o.value}),a=t.on(an.inputChanged,o=>{this.currentPromptText=o.value});this.eventUnsubscribers.push(r,s,i,a)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}getCurrentPromptText(){return this.currentPromptText}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement($Ze,{module:this})})}}function UZe({templates:e,onSelect:t}){const[n,r]=E.useState(""),s=e.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.description.toLowerCase().includes(n.toLowerCase())||a.tags.some(o=>o.toLowerCase().includes(n.toLowerCase()))),i=()=>{Ae.emit(Ir.openModalRequest,{modalId:"settingsModal",initialTab:"assistant",initialSubTab:"prompts"})};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx(At,{htmlFor:"search",children:"Search Templates"}),f.jsx(vn,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:a=>r(a.target.value)})]}),f.jsx("div",{className:"pt-6",children:f.jsxs(rt,{variant:"outline",size:"sm",onClick:i,className:"h-9 px-3",title:"Open Template Settings",children:[f.jsx(Xh,{className:"h-4 w-4 mr-1"}),"Manage"]})})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(a=>f.jsxs(Ba,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(a),children:[f.jsx(ro,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(so,{className:"text-sm",children:a.name}),f.jsx(dc,{className:"text-xs",children:a.description})]}),a.isPublic&&f.jsx(cs,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx(za,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.map(o=>f.jsx(cs,{variant:"outline",className:"text-xs",children:o},o)),a.variables.length>0&&f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[a.variables.length," variables"]}),a.tools&&a.tools.length>0&&f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[a.tools.length," tools"]}),a.rules&&a.rules.length>0&&f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[a.rules.length," rules"]})]})})]},a.id))})]})}function qZe({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default!=null?String(l.default):`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>(c.default!==void 0&&(l[c.name]=QA(c.default,c.type)),l),{}),{Form:o}=Dg({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(rt,{variant:"outline",size:"sm",onClick:n,children:" Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(rt,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(At,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(At,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const VZe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),i=E.useRef(null),{loadPromptTemplates:a,getTemplatesByType:o}=tl(pn(p=>({loadPromptTemplates:p.loadPromptTemplates,getTemplatesByType:p.getTemplatesByType}))),l=o("prompt");E.useEffect(()=>{t&&a()},[t,a]);const c=p=>{s(p),i.current&&(i.current.textContent=p.prompt)},u=async p=>{if(r)try{await e.applyTemplate(r.id,p),n(!1),s(null),ke.success("Template applied to input area!")}catch(g){console.error("Failed to Proompt :",g),ke.error("Failed to Proompt !")}},d=()=>{s(null)},h=async p=>{if(!(!r||!i.current))try{const g=await e.compileTemplate(r.id,p);i.current.textContent=g.content}catch(g){i.current.textContent=`Error: ${g instanceof Error?g.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx($ye,{className:"h-4 w-4"})}),f.jsx(vd,{open:t,onOpenChange:n,children:f.jsxs(xd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(wd,{children:[f.jsx(Sd,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(Bf,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(qZe,{template:r,onSubmit:u,onBack:d,module:e,previewElementRef:i,onCompile:h}):f.jsx(UZe,{templates:l,onSelect:c})})]})})]})};class WZe{constructor(){ue(this,"id","core-prompt-library");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"isStreaming",!1);ue(this,"modApiRef",null);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ue(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=tl.getState();return await r(t,n)});ue(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(an.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=en.getState().status==="streaming";const n=t.on(xn.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(VZe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const HZe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:f.jsxs("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:[f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`}),f.jsx("path",{d:`M1854 2726 c-92 -40 -150 -139 -141 -239 21 -237 343 -298 446 -84
59 123 -10 287 -138 325 -51 16 -128 15 -167 -2z`}),f.jsx("path",{d:`M3053 2719 c-81 -40 -133 -121 -133 -205 0 -102 47 -180 134 -220 95
-44 193 -27 268 47 78 78 94 181 44 278 -21 38 -76 88 -118 105 -54 23 -144
20 -195 -5z`}),f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})]})})};function GZe({agents:e,onUseAgent:t,onClearAgent:n,hasActiveAgent:r,currentAgentName:s,module:i}){const[a,o]=E.useState(""),l=e.filter(u=>u.name.toLowerCase().includes(a.toLowerCase())||u.description.toLowerCase().includes(a.toLowerCase())||u.tags.some(d=>d.toLowerCase().includes(a.toLowerCase()))),c=()=>{Ae.emit(Ir.openModalRequest,{modalId:"settingsModal",initialTab:"assistant",initialSubTab:"agents"})};return f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ly,{className:"h-4 w-4 text-primary"}),f.jsxs("span",{className:"text-sm font-medium",children:["Active Agent: ",s]})]}),f.jsx(rt,{variant:"outline",size:"sm",onClick:n,children:"Clear Agent"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx(At,{htmlFor:"search",children:"Search Agents"}),f.jsx(vn,{id:"search",placeholder:"Search by name, description, or tags...",value:a,onChange:u=>o(u.target.value)})]}),f.jsx("div",{className:"pt-6",children:f.jsxs(rt,{variant:"outline",size:"sm",onClick:c,className:"h-9 px-3",title:"Open Agent Settings",children:[f.jsx(Xh,{className:"h-4 w-4 mr-1"}),"Manage"]})})]}),f.jsx("div",{className:"grid gap-3",children:l.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No agents match your search.":"No agents available."}):l.map(u=>{const d=i.getTasksForAgent(u.id);return f.jsxs(Ba,{className:"hover:bg-muted/50 transition-colors",children:[f.jsx(ro,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsxs(so,{className:"text-sm flex items-center gap-2",children:[f.jsx(Ly,{className:"h-4 w-4"}),u.name]}),f.jsx(dc,{className:"text-xs",children:u.description})]}),u.isPublic&&f.jsx(cs,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsxs(za,{className:"pt-0 space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[d.length," tasks"]}),u.tags.map(h=>f.jsx(cs,{variant:"outline",className:"text-xs",children:h},h)),u.variables.length>0&&f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[u.variables.length," variables"]}),u.tools&&u.tools.length>0&&f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[u.tools.length," tools"]}),u.rules&&u.rules.length>0&&f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[u.rules.length," rules"]})]}),f.jsx(rt,{size:"sm",onClick:()=>t(u),className:"w-full",children:"Use Agent"})]})]},u.id)})})]})}function KZe({agent:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default!=null?String(o.default):`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>(l.default!==void 0&&(o[l.name]=QA(l.default,l.type)),o),{}),{Form:a}=Dg({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This agent has no variables defined. The agent will be applied as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(At,{className:"text-sm font-medium mb-4 block",children:"Agent Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(At,{className:"text-sm font-medium",children:"System Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function YZe({task:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default!=null?String(o.default):`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>(l.default!==void 0&&(o[l.name]=QA(l.default,l.type)),o),{}),{Form:a}=Dg({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This task has no variables defined. The task will be executed as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(At,{className:"text-sm font-medium mb-4 block",children:"Task Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(At,{className:"text-sm font-medium",children:"Task Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function ZZe({agent:e,tasks:t,onSubmit:n,onBack:r,previewElementRef:s,onCompile:i,autoClearEnabled:a,onAutoClearChange:o,module:l}){const[c,u]=E.useState(""),[d,h]=E.useState({}),[p,g]=E.useState({}),y=E.useRef(null),v=t.find(A=>A.id===c),x=A=>{h(A)},w=A=>{g(A)},S=A=>{u(A),g({})},_=()=>{v?n(d,v,p):n(d)},k=async A=>{if(s.current)try{await i(A)}catch(R){s.current&&(s.current.textContent=`Error: ${R instanceof Error?R.message:"Compilation failed"}`)}},T=async A=>{if(!(!v||!y.current))try{const R=await l.compileTaskTemplate(v.id,A);y.current.textContent=R.content}catch(R){y.current.textContent=`Error: ${R instanceof Error?R.message:"Compilation failed"}`}};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsxs(rt,{variant:"ghost",size:"sm",onClick:r,children:[f.jsx(Nye,{className:"h-4 w-4 mr-1"}),"Back to Agents"]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(At,{htmlFor:"auto-clear",className:"text-sm",children:"Auto-clear after use"}),f.jsx(Eo,{id:"auto-clear",checked:a,onCheckedChange:o})]})]}),t.length>0&&f.jsxs(Ba,{className:"mb-4",children:[f.jsxs(ro,{children:[f.jsx(so,{className:"text-lg",children:"Task Selection (Optional)"}),f.jsx(dc,{children:"Choose a task to execute with this agent, or leave empty to use the agent alone."})]}),f.jsx(za,{children:f.jsxs("div",{children:[f.jsx(At,{htmlFor:"task-select",children:"Select Task"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(mc,{value:c,onValueChange:S,children:[f.jsx(yc,{className:"flex-1",children:f.jsx(gc,{placeholder:"Select a task (optional)"})}),f.jsx(bc,{children:t.map(A=>f.jsx(yi,{value:A.id,children:A.name},A.id))})]}),c&&f.jsx(rt,{variant:"outline",size:"sm",onClick:()=>u(""),children:"Clear"})]})]})})]}),f.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[f.jsxs(Ba,{children:[f.jsxs(ro,{children:[f.jsx(so,{className:"text-lg",children:"Agent Configuration"}),f.jsxs(dc,{children:["Configure the system prompt and settings for ",e.name]})]}),f.jsx(za,{children:f.jsx(KZe,{agent:e,onChange:x,previewElementRef:s,onCompile:k})})]}),v&&f.jsxs(Ba,{children:[f.jsxs(ro,{children:[f.jsx(so,{className:"text-lg",children:"Task Configuration"}),f.jsxs(dc,{children:["Configure the task prompt for ",v.name]})]}),f.jsx(za,{children:f.jsx(YZe,{task:v,onChange:w,previewElementRef:y,onCompile:T})})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsxs(rt,{onClick:_,size:"lg",children:["Use Agent ",v?`with ${v.name}`:""]})})]})]})}const XZe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),[i,a]=E.useState(!1),[o,l]=E.useState(0),c=E.useRef(null);E.useEffect(()=>{const k=()=>{l(T=>T+1)};return e.setNotifyCallback(k),()=>{e.setNotifyCallback(null)}},[e]),E.useEffect(()=>{t&&e.loadPromptTemplates()},[t,e]);const u=e.getAgents(),d=e.hasActiveAgent(),h=e.getCurrentAgentId(),p=h?u.find(k=>k.id===h):null;E.useEffect(()=>{},[o]);const g=k=>{s(k),a(!0)},y=async(k,T,A)=>{var R;if(r)try{T&&A?(await e.applyAgentWithTask(r.id,T.id,k,A),ke.success(`Agent "${r.name}" applied with task "${T.name}"!`)):(await e.applyAgent(r.id,k),ke.success(`Agent "${r.name}" applied!`)),e.getAutoClearEnabled()&&((R=e.clearOnSubmit)==null||R.call(e)),n(!1),s(null),a(!1)}catch(M){console.error("Failed to apply agent:",M),ke.error("Failed to apply agent!")}},v=()=>{s(null),a(!1)},x=()=>{var k;(k=e.clearOnSubmit)==null||k.call(e),ke.success("Agent cleared!")},w=async k=>{if(!(!r||!c.current))try{const T=await e.compileTemplate(r.id,k);c.current.textContent=T.content}catch(T){c.current.textContent=`Error: ${T instanceof Error?T.message:"Compilation failed"}`}},S=()=>i&&r?`Configure ${r.name}`:"Select Agent",_=()=>i&&r?"Configure the agent and optionally select a task to execute.":"Select an AI agent to work with. Each agent has specialized capabilities and tasks.";return f.jsxs(f.Fragment,{children:[f.jsx(rt,{variant:d?"secondary":"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:d?`Active Agent: ${(p==null?void 0:p.name)||"Unknown"}`:"Select Agent",children:f.jsx(HZe,{className:"h-4 w-4"})}),f.jsx(vd,{open:t,onOpenChange:n,children:f.jsxs(xd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(wd,{children:[f.jsx(Sd,{children:S()}),f.jsx(Bf,{children:_()})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:i&&r?f.jsx(ZZe,{agent:r,tasks:e.getTasksForAgent(r.id),onSubmit:y,onBack:v,previewElementRef:c,onCompile:w,autoClearEnabled:e.getAutoClearEnabled(),onAutoClearChange:e.setAutoClearEnabled,module:e}):f.jsx(GZe,{agents:u,onUseAgent:g,onClearAgent:x,hasActiveAgent:d,currentAgentName:p==null?void 0:p.name,module:e})})]})})]})};class JZe{constructor(){ue(this,"id","agent-control");ue(this,"unregisterPromptControlCallback",null);ue(this,"unregisterCallback");ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"allTemplates",[]);ue(this,"isLoadingTemplates",!0);ue(this,"notifyComponentUpdate",null);ue(this,"currentAgentId",null);ue(this,"currentAgentSystemPrompt",null);ue(this,"autoClearEnabled",!1);ue(this,"getAllTemplates",()=>this.allTemplates);ue(this,"getAgents",()=>this.allTemplates.filter(t=>(t.type||"prompt")==="agent"));ue(this,"getTasksForAgent",t=>this.allTemplates.filter(n=>(n.type||"prompt")==="task"&&n.parentId===t));ue(this,"getIsLoadingTemplates",()=>this.isLoadingTemplates);ue(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=tl.getState();return await r(t,n)});ue(this,"compileTaskTemplate",async(t,n)=>{const{compilePromptTemplate:r}=tl.getState();return await r(t,n)});ue(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(an.setInputTextRequest,{text:r.content}),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});ue(this,"applyAgent",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);this.currentAgentId=t,this.currentAgentSystemPrompt=r.content,(s=this.notifyComponentUpdate)==null||s.call(this),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});ue(this,"applyAgentWithTask",async(t,n,r,s)=>{var a;await this.applyAgent(t,r);const i=await this.compileTemplate(n,s);(a=this.modApiRef)==null||a.emit(an.setInputTextRequest,{text:i.content}),i.selectedTools&&i.selectedTools.length>0,i.selectedRules&&i.selectedRules.length>0});ue(this,"getCurrentAgentId",()=>this.currentAgentId);ue(this,"getCurrentAgentSystemPrompt",()=>this.currentAgentSystemPrompt);ue(this,"hasActiveAgent",()=>this.currentAgentId!==null);ue(this,"getAutoClearEnabled",()=>this.autoClearEnabled);ue(this,"setAutoClearEnabled",t=>{this.autoClearEnabled=t});ue(this,"clearOnSubmit",()=>{var t;this.currentAgentId=null,this.currentAgentSystemPrompt=null,(t=this.notifyComponentUpdate)==null||t.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ue(this,"loadPromptTemplates",()=>{var t;(t=this.modApiRef)==null||t.emit(Fa.loadPromptTemplatesRequest,{})})}async initialize(t){this.modApiRef=t,t.emit(Fa.loadPromptTemplatesRequest,{});const n=t.on(Fa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,this.isLoadingTemplates=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Fa.promptTemplateAdded,a=>{var o;a!=null&&a.promptTemplate&&(this.allTemplates=[...this.allTemplates,a.promptTemplate],(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.on(Fa.promptTemplateUpdated,a=>{var o;if(a!=null&&a.promptTemplate){const l=this.allTemplates.findIndex(c=>c.id===a.promptTemplate.id);l!==-1&&(this.allTemplates[l]=a.promptTemplate,(o=this.notifyComponentUpdate)==null||o.call(this))}}),i=t.on(Fa.promptTemplateDeleted,a=>{var o;a!=null&&a.id&&(this.allTemplates=this.allTemplates.filter(l=>l.id!==a.id),(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s,i)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(XZe,{module:this}),getMetadata:()=>{if(this.currentAgentSystemPrompt)return{turnSystemPrompt:this.currentAgentSystemPrompt}},clearOnSubmit:()=>{var n;this.autoClearEnabled&&(this.currentAgentId=null,this.currentAgentSystemPrompt=null,(n=this.notifyComponentUpdate)==null||n.call(this))}}))}destroy(t){this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.modApiRef=null,this.notifyComponentUpdate=null,this.unregisterCallback&&this.unregisterCallback()}}const QZe=({step:e,onChange:t,onDelete:n,promptTemplates:r,agentTasks:s,models:i,module:a,workflow:o,stepIndex:l})=>{const[c,u]=E.useState(!0),d=e.type==="prompt"?r:e.type==="agent-task"?s:[],h=v=>{t({...e,templateId:v,prompt:void 0,structuredOutput:void 0})},p=v=>{const x=v.target.value;t({...e,name:x})},g=v=>a!=null&&a.validateTransformQuery?a.validateTransformQuery(v,o,l):v.trim()?v.startsWith("$.")?/[^a-zA-Z0-9_.$\[\]]/.test(v.replace(/\[(\d+)\]/g,""))?{isValid:!1,error:"Invalid characters in query"}:{isValid:!0}:{isValid:!1,error:'Query must start with "$."'}:{isValid:!1,error:"Query cannot be empty"},y=()=>{switch(e.type){case"agent-task":return"Agent Task";case"human-in-the-loop":return"Human Review";case"transform":return"Data Transform";default:return"AI Prompt"}};return f.jsxs("div",{className:"border rounded-lg bg-muted/20",children:[f.jsxs("div",{className:"flex items-center justify-between p-3 cursor-pointer",onClick:()=>u(!c),children:[f.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[f.jsx(rt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:c?f.jsx(Fl,{className:"h-4 w-4"}):f.jsx(NT,{className:"h-4 w-4"})}),f.jsx("div",{className:"font-medium",children:e.name}),f.jsxs("div",{className:"text-sm text-muted-foreground",children:["(",y(),")"]})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[e.modelId&&f.jsx("div",{className:"text-xs text-muted-foreground",children:e.modelId}),f.jsx(rt,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-red-500 hover:text-red-700 hover:bg-red-50",onClick:v=>{v.stopPropagation(),n()},title:"Delete step",children:f.jsx(to,{className:"h-4 w-4"})})]})]}),c&&f.jsxs("div",{className:"px-3 pb-3 space-y-3 border-t",children:[f.jsxs("div",{className:"space-y-1 pt-3",children:[f.jsx(At,{htmlFor:`step-name-${e.id}`,children:"Step Name"}),f.jsx(vn,{id:`step-name-${e.id}`,value:e.name,onChange:p})]}),e.type!=="transform"&&e.type!=="human-in-the-loop"&&f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{children:"Model"}),f.jsx(Bp,{value:e.modelId,onChange:v=>t({...e,modelId:v||void 0}),models:i,className:"w-full"})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{htmlFor:`step-type-${e.id}`,children:"Step Type"}),f.jsxs(mc,{value:e.type,onValueChange:v=>t({...e,type:v,templateId:void 0,prompt:void 0,structuredOutput:void 0,transformMappings:v==="transform"?{}:void 0,instructionsForHuman:v==="human-in-the-loop"?"":void 0}),children:[f.jsx(yc,{id:`step-type-${e.id}`,children:f.jsx(gc,{placeholder:"Select step type"})}),f.jsxs(bc,{children:[f.jsx(yi,{value:"prompt",children:"AI Prompt (from Template)"}),f.jsx(yi,{value:"agent-task",children:"Agent Task (from Template)"}),f.jsx(yi,{value:"transform",children:"Data Transform"}),f.jsx(yi,{value:"human-in-the-loop",children:"Human in the Loop"})]})]})]}),(e.type==="prompt"||e.type==="agent-task")&&f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{htmlFor:`step-template-${e.id}`,children:"Template"}),f.jsxs(mc,{value:e.templateId||"",onValueChange:h,children:[f.jsx(yc,{id:`step-template-${e.id}`,children:f.jsx(gc,{placeholder:"Select a template"})}),f.jsx(bc,{children:d.map(v=>f.jsx(yi,{value:v.id,children:e.type==="agent-task"?v.prefixedName:v.name},v.id))})]})]}),e.type==="human-in-the-loop"&&f.jsxs("div",{className:"space-y-1",children:[f.jsx(At,{htmlFor:`step-instructions-${e.id}`,children:"Instructions for Human"}),f.jsx(vn,{id:`step-instructions-${e.id}`,value:e.instructionsForHuman||"",onChange:v=>t({...e,instructionsForHuman:v.target.value}),placeholder:"e.g., 'Review and approve the summary.'"})]}),e.type==="transform"&&f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"flex items-center justify-between",children:f.jsx(At,{children:"Data Transformations"})}),f.jsxs("div",{className:"text-xs text-muted-foreground p-2 bg-muted/30 rounded border",children:[f.jsx("strong",{children:"Available Context:"}),f.jsx("br",{})," ",f.jsx("code",{children:"$.workflow"})," - Original workflow template (name, steps, etc.)",f.jsx("br",{})," ",f.jsx("code",{children:"$.initial_step"})," - Initial user input/prompt output",f.jsx("br",{})," ",f.jsx("code",{children:"$.outputs[0]"})," - Initial step output (same as $.initial_step)",f.jsx("br",{})," ",f.jsx("code",{children:"$.outputs[1]"}),", ",f.jsx("code",{children:"$.outputs[2]"}),", etc. - Previous step outputs by index",f.jsx("br",{})," ",f.jsx("strong",{children:"Static values:"})," Use ",f.jsx("code",{children:'"literal text"'})," or ",f.jsx("code",{children:"123"})," for static data"]}),(()=>{var S;const v=(l??0)+1,x=(S=o==null?void 0:o.steps)==null?void 0:S[v];let w=[];if(x!=null&&x.templateId){if(x.type==="prompt"){const _=r.find(k=>k.id===x.templateId);w=(_==null?void 0:_.variables)||[]}else if(x.type==="agent-task"){const _=s.find(k=>k.id===x.templateId);w=(_==null?void 0:_.variables)||[]}}return w.length===0?f.jsx("div",{className:"text-center text-muted-foreground py-4 border-2 border-dashed border-border rounded-lg",children:x?`Next step "${x.name}" has no template variables to configure.`:"No next step found. Transform steps need a following step with template variables."}):w.map(_=>{var R;const k=((R=e.transformMappings)==null?void 0:R[_.name])||"",T=g(k),A=k&&(k.startsWith('"')&&k.endsWith('"')||!isNaN(Number(k))||k==="true"||k==="false");return f.jsxs("div",{className:"border border-border rounded-lg p-3 space-y-2",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx(At,{className:"text-sm font-medium",children:_.name}),_.required&&f.jsx("span",{className:"text-destructive ml-1",children:"*"}),_.description&&f.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:_.description})]}),f.jsx("div",{className:"text-xs text-muted-foreground bg-muted px-2 py-1 rounded",children:_.type})]}),f.jsxs("div",{children:[f.jsx(At,{className:"text-xs",children:"JSON Query or Static Value"}),f.jsx(vn,{value:k,onChange:M=>{const j={...e.transformMappings||{}};j[_.name]=M.target.value,t({...e,transformMappings:j})},placeholder:`$.initial_step.${_.name} or "static text" or 123`,className:`h-8 ${!T.isValid&&!A?"border-destructive":T.result!==void 0||A?"border-primary":""}`}),!T.isValid&&!A&&f.jsx("div",{className:"text-xs text-destructive mt-1",children:T.error}),A&&f.jsxs("div",{className:"text-xs text-primary mt-1 p-2 bg-primary/10 border border-primary/20 rounded",children:[f.jsx("strong",{children:"Static value:"})," ",k]}),T.isValid&&T.result!==void 0&&!A&&f.jsxs("div",{className:"text-xs text-primary mt-1 p-2 bg-primary/10 border border-primary/20 rounded",children:[f.jsx("strong",{children:"Sample result:"})," ",JSON.stringify(T.result)]})]})]},_.name)})})()]})]})]})},eXe=({module:e,onEditWorkflow:t,onCreateNew:n,onWorkflowsChanged:r,onWorkflowRun:s})=>{const[i,a]=E.useState([]),[o,l]=E.useState(!0);E.useEffect(()=>{c()},[]);const c=async()=>{try{l(!0);const p=await dt.loadWorkflows();a(p)}catch(p){console.error("Failed to load workflows:",p),ke.error("Failed to load workflows")}finally{l(!1)}},u=async(p,g)=>{if(confirm(`Are you sure you want to delete the workflow "${g}"?`))try{await dt.deleteWorkflow(p),a(y=>y.filter(v=>v.id!==p)),await e.refreshWorkflows(),r==null||r(),ke.success(`Deleted workflow "${g}"`)}catch(y){console.error("Failed to delete workflow:",y),ke.error("Failed to delete workflow")}},d=async p=>{try{const g={...p,id:dr(),name:`${p.name} (Copy)`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await dt.saveWorkflow(g),a(y=>[...y,g]),await e.refreshWorkflows(),r==null||r(),ke.success(`Duplicated workflow "${p.name}"`)}catch(g){console.error("Failed to duplicate workflow:",g),ke.error("Failed to duplicate workflow")}},h=p=>{const g=prompt(`Enter initial message for workflow "${p.name}":`);g&&(e.startWorkflow(p,g),s==null||s())};return o?f.jsx("div",{className:"flex items-center justify-center p-8",children:f.jsx("div",{className:"text-muted-foreground",children:"Loading workflows..."})}):f.jsxs("div",{className:"space-y-4 p-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Saved Workflows"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:[i.length," workflow",i.length!==1?"s":""," saved"]})]}),f.jsxs(rt,{onClick:n,className:"flex items-center gap-2",children:[f.jsx(al,{className:"h-4 w-4"}),"Create New Workflow"]})]}),i.length===0?f.jsx(Ba,{children:f.jsx(za,{className:"flex flex-col items-center justify-center py-12",children:f.jsxs("div",{className:"text-center space-y-2",children:[f.jsx("p",{className:"text-muted-foreground",children:"No workflows created yet"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create your first workflow to automate sequences of AI interactions"}),f.jsxs(rt,{onClick:n,className:"mt-4",children:[f.jsx(al,{className:"h-4 w-4 mr-2"}),"Create Your First Workflow"]})]})})}):f.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:i.map(p=>f.jsxs(Ba,{className:"flex flex-col",children:[f.jsx(ro,{className:"pb-3",children:f.jsx("div",{className:"flex items-start justify-between",children:f.jsxs("div",{className:"space-y-1 flex-1 min-w-0",children:[f.jsx(so,{className:"text-base truncate",children:p.name}),f.jsx(dc,{className:"text-xs line-clamp-2",children:p.description})]})})}),f.jsxs(za,{className:"pt-0 flex-1 flex flex-col",children:[f.jsxs("div",{className:"space-y-2 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs(cs,{variant:"secondary",className:"text-xs",children:[p.steps.length," step",p.steps.length!==1?"s":""]}),f.jsxs("span",{className:"text-xs text-muted-foreground",children:["Updated ",new Date(p.updatedAt).toLocaleDateString()]})]}),p.steps.length>0&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["Steps: ",p.steps.map(g=>g.name).join(", ")]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-4 pt-2 border-t",children:[f.jsx(Nn,{tooltipText:"Run Workflow",onClick:()=>h(p),icon:f.jsx(OD,{}),className:"h-8 w-8",variant:"ghost"}),f.jsx(Nn,{tooltipText:"Edit Workflow",onClick:()=>t(p),icon:f.jsx(Ku,{}),className:"h-8 w-8",variant:"ghost"}),f.jsx(Nn,{tooltipText:"Duplicate Workflow",onClick:()=>d(p),icon:f.jsx(lY,{}),className:"h-8 w-8",variant:"ghost"}),f.jsx(Nn,{tooltipText:"Delete Workflow",onClick:()=>u(p.id,p.name),icon:f.jsx(to,{}),className:"h-8 w-8 text-destructive hover:text-destructive",variant:"ghost"})]})]})]},p.id))})]})};function Yi(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=Yi(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var tXe={value:()=>{}};function oN(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new ek(n)}function ek(e){this._=e}function nXe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}ek.prototype=oN.prototype={constructor:ek,on:function(e,t){var n=this._,r=nXe(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=rXe(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=GW(n[s],e.name,t);else if(t==null)for(s in n)n[s]=GW(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new ek(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function rXe(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function GW(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=tXe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var bO="http://www.w3.org/1999/xhtml";const KW={svg:"http://www.w3.org/2000/svg",xhtml:bO,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function lN(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),KW.hasOwnProperty(t)?{space:KW[t],local:e}:e}function sXe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===bO&&t.documentElement.namespaceURI===bO?t.createElement(e):t.createElementNS(n,e)}}function iXe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Voe(e){var t=lN(e);return(t.local?iXe:sXe)(t)}function aXe(){}function Z6(e){return e==null?aXe:function(){return this.querySelector(e)}}function oXe(e){typeof e!="function"&&(e=Z6(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new Dl(r,this._parents)}function lXe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function cXe(){return[]}function Woe(e){return e==null?cXe:function(){return this.querySelectorAll(e)}}function uXe(e){return function(){return lXe(e.apply(this,arguments))}}function dXe(e){typeof e=="function"?e=uXe(e):e=Woe(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new Dl(r,s)}function Hoe(e){return function(){return this.matches(e)}}function Goe(e){return function(t){return t.matches(e)}}var fXe=Array.prototype.find;function hXe(e){return function(){return fXe.call(this.children,e)}}function pXe(){return this.firstElementChild}function mXe(e){return this.select(e==null?pXe:hXe(typeof e=="function"?e:Goe(e)))}var gXe=Array.prototype.filter;function yXe(){return Array.from(this.children)}function bXe(e){return function(){return gXe.call(this.children,e)}}function vXe(e){return this.selectAll(e==null?yXe:bXe(typeof e=="function"?e:Goe(e)))}function xXe(e){typeof e!="function"&&(e=Hoe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new Dl(r,this._parents)}function Koe(e){return new Array(e.length)}function wXe(){return new Dl(this._enter||this._groups.map(Koe),this._parents)}function $E(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}$E.prototype={constructor:$E,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function SXe(e){return function(){return e}}function _Xe(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new $E(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function CXe(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),p;for(o=0;o<u;++o)(l=t[o])&&(h[o]=p=a.call(l,l.__data__,o,t)+"",c.has(p)?s[o]=l:c.set(p,l));for(o=0;o<d;++o)p=a.call(e,i[o],o,i)+"",(l=c.get(p))?(r[o]=l,l.__data__=i[o],c.delete(p)):n[o]=new $E(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function kXe(e){return e.__data__}function EXe(e,t){if(!arguments.length)return Array.from(this,kXe);var n=t?CXe:_Xe,r=this._parents,s=this._groups;typeof e!="function"&&(e=SXe(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,p=TXe(e.call(u,u&&u.__data__,c,r)),g=p.length,y=o[c]=new Array(g),v=a[c]=new Array(g),x=l[c]=new Array(h);n(u,d,y,v,x,p,t);for(var w=0,S=0,_,k;w<g;++w)if(_=y[w]){for(w>=S&&(S=w+1);!(k=v[S])&&++S<g;);_._next=k||null}}return a=new Dl(a,r),a._enter=o,a._exit=l,a}function TXe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function AXe(){return new Dl(this._exit||this._groups.map(Koe),this._parents)}function NXe(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function RXe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),p,g=0;g<d;++g)(p=c[g]||u[g])&&(h[g]=p);for(;l<s;++l)o[l]=n[l];return new Dl(o,this._parents)}function IXe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function MXe(e){e||(e=jXe);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new Dl(s,this._parents).order()}function jXe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function PXe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function OXe(){return Array.from(this)}function DXe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function FXe(){let e=0;for(const t of this)++e;return e}function LXe(){return!this.node()}function $Xe(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function BXe(e){return function(){this.removeAttribute(e)}}function zXe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function UXe(e,t){return function(){this.setAttribute(e,t)}}function qXe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function VXe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function WXe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function HXe(e,t){var n=lN(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?zXe:BXe:typeof t=="function"?n.local?WXe:VXe:n.local?qXe:UXe)(n,t))}function Yoe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function GXe(e){return function(){this.style.removeProperty(e)}}function KXe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function YXe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function ZXe(e,t,n){return arguments.length>1?this.each((t==null?GXe:typeof t=="function"?YXe:KXe)(e,t,n??"")):pb(this.node(),e)}function pb(e,t){return e.style.getPropertyValue(t)||Yoe(e).getComputedStyle(e,null).getPropertyValue(t)}function XXe(e){return function(){delete this[e]}}function JXe(e,t){return function(){this[e]=t}}function QXe(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function eJe(e,t){return arguments.length>1?this.each((t==null?XXe:typeof t=="function"?QXe:JXe)(e,t)):this.node()[e]}function Zoe(e){return e.trim().split(/^|\s+/)}function X6(e){return e.classList||new Xoe(e)}function Xoe(e){this._node=e,this._names=Zoe(e.getAttribute("class")||"")}Xoe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Joe(e,t){for(var n=X6(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function Qoe(e,t){for(var n=X6(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function tJe(e){return function(){Joe(this,e)}}function nJe(e){return function(){Qoe(this,e)}}function rJe(e,t){return function(){(t.apply(this,arguments)?Joe:Qoe)(this,e)}}function sJe(e,t){var n=Zoe(e+"");if(arguments.length<2){for(var r=X6(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?rJe:t?tJe:nJe)(n,t))}function iJe(){this.textContent=""}function aJe(e){return function(){this.textContent=e}}function oJe(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function lJe(e){return arguments.length?this.each(e==null?iJe:(typeof e=="function"?oJe:aJe)(e)):this.node().textContent}function cJe(){this.innerHTML=""}function uJe(e){return function(){this.innerHTML=e}}function dJe(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function fJe(e){return arguments.length?this.each(e==null?cJe:(typeof e=="function"?dJe:uJe)(e)):this.node().innerHTML}function hJe(){this.nextSibling&&this.parentNode.appendChild(this)}function pJe(){return this.each(hJe)}function mJe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gJe(){return this.each(mJe)}function yJe(e){var t=typeof e=="function"?e:Voe(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function bJe(){return null}function vJe(e,t){var n=typeof e=="function"?e:Voe(e),r=t==null?bJe:typeof t=="function"?t:Z6(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function xJe(){var e=this.parentNode;e&&e.removeChild(this)}function wJe(){return this.each(xJe)}function SJe(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _Je(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function CJe(e){return this.select(e?_Je:SJe)}function kJe(e){return arguments.length?this.property("__data__",e):this.node().__data__}function EJe(e){return function(t){e.call(this,t,this.__data__)}}function TJe(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function AJe(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function NJe(e,t,n){return function(){var r=this.__on,s,i=EJe(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function RJe(e,t,n){var r=TJe(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?NJe:AJe,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function ele(e,t,n){var r=Yoe(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function IJe(e,t){return function(){return ele(this,e,t)}}function MJe(e,t){return function(){return ele(this,e,t.apply(this,arguments))}}function jJe(e,t){return this.each((typeof t=="function"?MJe:IJe)(e,t))}function*PJe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var tle=[null];function Dl(e,t){this._groups=e,this._parents=t}function o_(){return new Dl([[document.documentElement]],tle)}function OJe(){return this}Dl.prototype=o_.prototype={constructor:Dl,select:oXe,selectAll:dXe,selectChild:mXe,selectChildren:vXe,filter:xXe,data:EXe,enter:wXe,exit:AXe,join:NXe,merge:RXe,selection:OJe,order:IXe,sort:MXe,call:PXe,nodes:OXe,node:DXe,size:FXe,empty:LXe,each:$Xe,attr:HXe,style:ZXe,property:eJe,classed:sJe,text:lJe,html:fJe,raise:pJe,lower:gJe,append:yJe,insert:vJe,remove:wJe,clone:CJe,datum:kJe,on:RJe,dispatch:jJe,[Symbol.iterator]:PJe};function mr(e){return typeof e=="string"?new Dl([[document.querySelector(e)]],[document.documentElement]):new Dl([[e]],tle)}function DJe(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Uc(e,t){if(e=DJe(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const FJe={passive:!1},V1={capture:!0,passive:!1};function H3(e){e.stopImmediatePropagation()}function ky(e){e.preventDefault(),e.stopImmediatePropagation()}function nle(e){var t=e.document.documentElement,n=mr(e).on("dragstart.drag",ky,V1);"onselectstart"in t?n.on("selectstart.drag",ky,V1):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function rle(e,t){var n=e.document.documentElement,r=mr(e).on("dragstart.drag",null);t&&(r.on("click.drag",ky,V1),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const b2=e=>()=>e;function vO(e,{sourceEvent:t,subject:n,target:r,identifier:s,active:i,x:a,y:o,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}vO.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function LJe(e){return!e.ctrlKey&&!e.button}function $Je(){return this.parentNode}function BJe(e,t){return t??{x:e.x,y:e.y}}function zJe(){return navigator.maxTouchPoints||"ontouchstart"in this}function sle(){var e=LJe,t=$Je,n=BJe,r=zJe,s={},i=oN("start","drag","end"),a=0,o,l,c,u,d=0;function h(_){_.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",x,FJe).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(_,k){if(!(u||!e.call(this,_,k))){var T=S(this,t.call(this,_,k),_,k,"mouse");T&&(mr(_.view).on("mousemove.drag",g,V1).on("mouseup.drag",y,V1),nle(_.view),H3(_),c=!1,o=_.clientX,l=_.clientY,T("start",_))}}function g(_){if(ky(_),!c){var k=_.clientX-o,T=_.clientY-l;c=k*k+T*T>d}s.mouse("drag",_)}function y(_){mr(_.view).on("mousemove.drag mouseup.drag",null),rle(_.view,c),ky(_),s.mouse("end",_)}function v(_,k){if(e.call(this,_,k)){var T=_.changedTouches,A=t.call(this,_,k),R=T.length,M,j;for(M=0;M<R;++M)(j=S(this,A,_,k,T[M].identifier,T[M]))&&(H3(_),j("start",_,T[M]))}}function x(_){var k=_.changedTouches,T=k.length,A,R;for(A=0;A<T;++A)(R=s[k[A].identifier])&&(ky(_),R("drag",_,k[A]))}function w(_){var k=_.changedTouches,T=k.length,A,R;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),A=0;A<T;++A)(R=s[k[A].identifier])&&(H3(_),R("end",_,k[A]))}function S(_,k,T,A,R,M){var j=i.copy(),F=Uc(M||T,k),P,q,I;if((I=n.call(_,new vO("beforestart",{sourceEvent:T,target:h,identifier:R,active:a,x:F[0],y:F[1],dx:0,dy:0,dispatch:j}),A))!=null)return P=I.x-F[0]||0,q=I.y-F[1]||0,function V(D,z,$){var Y=F,B;switch(D){case"start":s[R]=V,B=a++;break;case"end":delete s[R],--a;case"drag":F=Uc($||z,k),B=a;break}j.call(D,_,new vO(D,{sourceEvent:z,subject:I,target:h,identifier:R,active:B,x:F[0]+P,y:F[1]+q,dx:F[0]-Y[0],dy:F[1]-Y[1],dispatch:j}),A)}}return h.filter=function(_){return arguments.length?(e=typeof _=="function"?_:b2(!!_),h):e},h.container=function(_){return arguments.length?(t=typeof _=="function"?_:b2(_),h):t},h.subject=function(_){return arguments.length?(n=typeof _=="function"?_:b2(_),h):n},h.touchable=function(_){return arguments.length?(r=typeof _=="function"?_:b2(!!_),h):r},h.on=function(){var _=i.on.apply(i,arguments);return _===i?h:_},h.clickDistance=function(_){return arguments.length?(d=(_=+_)*_,h):Math.sqrt(d)},h}function J6(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ile(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function l_(){}var W1=.7,BE=1/W1,Ey="\\s*([+-]?\\d+)\\s*",H1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",td="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",UJe=/^#([0-9a-f]{3,8})$/,qJe=new RegExp(`^rgb\\(${Ey},${Ey},${Ey}\\)$`),VJe=new RegExp(`^rgb\\(${td},${td},${td}\\)$`),WJe=new RegExp(`^rgba\\(${Ey},${Ey},${Ey},${H1}\\)$`),HJe=new RegExp(`^rgba\\(${td},${td},${td},${H1}\\)$`),GJe=new RegExp(`^hsl\\(${H1},${td},${td}\\)$`),KJe=new RegExp(`^hsla\\(${H1},${td},${td},${H1}\\)$`),YW={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};J6(l_,hg,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ZW,formatHex:ZW,formatHex8:YJe,formatHsl:ZJe,formatRgb:XW,toString:XW});function ZW(){return this.rgb().formatHex()}function YJe(){return this.rgb().formatHex8()}function ZJe(){return ale(this).formatHsl()}function XW(){return this.rgb().formatRgb()}function hg(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=UJe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?JW(t):n===3?new nl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?v2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?v2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qJe.exec(e))?new nl(t[1],t[2],t[3],1):(t=VJe.exec(e))?new nl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=WJe.exec(e))?v2(t[1],t[2],t[3],t[4]):(t=HJe.exec(e))?v2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=GJe.exec(e))?tH(t[1],t[2]/100,t[3]/100,1):(t=KJe.exec(e))?tH(t[1],t[2]/100,t[3]/100,t[4]):YW.hasOwnProperty(e)?JW(YW[e]):e==="transparent"?new nl(NaN,NaN,NaN,0):null}function JW(e){return new nl(e>>16&255,e>>8&255,e&255,1)}function v2(e,t,n,r){return r<=0&&(e=t=n=NaN),new nl(e,t,n,r)}function XJe(e){return e instanceof l_||(e=hg(e)),e?(e=e.rgb(),new nl(e.r,e.g,e.b,e.opacity)):new nl}function xO(e,t,n,r){return arguments.length===1?XJe(e):new nl(e,t,n,r??1)}function nl(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}J6(nl,xO,ile(l_,{brighter(e){return e=e==null?BE:Math.pow(BE,e),new nl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?W1:Math.pow(W1,e),new nl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new nl(Km(this.r),Km(this.g),Km(this.b),zE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:QW,formatHex:QW,formatHex8:JJe,formatRgb:eH,toString:eH}));function QW(){return`#${$m(this.r)}${$m(this.g)}${$m(this.b)}`}function JJe(){return`#${$m(this.r)}${$m(this.g)}${$m(this.b)}${$m((isNaN(this.opacity)?1:this.opacity)*255)}`}function eH(){const e=zE(this.opacity);return`${e===1?"rgb(":"rgba("}${Km(this.r)}, ${Km(this.g)}, ${Km(this.b)}${e===1?")":`, ${e})`}`}function zE(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Km(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function $m(e){return e=Km(e),(e<16?"0":"")+e.toString(16)}function tH(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Vc(e,t,n,r)}function ale(e){if(e instanceof Vc)return new Vc(e.h,e.s,e.l,e.opacity);if(e instanceof l_||(e=hg(e)),!e)return new Vc;if(e instanceof Vc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new Vc(a,o,l,e.opacity)}function QJe(e,t,n,r){return arguments.length===1?ale(e):new Vc(e,t,n,r??1)}function Vc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}J6(Vc,QJe,ile(l_,{brighter(e){return e=e==null?BE:Math.pow(BE,e),new Vc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?W1:Math.pow(W1,e),new Vc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new nl(G3(e>=240?e-240:e+120,s,r),G3(e,s,r),G3(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new Vc(nH(this.h),x2(this.s),x2(this.l),zE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=zE(this.opacity);return`${e===1?"hsl(":"hsla("}${nH(this.h)}, ${x2(this.s)*100}%, ${x2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nH(e){return e=(e||0)%360,e<0?e+360:e}function x2(e){return Math.max(0,Math.min(1,e||0))}function G3(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const cN=e=>()=>e;function ole(e,t){return function(n){return e+n*t}}function eQe(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ivt(e,t){var n=t-e;return n?ole(e,n>180||n<-180?n-360*Math.round(n/360):n):cN(isNaN(e)?t:e)}function tQe(e){return(e=+e)==1?lle:function(t,n){return n-t?eQe(t,n,e):cN(isNaN(t)?n:t)}}function lle(e,t){var n=t-e;return n?ole(e,n):cN(isNaN(e)?t:e)}const UE=function e(t){var n=tQe(t);function r(s,i){var a=n((s=xO(s)).r,(i=xO(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=lle(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function nQe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=e[s]*(1-i)+t[s]*i;return r}}function rQe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sQe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,s=new Array(r),i=new Array(n),a;for(a=0;a<r;++a)s[a]=_w(e[a],t[a]);for(;a<n;++a)i[a]=t[a];return function(o){for(a=0;a<r;++a)i[a]=s[a](o);return i}}function iQe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Lu(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function aQe(e,t){var n={},r={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=_w(e[s],t[s]):r[s]=t[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var wO=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,K3=new RegExp(wO.source,"g");function oQe(e){return function(){return e}}function lQe(e){return function(t){return e(t)+""}}function cle(e,t){var n=wO.lastIndex=K3.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=wO.exec(e))&&(s=K3.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:Lu(r,s)})),n=K3.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?lQe(l[0].x):oQe(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}function _w(e,t){var n=typeof t,r;return t==null||n==="boolean"?cN(t):(n==="number"?Lu:n==="string"?(r=hg(t))?(t=r,UE):cle:t instanceof hg?UE:t instanceof Date?iQe:rQe(t)?nQe:Array.isArray(t)?sQe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?aQe:Lu)(e,t)}var rH=180/Math.PI,SO={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ule(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*rH,skewX:Math.atan(l)*rH,scaleX:a,scaleY:o}}var w2;function cQe(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?SO:ule(t.a,t.b,t.c,t.d,t.e,t.f)}function uQe(e){return e==null||(w2||(w2=document.createElementNS("http://www.w3.org/2000/svg","g")),w2.setAttribute("transform",e),!(e=w2.transform.baseVal.consolidate()))?SO:(e=e.matrix,ule(e.a,e.b,e.c,e.d,e.e,e.f))}function dle(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,p,g){if(c!==d||u!==h){var y=p.push("translate(",null,t,null,n);g.push({i:y-4,x:Lu(c,d)},{i:y-2,x:Lu(u,h)})}else(d||h)&&p.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:Lu(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:Lu(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,p,g){if(c!==d||u!==h){var y=p.push(s(p)+"scale(",null,",",null,")");g.push({i:y-4,x:Lu(c,d)},{i:y-2,x:Lu(u,h)})}else(d!==1||h!==1)&&p.push(s(p)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(p){for(var g=-1,y=h.length,v;++g<y;)d[(v=h[g]).i]=v.x(p);return d.join("")}}}var dQe=dle(cQe,"px, ","px)","deg)"),fQe=dle(uQe,", ",")",")"),hQe=1e-12;function sH(e){return((e=Math.exp(e))+1/e)/2}function pQe(e){return((e=Math.exp(e))-1/e)/2}function mQe(e){return((e=Math.exp(2*e))-1)/(e+1)}const tk=function e(t,n,r){function s(i,a){var o=i[0],l=i[1],c=i[2],u=a[0],d=a[1],h=a[2],p=u-o,g=d-l,y=p*p+g*g,v,x;if(y<hQe)x=Math.log(h/c)/t,v=function(A){return[o+A*p,l+A*g,c*Math.exp(t*A*x)]};else{var w=Math.sqrt(y),S=(h*h-c*c+r*y)/(2*c*n*w),_=(h*h-c*c-r*y)/(2*h*n*w),k=Math.log(Math.sqrt(S*S+1)-S),T=Math.log(Math.sqrt(_*_+1)-_);x=(T-k)/t,v=function(A){var R=A*x,M=sH(k),j=c/(n*w)*(M*mQe(t*R+k)-pQe(k));return[o+j*p,l+j*g,c*M/sH(t*R+k)]}}return v.duration=x*1e3*t/Math.SQRT2,v}return s.rho=function(i){var a=Math.max(.001,+i),o=a*a,l=o*o;return e(a,o,l)},s}(Math.SQRT2,2,4);var mb=0,iw=0,Rx=0,fle=1e3,qE,aw,VE=0,pg=0,uN=0,G1=typeof performance=="object"&&performance.now?performance:Date,hle=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Q6(){return pg||(hle(gQe),pg=G1.now()+uN)}function gQe(){pg=0}function WE(){this._call=this._time=this._next=null}WE.prototype=ple.prototype={constructor:WE,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Q6():+n)+(t==null?0:+t),!this._next&&aw!==this&&(aw?aw._next=this:qE=this,aw=this),this._call=e,this._time=n,_O()},stop:function(){this._call&&(this._call=null,this._time=1/0,_O())}};function ple(e,t,n){var r=new WE;return r.restart(e,t,n),r}function yQe(){Q6(),++mb;for(var e=qE,t;e;)(t=pg-e._time)>=0&&e._call.call(void 0,t),e=e._next;--mb}function iH(){pg=(VE=G1.now())+uN,mb=iw=0;try{yQe()}finally{mb=0,vQe(),pg=0}}function bQe(){var e=G1.now(),t=e-VE;t>fle&&(uN-=t,VE=e)}function vQe(){for(var e,t=qE,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:qE=n);aw=e,_O(r)}function _O(e){if(!mb){iw&&(iw=clearTimeout(iw));var t=e-pg;t>24?(e<1/0&&(iw=setTimeout(iH,e-G1.now()-uN)),Rx&&(Rx=clearInterval(Rx))):(Rx||(VE=G1.now(),Rx=setInterval(bQe,fle)),mb=1,hle(iH))}}function aH(e,t,n){var r=new WE;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var xQe=oN("start","end","cancel","interrupt"),wQe=[],mle=0,oH=1,CO=2,nk=3,lH=4,kO=5,rk=6;function dN(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;SQe(e,n,{name:t,index:r,group:s,on:xQe,tween:wQe,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:mle})}function eL(e,t){var n=fu(e,t);if(n.state>mle)throw new Error("too late; already scheduled");return n}function _d(e,t){var n=fu(e,t);if(n.state>nk)throw new Error("too late; already running");return n}function fu(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function SQe(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=ple(i,0,n.time);function i(c){n.state=oH,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,p;if(n.state!==oH)return l();for(u in r)if(p=r[u],p.name===n.name){if(p.state===nk)return aH(a);p.state===lH?(p.state=rk,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<t&&(p.state=rk,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(aH(function(){n.state===nk&&(n.state=lH,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=CO,n.on.call("start",e,e.__data__,n.index,n.group),n.state===CO){for(n.state=nk,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=p);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=kO,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===kO&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=rk,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function sk(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>CO&&r.state<kO,r.state=rk,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function _Qe(e){return this.each(function(){sk(this,e)})}function CQe(e,t){var n,r;return function(){var s=_d(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function kQe(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=_d(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function EQe(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=fu(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?CQe:kQe)(n,e,t))}function tL(e,t,n){var r=e._id;return e.each(function(){var s=_d(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return fu(s,r).value[t]}}function gle(e,t){var n;return(typeof t=="number"?Lu:t instanceof hg?UE:(n=hg(t))?(t=n,UE):cle)(e,t)}function TQe(e){return function(){this.removeAttribute(e)}}function AQe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function NQe(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function RQe(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function IQe(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function MQe(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function jQe(e,t){var n=lN(e),r=n==="transform"?fQe:gle;return this.attrTween(e,typeof t=="function"?(n.local?MQe:IQe)(n,r,tL(this,"attr."+e,t)):t==null?(n.local?AQe:TQe)(n):(n.local?RQe:NQe)(n,r,t))}function PQe(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function OQe(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function DQe(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&OQe(e,i)),n}return s._value=t,s}function FQe(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&PQe(e,i)),n}return s._value=t,s}function LQe(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=lN(e);return this.tween(n,(r.local?DQe:FQe)(r,t))}function $Qe(e,t){return function(){eL(this,e).delay=+t.apply(this,arguments)}}function BQe(e,t){return t=+t,function(){eL(this,e).delay=t}}function zQe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?$Qe:BQe)(t,e)):fu(this.node(),t).delay}function UQe(e,t){return function(){_d(this,e).duration=+t.apply(this,arguments)}}function qQe(e,t){return t=+t,function(){_d(this,e).duration=t}}function VQe(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?UQe:qQe)(t,e)):fu(this.node(),t).duration}function WQe(e,t){if(typeof t!="function")throw new Error;return function(){_d(this,e).ease=t}}function HQe(e){var t=this._id;return arguments.length?this.each(WQe(t,e)):fu(this.node(),t).ease}function GQe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;_d(this,e).ease=n}}function KQe(e){if(typeof e!="function")throw new Error;return this.each(GQe(this._id,e))}function YQe(e){typeof e!="function"&&(e=Hoe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new Mf(r,this._parents,this._name,this._id)}function ZQe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,p=0;p<u;++p)(h=l[p]||c[p])&&(d[p]=h);for(;o<r;++o)a[o]=t[o];return new Mf(a,this._parents,this._name,this._id)}function XQe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function JQe(e,t,n){var r,s,i=XQe(t)?eL:_d;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function QQe(e,t){var n=this._id;return arguments.length<2?fu(this.node(),n).on.on(e):this.each(JQe(n,e,t))}function eet(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function tet(){return this.on("end.remove",eet(this._id))}function net(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Z6(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,dN(c[h],t,n,h,c,fu(u,n)));return new Mf(i,this._parents,t,n)}function ret(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Woe(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),p,g=fu(u,n),y=0,v=h.length;y<v;++y)(p=h[y])&&dN(p,t,n,y,h,g);i.push(h),a.push(u)}return new Mf(i,a,t,n)}var set=o_.prototype.constructor;function iet(){return new set(this._groups,this._parents)}function aet(e,t){var n,r,s;return function(){var i=pb(this,e),a=(this.style.removeProperty(e),pb(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function yle(e){return function(){this.style.removeProperty(e)}}function oet(e,t,n){var r,s=n+"",i;return function(){var a=pb(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function cet(e,t,n){var r,s,i;return function(){var a=pb(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),pb(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function uet(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=_d(this,e),c=l.on,u=l.value[i]==null?o||(o=yle(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function det(e,t,n){var r=(e+="")=="transform"?dQe:gle;return t==null?this.styleTween(e,aet(e,r)).on("end.style."+e,yle(e)):typeof t=="function"?this.styleTween(e,cet(e,r,tL(this,"style."+e,t))).each(uet(this._id,e)):this.styleTween(e,oet(e,r,t),n).on("end.style."+e,null)}function fet(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function het(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&fet(e,a,n)),r}return i._value=t,i}function pet(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,het(e,t,n??""))}function met(e){return function(){this.textContent=e}}function get(e){return function(){var t=e(this);this.textContent=t??""}}function yet(e){return this.tween("text",typeof e=="function"?get(tL(this,"text",e)):met(e==null?"":e+""))}function bet(e){return function(t){this.textContent=e.call(this,t)}}function vet(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&bet(s)),t}return r._value=e,r}function xet(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,vet(e))}function wet(){for(var e=this._name,t=this._id,n=ble(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=fu(l,t);dN(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Mf(r,this._parents,e,n)}function _et(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=_d(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var Cet=0;function Mf(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function ble(){return++Cet}var Zd=o_.prototype;Mf.prototype={constructor:Mf,select:net,selectAll:ret,selectChild:Zd.selectChild,selectChildren:Zd.selectChildren,filter:YQe,merge:ZQe,selection:iet,transition:wet,call:Zd.call,nodes:Zd.nodes,node:Zd.node,size:Zd.size,empty:Zd.empty,each:Zd.each,on:QQe,attr:jQe,attrTween:LQe,style:det,styleTween:pet,text:yet,textTween:xet,remove:tet,tween:EQe,delay:zQe,duration:VQe,ease:HQe,easeVarying:KQe,end:_et,[Symbol.iterator]:Zd[Symbol.iterator]};function ket(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Eet={time:null,delay:0,duration:250,ease:ket};function Tet(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Aet(e){var t,n;e instanceof Mf?(t=e._id,e=e._name):(t=ble(),(n=Eet).time=Q6(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&dN(l,e,t,c,a,n||Tet(l,t));return new Mf(r,this._parents,e,t)}o_.prototype.interrupt=_Qe;o_.prototype.transition=Aet;const S2=e=>()=>e;function Net(e,{sourceEvent:t,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function df(e,t,n){this.k=e,this.x=t,this.y=n}df.prototype={constructor:df,scale:function(e){return e===1?this:new df(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new df(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fN=new df(1,0,0);vle.prototype=df.prototype;function vle(e){for(;!e.__zoom;)if(!(e=e.parentNode))return fN;return e.__zoom}function Y3(e){e.stopImmediatePropagation()}function Ix(e){e.preventDefault(),e.stopImmediatePropagation()}function Ret(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Iet(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function cH(){return this.__zoom||fN}function Met(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function jet(){return navigator.maxTouchPoints||"ontouchstart"in this}function Pet(e,t,n){var r=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],a=e.invertY(t[1][1])-n[1][1];return e.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),a>i?(i+a)/2:Math.min(0,i)||Math.max(0,a))}function xle(){var e=Ret,t=Iet,n=Pet,r=Met,s=jet,i=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],o=250,l=tk,c=oN("start","zoom","end"),u,d,h,p=500,g=150,y=0,v=10;function x(I){I.property("__zoom",cH).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",j).filter(s).on("touchstart.zoom",F).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",q).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(I,V,D,z){var $=I.selection?I.selection():I;$.property("__zoom",cH),I!==$?k(I,V,D,z):$.interrupt().each(function(){T(this,arguments).event(z).start().zoom(null,typeof V=="function"?V.apply(this,arguments):V).end()})},x.scaleBy=function(I,V,D,z){x.scaleTo(I,function(){var $=this.__zoom.k,Y=typeof V=="function"?V.apply(this,arguments):V;return $*Y},D,z)},x.scaleTo=function(I,V,D,z){x.transform(I,function(){var $=t.apply(this,arguments),Y=this.__zoom,B=D==null?_($):typeof D=="function"?D.apply(this,arguments):D,G=Y.invert(B),Z=typeof V=="function"?V.apply(this,arguments):V;return n(S(w(Y,Z),B,G),$,a)},D,z)},x.translateBy=function(I,V,D,z){x.transform(I,function(){return n(this.__zoom.translate(typeof V=="function"?V.apply(this,arguments):V,typeof D=="function"?D.apply(this,arguments):D),t.apply(this,arguments),a)},null,z)},x.translateTo=function(I,V,D,z,$){x.transform(I,function(){var Y=t.apply(this,arguments),B=this.__zoom,G=z==null?_(Y):typeof z=="function"?z.apply(this,arguments):z;return n(fN.translate(G[0],G[1]).scale(B.k).translate(typeof V=="function"?-V.apply(this,arguments):-V,typeof D=="function"?-D.apply(this,arguments):-D),Y,a)},z,$)};function w(I,V){return V=Math.max(i[0],Math.min(i[1],V)),V===I.k?I:new df(V,I.x,I.y)}function S(I,V,D){var z=V[0]-D[0]*I.k,$=V[1]-D[1]*I.k;return z===I.x&&$===I.y?I:new df(I.k,z,$)}function _(I){return[(+I[0][0]+ +I[1][0])/2,(+I[0][1]+ +I[1][1])/2]}function k(I,V,D,z){I.on("start.zoom",function(){T(this,arguments).event(z).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(z).end()}).tween("zoom",function(){var $=this,Y=arguments,B=T($,Y).event(z),G=t.apply($,Y),Z=D==null?_(G):typeof D=="function"?D.apply($,Y):D,ne=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),ae=$.__zoom,le=typeof V=="function"?V.apply($,Y):V,Se=l(ae.invert(Z).concat(ne/ae.k),le.invert(Z).concat(ne/le.k));return function(Ee){if(Ee===1)Ee=le;else{var he=Se(Ee),pe=ne/he[2];Ee=new df(pe,Z[0]-he[0]*pe,Z[1]-he[1]*pe)}B.zoom(null,Ee)}})}function T(I,V,D){return!D&&I.__zooming||new A(I,V)}function A(I,V){this.that=I,this.args=V,this.active=0,this.sourceEvent=null,this.extent=t.apply(I,V),this.taps=0}A.prototype={event:function(I){return I&&(this.sourceEvent=I),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(I,V){return this.mouse&&I!=="mouse"&&(this.mouse[1]=V.invert(this.mouse[0])),this.touch0&&I!=="touch"&&(this.touch0[1]=V.invert(this.touch0[0])),this.touch1&&I!=="touch"&&(this.touch1[1]=V.invert(this.touch1[0])),this.that.__zoom=V,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(I){var V=mr(this.that).datum();c.call(I,this.that,new Net(I,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:c}),V)}};function R(I,...V){if(!e.apply(this,arguments))return;var D=T(this,V).event(I),z=this.__zoom,$=Math.max(i[0],Math.min(i[1],z.k*Math.pow(2,r.apply(this,arguments)))),Y=Uc(I);if(D.wheel)(D.mouse[0][0]!==Y[0]||D.mouse[0][1]!==Y[1])&&(D.mouse[1]=z.invert(D.mouse[0]=Y)),clearTimeout(D.wheel);else{if(z.k===$)return;D.mouse=[Y,z.invert(Y)],sk(this),D.start()}Ix(I),D.wheel=setTimeout(B,g),D.zoom("mouse",n(S(w(z,$),D.mouse[0],D.mouse[1]),D.extent,a));function B(){D.wheel=null,D.end()}}function M(I,...V){if(h||!e.apply(this,arguments))return;var D=I.currentTarget,z=T(this,V,!0).event(I),$=mr(I.view).on("mousemove.zoom",Z,!0).on("mouseup.zoom",ne,!0),Y=Uc(I,D),B=I.clientX,G=I.clientY;nle(I.view),Y3(I),z.mouse=[Y,this.__zoom.invert(Y)],sk(this),z.start();function Z(ae){if(Ix(ae),!z.moved){var le=ae.clientX-B,Se=ae.clientY-G;z.moved=le*le+Se*Se>y}z.event(ae).zoom("mouse",n(S(z.that.__zoom,z.mouse[0]=Uc(ae,D),z.mouse[1]),z.extent,a))}function ne(ae){$.on("mousemove.zoom mouseup.zoom",null),rle(ae.view,z.moved),Ix(ae),z.event(ae).end()}}function j(I,...V){if(e.apply(this,arguments)){var D=this.__zoom,z=Uc(I.changedTouches?I.changedTouches[0]:I,this),$=D.invert(z),Y=D.k*(I.shiftKey?.5:2),B=n(S(w(D,Y),z,$),t.apply(this,V),a);Ix(I),o>0?mr(this).transition().duration(o).call(k,B,z,I):mr(this).call(x.transform,B,z,I)}}function F(I,...V){if(e.apply(this,arguments)){var D=I.touches,z=D.length,$=T(this,V,I.changedTouches.length===z).event(I),Y,B,G,Z;for(Y3(I),B=0;B<z;++B)G=D[B],Z=Uc(G,this),Z=[Z,this.__zoom.invert(Z),G.identifier],$.touch0?!$.touch1&&$.touch0[2]!==Z[2]&&($.touch1=Z,$.taps=0):($.touch0=Z,Y=!0,$.taps=1+!!u);u&&(u=clearTimeout(u)),Y&&($.taps<2&&(d=Z[0],u=setTimeout(function(){u=null},p)),sk(this),$.start())}}function P(I,...V){if(this.__zooming){var D=T(this,V).event(I),z=I.changedTouches,$=z.length,Y,B,G,Z;for(Ix(I),Y=0;Y<$;++Y)B=z[Y],G=Uc(B,this),D.touch0&&D.touch0[2]===B.identifier?D.touch0[0]=G:D.touch1&&D.touch1[2]===B.identifier&&(D.touch1[0]=G);if(B=D.that.__zoom,D.touch1){var ne=D.touch0[0],ae=D.touch0[1],le=D.touch1[0],Se=D.touch1[1],Ee=(Ee=le[0]-ne[0])*Ee+(Ee=le[1]-ne[1])*Ee,he=(he=Se[0]-ae[0])*he+(he=Se[1]-ae[1])*he;B=w(B,Math.sqrt(Ee/he)),G=[(ne[0]+le[0])/2,(ne[1]+le[1])/2],Z=[(ae[0]+Se[0])/2,(ae[1]+Se[1])/2]}else if(D.touch0)G=D.touch0[0],Z=D.touch0[1];else return;D.zoom("touch",n(S(B,G,Z),D.extent,a))}}function q(I,...V){if(this.__zooming){var D=T(this,V).event(I),z=I.changedTouches,$=z.length,Y,B;for(Y3(I),h&&clearTimeout(h),h=setTimeout(function(){h=null},p),Y=0;Y<$;++Y)B=z[Y],D.touch0&&D.touch0[2]===B.identifier?delete D.touch0:D.touch1&&D.touch1[2]===B.identifier&&delete D.touch1;if(D.touch1&&!D.touch0&&(D.touch0=D.touch1,delete D.touch1),D.touch0)D.touch0[1]=this.__zoom.invert(D.touch0[0]);else if(D.end(),D.taps===2&&(B=Uc(B,this),Math.hypot(d[0]-B[0],d[1]-B[1])<v)){var G=mr(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return x.wheelDelta=function(I){return arguments.length?(r=typeof I=="function"?I:S2(+I),x):r},x.filter=function(I){return arguments.length?(e=typeof I=="function"?I:S2(!!I),x):e},x.touchable=function(I){return arguments.length?(s=typeof I=="function"?I:S2(!!I),x):s},x.extent=function(I){return arguments.length?(t=typeof I=="function"?I:S2([[+I[0][0],+I[0][1]],[+I[1][0],+I[1][1]]]),x):t},x.scaleExtent=function(I){return arguments.length?(i[0]=+I[0],i[1]=+I[1],x):[i[0],i[1]]},x.translateExtent=function(I){return arguments.length?(a[0][0]=+I[0][0],a[1][0]=+I[1][0],a[0][1]=+I[0][1],a[1][1]=+I[1][1],x):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},x.constrain=function(I){return arguments.length?(n=I,x):n},x.duration=function(I){return arguments.length?(o=+I,x):o},x.interpolate=function(I){return arguments.length?(l=I,x):l},x.on=function(){var I=c.on.apply(c,arguments);return I===c?x:I},x.clickDistance=function(I){return arguments.length?(y=(I=+I)*I,x):Math.sqrt(y)},x.tapDistance=function(I){return arguments.length?(v=+I,x):v},x}const ud={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},K1=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],wle=["Enter"," ","Escape"],Sle={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var gb;(function(e){e.Strict="strict",e.Loose="loose"})(gb||(gb={}));var Ym;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Ym||(Ym={}));var Y1;(function(e){e.Partial="partial",e.Full="full"})(Y1||(Y1={}));const _le={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var qh;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(qh||(qh={}));var yb;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(yb||(yb={}));var Vn;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Vn||(Vn={}));const uH={[Vn.Left]:Vn.Right,[Vn.Right]:Vn.Left,[Vn.Top]:Vn.Bottom,[Vn.Bottom]:Vn.Top};function Cle(e){return e===null?null:e?"valid":"invalid"}const kle=e=>"id"in e&&"source"in e&&"target"in e,Oet=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),nL=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),c_=(e,t=[0,0])=>{const{width:n,height:r}=qf(e),s=e.origin??t,i=n*s[0],a=r*s[1];return{x:e.position.x-i,y:e.position.y-a}},Det=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,s)=>{const i=typeof s=="string";let a=!t.nodeLookup&&!i?s:void 0;t.nodeLookup&&(a=i?t.nodeLookup.get(s):nL(s)?s:t.nodeLookup.get(s.id));const o=a?HE(a,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return hN(r,o)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return pN(n)},u_=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const s=HE(r);n=hN(n,s)}}),pN(n)},rL=(e,t,[n,r,s]=[0,0,1],i=!1,a=!1)=>{const o={...d_(t,[n,r,s]),width:t.width/s,height:t.height/s},l=[];for(const c of e.values()){const{measured:u,selectable:d=!0,hidden:h=!1}=c;if(a&&!d||h)continue;const p=u.width??c.width??c.initialWidth??null,g=u.height??c.height??c.initialHeight??null,y=Z1(o,vb(c)),v=(p??0)*(g??0),x=i&&y>0;(!c.internals.handleBounds||x||y>=v||c.dragging)&&l.push(c)}return l},Fet=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Let(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(s=>s.id)):null;return e.forEach(s=>{s.measured.width&&s.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!s.hidden)&&(!r||r.has(s.id))&&n.set(s.id,s)}),n}async function $et({nodes:e,width:t,height:n,panZoom:r,minZoom:s,maxZoom:i},a){if(e.size===0)return Promise.resolve(!0);const o=Let(e,a),l=u_(o),c=sL(l,t,n,(a==null?void 0:a.minZoom)??s,(a==null?void 0:a.maxZoom)??i,(a==null?void 0:a.padding)??.1);return await r.setViewport(c,{duration:a==null?void 0:a.duration,ease:a==null?void 0:a.ease,interpolate:a==null?void 0:a.interpolate}),Promise.resolve(!0)}function Ele({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:s,onError:i}){const a=n.get(e),o=a.parentId?n.get(a.parentId):void 0,{x:l,y:c}=o?o.internals.positionAbsolute:{x:0,y:0},u=a.origin??r;let d=s;if(a.extent==="parent"&&!a.expandParent)if(!o)i==null||i("005",ud.error005());else{const p=o.measured.width,g=o.measured.height;p&&g&&(d=[[l,c],[l+p,c+g]])}else o&&xb(a.extent)&&(d=[[a.extent[0][0]+l,a.extent[0][1]+c],[a.extent[1][0]+l,a.extent[1][1]+c]]);const h=xb(d)?mg(t,d,a.measured):t;return(a.measured.width===void 0||a.measured.height===void 0)&&(i==null||i("015",ud.error015())),{position:{x:h.x-l+(a.measured.width??0)*u[0],y:h.y-c+(a.measured.height??0)*u[1]},positionAbsolute:h}}async function Bet({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:s}){const i=new Set(e.map(h=>h.id)),a=[];for(const h of n){if(h.deletable===!1)continue;const p=i.has(h.id),g=!p&&h.parentId&&a.find(y=>y.id===h.parentId);(p||g)&&a.push(h)}const o=new Set(t.map(h=>h.id)),l=r.filter(h=>h.deletable!==!1),u=Fet(a,l);for(const h of l)o.has(h.id)&&!u.find(g=>g.id===h.id)&&u.push(h);if(!s)return{edges:u,nodes:a};const d=await s({nodes:a,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:a}:{edges:[],nodes:[]}:d}const bb=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),mg=(e={x:0,y:0},t,n)=>({x:bb(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:bb(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Tle(e,t,n){const{width:r,height:s}=qf(n),{x:i,y:a}=n.internals.positionAbsolute;return mg(e,[[i,a],[i+r,a+s]],t)}const dH=(e,t,n)=>e<t?bb(Math.abs(e-t),1,t)/t:e>n?-bb(Math.abs(e-n),1,t)/t:0,Ale=(e,t,n=15,r=40)=>{const s=dH(e.x,r,t.width-r)*n,i=dH(e.y,r,t.height-r)*n;return[s,i]},hN=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),EO=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),pN=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),vb=(e,t=[0,0])=>{var s,i;const{x:n,y:r}=nL(e)?e.internals.positionAbsolute:c_(e,t);return{x:n,y:r,width:((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0,height:((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0}},HE=(e,t=[0,0])=>{var s,i;const{x:n,y:r}=nL(e)?e.internals.positionAbsolute:c_(e,t);return{x:n,y:r,x2:n+(((s=e.measured)==null?void 0:s.width)??e.width??e.initialWidth??0),y2:r+(((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0)}},Nle=(e,t)=>pN(hN(EO(e),EO(t))),Z1=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},fH=e=>Kc(e.width)&&Kc(e.height)&&Kc(e.x)&&Kc(e.y),Kc=e=>!isNaN(e)&&isFinite(e),zet=(e,t)=>{},mN=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),d_=({x:e,y:t},[n,r,s],i=!1,a=[1,1])=>{const o={x:(e-n)/s,y:(t-r)/s};return i?mN(o,a):o},GE=({x:e,y:t},[n,r,s])=>({x:e*s+n,y:t*s+r});function W0(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Uet(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=W0(e,n),s=W0(e,t);return{top:r,right:s,bottom:r,left:s,x:s*2,y:r*2}}if(typeof e=="object"){const r=W0(e.top??e.y??0,n),s=W0(e.bottom??e.y??0,n),i=W0(e.left??e.x??0,t),a=W0(e.right??e.x??0,t);return{top:r,right:a,bottom:s,left:i,x:i+a,y:r+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function qet(e,t,n,r,s,i){const{x:a,y:o}=GE(e,[t,n,r]),{x:l,y:c}=GE({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=s-l,d=i-c;return{left:Math.floor(a),top:Math.floor(o),right:Math.floor(u),bottom:Math.floor(d)}}const sL=(e,t,n,r,s,i)=>{const a=Uet(i,t,n),o=(t-a.x)/e.width,l=(n-a.y)/e.height,c=Math.min(o,l),u=bb(c,r,s),d=e.x+e.width/2,h=e.y+e.height/2,p=t/2-d*u,g=n/2-h*u,y=qet(e,p,g,u,t,n),v={left:Math.min(y.left-a.left,0),top:Math.min(y.top-a.top,0),right:Math.min(y.right-a.right,0),bottom:Math.min(y.bottom-a.bottom,0)};return{x:p-v.left+v.right,y:g-v.top+v.bottom,zoom:u}},KE=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function xb(e){return e!==void 0&&e!=="parent"}function qf(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Rle(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Ile(e,t={width:0,height:0},n,r,s){const i={...e},a=r.get(n);if(a){const o=a.origin||s;i.x+=a.internals.positionAbsolute.x-(t.width??0)*o[0],i.y+=a.internals.positionAbsolute.y-(t.height??0)*o[1]}return i}function hH(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Vet(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function Wet(e){return{...Sle,...e||{}}}function Cw(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:s}){const{x:i,y:a}=xf(e),o=d_({x:i-((s==null?void 0:s.left)??0),y:a-((s==null?void 0:s.top)??0)},r),{x:l,y:c}=n?mN(o,t):o;return{xSnapped:l,ySnapped:c,...o}}const iL=e=>({width:e.offsetWidth,height:e.offsetHeight}),Mle=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Het=["INPUT","SELECT","TEXTAREA"];function jle(e){var r,s;const t=((s=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:s[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:Het.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const Ple=e=>"clientX"in e,xf=(e,t)=>{var i,a;const n=Ple(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(a=e.touches)==null?void 0:a[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},pH=(e,t,n,r,s)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(a=>{const o=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),type:e,nodeId:s,position:a.getAttribute("data-handlepos"),x:(o.left-n.left)/r,y:(o.top-n.top)/r,...iL(a)}})};function Ole({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:s,sourceControlY:i,targetControlX:a,targetControlY:o}){const l=e*.125+s*.375+a*.375+n*.125,c=t*.125+i*.375+o*.375+r*.125,u=Math.abs(l-e),d=Math.abs(c-t);return[l,c,u,d]}function _2(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function mH({pos:e,x1:t,y1:n,x2:r,y2:s,c:i}){switch(e){case Vn.Left:return[t-_2(t-r,i),n];case Vn.Right:return[t+_2(r-t,i),n];case Vn.Top:return[t,n-_2(n-s,i)];case Vn.Bottom:return[t,n+_2(s-n,i)]}}function Dle({sourceX:e,sourceY:t,sourcePosition:n=Vn.Bottom,targetX:r,targetY:s,targetPosition:i=Vn.Top,curvature:a=.25}){const[o,l]=mH({pos:n,x1:e,y1:t,x2:r,y2:s,c:a}),[c,u]=mH({pos:i,x1:r,y1:s,x2:e,y2:t,c:a}),[d,h,p,g]=Ole({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:o,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${o},${l} ${c},${u} ${r},${s}`,d,h,p,g]}function Fle({sourceX:e,sourceY:t,targetX:n,targetY:r}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,a=Math.abs(r-t)/2,o=r<t?r+a:r-a;return[i,o,s,a]}function Get({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r=0,elevateOnSelect:s=!1}){if(!s)return r;const i=n||t.selected||e.selected,a=Math.max(e.internals.z||0,t.internals.z||0,1e3);return r+(i?a:0)}function Ket({sourceNode:e,targetNode:t,width:n,height:r,transform:s}){const i=hN(HE(e),HE(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const a={x:-s[0]/s[2],y:-s[1]/s[2],width:n/s[2],height:r/s[2]};return Z1(a,pN(i))>0}const Yet=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,Zet=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Xet=(e,t)=>{if(!e.source||!e.target)return t;let n;return kle(e)?n={...e}:n={...e,id:Yet(e)},Zet(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Lle({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[s,i,a,o]=Fle({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,s,i,a,o]}const gH={[Vn.Left]:{x:-1,y:0},[Vn.Right]:{x:1,y:0},[Vn.Top]:{x:0,y:-1},[Vn.Bottom]:{x:0,y:1}},Jet=({source:e,sourcePosition:t=Vn.Bottom,target:n})=>t===Vn.Left||t===Vn.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},yH=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Qet({source:e,sourcePosition:t=Vn.Bottom,target:n,targetPosition:r=Vn.Top,center:s,offset:i}){const a=gH[t],o=gH[r],l={x:e.x+a.x*i,y:e.y+a.y*i},c={x:n.x+o.x*i,y:n.y+o.y*i},u=Jet({source:l,sourcePosition:t,target:c}),d=u.x!==0?"x":"y",h=u[d];let p=[],g,y;const v={x:0,y:0},x={x:0,y:0},[w,S,_,k]=Fle({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(a[d]*o[d]===-1){g=s.x??w,y=s.y??S;const A=[{x:g,y:l.y},{x:g,y:c.y}],R=[{x:l.x,y},{x:c.x,y}];a[d]===h?p=d==="x"?A:R:p=d==="x"?R:A}else{const A=[{x:l.x,y:c.y}],R=[{x:c.x,y:l.y}];if(d==="x"?p=a.x===h?R:A:p=a.y===h?A:R,t===r){const q=Math.abs(e[d]-n[d]);if(q<=i){const I=Math.min(i-1,i-q);a[d]===h?v[d]=(l[d]>e[d]?-1:1)*I:x[d]=(c[d]>n[d]?-1:1)*I}}if(t!==r){const q=d==="x"?"y":"x",I=a[d]===o[q],V=l[q]>c[q],D=l[q]<c[q];(a[d]===1&&(!I&&V||I&&D)||a[d]!==1&&(!I&&D||I&&V))&&(p=d==="x"?A:R)}const M={x:l.x+v.x,y:l.y+v.y},j={x:c.x+x.x,y:c.y+x.y},F=Math.max(Math.abs(M.x-p[0].x),Math.abs(j.x-p[0].x)),P=Math.max(Math.abs(M.y-p[0].y),Math.abs(j.y-p[0].y));F>=P?(g=(M.x+j.x)/2,y=p[0].y):(g=p[0].x,y=(M.y+j.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...p,{x:c.x+x.x,y:c.y+x.y},n],g,y,_,k]}function ett(e,t,n,r){const s=Math.min(yH(e,t)/2,yH(t,n)/2,r),{x:i,y:a}=t;if(e.x===i&&i===n.x||e.y===a&&a===n.y)return`L${i} ${a}`;if(e.y===a){const c=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+s*c},${a}Q ${i},${a} ${i},${a+s*u}`}const o=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${a+s*l}Q ${i},${a} ${i+s*o},${a}`}function TO({sourceX:e,sourceY:t,sourcePosition:n=Vn.Bottom,targetX:r,targetY:s,targetPosition:i=Vn.Top,borderRadius:a=5,centerX:o,centerY:l,offset:c=20}){const[u,d,h,p,g]=Qet({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:s},targetPosition:i,center:{x:o,y:l},offset:c});return[u.reduce((v,x,w)=>{let S="";return w>0&&w<u.length-1?S=ett(u[w-1],x,u[w+1],a):S=`${w===0?"M":"L"}${x.x} ${x.y}`,v+=S,v},""),d,h,p,g]}function bH(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function ttt(e){var d;const{sourceNode:t,targetNode:n}=e;if(!bH(t)||!bH(n))return null;const r=t.internals.handleBounds||vH(t.handles),s=n.internals.handleBounds||vH(n.handles),i=xH((r==null?void 0:r.source)??[],e.sourceHandle),a=xH(e.connectionMode===gb.Strict?(s==null?void 0:s.target)??[]:((s==null?void 0:s.target)??[]).concat((s==null?void 0:s.source)??[]),e.targetHandle);if(!i||!a)return(d=e.onError)==null||d.call(e,"008",ud.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const o=(i==null?void 0:i.position)||Vn.Bottom,l=(a==null?void 0:a.position)||Vn.Top,c=X1(t,i,o),u=X1(n,a,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:o,targetPosition:l}}function vH(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function X1(e,t,n=Vn.Left,r=!1){const s=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,i=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:a,height:o}=t??qf(e);if(r)return{x:s+a/2,y:i+o/2};switch((t==null?void 0:t.position)??n){case Vn.Top:return{x:s+a/2,y:i};case Vn.Right:return{x:s+a,y:i+o/2};case Vn.Bottom:return{x:s+a/2,y:i+o};case Vn.Left:return{x:s,y:i+o/2}}}function xH(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function AO(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function ntt(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:s}){const i=new Set;return e.reduce((a,o)=>([o.markerStart||r,o.markerEnd||s].forEach(l=>{if(l&&typeof l=="object"){const c=AO(l,t);i.has(c)||(a.push({id:c,color:l.color||n,...l}),i.add(c))}}),a),[]).sort((a,o)=>a.id.localeCompare(o.id))}const aL={nodeOrigin:[0,0],nodeExtent:K1,elevateNodesOnSelect:!0,defaults:{}},rtt={...aL,checkEquality:!0};function oL(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function stt(e,t,n){const r=oL(aL,n);for(const s of e.values())if(s.parentId)lL(s,e,t,r);else{const i=c_(s,r.nodeOrigin),a=xb(s.extent)?s.extent:r.nodeExtent,o=mg(i,a,qf(s));s.internals.positionAbsolute=o}}function NO(e,t,n,r){var l,c;const s=oL(rtt,r);let i=e.length>0;const a=new Map(t),o=s!=null&&s.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let d=a.get(u.id);if(s.checkEquality&&u===(d==null?void 0:d.internals.userNode))t.set(u.id,d);else{const h=c_(u,s.nodeOrigin),p=xb(u.extent)?u.extent:s.nodeExtent,g=mg(h,p,qf(u));d={...s.defaults,...u,measured:{width:(l=u.measured)==null?void 0:l.width,height:(c=u.measured)==null?void 0:c.height},internals:{positionAbsolute:g,handleBounds:u.measured?d==null?void 0:d.internals.handleBounds:void 0,z:$le(u,o),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(i=!1),u.parentId&&lL(d,t,n,r)}return i}function itt(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function lL(e,t,n,r){const{elevateNodesOnSelect:s,nodeOrigin:i,nodeExtent:a}=oL(aL,r),o=e.parentId,l=t.get(o);if(!l){console.warn(`Parent node ${o} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}itt(e,n);const c=s?1e3:0,{x:u,y:d,z:h}=att(e,l,i,a,c),{positionAbsolute:p}=e.internals,g=u!==p.x||d!==p.y;(g||h!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:g?{x:u,y:d}:p,z:h}})}function $le(e,t){return(Kc(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function att(e,t,n,r,s){const{x:i,y:a}=t.internals.positionAbsolute,o=qf(e),l=c_(e,n),c=xb(e.extent)?mg(l,e.extent,o):l;let u=mg({x:i+c.x,y:a+c.y},r,o);e.extent==="parent"&&(u=Tle(u,o,t));const d=$le(e,s),h=t.internals.z??0;return{x:u.x,y:u.y,z:h>d?h:d}}function cL(e,t,n,r=[0,0]){var a;const s=[],i=new Map;for(const o of e){const l=t.get(o.parentId);if(!l)continue;const c=((a=i.get(o.parentId))==null?void 0:a.expandedRect)??vb(l),u=Nle(c,o.rect);i.set(o.parentId,{expandedRect:u,parent:l})}return i.size>0&&i.forEach(({expandedRect:o,parent:l},c)=>{var S;const u=l.internals.positionAbsolute,d=qf(l),h=l.origin??r,p=o.x<u.x?Math.round(Math.abs(u.x-o.x)):0,g=o.y<u.y?Math.round(Math.abs(u.y-o.y)):0,y=Math.max(d.width,Math.round(o.width)),v=Math.max(d.height,Math.round(o.height)),x=(y-d.width)*h[0],w=(v-d.height)*h[1];(p>0||g>0||x||w)&&(s.push({id:c,type:"position",position:{x:l.position.x-p+x,y:l.position.y-g+w}}),(S=n.get(c))==null||S.forEach(_=>{e.some(k=>k.id===_.id)||s.push({id:_.id,type:"position",position:{x:_.position.x+p,y:_.position.y+g}})})),(d.width<o.width||d.height<o.height||p||g)&&s.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:y+(p?h[0]*p-x:0),height:v+(g?h[1]*g-w:0)}})}),s}function ott(e,t,n,r,s,i){const a=r==null?void 0:r.querySelector(".xyflow__viewport");let o=!1;if(!a)return{changes:[],updatedInternals:o};const l=[],c=window.getComputedStyle(a),{m22:u}=new window.DOMMatrixReadOnly(c.transform),d=[];for(const h of e.values()){const p=t.get(h.id);if(!p)continue;if(p.hidden){t.set(p.id,{...p,internals:{...p.internals,handleBounds:void 0}}),o=!0;continue}const g=iL(h.nodeElement),y=p.measured.width!==g.width||p.measured.height!==g.height;if(!!(g.width&&g.height&&(y||!p.internals.handleBounds||h.force))){const x=h.nodeElement.getBoundingClientRect(),w=xb(p.extent)?p.extent:i;let{positionAbsolute:S}=p.internals;p.parentId&&p.extent==="parent"?S=Tle(S,g,t.get(p.parentId)):w&&(S=mg(S,w,g));const _={...p,measured:g,internals:{...p.internals,positionAbsolute:S,handleBounds:{source:pH("source",h.nodeElement,x,u,p.id),target:pH("target",h.nodeElement,x,u,p.id)}}};t.set(p.id,_),p.parentId&&lL(_,t,n,{nodeOrigin:s}),o=!0,y&&(l.push({id:p.id,type:"dimensions",dimensions:g}),p.expandParent&&p.parentId&&d.push({id:p.id,parentId:p.parentId,rect:vb(_,s)}))}}if(d.length>0){const h=cL(d,t,n,s);l.push(...h)}return{changes:l,updatedInternals:o}}async function ltt({delta:e,panZoom:t,transform:n,translateExtent:r,width:s,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const a=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[s,i]],r),o=!!a&&(a.x!==n[0]||a.y!==n[1]||a.k!==n[2]);return Promise.resolve(o)}function wH(e,t,n,r,s,i){let a=s;const o=r.get(a)||new Map;r.set(a,o.set(n,t)),a=`${s}-${e}`;const l=r.get(a)||new Map;if(r.set(a,l.set(n,t)),i){a=`${s}-${e}-${i}`;const c=r.get(a)||new Map;r.set(a,c.set(n,t))}}function Ble(e,t,n){e.clear(),t.clear();for(const r of n){const{source:s,target:i,sourceHandle:a=null,targetHandle:o=null}=r,l={edgeId:r.id,source:s,target:i,sourceHandle:a,targetHandle:o},c=`${s}-${a}--${i}-${o}`,u=`${i}-${o}--${s}-${a}`;wH("source",l,u,e,s,a),wH("target",l,c,e,i,o),t.set(r.id,r)}}function zle(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:zle(n,t):!1}function SH(e,t,n){var s;let r=e;do{if((s=r==null?void 0:r.matches)!=null&&s.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function ctt(e,t,n,r){const s=new Map;for(const[i,a]of e)if((a.selected||a.id===r)&&(!a.parentId||!zle(a,e))&&(a.draggable||t&&typeof a.draggable>"u")){const o=e.get(i);o&&s.set(i,{id:i,position:o.position||{x:0,y:0},distance:{x:n.x-o.internals.positionAbsolute.x,y:n.y-o.internals.positionAbsolute.y},extent:o.extent,parentId:o.parentId,origin:o.origin,expandParent:o.expandParent,internals:{positionAbsolute:o.internals.positionAbsolute||{x:0,y:0}},measured:{width:o.measured.width??0,height:o.measured.height??0}})}return s}function Z3({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var a,o,l;const s=[];for(const[c,u]of t){const d=(a=n.get(c))==null?void 0:a.internals.userNode;d&&s.push({...d,position:u.position,dragging:r})}if(!e)return[s[0],s];const i=(o=n.get(e))==null?void 0:o.internals.userNode;return[i?{...i,position:((l=t.get(e))==null?void 0:l.position)||i.position,dragging:r}:s[0],s]}function utt({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:s}){let i={x:null,y:null},a=0,o=new Map,l=!1,c={x:0,y:0},u=null,d=!1,h=null,p=!1;function g({noDragClassName:v,handleSelector:x,domNode:w,isSelectable:S,nodeId:_,nodeClickDistance:k=0}){h=mr(w);function T({x:j,y:F},P){const{nodeLookup:q,nodeExtent:I,snapGrid:V,snapToGrid:D,nodeOrigin:z,onNodeDrag:$,onSelectionDrag:Y,onError:B,updateNodePositions:G}=t();i={x:j,y:F};let Z=!1,ne={x:0,y:0,x2:0,y2:0};if(o.size>1&&I){const ae=u_(o);ne=EO(ae)}for(const[ae,le]of o){if(!q.has(ae))continue;let Se={x:j-le.distance.x,y:F-le.distance.y};D&&(Se=mN(Se,V));let Ee=[[I[0][0],I[0][1]],[I[1][0],I[1][1]]];if(o.size>1&&I&&!le.extent){const{positionAbsolute:Le}=le.internals,He=Le.x-ne.x+I[0][0],Fe=Le.x+le.measured.width-ne.x2+I[1][0],Ie=Le.y-ne.y+I[0][1],X=Le.y+le.measured.height-ne.y2+I[1][1];Ee=[[He,Ie],[Fe,X]]}const{position:he,positionAbsolute:pe}=Ele({nodeId:ae,nextPosition:Se,nodeLookup:q,nodeExtent:Ee,nodeOrigin:z,onError:B});Z=Z||le.position.x!==he.x||le.position.y!==he.y,le.position=he,le.internals.positionAbsolute=pe}if(Z&&(G(o,!0),P&&(r||$||!_&&Y))){const[ae,le]=Z3({nodeId:_,dragItems:o,nodeLookup:q});r==null||r(P,o,ae,le),$==null||$(P,ae,le),_||Y==null||Y(P,le)}}async function A(){if(!u)return;const{transform:j,panBy:F,autoPanSpeed:P,autoPanOnNodeDrag:q}=t();if(!q){l=!1,cancelAnimationFrame(a);return}const[I,V]=Ale(c,u,P);(I!==0||V!==0)&&(i.x=(i.x??0)-I/j[2],i.y=(i.y??0)-V/j[2],await F({x:I,y:V})&&T(i,null)),a=requestAnimationFrame(A)}function R(j){var Z;const{nodeLookup:F,multiSelectionActive:P,nodesDraggable:q,transform:I,snapGrid:V,snapToGrid:D,selectNodesOnDrag:z,onNodeDragStart:$,onSelectionDragStart:Y,unselectNodesAndEdges:B}=t();d=!0,(!z||!S)&&!P&&_&&((Z=F.get(_))!=null&&Z.selected||B()),S&&z&&_&&(e==null||e(_));const G=Cw(j.sourceEvent,{transform:I,snapGrid:V,snapToGrid:D,containerBounds:u});if(i=G,o=ctt(F,q,G,_),o.size>0&&(n||$||!_&&Y)){const[ne,ae]=Z3({nodeId:_,dragItems:o,nodeLookup:F});n==null||n(j.sourceEvent,o,ne,ae),$==null||$(j.sourceEvent,ne,ae),_||Y==null||Y(j.sourceEvent,ae)}}const M=sle().clickDistance(k).on("start",j=>{const{domNode:F,nodeDragThreshold:P,transform:q,snapGrid:I,snapToGrid:V}=t();u=(F==null?void 0:F.getBoundingClientRect())||null,p=!1,P===0&&R(j),i=Cw(j.sourceEvent,{transform:q,snapGrid:I,snapToGrid:V,containerBounds:u}),c=xf(j.sourceEvent,u)}).on("drag",j=>{const{autoPanOnNodeDrag:F,transform:P,snapGrid:q,snapToGrid:I,nodeDragThreshold:V,nodeLookup:D}=t(),z=Cw(j.sourceEvent,{transform:P,snapGrid:q,snapToGrid:I,containerBounds:u});if((j.sourceEvent.type==="touchmove"&&j.sourceEvent.touches.length>1||_&&!D.has(_))&&(p=!0),!p){if(!l&&F&&d&&(l=!0,A()),!d){const $=z.xSnapped-(i.x??0),Y=z.ySnapped-(i.y??0);Math.sqrt($*$+Y*Y)>V&&R(j)}(i.x!==z.xSnapped||i.y!==z.ySnapped)&&o&&d&&(c=xf(j.sourceEvent,u),T(z,j.sourceEvent))}}).on("end",j=>{if(!(!d||p)&&(l=!1,d=!1,cancelAnimationFrame(a),o.size>0)){const{nodeLookup:F,updateNodePositions:P,onNodeDragStop:q,onSelectionDragStop:I}=t();if(P(o,!1),s||q||!_&&I){const[V,D]=Z3({nodeId:_,dragItems:o,nodeLookup:F,dragging:!1});s==null||s(j.sourceEvent,o,V,D),q==null||q(j.sourceEvent,V,D),_||I==null||I(j.sourceEvent,D)}}}).filter(j=>{const F=j.target;return!j.button&&(!v||!SH(F,`.${v}`,w))&&(!x||SH(F,x,w))});h.call(M)}function y(){h==null||h.on(".drag",null)}return{update:g,destroy:y}}function dtt(e,t,n){const r=[],s={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())Z1(s,vb(i))>0&&r.push(i);return r}const ftt=250;function htt(e,t,n,r){var o,l;let s=[],i=1/0;const a=dtt(e,n,t+ftt);for(const c of a){const u=[...((o=c.internals.handleBounds)==null?void 0:o.source)??[],...((l=c.internals.handleBounds)==null?void 0:l.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:h,y:p}=X1(c,d,d.position,!0),g=Math.sqrt(Math.pow(h-e.x,2)+Math.pow(p-e.y,2));g>t||(g<i?(s=[{...d,x:h,y:p}],i=g):g===i&&s.push({...d,x:h,y:p}))}}if(!s.length)return null;if(s.length>1){const c=r.type==="source"?"target":"source";return s.find(u=>u.type===c)??s[0]}return s[0]}function Ule(e,t,n,r,s,i=!1){var c,u,d;const a=r.get(e);if(!a)return null;const o=s==="strict"?(c=a.internals.handleBounds)==null?void 0:c[t]:[...((u=a.internals.handleBounds)==null?void 0:u.source)??[],...((d=a.internals.handleBounds)==null?void 0:d.target)??[]],l=(n?o==null?void 0:o.find(h=>h.id===n):o==null?void 0:o[0])??null;return l&&i?{...l,...X1(a,l,l.position,!0)}:l}function qle(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function ptt(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const Vle=()=>!0;function mtt(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:s,edgeUpdaterType:i,isTarget:a,domNode:o,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:d,panBy:h,cancelConnection:p,onConnectStart:g,onConnect:y,onConnectEnd:v,isValidConnection:x=Vle,onReconnectEnd:w,updateConnection:S,getTransform:_,getFromHandle:k,autoPanSpeed:T}){const A=Mle(e.target);let R=0,M;const{x:j,y:F}=xf(e),P=A==null?void 0:A.elementFromPoint(j,F),q=qle(i,P),I=o==null?void 0:o.getBoundingClientRect();if(!I||!q)return;const V=Ule(s,q,r,l,t);if(!V)return;let D=xf(e,I),z=!1,$=null,Y=!1,B=null;function G(){if(!u||!I)return;const[pe,Le]=Ale(D,I,T);h({x:pe,y:Le}),R=requestAnimationFrame(G)}const Z={...V,nodeId:s,type:q,position:V.position},ne=l.get(s),le={inProgress:!0,isValid:null,from:X1(ne,Z,Vn.Left,!0),fromHandle:Z,fromPosition:Z.position,fromNode:ne,to:D,toHandle:null,toPosition:uH[Z.position],toNode:null};S(le);let Se=le;g==null||g(e,{nodeId:s,handleId:r,handleType:q});function Ee(pe){if(!k()||!Z){he(pe);return}const Le=_();D=xf(pe,I),M=htt(d_(D,Le,!1,[1,1]),n,l,Z),z||(G(),z=!0);const He=Wle(pe,{handle:M,connectionMode:t,fromNodeId:s,fromHandleId:r,fromType:a?"target":"source",isValidConnection:x,doc:A,lib:c,flowId:d,nodeLookup:l});B=He.handleDomNode,$=He.connection,Y=ptt(!!M,He.isValid);const Fe={...Se,isValid:Y,to:He.toHandle&&Y?GE({x:He.toHandle.x,y:He.toHandle.y},Le):D,toHandle:He.toHandle,toPosition:Y&&He.toHandle?He.toHandle.position:uH[Z.position],toNode:He.toHandle?l.get(He.toHandle.nodeId):null};Y&&M&&Se.toHandle&&Fe.toHandle&&Se.toHandle.type===Fe.toHandle.type&&Se.toHandle.nodeId===Fe.toHandle.nodeId&&Se.toHandle.id===Fe.toHandle.id&&Se.to.x===Fe.to.x&&Se.to.y===Fe.to.y||(S(Fe),Se=Fe)}function he(pe){(M||B)&&$&&Y&&(y==null||y($));const{inProgress:Le,...He}=Se,Fe={...He,toPosition:Se.toHandle?Se.toPosition:null};v==null||v(pe,Fe),i&&(w==null||w(pe,Fe)),p(),cancelAnimationFrame(R),z=!1,Y=!1,$=null,B=null,A.removeEventListener("mousemove",Ee),A.removeEventListener("mouseup",he),A.removeEventListener("touchmove",Ee),A.removeEventListener("touchend",he)}A.addEventListener("mousemove",Ee),A.addEventListener("mouseup",he),A.addEventListener("touchmove",Ee),A.addEventListener("touchend",he)}function Wle(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:s,fromType:i,doc:a,lib:o,flowId:l,isValidConnection:c=Vle,nodeLookup:u}){const d=i==="target",h=t?a.querySelector(`.${o}-flow__handle[data-id="${l}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:p,y:g}=xf(e),y=a.elementFromPoint(p,g),v=y!=null&&y.classList.contains(`${o}-flow__handle`)?y:h,x={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){const w=qle(void 0,v),S=v.getAttribute("data-nodeid"),_=v.getAttribute("data-handleid"),k=v.classList.contains("connectable"),T=v.classList.contains("connectableend");if(!S||!w)return x;const A={source:d?S:r,sourceHandle:d?_:s,target:d?r:S,targetHandle:d?s:_};x.connection=A;const M=k&&T&&(n===gb.Strict?d&&w==="source"||!d&&w==="target":S!==r||_!==s);x.isValid=M&&c(A),x.toHandle=Ule(S,w,_,u,n,!0)}return x}const RO={onPointerDown:mtt,isValid:Wle};function gtt({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const s=mr(e);function i({translateExtent:o,width:l,height:c,zoomStep:u=10,pannable:d=!0,zoomable:h=!0,inversePan:p=!1}){const g=S=>{const _=n();if(S.sourceEvent.type!=="wheel"||!t)return;const k=-S.sourceEvent.deltaY*(S.sourceEvent.deltaMode===1?.05:S.sourceEvent.deltaMode?1:.002)*u,T=_[2]*Math.pow(2,k);t.scaleTo(T)};let y=[0,0];const v=S=>{(S.sourceEvent.type==="mousedown"||S.sourceEvent.type==="touchstart")&&(y=[S.sourceEvent.clientX??S.sourceEvent.touches[0].clientX,S.sourceEvent.clientY??S.sourceEvent.touches[0].clientY])},x=S=>{const _=n();if(S.sourceEvent.type!=="mousemove"&&S.sourceEvent.type!=="touchmove"||!t)return;const k=[S.sourceEvent.clientX??S.sourceEvent.touches[0].clientX,S.sourceEvent.clientY??S.sourceEvent.touches[0].clientY],T=[k[0]-y[0],k[1]-y[1]];y=k;const A=r()*Math.max(_[2],Math.log(_[2]))*(p?-1:1),R={x:_[0]-T[0]*A,y:_[1]-T[1]*A},M=[[0,0],[l,c]];t.setViewportConstrained({x:R.x,y:R.y,zoom:_[2]},M,o)},w=xle().on("start",v).on("zoom",d?x:null).on("zoom.wheel",h?g:null);s.call(w,{})}function a(){s.on("zoom",null)}return{update:i,destroy:a,pointer:Uc}}const ytt=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,gN=e=>({x:e.x,y:e.y,zoom:e.k}),X3=({x:e,y:t,zoom:n})=>fN.translate(e,t).scale(n),fy=(e,t)=>e.target.closest(`.${t}`),Hle=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),btt=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,J3=(e,t=0,n=btt,r=()=>{})=>{const s=typeof t=="number"&&t>0;return s||r(),s?e.transition().duration(t).ease(n).on("end",r):e},Gle=e=>{const t=e.ctrlKey&&KE()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function vtt({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:s,panOnScrollSpeed:i,zoomOnPinch:a,onPanZoomStart:o,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(fy(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&a){const v=Uc(u),x=Gle(u),w=d*Math.pow(2,x);r.scaleTo(n,w,v,u);return}const h=u.deltaMode===1?20:1;let p=s===Ym.Vertical?0:u.deltaX*h,g=s===Ym.Horizontal?0:u.deltaY*h;!KE()&&u.shiftKey&&s!==Ym.Vertical&&(p=u.deltaY*h,g=0),r.translateBy(n,-(p/d)*i,-(g/d)*i,{internal:!0});const y=gN(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,o==null||o(u,y)),e.isPanScrolling&&(l==null||l(u,y),e.panScrollTimeout=setTimeout(()=>{c==null||c(u,y),e.isPanScrolling=!1},150))}}function xtt({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,s){const i=r.type==="wheel",a=!t&&i&&!r.ctrlKey,o=fy(r,e);if(r.ctrlKey&&i&&o&&r.preventDefault(),a||o)return null;r.preventDefault(),n.call(this,r,s)}}function wtt({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var i,a,o;if((i=r.sourceEvent)!=null&&i.internal)return;const s=gN(r.transform);e.mouseButton=((a=r.sourceEvent)==null?void 0:a.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=s,((o=r.sourceEvent)==null?void 0:o.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,s))}}function Stt({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:s}){return i=>{var a,o;e.usedRightMouseButton=!!(n&&Hle(t,e.mouseButton??0)),(a=i.sourceEvent)!=null&&a.sync||r([i.transform.x,i.transform.y,i.transform.k]),s&&!((o=i.sourceEvent)!=null&&o.internal)&&(s==null||s(i.sourceEvent,gN(i.transform)))}}function _tt({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:s,onPaneContextMenu:i}){return a=>{var o;if(!((o=a.sourceEvent)!=null&&o.internal)&&(e.isZoomingOrPanning=!1,i&&Hle(t,e.mouseButton??0)&&!e.usedRightMouseButton&&a.sourceEvent&&i(a.sourceEvent),e.usedRightMouseButton=!1,r(!1),s&&ytt(e.prevViewport,a.transform))){const l=gN(a.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{s==null||s(a.sourceEvent,l)},n?150:0)}}}function Ctt({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:s,zoomOnDoubleClick:i,userSelectionActive:a,noWheelClassName:o,noPanClassName:l,lib:c}){return u=>{var g;const d=e||t,h=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(fy(u,`${c}-flow__node`)||fy(u,`${c}-flow__edge`)))return!0;if(!r&&!d&&!s&&!i&&!n||a||fy(u,o)&&u.type==="wheel"||fy(u,l)&&(u.type!=="wheel"||s&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((g=u.touches)==null?void 0:g.length)>1)return u.preventDefault(),!1;if(!d&&!s&&!h&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const p=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&p}}function ktt({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:s,viewport:i,onPanZoom:a,onPanZoomStart:o,onPanZoomEnd:l,onDraggingChange:c}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),h=xle().clickDistance(!Kc(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(s),p=mr(e).call(h);S({x:i.x,y:i.y,zoom:bb(i.zoom,t,n)},[[0,0],[d.width,d.height]],s);const g=p.on("wheel.zoom"),y=p.on("dblclick.zoom");h.wheelDelta(Gle);function v(P,q){return p?new Promise(I=>{h==null||h.interpolate((q==null?void 0:q.interpolate)==="linear"?_w:tk).transform(J3(p,q==null?void 0:q.duration,q==null?void 0:q.ease,()=>I(!0)),P)}):Promise.resolve(!1)}function x({noWheelClassName:P,noPanClassName:q,onPaneContextMenu:I,userSelectionActive:V,panOnScroll:D,panOnDrag:z,panOnScrollMode:$,panOnScrollSpeed:Y,preventScrolling:B,zoomOnPinch:G,zoomOnScroll:Z,zoomOnDoubleClick:ne,zoomActivationKeyPressed:ae,lib:le,onTransformChange:Se}){V&&!u.isZoomingOrPanning&&w();const he=D&&!ae&&!V?vtt({zoomPanValues:u,noWheelClassName:P,d3Selection:p,d3Zoom:h,panOnScrollMode:$,panOnScrollSpeed:Y,zoomOnPinch:G,onPanZoomStart:o,onPanZoom:a,onPanZoomEnd:l}):xtt({noWheelClassName:P,preventScrolling:B,d3ZoomHandler:g});if(p.on("wheel.zoom",he,{passive:!1}),!V){const Le=wtt({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:o});h.on("start",Le);const He=Stt({zoomPanValues:u,panOnDrag:z,onPaneContextMenu:!!I,onPanZoom:a,onTransformChange:Se});h.on("zoom",He);const Fe=_tt({zoomPanValues:u,panOnDrag:z,panOnScroll:D,onPaneContextMenu:I,onPanZoomEnd:l,onDraggingChange:c});h.on("end",Fe)}const pe=Ctt({zoomActivationKeyPressed:ae,panOnDrag:z,zoomOnScroll:Z,panOnScroll:D,zoomOnDoubleClick:ne,zoomOnPinch:G,userSelectionActive:V,noPanClassName:q,noWheelClassName:P,lib:le});h.filter(pe),ne?p.on("dblclick.zoom",y):p.on("dblclick.zoom",null)}function w(){h.on("zoom",null)}async function S(P,q,I){const V=X3(P),D=h==null?void 0:h.constrain()(V,q,I);return D&&await v(D),new Promise(z=>z(D))}async function _(P,q){const I=X3(P);return await v(I,q),new Promise(V=>V(I))}function k(P){if(p){const q=X3(P),I=p.property("__zoom");(I.k!==P.zoom||I.x!==P.x||I.y!==P.y)&&(h==null||h.transform(p,q,null,{sync:!0}))}}function T(){const P=p?vle(p.node()):{x:0,y:0,k:1};return{x:P.x,y:P.y,zoom:P.k}}function A(P,q){return p?new Promise(I=>{h==null||h.interpolate((q==null?void 0:q.interpolate)==="linear"?_w:tk).scaleTo(J3(p,q==null?void 0:q.duration,q==null?void 0:q.ease,()=>I(!0)),P)}):Promise.resolve(!1)}function R(P,q){return p?new Promise(I=>{h==null||h.interpolate((q==null?void 0:q.interpolate)==="linear"?_w:tk).scaleBy(J3(p,q==null?void 0:q.duration,q==null?void 0:q.ease,()=>I(!0)),P)}):Promise.resolve(!1)}function M(P){h==null||h.scaleExtent(P)}function j(P){h==null||h.translateExtent(P)}function F(P){const q=!Kc(P)||P<0?0:P;h==null||h.clickDistance(q)}return{update:x,destroy:w,setViewport:_,setViewportConstrained:S,getViewport:T,scaleTo:A,scaleBy:R,setScaleExtent:M,setTranslateExtent:j,syncViewport:k,setClickDistance:F}}var wb;(function(e){e.Line="line",e.Handle="handle"})(wb||(wb={}));function Ett({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:s,affectsY:i}){const a=e-t,o=n-r,l=[a>0?1:a<0?-1:0,o>0?1:o<0?-1:0];return a&&s&&(l[0]=l[0]*-1),o&&i&&(l[1]=l[1]*-1),l}function Ttt(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),s=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:s}}function Ih(e,t){return Math.max(0,t-e)}function Mh(e,t){return Math.max(0,e-t)}function C2(e,t,n){return Math.max(0,t-e,e-n)}function _H(e,t){return e?!t:t}function Att(e,t,n,r,s,i,a,o){let{affectsX:l,affectsY:c}=t;const{isHorizontal:u,isVertical:d}=t,h=u&&d,{xSnapped:p,ySnapped:g}=n,{minWidth:y,maxWidth:v,minHeight:x,maxHeight:w}=r,{x:S,y:_,width:k,height:T,aspectRatio:A}=e;let R=Math.floor(u?p-e.pointerX:0),M=Math.floor(d?g-e.pointerY:0);const j=k+(l?-R:R),F=T+(c?-M:M),P=-i[0]*k,q=-i[1]*T;let I=C2(j,y,v),V=C2(F,x,w);if(a){let $=0,Y=0;l&&R<0?$=Ih(S+R+P,a[0][0]):!l&&R>0&&($=Mh(S+j+P,a[1][0])),c&&M<0?Y=Ih(_+M+q,a[0][1]):!c&&M>0&&(Y=Mh(_+F+q,a[1][1])),I=Math.max(I,$),V=Math.max(V,Y)}if(o){let $=0,Y=0;l&&R>0?$=Mh(S+R,o[0][0]):!l&&R<0&&($=Ih(S+j,o[1][0])),c&&M>0?Y=Mh(_+M,o[0][1]):!c&&M<0&&(Y=Ih(_+F,o[1][1])),I=Math.max(I,$),V=Math.max(V,Y)}if(s){if(u){const $=C2(j/A,x,w)*A;if(I=Math.max(I,$),a){let Y=0;!l&&!c||l&&!c&&h?Y=Mh(_+q+j/A,a[1][1])*A:Y=Ih(_+q+(l?R:-R)/A,a[0][1])*A,I=Math.max(I,Y)}if(o){let Y=0;!l&&!c||l&&!c&&h?Y=Ih(_+j/A,o[1][1])*A:Y=Mh(_+(l?R:-R)/A,o[0][1])*A,I=Math.max(I,Y)}}if(d){const $=C2(F*A,y,v)/A;if(V=Math.max(V,$),a){let Y=0;!l&&!c||c&&!l&&h?Y=Mh(S+F*A+P,a[1][0])/A:Y=Ih(S+(c?M:-M)*A+P,a[0][0])/A,V=Math.max(V,Y)}if(o){let Y=0;!l&&!c||c&&!l&&h?Y=Ih(S+F*A,o[1][0])/A:Y=Mh(S+(c?M:-M)*A,o[0][0])/A,V=Math.max(V,Y)}}}M=M+(M<0?V:-V),R=R+(R<0?I:-I),s&&(h?j>F*A?M=(_H(l,c)?-R:R)/A:R=(_H(l,c)?-M:M)*A:u?(M=R/A,c=l):(R=M*A,l=c));const D=l?S+R:S,z=c?_+M:_;return{width:k+(l?-R:R),height:T+(c?-M:M),x:i[0]*R*(l?-1:1)+D,y:i[1]*M*(c?-1:1)+z}}const Kle={width:0,height:0,x:0,y:0},Ntt={...Kle,pointerX:0,pointerY:0,aspectRatio:1};function Rtt(e){return[[0,0],[e.measured.width,e.measured.height]]}function Itt(e,t,n){const r=t.position.x+e.position.x,s=t.position.y+e.position.y,i=e.measured.width??0,a=e.measured.height??0,o=n[0]*i,l=n[1]*a;return[[r-o,s-l],[r+i-o,s+a-l]]}function Mtt({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:s}){const i=mr(e);function a({controlPosition:l,boundaries:c,keepAspectRatio:u,resizeDirection:d,onResizeStart:h,onResize:p,onResizeEnd:g,shouldResize:y}){let v={...Kle},x={...Ntt};const w=Ttt(l);let S,_=null,k=[],T,A,R;const M=sle().on("start",j=>{const{nodeLookup:F,transform:P,snapGrid:q,snapToGrid:I,nodeOrigin:V,paneDomNode:D}=n();if(S=F.get(t),!S)return;_=(D==null?void 0:D.getBoundingClientRect())??null;const{xSnapped:z,ySnapped:$}=Cw(j.sourceEvent,{transform:P,snapGrid:q,snapToGrid:I,containerBounds:_});v={width:S.measured.width??0,height:S.measured.height??0,x:S.position.x??0,y:S.position.y??0},x={...v,pointerX:z,pointerY:$,aspectRatio:v.width/v.height},T=void 0,S.parentId&&(S.extent==="parent"||S.expandParent)&&(T=F.get(S.parentId),A=T&&S.extent==="parent"?Rtt(T):void 0),k=[],R=void 0;for(const[Y,B]of F)if(B.parentId===t&&(k.push({id:Y,position:{...B.position},extent:B.extent}),B.extent==="parent"||B.expandParent)){const G=Itt(B,S,B.origin??V);R?R=[[Math.min(G[0][0],R[0][0]),Math.min(G[0][1],R[0][1])],[Math.max(G[1][0],R[1][0]),Math.max(G[1][1],R[1][1])]]:R=G}h==null||h(j,{...v})}).on("drag",j=>{const{transform:F,snapGrid:P,snapToGrid:q,nodeOrigin:I}=n(),V=Cw(j.sourceEvent,{transform:F,snapGrid:P,snapToGrid:q,containerBounds:_}),D=[];if(!S)return;const{x:z,y:$,width:Y,height:B}=v,G={},Z=S.origin??I,{width:ne,height:ae,x:le,y:Se}=Att(x,w,V,c,u,Z,A,R),Ee=ne!==Y,he=ae!==B,pe=le!==z&&Ee,Le=Se!==$&&he;if(!pe&&!Le&&!Ee&&!he)return;if((pe||Le||Z[0]===1||Z[1]===1)&&(G.x=pe?le:v.x,G.y=Le?Se:v.y,v.x=G.x,v.y=G.y,k.length>0)){const X=le-z,ye=Se-$;for(const Ne of k)Ne.position={x:Ne.position.x-X+Z[0]*(ne-Y),y:Ne.position.y-ye+Z[1]*(ae-B)},D.push(Ne)}if((Ee||he)&&(G.width=Ee&&(!d||d==="horizontal")?ne:v.width,G.height=he&&(!d||d==="vertical")?ae:v.height,v.width=G.width,v.height=G.height),T&&S.expandParent){const X=Z[0]*(G.width??0);G.x&&G.x<X&&(v.x=X,x.x=x.x-(G.x-X));const ye=Z[1]*(G.height??0);G.y&&G.y<ye&&(v.y=ye,x.y=x.y-(G.y-ye))}const He=Ett({width:v.width,prevWidth:Y,height:v.height,prevHeight:B,affectsX:w.affectsX,affectsY:w.affectsY}),Fe={...v,direction:He};(y==null?void 0:y(j,Fe))!==!1&&(p==null||p(j,Fe),r(G,D))}).on("end",j=>{g==null||g(j,{...v}),s==null||s({...v})});i.call(M)}function o(){i.on(".drag",null)}return{update:a,destroy:o}}const jtt={},CH=e=>{let t;const n=new Set,r=(u,d)=>{const h=typeof u=="function"?u(t):u;if(!Object.is(h,t)){const p=t;t=d??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(g=>g(t,p))}},s=()=>t,l={setState:r,getState:s,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(jtt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(r,s,l);return l},Ptt=e=>e?CH(e):CH,{useDebugValue:Ott}=We,{useSyncExternalStoreWithSelector:Dtt}=h6e,Ftt=e=>e;function Yle(e,t=Ftt,n){const r=Dtt(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Ott(r),r}const kH=(e,t)=>{const n=Ptt(e),r=(s,i=t)=>Yle(n,s,i);return Object.assign(r,n),r},Ltt=(e,t)=>e?kH(e,t):kH;function fi(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const yN=E.createContext(null),$tt=yN.Provider,Zle=ud.error001();function Xr(e,t){const n=E.useContext(yN);if(n===null)throw new Error(Zle);return Yle(n,e,t)}function ri(){const e=E.useContext(yN);if(e===null)throw new Error(Zle);return E.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const EH={display:"none"},Btt={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Xle="react-flow__node-desc",Jle="react-flow__edge-desc",ztt="react-flow__aria-live",Utt=e=>e.ariaLiveMessage,qtt=e=>e.ariaLabelConfig;function Vtt({rfId:e}){const t=Xr(Utt);return f.jsx("div",{id:`${ztt}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:Btt,children:t})}function Wtt({rfId:e,disableKeyboardA11y:t}){const n=Xr(qtt);return f.jsxs(f.Fragment,{children:[f.jsx("div",{id:`${Xle}-${e}`,style:EH,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),f.jsx("div",{id:`${Jle}-${e}`,style:EH,children:n["edge.a11yDescription.default"]}),!t&&f.jsx(Vtt,{rfId:e})]})}const Htt=e=>e.userSelectionActive?"none":"all",bN=E.forwardRef(({position:e="top-left",children:t,className:n,style:r,...s},i)=>{const a=Xr(Htt),o=`${e}`.split("-");return f.jsx("div",{className:Yi(["react-flow__panel",n,...o]),style:{...r,pointerEvents:a},ref:i,...s,children:t})});bN.displayName="Panel";function Gtt({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:f.jsx(bN,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:f.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Ktt=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},k2=e=>e.id;function Ytt(e,t){return fi(e.selectedNodes.map(k2),t.selectedNodes.map(k2))&&fi(e.selectedEdges.map(k2),t.selectedEdges.map(k2))}function Ztt({onSelectionChange:e}){const t=ri(),{selectedNodes:n,selectedEdges:r}=Xr(Ktt,Ytt);return E.useEffect(()=>{const s={nodes:n,edges:r};e==null||e(s),t.getState().onSelectionChangeHandlers.forEach(i=>i(s))},[n,r,e]),null}const Xtt=e=>!!e.onSelectionChangeHandlers;function Jtt({onSelectionChange:e}){const t=Xr(Xtt);return e||t?f.jsx(Ztt,{onSelectionChange:e}):null}const Qle=[0,0],Qtt={x:0,y:0,zoom:1},ent=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],TH=[...ent,"rfId"],tnt=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),AH={translateExtent:K1,nodeOrigin:Qle,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function nnt(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:s,setTranslateExtent:i,setNodeExtent:a,reset:o,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=Xr(tnt,fi),u=ri();E.useEffect(()=>(l(e.defaultNodes,e.defaultEdges),()=>{d.current=AH,o()}),[]);const d=E.useRef(AH);return E.useEffect(()=>{for(const h of TH){const p=e[h],g=d.current[h];p!==g&&(typeof e[h]>"u"||(h==="nodes"?t(p):h==="edges"?n(p):h==="minZoom"?r(p):h==="maxZoom"?s(p):h==="translateExtent"?i(p):h==="nodeExtent"?a(p):h==="paneClickDistance"?c(p):h==="fitView"?u.setState({fitViewQueued:p}):h==="fitViewOptions"&&u.setState({fitViewOptions:p}),h==="ariaLabelConfig"?u.setState({ariaLabelConfig:Wet(p)}):u.setState({[h]:p})))}d.current=e},TH.map(h=>e[h])),null}function NH(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function rnt(e){var r;const[t,n]=E.useState(e==="system"?null:e);return E.useEffect(()=>{if(e!=="system"){n(e);return}const s=NH(),i=()=>n(s!=null&&s.matches?"dark":"light");return i(),s==null||s.addEventListener("change",i),()=>{s==null||s.removeEventListener("change",i)}},[e]),t!==null?t:(r=NH())!=null&&r.matches?"dark":"light"}const RH=typeof document<"u"?document:null;function J1(e=null,t={target:RH,actInsideInputWithModifier:!0}){const[n,r]=E.useState(!1),s=E.useRef(!1),i=E.useRef(new Set([])),[a,o]=E.useMemo(()=>{if(e!==null){const c=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=c.reduce((d,h)=>d.concat(...h),[]);return[c,u]}return[[],[]]},[e]);return E.useEffect(()=>{const l=(t==null?void 0:t.target)??RH,c=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const u=p=>{var v,x;if(s.current=p.ctrlKey||p.metaKey||p.shiftKey||p.altKey,(!s.current||s.current&&!c)&&jle(p))return!1;const y=MH(p.code,o);if(i.current.add(p[y]),IH(a,i.current,!1)){const w=((x=(v=p.composedPath)==null?void 0:v.call(p))==null?void 0:x[0])||p.target,S=(w==null?void 0:w.nodeName)==="BUTTON"||(w==null?void 0:w.nodeName)==="A";t.preventDefault!==!1&&(s.current||!S)&&p.preventDefault(),r(!0)}},d=p=>{const g=MH(p.code,o);IH(a,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(p[g]),p.key==="Meta"&&i.current.clear(),s.current=!1},h=()=>{i.current.clear(),r(!1)};return l==null||l.addEventListener("keydown",u),l==null||l.addEventListener("keyup",d),window.addEventListener("blur",h),window.addEventListener("contextmenu",h),()=>{l==null||l.removeEventListener("keydown",u),l==null||l.removeEventListener("keyup",d),window.removeEventListener("blur",h),window.removeEventListener("contextmenu",h)}}},[e,r]),n}function IH(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(s=>t.has(s)))}function MH(e,t){return t.includes(e)?"code":"key"}const snt=()=>{const e=ri();return E.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,s,i],panZoom:a}=e.getState();return a?(await a.setViewport({x:t.x??r,y:t.y??s,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:s,minZoom:i,maxZoom:a,panZoom:o}=e.getState(),l=sL(t,r,s,i,a,(n==null?void 0:n.padding)??.1);return o?(await o.setViewport(l,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:s,snapToGrid:i,domNode:a}=e.getState();if(!a)return t;const{x:o,y:l}=a.getBoundingClientRect(),c={x:t.x-o,y:t.y-l},u=n.snapGrid??s,d=n.snapToGrid??i;return d_(c,r,d,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:s,y:i}=r.getBoundingClientRect(),a=GE(t,n);return{x:a.x+s,y:a.y+i}}}),[])};function ece(e,t){const n=[],r=new Map,s=[];for(const i of e)if(i.type==="add"){s.push(i);continue}else if(i.type==="remove"||i.type==="replace")r.set(i.id,[i]);else{const a=r.get(i.id);a?a.push(i):r.set(i.id,[i])}for(const i of t){const a=r.get(i.id);if(!a){n.push(i);continue}if(a[0].type==="remove")continue;if(a[0].type==="replace"){n.push({...a[0].item});continue}const o={...i};for(const l of a)int(l,o);n.push(o)}return s.length&&s.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function int(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function ant(e,t){return ece(e,t)}function ont(e,t){return ece(e,t)}function km(e,t){return{id:e,type:"select",selected:t}}function hy(e,t=new Set,n=!1){const r=[];for(const[s,i]of e){const a=t.has(s);!(i.selected===void 0&&!a)&&i.selected!==a&&(n&&(i.selected=a),r.push(km(i.id,a)))}return r}function jH({items:e=[],lookup:t}){var s;const n=[],r=new Map(e.map(i=>[i.id,i]));for(const[i,a]of e.entries()){const o=t.get(a.id),l=((s=o==null?void 0:o.internals)==null?void 0:s.userNode)??o;l!==void 0&&l!==a&&n.push({id:a.id,item:a,type:"replace"}),l===void 0&&n.push({item:a,type:"add",index:i})}for(const[i]of t)r.get(i)===void 0&&n.push({id:i,type:"remove"});return n}function PH(e){return{id:e.id,type:"remove"}}const OH=e=>Oet(e),lnt=e=>kle(e);function tce(e){return E.forwardRef(e)}const cnt=typeof window<"u"?E.useLayoutEffect:E.useEffect;function DH(e){const[t,n]=E.useState(BigInt(0)),[r]=E.useState(()=>unt(()=>n(s=>s+BigInt(1))));return cnt(()=>{const s=r.get();s.length&&(e(s),r.reset())},[t]),r}function unt(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const nce=E.createContext(null);function dnt({children:e}){const t=ri(),n=E.useCallback(o=>{const{nodes:l=[],setNodes:c,hasDefaultNodes:u,onNodesChange:d,nodeLookup:h,fitViewQueued:p}=t.getState();let g=l;for(const v of o)g=typeof v=="function"?v(g):v;const y=jH({items:g,lookup:h});u&&c(g),y.length>0?d==null||d(y):p&&window.requestAnimationFrame(()=>{const{fitViewQueued:v,nodes:x,setNodes:w}=t.getState();v&&w(x)})},[]),r=DH(n),s=E.useCallback(o=>{const{edges:l=[],setEdges:c,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:h}=t.getState();let p=l;for(const g of o)p=typeof g=="function"?g(p):g;u?c(p):d&&d(jH({items:p,lookup:h}))},[]),i=DH(s),a=E.useMemo(()=>({nodeQueue:r,edgeQueue:i}),[]);return f.jsx(nce.Provider,{value:a,children:e})}function fnt(){const e=E.useContext(nce);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const hnt=e=>!!e.panZoom;function uL(){const e=snt(),t=ri(),n=fnt(),r=Xr(hnt),s=E.useMemo(()=>{const i=d=>t.getState().nodeLookup.get(d),a=d=>{n.nodeQueue.push(d)},o=d=>{n.edgeQueue.push(d)},l=d=>{var x,w;const{nodeLookup:h,nodeOrigin:p}=t.getState(),g=OH(d)?d:h.get(d.id),y=g.parentId?Ile(g.position,g.measured,g.parentId,h,p):g.position,v={...g,position:y,width:((x=g.measured)==null?void 0:x.width)??g.width,height:((w=g.measured)==null?void 0:w.height)??g.height};return vb(v)},c=(d,h,p={replace:!1})=>{a(g=>g.map(y=>{if(y.id===d){const v=typeof h=="function"?h(y):h;return p.replace&&OH(v)?v:{...y,...v}}return y}))},u=(d,h,p={replace:!1})=>{o(g=>g.map(y=>{if(y.id===d){const v=typeof h=="function"?h(y):h;return p.replace&&lnt(v)?v:{...y,...v}}return y}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var h;return(h=i(d))==null?void 0:h.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(h=>({...h}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:a,setEdges:o,addNodes:d=>{const h=Array.isArray(d)?d:[d];n.nodeQueue.push(p=>[...p,...h])},addEdges:d=>{const h=Array.isArray(d)?d:[d];n.edgeQueue.push(p=>[...p,...h])},toObject:()=>{const{nodes:d=[],edges:h=[],transform:p}=t.getState(),[g,y,v]=p;return{nodes:d.map(x=>({...x})),edges:h.map(x=>({...x})),viewport:{x:g,y,zoom:v}}},deleteElements:async({nodes:d=[],edges:h=[]})=>{const{nodes:p,edges:g,onNodesDelete:y,onEdgesDelete:v,triggerNodeChanges:x,triggerEdgeChanges:w,onDelete:S,onBeforeDelete:_}=t.getState(),{nodes:k,edges:T}=await Bet({nodesToRemove:d,edgesToRemove:h,nodes:p,edges:g,onBeforeDelete:_}),A=T.length>0,R=k.length>0;if(A){const M=T.map(PH);v==null||v(T),w(M)}if(R){const M=k.map(PH);y==null||y(k),x(M)}return(R||A)&&(S==null||S({nodes:k,edges:T})),{deletedNodes:k,deletedEdges:T}},getIntersectingNodes:(d,h=!0,p)=>{const g=fH(d),y=g?d:l(d),v=p!==void 0;return y?(p||t.getState().nodes).filter(x=>{const w=t.getState().nodeLookup.get(x.id);if(w&&!g&&(x.id===d.id||!w.internals.positionAbsolute))return!1;const S=vb(v?x:w),_=Z1(S,y);return h&&_>0||_>=y.width*y.height}):[]},isNodeIntersecting:(d,h,p=!0)=>{const y=fH(d)?d:l(d);if(!y)return!1;const v=Z1(y,h);return p&&v>0||v>=y.width*y.height},updateNode:c,updateNodeData:(d,h,p={replace:!1})=>{c(d,g=>{const y=typeof h=="function"?h(g):h;return p.replace?{...g,data:y}:{...g,data:{...g.data,...y}}},p)},updateEdge:u,updateEdgeData:(d,h,p={replace:!1})=>{u(d,g=>{const y=typeof h=="function"?h(g):h;return p.replace?{...g,data:y}:{...g,data:{...g.data,...y}}},p)},getNodesBounds:d=>{const{nodeLookup:h,nodeOrigin:p}=t.getState();return Det(d,{nodeLookup:h,nodeOrigin:p})},getHandleConnections:({type:d,id:h,nodeId:p})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${p}-${d}${h?`-${h}`:""}`))==null?void 0:g.values())??[])},getNodeConnections:({type:d,handleId:h,nodeId:p})=>{var g;return Array.from(((g=t.getState().connectionLookup.get(`${p}${d?h?`-${d}-${h}`:`-${d}`:""}`))==null?void 0:g.values())??[])},fitView:async d=>{const h=t.getState().fitViewResolver??Vet();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:h}),n.nodeQueue.push(p=>[...p]),h.promise}}},[]);return E.useMemo(()=>({...s,...e,viewportInitialized:r}),[r])}const FH=e=>e.selected,pnt=typeof window<"u"?window:void 0;function mnt({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ri(),{deleteElements:r}=uL(),s=J1(e,{actInsideInputWithModifier:!1}),i=J1(t,{target:pnt});E.useEffect(()=>{if(s){const{edges:a,nodes:o}=n.getState();r({nodes:o.filter(FH),edges:a.filter(FH)}),n.setState({nodesSelectionActive:!1})}},[s]),E.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function gnt(e){const t=ri();E.useEffect(()=>{const n=()=>{var s,i;if(!e.current)return!1;const r=iL(e.current);(r.height===0||r.width===0)&&((i=(s=t.getState()).onError)==null||i.call(s,"004",ud.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const vN={position:"absolute",width:"100%",height:"100%",top:0,left:0},ynt=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function bnt({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:s=.5,panOnScrollMode:i=Ym.Free,zoomOnDoubleClick:a=!0,panOnDrag:o=!0,defaultViewport:l,translateExtent:c,minZoom:u,maxZoom:d,zoomActivationKeyCode:h,preventScrolling:p=!0,children:g,noWheelClassName:y,noPanClassName:v,onViewportChange:x,isControlledViewport:w,paneClickDistance:S}){const _=ri(),k=E.useRef(null),{userSelectionActive:T,lib:A}=Xr(ynt,fi),R=J1(h),M=E.useRef();gnt(k);const j=E.useCallback(F=>{x==null||x({x:F[0],y:F[1],zoom:F[2]}),w||_.setState({transform:F})},[x,w]);return E.useEffect(()=>{if(k.current){M.current=ktt({domNode:k.current,minZoom:u,maxZoom:d,translateExtent:c,viewport:l,paneClickDistance:S,onDraggingChange:I=>_.setState({paneDragging:I}),onPanZoomStart:(I,V)=>{const{onViewportChangeStart:D,onMoveStart:z}=_.getState();z==null||z(I,V),D==null||D(V)},onPanZoom:(I,V)=>{const{onViewportChange:D,onMove:z}=_.getState();z==null||z(I,V),D==null||D(V)},onPanZoomEnd:(I,V)=>{const{onViewportChangeEnd:D,onMoveEnd:z}=_.getState();z==null||z(I,V),D==null||D(V)}});const{x:F,y:P,zoom:q}=M.current.getViewport();return _.setState({panZoom:M.current,transform:[F,P,q],domNode:k.current.closest(".react-flow")}),()=>{var I;(I=M.current)==null||I.destroy()}}},[]),E.useEffect(()=>{var F;(F=M.current)==null||F.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:s,panOnScrollMode:i,zoomOnDoubleClick:a,panOnDrag:o,zoomActivationKeyPressed:R,preventScrolling:p,noPanClassName:v,userSelectionActive:T,noWheelClassName:y,lib:A,onTransformChange:j})},[e,t,n,r,s,i,a,o,R,p,v,T,y,A,j]),f.jsx("div",{className:"react-flow__renderer",ref:k,style:vN,children:g})}const vnt=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function xnt(){const{userSelectionActive:e,userSelectionRect:t}=Xr(vnt,fi);return e&&t?f.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Q3=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},wnt=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function Snt({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Y1.Full,panOnDrag:r,selectionOnDrag:s,onSelectionStart:i,onSelectionEnd:a,onPaneClick:o,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:h,children:p}){const g=ri(),{userSelectionActive:y,elementsSelectable:v,dragging:x,connectionInProgress:w}=Xr(wnt,fi),S=v&&(e||y),_=E.useRef(null),k=E.useRef(),T=E.useRef(new Set),A=E.useRef(new Set),R=E.useRef(!1),M=E.useRef(!1),j=z=>{if(R.current||w){R.current=!1;return}o==null||o(z),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},F=z=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){z.preventDefault();return}l==null||l(z)},P=c?z=>c(z):void 0,q=z=>{var Z,ne;const{resetSelectedElements:$,domNode:Y}=g.getState();if(k.current=Y==null?void 0:Y.getBoundingClientRect(),!v||!e||z.button!==0||z.target!==_.current||!k.current)return;(ne=(Z=z.target)==null?void 0:Z.setPointerCapture)==null||ne.call(Z,z.pointerId),M.current=!0,R.current=!1;const{x:B,y:G}=xf(z.nativeEvent,k.current);$(),g.setState({userSelectionRect:{width:0,height:0,startX:B,startY:G,x:B,y:G}}),i==null||i(z)},I=z=>{const{userSelectionRect:$,transform:Y,nodeLookup:B,edgeLookup:G,connectionLookup:Z,triggerNodeChanges:ne,triggerEdgeChanges:ae,defaultEdgeOptions:le}=g.getState();if(!k.current||!$)return;R.current=!0;const{x:Se,y:Ee}=xf(z.nativeEvent,k.current),{startX:he,startY:pe}=$,Le={startX:he,startY:pe,x:Se<he?Se:he,y:Ee<pe?Ee:pe,width:Math.abs(Se-he),height:Math.abs(Ee-pe)},He=T.current,Fe=A.current;T.current=new Set(rL(B,Le,Y,n===Y1.Partial,!0).map(X=>X.id)),A.current=new Set;const Ie=(le==null?void 0:le.selectable)??!0;for(const X of T.current){const ye=Z.get(X);if(ye)for(const{edgeId:Ne}of ye.values()){const fe=G.get(Ne);fe&&(fe.selectable??Ie)&&A.current.add(Ne)}}if(!hH(He,T.current)){const X=hy(B,T.current,!0);ne(X)}if(!hH(Fe,A.current)){const X=hy(G,A.current);ae(X)}g.setState({userSelectionRect:Le,userSelectionActive:!0,nodesSelectionActive:!1})},V=z=>{var Y,B;if(z.button!==0||!M.current)return;(B=(Y=z.target)==null?void 0:Y.releasePointerCapture)==null||B.call(Y,z.pointerId);const{userSelectionRect:$}=g.getState();!y&&$&&z.target===_.current&&(j==null||j(z)),g.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:T.current.size>0}),a==null||a(z),(t||s)&&(R.current=!1),M.current=!1},D=r===!0||Array.isArray(r)&&r.includes(0);return f.jsxs("div",{className:Yi(["react-flow__pane",{draggable:D,dragging:x,selection:e}]),onClick:S?void 0:Q3(j,_),onContextMenu:Q3(F,_),onWheel:Q3(P,_),onPointerEnter:S?void 0:u,onPointerDown:S?q:d,onPointerMove:S?I:d,onPointerUp:S?V:void 0,onPointerLeave:h,ref:_,style:vN,children:[p,f.jsx(xnt,{})]})}function IO({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:a,nodeLookup:o,onError:l}=t.getState(),c=o.get(e);if(!c){l==null||l("012",ud.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&a)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):s([e])}function rce({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:s,isSelectable:i,nodeClickDistance:a}){const o=ri(),[l,c]=E.useState(!1),u=E.useRef();return E.useEffect(()=>{u.current=utt({getStoreItems:()=>o.getState(),onNodeMouseDown:d=>{IO({id:d,store:o,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),E.useEffect(()=>{var d,h;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(h=u.current)==null||h.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:s,nodeClickDistance:a}),()=>{var p;(p=u.current)==null||p.destroy()}},[n,r,t,i,e,s]),l}const _nt=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function sce(){const e=ri();return E.useCallback(n=>{const{nodeExtent:r,snapToGrid:s,snapGrid:i,nodesDraggable:a,onError:o,updateNodePositions:l,nodeLookup:c,nodeOrigin:u}=e.getState(),d=new Map,h=_nt(a),p=s?i[0]:5,g=s?i[1]:5,y=n.direction.x*p*n.factor,v=n.direction.y*g*n.factor;for(const[,x]of c){if(!h(x))continue;let w={x:x.internals.positionAbsolute.x+y,y:x.internals.positionAbsolute.y+v};s&&(w=mN(w,i));const{position:S,positionAbsolute:_}=Ele({nodeId:x.id,nextPosition:w,nodeLookup:c,nodeExtent:r,nodeOrigin:u,onError:o});x.position=S,x.internals.positionAbsolute=_,d.set(x.id,x)}l(d)},[])}const dL=E.createContext(null),Cnt=dL.Provider;dL.Consumer;const ice=()=>E.useContext(dL),knt=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Ent=(e,t,n)=>r=>{const{connectionClickStartHandle:s,connectionMode:i,connection:a}=r,{fromHandle:o,toHandle:l,isValid:c}=a,u=(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.id)===t&&(l==null?void 0:l.type)===n;return{connectingFrom:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,connectingTo:u,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.id)===t&&(s==null?void 0:s.type)===n,isPossibleEndHandle:i===gb.Strict?(o==null?void 0:o.type)!==n:e!==(o==null?void 0:o.nodeId)||t!==(o==null?void 0:o.id),connectionInProcess:!!o,clickConnectionInProcess:!!s,valid:u&&c}};function Tnt({type:e="source",position:t=Vn.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:a,onConnect:o,children:l,className:c,onMouseDown:u,onTouchStart:d,...h},p){var V,D;const g=a||null,y=e==="target",v=ri(),x=ice(),{connectOnClick:w,noPanClassName:S,rfId:_}=Xr(knt,fi),{connectingFrom:k,connectingTo:T,clickConnecting:A,isPossibleEndHandle:R,connectionInProcess:M,clickConnectionInProcess:j,valid:F}=Xr(Ent(x,g,e),fi);x||(D=(V=v.getState()).onError)==null||D.call(V,"010",ud.error010());const P=z=>{const{defaultEdgeOptions:$,onConnect:Y,hasDefaultEdges:B}=v.getState(),G={...$,...z};if(B){const{edges:Z,setEdges:ne}=v.getState();ne(Xet(G,Z))}Y==null||Y(G),o==null||o(G)},q=z=>{if(!x)return;const $=Ple(z.nativeEvent);if(s&&($&&z.button===0||!$)){const Y=v.getState();RO.onPointerDown(z.nativeEvent,{autoPanOnConnect:Y.autoPanOnConnect,connectionMode:Y.connectionMode,connectionRadius:Y.connectionRadius,domNode:Y.domNode,nodeLookup:Y.nodeLookup,lib:Y.lib,isTarget:y,handleId:g,nodeId:x,flowId:Y.rfId,panBy:Y.panBy,cancelConnection:Y.cancelConnection,onConnectStart:Y.onConnectStart,onConnectEnd:Y.onConnectEnd,updateConnection:Y.updateConnection,onConnect:P,isValidConnection:n||Y.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:Y.autoPanSpeed})}$?u==null||u(z):d==null||d(z)},I=z=>{const{onClickConnectStart:$,onClickConnectEnd:Y,connectionClickStartHandle:B,connectionMode:G,isValidConnection:Z,lib:ne,rfId:ae,nodeLookup:le,connection:Se}=v.getState();if(!x||!B&&!s)return;if(!B){$==null||$(z.nativeEvent,{nodeId:x,handleId:g,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:x,type:e,id:g}});return}const Ee=Mle(z.target),he=n||Z,{connection:pe,isValid:Le}=RO.isValid(z.nativeEvent,{handle:{nodeId:x,id:g,type:e},connectionMode:G,fromNodeId:B.nodeId,fromHandleId:B.id||null,fromType:B.type,isValidConnection:he,flowId:ae,doc:Ee,lib:ne,nodeLookup:le});Le&&pe&&P(pe);const He=structuredClone(Se);delete He.inProgress,He.toPosition=He.toHandle?He.toHandle.position:null,Y==null||Y(z,He),v.setState({connectionClickStartHandle:null})};return f.jsx("div",{"data-handleid":g,"data-nodeid":x,"data-handlepos":t,"data-id":`${_}-${x}-${g}-${e}`,className:Yi(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",S,c,{source:!y,target:y,connectable:r,connectablestart:s,connectableend:i,clickconnecting:A,connectingfrom:k,connectingto:T,valid:F,connectionindicator:r&&(!M||R)&&(M||j?i:s)}]),onMouseDown:q,onTouchStart:q,onClick:w?I:void 0,ref:p,...h,children:l})}const gp=E.memo(tce(Tnt));function Ant({data:e,isConnectable:t,sourcePosition:n=Vn.Bottom}){return f.jsxs(f.Fragment,{children:[e==null?void 0:e.label,f.jsx(gp,{type:"source",position:n,isConnectable:t})]})}function Nnt({data:e,isConnectable:t,targetPosition:n=Vn.Top,sourcePosition:r=Vn.Bottom}){return f.jsxs(f.Fragment,{children:[f.jsx(gp,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,f.jsx(gp,{type:"source",position:r,isConnectable:t})]})}function Rnt(){return null}function Int({data:e,isConnectable:t,targetPosition:n=Vn.Top}){return f.jsxs(f.Fragment,{children:[f.jsx(gp,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const YE={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},LH={input:Ant,default:Nnt,output:Int,group:Rnt};function Mnt(e){var t,n,r,s;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((s=e.style)==null?void 0:s.height)}}const jnt=e=>{const{width:t,height:n,x:r,y:s}=u_(e.nodeLookup,{filter:i=>!!i.selected});return{width:Kc(t)?t:null,height:Kc(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${s}px)`}};function Pnt({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ri(),{width:s,height:i,transformString:a,userSelectionActive:o}=Xr(jnt,fi),l=sce(),c=E.useRef(null);if(E.useEffect(()=>{var h;n||(h=c.current)==null||h.focus({preventScroll:!0})},[n]),rce({nodeRef:c}),o||!s||!i)return null;const u=e?h=>{const p=r.getState().nodes.filter(g=>g.selected);e(h,p)}:void 0,d=h=>{Object.prototype.hasOwnProperty.call(YE,h.key)&&(h.preventDefault(),l({direction:YE[h.key],factor:h.shiftKey?4:1}))};return f.jsx("div",{className:Yi(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a},children:f.jsx("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:s,height:i}})})}const $H=typeof window<"u"?window:void 0,Ont=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function ace({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,paneClickDistance:o,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:u,selectionMode:d,onSelectionStart:h,onSelectionEnd:p,multiSelectionKeyCode:g,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:x,zoomOnScroll:w,zoomOnPinch:S,panOnScroll:_,panOnScrollSpeed:k,panOnScrollMode:T,zoomOnDoubleClick:A,panOnDrag:R,defaultViewport:M,translateExtent:j,minZoom:F,maxZoom:P,preventScrolling:q,onSelectionContextMenu:I,noWheelClassName:V,noPanClassName:D,disableKeyboardA11y:z,onViewportChange:$,isControlledViewport:Y}){const{nodesSelectionActive:B,userSelectionActive:G}=Xr(Ont),Z=J1(c,{target:$H}),ne=J1(y,{target:$H}),ae=ne||R,le=ne||_,Se=u&&ae!==!0,Ee=Z||G||Se;return mnt({deleteKeyCode:l,multiSelectionKeyCode:g}),f.jsx(bnt,{onPaneContextMenu:i,elementsSelectable:x,zoomOnScroll:w,zoomOnPinch:S,panOnScroll:le,panOnScrollSpeed:k,panOnScrollMode:T,zoomOnDoubleClick:A,panOnDrag:!Z&&ae,defaultViewport:M,translateExtent:j,minZoom:F,maxZoom:P,zoomActivationKeyCode:v,preventScrolling:q,noWheelClassName:V,noPanClassName:D,onViewportChange:$,isControlledViewport:Y,paneClickDistance:o,children:f.jsxs(Snt,{onSelectionStart:h,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:a,panOnDrag:ae,isSelecting:!!Ee,selectionMode:d,selectionKeyPressed:Z,selectionOnDrag:Se,children:[e,B&&f.jsx(Pnt,{onSelectionContextMenu:I,noPanClassName:D,disableKeyboardA11y:z})]})})}ace.displayName="FlowRenderer";const Dnt=E.memo(ace),Fnt=e=>t=>e?rL(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Lnt(e){return Xr(E.useCallback(Fnt(e),[e]),fi)}const $nt=e=>e.updateNodeInternals;function Bnt(){const e=Xr($nt),[t]=E.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(s=>{const i=s.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:s.target,force:!0})}),e(r)}));return E.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function znt({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const s=ri(),i=E.useRef(null),a=E.useRef(null),o=E.useRef(e.sourcePosition),l=E.useRef(e.targetPosition),c=E.useRef(t),u=n&&!!e.internals.handleBounds;return E.useEffect(()=>{i.current&&!e.hidden&&(!u||a.current!==i.current)&&(a.current&&(r==null||r.unobserve(a.current)),r==null||r.observe(i.current),a.current=i.current)},[u,e.hidden]),E.useEffect(()=>()=>{a.current&&(r==null||r.unobserve(a.current),a.current=null)},[]),E.useEffect(()=>{if(i.current){const d=c.current!==t,h=o.current!==e.sourcePosition,p=l.current!==e.targetPosition;(d||h||p)&&(c.current=t,o.current=e.sourcePosition,l.current=e.targetPosition,s.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Unt({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:s,onContextMenu:i,onDoubleClick:a,nodesDraggable:o,elementsSelectable:l,nodesConnectable:c,nodesFocusable:u,resizeObserver:d,noDragClassName:h,noPanClassName:p,disableKeyboardA11y:g,rfId:y,nodeTypes:v,nodeClickDistance:x,onError:w}){const{node:S,internals:_,isParent:k}=Xr(he=>{const pe=he.nodeLookup.get(e),Le=he.parentLookup.has(e);return{node:pe,internals:pe.internals,isParent:Le}},fi);let T=S.type||"default",A=(v==null?void 0:v[T])||LH[T];A===void 0&&(w==null||w("003",ud.error003(T)),T="default",A=LH.default);const R=!!(S.draggable||o&&typeof S.draggable>"u"),M=!!(S.selectable||l&&typeof S.selectable>"u"),j=!!(S.connectable||c&&typeof S.connectable>"u"),F=!!(S.focusable||u&&typeof S.focusable>"u"),P=ri(),q=Rle(S),I=znt({node:S,nodeType:T,hasDimensions:q,resizeObserver:d}),V=rce({nodeRef:I,disabled:S.hidden||!R,noDragClassName:h,handleSelector:S.dragHandle,nodeId:e,isSelectable:M,nodeClickDistance:x}),D=sce();if(S.hidden)return null;const z=qf(S),$=Mnt(S),Y=M||R||t||n||r||s,B=n?he=>n(he,{..._.userNode}):void 0,G=r?he=>r(he,{..._.userNode}):void 0,Z=s?he=>s(he,{..._.userNode}):void 0,ne=i?he=>i(he,{..._.userNode}):void 0,ae=a?he=>a(he,{..._.userNode}):void 0,le=he=>{const{selectNodesOnDrag:pe,nodeDragThreshold:Le}=P.getState();M&&(!pe||!R||Le>0)&&IO({id:e,store:P,nodeRef:I}),t&&t(he,{..._.userNode})},Se=he=>{if(!(jle(he.nativeEvent)||g)){if(wle.includes(he.key)&&M){const pe=he.key==="Escape";IO({id:e,store:P,unselect:pe,nodeRef:I})}else if(R&&S.selected&&Object.prototype.hasOwnProperty.call(YE,he.key)){he.preventDefault();const{ariaLabelConfig:pe}=P.getState();P.setState({ariaLiveMessage:pe["node.a11yDescription.ariaLiveMessage"]({direction:he.key.replace("Arrow","").toLowerCase(),x:~~_.positionAbsolute.x,y:~~_.positionAbsolute.y})}),D({direction:YE[he.key],factor:he.shiftKey?4:1})}}},Ee=()=>{var X;if(g||!((X=I.current)!=null&&X.matches(":focus-visible")))return;const{transform:he,width:pe,height:Le,autoPanOnNodeFocus:He,setCenter:Fe}=P.getState();if(!He)return;rL(new Map([[e,S]]),{x:0,y:0,width:pe,height:Le},he,!0).length>0||Fe(S.position.x+z.width/2,S.position.y+z.height/2,{zoom:he[2]})};return f.jsx("div",{className:Yi(["react-flow__node",`react-flow__node-${T}`,{[p]:R},S.className,{selected:S.selected,selectable:M,parent:k,draggable:R,dragging:V}]),ref:I,style:{zIndex:_.z,transform:`translate(${_.positionAbsolute.x}px,${_.positionAbsolute.y}px)`,pointerEvents:Y?"all":"none",visibility:q?"visible":"hidden",...S.style,...$},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:B,onMouseMove:G,onMouseLeave:Z,onContextMenu:ne,onClick:le,onDoubleClick:ae,onKeyDown:F?Se:void 0,tabIndex:F?0:void 0,onFocus:F?Ee:void 0,role:S.ariaRole??(F?"group":void 0),"aria-roledescription":"node","aria-describedby":g?void 0:`${Xle}-${y}`,"aria-label":S.ariaLabel,...S.domAttributes,children:f.jsx(Cnt,{value:e,children:f.jsx(A,{id:e,data:S.data,type:T,positionAbsoluteX:_.positionAbsolute.x,positionAbsoluteY:_.positionAbsolute.y,selected:S.selected??!1,selectable:M,draggable:R,deletable:S.deletable??!0,isConnectable:j,sourcePosition:S.sourcePosition,targetPosition:S.targetPosition,dragging:V,dragHandle:S.dragHandle,zIndex:_.z,parentId:S.parentId,...z})})})}const qnt=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function oce(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:s,onError:i}=Xr(qnt,fi),a=Lnt(e.onlyRenderVisibleElements),o=Bnt();return f.jsx("div",{className:"react-flow__nodes",style:vN,children:a.map(l=>f.jsx(Unt,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:o,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:s,nodeClickDistance:e.nodeClickDistance,onError:i},l))})}oce.displayName="NodeRenderer";const Vnt=E.memo(oce);function Wnt(e){return Xr(E.useCallback(n=>{if(!e)return n.edges.map(s=>s.id);const r=[];if(n.width&&n.height)for(const s of n.edges){const i=n.nodeLookup.get(s.source),a=n.nodeLookup.get(s.target);i&&a&&Ket({sourceNode:i,targetNode:a,width:n.width,height:n.height,transform:n.transform})&&r.push(s.id)}return r},[e]),fi)}const Hnt=({color:e="none",strokeWidth:t=1})=>f.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Gnt=({color:e="none",strokeWidth:t=1})=>f.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),BH={[yb.Arrow]:Hnt,[yb.ArrowClosed]:Gnt};function Knt(e){const t=ri();return E.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(BH,e)?BH[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",ud.error009(e)),null)},[e])}const Ynt=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:a,orient:o="auto-start-reverse"})=>{const l=Knt(t);return l?f.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:o,refX:"0",refY:"0",children:f.jsx(l,{color:n,strokeWidth:a})}):null},lce=({defaultColor:e,rfId:t})=>{const n=Xr(i=>i.edges),r=Xr(i=>i.defaultEdgeOptions),s=E.useMemo(()=>ntt(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return s.length?f.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:f.jsx("defs",{children:s.map(i=>f.jsx(Ynt,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};lce.displayName="MarkerDefinitions";var Znt=E.memo(lce);function cce({x:e,y:t,label:n,labelStyle:r,labelShowBg:s=!0,labelBgStyle:i,labelBgPadding:a=[2,4],labelBgBorderRadius:o=2,children:l,className:c,...u}){const[d,h]=E.useState({x:1,y:0,width:0,height:0}),p=Yi(["react-flow__edge-textwrapper",c]),g=E.useRef(null);return E.useEffect(()=>{if(g.current){const y=g.current.getBBox();h({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),n?f.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:p,visibility:d.width?"visible":"hidden",...u,children:[s&&f.jsx("rect",{width:d.width+2*a[0],x:-a[0],y:-a[1],height:d.height+2*a[1],className:"react-flow__edge-textbg",style:i,rx:o,ry:o}),f.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:g,style:r,children:n}),l]}):null}cce.displayName="EdgeText";const Xnt=E.memo(cce);function xN({path:e,labelX:t,labelY:n,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:o,labelBgBorderRadius:l,interactionWidth:c=20,...u}){return f.jsxs(f.Fragment,{children:[f.jsx("path",{...u,d:e,fill:"none",className:Yi(["react-flow__edge-path",u.className])}),c&&f.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}),r&&Kc(t)&&Kc(n)?f.jsx(Xnt,{x:t,y:n,label:r,labelStyle:s,labelShowBg:i,labelBgStyle:a,labelBgPadding:o,labelBgBorderRadius:l}):null]})}function zH({pos:e,x1:t,y1:n,x2:r,y2:s}){return e===Vn.Left||e===Vn.Right?[.5*(t+r),n]:[t,.5*(n+s)]}function uce({sourceX:e,sourceY:t,sourcePosition:n=Vn.Bottom,targetX:r,targetY:s,targetPosition:i=Vn.Top}){const[a,o]=zH({pos:n,x1:e,y1:t,x2:r,y2:s}),[l,c]=zH({pos:i,x1:r,y1:s,x2:e,y2:t}),[u,d,h,p]=Ole({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:a,sourceControlY:o,targetControlX:l,targetControlY:c});return[`M${e},${t} C${a},${o} ${l},${c} ${r},${s}`,u,d,h,p]}function dce(e){return E.memo(({id:t,sourceX:n,sourceY:r,targetX:s,targetY:i,sourcePosition:a,targetPosition:o,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:y,markerStart:v,interactionWidth:x})=>{const[w,S,_]=uce({sourceX:n,sourceY:r,sourcePosition:a,targetX:s,targetY:i,targetPosition:o}),k=e.isInternal?void 0:t;return f.jsx(xN,{id:k,path:w,labelX:S,labelY:_,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:y,markerStart:v,interactionWidth:x})})}const Jnt=dce({isInternal:!1}),fce=dce({isInternal:!0});Jnt.displayName="SimpleBezierEdge";fce.displayName="SimpleBezierEdgeInternal";function hce(e){return E.memo(({id:t,sourceX:n,sourceY:r,targetX:s,targetY:i,label:a,labelStyle:o,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,sourcePosition:p=Vn.Bottom,targetPosition:g=Vn.Top,markerEnd:y,markerStart:v,pathOptions:x,interactionWidth:w})=>{const[S,_,k]=TO({sourceX:n,sourceY:r,sourcePosition:p,targetX:s,targetY:i,targetPosition:g,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset}),T=e.isInternal?void 0:t;return f.jsx(xN,{id:T,path:S,labelX:_,labelY:k,label:a,labelStyle:o,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:y,markerStart:v,interactionWidth:w})})}const pce=hce({isInternal:!1}),mce=hce({isInternal:!0});pce.displayName="SmoothStepEdge";mce.displayName="SmoothStepEdgeInternal";function gce(e){return E.memo(({id:t,...n})=>{var s;const r=e.isInternal?void 0:t;return f.jsx(pce,{...n,id:r,pathOptions:E.useMemo(()=>{var i;return{borderRadius:0,offset:(i=n.pathOptions)==null?void 0:i.offset}},[(s=n.pathOptions)==null?void 0:s.offset])})})}const Qnt=gce({isInternal:!1}),yce=gce({isInternal:!0});Qnt.displayName="StepEdge";yce.displayName="StepEdgeInternal";function bce(e){return E.memo(({id:t,sourceX:n,sourceY:r,targetX:s,targetY:i,label:a,labelStyle:o,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:p,markerStart:g,interactionWidth:y})=>{const[v,x,w]=Lle({sourceX:n,sourceY:r,targetX:s,targetY:i}),S=e.isInternal?void 0:t;return f.jsx(xN,{id:S,path:v,labelX:x,labelY:w,label:a,labelStyle:o,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:h,markerEnd:p,markerStart:g,interactionWidth:y})})}const ert=bce({isInternal:!1}),vce=bce({isInternal:!0});ert.displayName="StraightEdge";vce.displayName="StraightEdgeInternal";function xce(e){return E.memo(({id:t,sourceX:n,sourceY:r,targetX:s,targetY:i,sourcePosition:a=Vn.Bottom,targetPosition:o=Vn.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:y,markerStart:v,pathOptions:x,interactionWidth:w})=>{const[S,_,k]=Dle({sourceX:n,sourceY:r,sourcePosition:a,targetX:s,targetY:i,targetPosition:o,curvature:x==null?void 0:x.curvature}),T=e.isInternal?void 0:t;return f.jsx(xN,{id:T,path:S,labelX:_,labelY:k,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:h,labelBgBorderRadius:p,style:g,markerEnd:y,markerStart:v,interactionWidth:w})})}const trt=xce({isInternal:!1}),wce=xce({isInternal:!0});trt.displayName="BezierEdge";wce.displayName="BezierEdgeInternal";const UH={default:wce,straight:vce,step:yce,smoothstep:mce,simplebezier:fce},qH={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},nrt=(e,t,n)=>n===Vn.Left?e-t:n===Vn.Right?e+t:e,rrt=(e,t,n)=>n===Vn.Top?e-t:n===Vn.Bottom?e+t:e,VH="react-flow__edgeupdater";function WH({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:s,onMouseEnter:i,onMouseOut:a,type:o}){return f.jsx("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:a,className:Yi([VH,`${VH}-${o}`]),cx:nrt(t,r,e),cy:rrt(n,r,e),r,stroke:"transparent",fill:"transparent"})}function srt({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:s,targetX:i,targetY:a,sourcePosition:o,targetPosition:l,onReconnect:c,onReconnectStart:u,onReconnectEnd:d,setReconnecting:h,setUpdateHover:p}){const g=ri(),y=(_,k)=>{if(_.button!==0)return;const{autoPanOnConnect:T,domNode:A,isValidConnection:R,connectionMode:M,connectionRadius:j,lib:F,onConnectStart:P,onConnectEnd:q,cancelConnection:I,nodeLookup:V,rfId:D,panBy:z,updateConnection:$}=g.getState(),Y=k.type==="target";h(!0),u==null||u(_,n,k.type);const B=(Z,ne)=>{h(!1),d==null||d(Z,n,k.type,ne)},G=Z=>c==null?void 0:c(n,Z);RO.onPointerDown(_.nativeEvent,{autoPanOnConnect:T,connectionMode:M,connectionRadius:j,domNode:A,handleId:k.id,nodeId:k.nodeId,nodeLookup:V,isTarget:Y,edgeUpdaterType:k.type,lib:F,flowId:D,cancelConnection:I,panBy:z,isValidConnection:R,onConnect:G,onConnectStart:P,onConnectEnd:q,onReconnectEnd:B,updateConnection:$,getTransform:()=>g.getState().transform,getFromHandle:()=>g.getState().connection.fromHandle})},v=_=>y(_,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),x=_=>y(_,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),w=()=>p(!0),S=()=>p(!1);return f.jsxs(f.Fragment,{children:[(e===!0||e==="source")&&f.jsx(WH,{position:o,centerX:r,centerY:s,radius:t,onMouseDown:v,onMouseEnter:w,onMouseOut:S,type:"source"}),(e===!0||e==="target")&&f.jsx(WH,{position:l,centerX:i,centerY:a,radius:t,onMouseDown:x,onMouseEnter:w,onMouseOut:S,type:"target"})]})}function irt({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:s,onDoubleClick:i,onContextMenu:a,onMouseEnter:o,onMouseMove:l,onMouseLeave:c,reconnectRadius:u,onReconnect:d,onReconnectStart:h,onReconnectEnd:p,rfId:g,edgeTypes:y,noPanClassName:v,onError:x,disableKeyboardA11y:w}){let S=Xr(Fe=>Fe.edgeLookup.get(e));const _=Xr(Fe=>Fe.defaultEdgeOptions);S=_?{..._,...S}:S;let k=S.type||"default",T=(y==null?void 0:y[k])||UH[k];T===void 0&&(x==null||x("011",ud.error011(k)),k="default",T=UH.default);const A=!!(S.focusable||t&&typeof S.focusable>"u"),R=typeof d<"u"&&(S.reconnectable||n&&typeof S.reconnectable>"u"),M=!!(S.selectable||r&&typeof S.selectable>"u"),j=E.useRef(null),[F,P]=E.useState(!1),[q,I]=E.useState(!1),V=ri(),{zIndex:D,sourceX:z,sourceY:$,targetX:Y,targetY:B,sourcePosition:G,targetPosition:Z}=Xr(E.useCallback(Fe=>{const Ie=Fe.nodeLookup.get(S.source),X=Fe.nodeLookup.get(S.target);if(!Ie||!X)return{zIndex:S.zIndex,...qH};const ye=ttt({id:e,sourceNode:Ie,targetNode:X,sourceHandle:S.sourceHandle||null,targetHandle:S.targetHandle||null,connectionMode:Fe.connectionMode,onError:x});return{zIndex:Get({selected:S.selected,zIndex:S.zIndex,sourceNode:Ie,targetNode:X,elevateOnSelect:Fe.elevateEdgesOnSelect}),...ye||qH}},[S.source,S.target,S.sourceHandle,S.targetHandle,S.selected,S.zIndex]),fi),ne=E.useMemo(()=>S.markerStart?`url('#${AO(S.markerStart,g)}')`:void 0,[S.markerStart,g]),ae=E.useMemo(()=>S.markerEnd?`url('#${AO(S.markerEnd,g)}')`:void 0,[S.markerEnd,g]);if(S.hidden||z===null||$===null||Y===null||B===null)return null;const le=Fe=>{var Ne;const{addSelectedEdges:Ie,unselectNodesAndEdges:X,multiSelectionActive:ye}=V.getState();M&&(V.setState({nodesSelectionActive:!1}),S.selected&&ye?(X({nodes:[],edges:[S]}),(Ne=j.current)==null||Ne.blur()):Ie([e])),s&&s(Fe,S)},Se=i?Fe=>{i(Fe,{...S})}:void 0,Ee=a?Fe=>{a(Fe,{...S})}:void 0,he=o?Fe=>{o(Fe,{...S})}:void 0,pe=l?Fe=>{l(Fe,{...S})}:void 0,Le=c?Fe=>{c(Fe,{...S})}:void 0,He=Fe=>{var Ie;if(!w&&wle.includes(Fe.key)&&M){const{unselectNodesAndEdges:X,addSelectedEdges:ye}=V.getState();Fe.key==="Escape"?((Ie=j.current)==null||Ie.blur(),X({edges:[S]})):ye([e])}};return f.jsx("svg",{style:{zIndex:D},children:f.jsxs("g",{className:Yi(["react-flow__edge",`react-flow__edge-${k}`,S.className,v,{selected:S.selected,animated:S.animated,inactive:!M&&!s,updating:F,selectable:M}]),onClick:le,onDoubleClick:Se,onContextMenu:Ee,onMouseEnter:he,onMouseMove:pe,onMouseLeave:Le,onKeyDown:A?He:void 0,tabIndex:A?0:void 0,role:S.ariaRole??(A?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":S.ariaLabel===null?void 0:S.ariaLabel||`Edge from ${S.source} to ${S.target}`,"aria-describedby":A?`${Jle}-${g}`:void 0,ref:j,...S.domAttributes,children:[!q&&f.jsx(T,{id:e,source:S.source,target:S.target,type:S.type,selected:S.selected,animated:S.animated,selectable:M,deletable:S.deletable??!0,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,sourceX:z,sourceY:$,targetX:Y,targetY:B,sourcePosition:G,targetPosition:Z,data:S.data,style:S.style,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerStart:ne,markerEnd:ae,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth}),R&&f.jsx(srt,{edge:S,isReconnectable:R,reconnectRadius:u,onReconnect:d,onReconnectStart:h,onReconnectEnd:p,sourceX:z,sourceY:$,targetX:Y,targetY:B,sourcePosition:G,targetPosition:Z,setUpdateHover:P,setReconnecting:I})]})})}const art=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Sce({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:s,onReconnect:i,onEdgeContextMenu:a,onEdgeMouseEnter:o,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:h,onReconnectStart:p,onReconnectEnd:g,disableKeyboardA11y:y}){const{edgesFocusable:v,edgesReconnectable:x,elementsSelectable:w,onError:S}=Xr(art,fi),_=Wnt(t);return f.jsxs("div",{className:"react-flow__edges",children:[f.jsx(Znt,{defaultColor:e,rfId:n}),_.map(k=>f.jsx(irt,{id:k,edgesFocusable:v,edgesReconnectable:x,elementsSelectable:w,noPanClassName:s,onReconnect:i,onContextMenu:a,onMouseEnter:o,onMouseMove:l,onMouseLeave:c,onClick:u,reconnectRadius:d,onDoubleClick:h,onReconnectStart:p,onReconnectEnd:g,rfId:n,onError:S,edgeTypes:r,disableKeyboardA11y:y},k))]})}Sce.displayName="EdgeRenderer";const ort=E.memo(Sce),lrt=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function crt({children:e}){const t=Xr(lrt);return f.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function urt(e){const t=uL(),n=E.useRef(!1);E.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const drt=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function frt(e){const t=Xr(drt),n=ri();return E.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function hrt(e){return e.connection.inProgress?{...e.connection,to:d_(e.connection.to,e.transform)}:{...e.connection}}function prt(e){return hrt}function mrt(e){const t=prt();return Xr(t,fi)}const grt=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function yrt({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:s,width:i,height:a,isValid:o,inProgress:l}=Xr(grt,fi);return!(i&&s&&l)?null:f.jsx("svg",{style:e,width:i,height:a,className:"react-flow__connectionline react-flow__container",children:f.jsx("g",{className:Yi(["react-flow__connection",Cle(o)]),children:f.jsx(_ce,{style:t,type:n,CustomComponent:r,isValid:o})})})}const _ce=({style:e,type:t=qh.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:s,from:i,fromNode:a,fromHandle:o,fromPosition:l,to:c,toNode:u,toHandle:d,toPosition:h}=mrt();if(!s)return;if(n)return f.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:a,fromHandle:o,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:h,connectionStatus:Cle(r),toNode:u,toHandle:d});let p="";const g={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:h};switch(t){case qh.Bezier:[p]=Dle(g);break;case qh.SimpleBezier:[p]=uce(g);break;case qh.Step:[p]=TO({...g,borderRadius:0});break;case qh.SmoothStep:[p]=TO(g);break;default:[p]=Lle(g)}return f.jsx("path",{d:p,fill:"none",className:"react-flow__connection-path",style:e})};_ce.displayName="ConnectionLine";const brt={};function HH(e=brt){E.useRef(e),ri(),E.useEffect(()=>{},[e])}function vrt(){ri(),E.useRef(!1),E.useEffect(()=>{},[])}function Cce({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:s,onNodeDoubleClick:i,onEdgeDoubleClick:a,onNodeMouseEnter:o,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:h,onSelectionEnd:p,connectionLineType:g,connectionLineStyle:y,connectionLineComponent:v,connectionLineContainerStyle:x,selectionKeyCode:w,selectionOnDrag:S,selectionMode:_,multiSelectionKeyCode:k,panActivationKeyCode:T,zoomActivationKeyCode:A,deleteKeyCode:R,onlyRenderVisibleElements:M,elementsSelectable:j,defaultViewport:F,translateExtent:P,minZoom:q,maxZoom:I,preventScrolling:V,defaultMarkerColor:D,zoomOnScroll:z,zoomOnPinch:$,panOnScroll:Y,panOnScrollSpeed:B,panOnScrollMode:G,zoomOnDoubleClick:Z,panOnDrag:ne,onPaneClick:ae,onPaneMouseEnter:le,onPaneMouseMove:Se,onPaneMouseLeave:Ee,onPaneScroll:he,onPaneContextMenu:pe,paneClickDistance:Le,nodeClickDistance:He,onEdgeContextMenu:Fe,onEdgeMouseEnter:Ie,onEdgeMouseMove:X,onEdgeMouseLeave:ye,reconnectRadius:Ne,onReconnect:fe,onReconnectStart:ce,onReconnectEnd:se,noDragClassName:Pe,noWheelClassName:Be,noPanClassName:je,disableKeyboardA11y:ot,nodeExtent:Et,rfId:ut,viewport:Pt,onViewportChange:$t}){return HH(e),HH(t),vrt(),urt(n),frt(Pt),f.jsx(Dnt,{onPaneClick:ae,onPaneMouseEnter:le,onPaneMouseMove:Se,onPaneMouseLeave:Ee,onPaneContextMenu:pe,onPaneScroll:he,paneClickDistance:Le,deleteKeyCode:R,selectionKeyCode:w,selectionOnDrag:S,selectionMode:_,onSelectionStart:h,onSelectionEnd:p,multiSelectionKeyCode:k,panActivationKeyCode:T,zoomActivationKeyCode:A,elementsSelectable:j,zoomOnScroll:z,zoomOnPinch:$,zoomOnDoubleClick:Z,panOnScroll:Y,panOnScrollSpeed:B,panOnScrollMode:G,panOnDrag:ne,defaultViewport:F,translateExtent:P,minZoom:q,maxZoom:I,onSelectionContextMenu:d,preventScrolling:V,noDragClassName:Pe,noWheelClassName:Be,noPanClassName:je,disableKeyboardA11y:ot,onViewportChange:$t,isControlledViewport:!!Pt,children:f.jsxs(crt,{children:[f.jsx(ort,{edgeTypes:t,onEdgeClick:s,onEdgeDoubleClick:a,onReconnect:fe,onReconnectStart:ce,onReconnectEnd:se,onlyRenderVisibleElements:M,onEdgeContextMenu:Fe,onEdgeMouseEnter:Ie,onEdgeMouseMove:X,onEdgeMouseLeave:ye,reconnectRadius:Ne,defaultMarkerColor:D,noPanClassName:je,disableKeyboardA11y:ot,rfId:ut}),f.jsx(yrt,{style:y,type:g,component:v,containerStyle:x}),f.jsx("div",{className:"react-flow__edgelabel-renderer"}),f.jsx(Vnt,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:o,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,nodeClickDistance:He,onlyRenderVisibleElements:M,noPanClassName:je,noDragClassName:Pe,disableKeyboardA11y:ot,nodeExtent:Et,rfId:ut}),f.jsx("div",{className:"react-flow__viewport-portal"})]})})}Cce.displayName="GraphView";const xrt=E.memo(Cce),GH=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:s,height:i,fitView:a,fitViewOptions:o,minZoom:l=.5,maxZoom:c=2,nodeOrigin:u,nodeExtent:d}={})=>{const h=new Map,p=new Map,g=new Map,y=new Map,v=r??t??[],x=n??e??[],w=u??[0,0],S=d??K1;Ble(g,y,v);const _=NO(x,h,p,{nodeOrigin:w,nodeExtent:S,elevateNodesOnSelect:!1});let k=[0,0,1];if(a&&s&&i){const T=u_(h,{filter:j=>!!((j.width||j.initialWidth)&&(j.height||j.initialHeight))}),{x:A,y:R,zoom:M}=sL(T,s,i,l,c,(o==null?void 0:o.padding)??.1);k=[A,R,M]}return{rfId:"1",width:0,height:0,transform:k,nodes:x,nodesInitialized:_,nodeLookup:h,parentLookup:p,edges:v,edgeLookup:y,connectionLookup:g,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:l,maxZoom:c,translateExtent:K1,nodeExtent:S,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:gb.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:w,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:a??!1,fitViewOptions:o,fitViewResolver:null,connection:{..._le},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:zet,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Sle}},wrt=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:s,height:i,fitView:a,fitViewOptions:o,minZoom:l,maxZoom:c,nodeOrigin:u,nodeExtent:d})=>Ltt((h,p)=>{async function g(){const{nodeLookup:y,panZoom:v,fitViewOptions:x,fitViewResolver:w,width:S,height:_,minZoom:k,maxZoom:T}=p();v&&(await $et({nodes:y,width:S,height:_,panZoom:v,minZoom:k,maxZoom:T},x),w==null||w.resolve(!0),h({fitViewResolver:null}))}return{...GH({nodes:e,edges:t,width:s,height:i,fitView:a,fitViewOptions:o,minZoom:l,maxZoom:c,nodeOrigin:u,nodeExtent:d,defaultNodes:n,defaultEdges:r}),setNodes:y=>{const{nodeLookup:v,parentLookup:x,nodeOrigin:w,elevateNodesOnSelect:S,fitViewQueued:_}=p(),k=NO(y,v,x,{nodeOrigin:w,nodeExtent:d,elevateNodesOnSelect:S,checkEquality:!0});_&&k?(g(),h({nodes:y,nodesInitialized:k,fitViewQueued:!1,fitViewOptions:void 0})):h({nodes:y,nodesInitialized:k})},setEdges:y=>{const{connectionLookup:v,edgeLookup:x}=p();Ble(v,x,y),h({edges:y})},setDefaultNodesAndEdges:(y,v)=>{if(y){const{setNodes:x}=p();x(y),h({hasDefaultNodes:!0})}if(v){const{setEdges:x}=p();x(v),h({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:v,nodeLookup:x,parentLookup:w,domNode:S,nodeOrigin:_,nodeExtent:k,debug:T,fitViewQueued:A}=p(),{changes:R,updatedInternals:M}=ott(y,x,w,S,_,k);M&&(stt(x,w,{nodeOrigin:_,nodeExtent:k}),A?(g(),h({fitViewQueued:!1,fitViewOptions:void 0})):h({}),(R==null?void 0:R.length)>0&&(T&&console.log("React Flow: trigger node changes",R),v==null||v(R)))},updateNodePositions:(y,v=!1)=>{const x=[],w=[],{nodeLookup:S,triggerNodeChanges:_}=p();for(const[k,T]of y){const A=S.get(k),R=!!(A!=null&&A.expandParent&&(A!=null&&A.parentId)&&(T!=null&&T.position)),M={id:k,type:"position",position:R?{x:Math.max(0,T.position.x),y:Math.max(0,T.position.y)}:T.position,dragging:v};R&&A.parentId&&x.push({id:k,parentId:A.parentId,rect:{...T.internals.positionAbsolute,width:T.measured.width??0,height:T.measured.height??0}}),w.push(M)}if(x.length>0){const{parentLookup:k,nodeOrigin:T}=p(),A=cL(x,S,k,T);w.push(...A)}_(w)},triggerNodeChanges:y=>{const{onNodesChange:v,setNodes:x,nodes:w,hasDefaultNodes:S,debug:_}=p();if(y!=null&&y.length){if(S){const k=ant(y,w);x(k)}_&&console.log("React Flow: trigger node changes",y),v==null||v(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:v,setEdges:x,edges:w,hasDefaultEdges:S,debug:_}=p();if(y!=null&&y.length){if(S){const k=ont(y,w);x(k)}_&&console.log("React Flow: trigger edge changes",y),v==null||v(y)}},addSelectedNodes:y=>{const{multiSelectionActive:v,edgeLookup:x,nodeLookup:w,triggerNodeChanges:S,triggerEdgeChanges:_}=p();if(v){const k=y.map(T=>km(T,!0));S(k);return}S(hy(w,new Set([...y]),!0)),_(hy(x))},addSelectedEdges:y=>{const{multiSelectionActive:v,edgeLookup:x,nodeLookup:w,triggerNodeChanges:S,triggerEdgeChanges:_}=p();if(v){const k=y.map(T=>km(T,!0));_(k);return}_(hy(x,new Set([...y]))),S(hy(w,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:v}={})=>{const{edges:x,nodes:w,nodeLookup:S,triggerNodeChanges:_,triggerEdgeChanges:k}=p(),T=y||w,A=v||x,R=T.map(j=>{const F=S.get(j.id);return F&&(F.selected=!1),km(j.id,!1)}),M=A.map(j=>km(j.id,!1));_(R),k(M)},setMinZoom:y=>{const{panZoom:v,maxZoom:x}=p();v==null||v.setScaleExtent([y,x]),h({minZoom:y})},setMaxZoom:y=>{const{panZoom:v,minZoom:x}=p();v==null||v.setScaleExtent([x,y]),h({maxZoom:y})},setTranslateExtent:y=>{var v;(v=p().panZoom)==null||v.setTranslateExtent(y),h({translateExtent:y})},setPaneClickDistance:y=>{var v;(v=p().panZoom)==null||v.setClickDistance(y)},resetSelectedElements:()=>{const{edges:y,nodes:v,triggerNodeChanges:x,triggerEdgeChanges:w,elementsSelectable:S}=p();if(!S)return;const _=v.reduce((T,A)=>A.selected?[...T,km(A.id,!1)]:T,[]),k=y.reduce((T,A)=>A.selected?[...T,km(A.id,!1)]:T,[]);x(_),w(k)},setNodeExtent:y=>{const{nodes:v,nodeLookup:x,parentLookup:w,nodeOrigin:S,elevateNodesOnSelect:_,nodeExtent:k}=p();y[0][0]===k[0][0]&&y[0][1]===k[0][1]&&y[1][0]===k[1][0]&&y[1][1]===k[1][1]||(NO(v,x,w,{nodeOrigin:S,nodeExtent:y,elevateNodesOnSelect:_,checkEquality:!1}),h({nodeExtent:y}))},panBy:y=>{const{transform:v,width:x,height:w,panZoom:S,translateExtent:_}=p();return ltt({delta:y,panZoom:S,transform:v,translateExtent:_,width:x,height:w})},setCenter:async(y,v,x)=>{const{width:w,height:S,maxZoom:_,panZoom:k}=p();if(!k)return Promise.resolve(!1);const T=typeof(x==null?void 0:x.zoom)<"u"?x.zoom:_;return await k.setViewport({x:w/2-y*T,y:S/2-v*T,zoom:T},{duration:x==null?void 0:x.duration,ease:x==null?void 0:x.ease,interpolate:x==null?void 0:x.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{h({connection:{..._le}})},updateConnection:y=>{h({connection:y})},reset:()=>h({...GH()})}},Object.is);function Srt({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:s,initialHeight:i,initialMinZoom:a,initialMaxZoom:o,initialFitViewOptions:l,fitView:c,nodeOrigin:u,nodeExtent:d,children:h}){const[p]=E.useState(()=>wrt({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:s,height:i,fitView:c,minZoom:a,maxZoom:o,fitViewOptions:l,nodeOrigin:u,nodeExtent:d}));return f.jsx($tt,{value:p,children:f.jsx(dnt,{children:h})})}function _rt({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:s,width:i,height:a,fitView:o,fitViewOptions:l,minZoom:c,maxZoom:u,nodeOrigin:d,nodeExtent:h}){return E.useContext(yN)?f.jsx(f.Fragment,{children:e}):f.jsx(Srt,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:s,initialWidth:i,initialHeight:a,fitView:o,initialFitViewOptions:l,initialMinZoom:c,initialMaxZoom:u,nodeOrigin:d,nodeExtent:h,children:e})}const Crt={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function krt({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:s,nodeTypes:i,edgeTypes:a,onNodeClick:o,onEdgeClick:l,onInit:c,onMove:u,onMoveStart:d,onMoveEnd:h,onConnect:p,onConnectStart:g,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:x,onNodeMouseEnter:w,onNodeMouseMove:S,onNodeMouseLeave:_,onNodeContextMenu:k,onNodeDoubleClick:T,onNodeDragStart:A,onNodeDrag:R,onNodeDragStop:M,onNodesDelete:j,onEdgesDelete:F,onDelete:P,onSelectionChange:q,onSelectionDragStart:I,onSelectionDrag:V,onSelectionDragStop:D,onSelectionContextMenu:z,onSelectionStart:$,onSelectionEnd:Y,onBeforeDelete:B,connectionMode:G,connectionLineType:Z=qh.Bezier,connectionLineStyle:ne,connectionLineComponent:ae,connectionLineContainerStyle:le,deleteKeyCode:Se="Backspace",selectionKeyCode:Ee="Shift",selectionOnDrag:he=!1,selectionMode:pe=Y1.Full,panActivationKeyCode:Le="Space",multiSelectionKeyCode:He=KE()?"Meta":"Control",zoomActivationKeyCode:Fe=KE()?"Meta":"Control",snapToGrid:Ie,snapGrid:X,onlyRenderVisibleElements:ye=!1,selectNodesOnDrag:Ne,nodesDraggable:fe,autoPanOnNodeFocus:ce,nodesConnectable:se,nodesFocusable:Pe,nodeOrigin:Be=Qle,edgesFocusable:je,edgesReconnectable:ot,elementsSelectable:Et=!0,defaultViewport:ut=Qtt,minZoom:Pt=.5,maxZoom:$t=2,translateExtent:Ft=K1,preventScrolling:Ht=!0,nodeExtent:Ce,defaultMarkerColor:U="#b1b1b7",zoomOnScroll:ee=!0,zoomOnPinch:xe=!0,panOnScroll:Re=!1,panOnScrollSpeed:ve=.5,panOnScrollMode:Me=Ym.Free,zoomOnDoubleClick:de=!0,panOnDrag:ht=!0,onPaneClick:et,onPaneMouseEnter:W,onPaneMouseMove:Ve,onPaneMouseLeave:tt,onPaneScroll:we,onPaneContextMenu:Te,paneClickDistance:Ue=0,nodeClickDistance:Ct=0,children:me,onReconnect:Q,onReconnectStart:J,onReconnectEnd:te,onEdgeContextMenu:_e,onEdgeDoubleClick:$e,onEdgeMouseEnter:Ge,onEdgeMouseMove:wt,onEdgeMouseLeave:Jt,reconnectRadius:jn=10,onNodesChange:Gt,onEdgesChange:rn,noDragClassName:dn="nodrag",noWheelClassName:br="nowheel",noPanClassName:Cr="nopan",fitView:Jr,fitViewOptions:Qr,connectOnClick:Sr,attributionPosition:mn,proOptions:nt,defaultEdgeOptions:Vt,elevateNodesOnSelect:gn,elevateEdgesOnSelect:tr,disableKeyboardA11y:ps=!1,autoPanOnConnect:es,autoPanOnNodeDrag:xi,autoPanSpeed:si,connectionRadius:Ea,isValidConnection:Zi,onError:$s,style:fo,id:ho,nodeDragThreshold:hu,viewport:Gf,onViewportChange:Fr,width:qp,height:Ta,colorMode:Vp="light",debug:Ss,onScroll:po,ariaLabelConfig:pu,...hl},Wp){const Di=ho||"1",mu=rnt(Vp),Hp=E.useCallback(Rc=>{Rc.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),po==null||po(Rc)},[po]);return f.jsx("div",{"data-testid":"rf__wrapper",...hl,onScroll:Hp,style:{...fo,...Crt},ref:Wp,className:Yi(["react-flow",s,mu]),id:ho,role:"application",children:f.jsxs(_rt,{nodes:e,edges:t,width:qp,height:Ta,fitView:Jr,fitViewOptions:Qr,minZoom:Pt,maxZoom:$t,nodeOrigin:Be,nodeExtent:Ce,children:[f.jsx(xrt,{onInit:c,onNodeClick:o,onEdgeClick:l,onNodeMouseEnter:w,onNodeMouseMove:S,onNodeMouseLeave:_,onNodeContextMenu:k,onNodeDoubleClick:T,nodeTypes:i,edgeTypes:a,connectionLineType:Z,connectionLineStyle:ne,connectionLineComponent:ae,connectionLineContainerStyle:le,selectionKeyCode:Ee,selectionOnDrag:he,selectionMode:pe,deleteKeyCode:Se,multiSelectionKeyCode:He,panActivationKeyCode:Le,zoomActivationKeyCode:Fe,onlyRenderVisibleElements:ye,defaultViewport:ut,translateExtent:Ft,minZoom:Pt,maxZoom:$t,preventScrolling:Ht,zoomOnScroll:ee,zoomOnPinch:xe,zoomOnDoubleClick:de,panOnScroll:Re,panOnScrollSpeed:ve,panOnScrollMode:Me,panOnDrag:ht,onPaneClick:et,onPaneMouseEnter:W,onPaneMouseMove:Ve,onPaneMouseLeave:tt,onPaneScroll:we,onPaneContextMenu:Te,paneClickDistance:Ue,nodeClickDistance:Ct,onSelectionContextMenu:z,onSelectionStart:$,onSelectionEnd:Y,onReconnect:Q,onReconnectStart:J,onReconnectEnd:te,onEdgeContextMenu:_e,onEdgeDoubleClick:$e,onEdgeMouseEnter:Ge,onEdgeMouseMove:wt,onEdgeMouseLeave:Jt,reconnectRadius:jn,defaultMarkerColor:U,noDragClassName:dn,noWheelClassName:br,noPanClassName:Cr,rfId:Di,disableKeyboardA11y:ps,nodeExtent:Ce,viewport:Gf,onViewportChange:Fr}),f.jsx(nnt,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:p,onConnectStart:g,onConnectEnd:y,onClickConnectStart:v,onClickConnectEnd:x,nodesDraggable:fe,autoPanOnNodeFocus:ce,nodesConnectable:se,nodesFocusable:Pe,edgesFocusable:je,edgesReconnectable:ot,elementsSelectable:Et,elevateNodesOnSelect:gn,elevateEdgesOnSelect:tr,minZoom:Pt,maxZoom:$t,nodeExtent:Ce,onNodesChange:Gt,onEdgesChange:rn,snapToGrid:Ie,snapGrid:X,connectionMode:G,translateExtent:Ft,connectOnClick:Sr,defaultEdgeOptions:Vt,fitView:Jr,fitViewOptions:Qr,onNodesDelete:j,onEdgesDelete:F,onDelete:P,onNodeDragStart:A,onNodeDrag:R,onNodeDragStop:M,onSelectionDrag:V,onSelectionDragStart:I,onSelectionDragStop:D,onMove:u,onMoveStart:d,onMoveEnd:h,noPanClassName:Cr,nodeOrigin:Be,rfId:Di,autoPanOnConnect:es,autoPanOnNodeDrag:xi,autoPanSpeed:si,onError:$s,connectionRadius:Ea,isValidConnection:Zi,selectNodesOnDrag:Ne,nodeDragThreshold:hu,onBeforeDelete:B,paneClickDistance:Ue,debug:Ss,ariaLabelConfig:pu}),f.jsx(Jtt,{onSelectionChange:q}),me,f.jsx(Gtt,{proOptions:nt,position:mn}),f.jsx(Wtt,{rfId:Di,disableKeyboardA11y:ps})]})})}var kce=tce(krt);function Ert({dimensions:e,lineWidth:t,variant:n,className:r}){return f.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Yi(["react-flow__background-pattern",n,r])})}function Trt({radius:e,className:t}){return f.jsx("circle",{cx:e,cy:e,r:e,className:Yi(["react-flow__background-pattern","dots",t])})}var nd;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(nd||(nd={}));const Art={[nd.Dots]:1,[nd.Lines]:1,[nd.Cross]:6},Nrt=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Ece({id:e,variant:t=nd.Dots,gap:n=20,size:r,lineWidth:s=1,offset:i=0,color:a,bgColor:o,style:l,className:c,patternClassName:u}){const d=E.useRef(null),{transform:h,patternId:p}=Xr(Nrt,fi),g=r||Art[t],y=t===nd.Dots,v=t===nd.Cross,x=Array.isArray(n)?n:[n,n],w=[x[0]*h[2]||1,x[1]*h[2]||1],S=g*h[2],_=Array.isArray(i)?i:[i,i],k=v?[S,S]:w,T=[_[0]*h[2]||1+k[0]/2,_[1]*h[2]||1+k[1]/2],A=`${p}${e||""}`;return f.jsxs("svg",{className:Yi(["react-flow__background",c]),style:{...l,...vN,"--xy-background-color-props":o,"--xy-background-pattern-color-props":a},ref:d,"data-testid":"rf__background",children:[f.jsx("pattern",{id:A,x:h[0]%w[0],y:h[1]%w[1],width:w[0],height:w[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${T[0]},-${T[1]})`,children:y?f.jsx(Trt,{radius:S/2,className:u}):f.jsx(Ert,{dimensions:k,lineWidth:s,variant:t,className:u})}),f.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${A})`})]})}Ece.displayName="Background";const Tce=E.memo(Ece);function Rrt(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:f.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Irt(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:f.jsx("path",{d:"M0 0h32v4.2H0z"})})}function Mrt(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:f.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function jrt(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:f.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Prt(){return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:f.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function E2({children:e,className:t,...n}){return f.jsx("button",{type:"button",className:Yi(["react-flow__controls-button",t]),...n,children:e})}const Ort=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function Ace({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:a,onFitView:o,onInteractiveChange:l,className:c,children:u,position:d="bottom-left",orientation:h="vertical","aria-label":p}){const g=ri(),{isInteractive:y,minZoomReached:v,maxZoomReached:x,ariaLabelConfig:w}=Xr(Ort,fi),{zoomIn:S,zoomOut:_,fitView:k}=uL(),T=()=>{S(),i==null||i()},A=()=>{_(),a==null||a()},R=()=>{k(s),o==null||o()},M=()=>{g.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),l==null||l(!y)},j=h==="horizontal"?"horizontal":"vertical";return f.jsxs(bN,{className:Yi(["react-flow__controls",j,c]),position:d,style:e,"data-testid":"rf__controls","aria-label":p??w["controls.ariaLabel"],children:[t&&f.jsxs(f.Fragment,{children:[f.jsx(E2,{onClick:T,className:"react-flow__controls-zoomin",title:w["controls.zoomIn.ariaLabel"],"aria-label":w["controls.zoomIn.ariaLabel"],disabled:x,children:f.jsx(Rrt,{})}),f.jsx(E2,{onClick:A,className:"react-flow__controls-zoomout",title:w["controls.zoomOut.ariaLabel"],"aria-label":w["controls.zoomOut.ariaLabel"],disabled:v,children:f.jsx(Irt,{})})]}),n&&f.jsx(E2,{className:"react-flow__controls-fitview",onClick:R,title:w["controls.fitView.ariaLabel"],"aria-label":w["controls.fitView.ariaLabel"],children:f.jsx(Mrt,{})}),r&&f.jsx(E2,{className:"react-flow__controls-interactive",onClick:M,title:w["controls.interactive.ariaLabel"],"aria-label":w["controls.interactive.ariaLabel"],children:y?f.jsx(Prt,{}):f.jsx(jrt,{})}),u]})}Ace.displayName="Controls";const Nce=E.memo(Ace);function Drt({id:e,x:t,y:n,width:r,height:s,style:i,color:a,strokeColor:o,strokeWidth:l,className:c,borderRadius:u,shapeRendering:d,selected:h,onClick:p}){const{background:g,backgroundColor:y}=i||{},v=a||g||y;return f.jsx("rect",{className:Yi(["react-flow__minimap-node",{selected:h},c]),x:t,y:n,rx:u,ry:u,width:r,height:s,style:{fill:v,stroke:o,strokeWidth:l},shapeRendering:d,onClick:p?x=>p(x,e):void 0})}const Frt=E.memo(Drt),Lrt=e=>e.nodes.map(t=>t.id),eP=e=>e instanceof Function?e:()=>e;function $rt({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:s,nodeComponent:i=Frt,onClick:a}){const o=Xr(Lrt,fi),l=eP(t),c=eP(e),u=eP(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return f.jsx(f.Fragment,{children:o.map(h=>f.jsx(zrt,{id:h,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:s,NodeComponent:i,onClick:a,shapeRendering:d},h))})}function Brt({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:s,nodeStrokeWidth:i,shapeRendering:a,NodeComponent:o,onClick:l}){const{node:c,x:u,y:d,width:h,height:p}=Xr(g=>{const{internals:y}=g.nodeLookup.get(e),v=y.userNode,{x,y:w}=y.positionAbsolute,{width:S,height:_}=qf(v);return{node:v,x,y:w,width:S,height:_}},fi);return!c||c.hidden||!Rle(c)?null:f.jsx(o,{x:u,y:d,width:h,height:p,style:c.style,selected:!!c.selected,className:r(c),color:t(c),borderRadius:s,strokeColor:n(c),strokeWidth:i,shapeRendering:a,onClick:l,id:c.id})}const zrt=E.memo(Brt);var Urt=E.memo($rt);const qrt=200,Vrt=150,Wrt=e=>!e.hidden,Hrt=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Nle(u_(e.nodeLookup,{filter:Wrt}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Grt="react-flow__minimap-desc";function Rce({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:a,nodeComponent:o,bgColor:l,maskColor:c,maskStrokeColor:u,maskStrokeWidth:d,position:h="bottom-right",onClick:p,onNodeClick:g,pannable:y=!1,zoomable:v=!1,ariaLabel:x,inversePan:w,zoomStep:S=10,offsetScale:_=5}){const k=ri(),T=E.useRef(null),{boundingRect:A,viewBB:R,rfId:M,panZoom:j,translateExtent:F,flowWidth:P,flowHeight:q,ariaLabelConfig:I}=Xr(Hrt,fi),V=(e==null?void 0:e.width)??qrt,D=(e==null?void 0:e.height)??Vrt,z=A.width/V,$=A.height/D,Y=Math.max(z,$),B=Y*V,G=Y*D,Z=_*Y,ne=A.x-(B-A.width)/2-Z,ae=A.y-(G-A.height)/2-Z,le=B+Z*2,Se=G+Z*2,Ee=`${Grt}-${M}`,he=E.useRef(0),pe=E.useRef();he.current=Y,E.useEffect(()=>{if(T.current&&j)return pe.current=gtt({domNode:T.current,panZoom:j,getTransform:()=>k.getState().transform,getViewScale:()=>he.current}),()=>{var Ie;(Ie=pe.current)==null||Ie.destroy()}},[j]),E.useEffect(()=>{var Ie;(Ie=pe.current)==null||Ie.update({translateExtent:F,width:P,height:q,inversePan:w,pannable:y,zoomStep:S,zoomable:v})},[y,v,w,S,F,P,q]);const Le=p?Ie=>{var Ne;const[X,ye]=((Ne=pe.current)==null?void 0:Ne.pointer(Ie))||[0,0];p(Ie,{x:X,y:ye})}:void 0,He=g?E.useCallback((Ie,X)=>{const ye=k.getState().nodeLookup.get(X).internals.userNode;g(Ie,ye)},[]):void 0,Fe=x??I["minimap.ariaLabel"];return f.jsx(bN,{position:h,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*Y:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof a=="number"?a:void 0},className:Yi(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:f.jsxs("svg",{width:V,height:D,viewBox:`${ne} ${ae} ${le} ${Se}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Ee,ref:T,onClick:Le,children:[Fe&&f.jsx("title",{id:Ee,children:Fe}),f.jsx(Urt,{onClick:He,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:a,nodeComponent:o}),f.jsx("path",{className:"react-flow__minimap-mask",d:`M${ne-Z},${ae-Z}h${le+Z*2}v${Se+Z*2}h${-le-Z*2}z
        M${R.x},${R.y}h${R.width}v${R.height}h${-R.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Rce.displayName="MiniMap";const Ice=E.memo(Rce),Krt=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Yrt={[wb.Line]:"right",[wb.Handle]:"bottom-right"};function Zrt({nodeId:e,position:t,variant:n=wb.Handle,className:r,style:s=void 0,children:i,color:a,minWidth:o=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:h,autoScale:p=!0,shouldResize:g,onResizeStart:y,onResize:v,onResizeEnd:x}){const w=ice(),S=typeof e=="string"?e:w,_=ri(),k=E.useRef(null),T=n===wb.Handle,A=Xr(E.useCallback(Krt(T&&p),[T,p]),fi),R=E.useRef(null),M=t??Yrt[n];E.useEffect(()=>{if(!(!k.current||!S))return R.current||(R.current=Mtt({domNode:k.current,nodeId:S,getStoreItems:()=>{const{nodeLookup:F,transform:P,snapGrid:q,snapToGrid:I,nodeOrigin:V,domNode:D}=_.getState();return{nodeLookup:F,transform:P,snapGrid:q,snapToGrid:I,nodeOrigin:V,paneDomNode:D}},onChange:(F,P)=>{const{triggerNodeChanges:q,nodeLookup:I,parentLookup:V,nodeOrigin:D}=_.getState(),z=[],$={x:F.x,y:F.y},Y=I.get(S);if(Y&&Y.expandParent&&Y.parentId){const B=Y.origin??D,G=F.width??Y.measured.width??0,Z=F.height??Y.measured.height??0,ne={id:Y.id,parentId:Y.parentId,rect:{width:G,height:Z,...Ile({x:F.x??Y.position.x,y:F.y??Y.position.y},{width:G,height:Z},Y.parentId,I,B)}},ae=cL([ne],I,V,D);z.push(...ae),$.x=F.x?Math.max(B[0]*G,F.x):void 0,$.y=F.y?Math.max(B[1]*Z,F.y):void 0}if($.x!==void 0&&$.y!==void 0){const B={id:S,type:"position",position:{...$}};z.push(B)}if(F.width!==void 0&&F.height!==void 0){const G={id:S,type:"dimensions",resizing:!0,setAttributes:h?h==="horizontal"?"width":"height":!0,dimensions:{width:F.width,height:F.height}};z.push(G)}for(const B of P){const G={...B,type:"position"};z.push(G)}q(z)},onEnd:({width:F,height:P})=>{const q={id:S,type:"dimensions",resizing:!1,dimensions:{width:F,height:P}};_.getState().triggerNodeChanges([q])}})),R.current.update({controlPosition:M,boundaries:{minWidth:o,minHeight:l,maxWidth:c,maxHeight:u},keepAspectRatio:d,resizeDirection:h,onResizeStart:y,onResize:v,onResizeEnd:x,shouldResize:g}),()=>{var F;(F=R.current)==null||F.destroy()}},[M,o,l,c,u,d,y,v,x,g]);const j=M.split("-");return f.jsx("div",{className:Yi(["react-flow__resize-control","nodrag",...j,n,r]),ref:k,style:{...s,scale:A,...a&&{[T?"backgroundColor":"borderColor"]:a}},children:i})}E.memo(Zrt);const Xrt=400,Jrt=({data:e})=>{const t=(r,s)=>{if(s)switch(s){case"running":return"bg-blue-50 border-blue-400 text-blue-900 shadow-lg shadow-blue-200";case"success":return"bg-green-50 border-green-400 text-green-900 shadow-lg shadow-green-200";case"error":return"bg-red-50 border-red-400 text-red-900 shadow-lg shadow-red-200";case"pending":return"bg-gray-50 border-gray-300 text-gray-700 shadow-lg shadow-gray-200"}switch(r){case"initial":return"bg-indigo-100 border-indigo-400 text-indigo-900 shadow-sm";case"prompt":return"bg-green-100 border-green-400 text-green-900 shadow-sm";case"agent-task":return"bg-purple-100 border-purple-400 text-purple-900 shadow-sm";case"transform":return"bg-yellow-100 border-yellow-400 text-yellow-900 shadow-sm";case"human-in-the-loop":return"bg-orange-100 border-orange-400 text-orange-900 shadow-sm";default:return"bg-gray-100 border-gray-400 text-gray-900 shadow-sm"}},n=(r,s)=>{if(s)switch(s){case"running":return"";case"success":return"";case"error":return"";case"pending":return""}switch(r){case"initial":return"";case"prompt":return"";case"agent-task":return"";case"transform":return"";case"human-in-the-loop":return"";default:return""}};return f.jsxs("div",{className:Ye("px-4 py-3 rounded-lg border-2 min-w-[200px] max-w-[280px]",t(e.type,e.status)),children:[f.jsx(gp,{type:"target",position:Vn.Left,id:"input",className:"!bg-gray-700"}),f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-lg",children:n(e.type,e.status)}),f.jsx("span",{className:"font-semibold text-sm",children:e.stepName||e.name}),e.status&&f.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white/60 font-medium capitalize",children:e.status})]}),e.templateName&&e.type!=="transform"&&f.jsx("div",{className:"text-sm font-medium mb-1 text-slate-700",children:e.templateName}),e.type==="transform"&&f.jsx("div",{className:"text-sm font-medium mb-1 text-slate-700",children:"Data Transform"}),e.modelName&&e.type!=="transform"&&f.jsx("div",{className:"text-xs opacity-75 font-mono bg-white/50 px-2 py-1 rounded",children:e.modelName}),f.jsx(gp,{type:"source",position:Vn.Right,id:"output",className:"!bg-gray-700"})]})},Qrt={workflowStep:Jrt},est=({workflow:e,className:t,initialStepData:n,stepDisplayData:r,stepStatuses:s={}})=>{const{nodes:i,edges:a}=E.useMemo(()=>{const o=[],l=[];return o.push({id:"initial",type:"workflowStep",position:{x:0,y:0},data:{stepName:n.stepName,templateName:n.templateName,type:"initial",modelName:n.modelName,status:s.initial}}),e.steps&&e.steps.length>0&&e.steps.forEach((c,u)=>{const d=(u+1)*Xrt,h=r[u]||{stepName:c.name||"Unnamed Step",templateName:void 0,modelName:void 0,type:c.type};o.push({id:c.id,type:"workflowStep",position:{x:d,y:0},data:{stepName:h.stepName,templateName:h.templateName,type:h.type,modelName:h.modelName,status:s[c.id]}});const p=u===0?"initial":e.steps[u-1].id;l.push({id:`${p}-${c.id}`,source:p,target:c.id,sourceHandle:"output",targetHandle:"input",type:"smoothstep",animated:!0,style:{stroke:"#1f2937",strokeWidth:3},markerEnd:{type:yb.ArrowClosed,color:"#1f2937",width:18,height:18}})}),{nodes:o,edges:l}},[e,n,r,s]);return!e.steps||e.steps.length===0?f.jsx("div",{className:Ye("flex items-center justify-center h-full border-2 border-dashed border-border rounded-lg",t),children:f.jsxs("div",{className:"text-center text-muted-foreground",children:[f.jsx("div",{className:"text-4xl mb-2",children:""}),f.jsx("div",{className:"text-lg font-medium",children:"No workflow steps"}),f.jsx("div",{className:"text-sm",children:"Add steps to see the workflow visualization"})]})}):f.jsx("div",{className:Ye("h-full w-full relative",t),children:f.jsxs(kce,{nodes:i,edges:a,nodeTypes:Qrt,fitView:!0,fitViewOptions:{padding:50,maxZoom:2.25,minZoom:.15},proOptions:{hideAttribution:!0},nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!0,zoomOnScroll:!0,panOnScroll:!1,zoomOnDoubleClick:!0,panOnDrag:!0,className:"bg-background",children:[f.jsx(Ice,{nodeColor:o=>{var l,c;if((l=o.data)!=null&&l.status)switch(o.data.status){case"running":return"#3b82f6";case"success":return"#10b981";case"error":return"#ef4444";case"pending":return"#6b7280"}switch((c=o.data)==null?void 0:c.type){case"initial":return"#6366f1";case"prompt":return"#10b981";case"agent-task":return"#8b5cf6";case"human-in-the-loop":return"#f59e0b";default:return"#6b7280"}},position:"bottom-right",style:{width:120,height:80}}),f.jsx(Nce,{position:"top-left",showInteractive:!1}),f.jsx(Tce,{variant:nd.Dots,gap:20,size:2})]})})};var Ho={},KH;function tst(){if(KH)return Ho;KH=1;var e=Ho&&Ho.__assign||function(){return e=Object.assign||function(k){for(var T,A=1,R=arguments.length;A<R;A++){T=arguments[A];for(var M in T)Object.prototype.hasOwnProperty.call(T,M)&&(k[M]=T[M])}return k},e.apply(this,arguments)},t=Ho&&Ho.__createBinding||(Object.create?function(k,T,A,R){R===void 0&&(R=A);var M=Object.getOwnPropertyDescriptor(T,A);(!M||("get"in M?!T.__esModule:M.writable||M.configurable))&&(M={enumerable:!0,get:function(){return T[A]}}),Object.defineProperty(k,R,M)}:function(k,T,A,R){R===void 0&&(R=A),k[R]=T[A]}),n=Ho&&Ho.__setModuleDefault||(Object.create?function(k,T){Object.defineProperty(k,"default",{enumerable:!0,value:T})}:function(k,T){k.default=T}),r=Ho&&Ho.__importStar||function(k){if(k&&k.__esModule)return k;var T={};if(k!=null)for(var A in k)A!=="default"&&Object.prototype.hasOwnProperty.call(k,A)&&t(T,k,A);return n(T,k),T},s=Ho&&Ho.__rest||function(k,T){var A={};for(var R in k)Object.prototype.hasOwnProperty.call(k,R)&&T.indexOf(R)<0&&(A[R]=k[R]);if(k!=null&&typeof Object.getOwnPropertySymbols=="function")for(var M=0,R=Object.getOwnPropertySymbols(k);M<R.length;M++)T.indexOf(R[M])<0&&Object.prototype.propertyIsEnumerable.call(k,R[M])&&(A[R[M]]=k[R[M]]);return A};Object.defineProperty(Ho,"__esModule",{value:!0});var i=r(Ib()),a=89,o=90,l=77,c=57,u=219,d=222,h=192,p=100,g=3e3,y=typeof window<"u"&&"navigator"in window&&/Win/i.test(navigator.platform),v=typeof window<"u"&&"navigator"in window&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),x="npm__react-simple-code-editor__textarea",w=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`.concat(x,`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`).concat(x,` {
    color: transparent !important;
  }

  .`).concat(x,`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`),S=i.forwardRef(function(T,A){var R=T.autoFocus,M=T.disabled,j=T.form,F=T.highlight,P=T.ignoreTabKey,q=P===void 0?!1:P,I=T.insertSpaces,V=I===void 0?!0:I,D=T.maxLength,z=T.minLength,$=T.name,Y=T.onBlur,B=T.onClick,G=T.onFocus,Z=T.onKeyDown,ne=T.onKeyUp,ae=T.onValueChange,le=T.padding,Se=le===void 0?0:le,Ee=T.placeholder,he=T.preClassName,pe=T.readOnly,Le=T.required,He=T.style,Fe=T.tabSize,Ie=Fe===void 0?2:Fe,X=T.textareaClassName,ye=T.textareaId,Ne=T.value,fe=s(T,["autoFocus","disabled","form","highlight","ignoreTabKey","insertSpaces","maxLength","minLength","name","onBlur","onClick","onFocus","onKeyDown","onKeyUp","onValueChange","padding","placeholder","preClassName","readOnly","required","style","tabSize","textareaClassName","textareaId","value"]),ce=i.useRef({stack:[],offset:-1}),se=i.useRef(null),Pe=i.useState(!0),Be=Pe[0],je=Pe[1],ot={paddingTop:typeof Se=="object"?Se.top:Se,paddingRight:typeof Se=="object"?Se.right:Se,paddingBottom:typeof Se=="object"?Se.bottom:Se,paddingLeft:typeof Se=="object"?Se.left:Se},Et=F(Ne),ut=function(Re,ve){return Re.substring(0,ve).split(`
`)},Pt=i.useCallback(function(Re,ve){var Me,de,ht;ve===void 0&&(ve=!1);var et=ce.current,W=et.stack,Ve=et.offset;if(W.length&&Ve>-1){ce.current.stack=W.slice(0,Ve+1);var tt=ce.current.stack.length;if(tt>p){var we=tt-p;ce.current.stack=W.slice(we,tt),ce.current.offset=Math.max(ce.current.offset-we,0)}}var Te=Date.now();if(ve){var Ue=ce.current.stack[ce.current.offset];if(Ue&&Te-Ue.timestamp<g){var Ct=/[^a-z0-9]([a-z0-9]+)$/i,me=(Me=ut(Ue.value,Ue.selectionStart).pop())===null||Me===void 0?void 0:Me.match(Ct),Q=(de=ut(Re.value,Re.selectionStart).pop())===null||de===void 0?void 0:de.match(Ct);if(me!=null&&me[1]&&(!((ht=Q==null?void 0:Q[1])===null||ht===void 0)&&ht.startsWith(me[1]))){ce.current.stack[ce.current.offset]=e(e({},Re),{timestamp:Te});return}}}ce.current.stack.push(e(e({},Re),{timestamp:Te})),ce.current.offset++},[]),$t=i.useCallback(function(){var Re=se.current;if(Re){var ve=Re.value,Me=Re.selectionStart,de=Re.selectionEnd;Pt({value:ve,selectionStart:Me,selectionEnd:de})}},[Pt]),Ft=function(Re){var ve=se.current;ve&&(ve.value=Re.value,ve.selectionStart=Re.selectionStart,ve.selectionEnd=Re.selectionEnd,ae==null||ae(Re.value))},Ht=function(Re){var ve=se.current,Me=ce.current.stack[ce.current.offset];Me&&ve&&(ce.current.stack[ce.current.offset]=e(e({},Me),{selectionStart:ve.selectionStart,selectionEnd:ve.selectionEnd})),Pt(Re),Ft(Re)},Ce=function(){var Re=ce.current,ve=Re.stack,Me=Re.offset,de=ve[Me-1];de&&(Ft(de),ce.current.offset=Math.max(Me-1,0))},U=function(){var Re=ce.current,ve=Re.stack,Me=Re.offset,de=ve[Me+1];de&&(Ft(de),ce.current.offset=Math.min(Me+1,ve.length-1))},ee=function(Re){if(!(Z&&(Z(Re),Re.defaultPrevented))){Re.key==="Escape"&&Re.currentTarget.blur();var ve=Re.currentTarget,Me=ve.value,de=ve.selectionStart,ht=ve.selectionEnd,et=(V?" ":"	").repeat(Ie);if(Re.key==="Tab"&&!q&&Be)if(Re.preventDefault(),Re.shiftKey){var W=ut(Me,de),Ve=W.length-1,tt=ut(Me,ht).length-1,we=Me.split(`
`).map(function(wt,Jt){return Jt>=Ve&&Jt<=tt&&wt.startsWith(et)?wt.substring(et.length):wt}).join(`
`);if(Me!==we){var Te=W[Ve];Ht({value:we,selectionStart:Te!=null&&Te.startsWith(et)?de-et.length:de,selectionEnd:ht-(Me.length-we.length)})}}else if(de!==ht){var W=ut(Me,de),Ue=W.length-1,Ct=ut(Me,ht).length-1,Te=W[Ue];Ht({value:Me.split(`
`).map(function(jn,Gt){return Gt>=Ue&&Gt<=Ct?et+jn:jn}).join(`
`),selectionStart:Te&&/\S/.test(Te)?de+et.length:de,selectionEnd:ht+et.length*(Ct-Ue+1)})}else{var me=de+et.length;Ht({value:Me.substring(0,de)+et+Me.substring(ht),selectionStart:me,selectionEnd:me})}else if(Re.key==="Backspace"){var Q=de!==ht,J=Me.substring(0,de);if(J.endsWith(et)&&!Q){Re.preventDefault();var me=de-et.length;Ht({value:Me.substring(0,de-et.length)+Me.substring(ht),selectionStart:me,selectionEnd:me})}}else if(Re.key==="Enter"){if(de===ht){var te=ut(Me,de).pop(),_e=te==null?void 0:te.match(/^\s+/);if(_e!=null&&_e[0]){Re.preventDefault();var $e=`
`+_e[0],me=de+$e.length;Ht({value:Me.substring(0,de)+$e+Me.substring(ht),selectionStart:me,selectionEnd:me})}}}else if(Re.keyCode===c||Re.keyCode===u||Re.keyCode===d||Re.keyCode===h){var Ge=void 0;Re.keyCode===c&&Re.shiftKey?Ge=["(",")"]:Re.keyCode===u?Re.shiftKey?Ge=["{","}"]:Ge=["[","]"]:Re.keyCode===d?Re.shiftKey?Ge=['"','"']:Ge=["'","'"]:Re.keyCode===h&&!Re.shiftKey&&(Ge=["`","`"]),de!==ht&&Ge&&(Re.preventDefault(),Ht({value:Me.substring(0,de)+Ge[0]+Me.substring(de,ht)+Ge[1]+Me.substring(ht),selectionStart:de,selectionEnd:ht+2}))}else(v?Re.metaKey&&Re.keyCode===o:Re.ctrlKey&&Re.keyCode===o)&&!Re.shiftKey&&!Re.altKey?(Re.preventDefault(),Ce()):(v?Re.metaKey&&Re.keyCode===o&&Re.shiftKey:y?Re.ctrlKey&&Re.keyCode===a:Re.ctrlKey&&Re.keyCode===o&&Re.shiftKey)&&!Re.altKey?(Re.preventDefault(),U()):Re.keyCode===l&&Re.ctrlKey&&(!v||Re.shiftKey)&&(Re.preventDefault(),je(function(wt){return!wt}))}},xe=function(Re){var ve=Re.currentTarget,Me=ve.value,de=ve.selectionStart,ht=ve.selectionEnd;Pt({value:Me,selectionStart:de,selectionEnd:ht},!0),ae(Me)};return i.useEffect(function(){$t()},[$t]),i.useImperativeHandle(A,function(){return{get session(){return{history:ce.current}},set session(Re){ce.current=Re.history}}},[]),i.createElement("div",e({},fe,{style:e(e({},_.container),He)}),i.createElement("pre",e({className:he,"aria-hidden":"true",style:e(e(e({},_.editor),_.highlight),ot)},typeof Et=="string"?{dangerouslySetInnerHTML:{__html:Et+"<br />"}}:{children:Et})),i.createElement("textarea",{ref:function(Re){return se.current=Re},style:e(e(e({},_.editor),_.textarea),ot),className:x+(X?" ".concat(X):""),id:ye,value:Ne,onChange:xe,onKeyDown:ee,onClick:B,onKeyUp:ne,onFocus:G,onBlur:Y,disabled:M,form:j,maxLength:D,minLength:z,name:$,placeholder:Ee,readOnly:pe,required:Le,autoFocus:R,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),i.createElement("style",{dangerouslySetInnerHTML:{__html:w}}))}),_={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}};return Ho.default=S,Ho}var nst=tst();const rst=la(nst);var tP={exports:{}},YH;function sst(){return YH||(YH=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(S){return S instanceof l?new l(S.type,w(S.content),S.alias):Array.isArray(S)?S.map(w):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(S,_){_=_||{};var k,T;switch(o.util.type(S)){case"Object":if(T=o.util.objId(S),_[T])return _[T];k={},_[T]=k;for(var A in S)S.hasOwnProperty(A)&&(k[A]=w(S[A],_));return k;case"Array":return T=o.util.objId(S),_[T]?_[T]:(k=[],_[T]=k,S.forEach(function(R,M){k[M]=w(R,_)}),k);default:return S}},getLanguage:function(w){for(;w;){var S=s.exec(w.className);if(S)return S[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,S){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(k){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(k.stack)||[])[1];if(w){var S=document.getElementsByTagName("script");for(var _ in S)if(S[_].src==w)return S[_]}return null}},isActive:function(w,S,_){for(var k="no-"+S;w;){var T=w.classList;if(T.contains(S))return!0;if(T.contains(k))return!1;w=w.parentElement}return!!_}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,S){var _=o.util.clone(o.languages[w]);for(var k in S)_[k]=S[k];return _},insertBefore:function(w,S,_,k){k=k||o.languages;var T=k[w],A={};for(var R in T)if(T.hasOwnProperty(R)){if(R==S)for(var M in _)_.hasOwnProperty(M)&&(A[M]=_[M]);_.hasOwnProperty(R)||(A[R]=T[R])}var j=k[w];return k[w]=A,o.languages.DFS(o.languages,function(F,P){P===j&&F!=w&&(this[F]=A)}),A},DFS:function w(S,_,k,T){T=T||{};var A=o.util.objId;for(var R in S)if(S.hasOwnProperty(R)){_.call(S,R,S[R],k||R);var M=S[R],j=o.util.type(M);j==="Object"&&!T[A(M)]?(T[A(M)]=!0,w(M,_,null,T)):j==="Array"&&!T[A(M)]&&(T[A(M)]=!0,w(M,_,R,T))}}},plugins:{},highlightAll:function(w,S){o.highlightAllUnder(document,w,S)},highlightAllUnder:function(w,S,_){var k={callback:_,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",k),k.elements=Array.prototype.slice.apply(k.container.querySelectorAll(k.selector)),o.hooks.run("before-all-elements-highlight",k);for(var T=0,A;A=k.elements[T++];)o.highlightElement(A,S===!0,k.callback)},highlightElement:function(w,S,_){var k=o.util.getLanguage(w),T=o.languages[k];o.util.setLanguage(w,k);var A=w.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,k);var R=w.textContent,M={element:w,language:k,grammar:T,code:R};function j(P){M.highlightedCode=P,o.hooks.run("before-insert",M),M.element.innerHTML=M.highlightedCode,o.hooks.run("after-highlight",M),o.hooks.run("complete",M),_&&_.call(M.element)}if(o.hooks.run("before-sanity-check",M),A=M.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!M.code){o.hooks.run("complete",M),_&&_.call(M.element);return}if(o.hooks.run("before-highlight",M),!M.grammar){j(o.util.encode(M.code));return}if(S&&r.Worker){var F=new Worker(o.filename);F.onmessage=function(P){j(P.data)},F.postMessage(JSON.stringify({language:M.language,code:M.code,immediateClose:!0}))}else j(o.highlight(M.code,M.grammar,M.language))},highlight:function(w,S,_){var k={code:w,grammar:S,language:_};if(o.hooks.run("before-tokenize",k),!k.grammar)throw new Error('The language "'+k.language+'" has no grammar.');return k.tokens=o.tokenize(k.code,k.grammar),o.hooks.run("after-tokenize",k),l.stringify(o.util.encode(k.tokens),k.language)},tokenize:function(w,S){var _=S.rest;if(_){for(var k in _)S[k]=_[k];delete S.rest}var T=new d;return h(T,T.head,w),u(w,T,S,T.head,0),g(T)},hooks:{all:{},add:function(w,S){var _=o.hooks.all;_[w]=_[w]||[],_[w].push(S)},run:function(w,S){var _=o.hooks.all[w];if(!(!_||!_.length))for(var k=0,T;T=_[k++];)T(S)}},Token:l};r.Prism=o;function l(w,S,_,k){this.type=w,this.content=S,this.alias=_,this.length=(k||"").length|0}l.stringify=function w(S,_){if(typeof S=="string")return S;if(Array.isArray(S)){var k="";return S.forEach(function(j){k+=w(j,_)}),k}var T={type:S.type,content:w(S.content,_),tag:"span",classes:["token",S.type],attributes:{},language:_},A=S.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(T.classes,A):T.classes.push(A)),o.hooks.run("wrap",T);var R="";for(var M in T.attributes)R+=" "+M+'="'+(T.attributes[M]||"").replace(/"/g,"&quot;")+'"';return"<"+T.tag+' class="'+T.classes.join(" ")+'"'+R+">"+T.content+"</"+T.tag+">"};function c(w,S,_,k){w.lastIndex=S;var T=w.exec(_);if(T&&k&&T[1]){var A=T[1].length;T.index+=A,T[0]=T[0].slice(A)}return T}function u(w,S,_,k,T,A){for(var R in _)if(!(!_.hasOwnProperty(R)||!_[R])){var M=_[R];M=Array.isArray(M)?M:[M];for(var j=0;j<M.length;++j){if(A&&A.cause==R+","+j)return;var F=M[j],P=F.inside,q=!!F.lookbehind,I=!!F.greedy,V=F.alias;if(I&&!F.pattern.global){var D=F.pattern.toString().match(/[imsuy]*$/)[0];F.pattern=RegExp(F.pattern.source,D+"g")}for(var z=F.pattern||F,$=k.next,Y=T;$!==S.tail&&!(A&&Y>=A.reach);Y+=$.value.length,$=$.next){var B=$.value;if(S.length>w.length)return;if(!(B instanceof l)){var G=1,Z;if(I){if(Z=c(z,Y,w,q),!Z||Z.index>=w.length)break;var Se=Z.index,ne=Z.index+Z[0].length,ae=Y;for(ae+=$.value.length;Se>=ae;)$=$.next,ae+=$.value.length;if(ae-=$.value.length,Y=ae,$.value instanceof l)continue;for(var le=$;le!==S.tail&&(ae<ne||typeof le.value=="string");le=le.next)G++,ae+=le.value.length;G--,B=w.slice(Y,ae),Z.index-=Y}else if(Z=c(z,0,B,q),!Z)continue;var Se=Z.index,Ee=Z[0],he=B.slice(0,Se),pe=B.slice(Se+Ee.length),Le=Y+B.length;A&&Le>A.reach&&(A.reach=Le);var He=$.prev;he&&(He=h(S,He,he),Y+=he.length),p(S,He,G);var Fe=new l(R,P?o.tokenize(Ee,P):Ee,V,Ee);if($=h(S,He,Fe),pe&&h(S,$,pe),G>1){var Ie={cause:R+","+j,reach:Le};u(w,S,_,$.prev,Y,Ie),A&&Ie.reach>A.reach&&(A.reach=Ie.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},S={value:null,prev:w,next:null};w.next=S,this.head=w,this.tail=S,this.length=0}function h(w,S,_){var k=S.next,T={value:_,prev:S,next:k};return S.next=T,k.prev=T,w.length++,T}function p(w,S,_){for(var k=S.next,T=0;T<_&&k!==w.tail;T++)k=k.next;S.next=k,k.prev=S,w.length-=T}function g(w){for(var S=[],_=w.head.next;_!==w.tail;)S.push(_.value),_=_.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var S=JSON.parse(w.data),_=S.language,k=S.code,T=S.immediateClose;r.postMessage(o.highlight(k,o.languages[_],_)),T&&r.close()},!1)),o;var y=o.util.currentScript();y&&(o.filename=y.src,y.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&y&&y.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof jm<"u"&&(jm.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(y,v){return" Error "+y+" while fetching file: "+v},i=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(y,v,x){var w=new XMLHttpRequest;w.open("GET",y,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function p(y){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(y||"");if(v){var x=Number(v[1]),w=v[2],S=v[3];return w?S?[x,Number(S)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(y){y.selector+=", "+d}),n.hooks.add("before-sanity-check",function(y){var v=y.element;if(v.matches(d)){y.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),S=y.language;if(S==="none"){var _=(/\.(\w+)$/.exec(w)||[,"none"])[1];S=a[_]||_}n.util.setLanguage(x,S),n.util.setLanguage(v,S);var k=n.plugins.autoloader;k&&k.loadLanguages(S),h(w,function(T){v.setAttribute(o,c);var A=p(v.getAttribute("data-range"));if(A){var R=T.split(/\r\n?|\n/g),M=A[0],j=A[1]==null?R.length:A[1];M<0&&(M+=R.length),M=Math.max(0,Math.min(M-1,R.length)),j<0&&(j+=R.length),j=Math.max(0,Math.min(j,R.length)),T=R.slice(M,j).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(M+1))}x.textContent=T,n.highlightElement(x)},function(T){v.setAttribute(o,u),x.textContent=T})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,S;S=x[w++];)n.highlightElement(S)}};var g=!1;n.fileHighlight=function(){g||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),g=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(tP)),tP.exports}var ist=sst();const Qs=la(ist);var ZH={},XH;function ast(){return XH||(XH=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),ZH}ast();Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;var JH={},QH;function ost(){return QH||(QH=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),JH}ost();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var p=0,g=h.length;p<g;p++){var y=h[p];if(y.type!=="code"){d(y.content);continue}var v=y.content[1],x=y.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var S="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,S]:x.alias.push(S):x.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,p=u.classes.length;h<p;h++){var g=u.classes[h],y=/language-(.+)/.exec(g);if(y){d=y[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,p){if(p=p.toLowerCase(),p[0]==="#"){var g;return p[1]==="x"?g=parseInt(p.slice(2),16):g=Number(p.slice(1)),l(g)}else{var y=o[p];return y||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var eG={},tG;function lst(){return tG||(tG=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),eG}lst();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const cst=e=>e?{javascript:Qs.languages.javascript,js:Qs.languages.javascript,typescript:Qs.languages.typescript,ts:Qs.languages.typescript,python:Qs.languages.python,py:Qs.languages.python,bash:Qs.languages.bash,sh:Qs.languages.bash,json:Qs.languages.json,markdown:Qs.languages.markdown,md:Qs.languages.markdown,diff:Qs.languages.diff,go:Qs.languages.go,yaml:Qs.languages.yaml,yml:Qs.languages.yaml,rust:Qs.languages.rust,rs:Qs.languages.rust,sql:Qs.languages.sql}[e.toLowerCase()]||Qs.languages.plaintext||Qs.languages.text:Qs.languages.plaintext||Qs.languages.text,Mce=({value:e,onChange:t,language:n="text",placeholder:r,error:s,onSave:i,showSaveButton:a=!1,saveButtonText:o="Save",disabled:l=!1,minHeight:c="200px",className:u=""})=>{const[d,h]=E.useState(!1),p=E.useCallback(v=>{try{const x=cst(n);return Qs.highlight(v,x,n||"text")}catch(x){return console.error("Syntax highlighting error:",x),v}},[n]),g=E.useCallback(async()=>{if(!(!i||l||d)){h(!0);try{await i(e)}finally{h(!1)}}},[i,e,l,d]),y=a&&i&&e.trim().length>0&&!l;return f.jsxs("div",{className:`space-y-2 ${u}`,children:[s&&f.jsxs(jA,{variant:"destructive",children:[f.jsx(No,{className:"h-4 w-4"}),f.jsx(PA,{className:"whitespace-pre-wrap",children:s})]}),f.jsx("div",{className:"relative border rounded-md",children:f.jsx(rst,{value:e,onValueChange:t,highlight:p,padding:16,tabSize:2,insertSpaces:!0,placeholder:r,disabled:l,style:{fontFamily:'"Fira Code", "Fira Mono", "Consolas", "Monaco", monospace',fontSize:14,lineHeight:1.5,minHeight:c,backgroundColor:"transparent",outline:"none"},className:"w-full bg-transparent resize-none",textareaClassName:"focus:outline-none"})}),y&&f.jsx("div",{className:"flex justify-end",children:f.jsxs(rt,{onClick:g,disabled:d||!e.trim(),size:"sm",className:"flex items-center gap-2",children:[f.jsx(wc,{className:"h-4 w-4"}),d?"Saving...":o]})})]})},ust=({code:e,language:t,onChange:n,minHeight:r="100px"})=>f.jsx(Mce,{value:e,onChange:n,language:t,minHeight:r,showSaveButton:!1}),dst=({workflow:e,onChange:t,onSave:n,disabled:r=!1,className:s})=>{const[i,a]=E.useState(""),[o,l]=E.useState(""),c=E.useRef(null);E.useEffect(()=>{try{const g=JSON.stringify(e,null,2);a(g),l("")}catch(g){l(`Failed to serialize workflow: ${g instanceof Error?g.message:String(g)}`)}},[e]);const u=E.useCallback(g=>{if(!g.trim())return{isValid:!1,error:"Workflow definition cannot be empty"};try{const y=JSON.parse(g);if(typeof y!="object"||y===null)return{isValid:!1,error:"Workflow must be a valid JSON object"};if(!y.id||typeof y.id!="string")return{isValid:!1,error:'Workflow must have a valid "id" field (string)'};if(!y.name||typeof y.name!="string")return{isValid:!1,error:'Workflow must have a valid "name" field (string)'};if(!y.description||typeof y.description!="string")return{isValid:!1,error:'Workflow must have a valid "description" field (string)'};if(!Array.isArray(y.steps))return{isValid:!1,error:'Workflow must have a "steps" field that is an array'};if(!y.createdAt||typeof y.createdAt!="string")return{isValid:!1,error:'Workflow must have a valid "createdAt" field (ISO string)'};if(!y.updatedAt||typeof y.updatedAt!="string")return{isValid:!1,error:'Workflow must have a valid "updatedAt" field (ISO string)'};for(let v=0;v<y.steps.length;v++){const x=y.steps[v];if(!x.id||typeof x.id!="string")return{isValid:!1,error:`Step ${v+1}: must have a valid "id" field (string)`};if(!x.name||typeof x.name!="string")return{isValid:!1,error:`Step ${v+1}: must have a valid "name" field (string)`};if(!x.type||typeof x.type!="string")return{isValid:!1,error:`Step ${v+1}: must have a valid "type" field (string)`};const w=["prompt","agent-task","human-in-the-loop"];if(!w.includes(x.type))return{isValid:!1,error:`Step ${v+1}: type must be one of: ${w.join(", ")}`};if(x.modelId!==void 0&&typeof x.modelId!="string")return{isValid:!1,error:`Step ${v+1}: "modelId" must be a string if provided`};if(x.templateId!==void 0&&typeof x.templateId!="string")return{isValid:!1,error:`Step ${v+1}: "templateId" must be a string if provided`};if(x.instructionsForHuman!==void 0&&typeof x.instructionsForHuman!="string")return{isValid:!1,error:`Step ${v+1}: "instructionsForHuman" must be a string if provided`};if(x.prompt!==void 0&&typeof x.prompt!="string")return{isValid:!1,error:`Step ${v+1}: "prompt" must be a string if provided`};if(x.inputMapping!==void 0){if(typeof x.inputMapping!="object"||x.inputMapping===null||Array.isArray(x.inputMapping))return{isValid:!1,error:`Step ${v+1}: "inputMapping" must be an object if provided`};for(const[S,_]of Object.entries(x.inputMapping))if(typeof _!="string")return{isValid:!1,error:`Step ${v+1}: inputMapping["${S}"] must be a string`}}if(x.structuredOutput!==void 0){if(typeof x.structuredOutput!="object"||x.structuredOutput===null||Array.isArray(x.structuredOutput))return{isValid:!1,error:`Step ${v+1}: "structuredOutput" must be an object if provided`};if(!x.structuredOutput.schema||typeof x.structuredOutput.schema!="object")return{isValid:!1,error:`Step ${v+1}: structuredOutput must have a "schema" object`};if(!x.structuredOutput.jsonSchema||typeof x.structuredOutput.jsonSchema!="object")return{isValid:!1,error:`Step ${v+1}: structuredOutput must have a "jsonSchema" object`}}}return{isValid:!0,workflow:y}}catch(y){return{isValid:!1,error:`JSON parsing error: ${y instanceof Error?y.message:String(y)}`}}},[]),d=E.useCallback(g=>{c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{const y=u(g);l(y.error||"")},750)},[u]),h=E.useCallback(g=>{a(g),d(g)},[d]),p=E.useCallback(async g=>{const y=u(g);if(!y.isValid)throw new Error(y.error||"Invalid workflow definition");if(!y.workflow)throw new Error("Failed to parse workflow definition");try{n&&(await n(y.workflow),ke.success("Workflow saved successfully")),t(y.workflow)}catch(v){const x=v instanceof Error?v.message:String(v);throw new Error(`Save failed: ${x}`)}},[n,u,t]);return E.useEffect(()=>()=>{c.current&&clearTimeout(c.current)},[]),f.jsxs("div",{className:s,children:[f.jsxs("div",{className:"mb-4",children:[f.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Raw Workflow Editor"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Edit the workflow as JSON. Changes are validated in real-time. Use the save button to persist changes to the database."})]}),f.jsx(Mce,{value:i,onChange:h,language:"json",placeholder:"Enter workflow JSON definition...",error:o,onSave:n?p:void 0,showSaveButton:!!n,saveButtonText:"Save Workflow",disabled:r,className:"flex-1"})]})};var fL="Radio",[fst,jce]=Pi(fL),[hst,pst]=fst(fL),Pce=E.forwardRef((e,t)=>{const{__scopeRadio:n,name:r,checked:s=!1,required:i,disabled:a,value:o="on",onCheck:l,form:c,...u}=e,[d,h]=E.useState(null),p=Tn(t,v=>h(v)),g=E.useRef(!1),y=d?c||!!d.closest("form"):!0;return f.jsxs(hst,{scope:n,checked:s,disabled:a,children:[f.jsx(Zn.button,{type:"button",role:"radio","aria-checked":s,"data-state":Lce(s),"data-disabled":a?"":void 0,disabled:a,value:o,...u,ref:p,onClick:Wt(e.onClick,v=>{s||l==null||l(),y&&(g.current=v.isPropagationStopped(),g.current||v.stopPropagation())})}),y&&f.jsx(Fce,{control:d,bubbles:!g.current,name:r,value:o,checked:s,required:i,disabled:a,form:c,style:{transform:"translateX(-100%)"}})]})});Pce.displayName=fL;var Oce="RadioIndicator",Dce=E.forwardRef((e,t)=>{const{__scopeRadio:n,forceMount:r,...s}=e,i=pst(Oce,n);return f.jsx(ca,{present:r||i.checked,children:f.jsx(Zn.span,{"data-state":Lce(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t})})});Dce.displayName=Oce;var mst="RadioBubbleInput",Fce=E.forwardRef(({__scopeRadio:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=Tn(a,i),l=KS(n),c=Sg(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&p){const g=new Event("click",{bubbles:r});p.call(u,n),u.dispatchEvent(g)}},[l,n,r]),f.jsx(Zn.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Fce.displayName=mst;function Lce(e){return e?"checked":"unchecked"}var gst=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],wN="RadioGroup",[yst,Mvt]=Pi(wN,[ov,jce]),$ce=ov(),Bce=jce(),[bst,vst]=yst(wN),zce=E.forwardRef((e,t)=>{const{__scopeRadioGroup:n,name:r,defaultValue:s,value:i,required:a=!1,disabled:o=!1,orientation:l,dir:c,loop:u=!0,onValueChange:d,...h}=e,p=$ce(n),g=Og(c),[y,v]=pc({prop:i,defaultProp:s??"",onChange:d,caller:wN});return f.jsx(bst,{scope:n,name:r,required:a,disabled:o,value:y,onValueChange:v,children:f.jsx(D6,{asChild:!0,...p,orientation:l,dir:g,loop:u,children:f.jsx(Zn.div,{role:"radiogroup","aria-required":a,"aria-orientation":l,"data-disabled":o?"":void 0,dir:g,...h,ref:t})})})});zce.displayName=wN;var Uce="RadioGroupItem",qce=E.forwardRef((e,t)=>{const{__scopeRadioGroup:n,disabled:r,...s}=e,i=vst(Uce,n),a=i.disabled||r,o=$ce(n),l=Bce(n),c=E.useRef(null),u=Tn(t,c),d=i.value===s.value,h=E.useRef(!1);return E.useEffect(()=>{const p=y=>{gst.includes(y.key)&&(h.current=!0)},g=()=>h.current=!1;return document.addEventListener("keydown",p),document.addEventListener("keyup",g),()=>{document.removeEventListener("keydown",p),document.removeEventListener("keyup",g)}},[]),f.jsx(F6,{asChild:!0,...o,focusable:!a,active:d,children:f.jsx(Pce,{disabled:a,required:i.required,checked:d,...l,...s,name:i.name,ref:u,onCheck:()=>i.onValueChange(s.value),onKeyDown:Wt(p=>{p.key==="Enter"&&p.preventDefault()}),onFocus:Wt(s.onFocus,()=>{var p;h.current&&((p=c.current)==null||p.click())})})})});qce.displayName=Uce;var xst="RadioGroupIndicator",Vce=E.forwardRef((e,t)=>{const{__scopeRadioGroup:n,...r}=e,s=Bce(n);return f.jsx(Dce,{...s,...r,ref:t})});Vce.displayName=xst;var wst=zce,Sst=qce,_st=Vce;function Cst({className:e,...t}){return f.jsx(wst,{"data-slot":"radio-group",className:Ye("grid gap-3",e),...t})}function nP({className:e,...t}){return f.jsx(Sst,{"data-slot":"radio-group-item",className:Ye("border-input text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(_st,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:f.jsx(oY,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}const nG=()=>({id:"",name:"My New Workflow",description:"A workflow for processing things.",steps:[],createdAt:"",updatedAt:""}),Wce=We.forwardRef(({initialData:e},t)=>{const n=Xs({defaultValues:e});We.useImperativeHandle(t,()=>({getData:()=>n.state.values,reset:s=>{n.setFieldValue("name",s.name),n.setFieldValue("description",s.description)}}));const r=E.useRef(!1);return E.useEffect(()=>{r.current||(n.setFieldValue("name",e.name),n.setFieldValue("description",e.description),r.current=!0)},[]),f.jsxs("div",{className:"space-y-4",children:[f.jsx(n.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"wf-name",children:"Workflow Name"}),f.jsx(vn,{id:"wf-name",value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur})]})}),f.jsx(n.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"wf-desc",children:"Description"}),f.jsx(Mi,{id:"wf-desc",value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,rows:3})]})})]})});Wce.displayName="WorkflowMetadataForm";const Hce=We.forwardRef(({initialData:e,promptTemplates:t,agentTasks:n,module:r},s)=>{const i=Xs({defaultValues:e}),[a,o]=E.useState(i.state.values);E.useEffect(()=>i.store.subscribe(()=>{o(i.state.values)}),[]);const l=a.triggerType==="template"&&a.selectedTemplateId?t.find(p=>p.id===a.selectedTemplateId):null,c=a.triggerType==="task"&&a.selectedTemplateId?n.find(p=>p.id===a.selectedTemplateId):null,u=E.useRef(null);We.useImperativeHandle(s,()=>({getData:()=>{var y;const p=i.state.values,g=((y=u.current)==null?void 0:y.getData())||{};return{...p,templateVariables:g}},getCompiledPrompt:async()=>{var y;const p=i.state.values,g=((y=u.current)==null?void 0:y.getData())||{};if(p.triggerType==="custom")return p.customPrompt;if(p.triggerType==="template"&&p.selectedTemplateId&&l)try{return(await r.compileTemplate(l.id,g)).content}catch(v){return`Error: ${v instanceof Error?v.message:"Compilation failed"}`}else if(p.triggerType==="task"&&p.selectedTemplateId&&c)return c.prompt;return""},reset:p=>{i.setFieldValue("triggerType",p.triggerType),i.setFieldValue("customPrompt",p.customPrompt),i.setFieldValue("selectedTemplateId",p.selectedTemplateId),i.setFieldValue("templateVariables",p.templateVariables),o(p)}}));const d=E.useRef(!1);E.useEffect(()=>{d.current||(i.setFieldValue("triggerType",e.triggerType),i.setFieldValue("customPrompt",e.customPrompt),i.setFieldValue("selectedTemplateId",e.selectedTemplateId),i.setFieldValue("templateVariables",e.templateVariables),d.current=!0)},[]);const h=a.triggerType==="template"?t:n;return f.jsxs("div",{className:"border rounded-md p-3 space-y-4",children:[f.jsx(At,{className:"font-semibold",children:"Trigger / Initial Message"}),f.jsx(i.Field,{name:"triggerType",children:p=>f.jsxs(Cst,{value:p.state.value,onValueChange:g=>{p.handleChange(g),i.setFieldValue("selectedTemplateId",""),i.setFieldValue("templateVariables",{})},children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(nP,{value:"custom",id:"r-custom"}),f.jsx(At,{htmlFor:"r-custom",children:"Custom Prompt"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(nP,{value:"template",id:"r-template"}),f.jsx(At,{htmlFor:"r-template",children:"Prompt from Template"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(nP,{value:"task",id:"r-task"}),f.jsx(At,{htmlFor:"r-task",children:"Agent Task"})]})]})}),a.triggerType==="custom"&&f.jsx(i.Field,{name:"customPrompt",children:p=>f.jsx(Mi,{value:p.state.value,onChange:g=>p.handleChange(g.target.value),onBlur:p.handleBlur,placeholder:"Enter the first message to start the workflow...",className:"min-h-[100px]"})}),(a.triggerType==="template"||a.triggerType==="task")&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(i.Field,{name:"selectedTemplateId",children:p=>f.jsxs(mc,{value:p.state.value,onValueChange:g=>{p.handleChange(g),i.setFieldValue("templateVariables",{})},children:[f.jsx(yc,{children:f.jsx(gc,{placeholder:`Select a ${a.triggerType}...`})}),f.jsx(bc,{children:h.map(g=>f.jsx(yi,{value:g.id,children:a.triggerType==="task"?g.prefixedName:g.name},g.id))})]})}),l&&l.variables.length>0&&f.jsx(Gce,{ref:u,template:l,initialVariables:a.templateVariables,module:r},l.id)]})]})});Hce.displayName="TriggerConfigForm";const Gce=We.forwardRef(({template:e,initialVariables:t,module:n},r)=>{const[s,i]=E.useState(t),a=E.useRef(null);We.useImperativeHandle(r,()=>({getData:()=>s}));const o=E.useMemo(()=>e.variables.map(c=>({name:c.name,type:c.type||"text",label:c.name,placeholder:c.description,description:c.instructions,required:c.required})),[e.variables]),{Form:l}=Dg({fields:o,formOptions:{defaultValues:t,onChange:async({value:c})=>{if(a.current)try{const u=await n.compileTemplate(e.id,c);a.current.textContent=u.content}catch(u){const d=`Error: ${u instanceof Error?u.message:"Compilation failed"}`;a.current.textContent=d}},onBlur:async({value:c})=>{i(c)}},showSubmitButton:!1,formClassName:"space-y-4 mt-4 border-t pt-4"});return E.useEffect(()=>{a.current&&(a.current.textContent=e.prompt),i(t),Object.keys(t).length>0&&n.compileTemplate(e.id,t).then(c=>{a.current&&(a.current.textContent=c.content)}).catch(c=>{if(a.current){const u=`Error: ${c instanceof Error?c.message:"Compilation failed"}`;a.current.textContent=u}})},[e.id,e.prompt]),f.jsxs("div",{children:[f.jsx(l,{}),f.jsxs("div",{className:"mt-4 border rounded-lg p-3",children:[f.jsx(At,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:a,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-32 overflow-y-auto",children:e.prompt})]})]})});Gce.displayName="TemplateVariableFormWrapper";const Kce=We.forwardRef(({initialSteps:e,promptTemplates:t,agentTasks:n,models:r,module:s,currentWorkflow:i},a)=>{const[o,l]=E.useState(e);We.useImperativeHandle(a,()=>({getData:()=>o,reset:p=>{l(p)}}));const c=E.useRef(!1);E.useEffect(()=>{c.current||(l(e),c.current=!0)},[]);const u=E.useCallback(()=>{const p={id:dr(),name:`Step ${o.length+1}`,type:"prompt",modelId:"",templateId:void 0};l(g=>[...g,p])},[o.length]),d=E.useCallback((p,g)=>{l(y=>{const v=[...y];return v[p]=g,v})},[]),h=E.useCallback(p=>{l(g=>g.filter((y,v)=>v!==p))},[]);return f.jsx("div",{className:"h-full flex flex-col",children:f.jsx(ul,{className:"flex-1 border rounded-md p-3",children:f.jsxs("div",{className:"space-y-4",children:[o.map((p,g)=>f.jsx(QZe,{step:p,onChange:y=>d(g,y),onDelete:()=>h(g),promptTemplates:t,agentTasks:n,models:r,module:s,workflow:i,stepIndex:g},p.id)),o.length===0&&f.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No subsequent steps. Add one to create a sequence."}),f.jsxs(rt,{size:"sm",onClick:u,className:"w-full mt-4",children:[f.jsx(al,{className:"h-4 w-4 mr-2"})," Add Step"]})]})})})});Kce.displayName="StepsForm";const kst=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState("list"),[i,a]=E.useState("builder"),[o,l]=E.useState(nG()),[c,u]=E.useState(!1),[d,h]=E.useState({name:o.name,description:o.description}),[p,g]=E.useState({triggerType:o.triggerType||"custom",customPrompt:o.triggerPrompt||"",selectedTemplateId:o.triggerRef||"",templateVariables:o.templateVariables||{}}),[y,v]=E.useState(o.steps||[]),x=E.useRef(null),w=E.useRef(null),S=E.useRef(null),[_,k]=E.useState(null),T=en(B=>B.streamingInteractionIds.length>0),A=e.getPromptTemplates(),R=e.getAgentTasks(),M=e.getModels(),j=E.useCallback(async()=>{var ae,le,Se,Ee;const B=((ae=x.current)==null?void 0:ae.getData())||d,G=((le=w.current)==null?void 0:le.getData())||p,Z=await(((Se=w.current)==null?void 0:Se.getCompiledPrompt())||Promise.resolve("")),ne=((Ee=S.current)==null?void 0:Ee.getData())||y;return{metadata:B,trigger:G,compiledPrompt:Z,steps:ne}},[d,p,y]),F=E.useCallback(async()=>{const{metadata:B,trigger:G,compiledPrompt:Z,steps:ne}=await j();return{...o,name:B.name,description:B.description,triggerType:G.triggerType,triggerPrompt:Z,triggerRef:G.triggerType!=="custom"?G.selectedTemplateId:void 0,templateVariables:G.templateVariables,steps:ne}},[o,j]),P=()=>{var ae,le,Se;const B=nG(),G={name:B.name,description:B.description},Z={triggerType:"custom",customPrompt:"",selectedTemplateId:"",templateVariables:{}},ne=[];l(B),h(G),g(Z),v(ne),u(!1),k(null),(ae=x.current)==null||ae.reset(G),(le=w.current)==null||le.reset(Z),(Se=S.current)==null||Se.reset(ne)},q=()=>{P(),s("builder")},I=B=>{const G={name:B.name,description:B.description},Z={triggerType:B.triggerType||"custom",customPrompt:B.triggerPrompt||"",selectedTemplateId:B.triggerRef||"",templateVariables:B.templateVariables||{}},ne=B.steps||[];l(B),h(G),g(Z),v(ne),u(!0),s("builder"),k(null),setTimeout(()=>{var ae,le,Se;(ae=x.current)==null||ae.reset(G),(le=w.current)==null||le.reset(Z),(Se=S.current)==null||Se.reset(ne)},100)},V=async()=>{const{metadata:B,trigger:G,steps:Z}=await j();if(h(B),g(G),v(Z),!B.name.trim()){ke.error("Workflow name cannot be empty.");return}try{const ne=new Date().toISOString(),ae=await F();ae.id=o.id||dr(),ae.createdAt=o.createdAt||ne,ae.updatedAt=ne,await dt.saveWorkflow(ae),l(ae),u(!0),await e.refreshWorkflows(),ke.success(`Saved workflow "${ae.name}"`)}catch(ne){console.error("Failed to save workflow:",ne),ke.error("Failed to save workflow")}},D=async()=>{const{metadata:B,trigger:G,steps:Z}=await j();if(h(B),g(G),v(Z),!B.name.trim()){ke.error("Workflow name cannot be empty.");return}try{const ne=new Date().toISOString(),ae=await F();ae.id=dr(),ae.name=`${B.name} (Fork)`,ae.createdAt=ne,ae.updatedAt=ne,await dt.saveWorkflow(ae),l(ae),h({name:ae.name,description:ae.description}),u(!0),await e.refreshWorkflows(),ke.success(`Forked workflow as "${ae.name}"`)}catch(ne){console.error("Failed to fork workflow:",ne),ke.error("Failed to fork workflow")}},z=async()=>{const{trigger:B,steps:G}=await j();if(B.triggerType==="custom"){if(!B.customPrompt){ke.error("Custom prompt cannot be empty.");return}}else if(!B.selectedTemplateId){ke.error("Please select a template or task.");return}if(G.length===0){ke.error("Workflow must have at least one step.");return}try{const Z=await F();await e.startWorkflow(Z,Z.triggerPrompt||""),n(!1),ke.success("Workflow started!")}catch(Z){console.error("Failed to run workflow:",Z),ke.error("Failed to start workflow")}},$=E.useCallback(async B=>{try{const{metadata:G,trigger:Z,steps:ne}=await j();h(G),g(Z),v(ne)}catch(G){console.error("Failed to gather form data before tab change:",G)}if(a(B),B==="visualizer"||B==="raw")try{const{trigger:G,steps:Z}=await j(),ne=await F(),ae=G.triggerType==="template"&&G.selectedTemplateId?A.find(he=>he.id===G.selectedTemplateId):null,le=G.triggerType==="task"&&G.selectedTemplateId?R.find(he=>he.id===G.selectedTemplateId):null;let Se;if(G.triggerType==="custom"&&G.customPrompt){const he=G.customPrompt.length>100?G.customPrompt.slice(0,100)+"...":G.customPrompt;Se={stepName:"Custom Prompt",templateName:he,type:"initial",previewContent:he}}else if(G.triggerType==="template"&&G.selectedTemplateId&&ae){const he=ne.triggerPrompt||ae.prompt,pe=he.length>100?he.slice(0,100)+"...":he;Se={stepName:ae.name,templateName:pe,type:"initial",previewContent:pe}}else if(G.triggerType==="task"&&G.selectedTemplateId&&le){const he=le.prompt.length>100?le.prompt.slice(0,100)+"...":le.prompt;Se={stepName:le.name,templateName:he,type:"initial",previewContent:he}}else Se={stepName:"Initial Step",templateName:void 0,type:"initial",previewContent:void 0};const Ee=Z.map(he=>{const pe=()=>{if(!he.modelId)return;const He=M.find(Fe=>Fe.id===he.modelId);return He?He.name:he.modelId},Le=()=>{if(he.templateId){if(he.type==="prompt"){const He=A.find(Fe=>Fe.id===he.templateId);return He==null?void 0:He.name}else if(he.type==="agent-task"){const He=R.find(Fe=>Fe.id===he.templateId);return He==null?void 0:He.name}}};return{stepName:he.name||"Unnamed Step",templateName:Le(),modelName:pe(),type:he.type}});k({workflow:ne,initialStepData:Se,stepDisplayData:Ee})}catch(G){console.error("Failed to gather data for visualizer:",G)}},[j,F,A,R,M]),Y=[{value:"list",label:"Workflows",content:f.jsx(eXe,{module:e,onEditWorkflow:I,onCreateNew:q,onWorkflowsChanged:()=>e.refreshWorkflows(),onWorkflowRun:()=>n(!1)})},{value:"builder",label:c?"Edit Workflow":"New Workflow",content:f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4 md:gap-6 h-full overflow-hidden p-1 md:p-2",children:[f.jsxs("div",{className:"lg:col-span-4 xl:col-span-3 2xl:col-span-3 flex flex-col gap-3 md:gap-4 overflow-y-auto max-h-full",children:[f.jsx(Wce,{ref:x,initialData:d}),f.jsx(Hce,{ref:w,initialData:p,promptTemplates:A,agentTasks:R,module:e})]}),f.jsxs("div",{className:"lg:col-span-8 xl:col-span-9 2xl:col-span-9 flex flex-col h-full",children:[f.jsx(At,{className:"mb-2",children:"Workflow Steps"}),f.jsx("div",{className:"flex-1 min-h-0",children:f.jsx(jo,{onValueChange:$,tabs:[{value:"builder",label:"Builder",content:f.jsx(Kce,{ref:S,initialSteps:y,promptTemplates:A,agentTasks:R,models:M,module:e,currentWorkflow:o})},{value:"visualizer",label:"Visualizer",content:f.jsx("div",{className:"h-full w-full border rounded-md",children:_?f.jsx(est,{workflow:_.workflow,initialStepData:_.initialStepData,stepDisplayData:_.stepDisplayData}):f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading visualizer..."})})},{value:"raw",label:"Raw Editor",content:f.jsx("div",{className:"h-full border rounded-md",children:_?f.jsx(dst,{workflow:_.workflow,onChange:async B=>{h({name:B.name,description:B.description}),g({triggerType:B.triggerType||"custom",customPrompt:B.triggerPrompt||"",selectedTemplateId:B.triggerRef||"",templateVariables:B.templateVariables||{}}),v(B.steps),k(G=>G?{...G,workflow:B}:null)},onSave:async B=>{const G=new Date().toISOString(),Z={...B,id:B.id||dr(),createdAt:B.createdAt||G,updatedAt:G};await dt.saveWorkflow(Z),l(Z),u(!0),await e.refreshWorkflows()},className:"h-full p-3"}):f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading editor..."})})}],scrollable:!1,className:"h-full",initialValue:i})})]})]})}];return f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:"Open Workflow Builder",onClick:()=>n(!0),"aria-label":"Open Workflow Builder",disabled:T,icon:f.jsx(Lw,{}),className:"h-5 w-5 md:h-6 md:w-6"}),f.jsx(vd,{open:t,onOpenChange:n,children:f.jsxs(xd,{className:"!w-[95vw] !h-[95vh] !max-w-none flex flex-col p-0",children:[f.jsxs(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 flex-shrink-0",children:[f.jsx(Sd,{className:"p-2",children:"Workflow Builder"}),f.jsx(Bf,{children:"Create and manage automated sequences of AI interactions."})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(jo,{tabs:Y,initialValue:r,onValueChange:async B=>{if(r==="builder"&&B!=="builder")try{const{metadata:G,trigger:Z,steps:ne}=await j();h(G),g(Z),v(ne)}catch(G){console.error("Failed to gather form data before main tab change:",G)}s(B),B==="list"&&e.refreshWorkflows()},scrollable:!0})}),r==="builder"&&f.jsx(Fg,{className:"p-1 sm:p-2 md:p-3 pt-0.5 sm:pt-1 md:pt-2",children:f.jsxs("div",{className:"flex gap-1 sm:gap-2 flex-wrap",children:[f.jsx(rt,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),c&&f.jsxs(rt,{variant:"outline",onClick:D,className:"flex items-center gap-2",children:[f.jsx(RD,{className:"h-4 w-4"}),"Fork"]}),f.jsxs(rt,{variant:"outline",onClick:V,className:"flex items-center gap-2",children:[f.jsx(wc,{className:"h-4 w-4"}),"Save"]}),f.jsxs(rt,{onClick:z,className:"flex items-center gap-2",children:[f.jsx(Lw,{className:"h-4 w-4"}),"Run Workflow"]})]})})]})})]})};class Est{constructor(){ue(this,"id","core-workflow-control");ue(this,"modApi",null);ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!1);ue(this,"allTemplates",[]);ue(this,"workflows",[])}async initialize(t){this.modApi=t;const n=Gn.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading,this.allTemplates=tl.getState().promptTemplates;const r=t.on($n.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on($n.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.on(Fa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(r,s,i),t.emit(Fa.loadPromptTemplatesRequest,{}),await this.loadWorkflows()}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}getPromptTemplates(){return this.allTemplates.filter(t=>(t.type||"prompt")==="prompt")}getAgentTasks(){const t=this.allTemplates.filter(r=>r.type==="agent"),n=new Map(t.map(r=>[r.id,r.name]));return this.allTemplates.filter(r=>r.type==="task"&&r.parentId).map(r=>({...r,prefixedName:`${n.get(r.parentId)||"Unknown Agent"}: ${r.name}`}))}getAllTemplates(){return this.allTemplates}getModels(){return this.globallyEnabledModels}getGlobalModel(){return Gn.getState().getSelectedModel()}async compileTemplate(t,n={}){const{compilePromptTemplate:r}=tl.getState();return await r(t,n)}async loadWorkflows(){var t;try{this.workflows=await dt.loadWorkflows(),(t=this.notifyComponentUpdate)==null||t.call(this)}catch(n){console.error("[WorkflowControlModule] Failed to load workflows:",n)}}getWorkflows(){return this.workflows}async refreshWorkflows(){await this.loadWorkflows()}startWorkflow(t,n){var s;const r=en.getState().currentConversationId;if(!r){ke.error("Cannot start workflow: No active conversation selected."),console.error("[WorkflowControlModule] startWorkflow called without an active conversation.");return}(s=this.modApi)==null||s.emit(as.startRequest,{template:t,initialPrompt:n,conversationId:r}),ke.success(`Workflow "${t.name}" started with ${t.steps.length} steps!`)}validateTransformQuery(t,n,r){if(!t.trim())return{isValid:!1,error:"Query cannot be empty"};if(!t.startsWith("$."))return{isValid:!1,error:'Query must start with "$."'};if(/[^a-zA-Z0-9_.$\[\]]/.test(t.replace(/\[(\d+)\]/g,"")))return{isValid:!1,error:"Invalid characters in query"};const i=this._buildRealisticSampleContext(n,r);try{return{isValid:!0,result:this._resolveJsonPath(i,t)}}catch(a){return{isValid:!1,error:`Query execution failed: ${a instanceof Error?a.message:"Unknown error"}`}}}_buildRealisticSampleContext(t,n){const r={workflow:t||{id:"sample-workflow",name:"Sample Workflow",description:"A sample workflow for validation",triggerType:"custom",triggerPrompt:"Sample initial prompt",steps:[]}};let s={};if(t){const a=t.steps[0];if((a==null?void 0:a.type)==="transform")s="Sample AI response text that would be output by the initial step. This is raw, unstructured text that the transform step will process using JSONPath queries to extract specific data.";else if(t.triggerType==="custom")s={analysis:"Sample analysis of the custom prompt",key_points:["point 1","point 2","point 3"],confidence:.85};else if(t.triggerType==="template"&&t.triggerRef){const l=this.allTemplates.find(c=>c.id===t.triggerRef);s={summary:`Sample output from template: ${(l==null?void 0:l.name)||"Selected Template"}`,extracted_data:"Sample extracted information",status:"completed"}}else if(t.triggerType==="task"&&t.triggerRef){const l=this.allTemplates.find(c=>c.id===t.triggerRef);s={result:`Sample result from agent task: ${(l==null?void 0:l.name)||"Selected Task"}`,recommendations:["rec 1","rec 2"],next_actions:"Sample next actions"}}}else s="Sample AI response text for validation purposes.";r.initial_step=s;const i=[];if(i[0]=s,t&&n!==void 0)for(let a=0;a<n;a++){const o=t.steps[a];let l={};const c=t.steps[a+1],u=(c==null?void 0:c.type)==="transform";if(o.type==="prompt"||o.type==="agent-task")if(u)l=`Sample AI response from ${o.name}. This is the raw text output that would be generated by the AI model when processing this step. It contains unstructured information that the transform step will extract using JSONPath queries.`;else{const d=this.allTemplates.find(h=>h.id===o.templateId);d!=null&&d.variables?l=d.variables.reduce((h,p)=>{switch(p.type){case"number":h[p.name]=42;break;case"boolean":h[p.name]=!0;break;case"array":h[p.name]=["item1","item2"];break;case"object":h[p.name]={nested:"value"};break;default:h[p.name]=`Sample ${p.name}`}return h},{}):l={result:`Sample output from ${o.name}`,step_type:o.type,step_name:o.name}}else o.type==="transform"?l={transformed_data:"Sample transformed data",step_type:"transform",step_name:o.name}:o.type==="human-in-the-loop"&&(l={human_input:"Sample human review result",approved:!0,step_type:"human-in-the-loop",step_name:o.name});i[a+1]=l}else i[1]={analysis:"Sample analysis result",confidence:.85,entities:["entity1","entity2"]},i[2]={summary:"Sample summary from step 1",items:["processed_item1","processed_item2"],metadata:{source:"step1",timestamp:"2024-01-01T00:00:00Z"}};return r.outputs=i,r}_resolveJsonPath(t,n){n.startsWith("$.")&&(n=n.substring(2));try{return n.split(".").reduce((r,s)=>{var i;if(r!=null){if(s.includes("[")&&s.includes("]")){const[a,o]=s.split("["),l=parseInt(o.replace("]",""));return(i=r[a])==null?void 0:i[l]}return r[s]}},t)}catch(r){throw new Error(`JSONPath resolution failed for ${n}: ${r instanceof Error?r.message:"Unknown error"}`)}}register(t){this.modApi=t,t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>We.createElement(kst,{module:this})})}}const Tst=({module:e})=>{const{activeRun:t,pausePayload:n}=xy(pn(d=>({activeRun:d.activeRun,pausePayload:d.pausePayload}))),[r,s]=E.useState("");if(!t||t.status!=="PAUSED"||!n)return null;const{step:i,pauseReason:a,rawAssistantResponse:o}=n,l=()=>{let d=r;if(a==="data-correction")try{d=JSON.parse(r)}catch{ke.error("Invalid JSON. Please correct the data before resuming.");return}e.resumeWorkflow(t.runId,d)},c=()=>{e.cancelWorkflow(t.runId)},u=o?(()=>{try{return JSON.stringify(JSON.parse(o),null,2)}catch{return o}})():"";return f.jsxs(Ba,{className:"m-4",children:[f.jsxs(ro,{className:"pb-2",children:[f.jsxs(so,{className:"flex items-center gap-2 text-sm",children:[f.jsx(No,{className:"h-4 w-4 text-orange-500"}),"Workflow Paused"]}),f.jsxs(dc,{className:"text-xs",children:['Step "',(i==null?void 0:i.name)||"Unknown",'" requires your input to continue.']})]}),f.jsxs(za,{className:"py-2",children:[a==="data-correction"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-xs text-muted-foreground",children:"Review and correct the data before continuing:"}),f.jsx(Mi,{value:r||u,onChange:d=>s(d.target.value),className:"text-xs font-mono",rows:6,placeholder:"Enter corrected data..."})]}),a==="human-in-the-loop"&&f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-xs text-muted-foreground",children:"Provide input to continue the workflow:"}),f.jsx(Mi,{value:r,onChange:d=>s(d.target.value),className:"text-xs",rows:3,placeholder:"Enter your input..."})]})]}),f.jsxs(nse,{className:"pt-2 gap-2",children:[f.jsxs(rt,{size:"sm",onClick:l,className:"flex-1",disabled:a==="human-in-the-loop"&&!r.trim(),children:[f.jsx(OD,{className:"h-3 w-3 mr-1"}),"Resume"]}),f.jsxs(rt,{size:"sm",variant:"outline",onClick:c,className:"flex-1",children:[f.jsx(Ri,{className:"h-3 w-3 mr-1"}),"Cancel"]})]})]})};class Ast{constructor(){ue(this,"id","core-workflow-display");ue(this,"modApi",null);ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[])}async initialize(t){this.modApi=t;const n=t.on(as.paused,()=>{}),r=t.on(as.resumed,()=>{}),s=t.on(as.completed,()=>{}),i=t.on(as.error,()=>{});this.eventUnsubscribers.push(n,r,s,i)}resumeWorkflow(t,n){var r;(r=this.modApi)==null||r.emit(as.resumeRequest,{runId:t,resumeData:n})}cancelWorkflow(t){var n;(n=this.modApi)==null||n.emit(as.cancelRequest,{runId:t})}register(t){this.modApi=t,this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",renderer:()=>We.createElement(Tst,{module:this})})}destroy(){var t;this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],(t=this.unregisterCallback)==null||t.call(this),this.modApi=null}}const Nst=Ze({enableStreamingMarkdown:Kn(),enableStreamingCodeBlockParsing:Kn(),foldStreamingCodeBlocks:Kn(),foldUserMessagesOnCompletion:Kn(),enableAutoScrollOnStream:Kn(),streamingRenderFPS:Nt().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:Nt().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),Rst=()=>{const e=gr(pn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=gr(pn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=Xs({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:Nst,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});E.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx(Mm,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx(Mm,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx(Mm,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx(Mm,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx(Mm,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Gc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(hb,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Ye("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Gc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(hb,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Ye("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(dg,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(rt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(pS,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},Ist=We.memo(Rst);class Mst{constructor(){ue(this,"id","core-settings-general");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:Ist,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const jst=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=E.useState(n??"");E.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(At,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(vn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(vn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},Pst=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],Ost=Ll(["system","light","dark","TijuLight","TijuDark","custom"]),Dst=Ze({theme:Ost,prismThemeUrl:qe(),customFontFamily:qe(),customFontSize:Nt().min(12).max(20),chatMaxWidth:qe(),customThemeColors:tp(qe(),qe().nullable())}),Fst=()=>{const e=gr(pn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=gr(pn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=Xs({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:Dst,onChangeAsyncDebounceMs:300}});E.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(sw,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(At,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(Sw,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(sw,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx($1,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Gc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(Sw,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(sw,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(Sw,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:Pst,triggerClassName:"w-full"}),f.jsx($1,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(sw,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(jst,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(dg,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(rt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(pS,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(rt,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},Lst=We.memo(Fst);class $st{constructor(){ue(this,"id","core-settings-theme");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:Lst,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Bst=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var R,M;const[c,u]=E.useState(!0),d=Vy(e.type),h=Hk(e.type),p=Wm(e.type),g=a==="fetching"||o,y=o||a==="fetching",v=o||a==="fetching",x=E.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(j=>j.id===e.apiKeyId):!1,S=d&&!w,_=E.useCallback(async(j,F)=>{const P=new Set(e.enabledModels??[]);F?P.add(j):P.delete(j);const q=Array.from(P);try{await i(e.id,{enabledModels:q})}catch(I){ke.error("Failed to update model status."),console.error("Failed to save model toggle:",I)}},[e.enabledModels,e.id,i]),k=()=>u(j=>!j),T=((R=e.enabledModels)==null?void 0:R.length)??0,A=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{children:f.jsx("span",{className:Ye("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Nr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{children:f.jsx(No,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Nr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(Nn,{tooltipText:"Edit",onClick:n,disabled:y,"aria-label":"Edit provider",icon:f.jsx(hS,{}),className:"h-8 w-8"}),f.jsx(Nn,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(to,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((M=t.find(j=>j.id===e.apiKeyId))==null?void 0:M.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),p&&f.jsx("div",{className:"pt-1",children:f.jsxs(rt,{variant:"outline",size:"sm",onClick:s,disabled:g,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Yn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(Ao,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(No,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(Jm,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",T," / ",A," enabled)"]}),f.jsx(Nn,{tooltipText:c?"Show Models":"Hide Models",onClick:k,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(Fl,{}):f.jsx(wp,{}),className:"h-6 w-6"})]}),!c&&f.jsx(I6,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:_,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},zst=We.memo(Bst),Ust=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=E.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=E.useCallback((d,h)=>{const p=new Set(t.enabledModels??[]);h?p.add(d):p.delete(d);const g=Array.from(p);o("enabledModels",g)},[t.enabledModels,o]),u=E.useCallback((d,h)=>new Promise(p=>{o(d,h),p(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(jie,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx(I6,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},qst=We.memo(Ust),Vst=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[p,g]=E.useState({name:"placeholder"}),y=Gn(M=>M.getAllAvailableModelDefsForProvider),[v,x]=E.useState([]),w=E.useMemo(()=>[...y(e.id)].sort((j,F)=>(j.name||j.id).localeCompare(F.name||F.id)),[e.id,e.fetchedModels,e.modelsLastFetchedAt,y]);E.useEffect(()=>{if(o){const M=y(e.id);x([...M].sort((j,F)=>(j.name||j.id).localeCompare(F.name||F.id))),g({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,e.fetchedModels,e.modelsLastFetchedAt,y]);const S=()=>l(!0),_=()=>{l(!1),g({}),u(!1)},k=E.useCallback(async()=>{u(!0);try{const M=p.enabledModels&&p.enabledModels.length>0?p.enabledModels:null,j={name:p.name,type:p.type,isEnabled:p.isEnabled,apiKeyId:p.apiKeyId,baseURL:p.baseURL,autoFetchModels:p.autoFetchModels,enabledModels:M};Object.keys(j).forEach(F=>{j[F]===void 0&&delete j[F]}),await n(e.id,j),l(!1),g({}),ke.success(`Provider "${j.name||e.name}" updated.`)}catch(M){console.error("Failed to save provider update:",M),ke.error("Failed to save provider configuration.")}finally{u(!1)}},[p,n,e.id,e.name]),T=E.useCallback((M,j)=>{g(F=>({...F,[M]:j}))},[]),A=E.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(M){console.error("Failed to delete provider:",M),h(!1)}}},[r,e.id,e.name]),R=E.useCallback(async()=>{if(await s(e.id),o){const M=y(e.id);x([...M].sort((j,F)=>(j.name||j.id).localeCompare(F.name||F.id)))}},[s,e.id,o,y]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(qst,{providerId:e.id,editData:p,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:_,onSave:k,onChange:T}):f.jsx(zst,{provider:e,apiKeys:t,onEdit:S,onDelete:A,onFetchModels:R,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},Wst=We.memo(Vst);function Hst(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const SN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function cv(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function hL(e){return"nodeType"in e}function fl(e){var t,n;return e?cv(e)?e:hL(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function pL(e){const{Document:t}=fl(e);return e instanceof t}function f_(e){return cv(e)?!1:e instanceof fl(e).HTMLElement}function Yce(e){return e instanceof fl(e).SVGElement}function uv(e){return e?cv(e)?e.document:hL(e)?pL(e)?e:f_(e)||Yce(e)?e.ownerDocument:document:document:document}const dd=SN?E.useLayoutEffect:E.useEffect;function mL(e){const t=E.useRef(e);return dd(()=>{t.current=e}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function Gst(){const e=E.useRef(null),t=E.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Q1(e,t){t===void 0&&(t=[e]);const n=E.useRef(e);return dd(()=>{n.current!==e&&(n.current=e)},t),n}function h_(e,t){const n=E.useRef();return E.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function ZE(e){const t=mL(e),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function MO(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let rP={};function p_(e,t){return E.useMemo(()=>{if(t)return t;const n=rP[e]==null?0:rP[e]+1;return rP[e]=n,e+"-"+n},[e,t])}function Zce(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const Ty=Zce(1),eS=Zce(-1);function Kst(e){return"clientX"in e&&"clientY"in e}function gL(e){if(!e)return!1;const{KeyboardEvent:t}=fl(e.target);return t&&e instanceof t}function Yst(e){if(!e)return!1;const{TouchEvent:t}=fl(e.target);return t&&e instanceof t}function jO(e){if(Yst(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Kst(e)?{x:e.clientX,y:e.clientY}:null}const tS=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[tS.Translate.toString(e),tS.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),rG="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Zst(e){return e.matches(rG)?e:e.querySelector(rG)}const Xst={display:"none"};function Jst(e){let{id:t,value:n}=e;return We.createElement("div",{id:t,style:Xst},n)}function Qst(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return We.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function eit(){const[e,t]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Xce=E.createContext(null);function tit(e){const t=E.useContext(Xce);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function nit(){const[e]=E.useState(()=>new Set),t=E.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[E.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const rit={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},sit={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function iit(e){let{announcements:t=sit,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=rit}=e;const{announce:i,announcement:a}=eit(),o=p_("DndLiveRegion"),[l,c]=E.useState(!1);if(E.useEffect(()=>{c(!0)},[]),tit(E.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:p}=d;t.onDragMove&&i(t.onDragMove({active:h,over:p}))},onDragOver(d){let{active:h,over:p}=d;i(t.onDragOver({active:h,over:p}))},onDragEnd(d){let{active:h,over:p}=d;i(t.onDragEnd({active:h,over:p}))},onDragCancel(d){let{active:h,over:p}=d;i(t.onDragCancel({active:h,over:p}))}}),[i,t])),!l)return null;const u=We.createElement(We.Fragment,null,We.createElement(Jst,{id:r,value:s.draggable}),We.createElement(Qst,{id:o,announcement:a}));return n?Nl.createPortal(u,n):u}var na;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(na||(na={}));function XE(){}function sG(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ait(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const ou=Object.freeze({x:0,y:0});function Jce(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Qce(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function oit(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function iG(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function eue(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function aG(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const lit=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=aG(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=Jce(aG(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(Qce)},cit=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=iG(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=iG(l),u=s.reduce((h,p,g)=>h+Jce(c[g],p),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(Qce)};function uit(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const dit=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=uit(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(oit)};function fit(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function tue(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ou}function hit(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const pit=hit(1);function mit(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function git(e,t,n){const r=mit(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const yit={ignoreTransform:!1};function dv(e,t){t===void 0&&(t=yit);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=fl(e).getComputedStyle(e);c&&(n=git(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function oG(e){return dv(e,{ignoreTransform:!0})}function bit(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function vit(e,t){return t===void 0&&(t=fl(e).getComputedStyle(e)),t.position==="fixed"}function xit(e,t){t===void 0&&(t=fl(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function _N(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(pL(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!f_(s)||Yce(s)||n.includes(s))return n;const i=fl(e).getComputedStyle(s);return s!==e&&xit(s,i)&&n.push(s),vit(s,i)?n:r(s.parentNode)}return e?r(e):n}function nue(e){const[t]=_N(e,1);return t??null}function sP(e){return!SN||!e?null:cv(e)?e:hL(e)?pL(e)||e===uv(e).scrollingElement?window:f_(e)?e:null:null}function rue(e){return cv(e)?e.scrollX:e.scrollLeft}function sue(e){return cv(e)?e.scrollY:e.scrollTop}function PO(e){return{x:rue(e),y:sue(e)}}var xa;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(xa||(xa={}));function iue(e){return!SN||!e?!1:e===document.scrollingElement}function aue(e){const t={x:0,y:0},n=iue(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const wit={x:.2,y:.2};function Sit(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=wit);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=aue(e),p={x:0,y:0},g={x:0,y:0},y={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+y.height?(p.y=xa.Backward,g.y=r*Math.abs((t.top+y.height-i)/y.height)):!u&&l>=t.bottom-y.height&&(p.y=xa.Forward,g.y=r*Math.abs((t.bottom-y.height-l)/y.height)),!h&&o>=t.right-y.width?(p.x=xa.Forward,g.x=r*Math.abs((t.right-y.width-o)/y.width)):!d&&a<=t.left+y.width&&(p.x=xa.Backward,g.x=r*Math.abs((t.left+y.width-a)/y.width)),{direction:p,speed:g}}function _it(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function oue(e){return e.reduce((t,n)=>Ty(t,PO(n)),ou)}function Cit(e){return e.reduce((t,n)=>t+rue(n),0)}function kit(e){return e.reduce((t,n)=>t+sue(n),0)}function Eit(e,t){if(t===void 0&&(t=dv),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);nue(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Tit=[["x",["left","right"],Cit],["y",["top","bottom"],kit]];class yL{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=_N(n),s=oue(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of Tit)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class kw{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Ait(e){const{EventTarget:t}=fl(e);return e instanceof t?e:uv(e)}function iP(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var sc;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(sc||(sc={}));function lG(e){e.preventDefault()}function Nit(e){e.stopPropagation()}var Yr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Yr||(Yr={}));const lue={start:[Yr.Space,Yr.Enter],cancel:[Yr.Esc],end:[Yr.Space,Yr.Enter,Yr.Tab]},Rit=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Yr.Right:return{...n,x:n.x+25};case Yr.Left:return{...n,x:n.x-25};case Yr.Down:return{...n,y:n.y+25};case Yr.Up:return{...n,y:n.y-25}}};class bL{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new kw(uv(n)),this.windowListeners=new kw(fl(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(sc.Resize,this.handleCancel),this.windowListeners.add(sc.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(sc.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Eit(r),n(ou)}handleKeyDown(t){if(gL(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=lue,coordinateGetter:a=Rit,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:ou;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=eS(d,u),p={x:0,y:0},{scrollableAncestors:g}=r.current;for(const y of g){const v=t.code,{isTop:x,isRight:w,isLeft:S,isBottom:_,maxScroll:k,minScroll:T}=aue(y),A=_it(y),R={x:Math.min(v===Yr.Right?A.right-A.width/2:A.right,Math.max(v===Yr.Right?A.left:A.left+A.width/2,d.x)),y:Math.min(v===Yr.Down?A.bottom-A.height/2:A.bottom,Math.max(v===Yr.Down?A.top:A.top+A.height/2,d.y))},M=v===Yr.Right&&!w||v===Yr.Left&&!S,j=v===Yr.Down&&!_||v===Yr.Up&&!x;if(M&&R.x!==d.x){const F=y.scrollLeft+h.x,P=v===Yr.Right&&F<=k.x||v===Yr.Left&&F>=T.x;if(P&&!h.y){y.scrollTo({left:F,behavior:o});return}P?p.x=y.scrollLeft-F:p.x=v===Yr.Right?y.scrollLeft-k.x:y.scrollLeft-T.x,p.x&&y.scrollBy({left:-p.x,behavior:o});break}else if(j&&R.y!==d.y){const F=y.scrollTop+h.y,P=v===Yr.Down&&F<=k.y||v===Yr.Up&&F>=T.y;if(P&&!h.x){y.scrollTo({top:F,behavior:o});return}P?p.y=y.scrollTop-F:p.y=v===Yr.Down?y.scrollTop-k.y:y.scrollTop-T.y,p.y&&y.scrollBy({top:-p.y,behavior:o});break}}this.handleMove(t,Ty(eS(d,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}bL.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=lue,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function cG(e){return!!(e&&"distance"in e)}function uG(e){return!!(e&&"delay"in e)}class vL{constructor(t,n,r){var s;r===void 0&&(r=Ait(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=uv(a),this.documentListeners=new kw(this.document),this.listeners=new kw(r),this.windowListeners=new kw(fl(a)),this.initialCoordinates=(s=jO(i))!=null?s:ou,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(sc.Resize,this.handleCancel),this.windowListeners.add(sc.DragStart,lG),this.windowListeners.add(sc.VisibilityChange,this.handleCancel),this.windowListeners.add(sc.ContextMenu,lG),this.documentListeners.add(sc.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(uG(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(cG(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(sc.Click,Nit,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(sc.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=jO(t))!=null?n:ou,c=eS(s,l);if(!r&&o){if(cG(o)){if(o.tolerance!=null&&iP(c,o.tolerance))return this.handleCancel();if(iP(c,o.distance))return this.handleStart()}if(uG(o)&&iP(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Yr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Iit={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class xL extends vL{constructor(t){const{event:n}=t,r=uv(n.target);super(t,Iit,r)}}xL.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const Mit={move:{name:"mousemove"},end:{name:"mouseup"}};var OO;(function(e){e[e.RightClick=2]="RightClick"})(OO||(OO={}));class jit extends vL{constructor(t){super(t,Mit,uv(t.event.target))}}jit.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===OO.RightClick?!1:(r==null||r({event:n}),!0)}}];const aP={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Pit extends vL{constructor(t){super(t,aP)}static setup(){return window.addEventListener(aP.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(aP.move.name,t)};function t(){}}}Pit.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Ew;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Ew||(Ew={}));var JE;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(JE||(JE={}));function Oit(e){let{acceleration:t,activator:n=Ew.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=JE.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const p=Fit({delta:d,disabled:!i}),[g,y]=Gst(),v=E.useRef({x:0,y:0}),x=E.useRef({x:0,y:0}),w=E.useMemo(()=>{switch(n){case Ew.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Ew.DraggableRect:return s}},[n,s,l]),S=E.useRef(null),_=E.useCallback(()=>{const T=S.current;if(!T)return;const A=v.current.x*x.current.x,R=v.current.y*x.current.y;T.scrollBy(A,R)},[]),k=E.useMemo(()=>o===JE.TreeOrder?[...c].reverse():c,[o,c]);E.useEffect(()=>{if(!i||!c.length||!w){y();return}for(const T of k){if((r==null?void 0:r(T))===!1)continue;const A=c.indexOf(T),R=u[A];if(!R)continue;const{direction:M,speed:j}=Sit(T,R,w,t,h);for(const F of["x","y"])p[F][M[F]]||(j[F]=0,M[F]=0);if(j.x>0||j.y>0){y(),S.current=T,g(_,a),v.current=j,x.current=M;return}}v.current={x:0,y:0},x.current={x:0,y:0},y()},[t,_,r,y,i,a,JSON.stringify(w),JSON.stringify(p),g,c,k,u,JSON.stringify(h)])}const Dit={x:{[xa.Backward]:!1,[xa.Forward]:!1},y:{[xa.Backward]:!1,[xa.Forward]:!1}};function Fit(e){let{delta:t,disabled:n}=e;const r=MO(t);return h_(s=>{if(n||!r||!s)return Dit;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[xa.Backward]:s.x[xa.Backward]||i.x===-1,[xa.Forward]:s.x[xa.Forward]||i.x===1},y:{[xa.Backward]:s.y[xa.Backward]||i.y===-1,[xa.Forward]:s.y[xa.Forward]||i.y===1}}},[n,t,r])}function Lit(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return h_(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function $it(e,t){return E.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var nS;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(nS||(nS={}));var DO;(function(e){e.Optimized="optimized"})(DO||(DO={}));const dG=new Map;function Bit(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=E.useState(null),{frequency:o,measure:l,strategy:c}=s,u=E.useRef(e),d=v(),h=Q1(d),p=E.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(S=>!w.includes(S))))},[h]),g=E.useRef(null),y=h_(x=>{if(d&&!n)return dG;if(!x||x===dG||u.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const _=S.node.current,k=_?new yL(l(_),_):null;S.rect.current=k,k&&w.set(S.id,k)}return w}return x},[e,i,n,d,l]);return E.useEffect(()=>{u.current=e},[e]),E.useEffect(()=>{d||p()},[n,d]),E.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),E.useEffect(()=>{d||typeof o!="number"||g.current!==null||(g.current=setTimeout(()=>{p(),g.current=null},o))},[o,d,p,...r]),{droppableRects:y,measureDroppableContainers:p,measuringScheduled:i!=null};function v(){switch(c){case nS.Always:return!1;case nS.BeforeDragging:return n;default:return!n}}}function cue(e,t){return h_(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function zit(e,t){return cue(e,t)}function Uit(e){let{callback:t,disabled:n}=e;const r=mL(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function CN(e){let{callback:t,disabled:n}=e;const r=mL(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function qit(e){return new yL(dv(e),e)}function fG(e,t,n){t===void 0&&(t=qit);const[r,s]=E.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=Uit({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=CN({callback:i});return dd(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function Vit(e){const t=cue(e);return tue(e,t)}const hG=[];function Wit(e){const t=E.useRef(e),n=h_(r=>e?r&&r!==hG&&e&&t.current&&e.parentNode===t.current.parentNode?r:_N(e):hG,[e]);return E.useEffect(()=>{t.current=e},[e]),n}function Hit(e){const[t,n]=E.useState(null),r=E.useRef(e),s=E.useCallback(i=>{const a=sP(i.target);a&&n(o=>o?(o.set(a,PO(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=sP(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,PO(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=sP(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>Ty(i,a),ou):oue(e):ou,[e,t])}function pG(e,t){t===void 0&&(t=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},t),E.useEffect(()=>{const r=e!==ou;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?eS(e,n.current):ou}function Git(e){E.useEffect(()=>{if(!SN)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Kit(e,t){return E.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function uue(e){return E.useMemo(()=>e?bit(e):null,[e])}const mG=[];function Yit(e,t){t===void 0&&(t=dv);const[n]=e,r=uue(n?fl(n):null),[s,i]=E.useState(mG);function a(){i(()=>e.length?e.map(l=>iue(l)?r:new yL(t(l),l)):mG)}const o=CN({callback:a});return dd(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function Zit(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return f_(t)?t:e}function Xit(e){let{measure:t}=e;const[n,r]=E.useState(null),s=E.useCallback(c=>{for(const{target:u}of c)if(f_(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=CN({callback:s}),a=E.useCallback(c=>{const u=Zit(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=ZE(a);return E.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const Jit=[{sensor:xL,options:{}},{sensor:bL,options:{}}],Qit={current:{}},ik={draggable:{measure:oG},droppable:{measure:oG,strategy:nS.WhileDragging,frequency:DO.Optimized},dragOverlay:{measure:dv}};class Tw extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const eat={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Tw,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:XE},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ik,measureDroppableContainers:XE,windowRect:null,measuringScheduled:!1},tat={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:XE,draggableNodes:new Map,over:null,measureDroppableContainers:XE},kN=E.createContext(tat),due=E.createContext(eat);function nat(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Tw}}}function rat(e,t){switch(t.type){case na.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case na.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case na.DragEnd:case na.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case na.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Tw(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case na.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Tw(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case na.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Tw(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function sat(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(kN),i=MO(r),a=MO(n==null?void 0:n.id);return E.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!gL(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=Zst(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function iat(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function aat(e){return E.useMemo(()=>({draggable:{...ik.draggable,...e==null?void 0:e.draggable},droppable:{...ik.droppable,...e==null?void 0:e.droppable},dragOverlay:{...ik.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function oat(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=E.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;dd(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=tue(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=nue(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const fue=E.createContext({...ou,scaleX:1,scaleY:1});var zh;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(zh||(zh={}));const lat=E.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=Jit,collisionDetection:d=dit,measuring:h,modifiers:p,...g}=t;const y=E.useReducer(rat,void 0,nat),[v,x]=y,[w,S]=nit(),[_,k]=E.useState(zh.Uninitialized),T=_===zh.Initialized,{draggable:{active:A,nodes:R,translate:M},droppable:{containers:j}}=v,F=A!=null?R.get(A):null,P=E.useRef({initial:null,translated:null}),q=E.useMemo(()=>{var tt;return A!=null?{id:A,data:(tt=F==null?void 0:F.data)!=null?tt:Qit,rect:P}:null},[A,F]),I=E.useRef(null),[V,D]=E.useState(null),[z,$]=E.useState(null),Y=Q1(g,Object.values(g)),B=p_("DndDescribedBy",a),G=E.useMemo(()=>j.getEnabled(),[j]),Z=aat(h),{droppableRects:ne,measureDroppableContainers:ae,measuringScheduled:le}=Bit(G,{dragging:T,dependencies:[M.x,M.y],config:Z.droppable}),Se=Lit(R,A),Ee=E.useMemo(()=>z?jO(z):null,[z]),he=Ve(),pe=zit(Se,Z.draggable.measure);oat({activeNode:A!=null?R.get(A):null,config:he.layoutShiftCompensation,initialRect:pe,measure:Z.draggable.measure});const Le=fG(Se,Z.draggable.measure,pe),He=fG(Se?Se.parentElement:null),Fe=E.useRef({activatorEvent:null,active:null,activeNode:Se,collisionRect:null,collisions:null,droppableRects:ne,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:j,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ie=j.getNodeFor((n=Fe.current.over)==null?void 0:n.id),X=Xit({measure:Z.dragOverlay.measure}),ye=(r=X.nodeRef.current)!=null?r:Se,Ne=T?(s=X.rect)!=null?s:Le:null,fe=!!(X.nodeRef.current&&X.rect),ce=Vit(fe?null:Le),se=uue(ye?fl(ye):null),Pe=Wit(T?Ie??Se:null),Be=Yit(Pe),je=iat(p,{transform:{x:M.x-ce.x,y:M.y-ce.y,scaleX:1,scaleY:1},activatorEvent:z,active:q,activeNodeRect:Le,containerNodeRect:He,draggingNodeRect:Ne,over:Fe.current.over,overlayNodeRect:X.rect,scrollableAncestors:Pe,scrollableAncestorRects:Be,windowRect:se}),ot=Ee?Ty(Ee,M):null,Et=Hit(Pe),ut=pG(Et),Pt=pG(Et,[Le]),$t=Ty(je,ut),Ft=Ne?pit(Ne,je):null,Ht=q&&Ft?d({active:q,collisionRect:Ft,droppableRects:ne,droppableContainers:G,pointerCoordinates:ot}):null,Ce=eue(Ht,"id"),[U,ee]=E.useState(null),xe=fe?je:Ty(je,Pt),Re=fit(xe,(i=U==null?void 0:U.rect)!=null?i:null,Le),ve=E.useRef(null),Me=E.useCallback((tt,we)=>{let{sensor:Te,options:Ue}=we;if(I.current==null)return;const Ct=R.get(I.current);if(!Ct)return;const me=tt.nativeEvent,Q=new Te({active:I.current,activeNode:Ct,event:me,options:Ue,context:Fe,onAbort(te){if(!R.get(te))return;const{onDragAbort:$e}=Y.current,Ge={id:te};$e==null||$e(Ge),w({type:"onDragAbort",event:Ge})},onPending(te,_e,$e,Ge){if(!R.get(te))return;const{onDragPending:Jt}=Y.current,jn={id:te,constraint:_e,initialCoordinates:$e,offset:Ge};Jt==null||Jt(jn),w({type:"onDragPending",event:jn})},onStart(te){const _e=I.current;if(_e==null)return;const $e=R.get(_e);if(!$e)return;const{onDragStart:Ge}=Y.current,wt={activatorEvent:me,active:{id:_e,data:$e.data,rect:P}};Nl.unstable_batchedUpdates(()=>{Ge==null||Ge(wt),k(zh.Initializing),x({type:na.DragStart,initialCoordinates:te,active:_e}),w({type:"onDragStart",event:wt}),D(ve.current),$(me)})},onMove(te){x({type:na.DragMove,coordinates:te})},onEnd:J(na.DragEnd),onCancel:J(na.DragCancel)});ve.current=Q;function J(te){return async function(){const{active:$e,collisions:Ge,over:wt,scrollAdjustedTranslate:Jt}=Fe.current;let jn=null;if($e&&Jt){const{cancelDrop:Gt}=Y.current;jn={activatorEvent:me,active:$e,collisions:Ge,delta:Jt,over:wt},te===na.DragEnd&&typeof Gt=="function"&&await Promise.resolve(Gt(jn))&&(te=na.DragCancel)}I.current=null,Nl.unstable_batchedUpdates(()=>{x({type:te}),k(zh.Uninitialized),ee(null),D(null),$(null),ve.current=null;const Gt=te===na.DragEnd?"onDragEnd":"onDragCancel";if(jn){const rn=Y.current[Gt];rn==null||rn(jn),w({type:Gt,event:jn})}})}}},[R]),de=E.useCallback((tt,we)=>(Te,Ue)=>{const Ct=Te.nativeEvent,me=R.get(Ue);if(I.current!==null||!me||Ct.dndKit||Ct.defaultPrevented)return;const Q={active:me};tt(Te,we.options,Q)===!0&&(Ct.dndKit={capturedBy:we.sensor},I.current=Ue,Me(Te,we))},[R,Me]),ht=$it(u,de);Git(u),dd(()=>{Le&&_===zh.Initializing&&k(zh.Initialized)},[Le,_]),E.useEffect(()=>{const{onDragMove:tt}=Y.current,{active:we,activatorEvent:Te,collisions:Ue,over:Ct}=Fe.current;if(!we||!Te)return;const me={active:we,activatorEvent:Te,collisions:Ue,delta:{x:$t.x,y:$t.y},over:Ct};Nl.unstable_batchedUpdates(()=>{tt==null||tt(me),w({type:"onDragMove",event:me})})},[$t.x,$t.y]),E.useEffect(()=>{const{active:tt,activatorEvent:we,collisions:Te,droppableContainers:Ue,scrollAdjustedTranslate:Ct}=Fe.current;if(!tt||I.current==null||!we||!Ct)return;const{onDragOver:me}=Y.current,Q=Ue.get(Ce),J=Q&&Q.rect.current?{id:Q.id,rect:Q.rect.current,data:Q.data,disabled:Q.disabled}:null,te={active:tt,activatorEvent:we,collisions:Te,delta:{x:Ct.x,y:Ct.y},over:J};Nl.unstable_batchedUpdates(()=>{ee(J),me==null||me(te),w({type:"onDragOver",event:te})})},[Ce]),dd(()=>{Fe.current={activatorEvent:z,active:q,activeNode:Se,collisionRect:Ft,collisions:Ht,droppableRects:ne,draggableNodes:R,draggingNode:ye,draggingNodeRect:Ne,droppableContainers:j,over:U,scrollableAncestors:Pe,scrollAdjustedTranslate:$t},P.current={initial:Ne,translated:Ft}},[q,Se,Ht,Ft,R,ye,Ne,ne,j,U,Pe,$t]),Oit({...he,delta:M,draggingRect:Ft,pointerCoordinates:ot,scrollableAncestors:Pe,scrollableAncestorRects:Be});const et=E.useMemo(()=>({active:q,activeNode:Se,activeNodeRect:Le,activatorEvent:z,collisions:Ht,containerNodeRect:He,dragOverlay:X,draggableNodes:R,droppableContainers:j,droppableRects:ne,over:U,measureDroppableContainers:ae,scrollableAncestors:Pe,scrollableAncestorRects:Be,measuringConfiguration:Z,measuringScheduled:le,windowRect:se}),[q,Se,Le,z,Ht,He,X,R,j,ne,U,ae,Pe,Be,Z,le,se]),W=E.useMemo(()=>({activatorEvent:z,activators:ht,active:q,activeNodeRect:Le,ariaDescribedById:{draggable:B},dispatch:x,draggableNodes:R,over:U,measureDroppableContainers:ae}),[z,ht,q,Le,x,B,R,U,ae]);return We.createElement(Xce.Provider,{value:S},We.createElement(kN.Provider,{value:W},We.createElement(due.Provider,{value:et},We.createElement(fue.Provider,{value:Re},c)),We.createElement(sat,{disabled:(o==null?void 0:o.restoreFocus)===!1})),We.createElement(iit,{...o,hiddenTextDescribedById:B}));function Ve(){const tt=(V==null?void 0:V.autoScrollEnabled)===!1,we=typeof l=="object"?l.enabled===!1:l===!1,Te=T&&!tt&&!we;return typeof l=="object"?{...l,enabled:Te}:{enabled:Te}}}),cat=E.createContext(null),gG="button",uat="Draggable";function dat(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=p_(uat),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=E.useContext(kN),{role:p=gG,roleDescription:g="draggable",tabIndex:y=0}=s??{},v=(l==null?void 0:l.id)===t,x=E.useContext(v?fue:cat),[w,S]=ZE(),[_,k]=ZE(),T=Kit(a,t),A=Q1(n);dd(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:_,data:A}),()=>{const M=d.get(t);M&&M.key===i&&d.delete(t)}),[d,t]);const R=E.useMemo(()=>({role:p,tabIndex:y,"aria-disabled":r,"aria-pressed":v&&p===gG?!0:void 0,"aria-roledescription":g,"aria-describedby":u.draggable}),[r,p,y,v,g,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:R,isDragging:v,listeners:r?void 0:T,node:w,over:h,setNodeRef:S,setActivatorNodeRef:k,transform:x}}function fat(){return E.useContext(due)}const hat="Droppable",pat={timeout:25};function mat(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=p_(hat),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=E.useContext(kN),u=E.useRef({disabled:n}),d=E.useRef(!1),h=E.useRef(null),p=E.useRef(null),{disabled:g,updateMeasurementsFor:y,timeout:v}={...pat,...s},x=Q1(y??r),w=E.useCallback(()=>{if(!d.current){d.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),p.current=null},v)},[v]),S=CN({callback:w,disabled:g||!a}),_=E.useCallback((R,M)=>{S&&(M&&(S.unobserve(M),d.current=!1),R&&S.observe(R))},[S]),[k,T]=ZE(_),A=Q1(t);return E.useEffect(()=>{!S||!k.current||(S.disconnect(),d.current=!1,S.observe(k.current))},[k,S]),E.useEffect(()=>(o({type:na.RegisterDroppable,element:{id:r,key:i,disabled:n,node:k,rect:h,data:A}}),()=>o({type:na.UnregisterDroppable,key:i,id:r})),[r]),E.useEffect(()=>{n!==u.current.disabled&&(o({type:na.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:k,over:l,setNodeRef:T}}function Aw(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function gat(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function T2(e){return e!==null&&e>=0}function yat(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function bat(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const hue=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Aw(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},A2={scaleX:1,scaleY:1},vat=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...A2}:null}const l=xat(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...A2}:s<n&&s>=a?{x:0,y:o.height+l,...A2}:{x:0,y:0,...A2}};function xat(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const pue="Sortable",mue=We.createContext({activeIndex:-1,containerId:pue,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:hue,disabled:{draggable:!1,droppable:!1}});function wat(e){let{children:t,id:n,items:r,strategy:s=hue,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=fat(),d=p_(pue,n),h=o.rect!==null,p=E.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),g=a!=null,y=a?p.indexOf(a.id):-1,v=c?p.indexOf(c.id):-1,x=E.useRef(p),w=!yat(p,x.current),S=v!==-1&&y===-1||w,_=bat(i);dd(()=>{w&&g&&u(p)},[w,p,g,u]),E.useEffect(()=>{x.current=p},[p]);const k=E.useMemo(()=>({activeIndex:y,containerId:d,disabled:_,disableTransforms:S,items:p,overIndex:v,useDragOverlay:h,sortedRects:gat(p,l),strategy:s}),[y,d,_.draggable,_.droppable,S,p,v,l,h,s]);return We.createElement(mue.Provider,{value:k},t)}const Sat=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Aw(n,r,s).indexOf(t)},_at=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},Cat={duration:200,easing:"ease"},gue="transform",kat=tS.Transition.toString({property:gue,duration:0,easing:"linear"}),Eat={roleDescription:"sortable"};function Tat(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=E.useState(null),o=E.useRef(n);return dd(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=dv(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),E.useEffect(()=>{i&&a(null)},[i]),i}function Aat(e){let{animateLayoutChanges:t=_at,attributes:n,disabled:r,data:s,getNewIndex:i=Sat,id:a,strategy:o,resizeObserverConfig:l,transition:c=Cat}=e;const{items:u,containerId:d,activeIndex:h,disabled:p,disableTransforms:g,sortedRects:y,overIndex:v,useDragOverlay:x,strategy:w}=E.useContext(mue),S=Nat(r,p),_=u.indexOf(a),k=E.useMemo(()=>({sortable:{containerId:d,index:_,items:u},...s}),[d,s,_,u]),T=E.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:A,node:R,isOver:M,setNodeRef:j}=mat({id:a,data:k,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...l}}),{active:F,activatorEvent:P,activeNodeRect:q,attributes:I,setNodeRef:V,listeners:D,isDragging:z,over:$,setActivatorNodeRef:Y,transform:B}=dat({id:a,data:k,attributes:{...Eat,...n},disabled:S.draggable}),G=Hst(j,V),Z=!!F,ne=Z&&!g&&T2(h)&&T2(v),ae=!x&&z,le=ae&&ne?B:null,Ee=ne?le??(o??w)({rects:y,activeNodeRect:q,activeIndex:h,overIndex:v,index:_}):null,he=T2(h)&&T2(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):_,pe=F==null?void 0:F.id,Le=E.useRef({activeId:pe,items:u,newIndex:he,containerId:d}),He=u!==Le.current.items,Fe=t({active:F,containerId:d,isDragging:z,isSorting:Z,id:a,index:_,items:u,newIndex:Le.current.newIndex,previousItems:Le.current.items,previousContainerId:Le.current.containerId,transition:c,wasDragging:Le.current.activeId!=null}),Ie=Tat({disabled:!Fe,index:_,node:R,rect:A});return E.useEffect(()=>{Z&&Le.current.newIndex!==he&&(Le.current.newIndex=he),d!==Le.current.containerId&&(Le.current.containerId=d),u!==Le.current.items&&(Le.current.items=u)},[Z,he,d,u]),E.useEffect(()=>{if(pe===Le.current.activeId)return;if(pe!=null&&Le.current.activeId==null){Le.current.activeId=pe;return}const ye=setTimeout(()=>{Le.current.activeId=pe},50);return()=>clearTimeout(ye)},[pe]),{active:F,activeIndex:h,attributes:I,data:k,rect:A,index:_,newIndex:he,items:u,isOver:M,isSorting:Z,isDragging:z,listeners:D,node:R,overIndex:v,over:$,setNodeRef:G,setActivatorNodeRef:Y,setDroppableNodeRef:j,setDraggableNodeRef:V,transform:Ie??Ee,transition:X()};function X(){if(Ie||He&&Le.current.newIndex===_)return kat;if(!(ae&&!gL(P)||!c)&&(Z||Fe))return tS.Transition.toString({...c,property:gue})}}function Nat(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function QE(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Rat=[Yr.Down,Yr.Right,Yr.Up,Yr.Left],Iat=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(Rat.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Yr.Down:r.top<h.top&&l.push(d);break;case Yr.Up:r.top>h.top&&l.push(d);break;case Yr.Left:r.left>h.left&&l.push(d);break;case Yr.Right:r.left<h.left&&l.push(d);break}});const c=cit({collisionRect:r,droppableRects:s,droppableContainers:l});let u=eue(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),p=h?s.get(h.id):null,g=h==null?void 0:h.node.current;if(g&&p&&d&&h){const v=_N(g).some((T,A)=>o[A]!==T),x=yue(d,h),w=Mat(d,h),S=v||!x?{x:0,y:0}:{x:w?r.width-p.width:0,y:w?r.height-p.height:0},_={x:p.left,y:p.top};return S.x&&S.y?_:eS(_,S)}}}};function yue(e,t){return!QE(e)||!QE(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function Mat(e,t){return!QE(e)||!QE(t)||!yue(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const jat=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var k,T,A;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:p}=Aat({id:e,disabled:!1}),g={transform:tS.Transform.toString(d),transition:h,zIndex:p?10:void 0},y=new Set(((k=t.metadataSummary)==null?void 0:k.supported_parameters)??[]),v=new Set(((T=t.metadataSummary)==null?void 0:T.input_modalities)??[]),x=y.has("reasoning"),w=y.has("web_search")||y.has("web_search_options"),S=y.has("tools"),_=Array.from(v).some(R=>R!=="text");return f.jsxs("div",{ref:u,style:g,className:Ye("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",p&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Ye("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(eve,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(At,{className:Ye("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Pb,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(Ro,{className:"h-3 w-3 text-green-500"}),S&&f.jsx(Jh,{className:"h-3 w-3 text-orange-500"}),_&&f.jsx(sd,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((A=t.metadataSummary)==null?void 0:A.description)&&f.jsx(Er,{delayDuration:100,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(jD,{className:"h-4 w-4"})})}),f.jsx(Nr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(Nn,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(tbe,{}),className:"h-6 w-6"}),f.jsx(Nn,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(jye,{}),className:"h-6 w-6"}),f.jsx(Nn,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(aY,{}),className:"h-6 w-6"})]})]})},Pat=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Gn(pn(S=>({dbProviderConfigs:S.dbProviderConfigs,globalModelSortOrder:S.globalModelSortOrder,isLoading:S.isLoading,getAvailableModelListItems:S.getAvailableModelListItems}))),[i,a]=E.useState(""),[o,l]=E.useState(()=>new Set(t.map(S=>S.id))),[c,u]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});E.useEffect(()=>{l(new Set(t.map(S=>S.id)))},[t]);const d=E.useMemo(()=>{const S=s(),_=new Map(S.map(M=>[M.id,M])),k=new Set;t.forEach(M=>{M.isEnabled&&M.enabledModels&&M.enabledModels.forEach(j=>{k.add(dw(M.id,j))})});const T=S.filter(M=>k.has(M.id)),A=[],R=new Set;return n.forEach(M=>{if(k.has(M)){const j=_.get(M);j&&!R.has(M)&&(A.push(j),R.add(M))}}),T.forEach(M=>{R.has(M.id)||A.push(M)}),A},[t,n,s]),h=E.useMemo(()=>{let S=d;if(o.size!==t.length&&(S=S.filter(k=>o.has(k.providerId))),i.trim()){const k=i.toLowerCase();S=S.filter(T=>T.name.toLowerCase().includes(k)||T.providerName.toLowerCase().includes(k)||T.id.toLowerCase().includes(k))}const _=Object.entries(c).filter(([,k])=>k).map(([k])=>k);return _.length>0&&(S=S.filter(k=>{var R,M;const T=new Set(((R=k.metadataSummary)==null?void 0:R.supported_parameters)??[]),A=new Set(((M=k.metadataSummary)==null?void 0:M.input_modalities)??[]);return _.every(j=>{switch(j){case"reasoning":return T.has("reasoning");case"webSearch":return T.has("web_search")||T.has("web_search_options");case"tools":return T.has("tools");case"multimodal":return Array.from(A).some(F=>F!=="text");default:return!0}})})),S},[d,i,o,t.length,c]),p=E.useMemo(()=>i.trim().length>0||o.size!==t.length||Object.values(c).some(Boolean),[i,o,t.length,c]),g=E.useMemo(()=>{const S=o.size!==t.length?1:0,_=Object.values(c).filter(Boolean).length;return S+_},[o,t.length,c]),y=E.useMemo(()=>h.map(S=>S.id),[h]),v=E.useCallback(S=>{const{active:_,over:k}=S;if(k&&_.id!==k.id){const T=d.map(F=>F.id),A=_.id,R=k.id,M=T.indexOf(A),j=T.indexOf(R);if(M!==-1&&j!==-1){const F=Aw(T,M,j);e(F)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[d,e]),x=E.useCallback((S,_)=>{if(p)return;const k=d.map(R=>R.id),T=k.indexOf(S);if(T===-1)return;let A;if(_==="top"){if(T===0)return;const R=k.splice(T,1)[0];k.unshift(R),A=k}else if(_==="up"){if(T===0)return;A=Aw(k,T,T-1)}else{if(T===k.length-1)return;A=Aw(k,T,T+1)}e(A)},[d,e,p]),w=ait(sG(xL),sG(bL,{coordinateGetter:Iat}));return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Zr,{className:"h-8 w-1/3"}),f.jsx(Zr,{className:"h-6 w-1/2"}),f.jsx(Zr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(dg,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(At,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:S=>a(S.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsx(R6,{currentCapabilityFilters:c,onCapabilityFilterChange:u,currentSelectedProviders:o,onProviderFilterChange:l,allProviders:t,showProviderFilter:!0,showCapabilityFilters:!0,disabled:r||t.length===0,totalActiveFilters:g})]}),f.jsx("div",{className:"w-full rounded-md border border-border p-3 bg-background/50",children:h.length>0?f.jsx(lat,{sensors:w,collisionDetection:lit,onDragEnd:v,children:f.jsx(wat,{items:y,strategy:vat,children:h.map(S=>f.jsx(jat,{id:S.id,modelDetails:S,onMoveToTop:()=>x(S.id,"top"),onMoveUp:()=>x(S.id,"up"),onMoveDown:()=>x(S.id,"down"),isFirst:d.findIndex(_=>_.id===S.id)===0,isLast:d.findIndex(_=>_.id===S.id)===d.length-1,buttonsDisabled:p},S.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:p?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},N2=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Jl=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(js,{children:[f.jsx(zn,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(zn,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(cs,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(cs,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),Oat=({modelId:e})=>{var p,g,y,v,x,w,S,_,k,T,A,R;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Gn(pn(M=>({createAiModelConfig:M.createAiModelConfig,dbProviderConfigs:M.dbProviderConfigs,dbApiKeys:M.dbApiKeys,updateProviderConfig:M.updateProviderConfig,isLoading:M.isLoading}))),a=E.useMemo(()=>{if(!e)return;const{providerId:M,modelId:j}=uc(e);if(!M||!j)return;const F=n.find(q=>q.id===M);if(!F)return;const P=r.find(q=>q.id===F.apiKeyId);return t(F,j,P==null?void 0:P.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=E.useCallback(async()=>{if(!a||!e)return;const{providerId:M,modelId:j}=uc(e);if(!M||!j)return;const F=n.find(V=>V.id===M);if(!F){ke.error("Provider configuration not found.");return}const P=new Set(F.enabledModels??[]),q=P.has(j);q?P.delete(j):P.add(j);const I=Array.from(P);try{await s(F.id,{enabledModels:I}),ke.success(`Model "${a.name}" ${q?"disabled":"enabled"}.`)}catch{ke.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Zr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Zr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Zr,{className:"h-10 w-full"}),f.jsx(Zr,{className:"h-10 w-full"}),f.jsx(Zr,{className:"h-10 w-full"}),f.jsx(Zr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(No,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(No,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=uc(e),d=n.find(M=>M.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((p=d==null?void 0:d.enabledModels)==null?void 0:p.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(At,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(Eo,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(ul,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(zf,{children:[f.jsxs($He,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(Uf,{children:[Jl("Context Length",((g=o.top_provider)==null?void 0:g.context_length)??o.context_length),Jl("Max Completion Tokens",(y=o.top_provider)==null?void 0:y.max_completion_tokens),Jl("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),Jl("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Jl("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),Jl("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),Jl("Pricing (Prompt)",N2((_=o.pricing)==null?void 0:_.prompt)),Jl("Pricing (Completion)",N2((k=o.pricing)==null?void 0:k.completion)),Jl("Pricing (Image)",N2((T=o.pricing)==null?void 0:T.image)),Jl("Pricing (Request)",N2((A=o.pricing)==null?void 0:A.request)),Jl("Supported Parameters",o.supported_parameters),Jl("Moderated",(R=o.top_provider)!=null&&R.is_moderated?f.jsx(dS,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},Dat=()=>{const{apiKeys:e,addApiKey:t,updateApiKey:n,deleteApiKey:r,isLoading:s}=Gn(pn(k=>({apiKeys:k.dbApiKeys,addApiKey:k.addApiKey,updateApiKey:k.updateApiKey,deleteApiKey:k.deleteApiKey,isLoading:k.isLoading}))),[i,a]=E.useState(!1),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[p,g]=E.useState({}),y=E.useCallback(async(k,T,A)=>{l(!0);try{await t(k,T,A),a(!1)}catch(R){console.error("Failed to add API key (from component):",R)}finally{l(!1)}},[t]),v=E.useCallback(async(k,T,A,R)=>{if(R){h(!0);try{await n(R,k,T,A),u(null)}catch(M){console.error("Failed to update API key (from component):",M)}finally{h(!1)}}},[n]),x=E.useCallback(async(k,T,A,R)=>{R?await v(k,T,A,R):await y(k,T,A)},[y,v]),w=E.useCallback(k=>{u(k.id),a(!1)},[]),S=E.useCallback(()=>{u(null)},[]),_=E.useCallback(async(k,T)=>{if(window.confirm(`Are you sure you want to delete the API key "${T}"? This will unlink it from any providers using it.`)){g(A=>({...A,[k]:!0}));try{await r(k)}catch(A){console.error("Failed to delete API key (from component):",A)}finally{g(A=>({...A,[k]:!1}))}}},[r]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!i&&!c&&f.jsxs(rt,{onClick:()=>{a(!0),u(null)},variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(al,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),i&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(fO,{onSave:x,onCancel:()=>a(!1),disabled:o||s})]}),c&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Edit API Key"}),(()=>{const k=e==null?void 0:e.find(T=>T.id===c);return k?f.jsx(fO,{initialName:k.name,initialProviderType:k.providerId,initialValue:k.value,onSave:x,onCancel:S,disabled:d||s,isEditMode:!0,editId:c}):null})()]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),s&&!i?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Zr,{className:"h-10 w-full"}),f.jsx(Zr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!i?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{children:"Provider Type"}),f.jsx(Pr,{children:"Created"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:(e||[]).map(k=>{const T=p[k.id];return f.jsxs(js,{className:T?"opacity-50":"",children:[f.jsx(zn,{className:"font-medium",children:k.name||"Unnamed Key"}),f.jsx(zn,{children:k.providerId||"Unknown"}),f.jsx(zn,{className:"text-xs text-muted-foreground",children:zu(new Date(k.createdAt),"PPp")}),f.jsx(zn,{className:"text-right",children:f.jsxs("div",{className:"flex justify-end space-x-1",children:[f.jsx(Nn,{tooltipText:"Edit Key",onClick:()=>w(k),disabled:T||c!==null,"aria-label":`Edit key ${k.name||"Unnamed Key"}`,icon:f.jsx(Ku,{className:"h-4 w-4"}),className:"text-muted-foreground hover:text-foreground h-8 w-8"}),f.jsx(Nn,{tooltipText:"Delete Key",onClick:()=>_(k.id,k.name||"Unnamed Key"),disabled:T||c!==null,"aria-label":`Delete key ${k.name||"Unnamed Key"}`,icon:T?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(to,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})})]},k.id)})})]})})]})]})},Fat=We.memo(Dat),Lat=({onSelectModelForDetails:e})=>{const[t,n]=E.useState(null),[r,s]=E.useState(null),i=E.useCallback(k=>{if(k){n(k);const T=k.querySelector("[data-radix-scroll-area-viewport]");if(T)s(T);else{const A=new MutationObserver(()=>{const R=k.querySelector("[data-radix-scroll-area-viewport]");R&&(s(R),A.disconnect())});return A.observe(k,{childList:!0,subtree:!0}),()=>A.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Gn(pn(k=>({getAvailableModelListItems:k.getAvailableModelListItems,isLoading:k.isLoading,dbProviderConfigs:k.dbProviderConfigs}))),[c,u]=E.useState(""),[d,h]=E.useState(()=>new Set(l.map(k=>k.id))),[p,g]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),y=E.useMemo(()=>a(),[a]);E.useEffect(()=>{h(new Set(l.map(k=>k.id)))},[l]);const v=E.useMemo(()=>{let k=y;if(d.size!==l.length&&(k=k.filter(A=>d.has(A.providerId))),c.trim()){const A=c.toLowerCase();k=k.filter(R=>R.name.toLowerCase().includes(A)||R.providerName.toLowerCase().includes(A)||R.id.toLowerCase().includes(A))}const T=Object.entries(p).filter(([,A])=>A).map(([A])=>A);return T.length>0&&(k=k.filter(A=>{var j,F;const R=new Set(((j=A.metadataSummary)==null?void 0:j.supported_parameters)??[]),M=new Set(((F=A.metadataSummary)==null?void 0:F.input_modalities)??[]);return T.every(P=>{switch(P){case"reasoning":return R.has("reasoning");case"webSearch":return R.has("web_search")||R.has("web_search_options");case"tools":return R.has("tools");case"multimodal":return Array.from(M).some(q=>q!=="text");default:return!0}})})),k.sort((A,R)=>{const M=A.providerName.localeCompare(R.providerName);return M!==0?M:A.name.localeCompare(R.name)})},[y,c,d,l.length,p]),x=N6({count:v.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),w=E.useCallback(k=>{e(k)},[e]),S=E.useCallback(k=>{g(k)},[]),_=E.useMemo(()=>(d.size!==l.length?1:0)+Object.values(p).filter(Boolean).length,[d,l.length,p]);return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Zr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Zr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(Ro,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(vn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:k=>u(k.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsx(R6,{currentCapabilityFilters:p,onCapabilityFilterChange:S,currentSelectedProviders:d,onProviderFilterChange:h,allProviders:l,showProviderFilter:!0,showCapabilityFilters:!0,disabled:o||l.length===0,totalActiveFilters:_})]}),f.jsxs(ul,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${x.getTotalSize()}px`,width:"100%",position:"relative"},children:v.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):x.getVirtualItems().map(k=>{var A;const T=v[k.index];return T?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${k.size}px`,transform:`translateY(${k.start}px)`},className:"p-1",children:f.jsx(Er,{delayDuration:300,children:f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>w(T.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:T.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:T.providerName})]})}),((A=T.metadataSummary)==null?void 0:A.description)&&f.jsx(Nr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:T.metadataSummary.description})})]})})},T.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},$at=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Gn(pn(y=>({addDbProviderConfig:y.addProviderConfig,updateDbProviderConfig:y.updateProviderConfig,deleteDbProviderConfig:y.deleteProviderConfig,fetchModels:y.fetchModels,providerFetchStatus:y.providerFetchStatus,dbProviderConfigs:y.dbProviderConfigs,apiKeys:y.dbApiKeys,isLoading:y.isLoading}))),[c,u]=E.useState(!1),d=()=>u(!0),h=E.useCallback(()=>u(!1),[]),p=E.useCallback(async y=>{await s(y)},[s]),g=E.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(Pie,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(rt,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(al,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Zr,{className:"h-24 w-full"}),f.jsx(Zr,{className:"h-24 w-full"}),f.jsx(Zr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:g.map(y=>f.jsx(Wst,{provider:y,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:p,fetchStatus:i[y.id]||"idle",onSelectModelForDetails:e},y.id))}),!l&&g.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},Bat=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Gn(pn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=E.useState("providers-config"),i=E.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=E.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx($at,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(Pat,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(Fat,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(Oat,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(Lat,{onSelectModelForDetails:i}),scrollable:!1}],[t,i,e]);return f.jsx(jo,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},zat=We.memo(Bat);class Uat{constructor(){ue(this,"id","core-provider-settings");ue(this,"modApiRef",null);ue(this,"eventUnsubscribers",[]);ue(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit($n.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>We.createElement(zat,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const qat=Ze({globalSystemPrompt:qe()});function Vat({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const Wat=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=gr(pn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=Xs({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:qat,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),ke.success("Global system prompt updated!")}catch(s){ke.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return E.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(At,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(Mi,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx(Vat,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(rt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},Hat=Ze({temperature:Nt().min(0).max(1),topP:Nt().min(0).max(1),maxTokens:Nt().min(1).nullable(),topK:Nt().min(1).nullable(),presencePenalty:Nt().min(-2).max(2),frequencyPenalty:Nt().min(-2).max(2)}),Gat=()=>{const e=gr(pn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=Xs({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:Hat,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),ke.success("Assistant parameters updated!")}catch(r){ke.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return E.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(Gc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Gc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(hb,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(hb,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(Gc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Gc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(rt,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(rt,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},Kat=Ze({toolMaxSteps:Nt({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function Yat({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const Zat=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=gr(pn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=Xs({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:Kat,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),ke.success("Tool settings updated!")}catch(s){ke.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return E.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(At,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(vn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Yat,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(rt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},Xat=Ze({autoTitleEnabled:Kn(),autoTitleModelId:qe().nullable(),autoTitlePromptMaxLength:Nt().min(100).max(4e3),autoTitleIncludeFiles:Kn(),autoTitleIncludeRules:Kn()});function Mx({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const Jat=()=>{const e=gr(pn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=Xs({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:Xat,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),ke.success("Auto-title settings updated!")}catch(r){ke.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return E.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Eo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(At,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx(Mx,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(Y6,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx(Mx,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(At,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(vn,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Mx,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Eo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(At,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx(Mx,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Eo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(At,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx(Mx,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(rt,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},Qat=({selectedTools:e,onToolsChange:t,className:n,disabled:r=!1,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a=5,showMaxSteps:o=!1})=>{const l=E.useMemo(()=>new Set(e),[e]),c=E.useCallback((d,h)=>{const p=h?[...e,d]:e.filter(g=>g!==d);t(p)},[e,t]),u=E.useCallback((d,h)=>{t(d?h:[])},[t]);return f.jsx(Moe,{enabledTools:l,onToggleTool:c,onToggleAll:u,disabled:r,className:n,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a,showMaxSteps:o})},eot=({variables:e,onVariablesChange:t,templateId:n})=>{const[r,s]=E.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""});E.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[n]),E.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[]);const i=()=>{r.name&&(t([...e,{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},a=o=>{t(e.filter((l,c)=>c!==o))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(At,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[e.map((o,l)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:o.name}),f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>a(l),children:f.jsx(Ri,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:o.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(cs,{variant:o.required?"default":"secondary",children:o.required?"Required":"Optional"}),f.jsx(cs,{variant:"outline",children:o.type}),o.default&&f.jsxs(cs,{variant:"outline",children:["Default: ",o.default]})]})]},`${o.name}-${l}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(At,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(At,{children:"Name"}),f.jsx(vn,{value:r.name,onChange:o=>s(l=>({...l,name:o.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(At,{children:"Type"}),f.jsxs(mc,{value:r.type,onValueChange:o=>s(l=>({...l,type:o})),children:[f.jsx(yc,{children:f.jsx(gc,{})}),f.jsxs(bc,{children:[f.jsx(yi,{value:"string",children:"String"}),f.jsx(yi,{value:"number",children:"Number"}),f.jsx(yi,{value:"boolean",children:"Boolean"}),f.jsx(yi,{value:"array",children:"Array"})]})]},`new-variable-type-${n||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(At,{children:"Description"}),f.jsx(vn,{value:r.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(At,{children:"Default Value"}),f.jsx(vn,{value:r.default,onChange:o=>s(l=>({...l,default:o.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx(au,{checked:r.required,onCheckedChange:o=>s(l=>({...l,required:!!o}))}),f.jsx(At,{children:"Required"})]})]}),f.jsxs(rt,{type:"button",onClick:i,className:"w-full",children:[f.jsx(al,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})})},tot=({selectedFollowUps:e,onFollowUpsChange:t,followUpOptions:n,templateId:r})=>{const[s,i]=E.useState(!1),[a,o]=E.useState(""),l=E.useRef(null),c=n.filter(p=>p.id!==r&&!e.includes(p.id)),u=c.filter(p=>p.name.toLowerCase().includes(a.toLowerCase())||p.description.toLowerCase().includes(a.toLowerCase())),d=p=>{p&&!e.includes(p)&&(t([...e,p]),o(""),i(!1))};E.useEffect(()=>{const p=g=>{l.current&&!l.current.contains(g.target)&&i(!1)};return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[]);const h=p=>{t(e.filter(g=>g!==p))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(At,{className:"text-base font-medium",children:"Follow-up Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select templates that can be suggested as follow-ups after this template is used."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{className:"text-sm font-medium",children:"Selected Follow-ups:"}),e.length===0?f.jsx("p",{className:"text-sm text-muted-foreground",children:"No follow-ups selected yet."}):f.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(p=>{const g=n.find(y=>y.id===p);return g?f.jsxs(cs,{variant:"secondary",className:"flex items-center gap-1",children:[g.name,f.jsx(rt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(p),children:f.jsx(Ri,{className:"h-3 w-3"})})]},p):f.jsxs(cs,{variant:"destructive",className:"flex items-center gap-1",children:["Unknown Template (",p,")",f.jsx(rt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(p),children:f.jsx(Ri,{className:"h-3 w-3"})})]},p)})})]}),c.length>0&&f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(At,{className:"text-sm",children:"Add Follow-up Template:"}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm cursor-pointer hover:bg-accent",onClick:()=>i(!s),children:[f.jsx("span",{className:"text-muted-foreground",children:a||"Select a template to add as follow-up"}),f.jsx(Fl,{className:"h-4 w-4 opacity-50"})]}),s&&f.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",style:{position:"relative",zIndex:"var(--z-popover)"},children:[f.jsx("div",{className:"p-2",children:f.jsx(vn,{placeholder:"Search templates...",value:a,onChange:p=>o(p.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:u.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No templates found."}):u.map(p=>f.jsxs("div",{className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",onClick:()=>d(p.id),children:[p.name," - ",p.description]},p.id))})]})]})]}),c.length===0&&e.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"No templates available for follow-ups. Create more templates first."}),c.length===0&&e.length>0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"All available templates have been selected as follow-ups."})]})]})})},not=()=>{const e=Ze({name:qe().min(1,"Name is required"),description:qe(),variables:cn(Ze({name:qe().min(1,"Variable name is required"),description:qe(),type:Ll(["string","number","boolean","array"]),required:Kn(),default:qe().optional(),instructions:qe().optional()})),prompt:qe().min(1,"Prompt content is required"),tags:cn(qe()),tools:cn(qe()),rules:cn(qe()),followUps:cn(qe())});return async({value:t})=>{try{await e.parseAsync(t)}catch(n){return n instanceof tu?n.formErrors.fieldErrors:{root:"Validation failed"}}}},py=({template:e,onSubmit:t,onSuccess:n,type:r,showFollowUps:s=!1,showMaxSteps:i=!1,followUpOptions:a=[],additionalActions:o})=>{const[l,c]=E.useState(null),{rules:u,tags:d,tagRuleLinks:h,loadRulesAndTags:p}=Lie(pn(w=>({rules:w.rules,tags:w.tags,tagRuleLinks:w.tagRuleLinks,loadRulesAndTags:w.loadRulesAndTags})));E.useEffect(()=>{p()},[p]);const g=Xs({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[],followUps:(e==null?void 0:e.followUps)||[]},validators:{onChangeAsync:not(),onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{t(w),n()}}),y=w=>{const S=h.filter(_=>_.tagId===w).map(_=>_.ruleId);return u.filter(_=>S.includes(_.id))},v=()=>{switch(r){case"agent":return"Agent";case"task":return"Task";default:return"Template"}},x=()=>{switch(r){case"agent":return"Agent Prompt";case"task":return"Task Prompt";default:return"Prompt Template"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?`Edit ${v()}`:`New ${v()}`}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?`Update your ${r}`:`Create a new ${r}${r==="prompt"?" template with variables":""}`})]}),f.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),g.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(g.Field,{name:"name",children:w=>f.jsxs("div",{children:[f.jsxs(At,{htmlFor:w.name,children:[v()," Name"]}),f.jsx(vn,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter ${r} name`}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})}),f.jsx(g.Field,{name:"description",children:w=>f.jsxs("div",{children:[f.jsx(At,{htmlFor:w.name,children:"Description"}),f.jsx(Mi,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Describe what this ${r} does`,rows:3})]})}),f.jsx(g.Field,{name:"prompt",children:w=>f.jsxs("div",{children:[f.jsx(At,{htmlFor:w.name,children:x()}),f.jsx(Mi,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter your ${r} prompt using {{ variable_name }} syntax`,rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})})]}),f.jsx(g.Field,{name:"variables",children:w=>f.jsx(eot,{variables:w.state.value,onVariablesChange:S=>w.handleChange(S),templateId:e==null?void 0:e.id})}),s&&f.jsx(g.Field,{name:"followUps",children:w=>f.jsx(tot,{selectedFollowUps:w.state.value||[],onFollowUpsChange:S=>w.handleChange(S),followUpOptions:a,templateId:e==null?void 0:e.id})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(At,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose tools that will be automatically enabled when this ",r,"is applied."]}),f.jsx(g.Field,{name:"tools",children:w=>f.jsx(Qat,{selectedTools:w.state.value,onToolsChange:S=>w.handleChange(S),className:"p-0 max-w-none",maxSteps:l,onMaxStepsChange:c,showMaxSteps:i})})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(At,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose rules and tags that will be automatically enabled when this",r," is applied."]}),f.jsx(Uoe,{activeTagIds:new Set(g.getFieldValue("tags")),activeRuleIds:new Set(g.getFieldValue("rules")),onToggleTag:(w,S)=>{const _=g.getFieldValue("tags");S?g.setFieldValue("tags",[..._,w]):g.setFieldValue("tags",_.filter(k=>k!==w))},onToggleRule:(w,S)=>{const _=g.getFieldValue("rules");S?g.setFieldValue("rules",[..._,w]):g.setFieldValue("rules",_.filter(k=>k!==w))},allRules:u,allTags:d,getRulesForTag:y})]})}),f.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[f.jsxs(rt,{type:"submit",className:"flex-1",children:[f.jsx(wc,{className:"h-4 w-4 mr-2"}),e?`Update ${v()}`:`Create ${v()}`]}),o]})]})]})},FO=({templates:e,onEdit:t,onDelete:n,type:r,emptyMessage:s,additionalActions:i,getTaskCount:a})=>{const o=()=>{switch(r){case"agent":return"Agents";case"task":return"Tasks";default:return"Templates"}},l=()=>{switch(r){case"agent":return"Manage your AI agents and their associated tasks";case"task":return"Manage tasks for this agent";default:return"Manage your reusable prompt templates with dynamic variables"}},c=()=>{if(s)return s;switch(r){case"agent":return"No Agents Yet";case"task":return"No Tasks Yet";default:return"No Templates Yet"}},u=()=>{switch(r){case"agent":return'Use the "New Agent" tab to create your first agent';case"task":return"Create tasks to define what this agent can do";default:return'Use the "New Template" tab to create your first template'}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:o()}),f.jsx("p",{className:"text-sm text-muted-foreground",children:l()})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:c()}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u()})]}):f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{children:"Description"}),f.jsx(Pr,{children:"Variables"}),r==="agent"&&f.jsx(Pr,{children:"Tasks"}),(r==="prompt"||r==="task")&&f.jsx(Pr,{children:"Follow-ups"}),f.jsx(Pr,{children:"Tools"}),f.jsx(Pr,{children:"Rules/Tags"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:e.map(d=>{var h,p,g,y;return f.jsxs(js,{children:[f.jsx(zn,{className:"font-medium",children:d.name}),f.jsx(zn,{className:"max-w-xs truncate",children:d.description}),f.jsx(zn,{children:f.jsx(cs,{variant:"secondary",children:d.variables.length})}),r==="agent"&&f.jsx(zn,{children:f.jsx(cs,{variant:"secondary",children:a?a(d.id):0})}),(r==="prompt"||r==="task")&&f.jsx(zn,{children:f.jsx(cs,{variant:"secondary",children:((h=d.followUps)==null?void 0:h.length)||0})}),f.jsx(zn,{children:f.jsx(cs,{variant:"secondary",children:((p=d.tools)==null?void 0:p.length)||0})}),f.jsx(zn,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(cs,{variant:"secondary",children:[((g=d.tags)==null?void 0:g.length)||0," tags"]}),f.jsxs(cs,{variant:"secondary",children:[((y=d.rules)==null?void 0:y.length)||0," rules"]})]})}),f.jsx(zn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[i&&i(d),f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>t(d),title:`Edit ${r}`,children:f.jsx(Ku,{className:"h-4 w-4"})}),f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>n(d.id),title:`Delete ${r}`,children:f.jsx(to,{className:"h-4 w-4"})})]})})]},d.id)})})]})]})},rot=()=>{const[e,t]=E.useState("templates"),[n,r]=E.useState(),{loadPromptTemplates:s,addPromptTemplate:i,updatePromptTemplate:a,deletePromptTemplate:o,getTemplatesByType:l}=tl(pn(v=>({loadPromptTemplates:v.loadPromptTemplates,addPromptTemplate:v.addPromptTemplate,updatePromptTemplate:v.updatePromptTemplate,deletePromptTemplate:v.deletePromptTemplate,getTemplatesByType:v.getTemplatesByType}))),c=l("prompt");E.useEffect(()=>{s()},[s]);const u=async v=>{await i({...v,type:"prompt",isPublic:!1})},d=async v=>{n&&await a(n.id,v)},h=async v=>{confirm("Are you sure you want to delete this template?")&&await o(v)},p=v=>{r(v),t("edit")},g=()=>{t("templates"),r(void 0)},y=[{value:"templates",label:"Templates",content:f.jsx(FO,{templates:c,onEdit:p,onDelete:h,type:"prompt"})},{value:"new",label:"New Template",content:f.jsx(py,{onSubmit:u,onSuccess:g,type:"prompt",showFollowUps:!0,followUpOptions:c},"new-template-form")}];return n&&y.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(py,{template:n,onSubmit:d,onSuccess:g,type:"prompt",showFollowUps:!0,followUpOptions:c},`edit-template-form-${n.id}`)}),f.jsx(jo,{tabs:y,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},sot=()=>{const[e,t]=E.useState("agents"),[n,r]=E.useState(),[s,i]=E.useState(),[a,o]=E.useState(),{loadPromptTemplates:l,addPromptTemplate:c,updatePromptTemplate:u,deletePromptTemplate:d,getAgents:h,getTasksForAgent:p}=tl(pn(I=>({loadPromptTemplates:I.loadPromptTemplates,addPromptTemplate:I.addPromptTemplate,updatePromptTemplate:I.updatePromptTemplate,deletePromptTemplate:I.deletePromptTemplate,getAgents:I.getAgents,getTasksForAgent:I.getTasksForAgent})));E.useEffect(()=>{l()},[l]);const g=h(),y=s?p(s.id):[],v=async I=>{await c({...I,type:"agent",isPublic:!1})},x=async I=>{n&&await u(n.id,I)},w=async I=>{if(confirm("Are you sure you want to delete this agent and all its tasks?")){const V=p(I);for(const D of V)await d(D.id);await d(I)}},S=async I=>{s&&await c({...I,type:"task",parentId:s.id,isPublic:!1})},_=async I=>{!a||!s||await u(a.id,{...I,parentId:s.id})},k=async I=>{confirm("Are you sure you want to delete this task?")&&await d(I)},T=I=>{r(I),t("edit-agent")},A=I=>{i(I),t("manage-tasks")},R=I=>{o(I),t("edit-task")},M=()=>{o(void 0),t("new-task")},j=()=>{t("agents"),r(void 0),i(void 0),o(void 0)},F=()=>{t("agents"),i(void 0),o(void 0)},P=()=>{t("manage-tasks"),o(void 0)},q=[{value:"agents",label:"Agents",content:f.jsx(FO,{templates:g,onEdit:T,onDelete:w,type:"agent",getTaskCount:I=>p(I).length,additionalActions:I=>f.jsxs(rt,{variant:"ghost",size:"sm",onClick:()=>A(I),title:"Manage Tasks",children:[f.jsx(Ku,{className:"h-4 w-4"}),"Tasks"]})})},{value:"new-agent",label:"New Agent",content:f.jsx(py,{onSubmit:v,onSuccess:j,type:"agent",showFollowUps:!1,showMaxSteps:!0},"new-agent-form")}];return n&&q.push({value:"edit-agent",label:`Edit: ${n.name}`,content:f.jsx(py,{template:n,onSubmit:x,onSuccess:j,type:"agent",showFollowUps:!1,showMaxSteps:!0,additionalActions:f.jsxs(rt,{type:"button",variant:"outline",onClick:()=>A(n),className:"flex items-center gap-2",children:[f.jsx(Ku,{className:"h-4 w-4"}),"Tasks (",p(n.id).length,")"]})},`edit-agent-form-${n.id}`)}),s&&q.push({value:"manage-tasks",label:`Tasks: ${s.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(rt,{variant:"outline",onClick:F,children:" Back to Agents"})}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-medium",children:["Tasks for ",s.name]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage tasks for this agent"})]}),f.jsxs(rt,{onClick:M,children:[f.jsx(al,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),f.jsx(FO,{templates:y,onEdit:R,onDelete:k,type:"task",emptyMessage:"No Tasks Yet"})]})}),s&&e==="new-task"&&q.push({value:"new-task",label:"New Task",content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(rt,{variant:"outline",onClick:P,children:" Back to Tasks"})}),f.jsx(py,{onSubmit:S,onSuccess:P,type:"task",showFollowUps:!0,followUpOptions:y,showMaxSteps:!0},`new-task-form-${s.id}`)]})}),a&&s&&q.push({value:"edit-task",label:`Edit: ${a.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(rt,{variant:"outline",onClick:P,children:" Back to Tasks"})}),f.jsx(py,{template:a,onSubmit:_,onSuccess:P,type:"task",showFollowUps:!0,followUpOptions:y.filter(I=>I.id!==a.id),showMaxSteps:!0},`edit-task-form-${a.id}`)]})}),f.jsx(jo,{tabs:q,initialValue:e,onValueChange:t,defaultValue:"agents",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},iot=Ze({name:qe().min(1,"Name is required"),url:qe().url("Must be a valid URL"),description:qe(),headers:qe(),enabled:Kn()}),aot=Ze({retryAttempts:Nt().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:Nt().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:Nt().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:Nt().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function Yc({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function oot(){const{bridgeConfig:e,setBridgeConfig:t}=Tl(pn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=Xs({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});E.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(Ba,{children:[f.jsxs(ro,{children:[f.jsxs(so,{className:"text-base flex items-center",children:[f.jsx(Xh,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx(dc,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs(za,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(vn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(Yc,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(vn,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(Yc,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(vn,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(Yc,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(Ba,{children:[f.jsx(ro,{children:f.jsx(so,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx(za,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(rt,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(pS,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function lot(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=Tl(pn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=Xs({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:aot,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});E.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(Ba,{children:[f.jsxs(ro,{children:[f.jsx(so,{className:"text-base",children:"Retry Configuration"}),f.jsx(dc,{children:"How LiteChat handles failed connections"})]}),f.jsx(za,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(vn,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(Yc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(vn,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(Yc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(vn,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(Yc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(vn,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(Yc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(Ba,{children:[f.jsx(ro,{children:f.jsx(so,{className:"text-base",children:"How It Works"})}),f.jsx(za,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(rt,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(rt,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(pS,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function yG({server:e,onSubmit:t,onCancel:n}){const r=Xs({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:iot,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return E.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(Ba,{children:[f.jsx(ro,{children:f.jsxs(so,{className:"text-base flex items-center",children:[f.jsx($y,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs(za,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:s.name,children:"Server Name"}),f.jsx(vn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(Yc,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:s.name,children:"Server URL"}),f.jsx(vn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(Yc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(Mi,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(Yc,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(Mi,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(Yc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Eo,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(At,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(nse,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(rt,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(rt,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function cot({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=Tl(pn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(rt,{onClick:e,children:[f.jsx(al,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx($y,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(rt,{onClick:e,children:[f.jsx(al,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{children:"URL"}),f.jsx(Pr,{children:"Status"}),f.jsx(Pr,{children:"Description"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:n.map(o=>f.jsxs(js,{children:[f.jsx(zn,{className:"font-medium",children:o.name}),f.jsx(zn,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(zn,{children:f.jsx(cs,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(sbe,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx(MP,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(zn,{className:"max-w-xs truncate",children:o.description||""}),f.jsx(zn,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(Eo,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(Ku,{className:"h-4 w-4"})}),f.jsx(rt,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(cxe,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const uot=()=>{const[e,t]=E.useState("servers"),[n,r]=E.useState(),{addServer:s,updateServer:i}=Tl(pn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const p=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:p,enabled:h.enabled}),t("servers")}catch(p){console.error("Invalid headers JSON:",p),ke.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const p=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:p,enabled:h.enabled}),t("servers"),r(void 0)}catch(p){console.error("Invalid headers JSON:",p),ke.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(cot,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(oot,{})},{value:"connection",label:"Connection",content:f.jsx(lot,{})},{value:"new",label:"Add Server",content:f.jsx(yG,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(yG,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(jo,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},R2=`Please provide a detailed but concise summary of our conversation so far. Include:

1. **Main Topics**: Key subjects we've discussed
2. **Important Decisions**: Any conclusions or agreements reached  
3. **Action Items**: Tasks or next steps identified
4. **Context**: Essential background information for continuing our discussion
5. **Current Status**: Where we left off and what we were working on

Keep the summary comprehensive enough that someone could understand the full context and continue our conversation seamlessly, but concise enough to be easily digestible. Focus on actionable information and key insights rather than verbose details.`,dot=()=>{const[e,t]=E.useState(!1),[n,r]=E.useState(""),[s,i]=E.useState(null),{forkCompactPrompt:a,forkCompactModelId:o,setForkCompactPrompt:l,setForkCompactModelId:c}=gr(pn(g=>({forkCompactPrompt:g.forkCompactPrompt,forkCompactModelId:g.forkCompactModelId,setForkCompactPrompt:g.setForkCompactPrompt,setForkCompactModelId:g.setForkCompactModelId}))),{globallyEnabledModels:u}=Gn(pn(g=>({globallyEnabledModels:g.getGloballyEnabledModelDefinitions()})));E.useEffect(()=>{r(a||R2),i(o)},[a,o]);const d=async()=>{t(!0);try{l(n),c(s),ke.success("Fork Compact settings saved!")}catch(g){console.error("Failed to save fork compact settings:",g),ke.error("Failed to save settings")}finally{t(!1)}},h=()=>{confirm("Reset Fork Compact settings to defaults?")&&(r(R2),i(null),l(R2),c(null),ke.success("Fork Compact settings reset to defaults"))},p=n!==(a||R2)||s!==o;return f.jsx("div",{className:"space-y-6",children:f.jsxs(Ba,{children:[f.jsxs(ro,{children:[f.jsx(so,{children:"Fork Compact Configuration"}),f.jsx(dc,{children:"Configure the model and prompt used when creating compact conversation summaries. Fork Compact creates a new conversation with a summary of the current conversation history."})]}),f.jsxs(za,{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"fork-compact-model",children:"Default Model"}),f.jsxs(mc,{value:s||"__default__",onValueChange:g=>i(g==="__default__"?null:g),children:[f.jsx(yc,{children:f.jsx(gc,{placeholder:"Use conversation's current model"})}),f.jsxs(bc,{children:[f.jsx(yi,{value:"__default__",children:"Use conversation's current model"}),u.map(g=>f.jsxs(yi,{value:g.id,children:[g.name," (",g.providerName,")"]},g.id))]})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to use the same model as the current conversation. Select a specific model to always use that model for compact summaries."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"fork-compact-prompt",children:"Compact Summary Prompt"}),f.jsx(Mi,{id:"fork-compact-prompt",value:n,onChange:g=>r(g.target.value),placeholder:"Enter the prompt for generating compact summaries...",className:"min-h-[200px] font-mono text-sm"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"This prompt will be sent to the AI along with the conversation history to generate a compact summary. The summary will become the first assistant message in the new forked conversation."})]}),f.jsxs("div",{className:"flex items-center justify-between pt-4",children:[f.jsxs(rt,{variant:"outline",size:"sm",onClick:h,disabled:e,children:[f.jsx(pS,{className:"mr-2 h-4 w-4"}),"Reset to Default"]}),f.jsx(rt,{onClick:d,disabled:!p||e,children:e?"Saving...":"Save Changes"})]})]})]})})},fot=()=>{const e=E.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(Wat,{})},{value:"parameters",label:"Parameters",content:f.jsx(Gat,{})},{value:"tools",label:"Tools",content:f.jsx(Zat,{})},{value:"mcp",label:"MCP",content:f.jsx(uot,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(Jat,{})},{value:"fork-compact",label:"Fork Compact",content:f.jsx(dot,{})},{value:"prompts",label:"Prompts",content:f.jsx(rot,{})},{value:"agents",label:"Agents",content:f.jsx(sot,{})}],[]);return f.jsx("div",{className:"space-y-4 p-1 h-full flex flex-col",children:f.jsx(jo,{tabs:e,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1})})},hot=We.memo(fot);class pot{constructor(){ue(this,"id","core-settings-assistant");ue(this,"unregisterCallback",null);ue(this,"modApiRef",null);ue(this,"eventUnsubscribers",[]);ue(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=gr.getState().enableAdvancedSettings;const n=t.on(on.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:hot,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const mot=Ze({importSettings:Kn(),importApiKeys:Kn(),importProviderConfigs:Kn(),importProjects:Kn(),importConversations:Kn(),importRulesAndTags:Kn(),importMods:Kn(),importSyncRepos:Kn(),importMcpServers:Kn(),importPromptTemplates:Kn(),importAgents:Kn(),importWorkflows:Kn()}),got=Ze({importSettings:Kn(),importApiKeys:Kn(),importProviderConfigs:Kn(),importProjects:Kn(),importConversations:Kn(),importRulesAndTags:Kn(),importMods:Kn(),importSyncRepos:Kn(),importMcpServers:Kn(),importPromptTemplates:Kn(),importAgents:Kn(),importWorkflows:Kn()}),yot=()=>{const{importConversation:e,exportAllConversations:t}=On(pn(R=>({importConversation:R.importConversation,exportAllConversations:R.exportAllConversations}))),n=E.useRef(null),r=E.useRef(null),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(!1),[h,p]=E.useState(!1),g=Xs({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0,importWorkflows:!0},validators:{onChange:mot}}),y=Xs({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0,importWorkflows:!0},validators:{onChange:got}}),v=()=>{var R;(R=n.current)==null||R.click()},x=()=>{var R;(R=r.current)==null||R.click()},w=E.useCallback(async R=>{var j;const M=(j=R.target.files)==null?void 0:j[0];if(M){i(!0);try{await e(M)}catch(F){console.error("Import failed (from component):",F)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),S=E.useCallback(async R=>{var j;const M=(j=R.target.files)==null?void 0:j[0];if(M){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}p(!0);try{await iy.importFullConfiguration(M,g.state.values)}catch(F){console.error("Full import failed (from component):",F)}finally{r.current&&(r.current.value=""),p(!1)}}},[g]),_=E.useCallback(async()=>{o(!0);try{await t()}catch(R){console.error("Export all failed (from component):",R)}finally{o(!1)}},[t]),k=E.useCallback(async()=>{d(!0);try{await iy.exportFullConfiguration(y.state.values)}catch(R){console.error("Full export failed (from component):",R)}finally{d(!1)}},[y]),T=E.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await dt.clearAllData(),ke.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(R){const M="Failed to clear all data";console.error(M,R),ke.error(`${M}: ${R instanceof Error?R.message:String(R)}`),c(!1)}}},[]),A=(R,M,j,F,P,q)=>{const I=`${q}-${M}-checkbox`;return f.jsx(R.Field,{name:M,children:V=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(au,{id:I,checked:V.state.value,onCheckedChange:D=>V.handleChange(!!D),disabled:P}),f.jsxs(At,{htmlFor:I,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(F,{className:"h-4 w-4 text-muted-foreground"})," ",j]})]})},M)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(At,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(rt,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(gY,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(At,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(rt,{onClick:_,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(cc,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(dg,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(At,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(g,"importSettings","Settings",Xh,h,"import"),A(g,"importApiKeys","API Keys",Fw,h,"import"),A(g,"importProviderConfigs","Providers",$y,h,"import"),A(g,"importProjects","Projects",Ez,h,"import"),A(g,"importConversations","Conversations",PP,h,"import"),A(g,"importRulesAndTags","Rules & Tags",OP,h,"import"),A(g,"importMods","Mods",Nz,h,"import"),A(g,"importSyncRepos","Sync Repos",eu,h,"import"),A(g,"importMcpServers","MCP Servers",Az,h,"import"),A(g,"importPromptTemplates","Prompt Templates",jP,h,"import"),A(g,"importAgents","Agents",Ly,h,"import"),A(g,"importWorkflows","Workflows",Lw,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(rt,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Obe,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(At,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(y,"importSettings","Settings",Xh,u,"export"),A(y,"importApiKeys","API Keys",Fw,u,"export"),A(y,"importProviderConfigs","Providers",$y,u,"export"),A(y,"importProjects","Projects",Ez,u,"export"),A(y,"importConversations","Conversations",PP,u,"export"),A(y,"importRulesAndTags","Rules & Tags",OP,u,"export"),A(y,"importMods","Mods",Nz,u,"export"),A(y,"importSyncRepos","Sync Repos",eu,u,"export"),A(y,"importMcpServers","MCP Servers",Az,u,"export"),A(y,"importPromptTemplates","Prompt Templates",jP,u,"export"),A(y,"importAgents","Agents",Ly,u,"export"),A(y,"importWorkflows","Workflows",Lw,u,"export")]}),f.jsxs(rt,{onClick:k,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Abe,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(rt,{onClick:T,variant:"destructive",disabled:l,children:[l?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(to,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},bot=We.memo(yot);class vot{constructor(){ue(this,"id","core-settings-data");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:bot,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const xot=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=pp(pn(T=>({loadedMods:T.loadedMods,addDbMod:T.addDbMod,updateDbMod:T.updateDbMod,deleteDbMod:T.deleteDbMod,dbMods:T.dbMods,isLoading:T.isLoading}))),[a,o]=E.useState(""),[l,c]=E.useState(""),[u,d]=E.useState(""),[h,p]=E.useState(!1),[g,y]=E.useState({}),[v,x]=E.useState({}),w=E.useCallback(async()=>{if(!a.trim()){ke.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){ke.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){ke.error("Provide either a Mod URL or Script Content, not both.");return}p(!0);try{const T={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(T),o(""),c(""),d(""),ke.info("Mod added. Reload required for changes to take effect.")}catch(T){console.error("Failed to add mod (from component):",T)}finally{p(!1)}},[a,l,u,t,s==null?void 0:s.length]),S=E.useCallback(async T=>{y(A=>({...A,[T.id]:!0}));try{await n(T.id,{enabled:!T.enabled}),ke.info(`Mod "${T.name}" ${T.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(A){console.error("Failed to update mod (from component):",A)}finally{y(A=>({...A,[T.id]:!1}))}},[n]),_=E.useCallback(async T=>{if(window.confirm(`Are you sure you want to delete the mod "${T.name}"? This cannot be undone.`)){x(A=>({...A,[T.id]:!0}));try{await r(T.id),ke.info("Mod deleted. Reload required for changes to take effect.")}catch(A){console.error("Failed to delete mod (from component):",A)}finally{x(A=>({...A,[T.id]:!1}))}}},[r]),k=E.useCallback(T=>{const A=e.find(M=>M.id===T);if(A)if(A.error){const M=A.error instanceof Error?A.error.message:String(A.error);return{status:"Error",error:A.error,tooltip:M}}else return{status:"Loaded"};const R=(s||[]).find(M=>M.id===T);return R?R.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(jA,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(DD,{className:"h-4 w-4"}),f.jsx(R5,{children:"Security Warning"}),f.jsx(PA,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(vn,{id:"mod-name",value:a,onChange:T=>o(T.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(vn,{id:"mod-url",type:"url",value:l,onChange:T=>c(T.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(At,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(Mi,{id:"mod-script",value:u,onChange:T=>d(T.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(rt,{onClick:w,disabled:h,children:[h&&f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(Er,{delayDuration:100,children:f.jsxs(zf,{children:[f.jsx($p,{children:f.jsxs(js,{children:[f.jsx(Pr,{children:"Name"}),f.jsx(Pr,{children:"Source"}),f.jsx(Pr,{children:"Status"}),f.jsx(Pr,{className:"text-center",children:"Enabled"}),f.jsx(Pr,{className:"text-right",children:"Actions"})]})}),f.jsx(Uf,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(js,{children:f.jsx(zn,{colSpan:5,children:f.jsx(Zr,{className:"h-10 w-full"})})}),f.jsx(js,{children:f.jsx(zn,{colSpan:5,children:f.jsx(Zr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(js,{children:f.jsx(zn,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(T=>{const{status:A,error:R,tooltip:M}=k(T.id),j=T.sourceUrl?new URL(T.sourceUrl).hostname:"Direct Script",F=g[T.id],P=v[T.id],q=F||P,I=A==="Error";return f.jsxs(js,{children:[f.jsx(zn,{className:"font-medium",children:T.name}),f.jsx(zn,{className:"text-muted-foreground",children:j}),f.jsxs(zn,{children:[f.jsxs(Tr,{children:[f.jsx(Ar,{asChild:!0,children:f.jsx("span",{className:I?"text-destructive font-semibold cursor-help":"",children:A})}),M&&f.jsx(Nr,{className:"max-w-xs break-words",children:f.jsx("p",{children:M})})]}),I&&R&&f.jsx("p",{className:"text-xs text-destructive truncate",children:R instanceof Error?R.message:String(R)})]}),f.jsxs(zn,{className:"text-center",children:[f.jsx(Eo,{checked:T.enabled??!1,onCheckedChange:()=>S(T),disabled:q,"aria-label":`Enable ${T.name}`}),F&&f.jsx(Yn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(zn,{className:"text-right",children:f.jsx(rt,{variant:"ghost",size:"icon",onClick:()=>_(T),disabled:q,"aria-label":`Delete ${T.name}`,className:"text-destructive hover:text-destructive/80",children:P?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(to,{className:"h-4 w-4"})})})]},T.id)})})]})})})]})]})},wot=We.memo(xot);class Sot{constructor(){ue(this,"id","core-settings-mods");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:wot,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const _ot=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=E.useState(!1),s=E.useCallback(async i=>{if(i.stopPropagation(),n||!t){ke.info("No content to copy or action disabled.");return}Ae.emit(ta.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(Nn,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(Ao,{className:"text-green-500"}):f.jsx(IT,{}),className:"h-5 w-5"})};class Cot{constructor(){ue(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?We.createElement(_ot,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const kot=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){ke.info("Regeneration is currently disabled.");return}Ae.emit(ta.regenerateInteractionRequest,{interactionId:e})};return f.jsx(Nn,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(Jm,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Eot{constructor(){ue(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=en.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?We.createElement(kot,{interactionId:r.id,disabled:!c}):null}})}destroy(t){}}const Tot=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Ae.emit(ta.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){ke.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(Bp,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Nn,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(hve,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Aot{constructor(){ue(this,"id","core-canvas-regenerate-with-model-action");ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!0)}async initialize(t){const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on($n.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Gn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on($n.initialDataLoaded,()=>{var c;const a=Gn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=en.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?We.createElement(Tot,{module:this,interactionId:r.id,disabled:!c}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const Not=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){ke.info("Fork is currently disabled.");return}Ae.emit(ta.forkConversationRequest,{interactionId:e})};return f.jsx(Nn,{tooltipText:"Fork",onClick:n,"aria-label":"Fork Conversation",disabled:t,icon:f.jsx(RD,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Rot{constructor(){ue(this,"id","core-canvas-fork-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=en.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(Not,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const Iot=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Ae.emit(ta.forkConversationWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){ke.info("Fork is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(Bp,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Nn,{tooltipText:"Fork with",onClick:o,"aria-label":"Fork Conversation with Model Selection",disabled:n,icon:f.jsxs("div",{className:"relative",children:[f.jsx(RD,{className:"h-4 w-4"}),f.jsx(al,{className:"absolute -top-1 -right-1 h-2 w-2"})]}),className:"h-5 w-5 md:h-6 md:w-6"})};class Mot{constructor(){ue(this,"id","core-canvas-fork-with-model-action");ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!0)}async initialize(t){const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on($n.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Gn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on($n.initialDataLoaded,()=>{var c;const a=Gn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=en.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(Iot,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const jot=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Ae.emit(ta.forkConversationCompactRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){ke.info("Fork compact is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(Bp,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(Nn,{tooltipText:"Summarize",onClick:o,"aria-label":"Fork Conversation with Compact Summary",disabled:n,icon:f.jsx(Oye,{className:"h-4 w-4"}),className:"h-5 w-5 md:h-6 md:w-6"})};class Pot{constructor(){ue(this,"id","core-canvas-fork-compact-action");ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!0)}async initialize(t){const n=Gn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on($n.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Gn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on($n.initialDataLoaded,()=>{var c;const a=Gn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=en.getState().status,a=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return We.createElement(jot,{module:this,interactionId:r.id,disabled:!a})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const Oot=({interactionId:e,currentRating:t})=>{const[n,r]=E.useState(!1),s=c=>{const u=c===t?null:c;Ae.emit(xn.rateInteractionRequest,{interactionId:e,rating:u}),r(!1)},i=Array.from({length:11},(c,u)=>u-5);let a="text-muted-foreground",o="",l="hover:text-foreground";return t!=null&&(t<0?(a="text-red-500",o="fill-red-500"):t===0?(a="text-gray-500",o="fill-gray-500"):(a="text-green-500",o="fill-green-500")),f.jsxs(Tc,{open:n,onOpenChange:r,children:[f.jsx(Ac,{asChild:!0,children:f.jsx(Nn,{tooltipText:t!=null?`Rating: ${t}`:"Rate response",onClick:()=>r(!n),"aria-label":"Rate response",icon:f.jsx(Mz,{className:Ye(o,t!=null?"fill-current":"fill-none")}),variant:"ghost",className:Ye("h-4 w-4 md:h-5 md:w-5 p-0",a,l)})}),f.jsx(Nc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"text-sm font-medium",children:"Rate this response"}),f.jsx("div",{className:"grid grid-cols-11 gap-1",children:i.map(c=>{let u="";c===-5?u="Terrible":c===-4?u="Very Bad":c===-3?u="Bad":c===-2?u="Poor":c===-1?u="Below Average":c===0?u="Neutral":c===1?u="Above Average":c===2?u="Good":c===3?u="Very Good":c===4?u="Excellent":c===5&&(u="Perfect");let d="text-muted-foreground",h="hover:text-foreground",p="";c<0?(h="hover:text-red-500",t===c&&(d="text-red-500",p="fill-red-500")):c===0?(h="hover:text-gray-500",t===c&&(d="text-gray-500",p="fill-gray-500")):(h="hover:text-green-500",t===c&&(d="text-green-500",p="fill-green-500"));const g=t===c?"bg-muted":"";return f.jsx(Nn,{tooltipText:`${c}: ${u}`,onClick:()=>s(c),"aria-label":`Rate response as ${u} (${c})`,icon:f.jsx(Mz,{className:Ye(p,t===c?"fill-current":"fill-none")}),variant:"ghost",className:Ye("h-6 w-6 p-0",d,h,g)},c)})}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"-5 (Terrible)"}),f.jsx("span",{children:"0 (Neutral)"}),f.jsx("span",{children:"+5 (Perfect)"})]}),t!=null&&f.jsx("div",{className:"pt-2 border-t",children:f.jsx("button",{onClick:()=>s(null),className:"text-xs text-muted-foreground hover:text-foreground",children:"Clear rating"})})]})})]})};class Dot{constructor(){ue(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:We.createElement(Oot,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const Fot=({interactionId:e,response:t,disabled:n})=>{const[r,s]=E.useState(!1),[i,a]=E.useState(""),o=u=>{if(u.stopPropagation(),n){ke.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){ke.error("Response cannot be empty");return}Ae.emit(ta.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),ke.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(Nn,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(PD,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(vd,{open:r,onOpenChange:s,children:f.jsxs(xd,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(wd,{className:"p-2 md:p-3 pb-1 md:pb-2 flex-shrink-0",children:f.jsx(Sd,{className:"p-2",children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(At,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(Mi,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(Fg,{className:"flex-shrink-0 p-2 md:p-3 pt-1 md:pt-2",children:[f.jsx(rt,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(rt,{onClick:l,children:"Save Changes"})]})]})})]})};class Lot{constructor(){ue(this,"id","core-canvas-edit-response-action");ue(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(ta.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=en.getState(),i=s.interactions.find(g=>g.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=dr(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(g=>g.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const g=(r=u.metadata)==null?void 0:r.editedFromId;g?u=s.interactions.find(y=>y.id===g):u=void 0}const d=c.sort((g,y)=>{var w,S;const v=((w=g.startedAt)==null?void 0:w.getTime())??0,x=((S=y.startedAt)==null?void 0:S.getTime())??0;return v-x}),h=d.map(async(g,y)=>{const v={parentId:a,index:y,metadata:{...g.metadata,originalVersion:y===0}};return console.log(`[EditResponseControlModule] Updating version ${g.id} to be child of ${a} with childIndex ${y}`),s._updateInteractionInState(g.id,v),dt.saveInteraction({...g,...v})}),p=l.map(async g=>{const y={parentId:a,index:d.length+g.index};return s._updateInteractionInState(g.id,y),dt.saveInteraction({...g,...y})});await Promise.all([dt.saveInteraction(o),...h,...p]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=en.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?We.createElement(Fot,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const $ot=({interactionId:e,codeBlockId:t,language:n,originalContent:r,editedContent:s,filepath:i,disabled:a,onEditModeChange:o})=>{const[l,c]=E.useState(!1),u=E.useCallback(g=>{if(g.stopPropagation(),a||!r||!e||!t){ke.info("Code editing is currently disabled.");return}c(!0),o==null||o(!0)},[a,r,e,t,o]),d=E.useCallback(()=>{if(!e||!t){ke.error("Missing interaction or code block ID");return}if(s.trim()===""){ke.error("Code cannot be empty");return}Ae.emit(ta.editCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,filepath:i,originalContent:r,newContent:s}),c(!1),o==null||o(!1),ke.success("Code block edited successfully")},[e,t,n,i,r,s,o]),h=E.useCallback(()=>{c(!1),o==null||o(!1)},[o]);return r&&r.trim().length>0&&e&&t?l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs(rt,{size:"sm",onClick:d,className:"h-6 px-2 text-xs",children:[f.jsx(wc,{className:"h-3 w-3 mr-1"}),"Save"]}),f.jsxs(rt,{size:"sm",variant:"outline",onClick:h,className:"h-6 px-2 text-xs",children:[f.jsx(Ri,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}):f.jsx(Nn,{tooltipText:"Edit Code",onClick:u,"aria-label":"Edit code block",disabled:a||!r||!e||!t,icon:f.jsx(PD,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null},Bot=new cl({html:!1,linkify:!0,breaks:!0});class zot{constructor(){ue(this,"id","core-canvas-edit-codeblock-action");ue(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(ta.editCodeBlockRequest,async r=>{await this.handleCodeBlockEdit(r.interactionId,r.codeBlockId,r.language,r.filepath,r.originalContent,r.newContent)});this.eventUnsubscribers.push(n)}parseMarkdownForCodeBlocks(t){var n,r,s;if(!t)return[];try{const i=Bot.parse(t,{}),a=[];for(const o of i)if(o.type==="fence"){const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[p,...g]=l.split(":");c=p||void 0,u=g.join(":")||void 0}else c=l.split(" ")[0]||void 0;const d=((r=o.map)==null?void 0:r[0])||0,h=((s=o.map)==null?void 0:s[1])||0;a.push({type:"block",lang:c,code:o.content,filepath:u,startPos:d,endPos:h})}return a}catch(i){return console.error("Markdown parsing error:",i),[]}}findCodeBlockByContent(t,n,r,s){const i=this.parseMarkdownForCodeBlocks(t);for(let a=0;a<i.length;a++){const o=i[a];if(o.code===n&&o.lang===r&&o.filepath===s)return a}for(let a=0;a<i.length;a++)if(i[a].code===n)return a;return-1}replaceCodeBlockInMarkdown(t,n,r,s,i){const a=t.split(`
`),o=this.parseMarkdownForCodeBlocks(t);if(n<0||n>=o.length)throw new Error(`Code block index ${n} not found`);const l=o[n],c=l.startPos,u=l.endPos,d=s||"",h=i?`:${i}`:"",p=[`\`\`\`${d}${h}`,...r.split(`
`),"```"];return[...a.slice(0,c),...p,...a.slice(u)].join(`
`)}async handleCodeBlockEdit(t,n,r,s,i,a){var o;try{const l=en.getState(),c=l.interactions.find(_=>_.id===t);if(!c)throw new Error("Original interaction not found");if(c.status!=="COMPLETED")throw new Error("Can only edit completed interactions");if(!c.response||typeof c.response!="string")throw new Error("Invalid response content");const u=this.findCodeBlockByContent(c.response,i||"",r,s);if(u===-1)throw new Error("Code block not found in response");const d=this.replaceCodeBlockInMarkdown(c.response,u,a||"",r,s),h=dr(),p={...c,id:h,response:d,parentId:null,index:c.index,metadata:{...c.metadata,editedResponse:!0,editedFromId:c.id,editedCodeBlock:{codeBlockId:n,language:r,filepath:s,originalContent:i,newContent:a}},endedAt:new Date};l._addInteractionToState(p);const g=l.interactions.filter(_=>_.parentId===c.id),y=[];let v=c;for(;v;){y.push(v);const _=(o=v.metadata)==null?void 0:o.editedFromId;_?v=l.interactions.find(k=>k.id===_):v=void 0}const x=y.sort((_,k)=>{var R,M;const T=((R=_.startedAt)==null?void 0:R.getTime())??0,A=((M=k.startedAt)==null?void 0:M.getTime())??0;return T-A}),w=x.map(async(_,k)=>{const T={parentId:h,index:k,metadata:{..._.metadata,originalVersion:k===0}};return l._updateInteractionInState(_.id,T),dt.saveInteraction({..._,...T})}),S=g.map(async _=>{const k={parentId:h,index:x.length+_.index};return l._updateInteractionInState(_.id,k),dt.saveInteraction({..._,...k})});await Promise.all([dt.saveInteraction(p),...w,...S])}catch(l){throw console.error("[EditCodeBlockControlModule] Failed to edit code block:",l),l}}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>{if(!n.codeBlockContent||!n.interactionId)return null;const r=en.getState(),s=r.status,i=r.interactions.find(l=>l.id===n.interactionId),a=i&&i.status==="COMPLETED"&&i.response&&typeof i.response=="string"&&s!=="streaming"&&(i.type==="message.user_assistant"||i.type==="message.assistant_regen")&&n.codeBlockContent&&n.codeBlockContent.trim().length>0;if(!a)return null;const o=n.blockId||`fallback-${Date.now()}`;return We.createElement($ot,{interactionId:n.interactionId,codeBlockId:o,language:n.codeBlockLang,filepath:n.codeBlockFilepath,originalContent:n.codeBlockContent||"",editedContent:n.codeBlockEditedContent||n.codeBlockContent||"",disabled:!a,onEditModeChange:n.onEditModeChange})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const Uot=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(Nn,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(Fl,{}):f.jsx(wp,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class qot{constructor(){ue(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:We.createElement(Uot,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const Vot=({context:e})=>{const t=NA(e.responseContent||""),n=E.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="block"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=E.useCallback(async()=>{var s;if(n.length===0){ke.info("No code blocks with filepaths found to download");return}try{const i=new JF,a=new Set;n.forEach(({filepath:h,code:p})=>{const g=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),y=g.split("/");if(y.length>1)for(let w=1;w<y.length;w++){const S=y.slice(0,w).join("/");a.has(S)||(i.folder(S),a.add(S))}let v=g,x=1;for(;i.file(v);){const w=g.lastIndexOf(".");if(w>0){const S=g.substring(0,w),_=g.substring(w);v=`${S}_${x}${_}`}else v=`${g}_${x}`;x++}i.file(v,p)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),ke.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),ke.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(Nn,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(iY,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class Wot{constructor(){ue(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:We.createElement(Vot,{context:n})})}destroy(t){}}const Hot=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=E.useState(!1),o=E.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Ae.emit(ta.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(Nn,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(Ao,{className:"text-green-500"}):f.jsx(IT,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class Got{constructor(){ue(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>We.createElement(Hot,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const Kot=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(Nn,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(RT,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class Yot{constructor(){ue(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:We.createElement(Kot,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const Zot=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=E.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const p=s.split("/");c=p[p.length-1]}else c=`code${Xot(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),ke.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),ke.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>1e3?f.jsx(Nn,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(cc,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function Xot(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class Jot{constructor(){ue(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>We.createElement(Zot,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const Qot=({toolCall:e})=>{const[t,n]=E.useState(!0),r=()=>n(i=>!i),s=E.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Nn,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(Fl,{}):f.jsx(wp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Bb,{lang:"json",code:s})]})},elt=({toolResult:e})=>{const[t,n]=E.useState(!0),r=()=>n(a=>!a),s=E.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Ye("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Ye("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(Nn,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(Fl,{}):f.jsx(wp,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Bb,{lang:i?"text":"json",code:s})]})},tlt=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(Qot,{toolCall:t}),n&&f.jsx(elt,{toolResult:n})]});class nlt{constructor(){ue(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):We.createElement(tlt,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const rlt=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s,blockId:i})=>{const{foldStreamingCodeBlocks:a}=gr(pn(k=>({foldStreamingCodeBlocks:k.foldStreamingCodeBlocks}))),[o,l]=E.useState(r?a:!1),[c,u]=E.useState(!1),[d,h]=E.useState(t);E.useEffect(()=>{c||h(t)},[t,c]);const p=E.useRef(null),g=Ni(pn(k=>Object.values(k.canvasControls))),y=E.useCallback((k,T,A,R,M,j)=>g.filter(F=>F.type==="codeblock"&&F.targetSlot===k&&F.renderer).map(F=>{if(F.renderer){const P={codeBlockContent:T,codeBlockEditedContent:d,codeBlockLang:A,codeBlockFilepath:R,isFolded:M,toggleFold:j,canvasContextType:"codeblock",interactionId:s,blockId:i,onEditModeChange:u};return f.jsx(We.Fragment,{children:F.renderer(P)},F.id)}return null}).filter(Boolean),[g,d,s,u]),v=E.useCallback(()=>{if(p.current&&t)try{p.current.style.whiteSpace!=="pre-wrap"&&(p.current.style.whiteSpace="pre-wrap"),p.current.textContent=t,Qs.highlightElement(p.current)}catch(k){console.error("Prism highlight error:",k),p.current.textContent=t}else p.current&&(p.current.textContent="")},[t]);E.useEffect(()=>{o||v()},[t,e,o,v]);const x=()=>{const k=o;l(T=>!T),k&&setTimeout(v,0)},w=e?`language-${e}`:"language-plaintext",S=E.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),_=y("codeblock-header-actions",t,e,n,o,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-[var(--z-sticky)] flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:_})]}),f.jsx("div",{})]}),!o&&!c&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{ref:p,className:w+" block p-4 font-mono text-sm leading-relaxed"})})}),!o&&c&&f.jsx("div",{className:"overflow-hidden w-full border border-border rounded-b-lg bg-muted/20",children:f.jsx(ust,{code:d,language:e,onChange:h})}),o&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border border border-t-0 border-border rounded-b-lg bg-muted/10 hover:bg-muted/20 transition-colors",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:S})})]})},EN=E.memo(rlt);class slt{constructor(){ue(this,"id","core-block-renderer-code");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:void 0,priority:0,renderer:r=>We.createElement(EN,{lang:r.lang,code:r.code,filepath:r.filepath,isStreaming:r.isStreaming,interactionId:r.interactionId,blockId:r.blockId})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}var ak={exports:{}},ilt=ak.exports,bG;function alt(){return bG||(bG=1,function(e,t){(function(n,r){e.exports=r()})(ilt,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",p="year",g="date",y="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(I){var V=["th","st","nd","rd"],D=I%100;return"["+I+(V[(D-20)%10]||V[D]||V[0])+"]"}},S=function(I,V,D){var z=String(I);return!z||z.length>=V?I:""+Array(V+1-z.length).join(D)+I},_={s:S,z:function(I){var V=-I.utcOffset(),D=Math.abs(V),z=Math.floor(D/60),$=D%60;return(V<=0?"+":"-")+S(z,2,"0")+":"+S($,2,"0")},m:function I(V,D){if(V.date()<D.date())return-I(D,V);var z=12*(D.year()-V.year())+(D.month()-V.month()),$=V.clone().add(z,d),Y=D-$<0,B=V.clone().add(z+(Y?-1:1),d);return+(-(z+(D-$)/(Y?$-B:B-$))||0)},a:function(I){return I<0?Math.ceil(I)||0:Math.floor(I)},p:function(I){return{M:d,y:p,w:u,d:c,D:g,h:l,m:o,s:a,ms:i,Q:h}[I]||String(I||"").toLowerCase().replace(/s$/,"")},u:function(I){return I===void 0}},k="en",T={};T[k]=w;var A="$isDayjsObject",R=function(I){return I instanceof P||!(!I||!I[A])},M=function I(V,D,z){var $;if(!V)return k;if(typeof V=="string"){var Y=V.toLowerCase();T[Y]&&($=Y),D&&(T[Y]=D,$=Y);var B=V.split("-");if(!$&&B.length>1)return I(B[0])}else{var G=V.name;T[G]=V,$=G}return!z&&$&&(k=$),$||!z&&k},j=function(I,V){if(R(I))return I.clone();var D=typeof V=="object"?V:{};return D.date=I,D.args=arguments,new P(D)},F=_;F.l=M,F.i=R,F.w=function(I,V){return j(I,{locale:V.$L,utc:V.$u,x:V.$x,$offset:V.$offset})};var P=function(){function I(D){this.$L=M(D.locale,null,!0),this.parse(D),this.$x=this.$x||D.x||{},this[A]=!0}var V=I.prototype;return V.parse=function(D){this.$d=function(z){var $=z.date,Y=z.utc;if($===null)return new Date(NaN);if(F.u($))return new Date;if($ instanceof Date)return new Date($);if(typeof $=="string"&&!/Z$/i.test($)){var B=$.match(v);if(B){var G=B[2]-1||0,Z=(B[7]||"0").substring(0,3);return Y?new Date(Date.UTC(B[1],G,B[3]||1,B[4]||0,B[5]||0,B[6]||0,Z)):new Date(B[1],G,B[3]||1,B[4]||0,B[5]||0,B[6]||0,Z)}}return new Date($)}(D),this.init()},V.init=function(){var D=this.$d;this.$y=D.getFullYear(),this.$M=D.getMonth(),this.$D=D.getDate(),this.$W=D.getDay(),this.$H=D.getHours(),this.$m=D.getMinutes(),this.$s=D.getSeconds(),this.$ms=D.getMilliseconds()},V.$utils=function(){return F},V.isValid=function(){return this.$d.toString()!==y},V.isSame=function(D,z){var $=j(D);return this.startOf(z)<=$&&$<=this.endOf(z)},V.isAfter=function(D,z){return j(D)<this.startOf(z)},V.isBefore=function(D,z){return this.endOf(z)<j(D)},V.$g=function(D,z,$){return F.u(D)?this[z]:this.set($,D)},V.unix=function(){return Math.floor(this.valueOf()/1e3)},V.valueOf=function(){return this.$d.getTime()},V.startOf=function(D,z){var $=this,Y=!!F.u(z)||z,B=F.p(D),G=function(pe,Le){var He=F.w($.$u?Date.UTC($.$y,Le,pe):new Date($.$y,Le,pe),$);return Y?He:He.endOf(c)},Z=function(pe,Le){return F.w($.toDate()[pe].apply($.toDate("s"),(Y?[0,0,0,0]:[23,59,59,999]).slice(Le)),$)},ne=this.$W,ae=this.$M,le=this.$D,Se="set"+(this.$u?"UTC":"");switch(B){case p:return Y?G(1,0):G(31,11);case d:return Y?G(1,ae):G(0,ae+1);case u:var Ee=this.$locale().weekStart||0,he=(ne<Ee?ne+7:ne)-Ee;return G(Y?le-he:le+(6-he),ae);case c:case g:return Z(Se+"Hours",0);case l:return Z(Se+"Minutes",1);case o:return Z(Se+"Seconds",2);case a:return Z(Se+"Milliseconds",3);default:return this.clone()}},V.endOf=function(D){return this.startOf(D,!1)},V.$set=function(D,z){var $,Y=F.p(D),B="set"+(this.$u?"UTC":""),G=($={},$[c]=B+"Date",$[g]=B+"Date",$[d]=B+"Month",$[p]=B+"FullYear",$[l]=B+"Hours",$[o]=B+"Minutes",$[a]=B+"Seconds",$[i]=B+"Milliseconds",$)[Y],Z=Y===c?this.$D+(z-this.$W):z;if(Y===d||Y===p){var ne=this.clone().set(g,1);ne.$d[G](Z),ne.init(),this.$d=ne.set(g,Math.min(this.$D,ne.daysInMonth())).$d}else G&&this.$d[G](Z);return this.init(),this},V.set=function(D,z){return this.clone().$set(D,z)},V.get=function(D){return this[F.p(D)]()},V.add=function(D,z){var $,Y=this;D=Number(D);var B=F.p(z),G=function(ae){var le=j(Y);return F.w(le.date(le.date()+Math.round(ae*D)),Y)};if(B===d)return this.set(d,this.$M+D);if(B===p)return this.set(p,this.$y+D);if(B===c)return G(1);if(B===u)return G(7);var Z=($={},$[o]=r,$[l]=s,$[a]=n,$)[B]||1,ne=this.$d.getTime()+D*Z;return F.w(ne,this)},V.subtract=function(D,z){return this.add(-1*D,z)},V.format=function(D){var z=this,$=this.$locale();if(!this.isValid())return $.invalidDate||y;var Y=D||"YYYY-MM-DDTHH:mm:ssZ",B=F.z(this),G=this.$H,Z=this.$m,ne=this.$M,ae=$.weekdays,le=$.months,Se=$.meridiem,Ee=function(Le,He,Fe,Ie){return Le&&(Le[He]||Le(z,Y))||Fe[He].slice(0,Ie)},he=function(Le){return F.s(G%12||12,Le,"0")},pe=Se||function(Le,He,Fe){var Ie=Le<12?"AM":"PM";return Fe?Ie.toLowerCase():Ie};return Y.replace(x,function(Le,He){return He||function(Fe){switch(Fe){case"YY":return String(z.$y).slice(-2);case"YYYY":return F.s(z.$y,4,"0");case"M":return ne+1;case"MM":return F.s(ne+1,2,"0");case"MMM":return Ee($.monthsShort,ne,le,3);case"MMMM":return Ee(le,ne);case"D":return z.$D;case"DD":return F.s(z.$D,2,"0");case"d":return String(z.$W);case"dd":return Ee($.weekdaysMin,z.$W,ae,2);case"ddd":return Ee($.weekdaysShort,z.$W,ae,3);case"dddd":return ae[z.$W];case"H":return String(G);case"HH":return F.s(G,2,"0");case"h":return he(1);case"hh":return he(2);case"a":return pe(G,Z,!0);case"A":return pe(G,Z,!1);case"m":return String(Z);case"mm":return F.s(Z,2,"0");case"s":return String(z.$s);case"ss":return F.s(z.$s,2,"0");case"SSS":return F.s(z.$ms,3,"0");case"Z":return B}return null}(Le)||B.replace(":","")})},V.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},V.diff=function(D,z,$){var Y,B=this,G=F.p(z),Z=j(D),ne=(Z.utcOffset()-this.utcOffset())*r,ae=this-Z,le=function(){return F.m(B,Z)};switch(G){case p:Y=le()/12;break;case d:Y=le();break;case h:Y=le()/3;break;case u:Y=(ae-ne)/6048e5;break;case c:Y=(ae-ne)/864e5;break;case l:Y=ae/s;break;case o:Y=ae/r;break;case a:Y=ae/n;break;default:Y=ae}return $?Y:F.a(Y)},V.daysInMonth=function(){return this.endOf(d).$D},V.$locale=function(){return T[this.$L]},V.locale=function(D,z){if(!D)return this.$L;var $=this.clone(),Y=M(D,z,!0);return Y&&($.$L=Y),$},V.clone=function(){return F.w(this.$d,this)},V.toDate=function(){return new Date(this.valueOf())},V.toJSON=function(){return this.isValid()?this.toISOString():null},V.toISOString=function(){return this.$d.toISOString()},V.toString=function(){return this.$d.toUTCString()},I}(),q=P.prototype;return j.prototype=q,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",p],["$D",g]].forEach(function(I){q[I[1]]=function(V){return this.$g(V,I[0],I[1])}}),j.extend=function(I,V){return I.$i||(I(V,P,j),I.$i=!0),j},j.locale=M,j.isDayjs=R,j.unix=function(I){return j(1e3*I)},j.en=T[k],j.Ls=T,j.p={},j})}(ak)),ak.exports}var olt=alt();const llt=la(olt),ok={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return ok.hue2rgb(i,s,e+1/3)*255;case"g":return ok.hue2rgb(i,s,e)*255;case"b":return ok.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},clt={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},ult={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},hr={channel:ok,lang:clt,unit:ult},Fh={};for(let e=0;e<=255;e++)Fh[e]=hr.unit.dec2hex(e);const Ga={ALL:0,RGB:1,HSL:2};class dlt{constructor(){this.type=Ga.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Ga.ALL}is(t){return this.type===t}}class flt{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new dlt}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Ga.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=hr.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=hr.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=hr.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=hr.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=hr.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=hr.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Ga.HSL)&&n!==void 0?n:(this._ensureHSL(),hr.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Ga.HSL)&&n!==void 0?n:(this._ensureHSL(),hr.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Ga.HSL)&&n!==void 0?n:(this._ensureHSL(),hr.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Ga.RGB)&&n!==void 0?n:(this._ensureRGB(),hr.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Ga.RGB)&&n!==void 0?n:(this._ensureRGB(),hr.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Ga.RGB)&&n!==void 0?n:(this._ensureRGB(),hr.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Ga.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Ga.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Ga.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Ga.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Ga.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Ga.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const TN=new flt({r:0,g:0,b:0,a:0},"transparent"),Ay={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(Ay.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return TN.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${Fh[Math.round(t)]}${Fh[Math.round(n)]}${Fh[Math.round(r)]}${Fh[Math.round(s*255)]}`:`#${Fh[Math.round(t)]}${Fh[Math.round(n)]}${Fh[Math.round(r)]}`}},Bm={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(Bm.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return hr.channel.clamp.h(parseFloat(n)*.9);case"rad":return hr.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return hr.channel.clamp.h(parseFloat(n)*360)}}return hr.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(Bm.re);if(!n)return;const[,r,s,i,a,o]=n;return TN.set({h:Bm._hue2deg(r),s:hr.channel.clamp.s(parseFloat(s)),l:hr.channel.clamp.l(parseFloat(i)),a:a?hr.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${hr.lang.round(t)}, ${hr.lang.round(n)}%, ${hr.lang.round(r)}%, ${s})`:`hsl(${hr.lang.round(t)}, ${hr.lang.round(n)}%, ${hr.lang.round(r)}%)`}},Nw={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=Nw.colors[e];if(t)return Ay.parse(t)},stringify:e=>{const t=Ay.stringify(e);for(const n in Nw.colors)if(Nw.colors[n]===t)return n}},ow={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(ow.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return TN.set({r:hr.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:hr.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:hr.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?hr.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${hr.lang.round(t)}, ${hr.lang.round(n)}, ${hr.lang.round(r)}, ${hr.lang.round(s)})`:`rgb(${hr.lang.round(t)}, ${hr.lang.round(n)}, ${hr.lang.round(r)})`}},fd={format:{keyword:Nw,hex:Ay,rgb:ow,rgba:ow,hsl:Bm,hsla:Bm},parse:e=>{if(typeof e!="string")return e;const t=Ay.parse(e)||ow.parse(e)||Bm.parse(e)||Nw.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Ga.HSL)||e.data.r===void 0?Bm.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?ow.stringify(e):Ay.stringify(e)},bue=(e,t)=>{const n=fd.parse(e);for(const r in t)n[r]=hr.channel.clamp[r](t[r]);return fd.stringify(n)},Rw=(e,t,n=0,r=1)=>{if(typeof e!="number")return bue(e,{a:t});const s=TN.set({r:hr.channel.clamp.r(e),g:hr.channel.clamp.g(t),b:hr.channel.clamp.b(n),a:hr.channel.clamp.a(r)});return fd.stringify(s)},hlt=e=>{const{r:t,g:n,b:r}=fd.parse(e),s=.2126*hr.channel.toLinear(t)+.7152*hr.channel.toLinear(n)+.0722*hr.channel.toLinear(r);return hr.lang.round(s)},plt=e=>hlt(e)>=.5,m_=e=>!plt(e),vue=(e,t,n)=>{const r=fd.parse(e),s=r[t],i=hr.channel.clamp[t](s+n);return s!==i&&(r[t]=i),fd.stringify(r)},kn=(e,t)=>vue(e,"l",t),Hn=(e,t)=>vue(e,"l",-t),xt=(e,t)=>{const n=fd.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return bue(e,r)},mlt=(e,t,n=50)=>{const{r,g:s,b:i,a}=fd.parse(e),{r:o,g:l,b:c,a:u}=fd.parse(t),d=n/100,h=d*2-1,p=a-u,y=((h*p===-1?h:(h+p)/(1+h*p))+1)/2,v=1-y,x=r*y+o*v,w=s*y+l*v,S=i*y+c*v,_=a*d+u*(1-d);return Rw(x,w,S,_)},fn=(e,t=100)=>{const n=fd.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,mlt(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:xue,setPrototypeOf:vG,isFrozen:glt,getPrototypeOf:ylt,getOwnPropertyDescriptor:blt}=Object;let{freeze:Po,seal:vc,create:wue}=Object,{apply:LO,construct:$O}=typeof Reflect<"u"&&Reflect;Po||(Po=function(t){return t});vc||(vc=function(t){return t});LO||(LO=function(t,n,r){return t.apply(n,r)});$O||($O=function(t,n){return new t(...n)});const I2=Oo(Array.prototype.forEach),vlt=Oo(Array.prototype.lastIndexOf),xG=Oo(Array.prototype.pop),jx=Oo(Array.prototype.push),xlt=Oo(Array.prototype.splice),lk=Oo(String.prototype.toLowerCase),oP=Oo(String.prototype.toString),wG=Oo(String.prototype.match),Px=Oo(String.prototype.replace),wlt=Oo(String.prototype.indexOf),Slt=Oo(String.prototype.trim),Bc=Oo(Object.prototype.hasOwnProperty),xo=Oo(RegExp.prototype.test),Ox=_lt(TypeError);function Oo(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return LO(e,t,r)}}function _lt(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $O(e,n)}}function Vr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:lk;vG&&vG(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(glt(t)||(t[r]=i),s=i)}e[s]=!0}return e}function Clt(e){for(let t=0;t<e.length;t++)Bc(e,t)||(e[t]=null);return e}function ef(e){const t=wue(null);for(const[n,r]of xue(e))Bc(e,n)&&(Array.isArray(r)?t[n]=Clt(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=ef(r):t[n]=r);return t}function Dx(e,t){for(;e!==null;){const r=blt(e,t);if(r){if(r.get)return Oo(r.get);if(typeof r.value=="function")return Oo(r.value)}e=ylt(e)}function n(){return null}return n}const SG=Po(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lP=Po(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),cP=Po(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),klt=Po(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),uP=Po(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Elt=Po(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_G=Po(["#text"]),CG=Po(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),dP=Po(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),kG=Po(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),M2=Po(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Tlt=vc(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Alt=vc(/<%[\w\W]*|[\w\W]*%>/gm),Nlt=vc(/\$\{[\w\W]*/gm),Rlt=vc(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ilt=vc(/^aria-[\-\w]+$/),Sue=vc(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Mlt=vc(/^(?:\w+script|data):/i),jlt=vc(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),_ue=vc(/^html$/i),Plt=vc(/^[a-z][.\w]*(-[.\w]+)+$/i);var EG=Object.freeze({__proto__:null,ARIA_ATTR:Ilt,ATTR_WHITESPACE:jlt,CUSTOM_ELEMENT:Plt,DATA_ATTR:Rlt,DOCTYPE_NAME:_ue,ERB_EXPR:Alt,IS_ALLOWED_URI:Sue,IS_SCRIPT_OR_DATA:Mlt,MUSTACHE_EXPR:Tlt,TMPLIT_EXPR:Nlt});const Fx={element:1,text:3,progressingInstruction:7,comment:8,document:9},Olt=function(){return typeof window>"u"?null:window},Dlt=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},TG=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Cue(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Olt();const t=mn=>Cue(mn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Fx.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:p}=e,g=l.prototype,y=Dx(g,"cloneNode"),v=Dx(g,"remove"),x=Dx(g,"nextSibling"),w=Dx(g,"childNodes"),S=Dx(g,"parentNode");if(typeof a=="function"){const mn=n.createElement("template");mn.content&&mn.content.ownerDocument&&(n=mn.content.ownerDocument)}let _,k="";const{implementation:T,createNodeIterator:A,createDocumentFragment:R,getElementsByTagName:M}=n,{importNode:j}=r;let F=TG();t.isSupported=typeof xue=="function"&&typeof S=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:q,TMPLIT_EXPR:I,DATA_ATTR:V,ARIA_ATTR:D,IS_SCRIPT_OR_DATA:z,ATTR_WHITESPACE:$,CUSTOM_ELEMENT:Y}=EG;let{IS_ALLOWED_URI:B}=EG,G=null;const Z=Vr({},[...SG,...lP,...cP,...uP,..._G]);let ne=null;const ae=Vr({},[...CG,...dP,...kG,...M2]);let le=Object.seal(wue(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Se=null,Ee=null,he=!0,pe=!0,Le=!1,He=!0,Fe=!1,Ie=!0,X=!1,ye=!1,Ne=!1,fe=!1,ce=!1,se=!1,Pe=!0,Be=!1;const je="user-content-";let ot=!0,Et=!1,ut={},Pt=null;const $t=Vr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ft=null;const Ht=Vr({},["audio","video","img","source","image","track"]);let Ce=null;const U=Vr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ee="http://www.w3.org/1998/Math/MathML",xe="http://www.w3.org/2000/svg",Re="http://www.w3.org/1999/xhtml";let ve=Re,Me=!1,de=null;const ht=Vr({},[ee,xe,Re],oP);let et=Vr({},["mi","mo","mn","ms","mtext"]),W=Vr({},["annotation-xml"]);const Ve=Vr({},["title","style","font","a","script"]);let tt=null;const we=["application/xhtml+xml","text/html"],Te="text/html";let Ue=null,Ct=null;const me=n.createElement("form"),Q=function(nt){return nt instanceof RegExp||nt instanceof Function},J=function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ct&&Ct===nt)){if((!nt||typeof nt!="object")&&(nt={}),nt=ef(nt),tt=we.indexOf(nt.PARSER_MEDIA_TYPE)===-1?Te:nt.PARSER_MEDIA_TYPE,Ue=tt==="application/xhtml+xml"?oP:lk,G=Bc(nt,"ALLOWED_TAGS")?Vr({},nt.ALLOWED_TAGS,Ue):Z,ne=Bc(nt,"ALLOWED_ATTR")?Vr({},nt.ALLOWED_ATTR,Ue):ae,de=Bc(nt,"ALLOWED_NAMESPACES")?Vr({},nt.ALLOWED_NAMESPACES,oP):ht,Ce=Bc(nt,"ADD_URI_SAFE_ATTR")?Vr(ef(U),nt.ADD_URI_SAFE_ATTR,Ue):U,Ft=Bc(nt,"ADD_DATA_URI_TAGS")?Vr(ef(Ht),nt.ADD_DATA_URI_TAGS,Ue):Ht,Pt=Bc(nt,"FORBID_CONTENTS")?Vr({},nt.FORBID_CONTENTS,Ue):$t,Se=Bc(nt,"FORBID_TAGS")?Vr({},nt.FORBID_TAGS,Ue):ef({}),Ee=Bc(nt,"FORBID_ATTR")?Vr({},nt.FORBID_ATTR,Ue):ef({}),ut=Bc(nt,"USE_PROFILES")?nt.USE_PROFILES:!1,he=nt.ALLOW_ARIA_ATTR!==!1,pe=nt.ALLOW_DATA_ATTR!==!1,Le=nt.ALLOW_UNKNOWN_PROTOCOLS||!1,He=nt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Fe=nt.SAFE_FOR_TEMPLATES||!1,Ie=nt.SAFE_FOR_XML!==!1,X=nt.WHOLE_DOCUMENT||!1,fe=nt.RETURN_DOM||!1,ce=nt.RETURN_DOM_FRAGMENT||!1,se=nt.RETURN_TRUSTED_TYPE||!1,Ne=nt.FORCE_BODY||!1,Pe=nt.SANITIZE_DOM!==!1,Be=nt.SANITIZE_NAMED_PROPS||!1,ot=nt.KEEP_CONTENT!==!1,Et=nt.IN_PLACE||!1,B=nt.ALLOWED_URI_REGEXP||Sue,ve=nt.NAMESPACE||Re,et=nt.MATHML_TEXT_INTEGRATION_POINTS||et,W=nt.HTML_INTEGRATION_POINTS||W,le=nt.CUSTOM_ELEMENT_HANDLING||{},nt.CUSTOM_ELEMENT_HANDLING&&Q(nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&Q(nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&typeof nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Fe&&(pe=!1),ce&&(fe=!0),ut&&(G=Vr({},_G),ne=[],ut.html===!0&&(Vr(G,SG),Vr(ne,CG)),ut.svg===!0&&(Vr(G,lP),Vr(ne,dP),Vr(ne,M2)),ut.svgFilters===!0&&(Vr(G,cP),Vr(ne,dP),Vr(ne,M2)),ut.mathMl===!0&&(Vr(G,uP),Vr(ne,kG),Vr(ne,M2))),nt.ADD_TAGS&&(G===Z&&(G=ef(G)),Vr(G,nt.ADD_TAGS,Ue)),nt.ADD_ATTR&&(ne===ae&&(ne=ef(ne)),Vr(ne,nt.ADD_ATTR,Ue)),nt.ADD_URI_SAFE_ATTR&&Vr(Ce,nt.ADD_URI_SAFE_ATTR,Ue),nt.FORBID_CONTENTS&&(Pt===$t&&(Pt=ef(Pt)),Vr(Pt,nt.FORBID_CONTENTS,Ue)),ot&&(G["#text"]=!0),X&&Vr(G,["html","head","body"]),G.table&&(Vr(G,["tbody"]),delete Se.tbody),nt.TRUSTED_TYPES_POLICY){if(typeof nt.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ox('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof nt.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ox('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');_=nt.TRUSTED_TYPES_POLICY,k=_.createHTML("")}else _===void 0&&(_=Dlt(p,s)),_!==null&&typeof k=="string"&&(k=_.createHTML(""));Po&&Po(nt),Ct=nt}},te=Vr({},[...lP,...cP,...klt]),_e=Vr({},[...uP,...Elt]),$e=function(nt){let Vt=S(nt);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:ve,tagName:"template"});const gn=lk(nt.tagName),tr=lk(Vt.tagName);return de[nt.namespaceURI]?nt.namespaceURI===xe?Vt.namespaceURI===Re?gn==="svg":Vt.namespaceURI===ee?gn==="svg"&&(tr==="annotation-xml"||et[tr]):!!te[gn]:nt.namespaceURI===ee?Vt.namespaceURI===Re?gn==="math":Vt.namespaceURI===xe?gn==="math"&&W[tr]:!!_e[gn]:nt.namespaceURI===Re?Vt.namespaceURI===xe&&!W[tr]||Vt.namespaceURI===ee&&!et[tr]?!1:!_e[gn]&&(Ve[gn]||!te[gn]):!!(tt==="application/xhtml+xml"&&de[nt.namespaceURI]):!1},Ge=function(nt){jx(t.removed,{element:nt});try{S(nt).removeChild(nt)}catch{v(nt)}},wt=function(nt,Vt){try{jx(t.removed,{attribute:Vt.getAttributeNode(nt),from:Vt})}catch{jx(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(nt),nt==="is")if(fe||ce)try{Ge(Vt)}catch{}else try{Vt.setAttribute(nt,"")}catch{}},Jt=function(nt){let Vt=null,gn=null;if(Ne)nt="<remove></remove>"+nt;else{const es=wG(nt,/^[\r\n\t ]+/);gn=es&&es[0]}tt==="application/xhtml+xml"&&ve===Re&&(nt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+nt+"</body></html>");const tr=_?_.createHTML(nt):nt;if(ve===Re)try{Vt=new h().parseFromString(tr,tt)}catch{}if(!Vt||!Vt.documentElement){Vt=T.createDocument(ve,"template",null);try{Vt.documentElement.innerHTML=Me?k:tr}catch{}}const ps=Vt.body||Vt.documentElement;return nt&&gn&&ps.insertBefore(n.createTextNode(gn),ps.childNodes[0]||null),ve===Re?M.call(Vt,X?"html":"body")[0]:X?Vt.documentElement:ps},jn=function(nt){return A.call(nt.ownerDocument||nt,nt,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Gt=function(nt){return nt instanceof d&&(typeof nt.nodeName!="string"||typeof nt.textContent!="string"||typeof nt.removeChild!="function"||!(nt.attributes instanceof u)||typeof nt.removeAttribute!="function"||typeof nt.setAttribute!="function"||typeof nt.namespaceURI!="string"||typeof nt.insertBefore!="function"||typeof nt.hasChildNodes!="function")},rn=function(nt){return typeof o=="function"&&nt instanceof o};function dn(mn,nt,Vt){I2(mn,gn=>{gn.call(t,nt,Vt,Ct)})}const br=function(nt){let Vt=null;if(dn(F.beforeSanitizeElements,nt,null),Gt(nt))return Ge(nt),!0;const gn=Ue(nt.nodeName);if(dn(F.uponSanitizeElement,nt,{tagName:gn,allowedTags:G}),Ie&&nt.hasChildNodes()&&!rn(nt.firstElementChild)&&xo(/<[/\w!]/g,nt.innerHTML)&&xo(/<[/\w!]/g,nt.textContent)||nt.nodeType===Fx.progressingInstruction||Ie&&nt.nodeType===Fx.comment&&xo(/<[/\w]/g,nt.data))return Ge(nt),!0;if(!G[gn]||Se[gn]){if(!Se[gn]&&Jr(gn)&&(le.tagNameCheck instanceof RegExp&&xo(le.tagNameCheck,gn)||le.tagNameCheck instanceof Function&&le.tagNameCheck(gn)))return!1;if(ot&&!Pt[gn]){const tr=S(nt)||nt.parentNode,ps=w(nt)||nt.childNodes;if(ps&&tr){const es=ps.length;for(let xi=es-1;xi>=0;--xi){const si=y(ps[xi],!0);si.__removalCount=(nt.__removalCount||0)+1,tr.insertBefore(si,x(nt))}}}return Ge(nt),!0}return nt instanceof l&&!$e(nt)||(gn==="noscript"||gn==="noembed"||gn==="noframes")&&xo(/<\/no(script|embed|frames)/i,nt.innerHTML)?(Ge(nt),!0):(Fe&&nt.nodeType===Fx.text&&(Vt=nt.textContent,I2([P,q,I],tr=>{Vt=Px(Vt,tr," ")}),nt.textContent!==Vt&&(jx(t.removed,{element:nt.cloneNode()}),nt.textContent=Vt)),dn(F.afterSanitizeElements,nt,null),!1)},Cr=function(nt,Vt,gn){if(Pe&&(Vt==="id"||Vt==="name")&&(gn in n||gn in me))return!1;if(!(pe&&!Ee[Vt]&&xo(V,Vt))){if(!(he&&xo(D,Vt))){if(!ne[Vt]||Ee[Vt]){if(!(Jr(nt)&&(le.tagNameCheck instanceof RegExp&&xo(le.tagNameCheck,nt)||le.tagNameCheck instanceof Function&&le.tagNameCheck(nt))&&(le.attributeNameCheck instanceof RegExp&&xo(le.attributeNameCheck,Vt)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(Vt))||Vt==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&xo(le.tagNameCheck,gn)||le.tagNameCheck instanceof Function&&le.tagNameCheck(gn))))return!1}else if(!Ce[Vt]){if(!xo(B,Px(gn,$,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&nt!=="script"&&wlt(gn,"data:")===0&&Ft[nt])){if(!(Le&&!xo(z,Px(gn,$,"")))){if(gn)return!1}}}}}}return!0},Jr=function(nt){return nt!=="annotation-xml"&&wG(nt,Y)},Qr=function(nt){dn(F.beforeSanitizeAttributes,nt,null);const{attributes:Vt}=nt;if(!Vt||Gt(nt))return;const gn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ne,forceKeepAttr:void 0};let tr=Vt.length;for(;tr--;){const ps=Vt[tr],{name:es,namespaceURI:xi,value:si}=ps,Ea=Ue(es),Zi=si;let $s=es==="value"?Zi:Slt(Zi);if(gn.attrName=Ea,gn.attrValue=$s,gn.keepAttr=!0,gn.forceKeepAttr=void 0,dn(F.uponSanitizeAttribute,nt,gn),$s=gn.attrValue,Be&&(Ea==="id"||Ea==="name")&&(wt(es,nt),$s=je+$s),Ie&&xo(/((--!?|])>)|<\/(style|title)/i,$s)){wt(es,nt);continue}if(gn.forceKeepAttr)continue;if(!gn.keepAttr){wt(es,nt);continue}if(!He&&xo(/\/>/i,$s)){wt(es,nt);continue}Fe&&I2([P,q,I],ho=>{$s=Px($s,ho," ")});const fo=Ue(nt.nodeName);if(!Cr(fo,Ea,$s)){wt(es,nt);continue}if(_&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!xi)switch(p.getAttributeType(fo,Ea)){case"TrustedHTML":{$s=_.createHTML($s);break}case"TrustedScriptURL":{$s=_.createScriptURL($s);break}}if($s!==Zi)try{xi?nt.setAttributeNS(xi,es,$s):nt.setAttribute(es,$s),Gt(nt)?Ge(nt):xG(t.removed)}catch{wt(es,nt)}}dn(F.afterSanitizeAttributes,nt,null)},Sr=function mn(nt){let Vt=null;const gn=jn(nt);for(dn(F.beforeSanitizeShadowDOM,nt,null);Vt=gn.nextNode();)dn(F.uponSanitizeShadowNode,Vt,null),br(Vt),Qr(Vt),Vt.content instanceof i&&mn(Vt.content);dn(F.afterSanitizeShadowDOM,nt,null)};return t.sanitize=function(mn){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,gn=null,tr=null,ps=null;if(Me=!mn,Me&&(mn="<!-->"),typeof mn!="string"&&!rn(mn))if(typeof mn.toString=="function"){if(mn=mn.toString(),typeof mn!="string")throw Ox("dirty is not a string, aborting")}else throw Ox("toString is not a function");if(!t.isSupported)return mn;if(ye||J(nt),t.removed=[],typeof mn=="string"&&(Et=!1),Et){if(mn.nodeName){const si=Ue(mn.nodeName);if(!G[si]||Se[si])throw Ox("root node is forbidden and cannot be sanitized in-place")}}else if(mn instanceof o)Vt=Jt("<!---->"),gn=Vt.ownerDocument.importNode(mn,!0),gn.nodeType===Fx.element&&gn.nodeName==="BODY"||gn.nodeName==="HTML"?Vt=gn:Vt.appendChild(gn);else{if(!fe&&!Fe&&!X&&mn.indexOf("<")===-1)return _&&se?_.createHTML(mn):mn;if(Vt=Jt(mn),!Vt)return fe?null:se?k:""}Vt&&Ne&&Ge(Vt.firstChild);const es=jn(Et?mn:Vt);for(;tr=es.nextNode();)br(tr),Qr(tr),tr.content instanceof i&&Sr(tr.content);if(Et)return mn;if(fe){if(ce)for(ps=R.call(Vt.ownerDocument);Vt.firstChild;)ps.appendChild(Vt.firstChild);else ps=Vt;return(ne.shadowroot||ne.shadowrootmode)&&(ps=j.call(r,ps,!0)),ps}let xi=X?Vt.outerHTML:Vt.innerHTML;return X&&G["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&xo(_ue,Vt.ownerDocument.doctype.name)&&(xi="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+xi),Fe&&I2([P,q,I],si=>{xi=Px(xi,si," ")}),_&&se?_.createHTML(xi):xi},t.setConfig=function(){let mn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};J(mn),ye=!0},t.clearConfig=function(){Ct=null,ye=!1},t.isValidAttribute=function(mn,nt,Vt){Ct||J({});const gn=Ue(mn),tr=Ue(nt);return Cr(gn,tr,Vt)},t.addHook=function(mn,nt){typeof nt=="function"&&jx(F[mn],nt)},t.removeHook=function(mn,nt){if(nt!==void 0){const Vt=vlt(F[mn],nt);return Vt===-1?void 0:xlt(F[mn],Vt,1)[0]}return xG(F[mn])},t.removeHooks=function(mn){F[mn]=[]},t.removeAllHooks=function(){F=TG()},t}var Sb=Cue(),kue=Object.defineProperty,ie=(e,t)=>kue(e,"name",{value:t,configurable:!0}),Flt=(e,t)=>{for(var n in t)kue(e,n,{get:t[n],enumerable:!0})},Xd={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},qt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},wL=ie(function(e="fatal"){let t=Xd.fatal;typeof e=="string"?e.toLowerCase()in Xd&&(t=Xd[e]):typeof e=="number"&&(t=e),qt.trace=()=>{},qt.debug=()=>{},qt.info=()=>{},qt.warn=()=>{},qt.error=()=>{},qt.fatal=()=>{},t<=Xd.fatal&&(qt.fatal=console.error?console.error.bind(console,Ql("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Ql("FATAL"))),t<=Xd.error&&(qt.error=console.error?console.error.bind(console,Ql("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Ql("ERROR"))),t<=Xd.warn&&(qt.warn=console.warn?console.warn.bind(console,Ql("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Ql("WARN"))),t<=Xd.info&&(qt.info=console.info?console.info.bind(console,Ql("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Ql("INFO"))),t<=Xd.debug&&(qt.debug=console.debug?console.debug.bind(console,Ql("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Ql("DEBUG"))),t<=Xd.trace&&(qt.trace=console.debug?console.debug.bind(console,Ql("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Ql("TRACE")))},"setLogLevel"),Ql=ie(e=>`%c${llt().format("ss.SSS")} : ${e} : `,"format"),Eue=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Iw=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,Llt=/\s*%%.*\n/gm,Ry,Tue=(Ry=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(Ry,"UnknownDiagramError"),Ry),_b={},SL=ie(function(e,t){e=e.replace(Eue,"").replace(Iw,"").replace(Llt,`
`);for(const[n,{detector:r}]of Object.entries(_b))if(r(e,t))return n;throw new Tue(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),Aue=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)Nue(t,n,r)},"registerLazyLoadedDiagrams"),Nue=ie((e,t,n)=>{_b[e]&&qt.warn(`Detector with key ${e} already exists. Overwriting.`),_b[e]={detector:t,loader:n},qt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),$lt=ie(e=>_b[e].loader,"getDiagramLoader"),BO=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>BO(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=BO(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),La=BO,AN="#ffffff",NN="#f2f2f2",So=ie((e,t)=>t?xt(e,{s:-40,l:10}):xt(e,{s:-40,l:-10}),"mkBorder"),Iy,Blt=(Iy=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k,T;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||xt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||xt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||So(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||So(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||So(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||So(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||fn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||fn(this.tertiaryColor),this.lineColor=this.lineColor||fn(this.background),this.arrowheadColor=this.arrowheadColor||fn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?Hn(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||Hn(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||fn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||kn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||Hn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Hn(this.mainBkg,10)):(this.rowOdd=this.rowOdd||kn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||kn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.darkMode)for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=Hn(this["cScale"+A],75);else for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=Hn(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||fn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this.darkMode?this["cScalePeer"+A]=this["cScalePeer"+A]||kn(this["cScale"+A],10):this["cScalePeer"+A]=this["cScalePeer"+A]||Hn(this["cScale"+A],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||xt(this.mainBkg,{h:180,s:-15,l:t*(5+A*3)}),this["surfacePeer"+A]=this["surfacePeer"+A]||xt(this.mainBkg,{h:180,s:-15,l:t*(8+A*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||xt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||xt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||xt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||xt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||xt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||xt(this.primaryColor,{l:-10}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||xt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||xt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||m_(this.quadrant1Fill)?kn(this.quadrant1Fill):Hn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((p=this.xyChart)==null?void 0:p.titleColor)||this.primaryTextColor,xAxisTitleColor:((g=this.xyChart)==null?void 0:g.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((_=this.xyChart)==null?void 0:_.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((T=this.xyChart)==null?void 0:T.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Hn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=kn(this.git0,25),this.git1=kn(this.git1,25),this.git2=kn(this.git2,25),this.git3=kn(this.git3,25),this.git4=kn(this.git4,25),this.git5=kn(this.git5,25),this.git6=kn(this.git6,25),this.git7=kn(this.git7,25)):(this.git0=Hn(this.git0,25),this.git1=Hn(this.git1,25),this.git2=Hn(this.git2,25),this.git3=Hn(this.git3,25),this.git4=Hn(this.git4,25),this.git5=Hn(this.git5,25),this.git6=Hn(this.git6,25),this.git7=Hn(this.git7,25)),this.gitInv0=this.gitInv0||fn(this.git0),this.gitInv1=this.gitInv1||fn(this.git1),this.gitInv2=this.gitInv2||fn(this.git2),this.gitInv3=this.gitInv3||fn(this.git3),this.gitInv4=this.gitInv4||fn(this.git4),this.gitInv5=this.gitInv5||fn(this.git5),this.gitInv6=this.gitInv6||fn(this.git6),this.gitInv7=this.gitInv7||fn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||AN,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||NN}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(Iy,"Theme"),Iy),zlt=ie(e=>{const t=new Blt;return t.calculate(e),t},"getThemeVariables"),My,Ult=(My=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=kn(this.primaryColor,16),this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=fn(this.background),this.secondaryBorderColor=So(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=So(this.tertiaryColor,this.darkMode),this.primaryTextColor=fn(this.primaryColor),this.secondaryTextColor=fn(this.secondaryColor),this.tertiaryTextColor=fn(this.tertiaryColor),this.lineColor=fn(this.background),this.textColor=fn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=kn(fn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=Rw(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=Hn("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=Hn(this.sectionBkgColor,10),this.taskBorderColor=Rw(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=Rw(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||kn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Hn(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k;this.secondBkg=kn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=kn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=kn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||fn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScalePeer"+T]=this["cScalePeer"+T]||kn(this["cScale"+T],10);for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(-10+T*4)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(-7+T*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||m_(this.quadrant1Fill)?kn(this.quadrant1Fill):Hn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((p=this.radar)==null?void 0:p.axisStrokeWidth)||2,axisLabelFontSize:((g=this.radar)==null?void 0:g.axisLabelFontSize)||12,curveOpacity:((y=this.radar)==null?void 0:y.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((_=this.radar)==null?void 0:_.legendBoxSize)||12,legendFontSize:((k=this.radar)==null?void 0:k.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Hn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=kn(this.secondaryColor,20),this.git1=kn(this.pie2||this.secondaryColor,20),this.git2=kn(this.pie3||this.tertiaryColor,20),this.git3=kn(this.pie4||xt(this.primaryColor,{h:-30}),20),this.git4=kn(this.pie5||xt(this.primaryColor,{h:-60}),20),this.git5=kn(this.pie6||xt(this.primaryColor,{h:-90}),10),this.git6=kn(this.pie7||xt(this.primaryColor,{h:60}),10),this.git7=kn(this.pie8||xt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||fn(this.git0),this.gitInv1=this.gitInv1||fn(this.git1),this.gitInv2=this.gitInv2||fn(this.git2),this.gitInv3=this.gitInv3||fn(this.git3),this.gitInv4=this.gitInv4||fn(this.git4),this.gitInv5=this.gitInv5||fn(this.git5),this.gitInv6=this.gitInv6||fn(this.git6),this.gitInv7=this.gitInv7||fn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||fn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||fn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||kn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||kn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(My,"Theme"),My),qlt=ie(e=>{const t=new Ult;return t.calculate(e),t},"getThemeVariables"),jy,Vlt=(jy=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=xt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=So(this.primaryColor,this.darkMode),this.secondaryBorderColor=So(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=So(this.tertiaryColor,this.darkMode),this.primaryTextColor=fn(this.primaryColor),this.secondaryTextColor=fn(this.secondaryColor),this.tertiaryTextColor=fn(this.tertiaryColor),this.lineColor=fn(this.background),this.textColor=fn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=Rw(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Hn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Hn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Hn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Hn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||xt(this["cScale"+T],{h:180});for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,l:-(7+T*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||fn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||fn(this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=kn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||kn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||kn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||xt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||xt(this.primaryColor,{l:-10}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||xt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||xt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||m_(this.quadrant1Fill)?kn(this.quadrant1Fill):Hn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((p=this.xyChart)==null?void 0:p.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((g=this.xyChart)==null?void 0:g.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((y=this.xyChart)==null?void 0:y.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((_=this.xyChart)==null?void 0:_.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((k=this.xyChart)==null?void 0:k.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=kn(this.git0,25),this.git1=kn(this.git1,25),this.git2=kn(this.git2,25),this.git3=kn(this.git3,25),this.git4=kn(this.git4,25),this.git5=kn(this.git5,25),this.git6=kn(this.git6,25),this.git7=kn(this.git7,25)):(this.git0=Hn(this.git0,25),this.git1=Hn(this.git1,25),this.git2=Hn(this.git2,25),this.git3=Hn(this.git3,25),this.git4=Hn(this.git4,25),this.git5=Hn(this.git5,25),this.git6=Hn(this.git6,25),this.git7=Hn(this.git7,25)),this.gitInv0=this.gitInv0||Hn(fn(this.git0),25),this.gitInv1=this.gitInv1||fn(this.git1),this.gitInv2=this.gitInv2||fn(this.git2),this.gitInv3=this.gitInv3||fn(this.git3),this.gitInv4=this.gitInv4||fn(this.git4),this.gitInv5=this.gitInv5||fn(this.git5),this.gitInv6=this.gitInv6||fn(this.git6),this.gitInv7=this.gitInv7||fn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||fn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||fn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||AN,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||NN}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(jy,"Theme"),jy),Wlt=ie(e=>{const t=new Vlt;return t.calculate(e),t},"getThemeVariables"),Py,Hlt=(Py=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=kn("#cde498",10),this.primaryBorderColor=So(this.primaryColor,this.darkMode),this.secondaryBorderColor=So(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=So(this.tertiaryColor,this.darkMode),this.primaryTextColor=fn(this.primaryColor),this.secondaryTextColor=fn(this.secondaryColor),this.tertiaryTextColor=fn(this.primaryColor),this.lineColor=fn(this.background),this.textColor=fn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k;this.actorBorder=Hn(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Hn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Hn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Hn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Hn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||xt(this["cScale"+T],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||kn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||kn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||xt(this.primaryColor,{l:-30}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||xt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||xt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||m_(this.quadrant1Fill)?kn(this.quadrant1Fill):Hn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((p=this.xyChart)==null?void 0:p.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((g=this.xyChart)==null?void 0:g.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((y=this.xyChart)==null?void 0:y.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((_=this.xyChart)==null?void 0:_.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((k=this.xyChart)==null?void 0:k.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=kn(this.git0,25),this.git1=kn(this.git1,25),this.git2=kn(this.git2,25),this.git3=kn(this.git3,25),this.git4=kn(this.git4,25),this.git5=kn(this.git5,25),this.git6=kn(this.git6,25),this.git7=kn(this.git7,25)):(this.git0=Hn(this.git0,25),this.git1=Hn(this.git1,25),this.git2=Hn(this.git2,25),this.git3=Hn(this.git3,25),this.git4=Hn(this.git4,25),this.git5=Hn(this.git5,25),this.git6=Hn(this.git6,25),this.git7=Hn(this.git7,25)),this.gitInv0=this.gitInv0||fn(this.git0),this.gitInv1=this.gitInv1||fn(this.git1),this.gitInv2=this.gitInv2||fn(this.git2),this.gitInv3=this.gitInv3||fn(this.git3),this.gitInv4=this.gitInv4||fn(this.git4),this.gitInv5=this.gitInv5||fn(this.git5),this.gitInv6=this.gitInv6||fn(this.git6),this.gitInv7=this.gitInv7||fn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||fn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||fn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||AN,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||NN}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(Py,"Theme"),Py),Glt=ie(e=>{const t=new Hlt;return t.calculate(e),t},"getThemeVariables"),Oy,Klt=(Oy=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=kn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=So(this.primaryColor,this.darkMode),this.secondaryBorderColor=So(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=So(this.tertiaryColor,this.darkMode),this.primaryTextColor=fn(this.primaryColor),this.secondaryTextColor=fn(this.secondaryColor),this.tertiaryTextColor=fn(this.tertiaryColor),this.lineColor=fn(this.background),this.textColor=fn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||kn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,p,g,y,v,x,w,S,_,k;this.secondBkg=kn(this.contrast,55),this.border2=this.contrast,this.actorBorder=kn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||fn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this.darkMode?this["cScalePeer"+T]=this["cScalePeer"+T]||kn(this["cScale"+T],10):this["cScalePeer"+T]=this["cScalePeer"+T]||Hn(this["cScale"+T],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=kn(this.contrast,30),this.sectionBkgColor2=kn(this.contrast,30),this.taskBorderColor=Hn(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=kn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=Hn(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||m_(this.quadrant1Fill)?kn(this.quadrant1Fill):Hn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((p=this.radar)==null?void 0:p.axisStrokeWidth)||2,axisLabelFontSize:((g=this.radar)==null?void 0:g.axisLabelFontSize)||12,curveOpacity:((y=this.radar)==null?void 0:y.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((_=this.radar)==null?void 0:_.legendBoxSize)||12,legendFontSize:((k=this.radar)==null?void 0:k.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Hn(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||xt(this.primaryColor,{h:-30}),this.git4=this.pie5||xt(this.primaryColor,{h:-60}),this.git5=this.pie6||xt(this.primaryColor,{h:-90}),this.git6=this.pie7||xt(this.primaryColor,{h:60}),this.git7=this.pie8||xt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||fn(this.git0),this.gitInv1=this.gitInv1||fn(this.git1),this.gitInv2=this.gitInv2||fn(this.git2),this.gitInv3=this.gitInv3||fn(this.git3),this.gitInv4=this.gitInv4||fn(this.git4),this.gitInv5=this.gitInv5||fn(this.git5),this.gitInv6=this.gitInv6||fn(this.git6),this.gitInv7=this.gitInv7||fn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||AN,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||NN}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(Oy,"Theme"),Oy),Ylt=ie(e=>{const t=new Klt;return t.calculate(e),t},"getThemeVariables"),wf={base:{getThemeVariables:zlt},dark:{getThemeVariables:qlt},default:{getThemeVariables:Wlt},forest:{getThemeVariables:Glt},neutral:{getThemeVariables:Ylt}},Jd={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},Rue={...Jd,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:wf.default.getThemeVariables(),sequence:{...Jd.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...Jd.gantt,tickInterval:void 0,useWidth:void 0},c4:{...Jd.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...Jd.pie,useWidth:984},xyChart:{...Jd.xyChart,useWidth:void 0},requirement:{...Jd.requirement,useWidth:void 0},packet:{...Jd.packet},radar:{...Jd.radar}},Iue=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...Iue(e[r],"")]:[...n,t+r],[]),"keyify"),Zlt=new Set(Iue(Rue,"")),Mue=Rue,eT=ie(e=>{if(qt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>eT(t));return}for(const t of Object.keys(e)){if(qt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!Zlt.has(t)||e[t]==null){qt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){qt.debug("sanitizing object",t),eT(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(qt.debug("sanitizing css option",t),e[t]=Xlt(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}qt.debug("After sanitization",e)}},"sanitizeDirective"),Xlt=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),Cb=Object.freeze(Mue),Yo=La({},Cb),jue,kb=[],Mw=La({},Cb),RN=ie((e,t)=>{let n=La({},e),r={};for(const s of t)Due(s),r=La(r,s);if(n=La(n,r),r.theme&&r.theme in wf){const s=La({},jue),i=La(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in wf&&(n.themeVariables=wf[n.theme].getThemeVariables(i))}return Mw=n,Fue(Mw),Mw},"updateCurrentConfig"),Jlt=ie(e=>(Yo=La({},Cb),Yo=La(Yo,e),e.theme&&wf[e.theme]&&(Yo.themeVariables=wf[e.theme].getThemeVariables(e.themeVariables)),RN(Yo,kb),Yo),"setSiteConfig"),Qlt=ie(e=>{jue=La({},e)},"saveConfigFromInitialize"),ect=ie(e=>(Yo=La(Yo,e),RN(Yo,kb),Yo),"updateSiteConfig"),Pue=ie(()=>La({},Yo),"getSiteConfig"),Oue=ie(e=>(Fue(e),La(Mw,e),il()),"setConfig"),il=ie(()=>La({},Mw),"getConfig"),Due=ie(e=>{e&&(["secure",...Yo.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(qt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&Due(e[t])}))},"sanitize"),tct=ie(e=>{var t;eT(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),kb.push(e),RN(Yo,kb)},"addDirective"),tT=ie((e=Yo)=>{kb=[],RN(e,kb)},"reset"),nct={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},AG={},rct=ie(e=>{AG[e]||(qt.warn(nct[e]),AG[e]=!0)},"issueWarning"),Fue=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&rct("LAZY_LOAD_DEPRECATED")},"checkConfig"),g_=/<br\s*\/?>/gi,sct=ie(e=>e?Bue(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),ict=(()=>{let e=!1;return()=>{e||(Lue(),e=!0)}})();function Lue(){const e="data-temp-href-target";Sb.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),Sb.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(Lue,"setupDompurifyHooks");var $ue=ie(e=>(ict(),Sb.sanitize(e)),"removeScript"),NG=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=$ue(e):r!=="loose"&&(e=Bue(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=cct(e))}return e},"sanitizeMore"),gg=ie((e,t)=>e&&(t.dompurifyConfig?e=Sb.sanitize(NG(e,t),t.dompurifyConfig).toString():e=Sb.sanitize(NG(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),act=ie((e,t)=>typeof e=="string"?gg(e,t):e.flat().map(n=>gg(n,t)),"sanitizeTextOrArray"),oct=ie(e=>g_.test(e),"hasBreaks"),lct=ie(e=>e.split(g_),"splitBreaks"),cct=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),Bue=ie(e=>e.replace(g_,"#br#"),"breakToPlaceholder"),uct=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),oa=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),dct=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),fct=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),RG=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];hct(i,a)&&(s=i+","+a,r++,n.pop())}n.push(pct(s))}return n.join("")},"parseGenericTypes"),zO=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),hct=ie((e,t)=>{const n=zO(e,"~"),r=zO(t,"~");return n===1&&r===1},"shouldCombineSets"),pct=ie(e=>{const t=zO(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),IG=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),UO=/\$\$(.*)\$\$/g,Eb=ie(e=>{var t;return(((t=e.match(UO))==null?void 0:t.length)??0)>0},"hasKatex"),jvt=ie(async(e,t)=>{e=await _L(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),_L=ie(async(e,t)=>{if(!Eb(e))return e;if(!(IG()||t.legacyMathML||t.forceLegacyMathML))return e.replace(UO,"MathML is unsupported in this environment.");const{default:n}=await zr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!IG()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(g_).map(s=>Eb(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(UO,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),fv={getRows:sct,sanitizeText:gg,sanitizeTextOrArray:act,hasBreaks:oct,splitBreaks:lct,lineBreakRegex:g_,removeScript:$ue,getUrl:uct,evaluate:oa,getMax:dct,getMin:fct},mct=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),gct=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),zue=ie(function(e,t,n,r){const s=gct(t,n,r);mct(e,s)},"configureSvgSize"),yct=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;qt.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;qt.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,qt.info(`Calculated bounds: ${o}x${l}`),zue(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),ck={},bct=ie((e,t,n)=>{let r="";return e in ck&&ck[e]?r=ck[e](n):qt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),vct=ie((e,t)=>{t!==void 0&&(ck[e]=t)},"addStylesForDiagram"),xct=bct,Uue={};Flt(Uue,{clear:()=>wct,getAccDescription:()=>kct,getAccTitle:()=>_ct,getDiagramTitle:()=>Tct,setAccDescription:()=>Cct,setAccTitle:()=>Sct,setDiagramTitle:()=>Ect});var CL="",kL="",EL="",TL=ie(e=>gg(e,il()),"sanitizeText"),wct=ie(()=>{CL="",EL="",kL=""},"clear"),Sct=ie(e=>{CL=TL(e).replace(/^\s+/g,"")},"setAccTitle"),_ct=ie(()=>CL,"getAccTitle"),Cct=ie(e=>{EL=TL(e).replace(/\n\s+/g,`
`)},"setAccDescription"),kct=ie(()=>EL,"getAccDescription"),Ect=ie(e=>{kL=TL(e)},"setDiagramTitle"),Tct=ie(()=>kL,"getDiagramTitle"),MG=qt,Act=wL,fs=il,Pvt=Oue,Ovt=Cb,AL=ie(e=>gg(e,fs()),"sanitizeText"),Nct=yct,Rct=ie(()=>Uue,"getCommonDb"),nT={},rT=ie((e,t,n)=>{var r;nT[e]&&MG.warn(`Diagram with id ${e} already registered. Overwriting.`),nT[e]=t,n&&Nue(e,n),vct(e,t.styles),(r=t.injectUtils)==null||r.call(t,MG,Act,fs,AL,Nct,Rct(),()=>{})},"registerDiagram"),qO=ie(e=>{if(e in nT)return nT[e];throw new Ict(e)},"getDiagram"),Dy,Ict=(Dy=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(Dy,"DiagramNotFoundError"),Dy);function NL(e){return typeof e>"u"||e===null}ie(NL,"isNothing");function que(e){return typeof e=="object"&&e!==null}ie(que,"isObject");function Vue(e){return Array.isArray(e)?e:NL(e)?[]:[e]}ie(Vue,"toArray");function Wue(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(Wue,"extend");function Hue(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(Hue,"repeat");function Gue(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(Gue,"isNegativeZero");var Mct=NL,jct=que,Pct=Vue,Oct=Hue,Dct=Gue,Fct=Wue,sa={isNothing:Mct,isObject:jct,toArray:Pct,repeat:Oct,isNegativeZero:Dct,extend:Fct};function RL(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(RL,"formatError");function Tb(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=RL(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(Tb,"YAMLException$1");Tb.prototype=Object.create(Error.prototype);Tb.prototype.constructor=Tb;Tb.prototype.toString=ie(function(t){return this.name+": "+RL(this,t)},"toString");var Qo=Tb;function uk(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+i.length}}ie(uk,"getLine");function dk(e,t){return sa.repeat(" ",t-e.length)+e}ie(dk,"padStart");function Kue(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=uk(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=sa.repeat(" ",t.indent)+dk((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=uk(e.buffer,r[a],s[a],e.position,d),o+=sa.repeat(" ",t.indent)+dk((e.line+1).toString(),u)+" | "+c.str+`
`,o+=sa.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=uk(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=sa.repeat(" ",t.indent)+dk((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(Kue,"makeSnippet");var Lct=Kue,$ct=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Bct=["scalar","sequence","mapping"];function Yue(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(Yue,"compileStyleAliases");function Zue(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if($ct.indexOf(n)===-1)throw new Qo('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=Yue(t.styleAliases||null),Bct.indexOf(this.kind)===-1)throw new Qo('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(Zue,"Type$1");var io=Zue;function VO(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie(VO,"compileList");function Xue(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(Xue,"compileMap");function sT(e){return this.extend(e)}ie(sT,"Schema$1");sT.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof io)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Qo("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof io))throw new Qo("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Qo("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Qo("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof io))throw new Qo("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(sT.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=VO(s,"implicit"),s.compiledExplicit=VO(s,"explicit"),s.compiledTypeMap=Xue(s.compiledImplicit,s.compiledExplicit),s},"extend");var zct=sT,Uct=new io("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),qct=new io("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),Vct=new io("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),Wct=new zct({explicit:[Uct,qct,Vct]});function Jue(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(Jue,"resolveYamlNull");function Que(){return null}ie(Que,"constructYamlNull");function ede(e){return e===null}ie(ede,"isNull");var Hct=new io("tag:yaml.org,2002:null",{kind:"scalar",resolve:Jue,construct:Que,predicate:ede,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function tde(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(tde,"resolveYamlBoolean");function nde(e){return e==="true"||e==="True"||e==="TRUE"}ie(nde,"constructYamlBoolean");function rde(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(rde,"isBoolean");var Gct=new io("tag:yaml.org,2002:bool",{kind:"scalar",resolve:tde,construct:nde,predicate:rde,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function sde(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(sde,"isHexCode");function ide(e){return 48<=e&&e<=55}ie(ide,"isOctCode");function ade(e){return 48<=e&&e<=57}ie(ade,"isDecCode");function ode(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!sde(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!ide(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!ade(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(ode,"resolveYamlInteger");function lde(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(lde,"constructYamlInteger");function cde(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!sa.isNegativeZero(e)}ie(cde,"isInteger");var Kct=new io("tag:yaml.org,2002:int",{kind:"scalar",resolve:ode,construct:lde,predicate:cde,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Yct=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ude(e){return!(e===null||!Yct.test(e)||e[e.length-1]==="_")}ie(ude,"resolveYamlFloat");function dde(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(dde,"constructYamlFloat");var Zct=/^[-+]?[0-9]+e/;function fde(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(sa.isNegativeZero(e))return"-0.0";return n=e.toString(10),Zct.test(n)?n.replace("e",".e"):n}ie(fde,"representYamlFloat");function hde(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||sa.isNegativeZero(e))}ie(hde,"isFloat");var Xct=new io("tag:yaml.org,2002:float",{kind:"scalar",resolve:ude,construct:dde,predicate:hde,represent:fde,defaultStyle:"lowercase"}),pde=Wct.extend({implicit:[Hct,Gct,Kct,Xct]}),Jct=pde,mde=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),gde=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function yde(e){return e===null?!1:mde.exec(e)!==null||gde.exec(e)!==null}ie(yde,"resolveYamlTimestamp");function bde(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=mde.exec(e),t===null&&(t=gde.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(bde,"constructYamlTimestamp");function vde(e){return e.toISOString()}ie(vde,"representYamlTimestamp");var Qct=new io("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:yde,construct:bde,instanceOf:Date,represent:vde});function xde(e){return e==="<<"||e===null}ie(xde,"resolveYamlMerge");var eut=new io("tag:yaml.org,2002:merge",{kind:"scalar",resolve:xde}),IL=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function wde(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=IL;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(wde,"resolveYamlBinary");function Sde(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=IL,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(Sde,"constructYamlBinary");function _de(e){var t="",n=0,r,s,i=e.length,a=IL;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(_de,"representYamlBinary");function Cde(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(Cde,"isBinary");var tut=new io("tag:yaml.org,2002:binary",{kind:"scalar",resolve:wde,construct:Sde,predicate:Cde,represent:_de}),nut=Object.prototype.hasOwnProperty,rut=Object.prototype.toString;function kde(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,rut.call(s)!=="[object Object]")return!1;for(i in s)if(nut.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(kde,"resolveYamlOmap");function Ede(e){return e!==null?e:[]}ie(Ede,"constructYamlOmap");var sut=new io("tag:yaml.org,2002:omap",{kind:"sequence",resolve:kde,construct:Ede}),iut=Object.prototype.toString;function Tde(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],iut.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(Tde,"resolveYamlPairs");function Ade(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie(Ade,"constructYamlPairs");var aut=new io("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Tde,construct:Ade}),out=Object.prototype.hasOwnProperty;function Nde(e){if(e===null)return!0;var t,n=e;for(t in n)if(out.call(n,t)&&n[t]!==null)return!1;return!0}ie(Nde,"resolveYamlSet");function Rde(e){return e!==null?e:{}}ie(Rde,"constructYamlSet");var lut=new io("tag:yaml.org,2002:set",{kind:"mapping",resolve:Nde,construct:Rde}),Ide=Jct.extend({implicit:[Qct,eut],explicit:[tut,sut,aut,lut]}),yp=Object.prototype.hasOwnProperty,iT=1,Mde=2,jde=3,aT=4,fP=1,cut=2,jG=3,uut=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,dut=/[\x85\u2028\u2029]/,fut=/[,\[\]\{\}]/,Pde=/^(?:!|!!|![a-z\-]+!)$/i,Ode=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function WO(e){return Object.prototype.toString.call(e)}ie(WO,"_class");function Jc(e){return e===10||e===13}ie(Jc,"is_EOL");function Yh(e){return e===9||e===32}ie(Yh,"is_WHITE_SPACE");function _o(e){return e===9||e===32||e===10||e===13}ie(_o,"is_WS_OR_EOL");function zm(e){return e===44||e===91||e===93||e===123||e===125}ie(zm,"is_FLOW_INDICATOR");function Dde(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(Dde,"fromHexCode");function Fde(e){return e===120?2:e===117?4:e===85?8:0}ie(Fde,"escapedHexLen");function Lde(e){return 48<=e&&e<=57?e-48:-1}ie(Lde,"fromDecimalCode");function HO(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}ie(HO,"simpleEscapeSequence");function $de(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie($de,"charFromCodepoint");var Bde=new Array(256),zde=new Array(256);for(Sm=0;Sm<256;Sm++)Bde[Sm]=HO(Sm)?1:0,zde[Sm]=HO(Sm);var Sm;function Ude(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Ide,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(Ude,"State$1");function ML(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=Lct(n),new Qo(t,n)}ie(ML,"generateError");function Bn(e,t){throw ML(e,t)}ie(Bn,"throwError");function rS(e,t){e.onWarning&&e.onWarning.call(null,ML(e,t))}ie(rS,"throwWarning");var PG={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&Bn(t,"duplication of %YAML directive"),r.length!==1&&Bn(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&Bn(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&Bn(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&rS(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&Bn(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],Pde.test(s)||Bn(t,"ill-formed tag handle (first argument) of the TAG directive"),yp.call(t.tagMap,s)&&Bn(t,'there is a previously declared suffix for "'+s+'" tag handle'),Ode.test(i)||Bn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Bn(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function Sf(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||Bn(e,"expected valid JSON character");else uut.test(o)&&Bn(e,"the stream contains non-printable characters");e.result+=o}}ie(Sf,"captureSegment");function GO(e,t,n,r){var s,i,a,o;for(sa.isObject(n)||Bn(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],yp.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(GO,"mergeMappings");function Um(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&Bn(e,"nested arrays are not supported inside keys"),typeof s=="object"&&WO(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&WO(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)GO(e,t,i[c],n);else GO(e,t,i,n);else!e.json&&!yp.call(n,s)&&yp.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Bn(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(Um,"storeMappingPair");function IN(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Bn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(IN,"readLineBreak");function Ti(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;Yh(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Jc(s))for(IN(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&rS(e,"deficient indentation"),r}ie(Ti,"skipSeparationSpace");function y_(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||_o(n)))}ie(y_,"testDocumentSeparator");function MN(e,t){t===1?e.result+=" ":t>1&&(e.result+=sa.repeat(`
`,t-1))}ie(MN,"writeFoldedLines");function qde(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,p;if(p=e.input.charCodeAt(e.position),_o(p)||zm(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(s=e.input.charCodeAt(e.position+1),_o(s)||n&&zm(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;p!==0;){if(p===58){if(s=e.input.charCodeAt(e.position+1),_o(s)||n&&zm(s))break}else if(p===35){if(r=e.input.charCodeAt(e.position-1),_o(r))break}else{if(e.position===e.lineStart&&y_(e)||n&&zm(p))break;if(Jc(p))if(l=e.line,c=e.lineStart,u=e.lineIndent,Ti(e,!1,-1),e.lineIndent>=t){o=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(Sf(e,i,a,!1),MN(e,e.line-l),i=a=e.position,o=!1),Yh(p)||(a=e.position+1),p=e.input.charCodeAt(++e.position)}return Sf(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(qde,"readPlainScalar");function Vde(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Sf(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else Jc(n)?(Sf(e,r,s,!0),MN(e,Ti(e,!1,t)),r=s=e.position):e.position===e.lineStart&&y_(e)?Bn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);Bn(e,"unexpected end of the stream within a single quoted scalar")}ie(Vde,"readSingleQuotedScalar");function Wde(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return Sf(e,n,e.position,!0),e.position++,!0;if(o===92){if(Sf(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),Jc(o))Ti(e,!1,t);else if(o<256&&Bde[o])e.result+=zde[o],e.position++;else if((a=Fde(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=Dde(o))>=0?i=(i<<4)+a:Bn(e,"expected hexadecimal character");e.result+=$de(i),e.position++}else Bn(e,"unknown escape sequence");n=r=e.position}else Jc(o)?(Sf(e,n,r,!0),MN(e,Ti(e,!1,t)),n=r=e.position):e.position===e.lineStart&&y_(e)?Bn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Bn(e,"unexpected end of the stream within a double quoted scalar")}ie(Wde,"readDoubleQuotedScalar");function Hde(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,p,g=Object.create(null),y,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,p=!1,o=[];else if(w===123)u=125,p=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(Ti(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=p?"mapping":"sequence",e.result=o,!0;n?w===44&&Bn(e,"expected the node content, but found ','"):Bn(e,"missed comma between flow collection entries"),v=y=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),_o(c)&&(d=h=!0,e.position++,Ti(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,yg(e,t,iT,!1,!0),v=e.tag,y=e.result,Ti(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),Ti(e,!0,t),yg(e,t,iT,!1,!0),x=e.result),p?Um(e,o,g,v,y,x,r,s,i):d?o.push(Um(e,null,g,v,y,x,r,s,i)):o.push(y),Ti(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}Bn(e,"unexpected end of the stream within a flow collection")}ie(Hde,"readFlowCollection");function Gde(e,t){var n,r,s=fP,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)fP===s?s=d===43?jG:cut:Bn(e,"repeat of a chomping mode identifier");else if((u=Lde(d))>=0)u===0?Bn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Bn(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(Yh(d)){do d=e.input.charCodeAt(++e.position);while(Yh(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!Jc(d)&&d!==0)}for(;d!==0;){for(IN(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),Jc(d)){l++;continue}if(e.lineIndent<o){s===jG?e.result+=sa.repeat(`
`,i?1+l:l):s===fP&&i&&(e.result+=`
`);break}for(r?Yh(d)?(c=!0,e.result+=sa.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=sa.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=sa.repeat(`
`,l):e.result+=sa.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!Jc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Sf(e,n,e.position,!1)}return!0}ie(Gde,"readBlockScalar");function KO(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Bn(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!_o(a))));){if(o=!0,e.position++,Ti(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,yg(e,t,jde,!1,!0),i.push(e.result),Ti(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)Bn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(KO,"readBlockSequence");function Kde(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),p=null,g=null,y=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Bn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&_o(r))w===63?(v&&(Um(e,d,h,p,g,null,a,o,l),p=g=y=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):Bn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!yg(e,n,Mde,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);Yh(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),_o(w)||Bn(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(Um(e,d,h,p,g,null,a,o,l),p=g=y=null),x=!0,v=!1,s=!1,p=e.tag,g=e.result;else if(x)Bn(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)Bn(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),yg(e,t,aT,!0,s)&&(v?g=e.result:y=e.result),v||(Um(e,d,h,p,g,y,a,o,l),p=g=y=null),Ti(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)Bn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&Um(e,d,h,p,g,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie(Kde,"readBlockMapping");function Yde(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&Bn(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Bn(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!_o(a);)a===33&&(r?Bn(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),Pde.test(s)||Bn(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),fut.test(i)&&Bn(e,"tag suffix cannot contain flow indicator characters")}i&&!Ode.test(i)&&Bn(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Bn(e,"tag name is malformed: "+i)}return n?e.tag=i:yp.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:Bn(e,'undeclared tag handle "'+s+'"'),!0}ie(Yde,"readTagProperty");function Zde(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Bn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!_o(n)&&!zm(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Bn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(Zde,"readAnchorProperty");function Xde(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!_o(r)&&!zm(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Bn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),yp.call(e.anchorMap,n)||Bn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Ti(e,!0,-1),!0}ie(Xde,"readAlias");function yg(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,p,g,y,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=aT===n||jde===n,r&&Ti(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;Yde(e)||Zde(e);)Ti(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||aT===n)&&(iT===n||Mde===n?y=t:y=t+1,v=e.position-e.lineStart,l===1?o&&(KO(e,v)||Kde(e,v,y))||Hde(e,y)?u=!0:(a&&Gde(e,y)||Vde(e,y)||Wde(e,y)?u=!0:Xde(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&Bn(e,"alias node should not have any properties")):qde(e,y,iT===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&KO(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Bn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(g=e.implicitTypes[d],g.resolve(e.result)){e.result=g.construct(e.result),e.tag=g.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(yp.call(e.typeMap[e.kind||"fallback"],e.tag))g=e.typeMap[e.kind||"fallback"][e.tag];else for(g=null,p=e.typeMap.multi[e.kind||"fallback"],d=0,h=p.length;d<h;d+=1)if(e.tag.slice(0,p[d].tag.length)===p[d].tag){g=p[d];break}g||Bn(e,"unknown tag !<"+e.tag+">"),e.result!==null&&g.kind!==e.kind&&Bn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+g.kind+'", not "'+e.kind+'"'),g.resolve(e.result,e.tag)?(e.result=g.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Bn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(yg,"composeNode");function Jde(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(Ti(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!_o(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&Bn(e,"directive name must not be less than one character in length");a!==0;){for(;Yh(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Jc(a));break}if(Jc(a))break;for(n=e.position;a!==0&&!_o(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&IN(e),yp.call(PG,r)?PG[r](e,r,s):rS(e,'unknown document directive "'+r+'"')}if(Ti(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,Ti(e,!0,-1)):i&&Bn(e,"directives end mark is expected"),yg(e,e.lineIndent-1,aT,!1,!0),Ti(e,!0,-1),e.checkLineBreaks&&dut.test(e.input.slice(t,e.position))&&rS(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&y_(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,Ti(e,!0,-1));return}if(e.position<e.length-1)Bn(e,"end of the stream or a document separator is expected");else return}ie(Jde,"readDocument");function jL(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new Ude(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Bn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Jde(n);return n.documents}ie(jL,"loadDocuments");function hut(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=jL(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(hut,"loadAll$1");function Qde(e,t){var n=jL(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Qo("expected a single document in the stream, but found more")}}ie(Qde,"load$1");var put=Qde,mut={load:put},efe=Object.prototype.toString,tfe=Object.prototype.hasOwnProperty,PL=65279,gut=9,sS=10,yut=13,but=32,vut=33,xut=34,YO=35,wut=37,Sut=38,_ut=39,Cut=42,nfe=44,kut=45,oT=58,Eut=61,Tut=62,Aut=63,Nut=64,rfe=91,sfe=93,Rut=96,ife=123,Iut=124,afe=125,uo={};uo[0]="\\0";uo[7]="\\a";uo[8]="\\b";uo[9]="\\t";uo[10]="\\n";uo[11]="\\v";uo[12]="\\f";uo[13]="\\r";uo[27]="\\e";uo[34]='\\"';uo[92]="\\\\";uo[133]="\\N";uo[160]="\\_";uo[8232]="\\L";uo[8233]="\\P";var Mut=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],jut=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function ofe(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&tfe.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(ofe,"compileStyleMap");function lfe(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Qo("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+sa.repeat("0",r-t.length)+t}ie(lfe,"encodeHex");var Put=1,iS=2;function cfe(e){this.schema=e.schema||Ide,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=sa.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=ofe(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?iS:Put,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(cfe,"State");function ZO(e,t){for(var n=sa.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(ZO,"indentString");function lT(e,t){return`
`+sa.repeat(" ",e.indent*t)}ie(lT,"generateNextLine");function ufe(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(ufe,"testImplicitResolving");function aS(e){return e===but||e===gut}ie(aS,"isWhitespace");function Ab(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==PL||65536<=e&&e<=1114111}ie(Ab,"isPrintable");function XO(e){return Ab(e)&&e!==PL&&e!==yut&&e!==sS}ie(XO,"isNsCharOrWhitespace");function JO(e,t,n){var r=XO(e),s=r&&!aS(e);return(n?r:r&&e!==nfe&&e!==rfe&&e!==sfe&&e!==ife&&e!==afe)&&e!==YO&&!(t===oT&&!s)||XO(t)&&!aS(t)&&e===YO||t===oT&&s}ie(JO,"isPlainSafe");function dfe(e){return Ab(e)&&e!==PL&&!aS(e)&&e!==kut&&e!==Aut&&e!==oT&&e!==nfe&&e!==rfe&&e!==sfe&&e!==ife&&e!==afe&&e!==YO&&e!==Sut&&e!==Cut&&e!==vut&&e!==Iut&&e!==Eut&&e!==Tut&&e!==_ut&&e!==xut&&e!==wut&&e!==Nut&&e!==Rut}ie(dfe,"isPlainSafeFirst");function ffe(e){return!aS(e)&&e!==oT}ie(ffe,"isPlainSafeLast");function my(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(my,"codePointAt");function OL(e){var t=/^\n* /;return t.test(e)}ie(OL,"needIndentIndicator");var hfe=1,QO=2,pfe=3,mfe=4,J0=5;function gfe(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,p=r!==-1,g=-1,y=dfe(my(e,0))&&ffe(my(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=my(e,l),!Ab(c))return J0;y=y&&JO(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=my(e,l),c===sS)d=!0,p&&(h=h||l-g-1>r&&e[g+1]!==" ",g=l);else if(!Ab(c))return J0;y=y&&JO(c,u,o),u=c}h=h||p&&l-g-1>r&&e[g+1]!==" "}return!d&&!h?y&&!a&&!s(e)?hfe:i===iS?J0:QO:n>9&&OL(e)?J0:a?i===iS?J0:QO:h?mfe:pfe}ie(gfe,"chooseScalarStyle");function yfe(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===iS?'""':"''";if(!e.noCompatMode&&(Mut.indexOf(t)!==-1||jut.test(t)))return e.quotingType===iS?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return ufe(e,c)}switch(ie(l,"testAmbiguity"),gfe(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case hfe:return t;case QO:return"'"+t.replace(/'/g,"''")+"'";case pfe:return"|"+eD(t,e.indent)+tD(ZO(t,i));case mfe:return">"+eD(t,e.indent)+tD(ZO(bfe(t,a),i));case J0:return'"'+vfe(t)+'"';default:throw new Qo("impossible error: invalid scalar style")}}()}ie(yfe,"writeScalar");function eD(e,t){var n=OL(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(eD,"blockHeader");function tD(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(tD,"dropEndingNewline");function bfe(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,nD(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+nD(l,t),s=i}return r}ie(bfe,"foldString");function nD(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(nD,"foldLine");function vfe(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=my(e,s),r=uo[n],!r&&Ab(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||lfe(n);return t}ie(vfe,"escapeString");function xfe(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(hd(e,t,o,!1,!1)||typeof o>"u"&&hd(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(xfe,"writeFlowSequence");function rD(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(hd(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&hd(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=lT(e,t)),e.dump&&sS===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(rD,"writeBlockSequence");function wfe(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),hd(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),hd(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(wfe,"writeFlowMapping");function Sfe(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Qo("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=lT(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),hd(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&sS===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=lT(e,t)),hd(e,t+1,u,!0,d)&&(e.dump&&sS===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie(Sfe,"writeBlockMapping");function sD(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,efe.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(tfe.call(o.represent,l))r=o.represent[l](t,l);else throw new Qo("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(sD,"detectType");function hd(e,t,n,r,s,i,a){e.tag=null,e.dump=n,sD(e,n,!1)||sD(e,n,!0);var o=efe.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(Sfe(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(wfe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?rD(e,t-1,e.dump,s):rD(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(xfe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&yfe(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Qo("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(hd,"writeNode");function _fe(e,t){var n=[],r=[],s,i;for(cT(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(_fe,"getDuplicateReferences");function cT(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)cT(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)cT(e[r[s]],t,n)}ie(cT,"inspectNode");function Out(e,t){t=t||{};var n=new cfe(t);n.noRefs||_fe(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),hd(n,0,r,!0,!0)?n.dump+`
`:""}ie(Out,"dump$1");function Dut(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(Dut,"renamed");var Fut=pde,Lut=mut.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var ec={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function lw(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=ei(e),t=ei(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(lw,"calculateDeltaAndAngle");var ei=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),$ut=ie(e=>({x:ie(function(t,n,r){let s=0;const i=ei(r[0]).x<ei(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(ec,e.arrowTypeStart)){const{angle:p,deltaX:g}=lw(r[0],r[1]);s=ec[e.arrowTypeStart]*Math.cos(p)*(g>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(ec,e.arrowTypeEnd)){const{angle:p,deltaX:g}=lw(r[r.length-1],r[r.length-2]);s=ec[e.arrowTypeEnd]*Math.cos(p)*(g>=0?1:-1)}const a=Math.abs(ei(t).x-ei(r[r.length-1]).x),o=Math.abs(ei(t).y-ei(r[r.length-1]).y),l=Math.abs(ei(t).x-ei(r[0]).x),c=Math.abs(ei(t).y-ei(r[0]).y),u=ec[e.arrowTypeStart],d=ec[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let p=d+h-a;p*=i==="right"?-1:1,s-=p}if(l<u&&l>0&&c<u){let p=u+h-l;p*=i==="right"?-1:1,s+=p}return ei(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=ei(r[0]).y<ei(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(ec,e.arrowTypeStart)){const{angle:p,deltaY:g}=lw(r[0],r[1]);s=ec[e.arrowTypeStart]*Math.abs(Math.sin(p))*(g>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(ec,e.arrowTypeEnd)){const{angle:p,deltaY:g}=lw(r[r.length-1],r[r.length-2]);s=ec[e.arrowTypeEnd]*Math.abs(Math.sin(p))*(g>=0?1:-1)}const a=Math.abs(ei(t).y-ei(r[r.length-1]).y),o=Math.abs(ei(t).x-ei(r[r.length-1]).x),l=Math.abs(ei(t).y-ei(r[0]).y),c=Math.abs(ei(t).x-ei(r[0]).x),u=ec[e.arrowTypeStart],d=ec[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let p=d+h-a;p*=i==="up"?-1:1,s-=p}if(l<u&&l>0&&c<u){let p=u+h-l;p*=i==="up"?-1:1,s+=p}return ei(t).y+s},"y")}),"getLineFunctionsWithOffset"),DL=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const But=Object.freeze({left:0,top:0,width:16,height:16}),uT=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Cfe=Object.freeze({...But,...uT}),zut=Object.freeze({...Cfe,body:"",hidden:!1}),Uut=Object.freeze({width:null,height:null}),qut=Object.freeze({...Uut,...uT}),Vut=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return hP(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return hP(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return hP(o,n)?o:null}return null},hP=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function Wut(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function OG(e,t){const n=Wut(e,t);for(const r in zut)r in uT?r in e&&!(r in n)&&(n[r]=uT[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function Hut(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function DG(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=OG(r[o]||s[o],i)}return a(t),n.forEach(a),OG(e,i)}function Gut(e,t){if(e.icons[t])return DG(e,t,[]);const n=Hut(e,[t])[t];return n?DG(e,t,n):null}const Kut=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Yut=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function FG(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(Kut);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=Yut.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function Zut(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function Xut(e,t){return e?"<defs>"+e+"</defs>"+t:t}function Jut(e,t,n){const r=Zut(e);return Xut(r.defs,t+r.content+n)}const Qut=e=>e==="unset"||e==="undefined"||e==="none";function edt(e,t){const n={...Cfe,...e},r={...qut,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(y=>{const v=[],x=y.hFlip,w=y.vFlip;let S=y.rotate;x?w?S+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let _;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:_=s.height/2+s.top,v.unshift("rotate(90 "+_.toString()+" "+_.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:_=s.width/2+s.left,v.unshift("rotate(-90 "+_.toString()+" "+_.toString()+")");break}S%2===1&&(s.left!==s.top&&(_=s.left,s.left=s.top,s.top=_),s.width!==s.height&&(_=s.width,s.width=s.height,s.height=_)),v.length&&(i=Jut(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=FG(d,l/c)):(u=a==="auto"?l:a,d=o===null?FG(u,c/l):o==="auto"?c:o);const h={},p=(y,v)=>{Qut(v)||(h[y]=v.toString())};p("width",u),p("height",d);const g=[s.left,s.top,l,c];return h.viewBox=g.join(" "),{attributes:h,viewBox:g,body:i}}const tdt=/\sid="(\S+)"/g,ndt="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let rdt=0;function sdt(e,t=ndt){const n=[];let r;for(;r=tdt.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(rdt++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function idt(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var adt={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},iD=new Map,kfe=new Map,odt=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(qt.debug("Registering icon pack:",t.name),"loader"in t)kfe.set(t.name,t.loader);else if("icons"in t)iD.set(t.name,t.icons);else throw qt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),ldt=ie(async(e,t)=>{const n=Vut(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=iD.get(r);if(!s){const a=kfe.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},iD.set(r,s)}catch(o){throw qt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=Gut(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),jN=ie(async(e,t)=>{let n;try{n=await ldt(e,t==null?void 0:t.fallbackPrefix)}catch(i){qt.error(i),n=adt}const r=edt(n,t);return idt(sdt(r.body),r.attributes)},"getIconSVG"),Lx={},ea={},LG;function cdt(){return LG||(LG=1,Object.defineProperty(ea,"__esModule",{value:!0}),ea.BLANK_URL=ea.relativeFirstCharacters=ea.whitespaceEscapeCharsRegex=ea.urlSchemeRegex=ea.ctrlCharactersRegex=ea.htmlCtrlEntityRegex=ea.htmlEntitiesRegex=ea.invalidProtocolRegex=void 0,ea.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,ea.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,ea.htmlCtrlEntityRegex=/&(newline|tab);/gi,ea.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,ea.urlSchemeRegex=/^.+(:|&colon;)/gim,ea.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,ea.relativeFirstCharacters=[".","/"],ea.BLANK_URL="about:blank"),ea}var $G;function udt(){if($G)return Lx;$G=1,Object.defineProperty(Lx,"__esModule",{value:!0}),Lx.sanitizeUrl=void 0;var e=cdt();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var p=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return p;if(h==="http:"||h==="https:"){if(!r(p))return e.BLANK_URL;var g=new URL(p);return g.protocol=g.protocol.toLowerCase(),g.hostname=g.hostname.toLowerCase(),g.toString()}return p}return Lx.sanitizeUrl=i,Lx}var ddt=udt();const aD=Math.PI,oD=2*aD,Em=1e-6,fdt=oD-Em;function Efe(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function hdt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Efe;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class pdt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Efe:hdt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Em)if(!(Math.abs(d*l-c*u)>Em)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-a,g=s-o,y=l*l+c*c,v=p*p+g*g,x=Math.sqrt(y),w=Math.sqrt(h),S=i*Math.tan((aD-Math.acos((y+h-v)/(2*x*w)))/2),_=S/w,k=S/x;Math.abs(_-1)>Em&&this._append`L${t+_*u},${n+_*d}`,this._append`A${i},${i},0,0,${+(d*p>u*g)},${this._x1=t+k*l},${this._y1=n+k*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Em||Math.abs(this._y1-u)>Em)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%oD+oD),h>fdt?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Em&&this._append`A${r},${r},0,${+(h>=aD)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function H0(e){return function(){return e}}const Dvt=Math.abs,Fvt=Math.atan2,Lvt=Math.cos,$vt=Math.max,Bvt=Math.min,zvt=Math.sin,Uvt=Math.sqrt,BG=1e-12,FL=Math.PI,zG=FL/2,qvt=2*FL;function Vvt(e){return e>1?0:e<-1?FL:Math.acos(e)}function Wvt(e){return e>=1?zG:e<=-1?-zG:Math.asin(e)}function mdt(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new pdt(t)}function gdt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Tfe(e){this._context=e}Tfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function dT(e){return new Tfe(e)}function ydt(e){return e[0]}function bdt(e){return e[1]}function vdt(e,t){var n=H0(!0),r=null,s=dT,i=null,a=mdt(o);e=typeof e=="function"?e:e===void 0?ydt:H0(e),t=typeof t=="function"?t:t===void 0?bdt:H0(t);function o(l){var c,u=(l=gdt(l)).length,d,h=!1,p;for(r==null&&(i=s(p=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(p)return i=null,p+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:H0(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:H0(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:H0(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class Afe{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Nfe(e){return new Afe(e,!0)}function Rfe(e){return new Afe(e,!1)}function bp(){}function fT(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function PN(e){this._context=e}PN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:fT(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:fT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function fk(e){return new PN(e)}function Ife(e){this._context=e}Ife.prototype={areaStart:bp,areaEnd:bp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:fT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function xdt(e){return new Ife(e)}function Mfe(e){this._context=e}Mfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:fT(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wdt(e){return new Mfe(e)}function jfe(e,t){this._basis=new PN(e),this._beta=t}jfe.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Sdt=function e(t){function n(r){return t===1?new PN(r):new jfe(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function hT(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function LL(e,t){this._context=e,this._k=(1-t)/6}LL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:hT(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:hT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Pfe=function e(t){function n(r){return new LL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function $L(e,t){this._context=e,this._k=(1-t)/6}$L.prototype={areaStart:bp,areaEnd:bp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:hT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const _dt=function e(t){function n(r){return new $L(r,t)}return n.tension=function(r){return e(+r)},n}(0);function BL(e,t){this._context=e,this._k=(1-t)/6}BL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:hT(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Cdt=function e(t){function n(r){return new BL(r,t)}return n.tension=function(r){return e(+r)},n}(0);function zL(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>BG){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>BG){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function Ofe(e,t){this._context=e,this._alpha=t}Ofe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:zL(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Dfe=function e(t){function n(r){return t?new Ofe(r,t):new LL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Ffe(e,t){this._context=e,this._alpha=t}Ffe.prototype={areaStart:bp,areaEnd:bp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:zL(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const kdt=function e(t){function n(r){return t?new Ffe(r,t):new $L(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Lfe(e,t){this._context=e,this._alpha=t}Lfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zL(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Edt=function e(t){function n(r){return t?new Lfe(r,t):new BL(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function $fe(e){this._context=e}$fe.prototype={areaStart:bp,areaEnd:bp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Tdt(e){return new $fe(e)}function UG(e){return e<0?-1:1}function qG(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(UG(i)+UG(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function VG(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function pP(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function pT(e){this._context=e}pT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:pP(this,this._t0,VG(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,pP(this,VG(this,n=qG(this,e,t)),n);break;default:pP(this,this._t0,n=qG(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Bfe(e){this._context=new zfe(e)}(Bfe.prototype=Object.create(pT.prototype)).point=function(e,t){pT.prototype.point.call(this,t,e)};function zfe(e){this._context=e}zfe.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function Ufe(e){return new pT(e)}function qfe(e){return new Bfe(e)}function Vfe(e){this._context=e}Vfe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=WG(e),s=WG(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function WG(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function Wfe(e){return new Vfe(e)}function ON(e,t){this._context=e,this._t=t}ON.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Hfe(e){return new ON(e,.5)}function Gfe(e){return new ON(e,0)}function Kfe(e){return new ON(e,1)}var Yfe=typeof ry=="object"&&ry&&ry.Object===Object&&ry,Adt=typeof self=="object"&&self&&self.Object===Object&&self,Cd=Yfe||Adt||Function("return this")(),mT=Cd.Symbol,Zfe=Object.prototype,Ndt=Zfe.hasOwnProperty,Rdt=Zfe.toString,$x=mT?mT.toStringTag:void 0;function Idt(e){var t=Ndt.call(e,$x),n=e[$x];try{e[$x]=void 0;var r=!0}catch{}var s=Rdt.call(e);return r&&(t?e[$x]=n:delete e[$x]),s}var Mdt=Object.prototype,jdt=Mdt.toString;function Pdt(e){return jdt.call(e)}var Odt="[object Null]",Ddt="[object Undefined]",HG=mT?mT.toStringTag:void 0;function hv(e){return e==null?e===void 0?Ddt:Odt:HG&&HG in Object(e)?Idt(e):Pdt(e)}function Bg(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Fdt="[object AsyncFunction]",Ldt="[object Function]",$dt="[object GeneratorFunction]",Bdt="[object Proxy]";function UL(e){if(!Bg(e))return!1;var t=hv(e);return t==Ldt||t==$dt||t==Fdt||t==Bdt}var mP=Cd["__core-js_shared__"],GG=function(){var e=/[^.]+$/.exec(mP&&mP.keys&&mP.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function zdt(e){return!!GG&&GG in e}var Udt=Function.prototype,qdt=Udt.toString;function zg(e){if(e!=null){try{return qdt.call(e)}catch{}try{return e+""}catch{}}return""}var Vdt=/[\\^$.*+?()[\]{}|]/g,Wdt=/^\[object .+?Constructor\]$/,Hdt=Function.prototype,Gdt=Object.prototype,Kdt=Hdt.toString,Ydt=Gdt.hasOwnProperty,Zdt=RegExp("^"+Kdt.call(Ydt).replace(Vdt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Xdt(e){if(!Bg(e)||zdt(e))return!1;var t=UL(e)?Zdt:Wdt;return t.test(zg(e))}function Jdt(e,t){return e==null?void 0:e[t]}function Ug(e,t){var n=Jdt(e,t);return Xdt(n)?n:void 0}var oS=Ug(Object,"create");function Qdt(){this.__data__=oS?oS(null):{},this.size=0}function eft(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var tft="__lodash_hash_undefined__",nft=Object.prototype,rft=nft.hasOwnProperty;function sft(e){var t=this.__data__;if(oS){var n=t[e];return n===tft?void 0:n}return rft.call(t,e)?t[e]:void 0}var ift=Object.prototype,aft=ift.hasOwnProperty;function oft(e){var t=this.__data__;return oS?t[e]!==void 0:aft.call(t,e)}var lft="__lodash_hash_undefined__";function cft(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=oS&&t===void 0?lft:t,this}function bg(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}bg.prototype.clear=Qdt;bg.prototype.delete=eft;bg.prototype.get=sft;bg.prototype.has=oft;bg.prototype.set=cft;function uft(){this.__data__=[],this.size=0}function DN(e,t){return e===t||e!==e&&t!==t}function FN(e,t){for(var n=e.length;n--;)if(DN(e[n][0],t))return n;return-1}var dft=Array.prototype,fft=dft.splice;function hft(e){var t=this.__data__,n=FN(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():fft.call(t,n,1),--this.size,!0}function pft(e){var t=this.__data__,n=FN(t,e);return n<0?void 0:t[n][1]}function mft(e){return FN(this.__data__,e)>-1}function gft(e,t){var n=this.__data__,r=FN(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function Vf(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Vf.prototype.clear=uft;Vf.prototype.delete=hft;Vf.prototype.get=pft;Vf.prototype.has=mft;Vf.prototype.set=gft;var lS=Ug(Cd,"Map");function yft(){this.size=0,this.__data__={hash:new bg,map:new(lS||Vf),string:new bg}}function bft(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function LN(e,t){var n=e.__data__;return bft(t)?n[typeof t=="string"?"string":"hash"]:n.map}function vft(e){var t=LN(this,e).delete(e);return this.size-=t?1:0,t}function xft(e){return LN(this,e).get(e)}function wft(e){return LN(this,e).has(e)}function Sft(e,t){var n=LN(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function zp(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}zp.prototype.clear=yft;zp.prototype.delete=vft;zp.prototype.get=xft;zp.prototype.has=wft;zp.prototype.set=Sft;var _ft="Expected a function";function b_(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(_ft);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(b_.Cache||zp),n}b_.Cache=zp;function Cft(){this.__data__=new Vf,this.size=0}function kft(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Eft(e){return this.__data__.get(e)}function Tft(e){return this.__data__.has(e)}var Aft=200;function Nft(e,t){var n=this.__data__;if(n instanceof Vf){var r=n.__data__;if(!lS||r.length<Aft-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new zp(r)}return n.set(e,t),this.size=n.size,this}function pv(e){var t=this.__data__=new Vf(e);this.size=t.size}pv.prototype.clear=Cft;pv.prototype.delete=kft;pv.prototype.get=Eft;pv.prototype.has=Tft;pv.prototype.set=Nft;var gT=function(){try{var e=Ug(Object,"defineProperty");return e({},"",{}),e}catch{}}();function qL(e,t,n){t=="__proto__"&&gT?gT(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function lD(e,t,n){(n!==void 0&&!DN(e[t],n)||n===void 0&&!(t in e))&&qL(e,t,n)}function Rft(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var Ift=Rft(),Xfe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,KG=Xfe&&typeof module=="object"&&module&&!module.nodeType&&module,Mft=KG&&KG.exports===Xfe,YG=Mft?Cd.Buffer:void 0,ZG=YG?YG.allocUnsafe:void 0;function jft(e,t){if(t)return e.slice();var n=e.length,r=ZG?ZG(n):new e.constructor(n);return e.copy(r),r}var XG=Cd.Uint8Array;function Pft(e){var t=new e.constructor(e.byteLength);return new XG(t).set(new XG(e)),t}function Oft(e,t){var n=t?Pft(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Dft(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var JG=Object.create,Fft=function(){function e(){}return function(t){if(!Bg(t))return{};if(JG)return JG(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Jfe(e,t){return function(n){return e(t(n))}}var Qfe=Jfe(Object.getPrototypeOf,Object),Lft=Object.prototype;function $N(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Lft;return e===n}function $ft(e){return typeof e.constructor=="function"&&!$N(e)?Fft(Qfe(e)):{}}function v_(e){return e!=null&&typeof e=="object"}var Bft="[object Arguments]";function QG(e){return v_(e)&&hv(e)==Bft}var ehe=Object.prototype,zft=ehe.hasOwnProperty,Uft=ehe.propertyIsEnumerable,yT=QG(function(){return arguments}())?QG:function(e){return v_(e)&&zft.call(e,"callee")&&!Uft.call(e,"callee")},bT=Array.isArray,qft=9007199254740991;function the(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=qft}function BN(e){return e!=null&&the(e.length)&&!UL(e)}function Vft(e){return v_(e)&&BN(e)}function Wft(){return!1}var nhe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eK=nhe&&typeof module=="object"&&module&&!module.nodeType&&module,Hft=eK&&eK.exports===nhe,tK=Hft?Cd.Buffer:void 0,Gft=tK?tK.isBuffer:void 0,VL=Gft||Wft,Kft="[object Object]",Yft=Function.prototype,Zft=Object.prototype,rhe=Yft.toString,Xft=Zft.hasOwnProperty,Jft=rhe.call(Object);function Qft(e){if(!v_(e)||hv(e)!=Kft)return!1;var t=Qfe(e);if(t===null)return!0;var n=Xft.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&rhe.call(n)==Jft}var eht="[object Arguments]",tht="[object Array]",nht="[object Boolean]",rht="[object Date]",sht="[object Error]",iht="[object Function]",aht="[object Map]",oht="[object Number]",lht="[object Object]",cht="[object RegExp]",uht="[object Set]",dht="[object String]",fht="[object WeakMap]",hht="[object ArrayBuffer]",pht="[object DataView]",mht="[object Float32Array]",ght="[object Float64Array]",yht="[object Int8Array]",bht="[object Int16Array]",vht="[object Int32Array]",xht="[object Uint8Array]",wht="[object Uint8ClampedArray]",Sht="[object Uint16Array]",_ht="[object Uint32Array]",Ws={};Ws[mht]=Ws[ght]=Ws[yht]=Ws[bht]=Ws[vht]=Ws[xht]=Ws[wht]=Ws[Sht]=Ws[_ht]=!0;Ws[eht]=Ws[tht]=Ws[hht]=Ws[nht]=Ws[pht]=Ws[rht]=Ws[sht]=Ws[iht]=Ws[aht]=Ws[oht]=Ws[lht]=Ws[cht]=Ws[uht]=Ws[dht]=Ws[fht]=!1;function Cht(e){return v_(e)&&the(e.length)&&!!Ws[hv(e)]}function kht(e){return function(t){return e(t)}}var she=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jw=she&&typeof module=="object"&&module&&!module.nodeType&&module,Eht=jw&&jw.exports===she,gP=Eht&&Yfe.process,nK=function(){try{var e=jw&&jw.require&&jw.require("util").types;return e||gP&&gP.binding&&gP.binding("util")}catch{}}(),rK=nK&&nK.isTypedArray,WL=rK?kht(rK):Cht;function cD(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Tht=Object.prototype,Aht=Tht.hasOwnProperty;function Nht(e,t,n){var r=e[t];(!(Aht.call(e,t)&&DN(r,n))||n===void 0&&!(t in e))&&qL(e,t,n)}function Rht(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?qL(n,o,l):Nht(n,o,l)}return n}function Iht(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Mht=9007199254740991,jht=/^(?:0|[1-9]\d*)$/;function ihe(e,t){var n=typeof e;return t=t??Mht,!!t&&(n=="number"||n!="symbol"&&jht.test(e))&&e>-1&&e%1==0&&e<t}var Pht=Object.prototype,Oht=Pht.hasOwnProperty;function Dht(e,t){var n=bT(e),r=!n&&yT(e),s=!n&&!r&&VL(e),i=!n&&!r&&!s&&WL(e),a=n||r||s||i,o=a?Iht(e.length,String):[],l=o.length;for(var c in e)(t||Oht.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||ihe(c,l)))&&o.push(c);return o}function Fht(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Lht=Object.prototype,$ht=Lht.hasOwnProperty;function Bht(e){if(!Bg(e))return Fht(e);var t=$N(e),n=[];for(var r in e)r=="constructor"&&(t||!$ht.call(e,r))||n.push(r);return n}function ahe(e){return BN(e)?Dht(e,!0):Bht(e)}function zht(e){return Rht(e,ahe(e))}function Uht(e,t,n,r,s,i,a){var o=cD(e,n),l=cD(t,n),c=a.get(l);if(c){lD(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=bT(l),p=!h&&VL(l),g=!h&&!p&&WL(l);u=l,h||p||g?bT(o)?u=o:Vft(o)?u=Dft(o):p?(d=!1,u=jft(l,!0)):g?(d=!1,u=Oft(l,!0)):u=[]:Qft(l)||yT(l)?(u=o,yT(o)?u=zht(o):(!Bg(o)||UL(o))&&(u=$ft(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),lD(e,n,u)}function ohe(e,t,n,r,s){e!==t&&Ift(t,function(i,a){if(s||(s=new pv),Bg(i))Uht(e,t,a,n,ohe,r,s);else{var o=r?r(cD(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),lD(e,a,o)}},ahe)}function lhe(e){return e}function qht(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var sK=Math.max;function Vht(e,t,n){return t=sK(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=sK(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),qht(e,this,o)}}function Wht(e){return function(){return e}}var Hht=gT?function(e,t){return gT(e,"toString",{configurable:!0,enumerable:!1,value:Wht(t),writable:!0})}:lhe,Ght=800,Kht=16,Yht=Date.now;function Zht(e){var t=0,n=0;return function(){var r=Yht(),s=Kht-(r-n);if(n=r,s>0){if(++t>=Ght)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Xht=Zht(Hht);function Jht(e,t){return Xht(Vht(e,t,lhe),e+"")}function Qht(e,t,n){if(!Bg(n))return!1;var r=typeof t;return(r=="number"?BN(n)&&ihe(t,n.length):r=="string"&&t in n)?DN(n[t],e):!1}function ept(e){return Jht(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&Qht(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var tpt=ept(function(e,t,n){ohe(e,t,n)}),npt="",rpt={curveBasis:fk,curveBasisClosed:xdt,curveBasisOpen:wdt,curveBumpX:Nfe,curveBumpY:Rfe,curveBundle:Sdt,curveCardinalClosed:_dt,curveCardinalOpen:Cdt,curveCardinal:Pfe,curveCatmullRomClosed:kdt,curveCatmullRomOpen:Edt,curveCatmullRom:Dfe,curveLinear:dT,curveLinearClosed:Tdt,curveMonotoneX:Ufe,curveMonotoneY:qfe,curveNatural:Wfe,curveStep:Hfe,curveStepAfter:Kfe,curveStepBefore:Gfe},spt=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,ipt=ie(function(e,t){const n=che(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);eT(a),r=La(r,[...a])}else r=n.args;if(!r)return;let s=SL(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),che=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${spt.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),qt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=Iw.exec(e))!==null;)if(i.index===Iw.lastIndex&&Iw.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return qt.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),apt=ie(function(e){return e.replace(Iw,"")},"removeDirectives"),opt=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function HL(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return rpt[n]??t}ie(HL,"interpolateToCurve");function uhe(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?ddt.sanitizeUrl(n):n}ie(uhe,"formatUrl");var lpt=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){qt.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function GL(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(GL,"distance");function dhe(e){let t,n=0;e.forEach(s=>{n+=GL(s,t),t=s});const r=n/2;return KL(e,r)}ie(dhe,"traverseEdge");function fhe(e){return e.length===1?e[0]:dhe(e)}ie(fhe,"calcLabelPosition");var iK=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),KL=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=GL(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:iK((1-a)*n.x+a*s.x,5),y:iK((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),cpt=ie((e,t,n)=>{qt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=KL(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function hhe(e,t,n){const r=structuredClone(n);qt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=KL(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(hhe,"calcTerminalLabelPosition");function phe(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(phe,"getStylesFromArray");var aK=0,upt=ie(()=>(aK++,"id-"+Math.random().toString(36).substr(2,12)+"-"+aK),"generateId");function mhe(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(mhe,"makeRandomHex");var dpt=ie(e=>mhe(e.length),"random"),fpt=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),hpt=ie(function(e,t){const n=t.text.replace(fv.lineBreakRegex," "),[,r]=zN(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),ppt=b_((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),fv.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=jf(`${a} `,n),c=jf(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:p}=mpt(a,t,"-",n);s.push(i,...h),i=p}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),mpt=b_((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(jf(c,r)>=t){const d=l+1,h=s.length===d,p=`${c}${n}`;i.push(h?c:p),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function ghe(e,t){return YL(e,t).height}ie(ghe,"calculateTextHeight");function jf(e,t){return YL(e,t).width}ie(jf,"calculateTextWidth");var YL=b_((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=zN(n),a=["sans-serif",r],o=e.split(fv.lineBreakRegex),l=[],c=mr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let p=0;const g={width:0,height:0,lineHeight:0};for(const y of o){const v=fpt();v.text=y||npt;const x=hpt(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");g.width=Math.round(Math.max(g.width,w.width)),p=Math.round(w.height),g.height+=p,g.lineHeight=Math.round(Math.max(g.lineHeight,p))}l.push(g)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),Fy,gpt=(Fy=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(Fy,"InitIDGenerator"),Fy),j2,ypt=ie(function(e){return j2=j2||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),j2.innerHTML=e,unescape(j2.textContent)},"entityDecode");function ZL(e){return"str"in e}ie(ZL,"isDetailedError");var bpt=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),zN=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function XL(e,t){return tpt({},e,t)}ie(XL,"cleanAndMerge");var qu={assignWithDepth:La,wrapLabel:ppt,calculateTextHeight:ghe,calculateTextWidth:jf,calculateTextDimensions:YL,cleanAndMerge:XL,detectInit:ipt,detectDirective:che,isSubstringInArray:opt,interpolateToCurve:HL,calcLabelPosition:fhe,calcCardinalityPosition:cpt,calcTerminalLabelPosition:hhe,formatUrl:uhe,getStylesFromArray:phe,generateId:upt,random:dpt,runFunc:lpt,entityDecode:ypt,insertTitle:bpt,parseFontSize:zN,InitIDGenerator:gpt},vpt=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?""+r+"":""+r+""}),t},"encodeEntities"),qg=ie(function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),Hvt=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function To(e){return e??null}ie(To,"handleUndefinedAttr");function JL(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Vg=JL();function yhe(e){Vg=e}var Pw={exec:()=>null};function ws(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(Co.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var Co={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},xpt=/^(?:[ \t]*(?:\n|$))+/,wpt=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Spt=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,x_=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,_pt=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,QL=/(?:[*+-]|\d{1,9}[.)])/,bhe=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,vhe=ws(bhe).replace(/bull/g,QL).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Cpt=ws(bhe).replace(/bull/g,QL).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),e8=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,kpt=/^[^\n]+/,t8=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Ept=ws(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",t8).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Tpt=ws(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,QL).getRegex(),UN="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",n8=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Apt=ws("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",n8).replace("tag",UN).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),xhe=ws(e8).replace("hr",x_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",UN).getRegex(),Npt=ws(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",xhe).getRegex(),r8={blockquote:Npt,code:wpt,def:Ept,fences:Spt,heading:_pt,hr:x_,html:Apt,lheading:vhe,list:Tpt,newline:xpt,paragraph:xhe,table:Pw,text:kpt},oK=ws("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",x_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",UN).getRegex(),Rpt={...r8,lheading:Cpt,table:oK,paragraph:ws(e8).replace("hr",x_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",oK).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",UN).getRegex()},Ipt={...r8,html:ws(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",n8).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Pw,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ws(e8).replace("hr",x_).replace("heading",` *#{1,6} *[^
]`).replace("lheading",vhe).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Mpt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,jpt=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,whe=/^( {2,}|\\)\n(?!\s*$)/,Ppt=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,qN=/[\p{P}\p{S}]/u,s8=/[\s\p{P}\p{S}]/u,She=/[^\s\p{P}\p{S}]/u,Opt=ws(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,s8).getRegex(),_he=/(?!~)[\p{P}\p{S}]/u,Dpt=/(?!~)[\s\p{P}\p{S}]/u,Fpt=/(?:[^\s\p{P}\p{S}]|~)/u,Lpt=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,Che=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,$pt=ws(Che,"u").replace(/punct/g,qN).getRegex(),Bpt=ws(Che,"u").replace(/punct/g,_he).getRegex(),khe="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",zpt=ws(khe,"gu").replace(/notPunctSpace/g,She).replace(/punctSpace/g,s8).replace(/punct/g,qN).getRegex(),Upt=ws(khe,"gu").replace(/notPunctSpace/g,Fpt).replace(/punctSpace/g,Dpt).replace(/punct/g,_he).getRegex(),qpt=ws("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,She).replace(/punctSpace/g,s8).replace(/punct/g,qN).getRegex(),Vpt=ws(/\\(punct)/,"gu").replace(/punct/g,qN).getRegex(),Wpt=ws(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Hpt=ws(n8).replace("(?:-->|$)","-->").getRegex(),Gpt=ws("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Hpt).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),vT=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Kpt=ws(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",vT).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Ehe=ws(/^!?\[(label)\]\[(ref)\]/).replace("label",vT).replace("ref",t8).getRegex(),The=ws(/^!?\[(ref)\](?:\[\])?/).replace("ref",t8).getRegex(),Ypt=ws("reflink|nolink(?!\\()","g").replace("reflink",Ehe).replace("nolink",The).getRegex(),i8={_backpedal:Pw,anyPunctuation:Vpt,autolink:Wpt,blockSkip:Lpt,br:whe,code:jpt,del:Pw,emStrongLDelim:$pt,emStrongRDelimAst:zpt,emStrongRDelimUnd:qpt,escape:Mpt,link:Kpt,nolink:The,punctuation:Opt,reflink:Ehe,reflinkSearch:Ypt,tag:Gpt,text:Ppt,url:Pw},Zpt={...i8,link:ws(/^!?\[(label)\]\((.*?)\)/).replace("label",vT).getRegex(),reflink:ws(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",vT).getRegex()},uD={...i8,emStrongRDelimAst:Upt,emStrongLDelim:Bpt,url:ws(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Xpt={...uD,br:ws(whe).replace("{2,}","*").getRegex(),text:ws(uD.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},P2={normal:r8,gfm:Rpt,pedantic:Ipt},Bx={normal:i8,gfm:uD,breaks:Xpt,pedantic:Zpt},Jpt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},lK=e=>Jpt[e];function Ru(e,t){if(t){if(Co.escapeTest.test(e))return e.replace(Co.escapeReplace,lK)}else if(Co.escapeTestNoEncode.test(e))return e.replace(Co.escapeReplaceNoEncode,lK);return e}function cK(e){try{e=encodeURI(e).replace(Co.percentDecode,"%")}catch{return null}return e}function uK(e,t){var i;const n=e.replace(Co.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(Co.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(Co.slashPipe,"|");return r}function zx(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function Qpt(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function dK(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function emt(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var xT=class{constructor(e){ue(this,"options");ue(this,"rules");ue(this,"lexer");this.options=e||Vg}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:zx(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=emt(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=zx(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:zx(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=zx(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const p=h,g=p.raw+`
`+n.join(`
`),y=this.blockquote(g);i[i.length-1]=y,r=r.substring(0,r.length-p.raw.length)+y.raw,s=s.substring(0,s.length-p.text.length)+y.text;break}else if((h==null?void 0:h.type)==="list"){const p=h,g=p.raw+`
`+n.join(`
`),y=this.list(g);i[i.length-1]=y,r=r.substring(0,r.length-h.raw.length)+y.raw,s=s.substring(0,s.length-p.raw.length)+y.raw,n=g.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],p=!d.trim(),g=0;if(this.options.pedantic?(g=2,u=d.trimStart()):p?g=t[1].length+1:(g=t[2].search(this.rules.other.nonSpaceChar),g=g>4?1:g,u=d.slice(g),g+=t[1].length),p&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(g),w=this.rules.other.hrRegex(g),S=this.rules.other.fencesBeginRegex(g),_=this.rules.other.headingBeginRegex(g),k=this.rules.other.htmlBeginRegex(g);for(;e;){const T=e.split(`
`,1)[0];let A;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),A=h):A=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||_.test(h)||k.test(h)||x.test(h)||w.test(h))break;if(A.search(this.rules.other.nonSpaceChar)>=g||!h.trim())u+=`
`+A.slice(g);else{if(p||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||_.test(d)||w.test(d))break;u+=`
`+h}!p&&!h.trim()&&(p=!0),c+=T+`
`,e=e.substring(T.length+1),d=A.slice(g)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let y=null,v;this.options.gfm&&(y=this.rules.other.listIsTask.exec(u),y&&(v=y[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!y,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=uK(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push(uK(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=zx(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=Qpt(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),dK(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return dK(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const g=h.slice(1,-1);return{type:"em",raw:h,text:g,tokens:this.lexer.inlineTokens(g)}}const p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},ff=class dD{constructor(t){ue(this,"tokens");ue(this,"options");ue(this,"state");ue(this,"tokenizer");ue(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Vg,this.options.tokenizer=this.options.tokenizer||new xT,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:Co,block:P2.normal,inline:Bx.normal};this.options.pedantic?(n.block=P2.pedantic,n.inline=Bx.pedantic):this.options.gfm&&(n.block=P2.gfm,this.options.breaks?n.inline=Bx.breaks:n.inline=Bx.gfm),this.tokenizer.rules=n}static get rules(){return{block:P2,inline:Bx}}static lex(t,n){return new dD(n).lex(t)}static lexInline(t,n){return new dD(n).inlineTokens(t)}lex(t){t=t.replace(Co.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(Co.tabCharGlobal,"    ").replace(Co.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const p=t.slice(1);let g;this.options.extensions.startInline.forEach(y=>{g=y.call({lexer:this},p),typeof g=="number"&&g>=0&&(h=Math.min(h,g))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},wT=class{constructor(e){ue(this,"options");ue(this,"parser");this.options=e||Vg}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(Co.notSpaceStart))==null?void 0:i[0],s=e.replace(Co.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Ru(r)+'">'+(n?s:Ru(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Ru(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+Ru(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Ru(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=cK(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+Ru(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=cK(e);if(s===null)return Ru(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${Ru(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Ru(e.text)}},a8=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},hf=class fD{constructor(t){ue(this,"options");ue(this,"renderer");ue(this,"textRenderer");this.options=t||Vg,this.options.renderer=this.options.renderer||new wT,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new a8}static parse(t,n){return new fD(n).parse(t)}static parseInline(t,n){return new fD(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},kP,hk=(kP=class{constructor(e){ue(this,"options");ue(this,"block");this.options=e||Vg}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?ff.lex:ff.lexInline}provideParser(){return this.block?hf.parse:hf.parseInline}},ue(kP,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),kP),tmt=class{constructor(...e){ue(this,"defaults",JL());ue(this,"options",this.setOptions);ue(this,"parse",this.parseMarkdown(!0));ue(this,"parseInline",this.parseMarkdown(!1));ue(this,"Parser",hf);ue(this,"Renderer",wT);ue(this,"TextRenderer",a8);ue(this,"Lexer",ff);ue(this,"Tokenizer",xT);ue(this,"Hooks",hk);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new wT(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new xT(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new hk;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];hk.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ff.lex(e,t??this.defaults)}parser(e,t){return hf.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?ff.lex:ff.lexInline,l=i.hooks?i.hooks.provideParser():e?hf.parse:hf.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Ru(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},vg=new tmt;function ys(e,t){return vg.parse(e,t)}ys.options=ys.setOptions=function(e){return vg.setOptions(e),ys.defaults=vg.defaults,yhe(ys.defaults),ys};ys.getDefaults=JL;ys.defaults=Vg;ys.use=function(...e){return vg.use(...e),ys.defaults=vg.defaults,yhe(ys.defaults),ys};ys.walkTokens=function(e,t){return vg.walkTokens(e,t)};ys.parseInline=vg.parseInline;ys.Parser=hf;ys.parser=hf.parse;ys.Renderer=wT;ys.TextRenderer=a8;ys.Lexer=ff;ys.lexer=ff.lex;ys.Tokenizer=xT;ys.Hooks=hk;ys.parse=ys;ys.options;ys.setOptions;ys.use;ys.walkTokens;ys.parseInline;hf.parse;ff.lex;function Ahe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,p){return p===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function Nhe(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=Ahe(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(Nhe,"preprocessMarkdown");function Rhe(e,t={}){const n=Nhe(e,t),r=ys.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(Rhe,"markdownToLines");function Ihe(e,{markdownAutoWrap:t}={}){const n=ys.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie(Ihe,"markdownToHTML");function Mhe(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(Mhe,"splitTextToChars");function jhe(e,t){const n=Mhe(t.content);return o8(e,[],n,t.type)}ie(jhe,"splitWordToFitWidth");function o8(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?o8(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(o8,"splitWordToFitWidthRecursion");function Phe(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return ST(e,t)}ie(Phe,"splitLineToFitWidth");function ST(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return ST(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=jhe(t,i);n.push([o]),l.content&&e.unshift(l)}return ST(e,t,n)}ie(ST,"splitLineToFitWidthRecursion");function hD(e,t){t&&e.attr("style",t)}ie(hD,"applyStyle");async function Ohe(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&Eb(t.label)&&(o=await _L(t.label.replace(fv.lineBreakRegex,`
`),fs()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),hD(c,t.labelStyle),c.attr("class",`${l} ${r}`),hD(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(Ohe,"addHtmlSpan");function VN(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(VN,"createTspan");function Dhe(e,t,n){const r=e.append("text"),s=VN(r,1,t);WN(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(Dhe,"computeWidthOfText");function nmt(e,t,n){var a;const r=e.append("text"),s=VN(r,1,t);WN(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(nmt,"computeDimensionOfText");function Fhe(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>Dhe(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:Phe(c,u);for(const h of d){const p=VN(o,l,1.1);WN(p,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(Fhe,"createFormattedText");function WN(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(WN,"updateTextContentAndStyles");function Lhe(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(Lhe,"replaceIconSubstring");var Up=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(qt.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=Ihe(t,c),d=Lhe(qg(u)),h=t.replace(/\\\\/g,"\\"),p={isNode:a,label:Eb(t)?h:d,labelStyle:n.replace("fill:","color:")};return await Ohe(e,p,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=Rhe(u.replace("<br>","<br/>"),c),h=Fhe(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const p=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");mr(h).attr("style",p)}else{const p=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");mr(h).select("rect").attr("style",p.replace(/background:/g,"fill:"));const g=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");mr(h).select("text").attr("style",g)}return h}},"createText");function yP(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function rmt(e,t){return e[0]===t[0]&&e[1]===t[1]}function smt(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)yP(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const S=[...w];rmt(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const p=[];u=Math.max(u,.1);const g=[];for(const w of h)for(let S=0;S<w.length-1;S++){const _=w[S],k=w[S+1];if(_[1]!==k[1]){const T=Math.min(_[1],k[1]);g.push({ymin:T,ymax:Math.max(_[1],k[1]),x:T===_[1]?_[0]:k[0],islope:(k[0]-_[0])/(k[1]-_[1])})}}if(g.sort((w,S)=>w.ymin<S.ymin?-1:w.ymin>S.ymin?1:w.x<S.x?-1:w.x>S.x?1:w.ymax===S.ymax?0:(w.ymax-S.ymax)/Math.abs(w.ymax-S.ymax)),!g.length)return p;let y=[],v=g[0].ymin,x=0;for(;y.length||g.length;){if(g.length){let w=-1;for(let S=0;S<g.length&&!(g[S].ymin>v);S++)w=S;g.splice(0,w+1).forEach(S=>{y.push({s:v,edge:S})})}if(y=y.filter(w=>!(w.edge.ymax<=v)),y.sort((w,S)=>w.edge.x===S.edge.x?0:(w.edge.x-S.edge.x)/Math.abs(w.edge.x-S.edge.x)),(d!==1||x%u==0)&&y.length>1)for(let w=0;w<y.length;w+=2){const S=w+1;if(S>=y.length)break;const _=y[w].edge,k=y[S].edge;p.push([[Math.round(_.x),v],[Math.round(k.x),v]])}v+=d,y.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return p}(a,i,r);if(s){for(const c of a)yP(c,o,-s);(function(c,u,d){const h=[];c.forEach(p=>h.push(...p)),yP(h,u,d)})(l,o,-s)}return l}function w_(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),smt(e,s,r,i||1)}class l8{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=w_(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function HN(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class imt extends l8{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=w_(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)HN([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class amt extends l8{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class omt{constructor(t){this.helper=t}fillPolygons(t,n){const r=w_(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=HN(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,p=Math.min(o[0][1],o[1][1]);for(let g=0;g<u;g++){const y=p+d+g*s,v=h-a+2*Math.random()*a,x=y-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class lmt{constructor(t){this.helper=t}fillPolygons(t,n){const r=w_(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=HN(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let p=0;p<l;p++){const g=p*(r+s),y=g+r,v=[u[0]+g*Math.cos(h)+c*Math.cos(h),u[1]+g*Math.sin(h)+c*Math.sin(h)],x=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class cmt{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=w_(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=HN(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,p=2*(d+1)*n,g=Math.sqrt(2*Math.pow(n,2)),y=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+p*Math.cos(u),l[1]+p*Math.sin(u)],x=[y[0]+g*Math.cos(u+Math.PI/4),y[1]+g*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(y[0],y[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const Go={};class umt{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const dmt=0,bP=1,fK=2,O2={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function vP(e,t){return e.type===t}function c8(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:dmt,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:bP,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:fK,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!vP(i,fK);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return c8("M0,0"+e);s++,a=O2[i.text],r=i.text}else vP(i,bP)?a=O2[r]:(s++,a=O2[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!vP(c,bP))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof O2[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function $he(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function Bhe(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let p=0,g=0;n==="Q"||n==="T"?(p=r+(r-o),g=s+(s-l)):(p=r,g=s);const y=r+2*(p-r)/3,v=s+2*(g-s)/3,x=d+2*(p-d)/3,w=h+2*(g-h)/3;t.push({key:"C",data:[y,v,x,w,d,h]}),o=p,l=g,r=d,s=h;break}case"Q":{const[d,h,p,g]=u,y=r+2*(d-r)/3,v=s+2*(h-s)/3,x=p+2*(d-p)/3,w=g+2*(h-g)/3;t.push({key:"C",data:[y,v,x,w,p,g]}),o=d,l=h,r=p,s=g;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),p=u[2],g=u[3],y=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(zhe(r,s,v,x,d,h,p,g,y).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function Ux(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function zhe(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],p=0,g=0,y=0,v=0;if(c)[p,g,y,v]=c;else{[e,t]=Ux(e,t,-u),[n,r]=Ux(n,r,-u);const q=(e-n)/2,I=(t-r)/2;let V=q*q/(s*s)+I*I/(i*i);V>1&&(V=Math.sqrt(V),s*=V,i*=V);const D=s*s,z=i*i,$=D*z-D*I*I-z*q*q,Y=D*I*I+z*q*q,B=(o===l?-1:1)*Math.sqrt(Math.abs($/Y));y=B*s*I/i+(e+n)/2,v=B*-i*q/s+(t+r)/2,p=Math.asin(parseFloat(((t-v)/i).toFixed(9))),g=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<y&&(p=Math.PI-p),n<y&&(g=Math.PI-g),p<0&&(p=2*Math.PI+p),g<0&&(g=2*Math.PI+g),l&&p>g&&(p-=2*Math.PI),!l&&g>p&&(g-=2*Math.PI)}let x=g-p;if(Math.abs(x)>120*Math.PI/180){const q=g,I=n,V=r;g=l&&g>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,h=zhe(n=y+s*Math.cos(g),r=v+i*Math.sin(g),I,V,s,i,a,0,l,[g,q,y,v])}x=g-p;const w=Math.cos(p),S=Math.sin(p),_=Math.cos(g),k=Math.sin(g),T=Math.tan(x/4),A=4/3*s*T,R=4/3*i*T,M=[e,t],j=[e+A*S,t-R*w],F=[n+A*k,r-R*_],P=[n,r];if(j[0]=2*M[0]-j[0],j[1]=2*M[1]-j[1],c)return[j,F,P].concat(h);{h=[j,F,P].concat(h);const q=[];for(let I=0;I<h.length;I+=3){const V=Ux(h[I][0],h[I][1],u),D=Ux(h[I+1][0],h[I+1][1],u),z=Ux(h[I+2][0],h[I+2][1],u);q.push([V[0],V[1],D[0],D[1],z[0],z[1]])}return q}}const fmt={randOffset:function(e,t){return ir(e,t)},randOffsetWithRange:function(e,t,n){return _T(e,t,n)},ellipse:function(e,t,n,r,s){const i=qhe(n,r,s);return pD(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return vp(e,t,n,r,s,!0)}};function Uhe(e,t,n,r,s){return{type:"path",ops:vp(e,t,n,r,s)}}function pk(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...vp(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...vp(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?Uhe(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function hmt(e,t,n,r,s){return function(i,a){return pk(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function hK(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=D2(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:D2(n[0],1.5*(1+.22*t.roughness),gK(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=D2(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:D2(a,1.5*(1+.22*t.roughness),gK(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function qhe(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=ir(a*l,n),o+=ir(o*l,n),{increment:i,rx:a,ry:o}}function pD(e,t,n,r){const[s,i]=yK(r.increment,e,t,r.rx,r.ry,1,r.increment*_T(.1,_T(.4,1,n),n),n);let a=CT(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=yK(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=CT(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function pK(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=ir(.01*d,l),h+=ir(.01*h,l);let p=s,g=i;for(;p<0;)p+=2*Math.PI,g+=2*Math.PI;g-p>2*Math.PI&&(p=0,g=2*Math.PI);const y=2*Math.PI/l.curveStepCount,v=Math.min(y/2,(g-p)/2),x=bK(v,c,u,d,h,p,g,1,l);if(!l.disableMultiStroke){const w=bK(v,c,u,d,h,p,g,1.5,l);x.push(...w)}return a&&(o?x.push(...vp(c,u,c+d*Math.cos(p),u+h*Math.sin(p),l),...vp(c,u,c+d*Math.cos(g),u+h*Math.sin(g),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(p),u+h*Math.sin(p)]})),{type:"path",ops:x}}function mK(e,t){const n=Bhe($he(c8(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...vp(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,p]=o;r.push(...pmt(l,c,u,d,h,p,i,t)),i=[h,p];break}case"Z":r.push(...vp(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function xP(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+ir(s,t),r[0][1]+ir(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+ir(s,t),r[a][1]+ir(s,t)]})}}return{type:"fillPath",ops:n}}function G0(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!Go[s])switch(s){case"zigzag":Go[s]||(Go[s]=new imt(r));break;case"cross-hatch":Go[s]||(Go[s]=new amt(r));break;case"dots":Go[s]||(Go[s]=new omt(r));break;case"dashed":Go[s]||(Go[s]=new lmt(r));break;case"zigzag-line":Go[s]||(Go[s]=new cmt(r));break;default:s="hachure",Go[s]||(Go[s]=new l8(r))}return Go[s]}(t,fmt).fillPolygons(e,t)}function gK(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Vhe(e){return e.randomizer||(e.randomizer=new umt(e.seed||0)),e.randomizer.next()}function _T(e,t,n,r=1){return n.roughness*r*(Vhe(n)*(t-e)+e)}function ir(e,t,n=1){return _T(-e,e,t,n)}function vp(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=mD(e,t,n,r,s,!0,!1);if(a)return o;const l=mD(e,t,n,r,s,!0,!0);return o.concat(l)}function mD(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*Vhe(s);let p=s.bowing*s.maxRandomnessOffset*(r-t)/200,g=s.bowing*s.maxRandomnessOffset*(e-n)/200;p=ir(p,s,c),g=ir(g,s,c);const y=[],v=()=>ir(d,s,c),x=()=>ir(u,s,c),w=s.preserveVertices;return a?y.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):y.push({op:"move",data:[e+(w?0:ir(u,s,c)),t+(w?0:ir(u,s,c))]}),a?y.push({op:"bcurveTo",data:[p+e+(n-e)*h+v(),g+t+(r-t)*h+v(),p+e+2*(n-e)*h+v(),g+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):y.push({op:"bcurveTo",data:[p+e+(n-e)*h+x(),g+t+(r-t)*h+x(),p+e+2*(n-e)*h+x(),g+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),y}function D2(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+ir(t,n),e[0][1]+ir(t,n)]),r.push([e[0][0]+ir(t,n),e[0][1]+ir(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+ir(t,n),e[s][1]+ir(t,n)]),s===e.length-1&&r.push([e[s][0]+ir(t,n),e[s][1]+ir(t,n)]);return CT(r,null,n)}function CT(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...mD(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function yK(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=ir(.5,o)-Math.PI/2;c.push([ir(i,o)+t+.9*r*Math.cos(u-e),ir(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const p=[ir(i,o)+t+r*Math.cos(h),ir(i,o)+n+s*Math.sin(h)];l.push(p),c.push(p)}c.push([ir(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),ir(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([ir(i,o)+t+.98*r*Math.cos(u+a),ir(i,o)+n+.98*s*Math.sin(u+a)]),c.push([ir(i,o)+t+.9*r*Math.cos(u+.5*a),ir(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function bK(e,t,n,r,s,i,a,o,l){const c=i+ir(.1,l),u=[];u.push([ir(o,l)+t+.9*r*Math.cos(c-e),ir(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([ir(o,l)+t+r*Math.cos(d),ir(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),CT(u,null,l)}function pmt(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let p=0;p<d;p++)p===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:ir(c[0],o)),a[1]+(h?0:ir(c[0],o))]}),u=h?[s,i]:[s+ir(c[p],o),i+ir(c[p],o)],l.push({op:"bcurveTo",data:[e+ir(c[p],o),t+ir(c[p],o),n+ir(c[p],o),r+ir(c[p],o),u[0],u[1]]});return l}function qx(e){return[...e]}function vK(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(qx(e[0]),qx(e[1]),qx(e[2]),qx(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(qx(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function mk(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function mmt(e,t,n){const r=mk(t,n);if(r===0)return mk(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),mk(e,Tm(t,n,s))}function Tm(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function gD(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let p=3*u[0]-2*c[0]-h[0];p*=p;let g=3*u[1]-2*c[1]-h[1];g*=g;let y=3*d[0]-2*h[0]-c[0];y*=y;let v=3*d[1]-2*h[1]-c[1];return v*=v,p<y&&(p=y),g<v&&(g=v),p+g}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt(mk(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=Tm(l,c,.5),p=Tm(c,u,.5),g=Tm(u,d,.5),y=Tm(h,p,.5),v=Tm(p,g,.5),x=Tm(y,v,.5);gD([l,h,y,x],0,n,s),gD([x,v,g,d],0,n,s)}var i,a;return s}function gmt(e,t){return kT(e,0,e.length,t)}function kT(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=mmt(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(kT(e,t,c+1,r,i),kT(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function wP(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)gD(e,3*i,t,r);return n&&n>0?kT(r,0,r.length,n):r}const Cl="none";class ET{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[Uhe(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=hmt(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(xP([c],a)):o.push(G0([c],a))}return a.stroke!==Cl&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=qhe(r,s,a),c=pD(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=pD(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(G0([c.estimatedPoints],a));return a.stroke!==Cl&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[pk(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=pK(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const p=pK(t,n,r,s,i,a,!0,!1,h);p.type="fillPath",u.push(p)}else u.push(function(h,p,g,y,v,x,w){const S=h,_=p;let k=Math.abs(g/2),T=Math.abs(y/2);k+=ir(.01*k,w),T+=ir(.01*T,w);let A=v,R=x;for(;A<0;)A+=2*Math.PI,R+=2*Math.PI;R-A>2*Math.PI&&(A=0,R=2*Math.PI);const M=(R-A)/w.curveStepCount,j=[];for(let F=A;F<=R;F+=M)j.push([S+k*Math.cos(F),_+T*Math.sin(F)]);return j.push([S+k*Math.cos(R),_+T*Math.sin(R)]),j.push([S,_]),G0([j],w)}(t,n,r,s,i,a,c));return c.stroke!==Cl&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=hK(t,r);if(r.fill&&r.fill!==Cl)if(r.fillStyle==="solid"){const a=hK(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...wP(vK([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...wP(vK(c),10,(1+r.roughness)/2))}a.length&&s.push(G0([a],r))}return r.stroke!==Cl&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=pk(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(xP([t],r)):s.push(G0([t],r))),r.stroke!==Cl&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==Cl,a=r.stroke!==Cl,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const p=Bhe($he(c8(u))),g=[];let y=[],v=[0,0],x=[];const w=()=>{x.length>=4&&y.push(...wP(x,d)),x=[]},S=()=>{w(),y.length&&(g.push(y),y=[])};for(const{key:k,data:T}of p)switch(k){case"M":S(),v=[T[0],T[1]],y.push(v);break;case"L":w(),y.push([T[0],T[1]]);break;case"C":if(!x.length){const A=y.length?y[y.length-1]:v;x.push([A[0],A[1]])}x.push([T[0],T[1]]),x.push([T[2],T[3]]),x.push([T[4],T[5]]);break;case"Z":w(),y.push([v[0],v[1]])}if(S(),!h)return g;const _=[];for(const k of g){const T=gmt(k,h);T.length&&_.push(T)}return _}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=mK(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=mK(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(xP(l,r));else s.push(G0(l,r));return a&&(o?l.forEach(u=>{s.push(pk(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Cl};break;case"fillPath":a={d:this.opsToPath(i),stroke:Cl,strokeWidth:0,fill:r.fill||Cl};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||Cl,strokeWidth:r,fill:Cl}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class ymt{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new ET(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const F2="http://www.w3.org/2000/svg";class bmt{constructor(t,n){this.svg=t,this.gen=new ET(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(F2,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(F2,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(F2,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(F2,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var Rn={canvas:(e,t)=>new ymt(e,t),svg:(e,t)=>new bmt(e,t),generator:e=>new ET(e),newSeed:()=>ET.newSeed()},yr=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||oa((d=fs())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",To(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await Up(a,gg(qg(o),fs()),{useHtmlLabels:s,width:t.width||((h=fs().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const p=l.children[0],g=mr(l),y=p.getElementsByTagName("img");if(y){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...y].map(x=>new Promise(w=>{function S(){if(x.style.display="flex",x.style.flexDirection="column",v){const _=fs().fontSize?fs().fontSize:window.getComputedStyle(document.body).fontSize,k=5,[T=Mue.fontSize]=zN(_),A=T*k+"px";x.style.minWidth=A,x.style.maxWidth=A}else x.style.width="100%";w(x)}ie(S,"setupImage"),setTimeout(()=>{x.complete&&S()}),x.addEventListener("error",S),x.addEventListener("load",S)})))}c=p.getBoundingClientRect(),g.attr("width",c.width),g.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),SP=ie(async(e,t,n)=>{var l,c,u,d,h,p;const r=n.useHtmlLabels||oa((c=(l=fs())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await Up(s,gg(qg(t),fs()),{useHtmlLabels:r,width:n.width||((d=(u=fs())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(oa((p=(h=fs())==null?void 0:h.flowchart)==null?void 0:p.htmlLabels)){const g=i.children[0],y=mr(i);a=g.getBoundingClientRect(),y.attr("width",a.width),y.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),Dn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),or=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function ss(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(ss,"createPathFromPoints");function xp(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let p=0;p<=50;p++){const g=p/50,y=e+g*l,v=h+s*Math.sin(d*(y-e));a.push({x:y,y:v})}return a}ie(xp,"generateFullSineWavePoints");function u8(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),g=t+n*Math.sin(h);a.push({x:-p,y:-g})}return a}ie(u8,"generateCirclePoints");var vmt=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),mv=vmt;function Whe(e,t){t&&e.attr("style",t)}ie(Whe,"applyStyle");async function Hhe(e){const t=mr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&Eb(e.label)&&(r=await _L(e.label.replace(fv.lineBreakRegex,`
`),fs()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),Whe(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(Hhe,"addHtmlLabel");var xmt=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),oa(fs().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),qt.info("vertexText"+s);const i={isNode:r,label:qg(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await Hhe(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),qm=xmt,Wf=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),wmt=ie(e=>{const{handDrawnSeed:t}=fs();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),gv=ie(e=>{const t=Smt([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),Smt=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),Ghe=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),Fn=ie(e=>{const{stylesArray:t}=gv(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];Ghe(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),Mn=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=fs(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=gv(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),Khe=ie(async(e,t)=>{qt.info("Creating subgraph rect for ",t.id,t);const n=fs(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=Fn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=oa(n.flowchart.htmlLabels),p=d.insert("g").attr("class","cluster-label "),g=await Up(p,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let y=g.getBBox();if(oa(n.flowchart.htmlLabels)){const A=g.children[0],R=mr(g);y=A.getBoundingClientRect(),R.attr("width",y.width),R.attr("height",y.height)}const v=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;qt.trace("Data ",t,JSON.stringify(t));let _;if(t.look==="handDrawn"){const A=Rn.svg(d),R=Mn(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),M=A.path(Wf(w,S,v,x,0),R);_=d.insert(()=>(qt.debug("Rough node insert CXC",M),M),":first-child"),_.select("path:nth-child(2)").attr("style",c.join(";")),_.select("path").attr("style",u.join(";").replace("fill","stroke"))}else _=d.insert("rect",":first-child"),_.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:k}=DL(n);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+k})`),o){const A=p.select("span");A&&A.attr("style",o)}const T=_.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=y.height-t.padding/2,t.intersect=function(A){return mv(t,A)},{cluster:d,labelBBox:y}},"rect"),_mt=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return mv(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),Cmt=ie(async(e,t)=>{const n=fs(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const p=d.node().appendChild(await qm(t.label,t.labelStyle,void 0,!0));let g=p.getBBox();if(oa(n.flowchart.htmlLabels)){const M=p.children[0],j=mr(p);g=M.getBoundingClientRect(),j.attr("width",g.width),j.attr("height",g.height)}const y=0*t.padding,v=y/2,x=(t.width<=g.width+t.padding?g.width+t.padding:t.width)+y;t.width<=g.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+y,S=t.height+y-g.height-6,_=t.x-x/2,k=t.y-w/2;t.width=x;const T=t.y-t.height/2-v+g.height+2;let A;if(t.look==="handDrawn"){const M=t.cssClasses.includes("statediagram-cluster-alt"),j=Rn.svg(c),F=t.rx||t.ry?j.path(Wf(_,k,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):j.rectangle(_,k,x,w,{seed:s});A=c.insert(()=>F,":first-child");const P=j.rectangle(_,T,x,S,{fill:M?i:a,fillStyle:M?"hachure":"solid",stroke:l,seed:s});A=c.insert(()=>F,":first-child"),h=c.insert(()=>P)}else A=u.insert("rect",":first-child"),A.attr("class","outer").attr("x",_).attr("y",k).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",_).attr("y",T).attr("width",x).attr("height",S);d.attr("transform",`translate(${t.x-g.width/2}, ${k+1-(oa(n.flowchart.htmlLabels)?0:3)})`);const R=A.node().getBBox();return t.height=R.height,t.offsetX=0,t.offsetY=g.height-t.padding/2,t.labelBBox=g,t.intersect=function(M){return mv(t,M)},{cluster:c,labelBBox:g}},"roundedWithTitle"),kmt=ie(async(e,t)=>{qt.info("Creating subgraph rect for ",t.id,t);const n=fs(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=Fn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=oa(n.flowchart.htmlLabels),p=d.insert("g").attr("class","cluster-label "),g=await Up(p,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let y=g.getBBox();if(oa(n.flowchart.htmlLabels)){const A=g.children[0],R=mr(g);y=A.getBoundingClientRect(),R.attr("width",y.width),R.attr("height",y.height)}const v=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;qt.trace("Data ",t,JSON.stringify(t));let _;if(t.look==="handDrawn"){const A=Rn.svg(d),R=Mn(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),M=A.path(Wf(w,S,v,x,t.rx),R);_=d.insert(()=>(qt.debug("Rough node insert CXC",M),M),":first-child"),_.select("path:nth-child(2)").attr("style",c.join(";")),_.select("path").attr("style",u.join(";").replace("fill","stroke"))}else _=d.insert("rect",":first-child"),_.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:k}=DL(n);if(p.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+k})`),o){const A=p.select("span");A&&A.attr("style",o)}const T=_.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=y.height-t.padding/2,t.intersect=function(A){return mv(t,A)},{cluster:d,labelBBox:y}},"kanbanSection"),Emt=ie((e,t)=>{const n=fs(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let p;if(t.look==="handDrawn"){const v=Rn.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});p=a.insert(()=>v,":first-child")}else p=o.insert("rect",":first-child"),p.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const g=p.node().getBBox();return t.height=g.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return mv(t,y)},{cluster:a,labelBBox:{}}},"divider"),Tmt=Khe,Amt={rect:Khe,squareRect:Tmt,roundedWithTitle:Cmt,noteGroup:_mt,divider:Emt,kanbanSection:kmt},Yhe=new Map,Nmt=ie(async(e,t)=>{const n=t.shape||"rect",r=await Amt[n](e,t);return Yhe.set(t.id,r),r},"insertCluster"),Gvt=ie(()=>{Yhe=new Map},"clear");function Zhe(e,t){return e.intersect(t)}ie(Zhe,"intersectNode");var Rmt=Zhe;function Xhe(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(Xhe,"intersectEllipse");var Jhe=Xhe;function Qhe(e,t,n){return Jhe(e,t,t,n)}ie(Qhe,"intersectCircle");var Imt=Qhe;function epe(e,t,n,r){var s,i,a,o,l,c,u,d,h,p,g,y,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,p=s*r.x+a*r.y+l,!(h!==0&&p!==0&&yD(h,p))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&yD(u,d))&&(g=s*o-i*a,g!==0)))return y=Math.abs(g/2),v=a*c-o*l,x=v<0?(v-y)/g:(v+y)/g,v=i*l-s*c,w=v<0?(v-y)/g:(v+y)/g,{x,y:w}}ie(epe,"intersectLine");function yD(e,t){return e*t>0}ie(yD,"sameSign");var Mmt=epe;function tpe(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],p=Mmt(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});p&&i.push(p)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,p=u.y-n.y,g=Math.sqrt(h*h+p*p),y=d.x-n.x,v=d.y-n.y,x=Math.sqrt(y*y+v*v);return g<x?-1:g===x?0:1}),i[0]):e}ie(tpe,"intersectPolygon");var jmt=tpe,En={node:Rmt,circle:Imt,ellipse:Jhe,polygon:jmt,rect:mv};function npe(e,t){const{labelStyles:n}=Fn(t);t.labelStyle=n;const r=or(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=Rn.svg(i),c=Mn(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",To(o)),Dn(t,d),t.intersect=function(h){return qt.info("Circle intersect",t,a,h),En.circle(t,a,h)},i}ie(npe,"anchor");function bD(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,p=d/s,g=h/i,y=Math.sqrt(p**2+g**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-y**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),S=Math.atan2((t-w)/i,(e-x)/s);let k=Math.atan2((r-w)/i,(n-x)/s)-S;a&&k<0&&(k+=2*Math.PI),!a&&k>0&&(k-=2*Math.PI);const T=[];for(let A=0;A<20;A++){const R=A/19,M=S+R*k,j=x+s*Math.cos(M),F=w+i*Math.sin(M);T.push({x:j,y:F})}return T}ie(bD,"generateArcPoints");async function rpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...bD(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...bD(a/2,o/2,a/2,-o/2,c,l,!0)],h=Rn.svg(s),p=Mn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=ss(d),y=h.path(g,p),v=s.insert(()=>y,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),Dn(t,v),t.intersect=function(x){return En.polygon(t,d,x)},s}ie(rpe,"bowTieRect");function Hf(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(Hf,"insertPolygonShape");async function spe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,p=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let g;const{cssStyles:y}=t;if(t.look==="handDrawn"){const v=Rn.svg(s),x=Mn(t,{}),w=ss(p),S=v.path(w,x);g=s.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),y&&g.attr("style",y)}else g=Hf(s,l,a,p);return r&&g.attr("style",r),Dn(t,g),t.intersect=function(v){return En.polygon(t,p,v)},s}ie(spe,"card");function ipe(e,t){const{nodeStyles:n}=Fn(t);t.label="";const r=e.insert("g").attr("class",or(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=Rn.svg(r),l=Mn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=ss(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return En.polygon(t,a,h)},r}ie(ipe,"choice");async function ape(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await yr(e,t,or(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=Rn.svg(s),d=Mn(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",To(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return Dn(t,l),t.intersect=function(u){return qt.info("Circle intersect",t,o,u),En.circle(t,o,u)},s}ie(ape,"circle");function ope(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie(ope,"createLine");function lpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",or(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=Rn.svg(s),l=Mn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=ope(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),Dn(t,h),t.intersect=function(p){return qt.info("crossedCircle intersect",t,{radius:i,point:p}),En.circle(t,i,p)},s}ie(lpe,"crossedCircle");function tf(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),g=t+n*Math.sin(h);a.push({x:-p,y:-g})}return a}ie(tf,"generateCirclePoints");async function cpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...tf(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...tf(o/2+c*2,-c,c,20,-180,-270),...tf(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...tf(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...tf(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...tf(o/2+o*.1,-c,c,20,-180,-270),...tf(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...tf(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],p=Rn.svg(s),g=Mn(t,{fill:"none"});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const v=ss(d).replace("Z",""),x=p.path(v,g),w=ss(h),S=p.path(w,{...g}),_=s.insert("g",":first-child");return _.insert(()=>S,":first-child").attr("stroke-opacity",0),_.insert(()=>x,":first-child"),_.attr("class","text"),u&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",r),_.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Dn(t,_),t.intersect=function(k){return En.polygon(t,h,k)},s}ie(cpe,"curlyBraceLeft");function nf(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),g=t+n*Math.sin(h);a.push({x:p,y:g})}return a}ie(nf,"generateCirclePoints");async function upe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...nf(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...nf(o/2+c*2,-c,c,20,-180,-270),...nf(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...nf(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},...nf(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...nf(o/2+c*2,-c,c,20,-180,-270),...nf(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...nf(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],p=Rn.svg(s),g=Mn(t,{fill:"none"});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const v=ss(d).replace("Z",""),x=p.path(v,g),w=ss(h),S=p.path(w,{...g}),_=s.insert("g",":first-child");return _.insert(()=>S,":first-child").attr("stroke-opacity",0),_.insert(()=>x,":first-child"),_.attr("class","text"),u&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",r),_.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Dn(t,_),t.intersect=function(k){return En.polygon(t,h,k)},s}ie(upe,"curlyBraceRight");function Ma(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),g=t+n*Math.sin(h);a.push({x:-p,y:-g})}return a}ie(Ma,"generateCirclePoints");async function dpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Ma(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...Ma(o/2+c*2,-c,c,20,-180,-270),...Ma(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...Ma(o/2,l/2,c,20,0,90)],h=[...Ma(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...Ma(-o/2-c/2,-c,c,20,0,90),...Ma(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...Ma(-o/2+c+c/2,l/2,c,30,-180,-270)],p=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...Ma(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...Ma(o/2+c*2,-c,c,20,-180,-270),...Ma(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...Ma(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...Ma(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...Ma(-o/2-c/2,-c,c,20,0,90),...Ma(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...Ma(-o/2+c+c/2,l/2,c,30,-180,-270)],g=Rn.svg(s),y=Mn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=ss(d).replace("Z",""),w=g.path(x,y),_=ss(h).replace("Z",""),k=g.path(_,y),T=ss(p),A=g.path(T,{...y}),R=s.insert("g",":first-child");return R.insert(()=>A,":first-child").attr("stroke-opacity",0),R.insert(()=>w,":first-child"),R.insert(()=>k,":first-child"),R.attr("class","text"),u&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",r),R.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Dn(t,R),t.intersect=function(M){return En.polygon(t,p,M)},s}ie(dpe,"curlyBraces");async function fpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=Rn.svg(s),p=Mn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=l,y=c,v=g-u,x=y/4,w=[{x:v,y:0},{x,y:0},{x:0,y:y/2},{x,y},{x:v,y},...u8(-v,-y/2,u,50,270,90)],S=ss(w),_=h.path(S,p),k=s.insert(()=>_,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectChildren("path").attr("style",r),k.attr("transform",`translate(${-l/2}, ${-c/2})`),Dn(t,k),t.intersect=function(T){return En.polygon(t,w,T)},s}ie(fpe,"curvedTrapezoid");var Pmt=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),Omt=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),Dmt=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function hpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const p=Rn.svg(s),g=Omt(0,0,o,u,l,c),y=Dmt(0,c,o,u,l,c),v=p.path(g,Mn(t,{})),x=p.path(y,Mn(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const p=Pmt(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",To(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Dn(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(p){const g=En.rect(t,p),y=g.x-(t.x??0);if(l!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(g.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-y*y/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,p.y-(t.y??0)>0&&(v=-v),g.y+=v}return g},s}ie(hpe,"cylinder");async function ppe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,p=Rn.svg(s),g=Mn(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const y=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=p.polygon(y.map(w=>[w.x,w.y]),g),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),Dn(t,x),t.intersect=function(w){return En.rect(t,w)},s}ie(ppe,"dividedRectangle");async function mpe(e,t){var h,p;const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await yr(e,t,or(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const g=Rn.svg(s),y=Mn(t,{roughness:.2,strokeWidth:2.5}),v=Mn(t,{roughness:.2,strokeWidth:1.5}),x=g.circle(0,0,l*2,y),w=g.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",To(t.cssClasses)).attr("style",To(d)),(h=u.node())==null||h.appendChild(x),(p=u.node())==null||p.appendChild(w)}else{u=s.insert("g",":first-child");const g=u.insert("circle",":first-child"),y=u.insert("circle");u.attr("class","basic label-container").attr("style",r),g.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),y.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return Dn(t,u),t.intersect=function(g){return qt.info("DoubleCircle intersect",t,l,g),En.circle(t,l,g)},s}ie(mpe,"doublecircle");function gpe(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=Fn(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",or(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=Rn.svg(i),{nodeBorder:c}=n,u=Mn(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),Dn(t,h),t.intersect=function(p){return qt.info("filledCircle intersect",t,{radius:a,point:p}),En.circle(t,a,p)},i}ie(gpe,"filledCircle");async function ype(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=Rn.svg(s),p=Mn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=ss(u),y=h.path(g,p),v=s.insert(()=>y,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,Dn(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return qt.info("Triangle intersect",t,u,x),En.polygon(t,u,x)},s}ie(ype,"flippedTriangle");function bpe(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=Fn(t);t.label="";const a=e.insert("g").attr("class",or(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=Rn.svg(a),p=Mn(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=h.rectangle(u,d,l,c,p),y=a.insert(()=>g,":first-child");o&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),Dn(t,y);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return En.rect(t,x)},a}ie(bpe,"forkJoin");async function vpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await yr(e,t,or(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=Rn.svg(a),p=Mn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...u8(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],y=ss(g),v=h.path(y,p),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),Dn(t,x),t.intersect=function(w){return qt.info("Pill intersect",t,{radius:u,point:w}),En.polygon(t,g,w)},a}ie(vpe,"halfRoundedRectangle");var Fmt=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function xpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const p=Rn.svg(s),g=Mn(t,{}),y=Fmt(0,0,c,o,l),v=p.path(y,g);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=Hf(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,Dn(t,d),t.intersect=function(p){return En.polygon(t,u,p)},s}ie(xpe,"hexagon");async function wpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await yr(e,t,or(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=Rn.svg(s),c=Mn(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=ss(u),h=l.path(d,c),p=s.insert(()=>h,":first-child");return p.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",r),p.attr("transform",`translate(${-i/2}, ${-a/2})`),Dn(t,p),t.intersect=function(g){return qt.info("Pill intersect",t,{points:u}),En.polygon(t,u,g)},s}ie(wpe,"hourglass");async function Spe(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Fn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await yr(e,t,"icon-shape default"),h=t.pos==="t",p=o,g=o,{nodeBorder:y}=n,{stylesMap:v}=gv(t),x=-g/2,w=-p/2,S=t.label?8:0,_=Rn.svg(c),k=Mn(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const T=_.rectangle(x,w,g,p,k),A=Math.max(g,u.width),R=p+u.height+S,M=_.rectangle(-A/2,-R/2,A,R,{...k,fill:"transparent",stroke:"none"}),j=c.insert(()=>T,":first-child"),F=c.insert(()=>M);if(t.icon){const P=c.append("g");P.html(`<g>${await jN(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const q=P.node().getBBox(),I=q.width,V=q.height,D=q.x,z=q.y;P.attr("transform",`translate(${-I/2-D},${h?u.height/2+S/2-V/2-z:-u.height/2-S/2-V/2-z})`),P.attr("style",`color: ${v.get("stroke")??y};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-R/2:R/2-u.height})`),j.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),Dn(t,F),t.intersect=function(P){if(qt.info("iconSquare intersect",t,P),!t.label)return En.rect(t,P);const q=t.x??0,I=t.y??0,V=t.height??0;let D=[];return h?D=[{x:q-u.width/2,y:I-V/2},{x:q+u.width/2,y:I-V/2},{x:q+u.width/2,y:I-V/2+u.height+S},{x:q+g/2,y:I-V/2+u.height+S},{x:q+g/2,y:I+V/2},{x:q-g/2,y:I+V/2},{x:q-g/2,y:I-V/2+u.height+S},{x:q-u.width/2,y:I-V/2+u.height+S}]:D=[{x:q-g/2,y:I-V/2},{x:q+g/2,y:I-V/2},{x:q+g/2,y:I-V/2+p},{x:q+u.width/2,y:I-V/2+p},{x:q+u.width/2/2,y:I+V/2},{x:q-u.width/2,y:I+V/2},{x:q-u.width/2,y:I-V/2+p},{x:q-g/2,y:I-V/2+p}],En.polygon(t,D,P)},c}ie(Spe,"icon");async function _pe(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Fn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await yr(e,t,"icon-shape default"),h=20,p=t.label?8:0,g=t.pos==="t",{nodeBorder:y,mainBkg:v}=n,{stylesMap:x}=gv(t),w=Rn.svg(c),S=Mn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const _=x.get("fill");S.stroke=_??v;const k=c.append("g");t.icon&&k.html(`<g>${await jN(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const T=k.node().getBBox(),A=T.width,R=T.height,M=T.x,j=T.y,F=Math.max(A,R)*Math.SQRT2+h*2,P=w.circle(0,0,F,S),q=Math.max(F,u.width),I=F+u.height+p,V=w.rectangle(-q/2,-I/2,q,I,{...S,fill:"transparent",stroke:"none"}),D=c.insert(()=>P,":first-child"),z=c.insert(()=>V);return k.attr("transform",`translate(${-A/2-M},${g?u.height/2+p/2-R/2-j:-u.height/2-p/2-R/2-j})`),k.attr("style",`color: ${x.get("stroke")??y};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${g?-I/2:I/2-u.height})`),D.attr("transform",`translate(0,${g?u.height/2+p/2:-u.height/2-p/2})`),Dn(t,z),t.intersect=function($){return qt.info("iconSquare intersect",t,$),En.rect(t,$)},c}ie(_pe,"iconCircle");async function Cpe(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Fn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await yr(e,t,"icon-shape default"),p=t.pos==="t",g=o+d*2,y=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=gv(t),S=-y/2,_=-g/2,k=t.label?8:0,T=Rn.svg(c),A=Mn(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const R=w.get("fill");A.stroke=R??x;const M=T.path(Wf(S,_,y,g,5),A),j=Math.max(y,u.width),F=g+u.height+k,P=T.rectangle(-j/2,-F/2,j,F,{...A,fill:"transparent",stroke:"none"}),q=c.insert(()=>M,":first-child").attr("class","icon-shape2"),I=c.insert(()=>P);if(t.icon){const V=c.append("g");V.html(`<g>${await jN(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const D=V.node().getBBox(),z=D.width,$=D.height,Y=D.x,B=D.y;V.attr("transform",`translate(${-z/2-Y},${p?u.height/2+k/2-$/2-B:-u.height/2-k/2-$/2-B})`),V.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${p?-F/2:F/2-u.height})`),q.attr("transform",`translate(0,${p?u.height/2+k/2:-u.height/2-k/2})`),Dn(t,I),t.intersect=function(V){if(qt.info("iconSquare intersect",t,V),!t.label)return En.rect(t,V);const D=t.x??0,z=t.y??0,$=t.height??0;let Y=[];return p?Y=[{x:D-u.width/2,y:z-$/2},{x:D+u.width/2,y:z-$/2},{x:D+u.width/2,y:z-$/2+u.height+k},{x:D+y/2,y:z-$/2+u.height+k},{x:D+y/2,y:z+$/2},{x:D-y/2,y:z+$/2},{x:D-y/2,y:z-$/2+u.height+k},{x:D-u.width/2,y:z-$/2+u.height+k}]:Y=[{x:D-y/2,y:z-$/2},{x:D+y/2,y:z-$/2},{x:D+y/2,y:z-$/2+g},{x:D+u.width/2,y:z-$/2+g},{x:D+u.width/2/2,y:z+$/2},{x:D-u.width/2,y:z+$/2},{x:D-u.width/2,y:z-$/2+g},{x:D-y/2,y:z-$/2+g}],En.polygon(t,Y,V)},c}ie(Cpe,"iconRounded");async function kpe(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Fn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await yr(e,t,"icon-shape default"),p=t.pos==="t",g=o+d*2,y=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=gv(t),S=-y/2,_=-g/2,k=t.label?8:0,T=Rn.svg(c),A=Mn(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const R=w.get("fill");A.stroke=R??x;const M=T.path(Wf(S,_,y,g,.1),A),j=Math.max(y,u.width),F=g+u.height+k,P=T.rectangle(-j/2,-F/2,j,F,{...A,fill:"transparent",stroke:"none"}),q=c.insert(()=>M,":first-child"),I=c.insert(()=>P);if(t.icon){const V=c.append("g");V.html(`<g>${await jN(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const D=V.node().getBBox(),z=D.width,$=D.height,Y=D.x,B=D.y;V.attr("transform",`translate(${-z/2-Y},${p?u.height/2+k/2-$/2-B:-u.height/2-k/2-$/2-B})`),V.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${p?-F/2:F/2-u.height})`),q.attr("transform",`translate(0,${p?u.height/2+k/2:-u.height/2-k/2})`),Dn(t,I),t.intersect=function(V){if(qt.info("iconSquare intersect",t,V),!t.label)return En.rect(t,V);const D=t.x??0,z=t.y??0,$=t.height??0;let Y=[];return p?Y=[{x:D-u.width/2,y:z-$/2},{x:D+u.width/2,y:z-$/2},{x:D+u.width/2,y:z-$/2+u.height+k},{x:D+y/2,y:z-$/2+u.height+k},{x:D+y/2,y:z+$/2},{x:D-y/2,y:z+$/2},{x:D-y/2,y:z-$/2+u.height+k},{x:D-u.width/2,y:z-$/2+u.height+k}]:Y=[{x:D-y/2,y:z-$/2},{x:D+y/2,y:z-$/2},{x:D+y/2,y:z-$/2+g},{x:D+u.width/2,y:z-$/2+g},{x:D+u.width/2/2,y:z+$/2},{x:D-u.width/2,y:z+$/2},{x:D-u.width/2,y:z-$/2+g},{x:D-y/2,y:z-$/2+g}],En.polygon(t,Y,V)},c}ie(kpe,"iconSquare");async function Epe(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=Fn(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:p}=await yr(e,t,"image-shape default"),g=t.pos==="t",y=-c/2,v=-u/2,x=t.label?8:0,w=Rn.svg(d),S=Mn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const _=w.rectangle(y,v,c,u,S),k=Math.max(c,h.width),T=u+h.height+x,A=w.rectangle(-k/2,-T/2,k,T,{...S,fill:"none",stroke:"none"}),R=d.insert(()=>_,":first-child"),M=d.insert(()=>A);if(t.img){const j=d.append("image");j.attr("href",t.img),j.attr("width",c),j.attr("height",u),j.attr("preserveAspectRatio","none"),j.attr("transform",`translate(${-c/2},${g?T/2-u:-T/2})`)}return p.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${g?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),R.attr("transform",`translate(0,${g?h.height/2+x/2:-h.height/2-x/2})`),Dn(t,M),t.intersect=function(j){if(qt.info("iconSquare intersect",t,j),!t.label)return En.rect(t,j);const F=t.x??0,P=t.y??0,q=t.height??0;let I=[];return g?I=[{x:F-h.width/2,y:P-q/2},{x:F+h.width/2,y:P-q/2},{x:F+h.width/2,y:P-q/2+h.height+x},{x:F+c/2,y:P-q/2+h.height+x},{x:F+c/2,y:P+q/2},{x:F-c/2,y:P+q/2},{x:F-c/2,y:P-q/2+h.height+x},{x:F-h.width/2,y:P-q/2+h.height+x}]:I=[{x:F-c/2,y:P-q/2},{x:F+c/2,y:P-q/2},{x:F+c/2,y:P-q/2+u},{x:F+h.width/2,y:P-q/2+u},{x:F+h.width/2/2,y:P+q/2},{x:F-h.width/2,y:P+q/2},{x:F-h.width/2,y:P-q/2+u},{x:F-c/2,y:P-q/2+u}],En.polygon(t,I,j)},d}ie(Epe,"imageSquare");async function Tpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=Mn(t,{}),p=ss(l),g=d.path(p,h);c=s.insert(()=>g,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Dn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Tpe,"inv_trapezoid");async function S_(e,t,n){const{labelStyles:r,nodeStyles:s}=Fn(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await yr(e,t,or(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:p}=t;const{cssStyles:g}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,p=n.ry),t.look==="handDrawn"){const y=Rn.svg(i),v=Mn(t,{}),x=h||p?y.path(Wf(c,u,o,l,h||0),v):y.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",To(g))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",To(h)).attr("ry",To(p)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return Dn(t,d),t.intersect=function(y){return En.rect(t,y)},i}ie(S_,"drawRect");async function Ape(e,t){const{shapeSvg:n,bbox:r,label:s}=await yr(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),Dn(t,i),t.intersect=function(l){return En.rect(t,l)},n}ie(Ape,"labelRect");async function Npe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=Mn(t,{}),p=ss(l),g=d.path(p,h);c=s.insert(()=>g,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Dn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Npe,"lean_left");async function Rpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=Mn(t,{}),p=ss(l),g=d.path(p,h);c=s.insert(()=>g,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Dn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Rpe,"lean_right");function Ipe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",or(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=Rn.svg(s),d=Mn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=ss(c),p=u.path(h,d),g=s.insert(()=>p,":first-child");return i&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",r),g.attr("transform",`translate(-${a/2},${-o})`),Dn(t,g),t.intersect=function(y){return qt.info("lightningBolt intersect",t,y),En.polygon(t,c,y)},s}ie(Ipe,"lightningBolt");var Lmt=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),$mt=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),Bmt=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Mpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:p}=t;if(t.look==="handDrawn"){const g=Rn.svg(s),y=$mt(0,0,o,u,l,c,d),v=Bmt(0,c,o,u,l,c),x=Mn(t,{}),w=g.path(y,x),S=g.path(v,x);s.insert(()=>S,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),p&&h.attr("style",p)}else{const g=Lmt(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",g).attr("class","basic label-container").attr("style",To(p)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Dn(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(g){const y=En.rect(t,g),v=y.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,g.y-(t.y??0)>0&&(x=-x),y.y+=x}return y},s}ie(Mpe,"linedCylinder");async function jpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=Rn.svg(s),p=Mn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...xp(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],y=h.polygon(g.map(x=>[x.x,x.y]),p),v=s.insert(()=>y,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Dn(t,v),t.intersect=function(x){return En.polygon(t,g,x)},s}ie(jpe,"linedWaveEdgedRect");async function Ppe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,p=Rn.svg(s),g=Mn(t,{}),y=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const x=ss(y),w=p.path(x,g),S=ss(v),_=p.path(S,{...g,fill:"none"}),k=s.insert(()=>_,":first-child");return k.insert(()=>w,":first-child"),k.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),Dn(t,k),t.intersect=function(T){return En.polygon(t,y,T)},s}ie(Ppe,"multiRect");async function Ope(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,p=5,{cssStyles:g}=t,y=xp(d-p,h+u+p,d+o-p,h+u+p,c,.8),v=y==null?void 0:y[y.length-1],x=[{x:d-p,y:h+p},{x:d-p,y:h+u+p},...y,{x:d+o-p,y:v.y-p},{x:d+o,y:v.y-p},{x:d+o,y:v.y-2*p},{x:d+o+p,y:v.y-2*p},{x:d+o+p,y:h-p},{x:d+p,y:h-p},{x:d+p,y:h},{x:d,y:h},{x:d,y:h+p}],w=[{x:d,y:h+p},{x:d+o-p,y:h+p},{x:d+o-p,y:v.y-p},{x:d+o,y:v.y-p},{x:d+o,y:h},{x:d,y:h}],S=Rn.svg(s),_=Mn(t,{});t.look!=="handDrawn"&&(_.roughness=0,_.fillStyle="solid");const k=ss(x),T=S.path(k,_),A=ss(w),R=S.path(A,_),M=s.insert(()=>T,":first-child");return M.insert(()=>R),M.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",g),r&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",r),M.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-p-(i.x-(i.left??0))}, ${-(i.height/2)+p-c/2-(i.y-(i.top??0))})`),Dn(t,M),t.intersect=function(j){return En.polygon(t,x,j)},s}ie(Ope,"multiWaveEdgedRectangle");async function Dpe(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=Fn(t);t.labelStyle=r,t.useHtmlLabels||((x=il().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await yr(e,t,or(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,p=Rn.svg(a),g=Mn(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const y=p.rectangle(u,d,l,c,g),v=a.insert(()=>y,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),Dn(t,v),t.intersect=function(w){return En.rect(t,w)},a}ie(Dpe,"note");var zmt=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Fpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=Rn.svg(s),p=Mn(t,{}),g=zmt(0,0,l),y=h.path(g,p);u=s.insert(()=>y,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=Hf(s,l,l,c);return r&&u.attr("style",r),Dn(t,u),t.intersect=function(h){return qt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,En.polygon(t,c,h)),En.polygon(t,c,h)},s}ie(Fpe,"question");async function Lpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:p}=t,g=Rn.svg(s),y=Mn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=ss(h),x=g.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Dn(t,w),t.intersect=function(S){return En.polygon(t,h,S)},s}ie(Lpe,"rect_left_inv_arrow");async function $pe(e,t){var R,M;const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await qm(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(oa((M=(R=fs())==null?void 0:R.flowchart)==null?void 0:M.htmlLabels)){const j=u.children[0],F=mr(u);d=j.getBoundingClientRect(),F.attr("width",d.width),F.attr("height",d.height)}qt.info("Text 2",l);const h=l||[],p=u.getBBox(),g=o.node().appendChild(await qm(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),y=g.children[0],v=mr(g);d=y.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;mr(g).attr("transform","translate( "+(d.width>p.width?0:(p.width-d.width)/2)+", "+(p.height+x+5)+")"),mr(u).attr("transform","translate( "+(d.width<p.width?0:-(p.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),S=d.height+(t.padding||0),_=-d.width/2-x,k=-d.height/2-x;let T,A;if(t.look==="handDrawn"){const j=Rn.svg(i),F=Mn(t,{}),P=j.path(Wf(_,k,w,S,t.rx||0),F),q=j.line(-d.width/2-x,-d.height/2-x+p.height+x,d.width/2+x,-d.height/2-x+p.height+x,F);A=i.insert(()=>(qt.debug("Rough node insert CXC",P),q),":first-child"),T=i.insert(()=>(qt.debug("Rough node insert CXC",P),P),":first-child")}else T=a.insert("rect",":first-child"),A=a.insert("line"),T.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),A.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+p.height+x).attr("y2",-d.height/2-x+p.height+x);return Dn(t,T),t.intersect=function(j){return En.rect(t,j)},i}ie($pe,"rectWithTitle");async function Bpe(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return S_(e,t,n)}ie(Bpe,"roundedRect");async function zpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,p=Rn.svg(s),g=Mn(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const y=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=p.polygon(y.map(w=>[w.x,w.y]),g),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",To(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),Dn(t,x),t.intersect=function(w){return En.rect(t,w)},s}ie(zpe,"shadedProcess");async function Upe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=Rn.svg(s),p=Mn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const g=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],y=ss(g),v=h.path(y,p),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),Dn(t,x),t.intersect=function(w){return En.polygon(t,g,w)},s}ie(Upe,"slopedRect");async function qpe(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return S_(e,t,n)}ie(qpe,"squareRect");async function Vpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=Rn.svg(s),d=Mn(t,{}),h=Wf(-o/2,-a/2,o,a,a/2),p=u.path(h,d);l=s.insert(()=>p,":first-child"),l.attr("class","basic label-container").attr("style",To(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return Dn(t,l),t.intersect=function(u){return En.rect(t,u)},s}ie(Vpe,"stadium");async function Wpe(e,t){return S_(e,t,{rx:5,ry:5})}ie(Wpe,"state");function Hpe(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=Fn(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=Rn.svg(c),d=Mn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),p=o??l,g=u.circle(0,0,5,{...d,fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"}),y=c.insert(()=>h,":first-child");return y.insert(()=>g),i&&y.selectAll("path").attr("style",i),s&&y.selectAll("path").attr("style",s),Dn(t,y),t.intersect=function(v){return En.circle(t,7,v)},c}ie(Hpe,"stateEnd");function Gpe(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=Rn.svg(s).circle(0,0,14,wmt(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return Dn(t,i),t.intersect=function(a){return En.circle(t,7,a)},s}ie(Gpe,"stateStart");async function Kpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=Rn.svg(s),p=Mn(t,{}),g=h.rectangle(c-8,u,o+16,l,p),y=h.line(c,u,c,u+l,p),v=h.line(c+o,u,c+o,u+l,p);s.insert(()=>y,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>g,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",To(w)),Dn(t,x)}else{const h=Hf(s,o,l,d);r&&h.attr("style",r),Dn(t,h)}return t.intersect=function(h){return En.polygon(t,d,h)},s}ie(Kpe,"subroutine");async function Ype(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,p=Rn.svg(s),g=Mn(t,{}),y=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const x=ss(y),w=p.path(x,g),S=ss(v),_=p.path(S,{...g,fillStyle:"solid"}),k=s.insert(()=>_,":first-child");return k.insert(()=>w,":first-child"),k.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),Dn(t,k),t.intersect=function(T){return En.polygon(t,y,T)},s}ie(Ype,"taggedRect");async function Zpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:p}=t,g=Rn.svg(s),y=Mn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...xp(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,S=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...xp(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],_=ss(v),k=g.path(_,y),T=ss(S),A=g.path(T,{...y,fillStyle:"solid"}),R=s.insert(()=>A,":first-child");return R.insert(()=>k,":first-child"),R.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&R.selectAll("path").attr("style",r),R.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Dn(t,R),t.intersect=function(M){return En.polygon(t,v,M)},s}ie(Zpe,"taggedWaveEdgedRectangle");async function Xpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),Dn(t,u),t.intersect=function(d){return En.rect(t,d)},s}ie(Xpe,"text");var Umt=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),qmt=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),Vmt=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function Jpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await yr(e,t,or(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:p}=t;let g;if(t.look==="handDrawn"){const y=Rn.svg(s),v=qmt(0,0,h,c,d,u),x=Vmt(0,0,h,c,d,u),w=y.path(v,Mn(t,{})),S=y.path(x,Mn(t,{fill:"none"}));g=s.insert(()=>S,":first-child"),g=s.insert(()=>w,":first-child"),g.attr("class","basic label-container"),p&&g.attr("style",p)}else{const y=Umt(0,0,h,c,d,u);g=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",To(p)).attr("style",r),g.attr("class","basic label-container"),p&&g.selectAll("path").attr("style",p),r&&g.selectAll("path").attr("style",r)}return g.attr("label-offset-x",d),g.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Dn(t,g),t.intersect=function(y){const v=En.rect(t,y),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,y.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(Jpe,"tiltedCylinder");async function Qpe(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=Rn.svg(s),h=Mn(t,{}),p=ss(l),g=d.path(p,h);c=s.insert(()=>g,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Hf(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Dn(t,c),t.intersect=function(d){return En.polygon(t,l,d)},s}ie(Qpe,"trapezoid");async function eme(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=Rn.svg(s),h=Mn(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const p=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],g=ss(p),y=d.path(g,h),v=s.insert(()=>y,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),Dn(t,v),t.intersect=function(x){return En.polygon(t,p,x)},s}ie(eme,"trapezoidalPentagon");async function tme(e,t){var w;const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=oa((w=fs().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,p=Rn.svg(s),g=Mn(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const y=ss(d),v=p.path(y,g),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,Dn(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(S){return qt.info("Triangle intersect",t,d,S),En.polygon(t,d,S)},s}ie(tme,"triangle");async function nme(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,p=70-o,g=p>0?p/2:0,y=Rn.svg(s),v=Mn(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-g,y:u/2},...xp(-o/2-g,u/2,o/2+g,u/2,c,.8),{x:o/2+g,y:-u/2},{x:-o/2-g,y:-u/2}],w=ss(x),S=y.path(w,v),_=s.insert(()=>S,":first-child");return _.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",r),_.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),Dn(t,_),t.intersect=function(k){return En.polygon(t,x,k)},s}ie(nme,"waveEdgedRectangle");async function rme(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await yr(e,t,or(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const p=Math.min(h*.2,h/4),g=h+p*2,{cssStyles:y}=t,v=Rn.svg(s),x=Mn(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:g/2},...xp(-d/2,g/2,d/2,g/2,p,1),{x:d/2,y:-g/2},...xp(d/2,-g/2,-d/2,-g/2,p,-1)],S=ss(w),_=v.path(S,x),k=s.insert(()=>_,":first-child");return k.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),Dn(t,k),t.intersect=function(T){return En.polygon(t,w,T)},s}ie(rme,"waveRectangle");async function sme(e,t){const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await yr(e,t,or(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,p=Rn.svg(s),g=Mn(t,{}),y=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const x=p.path(v,g),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),Dn(t,w),t.intersect=function(S){return En.polygon(t,y,S)},s}ie(sme,"windowPane");async function d8(e,t){var Y,B,G;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:Z}=il(),{background:ne}=Z,ae={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${ne}`]};await d8(e,ae)}const r=il();t.useHtmlLabels=r.htmlLabels;let s=((Y=r.er)==null?void 0:Y.diagramPadding)??10,i=((B=r.er)==null?void 0:B.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=Fn(t);if(n.attributes.length===0&&t.label){const Z={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};jf(t.label,r)+Z.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const ne=await S_(e,t,Z);if(!oa(r.htmlLabels)){const ae=ne.select("text"),le=(G=ae.node())==null?void 0:G.getBBox();ae.attr("transform",`translate(${-le.width/2}, 0)`)}return ne}r.htmlLabels||(s*=1.25,i*=1.25);let l=or(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await Q0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let p=0,g=0,y=0,v=0,x=!0,w=!0;for(const Z of n.attributes){const ne=await Q0(c,Z.type,r,0,d,["attribute-type"],o);p=Math.max(p,ne.width+s);const ae=await Q0(c,Z.name,r,0,d,["attribute-name"],o);g=Math.max(g,ae.width+s);const le=await Q0(c,Z.keys.join(),r,0,d,["attribute-keys"],o);y=Math.max(y,le.width+s);const Se=await Q0(c,Z.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,Se.width+s),d+=Math.max(ne.height,ae.height,le.height,Se.height)+i,h.push(d)}h.pop();let S=4;y<=s&&(x=!1,y=0,S--),v<=s&&(w=!1,v=0,S--);const _=c.node().getBBox();if(u.width+s*2-(p+g+y+v)>0){const Z=u.width+s*2-(p+g+y+v);p+=Z/S,g+=Z/S,y>0&&(y+=Z/S),v>0&&(v+=Z/S)}const k=p+g+y+v,T=Rn.svg(c),A=Mn(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const R=Math.max(_.width+s*2,(t==null?void 0:t.width)||0,k),M=Math.max(_.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),j=-R/2,F=-M/2;c.selectAll("g:not(:first-child)").each((Z,ne,ae)=>{const le=mr(ae[ne]),Se=le.attr("transform");let Ee=0,he=0;if(Se){const Le=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Se);Le&&(Ee=parseFloat(Le[1]),he=parseFloat(Le[2]),le.attr("class").includes("attribute-name")?Ee+=p:le.attr("class").includes("attribute-keys")?Ee+=p+g:le.attr("class").includes("attribute-comment")&&(Ee+=p+g+y))}le.attr("transform",`translate(${j+s/2+Ee}, ${he+F+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(F+i/2)+")");const P=T.rectangle(j,F,R,M,A),q=c.insert(()=>P,":first-child").attr("style",a.join("")),{themeVariables:I}=il(),{rowEven:V,rowOdd:D,nodeBorder:z}=I;h.push(0);for(const[Z,ne]of h.entries()){if(Z===0&&h.length>1)continue;const ae=Z%2===0&&ne!==0,le=T.rectangle(j,u.height+F+ne,R,u.height,{...A,fill:ae?V:D,stroke:z});c.insert(()=>le,"g.label").attr("style",a.join("")).attr("class",`row-rect-${Z%2===0?"even":"odd"}`)}let $=T.line(j,u.height+F,R+j,u.height+F,A);c.insert(()=>$).attr("class","divider"),$=T.line(p+j,u.height+F,p+j,M+F,A),c.insert(()=>$).attr("class","divider"),x&&($=T.line(p+g+j,u.height+F,p+g+j,M+F,A),c.insert(()=>$).attr("class","divider")),w&&($=T.line(p+g+y+j,u.height+F,p+g+y+j,M+F,A),c.insert(()=>$).attr("class","divider"));for(const Z of h)$=T.line(j,u.height+F+Z,R+j,u.height+F+Z,A),c.insert(()=>$).attr("class","divider");return Dn(t,q),t.intersect=function(Z){return En.rect(t,Z)},c}ie(d8,"erBox");async function Q0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==RG(t)&&(t=RG(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await Up(o,t,{width:jf(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(oa(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=mr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(Q0,"addText");async function ime(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",or(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,p=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await cw(o,{text:`${w}`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await cw(l,t,0,["font-weight: bolder"]);const g=l.node().getBBox();h=g.height,c=a.insert("g").attr("class","members-group text");let y=0;for(const w of t.members){const S=await cw(c,w,y,[w.parseClassifier()]);y+=S+i}p=c.node().getBBox().height,p<=0&&(p=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const S=await cw(u,w,v,[w.parseClassifier()]);v+=S+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-g.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(p?p+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(ime,"textHelper");async function cw(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=il();let a="useHtmlLabels"in t?t.useHtmlLabels:oa(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),Eb(o)&&(a=!0);const l=await Up(s,AL(qg(o)),{width:jf(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=mr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const p=d.getElementsByTagName("img");if(p){const g=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...p].map(y=>new Promise(v=>{function x(){var w;if(y.style.display="flex",y.style.flexDirection="column",g){const S=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,k=parseInt(S,10)*5+"px";y.style.minWidth=k,y.style.maxWidth=k}else y.style.width="100%";v(y)}ie(x,"setupImage"),setTimeout(()=>{y.complete&&x()}),y.addEventListener("error",x),y.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&mr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(cw,"addText");async function ame(e,t){var M,j;const n=fs(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??oa(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await ime(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=Fn(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((M=a.styles)==null?void 0:M.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((j=n.class)!=null&&j.hideEmptyMembersBox),p=Rn.svg(o),g=Mn(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const y=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-y/2,w=-v/2,S=p.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),y+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),g),_=o.insert(()=>S,":first-child");_.attr("class","basic label-container");const k=_.node().getBBox();o.selectAll(".text").each((F,P,q)=>{var Y;const I=mr(q[P]),V=I.attr("transform");let D=0;if(V){const G=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(V);G&&(D=parseFloat(G[2]))}let z=D+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(z-=4);let $=x;(I.attr("class").includes("label-group")||I.attr("class").includes("annotation-group"))&&($=-((Y=I.node())==null?void 0:Y.getBBox().width)/2||0,o.selectAll("text").each(function(B,G,Z){window.getComputedStyle(Z[G]).textAnchor==="middle"&&($=0)})),I.attr("transform",`translate(${$}, ${z})`)});const T=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,A=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,R=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const F=p.line(k.x,T+A+w+r,k.x+k.width,T+A+w+r,g);o.insert(()=>F).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const F=p.line(k.x,T+A+R+w+s*2+r,k.x+k.width,T+A+R+w+r+s*2,g);o.insert(()=>F).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),_.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const F=RegExp(/color\s*:\s*([^;]*)/),P=F.exec(d);if(P){const q=P[0].replace("color","fill");o.selectAll("tspan").attr("style",q)}else if(c){const q=F.exec(c);if(q){const I=q[0].replace("color","fill");o.selectAll("tspan").attr("style",I)}}}return Dn(t,_),t.intersect=function(F){return En.rect(t,F)},o}ie(ame,"classBox");async function ome(e,t){var T,A;const{labelStyles:n,nodeStyles:r}=Fn(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=or(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await Iu(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await Iu(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const p=await Iu(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=p+o,l){const R=await Iu(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=R;const M=await Iu(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=M;const j=await Iu(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=j,await Iu(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const R=await Iu(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=R,await Iu(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const g=(((T=u.node())==null?void 0:T.getBBox().width)??200)+a,y=(((A=u.node())==null?void 0:A.getBBox().height)??200)+a,v=-g/2,x=-y/2,w=Rn.svg(u),S=Mn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const _=w.rectangle(v,x,g,y,S),k=u.insert(()=>_,":first-child");if(k.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((R,M,j)=>{const F=mr(j[M]),P=F.attr("transform");let q=0,I=0;if(P){const $=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(P);$&&(q=parseFloat($[1]),I=parseFloat($[2]))}const V=I-y/2;let D=v+a/2;(M===0||M===1)&&(D=q),F.attr("transform",`translate(${D}, ${V+a})`)}),h>d+p+o){const R=w.line(v,x+d+p+o,v+g,x+d+p+o,S);u.insert(()=>R).attr("style",r)}return Dn(t,k),t.intersect=function(R){return En.rect(t,R)},u}ie(ome,"requirementBox");async function Iu(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=fs(),a=i.htmlLabels??!0,o=await Up(s,AL(qg(t)),{width:jf(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=mr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(Iu,"addText");var Wmt=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function lme(e,t,{config:n}){var P,q;const{labelStyles:r,nodeStyles:s}=Fn(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await yr(e,t,or(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((P=n==null?void 0:n.kanban)!=null&&P.ticketBaseUrl)&&(d=(q=n==null?void 0:n.kanban)==null?void 0:q.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const p={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let g,y;h?{label:g,bbox:y}=await SP(h,"ticket"in t&&t.ticket||"",p):{label:g,bbox:y}=await SP(o,"ticket"in t&&t.ticket||"",p);const{label:v,bbox:x}=await SP(o,"assigned"in t&&t.assigned||"",p);t.width=a;const w=10,S=(t==null?void 0:t.width)||0,_=Math.max(y.height,x.height)/2,k=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+_,T=-S/2,A=-k/2;c.attr("transform","translate("+(u-S/2)+", "+(-_-l.height/2)+")"),g.attr("transform","translate("+(u-S/2)+", "+(-_+l.height/2)+")"),v.attr("transform","translate("+(u+S/2-x.width-2*i)+", "+(-_+l.height/2)+")");let R;const{rx:M,ry:j}=t,{cssStyles:F}=t;if(t.look==="handDrawn"){const I=Rn.svg(o),V=Mn(t,{}),D=M||j?I.path(Wf(T,A,S,k,M||0),V):I.rectangle(T,A,S,k,V);R=o.insert(()=>D,":first-child"),R.attr("class","basic label-container").attr("style",F||null)}else{R=o.insert("rect",":first-child"),R.attr("class","basic label-container __APA__").attr("style",s).attr("rx",M??5).attr("ry",j??5).attr("x",T).attr("y",A).attr("width",S).attr("height",k);const I="priority"in t&&t.priority;if(I){const V=o.append("line"),D=T+2,z=A+Math.floor((M??0)/2),$=A+k-Math.floor((M??0)/2);V.attr("x1",D).attr("y1",z).attr("x2",D).attr("y2",$).attr("stroke-width","4").attr("stroke",Wmt(I))}}return Dn(t,R),t.height=k,t.intersect=function(I){return En.rect(t,I)},o}ie(lme,"kanbanItem");var Hmt=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:qpe},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Bpe},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Vpe},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Kpe},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:hpe},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:ape},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Fpe},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:xpe},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Rpe},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Npe},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Qpe},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Tpe},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:mpe},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Xpe},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:spe},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:zpe},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Gpe},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:Hpe},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:bpe},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:wpe},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:cpe},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:upe},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:dpe},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Ipe},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:nme},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:vpe},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Jpe},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Mpe},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:fpe},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:ppe},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:tme},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:sme},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:gpe},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:eme},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:ype},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Upe},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Ope},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Ppe},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:rpe},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:lpe},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Zpe},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Ype},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:rme},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Lpe},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:jpe}],Gmt=ie(()=>{const t=[...Object.entries({state:Wpe,choice:ipe,note:Dpe,rectWithTitle:$pe,labelRect:Ape,iconSquare:kpe,iconCircle:_pe,icon:Spe,iconRounded:Cpe,imageSquare:Epe,anchor:npe,kanbanItem:lme,classBox:ame,erBox:d8,requirementBox:ome}),...Hmt.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),cme=Gmt();function Kmt(e){return e in cme}ie(Kmt,"isValidShape");var GN=new Map;async function ume(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?cme[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),GN.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(ume,"insertNode");var Kvt=ie((e,t)=>{GN.set(t.id,e)},"setNodeElem"),Yvt=ie(()=>{GN.clear()},"clear"),Zvt=ie(e=>{const t=GN.get(e.id);qt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),Ymt=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&xK(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&xK(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),Zmt={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},xK=ie((e,t,n,r,s,i,a)=>{var d;const o=Zmt[n];if(!o){qt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),p=`${u}_${h}`;if(!document.getElementById(p)){const g=document.getElementById(u);if(g){const y=g.cloneNode(!0);y.id=p,y.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=g.parentNode)==null||d.appendChild(y)}}e.attr(`marker-${t}`,`url(${r}#${p})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),TT=new Map,Pa=new Map,Xvt=ie(()=>{TT.clear(),Pa.clear()},"clear"),Vx=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),Xmt=ie(async(e,t)=>{let n=oa(fs().flowchart.htmlLabels);const r=await Up(e,t.label,{style:Vx(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});qt.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=mr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),TT.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await qm(t.startLabelLeft,Vx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),Pa.get(t.id)||Pa.set(t.id,{}),Pa.get(t.id).startLeft=c,uw(o,t.startLabelLeft)}if(t.startLabelRight){const l=await qm(t.startLabelRight,Vx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),Pa.get(t.id)||Pa.set(t.id,{}),Pa.get(t.id).startRight=c,uw(o,t.startLabelRight)}if(t.endLabelLeft){const l=await qm(t.endLabelLeft,Vx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),Pa.get(t.id)||Pa.set(t.id,{}),Pa.get(t.id).endLeft=c,uw(o,t.endLabelLeft)}if(t.endLabelRight){const l=await qm(t.endLabelRight,Vx(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),Pa.get(t.id)||Pa.set(t.id,{}),Pa.get(t.id).endRight=c,uw(o,t.endLabelRight)}return r},"insertEdgeLabel");function uw(e,t){fs().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(uw,"setTerminalWidth");var Jmt=ie((e,t)=>{qt.debug("Moving label abc88 ",e.id,e.label,TT.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=fs(),{subGraphTitleTotalMargin:s}=DL(r);if(e.label){const i=TT.get(e.id);let a=e.x,o=e.y;if(n){const l=qu.calcLabelPosition(n);qt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=Pa.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=qu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=Pa.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=qu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=Pa.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=qu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=Pa.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=qu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),Qmt=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),egt=ie((e,t,n)=>{qt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),qt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,p=n.y<t.y?n.y+d:n.y-d;return qt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:p}),o===0&&(h=t.x,p=t.y),u===0&&(h=t.x),c===0&&(p=t.y),{x:h,y:p}}},"intersection"),wK=ie((e,t)=>{qt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(qt.info("abc88 checking point",i,t),!Qmt(t,i)&&!s){const a=egt(t,r,i);qt.debug("abc88 inside",i,r,a),qt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?qt.warn("abc88 no intersect",a,n):n.push(a),s=!0}else qt.warn("abc88 outside",i,r),r=i,s||n.push(i)}),qt.debug("returning points",n),n},"cutPathAtIntersect");function dme(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(dme,"extractCornerPoints");var SK=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),tgt=ie(function(e){const{cornerPointPositions:t}=dme(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=SK(s,a,5),l=SK(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){qt.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const p=5;a.x===o.x?h={x:c<0?o.x-p+d:o.x+p-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-p+d:o.y+p-d}}else qt.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),ngt=ie(function(e,t,n,r,s,i,a){var M;const{handDrawnSeed:o}=fs();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const j in t.cssCompiledStyles)Ghe(j)||h.push(t.cssCompiledStyles[j]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),qt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(qt.info("to cluster abc88",n.get(t.toCluster)),l=wK(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(qt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=wK(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let p=l.filter(j=>!Number.isNaN(j.y));p=tgt(p);let g=fk;switch(g=dT,t.curve){case"linear":g=dT;break;case"basis":g=fk;break;case"cardinal":g=Pfe;break;case"bumpX":g=Nfe;break;case"bumpY":g=Rfe;break;case"catmullRom":g=Dfe;break;case"monotoneX":g=Ufe;break;case"monotoneY":g=qfe;break;case"natural":g=Wfe;break;case"step":g=Hfe;break;case"stepAfter":g=Kfe;break;case"stepBefore":g=Gfe;break;default:g=fk}const{x:y,y:v}=$ut(t),x=vdt().x(y).y(v).curve(g);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let S,_=x(p);const k=Array.isArray(t.style)?t.style:[t.style];let T=k.find(j=>j==null?void 0:j.startsWith("stroke:"));if(t.look==="handDrawn"){const j=Rn.svg(e);Object.assign([],p);const F=j.path(_,{roughness:.3,seed:o});w+=" transition",S=mr(F).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",k?k.reduce((q,I)=>q+";"+I,""):"");let P=S.attr("d");S.attr("d",P),e.node().appendChild(S.node())}else{const j=h.join(";"),F=k?k.reduce((I,V)=>I+V+";",""):"";let P="";t.animate&&(P=" edge-animation-fast"),t.animation&&(P=" edge-animation-"+t.animation);const q=j?j+";"+F+";":F;S=e.append("path").attr("d",_).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(P??"")).attr("style",q),T=(M=q.match(/stroke:([^;]+)/))==null?void 0:M[1]}let A="";(fs().flowchart.arrowMarkerAbsolute||fs().state.arrowMarkerAbsolute)&&(A=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,A=A.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),qt.info("arrowTypeStart",t.arrowTypeStart),qt.info("arrowTypeEnd",t.arrowTypeEnd),Ymt(S,t,A,a,r,T);let R={};return c&&(R.updatedPath=l),R.originalPath=t.points,R},"insertEdge"),rgt=ie((e,t,n,r)=>{t.forEach(s=>{vgt[s](e,n,r)})},"insertMarkers"),sgt=ie((e,t,n)=>{qt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),igt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),agt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),ogt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),lgt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),cgt=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),ugt=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),dgt=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),fgt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),hgt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),pgt=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),mgt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),ggt=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),ygt=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),bgt=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),vgt={extension:sgt,composition:igt,aggregation:agt,dependency:ogt,lollipop:lgt,point:cgt,circle:ugt,cross:dgt,barb:fgt,only_one:hgt,zero_or_one:pgt,one_or_more:mgt,zero_or_more:ggt,requirement_arrow:ygt,requirement_contains:bgt},xgt=rgt,wgt={common:fv,getConfig:il,insertCluster:Nmt,insertEdge:ngt,insertEdgeLabel:Xmt,insertMarkers:xgt,insertNode:ume,interpolateToCurve:HL,labelHelper:yr,log:qt,positionEdgeLabel:Jmt},cS={},fme=ie(e=>{for(const t of e)cS[t.name]=t},"registerLayoutLoaders"),Sgt=ie(()=>{fme([{name:"dagre",loader:ie(async()=>await zr(()=>import("./dagre-OKDRZEBW-Cd3wF-to.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");Sgt();var Jvt=ie(async(e,t)=>{if(!(e.layoutAlgorithm in cS))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=cS[e.layoutAlgorithm];return(await n.loader()).render(e,t,wgt,{algorithm:n.algorithm})},"render"),Qvt=ie((e="",{fallback:t="dagre"}={})=>{if(e in cS)return e;if(t in cS)return qt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),_K={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},_gt=ie(e=>{var s;const{securityLevel:t}=fs();let n=mr("body");if(t==="sandbox"){const a=((s=mr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=mr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),hme="comm",pme="rule",mme="decl",Cgt="@import",kgt="@namespace",Egt="@keyframes",Tgt="@layer",gme=Math.abs,f8=String.fromCharCode;function yme(e){return e.trim()}function gk(e,t,n){return e.replace(t,n)}function Agt(e,t,n){return e.indexOf(t,n)}function Ny(e,t){return e.charCodeAt(t)|0}function Nb(e,t,n){return e.slice(t,n)}function Du(e){return e.length}function Ngt(e){return e.length}function L2(e,t){return t.push(e),e}var KN=1,Rb=1,bme=0,xc=0,Hi=0,yv="";function h8(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:KN,column:Rb,length:a,return:"",siblings:o}}function Rgt(){return Hi}function Igt(){return Hi=xc>0?Ny(yv,--xc):0,Rb--,Hi===10&&(Rb=1,KN--),Hi}function Qc(){return Hi=xc<bme?Ny(yv,xc++):0,Rb++,Hi===10&&(Rb=1,KN++),Hi}function Gh(){return Ny(yv,xc)}function yk(){return xc}function YN(e,t){return Nb(yv,e,t)}function uS(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Mgt(e){return KN=Rb=1,bme=Du(yv=e),xc=0,[]}function jgt(e){return yv="",e}function _P(e){return yme(YN(xc-1,vD(e===91?e+2:e===40?e+1:e)))}function Pgt(e){for(;(Hi=Gh())&&Hi<33;)Qc();return uS(e)>2||uS(Hi)>3?"":" "}function Ogt(e,t){for(;--t&&Qc()&&!(Hi<48||Hi>102||Hi>57&&Hi<65||Hi>70&&Hi<97););return YN(e,yk()+(t<6&&Gh()==32&&Qc()==32))}function vD(e){for(;Qc();)switch(Hi){case e:return xc;case 34:case 39:e!==34&&e!==39&&vD(Hi);break;case 40:e===41&&vD(e);break;case 92:Qc();break}return xc}function Dgt(e,t){for(;Qc()&&e+Hi!==57;)if(e+Hi===84&&Gh()===47)break;return"/*"+YN(t,xc-1)+"*"+f8(e===47?e:Qc())}function Fgt(e){for(;!uS(Gh());)Qc();return YN(e,xc)}function Lgt(e){return jgt(bk("",null,null,null,[""],e=Mgt(e),0,[0],e))}function bk(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,p=0,g=0,y=1,v=1,x=1,w=0,S="",_=s,k=i,T=r,A=S;v;)switch(g=w,w=Qc()){case 40:if(g!=108&&Ny(A,d-1)==58){Agt(A+=gk(_P(w),"&","&\f"),"&\f",gme(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:A+=_P(w);break;case 9:case 10:case 13:case 32:A+=Pgt(g);break;case 92:A+=Ogt(yk()-1,7);continue;case 47:switch(Gh()){case 42:case 47:L2($gt(Dgt(Qc(),yk()),t,n,l),l),(uS(g||1)==5||uS(Gh()||1)==5)&&Du(A)&&Nb(A,-1,void 0)!==" "&&(A+=" ");break;default:A+="/"}break;case 123*y:o[c++]=Du(A)*x;case 125*y:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(A=gk(A,/\f/g,"")),p>0&&(Du(A)-d||y===0&&g===47)&&L2(p>32?kK(A+";",r,n,d-1,l):kK(gk(A," ","")+";",r,n,d-2,l),l);break;case 59:A+=";";default:if(L2(T=CK(A,t,n,c,u,s,o,S,_=[],k=[],d,i),i),w===123)if(u===0)bk(A,t,T,T,_,i,d,o,k);else{switch(h){case 99:if(Ny(A,3)===110)break;case 108:if(Ny(A,2)===97)break;default:u=0;case 100:case 109:case 115:}u?bk(e,T,T,r&&L2(CK(e,T,T,0,0,s,o,S,s,_=[],d,k),k),s,k,d,o,r?_:k):bk(A,T,T,T,[""],k,0,o,k)}}c=u=p=0,y=x=1,S=A="",d=a;break;case 58:d=1+Du(A),p=g;default:if(y<1){if(w==123)--y;else if(w==125&&y++==0&&Igt()==125)continue}switch(A+=f8(w),w*y){case 38:x=u>0?1:(A+="\f",-1);break;case 44:o[c++]=(Du(A)-1)*x,x=1;break;case 64:Gh()===45&&(A+=_P(Qc())),h=Gh(),u=d=Du(S=A+=Fgt(yk())),w++;break;case 45:g===45&&Du(A)==2&&(y=0)}}return i}function CK(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,p=s===0?i:[""],g=Ngt(p),y=0,v=0,x=0;y<r;++y)for(var w=0,S=Nb(e,h+1,h=gme(v=a[y])),_=e;w<g;++w)(_=yme(v>0?p[w]+" "+S:gk(S,/&\f/g,p[w])))&&(l[x++]=_);return h8(e,t,n,s===0?pme:o,l,c,u,d)}function $gt(e,t,n,r){return h8(e,t,n,hme,f8(Rgt()),Nb(e,2,-2),0,r)}function kK(e,t,n,r,s){return h8(e,t,n,mme,Nb(e,0,r),Nb(e,r+1,-1),r,s)}function xD(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function Bgt(e,t,n,r){switch(e.type){case Tgt:if(e.children.length)break;case Cgt:case kgt:case mme:return e.return=e.return||e.value;case hme:return"";case Egt:return e.return=e.value+"{"+xD(e.children,r)+"}";case pme:if(!Du(e.value=e.props.join(",")))return""}return Du(n=xD(e.children,r))?e.return=e.value+"{"+n+"}":""}var zgt=Jfe(Object.keys,Object),Ugt=Object.prototype,qgt=Ugt.hasOwnProperty;function Vgt(e){if(!$N(e))return zgt(e);var t=[];for(var n in Object(e))qgt.call(e,n)&&n!="constructor"&&t.push(n);return t}var wD=Ug(Cd,"DataView"),SD=Ug(Cd,"Promise"),_D=Ug(Cd,"Set"),CD=Ug(Cd,"WeakMap"),EK="[object Map]",Wgt="[object Object]",TK="[object Promise]",AK="[object Set]",NK="[object WeakMap]",RK="[object DataView]",Hgt=zg(wD),Ggt=zg(lS),Kgt=zg(SD),Ygt=zg(_D),Zgt=zg(CD),Am=hv;(wD&&Am(new wD(new ArrayBuffer(1)))!=RK||lS&&Am(new lS)!=EK||SD&&Am(SD.resolve())!=TK||_D&&Am(new _D)!=AK||CD&&Am(new CD)!=NK)&&(Am=function(e){var t=hv(e),n=t==Wgt?e.constructor:void 0,r=n?zg(n):"";if(r)switch(r){case Hgt:return RK;case Ggt:return EK;case Kgt:return TK;case Ygt:return AK;case Zgt:return NK}return t});var Xgt="[object Map]",Jgt="[object Set]",Qgt=Object.prototype,e0t=Qgt.hasOwnProperty;function IK(e){if(e==null)return!0;if(BN(e)&&(bT(e)||typeof e=="string"||typeof e.splice=="function"||VL(e)||WL(e)||yT(e)))return!e.length;var t=Am(e);if(t==Xgt||t==Jgt)return!e.size;if($N(e))return!Vgt(e).length;for(var n in e)if(e0t.call(e,n))return!1;return!0}var vme="c4",t0t=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),n0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-CbWfQgx6.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:vme,diagram:e}},"loader"),r0t={id:vme,detector:t0t,loader:n0t},s0t=r0t,xme="flowchart",i0t=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),a0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-ox3wVZnH.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:xme,diagram:e}},"loader"),o0t={id:xme,detector:i0t,loader:a0t},l0t=o0t,wme="flowchart-v2",c0t=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),u0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-ox3wVZnH.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:wme,diagram:e}},"loader"),d0t={id:wme,detector:c0t,loader:u0t},f0t=d0t,Sme="er",h0t=ie(e=>/^\s*erDiagram/.test(e),"detector"),p0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-ClW3W3Lm.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:Sme,diagram:e}},"loader"),m0t={id:Sme,detector:h0t,loader:p0t},g0t=m0t,_me="gitGraph",y0t=ie(e=>/^\s*gitGraph/.test(e),"detector"),b0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-CdS0MeYr.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:_me,diagram:e}},"loader"),v0t={id:_me,detector:y0t,loader:b0t},x0t=v0t,Cme="gantt",w0t=ie(e=>/^\s*gantt/.test(e),"detector"),S0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-Dbdq55u7.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:Cme,diagram:e}},"loader"),_0t={id:Cme,detector:w0t,loader:S0t},C0t=_0t,kme="info",k0t=ie(e=>/^\s*info/.test(e),"detector"),E0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-DlL3HGUv.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:kme,diagram:e}},"loader"),T0t={id:kme,detector:k0t,loader:E0t},Eme="pie",A0t=ie(e=>/^\s*pie/.test(e),"detector"),N0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-DbXs6uhO.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:Eme,diagram:e}},"loader"),R0t={id:Eme,detector:A0t,loader:N0t},Tme="quadrantChart",I0t=ie(e=>/^\s*quadrantChart/.test(e),"detector"),M0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-DYYH9nmp.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:Tme,diagram:e}},"loader"),j0t={id:Tme,detector:I0t,loader:M0t},P0t=j0t,Ame="xychart",O0t=ie(e=>/^\s*xychart-beta/.test(e),"detector"),D0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-kHLixIrq.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:Ame,diagram:e}},"loader"),F0t={id:Ame,detector:O0t,loader:D0t},L0t=F0t,Nme="requirement",$0t=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),B0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-C3HUqf4M.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:Nme,diagram:e}},"loader"),z0t={id:Nme,detector:$0t,loader:B0t},U0t=z0t,Rme="sequence",q0t=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),V0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-DFrBYG9V.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:Rme,diagram:e}},"loader"),W0t={id:Rme,detector:q0t,loader:V0t},H0t=W0t,Ime="class",G0t=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),K0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-DPOFCsq0.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:Ime,diagram:e}},"loader"),Y0t={id:Ime,detector:G0t,loader:K0t},Z0t=Y0t,Mme="classDiagram",X0t=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),J0t=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-DPOFCsq0.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:Mme,diagram:e}},"loader"),Q0t={id:Mme,detector:X0t,loader:J0t},eyt=Q0t,jme="state",tyt=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),nyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-B02l0ZUW.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:jme,diagram:e}},"loader"),ryt={id:jme,detector:tyt,loader:nyt},syt=ryt,Pme="stateDiagram",iyt=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),ayt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-BLG6zomh.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:Pme,diagram:e}},"loader"),oyt={id:Pme,detector:iyt,loader:ayt},lyt=oyt,Ome="journey",cyt=ie(e=>/^\s*journey/.test(e),"detector"),uyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-CfDj_deJ.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:Ome,diagram:e}},"loader"),dyt={id:Ome,detector:cyt,loader:uyt},fyt=dyt,hyt=ie((e,t,n)=>{qt.debug(`rendering svg for syntax error
`);const r=_gt(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),zue(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),Dme={draw:hyt},pyt=Dme,myt={db:{},renderer:Dme,parser:{parse:ie(()=>{},"parse")}},gyt=myt,Fme="flowchart-elk",yyt=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),byt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-ox3wVZnH.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Fme,diagram:e}},"loader"),vyt={id:Fme,detector:yyt,loader:byt},xyt=vyt,Lme="timeline",wyt=ie(e=>/^\s*timeline/.test(e),"detector"),Syt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-D3dihuQl.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:Lme,diagram:e}},"loader"),_yt={id:Lme,detector:wyt,loader:Syt},Cyt=_yt,$me="mindmap",kyt=ie(e=>/^\s*mindmap/.test(e),"detector"),Eyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-DOPmOc00.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:$me,diagram:e}},"loader"),Tyt={id:$me,detector:kyt,loader:Eyt},Ayt=Tyt,Bme="kanban",Nyt=ie(e=>/^\s*kanban/.test(e),"detector"),Ryt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-BU46bfXI.js");return{diagram:t}},[]);return{id:Bme,diagram:e}},"loader"),Iyt={id:Bme,detector:Nyt,loader:Ryt},Myt=Iyt,zme="sankey",jyt=ie(e=>/^\s*sankey-beta/.test(e),"detector"),Pyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-CMxqnjlT.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:zme,diagram:e}},"loader"),Oyt={id:zme,detector:jyt,loader:Pyt},Dyt=Oyt,Ume="packet",Fyt=ie(e=>/^\s*packet-beta/.test(e),"detector"),Lyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-CGL2XTgy.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:Ume,diagram:e}},"loader"),$yt={id:Ume,detector:Fyt,loader:Lyt},qme="radar",Byt=ie(e=>/^\s*radar-beta/.test(e),"detector"),zyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-DPdNGNxT.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:qme,diagram:e}},"loader"),Uyt={id:qme,detector:Byt,loader:zyt},Vme="block",qyt=ie(e=>/^\s*block-beta/.test(e),"detector"),Vyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC--lRDJLLV.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:Vme,diagram:e}},"loader"),Wyt={id:Vme,detector:qyt,loader:Vyt},Hyt=Wyt,Wme="architecture",Gyt=ie(e=>/^\s*architecture/.test(e),"detector"),Kyt=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-BSAl4fw0.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:Wme,diagram:e}},"loader"),Yyt={id:Wme,detector:Gyt,loader:Kyt},Zyt=Yyt,MK=!1,ZN=ie(()=>{MK||(MK=!0,rT("error",gyt,e=>e.toLowerCase().trim()==="error"),rT("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),Aue(s0t,Myt,eyt,Z0t,g0t,C0t,T0t,R0t,U0t,H0t,xyt,f0t,l0t,Ayt,Cyt,x0t,lyt,syt,fyt,P0t,Dyt,$yt,L0t,Hyt,Zyt,Uyt))},"addDiagrams"),Xyt=ie(async()=>{qt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(_b).map(async([n,{detector:r,loader:s}])=>{if(s)try{qO(n)}catch{try{const{diagram:i,id:a}=await s();rT(a,i,r)}catch(i){throw qt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete _b[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){qt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)qt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),Jyt="graphics-document document";function Hme(e,t){e.attr("role",Jyt),t!==""&&e.attr("aria-roledescription",t)}ie(Hme,"setA11yDiagramInfo");function Gme(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(Gme,"addSVGa11yTitleDescription");var Zm,kD=(Zm=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=il(),s=SL(t,r);t=vpt(t)+`
`;try{qO(s)}catch{const d=$lt(s);if(!d)throw new Tue(`Diagram ${s} not found.`);const{id:h,diagram:p}=await d();rT(h,p)}const{db:i,parser:a,renderer:o,init:l}=qO(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new Zm(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(Zm,"Diagram"),Zm),jK=[],Qyt=ie(()=>{jK.forEach(e=>{e()}),jK=[]},"attachFunctions"),ebt=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function Kme(e){const t=e.match(Eue);if(!t)return{text:e,metadata:{}};let n=Lut(t[1],{schema:Fut})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(Kme,"extractFrontMatter");var tbt=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),nbt=ie(e=>{const{text:t,metadata:n}=Kme(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),rbt=ie(e=>{const t=qu.detectInit(e)??{},n=qu.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:apt(e),directive:t}},"processDirectives");function p8(e){const t=tbt(e),n=nbt(t),r=rbt(n.text),s=XL(n.config,r.directive);return e=ebt(r.text),{code:e,title:n.title,config:s}}ie(p8,"preprocessDiagram");function Yme(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(Yme,"toBase64");var sbt=5e4,ibt="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",abt="sandbox",obt="loose",lbt="http://www.w3.org/2000/svg",cbt="http://www.w3.org/1999/xlink",ubt="http://www.w3.org/1999/xhtml",dbt="100%",fbt="100%",hbt="border:0;margin:0;",pbt="margin:0",mbt="allow-top-navigation-by-user-activation allow-popups",gbt='The "iframe" tag is not supported by your browser.',ybt=["foreignobject"],bbt=["dominant-baseline"];function m8(e){const t=p8(e);return tT(),tct(t.config??{}),t}ie(m8,"processAndSetConfigs");async function Zme(e,t){ZN();try{const{code:n,config:r}=m8(e);return{diagramType:(await Jme(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(Zme,"parse");var PK=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),vbt=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{IK(l.styles)||o.forEach(c=>{n+=PK(l.id,c,l.styles)}),IK(l.textStyles)||(n+=PK(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),xbt=ie((e,t,n,r)=>{const s=vbt(e,n),i=xct(t,s,e.themeVariables);return xD(Lgt(`${r}{${i}}`),Bgt)},"createUserStyles"),wbt=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=qg(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),Sbt=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":fbt,r=Yme(`<body style="${pbt}">${e}</body>`);return`<iframe style="width:${dbt};height:${n};${hbt}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${mbt}">
  ${gbt}
</iframe>`},"putIntoIFrame"),OK=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",lbt);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function ED(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(ED,"sandboxedIframe");var _bt=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),Cbt=ie(async function(e,t,n){var P,q,I,V,D,z;ZN();const r=m8(t);t=r.code;const s=il();qt.debug(s),t.length>((s==null?void 0:s.maxTextSize)??sbt)&&(t=ibt);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const Y=mr(h?o:c).node();Y&&"remove"in Y&&Y.remove()},"removeTempElements");let d=mr("body");const h=s.securityLevel===abt,p=s.securityLevel===obt,g=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const $=ED(mr(n),a);d=mr($.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=mr(n);OK(d,e,l,`font-family: ${g}`,cbt)}else{if(_bt(document,e,l,a),h){const $=ED(mr("body"),a);d=mr($.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=mr("body");OK(d,e,l)}let y,v;try{y=await kD.fromText(t,{title:r.title})}catch($){if(s.suppressErrorRendering)throw u(),$;y=await kD.fromText("error"),v=$}const x=d.select(c).node(),w=y.type,S=x.firstChild,_=S.firstChild,k=(q=(P=y.renderer).getClasses)==null?void 0:q.call(P,t,y),T=xbt(s,w,k,i),A=document.createElement("style");A.innerHTML=T,S.insertBefore(A,_);try{await y.renderer.draw(t,e,_K.version,y)}catch($){throw s.suppressErrorRendering?u():pyt.draw(t,e,_K.version),$}const R=d.select(`${c} svg`),M=(V=(I=y.db).getAccTitle)==null?void 0:V.call(I),j=(z=(D=y.db).getAccDescription)==null?void 0:z.call(D);Qme(w,R,M,j),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",ubt);let F=d.select(c).node().innerHTML;if(qt.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),F=wbt(F,h,oa(s.arrowMarkerAbsolute)),h){const $=d.select(c+" svg").node();F=Sbt(F,$)}else p||(F=Sb.sanitize(F,{ADD_TAGS:ybt,ADD_ATTR:bbt,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(Qyt(),v)throw v;return u(),{diagramType:w,svg:F,bindFunctions:y.db.bindFunctions}},"render");function Xme(e={}){var r;const t=La({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),Qlt(t),t!=null&&t.theme&&t.theme in wf?t.themeVariables=wf[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=wf.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?Jlt(t):Pue();wL(n.logLevel),ZN()}ie(Xme,"initialize");var Jme=ie((e,t={})=>{const{code:n}=p8(e);return kD.fromText(n,t)},"getDiagramFromText");function Qme(e,t,n,r){Hme(t,e),Gme(t,n,r,t.attr("id"))}ie(Qme,"addA11yInfo");var xg=Object.freeze({render:Cbt,parse:Zme,getDiagramFromText:Jme,initialize:Xme,getConfig:il,setConfig:Oue,getSiteConfig:Pue,updateSiteConfig:ect,reset:ie(()=>{tT()},"reset"),globalReset:ie(()=>{tT(Cb)},"globalReset"),defaultConfig:Cb});wL(il().logLevel);tT(il());var kbt=ie((e,t,n)=>{qt.warn(e),ZL(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),ege=ie(async function(e={querySelector:".mermaid"}){try{await Ebt(e)}catch(t){if(ZL(t)&&qt.error(t.str),Ml.parseError&&Ml.parseError(t),!e.suppressErrors)throw qt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),Ebt=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=xg.getConfig();qt.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");qt.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(qt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),xg.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new qu.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(qt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=Ahe(qu.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=qu.detectInit(a);u&&qt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await sge(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){kbt(d,o,Ml.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),tge=ie(function(e){xg.initialize(e)},"initialize"),Tbt=ie(async function(e,t,n){qt.warn("mermaid.init is deprecated. Please use run instead."),e&&tge(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await ege(r)},"init"),Abt=ie(async(e,{lazyLoad:t=!0}={})=>{ZN(),Aue(...e),t===!1&&await Xyt()},"registerExternalDiagrams"),nge=ie(function(){if(Ml.startOnLoad){const{startOnLoad:e}=xg.getConfig();e&&Ml.run().catch(t=>qt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",nge,!1);var Nbt=ie(function(e){Ml.parseError=e},"setParseErrorHandler"),AT=[],CP=!1,rge=ie(async()=>{if(!CP){for(CP=!0;AT.length>0;){const e=AT.shift();if(e)try{await e()}catch(t){qt.error("Error executing queue",t)}}CP=!1}},"executeQueue"),Rbt=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{xg.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;qt.error("Error parsing",o),(l=Ml.parseError)==null||l.call(Ml,o),a(o),r(o)})}),"performCall");AT.push(s),rge().catch(r)}),"parse"),sge=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{xg.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;qt.error("Error parsing",l),(c=Ml.parseError)==null||c.call(Ml,l),o(l),s(l)})}),"performCall");AT.push(i),rge().catch(s)}),"render"),Ml={startOnLoad:!0,mermaidAPI:xg,parse:Rbt,render:sge,init:Tbt,run:ege,registerExternalDiagrams:Abt,registerLayoutLoaders:fme,initialize:tge,parseError:void 0,contentLoaded:nge,setParseErrorHandler:Nbt,detectType:SL,registerIconPacks:odt},Ibt=Ml;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const Mbt=new DOMParser,jbt=new XMLSerializer;function DK(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let FK=0;const Pbt=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${FK}`;FK+=1;const{svg:a}=await Ibt.render(i,s,n),o=Mbt.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=DK(l,"aria-describedby"),h=DK(l,"aria-labelledby"),p={height:c,id:i,svg:jbt.serializeToString(l),width:u};return d&&(p.description=d),h&&(p.title=h),p}));return n.remove(),r},Obt=()=>Pbt,Dbt=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=gr(pn(T=>({foldStreamingCodeBlocks:T.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),p=E.useRef(null),g=Ni(pn(T=>Object.values(T.canvasControls))),y=E.useCallback((T,A,R,M,j)=>g.filter(F=>F.type==="codeblock"&&F.targetSlot===T&&F.renderer).map(F=>{if(F.renderer){const P={codeBlockContent:A,codeBlockLang:"mermaid",isFolded:M,toggleFold:j,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:F.renderer(P)},F.id)}return null}).filter(Boolean),[g]),v=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const A=await Obt()([e]);if(A.length>0&&A[0].status==="fulfilled")a(A[0].value.svg);else if(A.length>0&&A[0].status==="rejected"){const R=A[0].reason;u((R==null?void 0:R.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(T){console.error("Mermaid rendering error:",T),u(T instanceof Error?T.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&v()},[e,r,d,v]);const x=()=>{const T=r;s(A=>!A),T&&!d&&setTimeout(v,0)},w=E.useCallback(async()=>{if(!i){ke.error("No SVG content to download");return}try{const T=new Blob([i],{type:"image/svg+xml"}),A=URL.createObjectURL(T),R=document.createElement("a");R.href=A,R.download="mermaid-diagram.svg",document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(A),ke.success("SVG downloaded successfully!")}catch(T){console.error("Download error:",T),ke.error("Failed to download SVG")}},[i]),S=E.useCallback(()=>{h(T=>!T)},[]),_=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),k=y("codeblock-header-actions",e,"mermaid",r,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:k})]}),f.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:S,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show diagram":"Show code",children:d?f.jsx(sd,{className:"h-4 w-4"}):f.jsx(fS,{className:"h-4 w-4"})}),i&&!d&&f.jsx("button",{onClick:w,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:"Download SVG",children:f.jsx(cc,{className:"h-4 w-4"})})]})]}),!r&&!t&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(EN,{lang:"mermaid",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Yn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(No,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:p,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]})}),(r||t)&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:_})})]})},Fbt=E.memo(Dbt);class Lbt{constructor(){ue(this,"id","core-block-renderer-mermaid");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["mermaid"],priority:10,renderer:r=>We.createElement(Fbt,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}class $bt{async parse(t){try{const n=t.trim();if(!n)return{success:!1,error:"Empty flow content"};let r;try{r=JSON.parse(n)}catch(i){return{success:!1,error:`Invalid JSON format: ${i instanceof Error?i.message:"Unknown error"}`}}const s=await this.validate(n);return s.success?{success:!0,data:r}:s}catch(n){return{success:!1,error:`Parse error: ${n instanceof Error?n.message:"Unknown error"}`}}}async validate(t){try{const n=JSON.parse(t.trim());if(!n.type)return{success:!1,error:"Missing required field: type"};if(!Array.isArray(n.nodes))return{success:!1,error:"Missing or invalid field: nodes (must be array)"};if(!Array.isArray(n.edges))return{success:!1,error:"Missing or invalid field: edges (must be array)"};for(let s=0;s<n.nodes.length;s++){const i=n.nodes[s],a=this.validateNode(i,s);if(a)return{success:!1,error:a}}const r=new Set;n.nodes.forEach(s=>{typeof s.id=="string"&&r.add(s.id)});for(let s=0;s<n.edges.length;s++){const i=n.edges[s],a=this.validateEdge(i,r,s);if(a)return{success:!1,error:a}}return{success:!0,data:n}}catch(n){return{success:!1,error:`Validation error: ${n instanceof Error?n.message:"Unknown error"}`}}}serialize(t){return JSON.stringify(t,null,2)}validateNode(t,n){if(!t.id)return`Node ${n}: Missing required field: id`;if(typeof t.id!="string")return`Node ${n}: Field 'id' must be a string`;if(!t.type)return`Node ${n}: Missing required field: type`;const r=["trigger","prompt","agent-task","transform","human-in-the-loop","custom","input","output","default","group"];if(!r.includes(t.type))return`Node ${n}: Invalid type '${t.type}'. Must be one of: ${r.join(", ")}`;if(!t.label)return`Node ${n}: Missing required field: label`;if(!t.position||typeof t.position!="object")return`Node ${n}: Missing or invalid field: position (must be object)`;if(typeof t.position.x!="number"||typeof t.position.y!="number")return`Node ${n}: Position must have numeric x and y coordinates`;if(t.status){const s=["pending","running","success","error"];if(!s.includes(t.status))return`Node ${n}: Invalid status '${t.status}'. Must be one of: ${s.join(", ")}`}if(t.style&&typeof t.style!="object")return`Node ${n}: Style must be an object`;if(t.style){const s=["background","backgroundColor","color","border","borderColor","borderWidth","borderRadius","width","height","minWidth","minHeight","maxWidth","maxHeight","padding","margin","fontSize","fontWeight","opacity","boxShadow"];for(const i in t.style)if(!s.includes(i))return`Node ${n}: Invalid style property '${i}'. Valid properties: ${s.join(", ")}`}return t.className&&typeof t.className!="string"?`Node ${n}: className must be a string`:null}validateEdge(t,n,r){if(!t.id)return`Edge ${r}: Missing required field: id`;if(!t.source)return`Edge ${r}: Missing required field: source`;if(!t.target)return`Edge ${r}: Missing required field: target`;if(!n.has(t.source))return`Edge ${r}: Source node '${t.source}' does not exist`;if(!n.has(t.target))return`Edge ${r}: Target node '${t.target}' does not exist`;if(t.type){const s=["default","straight","step","smoothstep","bezier","custom"];if(!s.includes(t.type))return`Edge ${r}: Invalid type '${t.type}'. Must be one of: ${s.join(", ")}`}if(t.style&&typeof t.style!="object")return`Edge ${r}: Style must be an object`;if(t.style){const s=["stroke","strokeWidth","strokeDasharray","strokeOpacity","fill","color","opacity"];for(const i in t.style)if(!s.includes(i))return`Edge ${r}: Invalid style property '${i}'. Valid properties: ${s.join(", ")}`}if(t.markerEnd){const s=this.validateMarker(t.markerEnd,`Edge ${r} markerEnd`);if(s)return s}if(t.markerStart){const s=this.validateMarker(t.markerStart,`Edge ${r} markerStart`);if(s)return s}return null}validateMarker(t,n){if(typeof t=="string")return null;if(typeof t!="object")return`${n}: Marker must be an object or string`;if(t.type){const r=["Arrow","ArrowClosed"];if(!r.includes(t.type))return`${n}: Invalid marker type '${t.type}'. Must be one of: ${r.join(", ")}`}return t.width&&typeof t.width!="number"?`${n}: Marker width must be a number`:t.height&&typeof t.height!="number"?`${n}: Marker height must be a number`:t.color&&typeof t.color!="string"?`${n}: Marker color must be a string`:null}}function Bbt(e){return e.map((r,s)=>{if(r.position.x===0&&r.position.y===0&&s>0){const i=Math.floor(s/3),a=s%3;return{...r,position:{x:a*400,y:i*150}}}return r})}const zbt=({data:e})=>{const t=(r,s)=>{if(s)switch(s){case"running":return"bg-blue-50 border-blue-400 text-blue-900 shadow-lg shadow-blue-200";case"success":return"bg-green-50 border-green-400 text-green-900 shadow-lg shadow-green-200";case"error":return"bg-red-50 border-red-400 text-red-900 shadow-lg shadow-red-200";case"pending":return"bg-gray-50 border-gray-300 text-gray-700 shadow-lg shadow-gray-200"}switch(r){case"trigger":return"bg-indigo-100 border-indigo-400 text-indigo-900 shadow-sm";case"prompt":return"bg-green-100 border-green-400 text-green-900 shadow-sm";case"agent-task":return"bg-purple-100 border-purple-400 text-purple-900 shadow-sm";case"human-in-the-loop":return"bg-orange-100 border-orange-400 text-orange-900 shadow-sm";default:return"bg-gray-100 border-gray-400 text-gray-900 shadow-sm"}},n=(r,s)=>{if(s)switch(s){case"running":return"";case"success":return"";case"error":return"";case"pending":return""}switch(r){case"trigger":return"";case"prompt":return"";case"agent-task":return"";case"human-in-the-loop":return"";default:return""}};return f.jsxs("div",{className:Ye("px-4 py-3 rounded-lg border-2 min-w-[200px] max-w-[280px]",t(e.type,e.status)),children:[f.jsx(gp,{type:"target",position:Vn.Left,id:"input",className:"!bg-gray-700"}),f.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[f.jsx("span",{className:"text-lg",children:n(e.type,e.status)}),f.jsx("span",{className:"font-semibold text-sm",children:e.label||e.name}),e.status&&f.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-white/60 font-medium capitalize",children:e.status})]}),e.templateName&&f.jsx("div",{className:"text-sm font-medium mb-1 text-slate-700",children:e.templateName}),e.modelName&&f.jsx("div",{className:"text-xs opacity-75 font-mono bg-white/50 px-2 py-1 rounded",children:e.modelName}),f.jsx(gp,{type:"source",position:Vn.Right,id:"output",className:"!bg-gray-700"})]})},Ubt={flowStep:zbt},qbt=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=gr(pn(j=>({foldStreamingCodeBlocks:j.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[,i]=E.useState(null),[a,o]=E.useState([]),[l,c]=E.useState([]),[u,d]=E.useState(!1),[h,p]=E.useState(null),[g,y]=E.useState(!1),v=E.useRef(null),x=E.useRef(new $bt),w=Ni(pn(j=>Object.values(j.canvasControls))),S=E.useCallback((j,F,P,q,I)=>w.filter(V=>V.type==="codeblock"&&V.targetSlot===j&&V.renderer).map(V=>{if(V.renderer){const D={codeBlockContent:F,codeBlockLang:"flow",isFolded:q,toggleFold:I,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:V.renderer(D)},V.id)}return null}).filter(Boolean),[w]),_=E.useCallback(async()=>{if(!(!e.trim()||r)){if(t){const j=e.trim();if(!j.startsWith("{")||!j.endsWith("}")){p(null),o([]),c([]);return}try{JSON.parse(j)}catch{p(null),o([]),c([]);return}}d(!0),p(null),i(null),o([]),c([]);try{const j=await x.current.parse(e.trim());if(!j.success){t||p(j.error||"Failed to parse flow data");return}if(!j.data){t||p("No flow data returned from parser");return}const F=j.data;i(F);const q=Bbt(F.nodes).map(V=>{var D,z;return{id:V.id,type:"flowStep",position:V.position,data:{type:V.type,label:V.label,status:V.status,templateName:(D=V.data)==null?void 0:D.templateName,modelName:(z=V.data)==null?void 0:z.modelName,...V.data}}}),I=F.edges.map(V=>({id:V.id,source:V.source,target:V.target,type:V.type||"smoothstep",animated:V.animated||!1,style:V.style||{stroke:"#1f2937",strokeWidth:2},markerEnd:{type:yb.ArrowClosed,color:"#1f2937",width:18,height:18}}));o(q),c(I)}catch(j){console.error("[FlowBlockRenderer.parseFlow] Flow parsing error:",j),p(j instanceof Error?j.message:"Failed to parse flow data")}finally{d(!1)}}},[e,r]);E.useEffect(()=>{if(!r&&e.trim()&&!g){const F=setTimeout(_,t?100:0);return()=>clearTimeout(F)}},[e,r,g,_,t]);const k=()=>{const j=r;s(F=>!F),j&&!g&&setTimeout(_,0)},T=E.useCallback(async()=>{if(!v.current){ke.error("No flow content to download");return}try{const j=v.current.querySelector("svg");if(!j){ke.error("No SVG element found");return}const F=new XMLSerializer().serializeToString(j),P=new Blob([F],{type:"image/svg+xml"}),q=URL.createObjectURL(P),I=document.createElement("a");I.href=q,I.download="flow-diagram.svg",document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(q),ke.success("SVG downloaded successfully!")}catch(j){console.error("Download error:",j),ke.error("Failed to download SVG")}},[]),A=E.useCallback(()=>{y(j=>!j)},[]),R=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),M=S("codeblock-header-actions",e,"flow",r,k);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"FLOW"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:M})]}),f.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:A,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:g?"Show diagram":"Show code",children:g?f.jsx(sd,{className:"h-4 w-4"}):f.jsx(fS,{className:"h-4 w-4"})}),a.length>0&&!g&&!h&&f.jsx("button",{onClick:T,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:"Download SVG",children:f.jsx(cc,{className:"h-4 w-4"})})]})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:g?f.jsx(EN,{lang:"json",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[u&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Yn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Parsing flow..."})]}),h&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(No,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to parse flow data"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:h})]})]}),a.length>0&&!u&&!h&&f.jsx("div",{ref:v,className:"flow-container h-96 bg-background border rounded-md",children:f.jsxs(kce,{nodes:a,edges:l,nodeTypes:Ubt,fitView:!0,fitViewOptions:{padding:50,maxZoom:2.25,minZoom:.15},proOptions:{hideAttribution:!0},nodesDraggable:!1,nodesConnectable:!1,elementsSelectable:!0,zoomOnScroll:!0,panOnScroll:!1,zoomOnDoubleClick:!0,panOnDrag:!0,className:"bg-background",children:[f.jsx(Ice,{nodeColor:j=>{var F,P;if((F=j.data)!=null&&F.status)switch(j.data.status){case"running":return"#3b82f6";case"success":return"#10b981";case"error":return"#ef4444";case"pending":return"#6b7280"}switch((P=j.data)==null?void 0:P.type){case"trigger":return"#6366f1";case"prompt":return"#10b981";case"agent-task":return"#8b5cf6";case"human-in-the-loop":return"#f59e0b";default:return"#6b7280"}},position:"bottom-right",style:{width:120,height:80}}),f.jsx(Nce,{position:"top-left",showInteractive:!1}),f.jsx(Tce,{variant:nd.Dots,gap:20,size:2})]})}),!a.length&&!u&&!h&&f.jsx("div",{className:"flex items-center justify-center h-48 border-2 border-dashed border-border rounded-lg",children:f.jsx("div",{className:"text-center text-muted-foreground",children:t?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"text-4xl mb-2",children:""}),f.jsx("div",{className:"text-lg font-medium",children:"Streaming flow data..."}),f.jsx("div",{className:"text-sm",children:"Waiting for complete JSON"})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"text-4xl mb-2",children:""}),f.jsx("div",{className:"text-lg font-medium",children:"No flow data"}),f.jsx("div",{className:"text-sm",children:"Check the flow format"})]})})})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:k,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:R})})]})},Vbt=E.memo(qbt);class Wbt{constructor(){ue(this,"id","core-block-renderer-flow");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["flow","workflow","reactflow"],priority:10,renderer:r=>We.createElement(Vbt,{code:r.code,isStreaming:r.isStreaming})};console.log("[FlowBlockRendererModule] Registering flow block renderer with supported languages:",n.supportedLanguages),this.unregisterCallback=t.registerBlockRenderer(n),console.log("[FlowBlockRendererModule] Flow block renderer registered successfully")}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}class Nm{static parse(t){try{const n=this.sanitizeCode(t),r=this.parseObjectLiteral(n);return this.validateAndSanitize(r)}catch(n){throw new Error(`Failed to parse Formedible definition: ${n instanceof Error?n.message:String(n)}`)}}static sanitizeCode(t){let n=t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return n=n.replace(/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,""),n=n.replace(/=>\s*{[^}]*}/g,'""'),n=n.replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""'),n}static parseObjectLiteral(t){try{return JSON.parse(t)}catch{try{let r=t.trim();return r=this.replaceZodExpressions(r),r=r.replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":'),r=r.replace(/,(\s*[}\]])/g,"$1"),r=r.replace(/'/g,'"'),JSON.parse(r)}catch(r){throw new Error(`Invalid syntax. Please use valid JSON format or JavaScript object literal syntax. Error: ${r instanceof Error?r.message:String(r)}`)}}}static replaceZodExpressions(t){let n=t,r=!0;for(;r;){r=!1;const s=n.match(/z\.[a-zA-Z]+\(/);if(s){const i=s.index,a=i+s[0].length-1;let o=1,l=a+1;for(;l<n.length&&o>0;)n[l]==="("?o++:n[l]===")"&&o--,l++;if(o===0){let c=l;for(;c<n.length;){const u=n.slice(c).match(/^\.[a-zA-Z]+\(/);if(u){let d=1,p=c+u[0].length-1+1;for(;p<n.length&&d>0;)n[p]==="("?d++:n[p]===")"&&d--,p++;if(d===0)c=p;else break}else break}n=n.slice(0,i)+'"__ZOD_SCHEMA__"'+n.slice(c),r=!0}else n=n.replace(/z\.[a-zA-Z]+/,'"__ZOD_SCHEMA__"'),r=!0}}return n}static validateAndSanitize(t){if(typeof t!="object"||t===null)throw new Error("Definition must be an object");const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_KEYS.includes(r))switch(r){case"schema":break;case"fields":n[r]=this.validateFields(s);break;case"pages":n[r]=this.validatePages(s);break;case"progress":n[r]=this.validateProgress(s);break;case"formOptions":n[r]=this.validateFormOptions(s);break;case"submitLabel":case"nextLabel":case"previousLabel":case"formClassName":case"fieldClassName":typeof s=="string"&&(n[r]=s);break}return n}static validateFields(t){if(!Array.isArray(t))throw new Error("Fields must be an array");return t.map((n,r)=>{if(typeof n!="object"||n===null)throw new Error(`Field at index ${r} must be an object`);const s={};for(const[i,a]of Object.entries(n))if(this.ALLOWED_FIELD_KEYS.includes(i))switch(i){case"name":typeof a=="string"&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(a)&&(s[i]=a);break;case"type":typeof a=="string"&&this.ALLOWED_FIELD_TYPES.includes(a)&&(s[i]=a);break;case"label":case"placeholder":case"description":case"accept":typeof a=="string"&&(s[i]=a);break;case"options":Array.isArray(a)&&(s[i]=a.filter(o=>typeof o=="string"||typeof o=="object"&&o!==null&&typeof o.value=="string"&&typeof o.label=="string"));break;case"min":case"max":case"step":case"page":typeof a=="number"&&!isNaN(a)&&(s[i]=a);break;case"multiple":typeof a=="boolean"&&(s[i]=a);break}if(!s.name||!s.type)throw new Error(`Field at index ${r} must have 'name' and 'type' properties`);return s})}static validatePages(t){return Array.isArray(t)?t.map(n=>{if(typeof n!="object"||n===null)return null;const r={};for(const[s,i]of Object.entries(n))if(this.ALLOWED_PAGE_KEYS.includes(s))switch(s){case"page":typeof i=="number"&&!isNaN(i)&&(r[s]=i);break;case"title":case"description":typeof i=="string"&&(r[s]=i);break}return r.page?r:null}).filter(Boolean):[]}static validateProgress(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_PROGRESS_KEYS.includes(r))switch(r){case"showSteps":case"showPercentage":typeof s=="boolean"&&(n[r]=s);break;case"className":typeof s=="string"&&(n[r]=s);break}return n}static validateFormOptions(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_FORM_OPTIONS_KEYS.includes(r))switch(r){case"defaultValues":typeof s=="object"&&s!==null&&(n[r]=s);break;case"asyncDebounceMs":typeof s=="number"&&!isNaN(s)&&(n[r]=s);break;case"canSubmitWhenInvalid":typeof s=="boolean"&&(n[r]=s);break}return n}}ue(Nm,"ALLOWED_FIELD_TYPES",["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file"]),ue(Nm,"ALLOWED_KEYS",["schema","fields","pages","progress","submitLabel","nextLabel","previousLabel","formClassName","fieldClassName","formOptions"]),ue(Nm,"ALLOWED_FIELD_KEYS",["name","type","label","placeholder","description","options","min","max","step","accept","multiple","page","conditional"]),ue(Nm,"ALLOWED_PAGE_KEYS",["page","title","description"]),ue(Nm,"ALLOWED_PROGRESS_KEYS",["showSteps","showPercentage","className"]),ue(Nm,"ALLOWED_FORM_OPTIONS_KEYS",["defaultValues","asyncDebounceMs","canSubmitWhenInvalid"]);const Hbt=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=gr(pn(q=>({foldStreamingCodeBlocks:q.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[p,g]=E.useState(!1),y=E.useMemo(()=>`_sendOnSubmit_${dr()}`,[]),v=Ni(pn(q=>Object.values(q.canvasControls))),x=E.useCallback((q,I,V,D,z)=>v.filter($=>$.type==="codeblock"&&$.targetSlot===q&&$.renderer).map($=>{if($.renderer){const Y={codeBlockContent:I,codeBlockLang:"formedible",isFolded:D,toggleFold:z,canvasContextType:"codeblock"};return f.jsx(We.Fragment,{children:$.renderer(Y)},$.id)}return null}).filter(Boolean),[v]),w=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const q=Nm.parse(e);a(q)}catch(q){console.error("Formedible parsing error:",q),u(q instanceof Error?q.message:"Failed to parse Formedible definition")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&!t&&w()},[e,r,d,t,w]);const S=()=>{const q=r;s(I=>!I),q&&!d&&setTimeout(w,0)},_=E.useCallback(()=>{h(q=>!q)},[]),k=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),T=E.useCallback(q=>{const I={};return q.forEach(V=>{switch(V.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":I[V.name]=qe();break;case"number":case"slider":I[V.name]=Nt();break;case"checkbox":case"switch":I[V.name]=Kn();break;case"date":I[V.name]=I1e();break;case"select":I[V.name]=qe();break;case"file":I[V.name]=Cf();break;default:I[V.name]=qe()}}),Ze(I)},[]),A=E.useCallback(q=>{const I={};return q.forEach(V=>{switch(V.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":I[V.name]="";break;case"number":case"slider":I[V.name]=V.min||0;break;case"checkbox":case"switch":I[V.name]=!1;break;case"date":I[V.name]=new Date().toISOString().split("T")[0];break;case"select":if(V.options&&V.options.length>0){const D=V.options[0];I[V.name]=typeof D=="string"?D:D.value}else I[V.name]="";break;case"file":I[V.name]=null;break;default:I[V.name]=""}}),I},[]),R=E.useCallback(async(q,I)=>{try{const D=`These are the form values:
\`\`\`json
${JSON.stringify(q,null,2)}
\`\`\`
`;Ae.emit(an.setInputTextRequest,{text:D}),Ae.emit(an.focusInputRequest,void 0),console.log("Formedible: sendOnSubmit value before conditional: ",I),I?(console.log("Sending form data to prompt"),requestAnimationFrame(()=>{console.log("Setting input text");try{console.log("Creating turn data");const z={id:dr(),content:D,parameters:{},metadata:{}};Ae.emit(an.submitPromptRequest,{turnData:z}),ke.success("Form submitted and prompt sent!")}catch(z){console.error("Failed to submit prompt:",z),ke.error("Form data added to input, but failed to send prompt")}})):ke.success("Form data added to prompt input")}catch(V){console.error("Form submission error:",V),ke.error("Failed to process form submission")}},[]),M=E.useMemo(()=>{var q;if(!i||!i.fields)return null;try{const I=T(i.fields),V=((q=i.formOptions)==null?void 0:q.defaultValues)||A(i.fields),D=i.pages&&i.pages.length>0?Math.max(...i.pages.map(B=>B.page)):1,z=[...i.fields,{name:y,type:"switch",label:"Send on submit",description:"Automatically send the prompt after form submission",page:D}],$=I.extend({[y]:Kn().default(!1)}),Y={...V,[y]:!1};return{schema:$,fields:z,pages:i.pages,progress:i.progress,submitLabel:i.submitLabel||"Submit",nextLabel:i.nextLabel||"Next",previousLabel:i.previousLabel||"Previous",formClassName:i.formClassName,fieldClassName:i.fieldClassName,formOptions:{...i.formOptions,defaultValues:Y,canSubmitWhenInvalid:!0,onSubmit:async({value:B})=>{console.log("Formedible onSubmit received full value:",B),console.log("Formedible onSubmit received sendOnSubmit:",B[y]);const G=B[y],Z={...B};delete Z[y],g(G),await R(Z,G)},onSubmitInvalid:({value:B,formApi:G})=>{console.error("Formedible onSubmitInvalid triggered. Values:",B),console.error("Formedible onSubmitInvalid triggered. Form API errors:",G.formState.errors),ke.error("Form has validation errors. Please check your input.")}},disabled:!1}}catch(I){return console.error("Form configuration error:",I),{error:I instanceof Error?I.message:"Unknown error"}}},[i,T,A,R,y]),j=Dg(M&&!("error"in M)?M:{fields:[],formOptions:{defaultValues:{}}}),F=E.useMemo(()=>M?"error"in M?f.jsx("div",{className:"p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:f.jsxs("div",{className:"text-sm text-destructive",children:["Failed to render form: ",M.error]})}):!i||!i.fields?null:f.jsx(j.Form,{}):null,[M,i,j.Form]),P=x("codeblock-header-actions",e,"formedible",r,S);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-[var(--z-sticky)] flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"Formedible"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:P})]}),f.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx("button",{onClick:_,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show form":"Show code",children:d?f.jsx(Lve,{className:"h-4 w-4"}):f.jsx(fS,{className:"h-4 w-4"})})})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(EN,{lang:"formedible",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Yn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Parsing form definition..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(No,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to parse Formedible definition"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),F&&!o&&!c&&f.jsxs("div",{className:"p-4 bg-background border rounded-md",children:[f.jsx("div",{className:"mb-4 p-2 bg-muted/50 rounded text-xs text-muted-foreground",children:" Interactive Form - Fill out and submit to add data to prompt input"}),F]})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:S,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:k})})]})},Gbt=E.memo(Hbt);class Kbt{constructor(){ue(this,"id","core-block-renderer-formedible");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["formedible"],priority:10,renderer:r=>We.createElement(Gbt,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}const Ybt=[jZe,Mst,$st,Uat,pot,vot,Sot,IWe,NHe,THe,rZe,sZe,IZe,fZe,pZe,gZe,OZe,FHe,OKe,NZe,aZe,gYe,jHe,cZe,FZe,zZe,WZe,JZe,Est,Ast,ZKe,JKe,iYe,dYe,fYe,slt,Lbt,Wbt,Kbt,Cot,qot,Wot,Eot,Aot,Rot,Mot,Pot,Lot,Dot,Got,Yot,Jot,zot,nlt];function Zbt(){return f.jsxs(TWe,{children:[f.jsx(kWe,{}),f.jsx(CWe,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(bWe,{controls:Ybt})})})]})}Lxe();D0e.createRoot(document.getElementById("root")).render(f.jsx(We.StrictMode,{children:f.jsx(Zbt,{})}));export{mdt as $,Rw as A,Flt as B,Nct as C,XL as D,il as E,Mue as F,dpt as G,_gt as H,_K as I,Fut as J,Wlt as K,Eb as L,jvt as M,zN as N,_L as O,RG as P,vdt as Q,fk as R,upt as S,g_ as T,yct as U,m_ as V,kn as W,Hn as X,Uue as Y,npt as Z,ie as _,_ct as a,lle as a$,FL as a0,Lvt as a1,zvt as a2,H0 as a3,zG as a4,BG as a5,qvt as a6,Uvt as a7,Bvt as a8,Dvt as a9,Jht as aA,Vft as aB,Wht as aC,UL as aD,IK as aE,nmt as aF,gdt as aG,la as aH,jN as aI,odt as aJ,adt as aK,Bg as aL,Qht as aM,ahe as aN,DN as aO,BN as aP,bT as aQ,lhe as aR,ihe as aS,Nht as aT,Lu as aU,_w as aV,nl as aW,XJe as aX,J6 as aY,ile as aZ,l_ as a_,Fvt as aa,Wvt as ab,$vt as ac,Vvt as ad,Nmt as ae,ume as af,Zvt as ag,$ut as ah,oa as ai,Up as aj,DL as ak,Lhe as al,qg as am,phe as an,hr as ao,fd as ap,ry as aq,xgt as ar,Yvt as as,Xvt as at,Gvt as au,Dn as av,Kvt as aw,ngt as ax,Jmt as ay,Xmt as az,Sct as b,Ivt as b0,llt as b1,Xht as b2,Vht as b3,Ift as b4,qL as b5,kht as b6,tpt as b7,v_ as b8,hv as b9,mT as ba,Dht as bb,Vgt as bc,b_ as bd,yT as be,Rht as bf,Qfe as bg,Pft as bh,Oft as bi,Am as bj,nK as bk,Dft as bl,VL as bm,jft as bn,$ft as bo,pv as bp,zp as bq,XG as br,WL as bs,the as bt,_D as bu,ept as bv,$N as bw,Wi as bx,zr as by,fs as c,mr as d,zue as e,La as f,kct as g,jf as h,gg as i,ddt as j,fv as k,qt as l,ghe as m,Pvt as n,Qvt as o,Ect as p,Tct as q,Jvt as r,Cct as s,Lut as t,qu as u,Kmt as v,ppt as w,Hvt as x,wct as y,Ovt as z};
