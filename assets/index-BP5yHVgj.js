const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-BjDabwFb.js","assets/graph-ylyaNYqC.js","assets/_baseUniq-Cd5kGNUt.js","assets/layout-C09XMOxR.js","assets/_basePickBy-yCL7yhSN.js","assets/clone-Dp2HKN5C.js","assets/c4Diagram-VJAJSXHY-C66brPs5.js","assets/chunk-D6G4REZN-T3ayb6F2.js","assets/flowDiagram-4HSFHLVR-C7Cbrwv_.js","assets/chunk-RZ5BOZE2-B4KUknig.js","assets/channel-BdesgCfR.js","assets/erDiagram-Q7BY3M3F-1L6jwj7J.js","assets/gitGraphDiagram-7IBYFJ6S-Cj1L176Q.js","assets/chunk-4BMEZGHF-DD6kqYTi.js","assets/chunk-XZIHB7SX-C_0KDJLr.js","assets/radar-MK3ICKWK-DMwa8Hv_.js","assets/ganttDiagram-APWFNJXF-Bc7pWP_q.js","assets/linear-CjDoftW9.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-C_RVqKc-.js","assets/pieDiagram-IB7DONF6-BaTZdgSq.js","assets/arc-84_P_RUG.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-CZdsAYCM.js","assets/xychartDiagram-VJFVF3MP-DK1dQ3gc.js","assets/requirementDiagram-KVF5MWMF-BxIQixlc.js","assets/sequenceDiagram-X6HHIX6F-vAeZHIh1.js","assets/classDiagram-GIVACNV2-BMKryCrh.js","assets/chunk-A2AXSNBT-Qdti7A7z.js","assets/classDiagram-v2-COTLJTTW-BMKryCrh.js","assets/stateDiagram-DGXRK772-C2kKDehE.js","assets/chunk-AEK57VVT-DXLqOLlN.js","assets/stateDiagram-v2-YXO3MK2T-CGVFKI9g.js","assets/journeyDiagram-U35MCT3I-CrU5rD3D.js","assets/timeline-definition-BDJGKUSR-Dzk7G27P.js","assets/mindmap-definition-ALO5MXBD-Btd8n0Si.js","assets/cytoscape.esm-hIkt8yTm.js","assets/sankeyDiagram-QLVOVGJD-VqXnFSpg.js","assets/diagram-VNBRO52H-CXLcUM6y.js","assets/diagram-SSKATNLV-Bal489ma.js","assets/blockDiagram-JOT3LUYC-Dwnsxc5X.js","assets/architectureDiagram-IEHRJDOE-DAGVzqzM.js"])))=>i.map(i=>d[i]);
var Qfe=Object.defineProperty;var ehe=(e,t,n)=>t in e?Qfe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var de=(e,t,n)=>ehe(e,typeof t!="symbol"?t+"":t,n);function the(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Qp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Sa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lN={exports:{}},Tv={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rB;function nhe(){if(rB)return Tv;rB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return Tv.Fragment=t,Tv.jsx=n,Tv.jsxs=n,Tv}var sB;function rhe(){return sB||(sB=1,lN.exports=nhe()),lN.exports}var f=rhe(),cN={exports:{}};function she(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var WW={exports:{}},xi=WW.exports={},cu,uu;function U3(){throw new Error("setTimeout has not been defined")}function q3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?cu=setTimeout:cu=U3}catch{cu=U3}try{typeof clearTimeout=="function"?uu=clearTimeout:uu=q3}catch{uu=q3}})();function HW(e){if(cu===setTimeout)return setTimeout(e,0);if((cu===U3||!cu)&&setTimeout)return cu=setTimeout,setTimeout(e,0);try{return cu(e,0)}catch{try{return cu.call(null,e,0)}catch{return cu.call(this,e,0)}}}function ihe(e){if(uu===clearTimeout)return clearTimeout(e);if((uu===q3||!uu)&&clearTimeout)return uu=clearTimeout,clearTimeout(e);try{return uu(e)}catch{try{return uu.call(null,e)}catch{return uu.call(this,e)}}}var Ed=[],A0=!1,em,E2=-1;function ahe(){!A0||!em||(A0=!1,em.length?Ed=em.concat(Ed):E2=-1,Ed.length&&GW())}function GW(){if(!A0){var e=HW(ahe);A0=!0;for(var t=Ed.length;t;){for(em=Ed,Ed=[];++E2<t;)em&&em[E2].run();E2=-1,t=Ed.length}em=null,A0=!1,ihe(e)}}xi.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Ed.push(new KW(e,t)),Ed.length===1&&!A0&&HW(GW)};function KW(e,t){this.fun=e,this.array=t}KW.prototype.run=function(){this.fun.apply(null,this.array)};xi.title="browser";xi.browser=!0;xi.env={};xi.argv=[];xi.version="";xi.versions={};function Qd(){}xi.on=Qd;xi.addListener=Qd;xi.once=Qd;xi.off=Qd;xi.removeListener=Qd;xi.removeAllListeners=Qd;xi.emit=Qd;xi.prependListener=Qd;xi.prependOnceListener=Qd;xi.listeners=function(e){return[]};xi.binding=function(e){throw new Error("process.binding is not supported")};xi.cwd=function(){return"/"};xi.chdir=function(e){throw new Error("process.chdir is not supported")};xi.umask=function(){return 0};var ohe=WW.exports;const Ni=she(ohe);var Er={},iB;function lhe(){if(iB)return Er;iB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(V){return V===null||typeof V!="object"?null:(V=d&&V[d]||V["@@iterator"],typeof V=="function"?V:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(V,Q,ee){this.props=V,this.context=Q,this.refs=b,this.updater=ee||m}v.prototype.isReactComponent={},v.prototype.setState=function(V,Q){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,Q,"setState")},v.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(V,Q,ee){this.props=V,this.context=Q,this.refs=b,this.updater=ee||m}var S=w.prototype=new x;S.constructor=w,y(S,v.prototype),S.isPureReactComponent=!0;var k=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},R=Object.prototype.hasOwnProperty;function A(V,Q,ee,se,me,ce){return ee=ce.ref,{$$typeof:e,type:V,key:Q,ref:ee!==void 0?ee:null,props:ce}}function N(V,Q){return A(V.type,Q,void 0,void 0,void 0,V.props)}function I(V){return typeof V=="object"&&V!==null&&V.$$typeof===e}function O(V){var Q={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ee){return Q[ee]})}var B=/\/+/g;function D(V,Q){return typeof V=="object"&&V!==null&&V.key!=null?O(""+V.key):Q.toString(36)}function W(){}function P(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(W,W):(V.status="pending",V.then(function(Q){V.status==="pending"&&(V.status="fulfilled",V.value=Q)},function(Q){V.status==="pending"&&(V.status="rejected",V.reason=Q)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Z(V,Q,ee,se,me){var ce=typeof V;(ce==="undefined"||ce==="boolean")&&(V=null);var je=!1;if(V===null)je=!0;else switch(ce){case"bigint":case"string":case"number":je=!0;break;case"object":switch(V.$$typeof){case e:case t:je=!0;break;case u:return je=V._init,Z(je(V._payload),Q,ee,se,me)}}if(je)return me=me(V),je=se===""?"."+D(V,0):se,k(me)?(ee="",je!=null&&(ee=je.replace(B,"$&/")+"/"),Z(me,Q,ee,"",function(Ce){return Ce})):me!=null&&(I(me)&&(me=N(me,ee+(me.key==null||V&&V.key===me.key?"":(""+me.key).replace(B,"$&/")+"/")+je)),Q.push(me)),1;je=0;var De=se===""?".":se+":";if(k(V))for(var Se=0;Se<V.length;Se++)se=V[Se],ce=De+D(se,Se),je+=Z(se,Q,ee,ce,me);else if(Se=h(V),typeof Se=="function")for(V=Se.call(V),Se=0;!(se=V.next()).done;)se=se.value,ce=De+D(se,Se++),je+=Z(se,Q,ee,ce,me);else if(ce==="object"){if(typeof V.then=="function")return Z(P(V),Q,ee,se,me);throw Q=String(V),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return je}function U(V,Q,ee){if(V==null)return V;var se=[],me=0;return Z(V,se,"","",function(ce){return Q.call(ee,ce,me++)}),se}function H(V){if(V._status===-1){var Q=V._result;Q=Q(),Q.then(function(ee){(V._status===0||V._status===-1)&&(V._status=1,V._result=ee)},function(ee){(V._status===0||V._status===-1)&&(V._status=2,V._result=ee)}),V._status===-1&&(V._status=0,V._result=Q)}if(V._status===1)return V._result.default;throw V._result}var L=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(Q))return}else if(typeof Ni=="object"&&typeof Ni.emit=="function"){Ni.emit("uncaughtException",V);return}console.error(V)};function ne(){}return Er.Children={map:U,forEach:function(V,Q,ee){U(V,function(){Q.apply(this,arguments)},ee)},count:function(V){var Q=0;return U(V,function(){Q++}),Q},toArray:function(V){return U(V,function(Q){return Q})||[]},only:function(V){if(!I(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},Er.Component=v,Er.Fragment=n,Er.Profiler=s,Er.PureComponent=w,Er.StrictMode=r,Er.Suspense=l,Er.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Er.__COMPILER_RUNTIME={__proto__:null,c:function(V){return C.H.useMemoCache(V)}},Er.cache=function(V){return function(){return V.apply(null,arguments)}},Er.cloneElement=function(V,Q,ee){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var se=y({},V.props),me=V.key,ce=void 0;if(Q!=null)for(je in Q.ref!==void 0&&(ce=void 0),Q.key!==void 0&&(me=""+Q.key),Q)!R.call(Q,je)||je==="key"||je==="__self"||je==="__source"||je==="ref"&&Q.ref===void 0||(se[je]=Q[je]);var je=arguments.length-2;if(je===1)se.children=ee;else if(1<je){for(var De=Array(je),Se=0;Se<je;Se++)De[Se]=arguments[Se+2];se.children=De}return A(V.type,me,void 0,void 0,ce,se)},Er.createContext=function(V){return V={$$typeof:a,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:i,_context:V},V},Er.createElement=function(V,Q,ee){var se,me={},ce=null;if(Q!=null)for(se in Q.key!==void 0&&(ce=""+Q.key),Q)R.call(Q,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(me[se]=Q[se]);var je=arguments.length-2;if(je===1)me.children=ee;else if(1<je){for(var De=Array(je),Se=0;Se<je;Se++)De[Se]=arguments[Se+2];me.children=De}if(V&&V.defaultProps)for(se in je=V.defaultProps,je)me[se]===void 0&&(me[se]=je[se]);return A(V,ce,void 0,void 0,null,me)},Er.createRef=function(){return{current:null}},Er.forwardRef=function(V){return{$$typeof:o,render:V}},Er.isValidElement=I,Er.lazy=function(V){return{$$typeof:u,_payload:{_status:-1,_result:V},_init:H}},Er.memo=function(V,Q){return{$$typeof:c,type:V,compare:Q===void 0?null:Q}},Er.startTransition=function(V){var Q=C.T,ee={};C.T=ee;try{var se=V(),me=C.S;me!==null&&me(ee,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(ne,L)}catch(ce){L(ce)}finally{C.T=Q}},Er.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Er.use=function(V){return C.H.use(V)},Er.useActionState=function(V,Q,ee){return C.H.useActionState(V,Q,ee)},Er.useCallback=function(V,Q){return C.H.useCallback(V,Q)},Er.useContext=function(V){return C.H.useContext(V)},Er.useDebugValue=function(){},Er.useDeferredValue=function(V,Q){return C.H.useDeferredValue(V,Q)},Er.useEffect=function(V,Q,ee){var se=C.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(V,Q)},Er.useId=function(){return C.H.useId()},Er.useImperativeHandle=function(V,Q,ee){return C.H.useImperativeHandle(V,Q,ee)},Er.useInsertionEffect=function(V,Q){return C.H.useInsertionEffect(V,Q)},Er.useLayoutEffect=function(V,Q){return C.H.useLayoutEffect(V,Q)},Er.useMemo=function(V,Q){return C.H.useMemo(V,Q)},Er.useOptimistic=function(V,Q){return C.H.useOptimistic(V,Q)},Er.useReducer=function(V,Q,ee){return C.H.useReducer(V,Q,ee)},Er.useRef=function(V){return C.H.useRef(V)},Er.useState=function(V){return C.H.useState(V)},Er.useSyncExternalStore=function(V,Q,ee){return C.H.useSyncExternalStore(V,Q,ee)},Er.useTransition=function(){return C.H.useTransition()},Er.version="19.1.0",Er}var aB;function d1(){return aB||(aB=1,cN.exports=lhe()),cN.exports}var E=d1();const Ve=Sa(E),YW=the({__proto__:null,default:Ve},[E]);var uN={exports:{}},Av={},dN={exports:{}},fN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oB;function che(){return oB||(oB=1,function(e){function t(U,H){var L=U.length;U.push(H);e:for(;0<L;){var ne=L-1>>>1,V=U[ne];if(0<s(V,H))U[ne]=H,U[L]=V,L=ne;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],L=U.pop();if(L!==H){U[0]=L;e:for(var ne=0,V=U.length,Q=V>>>1;ne<Q;){var ee=2*(ne+1)-1,se=U[ee],me=ee+1,ce=U[me];if(0>s(se,L))me<V&&0>s(ce,se)?(U[ne]=ce,U[me]=L,ne=me):(U[ne]=se,U[ee]=L,ne=ee);else if(me<V&&0>s(ce,L))U[ne]=ce,U[me]=L,ne=me;else break e}}return H}function s(U,H){var L=U.sortIndex-H.sortIndex;return L!==0?L:U.id-H.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,m=!1,y=!1,b=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function k(U){for(var H=n(c);H!==null;){if(H.callback===null)r(c);else if(H.startTime<=U)r(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=n(c)}}function C(U){if(b=!1,k(U),!y)if(n(l)!==null)y=!0,R||(R=!0,D());else{var H=n(c);H!==null&&Z(C,H.startTime-U)}}var R=!1,A=-1,N=5,I=-1;function O(){return v?!0:!(e.unstable_now()-I<N)}function B(){if(v=!1,R){var U=e.unstable_now();I=U;var H=!0;try{e:{y=!1,b&&(b=!1,w(A),A=-1),m=!0;var L=h;try{t:{for(k(U),d=n(l);d!==null&&!(d.expirationTime>U&&O());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,h=d.priorityLevel;var V=ne(d.expirationTime<=U);if(U=e.unstable_now(),typeof V=="function"){d.callback=V,k(U),H=!0;break t}d===n(l)&&r(l),k(U)}else r(l);d=n(l)}if(d!==null)H=!0;else{var Q=n(c);Q!==null&&Z(C,Q.startTime-U),H=!1}}break e}finally{d=null,h=L,m=!1}H=void 0}}finally{H?D():R=!1}}}var D;if(typeof S=="function")D=function(){S(B)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,P=W.port2;W.port1.onmessage=B,D=function(){P.postMessage(null)}}else D=function(){x(B,0)};function Z(U,H){A=x(function(){U(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var L=h;h=H;try{return U()}finally{h=L}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var L=h;h=U;try{return H()}finally{h=L}},e.unstable_scheduleCallback=function(U,H,L){var ne=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?ne+L:ne):L=ne,U){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=L+V,U={id:u++,callback:H,priorityLevel:U,startTime:L,expirationTime:V,sortIndex:-1},L>ne?(U.sortIndex=L,t(c,U),n(l)===null&&U===n(c)&&(b?(w(A),A=-1):b=!0,Z(C,L-ne))):(U.sortIndex=V,t(l,U),y||m||(y=!0,R||(R=!0,D()))),U},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(U){var H=h;return function(){var L=h;h=H;try{return U.apply(this,arguments)}finally{h=L}}}}(fN)),fN}var lB;function uhe(){return lB||(lB=1,dN.exports=che()),dN.exports}var hN={exports:{}},Aa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cB;function dhe(){if(cB)return Aa;cB=1;var e=d1();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Aa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Aa.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Aa.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Aa.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Aa.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Aa.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:m}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Aa.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Aa.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Aa.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Aa.requestFormReset=function(l){r.d.r(l)},Aa.unstable_batchedUpdates=function(l,c){return l(c)},Aa.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Aa.useFormStatus=function(){return a.H.useHostTransitionStatus()},Aa.version="19.1.0",Aa}var uB;function ZW(){if(uB)return hN.exports;uB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),hN.exports=dhe(),hN.exports}var dB;function fhe(){if(dB)return Av;dB=1;var e=uhe(),t=d1(),n=ZW();function r(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function i(p){var g=p,_=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(_=g.return),p=g.return;while(p)}return g.tag===3?_:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(i(p)!==p)throw Error(r(188))}function l(p){var g=p.alternate;if(!g){if(g=i(p),g===null)throw Error(r(188));return g!==p?null:p}for(var _=p,T=g;;){var j=_.return;if(j===null)break;var q=j.alternate;if(q===null){if(T=j.return,T!==null){_=T;continue}break}if(j.child===q.child){for(q=j.child;q;){if(q===_)return o(j),p;if(q===T)return o(j),g;q=q.sibling}throw Error(r(188))}if(_.return!==T.return)_=j,T=q;else{for(var ue=!1,Re=j.child;Re;){if(Re===_){ue=!0,_=j,T=q;break}if(Re===T){ue=!0,T=j,_=q;break}Re=Re.sibling}if(!ue){for(Re=q.child;Re;){if(Re===_){ue=!0,_=q,T=j;break}if(Re===T){ue=!0,T=q,_=j;break}Re=Re.sibling}if(!ue)throw Error(r(189))}}if(_.alternate!==T)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function D(p){return p===null||typeof p!="object"?null:(p=B&&p[B]||p["@@iterator"],typeof p=="function"?p:null)}var W=Symbol.for("react.client.reference");function P(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===W?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case C:return"Suspense";case R:return"SuspenseList";case I:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case S:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case k:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case A:return g=p.displayName||null,g!==null?g:P(p.type)||"Memo";case N:g=p._payload,p=p._init;try{return P(p(g))}catch{}}return null}var Z=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},ne=[],V=-1;function Q(p){return{current:p}}function ee(p){0>V||(p.current=ne[V],ne[V]=null,V--)}function se(p,g){V++,ne[V]=p.current,p.current=g}var me=Q(null),ce=Q(null),je=Q(null),De=Q(null);function Se(p,g){switch(se(je,g),se(ce,p),se(me,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?ML(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=ML(g),p=IL(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ee(me),se(me,p)}function Ce(){ee(me),ee(ce),ee(je)}function qe(p){p.memoizedState!==null&&se(De,p);var g=me.current,_=IL(g,p.type);g!==_&&(se(ce,p),se(me,_))}function Qe(p){ce.current===p&&(ee(me),ee(ce)),De.current===p&&(ee(De),_v._currentValue=L)}var We=Object.prototype.hasOwnProperty,Ne=e.unstable_scheduleCallback,K=e.unstable_cancelCallback,ge=e.unstable_shouldYield,Ae=e.unstable_requestPaint,le=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,re=e.unstable_ImmediatePriority,Te=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,ke=e.unstable_LowPriority,lt=e.unstable_IdlePriority,Rt=e.log,ft=e.unstable_setDisableYieldValue,Pt=null,qt=null;function Lt(p){if(typeof Rt=="function"&&ft(p),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(Pt,p)}catch{}}var en=Math.clz32?Math.clz32:X,xe=Math.log,F=Math.LN2;function X(p){return p>>>=0,p===0?32:31-(xe(p)/F|0)|0}var ye=256,Fe=4194304;function we(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Ie(p,g,_){var T=p.pendingLanes;if(T===0)return 0;var j=0,q=p.suspendedLanes,ue=p.pingedLanes;p=p.warmLanes;var Re=T&134217727;return Re!==0?(T=Re&~q,T!==0?j=we(T):(ue&=Re,ue!==0?j=we(ue):_||(_=Re&~p,_!==0&&(j=we(_))))):(Re=T&~q,Re!==0?j=we(Re):ue!==0?j=we(ue):_||(_=T&~p,_!==0&&(j=we(_)))),j===0?0:g!==0&&g!==j&&(g&q)===0&&(q=j&-j,_=g&-g,q>=_||q===32&&(_&4194048)!==0)?g:j}function fe(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function vt(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ot(){var p=ye;return ye<<=1,(ye&4194048)===0&&(ye=256),p}function $(){var p=Fe;return Fe<<=1,(Fe&62914560)===0&&(Fe=4194304),p}function ze(p){for(var g=[],_=0;31>_;_++)g.push(p);return g}function st(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function be(p,g,_,T,j,q){var ue=p.pendingLanes;p.pendingLanes=_,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=_,p.entangledLanes&=_,p.errorRecoveryDisabledLanes&=_,p.shellSuspendCounter=0;var Re=p.entanglements,Ye=p.expirationTimes,wt=p.hiddenUpdates;for(_=ue&~_;0<_;){var Dt=31-en(_),Bt=1<<Dt;Re[Dt]=0,Ye[Dt]=-1;var kt=wt[Dt];if(kt!==null)for(wt[Dt]=null,Dt=0;Dt<kt.length;Dt++){var At=kt[Dt];At!==null&&(At.lane&=-536870913)}_&=~Bt}T!==0&&_e(p,T,0),q!==0&&j===0&&p.tag!==0&&(p.suspendedLanes|=q&~(ue&~g))}function _e(p,g,_){p.pendingLanes|=g,p.suspendedLanes&=~g;var T=31-en(g);p.entangledLanes|=g,p.entanglements[T]=p.entanglements[T]|1073741824|_&4194090}function Ue(p,g){var _=p.entangledLanes|=g;for(p=p.entanglements;_;){var T=31-en(_),j=1<<T;j&g|p[T]&g&&(p[T]|=g),_&=~j}}function Et(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function he(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Y(){var p=H.p;return p!==0?p:(p=window.event,p===void 0?32:XL(p.type))}function G(p,g){var _=H.p;try{return H.p=p,g()}finally{H.p=_}}var J=Math.random().toString(36).slice(2),ve="__reactFiber$"+J,Oe="__reactProps$"+J,Ke="__reactContainer$"+J,_t="__reactEvents$"+J,tn="__reactListeners$"+J,zn="__reactHandles$"+J,Xt="__reactResources$"+J,nn="__reactMarker$"+J;function un(p){delete p[ve],delete p[Oe],delete p[_t],delete p[tn],delete p[zn]}function yr(p){var g=p[ve];if(g)return g;for(var _=p.parentNode;_;){if(g=_[Ke]||_[ve]){if(_=g.alternate,g.child!==null||_!==null&&_.child!==null)for(p=DL(p);p!==null;){if(_=p[ve])return _;p=DL(p)}return g}p=_,_=p.parentNode}return null}function Rr(p){if(p=p[ve]||p[Ke]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function ns(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(r(33))}function rs(p){var g=p[Xt];return g||(g=p[Xt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function Cr(p){p[nn]=!0}var hn=new Set,et={};function Vt(p,g){pn(p,g),pn(p+"Capture",g)}function pn(p,g){for(et[p]=g,p=0;p<g.length;p++)hn.add(g[p])}var rr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Rs={},es={};function Pi(p){return We.call(es,p)?!0:We.call(Rs,p)?!1:rr.test(p)?es[p]=!0:(Rs[p]=!0,!1)}function ui(p,g,_){if(Pi(g))if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var T=g.toLowerCase().slice(0,5);if(T!=="data-"&&T!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+_)}}function qa(p,g,_){if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+_)}}function da(p,g,_,T){if(T===null)p.removeAttribute(_);else{switch(typeof T){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(_);return}p.setAttributeNS(g,_,""+T)}}var Hs,qo;function bl(p){if(Hs===void 0)try{throw Error()}catch(_){var g=_.stack.trim().match(/\n( *(at )?)/);Hs=g&&g[1]||"",qo=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Hs+p+qo}var ff=!1;function ig(p,g){if(!p||ff)return"";ff=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var T={DetermineComponentFrameRoot:function(){try{if(g){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(At){var kt=At}Reflect.construct(p,[],Bt)}else{try{Bt.call()}catch(At){kt=At}p.call(Bt.prototype)}}else{try{throw Error()}catch(At){kt=At}(Bt=p())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(At){if(At&&kt&&typeof At.stack=="string")return[At.stack,kt.stack]}return[null,null]}};T.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(T.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(T.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var q=T.DetermineComponentFrameRoot(),ue=q[0],Re=q[1];if(ue&&Re){var Ye=ue.split(`
`),wt=Re.split(`
`);for(j=T=0;T<Ye.length&&!Ye[T].includes("DetermineComponentFrameRoot");)T++;for(;j<wt.length&&!wt[j].includes("DetermineComponentFrameRoot");)j++;if(T===Ye.length||j===wt.length)for(T=Ye.length-1,j=wt.length-1;1<=T&&0<=j&&Ye[T]!==wt[j];)j--;for(;1<=T&&0<=j;T--,j--)if(Ye[T]!==wt[j]){if(T!==1||j!==1)do if(T--,j--,0>j||Ye[T]!==wt[j]){var Dt=`
`+Ye[T].replace(" at new "," at ");return p.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",p.displayName)),Dt}while(1<=T&&0<=j);break}}}finally{ff=!1,Error.prepareStackTrace=_}return(_=p?p.displayName||p.name:"")?bl(_):""}function Dr(p){switch(p.tag){case 26:case 27:case 5:return bl(p.type);case 16:return bl("Lazy");case 13:return bl("Suspense");case 19:return bl("SuspenseList");case 0:case 15:return ig(p.type,!1);case 11:return ig(p.type.render,!1);case 1:return ig(p.type,!0);case 31:return bl("Activity");default:return""}}function Cb(p){try{var g="";do g+=Dr(p),p=p.return;while(p);return g}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function Va(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function kb(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Ns(p){var g=kb(p)?"checked":"value",_=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),T=""+p[g];if(!p.hasOwnProperty(g)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var j=_.get,q=_.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return j.call(this)},set:function(ue){T=""+ue,q.call(this,ue)}}),Object.defineProperty(p,g,{enumerable:_.enumerable}),{getValue:function(){return T},setValue:function(ue){T=""+ue},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Vc(p){p._valueTracker||(p._valueTracker=Ns(p))}function hf(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var _=g.getValue(),T="";return p&&(T=kb(p)?p.checked?"true":"false":p.value),p=T,p!==_?(g.setValue(p),!0):!1}function nc(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var Eb=/[\n"\\]/g;function Ca(p){return p.replace(Eb,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function pf(p,g,_,T,j,q,ue,Re){p.name="",ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?p.type=ue:p.removeAttribute("type"),g!=null?ue==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Va(g)):p.value!==""+Va(g)&&(p.value=""+Va(g)):ue!=="submit"&&ue!=="reset"||p.removeAttribute("value"),g!=null?mf(p,ue,Va(g)):_!=null?mf(p,ue,Va(_)):T!=null&&p.removeAttribute("value"),j==null&&q!=null&&(p.defaultChecked=!!q),j!=null&&(p.checked=j&&typeof j!="function"&&typeof j!="symbol"),Re!=null&&typeof Re!="function"&&typeof Re!="symbol"&&typeof Re!="boolean"?p.name=""+Va(Re):p.removeAttribute("name")}function Tb(p,g,_,T,j,q,ue,Re){if(q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(p.type=q),g!=null||_!=null){if(!(q!=="submit"&&q!=="reset"||g!=null))return;_=_!=null?""+Va(_):"",g=g!=null?""+Va(g):_,Re||g===p.value||(p.value=g),p.defaultValue=g}T=T??j,T=typeof T!="function"&&typeof T!="symbol"&&!!T,p.checked=Re?p.checked:!!T,p.defaultChecked=!!T,ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"&&(p.name=ue)}function mf(p,g,_){g==="number"&&nc(p.ownerDocument)===p||p.defaultValue===""+_||(p.defaultValue=""+_)}function Wu(p,g,_,T){if(p=p.options,g){g={};for(var j=0;j<_.length;j++)g["$"+_[j]]=!0;for(_=0;_<p.length;_++)j=g.hasOwnProperty("$"+p[_].value),p[_].selected!==j&&(p[_].selected=j),j&&T&&(p[_].defaultSelected=!0)}else{for(_=""+Va(_),g=null,j=0;j<p.length;j++){if(p[j].value===_){p[j].selected=!0,T&&(p[j].defaultSelected=!0);return}g!==null||p[j].disabled||(g=p[j])}g!==null&&(g.selected=!0)}}function gf(p,g,_){if(g!=null&&(g=""+Va(g),g!==p.value&&(p.value=g),_==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=_!=null?""+Va(_):""}function Ab(p,g,_,T){if(g==null){if(T!=null){if(_!=null)throw Error(r(92));if(Z(T)){if(1<T.length)throw Error(r(93));T=T[0]}_=T}_==null&&(_=""),g=_}_=Va(g),p.defaultValue=_,T=p.textContent,T===_&&T!==""&&T!==null&&(p.value=T)}function yf(p,g){if(g){var _=p.firstChild;if(_&&_===p.lastChild&&_.nodeType===3){_.nodeValue=g;return}}p.textContent=g}var Hr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ag(p,g,_){var T=g.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?T?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":T?p.setProperty(g,_):typeof _!="number"||_===0||Hr.has(g)?g==="float"?p.cssFloat=_:p[g]=(""+_).trim():p[g]=_+"px"}function b_(p,g,_){if(g!=null&&typeof g!="object")throw Error(r(62));if(p=p.style,_!=null){for(var T in _)!_.hasOwnProperty(T)||g!=null&&g.hasOwnProperty(T)||(T.indexOf("--")===0?p.setProperty(T,""):T==="float"?p.cssFloat="":p[T]="");for(var j in g)T=g[j],g.hasOwnProperty(j)&&_[j]!==T&&ag(p,j,T)}else for(var q in g)g.hasOwnProperty(q)&&ag(p,q,g[q])}function Rb(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wa=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),bf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Hu(p){return bf.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var vl=null;function og(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Gu=null,Ls=null;function Vo(p){var g=Rr(p);if(g&&(p=g.stateNode)){var _=p[Oe]||null;e:switch(p=g.stateNode,g.type){case"input":if(pf(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),g=_.name,_.type==="radio"&&g!=null){for(_=p;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+Ca(""+g)+'"][type="radio"]'),g=0;g<_.length;g++){var T=_[g];if(T!==p&&T.form===p.form){var j=T[Oe]||null;if(!j)throw Error(r(90));pf(T,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(g=0;g<_.length;g++)T=_[g],T.form===p.form&&hf(T)}break e;case"textarea":gf(p,_.value,_.defaultValue);break e;case"select":g=_.value,g!=null&&Wu(p,!!_.multiple,g,!1)}}}var Ku=!1;function vf(p,g,_){if(Ku)return p(g,_);Ku=!0;try{var T=p(g);return T}finally{if(Ku=!1,(Gu!==null||Ls!==null)&&(aS(),Gu&&(g=Gu,p=Ls,Ls=Gu=null,Vo(g),p)))for(g=0;g<p.length;g++)Vo(p[g])}}function Yu(p,g){var _=p.stateNode;if(_===null)return null;var T=_[Oe]||null;if(T===null)return null;_=T[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(p=p.type,T=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!T;break e;default:p=!1}if(p)return null;if(_&&typeof _!="function")throw Error(r(231,g,typeof _));return _}var Ki=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nb=!1;if(Ki)try{var ka={};Object.defineProperty(ka,"passive",{get:function(){Nb=!0}}),window.addEventListener("test",ka,ka),window.removeEventListener("test",ka,ka)}catch{Nb=!1}var xl=null,lg=null,xf=null;function wf(){if(xf)return xf;var p,g=lg,_=g.length,T,j="value"in xl?xl.value:xl.textContent,q=j.length;for(p=0;p<_&&g[p]===j[p];p++);var ue=_-p;for(T=1;T<=ue&&g[_-T]===j[q-T];T++);return xf=j.slice(p,1<T?1-T:void 0)}function _f(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function hp(){return!0}function v_(){return!1}function _i(p){function g(_,T,j,q,ue){this._reactName=_,this._targetInst=j,this.type=T,this.nativeEvent=q,this.target=ue,this.currentTarget=null;for(var Re in p)p.hasOwnProperty(Re)&&(_=p[Re],this[Re]=_?_(q):q[Re]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?hp:v_,this.isPropagationStopped=v_,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=hp)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=hp)},persist:function(){},isPersistent:hp}),g}var Zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cg=_i(Zu),Wc=u({},Zu,{view:0,detail:0}),ug=_i(Wc),pp,Mb,mp,dg=u({},Wc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xu,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==mp&&(mp&&p.type==="mousemove"?(pp=p.screenX-mp.screenX,Mb=p.screenY-mp.screenY):Mb=pp=0,mp=p),pp)},movementY:function(p){return"movementY"in p?p.movementY:Mb}}),fg=_i(dg),Ib=u({},dg,{dataTransfer:0}),x_=_i(Ib),hg=u({},Wc,{relatedTarget:0}),Sf=_i(hg),pg=u({},Zu,{animationName:0,elapsedTime:0,pseudoElement:0}),w_=_i(pg),_A=u({},Zu,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),mg=_i(_A),jb=u({},Zu,{data:0}),gg=_i(jb),Pb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ob={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gp(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=Yi[p])?!!g[p]:!1}function Xu(){return gp}var __=u({},Wc,{key:function(p){if(p.key){var g=Pb[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=_f(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?Ob[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xu,charCode:function(p){return p.type==="keypress"?_f(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?_f(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),yg=_i(__),S_=u({},dg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Db=_i(S_),bg=u({},Wc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xu}),Fb=_i(bg),Ju=u({},Zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Lb=_i(Ju),Bb=u({},dg,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),vg=_i(Bb),$b=u({},Zu,{newState:0,oldState:0}),C_=_i($b),SA=[9,13,27,32],yp=Ki&&"CompositionEvent"in window,Hc=null;Ki&&"documentMode"in document&&(Hc=document.documentMode);var CA=Ki&&"TextEvent"in window&&!Hc,xg=Ki&&(!yp||Hc&&8<Hc&&11>=Hc),wg=" ",k_=!1;function zb(p,g){switch(p){case"keyup":return SA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function E_(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var Qu=!1;function T_(p,g){switch(p){case"compositionend":return E_(g);case"keypress":return g.which!==32?null:(k_=!0,wg);case"textInput":return p=g.data,p===wg&&k_?null:p;default:return null}}function kA(p,g){if(Qu)return p==="compositionend"||!yp&&zb(p,g)?(p=wf(),xf=lg=xl=null,Qu=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return xg&&g.locale!=="ko"?null:g.data;default:return null}}var A_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _g(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!A_[p.type]:g==="textarea"}function Ub(p,g,_,T){Gu?Ls?Ls.push(T):Ls=[T]:Gu=T,g=fS(g,"onChange"),0<g.length&&(_=new cg("onChange","change",null,_,T),p.push({event:_,listeners:g}))}var Cf=null,bp=null;function EA(p){EL(p,0)}function Sg(p){var g=ns(p);if(hf(g))return p}function vp(p,g){if(p==="change")return g}var wl=!1;if(Ki){var Bs;if(Ki){var kf="oninput"in document;if(!kf){var Ha=document.createElement("div");Ha.setAttribute("oninput","return;"),kf=typeof Ha.oninput=="function"}Bs=kf}else Bs=!1;wl=Bs&&(!document.documentMode||9<document.documentMode)}function R_(){Cf&&(Cf.detachEvent("onpropertychange",Cg),bp=Cf=null)}function Cg(p){if(p.propertyName==="value"&&Sg(bp)){var g=[];Ub(g,bp,p,og(p)),vf(EA,g)}}function N_(p,g,_){p==="focusin"?(R_(),Cf=g,bp=_,Cf.attachEvent("onpropertychange",Cg)):p==="focusout"&&R_()}function ed(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Sg(bp)}function qb(p,g){if(p==="click")return Sg(g)}function Ef(p,g){if(p==="input"||p==="change")return Sg(g)}function Gc(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var Ea=typeof Object.is=="function"?Object.is:Gc;function M(p,g){if(Ea(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var _=Object.keys(p),T=Object.keys(g);if(_.length!==T.length)return!1;for(T=0;T<_.length;T++){var j=_[T];if(!We.call(g,j)||!Ea(p[j],g[j]))return!1}return!0}function z(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function te(p,g){var _=z(p);p=0;for(var T;_;){if(_.nodeType===3){if(T=p+_.textContent.length,p<=g&&T>=g)return{node:_,offset:g-p};p=T}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=z(_)}}function ae(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?ae(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function pe(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=nc(p.document);g instanceof p.HTMLIFrameElement;){try{var _=typeof g.contentWindow.location.href=="string"}catch{_=!1}if(_)p=g.contentWindow;else break;g=nc(p.document)}return g}function Ee(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Le=Ki&&"documentMode"in document&&11>=document.documentMode,He=null,nt=null,it=null,dt=!1;function Xe(p,g,_){var T=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;dt||He==null||He!==nc(T)||(T=He,"selectionStart"in T&&Ee(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),it&&M(it,T)||(it=T,T=fS(nt,"onSelect"),0<T.length&&(g=new cg("onSelect","select",null,g,_),p.push({event:g,listeners:T}),g.target=He)))}function mt(p,g){var _={};return _[p.toLowerCase()]=g.toLowerCase(),_["Webkit"+p]="webkit"+g,_["Moz"+p]="moz"+g,_}var tt={animationend:mt("Animation","AnimationEnd"),animationiteration:mt("Animation","AnimationIteration"),animationstart:mt("Animation","AnimationStart"),transitionrun:mt("Transition","TransitionRun"),transitionstart:mt("Transition","TransitionStart"),transitioncancel:mt("Transition","TransitionCancel"),transitionend:mt("Transition","TransitionEnd")},ut={},gt={};Ki&&(gt=document.createElement("div").style,"AnimationEvent"in window||(delete tt.animationend.animation,delete tt.animationiteration.animation,delete tt.animationstart.animation),"TransitionEvent"in window||delete tt.transitionend.transition);function at(p){if(ut[p])return ut[p];if(!tt[p])return p;var g=tt[p],_;for(_ in g)if(g.hasOwnProperty(_)&&_ in gt)return ut[p]=g[_];return p}var Ct=at("animationend"),Nt=at("animationiteration"),Mt=at("animationstart"),Ot=at("transitionrun"),Yt=at("transitionstart"),rn=at("transitioncancel"),Ht=at("transitionend"),Jt=new Map,an="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");an.push("scrollEnd");function Gt(p,g){Jt.set(p,g),Vt(g,[p])}var mn=new WeakMap;function Bn(p,g){if(typeof p=="object"&&p!==null){var _=mn.get(p);return _!==void 0?_:(g={value:p,source:g,stack:Cb(g)},mn.set(p,g),g)}return{value:p,source:g,stack:Cb(g)}}var qn=[],hr=0,fa=0;function sr(){for(var p=hr,g=fa=hr=0;g<p;){var _=qn[g];qn[g++]=null;var T=qn[g];qn[g++]=null;var j=qn[g];qn[g++]=null;var q=qn[g];if(qn[g++]=null,T!==null&&j!==null){var ue=T.pending;ue===null?j.next=j:(j.next=ue.next,ue.next=j),T.pending=j}q!==0&&Zi(_,j,q)}}function di(p,g,_,T){qn[hr++]=p,qn[hr++]=g,qn[hr++]=_,qn[hr++]=T,fa|=T,p.lanes|=T,p=p.alternate,p!==null&&(p.lanes|=T)}function Si(p,g,_,T){return di(p,g,_,T),_l(p)}function rc(p,g){return di(p,null,null,g),_l(p)}function Zi(p,g,_){p.lanes|=_;var T=p.alternate;T!==null&&(T.lanes|=_);for(var j=!1,q=p.return;q!==null;)q.childLanes|=_,T=q.alternate,T!==null&&(T.childLanes|=_),q.tag===22&&(p=q.stateNode,p===null||p._visibility&1||(j=!0)),p=q,q=q.return;return p.tag===3?(q=p.stateNode,j&&g!==null&&(j=31-en(_),p=q.hiddenUpdates,T=p[j],T===null?p[j]=[g]:T.push(g),g.lane=_|536870912),q):null}function _l(p){if(50<pv)throw pv=0,IR=null,Error(r(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var Kc={};function Lde(p,g,_,T){this.tag=p,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wo(p,g,_,T){return new Lde(p,g,_,T)}function TA(p){return p=p.prototype,!(!p||!p.isReactComponent)}function td(p,g){var _=p.alternate;return _===null?(_=Wo(p.tag,g,p.key,p.mode),_.elementType=p.elementType,_.type=p.type,_.stateNode=p.stateNode,_.alternate=p,p.alternate=_):(_.pendingProps=g,_.type=p.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=p.flags&65011712,_.childLanes=p.childLanes,_.lanes=p.lanes,_.child=p.child,_.memoizedProps=p.memoizedProps,_.memoizedState=p.memoizedState,_.updateQueue=p.updateQueue,g=p.dependencies,_.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},_.sibling=p.sibling,_.index=p.index,_.ref=p.ref,_.refCleanup=p.refCleanup,_}function dF(p,g){p.flags&=65011714;var _=p.alternate;return _===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=_.childLanes,p.lanes=_.lanes,p.child=_.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=_.memoizedProps,p.memoizedState=_.memoizedState,p.updateQueue=_.updateQueue,p.type=_.type,g=_.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function M_(p,g,_,T,j,q){var ue=0;if(T=p,typeof p=="function")TA(p)&&(ue=1);else if(typeof p=="string")ue=$fe(p,_,me.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case I:return p=Wo(31,_,g,j),p.elementType=I,p.lanes=q,p;case y:return xp(_.children,j,q,g);case b:ue=8,j|=24;break;case v:return p=Wo(12,_,g,j|2),p.elementType=v,p.lanes=q,p;case C:return p=Wo(13,_,g,j),p.elementType=C,p.lanes=q,p;case R:return p=Wo(19,_,g,j),p.elementType=R,p.lanes=q,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case S:ue=10;break e;case w:ue=9;break e;case k:ue=11;break e;case A:ue=14;break e;case N:ue=16,T=null;break e}ue=29,_=Error(r(130,p===null?"null":typeof p,"")),T=null}return g=Wo(ue,_,g,j),g.elementType=p,g.type=T,g.lanes=q,g}function xp(p,g,_,T){return p=Wo(7,p,T,g),p.lanes=_,p}function AA(p,g,_){return p=Wo(6,p,null,g),p.lanes=_,p}function RA(p,g,_){return g=Wo(4,p.children!==null?p.children:[],p.key,g),g.lanes=_,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var kg=[],Eg=0,I_=null,j_=0,Sl=[],Cl=0,wp=null,nd=1,rd="";function _p(p,g){kg[Eg++]=j_,kg[Eg++]=I_,I_=p,j_=g}function fF(p,g,_){Sl[Cl++]=nd,Sl[Cl++]=rd,Sl[Cl++]=wp,wp=p;var T=nd;p=rd;var j=32-en(T)-1;T&=~(1<<j),_+=1;var q=32-en(g)+j;if(30<q){var ue=j-j%5;q=(T&(1<<ue)-1).toString(32),T>>=ue,j-=ue,nd=1<<32-en(g)+j|_<<j|T,rd=q+p}else nd=1<<q|_<<j|T,rd=p}function NA(p){p.return!==null&&(_p(p,1),fF(p,1,0))}function MA(p){for(;p===I_;)I_=kg[--Eg],kg[Eg]=null,j_=kg[--Eg],kg[Eg]=null;for(;p===wp;)wp=Sl[--Cl],Sl[Cl]=null,rd=Sl[--Cl],Sl[Cl]=null,nd=Sl[--Cl],Sl[Cl]=null}var Ga=null,ii=null,ss=!1,Sp=null,Yc=!1,IA=Error(r(519));function Cp(p){var g=Error(r(418,""));throw Hb(Bn(g,p)),IA}function hF(p){var g=p.stateNode,_=p.type,T=p.memoizedProps;switch(g[ve]=p,g[Oe]=T,_){case"dialog":Lr("cancel",g),Lr("close",g);break;case"iframe":case"object":case"embed":Lr("load",g);break;case"video":case"audio":for(_=0;_<gv.length;_++)Lr(gv[_],g);break;case"source":Lr("error",g);break;case"img":case"image":case"link":Lr("error",g),Lr("load",g);break;case"details":Lr("toggle",g);break;case"input":Lr("invalid",g),Tb(g,T.value,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name,!0),Vc(g);break;case"select":Lr("invalid",g);break;case"textarea":Lr("invalid",g),Ab(g,T.value,T.defaultValue,T.children),Vc(g)}_=T.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||g.textContent===""+_||T.suppressHydrationWarning===!0||NL(g.textContent,_)?(T.popover!=null&&(Lr("beforetoggle",g),Lr("toggle",g)),T.onScroll!=null&&Lr("scroll",g),T.onScrollEnd!=null&&Lr("scrollend",g),T.onClick!=null&&(g.onclick=hS),g=!0):g=!1,g||Cp(p)}function pF(p){for(Ga=p.return;Ga;)switch(Ga.tag){case 5:case 13:Yc=!1;return;case 27:case 3:Yc=!0;return;default:Ga=Ga.return}}function Vb(p){if(p!==Ga)return!1;if(!ss)return pF(p),ss=!0,!1;var g=p.tag,_;if((_=g!==3&&g!==27)&&((_=g===5)&&(_=p.type,_=!(_!=="form"&&_!=="button")||KR(p.type,p.memoizedProps)),_=!_),_&&ii&&Cp(p),pF(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(_=p.data,_==="/$"){if(g===0){ii=ic(p.nextSibling);break e}g--}else _!=="$"&&_!=="$!"&&_!=="$?"||g++;p=p.nextSibling}ii=null}}else g===27?(g=ii,Uf(p.type)?(p=JR,JR=null,ii=p):ii=g):ii=Ga?ic(p.stateNode.nextSibling):null;return!0}function Wb(){ii=Ga=null,ss=!1}function mF(){var p=Sp;return p!==null&&(go===null?go=p:go.push.apply(go,p),Sp=null),p}function Hb(p){Sp===null?Sp=[p]:Sp.push(p)}var jA=Q(null),kp=null,sd=null;function Tf(p,g,_){se(jA,g._currentValue),g._currentValue=_}function id(p){p._currentValue=jA.current,ee(jA)}function PA(p,g,_){for(;p!==null;){var T=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,T!==null&&(T.childLanes|=g)):T!==null&&(T.childLanes&g)!==g&&(T.childLanes|=g),p===_)break;p=p.return}}function OA(p,g,_,T){var j=p.child;for(j!==null&&(j.return=p);j!==null;){var q=j.dependencies;if(q!==null){var ue=j.child;q=q.firstContext;e:for(;q!==null;){var Re=q;q=j;for(var Ye=0;Ye<g.length;Ye++)if(Re.context===g[Ye]){q.lanes|=_,Re=q.alternate,Re!==null&&(Re.lanes|=_),PA(q.return,_,p),T||(ue=null);break e}q=Re.next}}else if(j.tag===18){if(ue=j.return,ue===null)throw Error(r(341));ue.lanes|=_,q=ue.alternate,q!==null&&(q.lanes|=_),PA(ue,_,p),ue=null}else ue=j.child;if(ue!==null)ue.return=j;else for(ue=j;ue!==null;){if(ue===p){ue=null;break}if(j=ue.sibling,j!==null){j.return=ue.return,ue=j;break}ue=ue.return}j=ue}}function Gb(p,g,_,T){p=null;for(var j=g,q=!1;j!==null;){if(!q){if((j.flags&524288)!==0)q=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var ue=j.alternate;if(ue===null)throw Error(r(387));if(ue=ue.memoizedProps,ue!==null){var Re=j.type;Ea(j.pendingProps.value,ue.value)||(p!==null?p.push(Re):p=[Re])}}else if(j===De.current){if(ue=j.alternate,ue===null)throw Error(r(387));ue.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(p!==null?p.push(_v):p=[_v])}j=j.return}p!==null&&OA(g,p,_,T),g.flags|=262144}function P_(p){for(p=p.firstContext;p!==null;){if(!Ea(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Ep(p){kp=p,sd=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Ta(p){return gF(kp,p)}function O_(p,g){return kp===null&&Ep(p),gF(p,g)}function gF(p,g){var _=g._currentValue;if(g={context:g,memoizedValue:_,next:null},sd===null){if(p===null)throw Error(r(308));sd=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else sd=sd.next=g;return _}var Bde=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(_,T){p.push(T)}};this.abort=function(){g.aborted=!0,p.forEach(function(_){return _()})}},$de=e.unstable_scheduleCallback,zde=e.unstable_NormalPriority,Oi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function DA(){return{controller:new Bde,data:new Map,refCount:0}}function Kb(p){p.refCount--,p.refCount===0&&$de(zde,function(){p.controller.abort()})}var Yb=null,FA=0,Tg=0,Ag=null;function Ude(p,g){if(Yb===null){var _=Yb=[];FA=0,Tg=BR(),Ag={status:"pending",value:void 0,then:function(T){_.push(T)}}}return FA++,g.then(yF,yF),g}function yF(){if(--FA===0&&Yb!==null){Ag!==null&&(Ag.status="fulfilled");var p=Yb;Yb=null,Tg=0,Ag=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function qde(p,g){var _=[],T={status:"pending",value:null,reason:null,then:function(j){_.push(j)}};return p.then(function(){T.status="fulfilled",T.value=g;for(var j=0;j<_.length;j++)(0,_[j])(g)},function(j){for(T.status="rejected",T.reason=j,j=0;j<_.length;j++)(0,_[j])(void 0)}),T}var bF=U.S;U.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&Ude(p,g),bF!==null&&bF(p,g)};var Tp=Q(null);function LA(){var p=Tp.current;return p!==null?p:Os.pooledCache}function D_(p,g){g===null?se(Tp,Tp.current):se(Tp,g.pool)}function vF(){var p=LA();return p===null?null:{parent:Oi._currentValue,pool:p}}var Zb=Error(r(460)),xF=Error(r(474)),F_=Error(r(542)),BA={then:function(){}};function wF(p){return p=p.status,p==="fulfilled"||p==="rejected"}function L_(){}function _F(p,g,_){switch(_=p[_],_===void 0?p.push(g):_!==g&&(g.then(L_,L_),g=_),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,CF(p),p;default:if(typeof g.status=="string")g.then(L_,L_);else{if(p=Os,p!==null&&100<p.shellSuspendCounter)throw Error(r(482));p=g,p.status="pending",p.then(function(T){if(g.status==="pending"){var j=g;j.status="fulfilled",j.value=T}},function(T){if(g.status==="pending"){var j=g;j.status="rejected",j.reason=T}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,CF(p),p}throw Xb=g,Zb}}var Xb=null;function SF(){if(Xb===null)throw Error(r(459));var p=Xb;return Xb=null,p}function CF(p){if(p===Zb||p===F_)throw Error(r(483))}var Af=!1;function $A(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zA(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Rf(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Nf(p,g,_){var T=p.updateQueue;if(T===null)return null;if(T=T.shared,(gs&2)!==0){var j=T.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),T.pending=g,g=_l(p),Zi(p,null,_),g}return di(p,T,g,_),_l(p)}function Jb(p,g,_){if(g=g.updateQueue,g!==null&&(g=g.shared,(_&4194048)!==0)){var T=g.lanes;T&=p.pendingLanes,_|=T,g.lanes=_,Ue(p,_)}}function UA(p,g){var _=p.updateQueue,T=p.alternate;if(T!==null&&(T=T.updateQueue,_===T)){var j=null,q=null;if(_=_.firstBaseUpdate,_!==null){do{var ue={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};q===null?j=q=ue:q=q.next=ue,_=_.next}while(_!==null);q===null?j=q=g:q=q.next=g}else j=q=g;_={baseState:T.baseState,firstBaseUpdate:j,lastBaseUpdate:q,shared:T.shared,callbacks:T.callbacks},p.updateQueue=_;return}p=_.lastBaseUpdate,p===null?_.firstBaseUpdate=g:p.next=g,_.lastBaseUpdate=g}var qA=!1;function Qb(){if(qA){var p=Ag;if(p!==null)throw p}}function ev(p,g,_,T){qA=!1;var j=p.updateQueue;Af=!1;var q=j.firstBaseUpdate,ue=j.lastBaseUpdate,Re=j.shared.pending;if(Re!==null){j.shared.pending=null;var Ye=Re,wt=Ye.next;Ye.next=null,ue===null?q=wt:ue.next=wt,ue=Ye;var Dt=p.alternate;Dt!==null&&(Dt=Dt.updateQueue,Re=Dt.lastBaseUpdate,Re!==ue&&(Re===null?Dt.firstBaseUpdate=wt:Re.next=wt,Dt.lastBaseUpdate=Ye))}if(q!==null){var Bt=j.baseState;ue=0,Dt=wt=Ye=null,Re=q;do{var kt=Re.lane&-536870913,At=kt!==Re.lane;if(At?(Gr&kt)===kt:(T&kt)===kt){kt!==0&&kt===Tg&&(qA=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:Re.tag,payload:Re.payload,callback:null,next:null});e:{var ir=p,Vn=Re;kt=g;var Cs=_;switch(Vn.tag){case 1:if(ir=Vn.payload,typeof ir=="function"){Bt=ir.call(Cs,Bt,kt);break e}Bt=ir;break e;case 3:ir.flags=ir.flags&-65537|128;case 0:if(ir=Vn.payload,kt=typeof ir=="function"?ir.call(Cs,Bt,kt):ir,kt==null)break e;Bt=u({},Bt,kt);break e;case 2:Af=!0}}kt=Re.callback,kt!==null&&(p.flags|=64,At&&(p.flags|=8192),At=j.callbacks,At===null?j.callbacks=[kt]:At.push(kt))}else At={lane:kt,tag:Re.tag,payload:Re.payload,callback:Re.callback,next:null},Dt===null?(wt=Dt=At,Ye=Bt):Dt=Dt.next=At,ue|=kt;if(Re=Re.next,Re===null){if(Re=j.shared.pending,Re===null)break;At=Re,Re=At.next,At.next=null,j.lastBaseUpdate=At,j.shared.pending=null}}while(!0);Dt===null&&(Ye=Bt),j.baseState=Ye,j.firstBaseUpdate=wt,j.lastBaseUpdate=Dt,q===null&&(j.shared.lanes=0),Lf|=ue,p.lanes=ue,p.memoizedState=Bt}}function kF(p,g){if(typeof p!="function")throw Error(r(191,p));p.call(g)}function EF(p,g){var _=p.callbacks;if(_!==null)for(p.callbacks=null,p=0;p<_.length;p++)kF(_[p],g)}var Rg=Q(null),B_=Q(0);function TF(p,g){p=fd,se(B_,p),se(Rg,g),fd=p|g.baseLanes}function VA(){se(B_,fd),se(Rg,Rg.current)}function WA(){fd=B_.current,ee(Rg),ee(B_)}var Mf=0,Ir=null,_s=null,Ci=null,$_=!1,Ng=!1,Ap=!1,z_=0,tv=0,Mg=null,Vde=0;function fi(){throw Error(r(321))}function HA(p,g){if(g===null)return!1;for(var _=0;_<g.length&&_<p.length;_++)if(!Ea(p[_],g[_]))return!1;return!0}function GA(p,g,_,T,j,q){return Mf=q,Ir=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,U.H=p===null||p.memoizedState===null?u8:d8,Ap=!1,q=_(T,j),Ap=!1,Ng&&(q=RF(g,_,T,j)),AF(p),q}function AF(p){U.H=G_;var g=_s!==null&&_s.next!==null;if(Mf=0,Ci=_s=Ir=null,$_=!1,tv=0,Mg=null,g)throw Error(r(300));p===null||Xi||(p=p.dependencies,p!==null&&P_(p)&&(Xi=!0))}function RF(p,g,_,T){Ir=p;var j=0;do{if(Ng&&(Mg=null),tv=0,Ng=!1,25<=j)throw Error(r(301));if(j+=1,Ci=_s=null,p.updateQueue!=null){var q=p.updateQueue;q.lastEffect=null,q.events=null,q.stores=null,q.memoCache!=null&&(q.memoCache.index=0)}U.H=Xde,q=g(_,T)}while(Ng);return q}function Wde(){var p=U.H,g=p.useState()[0];return g=typeof g.then=="function"?nv(g):g,p=p.useState()[0],(_s!==null?_s.memoizedState:null)!==p&&(Ir.flags|=1024),g}function KA(){var p=z_!==0;return z_=0,p}function YA(p,g,_){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_}function ZA(p){if($_){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}$_=!1}Mf=0,Ci=_s=Ir=null,Ng=!1,tv=z_=0,Mg=null}function po(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ci===null?Ir.memoizedState=Ci=p:Ci=Ci.next=p,Ci}function ki(){if(_s===null){var p=Ir.alternate;p=p!==null?p.memoizedState:null}else p=_s.next;var g=Ci===null?Ir.memoizedState:Ci.next;if(g!==null)Ci=g,_s=p;else{if(p===null)throw Ir.alternate===null?Error(r(467)):Error(r(310));_s=p,p={memoizedState:_s.memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},Ci===null?Ir.memoizedState=Ci=p:Ci=Ci.next=p}return Ci}function XA(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nv(p){var g=tv;return tv+=1,Mg===null&&(Mg=[]),p=_F(Mg,p,g),g=Ir,(Ci===null?g.memoizedState:Ci.next)===null&&(g=g.alternate,U.H=g===null||g.memoizedState===null?u8:d8),p}function U_(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return nv(p);if(p.$$typeof===S)return Ta(p)}throw Error(r(438,String(p)))}function JA(p){var g=null,_=Ir.updateQueue;if(_!==null&&(g=_.memoCache),g==null){var T=Ir.alternate;T!==null&&(T=T.updateQueue,T!==null&&(T=T.memoCache,T!=null&&(g={data:T.data.map(function(j){return j.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),_===null&&(_=XA(),Ir.updateQueue=_),_.memoCache=g,_=g.data[g.index],_===void 0)for(_=g.data[g.index]=Array(p),T=0;T<p;T++)_[T]=O;return g.index++,_}function ad(p,g){return typeof g=="function"?g(p):g}function q_(p){var g=ki();return QA(g,_s,p)}function QA(p,g,_){var T=p.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=_;var j=p.baseQueue,q=T.pending;if(q!==null){if(j!==null){var ue=j.next;j.next=q.next,q.next=ue}g.baseQueue=j=q,T.pending=null}if(q=p.baseState,j===null)p.memoizedState=q;else{g=j.next;var Re=ue=null,Ye=null,wt=g,Dt=!1;do{var Bt=wt.lane&-536870913;if(Bt!==wt.lane?(Gr&Bt)===Bt:(Mf&Bt)===Bt){var kt=wt.revertLane;if(kt===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null}),Bt===Tg&&(Dt=!0);else if((Mf&kt)===kt){wt=wt.next,kt===Tg&&(Dt=!0);continue}else Bt={lane:0,revertLane:wt.revertLane,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},Ye===null?(Re=Ye=Bt,ue=q):Ye=Ye.next=Bt,Ir.lanes|=kt,Lf|=kt;Bt=wt.action,Ap&&_(q,Bt),q=wt.hasEagerState?wt.eagerState:_(q,Bt)}else kt={lane:Bt,revertLane:wt.revertLane,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},Ye===null?(Re=Ye=kt,ue=q):Ye=Ye.next=kt,Ir.lanes|=Bt,Lf|=Bt;wt=wt.next}while(wt!==null&&wt!==g);if(Ye===null?ue=q:Ye.next=Re,!Ea(q,p.memoizedState)&&(Xi=!0,Dt&&(_=Ag,_!==null)))throw _;p.memoizedState=q,p.baseState=ue,p.baseQueue=Ye,T.lastRenderedState=q}return j===null&&(T.lanes=0),[p.memoizedState,T.dispatch]}function eR(p){var g=ki(),_=g.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=p;var T=_.dispatch,j=_.pending,q=g.memoizedState;if(j!==null){_.pending=null;var ue=j=j.next;do q=p(q,ue.action),ue=ue.next;while(ue!==j);Ea(q,g.memoizedState)||(Xi=!0),g.memoizedState=q,g.baseQueue===null&&(g.baseState=q),_.lastRenderedState=q}return[q,T]}function NF(p,g,_){var T=Ir,j=ki(),q=ss;if(q){if(_===void 0)throw Error(r(407));_=_()}else _=g();var ue=!Ea((_s||j).memoizedState,_);ue&&(j.memoizedState=_,Xi=!0),j=j.queue;var Re=jF.bind(null,T,j,p);if(rv(2048,8,Re,[p]),j.getSnapshot!==g||ue||Ci!==null&&Ci.memoizedState.tag&1){if(T.flags|=2048,Ig(9,V_(),IF.bind(null,T,j,_,g),null),Os===null)throw Error(r(349));q||(Mf&124)!==0||MF(T,g,_)}return _}function MF(p,g,_){p.flags|=16384,p={getSnapshot:g,value:_},g=Ir.updateQueue,g===null?(g=XA(),Ir.updateQueue=g,g.stores=[p]):(_=g.stores,_===null?g.stores=[p]:_.push(p))}function IF(p,g,_,T){g.value=_,g.getSnapshot=T,PF(g)&&OF(p)}function jF(p,g,_){return _(function(){PF(g)&&OF(p)})}function PF(p){var g=p.getSnapshot;p=p.value;try{var _=g();return!Ea(p,_)}catch{return!0}}function OF(p){var g=rc(p,2);g!==null&&Zo(g,p,2)}function tR(p){var g=po();if(typeof p=="function"){var _=p;if(p=_(),Ap){Lt(!0);try{_()}finally{Lt(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:p},g}function DF(p,g,_,T){return p.baseState=_,QA(p,_s,typeof T=="function"?T:ad)}function Hde(p,g,_,T,j){if(H_(p))throw Error(r(485));if(p=g.action,p!==null){var q={payload:j,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ue){q.listeners.push(ue)}};U.T!==null?_(!0):q.isTransition=!1,T(q),_=g.pending,_===null?(q.next=g.pending=q,FF(g,q)):(q.next=_.next,g.pending=_.next=q)}}function FF(p,g){var _=g.action,T=g.payload,j=p.state;if(g.isTransition){var q=U.T,ue={};U.T=ue;try{var Re=_(j,T),Ye=U.S;Ye!==null&&Ye(ue,Re),LF(p,g,Re)}catch(wt){nR(p,g,wt)}finally{U.T=q}}else try{q=_(j,T),LF(p,g,q)}catch(wt){nR(p,g,wt)}}function LF(p,g,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(T){BF(p,g,T)},function(T){return nR(p,g,T)}):BF(p,g,_)}function BF(p,g,_){g.status="fulfilled",g.value=_,$F(g),p.state=_,g=p.pending,g!==null&&(_=g.next,_===g?p.pending=null:(_=_.next,g.next=_,FF(p,_)))}function nR(p,g,_){var T=p.pending;if(p.pending=null,T!==null){T=T.next;do g.status="rejected",g.reason=_,$F(g),g=g.next;while(g!==T)}p.action=null}function $F(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function zF(p,g){return g}function UF(p,g){if(ss){var _=Os.formState;if(_!==null){e:{var T=Ir;if(ss){if(ii){t:{for(var j=ii,q=Yc;j.nodeType!==8;){if(!q){j=null;break t}if(j=ic(j.nextSibling),j===null){j=null;break t}}q=j.data,j=q==="F!"||q==="F"?j:null}if(j){ii=ic(j.nextSibling),T=j.data==="F!";break e}}Cp(T)}T=!1}T&&(g=_[0])}}return _=po(),_.memoizedState=_.baseState=g,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zF,lastRenderedState:g},_.queue=T,_=o8.bind(null,Ir,T),T.dispatch=_,T=tR(!1),q=oR.bind(null,Ir,!1,T.queue),T=po(),j={state:g,dispatch:null,action:p,pending:null},T.queue=j,_=Hde.bind(null,Ir,j,q,_),j.dispatch=_,T.memoizedState=p,[g,_,!1]}function qF(p){var g=ki();return VF(g,_s,p)}function VF(p,g,_){if(g=QA(p,g,zF)[0],p=q_(ad)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var T=nv(g)}catch(ue){throw ue===Zb?F_:ue}else T=g;g=ki();var j=g.queue,q=j.dispatch;return _!==g.memoizedState&&(Ir.flags|=2048,Ig(9,V_(),Gde.bind(null,j,_),null)),[T,q,p]}function Gde(p,g){p.action=g}function WF(p){var g=ki(),_=_s;if(_!==null)return VF(g,_,p);ki(),g=g.memoizedState,_=ki();var T=_.queue.dispatch;return _.memoizedState=p,[g,T,!1]}function Ig(p,g,_,T){return p={tag:p,create:_,deps:T,inst:g,next:null},g=Ir.updateQueue,g===null&&(g=XA(),Ir.updateQueue=g),_=g.lastEffect,_===null?g.lastEffect=p.next=p:(T=_.next,_.next=p,p.next=T,g.lastEffect=p),p}function V_(){return{destroy:void 0,resource:void 0}}function HF(){return ki().memoizedState}function W_(p,g,_,T){var j=po();T=T===void 0?null:T,Ir.flags|=p,j.memoizedState=Ig(1|g,V_(),_,T)}function rv(p,g,_,T){var j=ki();T=T===void 0?null:T;var q=j.memoizedState.inst;_s!==null&&T!==null&&HA(T,_s.memoizedState.deps)?j.memoizedState=Ig(g,q,_,T):(Ir.flags|=p,j.memoizedState=Ig(1|g,q,_,T))}function GF(p,g){W_(8390656,8,p,g)}function KF(p,g){rv(2048,8,p,g)}function YF(p,g){return rv(4,2,p,g)}function ZF(p,g){return rv(4,4,p,g)}function XF(p,g){if(typeof g=="function"){p=p();var _=g(p);return function(){typeof _=="function"?_():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function JF(p,g,_){_=_!=null?_.concat([p]):null,rv(4,4,XF.bind(null,g,p),_)}function rR(){}function QF(p,g){var _=ki();g=g===void 0?null:g;var T=_.memoizedState;return g!==null&&HA(g,T[1])?T[0]:(_.memoizedState=[p,g],p)}function e8(p,g){var _=ki();g=g===void 0?null:g;var T=_.memoizedState;if(g!==null&&HA(g,T[1]))return T[0];if(T=p(),Ap){Lt(!0);try{p()}finally{Lt(!1)}}return _.memoizedState=[T,g],T}function sR(p,g,_){return _===void 0||(Mf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=_,p=rL(),Ir.lanes|=p,Lf|=p,_)}function t8(p,g,_,T){return Ea(_,g)?_:Rg.current!==null?(p=sR(p,_,T),Ea(p,g)||(Xi=!0),p):(Mf&42)===0?(Xi=!0,p.memoizedState=_):(p=rL(),Ir.lanes|=p,Lf|=p,g)}function n8(p,g,_,T,j){var q=H.p;H.p=q!==0&&8>q?q:8;var ue=U.T,Re={};U.T=Re,oR(p,!1,g,_);try{var Ye=j(),wt=U.S;if(wt!==null&&wt(Re,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var Dt=qde(Ye,T);sv(p,g,Dt,Yo(p))}else sv(p,g,T,Yo(p))}catch(Bt){sv(p,g,{then:function(){},status:"rejected",reason:Bt},Yo())}finally{H.p=q,U.T=ue}}function Kde(){}function iR(p,g,_,T){if(p.tag!==5)throw Error(r(476));var j=r8(p).queue;n8(p,j,g,L,_===null?Kde:function(){return s8(p),_(T)})}function r8(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:L},next:null};var _={};return g.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ad,lastRenderedState:_},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function s8(p){var g=r8(p).next.queue;sv(p,g,{},Yo())}function aR(){return Ta(_v)}function i8(){return ki().memoizedState}function a8(){return ki().memoizedState}function Yde(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var _=Yo();p=Rf(_);var T=Nf(g,p,_);T!==null&&(Zo(T,g,_),Jb(T,g,_)),g={cache:DA()},p.payload=g;return}g=g.return}}function Zde(p,g,_){var T=Yo();_={lane:T,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},H_(p)?l8(g,_):(_=Si(p,g,_,T),_!==null&&(Zo(_,p,T),c8(_,g,T)))}function o8(p,g,_){var T=Yo();sv(p,g,_,T)}function sv(p,g,_,T){var j={lane:T,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(H_(p))l8(g,j);else{var q=p.alternate;if(p.lanes===0&&(q===null||q.lanes===0)&&(q=g.lastRenderedReducer,q!==null))try{var ue=g.lastRenderedState,Re=q(ue,_);if(j.hasEagerState=!0,j.eagerState=Re,Ea(Re,ue))return di(p,g,j,0),Os===null&&sr(),!1}catch{}finally{}if(_=Si(p,g,j,T),_!==null)return Zo(_,p,T),c8(_,g,T),!0}return!1}function oR(p,g,_,T){if(T={lane:2,revertLane:BR(),action:T,hasEagerState:!1,eagerState:null,next:null},H_(p)){if(g)throw Error(r(479))}else g=Si(p,_,T,2),g!==null&&Zo(g,p,2)}function H_(p){var g=p.alternate;return p===Ir||g!==null&&g===Ir}function l8(p,g){Ng=$_=!0;var _=p.pending;_===null?g.next=g:(g.next=_.next,_.next=g),p.pending=g}function c8(p,g,_){if((_&4194048)!==0){var T=g.lanes;T&=p.pendingLanes,_|=T,g.lanes=_,Ue(p,_)}}var G_={readContext:Ta,use:U_,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useLayoutEffect:fi,useInsertionEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useSyncExternalStore:fi,useId:fi,useHostTransitionStatus:fi,useFormState:fi,useActionState:fi,useOptimistic:fi,useMemoCache:fi,useCacheRefresh:fi},u8={readContext:Ta,use:U_,useCallback:function(p,g){return po().memoizedState=[p,g===void 0?null:g],p},useContext:Ta,useEffect:GF,useImperativeHandle:function(p,g,_){_=_!=null?_.concat([p]):null,W_(4194308,4,XF.bind(null,g,p),_)},useLayoutEffect:function(p,g){return W_(4194308,4,p,g)},useInsertionEffect:function(p,g){W_(4,2,p,g)},useMemo:function(p,g){var _=po();g=g===void 0?null:g;var T=p();if(Ap){Lt(!0);try{p()}finally{Lt(!1)}}return _.memoizedState=[T,g],T},useReducer:function(p,g,_){var T=po();if(_!==void 0){var j=_(g);if(Ap){Lt(!0);try{_(g)}finally{Lt(!1)}}}else j=g;return T.memoizedState=T.baseState=j,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:j},T.queue=p,p=p.dispatch=Zde.bind(null,Ir,p),[T.memoizedState,p]},useRef:function(p){var g=po();return p={current:p},g.memoizedState=p},useState:function(p){p=tR(p);var g=p.queue,_=o8.bind(null,Ir,g);return g.dispatch=_,[p.memoizedState,_]},useDebugValue:rR,useDeferredValue:function(p,g){var _=po();return sR(_,p,g)},useTransition:function(){var p=tR(!1);return p=n8.bind(null,Ir,p.queue,!0,!1),po().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,_){var T=Ir,j=po();if(ss){if(_===void 0)throw Error(r(407));_=_()}else{if(_=g(),Os===null)throw Error(r(349));(Gr&124)!==0||MF(T,g,_)}j.memoizedState=_;var q={value:_,getSnapshot:g};return j.queue=q,GF(jF.bind(null,T,q,p),[p]),T.flags|=2048,Ig(9,V_(),IF.bind(null,T,q,_,g),null),_},useId:function(){var p=po(),g=Os.identifierPrefix;if(ss){var _=rd,T=nd;_=(T&~(1<<32-en(T)-1)).toString(32)+_,g=""+g+"R"+_,_=z_++,0<_&&(g+="H"+_.toString(32)),g+=""}else _=Vde++,g=""+g+"r"+_.toString(32)+"";return p.memoizedState=g},useHostTransitionStatus:aR,useFormState:UF,useActionState:UF,useOptimistic:function(p){var g=po();g.memoizedState=g.baseState=p;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=_,g=oR.bind(null,Ir,!0,_),_.dispatch=g,[p,g]},useMemoCache:JA,useCacheRefresh:function(){return po().memoizedState=Yde.bind(null,Ir)}},d8={readContext:Ta,use:U_,useCallback:QF,useContext:Ta,useEffect:KF,useImperativeHandle:JF,useInsertionEffect:YF,useLayoutEffect:ZF,useMemo:e8,useReducer:q_,useRef:HF,useState:function(){return q_(ad)},useDebugValue:rR,useDeferredValue:function(p,g){var _=ki();return t8(_,_s.memoizedState,p,g)},useTransition:function(){var p=q_(ad)[0],g=ki().memoizedState;return[typeof p=="boolean"?p:nv(p),g]},useSyncExternalStore:NF,useId:i8,useHostTransitionStatus:aR,useFormState:qF,useActionState:qF,useOptimistic:function(p,g){var _=ki();return DF(_,_s,p,g)},useMemoCache:JA,useCacheRefresh:a8},Xde={readContext:Ta,use:U_,useCallback:QF,useContext:Ta,useEffect:KF,useImperativeHandle:JF,useInsertionEffect:YF,useLayoutEffect:ZF,useMemo:e8,useReducer:eR,useRef:HF,useState:function(){return eR(ad)},useDebugValue:rR,useDeferredValue:function(p,g){var _=ki();return _s===null?sR(_,p,g):t8(_,_s.memoizedState,p,g)},useTransition:function(){var p=eR(ad)[0],g=ki().memoizedState;return[typeof p=="boolean"?p:nv(p),g]},useSyncExternalStore:NF,useId:i8,useHostTransitionStatus:aR,useFormState:WF,useActionState:WF,useOptimistic:function(p,g){var _=ki();return _s!==null?DF(_,_s,p,g):(_.baseState=p,[p,_.queue.dispatch])},useMemoCache:JA,useCacheRefresh:a8},jg=null,iv=0;function K_(p){var g=iv;return iv+=1,jg===null&&(jg=[]),_F(jg,p,g)}function av(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function Y_(p,g){throw g.$$typeof===d?Error(r(525)):(p=Object.prototype.toString.call(g),Error(r(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function f8(p){var g=p._init;return g(p._payload)}function h8(p){function g(ht,rt){if(p){var xt=ht.deletions;xt===null?(ht.deletions=[rt],ht.flags|=16):xt.push(rt)}}function _(ht,rt){if(!p)return null;for(;rt!==null;)g(ht,rt),rt=rt.sibling;return null}function T(ht){for(var rt=new Map;ht!==null;)ht.key!==null?rt.set(ht.key,ht):rt.set(ht.index,ht),ht=ht.sibling;return rt}function j(ht,rt){return ht=td(ht,rt),ht.index=0,ht.sibling=null,ht}function q(ht,rt,xt){return ht.index=xt,p?(xt=ht.alternate,xt!==null?(xt=xt.index,xt<rt?(ht.flags|=67108866,rt):xt):(ht.flags|=67108866,rt)):(ht.flags|=1048576,rt)}function ue(ht){return p&&ht.alternate===null&&(ht.flags|=67108866),ht}function Re(ht,rt,xt,Ft){return rt===null||rt.tag!==6?(rt=AA(xt,ht.mode,Ft),rt.return=ht,rt):(rt=j(rt,xt),rt.return=ht,rt)}function Ye(ht,rt,xt,Ft){var vn=xt.type;return vn===y?Dt(ht,rt,xt.props.children,Ft,xt.key):rt!==null&&(rt.elementType===vn||typeof vn=="object"&&vn!==null&&vn.$$typeof===N&&f8(vn)===rt.type)?(rt=j(rt,xt.props),av(rt,xt),rt.return=ht,rt):(rt=M_(xt.type,xt.key,xt.props,null,ht.mode,Ft),av(rt,xt),rt.return=ht,rt)}function wt(ht,rt,xt,Ft){return rt===null||rt.tag!==4||rt.stateNode.containerInfo!==xt.containerInfo||rt.stateNode.implementation!==xt.implementation?(rt=RA(xt,ht.mode,Ft),rt.return=ht,rt):(rt=j(rt,xt.children||[]),rt.return=ht,rt)}function Dt(ht,rt,xt,Ft,vn){return rt===null||rt.tag!==7?(rt=xp(xt,ht.mode,Ft,vn),rt.return=ht,rt):(rt=j(rt,xt),rt.return=ht,rt)}function Bt(ht,rt,xt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return rt=AA(""+rt,ht.mode,xt),rt.return=ht,rt;if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case h:return xt=M_(rt.type,rt.key,rt.props,null,ht.mode,xt),av(xt,rt),xt.return=ht,xt;case m:return rt=RA(rt,ht.mode,xt),rt.return=ht,rt;case N:var Ft=rt._init;return rt=Ft(rt._payload),Bt(ht,rt,xt)}if(Z(rt)||D(rt))return rt=xp(rt,ht.mode,xt,null),rt.return=ht,rt;if(typeof rt.then=="function")return Bt(ht,K_(rt),xt);if(rt.$$typeof===S)return Bt(ht,O_(ht,rt),xt);Y_(ht,rt)}return null}function kt(ht,rt,xt,Ft){var vn=rt!==null?rt.key:null;if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return vn!==null?null:Re(ht,rt,""+xt,Ft);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case h:return xt.key===vn?Ye(ht,rt,xt,Ft):null;case m:return xt.key===vn?wt(ht,rt,xt,Ft):null;case N:return vn=xt._init,xt=vn(xt._payload),kt(ht,rt,xt,Ft)}if(Z(xt)||D(xt))return vn!==null?null:Dt(ht,rt,xt,Ft,null);if(typeof xt.then=="function")return kt(ht,rt,K_(xt),Ft);if(xt.$$typeof===S)return kt(ht,rt,O_(ht,xt),Ft);Y_(ht,xt)}return null}function At(ht,rt,xt,Ft,vn){if(typeof Ft=="string"&&Ft!==""||typeof Ft=="number"||typeof Ft=="bigint")return ht=ht.get(xt)||null,Re(rt,ht,""+Ft,vn);if(typeof Ft=="object"&&Ft!==null){switch(Ft.$$typeof){case h:return ht=ht.get(Ft.key===null?xt:Ft.key)||null,Ye(rt,ht,Ft,vn);case m:return ht=ht.get(Ft.key===null?xt:Ft.key)||null,wt(rt,ht,Ft,vn);case N:var Or=Ft._init;return Ft=Or(Ft._payload),At(ht,rt,xt,Ft,vn)}if(Z(Ft)||D(Ft))return ht=ht.get(xt)||null,Dt(rt,ht,Ft,vn,null);if(typeof Ft.then=="function")return At(ht,rt,xt,K_(Ft),vn);if(Ft.$$typeof===S)return At(ht,rt,xt,O_(rt,Ft),vn);Y_(rt,Ft)}return null}function ir(ht,rt,xt,Ft){for(var vn=null,Or=null,jn=rt,Kn=rt=0,Qi=null;jn!==null&&Kn<xt.length;Kn++){jn.index>Kn?(Qi=jn,jn=null):Qi=jn.sibling;var ts=kt(ht,jn,xt[Kn],Ft);if(ts===null){jn===null&&(jn=Qi);break}p&&jn&&ts.alternate===null&&g(ht,jn),rt=q(ts,rt,Kn),Or===null?vn=ts:Or.sibling=ts,Or=ts,jn=Qi}if(Kn===xt.length)return _(ht,jn),ss&&_p(ht,Kn),vn;if(jn===null){for(;Kn<xt.length;Kn++)jn=Bt(ht,xt[Kn],Ft),jn!==null&&(rt=q(jn,rt,Kn),Or===null?vn=jn:Or.sibling=jn,Or=jn);return ss&&_p(ht,Kn),vn}for(jn=T(jn);Kn<xt.length;Kn++)Qi=At(jn,ht,Kn,xt[Kn],Ft),Qi!==null&&(p&&Qi.alternate!==null&&jn.delete(Qi.key===null?Kn:Qi.key),rt=q(Qi,rt,Kn),Or===null?vn=Qi:Or.sibling=Qi,Or=Qi);return p&&jn.forEach(function(Gf){return g(ht,Gf)}),ss&&_p(ht,Kn),vn}function Vn(ht,rt,xt,Ft){if(xt==null)throw Error(r(151));for(var vn=null,Or=null,jn=rt,Kn=rt=0,Qi=null,ts=xt.next();jn!==null&&!ts.done;Kn++,ts=xt.next()){jn.index>Kn?(Qi=jn,jn=null):Qi=jn.sibling;var Gf=kt(ht,jn,ts.value,Ft);if(Gf===null){jn===null&&(jn=Qi);break}p&&jn&&Gf.alternate===null&&g(ht,jn),rt=q(Gf,rt,Kn),Or===null?vn=Gf:Or.sibling=Gf,Or=Gf,jn=Qi}if(ts.done)return _(ht,jn),ss&&_p(ht,Kn),vn;if(jn===null){for(;!ts.done;Kn++,ts=xt.next())ts=Bt(ht,ts.value,Ft),ts!==null&&(rt=q(ts,rt,Kn),Or===null?vn=ts:Or.sibling=ts,Or=ts);return ss&&_p(ht,Kn),vn}for(jn=T(jn);!ts.done;Kn++,ts=xt.next())ts=At(jn,ht,Kn,ts.value,Ft),ts!==null&&(p&&ts.alternate!==null&&jn.delete(ts.key===null?Kn:ts.key),rt=q(ts,rt,Kn),Or===null?vn=ts:Or.sibling=ts,Or=ts);return p&&jn.forEach(function(Jfe){return g(ht,Jfe)}),ss&&_p(ht,Kn),vn}function Cs(ht,rt,xt,Ft){if(typeof xt=="object"&&xt!==null&&xt.type===y&&xt.key===null&&(xt=xt.props.children),typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case h:e:{for(var vn=xt.key;rt!==null;){if(rt.key===vn){if(vn=xt.type,vn===y){if(rt.tag===7){_(ht,rt.sibling),Ft=j(rt,xt.props.children),Ft.return=ht,ht=Ft;break e}}else if(rt.elementType===vn||typeof vn=="object"&&vn!==null&&vn.$$typeof===N&&f8(vn)===rt.type){_(ht,rt.sibling),Ft=j(rt,xt.props),av(Ft,xt),Ft.return=ht,ht=Ft;break e}_(ht,rt);break}else g(ht,rt);rt=rt.sibling}xt.type===y?(Ft=xp(xt.props.children,ht.mode,Ft,xt.key),Ft.return=ht,ht=Ft):(Ft=M_(xt.type,xt.key,xt.props,null,ht.mode,Ft),av(Ft,xt),Ft.return=ht,ht=Ft)}return ue(ht);case m:e:{for(vn=xt.key;rt!==null;){if(rt.key===vn)if(rt.tag===4&&rt.stateNode.containerInfo===xt.containerInfo&&rt.stateNode.implementation===xt.implementation){_(ht,rt.sibling),Ft=j(rt,xt.children||[]),Ft.return=ht,ht=Ft;break e}else{_(ht,rt);break}else g(ht,rt);rt=rt.sibling}Ft=RA(xt,ht.mode,Ft),Ft.return=ht,ht=Ft}return ue(ht);case N:return vn=xt._init,xt=vn(xt._payload),Cs(ht,rt,xt,Ft)}if(Z(xt))return ir(ht,rt,xt,Ft);if(D(xt)){if(vn=D(xt),typeof vn!="function")throw Error(r(150));return xt=vn.call(xt),Vn(ht,rt,xt,Ft)}if(typeof xt.then=="function")return Cs(ht,rt,K_(xt),Ft);if(xt.$$typeof===S)return Cs(ht,rt,O_(ht,xt),Ft);Y_(ht,xt)}return typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint"?(xt=""+xt,rt!==null&&rt.tag===6?(_(ht,rt.sibling),Ft=j(rt,xt),Ft.return=ht,ht=Ft):(_(ht,rt),Ft=AA(xt,ht.mode,Ft),Ft.return=ht,ht=Ft),ue(ht)):_(ht,rt)}return function(ht,rt,xt,Ft){try{iv=0;var vn=Cs(ht,rt,xt,Ft);return jg=null,vn}catch(jn){if(jn===Zb||jn===F_)throw jn;var Or=Wo(29,jn,null,ht.mode);return Or.lanes=Ft,Or.return=ht,Or}finally{}}}var Pg=h8(!0),p8=h8(!1),kl=Q(null),Zc=null;function If(p){var g=p.alternate;se(Di,Di.current&1),se(kl,p),Zc===null&&(g===null||Rg.current!==null||g.memoizedState!==null)&&(Zc=p)}function m8(p){if(p.tag===22){if(se(Di,Di.current),se(kl,p),Zc===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(Zc=p)}}else jf()}function jf(){se(Di,Di.current),se(kl,kl.current)}function od(p){ee(kl),Zc===p&&(Zc=null),ee(Di)}var Di=Q(0);function Z_(p){for(var g=p;g!==null;){if(g.tag===13){var _=g.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||XR(_)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function lR(p,g,_,T){g=p.memoizedState,_=_(T,g),_=_==null?g:u({},g,_),p.memoizedState=_,p.lanes===0&&(p.updateQueue.baseState=_)}var cR={enqueueSetState:function(p,g,_){p=p._reactInternals;var T=Yo(),j=Rf(T);j.payload=g,_!=null&&(j.callback=_),g=Nf(p,j,T),g!==null&&(Zo(g,p,T),Jb(g,p,T))},enqueueReplaceState:function(p,g,_){p=p._reactInternals;var T=Yo(),j=Rf(T);j.tag=1,j.payload=g,_!=null&&(j.callback=_),g=Nf(p,j,T),g!==null&&(Zo(g,p,T),Jb(g,p,T))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var _=Yo(),T=Rf(_);T.tag=2,g!=null&&(T.callback=g),g=Nf(p,T,_),g!==null&&(Zo(g,p,_),Jb(g,p,_))}};function g8(p,g,_,T,j,q,ue){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(T,q,ue):g.prototype&&g.prototype.isPureReactComponent?!M(_,T)||!M(j,q):!0}function y8(p,g,_,T){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(_,T),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(_,T),g.state!==p&&cR.enqueueReplaceState(g,g.state,null)}function Rp(p,g){var _=g;if("ref"in g){_={};for(var T in g)T!=="ref"&&(_[T]=g[T])}if(p=p.defaultProps){_===g&&(_=u({},_));for(var j in p)_[j]===void 0&&(_[j]=p[j])}return _}var X_=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof Ni=="object"&&typeof Ni.emit=="function"){Ni.emit("uncaughtException",p);return}console.error(p)};function b8(p){X_(p)}function v8(p){console.error(p)}function x8(p){X_(p)}function J_(p,g){try{var _=p.onUncaughtError;_(g.value,{componentStack:g.stack})}catch(T){setTimeout(function(){throw T})}}function w8(p,g,_){try{var T=p.onCaughtError;T(_.value,{componentStack:_.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function uR(p,g,_){return _=Rf(_),_.tag=3,_.payload={element:null},_.callback=function(){J_(p,g)},_}function _8(p){return p=Rf(p),p.tag=3,p}function S8(p,g,_,T){var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var q=T.value;p.payload=function(){return j(q)},p.callback=function(){w8(g,_,T)}}var ue=_.stateNode;ue!==null&&typeof ue.componentDidCatch=="function"&&(p.callback=function(){w8(g,_,T),typeof j!="function"&&(Bf===null?Bf=new Set([this]):Bf.add(this));var Re=T.stack;this.componentDidCatch(T.value,{componentStack:Re!==null?Re:""})})}function Jde(p,g,_,T,j){if(_.flags|=32768,T!==null&&typeof T=="object"&&typeof T.then=="function"){if(g=_.alternate,g!==null&&Gb(g,_,j,!0),_=kl.current,_!==null){switch(_.tag){case 13:return Zc===null?PR():_.alternate===null&&ai===0&&(ai=3),_.flags&=-257,_.flags|=65536,_.lanes=j,T===BA?_.flags|=16384:(g=_.updateQueue,g===null?_.updateQueue=new Set([T]):g.add(T),DR(p,T,j)),!1;case 22:return _.flags|=65536,T===BA?_.flags|=16384:(g=_.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([T])},_.updateQueue=g):(_=g.retryQueue,_===null?g.retryQueue=new Set([T]):_.add(T)),DR(p,T,j)),!1}throw Error(r(435,_.tag))}return DR(p,T,j),PR(),!1}if(ss)return g=kl.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=j,T!==IA&&(p=Error(r(422),{cause:T}),Hb(Bn(p,_)))):(T!==IA&&(g=Error(r(423),{cause:T}),Hb(Bn(g,_))),p=p.current.alternate,p.flags|=65536,j&=-j,p.lanes|=j,T=Bn(T,_),j=uR(p.stateNode,T,j),UA(p,j),ai!==4&&(ai=2)),!1;var q=Error(r(520),{cause:T});if(q=Bn(q,_),hv===null?hv=[q]:hv.push(q),ai!==4&&(ai=2),g===null)return!0;T=Bn(T,_),_=g;do{switch(_.tag){case 3:return _.flags|=65536,p=j&-j,_.lanes|=p,p=uR(_.stateNode,T,p),UA(_,p),!1;case 1:if(g=_.type,q=_.stateNode,(_.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Bf===null||!Bf.has(q))))return _.flags|=65536,j&=-j,_.lanes|=j,j=_8(j),S8(j,p,_,T),UA(_,j),!1}_=_.return}while(_!==null);return!1}var C8=Error(r(461)),Xi=!1;function ha(p,g,_,T){g.child=p===null?p8(g,null,_,T):Pg(g,p.child,_,T)}function k8(p,g,_,T,j){_=_.render;var q=g.ref;if("ref"in T){var ue={};for(var Re in T)Re!=="ref"&&(ue[Re]=T[Re])}else ue=T;return Ep(g),T=GA(p,g,_,ue,q,j),Re=KA(),p!==null&&!Xi?(YA(p,g,j),ld(p,g,j)):(ss&&Re&&NA(g),g.flags|=1,ha(p,g,T,j),g.child)}function E8(p,g,_,T,j){if(p===null){var q=_.type;return typeof q=="function"&&!TA(q)&&q.defaultProps===void 0&&_.compare===null?(g.tag=15,g.type=q,T8(p,g,q,T,j)):(p=M_(_.type,null,T,g,g.mode,j),p.ref=g.ref,p.return=g,g.child=p)}if(q=p.child,!bR(p,j)){var ue=q.memoizedProps;if(_=_.compare,_=_!==null?_:M,_(ue,T)&&p.ref===g.ref)return ld(p,g,j)}return g.flags|=1,p=td(q,T),p.ref=g.ref,p.return=g,g.child=p}function T8(p,g,_,T,j){if(p!==null){var q=p.memoizedProps;if(M(q,T)&&p.ref===g.ref)if(Xi=!1,g.pendingProps=T=q,bR(p,j))(p.flags&131072)!==0&&(Xi=!0);else return g.lanes=p.lanes,ld(p,g,j)}return dR(p,g,_,T,j)}function A8(p,g,_){var T=g.pendingProps,j=T.children,q=p!==null?p.memoizedState:null;if(T.mode==="hidden"){if((g.flags&128)!==0){if(T=q!==null?q.baseLanes|_:_,p!==null){for(j=g.child=p.child,q=0;j!==null;)q=q|j.lanes|j.childLanes,j=j.sibling;g.childLanes=q&~T}else g.childLanes=0,g.child=null;return R8(p,g,T,_)}if((_&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&D_(g,q!==null?q.cachePool:null),q!==null?TF(g,q):VA(),m8(g);else return g.lanes=g.childLanes=536870912,R8(p,g,q!==null?q.baseLanes|_:_,_)}else q!==null?(D_(g,q.cachePool),TF(g,q),jf(),g.memoizedState=null):(p!==null&&D_(g,null),VA(),jf());return ha(p,g,j,_),g.child}function R8(p,g,_,T){var j=LA();return j=j===null?null:{parent:Oi._currentValue,pool:j},g.memoizedState={baseLanes:_,cachePool:j},p!==null&&D_(g,null),VA(),m8(g),p!==null&&Gb(p,g,T,!0),null}function Q_(p,g){var _=g.ref;if(_===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(r(284));(p===null||p.ref!==_)&&(g.flags|=4194816)}}function dR(p,g,_,T,j){return Ep(g),_=GA(p,g,_,T,void 0,j),T=KA(),p!==null&&!Xi?(YA(p,g,j),ld(p,g,j)):(ss&&T&&NA(g),g.flags|=1,ha(p,g,_,j),g.child)}function N8(p,g,_,T,j,q){return Ep(g),g.updateQueue=null,_=RF(g,T,_,j),AF(p),T=KA(),p!==null&&!Xi?(YA(p,g,q),ld(p,g,q)):(ss&&T&&NA(g),g.flags|=1,ha(p,g,_,q),g.child)}function M8(p,g,_,T,j){if(Ep(g),g.stateNode===null){var q=Kc,ue=_.contextType;typeof ue=="object"&&ue!==null&&(q=Ta(ue)),q=new _(T,q),g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,q.updater=cR,g.stateNode=q,q._reactInternals=g,q=g.stateNode,q.props=T,q.state=g.memoizedState,q.refs={},$A(g),ue=_.contextType,q.context=typeof ue=="object"&&ue!==null?Ta(ue):Kc,q.state=g.memoizedState,ue=_.getDerivedStateFromProps,typeof ue=="function"&&(lR(g,_,ue,T),q.state=g.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(ue=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),ue!==q.state&&cR.enqueueReplaceState(q,q.state,null),ev(g,T,q,j),Qb(),q.state=g.memoizedState),typeof q.componentDidMount=="function"&&(g.flags|=4194308),T=!0}else if(p===null){q=g.stateNode;var Re=g.memoizedProps,Ye=Rp(_,Re);q.props=Ye;var wt=q.context,Dt=_.contextType;ue=Kc,typeof Dt=="object"&&Dt!==null&&(ue=Ta(Dt));var Bt=_.getDerivedStateFromProps;Dt=typeof Bt=="function"||typeof q.getSnapshotBeforeUpdate=="function",Re=g.pendingProps!==Re,Dt||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(Re||wt!==ue)&&y8(g,q,T,ue),Af=!1;var kt=g.memoizedState;q.state=kt,ev(g,T,q,j),Qb(),wt=g.memoizedState,Re||kt!==wt||Af?(typeof Bt=="function"&&(lR(g,_,Bt,T),wt=g.memoizedState),(Ye=Af||g8(g,_,Ye,T,kt,wt,ue))?(Dt||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=T,g.memoizedState=wt),q.props=T,q.state=wt,q.context=ue,T=Ye):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),T=!1)}else{q=g.stateNode,zA(p,g),ue=g.memoizedProps,Dt=Rp(_,ue),q.props=Dt,Bt=g.pendingProps,kt=q.context,wt=_.contextType,Ye=Kc,typeof wt=="object"&&wt!==null&&(Ye=Ta(wt)),Re=_.getDerivedStateFromProps,(wt=typeof Re=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(ue!==Bt||kt!==Ye)&&y8(g,q,T,Ye),Af=!1,kt=g.memoizedState,q.state=kt,ev(g,T,q,j),Qb();var At=g.memoizedState;ue!==Bt||kt!==At||Af||p!==null&&p.dependencies!==null&&P_(p.dependencies)?(typeof Re=="function"&&(lR(g,_,Re,T),At=g.memoizedState),(Dt=Af||g8(g,_,Dt,T,kt,At,Ye)||p!==null&&p.dependencies!==null&&P_(p.dependencies))?(wt||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(T,At,Ye),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(T,At,Ye)),typeof q.componentDidUpdate=="function"&&(g.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof q.componentDidUpdate!="function"||ue===p.memoizedProps&&kt===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ue===p.memoizedProps&&kt===p.memoizedState||(g.flags|=1024),g.memoizedProps=T,g.memoizedState=At),q.props=T,q.state=At,q.context=Ye,T=Dt):(typeof q.componentDidUpdate!="function"||ue===p.memoizedProps&&kt===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||ue===p.memoizedProps&&kt===p.memoizedState||(g.flags|=1024),T=!1)}return q=T,Q_(p,g),T=(g.flags&128)!==0,q||T?(q=g.stateNode,_=T&&typeof _.getDerivedStateFromError!="function"?null:q.render(),g.flags|=1,p!==null&&T?(g.child=Pg(g,p.child,null,j),g.child=Pg(g,null,_,j)):ha(p,g,_,j),g.memoizedState=q.state,p=g.child):p=ld(p,g,j),p}function I8(p,g,_,T){return Wb(),g.flags|=256,ha(p,g,_,T),g.child}var fR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hR(p){return{baseLanes:p,cachePool:vF()}}function pR(p,g,_){return p=p!==null?p.childLanes&~_:0,g&&(p|=El),p}function j8(p,g,_){var T=g.pendingProps,j=!1,q=(g.flags&128)!==0,ue;if((ue=q)||(ue=p!==null&&p.memoizedState===null?!1:(Di.current&2)!==0),ue&&(j=!0,g.flags&=-129),ue=(g.flags&32)!==0,g.flags&=-33,p===null){if(ss){if(j?If(g):jf(),ss){var Re=ii,Ye;if(Ye=Re){e:{for(Ye=Re,Re=Yc;Ye.nodeType!==8;){if(!Re){Re=null;break e}if(Ye=ic(Ye.nextSibling),Ye===null){Re=null;break e}}Re=Ye}Re!==null?(g.memoizedState={dehydrated:Re,treeContext:wp!==null?{id:nd,overflow:rd}:null,retryLane:536870912,hydrationErrors:null},Ye=Wo(18,null,null,0),Ye.stateNode=Re,Ye.return=g,g.child=Ye,Ga=g,ii=null,Ye=!0):Ye=!1}Ye||Cp(g)}if(Re=g.memoizedState,Re!==null&&(Re=Re.dehydrated,Re!==null))return XR(Re)?g.lanes=32:g.lanes=536870912,null;od(g)}return Re=T.children,T=T.fallback,j?(jf(),j=g.mode,Re=eS({mode:"hidden",children:Re},j),T=xp(T,j,_,null),Re.return=g,T.return=g,Re.sibling=T,g.child=Re,j=g.child,j.memoizedState=hR(_),j.childLanes=pR(p,ue,_),g.memoizedState=fR,T):(If(g),mR(g,Re))}if(Ye=p.memoizedState,Ye!==null&&(Re=Ye.dehydrated,Re!==null)){if(q)g.flags&256?(If(g),g.flags&=-257,g=gR(p,g,_)):g.memoizedState!==null?(jf(),g.child=p.child,g.flags|=128,g=null):(jf(),j=T.fallback,Re=g.mode,T=eS({mode:"visible",children:T.children},Re),j=xp(j,Re,_,null),j.flags|=2,T.return=g,j.return=g,T.sibling=j,g.child=T,Pg(g,p.child,null,_),T=g.child,T.memoizedState=hR(_),T.childLanes=pR(p,ue,_),g.memoizedState=fR,g=j);else if(If(g),XR(Re)){if(ue=Re.nextSibling&&Re.nextSibling.dataset,ue)var wt=ue.dgst;ue=wt,T=Error(r(419)),T.stack="",T.digest=ue,Hb({value:T,source:null,stack:null}),g=gR(p,g,_)}else if(Xi||Gb(p,g,_,!1),ue=(_&p.childLanes)!==0,Xi||ue){if(ue=Os,ue!==null&&(T=_&-_,T=(T&42)!==0?1:Et(T),T=(T&(ue.suspendedLanes|_))!==0?0:T,T!==0&&T!==Ye.retryLane))throw Ye.retryLane=T,rc(p,T),Zo(ue,p,T),C8;Re.data==="$?"||PR(),g=gR(p,g,_)}else Re.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=Ye.treeContext,ii=ic(Re.nextSibling),Ga=g,ss=!0,Sp=null,Yc=!1,p!==null&&(Sl[Cl++]=nd,Sl[Cl++]=rd,Sl[Cl++]=wp,nd=p.id,rd=p.overflow,wp=g),g=mR(g,T.children),g.flags|=4096);return g}return j?(jf(),j=T.fallback,Re=g.mode,Ye=p.child,wt=Ye.sibling,T=td(Ye,{mode:"hidden",children:T.children}),T.subtreeFlags=Ye.subtreeFlags&65011712,wt!==null?j=td(wt,j):(j=xp(j,Re,_,null),j.flags|=2),j.return=g,T.return=g,T.sibling=j,g.child=T,T=j,j=g.child,Re=p.child.memoizedState,Re===null?Re=hR(_):(Ye=Re.cachePool,Ye!==null?(wt=Oi._currentValue,Ye=Ye.parent!==wt?{parent:wt,pool:wt}:Ye):Ye=vF(),Re={baseLanes:Re.baseLanes|_,cachePool:Ye}),j.memoizedState=Re,j.childLanes=pR(p,ue,_),g.memoizedState=fR,T):(If(g),_=p.child,p=_.sibling,_=td(_,{mode:"visible",children:T.children}),_.return=g,_.sibling=null,p!==null&&(ue=g.deletions,ue===null?(g.deletions=[p],g.flags|=16):ue.push(p)),g.child=_,g.memoizedState=null,_)}function mR(p,g){return g=eS({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function eS(p,g){return p=Wo(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function gR(p,g,_){return Pg(g,p.child,null,_),p=mR(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function P8(p,g,_){p.lanes|=g;var T=p.alternate;T!==null&&(T.lanes|=g),PA(p.return,g,_)}function yR(p,g,_,T,j){var q=p.memoizedState;q===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:T,tail:_,tailMode:j}:(q.isBackwards=g,q.rendering=null,q.renderingStartTime=0,q.last=T,q.tail=_,q.tailMode=j)}function O8(p,g,_){var T=g.pendingProps,j=T.revealOrder,q=T.tail;if(ha(p,g,T.children,_),T=Di.current,(T&2)!==0)T=T&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&P8(p,_,g);else if(p.tag===19)P8(p,_,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}T&=1}switch(se(Di,T),j){case"forwards":for(_=g.child,j=null;_!==null;)p=_.alternate,p!==null&&Z_(p)===null&&(j=_),_=_.sibling;_=j,_===null?(j=g.child,g.child=null):(j=_.sibling,_.sibling=null),yR(g,!1,j,_,q);break;case"backwards":for(_=null,j=g.child,g.child=null;j!==null;){if(p=j.alternate,p!==null&&Z_(p)===null){g.child=j;break}p=j.sibling,j.sibling=_,_=j,j=p}yR(g,!0,_,null,q);break;case"together":yR(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function ld(p,g,_){if(p!==null&&(g.dependencies=p.dependencies),Lf|=g.lanes,(_&g.childLanes)===0)if(p!==null){if(Gb(p,g,_,!1),(_&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(r(153));if(g.child!==null){for(p=g.child,_=td(p,p.pendingProps),g.child=_,_.return=g;p.sibling!==null;)p=p.sibling,_=_.sibling=td(p,p.pendingProps),_.return=g;_.sibling=null}return g.child}function bR(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&P_(p)))}function Qde(p,g,_){switch(g.tag){case 3:Se(g,g.stateNode.containerInfo),Tf(g,Oi,p.memoizedState.cache),Wb();break;case 27:case 5:qe(g);break;case 4:Se(g,g.stateNode.containerInfo);break;case 10:Tf(g,g.type,g.memoizedProps.value);break;case 13:var T=g.memoizedState;if(T!==null)return T.dehydrated!==null?(If(g),g.flags|=128,null):(_&g.child.childLanes)!==0?j8(p,g,_):(If(g),p=ld(p,g,_),p!==null?p.sibling:null);If(g);break;case 19:var j=(p.flags&128)!==0;if(T=(_&g.childLanes)!==0,T||(Gb(p,g,_,!1),T=(_&g.childLanes)!==0),j){if(T)return O8(p,g,_);g.flags|=128}if(j=g.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),se(Di,Di.current),T)break;return null;case 22:case 23:return g.lanes=0,A8(p,g,_);case 24:Tf(g,Oi,p.memoizedState.cache)}return ld(p,g,_)}function D8(p,g,_){if(p!==null)if(p.memoizedProps!==g.pendingProps)Xi=!0;else{if(!bR(p,_)&&(g.flags&128)===0)return Xi=!1,Qde(p,g,_);Xi=(p.flags&131072)!==0}else Xi=!1,ss&&(g.flags&1048576)!==0&&fF(g,j_,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var T=g.elementType,j=T._init;if(T=j(T._payload),g.type=T,typeof T=="function")TA(T)?(p=Rp(T,p),g.tag=1,g=M8(null,g,T,p,_)):(g.tag=0,g=dR(null,g,T,p,_));else{if(T!=null){if(j=T.$$typeof,j===k){g.tag=11,g=k8(null,g,T,p,_);break e}else if(j===A){g.tag=14,g=E8(null,g,T,p,_);break e}}throw g=P(T)||T,Error(r(306,g,""))}}return g;case 0:return dR(p,g,g.type,g.pendingProps,_);case 1:return T=g.type,j=Rp(T,g.pendingProps),M8(p,g,T,j,_);case 3:e:{if(Se(g,g.stateNode.containerInfo),p===null)throw Error(r(387));T=g.pendingProps;var q=g.memoizedState;j=q.element,zA(p,g),ev(g,T,null,_);var ue=g.memoizedState;if(T=ue.cache,Tf(g,Oi,T),T!==q.cache&&OA(g,[Oi],_,!0),Qb(),T=ue.element,q.isDehydrated)if(q={element:T,isDehydrated:!1,cache:ue.cache},g.updateQueue.baseState=q,g.memoizedState=q,g.flags&256){g=I8(p,g,T,_);break e}else if(T!==j){j=Bn(Error(r(424)),g),Hb(j),g=I8(p,g,T,_);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(ii=ic(p.firstChild),Ga=g,ss=!0,Sp=null,Yc=!0,_=p8(g,null,T,_),g.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(Wb(),T===j){g=ld(p,g,_);break e}ha(p,g,T,_)}g=g.child}return g;case 26:return Q_(p,g),p===null?(_=$L(g.type,null,g.pendingProps,null))?g.memoizedState=_:ss||(_=g.type,p=g.pendingProps,T=pS(je.current).createElement(_),T[ve]=g,T[Oe]=p,ma(T,_,p),Cr(T),g.stateNode=T):g.memoizedState=$L(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return qe(g),p===null&&ss&&(T=g.stateNode=FL(g.type,g.pendingProps,je.current),Ga=g,Yc=!0,j=ii,Uf(g.type)?(JR=j,ii=ic(T.firstChild)):ii=j),ha(p,g,g.pendingProps.children,_),Q_(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&ss&&((j=T=ii)&&(T=Tfe(T,g.type,g.pendingProps,Yc),T!==null?(g.stateNode=T,Ga=g,ii=ic(T.firstChild),Yc=!1,j=!0):j=!1),j||Cp(g)),qe(g),j=g.type,q=g.pendingProps,ue=p!==null?p.memoizedProps:null,T=q.children,KR(j,q)?T=null:ue!==null&&KR(j,ue)&&(g.flags|=32),g.memoizedState!==null&&(j=GA(p,g,Wde,null,null,_),_v._currentValue=j),Q_(p,g),ha(p,g,T,_),g.child;case 6:return p===null&&ss&&((p=_=ii)&&(_=Afe(_,g.pendingProps,Yc),_!==null?(g.stateNode=_,Ga=g,ii=null,p=!0):p=!1),p||Cp(g)),null;case 13:return j8(p,g,_);case 4:return Se(g,g.stateNode.containerInfo),T=g.pendingProps,p===null?g.child=Pg(g,null,T,_):ha(p,g,T,_),g.child;case 11:return k8(p,g,g.type,g.pendingProps,_);case 7:return ha(p,g,g.pendingProps,_),g.child;case 8:return ha(p,g,g.pendingProps.children,_),g.child;case 12:return ha(p,g,g.pendingProps.children,_),g.child;case 10:return T=g.pendingProps,Tf(g,g.type,T.value),ha(p,g,T.children,_),g.child;case 9:return j=g.type._context,T=g.pendingProps.children,Ep(g),j=Ta(j),T=T(j),g.flags|=1,ha(p,g,T,_),g.child;case 14:return E8(p,g,g.type,g.pendingProps,_);case 15:return T8(p,g,g.type,g.pendingProps,_);case 19:return O8(p,g,_);case 31:return T=g.pendingProps,_=g.mode,T={mode:T.mode,children:T.children},p===null?(_=eS(T,_),_.ref=g.ref,g.child=_,_.return=g,g=_):(_=td(p.child,T),_.ref=g.ref,g.child=_,_.return=g,g=_),g;case 22:return A8(p,g,_);case 24:return Ep(g),T=Ta(Oi),p===null?(j=LA(),j===null&&(j=Os,q=DA(),j.pooledCache=q,q.refCount++,q!==null&&(j.pooledCacheLanes|=_),j=q),g.memoizedState={parent:T,cache:j},$A(g),Tf(g,Oi,j)):((p.lanes&_)!==0&&(zA(p,g),ev(g,null,null,_),Qb()),j=p.memoizedState,q=g.memoizedState,j.parent!==T?(j={parent:T,cache:T},g.memoizedState=j,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=j),Tf(g,Oi,T)):(T=q.cache,Tf(g,Oi,T),T!==j.cache&&OA(g,[Oi],_,!0))),ha(p,g,g.pendingProps.children,_),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function cd(p){p.flags|=4}function F8(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!WL(g)){if(g=kl.current,g!==null&&((Gr&4194048)===Gr?Zc!==null:(Gr&62914560)!==Gr&&(Gr&536870912)===0||g!==Zc))throw Xb=BA,xF;p.flags|=8192}}function tS(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?$():536870912,p.lanes|=g,Lg|=g)}function ov(p,g){if(!ss)switch(p.tailMode){case"hidden":g=p.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?p.tail=null:_.sibling=null;break;case"collapsed":_=p.tail;for(var T=null;_!==null;)_.alternate!==null&&(T=_),_=_.sibling;T===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:T.sibling=null}}function Xs(p){var g=p.alternate!==null&&p.alternate.child===p.child,_=0,T=0;if(g)for(var j=p.child;j!==null;)_|=j.lanes|j.childLanes,T|=j.subtreeFlags&65011712,T|=j.flags&65011712,j.return=p,j=j.sibling;else for(j=p.child;j!==null;)_|=j.lanes|j.childLanes,T|=j.subtreeFlags,T|=j.flags,j.return=p,j=j.sibling;return p.subtreeFlags|=T,p.childLanes=_,g}function efe(p,g,_){var T=g.pendingProps;switch(MA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xs(g),null;case 1:return Xs(g),null;case 3:return _=g.stateNode,T=null,p!==null&&(T=p.memoizedState.cache),g.memoizedState.cache!==T&&(g.flags|=2048),id(Oi),Ce(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(p===null||p.child===null)&&(Vb(g)?cd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,mF())),Xs(g),null;case 26:return _=g.memoizedState,p===null?(cd(g),_!==null?(Xs(g),F8(g,_)):(Xs(g),g.flags&=-16777217)):_?_!==p.memoizedState?(cd(g),Xs(g),F8(g,_)):(Xs(g),g.flags&=-16777217):(p.memoizedProps!==T&&cd(g),Xs(g),g.flags&=-16777217),null;case 27:Qe(g),_=je.current;var j=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==T&&cd(g);else{if(!T){if(g.stateNode===null)throw Error(r(166));return Xs(g),null}p=me.current,Vb(g)?hF(g):(p=FL(j,T,_),g.stateNode=p,cd(g))}return Xs(g),null;case 5:if(Qe(g),_=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==T&&cd(g);else{if(!T){if(g.stateNode===null)throw Error(r(166));return Xs(g),null}if(p=me.current,Vb(g))hF(g);else{switch(j=pS(je.current),p){case 1:p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":p=j.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof T.is=="string"?j.createElement("select",{is:T.is}):j.createElement("select"),T.multiple?p.multiple=!0:T.size&&(p.size=T.size);break;default:p=typeof T.is=="string"?j.createElement(_,{is:T.is}):j.createElement(_)}}p[ve]=g,p[Oe]=T;e:for(j=g.child;j!==null;){if(j.tag===5||j.tag===6)p.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===g)break e;for(;j.sibling===null;){if(j.return===null||j.return===g)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}g.stateNode=p;e:switch(ma(p,_,T),_){case"button":case"input":case"select":case"textarea":p=!!T.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&cd(g)}}return Xs(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==T&&cd(g);else{if(typeof T!="string"&&g.stateNode===null)throw Error(r(166));if(p=je.current,Vb(g)){if(p=g.stateNode,_=g.memoizedProps,T=null,j=Ga,j!==null)switch(j.tag){case 27:case 5:T=j.memoizedProps}p[ve]=g,p=!!(p.nodeValue===_||T!==null&&T.suppressHydrationWarning===!0||NL(p.nodeValue,_)),p||Cp(g)}else p=pS(p).createTextNode(T),p[ve]=g,g.stateNode=p}return Xs(g),null;case 13:if(T=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(j=Vb(g),T!==null&&T.dehydrated!==null){if(p===null){if(!j)throw Error(r(318));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[ve]=g}else Wb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Xs(g),j=!1}else j=mF(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=j),j=!0;if(!j)return g.flags&256?(od(g),g):(od(g),null)}if(od(g),(g.flags&128)!==0)return g.lanes=_,g;if(_=T!==null,p=p!==null&&p.memoizedState!==null,_){T=g.child,j=null,T.alternate!==null&&T.alternate.memoizedState!==null&&T.alternate.memoizedState.cachePool!==null&&(j=T.alternate.memoizedState.cachePool.pool);var q=null;T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(q=T.memoizedState.cachePool.pool),q!==j&&(T.flags|=2048)}return _!==p&&_&&(g.child.flags|=8192),tS(g,g.updateQueue),Xs(g),null;case 4:return Ce(),p===null&&qR(g.stateNode.containerInfo),Xs(g),null;case 10:return id(g.type),Xs(g),null;case 19:if(ee(Di),j=g.memoizedState,j===null)return Xs(g),null;if(T=(g.flags&128)!==0,q=j.rendering,q===null)if(T)ov(j,!1);else{if(ai!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(q=Z_(p),q!==null){for(g.flags|=128,ov(j,!1),p=q.updateQueue,g.updateQueue=p,tS(g,p),g.subtreeFlags=0,p=_,_=g.child;_!==null;)dF(_,p),_=_.sibling;return se(Di,Di.current&1|2),g.child}p=p.sibling}j.tail!==null&&le()>sS&&(g.flags|=128,T=!0,ov(j,!1),g.lanes=4194304)}else{if(!T)if(p=Z_(q),p!==null){if(g.flags|=128,T=!0,p=p.updateQueue,g.updateQueue=p,tS(g,p),ov(j,!0),j.tail===null&&j.tailMode==="hidden"&&!q.alternate&&!ss)return Xs(g),null}else 2*le()-j.renderingStartTime>sS&&_!==536870912&&(g.flags|=128,T=!0,ov(j,!1),g.lanes=4194304);j.isBackwards?(q.sibling=g.child,g.child=q):(p=j.last,p!==null?p.sibling=q:g.child=q,j.last=q)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=le(),g.sibling=null,p=Di.current,se(Di,T?p&1|2:p&1),g):(Xs(g),null);case 22:case 23:return od(g),WA(),T=g.memoizedState!==null,p!==null?p.memoizedState!==null!==T&&(g.flags|=8192):T&&(g.flags|=8192),T?(_&536870912)!==0&&(g.flags&128)===0&&(Xs(g),g.subtreeFlags&6&&(g.flags|=8192)):Xs(g),_=g.updateQueue,_!==null&&tS(g,_.retryQueue),_=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),T=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(T=g.memoizedState.cachePool.pool),T!==_&&(g.flags|=2048),p!==null&&ee(Tp),null;case 24:return _=null,p!==null&&(_=p.memoizedState.cache),g.memoizedState.cache!==_&&(g.flags|=2048),id(Oi),Xs(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function tfe(p,g){switch(MA(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return id(Oi),Ce(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Qe(g),null;case 13:if(od(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(r(340));Wb()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ee(Di),null;case 4:return Ce(),null;case 10:return id(g.type),null;case 22:case 23:return od(g),WA(),p!==null&&ee(Tp),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return id(Oi),null;case 25:return null;default:return null}}function L8(p,g){switch(MA(g),g.tag){case 3:id(Oi),Ce();break;case 26:case 27:case 5:Qe(g);break;case 4:Ce();break;case 13:od(g);break;case 19:ee(Di);break;case 10:id(g.type);break;case 22:case 23:od(g),WA(),p!==null&&ee(Tp);break;case 24:id(Oi)}}function lv(p,g){try{var _=g.updateQueue,T=_!==null?_.lastEffect:null;if(T!==null){var j=T.next;_=j;do{if((_.tag&p)===p){T=void 0;var q=_.create,ue=_.inst;T=q(),ue.destroy=T}_=_.next}while(_!==j)}}catch(Re){Ms(g,g.return,Re)}}function Pf(p,g,_){try{var T=g.updateQueue,j=T!==null?T.lastEffect:null;if(j!==null){var q=j.next;T=q;do{if((T.tag&p)===p){var ue=T.inst,Re=ue.destroy;if(Re!==void 0){ue.destroy=void 0,j=g;var Ye=_,wt=Re;try{wt()}catch(Dt){Ms(j,Ye,Dt)}}}T=T.next}while(T!==q)}}catch(Dt){Ms(g,g.return,Dt)}}function B8(p){var g=p.updateQueue;if(g!==null){var _=p.stateNode;try{EF(g,_)}catch(T){Ms(p,p.return,T)}}}function $8(p,g,_){_.props=Rp(p.type,p.memoizedProps),_.state=p.memoizedState;try{_.componentWillUnmount()}catch(T){Ms(p,g,T)}}function cv(p,g){try{var _=p.ref;if(_!==null){switch(p.tag){case 26:case 27:case 5:var T=p.stateNode;break;case 30:T=p.stateNode;break;default:T=p.stateNode}typeof _=="function"?p.refCleanup=_(T):_.current=T}}catch(j){Ms(p,g,j)}}function Xc(p,g){var _=p.ref,T=p.refCleanup;if(_!==null)if(typeof T=="function")try{T()}catch(j){Ms(p,g,j)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(j){Ms(p,g,j)}else _.current=null}function z8(p){var g=p.type,_=p.memoizedProps,T=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":_.autoFocus&&T.focus();break e;case"img":_.src?T.src=_.src:_.srcSet&&(T.srcset=_.srcSet)}}catch(j){Ms(p,p.return,j)}}function vR(p,g,_){try{var T=p.stateNode;_fe(T,p.type,_,g),T[Oe]=g}catch(j){Ms(p,p.return,j)}}function U8(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Uf(p.type)||p.tag===4}function xR(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||U8(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Uf(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function wR(p,g,_){var T=p.tag;if(T===5||T===6)p=p.stateNode,g?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(p,g):(g=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,g.appendChild(p),_=_._reactRootContainer,_!=null||g.onclick!==null||(g.onclick=hS));else if(T!==4&&(T===27&&Uf(p.type)&&(_=p.stateNode,g=null),p=p.child,p!==null))for(wR(p,g,_),p=p.sibling;p!==null;)wR(p,g,_),p=p.sibling}function nS(p,g,_){var T=p.tag;if(T===5||T===6)p=p.stateNode,g?_.insertBefore(p,g):_.appendChild(p);else if(T!==4&&(T===27&&Uf(p.type)&&(_=p.stateNode),p=p.child,p!==null))for(nS(p,g,_),p=p.sibling;p!==null;)nS(p,g,_),p=p.sibling}function q8(p){var g=p.stateNode,_=p.memoizedProps;try{for(var T=p.type,j=g.attributes;j.length;)g.removeAttributeNode(j[0]);ma(g,T,_),g[ve]=p,g[Oe]=_}catch(q){Ms(p,p.return,q)}}var ud=!1,hi=!1,_R=!1,V8=typeof WeakSet=="function"?WeakSet:Set,Ji=null;function nfe(p,g){if(p=p.containerInfo,HR=xS,p=pe(p),Ee(p)){if("selectionStart"in p)var _={start:p.selectionStart,end:p.selectionEnd};else e:{_=(_=p.ownerDocument)&&_.defaultView||window;var T=_.getSelection&&_.getSelection();if(T&&T.rangeCount!==0){_=T.anchorNode;var j=T.anchorOffset,q=T.focusNode;T=T.focusOffset;try{_.nodeType,q.nodeType}catch{_=null;break e}var ue=0,Re=-1,Ye=-1,wt=0,Dt=0,Bt=p,kt=null;t:for(;;){for(var At;Bt!==_||j!==0&&Bt.nodeType!==3||(Re=ue+j),Bt!==q||T!==0&&Bt.nodeType!==3||(Ye=ue+T),Bt.nodeType===3&&(ue+=Bt.nodeValue.length),(At=Bt.firstChild)!==null;)kt=Bt,Bt=At;for(;;){if(Bt===p)break t;if(kt===_&&++wt===j&&(Re=ue),kt===q&&++Dt===T&&(Ye=ue),(At=Bt.nextSibling)!==null)break;Bt=kt,kt=Bt.parentNode}Bt=At}_=Re===-1||Ye===-1?null:{start:Re,end:Ye}}else _=null}_=_||{start:0,end:0}}else _=null;for(GR={focusedElem:p,selectionRange:_},xS=!1,Ji=g;Ji!==null;)if(g=Ji,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,Ji=p;else for(;Ji!==null;){switch(g=Ji,q=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&q!==null){p=void 0,_=g,j=q.memoizedProps,q=q.memoizedState,T=_.stateNode;try{var ir=Rp(_.type,j,_.elementType===_.type);p=T.getSnapshotBeforeUpdate(ir,q),T.__reactInternalSnapshotBeforeUpdate=p}catch(Vn){Ms(_,_.return,Vn)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,_=p.nodeType,_===9)ZR(p);else if(_===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":ZR(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(r(163))}if(p=g.sibling,p!==null){p.return=g.return,Ji=p;break}Ji=g.return}}function W8(p,g,_){var T=_.flags;switch(_.tag){case 0:case 11:case 15:Of(p,_),T&4&&lv(5,_);break;case 1:if(Of(p,_),T&4)if(p=_.stateNode,g===null)try{p.componentDidMount()}catch(ue){Ms(_,_.return,ue)}else{var j=Rp(_.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(j,g,p.__reactInternalSnapshotBeforeUpdate)}catch(ue){Ms(_,_.return,ue)}}T&64&&B8(_),T&512&&cv(_,_.return);break;case 3:if(Of(p,_),T&64&&(p=_.updateQueue,p!==null)){if(g=null,_.child!==null)switch(_.child.tag){case 27:case 5:g=_.child.stateNode;break;case 1:g=_.child.stateNode}try{EF(p,g)}catch(ue){Ms(_,_.return,ue)}}break;case 27:g===null&&T&4&&q8(_);case 26:case 5:Of(p,_),g===null&&T&4&&z8(_),T&512&&cv(_,_.return);break;case 12:Of(p,_);break;case 13:Of(p,_),T&4&&K8(p,_),T&64&&(p=_.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(_=dfe.bind(null,_),Rfe(p,_))));break;case 22:if(T=_.memoizedState!==null||ud,!T){g=g!==null&&g.memoizedState!==null||hi,j=ud;var q=hi;ud=T,(hi=g)&&!q?Df(p,_,(_.subtreeFlags&8772)!==0):Of(p,_),ud=j,hi=q}break;case 30:break;default:Of(p,_)}}function H8(p){var g=p.alternate;g!==null&&(p.alternate=null,H8(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&un(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Gs=null,mo=!1;function dd(p,g,_){for(_=_.child;_!==null;)G8(p,g,_),_=_.sibling}function G8(p,g,_){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Pt,_)}catch{}switch(_.tag){case 26:hi||Xc(_,g),dd(p,g,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:hi||Xc(_,g);var T=Gs,j=mo;Uf(_.type)&&(Gs=_.stateNode,mo=!1),dd(p,g,_),bv(_.stateNode),Gs=T,mo=j;break;case 5:hi||Xc(_,g);case 6:if(T=Gs,j=mo,Gs=null,dd(p,g,_),Gs=T,mo=j,Gs!==null)if(mo)try{(Gs.nodeType===9?Gs.body:Gs.nodeName==="HTML"?Gs.ownerDocument.body:Gs).removeChild(_.stateNode)}catch(q){Ms(_,g,q)}else try{Gs.removeChild(_.stateNode)}catch(q){Ms(_,g,q)}break;case 18:Gs!==null&&(mo?(p=Gs,OL(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,_.stateNode),Ev(p)):OL(Gs,_.stateNode));break;case 4:T=Gs,j=mo,Gs=_.stateNode.containerInfo,mo=!0,dd(p,g,_),Gs=T,mo=j;break;case 0:case 11:case 14:case 15:hi||Pf(2,_,g),hi||Pf(4,_,g),dd(p,g,_);break;case 1:hi||(Xc(_,g),T=_.stateNode,typeof T.componentWillUnmount=="function"&&$8(_,g,T)),dd(p,g,_);break;case 21:dd(p,g,_);break;case 22:hi=(T=hi)||_.memoizedState!==null,dd(p,g,_),hi=T;break;default:dd(p,g,_)}}function K8(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{Ev(p)}catch(_){Ms(g,g.return,_)}}function rfe(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new V8),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new V8),g;default:throw Error(r(435,p.tag))}}function SR(p,g){var _=rfe(p);g.forEach(function(T){var j=ffe.bind(null,p,T);_.has(T)||(_.add(T),T.then(j,j))})}function Ho(p,g){var _=g.deletions;if(_!==null)for(var T=0;T<_.length;T++){var j=_[T],q=p,ue=g,Re=ue;e:for(;Re!==null;){switch(Re.tag){case 27:if(Uf(Re.type)){Gs=Re.stateNode,mo=!1;break e}break;case 5:Gs=Re.stateNode,mo=!1;break e;case 3:case 4:Gs=Re.stateNode.containerInfo,mo=!0;break e}Re=Re.return}if(Gs===null)throw Error(r(160));G8(q,ue,j),Gs=null,mo=!1,q=j.alternate,q!==null&&(q.return=null),j.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)Y8(g,p),g=g.sibling}var sc=null;function Y8(p,g){var _=p.alternate,T=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Ho(g,p),Go(p),T&4&&(Pf(3,p,p.return),lv(3,p),Pf(5,p,p.return));break;case 1:Ho(g,p),Go(p),T&512&&(hi||_===null||Xc(_,_.return)),T&64&&ud&&(p=p.updateQueue,p!==null&&(T=p.callbacks,T!==null&&(_=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=_===null?T:_.concat(T))));break;case 26:var j=sc;if(Ho(g,p),Go(p),T&512&&(hi||_===null||Xc(_,_.return)),T&4){var q=_!==null?_.memoizedState:null;if(T=p.memoizedState,_===null)if(T===null)if(p.stateNode===null){e:{T=p.type,_=p.memoizedProps,j=j.ownerDocument||j;t:switch(T){case"title":q=j.getElementsByTagName("title")[0],(!q||q[nn]||q[ve]||q.namespaceURI==="http://www.w3.org/2000/svg"||q.hasAttribute("itemprop"))&&(q=j.createElement(T),j.head.insertBefore(q,j.querySelector("head > title"))),ma(q,T,_),q[ve]=p,Cr(q),T=q;break e;case"link":var ue=qL("link","href",j).get(T+(_.href||""));if(ue){for(var Re=0;Re<ue.length;Re++)if(q=ue[Re],q.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&q.getAttribute("rel")===(_.rel==null?null:_.rel)&&q.getAttribute("title")===(_.title==null?null:_.title)&&q.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){ue.splice(Re,1);break t}}q=j.createElement(T),ma(q,T,_),j.head.appendChild(q);break;case"meta":if(ue=qL("meta","content",j).get(T+(_.content||""))){for(Re=0;Re<ue.length;Re++)if(q=ue[Re],q.getAttribute("content")===(_.content==null?null:""+_.content)&&q.getAttribute("name")===(_.name==null?null:_.name)&&q.getAttribute("property")===(_.property==null?null:_.property)&&q.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&q.getAttribute("charset")===(_.charSet==null?null:_.charSet)){ue.splice(Re,1);break t}}q=j.createElement(T),ma(q,T,_),j.head.appendChild(q);break;default:throw Error(r(468,T))}q[ve]=p,Cr(q),T=q}p.stateNode=T}else VL(j,p.type,p.stateNode);else p.stateNode=UL(j,T,p.memoizedProps);else q!==T?(q===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):q.count--,T===null?VL(j,p.type,p.stateNode):UL(j,T,p.memoizedProps)):T===null&&p.stateNode!==null&&vR(p,p.memoizedProps,_.memoizedProps)}break;case 27:Ho(g,p),Go(p),T&512&&(hi||_===null||Xc(_,_.return)),_!==null&&T&4&&vR(p,p.memoizedProps,_.memoizedProps);break;case 5:if(Ho(g,p),Go(p),T&512&&(hi||_===null||Xc(_,_.return)),p.flags&32){j=p.stateNode;try{yf(j,"")}catch(At){Ms(p,p.return,At)}}T&4&&p.stateNode!=null&&(j=p.memoizedProps,vR(p,j,_!==null?_.memoizedProps:j)),T&1024&&(_R=!0);break;case 6:if(Ho(g,p),Go(p),T&4){if(p.stateNode===null)throw Error(r(162));T=p.memoizedProps,_=p.stateNode;try{_.nodeValue=T}catch(At){Ms(p,p.return,At)}}break;case 3:if(yS=null,j=sc,sc=mS(g.containerInfo),Ho(g,p),sc=j,Go(p),T&4&&_!==null&&_.memoizedState.isDehydrated)try{Ev(g.containerInfo)}catch(At){Ms(p,p.return,At)}_R&&(_R=!1,Z8(p));break;case 4:T=sc,sc=mS(p.stateNode.containerInfo),Ho(g,p),Go(p),sc=T;break;case 12:Ho(g,p),Go(p);break;case 13:Ho(g,p),Go(p),p.child.flags&8192&&p.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(RR=le()),T&4&&(T=p.updateQueue,T!==null&&(p.updateQueue=null,SR(p,T)));break;case 22:j=p.memoizedState!==null;var Ye=_!==null&&_.memoizedState!==null,wt=ud,Dt=hi;if(ud=wt||j,hi=Dt||Ye,Ho(g,p),hi=Dt,ud=wt,Go(p),T&8192)e:for(g=p.stateNode,g._visibility=j?g._visibility&-2:g._visibility|1,j&&(_===null||Ye||ud||hi||Np(p)),_=null,g=p;;){if(g.tag===5||g.tag===26){if(_===null){Ye=_=g;try{if(q=Ye.stateNode,j)ue=q.style,typeof ue.setProperty=="function"?ue.setProperty("display","none","important"):ue.display="none";else{Re=Ye.stateNode;var Bt=Ye.memoizedProps.style,kt=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;Re.style.display=kt==null||typeof kt=="boolean"?"":(""+kt).trim()}}catch(At){Ms(Ye,Ye.return,At)}}}else if(g.tag===6){if(_===null){Ye=g;try{Ye.stateNode.nodeValue=j?"":Ye.memoizedProps}catch(At){Ms(Ye,Ye.return,At)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;_===g&&(_=null),g=g.return}_===g&&(_=null),g.sibling.return=g.return,g=g.sibling}T&4&&(T=p.updateQueue,T!==null&&(_=T.retryQueue,_!==null&&(T.retryQueue=null,SR(p,_))));break;case 19:Ho(g,p),Go(p),T&4&&(T=p.updateQueue,T!==null&&(p.updateQueue=null,SR(p,T)));break;case 30:break;case 21:break;default:Ho(g,p),Go(p)}}function Go(p){var g=p.flags;if(g&2){try{for(var _,T=p.return;T!==null;){if(U8(T)){_=T;break}T=T.return}if(_==null)throw Error(r(160));switch(_.tag){case 27:var j=_.stateNode,q=xR(p);nS(p,q,j);break;case 5:var ue=_.stateNode;_.flags&32&&(yf(ue,""),_.flags&=-33);var Re=xR(p);nS(p,Re,ue);break;case 3:case 4:var Ye=_.stateNode.containerInfo,wt=xR(p);wR(p,wt,Ye);break;default:throw Error(r(161))}}catch(Dt){Ms(p,p.return,Dt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function Z8(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;Z8(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function Of(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)W8(p,g.alternate,g),g=g.sibling}function Np(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:Pf(4,g,g.return),Np(g);break;case 1:Xc(g,g.return);var _=g.stateNode;typeof _.componentWillUnmount=="function"&&$8(g,g.return,_),Np(g);break;case 27:bv(g.stateNode);case 26:case 5:Xc(g,g.return),Np(g);break;case 22:g.memoizedState===null&&Np(g);break;case 30:Np(g);break;default:Np(g)}p=p.sibling}}function Df(p,g,_){for(_=_&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var T=g.alternate,j=p,q=g,ue=q.flags;switch(q.tag){case 0:case 11:case 15:Df(j,q,_),lv(4,q);break;case 1:if(Df(j,q,_),T=q,j=T.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(wt){Ms(T,T.return,wt)}if(T=q,j=T.updateQueue,j!==null){var Re=T.stateNode;try{var Ye=j.shared.hiddenCallbacks;if(Ye!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Ye.length;j++)kF(Ye[j],Re)}catch(wt){Ms(T,T.return,wt)}}_&&ue&64&&B8(q),cv(q,q.return);break;case 27:q8(q);case 26:case 5:Df(j,q,_),_&&T===null&&ue&4&&z8(q),cv(q,q.return);break;case 12:Df(j,q,_);break;case 13:Df(j,q,_),_&&ue&4&&K8(j,q);break;case 22:q.memoizedState===null&&Df(j,q,_),cv(q,q.return);break;case 30:break;default:Df(j,q,_)}g=g.sibling}}function CR(p,g){var _=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==_&&(p!=null&&p.refCount++,_!=null&&Kb(_))}function kR(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Kb(p))}function Jc(p,g,_,T){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)X8(p,g,_,T),g=g.sibling}function X8(p,g,_,T){var j=g.flags;switch(g.tag){case 0:case 11:case 15:Jc(p,g,_,T),j&2048&&lv(9,g);break;case 1:Jc(p,g,_,T);break;case 3:Jc(p,g,_,T),j&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&Kb(p)));break;case 12:if(j&2048){Jc(p,g,_,T),p=g.stateNode;try{var q=g.memoizedProps,ue=q.id,Re=q.onPostCommit;typeof Re=="function"&&Re(ue,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ye){Ms(g,g.return,Ye)}}else Jc(p,g,_,T);break;case 13:Jc(p,g,_,T);break;case 23:break;case 22:q=g.stateNode,ue=g.alternate,g.memoizedState!==null?q._visibility&2?Jc(p,g,_,T):uv(p,g):q._visibility&2?Jc(p,g,_,T):(q._visibility|=2,Og(p,g,_,T,(g.subtreeFlags&10256)!==0)),j&2048&&CR(ue,g);break;case 24:Jc(p,g,_,T),j&2048&&kR(g.alternate,g);break;default:Jc(p,g,_,T)}}function Og(p,g,_,T,j){for(j=j&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var q=p,ue=g,Re=_,Ye=T,wt=ue.flags;switch(ue.tag){case 0:case 11:case 15:Og(q,ue,Re,Ye,j),lv(8,ue);break;case 23:break;case 22:var Dt=ue.stateNode;ue.memoizedState!==null?Dt._visibility&2?Og(q,ue,Re,Ye,j):uv(q,ue):(Dt._visibility|=2,Og(q,ue,Re,Ye,j)),j&&wt&2048&&CR(ue.alternate,ue);break;case 24:Og(q,ue,Re,Ye,j),j&&wt&2048&&kR(ue.alternate,ue);break;default:Og(q,ue,Re,Ye,j)}g=g.sibling}}function uv(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var _=p,T=g,j=T.flags;switch(T.tag){case 22:uv(_,T),j&2048&&CR(T.alternate,T);break;case 24:uv(_,T),j&2048&&kR(T.alternate,T);break;default:uv(_,T)}g=g.sibling}}var dv=8192;function Dg(p){if(p.subtreeFlags&dv)for(p=p.child;p!==null;)J8(p),p=p.sibling}function J8(p){switch(p.tag){case 26:Dg(p),p.flags&dv&&p.memoizedState!==null&&Ufe(sc,p.memoizedState,p.memoizedProps);break;case 5:Dg(p);break;case 3:case 4:var g=sc;sc=mS(p.stateNode.containerInfo),Dg(p),sc=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=dv,dv=16777216,Dg(p),dv=g):Dg(p));break;default:Dg(p)}}function Q8(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function fv(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var T=g[_];Ji=T,tL(T,p)}Q8(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)eL(p),p=p.sibling}function eL(p){switch(p.tag){case 0:case 11:case 15:fv(p),p.flags&2048&&Pf(9,p,p.return);break;case 3:fv(p);break;case 12:fv(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,rS(p)):fv(p);break;default:fv(p)}}function rS(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var T=g[_];Ji=T,tL(T,p)}Q8(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:Pf(8,g,g.return),rS(g);break;case 22:_=g.stateNode,_._visibility&2&&(_._visibility&=-3,rS(g));break;default:rS(g)}p=p.sibling}}function tL(p,g){for(;Ji!==null;){var _=Ji;switch(_.tag){case 0:case 11:case 15:Pf(8,_,g);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var T=_.memoizedState.cachePool.pool;T!=null&&T.refCount++}break;case 24:Kb(_.memoizedState.cache)}if(T=_.child,T!==null)T.return=_,Ji=T;else e:for(_=p;Ji!==null;){T=Ji;var j=T.sibling,q=T.return;if(H8(T),T===_){Ji=null;break e}if(j!==null){j.return=q,Ji=j;break e}Ji=q}}}var sfe={getCacheForType:function(p){var g=Ta(Oi),_=g.data.get(p);return _===void 0&&(_=p(),g.data.set(p,_)),_}},ife=typeof WeakMap=="function"?WeakMap:Map,gs=0,Os=null,Fr=null,Gr=0,ys=0,Ko=null,Ff=!1,Fg=!1,ER=!1,fd=0,ai=0,Lf=0,Mp=0,TR=0,El=0,Lg=0,hv=null,go=null,AR=!1,RR=0,sS=1/0,iS=null,Bf=null,pa=0,$f=null,Bg=null,$g=0,NR=0,MR=null,nL=null,pv=0,IR=null;function Yo(){if((gs&2)!==0&&Gr!==0)return Gr&-Gr;if(U.T!==null){var p=Tg;return p!==0?p:BR()}return Y()}function rL(){El===0&&(El=(Gr&536870912)===0||ss?ot():536870912);var p=kl.current;return p!==null&&(p.flags|=32),El}function Zo(p,g,_){(p===Os&&(ys===2||ys===9)||p.cancelPendingCommit!==null)&&(zg(p,0),zf(p,Gr,El,!1)),st(p,_),((gs&2)===0||p!==Os)&&(p===Os&&((gs&2)===0&&(Mp|=_),ai===4&&zf(p,Gr,El,!1)),Qc(p))}function sL(p,g,_){if((gs&6)!==0)throw Error(r(327));var T=!_&&(g&124)===0&&(g&p.expiredLanes)===0||fe(p,g),j=T?lfe(p,g):OR(p,g,!0),q=T;do{if(j===0){Fg&&!T&&zf(p,g,0,!1);break}else{if(_=p.current.alternate,q&&!afe(_)){j=OR(p,g,!1),q=!1;continue}if(j===2){if(q=g,p.errorRecoveryDisabledLanes&q)var ue=0;else ue=p.pendingLanes&-536870913,ue=ue!==0?ue:ue&536870912?536870912:0;if(ue!==0){g=ue;e:{var Re=p;j=hv;var Ye=Re.current.memoizedState.isDehydrated;if(Ye&&(zg(Re,ue).flags|=256),ue=OR(Re,ue,!1),ue!==2){if(ER&&!Ye){Re.errorRecoveryDisabledLanes|=q,Mp|=q,j=4;break e}q=go,go=j,q!==null&&(go===null?go=q:go.push.apply(go,q))}j=ue}if(q=!1,j!==2)continue}}if(j===1){zg(p,0),zf(p,g,0,!0);break}e:{switch(T=p,q=j,q){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:zf(T,g,El,!Ff);break e;case 2:go=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(j=RR+300-le(),10<j)){if(zf(T,g,El,!Ff),Ie(T,0,!0)!==0)break e;T.timeoutHandle=jL(iL.bind(null,T,_,go,iS,AR,g,El,Mp,Lg,Ff,q,2,-0,0),j);break e}iL(T,_,go,iS,AR,g,El,Mp,Lg,Ff,q,0,-0,0)}}break}while(!0);Qc(p)}function iL(p,g,_,T,j,q,ue,Re,Ye,wt,Dt,Bt,kt,At){if(p.timeoutHandle=-1,Bt=g.subtreeFlags,(Bt&8192||(Bt&16785408)===16785408)&&(wv={stylesheets:null,count:0,unsuspend:zfe},J8(g),Bt=qfe(),Bt!==null)){p.cancelPendingCommit=Bt(fL.bind(null,p,g,q,_,T,j,ue,Re,Ye,Dt,1,kt,At)),zf(p,q,ue,!wt);return}fL(p,g,q,_,T,j,ue,Re,Ye)}function afe(p){for(var g=p;;){var _=g.tag;if((_===0||_===11||_===15)&&g.flags&16384&&(_=g.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var T=0;T<_.length;T++){var j=_[T],q=j.getSnapshot;j=j.value;try{if(!Ea(q(),j))return!1}catch{return!1}}if(_=g.child,g.subtreeFlags&16384&&_!==null)_.return=g,g=_;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function zf(p,g,_,T){g&=~TR,g&=~Mp,p.suspendedLanes|=g,p.pingedLanes&=~g,T&&(p.warmLanes|=g),T=p.expirationTimes;for(var j=g;0<j;){var q=31-en(j),ue=1<<q;T[q]=-1,j&=~ue}_!==0&&_e(p,_,g)}function aS(){return(gs&6)===0?(mv(0),!1):!0}function jR(){if(Fr!==null){if(ys===0)var p=Fr.return;else p=Fr,sd=kp=null,ZA(p),jg=null,iv=0,p=Fr;for(;p!==null;)L8(p.alternate,p),p=p.return;Fr=null}}function zg(p,g){var _=p.timeoutHandle;_!==-1&&(p.timeoutHandle=-1,Cfe(_)),_=p.cancelPendingCommit,_!==null&&(p.cancelPendingCommit=null,_()),jR(),Os=p,Fr=_=td(p.current,null),Gr=g,ys=0,Ko=null,Ff=!1,Fg=fe(p,g),ER=!1,Lg=El=TR=Mp=Lf=ai=0,go=hv=null,AR=!1,(g&8)!==0&&(g|=g&32);var T=p.entangledLanes;if(T!==0)for(p=p.entanglements,T&=g;0<T;){var j=31-en(T),q=1<<j;g|=p[j],T&=~q}return fd=g,sr(),_}function aL(p,g){Ir=null,U.H=G_,g===Zb||g===F_?(g=SF(),ys=3):g===xF?(g=SF(),ys=4):ys=g===C8?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Ko=g,Fr===null&&(ai=1,J_(p,Bn(g,p.current)))}function oL(){var p=U.H;return U.H=G_,p===null?G_:p}function lL(){var p=U.A;return U.A=sfe,p}function PR(){ai=4,Ff||(Gr&4194048)!==Gr&&kl.current!==null||(Fg=!0),(Lf&134217727)===0&&(Mp&134217727)===0||Os===null||zf(Os,Gr,El,!1)}function OR(p,g,_){var T=gs;gs|=2;var j=oL(),q=lL();(Os!==p||Gr!==g)&&(iS=null,zg(p,g)),g=!1;var ue=ai;e:do try{if(ys!==0&&Fr!==null){var Re=Fr,Ye=Ko;switch(ys){case 8:jR(),ue=6;break e;case 3:case 2:case 9:case 6:kl.current===null&&(g=!0);var wt=ys;if(ys=0,Ko=null,Ug(p,Re,Ye,wt),_&&Fg){ue=0;break e}break;default:wt=ys,ys=0,Ko=null,Ug(p,Re,Ye,wt)}}ofe(),ue=ai;break}catch(Dt){aL(p,Dt)}while(!0);return g&&p.shellSuspendCounter++,sd=kp=null,gs=T,U.H=j,U.A=q,Fr===null&&(Os=null,Gr=0,sr()),ue}function ofe(){for(;Fr!==null;)cL(Fr)}function lfe(p,g){var _=gs;gs|=2;var T=oL(),j=lL();Os!==p||Gr!==g?(iS=null,sS=le()+500,zg(p,g)):Fg=fe(p,g);e:do try{if(ys!==0&&Fr!==null){g=Fr;var q=Ko;t:switch(ys){case 1:ys=0,Ko=null,Ug(p,g,q,1);break;case 2:case 9:if(wF(q)){ys=0,Ko=null,uL(g);break}g=function(){ys!==2&&ys!==9||Os!==p||(ys=7),Qc(p)},q.then(g,g);break e;case 3:ys=7;break e;case 4:ys=5;break e;case 7:wF(q)?(ys=0,Ko=null,uL(g)):(ys=0,Ko=null,Ug(p,g,q,7));break;case 5:var ue=null;switch(Fr.tag){case 26:ue=Fr.memoizedState;case 5:case 27:var Re=Fr;if(!ue||WL(ue)){ys=0,Ko=null;var Ye=Re.sibling;if(Ye!==null)Fr=Ye;else{var wt=Re.return;wt!==null?(Fr=wt,oS(wt)):Fr=null}break t}}ys=0,Ko=null,Ug(p,g,q,5);break;case 6:ys=0,Ko=null,Ug(p,g,q,6);break;case 8:jR(),ai=6;break e;default:throw Error(r(462))}}cfe();break}catch(Dt){aL(p,Dt)}while(!0);return sd=kp=null,U.H=T,U.A=j,gs=_,Fr!==null?0:(Os=null,Gr=0,sr(),ai)}function cfe(){for(;Fr!==null&&!ge();)cL(Fr)}function cL(p){var g=D8(p.alternate,p,fd);p.memoizedProps=p.pendingProps,g===null?oS(p):Fr=g}function uL(p){var g=p,_=g.alternate;switch(g.tag){case 15:case 0:g=N8(_,g,g.pendingProps,g.type,void 0,Gr);break;case 11:g=N8(_,g,g.pendingProps,g.type.render,g.ref,Gr);break;case 5:ZA(g);default:L8(_,g),g=Fr=dF(g,fd),g=D8(_,g,fd)}p.memoizedProps=p.pendingProps,g===null?oS(p):Fr=g}function Ug(p,g,_,T){sd=kp=null,ZA(g),jg=null,iv=0;var j=g.return;try{if(Jde(p,j,g,_,Gr)){ai=1,J_(p,Bn(_,p.current)),Fr=null;return}}catch(q){if(j!==null)throw Fr=j,q;ai=1,J_(p,Bn(_,p.current)),Fr=null;return}g.flags&32768?(ss||T===1?p=!0:Fg||(Gr&536870912)!==0?p=!1:(Ff=p=!0,(T===2||T===9||T===3||T===6)&&(T=kl.current,T!==null&&T.tag===13&&(T.flags|=16384))),dL(g,p)):oS(g)}function oS(p){var g=p;do{if((g.flags&32768)!==0){dL(g,Ff);return}p=g.return;var _=efe(g.alternate,g,fd);if(_!==null){Fr=_;return}if(g=g.sibling,g!==null){Fr=g;return}Fr=g=p}while(g!==null);ai===0&&(ai=5)}function dL(p,g){do{var _=tfe(p.alternate,p);if(_!==null){_.flags&=32767,Fr=_;return}if(_=p.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!g&&(p=p.sibling,p!==null)){Fr=p;return}Fr=p=_}while(p!==null);ai=6,Fr=null}function fL(p,g,_,T,j,q,ue,Re,Ye){p.cancelPendingCommit=null;do lS();while(pa!==0);if((gs&6)!==0)throw Error(r(327));if(g!==null){if(g===p.current)throw Error(r(177));if(q=g.lanes|g.childLanes,q|=fa,be(p,_,q,ue,Re,Ye),p===Os&&(Fr=Os=null,Gr=0),Bg=g,$f=p,$g=_,NR=q,MR=j,nL=T,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,hfe(Be,function(){return yL(),null})):(p.callbackNode=null,p.callbackPriority=0),T=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||T){T=U.T,U.T=null,j=H.p,H.p=2,ue=gs,gs|=4;try{nfe(p,g,_)}finally{gs=ue,H.p=j,U.T=T}}pa=1,hL(),pL(),mL()}}function hL(){if(pa===1){pa=0;var p=$f,g=Bg,_=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||_){_=U.T,U.T=null;var T=H.p;H.p=2;var j=gs;gs|=4;try{Y8(g,p);var q=GR,ue=pe(p.containerInfo),Re=q.focusedElem,Ye=q.selectionRange;if(ue!==Re&&Re&&Re.ownerDocument&&ae(Re.ownerDocument.documentElement,Re)){if(Ye!==null&&Ee(Re)){var wt=Ye.start,Dt=Ye.end;if(Dt===void 0&&(Dt=wt),"selectionStart"in Re)Re.selectionStart=wt,Re.selectionEnd=Math.min(Dt,Re.value.length);else{var Bt=Re.ownerDocument||document,kt=Bt&&Bt.defaultView||window;if(kt.getSelection){var At=kt.getSelection(),ir=Re.textContent.length,Vn=Math.min(Ye.start,ir),Cs=Ye.end===void 0?Vn:Math.min(Ye.end,ir);!At.extend&&Vn>Cs&&(ue=Cs,Cs=Vn,Vn=ue);var ht=te(Re,Vn),rt=te(Re,Cs);if(ht&&rt&&(At.rangeCount!==1||At.anchorNode!==ht.node||At.anchorOffset!==ht.offset||At.focusNode!==rt.node||At.focusOffset!==rt.offset)){var xt=Bt.createRange();xt.setStart(ht.node,ht.offset),At.removeAllRanges(),Vn>Cs?(At.addRange(xt),At.extend(rt.node,rt.offset)):(xt.setEnd(rt.node,rt.offset),At.addRange(xt))}}}}for(Bt=[],At=Re;At=At.parentNode;)At.nodeType===1&&Bt.push({element:At,left:At.scrollLeft,top:At.scrollTop});for(typeof Re.focus=="function"&&Re.focus(),Re=0;Re<Bt.length;Re++){var Ft=Bt[Re];Ft.element.scrollLeft=Ft.left,Ft.element.scrollTop=Ft.top}}xS=!!HR,GR=HR=null}finally{gs=j,H.p=T,U.T=_}}p.current=g,pa=2}}function pL(){if(pa===2){pa=0;var p=$f,g=Bg,_=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||_){_=U.T,U.T=null;var T=H.p;H.p=2;var j=gs;gs|=4;try{W8(p,g.alternate,g)}finally{gs=j,H.p=T,U.T=_}}pa=3}}function mL(){if(pa===4||pa===3){pa=0,Ae();var p=$f,g=Bg,_=$g,T=nL;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?pa=5:(pa=0,Bg=$f=null,gL(p,p.pendingLanes));var j=p.pendingLanes;if(j===0&&(Bf=null),he(_),g=g.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Pt,g,void 0,(g.current.flags&128)===128)}catch{}if(T!==null){g=U.T,j=H.p,H.p=2,U.T=null;try{for(var q=p.onRecoverableError,ue=0;ue<T.length;ue++){var Re=T[ue];q(Re.value,{componentStack:Re.stack})}}finally{U.T=g,H.p=j}}($g&3)!==0&&lS(),Qc(p),j=p.pendingLanes,(_&4194090)!==0&&(j&42)!==0?p===IR?pv++:(pv=0,IR=p):pv=0,mv(0)}}function gL(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,Kb(g)))}function lS(p){return hL(),pL(),mL(),yL()}function yL(){if(pa!==5)return!1;var p=$f,g=NR;NR=0;var _=he($g),T=U.T,j=H.p;try{H.p=32>_?32:_,U.T=null,_=MR,MR=null;var q=$f,ue=$g;if(pa=0,Bg=$f=null,$g=0,(gs&6)!==0)throw Error(r(331));var Re=gs;if(gs|=4,eL(q.current),X8(q,q.current,ue,_),gs=Re,mv(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Pt,q)}catch{}return!0}finally{H.p=j,U.T=T,gL(p,g)}}function bL(p,g,_){g=Bn(_,g),g=uR(p.stateNode,g,2),p=Nf(p,g,2),p!==null&&(st(p,2),Qc(p))}function Ms(p,g,_){if(p.tag===3)bL(p,p,_);else for(;g!==null;){if(g.tag===3){bL(g,p,_);break}else if(g.tag===1){var T=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(Bf===null||!Bf.has(T))){p=Bn(_,p),_=_8(2),T=Nf(g,_,2),T!==null&&(S8(_,T,g,p),st(T,2),Qc(T));break}}g=g.return}}function DR(p,g,_){var T=p.pingCache;if(T===null){T=p.pingCache=new ife;var j=new Set;T.set(g,j)}else j=T.get(g),j===void 0&&(j=new Set,T.set(g,j));j.has(_)||(ER=!0,j.add(_),p=ufe.bind(null,p,g,_),g.then(p,p))}function ufe(p,g,_){var T=p.pingCache;T!==null&&T.delete(g),p.pingedLanes|=p.suspendedLanes&_,p.warmLanes&=~_,Os===p&&(Gr&_)===_&&(ai===4||ai===3&&(Gr&62914560)===Gr&&300>le()-RR?(gs&2)===0&&zg(p,0):TR|=_,Lg===Gr&&(Lg=0)),Qc(p)}function vL(p,g){g===0&&(g=$()),p=rc(p,g),p!==null&&(st(p,g),Qc(p))}function dfe(p){var g=p.memoizedState,_=0;g!==null&&(_=g.retryLane),vL(p,_)}function ffe(p,g){var _=0;switch(p.tag){case 13:var T=p.stateNode,j=p.memoizedState;j!==null&&(_=j.retryLane);break;case 19:T=p.stateNode;break;case 22:T=p.stateNode._retryCache;break;default:throw Error(r(314))}T!==null&&T.delete(g),vL(p,_)}function hfe(p,g){return Ne(p,g)}var cS=null,qg=null,FR=!1,uS=!1,LR=!1,Ip=0;function Qc(p){p!==qg&&p.next===null&&(qg===null?cS=qg=p:qg=qg.next=p),uS=!0,FR||(FR=!0,mfe())}function mv(p,g){if(!LR&&uS){LR=!0;do for(var _=!1,T=cS;T!==null;){if(p!==0){var j=T.pendingLanes;if(j===0)var q=0;else{var ue=T.suspendedLanes,Re=T.pingedLanes;q=(1<<31-en(42|p)+1)-1,q&=j&~(ue&~Re),q=q&201326741?q&201326741|1:q?q|2:0}q!==0&&(_=!0,SL(T,q))}else q=Gr,q=Ie(T,T===Os?q:0,T.cancelPendingCommit!==null||T.timeoutHandle!==-1),(q&3)===0||fe(T,q)||(_=!0,SL(T,q));T=T.next}while(_);LR=!1}}function pfe(){xL()}function xL(){uS=FR=!1;var p=0;Ip!==0&&(Sfe()&&(p=Ip),Ip=0);for(var g=le(),_=null,T=cS;T!==null;){var j=T.next,q=wL(T,g);q===0?(T.next=null,_===null?cS=j:_.next=j,j===null&&(qg=_)):(_=T,(p!==0||(q&3)!==0)&&(uS=!0)),T=j}mv(p)}function wL(p,g){for(var _=p.suspendedLanes,T=p.pingedLanes,j=p.expirationTimes,q=p.pendingLanes&-62914561;0<q;){var ue=31-en(q),Re=1<<ue,Ye=j[ue];Ye===-1?((Re&_)===0||(Re&T)!==0)&&(j[ue]=vt(Re,g)):Ye<=g&&(p.expiredLanes|=Re),q&=~Re}if(g=Os,_=Gr,_=Ie(p,p===g?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),T=p.callbackNode,_===0||p===g&&(ys===2||ys===9)||p.cancelPendingCommit!==null)return T!==null&&T!==null&&K(T),p.callbackNode=null,p.callbackPriority=0;if((_&3)===0||fe(p,_)){if(g=_&-_,g===p.callbackPriority)return g;switch(T!==null&&K(T),he(_)){case 2:case 8:_=Te;break;case 32:_=Be;break;case 268435456:_=lt;break;default:_=Be}return T=_L.bind(null,p),_=Ne(_,T),p.callbackPriority=g,p.callbackNode=_,g}return T!==null&&T!==null&&K(T),p.callbackPriority=2,p.callbackNode=null,2}function _L(p,g){if(pa!==0&&pa!==5)return p.callbackNode=null,p.callbackPriority=0,null;var _=p.callbackNode;if(lS()&&p.callbackNode!==_)return null;var T=Gr;return T=Ie(p,p===Os?T:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),T===0?null:(sL(p,T,g),wL(p,le()),p.callbackNode!=null&&p.callbackNode===_?_L.bind(null,p):null)}function SL(p,g){if(lS())return null;sL(p,g,!0)}function mfe(){kfe(function(){(gs&6)!==0?Ne(re,pfe):xL()})}function BR(){return Ip===0&&(Ip=ot()),Ip}function CL(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:Hu(""+p)}function kL(p,g){var _=g.ownerDocument.createElement("input");return _.name=g.name,_.value=g.value,p.id&&_.setAttribute("form",p.id),g.parentNode.insertBefore(_,g),p=new FormData(p),_.parentNode.removeChild(_),p}function gfe(p,g,_,T,j){if(g==="submit"&&_&&_.stateNode===j){var q=CL((j[Oe]||null).action),ue=T.submitter;ue&&(g=(g=ue[Oe]||null)?CL(g.formAction):ue.getAttribute("formAction"),g!==null&&(q=g,ue=null));var Re=new cg("action","action",null,T,j);p.push({event:Re,listeners:[{instance:null,listener:function(){if(T.defaultPrevented){if(Ip!==0){var Ye=ue?kL(j,ue):new FormData(j);iR(_,{pending:!0,data:Ye,method:j.method,action:q},null,Ye)}}else typeof q=="function"&&(Re.preventDefault(),Ye=ue?kL(j,ue):new FormData(j),iR(_,{pending:!0,data:Ye,method:j.method,action:q},q,Ye))},currentTarget:j}]})}}for(var $R=0;$R<an.length;$R++){var zR=an[$R],yfe=zR.toLowerCase(),bfe=zR[0].toUpperCase()+zR.slice(1);Gt(yfe,"on"+bfe)}Gt(Ct,"onAnimationEnd"),Gt(Nt,"onAnimationIteration"),Gt(Mt,"onAnimationStart"),Gt("dblclick","onDoubleClick"),Gt("focusin","onFocus"),Gt("focusout","onBlur"),Gt(Ot,"onTransitionRun"),Gt(Yt,"onTransitionStart"),Gt(rn,"onTransitionCancel"),Gt(Ht,"onTransitionEnd"),pn("onMouseEnter",["mouseout","mouseover"]),pn("onMouseLeave",["mouseout","mouseover"]),pn("onPointerEnter",["pointerout","pointerover"]),pn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vfe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gv));function EL(p,g){g=(g&4)!==0;for(var _=0;_<p.length;_++){var T=p[_],j=T.event;T=T.listeners;e:{var q=void 0;if(g)for(var ue=T.length-1;0<=ue;ue--){var Re=T[ue],Ye=Re.instance,wt=Re.currentTarget;if(Re=Re.listener,Ye!==q&&j.isPropagationStopped())break e;q=Re,j.currentTarget=wt;try{q(j)}catch(Dt){X_(Dt)}j.currentTarget=null,q=Ye}else for(ue=0;ue<T.length;ue++){if(Re=T[ue],Ye=Re.instance,wt=Re.currentTarget,Re=Re.listener,Ye!==q&&j.isPropagationStopped())break e;q=Re,j.currentTarget=wt;try{q(j)}catch(Dt){X_(Dt)}j.currentTarget=null,q=Ye}}}}function Lr(p,g){var _=g[_t];_===void 0&&(_=g[_t]=new Set);var T=p+"__bubble";_.has(T)||(TL(g,p,2,!1),_.add(T))}function UR(p,g,_){var T=0;g&&(T|=4),TL(_,p,T,g)}var dS="_reactListening"+Math.random().toString(36).slice(2);function qR(p){if(!p[dS]){p[dS]=!0,hn.forEach(function(_){_!=="selectionchange"&&(vfe.has(_)||UR(_,!1,p),UR(_,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[dS]||(g[dS]=!0,UR("selectionchange",!1,g))}}function TL(p,g,_,T){switch(XL(g)){case 2:var j=Hfe;break;case 8:j=Gfe;break;default:j=rN}_=j.bind(null,g,_,p),j=void 0,!Nb||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(j=!0),T?j!==void 0?p.addEventListener(g,_,{capture:!0,passive:j}):p.addEventListener(g,_,!0):j!==void 0?p.addEventListener(g,_,{passive:j}):p.addEventListener(g,_,!1)}function VR(p,g,_,T,j){var q=T;if((g&1)===0&&(g&2)===0&&T!==null)e:for(;;){if(T===null)return;var ue=T.tag;if(ue===3||ue===4){var Re=T.stateNode.containerInfo;if(Re===j)break;if(ue===4)for(ue=T.return;ue!==null;){var Ye=ue.tag;if((Ye===3||Ye===4)&&ue.stateNode.containerInfo===j)return;ue=ue.return}for(;Re!==null;){if(ue=yr(Re),ue===null)return;if(Ye=ue.tag,Ye===5||Ye===6||Ye===26||Ye===27){T=q=ue;continue e}Re=Re.parentNode}}T=T.return}vf(function(){var wt=q,Dt=og(_),Bt=[];e:{var kt=Jt.get(p);if(kt!==void 0){var At=cg,ir=p;switch(p){case"keypress":if(_f(_)===0)break e;case"keydown":case"keyup":At=yg;break;case"focusin":ir="focus",At=Sf;break;case"focusout":ir="blur",At=Sf;break;case"beforeblur":case"afterblur":At=Sf;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":At=fg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":At=x_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":At=Fb;break;case Ct:case Nt:case Mt:At=w_;break;case Ht:At=Lb;break;case"scroll":case"scrollend":At=ug;break;case"wheel":At=vg;break;case"copy":case"cut":case"paste":At=mg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":At=Db;break;case"toggle":case"beforetoggle":At=C_}var Vn=(g&4)!==0,Cs=!Vn&&(p==="scroll"||p==="scrollend"),ht=Vn?kt!==null?kt+"Capture":null:kt;Vn=[];for(var rt=wt,xt;rt!==null;){var Ft=rt;if(xt=Ft.stateNode,Ft=Ft.tag,Ft!==5&&Ft!==26&&Ft!==27||xt===null||ht===null||(Ft=Yu(rt,ht),Ft!=null&&Vn.push(yv(rt,Ft,xt))),Cs)break;rt=rt.return}0<Vn.length&&(kt=new At(kt,ir,null,_,Dt),Bt.push({event:kt,listeners:Vn}))}}if((g&7)===0){e:{if(kt=p==="mouseover"||p==="pointerover",At=p==="mouseout"||p==="pointerout",kt&&_!==vl&&(ir=_.relatedTarget||_.fromElement)&&(yr(ir)||ir[Ke]))break e;if((At||kt)&&(kt=Dt.window===Dt?Dt:(kt=Dt.ownerDocument)?kt.defaultView||kt.parentWindow:window,At?(ir=_.relatedTarget||_.toElement,At=wt,ir=ir?yr(ir):null,ir!==null&&(Cs=i(ir),Vn=ir.tag,ir!==Cs||Vn!==5&&Vn!==27&&Vn!==6)&&(ir=null)):(At=null,ir=wt),At!==ir)){if(Vn=fg,Ft="onMouseLeave",ht="onMouseEnter",rt="mouse",(p==="pointerout"||p==="pointerover")&&(Vn=Db,Ft="onPointerLeave",ht="onPointerEnter",rt="pointer"),Cs=At==null?kt:ns(At),xt=ir==null?kt:ns(ir),kt=new Vn(Ft,rt+"leave",At,_,Dt),kt.target=Cs,kt.relatedTarget=xt,Ft=null,yr(Dt)===wt&&(Vn=new Vn(ht,rt+"enter",ir,_,Dt),Vn.target=xt,Vn.relatedTarget=Cs,Ft=Vn),Cs=Ft,At&&ir)t:{for(Vn=At,ht=ir,rt=0,xt=Vn;xt;xt=Vg(xt))rt++;for(xt=0,Ft=ht;Ft;Ft=Vg(Ft))xt++;for(;0<rt-xt;)Vn=Vg(Vn),rt--;for(;0<xt-rt;)ht=Vg(ht),xt--;for(;rt--;){if(Vn===ht||ht!==null&&Vn===ht.alternate)break t;Vn=Vg(Vn),ht=Vg(ht)}Vn=null}else Vn=null;At!==null&&AL(Bt,kt,At,Vn,!1),ir!==null&&Cs!==null&&AL(Bt,Cs,ir,Vn,!0)}}e:{if(kt=wt?ns(wt):window,At=kt.nodeName&&kt.nodeName.toLowerCase(),At==="select"||At==="input"&&kt.type==="file")var vn=vp;else if(_g(kt))if(wl)vn=Ef;else{vn=ed;var Or=N_}else At=kt.nodeName,!At||At.toLowerCase()!=="input"||kt.type!=="checkbox"&&kt.type!=="radio"?wt&&Rb(wt.elementType)&&(vn=vp):vn=qb;if(vn&&(vn=vn(p,wt))){Ub(Bt,vn,_,Dt);break e}Or&&Or(p,kt,wt),p==="focusout"&&wt&&kt.type==="number"&&wt.memoizedProps.value!=null&&mf(kt,"number",kt.value)}switch(Or=wt?ns(wt):window,p){case"focusin":(_g(Or)||Or.contentEditable==="true")&&(He=Or,nt=wt,it=null);break;case"focusout":it=nt=He=null;break;case"mousedown":dt=!0;break;case"contextmenu":case"mouseup":case"dragend":dt=!1,Xe(Bt,_,Dt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Xe(Bt,_,Dt)}var jn;if(yp)e:{switch(p){case"compositionstart":var Kn="onCompositionStart";break e;case"compositionend":Kn="onCompositionEnd";break e;case"compositionupdate":Kn="onCompositionUpdate";break e}Kn=void 0}else Qu?zb(p,_)&&(Kn="onCompositionEnd"):p==="keydown"&&_.keyCode===229&&(Kn="onCompositionStart");Kn&&(xg&&_.locale!=="ko"&&(Qu||Kn!=="onCompositionStart"?Kn==="onCompositionEnd"&&Qu&&(jn=wf()):(xl=Dt,lg="value"in xl?xl.value:xl.textContent,Qu=!0)),Or=fS(wt,Kn),0<Or.length&&(Kn=new gg(Kn,p,null,_,Dt),Bt.push({event:Kn,listeners:Or}),jn?Kn.data=jn:(jn=E_(_),jn!==null&&(Kn.data=jn)))),(jn=CA?T_(p,_):kA(p,_))&&(Kn=fS(wt,"onBeforeInput"),0<Kn.length&&(Or=new gg("onBeforeInput","beforeinput",null,_,Dt),Bt.push({event:Or,listeners:Kn}),Or.data=jn)),gfe(Bt,p,wt,_,Dt)}EL(Bt,g)})}function yv(p,g,_){return{instance:p,listener:g,currentTarget:_}}function fS(p,g){for(var _=g+"Capture",T=[];p!==null;){var j=p,q=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||q===null||(j=Yu(p,_),j!=null&&T.unshift(yv(p,j,q)),j=Yu(p,g),j!=null&&T.push(yv(p,j,q))),p.tag===3)return T;p=p.return}return[]}function Vg(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function AL(p,g,_,T,j){for(var q=g._reactName,ue=[];_!==null&&_!==T;){var Re=_,Ye=Re.alternate,wt=Re.stateNode;if(Re=Re.tag,Ye!==null&&Ye===T)break;Re!==5&&Re!==26&&Re!==27||wt===null||(Ye=wt,j?(wt=Yu(_,q),wt!=null&&ue.unshift(yv(_,wt,Ye))):j||(wt=Yu(_,q),wt!=null&&ue.push(yv(_,wt,Ye)))),_=_.return}ue.length!==0&&p.push({event:g,listeners:ue})}var xfe=/\r\n?/g,wfe=/\u0000|\uFFFD/g;function RL(p){return(typeof p=="string"?p:""+p).replace(xfe,`
`).replace(wfe,"")}function NL(p,g){return g=RL(g),RL(p)===g}function hS(){}function Ss(p,g,_,T,j,q){switch(_){case"children":typeof T=="string"?g==="body"||g==="textarea"&&T===""||yf(p,T):(typeof T=="number"||typeof T=="bigint")&&g!=="body"&&yf(p,""+T);break;case"className":qa(p,"class",T);break;case"tabIndex":qa(p,"tabindex",T);break;case"dir":case"role":case"viewBox":case"width":case"height":qa(p,_,T);break;case"style":b_(p,T,q);break;case"data":if(g!=="object"){qa(p,"data",T);break}case"src":case"href":if(T===""&&(g!=="a"||_!=="href")){p.removeAttribute(_);break}if(T==null||typeof T=="function"||typeof T=="symbol"||typeof T=="boolean"){p.removeAttribute(_);break}T=Hu(""+T),p.setAttribute(_,T);break;case"action":case"formAction":if(typeof T=="function"){p.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof q=="function"&&(_==="formAction"?(g!=="input"&&Ss(p,g,"name",j.name,j,null),Ss(p,g,"formEncType",j.formEncType,j,null),Ss(p,g,"formMethod",j.formMethod,j,null),Ss(p,g,"formTarget",j.formTarget,j,null)):(Ss(p,g,"encType",j.encType,j,null),Ss(p,g,"method",j.method,j,null),Ss(p,g,"target",j.target,j,null)));if(T==null||typeof T=="symbol"||typeof T=="boolean"){p.removeAttribute(_);break}T=Hu(""+T),p.setAttribute(_,T);break;case"onClick":T!=null&&(p.onclick=hS);break;case"onScroll":T!=null&&Lr("scroll",p);break;case"onScrollEnd":T!=null&&Lr("scrollend",p);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(r(61));if(_=T.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"multiple":p.multiple=T&&typeof T!="function"&&typeof T!="symbol";break;case"muted":p.muted=T&&typeof T!="function"&&typeof T!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(T==null||typeof T=="function"||typeof T=="boolean"||typeof T=="symbol"){p.removeAttribute("xlink:href");break}_=Hu(""+T),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":T!=null&&typeof T!="function"&&typeof T!="symbol"?p.setAttribute(_,""+T):p.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":T&&typeof T!="function"&&typeof T!="symbol"?p.setAttribute(_,""):p.removeAttribute(_);break;case"capture":case"download":T===!0?p.setAttribute(_,""):T!==!1&&T!=null&&typeof T!="function"&&typeof T!="symbol"?p.setAttribute(_,T):p.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":T!=null&&typeof T!="function"&&typeof T!="symbol"&&!isNaN(T)&&1<=T?p.setAttribute(_,T):p.removeAttribute(_);break;case"rowSpan":case"start":T==null||typeof T=="function"||typeof T=="symbol"||isNaN(T)?p.removeAttribute(_):p.setAttribute(_,T);break;case"popover":Lr("beforetoggle",p),Lr("toggle",p),ui(p,"popover",T);break;case"xlinkActuate":da(p,"http://www.w3.org/1999/xlink","xlink:actuate",T);break;case"xlinkArcrole":da(p,"http://www.w3.org/1999/xlink","xlink:arcrole",T);break;case"xlinkRole":da(p,"http://www.w3.org/1999/xlink","xlink:role",T);break;case"xlinkShow":da(p,"http://www.w3.org/1999/xlink","xlink:show",T);break;case"xlinkTitle":da(p,"http://www.w3.org/1999/xlink","xlink:title",T);break;case"xlinkType":da(p,"http://www.w3.org/1999/xlink","xlink:type",T);break;case"xmlBase":da(p,"http://www.w3.org/XML/1998/namespace","xml:base",T);break;case"xmlLang":da(p,"http://www.w3.org/XML/1998/namespace","xml:lang",T);break;case"xmlSpace":da(p,"http://www.w3.org/XML/1998/namespace","xml:space",T);break;case"is":ui(p,"is",T);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=Wa.get(_)||_,ui(p,_,T))}}function WR(p,g,_,T,j,q){switch(_){case"style":b_(p,T,q);break;case"dangerouslySetInnerHTML":if(T!=null){if(typeof T!="object"||!("__html"in T))throw Error(r(61));if(_=T.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"children":typeof T=="string"?yf(p,T):(typeof T=="number"||typeof T=="bigint")&&yf(p,""+T);break;case"onScroll":T!=null&&Lr("scroll",p);break;case"onScrollEnd":T!=null&&Lr("scrollend",p);break;case"onClick":T!=null&&(p.onclick=hS);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!et.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(j=_.endsWith("Capture"),g=_.slice(2,j?_.length-7:void 0),q=p[Oe]||null,q=q!=null?q[_]:null,typeof q=="function"&&p.removeEventListener(g,q,j),typeof T=="function")){typeof q!="function"&&q!==null&&(_ in p?p[_]=null:p.hasAttribute(_)&&p.removeAttribute(_)),p.addEventListener(g,T,j);break e}_ in p?p[_]=T:T===!0?p.setAttribute(_,""):ui(p,_,T)}}}function ma(p,g,_){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lr("error",p),Lr("load",p);var T=!1,j=!1,q;for(q in _)if(_.hasOwnProperty(q)){var ue=_[q];if(ue!=null)switch(q){case"src":T=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Ss(p,g,q,ue,_,null)}}j&&Ss(p,g,"srcSet",_.srcSet,_,null),T&&Ss(p,g,"src",_.src,_,null);return;case"input":Lr("invalid",p);var Re=q=ue=j=null,Ye=null,wt=null;for(T in _)if(_.hasOwnProperty(T)){var Dt=_[T];if(Dt!=null)switch(T){case"name":j=Dt;break;case"type":ue=Dt;break;case"checked":Ye=Dt;break;case"defaultChecked":wt=Dt;break;case"value":q=Dt;break;case"defaultValue":Re=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,g));break;default:Ss(p,g,T,Dt,_,null)}}Tb(p,q,Re,Ye,wt,ue,j,!1),Vc(p);return;case"select":Lr("invalid",p),T=ue=q=null;for(j in _)if(_.hasOwnProperty(j)&&(Re=_[j],Re!=null))switch(j){case"value":q=Re;break;case"defaultValue":ue=Re;break;case"multiple":T=Re;default:Ss(p,g,j,Re,_,null)}g=q,_=ue,p.multiple=!!T,g!=null?Wu(p,!!T,g,!1):_!=null&&Wu(p,!!T,_,!0);return;case"textarea":Lr("invalid",p),q=j=T=null;for(ue in _)if(_.hasOwnProperty(ue)&&(Re=_[ue],Re!=null))switch(ue){case"value":T=Re;break;case"defaultValue":j=Re;break;case"children":q=Re;break;case"dangerouslySetInnerHTML":if(Re!=null)throw Error(r(91));break;default:Ss(p,g,ue,Re,_,null)}Ab(p,T,j,q),Vc(p);return;case"option":for(Ye in _)if(_.hasOwnProperty(Ye)&&(T=_[Ye],T!=null))switch(Ye){case"selected":p.selected=T&&typeof T!="function"&&typeof T!="symbol";break;default:Ss(p,g,Ye,T,_,null)}return;case"dialog":Lr("beforetoggle",p),Lr("toggle",p),Lr("cancel",p),Lr("close",p);break;case"iframe":case"object":Lr("load",p);break;case"video":case"audio":for(T=0;T<gv.length;T++)Lr(gv[T],p);break;case"image":Lr("error",p),Lr("load",p);break;case"details":Lr("toggle",p);break;case"embed":case"source":case"link":Lr("error",p),Lr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(wt in _)if(_.hasOwnProperty(wt)&&(T=_[wt],T!=null))switch(wt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Ss(p,g,wt,T,_,null)}return;default:if(Rb(g)){for(Dt in _)_.hasOwnProperty(Dt)&&(T=_[Dt],T!==void 0&&WR(p,g,Dt,T,_,void 0));return}}for(Re in _)_.hasOwnProperty(Re)&&(T=_[Re],T!=null&&Ss(p,g,Re,T,_,null))}function _fe(p,g,_,T){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,q=null,ue=null,Re=null,Ye=null,wt=null,Dt=null;for(At in _){var Bt=_[At];if(_.hasOwnProperty(At)&&Bt!=null)switch(At){case"checked":break;case"value":break;case"defaultValue":Ye=Bt;default:T.hasOwnProperty(At)||Ss(p,g,At,null,T,Bt)}}for(var kt in T){var At=T[kt];if(Bt=_[kt],T.hasOwnProperty(kt)&&(At!=null||Bt!=null))switch(kt){case"type":q=At;break;case"name":j=At;break;case"checked":wt=At;break;case"defaultChecked":Dt=At;break;case"value":ue=At;break;case"defaultValue":Re=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(r(137,g));break;default:At!==Bt&&Ss(p,g,kt,At,T,Bt)}}pf(p,ue,Re,Ye,wt,Dt,q,j);return;case"select":At=ue=Re=kt=null;for(q in _)if(Ye=_[q],_.hasOwnProperty(q)&&Ye!=null)switch(q){case"value":break;case"multiple":At=Ye;default:T.hasOwnProperty(q)||Ss(p,g,q,null,T,Ye)}for(j in T)if(q=T[j],Ye=_[j],T.hasOwnProperty(j)&&(q!=null||Ye!=null))switch(j){case"value":kt=q;break;case"defaultValue":Re=q;break;case"multiple":ue=q;default:q!==Ye&&Ss(p,g,j,q,T,Ye)}g=Re,_=ue,T=At,kt!=null?Wu(p,!!_,kt,!1):!!T!=!!_&&(g!=null?Wu(p,!!_,g,!0):Wu(p,!!_,_?[]:"",!1));return;case"textarea":At=kt=null;for(Re in _)if(j=_[Re],_.hasOwnProperty(Re)&&j!=null&&!T.hasOwnProperty(Re))switch(Re){case"value":break;case"children":break;default:Ss(p,g,Re,null,T,j)}for(ue in T)if(j=T[ue],q=_[ue],T.hasOwnProperty(ue)&&(j!=null||q!=null))switch(ue){case"value":kt=j;break;case"defaultValue":At=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==q&&Ss(p,g,ue,j,T,q)}gf(p,kt,At);return;case"option":for(var ir in _)if(kt=_[ir],_.hasOwnProperty(ir)&&kt!=null&&!T.hasOwnProperty(ir))switch(ir){case"selected":p.selected=!1;break;default:Ss(p,g,ir,null,T,kt)}for(Ye in T)if(kt=T[Ye],At=_[Ye],T.hasOwnProperty(Ye)&&kt!==At&&(kt!=null||At!=null))switch(Ye){case"selected":p.selected=kt&&typeof kt!="function"&&typeof kt!="symbol";break;default:Ss(p,g,Ye,kt,T,At)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Vn in _)kt=_[Vn],_.hasOwnProperty(Vn)&&kt!=null&&!T.hasOwnProperty(Vn)&&Ss(p,g,Vn,null,T,kt);for(wt in T)if(kt=T[wt],At=_[wt],T.hasOwnProperty(wt)&&kt!==At&&(kt!=null||At!=null))switch(wt){case"children":case"dangerouslySetInnerHTML":if(kt!=null)throw Error(r(137,g));break;default:Ss(p,g,wt,kt,T,At)}return;default:if(Rb(g)){for(var Cs in _)kt=_[Cs],_.hasOwnProperty(Cs)&&kt!==void 0&&!T.hasOwnProperty(Cs)&&WR(p,g,Cs,void 0,T,kt);for(Dt in T)kt=T[Dt],At=_[Dt],!T.hasOwnProperty(Dt)||kt===At||kt===void 0&&At===void 0||WR(p,g,Dt,kt,T,At);return}}for(var ht in _)kt=_[ht],_.hasOwnProperty(ht)&&kt!=null&&!T.hasOwnProperty(ht)&&Ss(p,g,ht,null,T,kt);for(Bt in T)kt=T[Bt],At=_[Bt],!T.hasOwnProperty(Bt)||kt===At||kt==null&&At==null||Ss(p,g,Bt,kt,T,At)}var HR=null,GR=null;function pS(p){return p.nodeType===9?p:p.ownerDocument}function ML(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function IL(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function KR(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var YR=null;function Sfe(){var p=window.event;return p&&p.type==="popstate"?p===YR?!1:(YR=p,!0):(YR=null,!1)}var jL=typeof setTimeout=="function"?setTimeout:void 0,Cfe=typeof clearTimeout=="function"?clearTimeout:void 0,PL=typeof Promise=="function"?Promise:void 0,kfe=typeof queueMicrotask=="function"?queueMicrotask:typeof PL<"u"?function(p){return PL.resolve(null).then(p).catch(Efe)}:jL;function Efe(p){setTimeout(function(){throw p})}function Uf(p){return p==="head"}function OL(p,g){var _=g,T=0,j=0;do{var q=_.nextSibling;if(p.removeChild(_),q&&q.nodeType===8)if(_=q.data,_==="/$"){if(0<T&&8>T){_=T;var ue=p.ownerDocument;if(_&1&&bv(ue.documentElement),_&2&&bv(ue.body),_&4)for(_=ue.head,bv(_),ue=_.firstChild;ue;){var Re=ue.nextSibling,Ye=ue.nodeName;ue[nn]||Ye==="SCRIPT"||Ye==="STYLE"||Ye==="LINK"&&ue.rel.toLowerCase()==="stylesheet"||_.removeChild(ue),ue=Re}}if(j===0){p.removeChild(q),Ev(g);return}j--}else _==="$"||_==="$?"||_==="$!"?j++:T=_.charCodeAt(0)-48;else T=0;_=q}while(_);Ev(g)}function ZR(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var _=g;switch(g=g.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":ZR(_),un(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}p.removeChild(_)}}function Tfe(p,g,_,T){for(;p.nodeType===1;){var j=_;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!T&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(T){if(!p[nn])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(q=p.getAttribute("rel"),q==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(q!==j.rel||p.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||p.getAttribute("title")!==(j.title==null?null:j.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(q=p.getAttribute("src"),(q!==(j.src==null?null:j.src)||p.getAttribute("type")!==(j.type==null?null:j.type)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&q&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var q=j.name==null?null:""+j.name;if(j.type==="hidden"&&p.getAttribute("name")===q)return p}else return p;if(p=ic(p.nextSibling),p===null)break}return null}function Afe(p,g,_){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!_||(p=ic(p.nextSibling),p===null))return null;return p}function XR(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function Rfe(p,g){var _=p.ownerDocument;if(p.data!=="$?"||_.readyState==="complete")g();else{var T=function(){g(),_.removeEventListener("DOMContentLoaded",T)};_.addEventListener("DOMContentLoaded",T),p._reactRetry=T}}function ic(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var JR=null;function DL(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var _=p.data;if(_==="$"||_==="$!"||_==="$?"){if(g===0)return p;g--}else _==="/$"&&g++}p=p.previousSibling}return null}function FL(p,g,_){switch(g=pS(_),p){case"html":if(p=g.documentElement,!p)throw Error(r(452));return p;case"head":if(p=g.head,!p)throw Error(r(453));return p;case"body":if(p=g.body,!p)throw Error(r(454));return p;default:throw Error(r(451))}}function bv(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);un(p)}var Tl=new Map,LL=new Set;function mS(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var hd=H.d;H.d={f:Nfe,r:Mfe,D:Ife,C:jfe,L:Pfe,m:Ofe,X:Ffe,S:Dfe,M:Lfe};function Nfe(){var p=hd.f(),g=aS();return p||g}function Mfe(p){var g=Rr(p);g!==null&&g.tag===5&&g.type==="form"?s8(g):hd.r(p)}var Wg=typeof document>"u"?null:document;function BL(p,g,_){var T=Wg;if(T&&typeof g=="string"&&g){var j=Ca(g);j='link[rel="'+p+'"][href="'+j+'"]',typeof _=="string"&&(j+='[crossorigin="'+_+'"]'),LL.has(j)||(LL.add(j),p={rel:p,crossOrigin:_,href:g},T.querySelector(j)===null&&(g=T.createElement("link"),ma(g,"link",p),Cr(g),T.head.appendChild(g)))}}function Ife(p){hd.D(p),BL("dns-prefetch",p,null)}function jfe(p,g){hd.C(p,g),BL("preconnect",p,g)}function Pfe(p,g,_){hd.L(p,g,_);var T=Wg;if(T&&p&&g){var j='link[rel="preload"][as="'+Ca(g)+'"]';g==="image"&&_&&_.imageSrcSet?(j+='[imagesrcset="'+Ca(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(j+='[imagesizes="'+Ca(_.imageSizes)+'"]')):j+='[href="'+Ca(p)+'"]';var q=j;switch(g){case"style":q=Hg(p);break;case"script":q=Gg(p)}Tl.has(q)||(p=u({rel:"preload",href:g==="image"&&_&&_.imageSrcSet?void 0:p,as:g},_),Tl.set(q,p),T.querySelector(j)!==null||g==="style"&&T.querySelector(vv(q))||g==="script"&&T.querySelector(xv(q))||(g=T.createElement("link"),ma(g,"link",p),Cr(g),T.head.appendChild(g)))}}function Ofe(p,g){hd.m(p,g);var _=Wg;if(_&&p){var T=g&&typeof g.as=="string"?g.as:"script",j='link[rel="modulepreload"][as="'+Ca(T)+'"][href="'+Ca(p)+'"]',q=j;switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":q=Gg(p)}if(!Tl.has(q)&&(p=u({rel:"modulepreload",href:p},g),Tl.set(q,p),_.querySelector(j)===null)){switch(T){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(xv(q)))return}T=_.createElement("link"),ma(T,"link",p),Cr(T),_.head.appendChild(T)}}}function Dfe(p,g,_){hd.S(p,g,_);var T=Wg;if(T&&p){var j=rs(T).hoistableStyles,q=Hg(p);g=g||"default";var ue=j.get(q);if(!ue){var Re={loading:0,preload:null};if(ue=T.querySelector(vv(q)))Re.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},_),(_=Tl.get(q))&&QR(p,_);var Ye=ue=T.createElement("link");Cr(Ye),ma(Ye,"link",p),Ye._p=new Promise(function(wt,Dt){Ye.onload=wt,Ye.onerror=Dt}),Ye.addEventListener("load",function(){Re.loading|=1}),Ye.addEventListener("error",function(){Re.loading|=2}),Re.loading|=4,gS(ue,g,T)}ue={type:"stylesheet",instance:ue,count:1,state:Re},j.set(q,ue)}}}function Ffe(p,g){hd.X(p,g);var _=Wg;if(_&&p){var T=rs(_).hoistableScripts,j=Gg(p),q=T.get(j);q||(q=_.querySelector(xv(j)),q||(p=u({src:p,async:!0},g),(g=Tl.get(j))&&eN(p,g),q=_.createElement("script"),Cr(q),ma(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},T.set(j,q))}}function Lfe(p,g){hd.M(p,g);var _=Wg;if(_&&p){var T=rs(_).hoistableScripts,j=Gg(p),q=T.get(j);q||(q=_.querySelector(xv(j)),q||(p=u({src:p,async:!0,type:"module"},g),(g=Tl.get(j))&&eN(p,g),q=_.createElement("script"),Cr(q),ma(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},T.set(j,q))}}function $L(p,g,_,T){var j=(j=je.current)?mS(j):null;if(!j)throw Error(r(446));switch(p){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(g=Hg(_.href),_=rs(j).hoistableStyles,T=_.get(g),T||(T={type:"style",instance:null,count:0,state:null},_.set(g,T)),T):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){p=Hg(_.href);var q=rs(j).hoistableStyles,ue=q.get(p);if(ue||(j=j.ownerDocument||j,ue={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},q.set(p,ue),(q=j.querySelector(vv(p)))&&!q._p&&(ue.instance=q,ue.state.loading=5),Tl.has(p)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},Tl.set(p,_),q||Bfe(j,p,_,ue.state))),g&&T===null)throw Error(r(528,""));return ue}if(g&&T!==null)throw Error(r(529,""));return null;case"script":return g=_.async,_=_.src,typeof _=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Gg(_),_=rs(j).hoistableScripts,T=_.get(g),T||(T={type:"script",instance:null,count:0,state:null},_.set(g,T)),T):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,p))}}function Hg(p){return'href="'+Ca(p)+'"'}function vv(p){return'link[rel="stylesheet"]['+p+"]"}function zL(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function Bfe(p,g,_,T){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?T.loading=1:(g=p.createElement("link"),T.preload=g,g.addEventListener("load",function(){return T.loading|=1}),g.addEventListener("error",function(){return T.loading|=2}),ma(g,"link",_),Cr(g),p.head.appendChild(g))}function Gg(p){return'[src="'+Ca(p)+'"]'}function xv(p){return"script[async]"+p}function UL(p,g,_){if(g.count++,g.instance===null)switch(g.type){case"style":var T=p.querySelector('style[data-href~="'+Ca(_.href)+'"]');if(T)return g.instance=T,Cr(T),T;var j=u({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return T=(p.ownerDocument||p).createElement("style"),Cr(T),ma(T,"style",j),gS(T,_.precedence,p),g.instance=T;case"stylesheet":j=Hg(_.href);var q=p.querySelector(vv(j));if(q)return g.state.loading|=4,g.instance=q,Cr(q),q;T=zL(_),(j=Tl.get(j))&&QR(T,j),q=(p.ownerDocument||p).createElement("link"),Cr(q);var ue=q;return ue._p=new Promise(function(Re,Ye){ue.onload=Re,ue.onerror=Ye}),ma(q,"link",T),g.state.loading|=4,gS(q,_.precedence,p),g.instance=q;case"script":return q=Gg(_.src),(j=p.querySelector(xv(q)))?(g.instance=j,Cr(j),j):(T=_,(j=Tl.get(q))&&(T=u({},_),eN(T,j)),p=p.ownerDocument||p,j=p.createElement("script"),Cr(j),ma(j,"link",T),p.head.appendChild(j),g.instance=j);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(T=g.instance,g.state.loading|=4,gS(T,_.precedence,p));return g.instance}function gS(p,g,_){for(var T=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=T.length?T[T.length-1]:null,q=j,ue=0;ue<T.length;ue++){var Re=T[ue];if(Re.dataset.precedence===g)q=Re;else if(q!==j)break}q?q.parentNode.insertBefore(p,q.nextSibling):(g=_.nodeType===9?_.head:_,g.insertBefore(p,g.firstChild))}function QR(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function eN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var yS=null;function qL(p,g,_){if(yS===null){var T=new Map,j=yS=new Map;j.set(_,T)}else j=yS,T=j.get(_),T||(T=new Map,j.set(_,T));if(T.has(p))return T;for(T.set(p,null),_=_.getElementsByTagName(p),j=0;j<_.length;j++){var q=_[j];if(!(q[nn]||q[ve]||p==="link"&&q.getAttribute("rel")==="stylesheet")&&q.namespaceURI!=="http://www.w3.org/2000/svg"){var ue=q.getAttribute(g)||"";ue=p+ue;var Re=T.get(ue);Re?Re.push(q):T.set(ue,[q])}}return T}function VL(p,g,_){p=p.ownerDocument||p,p.head.insertBefore(_,g==="title"?p.querySelector("head > title"):null)}function $fe(p,g,_){if(_===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function WL(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var wv=null;function zfe(){}function Ufe(p,g,_){if(wv===null)throw Error(r(475));var T=wv;if(g.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var j=Hg(_.href),q=p.querySelector(vv(j));if(q){p=q._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(T.count++,T=bS.bind(T),p.then(T,T)),g.state.loading|=4,g.instance=q,Cr(q);return}q=p.ownerDocument||p,_=zL(_),(j=Tl.get(j))&&QR(_,j),q=q.createElement("link"),Cr(q);var ue=q;ue._p=new Promise(function(Re,Ye){ue.onload=Re,ue.onerror=Ye}),ma(q,"link",_),g.instance=q}T.stylesheets===null&&(T.stylesheets=new Map),T.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(T.count++,g=bS.bind(T),p.addEventListener("load",g),p.addEventListener("error",g))}}function qfe(){if(wv===null)throw Error(r(475));var p=wv;return p.stylesheets&&p.count===0&&tN(p,p.stylesheets),0<p.count?function(g){var _=setTimeout(function(){if(p.stylesheets&&tN(p,p.stylesheets),p.unsuspend){var T=p.unsuspend;p.unsuspend=null,T()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(_)}}:null}function bS(){if(this.count--,this.count===0){if(this.stylesheets)tN(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var vS=null;function tN(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,vS=new Map,g.forEach(Vfe,p),vS=null,bS.call(p))}function Vfe(p,g){if(!(g.state.loading&4)){var _=vS.get(p);if(_)var T=_.get(null);else{_=new Map,vS.set(p,_);for(var j=p.querySelectorAll("link[data-precedence],style[data-precedence]"),q=0;q<j.length;q++){var ue=j[q];(ue.nodeName==="LINK"||ue.getAttribute("media")!=="not all")&&(_.set(ue.dataset.precedence,ue),T=ue)}T&&_.set(null,T)}j=g.instance,ue=j.getAttribute("data-precedence"),q=_.get(ue)||T,q===T&&_.set(null,j),_.set(ue,j),this.count++,T=bS.bind(this),j.addEventListener("load",T),j.addEventListener("error",T),q?q.parentNode.insertBefore(j,q.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(j,p.firstChild)),g.state.loading|=4}}var _v={$$typeof:S,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function Wfe(p,g,_,T,j,q,ue,Re){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ze(0),this.hiddenUpdates=ze(null),this.identifierPrefix=T,this.onUncaughtError=j,this.onCaughtError=q,this.onRecoverableError=ue,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Re,this.incompleteTransitions=new Map}function HL(p,g,_,T,j,q,ue,Re,Ye,wt,Dt,Bt){return p=new Wfe(p,g,_,ue,Re,Ye,wt,Bt),g=1,q===!0&&(g|=24),q=Wo(3,null,null,g),p.current=q,q.stateNode=p,g=DA(),g.refCount++,p.pooledCache=g,g.refCount++,q.memoizedState={element:T,isDehydrated:_,cache:g},$A(q),p}function GL(p){return p?(p=Kc,p):Kc}function KL(p,g,_,T,j,q){j=GL(j),T.context===null?T.context=j:T.pendingContext=j,T=Rf(g),T.payload={element:_},q=q===void 0?null:q,q!==null&&(T.callback=q),_=Nf(p,T,g),_!==null&&(Zo(_,p,g),Jb(_,p,g))}function YL(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var _=p.retryLane;p.retryLane=_!==0&&_<g?_:g}}function nN(p,g){YL(p,g),(p=p.alternate)&&YL(p,g)}function ZL(p){if(p.tag===13){var g=rc(p,67108864);g!==null&&Zo(g,p,67108864),nN(p,67108864)}}var xS=!0;function Hfe(p,g,_,T){var j=U.T;U.T=null;var q=H.p;try{H.p=2,rN(p,g,_,T)}finally{H.p=q,U.T=j}}function Gfe(p,g,_,T){var j=U.T;U.T=null;var q=H.p;try{H.p=8,rN(p,g,_,T)}finally{H.p=q,U.T=j}}function rN(p,g,_,T){if(xS){var j=sN(T);if(j===null)VR(p,g,T,wS,_),JL(p,T);else if(Yfe(j,p,g,_,T))T.stopPropagation();else if(JL(p,T),g&4&&-1<Kfe.indexOf(p)){for(;j!==null;){var q=Rr(j);if(q!==null)switch(q.tag){case 3:if(q=q.stateNode,q.current.memoizedState.isDehydrated){var ue=we(q.pendingLanes);if(ue!==0){var Re=q;for(Re.pendingLanes|=2,Re.entangledLanes|=2;ue;){var Ye=1<<31-en(ue);Re.entanglements[1]|=Ye,ue&=~Ye}Qc(q),(gs&6)===0&&(sS=le()+500,mv(0))}}break;case 13:Re=rc(q,2),Re!==null&&Zo(Re,q,2),aS(),nN(q,2)}if(q=sN(T),q===null&&VR(p,g,T,wS,_),q===j)break;j=q}j!==null&&T.stopPropagation()}else VR(p,g,T,null,_)}}function sN(p){return p=og(p),iN(p)}var wS=null;function iN(p){if(wS=null,p=yr(p),p!==null){var g=i(p);if(g===null)p=null;else{var _=g.tag;if(_===13){if(p=a(g),p!==null)return p;p=null}else if(_===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return wS=p,null}function XL(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case re:return 2;case Te:return 8;case Be:case ke:return 32;case lt:return 268435456;default:return 32}default:return 32}}var aN=!1,qf=null,Vf=null,Wf=null,Sv=new Map,Cv=new Map,Hf=[],Kfe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function JL(p,g){switch(p){case"focusin":case"focusout":qf=null;break;case"dragenter":case"dragleave":Vf=null;break;case"mouseover":case"mouseout":Wf=null;break;case"pointerover":case"pointerout":Sv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cv.delete(g.pointerId)}}function kv(p,g,_,T,j,q){return p===null||p.nativeEvent!==q?(p={blockedOn:g,domEventName:_,eventSystemFlags:T,nativeEvent:q,targetContainers:[j]},g!==null&&(g=Rr(g),g!==null&&ZL(g)),p):(p.eventSystemFlags|=T,g=p.targetContainers,j!==null&&g.indexOf(j)===-1&&g.push(j),p)}function Yfe(p,g,_,T,j){switch(g){case"focusin":return qf=kv(qf,p,g,_,T,j),!0;case"dragenter":return Vf=kv(Vf,p,g,_,T,j),!0;case"mouseover":return Wf=kv(Wf,p,g,_,T,j),!0;case"pointerover":var q=j.pointerId;return Sv.set(q,kv(Sv.get(q)||null,p,g,_,T,j)),!0;case"gotpointercapture":return q=j.pointerId,Cv.set(q,kv(Cv.get(q)||null,p,g,_,T,j)),!0}return!1}function QL(p){var g=yr(p.target);if(g!==null){var _=i(g);if(_!==null){if(g=_.tag,g===13){if(g=a(_),g!==null){p.blockedOn=g,G(p.priority,function(){if(_.tag===13){var T=Yo();T=Et(T);var j=rc(_,T);j!==null&&Zo(j,_,T),nN(_,T)}});return}}else if(g===3&&_.stateNode.current.memoizedState.isDehydrated){p.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}p.blockedOn=null}function _S(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var _=sN(p.nativeEvent);if(_===null){_=p.nativeEvent;var T=new _.constructor(_.type,_);vl=T,_.target.dispatchEvent(T),vl=null}else return g=Rr(_),g!==null&&ZL(g),p.blockedOn=_,!1;g.shift()}return!0}function eB(p,g,_){_S(p)&&_.delete(g)}function Zfe(){aN=!1,qf!==null&&_S(qf)&&(qf=null),Vf!==null&&_S(Vf)&&(Vf=null),Wf!==null&&_S(Wf)&&(Wf=null),Sv.forEach(eB),Cv.forEach(eB)}function SS(p,g){p.blockedOn===g&&(p.blockedOn=null,aN||(aN=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Zfe)))}var CS=null;function tB(p){CS!==p&&(CS=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){CS===p&&(CS=null);for(var g=0;g<p.length;g+=3){var _=p[g],T=p[g+1],j=p[g+2];if(typeof T!="function"){if(iN(T||_)===null)continue;break}var q=Rr(_);q!==null&&(p.splice(g,3),g-=3,iR(q,{pending:!0,data:j,method:_.method,action:T},T,j))}}))}function Ev(p){function g(Ye){return SS(Ye,p)}qf!==null&&SS(qf,p),Vf!==null&&SS(Vf,p),Wf!==null&&SS(Wf,p),Sv.forEach(g),Cv.forEach(g);for(var _=0;_<Hf.length;_++){var T=Hf[_];T.blockedOn===p&&(T.blockedOn=null)}for(;0<Hf.length&&(_=Hf[0],_.blockedOn===null);)QL(_),_.blockedOn===null&&Hf.shift();if(_=(p.ownerDocument||p).$$reactFormReplay,_!=null)for(T=0;T<_.length;T+=3){var j=_[T],q=_[T+1],ue=j[Oe]||null;if(typeof q=="function")ue||tB(_);else if(ue){var Re=null;if(q&&q.hasAttribute("formAction")){if(j=q,ue=q[Oe]||null)Re=ue.formAction;else if(iN(j)!==null)continue}else Re=ue.action;typeof Re=="function"?_[T+1]=Re:(_.splice(T,3),T-=3),tB(_)}}}function oN(p){this._internalRoot=p}kS.prototype.render=oN.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(r(409));var _=g.current,T=Yo();KL(_,T,p,g,null,null)},kS.prototype.unmount=oN.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;KL(p.current,2,null,p,null,null),aS(),g[Ke]=null}};function kS(p){this._internalRoot=p}kS.prototype.unstable_scheduleHydration=function(p){if(p){var g=Y();p={blockedOn:null,target:p,priority:g};for(var _=0;_<Hf.length&&g!==0&&g<Hf[_].priority;_++);Hf.splice(_,0,p),_===0&&QL(p)}};var nB=t.version;if(nB!=="19.1.0")throw Error(r(527,nB,"19.1.0"));H.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(r(188)):(p=Object.keys(p).join(","),Error(r(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var Xfe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ES=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ES.isDisabled&&ES.supportsFiber)try{Pt=ES.inject(Xfe),qt=ES}catch{}}return Av.createRoot=function(p,g){if(!s(p))throw Error(r(299));var _=!1,T="",j=b8,q=v8,ue=x8,Re=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(T=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(ue=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Re=g.unstable_transitionCallbacks)),g=HL(p,1,!1,null,null,_,T,j,q,ue,Re,null),p[Ke]=g.current,qR(p),new oN(g)},Av.hydrateRoot=function(p,g,_){if(!s(p))throw Error(r(299));var T=!1,j="",q=b8,ue=v8,Re=x8,Ye=null,wt=null;return _!=null&&(_.unstable_strictMode===!0&&(T=!0),_.identifierPrefix!==void 0&&(j=_.identifierPrefix),_.onUncaughtError!==void 0&&(q=_.onUncaughtError),_.onCaughtError!==void 0&&(ue=_.onCaughtError),_.onRecoverableError!==void 0&&(Re=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Ye=_.unstable_transitionCallbacks),_.formState!==void 0&&(wt=_.formState)),g=HL(p,1,!0,g,_??null,T,j,q,ue,Re,Ye,wt),g.context=GL(null),_=g.current,T=Yo(),T=Et(T),j=Rf(T),j.callback=null,Nf(_,j,T),_=T,g.current.lanes=_,st(g,_),Qc(g),p[Ke]=g.current,qR(p),new kS(g)},Av.version="19.1.0",Av}var fB;function hhe(){if(fB)return uN.exports;fB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),uN.exports=fhe(),uN.exports}var phe=hhe();const mhe=Sa(phe);function hB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function fl(...e){return t=>{let n=!1;const r=e.map(s=>{const i=hB(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():hB(e[s],null)}}}}function Nn(...e){return E.useCallback(fl(...e),e)}function Au(e){const t=ghe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(bhe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var XW=Au("Slot");function ghe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=xhe(s),o=vhe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?fl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var yhe=Symbol("radix.slottable");function bhe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===yhe}function vhe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function xhe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function JW(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=JW(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function QW(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=JW(e))&&(r&&(r+=" "),r+=t);return r}const pB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,mB=QW,OP=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return mB(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=pB(u)||pB(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(y=>{let[b,v]=y;return Array.isArray(v)?v.includes({...i,...o}[b]):{...i,...o}[b]===v})?[...c,d,h]:c},[]);return mB(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},DP="-",whe=e=>{const t=She(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(DP);return o[0]===""&&o.length!==1&&o.shift(),eH(o,t)||_he(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},eH=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?eH(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(DP);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},gB=/^\[(.+)\]$/,_he=e=>{if(gB.test(e)){const t=gB.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},She=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)V3(n[s],r,s,t);return r},V3=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:yB(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(Che(s)){V3(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{V3(a,yB(t,i),n,r)})})},yB=(e,t)=>{let n=e;return t.split(DP).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Che=e=>e.isThemeGetter,khe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},W3="!",H3=":",Ehe=H3.length,The=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let y=0;y<s.length;y++){let b=s[y];if(a===0&&o===0){if(b===H3){i.push(s.slice(l,y)),l=y+Ehe;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),d=Ahe(u),h=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const s=t+H3,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},Ahe=e=>e.endsWith(W3)?e.substring(0,e.length-1):e.startsWith(W3)?e.substring(1):e,Rhe=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},Nhe=e=>({cache:khe(e.cacheSize),parseClassName:The(e),sortModifiers:Rhe(e),...whe(e)}),Mhe=/\s+/,Ihe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(Mhe);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:m,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!b,x=r(v?y.substring(0,b):y);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(y),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),S=m?w+W3:w,k=S+x;if(a.includes(k))continue;a.push(k);const C=s(x,v);for(let R=0;R<C.length;++R){const A=C[R];a.push(S+A)}l=u+(l.length>0?" "+l:l)}return l};function jhe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=tH(t))&&(r&&(r+=" "),r+=n);return r}const tH=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=tH(e[r]))&&(n&&(n+=" "),n+=t);return n};function Phe(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=Nhe(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Ihe(l,n);return s(l,u),u}return function(){return i(jhe.apply(null,arguments))}}const Fi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},nH=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,rH=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Ohe=/^\d+\/\d+$/,Dhe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Fhe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Lhe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Bhe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$he=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Kg=e=>Ohe.test(e),jr=e=>!!e&&!Number.isNaN(Number(e)),Kf=e=>!!e&&Number.isInteger(Number(e)),pN=e=>e.endsWith("%")&&jr(e.slice(0,-1)),pd=e=>Dhe.test(e),zhe=()=>!0,Uhe=e=>Fhe.test(e)&&!Lhe.test(e),sH=()=>!1,qhe=e=>Bhe.test(e),Vhe=e=>$he.test(e),Whe=e=>!xn(e)&&!wn(e),Hhe=e=>Dy(e,oH,sH),xn=e=>nH.test(e),jp=e=>Dy(e,lH,Uhe),mN=e=>Dy(e,Xhe,jr),bB=e=>Dy(e,iH,sH),Ghe=e=>Dy(e,aH,Vhe),TS=e=>Dy(e,cH,qhe),wn=e=>rH.test(e),Rv=e=>Fy(e,lH),Khe=e=>Fy(e,Jhe),vB=e=>Fy(e,iH),Yhe=e=>Fy(e,oH),Zhe=e=>Fy(e,aH),AS=e=>Fy(e,cH,!0),Dy=(e,t,n)=>{const r=nH.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Fy=(e,t,n=!1)=>{const r=rH.exec(e);return r?r[1]?t(r[1]):n:!1},iH=e=>e==="position"||e==="percentage",aH=e=>e==="image"||e==="url",oH=e=>e==="length"||e==="size"||e==="bg-size",lH=e=>e==="length",Xhe=e=>e==="number",Jhe=e=>e==="family-name",cH=e=>e==="shadow",Qhe=()=>{const e=Fi("color"),t=Fi("font"),n=Fi("text"),r=Fi("font-weight"),s=Fi("tracking"),i=Fi("leading"),a=Fi("breakpoint"),o=Fi("container"),l=Fi("spacing"),c=Fi("radius"),u=Fi("shadow"),d=Fi("inset-shadow"),h=Fi("text-shadow"),m=Fi("drop-shadow"),y=Fi("blur"),b=Fi("perspective"),v=Fi("aspect"),x=Fi("ease"),w=Fi("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],k=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...k(),wn,xn],R=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],N=()=>[wn,xn,l],I=()=>[Kg,"full","auto",...N()],O=()=>[Kf,"none","subgrid",wn,xn],B=()=>["auto",{span:["full",Kf,wn,xn]},Kf,wn,xn],D=()=>[Kf,"auto",wn,xn],W=()=>["auto","min","max","fr",wn,xn],P=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Z=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...N()],H=()=>[Kg,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],L=()=>[e,wn,xn],ne=()=>[...k(),vB,bB,{position:[wn,xn]}],V=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",Yhe,Hhe,{size:[wn,xn]}],ee=()=>[pN,Rv,jp],se=()=>["","none","full",c,wn,xn],me=()=>["",jr,Rv,jp],ce=()=>["solid","dashed","dotted","double"],je=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],De=()=>[jr,pN,vB,bB],Se=()=>["","none",y,wn,xn],Ce=()=>["none",jr,wn,xn],qe=()=>["none",jr,wn,xn],Qe=()=>[jr,wn,xn],We=()=>[Kg,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[pd],breakpoint:[pd],color:[zhe],container:[pd],"drop-shadow":[pd],ease:["in","out","in-out"],font:[Whe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[pd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[pd],shadow:[pd],spacing:["px",jr],text:[pd],"text-shadow":[pd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Kg,xn,wn,v]}],container:["container"],columns:[{columns:[jr,xn,wn,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[Kf,"auto",wn,xn]}],basis:[{basis:[Kg,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[jr,Kg,"auto","initial","none",xn]}],grow:[{grow:["",jr,wn,xn]}],shrink:[{shrink:["",jr,wn,xn]}],order:[{order:[Kf,"first","last","none",wn,xn]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":W()}],"auto-rows":[{"auto-rows":W()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...P(),"normal"]}],"justify-items":[{"justify-items":[...Z(),"normal"]}],"justify-self":[{"justify-self":["auto",...Z()]}],"align-content":[{content:["normal",...P()]}],"align-items":[{items:[...Z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Z(),{baseline:["","last"]}]}],"place-content":[{"place-content":P()}],"place-items":[{"place-items":[...Z(),"baseline"]}],"place-self":[{"place-self":["auto",...Z()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:H()}],w:[{w:[o,"screen",...H()]}],"min-w":[{"min-w":[o,"screen","none",...H()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...H()]}],h:[{h:["screen",...H()]}],"min-h":[{"min-h":["screen","none",...H()]}],"max-h":[{"max-h":["screen",...H()]}],"font-size":[{text:["base",n,Rv,jp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,wn,mN]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",pN,xn]}],"font-family":[{font:[Khe,xn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,wn,xn]}],"line-clamp":[{"line-clamp":[jr,"none",wn,mN]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",wn,xn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",wn,xn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:L()}],"text-color":[{text:L()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ce(),"wavy"]}],"text-decoration-thickness":[{decoration:[jr,"from-font","auto",wn,jp]}],"text-decoration-color":[{decoration:L()}],"underline-offset":[{"underline-offset":[jr,"auto",wn,xn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",wn,xn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",wn,xn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:V()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Kf,wn,xn],radial:["",wn,xn],conic:[Kf,wn,xn]},Zhe,Ghe]}],"bg-color":[{bg:L()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:L()}],"gradient-via":[{via:L()}],"gradient-to":[{to:L()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:me()}],"border-w-x":[{"border-x":me()}],"border-w-y":[{"border-y":me()}],"border-w-s":[{"border-s":me()}],"border-w-e":[{"border-e":me()}],"border-w-t":[{"border-t":me()}],"border-w-r":[{"border-r":me()}],"border-w-b":[{"border-b":me()}],"border-w-l":[{"border-l":me()}],"divide-x":[{"divide-x":me()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":me()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ce(),"hidden","none"]}],"divide-style":[{divide:[...ce(),"hidden","none"]}],"border-color":[{border:L()}],"border-color-x":[{"border-x":L()}],"border-color-y":[{"border-y":L()}],"border-color-s":[{"border-s":L()}],"border-color-e":[{"border-e":L()}],"border-color-t":[{"border-t":L()}],"border-color-r":[{"border-r":L()}],"border-color-b":[{"border-b":L()}],"border-color-l":[{"border-l":L()}],"divide-color":[{divide:L()}],"outline-style":[{outline:[...ce(),"none","hidden"]}],"outline-offset":[{"outline-offset":[jr,wn,xn]}],"outline-w":[{outline:["",jr,Rv,jp]}],"outline-color":[{outline:L()}],shadow:[{shadow:["","none",u,AS,TS]}],"shadow-color":[{shadow:L()}],"inset-shadow":[{"inset-shadow":["none",d,AS,TS]}],"inset-shadow-color":[{"inset-shadow":L()}],"ring-w":[{ring:me()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:L()}],"ring-offset-w":[{"ring-offset":[jr,jp]}],"ring-offset-color":[{"ring-offset":L()}],"inset-ring-w":[{"inset-ring":me()}],"inset-ring-color":[{"inset-ring":L()}],"text-shadow":[{"text-shadow":["none",h,AS,TS]}],"text-shadow-color":[{"text-shadow":L()}],opacity:[{opacity:[jr,wn,xn]}],"mix-blend":[{"mix-blend":[...je(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":je()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[jr]}],"mask-image-linear-from-pos":[{"mask-linear-from":De()}],"mask-image-linear-to-pos":[{"mask-linear-to":De()}],"mask-image-linear-from-color":[{"mask-linear-from":L()}],"mask-image-linear-to-color":[{"mask-linear-to":L()}],"mask-image-t-from-pos":[{"mask-t-from":De()}],"mask-image-t-to-pos":[{"mask-t-to":De()}],"mask-image-t-from-color":[{"mask-t-from":L()}],"mask-image-t-to-color":[{"mask-t-to":L()}],"mask-image-r-from-pos":[{"mask-r-from":De()}],"mask-image-r-to-pos":[{"mask-r-to":De()}],"mask-image-r-from-color":[{"mask-r-from":L()}],"mask-image-r-to-color":[{"mask-r-to":L()}],"mask-image-b-from-pos":[{"mask-b-from":De()}],"mask-image-b-to-pos":[{"mask-b-to":De()}],"mask-image-b-from-color":[{"mask-b-from":L()}],"mask-image-b-to-color":[{"mask-b-to":L()}],"mask-image-l-from-pos":[{"mask-l-from":De()}],"mask-image-l-to-pos":[{"mask-l-to":De()}],"mask-image-l-from-color":[{"mask-l-from":L()}],"mask-image-l-to-color":[{"mask-l-to":L()}],"mask-image-x-from-pos":[{"mask-x-from":De()}],"mask-image-x-to-pos":[{"mask-x-to":De()}],"mask-image-x-from-color":[{"mask-x-from":L()}],"mask-image-x-to-color":[{"mask-x-to":L()}],"mask-image-y-from-pos":[{"mask-y-from":De()}],"mask-image-y-to-pos":[{"mask-y-to":De()}],"mask-image-y-from-color":[{"mask-y-from":L()}],"mask-image-y-to-color":[{"mask-y-to":L()}],"mask-image-radial":[{"mask-radial":[wn,xn]}],"mask-image-radial-from-pos":[{"mask-radial-from":De()}],"mask-image-radial-to-pos":[{"mask-radial-to":De()}],"mask-image-radial-from-color":[{"mask-radial-from":L()}],"mask-image-radial-to-color":[{"mask-radial-to":L()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":k()}],"mask-image-conic-pos":[{"mask-conic":[jr]}],"mask-image-conic-from-pos":[{"mask-conic-from":De()}],"mask-image-conic-to-pos":[{"mask-conic-to":De()}],"mask-image-conic-from-color":[{"mask-conic-from":L()}],"mask-image-conic-to-color":[{"mask-conic-to":L()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:V()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",wn,xn]}],filter:[{filter:["","none",wn,xn]}],blur:[{blur:Se()}],brightness:[{brightness:[jr,wn,xn]}],contrast:[{contrast:[jr,wn,xn]}],"drop-shadow":[{"drop-shadow":["","none",m,AS,TS]}],"drop-shadow-color":[{"drop-shadow":L()}],grayscale:[{grayscale:["",jr,wn,xn]}],"hue-rotate":[{"hue-rotate":[jr,wn,xn]}],invert:[{invert:["",jr,wn,xn]}],saturate:[{saturate:[jr,wn,xn]}],sepia:[{sepia:["",jr,wn,xn]}],"backdrop-filter":[{"backdrop-filter":["","none",wn,xn]}],"backdrop-blur":[{"backdrop-blur":Se()}],"backdrop-brightness":[{"backdrop-brightness":[jr,wn,xn]}],"backdrop-contrast":[{"backdrop-contrast":[jr,wn,xn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",jr,wn,xn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[jr,wn,xn]}],"backdrop-invert":[{"backdrop-invert":["",jr,wn,xn]}],"backdrop-opacity":[{"backdrop-opacity":[jr,wn,xn]}],"backdrop-saturate":[{"backdrop-saturate":[jr,wn,xn]}],"backdrop-sepia":[{"backdrop-sepia":["",jr,wn,xn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",wn,xn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[jr,"initial",wn,xn]}],ease:[{ease:["linear","initial",x,wn,xn]}],delay:[{delay:[jr,wn,xn]}],animate:[{animate:["none",w,wn,xn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,wn,xn]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:qe()}],"scale-x":[{"scale-x":qe()}],"scale-y":[{"scale-y":qe()}],"scale-z":[{"scale-z":qe()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[wn,xn,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:We()}],"translate-x":[{"translate-x":We()}],"translate-y":[{"translate-y":We()}],"translate-z":[{"translate-z":We()}],"translate-none":["translate-none"],accent:[{accent:L()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:L()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",wn,xn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",wn,xn]}],fill:[{fill:["none",...L()]}],"stroke-w":[{stroke:[jr,Rv,jp,mN]}],stroke:[{stroke:["none",...L()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},epe=Phe(Qhe);function Je(...e){return epe(QW(e))}const G3=OP("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function pt({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?XW:"button";return f.jsx(i,{"data-slot":"button",className:Je(G3({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tpe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),npe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),xB=e=>{const t=npe(e);return t.charAt(0).toUpperCase()+t.slice(1)},uH=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rpe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const spe=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...rpe,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:uH("lucide",s),...o},[...a.map(([c,u])=>E.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=(e,t)=>{const n=E.forwardRef(({className:r,...s},i)=>E.createElement(spe,{ref:i,iconNode:t,className:uH(`lucide-${tpe(xB(e))}`,`lucide-${e}`,r),...s}));return n.displayName=xB(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ipe=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],dH=Ut("archive",ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ape=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],fH=Ut("arrow-down",ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ope=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],lpe=Ut("arrow-left",ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cpe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],upe=Ut("arrow-right",cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dpe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],fpe=Ut("arrow-up",dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],ppe=Ut("ban",hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mpe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],gpe=Ut("book-open-text",mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ype=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],K0=Ut("bot",ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Ly=Ut("brain-circuit",bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],wB=Ut("brain",vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xpe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],wpe=Ut("calendar",xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _pe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],so=Ut("check",_pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Spe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Yl=Ut("chevron-down",Spe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cpe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],kpe=Ut("chevron-left",Cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Epe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],FP=Ut("chevron-right",Epe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tpe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Lh=Ut("chevron-up",Tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ape=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],dE=Ut("chevrons-up-down",Ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rpe=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],Npe=Ut("chevrons-up",Rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Wl=Ut("circle-alert",Mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ipe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],jpe=Ut("circle-check-big",Ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ppe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],fE=Ut("circle-check",Ppe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ope=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Dpe=Ut("circle-stop",Ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Lpe=Ut("circle",Fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],$pe=Ut("circle-x",Bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zpe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],hE=Ut("clipboard",zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],qpe=Ut("clock",Upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vpe=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],LP=Ut("cloud-upload",Vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wpe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],pE=Ut("code",Wpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hpe=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],Gpe=Ut("cog",Hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kpe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Ype=Ut("coins",Kpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zpe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Xpe=Ut("copy",Zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jpe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Qpe=Ut("dollar-sign",Jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eme=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],wc=Ut("download",eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tme=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],nme=Ut("ellipsis-vertical",tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rme=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],sme=Ut("file-archive",rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ime=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],ame=Ut("file-down",ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ome=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],lme=Ut("file-json",ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cme=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],ume=Ut("file-question",cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],K3=Ut("file-text",dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],hme=Ut("file-up",fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],hH=Ut("file",pme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mme=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],pH=Ut("folder-git",mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gme=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mH=Ut("folder-plus",gme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yme=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],_B=Ut("folder-tree",yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],vme=Ut("folder-up",bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],mh=Ut("folder",xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wme=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],_me=Ut("funnel",wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sme=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Tc=Ut("git-branch",Sme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cme=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],gH=Ut("git-commit-horizontal",Cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],yH=Ut("git-merge",kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],BP=Ut("git-pull-request",Eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tme=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Ame=Ut("github",Tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],SB=Ut("globe",Rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Mme=Ut("grip-vertical",Nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ime=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],$P=Ut("hard-drive",Ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Pme=Ut("history",jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ome=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Dme=Ut("house",Ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Y0=Ut("image",Fme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],zP=Ut("info",Lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bme=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],qx=Ut("key",Bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $me=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],bH=Ut("land-plot",$me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zme=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],Ume=Ut("list-restart",zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qme=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Yn=Ut("loader-circle",qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vme=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],Wme=Ut("menu",Vme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],Gme=Ut("message-square-plus",Hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],CB=Ut("message-square-text",Kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yme=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],Y3=Ut("message-square",Yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zme=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Xme=Ut("music",Zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jme=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],vH=Ut("notebook-pen",Jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qme=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],sC=Ut("palette",Qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ege=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],tge=Ut("panel-left-close",ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],rge=Ut("panel-right-close",nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sge=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],mE=Ut("paperclip",sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ige=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],age=Ut("pause",ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oge=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],f1=Ut("pen",oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lge=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],cge=Ut("play",lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uge=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],kB=Ut("plug",uge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dge=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ru=Ut("plus",dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fge=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],EB=Ut("puzzle",fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hge=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]],pge=Ut("rectangle-ellipsis",hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mge=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ym=Ut("refresh-cw",mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gge=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],yge=Ut("rocket",gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],h1=Ut("rotate-ccw",bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ef=Ut("save",vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xge=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],jo=Ut("search",xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wge=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],_ge=Ut("send-horizontal",wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sge=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],Z0=Ut("server",Sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],iC=Ut("settings",Cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kge=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],TB=Ut("shield-alert",kge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ege=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],Tge=Ut("sliders-horizontal",Ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Age=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],Rge=Ut("smile",Age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],xH=Ut("sparkles",Nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],AB=Ut("sparkle",Mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ige=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],fh=Ut("square-pen",Ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Pge=Ut("square",jge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oge=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Dge=Ut("star",Oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],Z3=Ut("tags",Fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lge=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],Bge=Ut("text",Lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Ao=Ut("trash-2",$ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],Uge=Ut("trash",zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qge=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],UP=Ut("triangle-alert",qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vge=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],wH=Ut("upload",Vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wge=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Hge=Ut("user",Wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gge=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],RB=Ut("users",Gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kge=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Yge=Ut("video",Kge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zge=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Vx=Ut("wrench",Zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xge=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Wi=Ut("x",Xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jge=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Qge=Ut("zap",Jge),NB=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Je(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(Ve.Fragment,{children:i},s.id):null})})},MB=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},e0e=e=>e?MB(e):MB,t0e=e=>e;function n0e(e,t=t0e){const n=Ve.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return Ve.useDebugValue(n),n}const IB=e=>{const t=e0e(e),n=r=>n0e(t,r);return Object.assign(n,t),n},Bo=e=>e?IB(e):IB;var _H=Symbol.for("immer-nothing"),jB=Symbol.for("immer-draftable"),cs=Symbol.for("immer-state");function $l(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var X0=Object.getPrototypeOf;function J0(e){return!!e&&!!e[cs]}function Ud(e){var t;return e?SH(e)||Array.isArray(e)||!!e[jB]||!!((t=e.constructor)!=null&&t[jB])||yE(e)||bE(e):!1}var r0e=Object.prototype.constructor.toString();function SH(e){if(!e||typeof e!="object")return!1;const t=X0(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===r0e}function Wx(e,t){gE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function gE(e){const t=e[cs];return t?t.type_:Array.isArray(e)?1:yE(e)?2:bE(e)?3:0}function X3(e,t){return gE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function CH(e,t,n){const r=gE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function s0e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function yE(e){return e instanceof Map}function bE(e){return e instanceof Set}function ta(e){return e.copy_||e.base_}function J3(e,t){if(yE(e))return new Map(e);if(bE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=SH(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[cs];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(X0(e),r)}else{const r=X0(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function qP(e,t=!1){return vE(e)||J0(e)||!Ud(e)||(gE(e)>1&&(e.set=e.add=e.clear=e.delete=i0e),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>qP(r,!0))),e}function i0e(){$l(2)}function vE(e){return Object.isFrozen(e)}var Q3={};function bm(e){const t=Q3[e];return t||$l(0,e),t}function a0e(e,t){Q3[e]||(Q3[e]=t)}var Hx;function aC(){return Hx}function o0e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function PB(e,t){t&&(bm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function ej(e){tj(e),e.drafts_.forEach(l0e),e.drafts_=null}function tj(e){e===Hx&&(Hx=e.parent_)}function OB(e){return Hx=o0e(Hx,e)}function l0e(e){const t=e[cs];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function DB(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[cs].modified_&&(ej(t),$l(4)),Ud(e)&&(e=oC(t,e),t.parent_||lC(t,e)),t.patches_&&bm("Patches").generateReplacementPatches_(n[cs].base_,e,t.patches_,t.inversePatches_)):e=oC(t,n,[]),ej(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==_H?e:void 0}function oC(e,t,n){if(vE(t))return t;const r=t[cs];if(!r)return Wx(t,(s,i)=>FB(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return lC(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),Wx(i,(o,l)=>FB(e,r,s,o,l,n,a)),lC(e,s,!1),n&&e.patches_&&bm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function FB(e,t,n,r,s,i,a){if(J0(s)){const o=i&&t&&t.type_!==3&&!X3(t.assigned_,r)?i.concat(r):void 0,l=oC(e,s,o);if(CH(n,r,l),J0(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(Ud(s)&&!vE(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;oC(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&lC(e,s)}}function lC(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&qP(t,n)}function c0e(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:aC(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=VP;n&&(s=[r],i=Gx);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var VP={get(e,t){if(t===cs)return e;const n=ta(e);if(!X3(n,t))return u0e(e,n,t);const r=n[t];return e.finalized_||!Ud(r)?r:r===gN(e.base_,t)?(yN(e),e.copy_[t]=Kx(r,e)):r},has(e,t){return t in ta(e)},ownKeys(e){return Reflect.ownKeys(ta(e))},set(e,t,n){const r=kH(ta(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=gN(ta(e),t),i=s==null?void 0:s[cs];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(s0e(n,s)&&(n!==void 0||X3(e.base_,t)))return!0;yN(e),Sd(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return gN(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,yN(e),Sd(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=ta(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){$l(11)},getPrototypeOf(e){return X0(e.base_)},setPrototypeOf(){$l(12)}},Gx={};Wx(VP,(e,t)=>{Gx[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Gx.deleteProperty=function(e,t){return Gx.set.call(this,e,t,void 0)};Gx.set=function(e,t,n){return VP.set.call(this,e[0],t,n,e[0])};function gN(e,t){const n=e[cs];return(n?ta(n):e)[t]}function u0e(e,t,n){var s;const r=kH(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function kH(e,t){if(!(t in e))return;let n=X0(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=X0(n)}}function Sd(e){e.modified_||(e.modified_=!0,e.parent_&&Sd(e.parent_))}function yN(e){e.copy_||(e.copy_=J3(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var d0e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&$l(6),r!==void 0&&typeof r!="function"&&$l(7);let s;if(Ud(t)){const i=OB(this),a=Kx(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?ej(i):tj(i)}return PB(i,r),DB(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===_H&&(s=void 0),this.autoFreeze_&&qP(s,!0),r){const i=[],a=[];bm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else $l(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ud(e)||$l(8),J0(e)&&(e=f0e(e));const t=OB(this),n=Kx(e,void 0);return n[cs].isManual_=!0,tj(t),n}finishDraft(e,t){const n=e&&e[cs];(!n||!n.isManual_)&&$l(9);const{scope_:r}=n;return PB(r,t),DB(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=bm("Patches").applyPatches_;return J0(e)?r(e,t):this.produce(e,s=>r(s,t))}};function Kx(e,t){const n=yE(e)?bm("MapSet").proxyMap_(e,t):bE(e)?bm("MapSet").proxySet_(e,t):c0e(e,t);return(t?t.scope_:aC()).drafts_.push(n),n}function f0e(e){return J0(e)||$l(10,e),EH(e)}function EH(e){if(!Ud(e)||vE(e))return e;const t=e[cs];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=J3(e,t.scope_.immer_.useStrictShallowCopy_)}else n=J3(e,!0);return Wx(n,(r,s)=>{CH(n,r,EH(s))}),t&&(t.finalized_=!1),n}function h0e(){class e extends Map{constructor(l,c){super(),this[cs]={type_:2,parent_:c,scope_:c?c.scope_:aC(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return ta(this[cs]).size}has(l){return ta(this[cs]).has(l)}set(l,c){const u=this[cs];return a(u),(!ta(u).has(l)||ta(u).get(l)!==c)&&(n(u),Sd(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[cs];return a(c),n(c),Sd(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[cs];a(l),ta(l).size&&(n(l),Sd(l),l.assigned_=new Map,Wx(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[cs];ta(u).forEach((d,h,m)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[cs];a(c);const u=ta(c).get(l);if(c.finalized_||!Ud(u)||u!==c.base_.get(l))return u;const d=Kx(u,c);return n(c),c.copy_.set(l,d),d}keys(){return ta(this[cs]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[cs]={type_:3,parent_:c,scope_:c?c.scope_:aC(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return ta(this[cs]).size}has(l){const c=this[cs];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[cs];return a(c),this.has(l)||(i(c),Sd(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[cs];return a(c),i(c),Sd(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[cs];a(l),ta(l).size&&(i(l),Sd(l),l.copy_.clear())}values(){const l=this[cs];return a(l),i(l),l.copy_.values()}entries(){const l=this[cs];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Ud(l)){const c=Kx(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&$l(3,JSON.stringify(ta(o)))}a0e("MapSet",{proxyMap_:t,proxySet_:s})}var hl=new d0e,p0e=hl.produce;hl.produceWithPatches.bind(hl);hl.setAutoFreeze.bind(hl);hl.setUseStrictShallowCopy.bind(hl);hl.applyPatches.bind(hl);hl.createDraft.bind(hl);hl.finishDraft.bind(hl);const m0e=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?p0e(s):s;return t(o,i,...a)},e(r.setState,n,r)),$o=m0e;function g0e(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Pe=g0e(),$r={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},p0={blockRenderersChanged:"block.renderer.renderers.changed",registerBlockRendererRequest:"block.renderer.register.request",unregisterBlockRendererRequest:"block.renderer.unregister.request"},Ui=Bo($o((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},blockRenderers:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Pe.emit($r.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Pe.emit($r.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Pe.emit($r.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Pe.emit($r.canvasControlsChanged,{controls:t().canvasControls})},registerBlockRenderer:n=>(e(r=>{r.blockRenderers[n.id]&&console.warn(`ControlRegistryStore: BlockRenderer with ID "${n.id}" already registered. Overwriting.`),r.blockRenderers[n.id]=n}),Pe.emit(p0.blockRenderersChanged,{renderers:t().blockRenderers}),()=>t().unregisterBlockRenderer(n.id)),unregisterBlockRenderer:n=>{e(r=>{r.blockRenderers[n]?delete r.blockRenderers[n]:console.warn(`ControlRegistryStore: BlockRenderer with ID "${n}" not found for unregistration.`)}),Pe.emit(p0.blockRenderersChanged,{renderers:t().blockRenderers})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Pe.emit($r.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Pe.emit($r.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Pe.emit($r.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Pe.emit($r.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Pe.emit($r.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Pe.emit($r.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:$r.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:$r.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:$r.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:$r.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:$r.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:$r.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:p0.registerBlockRendererRequest,handler:s=>{r.registerBlockRenderer(s.renderer)},storeId:n},{eventName:p0.unregisterBlockRendererRequest,handler:s=>{r.unregisterBlockRenderer(s.id)},storeId:n},{eventName:$r.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:$r.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:$r.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:$r.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:$r.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:$r.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var T2={exports:{}},y0e=T2.exports,LB;function b0e(){return LB||(LB=1,function(e,t){(function(n,r){e.exports=r()})(y0e,function(){var n=function(M,z){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,ae){te.__proto__=ae}||function(te,ae){for(var pe in ae)Object.prototype.hasOwnProperty.call(ae,pe)&&(te[pe]=ae[pe])})(M,z)},r=function(){return(r=Object.assign||function(M){for(var z,te=1,ae=arguments.length;te<ae;te++)for(var pe in z=arguments[te])Object.prototype.hasOwnProperty.call(z,pe)&&(M[pe]=z[pe]);return M}).apply(this,arguments)};function s(M,z,te){for(var ae,pe=0,Ee=z.length;pe<Ee;pe++)!ae&&pe in z||((ae=ae||Array.prototype.slice.call(z,0,pe))[pe]=z[pe]);return M.concat(ae||Array.prototype.slice.call(z))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Qp,a=Object.keys,o=Array.isArray;function l(M,z){return typeof z!="object"||a(z).forEach(function(te){M[te]=z[te]}),M}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(M,z){return u.call(M,z)}function h(M,z){typeof z=="function"&&(z=z(c(M))),(typeof Reflect>"u"?a:Reflect.ownKeys)(z).forEach(function(te){y(M,te,z[te])})}var m=Object.defineProperty;function y(M,z,te,ae){m(M,z,l(te&&d(te,"get")&&typeof te.get=="function"?{get:te.get,set:te.set,configurable:!0}:{value:te,configurable:!0,writable:!0},ae))}function b(M){return{from:function(z){return M.prototype=Object.create(z.prototype),y(M.prototype,"constructor",M),{extend:h.bind(null,M.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(M,z,te){return x.call(M,z,te)}function S(M,z){return z(M)}function k(M){if(!M)throw new Error("Assertion Failed")}function C(M){i.setImmediate?setImmediate(M):setTimeout(M,0)}function R(M,z){if(typeof z=="string"&&d(M,z))return M[z];if(!z)return M;if(typeof z!="string"){for(var te=[],ae=0,pe=z.length;ae<pe;++ae){var Ee=R(M,z[ae]);te.push(Ee)}return te}var Le=z.indexOf(".");if(Le!==-1){var He=M[z.substr(0,Le)];return He==null?void 0:R(He,z.substr(Le+1))}}function A(M,z,te){if(M&&z!==void 0&&!("isFrozen"in Object&&Object.isFrozen(M)))if(typeof z!="string"&&"length"in z){k(typeof te!="string"&&"length"in te);for(var ae=0,pe=z.length;ae<pe;++ae)A(M,z[ae],te[ae])}else{var Ee,Le,He=z.indexOf(".");He!==-1?(Ee=z.substr(0,He),(Le=z.substr(He+1))===""?te===void 0?o(M)&&!isNaN(parseInt(Ee))?M.splice(Ee,1):delete M[Ee]:M[Ee]=te:A(He=!(He=M[Ee])||!d(M,Ee)?M[Ee]={}:He,Le,te)):te===void 0?o(M)&&!isNaN(parseInt(z))?M.splice(z,1):delete M[z]:M[z]=te}}function N(M){var z,te={};for(z in M)d(M,z)&&(te[z]=M[z]);return te}var I=[].concat;function O(M){return I.apply([],M)}var Pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(O([8,16,32,64].map(function(M){return["Int","Uint","Float"].map(function(z){return z+M+"Array"})}))).filter(function(M){return i[M]}),B=new Set(Pt.map(function(M){return i[M]})),D=null;function W(M){return D=new WeakMap,M=function z(te){if(!te||typeof te!="object")return te;var ae=D.get(te);if(ae)return ae;if(o(te)){ae=[],D.set(te,ae);for(var pe=0,Ee=te.length;pe<Ee;++pe)ae.push(z(te[pe]))}else if(B.has(te.constructor))ae=te;else{var Le,He=c(te);for(Le in ae=He===Object.prototype?{}:Object.create(He),D.set(te,ae),te)d(te,Le)&&(ae[Le]=z(te[Le]))}return ae}(M),D=null,M}var P={}.toString;function Z(M){return P.call(M).slice(8,-1)}var U=typeof Symbol<"u"?Symbol.iterator:"@@iterator",H=typeof U=="symbol"?function(M){var z;return M!=null&&(z=M[U])&&z.apply(M)}:function(){return null};function L(M,z){return z=M.indexOf(z),0<=z&&M.splice(z,1),0<=z}var ne={};function V(M){var z,te,ae,pe;if(arguments.length===1){if(o(M))return M.slice();if(this===ne&&typeof M=="string")return[M];if(pe=H(M)){for(te=[];!(ae=pe.next()).done;)te.push(ae.value);return te}if(M==null)return[M];if(typeof(z=M.length)!="number")return[M];for(te=new Array(z);z--;)te[z]=M[z];return te}for(z=arguments.length,te=new Array(z);z--;)te[z]=arguments[z];return te}var Q=typeof Symbol<"u"?function(M){return M[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ha=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ft),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function se(M,z){this.name=M,this.message=z}function me(M,z){return M+". Errors: "+Object.keys(z).map(function(te){return z[te].toString()}).filter(function(te,ae,pe){return pe.indexOf(te)===ae}).join(`
`)}function ce(M,z,te,ae){this.failures=z,this.failedKeys=ae,this.successCount=te,this.message=me(M,z)}function je(M,z){this.name="BulkError",this.failures=Object.keys(z).map(function(te){return z[te]}),this.failuresByPos=z,this.message=me(M,this.failures)}b(se).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(ce).from(se),b(je).from(se);var De=Ha.reduce(function(M,z){return M[z]=z+"Error",M},{}),Se=se,Ce=Ha.reduce(function(M,z){var te=z+"Error";function ae(pe,Ee){this.name=te,pe?typeof pe=="string"?(this.message="".concat(pe).concat(Ee?`
 `+Ee:""),this.inner=Ee||null):typeof pe=="object"&&(this.message="".concat(pe.name," ").concat(pe.message),this.inner=pe):(this.message=ee[z]||te,this.inner=null)}return b(ae).from(Se),M[z]=ae,M},{});Ce.Syntax=SyntaxError,Ce.Type=TypeError,Ce.Range=RangeError;var qe=ft.reduce(function(M,z){return M[z+"Error"]=Ce[z],M},{}),Qe=Ha.reduce(function(M,z){return["Syntax","Type","Range"].indexOf(z)===-1&&(M[z+"Error"]=Ce[z]),M},{});function We(){}function Ne(M){return M}function K(M,z){return M==null||M===Ne?z:function(te){return z(M(te))}}function ge(M,z){return function(){M.apply(this,arguments),z.apply(this,arguments)}}function Ae(M,z){return M===We?z:function(){var te=M.apply(this,arguments);te!==void 0&&(arguments[0]=te);var ae=this.onsuccess,pe=this.onerror;this.onsuccess=null,this.onerror=null;var Ee=z.apply(this,arguments);return ae&&(this.onsuccess=this.onsuccess?ge(ae,this.onsuccess):ae),pe&&(this.onerror=this.onerror?ge(pe,this.onerror):pe),Ee!==void 0?Ee:te}}function le(M,z){return M===We?z:function(){M.apply(this,arguments);var te=this.onsuccess,ae=this.onerror;this.onsuccess=this.onerror=null,z.apply(this,arguments),te&&(this.onsuccess=this.onsuccess?ge(te,this.onsuccess):te),ae&&(this.onerror=this.onerror?ge(ae,this.onerror):ae)}}function oe(M,z){return M===We?z:function(te){var ae=M.apply(this,arguments);l(te,ae);var pe=this.onsuccess,Ee=this.onerror;return this.onsuccess=null,this.onerror=null,te=z.apply(this,arguments),pe&&(this.onsuccess=this.onsuccess?ge(pe,this.onsuccess):pe),Ee&&(this.onerror=this.onerror?ge(Ee,this.onerror):Ee),ae===void 0?te===void 0?void 0:te:l(ae,te)}}function re(M,z){return M===We?z:function(){return z.apply(this,arguments)!==!1&&M.apply(this,arguments)}}function Te(M,z){return M===We?z:function(){var te=M.apply(this,arguments);if(te&&typeof te.then=="function"){for(var ae=this,pe=arguments.length,Ee=new Array(pe);pe--;)Ee[pe]=arguments[pe];return te.then(function(){return z.apply(ae,Ee)})}return z.apply(this,arguments)}}Qe.ModifyError=ce,Qe.DexieError=se,Qe.BulkError=je;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ke(M){Be=M}var lt={},Rt=100,Pt=typeof Promise>"u"?[]:function(){var M=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[M,c(M),M];var z=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[z,c(z),M]}(),ft=Pt[0],Ha=Pt[1],Pt=Pt[2],Ha=Ha&&Ha.then,qt=ft&&ft.constructor,Lt=!!Pt,en=function(M,z){fe.push([M,z]),F&&(queueMicrotask(he),F=!1)},xe=!0,F=!0,X=[],ye=[],Fe=Ne,we={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:We,pgp:!1,env:{},finalize:We},Ie=we,fe=[],vt=0,ot=[];function $(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var z=this._PSD=Ie;if(typeof M!="function"){if(M!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&be(this,this._value))}this._state=null,this._value=null,++z.ref,function te(ae,pe){try{pe(function(Ee){if(ae._state===null){if(Ee===ae)throw new TypeError("A promise cannot be resolved with itself.");var Le=ae._lib&&Y();Ee&&typeof Ee.then=="function"?te(ae,function(He,nt){Ee instanceof $?Ee._then(He,nt):Ee.then(He,nt)}):(ae._state=!0,ae._value=Ee,_e(ae)),Le&&G()}},be.bind(null,ae))}catch(Ee){be(ae,Ee)}}(this,M)}var ze={get:function(){var M=Ie,z=Xt;function te(ae,pe){var Ee=this,Le=!M.global&&(M!==Ie||z!==Xt),He=Le&&!Rr(),nt=new $(function(it,dt){Ue(Ee,new st(Vt(ae,M,Le,He),Vt(pe,M,Le,He),it,dt,M))});return this._consoleTask&&(nt._consoleTask=this._consoleTask),nt}return te.prototype=lt,te},set:function(M){y(this,"then",M&&M.prototype===lt?ze:{get:function(){return M},set:ze.set})}};function st(M,z,te,ae,pe){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof z=="function"?z:null,this.resolve=te,this.reject=ae,this.psd=pe}function be(M,z){var te,ae;ye.push(z),M._state===null&&(te=M._lib&&Y(),z=Fe(z),M._state=!1,M._value=z,ae=M,X.some(function(pe){return pe._value===ae._value})||X.push(ae),_e(M),te&&G())}function _e(M){var z=M._listeners;M._listeners=[];for(var te=0,ae=z.length;te<ae;++te)Ue(M,z[te]);var pe=M._PSD;--pe.ref||pe.finalize(),vt===0&&(++vt,en(function(){--vt==0&&J()},[]))}function Ue(M,z){if(M._state!==null){var te=M._state?z.onFulfilled:z.onRejected;if(te===null)return(M._state?z.resolve:z.reject)(M._value);++z.psd.ref,++vt,en(Et,[te,M,z])}else M._listeners.push(z)}function Et(M,z,te){try{var ae,pe=z._value;!z._state&&ye.length&&(ye=[]),ae=Be&&z._consoleTask?z._consoleTask.run(function(){return M(pe)}):M(pe),z._state||ye.indexOf(pe)!==-1||function(Ee){for(var Le=X.length;Le;)if(X[--Le]._value===Ee._value)return X.splice(Le,1)}(z),te.resolve(ae)}catch(Ee){te.reject(Ee)}finally{--vt==0&&J(),--te.psd.ref||te.psd.finalize()}}function he(){et(we,function(){Y()&&G()})}function Y(){var M=xe;return F=xe=!1,M}function G(){var M,z,te;do for(;0<fe.length;)for(M=fe,fe=[],te=M.length,z=0;z<te;++z){var ae=M[z];ae[0].apply(null,ae[1])}while(0<fe.length);F=xe=!0}function J(){var M=X;X=[],M.forEach(function(ae){ae._PSD.onunhandled.call(null,ae._value,ae)});for(var z=ot.slice(0),te=z.length;te;)z[--te]()}function ve(M){return new $(lt,!1,M)}function Oe(M,z){var te=Ie;return function(){var ae=Y(),pe=Ie;try{return Cr(te,!0),M.apply(this,arguments)}catch(Ee){z&&z(Ee)}finally{Cr(pe,!1),ae&&G()}}}h($.prototype,{then:ze,_then:function(M,z){Ue(this,new st(null,null,M,z,Ie))},catch:function(M){if(arguments.length===1)return this.then(null,M);var z=M,te=arguments[1];return typeof z=="function"?this.then(null,function(ae){return(ae instanceof z?te:ve)(ae)}):this.then(null,function(ae){return(ae&&ae.name===z?te:ve)(ae)})},finally:function(M){return this.then(function(z){return $.resolve(M()).then(function(){return z})},function(z){return $.resolve(M()).then(function(){return ve(z)})})},timeout:function(M,z){var te=this;return M<1/0?new $(function(ae,pe){var Ee=setTimeout(function(){return pe(new Ce.Timeout(z))},M);te.then(ae,pe).finally(clearTimeout.bind(null,Ee))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y($.prototype,Symbol.toStringTag,"Dexie.Promise"),we.env=hn(),h($,{all:function(){var M=V.apply(null,arguments).map(ns);return new $(function(z,te){M.length===0&&z([]);var ae=M.length;M.forEach(function(pe,Ee){return $.resolve(pe).then(function(Le){M[Ee]=Le,--ae||z(M)},te)})})},resolve:function(M){return M instanceof $?M:M&&typeof M.then=="function"?new $(function(z,te){M.then(z,te)}):new $(lt,!0,M)},reject:ve,race:function(){var M=V.apply(null,arguments).map(ns);return new $(function(z,te){M.map(function(ae){return $.resolve(ae).then(z,te)})})},PSD:{get:function(){return Ie},set:function(M){return Ie=M}},totalEchoes:{get:function(){return Xt}},newPSD:un,usePSD:et,scheduler:{get:function(){return en},set:function(M){en=M}},rejectionMapper:{get:function(){return Fe},set:function(M){Fe=M}},follow:function(M,z){return new $(function(te,ae){return un(function(pe,Ee){var Le=Ie;Le.unhandleds=[],Le.onunhandled=Ee,Le.finalize=ge(function(){var He,nt=this;He=function(){nt.unhandleds.length===0?pe():Ee(nt.unhandleds[0])},ot.push(function it(){He(),ot.splice(ot.indexOf(it),1)}),++vt,en(function(){--vt==0&&J()},[])},Le.finalize),M()},z,te,ae)})}}),qt&&(qt.allSettled&&y($,"allSettled",function(){var M=V.apply(null,arguments).map(ns);return new $(function(z){M.length===0&&z([]);var te=M.length,ae=new Array(te);M.forEach(function(pe,Ee){return $.resolve(pe).then(function(Le){return ae[Ee]={status:"fulfilled",value:Le}},function(Le){return ae[Ee]={status:"rejected",reason:Le}}).then(function(){return--te||z(ae)})})})}),qt.any&&typeof AggregateError<"u"&&y($,"any",function(){var M=V.apply(null,arguments).map(ns);return new $(function(z,te){M.length===0&&te(new AggregateError([]));var ae=M.length,pe=new Array(ae);M.forEach(function(Ee,Le){return $.resolve(Ee).then(function(He){return z(He)},function(He){pe[Le]=He,--ae||te(new AggregateError(pe))})})})}),qt.withResolvers&&($.withResolvers=qt.withResolvers));var Ke={awaits:0,echoes:0,id:0},_t=0,tn=[],zn=0,Xt=0,nn=0;function un(M,z,te,ae){var pe=Ie,Ee=Object.create(pe);return Ee.parent=pe,Ee.ref=0,Ee.global=!1,Ee.id=++nn,we.env,Ee.env=Lt?{Promise:$,PromiseProp:{value:$,configurable:!0,writable:!0},all:$.all,race:$.race,allSettled:$.allSettled,any:$.any,resolve:$.resolve,reject:$.reject}:{},z&&l(Ee,z),++pe.ref,Ee.finalize=function(){--this.parent.ref||this.parent.finalize()},ae=et(Ee,M,te,ae),Ee.ref===0&&Ee.finalize(),ae}function yr(){return Ke.id||(Ke.id=++_t),++Ke.awaits,Ke.echoes+=Rt,Ke.id}function Rr(){return!!Ke.awaits&&(--Ke.awaits==0&&(Ke.id=0),Ke.echoes=Ke.awaits*Rt,!0)}function ns(M){return Ke.echoes&&M&&M.constructor===qt?(yr(),M.then(function(z){return Rr(),z},function(z){return Rr(),rr(z)})):M}function rs(){var M=tn[tn.length-1];tn.pop(),Cr(M,!1)}function Cr(M,z){var te,ae=Ie;(z?!Ke.echoes||zn++&&M===Ie:!zn||--zn&&M===Ie)||queueMicrotask(z?(function(pe){++Xt,Ke.echoes&&--Ke.echoes!=0||(Ke.echoes=Ke.awaits=Ke.id=0),tn.push(Ie),Cr(pe,!0)}).bind(null,M):rs),M!==Ie&&(Ie=M,ae===we&&(we.env=hn()),Lt&&(te=we.env.Promise,z=M.env,(ae.global||M.global)&&(Object.defineProperty(i,"Promise",z.PromiseProp),te.all=z.all,te.race=z.race,te.resolve=z.resolve,te.reject=z.reject,z.allSettled&&(te.allSettled=z.allSettled),z.any&&(te.any=z.any))))}function hn(){var M=i.Promise;return Lt?{Promise:M,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{}}function et(M,z,te,ae,pe){var Ee=Ie;try{return Cr(M,!0),z(te,ae,pe)}finally{Cr(Ee,!1)}}function Vt(M,z,te,ae){return typeof M!="function"?M:function(){var pe=Ie;te&&yr(),Cr(z,!0);try{return M.apply(this,arguments)}finally{Cr(pe,!1),ae&&queueMicrotask(Rr)}}}function pn(M){Promise===qt&&Ke.echoes===0?zn===0?M():enqueueNativeMicroTask(M):setTimeout(M,0)}(""+Ha).indexOf("[native code]")===-1&&(yr=Rr=We);var rr=$.reject,Rs="",es="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Pi="String expected.",ui=[],qa="__dbnames",da="readonly",Hs="readwrite";function qo(M,z){return M?z?function(){return M.apply(this,arguments)&&z.apply(this,arguments)}:M:z}var bl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ff(M){return typeof M!="string"||/\./.test(M)?function(z){return z}:function(z){return z[M]===void 0&&M in z&&delete(z=W(z))[M],z}}function ig(){throw Ce.Type()}function Dr(M,z){try{var te=Cb(M),ae=Cb(z);if(te!==ae)return te==="Array"?1:ae==="Array"?-1:te==="binary"?1:ae==="binary"?-1:te==="string"?1:ae==="string"?-1:te==="Date"?1:ae!=="Date"?NaN:-1;switch(te){case"number":case"Date":case"string":return z<M?1:M<z?-1:0;case"binary":return function(pe,Ee){for(var Le=pe.length,He=Ee.length,nt=Le<He?Le:He,it=0;it<nt;++it)if(pe[it]!==Ee[it])return pe[it]<Ee[it]?-1:1;return Le===He?0:Le<He?-1:1}(Va(M),Va(z));case"Array":return function(pe,Ee){for(var Le=pe.length,He=Ee.length,nt=Le<He?Le:He,it=0;it<nt;++it){var dt=Dr(pe[it],Ee[it]);if(dt!==0)return dt}return Le===He?0:Le<He?-1:1}(M,z)}}catch{}return NaN}function Cb(M){var z=typeof M;return z!="object"?z:ArrayBuffer.isView(M)?"binary":(M=Z(M),M==="ArrayBuffer"?"binary":M)}function Va(M){return M instanceof Uint8Array?M:ArrayBuffer.isView(M)?new Uint8Array(M.buffer,M.byteOffset,M.byteLength):new Uint8Array(M)}var kb=(Ns.prototype._trans=function(M,z,te){var ae=this._tx||Ie.trans,pe=this.name,Ee=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(M==="readonly"?"read":"write"," ").concat(this.name));function Le(it,dt,Xe){if(!Xe.schema[pe])throw new Ce.NotFound("Table "+pe+" not part of transaction");return z(Xe.idbtrans,Xe)}var He=Y();try{var nt=ae&&ae.db._novip===this.db._novip?ae===Ie.trans?ae._promise(M,Le,te):un(function(){return ae._promise(M,Le,te)},{trans:ae,transless:Ie.transless||Ie}):function it(dt,Xe,mt,tt){if(dt.idbdb&&(dt._state.openComplete||Ie.letThrough||dt._vip)){var ut=dt._createTransaction(Xe,mt,dt._dbSchema);try{ut.create(),dt._state.PR1398_maxLoop=3}catch(gt){return gt.name===De.InvalidState&&dt.isOpen()&&0<--dt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),dt.close({disableAutoOpen:!1}),dt.open().then(function(){return it(dt,Xe,mt,tt)})):rr(gt)}return ut._promise(Xe,function(gt,at){return un(function(){return Ie.trans=ut,tt(gt,at,ut)})}).then(function(gt){if(Xe==="readwrite")try{ut.idbtrans.commit()}catch{}return Xe==="readonly"?gt:ut._completion.then(function(){return gt})})}if(dt._state.openComplete)return rr(new Ce.DatabaseClosed(dt._state.dbOpenError));if(!dt._state.isBeingOpened){if(!dt._state.autoOpen)return rr(new Ce.DatabaseClosed);dt.open().catch(We)}return dt._state.dbReadyPromise.then(function(){return it(dt,Xe,mt,tt)})}(this.db,M,[this.name],Le);return Ee&&(nt._consoleTask=Ee,nt=nt.catch(function(it){return console.trace(it),rr(it)})),nt}finally{He&&G()}},Ns.prototype.get=function(M,z){var te=this;return M&&M.constructor===Object?this.where(M).first(z):M==null?rr(new Ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ae){return te.core.get({trans:ae,key:M}).then(function(pe){return te.hook.reading.fire(pe)})}).then(z)},Ns.prototype.where=function(M){if(typeof M=="string")return new this.db.WhereClause(this,M);if(o(M))return new this.db.WhereClause(this,"[".concat(M.join("+"),"]"));var z=a(M);if(z.length===1)return this.where(z[0]).equals(M[z[0]]);var te=this.schema.indexes.concat(this.schema.primKey).filter(function(He){if(He.compound&&z.every(function(it){return 0<=He.keyPath.indexOf(it)})){for(var nt=0;nt<z.length;++nt)if(z.indexOf(He.keyPath[nt])===-1)return!1;return!0}return!1}).sort(function(He,nt){return He.keyPath.length-nt.keyPath.length})[0];if(te&&this.db._maxKey!==Rs){var Ee=te.keyPath.slice(0,z.length);return this.where(Ee).equals(Ee.map(function(nt){return M[nt]}))}!te&&Be&&console.warn("The query ".concat(JSON.stringify(M)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(z.join("+"),"]"));var ae=this.schema.idxByName;function pe(He,nt){return Dr(He,nt)===0}var Le=z.reduce(function(Xe,nt){var it=Xe[0],dt=Xe[1],Xe=ae[nt],mt=M[nt];return[it||Xe,it||!Xe?qo(dt,Xe&&Xe.multi?function(tt){return tt=R(tt,nt),o(tt)&&tt.some(function(ut){return pe(mt,ut)})}:function(tt){return pe(mt,R(tt,nt))}):dt]},[null,null]),Ee=Le[0],Le=Le[1];return Ee?this.where(Ee.name).equals(M[Ee.keyPath]).filter(Le):te?this.filter(Le):this.where(z).equals("")},Ns.prototype.filter=function(M){return this.toCollection().and(M)},Ns.prototype.count=function(M){return this.toCollection().count(M)},Ns.prototype.offset=function(M){return this.toCollection().offset(M)},Ns.prototype.limit=function(M){return this.toCollection().limit(M)},Ns.prototype.each=function(M){return this.toCollection().each(M)},Ns.prototype.toArray=function(M){return this.toCollection().toArray(M)},Ns.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ns.prototype.orderBy=function(M){return new this.db.Collection(new this.db.WhereClause(this,o(M)?"[".concat(M.join("+"),"]"):M))},Ns.prototype.reverse=function(){return this.toCollection().reverse()},Ns.prototype.mapToClass=function(M){var z,te=this.db,ae=this.name;function pe(){return z!==null&&z.apply(this,arguments)||this}(this.schema.mappedClass=M).prototype instanceof ig&&(function(nt,it){if(typeof it!="function"&&it!==null)throw new TypeError("Class extends value "+String(it)+" is not a constructor or null");function dt(){this.constructor=nt}n(nt,it),nt.prototype=it===null?Object.create(it):(dt.prototype=it.prototype,new dt)}(pe,z=M),Object.defineProperty(pe.prototype,"db",{get:function(){return te},enumerable:!1,configurable:!0}),pe.prototype.table=function(){return ae},M=pe);for(var Ee=new Set,Le=M.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(nt){return Ee.add(nt)});function He(nt){if(!nt)return nt;var it,dt=Object.create(M.prototype);for(it in nt)if(!Ee.has(it))try{dt[it]=nt[it]}catch{}return dt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=He,this.hook("reading",He),M},Ns.prototype.defineClass=function(){return this.mapToClass(function(M){l(this,M)})},Ns.prototype.add=function(M,z){var te=this,ae=this.schema.primKey,pe=ae.auto,Ee=ae.keyPath,Le=M;return Ee&&pe&&(Le=ff(Ee)(M)),this._trans("readwrite",function(He){return te.core.mutate({trans:He,type:"add",keys:z!=null?[z]:null,values:[Le]})}).then(function(He){return He.numFailures?$.reject(He.failures[0]):He.lastResult}).then(function(He){if(Ee)try{A(M,Ee,He)}catch{}return He})},Ns.prototype.update=function(M,z){return typeof M!="object"||o(M)?this.where(":id").equals(M).modify(z):(M=R(M,this.schema.primKey.keyPath),M===void 0?rr(new Ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(M).modify(z))},Ns.prototype.put=function(M,z){var te=this,ae=this.schema.primKey,pe=ae.auto,Ee=ae.keyPath,Le=M;return Ee&&pe&&(Le=ff(Ee)(M)),this._trans("readwrite",function(He){return te.core.mutate({trans:He,type:"put",values:[Le],keys:z!=null?[z]:null})}).then(function(He){return He.numFailures?$.reject(He.failures[0]):He.lastResult}).then(function(He){if(Ee)try{A(M,Ee,He)}catch{}return He})},Ns.prototype.delete=function(M){var z=this;return this._trans("readwrite",function(te){return z.core.mutate({trans:te,type:"delete",keys:[M]})}).then(function(te){return te.numFailures?$.reject(te.failures[0]):void 0})},Ns.prototype.clear=function(){var M=this;return this._trans("readwrite",function(z){return M.core.mutate({trans:z,type:"deleteRange",range:bl})}).then(function(z){return z.numFailures?$.reject(z.failures[0]):void 0})},Ns.prototype.bulkGet=function(M){var z=this;return this._trans("readonly",function(te){return z.core.getMany({keys:M,trans:te}).then(function(ae){return ae.map(function(pe){return z.hook.reading.fire(pe)})})})},Ns.prototype.bulkAdd=function(M,z,te){var ae=this,pe=Array.isArray(z)?z:void 0,Ee=(te=te||(pe?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var it=ae.schema.primKey,He=it.auto,it=it.keyPath;if(it&&pe)throw new Ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(pe&&pe.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var nt=M.length,it=it&&He?M.map(ff(it)):M;return ae.core.mutate({trans:Le,type:"add",keys:pe,values:it,wantResults:Ee}).then(function(ut){var Xe=ut.numFailures,mt=ut.results,tt=ut.lastResult,ut=ut.failures;if(Xe===0)return Ee?mt:tt;throw new je("".concat(ae.name,".bulkAdd(): ").concat(Xe," of ").concat(nt," operations failed"),ut)})})},Ns.prototype.bulkPut=function(M,z,te){var ae=this,pe=Array.isArray(z)?z:void 0,Ee=(te=te||(pe?void 0:z))?te.allKeys:void 0;return this._trans("readwrite",function(Le){var it=ae.schema.primKey,He=it.auto,it=it.keyPath;if(it&&pe)throw new Ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(pe&&pe.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var nt=M.length,it=it&&He?M.map(ff(it)):M;return ae.core.mutate({trans:Le,type:"put",keys:pe,values:it,wantResults:Ee}).then(function(ut){var Xe=ut.numFailures,mt=ut.results,tt=ut.lastResult,ut=ut.failures;if(Xe===0)return Ee?mt:tt;throw new je("".concat(ae.name,".bulkPut(): ").concat(Xe," of ").concat(nt," operations failed"),ut)})})},Ns.prototype.bulkUpdate=function(M){var z=this,te=this.core,ae=M.map(function(Le){return Le.key}),pe=M.map(function(Le){return Le.changes}),Ee=[];return this._trans("readwrite",function(Le){return te.getMany({trans:Le,keys:ae,cache:"clone"}).then(function(He){var nt=[],it=[];M.forEach(function(Xe,mt){var tt=Xe.key,ut=Xe.changes,gt=He[mt];if(gt){for(var at=0,Ct=Object.keys(ut);at<Ct.length;at++){var Nt=Ct[at],Mt=ut[Nt];if(Nt===z.schema.primKey.keyPath){if(Dr(Mt,tt)!==0)throw new Ce.Constraint("Cannot update primary key in bulkUpdate()")}else A(gt,Nt,Mt)}Ee.push(mt),nt.push(tt),it.push(gt)}});var dt=nt.length;return te.mutate({trans:Le,type:"put",keys:nt,values:it,updates:{keys:ae,changeSpecs:pe}}).then(function(Xe){var mt=Xe.numFailures,tt=Xe.failures;if(mt===0)return dt;for(var ut=0,gt=Object.keys(tt);ut<gt.length;ut++){var at,Ct=gt[ut],Nt=Ee[Number(Ct)];Nt!=null&&(at=tt[Ct],delete tt[Ct],tt[Nt]=at)}throw new je("".concat(z.name,".bulkUpdate(): ").concat(mt," of ").concat(dt," operations failed"),tt)})})})},Ns.prototype.bulkDelete=function(M){var z=this,te=M.length;return this._trans("readwrite",function(ae){return z.core.mutate({trans:ae,type:"delete",keys:M})}).then(function(Le){var pe=Le.numFailures,Ee=Le.lastResult,Le=Le.failures;if(pe===0)return Ee;throw new je("".concat(z.name,".bulkDelete(): ").concat(pe," of ").concat(te," operations failed"),Le)})},Ns);function Ns(){}function Vc(M){function z(Le,He){if(He){for(var nt=arguments.length,it=new Array(nt-1);--nt;)it[nt-1]=arguments[nt];return te[Le].subscribe.apply(null,it),M}if(typeof Le=="string")return te[Le]}var te={};z.addEventType=Ee;for(var ae=1,pe=arguments.length;ae<pe;++ae)Ee(arguments[ae]);return z;function Ee(Le,He,nt){if(typeof Le!="object"){var it;He=He||re;var dt={subscribers:[],fire:nt=nt||We,subscribe:function(Xe){dt.subscribers.indexOf(Xe)===-1&&(dt.subscribers.push(Xe),dt.fire=He(dt.fire,Xe))},unsubscribe:function(Xe){dt.subscribers=dt.subscribers.filter(function(mt){return mt!==Xe}),dt.fire=dt.subscribers.reduce(He,nt)}};return te[Le]=z[Le]=dt}a(it=Le).forEach(function(Xe){var mt=it[Xe];if(o(mt))Ee(Xe,it[Xe][0],it[Xe][1]);else{if(mt!=="asap")throw new Ce.InvalidArgument("Invalid event config");var tt=Ee(Xe,Ne,function(){for(var ut=arguments.length,gt=new Array(ut);ut--;)gt[ut]=arguments[ut];tt.subscribers.forEach(function(at){C(function(){at.apply(null,gt)})})})}})}}function hf(M,z){return b(z).from({prototype:M}),z}function nc(M,z){return!(M.filter||M.algorithm||M.or)&&(z?M.justLimit:!M.replayFilter)}function Eb(M,z){M.filter=qo(M.filter,z)}function Ca(M,z,te){var ae=M.replayFilter;M.replayFilter=ae?function(){return qo(ae(),z())}:z,M.justLimit=te&&!ae}function pf(M,z){if(M.isPrimKey)return z.primaryKey;var te=z.getIndexByKeyPath(M.index);if(!te)throw new Ce.Schema("KeyPath "+M.index+" on object store "+z.name+" is not indexed");return te}function Tb(M,z,te){var ae=pf(M,z.schema);return z.openCursor({trans:te,values:!M.keysOnly,reverse:M.dir==="prev",unique:!!M.unique,query:{index:ae,range:M.range}})}function mf(M,z,te,ae){var pe=M.replayFilter?qo(M.filter,M.replayFilter()):M.filter;if(M.or){var Ee={},Le=function(He,nt,it){var dt,Xe;pe&&!pe(nt,it,function(mt){return nt.stop(mt)},function(mt){return nt.fail(mt)})||((Xe=""+(dt=nt.primaryKey))=="[object ArrayBuffer]"&&(Xe=""+new Uint8Array(dt)),d(Ee,Xe)||(Ee[Xe]=!0,z(He,nt,it)))};return Promise.all([M.or._iterate(Le,te),Wu(Tb(M,ae,te),M.algorithm,Le,!M.keysOnly&&M.valueMapper)])}return Wu(Tb(M,ae,te),qo(M.algorithm,pe),z,!M.keysOnly&&M.valueMapper)}function Wu(M,z,te,ae){var pe=Oe(ae?function(Ee,Le,He){return te(ae(Ee),Le,He)}:te);return M.then(function(Ee){if(Ee)return Ee.start(function(){var Le=function(){return Ee.continue()};z&&!z(Ee,function(He){return Le=He},function(He){Ee.stop(He),Le=We},function(He){Ee.fail(He),Le=We})||pe(Ee.value,Ee,function(He){return Le=He}),Le()})})}var gf=(Ab.prototype.execute=function(M){var z=this["@@propmod"];if(z.add!==void 0){var te=z.add;if(o(te))return s(s([],o(M)?M:[],!0),te).sort();if(typeof te=="number")return(Number(M)||0)+te;if(typeof te=="bigint")try{return BigInt(M)+te}catch{return BigInt(0)+te}throw new TypeError("Invalid term ".concat(te))}if(z.remove!==void 0){var ae=z.remove;if(o(ae))return o(M)?M.filter(function(pe){return!ae.includes(pe)}).sort():[];if(typeof ae=="number")return Number(M)-ae;if(typeof ae=="bigint")try{return BigInt(M)-ae}catch{return BigInt(0)-ae}throw new TypeError("Invalid subtrahend ".concat(ae))}return te=(te=z.replacePrefix)===null||te===void 0?void 0:te[0],te&&typeof M=="string"&&M.startsWith(te)?z.replacePrefix[1]+M.substring(te.length):M},Ab);function Ab(M){this["@@propmod"]=M}var yf=(Hr.prototype._read=function(M,z){var te=this._ctx;return te.error?te.table._trans(null,rr.bind(null,te.error)):te.table._trans("readonly",M).then(z)},Hr.prototype._write=function(M){var z=this._ctx;return z.error?z.table._trans(null,rr.bind(null,z.error)):z.table._trans("readwrite",M,"locked")},Hr.prototype._addAlgorithm=function(M){var z=this._ctx;z.algorithm=qo(z.algorithm,M)},Hr.prototype._iterate=function(M,z){return mf(this._ctx,M,z,this._ctx.table.core)},Hr.prototype.clone=function(M){var z=Object.create(this.constructor.prototype),te=Object.create(this._ctx);return M&&l(te,M),z._ctx=te,z},Hr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Hr.prototype.each=function(M){var z=this._ctx;return this._read(function(te){return mf(z,M,te,z.table.core)})},Hr.prototype.count=function(M){var z=this;return this._read(function(te){var ae=z._ctx,pe=ae.table.core;if(nc(ae,!0))return pe.count({trans:te,query:{index:pf(ae,pe.schema),range:ae.range}}).then(function(Le){return Math.min(Le,ae.limit)});var Ee=0;return mf(ae,function(){return++Ee,!1},te,pe).then(function(){return Ee})}).then(M)},Hr.prototype.sortBy=function(M,z){var te=M.split(".").reverse(),ae=te[0],pe=te.length-1;function Ee(nt,it){return it?Ee(nt[te[it]],it-1):nt[ae]}var Le=this._ctx.dir==="next"?1:-1;function He(nt,it){return Dr(Ee(nt,pe),Ee(it,pe))*Le}return this.toArray(function(nt){return nt.sort(He)}).then(z)},Hr.prototype.toArray=function(M){var z=this;return this._read(function(te){var ae=z._ctx;if(ae.dir==="next"&&nc(ae,!0)&&0<ae.limit){var pe=ae.valueMapper,Ee=pf(ae,ae.table.core.schema);return ae.table.core.query({trans:te,limit:ae.limit,values:!0,query:{index:Ee,range:ae.range}}).then(function(He){return He=He.result,pe?He.map(pe):He})}var Le=[];return mf(ae,function(He){return Le.push(He)},te,ae.table.core).then(function(){return Le})},M)},Hr.prototype.offset=function(M){var z=this._ctx;return M<=0||(z.offset+=M,nc(z)?Ca(z,function(){var te=M;return function(ae,pe){return te===0||(te===1?--te:pe(function(){ae.advance(te),te=0}),!1)}}):Ca(z,function(){var te=M;return function(){return--te<0}})),this},Hr.prototype.limit=function(M){return this._ctx.limit=Math.min(this._ctx.limit,M),Ca(this._ctx,function(){var z=M;return function(te,ae,pe){return--z<=0&&ae(pe),0<=z}},!0),this},Hr.prototype.until=function(M,z){return Eb(this._ctx,function(te,ae,pe){return!M(te.value)||(ae(pe),z)}),this},Hr.prototype.first=function(M){return this.limit(1).toArray(function(z){return z[0]}).then(M)},Hr.prototype.last=function(M){return this.reverse().first(M)},Hr.prototype.filter=function(M){var z;return Eb(this._ctx,function(te){return M(te.value)}),(z=this._ctx).isMatch=qo(z.isMatch,M),this},Hr.prototype.and=function(M){return this.filter(M)},Hr.prototype.or=function(M){return new this.db.WhereClause(this._ctx.table,M,this)},Hr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Hr.prototype.desc=function(){return this.reverse()},Hr.prototype.eachKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.key,ae)})},Hr.prototype.eachUniqueKey=function(M){return this._ctx.unique="unique",this.eachKey(M)},Hr.prototype.eachPrimaryKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(te,ae){M(ae.primaryKey,ae)})},Hr.prototype.keys=function(M){var z=this._ctx;z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,pe){te.push(pe.key)}).then(function(){return te}).then(M)},Hr.prototype.primaryKeys=function(M){var z=this._ctx;if(z.dir==="next"&&nc(z,!0)&&0<z.limit)return this._read(function(ae){var pe=pf(z,z.table.core.schema);return z.table.core.query({trans:ae,values:!1,limit:z.limit,query:{index:pe,range:z.range}})}).then(function(ae){return ae.result}).then(M);z.keysOnly=!z.isMatch;var te=[];return this.each(function(ae,pe){te.push(pe.primaryKey)}).then(function(){return te}).then(M)},Hr.prototype.uniqueKeys=function(M){return this._ctx.unique="unique",this.keys(M)},Hr.prototype.firstKey=function(M){return this.limit(1).keys(function(z){return z[0]}).then(M)},Hr.prototype.lastKey=function(M){return this.reverse().firstKey(M)},Hr.prototype.distinct=function(){var M=this._ctx,M=M.index&&M.table.schema.idxByName[M.index];if(!M||!M.multi)return this;var z={};return Eb(this._ctx,function(pe){var ae=pe.primaryKey.toString(),pe=d(z,ae);return z[ae]=!0,!pe}),this},Hr.prototype.modify=function(M){var z=this,te=this._ctx;return this._write(function(ae){var pe,Ee,Le;Le=typeof M=="function"?M:(pe=a(M),Ee=pe.length,function(at){for(var Ct=!1,Nt=0;Nt<Ee;++Nt){var Mt=pe[Nt],Ot=M[Mt],Yt=R(at,Mt);Ot instanceof gf?(A(at,Mt,Ot.execute(Yt)),Ct=!0):Yt!==Ot&&(A(at,Mt,Ot),Ct=!0)}return Ct});var He=te.table.core,Xe=He.schema.primaryKey,nt=Xe.outbound,it=Xe.extractKey,dt=200,Xe=z.db._options.modifyChunkSize;Xe&&(dt=typeof Xe=="object"?Xe[He.name]||Xe["*"]||200:Xe);function mt(at,Mt){var Nt=Mt.failures,Mt=Mt.numFailures;ut+=at-Mt;for(var Ot=0,Yt=a(Nt);Ot<Yt.length;Ot++){var rn=Yt[Ot];tt.push(Nt[rn])}}var tt=[],ut=0,gt=[];return z.clone().primaryKeys().then(function(at){function Ct(Mt){var Ot=Math.min(dt,at.length-Mt);return He.getMany({trans:ae,keys:at.slice(Mt,Mt+Ot),cache:"immutable"}).then(function(Yt){for(var rn=[],Ht=[],Jt=nt?[]:null,an=[],Gt=0;Gt<Ot;++Gt){var mn=Yt[Gt],Bn={value:W(mn),primKey:at[Mt+Gt]};Le.call(Bn,Bn.value,Bn)!==!1&&(Bn.value==null?an.push(at[Mt+Gt]):nt||Dr(it(mn),it(Bn.value))===0?(Ht.push(Bn.value),nt&&Jt.push(at[Mt+Gt])):(an.push(at[Mt+Gt]),rn.push(Bn.value)))}return Promise.resolve(0<rn.length&&He.mutate({trans:ae,type:"add",values:rn}).then(function(qn){for(var hr in qn.failures)an.splice(parseInt(hr),1);mt(rn.length,qn)})).then(function(){return(0<Ht.length||Nt&&typeof M=="object")&&He.mutate({trans:ae,type:"put",keys:Jt,values:Ht,criteria:Nt,changeSpec:typeof M!="function"&&M,isAdditionalChunk:0<Mt}).then(function(qn){return mt(Ht.length,qn)})}).then(function(){return(0<an.length||Nt&&M===ag)&&He.mutate({trans:ae,type:"delete",keys:an,criteria:Nt,isAdditionalChunk:0<Mt}).then(function(qn){return mt(an.length,qn)})}).then(function(){return at.length>Mt+Ot&&Ct(Mt+dt)})})}var Nt=nc(te)&&te.limit===1/0&&(typeof M!="function"||M===ag)&&{index:te.index,range:te.range};return Ct(0).then(function(){if(0<tt.length)throw new ce("Error modifying one or more objects",tt,ut,gt);return at.length})})})},Hr.prototype.delete=function(){var M=this._ctx,z=M.range;return nc(M)&&(M.isPrimKey||z.type===3)?this._write(function(te){var ae=M.table.core.schema.primaryKey,pe=z;return M.table.core.count({trans:te,query:{index:ae,range:pe}}).then(function(Ee){return M.table.core.mutate({trans:te,type:"deleteRange",range:pe}).then(function(Le){var He=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new ce("Could not delete some values",Object.keys(He).map(function(nt){return He[nt]}),Ee-Le);return Ee-Le})})}):this.modify(ag)},Hr);function Hr(){}var ag=function(M,z){return z.value=null};function b_(M,z){return M<z?-1:M===z?0:1}function Rb(M,z){return z<M?-1:M===z?0:1}function Wa(M,z,te){return M=M instanceof Gu?new M.Collection(M):M,M._ctx.error=new(te||TypeError)(z),M}function bf(M){return new M.Collection(M,function(){return og("")}).limit(0)}function Hu(M,z,te,ae){var pe,Ee,Le,He,nt,it,dt,Xe=te.length;if(!te.every(function(ut){return typeof ut=="string"}))return Wa(M,Pi);function mt(ut){pe=ut==="next"?function(at){return at.toUpperCase()}:function(at){return at.toLowerCase()},Ee=ut==="next"?function(at){return at.toLowerCase()}:function(at){return at.toUpperCase()},Le=ut==="next"?b_:Rb;var gt=te.map(function(at){return{lower:Ee(at),upper:pe(at)}}).sort(function(at,Ct){return Le(at.lower,Ct.lower)});He=gt.map(function(at){return at.upper}),nt=gt.map(function(at){return at.lower}),dt=(it=ut)==="next"?"":ae}mt("next"),M=new M.Collection(M,function(){return vl(He[0],nt[Xe-1]+ae)}),M._ondirectionchange=function(ut){mt(ut)};var tt=0;return M._addAlgorithm(function(ut,gt,at){var Ct=ut.key;if(typeof Ct!="string")return!1;var Nt=Ee(Ct);if(z(Nt,nt,tt))return!0;for(var Mt=null,Ot=tt;Ot<Xe;++Ot){var Yt=function(rn,Ht,Jt,an,Gt,mn){for(var Bn=Math.min(rn.length,an.length),qn=-1,hr=0;hr<Bn;++hr){var fa=Ht[hr];if(fa!==an[hr])return Gt(rn[hr],Jt[hr])<0?rn.substr(0,hr)+Jt[hr]+Jt.substr(hr+1):Gt(rn[hr],an[hr])<0?rn.substr(0,hr)+an[hr]+Jt.substr(hr+1):0<=qn?rn.substr(0,qn)+Ht[qn]+Jt.substr(qn+1):null;Gt(rn[hr],fa)<0&&(qn=hr)}return Bn<an.length&&mn==="next"?rn+Jt.substr(rn.length):Bn<rn.length&&mn==="prev"?rn.substr(0,Jt.length):qn<0?null:rn.substr(0,qn)+an[qn]+Jt.substr(qn+1)}(Ct,Nt,He[Ot],nt[Ot],Le,it);Yt===null&&Mt===null?tt=Ot+1:(Mt===null||0<Le(Mt,Yt))&&(Mt=Yt)}return gt(Mt!==null?function(){ut.continue(Mt+dt)}:at),!1}),M}function vl(M,z,te,ae){return{type:2,lower:M,upper:z,lowerOpen:te,upperOpen:ae}}function og(M){return{type:1,lower:M,upper:M}}var Gu=(Object.defineProperty(Ls.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ls.prototype.between=function(M,z,te,ae){te=te!==!1,ae=ae===!0;try{return 0<this._cmp(M,z)||this._cmp(M,z)===0&&(te||ae)&&(!te||!ae)?bf(this):new this.Collection(this,function(){return vl(M,z,!te,!ae)})}catch{return Wa(this,es)}},Ls.prototype.equals=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return og(M)})},Ls.prototype.above=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return vl(M,void 0,!0)})},Ls.prototype.aboveOrEqual=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return vl(M,void 0,!1)})},Ls.prototype.below=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return vl(void 0,M,!1,!0)})},Ls.prototype.belowOrEqual=function(M){return M==null?Wa(this,es):new this.Collection(this,function(){return vl(void 0,M)})},Ls.prototype.startsWith=function(M){return typeof M!="string"?Wa(this,Pi):this.between(M,M+Rs,!0,!0)},Ls.prototype.startsWithIgnoreCase=function(M){return M===""?this.startsWith(M):Hu(this,function(z,te){return z.indexOf(te[0])===0},[M],Rs)},Ls.prototype.equalsIgnoreCase=function(M){return Hu(this,function(z,te){return z===te[0]},[M],"")},Ls.prototype.anyOfIgnoreCase=function(){var M=V.apply(ne,arguments);return M.length===0?bf(this):Hu(this,function(z,te){return te.indexOf(z)!==-1},M,"")},Ls.prototype.startsWithAnyOfIgnoreCase=function(){var M=V.apply(ne,arguments);return M.length===0?bf(this):Hu(this,function(z,te){return te.some(function(ae){return z.indexOf(ae)===0})},M,Rs)},Ls.prototype.anyOf=function(){var M=this,z=V.apply(ne,arguments),te=this._cmp;try{z.sort(te)}catch{return Wa(this,es)}if(z.length===0)return bf(this);var ae=new this.Collection(this,function(){return vl(z[0],z[z.length-1])});ae._ondirectionchange=function(Ee){te=Ee==="next"?M._ascending:M._descending,z.sort(te)};var pe=0;return ae._addAlgorithm(function(Ee,Le,He){for(var nt=Ee.key;0<te(nt,z[pe]);)if(++pe===z.length)return Le(He),!1;return te(nt,z[pe])===0||(Le(function(){Ee.continue(z[pe])}),!1)}),ae},Ls.prototype.notEqual=function(M){return this.inAnyRange([[-1/0,M],[M,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ls.prototype.noneOf=function(){var M=V.apply(ne,arguments);if(M.length===0)return new this.Collection(this);try{M.sort(this._ascending)}catch{return Wa(this,es)}var z=M.reduce(function(te,ae){return te?te.concat([[te[te.length-1][1],ae]]):[[-1/0,ae]]},null);return z.push([M[M.length-1],this.db._maxKey]),this.inAnyRange(z,{includeLowers:!1,includeUppers:!1})},Ls.prototype.inAnyRange=function(Ct,z){var te=this,ae=this._cmp,pe=this._ascending,Ee=this._descending,Le=this._min,He=this._max;if(Ct.length===0)return bf(this);if(!Ct.every(function(Nt){return Nt[0]!==void 0&&Nt[1]!==void 0&&pe(Nt[0],Nt[1])<=0}))return Wa(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ce.InvalidArgument);var nt=!z||z.includeLowers!==!1,it=z&&z.includeUppers===!0,dt,Xe=pe;function mt(Nt,Mt){return Xe(Nt[0],Mt[0])}try{(dt=Ct.reduce(function(Nt,Mt){for(var Ot=0,Yt=Nt.length;Ot<Yt;++Ot){var rn=Nt[Ot];if(ae(Mt[0],rn[1])<0&&0<ae(Mt[1],rn[0])){rn[0]=Le(rn[0],Mt[0]),rn[1]=He(rn[1],Mt[1]);break}}return Ot===Yt&&Nt.push(Mt),Nt},[])).sort(mt)}catch{return Wa(this,es)}var tt=0,ut=it?function(Nt){return 0<pe(Nt,dt[tt][1])}:function(Nt){return 0<=pe(Nt,dt[tt][1])},gt=nt?function(Nt){return 0<Ee(Nt,dt[tt][0])}:function(Nt){return 0<=Ee(Nt,dt[tt][0])},at=ut,Ct=new this.Collection(this,function(){return vl(dt[0][0],dt[dt.length-1][1],!nt,!it)});return Ct._ondirectionchange=function(Nt){Xe=Nt==="next"?(at=ut,pe):(at=gt,Ee),dt.sort(mt)},Ct._addAlgorithm(function(Nt,Mt,Ot){for(var Yt,rn=Nt.key;at(rn);)if(++tt===dt.length)return Mt(Ot),!1;return!ut(Yt=rn)&&!gt(Yt)||(te._cmp(rn,dt[tt][1])===0||te._cmp(rn,dt[tt][0])===0||Mt(function(){Xe===pe?Nt.continue(dt[tt][0]):Nt.continue(dt[tt][1])}),!1)}),Ct},Ls.prototype.startsWithAnyOf=function(){var M=V.apply(ne,arguments);return M.every(function(z){return typeof z=="string"})?M.length===0?bf(this):this.inAnyRange(M.map(function(z){return[z,z+Rs]})):Wa(this,"startsWithAnyOf() only works with strings")},Ls);function Ls(){}function Vo(M){return Oe(function(z){return Ku(z),M(z.target.error),!1})}function Ku(M){M.stopPropagation&&M.stopPropagation(),M.preventDefault&&M.preventDefault()}var vf="storagemutated",Yu="x-storagemutated-1",Ki=Vc(null,vf),Nb=(ka.prototype._lock=function(){return k(!Ie.global),++this._reculock,this._reculock!==1||Ie.global||(Ie.lockOwnerFor=this),this},ka.prototype._unlock=function(){if(k(!Ie.global),--this._reculock==0)for(Ie.global||(Ie.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var M=this._blockedFuncs.shift();try{et(M[1],M[0])}catch{}}return this},ka.prototype._locked=function(){return this._reculock&&Ie.lockOwnerFor!==this},ka.prototype.create=function(M){var z=this;if(!this.mode)return this;var te=this.db.idbdb,ae=this.db._state.dbOpenError;if(k(!this.idbtrans),!M&&!te)switch(ae&&ae.name){case"DatabaseClosedError":throw new Ce.DatabaseClosed(ae);case"MissingAPIError":throw new Ce.MissingAPI(ae.message,ae);default:throw new Ce.OpenFailed(ae)}if(!this.active)throw new Ce.TransactionInactive;return k(this._completion._state===null),(M=this.idbtrans=M||(this.db.core||te).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Oe(function(pe){Ku(pe),z._reject(M.error)}),M.onabort=Oe(function(pe){Ku(pe),z.active&&z._reject(new Ce.Abort(M.error)),z.active=!1,z.on("abort").fire(pe)}),M.oncomplete=Oe(function(){z.active=!1,z._resolve(),"mutatedParts"in M&&Ki.storagemutated.fire(M.mutatedParts)}),this},ka.prototype._promise=function(M,z,te){var ae=this;if(M==="readwrite"&&this.mode!=="readwrite")return rr(new Ce.ReadOnly("Transaction is readonly"));if(!this.active)return rr(new Ce.TransactionInactive);if(this._locked())return new $(function(Ee,Le){ae._blockedFuncs.push([function(){ae._promise(M,z,te).then(Ee,Le)},Ie])});if(te)return un(function(){var Ee=new $(function(Le,He){ae._lock();var nt=z(Le,He,ae);nt&&nt.then&&nt.then(Le,He)});return Ee.finally(function(){return ae._unlock()}),Ee._lib=!0,Ee});var pe=new $(function(Ee,Le){var He=z(Ee,Le,ae);He&&He.then&&He.then(Ee,Le)});return pe._lib=!0,pe},ka.prototype._root=function(){return this.parent?this.parent._root():this},ka.prototype.waitFor=function(M){var z,te=this._root(),ae=$.resolve(M);te._waitingFor?te._waitingFor=te._waitingFor.then(function(){return ae}):(te._waitingFor=ae,te._waitingQueue=[],z=te.idbtrans.objectStore(te.storeNames[0]),function Ee(){for(++te._spinCount;te._waitingQueue.length;)te._waitingQueue.shift()();te._waitingFor&&(z.get(-1/0).onsuccess=Ee)}());var pe=te._waitingFor;return new $(function(Ee,Le){ae.then(function(He){return te._waitingQueue.push(Oe(Ee.bind(null,He)))},function(He){return te._waitingQueue.push(Oe(Le.bind(null,He)))}).finally(function(){te._waitingFor===pe&&(te._waitingFor=null)})})},ka.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ce.Abort))},ka.prototype.table=function(M){var z=this._memoizedTables||(this._memoizedTables={});if(d(z,M))return z[M];var te=this.schema[M];if(!te)throw new Ce.NotFound("Table "+M+" not part of transaction");return te=new this.db.Table(M,te,this),te.core=this.db.core.table(M),z[M]=te},ka);function ka(){}function xl(M,z,te,ae,pe,Ee,Le){return{name:M,keyPath:z,unique:te,multi:ae,auto:pe,compound:Ee,src:(te&&!Le?"&":"")+(ae?"*":"")+(pe?"++":"")+lg(z)}}function lg(M){return typeof M=="string"?M:M?"["+[].join.call(M,"+")+"]":""}function xf(M,z,te){return{name:M,primKey:z,indexes:te,mappedClass:null,idxByName:(ae=function(pe){return[pe.name,pe]},te.reduce(function(pe,Ee,Le){return Le=ae(Ee,Le),Le&&(pe[Le[0]]=Le[1]),pe},{}))};var ae}var wf=function(M){try{return M.only([[]]),wf=function(){return[[]]},[[]]}catch{return wf=function(){return Rs},Rs}};function _f(M){return M==null?function(){}:typeof M=="string"?(z=M).split(".").length===1?function(te){return te[z]}:function(te){return R(te,z)}:function(te){return R(te,M)};var z}function hp(M){return[].slice.call(M)}var v_=0;function _i(M){return M==null?":id":typeof M=="string"?M:"[".concat(M.join("+"),"]")}function Zu(M,z,nt){function ae(at){if(at.type===3)return null;if(at.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var tt=at.lower,ut=at.upper,gt=at.lowerOpen,at=at.upperOpen;return tt===void 0?ut===void 0?null:z.upperBound(ut,!!at):ut===void 0?z.lowerBound(tt,!!gt):z.bound(tt,ut,!!gt,!!at)}function pe(mt){var tt,ut=mt.name;return{name:ut,schema:mt,mutate:function(gt){var at=gt.trans,Ct=gt.type,Nt=gt.keys,Mt=gt.values,Ot=gt.range;return new Promise(function(Yt,rn){Yt=Oe(Yt);var Ht=at.objectStore(ut),Jt=Ht.keyPath==null,an=Ct==="put"||Ct==="add";if(!an&&Ct!=="delete"&&Ct!=="deleteRange")throw new Error("Invalid operation type: "+Ct);var Gt,mn=(Nt||Mt||{length:1}).length;if(Nt&&Mt&&Nt.length!==Mt.length)throw new Error("Given keys array must have same length as given values array.");if(mn===0)return Yt({numFailures:0,failures:{},results:[],lastResult:void 0});function Bn(Zi){++fa,Ku(Zi)}var qn=[],hr=[],fa=0;if(Ct==="deleteRange"){if(Ot.type===4)return Yt({numFailures:fa,failures:hr,results:[],lastResult:void 0});Ot.type===3?qn.push(Gt=Ht.clear()):qn.push(Gt=Ht.delete(ae(Ot)))}else{var Jt=an?Jt?[Mt,Nt]:[Mt,null]:[Nt,null],sr=Jt[0],di=Jt[1];if(an)for(var Si=0;Si<mn;++Si)qn.push(Gt=di&&di[Si]!==void 0?Ht[Ct](sr[Si],di[Si]):Ht[Ct](sr[Si])),Gt.onerror=Bn;else for(Si=0;Si<mn;++Si)qn.push(Gt=Ht[Ct](sr[Si])),Gt.onerror=Bn}function rc(Zi){Zi=Zi.target.result,qn.forEach(function(_l,Kc){return _l.error!=null&&(hr[Kc]=_l.error)}),Yt({numFailures:fa,failures:hr,results:Ct==="delete"?Nt:qn.map(function(_l){return _l.result}),lastResult:Zi})}Gt.onerror=function(Zi){Bn(Zi),rc(Zi)},Gt.onsuccess=rc})},getMany:function(gt){var at=gt.trans,Ct=gt.keys;return new Promise(function(Nt,Mt){Nt=Oe(Nt);for(var Ot,Yt=at.objectStore(ut),rn=Ct.length,Ht=new Array(rn),Jt=0,an=0,Gt=function(qn){qn=qn.target,Ht[qn._pos]=qn.result,++an===Jt&&Nt(Ht)},mn=Vo(Mt),Bn=0;Bn<rn;++Bn)Ct[Bn]!=null&&((Ot=Yt.get(Ct[Bn]))._pos=Bn,Ot.onsuccess=Gt,Ot.onerror=mn,++Jt);Jt===0&&Nt(Ht)})},get:function(gt){var at=gt.trans,Ct=gt.key;return new Promise(function(Nt,Mt){Nt=Oe(Nt);var Ot=at.objectStore(ut).get(Ct);Ot.onsuccess=function(Yt){return Nt(Yt.target.result)},Ot.onerror=Vo(Mt)})},query:(tt=it,function(gt){return new Promise(function(at,Ct){at=Oe(at);var Nt,Mt,Ot,Jt=gt.trans,Yt=gt.values,rn=gt.limit,Gt=gt.query,Ht=rn===1/0?void 0:rn,an=Gt.index,Gt=Gt.range,Jt=Jt.objectStore(ut),an=an.isPrimaryKey?Jt:Jt.index(an.name),Gt=ae(Gt);if(rn===0)return at({result:[]});tt?((Ht=Yt?an.getAll(Gt,Ht):an.getAllKeys(Gt,Ht)).onsuccess=function(mn){return at({result:mn.target.result})},Ht.onerror=Vo(Ct)):(Nt=0,Mt=!Yt&&"openKeyCursor"in an?an.openKeyCursor(Gt):an.openCursor(Gt),Ot=[],Mt.onsuccess=function(mn){var Bn=Mt.result;return Bn?(Ot.push(Yt?Bn.value:Bn.primaryKey),++Nt===rn?at({result:Ot}):void Bn.continue()):at({result:Ot})},Mt.onerror=Vo(Ct))})}),openCursor:function(gt){var at=gt.trans,Ct=gt.values,Nt=gt.query,Mt=gt.reverse,Ot=gt.unique;return new Promise(function(Yt,rn){Yt=Oe(Yt);var an=Nt.index,Ht=Nt.range,Jt=at.objectStore(ut),Jt=an.isPrimaryKey?Jt:Jt.index(an.name),an=Mt?Ot?"prevunique":"prev":Ot?"nextunique":"next",Gt=!Ct&&"openKeyCursor"in Jt?Jt.openKeyCursor(ae(Ht),an):Jt.openCursor(ae(Ht),an);Gt.onerror=Vo(rn),Gt.onsuccess=Oe(function(mn){var Bn,qn,hr,fa,sr=Gt.result;sr?(sr.___id=++v_,sr.done=!1,Bn=sr.continue.bind(sr),qn=(qn=sr.continuePrimaryKey)&&qn.bind(sr),hr=sr.advance.bind(sr),fa=function(){throw new Error("Cursor not stopped")},sr.trans=at,sr.stop=sr.continue=sr.continuePrimaryKey=sr.advance=function(){throw new Error("Cursor not started")},sr.fail=Oe(rn),sr.next=function(){var di=this,Si=1;return this.start(function(){return Si--?di.continue():di.stop()}).then(function(){return di})},sr.start=function(di){function Si(){if(Gt.result)try{di()}catch(Zi){sr.fail(Zi)}else sr.done=!0,sr.start=function(){throw new Error("Cursor behind last entry")},sr.stop()}var rc=new Promise(function(Zi,_l){Zi=Oe(Zi),Gt.onerror=Vo(_l),sr.fail=_l,sr.stop=function(Kc){sr.stop=sr.continue=sr.continuePrimaryKey=sr.advance=fa,Zi(Kc)}});return Gt.onsuccess=Oe(function(Zi){Gt.onsuccess=Si,Si()}),sr.continue=Bn,sr.continuePrimaryKey=qn,sr.advance=hr,Si(),rc},Yt(sr)):Yt(null)},rn)})},count:function(gt){var at=gt.query,Ct=gt.trans,Nt=at.index,Mt=at.range;return new Promise(function(Ot,Yt){var rn=Ct.objectStore(ut),Ht=Nt.isPrimaryKey?rn:rn.index(Nt.name),rn=ae(Mt),Ht=rn?Ht.count(rn):Ht.count();Ht.onsuccess=Oe(function(Jt){return Ot(Jt.target.result)}),Ht.onerror=Vo(Yt)})}}}var Ee,Le,He,dt=(Le=nt,He=hp((Ee=M).objectStoreNames),{schema:{name:Ee.name,tables:He.map(function(mt){return Le.objectStore(mt)}).map(function(mt){var tt=mt.keyPath,at=mt.autoIncrement,ut=o(tt),gt={},at={name:mt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:tt==null,compound:ut,keyPath:tt,autoIncrement:at,unique:!0,extractKey:_f(tt)},indexes:hp(mt.indexNames).map(function(Ct){return mt.index(Ct)}).map(function(Ot){var Nt=Ot.name,Mt=Ot.unique,Yt=Ot.multiEntry,Ot=Ot.keyPath,Yt={name:Nt,compound:o(Ot),keyPath:Ot,unique:Mt,multiEntry:Yt,extractKey:_f(Ot)};return gt[_i(Ot)]=Yt}),getIndexByKeyPath:function(Ct){return gt[_i(Ct)]}};return gt[":id"]=at.primaryKey,tt!=null&&(gt[_i(tt)]=at.primaryKey),at})},hasGetAll:0<He.length&&"getAll"in Le.objectStore(He[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),nt=dt.schema,it=dt.hasGetAll,dt=nt.tables.map(pe),Xe={};return dt.forEach(function(mt){return Xe[mt.name]=mt}),{stack:"dbcore",transaction:M.transaction.bind(M),table:function(mt){if(!Xe[mt])throw new Error("Table '".concat(mt,"' not found"));return Xe[mt]},MIN_KEY:-1/0,MAX_KEY:wf(z),schema:nt}}function cg(M,z,te,ae){var pe=te.IDBKeyRange;return te.indexedDB,{dbcore:(ae=Zu(z,pe,ae),M.dbcore.reduce(function(Ee,Le){return Le=Le.create,r(r({},Ee),Le(Ee))},ae))}}function Wc(M,ae){var te=ae.db,ae=cg(M._middlewares,te,M._deps,ae);M.core=ae.dbcore,M.tables.forEach(function(pe){var Ee=pe.name;M.core.schema.tables.some(function(Le){return Le.name===Ee})&&(pe.core=M.core.table(Ee),M[Ee]instanceof M.Table&&(M[Ee].core=pe.core))})}function ug(M,z,te,ae){te.forEach(function(pe){var Ee=ae[pe];z.forEach(function(Le){var He=function nt(it,dt){return v(it,dt)||(it=c(it))&&nt(it,dt)}(Le,pe);(!He||"value"in He&&He.value===void 0)&&(Le===M.Transaction.prototype||Le instanceof M.Transaction?y(Le,pe,{get:function(){return this.table(pe)},set:function(nt){m(this,pe,{value:nt,writable:!0,configurable:!0,enumerable:!0})}}):Le[pe]=new M.Table(pe,Ee))})})}function pp(M,z){z.forEach(function(te){for(var ae in te)te[ae]instanceof M.Table&&delete te[ae]})}function Mb(M,z){return M._cfg.version-z._cfg.version}function mp(M,z,te,ae){var pe=M._dbSchema;te.objectStoreNames.contains("$meta")&&!pe.$meta&&(pe.$meta=xf("$meta",w_("")[0],[]),M._storeNames.push("$meta"));var Ee=M._createTransaction("readwrite",M._storeNames,pe);Ee.create(te),Ee._completion.catch(ae);var Le=Ee._reject.bind(Ee),He=Ie.transless||Ie;un(function(){return Ie.trans=Ee,Ie.transless=He,z!==0?(Wc(M,te),it=z,((nt=Ee).storeNames.includes("$meta")?nt.table("$meta").get("version").then(function(dt){return dt??it}):$.resolve(it)).then(function(dt){return mt=dt,tt=Ee,ut=te,gt=[],dt=(Xe=M)._versions,at=Xe._dbSchema=Sf(0,Xe.idbdb,ut),(dt=dt.filter(function(Ct){return Ct._cfg.version>=mt})).length!==0?(dt.forEach(function(Ct){gt.push(function(){var Nt=at,Mt=Ct._cfg.dbschema;pg(Xe,Nt,ut),pg(Xe,Mt,ut),at=Xe._dbSchema=Mt;var Ot=fg(Nt,Mt);Ot.add.forEach(function(an){Ib(ut,an[0],an[1].primKey,an[1].indexes)}),Ot.change.forEach(function(an){if(an.recreate)throw new Ce.Upgrade("Not yet support for changing primary key");var Gt=ut.objectStore(an.name);an.add.forEach(function(mn){return hg(Gt,mn)}),an.change.forEach(function(mn){Gt.deleteIndex(mn.name),hg(Gt,mn)}),an.del.forEach(function(mn){return Gt.deleteIndex(mn)})});var Yt=Ct._cfg.contentUpgrade;if(Yt&&Ct._cfg.version>mt){Wc(Xe,ut),tt._memoizedTables={};var rn=N(Mt);Ot.del.forEach(function(an){rn[an]=Nt[an]}),pp(Xe,[Xe.Transaction.prototype]),ug(Xe,[Xe.Transaction.prototype],a(rn),rn),tt.schema=rn;var Ht,Jt=Q(Yt);return Jt&&yr(),Ot=$.follow(function(){var an;(Ht=Yt(tt))&&Jt&&(an=Rr.bind(null,null),Ht.then(an,an))}),Ht&&typeof Ht.then=="function"?$.resolve(Ht):Ot.then(function(){return Ht})}}),gt.push(function(Nt){var Mt,Ot,Yt=Ct._cfg.dbschema;Mt=Yt,Ot=Nt,[].slice.call(Ot.db.objectStoreNames).forEach(function(rn){return Mt[rn]==null&&Ot.db.deleteObjectStore(rn)}),pp(Xe,[Xe.Transaction.prototype]),ug(Xe,[Xe.Transaction.prototype],Xe._storeNames,Xe._dbSchema),tt.schema=Xe._dbSchema}),gt.push(function(Nt){Xe.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Xe.idbdb.version/10)===Ct._cfg.version?(Xe.idbdb.deleteObjectStore("$meta"),delete Xe._dbSchema.$meta,Xe._storeNames=Xe._storeNames.filter(function(Mt){return Mt!=="$meta"})):Nt.objectStore("$meta").put(Ct._cfg.version,"version"))})}),function Ct(){return gt.length?$.resolve(gt.shift()(tt.idbtrans)).then(Ct):$.resolve()}().then(function(){x_(at,ut)})):$.resolve();var Xe,mt,tt,ut,gt,at}).catch(Le)):(a(pe).forEach(function(dt){Ib(te,dt,pe[dt].primKey,pe[dt].indexes)}),Wc(M,te),void $.follow(function(){return M.on.populate.fire(Ee)}).catch(Le));var nt,it})}function dg(M,z){x_(M._dbSchema,z),z.db.version%10!=0||z.objectStoreNames.contains("$meta")||z.db.createObjectStore("$meta").add(Math.ceil(z.db.version/10-1),"version");var te=Sf(0,M.idbdb,z);pg(M,M._dbSchema,z);for(var ae=0,pe=fg(te,M._dbSchema).change;ae<pe.length;ae++){var Ee=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var He=z.objectStore(Le.name);Le.add.forEach(function(nt){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(nt.src)),hg(He,nt)})}(pe[ae]);if(typeof Ee=="object")return Ee.value}}function fg(M,z){var te,ae={del:[],add:[],change:[]};for(te in M)z[te]||ae.del.push(te);for(te in z){var pe=M[te],Ee=z[te];if(pe){var Le={name:te,def:Ee,recreate:!1,del:[],add:[],change:[]};if(""+(pe.primKey.keyPath||"")!=""+(Ee.primKey.keyPath||"")||pe.primKey.auto!==Ee.primKey.auto)Le.recreate=!0,ae.change.push(Le);else{var He=pe.idxByName,nt=Ee.idxByName,it=void 0;for(it in He)nt[it]||Le.del.push(it);for(it in nt){var dt=He[it],Xe=nt[it];dt?dt.src!==Xe.src&&Le.change.push(Xe):Le.add.push(Xe)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&ae.change.push(Le)}}else ae.add.push([te,Ee])}return ae}function Ib(M,z,te,ae){var pe=M.db.createObjectStore(z,te.keyPath?{keyPath:te.keyPath,autoIncrement:te.auto}:{autoIncrement:te.auto});return ae.forEach(function(Ee){return hg(pe,Ee)}),pe}function x_(M,z){a(M).forEach(function(te){z.db.objectStoreNames.contains(te)||(Be&&console.debug("Dexie: Creating missing table",te),Ib(z,te,M[te].primKey,M[te].indexes))})}function hg(M,z){M.createIndex(z.name,z.keyPath,{unique:z.unique,multiEntry:z.multi})}function Sf(M,z,te){var ae={};return w(z.objectStoreNames,0).forEach(function(pe){for(var Ee=te.objectStore(pe),Le=xl(lg(it=Ee.keyPath),it||"",!0,!1,!!Ee.autoIncrement,it&&typeof it!="string",!0),He=[],nt=0;nt<Ee.indexNames.length;++nt){var dt=Ee.index(Ee.indexNames[nt]),it=dt.keyPath,dt=xl(dt.name,it,!!dt.unique,!!dt.multiEntry,!1,it&&typeof it!="string",!1);He.push(dt)}ae[pe]=xf(pe,Le,He)}),ae}function pg(M,z,te){for(var ae=te.db.objectStoreNames,pe=0;pe<ae.length;++pe){var Ee=ae[pe],Le=te.objectStore(Ee);M._hasGetAll="getAll"in Le;for(var He=0;He<Le.indexNames.length;++He){var nt=Le.indexNames[He],it=Le.index(nt).keyPath,dt=typeof it=="string"?it:"["+w(it).join("+")+"]";!z[Ee]||(it=z[Ee].idxByName[dt])&&(it.name=nt,delete z[Ee].idxByName[dt],z[Ee].idxByName[nt]=it)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(M._hasGetAll=!1)}function w_(M){return M.split(",").map(function(z,te){var ae=(z=z.trim()).replace(/([&*]|\+\+)/g,""),pe=/^\[/.test(ae)?ae.match(/^\[(.*)\]$/)[1].split("+"):ae;return xl(ae,pe||null,/\&/.test(z),/\*/.test(z),/\+\+/.test(z),o(pe),te===0)})}var _A=(mg.prototype._parseStoresSpec=function(M,z){a(M).forEach(function(te){if(M[te]!==null){var ae=w_(M[te]),pe=ae.shift();if(pe.unique=!0,pe.multi)throw new Ce.Schema("Primary key cannot be multi-valued");ae.forEach(function(Ee){if(Ee.auto)throw new Ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ee.keyPath)throw new Ce.Schema("Index must have a name and cannot be an empty string")}),z[te]=xf(te,pe,ae)}})},mg.prototype.stores=function(te){var z=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,te):te;var te=z._versions,ae={},pe={};return te.forEach(function(Ee){l(ae,Ee._cfg.storesSource),pe=Ee._cfg.dbschema={},Ee._parseStoresSpec(ae,pe)}),z._dbSchema=pe,pp(z,[z._allTables,z,z.Transaction.prototype]),ug(z,[z._allTables,z,z.Transaction.prototype,this._cfg.tables],a(pe),pe),z._storeNames=a(pe),this},mg.prototype.upgrade=function(M){return this._cfg.contentUpgrade=Te(this._cfg.contentUpgrade||We,M),this},mg);function mg(){}function jb(M,z){var te=M._dbNamesDB;return te||(te=M._dbNamesDB=new wl(qa,{addons:[],indexedDB:M,IDBKeyRange:z})).version(1).stores({dbnames:"name"}),te.table("dbnames")}function gg(M){return M&&typeof M.databases=="function"}function Pb(M){return un(function(){return Ie.letThrough=!0,M()})}function Ob(M){return!("from"in M)}var Yi=function(M,z){if(!this){var te=new Yi;return M&&"d"in M&&l(te,M),te}l(this,arguments.length?{d:1,from:M,to:1<arguments.length?z:M}:{d:0})};function gp(M,z,te){var ae=Dr(z,te);if(!isNaN(ae)){if(0<ae)throw RangeError();if(Ob(M))return l(M,{from:z,to:te,d:1});var pe=M.l,ae=M.r;if(Dr(te,M.from)<0)return pe?gp(pe,z,te):M.l={from:z,to:te,d:1,l:null,r:null},S_(M);if(0<Dr(z,M.to))return ae?gp(ae,z,te):M.r={from:z,to:te,d:1,l:null,r:null},S_(M);Dr(z,M.from)<0&&(M.from=z,M.l=null,M.d=ae?ae.d+1:1),0<Dr(te,M.to)&&(M.to=te,M.r=null,M.d=M.l?M.l.d+1:1),te=!M.r,pe&&!M.l&&Xu(M,pe),ae&&te&&Xu(M,ae)}}function Xu(M,z){Ob(z)||function te(ae,nt){var Ee=nt.from,Le=nt.to,He=nt.l,nt=nt.r;gp(ae,Ee,Le),He&&te(ae,He),nt&&te(ae,nt)}(M,z)}function __(M,z){var te=yg(z),ae=te.next();if(ae.done)return!1;for(var pe=ae.value,Ee=yg(M),Le=Ee.next(pe.from),He=Le.value;!ae.done&&!Le.done;){if(Dr(He.from,pe.to)<=0&&0<=Dr(He.to,pe.from))return!0;Dr(pe.from,He.from)<0?pe=(ae=te.next(He.from)).value:He=(Le=Ee.next(pe.from)).value}return!1}function yg(M){var z=Ob(M)?null:{s:0,n:M};return{next:function(te){for(var ae=0<arguments.length;z;)switch(z.s){case 0:if(z.s=1,ae)for(;z.n.l&&Dr(te,z.n.from)<0;)z={up:z,n:z.n.l,s:1};else for(;z.n.l;)z={up:z,n:z.n.l,s:1};case 1:if(z.s=2,!ae||Dr(te,z.n.to)<=0)return{value:z.n,done:!1};case 2:if(z.n.r){z.s=3,z={up:z,n:z.n.r,s:0};continue}case 3:z=z.up}return{done:!0}}}}function S_(M){var z,te,ae=(((z=M.r)===null||z===void 0?void 0:z.d)||0)-(((te=M.l)===null||te===void 0?void 0:te.d)||0),pe=1<ae?"r":ae<-1?"l":"";pe&&(z=pe=="r"?"l":"r",te=r({},M),ae=M[pe],M.from=ae.from,M.to=ae.to,M[pe]=ae[pe],te[pe]=ae[z],(M[z]=te).d=Db(te)),M.d=Db(M)}function Db(te){var z=te.r,te=te.l;return(z?te?Math.max(z.d,te.d):z.d:te?te.d:0)+1}function bg(M,z){return a(z).forEach(function(te){M[te]?Xu(M[te],z[te]):M[te]=function ae(pe){var Ee,Le,He={};for(Ee in pe)d(pe,Ee)&&(Le=pe[Ee],He[Ee]=!Le||typeof Le!="object"||B.has(Le.constructor)?Le:ae(Le));return He}(z[te])}),M}function Fb(M,z){return M.all||z.all||Object.keys(M).some(function(te){return z[te]&&__(z[te],M[te])})}h(Yi.prototype,((Ha={add:function(M){return Xu(this,M),this},addKey:function(M){return gp(this,M,M),this},addKeys:function(M){var z=this;return M.forEach(function(te){return gp(z,te,te)}),this},hasKey:function(M){var z=yg(this).next(M).value;return z&&Dr(z.from,M)<=0&&0<=Dr(z.to,M)}})[U]=function(){return yg(this)},Ha));var Ju={},Lb={},Bb=!1;function vg(M){bg(Lb,M),Bb||(Bb=!0,setTimeout(function(){Bb=!1,$b(Lb,!(Lb={}))},0))}function $b(M,z){z===void 0&&(z=!1);var te=new Set;if(M.all)for(var ae=0,pe=Object.values(Ju);ae<pe.length;ae++)C_(Le=pe[ae],M,te,z);else for(var Ee in M){var Le,He=/^idb\:\/\/(.*)\/(.*)\//.exec(Ee);He&&(Ee=He[1],He=He[2],(Le=Ju["idb://".concat(Ee,"/").concat(He)])&&C_(Le,M,te,z))}te.forEach(function(nt){return nt()})}function C_(M,z,te,ae){for(var pe=[],Ee=0,Le=Object.entries(M.queries.query);Ee<Le.length;Ee++){for(var He=Le[Ee],nt=He[0],it=[],dt=0,Xe=He[1];dt<Xe.length;dt++){var mt=Xe[dt];Fb(z,mt.obsSet)?mt.subscribers.forEach(function(at){return te.add(at)}):ae&&it.push(mt)}ae&&pe.push([nt,it])}if(ae)for(var tt=0,ut=pe;tt<ut.length;tt++){var gt=ut[tt],nt=gt[0],it=gt[1];M.queries.query[nt]=it}}function SA(M){var z=M._state,te=M._deps.indexedDB;if(z.isBeingOpened||M.idbdb)return z.dbReadyPromise.then(function(){return z.dbOpenError?rr(z.dbOpenError):M});z.isBeingOpened=!0,z.dbOpenError=null,z.openComplete=!1;var ae=z.openCanceller,pe=Math.round(10*M.verno),Ee=!1;function Le(){if(z.openCanceller!==ae)throw new Ce.DatabaseClosed("db.open() was cancelled")}function He(){return new $(function(mt,tt){if(Le(),!te)throw new Ce.MissingAPI;var ut=M.name,gt=z.autoSchema||!pe?te.open(ut):te.open(ut,pe);if(!gt)throw new Ce.MissingAPI;gt.onerror=Vo(tt),gt.onblocked=Oe(M._fireOnBlocked),gt.onupgradeneeded=Oe(function(at){var Ct;dt=gt.transaction,z.autoSchema&&!M._options.allowEmptyDB?(gt.onerror=Ku,dt.abort(),gt.result.close(),(Ct=te.deleteDatabase(ut)).onsuccess=Ct.onerror=Oe(function(){tt(new Ce.NoSuchDatabase("Database ".concat(ut," doesnt exist")))})):(dt.onerror=Vo(tt),at=at.oldVersion>Math.pow(2,62)?0:at.oldVersion,Xe=at<1,M.idbdb=gt.result,Ee&&dg(M,dt),mp(M,at/10,dt,tt))},tt),gt.onsuccess=Oe(function(){dt=null;var at,Ct,Nt,Mt,Ot,Yt=M.idbdb=gt.result,rn=w(Yt.objectStoreNames);if(0<rn.length)try{var Ht=Yt.transaction((Mt=rn).length===1?Mt[0]:Mt,"readonly");if(z.autoSchema)Ct=Yt,Nt=Ht,(at=M).verno=Ct.version/10,Nt=at._dbSchema=Sf(0,Ct,Nt),at._storeNames=w(Ct.objectStoreNames,0),ug(at,[at._allTables],a(Nt),Nt);else if(pg(M,M._dbSchema,Ht),((Ot=fg(Sf(0,(Ot=M).idbdb,Ht),Ot._dbSchema)).add.length||Ot.change.some(function(Jt){return Jt.add.length||Jt.change.length}))&&!Ee)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Yt.close(),pe=Yt.version+1,Ee=!0,mt(He());Wc(M,Ht)}catch{}ui.push(M),Yt.onversionchange=Oe(function(Jt){z.vcFired=!0,M.on("versionchange").fire(Jt)}),Yt.onclose=Oe(function(Jt){M.on("close").fire(Jt)}),Xe&&(Ot=M._deps,Ht=ut,Yt=Ot.indexedDB,Ot=Ot.IDBKeyRange,gg(Yt)||Ht===qa||jb(Yt,Ot).put({name:Ht}).catch(We)),mt()},tt)}).catch(function(mt){switch(mt==null?void 0:mt.name){case"UnknownError":if(0<z.PR1398_maxLoop)return z.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),He();break;case"VersionError":if(0<pe)return pe=0,He()}return $.reject(mt)})}var nt,it=z.dbReadyResolve,dt=null,Xe=!1;return $.race([ae,(typeof navigator>"u"?$.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(mt){function tt(){return indexedDB.databases().finally(mt)}nt=setInterval(tt,100),tt()}).finally(function(){return clearInterval(nt)}):Promise.resolve()).then(He)]).then(function(){return Le(),z.onReadyBeingFired=[],$.resolve(Pb(function(){return M.on.ready.fire(M.vip)})).then(function mt(){if(0<z.onReadyBeingFired.length){var tt=z.onReadyBeingFired.reduce(Te,We);return z.onReadyBeingFired=[],$.resolve(Pb(function(){return tt(M.vip)})).then(mt)}})}).finally(function(){z.openCanceller===ae&&(z.onReadyBeingFired=null,z.isBeingOpened=!1)}).catch(function(mt){z.dbOpenError=mt;try{dt&&dt.abort()}catch{}return ae===z.openCanceller&&M._close(),rr(mt)}).finally(function(){z.openComplete=!0,it()}).then(function(){var mt;return Xe&&(mt={},M.tables.forEach(function(tt){tt.schema.indexes.forEach(function(ut){ut.name&&(mt["idb://".concat(M.name,"/").concat(tt.name,"/").concat(ut.name)]=new Yi(-1/0,[[[]]]))}),mt["idb://".concat(M.name,"/").concat(tt.name,"/")]=mt["idb://".concat(M.name,"/").concat(tt.name,"/:dels")]=new Yi(-1/0,[[[]]])}),Ki(vf).fire(mt),$b(mt,!0)),M})}function yp(M){function z(Ee){return M.next(Ee)}var te=pe(z),ae=pe(function(Ee){return M.throw(Ee)});function pe(Ee){return function(nt){var He=Ee(nt),nt=He.value;return He.done?nt:nt&&typeof nt.then=="function"?nt.then(te,ae):o(nt)?Promise.all(nt).then(te,ae):te(nt)}}return pe(z)()}function Hc(M,z,te){for(var ae=o(M)?M.slice():[M],pe=0;pe<te;++pe)ae.push(z);return ae}var CA={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema,pe={},Ee=[];function Le(Xe,mt,tt){var ut=_i(Xe),gt=pe[ut]=pe[ut]||[],at=Xe==null?0:typeof Xe=="string"?1:Xe.length,Ct=0<mt,Ct=r(r({},tt),{name:Ct?"".concat(ut,"(virtual-from:").concat(tt.name,")"):tt.name,lowLevelIndex:tt,isVirtual:Ct,keyTail:mt,keyLength:at,extractKey:_f(Xe),unique:!Ct&&tt.unique});return gt.push(Ct),Ct.isPrimaryKey||Ee.push(Ct),1<at&&Le(at===2?Xe[0]:Xe.slice(0,at-1),mt+1,tt),gt.sort(function(Nt,Mt){return Nt.keyTail-Mt.keyTail}),Ct}z=Le(ae.primaryKey.keyPath,0,ae.primaryKey),pe[":id"]=[z];for(var He=0,nt=ae.indexes;He<nt.length;He++){var it=nt[He];Le(it.keyPath,0,it)}function dt(Xe){var mt,tt=Xe.query.index;return tt.isVirtual?r(r({},Xe),{query:{index:tt.lowLevelIndex,range:(mt=Xe.query.range,tt=tt.keyTail,{type:mt.type===1?2:mt.type,lower:Hc(mt.lower,mt.lowerOpen?M.MAX_KEY:M.MIN_KEY,tt),lowerOpen:!0,upper:Hc(mt.upper,mt.upperOpen?M.MIN_KEY:M.MAX_KEY,tt),upperOpen:!0})}}):Xe}return r(r({},te),{schema:r(r({},ae),{primaryKey:z,indexes:Ee,getIndexByKeyPath:function(Xe){return(Xe=pe[_i(Xe)])&&Xe[0]}}),count:function(Xe){return te.count(dt(Xe))},query:function(Xe){return te.query(dt(Xe))},openCursor:function(Xe){var mt=Xe.query.index,tt=mt.keyTail,ut=mt.isVirtual,gt=mt.keyLength;return ut?te.openCursor(dt(Xe)).then(function(Ct){return Ct&&at(Ct)}):te.openCursor(Xe);function at(Ct){return Object.create(Ct,{continue:{value:function(Nt){Nt!=null?Ct.continue(Hc(Nt,Xe.reverse?M.MAX_KEY:M.MIN_KEY,tt)):Xe.unique?Ct.continue(Ct.key.slice(0,gt).concat(Xe.reverse?M.MIN_KEY:M.MAX_KEY,tt)):Ct.continue()}},continuePrimaryKey:{value:function(Nt,Mt){Ct.continuePrimaryKey(Hc(Nt,M.MAX_KEY,tt),Mt)}},primaryKey:{get:function(){return Ct.primaryKey}},key:{get:function(){var Nt=Ct.key;return gt===1?Nt[0]:Nt.slice(0,gt)}},value:{get:function(){return Ct.value}}})}}})}})}};function xg(M,z,te,ae){return te=te||{},ae=ae||"",a(M).forEach(function(pe){var Ee,Le,He;d(z,pe)?(Ee=M[pe],Le=z[pe],typeof Ee=="object"&&typeof Le=="object"&&Ee&&Le?(He=Z(Ee))!==Z(Le)?te[ae+pe]=z[pe]:He==="Object"?xg(Ee,Le,te,ae+pe+"."):Ee!==Le&&(te[ae+pe]=z[pe]):Ee!==Le&&(te[ae+pe]=z[pe])):te[ae+pe]=void 0}),a(z).forEach(function(pe){d(M,pe)||(te[ae+pe]=z[pe])}),te}function wg(M,z){return z.type==="delete"?z.keys:z.keys||z.values.map(M.extractKey)}var k_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(M){return r(r({},M),{table:function(z){var te=M.table(z),ae=te.schema.primaryKey;return r(r({},te),{mutate:function(pe){var Ee=Ie.trans,Le=Ee.table(z).hook,He=Le.deleting,nt=Le.creating,it=Le.updating;switch(pe.type){case"add":if(nt.fire===We)break;return Ee._promise("readwrite",function(){return dt(pe)},!0);case"put":if(nt.fire===We&&it.fire===We)break;return Ee._promise("readwrite",function(){return dt(pe)},!0);case"delete":if(He.fire===We)break;return Ee._promise("readwrite",function(){return dt(pe)},!0);case"deleteRange":if(He.fire===We)break;return Ee._promise("readwrite",function(){return function Xe(mt,tt,ut){return te.query({trans:mt,values:!1,query:{index:ae,range:tt},limit:ut}).then(function(gt){var at=gt.result;return dt({type:"delete",keys:at,trans:mt}).then(function(Ct){return 0<Ct.numFailures?Promise.reject(Ct.failures[0]):at.length<ut?{failures:[],numFailures:0,lastResult:void 0}:Xe(mt,r(r({},tt),{lower:at[at.length-1],lowerOpen:!0}),ut)})})}(pe.trans,pe.range,1e4)},!0)}return te.mutate(pe);function dt(Xe){var mt,tt,ut,gt=Ie.trans,at=Xe.keys||wg(ae,Xe);if(!at)throw new Error("Keys missing");return(Xe=Xe.type==="add"||Xe.type==="put"?r(r({},Xe),{keys:at}):r({},Xe)).type!=="delete"&&(Xe.values=s([],Xe.values)),Xe.keys&&(Xe.keys=s([],Xe.keys)),mt=te,ut=at,((tt=Xe).type==="add"?Promise.resolve([]):mt.getMany({trans:tt.trans,keys:ut,cache:"immutable"})).then(function(Ct){var Nt=at.map(function(Mt,Ot){var Yt,rn,Ht,Jt=Ct[Ot],an={onerror:null,onsuccess:null};return Xe.type==="delete"?He.fire.call(an,Mt,Jt,gt):Xe.type==="add"||Jt===void 0?(Yt=nt.fire.call(an,Mt,Xe.values[Ot],gt),Mt==null&&Yt!=null&&(Xe.keys[Ot]=Mt=Yt,ae.outbound||A(Xe.values[Ot],ae.keyPath,Mt))):(Yt=xg(Jt,Xe.values[Ot]),(rn=it.fire.call(an,Yt,Mt,Jt,gt))&&(Ht=Xe.values[Ot],Object.keys(rn).forEach(function(Gt){d(Ht,Gt)?Ht[Gt]=rn[Gt]:A(Ht,Gt,rn[Gt])}))),an});return te.mutate(Xe).then(function(Mt){for(var Ot=Mt.failures,Yt=Mt.results,rn=Mt.numFailures,Mt=Mt.lastResult,Ht=0;Ht<at.length;++Ht){var Jt=(Yt||at)[Ht],an=Nt[Ht];Jt==null?an.onerror&&an.onerror(Ot[Ht]):an.onsuccess&&an.onsuccess(Xe.type==="put"&&Ct[Ht]?Xe.values[Ht]:Jt)}return{failures:Ot,results:Yt,numFailures:rn,lastResult:Mt}}).catch(function(Mt){return Nt.forEach(function(Ot){return Ot.onerror&&Ot.onerror(Mt)}),Promise.reject(Mt)})})}}})}})}};function zb(M,z,te){try{if(!z||z.keys.length<M.length)return null;for(var ae=[],pe=0,Ee=0;pe<z.keys.length&&Ee<M.length;++pe)Dr(z.keys[pe],M[Ee])===0&&(ae.push(te?W(z.values[pe]):z.values[pe]),++Ee);return ae.length===M.length?ae:null}catch{return null}}var E_={stack:"dbcore",level:-1,create:function(M){return{table:function(z){var te=M.table(z);return r(r({},te),{getMany:function(ae){if(!ae.cache)return te.getMany(ae);var pe=zb(ae.keys,ae.trans._cache,ae.cache==="clone");return pe?$.resolve(pe):te.getMany(ae).then(function(Ee){return ae.trans._cache={keys:ae.keys,values:ae.cache==="clone"?W(Ee):Ee},Ee})},mutate:function(ae){return ae.type!=="add"&&(ae.trans._cache=null),te.mutate(ae)}})}}}};function Qu(M,z){return M.trans.mode==="readonly"&&!!M.subscr&&!M.trans.explicit&&M.trans.db._options.cache!=="disabled"&&!z.schema.primaryKey.outbound}function T_(M,z){switch(M){case"query":return z.values&&!z.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var kA={stack:"dbcore",level:0,name:"Observability",create:function(M){var z=M.schema.name,te=new Yi(M.MIN_KEY,M.MAX_KEY);return r(r({},M),{transaction:function(ae,pe,Ee){if(Ie.subscr&&pe!=="readonly")throw new Ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ie.querier));return M.transaction(ae,pe,Ee)},table:function(ae){var pe=M.table(ae),Ee=pe.schema,Le=Ee.primaryKey,Xe=Ee.indexes,He=Le.extractKey,nt=Le.outbound,it=Le.autoIncrement&&Xe.filter(function(tt){return tt.compound&&tt.keyPath.includes(Le.keyPath)}),dt=r(r({},pe),{mutate:function(tt){function ut(Gt){return Gt="idb://".concat(z,"/").concat(ae,"/").concat(Gt),Mt[Gt]||(Mt[Gt]=new Yi)}var gt,at,Ct,Nt=tt.trans,Mt=tt.mutatedParts||(tt.mutatedParts={}),Ot=ut(""),Yt=ut(":dels"),rn=tt.type,an=tt.type==="deleteRange"?[tt.range]:tt.type==="delete"?[tt.keys]:tt.values.length<50?[wg(Le,tt).filter(function(Gt){return Gt}),tt.values]:[],Ht=an[0],Jt=an[1],an=tt.trans._cache;return o(Ht)?(Ot.addKeys(Ht),(an=rn==="delete"||Ht.length===Jt.length?zb(Ht,an):null)||Yt.addKeys(Ht),(an||Jt)&&(gt=ut,at=an,Ct=Jt,Ee.indexes.forEach(function(Gt){var mn=gt(Gt.name||"");function Bn(hr){return hr!=null?Gt.extractKey(hr):null}function qn(hr){return Gt.multiEntry&&o(hr)?hr.forEach(function(fa){return mn.addKey(fa)}):mn.addKey(hr)}(at||Ct).forEach(function(hr,di){var sr=at&&Bn(at[di]),di=Ct&&Bn(Ct[di]);Dr(sr,di)!==0&&(sr!=null&&qn(sr),di!=null&&qn(di))})}))):Ht?(Jt={from:(Jt=Ht.lower)!==null&&Jt!==void 0?Jt:M.MIN_KEY,to:(Jt=Ht.upper)!==null&&Jt!==void 0?Jt:M.MAX_KEY},Yt.add(Jt),Ot.add(Jt)):(Ot.add(te),Yt.add(te),Ee.indexes.forEach(function(Gt){return ut(Gt.name).add(te)})),pe.mutate(tt).then(function(Gt){return!Ht||tt.type!=="add"&&tt.type!=="put"||(Ot.addKeys(Gt.results),it&&it.forEach(function(mn){for(var Bn=tt.values.map(function(sr){return mn.extractKey(sr)}),qn=mn.keyPath.findIndex(function(sr){return sr===Le.keyPath}),hr=0,fa=Gt.results.length;hr<fa;++hr)Bn[hr][qn]=Gt.results[hr];ut(mn.name).addKeys(Bn)})),Nt.mutatedParts=bg(Nt.mutatedParts||{},Mt),Gt})}}),Xe=function(ut){var gt=ut.query,ut=gt.index,gt=gt.range;return[ut,new Yi((ut=gt.lower)!==null&&ut!==void 0?ut:M.MIN_KEY,(gt=gt.upper)!==null&&gt!==void 0?gt:M.MAX_KEY)]},mt={get:function(tt){return[Le,new Yi(tt.key)]},getMany:function(tt){return[Le,new Yi().addKeys(tt.keys)]},count:Xe,query:Xe,openCursor:Xe};return a(mt).forEach(function(tt){dt[tt]=function(ut){var gt=Ie.subscr,at=!!gt,Ct=Qu(Ie,pe)&&T_(tt,ut)?ut.obsSet={}:gt;if(at){var Nt=function(Jt){return Jt="idb://".concat(z,"/").concat(ae,"/").concat(Jt),Ct[Jt]||(Ct[Jt]=new Yi)},Mt=Nt(""),Ot=Nt(":dels"),gt=mt[tt](ut),at=gt[0],gt=gt[1];if((tt==="query"&&at.isPrimaryKey&&!ut.values?Ot:Nt(at.name||"")).add(gt),!at.isPrimaryKey){if(tt!=="count"){var Yt=tt==="query"&&nt&&ut.values&&pe.query(r(r({},ut),{values:!1}));return pe[tt].apply(this,arguments).then(function(Jt){if(tt==="query"){if(nt&&ut.values)return Yt.then(function(Bn){return Bn=Bn.result,Mt.addKeys(Bn),Jt});var an=ut.values?Jt.result.map(He):Jt.result;(ut.values?Mt:Ot).addKeys(an)}else if(tt==="openCursor"){var Gt=Jt,mn=ut.values;return Gt&&Object.create(Gt,{key:{get:function(){return Ot.addKey(Gt.primaryKey),Gt.key}},primaryKey:{get:function(){var Bn=Gt.primaryKey;return Ot.addKey(Bn),Bn}},value:{get:function(){return mn&&Mt.addKey(Gt.primaryKey),Gt.value}}})}return Jt})}Ot.add(te)}}return pe[tt].apply(this,arguments)}}),dt}})}};function A_(M,z,te){if(te.numFailures===0)return z;if(z.type==="deleteRange")return null;var ae=z.keys?z.keys.length:"values"in z&&z.values?z.values.length:1;return te.numFailures===ae?null:(z=r({},z),o(z.keys)&&(z.keys=z.keys.filter(function(pe,Ee){return!(Ee in te.failures)})),"values"in z&&o(z.values)&&(z.values=z.values.filter(function(pe,Ee){return!(Ee in te.failures)})),z)}function _g(M,z){return te=M,((ae=z).lower===void 0||(ae.lowerOpen?0<Dr(te,ae.lower):0<=Dr(te,ae.lower)))&&(M=M,(z=z).upper===void 0||(z.upperOpen?Dr(M,z.upper)<0:Dr(M,z.upper)<=0));var te,ae}function Ub(M,z,mt,ae,pe,Ee){if(!mt||mt.length===0)return M;var Le=z.query.index,He=Le.multiEntry,nt=z.query.range,it=ae.schema.primaryKey.extractKey,dt=Le.extractKey,Xe=(Le.lowLevelIndex||Le).extractKey,mt=mt.reduce(function(tt,ut){var gt=tt,at=[];if(ut.type==="add"||ut.type==="put")for(var Ct=new Yi,Nt=ut.values.length-1;0<=Nt;--Nt){var Mt,Ot=ut.values[Nt],Yt=it(Ot);Ct.hasKey(Yt)||(Mt=dt(Ot),(He&&o(Mt)?Mt.some(function(Gt){return _g(Gt,nt)}):_g(Mt,nt))&&(Ct.addKey(Yt),at.push(Ot)))}switch(ut.type){case"add":var rn=new Yi().addKeys(z.values?tt.map(function(mn){return it(mn)}):tt),gt=tt.concat(z.values?at.filter(function(mn){return mn=it(mn),!rn.hasKey(mn)&&(rn.addKey(mn),!0)}):at.map(function(mn){return it(mn)}).filter(function(mn){return!rn.hasKey(mn)&&(rn.addKey(mn),!0)}));break;case"put":var Ht=new Yi().addKeys(ut.values.map(function(mn){return it(mn)}));gt=tt.filter(function(mn){return!Ht.hasKey(z.values?it(mn):mn)}).concat(z.values?at:at.map(function(mn){return it(mn)}));break;case"delete":var Jt=new Yi().addKeys(ut.keys);gt=tt.filter(function(mn){return!Jt.hasKey(z.values?it(mn):mn)});break;case"deleteRange":var an=ut.range;gt=tt.filter(function(mn){return!_g(it(mn),an)})}return gt},M);return mt===M?M:(mt.sort(function(tt,ut){return Dr(Xe(tt),Xe(ut))||Dr(it(tt),it(ut))}),z.limit&&z.limit<1/0&&(mt.length>z.limit?mt.length=z.limit:M.length===z.limit&&mt.length<z.limit&&(pe.dirty=!0)),Ee?Object.freeze(mt):mt)}function Cf(M,z){return Dr(M.lower,z.lower)===0&&Dr(M.upper,z.upper)===0&&!!M.lowerOpen==!!z.lowerOpen&&!!M.upperOpen==!!z.upperOpen}function bp(M,z){return function(te,ae,pe,Ee){if(te===void 0)return ae!==void 0?-1:0;if(ae===void 0)return 1;if((ae=Dr(te,ae))===0){if(pe&&Ee)return 0;if(pe)return 1;if(Ee)return-1}return ae}(M.lower,z.lower,M.lowerOpen,z.lowerOpen)<=0&&0<=function(te,ae,pe,Ee){if(te===void 0)return ae!==void 0?1:0;if(ae===void 0)return-1;if((ae=Dr(te,ae))===0){if(pe&&Ee)return 0;if(pe)return-1;if(Ee)return 1}return ae}(M.upper,z.upper,M.upperOpen,z.upperOpen)}function EA(M,z,te,ae){M.subscribers.add(te),ae.addEventListener("abort",function(){var pe,Ee;M.subscribers.delete(te),M.subscribers.size===0&&(pe=M,Ee=z,setTimeout(function(){pe.subscribers.size===0&&L(Ee,pe)},3e3))})}var Sg={stack:"dbcore",level:0,name:"Cache",create:function(M){var z=M.schema.name;return r(r({},M),{transaction:function(te,ae,pe){var Ee,Le,He=M.transaction(te,ae,pe);return ae==="readwrite"&&(Le=(Ee=new AbortController).signal,pe=function(nt){return function(){if(Ee.abort(),ae==="readwrite"){for(var it=new Set,dt=0,Xe=te;dt<Xe.length;dt++){var mt=Xe[dt],tt=Ju["idb://".concat(z,"/").concat(mt)];if(tt){var ut=M.table(mt),gt=tt.optimisticOps.filter(function(mn){return mn.trans===He});if(He._explicit&&nt&&He.mutatedParts)for(var at=0,Ct=Object.values(tt.queries.query);at<Ct.length;at++)for(var Nt=0,Mt=(rn=Ct[at]).slice();Nt<Mt.length;Nt++)Fb((Ht=Mt[Nt]).obsSet,He.mutatedParts)&&(L(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)}));else if(0<gt.length){tt.optimisticOps=tt.optimisticOps.filter(function(mn){return mn.trans!==He});for(var Ot=0,Yt=Object.values(tt.queries.query);Ot<Yt.length;Ot++)for(var rn,Ht,Jt,an=0,Gt=(rn=Yt[Ot]).slice();an<Gt.length;an++)(Ht=Gt[an]).res!=null&&He.mutatedParts&&(nt&&!Ht.dirty?(Jt=Object.isFrozen(Ht.res),Jt=Ub(Ht.res,Ht.req,gt,ut,Ht,Jt),Ht.dirty?(L(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)})):Jt!==Ht.res&&(Ht.res=Jt,Ht.promise=$.resolve({result:Jt}))):(Ht.dirty&&L(rn,Ht),Ht.subscribers.forEach(function(mn){return it.add(mn)})))}}}it.forEach(function(mn){return mn()})}}},He.addEventListener("abort",pe(!1),{signal:Le}),He.addEventListener("error",pe(!1),{signal:Le}),He.addEventListener("complete",pe(!0),{signal:Le})),He},table:function(te){var ae=M.table(te),pe=ae.schema.primaryKey;return r(r({},ae),{mutate:function(Ee){var Le=Ie.trans;if(pe.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return ae.mutate(Ee);var He=Ju["idb://".concat(z,"/").concat(te)];return He?(Le=ae.mutate(Ee),Ee.type!=="add"&&Ee.type!=="put"||!(50<=Ee.values.length||wg(pe,Ee).some(function(nt){return nt==null}))?(He.optimisticOps.push(Ee),Ee.mutatedParts&&vg(Ee.mutatedParts),Le.then(function(nt){0<nt.numFailures&&(L(He.optimisticOps,Ee),(nt=A_(0,Ee,nt))&&He.optimisticOps.push(nt),Ee.mutatedParts&&vg(Ee.mutatedParts))}),Le.catch(function(){L(He.optimisticOps,Ee),Ee.mutatedParts&&vg(Ee.mutatedParts)})):Le.then(function(nt){var it=A_(0,r(r({},Ee),{values:Ee.values.map(function(dt,Xe){var mt;return nt.failures[Xe]?dt:(dt=(mt=pe.keyPath)!==null&&mt!==void 0&&mt.includes(".")?W(dt):r({},dt),A(dt,pe.keyPath,nt.results[Xe]),dt)})}),nt);He.optimisticOps.push(it),queueMicrotask(function(){return Ee.mutatedParts&&vg(Ee.mutatedParts)})}),Le):ae.mutate(Ee)},query:function(Ee){if(!Qu(Ie,ae)||!T_("query",Ee))return ae.query(Ee);var Le=((it=Ie.trans)===null||it===void 0?void 0:it.db._options.cache)==="immutable",Xe=Ie,He=Xe.requery,nt=Xe.signal,it=function(ut,gt,at,Ct){var Nt=Ju["idb://".concat(ut,"/").concat(gt)];if(!Nt)return[];if(!(gt=Nt.queries[at]))return[null,!1,Nt,null];var Mt=gt[(Ct.query?Ct.query.index.name:null)||""];if(!Mt)return[null,!1,Nt,null];switch(at){case"query":var Ot=Mt.find(function(Yt){return Yt.req.limit===Ct.limit&&Yt.req.values===Ct.values&&Cf(Yt.req.query.range,Ct.query.range)});return Ot?[Ot,!0,Nt,Mt]:[Mt.find(function(Yt){return("limit"in Yt.req?Yt.req.limit:1/0)>=Ct.limit&&(!Ct.values||Yt.req.values)&&bp(Yt.req.query.range,Ct.query.range)}),!1,Nt,Mt];case"count":return Ot=Mt.find(function(Yt){return Cf(Yt.req.query.range,Ct.query.range)}),[Ot,!!Ot,Nt,Mt]}}(z,te,"query",Ee),dt=it[0],Xe=it[1],mt=it[2],tt=it[3];return dt&&Xe?dt.obsSet=Ee.obsSet:(Xe=ae.query(Ee).then(function(ut){var gt=ut.result;if(dt&&(dt.res=gt),Le){for(var at=0,Ct=gt.length;at<Ct;++at)Object.freeze(gt[at]);Object.freeze(gt)}else ut.result=W(gt);return ut}).catch(function(ut){return tt&&dt&&L(tt,dt),Promise.reject(ut)}),dt={obsSet:Ee.obsSet,promise:Xe,subscribers:new Set,type:"query",req:Ee,dirty:!1},tt?tt.push(dt):(tt=[dt],(mt=mt||(Ju["idb://".concat(z,"/").concat(te)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ee.query.index.name||""]=tt)),EA(dt,tt,He,nt),dt.promise.then(function(ut){return{result:Ub(ut.result,Ee,mt==null?void 0:mt.optimisticOps,ae,dt,Le)}})}})}})}};function vp(M,z){return new Proxy(M,{get:function(te,ae,pe){return ae==="db"?z:Reflect.get(te,ae,pe)}})}var wl=(Bs.prototype.version=function(M){if(isNaN(M)||M<.1)throw new Ce.Type("Given version is not a positive number");if(M=Math.round(10*M)/10,this.idbdb||this._state.isBeingOpened)throw new Ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,M);var z=this._versions,te=z.filter(function(ae){return ae._cfg.version===M})[0];return te||(te=new this.Version(M),z.push(te),z.sort(Mb),te.stores({}),this._state.autoSchema=!1,te)},Bs.prototype._whenReady=function(M){var z=this;return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?M():new $(function(te,ae){if(z._state.openComplete)return ae(new Ce.DatabaseClosed(z._state.dbOpenError));if(!z._state.isBeingOpened){if(!z._state.autoOpen)return void ae(new Ce.DatabaseClosed);z.open().catch(We)}z._state.dbReadyPromise.then(te,ae)}).then(M)},Bs.prototype.use=function(M){var z=M.stack,te=M.create,ae=M.level,pe=M.name;return pe&&this.unuse({stack:z,name:pe}),M=this._middlewares[z]||(this._middlewares[z]=[]),M.push({stack:z,create:te,level:ae??10,name:pe}),M.sort(function(Ee,Le){return Ee.level-Le.level}),this},Bs.prototype.unuse=function(M){var z=M.stack,te=M.name,ae=M.create;return z&&this._middlewares[z]&&(this._middlewares[z]=this._middlewares[z].filter(function(pe){return ae?pe.create!==ae:!!te&&pe.name!==te})),this},Bs.prototype.open=function(){var M=this;return et(we,function(){return SA(M)})},Bs.prototype._close=function(){var M=this._state,z=ui.indexOf(this);if(0<=z&&ui.splice(z,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}M.isBeingOpened||(M.dbReadyPromise=new $(function(te){M.dbReadyResolve=te}),M.openCanceller=new $(function(te,ae){M.cancelOpen=ae}))},Bs.prototype.close=function(te){var z=(te===void 0?{disableAutoOpen:!0}:te).disableAutoOpen,te=this._state;z?(te.isBeingOpened&&te.cancelOpen(new Ce.DatabaseClosed),this._close(),te.autoOpen=!1,te.dbOpenError=new Ce.DatabaseClosed):(this._close(),te.autoOpen=this._options.autoOpen||te.isBeingOpened,te.openComplete=!1,te.dbOpenError=null)},Bs.prototype.delete=function(M){var z=this;M===void 0&&(M={disableAutoOpen:!0});var te=0<arguments.length&&typeof arguments[0]!="object",ae=this._state;return new $(function(pe,Ee){function Le(){z.close(M);var He=z._deps.indexedDB.deleteDatabase(z.name);He.onsuccess=Oe(function(){var nt,it,dt;nt=z._deps,it=z.name,dt=nt.indexedDB,nt=nt.IDBKeyRange,gg(dt)||it===qa||jb(dt,nt).delete(it).catch(We),pe()}),He.onerror=Vo(Ee),He.onblocked=z._fireOnBlocked}if(te)throw new Ce.InvalidArgument("Invalid closeOptions argument to db.delete()");ae.isBeingOpened?ae.dbReadyPromise.then(Le):Le()})},Bs.prototype.backendDB=function(){return this.idbdb},Bs.prototype.isOpen=function(){return this.idbdb!==null},Bs.prototype.hasBeenClosed=function(){var M=this._state.dbOpenError;return M&&M.name==="DatabaseClosed"},Bs.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Bs.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Bs.prototype,"tables",{get:function(){var M=this;return a(this._allTables).map(function(z){return M._allTables[z]})},enumerable:!1,configurable:!0}),Bs.prototype.transaction=function(){var M=(function(z,te,ae){var pe=arguments.length;if(pe<2)throw new Ce.InvalidArgument("Too few arguments");for(var Ee=new Array(pe-1);--pe;)Ee[pe-1]=arguments[pe];return ae=Ee.pop(),[z,O(Ee),ae]}).apply(this,arguments);return this._transaction.apply(this,M)},Bs.prototype._transaction=function(M,z,te){var ae=this,pe=Ie.trans;pe&&pe.db===this&&M.indexOf("!")===-1||(pe=null);var Ee,Le,He=M.indexOf("?")!==-1;M=M.replace("!","").replace("?","");try{if(Le=z.map(function(it){if(it=it instanceof ae.Table?it.name:it,typeof it!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return it}),M=="r"||M===da)Ee=da;else{if(M!="rw"&&M!=Hs)throw new Ce.InvalidArgument("Invalid transaction mode: "+M);Ee=Hs}if(pe){if(pe.mode===da&&Ee===Hs){if(!He)throw new Ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");pe=null}pe&&Le.forEach(function(it){if(pe&&pe.storeNames.indexOf(it)===-1){if(!He)throw new Ce.SubTransaction("Table "+it+" not included in parent transaction.");pe=null}}),He&&pe&&!pe.active&&(pe=null)}}catch(it){return pe?pe._promise(null,function(dt,Xe){Xe(it)}):rr(it)}var nt=(function it(dt,Xe,mt,tt,ut){return $.resolve().then(function(){var gt=Ie.transless||Ie,at=dt._createTransaction(Xe,mt,dt._dbSchema,tt);if(at.explicit=!0,gt={trans:at,transless:gt},tt)at.idbtrans=tt.idbtrans;else try{at.create(),at.idbtrans._explicit=!0,dt._state.PR1398_maxLoop=3}catch(Mt){return Mt.name===De.InvalidState&&dt.isOpen()&&0<--dt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),dt.close({disableAutoOpen:!1}),dt.open().then(function(){return it(dt,Xe,mt,null,ut)})):rr(Mt)}var Ct,Nt=Q(ut);return Nt&&yr(),gt=$.follow(function(){var Mt;(Ct=ut.call(at,at))&&(Nt?(Mt=Rr.bind(null,null),Ct.then(Mt,Mt)):typeof Ct.next=="function"&&typeof Ct.throw=="function"&&(Ct=yp(Ct)))},gt),(Ct&&typeof Ct.then=="function"?$.resolve(Ct).then(function(Mt){return at.active?Mt:rr(new Ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):gt.then(function(){return Ct})).then(function(Mt){return tt&&at._resolve(),at._completion.then(function(){return Mt})}).catch(function(Mt){return at._reject(Mt),rr(Mt)})})}).bind(null,this,Ee,Le,pe,te);return pe?pe._promise(Ee,nt,"lock"):Ie.trans?et(Ie.transless,function(){return ae._whenReady(nt)}):this._whenReady(nt)},Bs.prototype.table=function(M){if(!d(this._allTables,M))throw new Ce.InvalidTable("Table ".concat(M," does not exist"));return this._allTables[M]},Bs);function Bs(M,z){var te=this;this._middlewares={},this.verno=0;var ae=Bs.dependencies;this._options=z=r({addons:Bs.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},z),this._deps={indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange},ae=z.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var pe,Ee,Le,He,nt,it={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:We,dbReadyPromise:null,cancelOpen:We,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:z.autoOpen};it.dbReadyPromise=new $(function(Xe){it.dbReadyResolve=Xe}),it.openCanceller=new $(function(Xe,mt){it.cancelOpen=mt}),this._state=it,this.name=M,this.on=Vc(this,"populate","blocked","versionchange","close",{ready:[Te,We]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Xe){return function(mt,tt){Bs.vip(function(){var ut,gt=te._state;gt.openComplete?(gt.dbOpenError||$.resolve().then(mt),tt&&Xe(mt)):gt.onReadyBeingFired?(gt.onReadyBeingFired.push(mt),tt&&Xe(mt)):(Xe(mt),ut=te,tt||Xe(function at(){ut.on.ready.unsubscribe(mt),ut.on.ready.unsubscribe(at)}))})}}),this.Collection=(pe=this,hf(yf.prototype,function(Ct,at){this.db=pe;var tt=bl,ut=null;if(at)try{tt=at()}catch(Nt){ut=Nt}var gt=Ct._ctx,at=gt.table,Ct=at.hook.reading.fire;this._ctx={table:at,index:gt.index,isPrimKey:!gt.index||at.schema.primKey.keyPath&&gt.index===at.schema.primKey.name,range:tt,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ut,or:gt.or,valueMapper:Ct!==Ne?Ct:null}})),this.Table=(Ee=this,hf(kb.prototype,function(Xe,mt,tt){this.db=Ee,this._tx=tt,this.name=Xe,this.schema=mt,this.hook=Ee._allTables[Xe]?Ee._allTables[Xe].hook:Vc(null,{creating:[Ae,We],reading:[K,Ne],updating:[oe,We],deleting:[le,We]})})),this.Transaction=(Le=this,hf(Nb.prototype,function(Xe,mt,tt,ut,gt){var at=this;this.db=Le,this.mode=Xe,this.storeNames=mt,this.schema=tt,this.chromeTransactionDurability=ut,this.idbtrans=null,this.on=Vc(this,"complete","error","abort"),this.parent=gt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new $(function(Ct,Nt){at._resolve=Ct,at._reject=Nt}),this._completion.then(function(){at.active=!1,at.on.complete.fire()},function(Ct){var Nt=at.active;return at.active=!1,at.on.error.fire(Ct),at.parent?at.parent._reject(Ct):Nt&&at.idbtrans&&at.idbtrans.abort(),rr(Ct)})})),this.Version=(He=this,hf(_A.prototype,function(Xe){this.db=He,this._cfg={version:Xe,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(nt=this,hf(Gu.prototype,function(Xe,mt,tt){if(this.db=nt,this._ctx={table:Xe,index:mt===":id"?null:mt,or:tt},this._cmp=this._ascending=Dr,this._descending=function(ut,gt){return Dr(gt,ut)},this._max=function(ut,gt){return 0<Dr(ut,gt)?ut:gt},this._min=function(ut,gt){return Dr(ut,gt)<0?ut:gt},this._IDBKeyRange=nt._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ce.MissingAPI})),this.on("versionchange",function(Xe){0<Xe.newVersion?console.warn("Another connection wants to upgrade database '".concat(te.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(te.name,"'. Closing db now to resume the delete request.")),te.close({disableAutoOpen:!1})}),this.on("blocked",function(Xe){!Xe.newVersion||Xe.newVersion<Xe.oldVersion?console.warn("Dexie.delete('".concat(te.name,"') was blocked")):console.warn("Upgrade '".concat(te.name,"' blocked by other connection holding version ").concat(Xe.oldVersion/10))}),this._maxKey=wf(z.IDBKeyRange),this._createTransaction=function(Xe,mt,tt,ut){return new te.Transaction(Xe,mt,tt,te._options.chromeTransactionDurability,ut)},this._fireOnBlocked=function(Xe){te.on("blocked").fire(Xe),ui.filter(function(mt){return mt.name===te.name&&mt!==te&&!mt._state.vcFired}).map(function(mt){return mt.on("versionchange").fire(Xe)})},this.use(E_),this.use(Sg),this.use(kA),this.use(CA),this.use(k_);var dt=new Proxy(this,{get:function(Xe,mt,tt){if(mt==="_vip")return!0;if(mt==="table")return function(gt){return vp(te.table(gt),dt)};var ut=Reflect.get(Xe,mt,tt);return ut instanceof kb?vp(ut,dt):mt==="tables"?ut.map(function(gt){return vp(gt,dt)}):mt==="_createTransaction"?function(){return vp(ut.apply(this,arguments),dt)}:ut}});this.vip=dt,ae.forEach(function(Xe){return Xe(te)})}var kf,Ha=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",R_=(Cg.prototype.subscribe=function(M,z,te){return this._subscribe(M&&typeof M!="function"?M:{next:M,error:z,complete:te})},Cg.prototype[Ha]=function(){return this},Cg);function Cg(M){this._subscribe=M}try{kf={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{kf={indexedDB:null,IDBKeyRange:null}}function N_(M){var z,te=!1,ae=new R_(function(pe){var Ee=Q(M),Le,He=!1,nt={},it={},dt={get closed(){return He},unsubscribe:function(){He||(He=!0,Le&&Le.abort(),Xe&&Ki.storagemutated.unsubscribe(tt))}};pe.start&&pe.start(dt);var Xe=!1,mt=function(){return pn(ut)},tt=function(gt){bg(nt,gt),Fb(it,nt)&&mt()},ut=function(){var gt,at,Ct;!He&&kf.indexedDB&&(nt={},gt={},Le&&Le.abort(),Le=new AbortController,Ct=function(Nt){var Mt=Y();try{Ee&&yr();var Ot=un(M,Nt);return Ot=Ee?Ot.finally(Rr):Ot}finally{Mt&&G()}}(at={subscr:gt,signal:Le.signal,requery:mt,querier:M,trans:null}),Promise.resolve(Ct).then(function(Nt){te=!0,z=Nt,He||at.signal.aborted||(nt={},function(Mt){for(var Ot in Mt)if(d(Mt,Ot))return;return 1}(it=gt)||Xe||(Ki(vf,tt),Xe=!0),pn(function(){return!He&&pe.next&&pe.next(Nt)}))},function(Nt){te=!1,["DatabaseClosedError","AbortError"].includes(Nt==null?void 0:Nt.name)||He||pn(function(){He||pe.error&&pe.error(Nt)})}))};return setTimeout(mt,0),dt});return ae.hasValue=function(){return te},ae.getValue=function(){return z},ae}var ed=wl;function qb(M){var z=Gc;try{Gc=!0,Ki.storagemutated.fire(M),$b(M,!0)}finally{Gc=z}}h(ed,r(r({},Qe),{delete:function(M){return new ed(M,{addons:[]}).delete()},exists:function(M){return new ed(M,{addons:[]}).open().then(function(z){return z.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(M){try{return z=ed.dependencies,te=z.indexedDB,z=z.IDBKeyRange,(gg(te)?Promise.resolve(te.databases()).then(function(ae){return ae.map(function(pe){return pe.name}).filter(function(pe){return pe!==qa})}):jb(te,z).toCollection().primaryKeys()).then(M)}catch{return rr(new Ce.MissingAPI)}var z,te},defineClass:function(){return function(M){l(this,M)}},ignoreTransaction:function(M){return Ie.trans?et(Ie.transless,M):M()},vip:Pb,async:function(M){return function(){try{var z=yp(M.apply(this,arguments));return z&&typeof z.then=="function"?z:$.resolve(z)}catch(te){return rr(te)}}},spawn:function(M,z,te){try{var ae=yp(M.apply(te,z||[]));return ae&&typeof ae.then=="function"?ae:$.resolve(ae)}catch(pe){return rr(pe)}},currentTransaction:{get:function(){return Ie.trans||null}},waitFor:function(M,z){return z=$.resolve(typeof M=="function"?ed.ignoreTransaction(M):M).timeout(z||6e4),Ie.trans?Ie.trans.waitFor(z):z},Promise:$,debug:{get:function(){return Be},set:function(M){ke(M)}},derive:b,extend:l,props:h,override:S,Events:Vc,on:Ki,liveQuery:N_,extendObservabilitySet:bg,getByKeyPath:R,setByKeyPath:A,delByKeyPath:function(M,z){typeof z=="string"?A(M,z,void 0):"length"in z&&[].map.call(z,function(te){A(M,te,void 0)})},shallowClone:N,deepClone:W,getObjectDiff:xg,cmp:Dr,asap:C,minKey:-1/0,addons:[],connections:ui,errnames:De,dependencies:kf,cache:Ju,semVer:"4.0.11",version:"4.0.11".split(".").map(function(M){return parseInt(M)}).reduce(function(M,z,te){return M+z/Math.pow(10,2*te)})})),ed.maxKey=wf(ed.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ki(vf,function(M){Gc||(M=new CustomEvent(Yu,{detail:M}),Gc=!0,dispatchEvent(M),Gc=!1)}),addEventListener(Yu,function(M){M=M.detail,Gc||qb(M)}));var Ef,Gc=!1,Ea=function(){};return typeof BroadcastChannel<"u"&&((Ea=function(){(Ef=new BroadcastChannel(Yu)).onmessage=function(M){return M.data&&qb(M.data)}})(),typeof Ef.unref=="function"&&Ef.unref(),Ki(vf,function(M){Gc||Ef.postMessage(M)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(M){if(!wl.disableBfCache&&M.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),Ef!=null&&Ef.close();for(var z=0,te=ui;z<te.length;z++)te[z].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(M){!wl.disableBfCache&&M.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),Ea(),qb({all:new Yi(-1/0,[[]])}))})),$.rejectionMapper=function(M,z){return!M||M instanceof se||M instanceof TypeError||M instanceof SyntaxError||!M.name||!qe[M.name]?M:(z=new qe[M.name](z||M.message,M),"stack"in M&&y(z,"stack",{get:function(){return this.inner.stack}}),z)},ke(Be),r(wl,Object.freeze({__proto__:null,Dexie:wl,liveQuery:N_,Entity:ig,cmp:Dr,PropModification:gf,replacePrefix:function(M,z){return new gf({replacePrefix:[M,z]})},add:function(M){return new gf({add:M})},remove:function(M){return new gf({remove:M})},default:wl,RangeSet:Yi,mergeRanges:Xu,rangesOverlap:__}),{default:wl}),wl})}(T2)),T2.exports}var v0e=b0e();const nj=Sa(v0e),BB=Symbol.for("Dexie"),cC=globalThis[BB]||(globalThis[BB]=nj);if(nj.semVer!==cC.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${nj.semVer} and ${cC.semVer}`);const{liveQuery:qut,mergeRanges:Vut,rangesOverlap:Wut,RangeSet:Hut,cmp:Gut,Entity:Kut,PropModification:Yut,replacePrefix:Zut,add:Xut,remove:Jut}=cC;class x0e extends cC{constructor(){super("LiteChatDatabase_Rewrite_v1");de(this,"conversations");de(this,"interactions");de(this,"mods");de(this,"appState");de(this,"providerConfigs");de(this,"apiKeys");de(this,"syncRepos");de(this,"projects");de(this,"rules");de(this,"tags");de(this,"tagRuleLinks");de(this,"promptTemplates");this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const It=new x0e,w0e="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let ws=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=w0e[n[e]&63];return t};const pi=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class St{static async loadConversations(){try{return(await It.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>pi(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await It.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await It.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await It.interactions.where({conversationId:t}).sortBy("index")).map(r=>pi(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await It.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await It.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await It.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await It.mods.orderBy("loadOrder").toArray()).map(n=>pi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await It.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await It.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await It.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await It.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=It.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>pi(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await It.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await It.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=It.apiKeys)==null?void 0:t.toArray())??[]).map(r=>pi(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await It.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await It.transaction("rw",[It.apiKeys,It.providerConfigs],async()=>{const n=await It.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await It.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await It.syncRepos.toArray()).map(n=>pi(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await It.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await It.transaction("rw",[It.syncRepos,It.conversations],async()=>{const n=await It.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await It.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await It.projects.orderBy("updatedAt").reverse().toArray()).map(n=>pi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await It.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await It.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await It.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await It.transaction("rw",[It.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await It.rules.orderBy("name").toArray()).map(n=>pi(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await It.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await It.transaction("rw",[It.rules,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("ruleId").equals(t).delete(),await It.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await It.tags.orderBy("name").toArray()).map(n=>pi(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await It.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await It.transaction("rw",[It.tags,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("tagId").equals(t).delete(),await It.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await It.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await It.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await It.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await It.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&s.key!=="settings:mcpServers"&&(n.settings[s.key.substring(9)]=s.value)})}if(t.importApiKeys&&(n.apiKeys=await It.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await It.providerConfigs.toArray()),t.importProjects&&(n.projects=await It.projects.toArray()),t.importConversations&&(n.conversations=await It.conversations.toArray(),n.interactions=await It.interactions.toArray()),t.importRulesAndTags&&(n.rules=await It.rules.toArray(),n.tags=await It.tags.toArray(),n.tagRuleLinks=await It.tagRuleLinks.toArray()),t.importMods&&(n.mods=await It.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await It.syncRepos.toArray()),t.importMcpServers){const s=(await It.appState.toArray()).find(i=>i.key==="settings:mcpServers");n.mcpServers=s?s.value:[]}if(t.importPromptTemplates){const r=await It.promptTemplates.toArray();n.promptTemplates=r.filter(s=>!s.type||s.type==="prompt")}if(t.importAgents){const r=await It.promptTemplates.toArray(),s=r.filter(o=>o.type==="agent"),i=s.map(o=>o.id),a=r.filter(o=>o.type==="task"&&i.includes(o.parentId));n.agents=[...s,...a]}return n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await It.transaction("rw",[It.appState,It.apiKeys,It.providerConfigs,It.projects,It.conversations,It.interactions,It.rules,It.tags,It.tagRuleLinks,It.mods,It.syncRepos,It.promptTemplates],async()=>{if(n.importSettings&&await It.appState.clear(),n.importApiKeys&&await It.apiKeys.clear(),n.importProviderConfigs&&await It.providerConfigs.clear(),n.importProjects&&await It.projects.clear(),n.importConversations&&(await It.conversations.clear(),await It.interactions.clear()),n.importRulesAndTags&&(await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear()),n.importMods&&await It.mods.clear(),n.importSyncRepos&&await It.syncRepos.clear(),n.importMcpServers&&await It.appState.where("key").equals("settings:mcpServers").delete(),n.importPromptTemplates){const i=(await It.promptTemplates.toArray()).filter(a=>!a.type||a.type==="prompt").map(a=>a.id||ws());i.length>0&&await It.promptTemplates.where("id").anyOf(i).delete()}if(n.importAgents&&t.agents){const s=t.agents.filter(l=>l.type==="agent").map(l=>l.id||ws()),a=t.agents.filter(l=>l.type==="task").map(l=>l.id||ws()),o=[...s,...a];o.length>0&&await It.promptTemplates.where("id").anyOf(o).delete()}if(n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await It.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await It.apiKeys.bulkPut(t.apiKeys.map(r=>pi(r))),n.importProviderConfigs&&t.providerConfigs&&await It.providerConfigs.bulkPut(t.providerConfigs.map(r=>pi(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await It.projects.bulkPut(t.projects.map(r=>pi(r))),n.importConversations&&t.conversations&&(await It.conversations.bulkPut(t.conversations.map(r=>pi(r,["lastSyncedAt"]))),t.interactions&&await It.interactions.bulkPut(t.interactions.map(r=>pi(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await It.rules.bulkPut(t.rules.map(r=>pi(r))),t.tags&&await It.tags.bulkPut(t.tags.map(r=>pi(r))),t.tagRuleLinks&&await It.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await It.mods.bulkPut(t.mods.map(r=>pi(r))),n.importSyncRepos&&t.syncRepos&&await It.syncRepos.bulkPut(t.syncRepos.map(r=>pi(r,["lastPulledAt","lastPushedAt"]))),n.importMcpServers&&t.mcpServers&&await It.appState.put({key:"settings:mcpServers",value:t.mcpServers}),n.importPromptTemplates&&t.promptTemplates&&await It.promptTemplates.bulkPut(t.promptTemplates.map(r=>pi({...r,id:r.id||ws()},["createdAt","updatedAt"]))),n.importAgents&&t.agents&&await It.promptTemplates.bulkPut(t.agents.map(r=>pi({...r,id:r.id||ws()},["createdAt","updatedAt"])))})}static async loadPromptTemplates(){try{return(await It.promptTemplates.orderBy("name").toArray()).map(n=>pi(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await It.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await It.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async clearAllData(){try{await It.transaction("rw",[It.conversations,It.interactions,It.mods,It.appState,It.providerConfigs,It.apiKeys,It.syncRepos,It.projects,It.rules,It.tags,It.tagRuleLinks,It.promptTemplates],async()=>{await It.conversations.clear(),await It.interactions.clear(),await It.mods.clear(),await It.appState.clear(),await It.providerConfigs.clear(),await It.apiKeys.clear(),await It.syncRepos.clear(),await It.projects.clear(),await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear(),await It.promptTemplates.clear()})}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const Xn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var il=ZW();const xE=Sa(il);function _0e(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const S0e=e=>{switch(e){case"success":return E0e;case"info":return A0e;case"warning":return T0e;case"error":return R0e;default:return null}},C0e=Array(12).fill(0),k0e=({visible:e,className:t})=>Ve.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Ve.createElement("div",{className:"sonner-spinner"},C0e.map((n,r)=>Ve.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),E0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),T0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),A0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),R0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),N0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ve.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ve.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),M0e=()=>{const[e,t]=Ve.useState(document.hidden);return Ve.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let rj=1;class I0e{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:rj++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],Ve.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(P0e(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,m=typeof u=="object"&&!Ve.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...m})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||rj++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const vo=new I0e,j0e=(e,t)=>{const n=(t==null?void 0:t.id)||rj++;return vo.addToast({title:e,...t,id:n}),n},P0e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",O0e=j0e,D0e=()=>vo.toasts,F0e=()=>vo.getActiveToasts(),Me=Object.assign(O0e,{success:vo.success,info:vo.info,warning:vo.warning,error:vo.error,custom:vo.custom,message:vo.message,promise:vo.promise,dismiss:vo.dismiss,loading:vo.loading},{getHistory:D0e,getToasts:F0e});_0e("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function RS(e){return e.label!==void 0}const L0e=3,B0e="24px",$0e="16px",$B=4e3,z0e=356,U0e=14,q0e=45,V0e=200;function eu(...e){return e.filter(Boolean).join(" ")}function W0e(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const H0e=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:m,setHeights:y,visibleToasts:b,heights:v,index:x,toasts:w,expanded:S,removeToast:k,defaultRichColors:C,closeButton:R,style:A,cancelButtonStyle:N,actionButtonStyle:I,className:O="",descriptionClassName:B="",duration:D,position:W,gap:P,expandByDefault:Z,classNames:U,icons:H,closeButtonAriaLabel:L="Close toast"}=e,[ne,V]=Ve.useState(null),[Q,ee]=Ve.useState(null),[se,me]=Ve.useState(!1),[ce,je]=Ve.useState(!1),[De,Se]=Ve.useState(!1),[Ce,qe]=Ve.useState(!1),[Qe,We]=Ve.useState(!1),[Ne,K]=Ve.useState(0),[ge,Ae]=Ve.useState(0),le=Ve.useRef(d.duration||D||$B),oe=Ve.useRef(null),re=Ve.useRef(null),Te=x===0,Be=x+1<=b,ke=d.type,lt=d.dismissible!==!1,Rt=d.className||"",ft=d.descriptionClassName||"",Pt=Ve.useMemo(()=>v.findIndex(_e=>_e.toastId===d.id)||0,[v,d.id]),qt=Ve.useMemo(()=>{var _e;return(_e=d.closeButton)!=null?_e:R},[d.closeButton,R]),Lt=Ve.useMemo(()=>d.duration||D||$B,[d.duration,D]),en=Ve.useRef(0),xe=Ve.useRef(0),F=Ve.useRef(0),X=Ve.useRef(null),[ye,Fe]=W.split("-"),we=Ve.useMemo(()=>v.reduce((_e,Ue,Et)=>Et>=Pt?_e:_e+Ue.height,0),[v,Pt]),Ie=M0e(),fe=d.invert||u,vt=ke==="loading";xe.current=Ve.useMemo(()=>Pt*P+we,[Pt,we]),Ve.useEffect(()=>{le.current=Lt},[Lt]),Ve.useEffect(()=>{me(!0)},[]),Ve.useEffect(()=>{const _e=re.current;if(_e){const Ue=_e.getBoundingClientRect().height;return Ae(Ue),y(Et=>[{toastId:d.id,height:Ue,position:d.position},...Et]),()=>y(Et=>Et.filter(he=>he.toastId!==d.id))}},[y,d.id]),Ve.useLayoutEffect(()=>{if(!se)return;const _e=re.current,Ue=_e.style.height;_e.style.height="auto";const Et=_e.getBoundingClientRect().height;_e.style.height=Ue,Ae(Et),y(he=>he.find(G=>G.toastId===d.id)?he.map(G=>G.toastId===d.id?{...G,height:Et}:G):[{toastId:d.id,height:Et,position:d.position},...he])},[se,d.title,d.description,y,d.id]);const ot=Ve.useCallback(()=>{je(!0),K(xe.current),y(_e=>_e.filter(Ue=>Ue.toastId!==d.id)),setTimeout(()=>{k(d)},V0e)},[d,k,y,xe]);Ve.useEffect(()=>{if(d.promise&&ke==="loading"||d.duration===1/0||d.type==="loading")return;let _e;return S||m||Ie?(()=>{if(F.current<en.current){const he=new Date().getTime()-en.current;le.current=le.current-he}F.current=new Date().getTime()})():(()=>{le.current!==1/0&&(en.current=new Date().getTime(),_e=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),ot()},le.current))})(),()=>clearTimeout(_e)},[S,m,d,ke,Ie,ot]),Ve.useEffect(()=>{d.delete&&ot()},[ot,d.delete]);function $(){var _e;if(H!=null&&H.loading){var Ue;return Ve.createElement("div",{className:eu(U==null?void 0:U.loader,d==null||(Ue=d.classNames)==null?void 0:Ue.loader,"sonner-loader"),"data-visible":ke==="loading"},H.loading)}return Ve.createElement(k0e,{className:eu(U==null?void 0:U.loader,d==null||(_e=d.classNames)==null?void 0:_e.loader),visible:ke==="loading"})}const ze=d.icon||(H==null?void 0:H[ke])||S0e(ke);var st,be;return Ve.createElement("li",{tabIndex:0,ref:re,className:eu(O,Rt,U==null?void 0:U.toast,d==null||(t=d.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[ke],d==null||(n=d.classNames)==null?void 0:n[ke]),"data-sonner-toast":"","data-rich-colors":(st=d.richColors)!=null?st:C,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":se,"data-promise":!!d.promise,"data-swiped":Qe,"data-removed":ce,"data-visible":Be,"data-y-position":ye,"data-x-position":Fe,"data-index":x,"data-front":Te,"data-swiping":De,"data-dismissible":lt,"data-type":ke,"data-invert":fe,"data-swipe-out":Ce,"data-swipe-direction":Q,"data-expanded":!!(S||Z&&se),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${ce?Ne:xe.current}px`,"--initial-height":Z?"auto":`${ge}px`,...A,...d.style},onDragEnd:()=>{Se(!1),V(null),X.current=null},onPointerDown:_e=>{vt||!lt||(oe.current=new Date,K(xe.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(Se(!0),X.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,Ue,Et;if(Ce||!lt)return;X.current=null;const he=Number(((_e=re.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Y=Number(((Ue=re.current)==null?void 0:Ue.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((Et=oe.current)==null?void 0:Et.getTime()),J=ne==="x"?he:Y,ve=Math.abs(J)/G;if(Math.abs(J)>=q0e||ve>.11){K(xe.current),d.onDismiss==null||d.onDismiss.call(d,d),ee(ne==="x"?he>0?"right":"left":Y>0?"down":"up"),ot(),qe(!0);return}else{var Oe,Ke;(Oe=re.current)==null||Oe.style.setProperty("--swipe-amount-x","0px"),(Ke=re.current)==null||Ke.style.setProperty("--swipe-amount-y","0px")}We(!1),Se(!1),V(null)},onPointerMove:_e=>{var Ue,Et,he;if(!X.current||!lt||((Ue=window.getSelection())==null?void 0:Ue.toString().length)>0)return;const G=_e.clientY-X.current.y,J=_e.clientX-X.current.x;var ve;const Oe=(ve=e.swipeDirections)!=null?ve:W0e(W);!ne&&(Math.abs(J)>1||Math.abs(G)>1)&&V(Math.abs(J)>Math.abs(G)?"x":"y");let Ke={x:0,y:0};const _t=tn=>1/(1.5+Math.abs(tn)/20);if(ne==="y"){if(Oe.includes("top")||Oe.includes("bottom"))if(Oe.includes("top")&&G<0||Oe.includes("bottom")&&G>0)Ke.y=G;else{const tn=G*_t(G);Ke.y=Math.abs(tn)<Math.abs(G)?tn:G}}else if(ne==="x"&&(Oe.includes("left")||Oe.includes("right")))if(Oe.includes("left")&&J<0||Oe.includes("right")&&J>0)Ke.x=J;else{const tn=J*_t(J);Ke.x=Math.abs(tn)<Math.abs(J)?tn:J}(Math.abs(Ke.x)>0||Math.abs(Ke.y)>0)&&We(!0),(Et=re.current)==null||Et.style.setProperty("--swipe-amount-x",`${Ke.x}px`),(he=re.current)==null||he.style.setProperty("--swipe-amount-y",`${Ke.y}px`)}},qt&&!d.jsx&&ke!=="loading"?Ve.createElement("button",{"aria-label":L,"data-disabled":vt,"data-close-button":!0,onClick:vt||!lt?()=>{}:()=>{ot(),d.onDismiss==null||d.onDismiss.call(d,d)},className:eu(U==null?void 0:U.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(be=H==null?void 0:H.close)!=null?be:N0e):null,(ke||d.icon||d.promise)&&d.icon!==null&&((H==null?void 0:H[ke])!==null||d.icon)?Ve.createElement("div",{"data-icon":"",className:eu(U==null?void 0:U.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||$():null,d.type!=="loading"?ze:null):null,Ve.createElement("div",{"data-content":"",className:eu(U==null?void 0:U.content,d==null||(i=d.classNames)==null?void 0:i.content)},Ve.createElement("div",{"data-title":"",className:eu(U==null?void 0:U.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?Ve.createElement("div",{"data-description":"",className:eu(B,ft,U==null?void 0:U.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),Ve.isValidElement(d.cancel)?d.cancel:d.cancel&&RS(d.cancel)?Ve.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||N,onClick:_e=>{RS(d.cancel)&&lt&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,_e),ot())},className:eu(U==null?void 0:U.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,Ve.isValidElement(d.action)?d.action:d.action&&RS(d.action)?Ve.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||I,onClick:_e=>{RS(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,_e),!_e.defaultPrevented&&ot())},className:eu(U==null?void 0:U.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function zB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function G0e(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?$0e:B0e;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const K0e=Ve.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:m,style:y,visibleToasts:b=L0e,toastOptions:v,dir:x=zB(),gap:w=U0e,icons:S,containerAriaLabel:k="Notifications"}=t,[C,R]=Ve.useState([]),A=Ve.useMemo(()=>Array.from(new Set([s].concat(C.filter(Q=>Q.position).map(Q=>Q.position)))),[C,s]),[N,I]=Ve.useState([]),[O,B]=Ve.useState(!1),[D,W]=Ve.useState(!1),[P,Z]=Ve.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=Ve.useRef(null),H=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),L=Ve.useRef(null),ne=Ve.useRef(!1),V=Ve.useCallback(Q=>{R(ee=>{var se;return(se=ee.find(me=>me.id===Q.id))!=null&&se.delete||vo.dismiss(Q.id),ee.filter(({id:me})=>me!==Q.id)})},[]);return Ve.useEffect(()=>vo.subscribe(Q=>{if(Q.dismiss){requestAnimationFrame(()=>{R(ee=>ee.map(se=>se.id===Q.id?{...se,delete:!0}:se))});return}setTimeout(()=>{xE.flushSync(()=>{R(ee=>{const se=ee.findIndex(me=>me.id===Q.id);return se!==-1?[...ee.slice(0,se),{...ee[se],...Q},...ee.slice(se+1)]:[Q,...ee]})})})}),[C]),Ve.useEffect(()=>{if(d!=="system"){Z(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window>"u")return;const Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:ee})=>{Z(ee?"dark":"light")})}catch{Q.addListener(({matches:se})=>{try{Z(se?"dark":"light")}catch(me){console.error(me)}})}},[d]),Ve.useEffect(()=>{C.length<=1&&B(!1)},[C]),Ve.useEffect(()=>{const Q=ee=>{var se;if(i.every(je=>ee[je]||ee.code===je)){var ce;B(!0),(ce=U.current)==null||ce.focus()}ee.code==="Escape"&&(document.activeElement===U.current||(se=U.current)!=null&&se.contains(document.activeElement))&&B(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),Ve.useEffect(()=>{if(U.current)return()=>{L.current&&(L.current.focus({preventScroll:!0}),L.current=null,ne.current=!1)}},[U.current]),Ve.createElement("section",{ref:n,"aria-label":`${k} ${H}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((Q,ee)=>{var se;const[me,ce]=Q.split("-");return C.length?Ve.createElement("ol",{key:Q,dir:x==="auto"?zB():x,tabIndex:-1,ref:U,className:l,"data-sonner-toaster":!0,"data-sonner-theme":P,"data-y-position":me,"data-lifted":O&&C.length>1&&!a,"data-x-position":ce,style:{"--front-toast-height":`${((se=N[0])==null?void 0:se.height)||0}px`,"--width":`${z0e}px`,"--gap":`${w}px`,...y,...G0e(c,u)},onBlur:je=>{ne.current&&!je.currentTarget.contains(je.relatedTarget)&&(ne.current=!1,L.current&&(L.current.focus({preventScroll:!0}),L.current=null))},onFocus:je=>{je.target instanceof HTMLElement&&je.target.dataset.dismissible==="false"||ne.current||(ne.current=!0,L.current=je.relatedTarget)},onMouseEnter:()=>B(!0),onMouseMove:()=>B(!0),onMouseLeave:()=>{D||B(!1)},onDragEnd:()=>B(!1),onPointerDown:je=>{je.target instanceof HTMLElement&&je.target.dataset.dismissible==="false"||W(!0)},onPointerUp:()=>W(!1)},C.filter(je=>!je.position&&ee===0||je.position===Q).map((je,De)=>{var Se,Ce;return Ve.createElement(H0e,{key:je.id,icons:S,index:De,toast:je,defaultRichColors:h,duration:(Se=v==null?void 0:v.duration)!=null?Se:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ce=v==null?void 0:v.closeButton)!=null?Ce:o,interacting:D,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:V,toasts:C.filter(qe=>qe.position==je.position),heights:N.filter(qe=>qe.position==je.position),setHeights:I,expandByDefault:a,gap:w,expanded:O,swipeDirections:t.swipeDirections})})):null}))}),Ln=Bo($o((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Pe.emit(Xn.statusChanged,{status:"loading"});try{const s=await St.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Pe.emit(Xn.loaded,{conversationId:n,interactions:o}),Pe.emit(Xn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Pe.emit(Xn.statusChanged,{status:"error"}),Pe.emit(Xn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Pe.emit(Xn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Pe.emit(Xn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Pe.emit(Xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Pe.emit(Xn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await St.saveInteraction({...s,rating:r}),Pe.emit(Xn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),Me.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Pe.emit(Xn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Pe.emit(Xn.statusChanged,{status:"idle"}),Pe.emit(Xn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Pe.emit(Xn.statusChanged,{status:s}),Pe.emit(Xn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Pe.emit(Xn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Pe.emit(Xn.statusChanged,{status:"streaming"}),Pe.emit(Xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Pe.emit(Xn.statusChanged,{status:t().status}),Pe.emit(Xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:Xn.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:Xn.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:Xn.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:Xn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:Xn.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:Xn.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),Bl={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},gh=Bo($o((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:ws(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Pe.emit(Bl.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Pe.emit(Bl.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Pe.emit(Bl.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:Bl.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:Bl.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:Bl.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),TH=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(TH);const Yx=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return TH.has(s)};var AH="vercel.ai.error",Y0e=Symbol.for(AH),RH,Z0e=class NH extends Error{constructor({name:t,message:n,cause:r}){super(n),this[RH]=!0,this.name=t,this.cause=r}static isInstance(t){return NH.hasMarker(t,AH)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};RH=Y0e;var tr=Z0e,MH="AI_APICallError",IH=`vercel.ai.error.${MH}`,X0e=Symbol.for(IH),jH,zl=class extends tr{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:MH,message:e,cause:a}),this[jH]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return tr.hasMarker(e,IH)}};jH=X0e;var PH="AI_EmptyResponseBodyError",OH=`vercel.ai.error.${PH}`,J0e=Symbol.for(OH),DH,FH=class extends tr{constructor({message:e="Empty response body"}={}){super({name:PH,message:e}),this[DH]=!0}static isInstance(e){return tr.hasMarker(e,OH)}};DH=J0e;function p1(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var LH="AI_InvalidArgumentError",BH=`vercel.ai.error.${LH}`,Q0e=Symbol.for(BH),$H,zH=class extends tr{constructor({message:t,cause:n,argument:r}){super({name:LH,message:t,cause:n}),this[$H]=!0,this.argument=r}static isInstance(t){return tr.hasMarker(t,BH)}};$H=Q0e;var UH="AI_InvalidPromptError",qH=`vercel.ai.error.${UH}`,eye=Symbol.for(qH),VH,pc=class extends tr{constructor({prompt:e,message:t,cause:n}){super({name:UH,message:`Invalid prompt: ${t}`,cause:n}),this[VH]=!0,this.prompt=e}static isInstance(e){return tr.hasMarker(e,qH)}};VH=eye;var WH="AI_InvalidResponseDataError",HH=`vercel.ai.error.${WH}`,tye=Symbol.for(HH),GH,jd=class extends tr{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:WH,message:t}),this[GH]=!0,this.data=e}static isInstance(e){return tr.hasMarker(e,HH)}};GH=tye;var KH="AI_JSONParseError",YH=`vercel.ai.error.${KH}`,nye=Symbol.for(YH),ZH,uC=class extends tr{constructor({text:e,cause:t}){super({name:KH,message:`JSON parsing failed: Text: ${e}.
Error message: ${p1(t)}`,cause:t}),this[ZH]=!0,this.text=e}static isInstance(e){return tr.hasMarker(e,YH)}};ZH=nye;var XH="AI_LoadAPIKeyError",JH=`vercel.ai.error.${XH}`,rye=Symbol.for(JH),QH,NS=class extends tr{constructor({message:e}){super({name:XH,message:e}),this[QH]=!0}static isInstance(e){return tr.hasMarker(e,JH)}};QH=rye;var eG="AI_TooManyEmbeddingValuesForCallError",tG=`vercel.ai.error.${eG}`,sye=Symbol.for(tG),nG,wE=class extends tr{constructor(e){super({name:eG,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[nG]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return tr.hasMarker(e,tG)}};nG=sye;var rG="AI_TypeValidationError",sG=`vercel.ai.error.${rG}`,iye=Symbol.for(sG),iG,aye=class sj extends tr{constructor({value:t,cause:n}){super({name:rG,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${p1(n)}`,cause:n}),this[iG]=!0,this.value=t}static isInstance(t){return tr.hasMarker(t,sG)}static wrap({value:t,cause:n}){return sj.isInstance(n)&&n.value===t?n:new sj({value:t,cause:n})}};iG=iye;var dC=aye,aG="AI_UnsupportedFunctionalityError",oG=`vercel.ai.error.${aG}`,oye=Symbol.for(oG),lG,pr=class extends tr{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:aG,message:t}),this[lG]=!0,this.functionality=e}static isInstance(e){return tr.hasMarker(e,oG)}};lG=oye;let lye=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var WP={},_E={};_E.byteLength=dye;_E.toByteArray=hye;_E.fromByteArray=gye;var hu=[],Dl=[],cye=typeof Uint8Array<"u"?Uint8Array:Array,bN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Yg=0,uye=bN.length;Yg<uye;++Yg)hu[Yg]=bN[Yg],Dl[bN.charCodeAt(Yg)]=Yg;Dl[45]=62;Dl[95]=63;function cG(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function dye(e){var t=cG(e),n=t[0],r=t[1];return(n+r)*3/4-r}function fye(e,t,n){return(t+n)*3/4-n}function hye(e){var t,n=cG(e),r=n[0],s=n[1],i=new cye(fye(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=Dl[e.charCodeAt(l)]<<18|Dl[e.charCodeAt(l+1)]<<12|Dl[e.charCodeAt(l+2)]<<6|Dl[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=Dl[e.charCodeAt(l)]<<2|Dl[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=Dl[e.charCodeAt(l)]<<10|Dl[e.charCodeAt(l+1)]<<4|Dl[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function pye(e){return hu[e>>18&63]+hu[e>>12&63]+hu[e>>6&63]+hu[e&63]}function mye(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(pye(r));return s.join("")}function gye(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(mye(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(hu[t>>2]+hu[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(hu[t>>10]+hu[t>>4&63]+hu[t<<2&63]+"=")),s.join("")}var HP={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */HP.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,m=e[t+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(m?-1:1)*a*Math.pow(2,i-r)};HP.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:i-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+m]=o&255,m+=y,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+m]=a&255,m+=y,a/=256,c-=8);e[n+m-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=_E,n=HP,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=C,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const xe=new i(1),F={foo:function(){return 42}};return Object.setPrototypeOf(F,i.prototype),Object.setPrototypeOf(xe,F),xe.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(xe){if(xe>s)throw new RangeError('The value "'+xe+'" is invalid for option "size"');const F=new i(xe);return Object.setPrototypeOf(F,u.prototype),F}function u(xe,F,X){if(typeof xe=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(xe)}return d(xe,F,X)}u.poolSize=8192;function d(xe,F,X){if(typeof xe=="string")return b(xe,F);if(a.isView(xe))return x(xe);if(xe==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe);if(ft(xe,a)||xe&&ft(xe.buffer,a)||typeof o<"u"&&(ft(xe,o)||xe&&ft(xe.buffer,o)))return w(xe,F,X);if(typeof xe=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ye=xe.valueOf&&xe.valueOf();if(ye!=null&&ye!==xe)return u.from(ye,F,X);const Fe=S(xe);if(Fe)return Fe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof xe[Symbol.toPrimitive]=="function")return u.from(xe[Symbol.toPrimitive]("string"),F,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe)}u.from=function(xe,F,X){return d(xe,F,X)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(xe){if(typeof xe!="number")throw new TypeError('"size" argument must be of type number');if(xe<0)throw new RangeError('The value "'+xe+'" is invalid for option "size"')}function m(xe,F,X){return h(xe),xe<=0?c(xe):F!==void 0?typeof X=="string"?c(xe).fill(F,X):c(xe).fill(F):c(xe)}u.alloc=function(xe,F,X){return m(xe,F,X)};function y(xe){return h(xe),c(xe<0?0:k(xe)|0)}u.allocUnsafe=function(xe){return y(xe)},u.allocUnsafeSlow=function(xe){return y(xe)};function b(xe,F){if((typeof F!="string"||F==="")&&(F="utf8"),!u.isEncoding(F))throw new TypeError("Unknown encoding: "+F);const X=R(xe,F)|0;let ye=c(X);const Fe=ye.write(xe,F);return Fe!==X&&(ye=ye.slice(0,Fe)),ye}function v(xe){const F=xe.length<0?0:k(xe.length)|0,X=c(F);for(let ye=0;ye<F;ye+=1)X[ye]=xe[ye]&255;return X}function x(xe){if(ft(xe,i)){const F=new i(xe);return w(F.buffer,F.byteOffset,F.byteLength)}return v(xe)}function w(xe,F,X){if(F<0||xe.byteLength<F)throw new RangeError('"offset" is outside of buffer bounds');if(xe.byteLength<F+(X||0))throw new RangeError('"length" is outside of buffer bounds');let ye;return F===void 0&&X===void 0?ye=new i(xe):X===void 0?ye=new i(xe,F):ye=new i(xe,F,X),Object.setPrototypeOf(ye,u.prototype),ye}function S(xe){if(u.isBuffer(xe)){const F=k(xe.length)|0,X=c(F);return X.length===0||xe.copy(X,0,0,F),X}if(xe.length!==void 0)return typeof xe.length!="number"||Pt(xe.length)?c(0):v(xe);if(xe.type==="Buffer"&&Array.isArray(xe.data))return v(xe.data)}function k(xe){if(xe>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return xe|0}function C(xe){return+xe!=xe&&(xe=0),u.alloc(+xe)}u.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==u.prototype},u.compare=function(F,X){if(ft(F,i)&&(F=u.from(F,F.offset,F.byteLength)),ft(X,i)&&(X=u.from(X,X.offset,X.byteLength)),!u.isBuffer(F)||!u.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===X)return 0;let ye=F.length,Fe=X.length;for(let we=0,Ie=Math.min(ye,Fe);we<Ie;++we)if(F[we]!==X[we]){ye=F[we],Fe=X[we];break}return ye<Fe?-1:Fe<ye?1:0},u.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(F,X){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return u.alloc(0);let ye;if(X===void 0)for(X=0,ye=0;ye<F.length;++ye)X+=F[ye].length;const Fe=u.allocUnsafe(X);let we=0;for(ye=0;ye<F.length;++ye){let Ie=F[ye];if(ft(Ie,i))we+Ie.length>Fe.length?(u.isBuffer(Ie)||(Ie=u.from(Ie)),Ie.copy(Fe,we)):i.prototype.set.call(Fe,Ie,we);else if(u.isBuffer(Ie))Ie.copy(Fe,we);else throw new TypeError('"list" argument must be an Array of Buffers');we+=Ie.length}return Fe};function R(xe,F){if(u.isBuffer(xe))return xe.length;if(a.isView(xe)||ft(xe,a))return xe.byteLength;if(typeof xe!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof xe);const X=xe.length,ye=arguments.length>2&&arguments[2]===!0;if(!ye&&X===0)return 0;let Fe=!1;for(;;)switch(F){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return Te(xe).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return lt(xe).length;default:if(Fe)return ye?-1:Te(xe).length;F=(""+F).toLowerCase(),Fe=!0}}u.byteLength=R;function A(xe,F,X){let ye=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,F>>>=0,X<=F))return"";for(xe||(xe="utf8");;)switch(xe){case"hex":return ee(this,F,X);case"utf8":case"utf-8":return H(this,F,X);case"ascii":return V(this,F,X);case"latin1":case"binary":return Q(this,F,X);case"base64":return U(this,F,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,F,X);default:if(ye)throw new TypeError("Unknown encoding: "+xe);xe=(xe+"").toLowerCase(),ye=!0}}u.prototype._isBuffer=!0;function N(xe,F,X){const ye=xe[F];xe[F]=xe[X],xe[X]=ye}u.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<F;X+=2)N(this,X,X+1);return this},u.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<F;X+=4)N(this,X,X+3),N(this,X+1,X+2);return this},u.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<F;X+=8)N(this,X,X+7),N(this,X+1,X+6),N(this,X+2,X+5),N(this,X+3,X+4);return this},u.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?H(this,0,F):A.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(F){if(!u.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:u.compare(this,F)===0},u.prototype.inspect=function(){let F="";const X=e.INSPECT_MAX_BYTES;return F=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(F+=" ... "),"<Buffer "+F+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(F,X,ye,Fe,we){if(ft(F,i)&&(F=u.from(F,F.offset,F.byteLength)),!u.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(X===void 0&&(X=0),ye===void 0&&(ye=F?F.length:0),Fe===void 0&&(Fe=0),we===void 0&&(we=this.length),X<0||ye>F.length||Fe<0||we>this.length)throw new RangeError("out of range index");if(Fe>=we&&X>=ye)return 0;if(Fe>=we)return-1;if(X>=ye)return 1;if(X>>>=0,ye>>>=0,Fe>>>=0,we>>>=0,this===F)return 0;let Ie=we-Fe,fe=ye-X;const vt=Math.min(Ie,fe),ot=this.slice(Fe,we),$=F.slice(X,ye);for(let ze=0;ze<vt;++ze)if(ot[ze]!==$[ze]){Ie=ot[ze],fe=$[ze];break}return Ie<fe?-1:fe<Ie?1:0};function I(xe,F,X,ye,Fe){if(xe.length===0)return-1;if(typeof X=="string"?(ye=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,Pt(X)&&(X=Fe?0:xe.length-1),X<0&&(X=xe.length+X),X>=xe.length){if(Fe)return-1;X=xe.length-1}else if(X<0)if(Fe)X=0;else return-1;if(typeof F=="string"&&(F=u.from(F,ye)),u.isBuffer(F))return F.length===0?-1:O(xe,F,X,ye,Fe);if(typeof F=="number")return F=F&255,typeof i.prototype.indexOf=="function"?Fe?i.prototype.indexOf.call(xe,F,X):i.prototype.lastIndexOf.call(xe,F,X):O(xe,[F],X,ye,Fe);throw new TypeError("val must be string, number or Buffer")}function O(xe,F,X,ye,Fe){let we=1,Ie=xe.length,fe=F.length;if(ye!==void 0&&(ye=String(ye).toLowerCase(),ye==="ucs2"||ye==="ucs-2"||ye==="utf16le"||ye==="utf-16le")){if(xe.length<2||F.length<2)return-1;we=2,Ie/=2,fe/=2,X/=2}function vt($,ze){return we===1?$[ze]:$.readUInt16BE(ze*we)}let ot;if(Fe){let $=-1;for(ot=X;ot<Ie;ot++)if(vt(xe,ot)===vt(F,$===-1?0:ot-$)){if($===-1&&($=ot),ot-$+1===fe)return $*we}else $!==-1&&(ot-=ot-$),$=-1}else for(X+fe>Ie&&(X=Ie-fe),ot=X;ot>=0;ot--){let $=!0;for(let ze=0;ze<fe;ze++)if(vt(xe,ot+ze)!==vt(F,ze)){$=!1;break}if($)return ot}return-1}u.prototype.includes=function(F,X,ye){return this.indexOf(F,X,ye)!==-1},u.prototype.indexOf=function(F,X,ye){return I(this,F,X,ye,!0)},u.prototype.lastIndexOf=function(F,X,ye){return I(this,F,X,ye,!1)};function B(xe,F,X,ye){X=Number(X)||0;const Fe=xe.length-X;ye?(ye=Number(ye),ye>Fe&&(ye=Fe)):ye=Fe;const we=F.length;ye>we/2&&(ye=we/2);let Ie;for(Ie=0;Ie<ye;++Ie){const fe=parseInt(F.substr(Ie*2,2),16);if(Pt(fe))return Ie;xe[X+Ie]=fe}return Ie}function D(xe,F,X,ye){return Rt(Te(F,xe.length-X),xe,X,ye)}function W(xe,F,X,ye){return Rt(Be(F),xe,X,ye)}function P(xe,F,X,ye){return Rt(lt(F),xe,X,ye)}function Z(xe,F,X,ye){return Rt(ke(F,xe.length-X),xe,X,ye)}u.prototype.write=function(F,X,ye,Fe){if(X===void 0)Fe="utf8",ye=this.length,X=0;else if(ye===void 0&&typeof X=="string")Fe=X,ye=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(ye)?(ye=ye>>>0,Fe===void 0&&(Fe="utf8")):(Fe=ye,ye=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const we=this.length-X;if((ye===void 0||ye>we)&&(ye=we),F.length>0&&(ye<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");Fe||(Fe="utf8");let Ie=!1;for(;;)switch(Fe){case"hex":return B(this,F,X,ye);case"utf8":case"utf-8":return D(this,F,X,ye);case"ascii":case"latin1":case"binary":return W(this,F,X,ye);case"base64":return P(this,F,X,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,F,X,ye);default:if(Ie)throw new TypeError("Unknown encoding: "+Fe);Fe=(""+Fe).toLowerCase(),Ie=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(xe,F,X){return F===0&&X===xe.length?t.fromByteArray(xe):t.fromByteArray(xe.slice(F,X))}function H(xe,F,X){X=Math.min(xe.length,X);const ye=[];let Fe=F;for(;Fe<X;){const we=xe[Fe];let Ie=null,fe=we>239?4:we>223?3:we>191?2:1;if(Fe+fe<=X){let vt,ot,$,ze;switch(fe){case 1:we<128&&(Ie=we);break;case 2:vt=xe[Fe+1],(vt&192)===128&&(ze=(we&31)<<6|vt&63,ze>127&&(Ie=ze));break;case 3:vt=xe[Fe+1],ot=xe[Fe+2],(vt&192)===128&&(ot&192)===128&&(ze=(we&15)<<12|(vt&63)<<6|ot&63,ze>2047&&(ze<55296||ze>57343)&&(Ie=ze));break;case 4:vt=xe[Fe+1],ot=xe[Fe+2],$=xe[Fe+3],(vt&192)===128&&(ot&192)===128&&($&192)===128&&(ze=(we&15)<<18|(vt&63)<<12|(ot&63)<<6|$&63,ze>65535&&ze<1114112&&(Ie=ze))}}Ie===null?(Ie=65533,fe=1):Ie>65535&&(Ie-=65536,ye.push(Ie>>>10&1023|55296),Ie=56320|Ie&1023),ye.push(Ie),Fe+=fe}return ne(ye)}const L=4096;function ne(xe){const F=xe.length;if(F<=L)return String.fromCharCode.apply(String,xe);let X="",ye=0;for(;ye<F;)X+=String.fromCharCode.apply(String,xe.slice(ye,ye+=L));return X}function V(xe,F,X){let ye="";X=Math.min(xe.length,X);for(let Fe=F;Fe<X;++Fe)ye+=String.fromCharCode(xe[Fe]&127);return ye}function Q(xe,F,X){let ye="";X=Math.min(xe.length,X);for(let Fe=F;Fe<X;++Fe)ye+=String.fromCharCode(xe[Fe]);return ye}function ee(xe,F,X){const ye=xe.length;(!F||F<0)&&(F=0),(!X||X<0||X>ye)&&(X=ye);let Fe="";for(let we=F;we<X;++we)Fe+=qt[xe[we]];return Fe}function se(xe,F,X){const ye=xe.slice(F,X);let Fe="";for(let we=0;we<ye.length-1;we+=2)Fe+=String.fromCharCode(ye[we]+ye[we+1]*256);return Fe}u.prototype.slice=function(F,X){const ye=this.length;F=~~F,X=X===void 0?ye:~~X,F<0?(F+=ye,F<0&&(F=0)):F>ye&&(F=ye),X<0?(X+=ye,X<0&&(X=0)):X>ye&&(X=ye),X<F&&(X=F);const Fe=this.subarray(F,X);return Object.setPrototypeOf(Fe,u.prototype),Fe};function me(xe,F,X){if(xe%1!==0||xe<0)throw new RangeError("offset is not uint");if(xe+F>X)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||me(F,X,this.length);let Fe=this[F],we=1,Ie=0;for(;++Ie<X&&(we*=256);)Fe+=this[F+Ie]*we;return Fe},u.prototype.readUintBE=u.prototype.readUIntBE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||me(F,X,this.length);let Fe=this[F+--X],we=1;for(;X>0&&(we*=256);)Fe+=this[F+--X]*we;return Fe},u.prototype.readUint8=u.prototype.readUInt8=function(F,X){return F=F>>>0,X||me(F,1,this.length),this[F]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(F,X){return F=F>>>0,X||me(F,2,this.length),this[F]|this[F+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(F,X){return F=F>>>0,X||me(F,2,this.length),this[F]<<8|this[F+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(F,X){return F=F>>>0,X||me(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(F,X){return F=F>>>0,X||me(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},u.prototype.readBigUInt64LE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,we=this[++F]+this[++F]*2**8+this[++F]*2**16+ye*2**24;return BigInt(Fe)+(BigInt(we)<<BigInt(32))}),u.prototype.readBigUInt64BE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=X*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],we=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+ye;return(BigInt(Fe)<<BigInt(32))+BigInt(we)}),u.prototype.readIntLE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||me(F,X,this.length);let Fe=this[F],we=1,Ie=0;for(;++Ie<X&&(we*=256);)Fe+=this[F+Ie]*we;return we*=128,Fe>=we&&(Fe-=Math.pow(2,8*X)),Fe},u.prototype.readIntBE=function(F,X,ye){F=F>>>0,X=X>>>0,ye||me(F,X,this.length);let Fe=X,we=1,Ie=this[F+--Fe];for(;Fe>0&&(we*=256);)Ie+=this[F+--Fe]*we;return we*=128,Ie>=we&&(Ie-=Math.pow(2,8*X)),Ie},u.prototype.readInt8=function(F,X){return F=F>>>0,X||me(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},u.prototype.readInt16LE=function(F,X){F=F>>>0,X||me(F,2,this.length);const ye=this[F]|this[F+1]<<8;return ye&32768?ye|4294901760:ye},u.prototype.readInt16BE=function(F,X){F=F>>>0,X||me(F,2,this.length);const ye=this[F+1]|this[F]<<8;return ye&32768?ye|4294901760:ye},u.prototype.readInt32LE=function(F,X){return F=F>>>0,X||me(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},u.prototype.readInt32BE=function(F,X){return F=F>>>0,X||me(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},u.prototype.readBigInt64LE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(ye<<24);return(BigInt(Fe)<<BigInt(32))+BigInt(X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24)}),u.prototype.readBigInt64BE=Lt(function(F){F=F>>>0,Ae(F,"offset");const X=this[F],ye=this[F+7];(X===void 0||ye===void 0)&&le(F,this.length-8);const Fe=(X<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(Fe)<<BigInt(32))+BigInt(this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+ye)}),u.prototype.readFloatLE=function(F,X){return F=F>>>0,X||me(F,4,this.length),n.read(this,F,!0,23,4)},u.prototype.readFloatBE=function(F,X){return F=F>>>0,X||me(F,4,this.length),n.read(this,F,!1,23,4)},u.prototype.readDoubleLE=function(F,X){return F=F>>>0,X||me(F,8,this.length),n.read(this,F,!0,52,8)},u.prototype.readDoubleBE=function(F,X){return F=F>>>0,X||me(F,8,this.length),n.read(this,F,!1,52,8)};function ce(xe,F,X,ye,Fe,we){if(!u.isBuffer(xe))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>Fe||F<we)throw new RangeError('"value" argument is out of bounds');if(X+ye>xe.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,ye=ye>>>0,!Fe){const fe=Math.pow(2,8*ye)-1;ce(this,F,X,ye,fe,0)}let we=1,Ie=0;for(this[X]=F&255;++Ie<ye&&(we*=256);)this[X+Ie]=F/we&255;return X+ye},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,ye=ye>>>0,!Fe){const fe=Math.pow(2,8*ye)-1;ce(this,F,X,ye,fe,0)}let we=ye-1,Ie=1;for(this[X+we]=F&255;--we>=0&&(Ie*=256);)this[X+we]=F/Ie&255;return X+ye},u.prototype.writeUint8=u.prototype.writeUInt8=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,1,255,0),this[X]=F&255,X+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,65535,0),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,65535,0),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,4294967295,0),this[X+3]=F>>>24,this[X+2]=F>>>16,this[X+1]=F>>>8,this[X]=F&255,X+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,4294967295,0),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4};function je(xe,F,X,ye,Fe){ge(F,ye,Fe,xe,X,7);let we=Number(F&BigInt(4294967295));xe[X++]=we,we=we>>8,xe[X++]=we,we=we>>8,xe[X++]=we,we=we>>8,xe[X++]=we;let Ie=Number(F>>BigInt(32)&BigInt(4294967295));return xe[X++]=Ie,Ie=Ie>>8,xe[X++]=Ie,Ie=Ie>>8,xe[X++]=Ie,Ie=Ie>>8,xe[X++]=Ie,X}function De(xe,F,X,ye,Fe){ge(F,ye,Fe,xe,X,7);let we=Number(F&BigInt(4294967295));xe[X+7]=we,we=we>>8,xe[X+6]=we,we=we>>8,xe[X+5]=we,we=we>>8,xe[X+4]=we;let Ie=Number(F>>BigInt(32)&BigInt(4294967295));return xe[X+3]=Ie,Ie=Ie>>8,xe[X+2]=Ie,Ie=Ie>>8,xe[X+1]=Ie,Ie=Ie>>8,xe[X]=Ie,X+8}u.prototype.writeBigUInt64LE=Lt(function(F,X=0){return je(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Lt(function(F,X=0){return De(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,!Fe){const vt=Math.pow(2,8*ye-1);ce(this,F,X,ye,vt-1,-vt)}let we=0,Ie=1,fe=0;for(this[X]=F&255;++we<ye&&(Ie*=256);)F<0&&fe===0&&this[X+we-1]!==0&&(fe=1),this[X+we]=(F/Ie>>0)-fe&255;return X+ye},u.prototype.writeIntBE=function(F,X,ye,Fe){if(F=+F,X=X>>>0,!Fe){const vt=Math.pow(2,8*ye-1);ce(this,F,X,ye,vt-1,-vt)}let we=ye-1,Ie=1,fe=0;for(this[X+we]=F&255;--we>=0&&(Ie*=256);)F<0&&fe===0&&this[X+we+1]!==0&&(fe=1),this[X+we]=(F/Ie>>0)-fe&255;return X+ye},u.prototype.writeInt8=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,1,127,-128),F<0&&(F=255+F+1),this[X]=F&255,X+1},u.prototype.writeInt16LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,32767,-32768),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeInt16BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,2,32767,-32768),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeInt32LE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,2147483647,-2147483648),this[X]=F&255,this[X+1]=F>>>8,this[X+2]=F>>>16,this[X+3]=F>>>24,X+4},u.prototype.writeInt32BE=function(F,X,ye){return F=+F,X=X>>>0,ye||ce(this,F,X,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4},u.prototype.writeBigInt64LE=Lt(function(F,X=0){return je(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Lt(function(F,X=0){return De(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Se(xe,F,X,ye,Fe,we){if(X+ye>xe.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function Ce(xe,F,X,ye,Fe){return F=+F,X=X>>>0,Fe||Se(xe,F,X,4),n.write(xe,F,X,ye,23,4),X+4}u.prototype.writeFloatLE=function(F,X,ye){return Ce(this,F,X,!0,ye)},u.prototype.writeFloatBE=function(F,X,ye){return Ce(this,F,X,!1,ye)};function qe(xe,F,X,ye,Fe){return F=+F,X=X>>>0,Fe||Se(xe,F,X,8),n.write(xe,F,X,ye,52,8),X+8}u.prototype.writeDoubleLE=function(F,X,ye){return qe(this,F,X,!0,ye)},u.prototype.writeDoubleBE=function(F,X,ye){return qe(this,F,X,!1,ye)},u.prototype.copy=function(F,X,ye,Fe){if(!u.isBuffer(F))throw new TypeError("argument should be a Buffer");if(ye||(ye=0),!Fe&&Fe!==0&&(Fe=this.length),X>=F.length&&(X=F.length),X||(X=0),Fe>0&&Fe<ye&&(Fe=ye),Fe===ye||F.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(ye<0||ye>=this.length)throw new RangeError("Index out of range");if(Fe<0)throw new RangeError("sourceEnd out of bounds");Fe>this.length&&(Fe=this.length),F.length-X<Fe-ye&&(Fe=F.length-X+ye);const we=Fe-ye;return this===F&&typeof i.prototype.copyWithin=="function"?this.copyWithin(X,ye,Fe):i.prototype.set.call(F,this.subarray(ye,Fe),X),we},u.prototype.fill=function(F,X,ye,Fe){if(typeof F=="string"){if(typeof X=="string"?(Fe=X,X=0,ye=this.length):typeof ye=="string"&&(Fe=ye,ye=this.length),Fe!==void 0&&typeof Fe!="string")throw new TypeError("encoding must be a string");if(typeof Fe=="string"&&!u.isEncoding(Fe))throw new TypeError("Unknown encoding: "+Fe);if(F.length===1){const Ie=F.charCodeAt(0);(Fe==="utf8"&&Ie<128||Fe==="latin1")&&(F=Ie)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(X<0||this.length<X||this.length<ye)throw new RangeError("Out of range index");if(ye<=X)return this;X=X>>>0,ye=ye===void 0?this.length:ye>>>0,F||(F=0);let we;if(typeof F=="number")for(we=X;we<ye;++we)this[we]=F;else{const Ie=u.isBuffer(F)?F:u.from(F,Fe),fe=Ie.length;if(fe===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(we=0;we<ye-X;++we)this[we+X]=Ie[we%fe]}return this};const Qe={};function We(xe,F,X){Qe[xe]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:F.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${xe}]`,this.stack,delete this.name}get code(){return xe}set code(Fe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Fe,writable:!0})}toString(){return`${this.name} [${xe}]: ${this.message}`}}}We("ERR_BUFFER_OUT_OF_BOUNDS",function(xe){return xe?`${xe} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),We("ERR_INVALID_ARG_TYPE",function(xe,F){return`The "${xe}" argument must be of type number. Received type ${typeof F}`},TypeError),We("ERR_OUT_OF_RANGE",function(xe,F,X){let ye=`The value of "${xe}" is out of range.`,Fe=X;return Number.isInteger(X)&&Math.abs(X)>2**32?Fe=Ne(String(X)):typeof X=="bigint"&&(Fe=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(Fe=Ne(Fe)),Fe+="n"),ye+=` It must be ${F}. Received ${Fe}`,ye},RangeError);function Ne(xe){let F="",X=xe.length;const ye=xe[0]==="-"?1:0;for(;X>=ye+4;X-=3)F=`_${xe.slice(X-3,X)}${F}`;return`${xe.slice(0,X)}${F}`}function K(xe,F,X){Ae(F,"offset"),(xe[F]===void 0||xe[F+X]===void 0)&&le(F,xe.length-(X+1))}function ge(xe,F,X,ye,Fe,we){if(xe>X||xe<F){const Ie=typeof F=="bigint"?"n":"";let fe;throw F===0||F===BigInt(0)?fe=`>= 0${Ie} and < 2${Ie} ** ${(we+1)*8}${Ie}`:fe=`>= -(2${Ie} ** ${(we+1)*8-1}${Ie}) and < 2 ** ${(we+1)*8-1}${Ie}`,new Qe.ERR_OUT_OF_RANGE("value",fe,xe)}K(ye,Fe,we)}function Ae(xe,F){if(typeof xe!="number")throw new Qe.ERR_INVALID_ARG_TYPE(F,"number",xe)}function le(xe,F,X){throw Math.floor(xe)!==xe?(Ae(xe,X),new Qe.ERR_OUT_OF_RANGE("offset","an integer",xe)):F<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${F}`,xe)}const oe=/[^+/0-9A-Za-z-_]/g;function re(xe){if(xe=xe.split("=")[0],xe=xe.trim().replace(oe,""),xe.length<2)return"";for(;xe.length%4!==0;)xe=xe+"=";return xe}function Te(xe,F){F=F||1/0;let X;const ye=xe.length;let Fe=null;const we=[];for(let Ie=0;Ie<ye;++Ie){if(X=xe.charCodeAt(Ie),X>55295&&X<57344){if(!Fe){if(X>56319){(F-=3)>-1&&we.push(239,191,189);continue}else if(Ie+1===ye){(F-=3)>-1&&we.push(239,191,189);continue}Fe=X;continue}if(X<56320){(F-=3)>-1&&we.push(239,191,189),Fe=X;continue}X=(Fe-55296<<10|X-56320)+65536}else Fe&&(F-=3)>-1&&we.push(239,191,189);if(Fe=null,X<128){if((F-=1)<0)break;we.push(X)}else if(X<2048){if((F-=2)<0)break;we.push(X>>6|192,X&63|128)}else if(X<65536){if((F-=3)<0)break;we.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((F-=4)<0)break;we.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return we}function Be(xe){const F=[];for(let X=0;X<xe.length;++X)F.push(xe.charCodeAt(X)&255);return F}function ke(xe,F){let X,ye,Fe;const we=[];for(let Ie=0;Ie<xe.length&&!((F-=2)<0);++Ie)X=xe.charCodeAt(Ie),ye=X>>8,Fe=X%256,we.push(Fe),we.push(ye);return we}function lt(xe){return t.toByteArray(re(xe))}function Rt(xe,F,X,ye){let Fe;for(Fe=0;Fe<ye&&!(Fe+X>=F.length||Fe>=xe.length);++Fe)F[Fe+X]=xe[Fe];return Fe}function ft(xe,F){return xe instanceof F||xe!=null&&xe.constructor!=null&&xe.constructor.name!=null&&xe.constructor.name===F.name}function Pt(xe){return xe!==xe}const qt=function(){const xe="0123456789abcdef",F=new Array(256);for(let X=0;X<16;++X){const ye=X*16;for(let Fe=0;Fe<16;++Fe)F[ye+Fe]=xe[X]+xe[Fe]}return F}();function Lt(xe){return typeof BigInt>"u"?en:xe}function en(){throw new Error("BigInt not supported")}})(WP);const ln=WP.Buffer,Ds=WP.Buffer;var Pp={exports:{}},UB;function yye(){if(UB)return Pp.exports;UB=1;const e=typeof ln<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&ln.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const m of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"constructor")&&Object.prototype.hasOwnProperty.call(m.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.constructor}for(const y in m){const b=m[y];b&&typeof b=="object"&&d.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Pp.exports=i,Pp.exports.default=i,Pp.exports.parse=i,Pp.exports.safeParse=a,Pp.exports.scan=s,Pp.exports}var bye=yye();const GP=Sa(bye);var vye={};function Vs(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function xye(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function wye(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function uG(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,m=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,m)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=_ye(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function _ye(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function By(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Lm=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=lye(n,t);if(e==null)return s;if(n.includes(r))throw new zH({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},ia=Lm();function Sye(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function Cye(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function A2(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function KP({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new NS({message:`${r} API key must be a string.`});if(typeof Ni>"u")throw new NS({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=vye[t],e==null)throw new NS({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new NS({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var fC=Symbol.for("vercel.ai.validator");function kye(e){return{[fC]:!0,validate:e}}function Eye(e){return typeof e=="object"&&e!==null&&fC in e&&e[fC]===!0&&"validate"in e}function Tye(e){return Eye(e)?e:Aye(e)}function Aye(e){return kye(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function Rye({value:e,schema:t}){const n=$y({value:e,schema:t});if(!n.success)throw dC.wrap({value:e,cause:n.error});return n.value}function $y({value:e,schema:t}){const n=Tye(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:dC.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:dC.wrap({value:e,cause:r})}}}function Nye({text:e,schema:t}){try{const n=GP.parse(e);return t==null?n:Rye({value:n,schema:t})}catch(n){throw uC.isInstance(n)||dC.isInstance(n)?n:new uC({text:e,cause:n})}}function vm({text:e,schema:t}){try{const n=GP.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=$y({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:uC.isInstance(n)?n:new uC({text:e,cause:n})}}}function um(e){try{return GP.parse(e),!0}catch{return!1}}function SE({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=$y({value:t[e],schema:n});if(!r.success)throw new zH({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var Mye=()=>globalThis.fetch,Ws=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>dG({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),Iye=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>dG({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),dG=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=Mye()})=>{try{const o=await a(e,{method:"POST",headers:Cye(t),body:n.content,signal:i}),l=By(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw A2(u)||zl.isInstance(u)?u:new zl({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(A2(c)||zl.isInstance(c))?c:new zl({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(A2(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new zl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function ij(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var Bh=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=By(r);if(a.trim()==="")return{responseHeaders:o,value:new zl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=Nye({text:a,schema:e});return{responseHeaders:o,value:new zl({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new zl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},$h=e=>async({response:t})=>{const n=By(t);if(t.body==null)throw new FH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(uG()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(vm({text:r,schema:e}))}}))}},$a=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=vm({text:s,schema:e}),a=By(t);if(!i.success)throw new zl({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},jye=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=By(e);if(!e.body)throw new zl({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new zl({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:Pye,atob:Oye}=globalThis;function CE(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=Oye(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Nu(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return Pye(t)}function m1(e){return e==null?void 0:e.replace(/\/$/,"")}var Qr;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Qr||(Qr={}));var qB;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(qB||(qB={}));const bn=Qr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),rh=e=>{switch(typeof e){case"undefined":return bn.undefined;case"string":return bn.string;case"number":return Number.isNaN(e)?bn.nan:bn.number;case"boolean":return bn.boolean;case"function":return bn.function;case"bigint":return bn.bigint;case"symbol":return bn.symbol;case"object":return Array.isArray(e)?bn.array:e===null?bn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?bn.promise:typeof Map<"u"&&e instanceof Map?bn.map:typeof Set<"u"&&e instanceof Set?bn.set:typeof Date<"u"&&e instanceof Date?bn.date:bn.object;default:return bn.unknown}},Zt=Qr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Ac extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Ac))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Ac.create=e=>new Ac(e);const aj=(e,t)=>{let n;switch(e.code){case Zt.invalid_type:e.received===bn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Zt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Qr.jsonStringifyReplacer)}`;break;case Zt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Qr.joinValues(e.keys,", ")}`;break;case Zt.invalid_union:n="Invalid input";break;case Zt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Qr.joinValues(e.options)}`;break;case Zt.invalid_enum_value:n=`Invalid enum value. Expected ${Qr.joinValues(e.options)}, received '${e.received}'`;break;case Zt.invalid_arguments:n="Invalid function arguments";break;case Zt.invalid_return_type:n="Invalid function return type";break;case Zt.invalid_date:n="Invalid date";break;case Zt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Qr.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Zt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Zt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Zt.custom:n="Invalid input";break;case Zt.invalid_intersection_types:n="Intersection results could not be merged";break;case Zt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Zt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Qr.assertNever(e)}return{message:n}};let Dye=aj;function Fye(){return Dye}const Lye=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function fn(e,t){const n=Fye(),r=Lye({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===aj?void 0:aj].filter(s=>!!s)});e.common.issues.push(r)}class io{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return ur;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return io.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return ur;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const ur=Object.freeze({status:"aborted"}),ex=e=>({status:"dirty",value:e}),Zl=e=>({status:"valid",value:e}),VB=e=>e.status==="aborted",WB=e=>e.status==="dirty",Q0=e=>e.status==="valid",hC=e=>typeof Promise<"u"&&e instanceof Promise;var Tn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Tn||(Tn={}));class Mu{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const HB=(e,t)=>{if(Q0(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Ac(e.common.issues);return this._error=n,this._error}}};function Ar(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Ur{get description(){return this._def.description}_getType(t){return rh(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:rh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new io,ctx:{common:t.parent.common,data:t.data,parsedType:rh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(hC(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:rh(t)},s=this._parseSync({data:t,path:r.path,parent:r});return HB(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:rh(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return Q0(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>Q0(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:rh(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(hC(s)?s:Promise.resolve(s));return HB(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Zt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new _m({schema:this,typeName:Qt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return _u.create(this,this._def)}nullable(){return Sm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return wu.create(this)}promise(){return xC.create(this,this._def)}or(t){return mC.create([this,t],this._def)}and(t){return gC.create(this,t,this._def)}transform(t){return new _m({...Ar(this._def),schema:this,typeName:Qt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new wC({...Ar(this._def),innerType:this,defaultValue:n,typeName:Qt.ZodDefault})}brand(){return new mG({typeName:Qt.ZodBranded,type:this,...Ar(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new _C({...Ar(this._def),innerType:this,catchValue:n,typeName:Qt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return ZP.create(this,t)}readonly(){return SC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Bye=/^c[^\s-]{8,}$/i,$ye=/^[0-9a-z]+$/,zye=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Uye=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,qye=/^[a-z0-9_-]{21}$/i,Vye=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Wye=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Hye=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Gye="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let vN;const Kye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Yye=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Zye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Xye=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Jye=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Qye=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,fG="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ebe=new RegExp(`^${fG}$`);function hG(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function tbe(e){return new RegExp(`^${hG(e)}$`)}function nbe(e){let t=`${fG}T${hG(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function rbe(e,t){return!!((t==="v4"||!t)&&Kye.test(e)||(t==="v6"||!t)&&Zye.test(e))}function sbe(e,t){if(!Vye.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function ibe(e,t){return!!((t==="v4"||!t)&&Yye.test(e)||(t==="v6"||!t)&&Xye.test(e))}class Td extends Ur{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==bn.string){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:bn.string,received:i.parsedType}),ur}const r=new io;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?fn(s,{code:Zt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&fn(s,{code:Zt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Hye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"email",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")vN||(vN=new RegExp(Gye,"u")),vN.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"emoji",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Uye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"uuid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")qye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"nanoid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Bye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")$ye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cuid2",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")zye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ulid",code:Zt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),fn(s,{validation:"url",code:Zt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"regex",code:Zt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?nbe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?ebe.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?tbe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?Wye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"duration",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?rbe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"ip",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?sbe(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"jwt",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?ibe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"cidr",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?Jye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64",code:Zt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?Qye.test(t.data)||(s=this._getOrReturnCtx(t,s),fn(s,{validation:"base64url",code:Zt.invalid_string,message:i.message}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Zt.invalid_string,...Tn.errToObj(r)})}_addCheck(t){return new Td({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Tn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Tn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Tn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Tn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Tn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Tn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Tn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Tn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Tn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Tn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Tn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Tn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Tn.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Tn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Tn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Tn.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Tn.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Tn.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Tn.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Tn.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Tn.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Tn.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Tn.errToObj(n)})}nonempty(t){return this.min(1,Tn.errToObj(t))}trim(){return new Td({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Td({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Td({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Td.create=e=>new Td({checks:[],typeName:Qt.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Ar(e)});function abe(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class ey extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==bn.number){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:bn.number,received:i.parsedType}),ur}let r;const s=new io;for(const i of this._def.checks)i.kind==="int"?Qr.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?abe(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_finite,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Tn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Tn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Tn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Tn.toString(n))}setLimit(t,n,r,s){return new ey({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Tn.toString(s)}]})}_addCheck(t){return new ey({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Tn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Tn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Tn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Tn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Tn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Tn.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Tn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Tn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Tn.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Qr.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}ey.create=e=>new ey({checks:[],typeName:Qt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Ar(e)});class Zx extends Ur{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==bn.bigint)return this._getInvalidInput(t);let r;const s=new io;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),fn(r,{code:Zt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Qr.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Zt.invalid_type,expected:bn.bigint,received:n.parsedType}),ur}gte(t,n){return this.setLimit("min",t,!0,Tn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Tn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Tn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Tn.toString(n))}setLimit(t,n,r,s){return new Zx({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Tn.toString(s)}]})}_addCheck(t){return new Zx({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Tn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Tn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Tn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Tn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Tn.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Zx.create=e=>new Zx({checks:[],typeName:Qt.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Ar(e)});class oj extends Ur{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==bn.boolean){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:bn.boolean,received:r.parsedType}),ur}return Zl(t.data)}}oj.create=e=>new oj({typeName:Qt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Ar(e)});class Xx extends Ur{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==bn.date){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_type,expected:bn.date,received:i.parsedType}),ur}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return fn(i,{code:Zt.invalid_date}),ur}const r=new io;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),fn(s,{code:Zt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Qr.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Xx({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Tn.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Tn.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}Xx.create=e=>new Xx({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Qt.ZodDate,...Ar(e)});class GB extends Ur{_parse(t){if(this._getType(t)!==bn.symbol){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:bn.symbol,received:r.parsedType}),ur}return Zl(t.data)}}GB.create=e=>new GB({typeName:Qt.ZodSymbol,...Ar(e)});class lj extends Ur{_parse(t){if(this._getType(t)!==bn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:bn.undefined,received:r.parsedType}),ur}return Zl(t.data)}}lj.create=e=>new lj({typeName:Qt.ZodUndefined,...Ar(e)});class pC extends Ur{_parse(t){if(this._getType(t)!==bn.null){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:bn.null,received:r.parsedType}),ur}return Zl(t.data)}}pC.create=e=>new pC({typeName:Qt.ZodNull,...Ar(e)});class Jx extends Ur{constructor(){super(...arguments),this._any=!0}_parse(t){return Zl(t.data)}}Jx.create=e=>new Jx({typeName:Qt.ZodAny,...Ar(e)});class cj extends Ur{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Zl(t.data)}}cj.create=e=>new cj({typeName:Qt.ZodUnknown,...Ar(e)});class yh extends Ur{_parse(t){const n=this._getOrReturnCtx(t);return fn(n,{code:Zt.invalid_type,expected:bn.never,received:n.parsedType}),ur}}yh.create=e=>new yh({typeName:Qt.ZodNever,...Ar(e)});class KB extends Ur{_parse(t){if(this._getType(t)!==bn.undefined){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:bn.void,received:r.parsedType}),ur}return Zl(t.data)}}KB.create=e=>new KB({typeName:Qt.ZodVoid,...Ar(e)});class wu extends Ur{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==bn.array)return fn(n,{code:Zt.invalid_type,expected:bn.array,received:n.parsedType}),ur;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(fn(n,{code:a?Zt.too_big:Zt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(fn(n,{code:Zt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(fn(n,{code:Zt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new Mu(n,a,n.path,o)))).then(a=>io.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new Mu(n,a,n.path,o)));return io.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new wu({...this._def,minLength:{value:t,message:Tn.toString(n)}})}max(t,n){return new wu({...this._def,maxLength:{value:t,message:Tn.toString(n)}})}length(t,n){return new wu({...this._def,exactLength:{value:t,message:Tn.toString(n)}})}nonempty(t){return this.min(1,t)}}wu.create=(e,t)=>new wu({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Qt.ZodArray,...Ar(t)});function l0(e){if(e instanceof Ai){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=_u.create(l0(r))}return new Ai({...e._def,shape:()=>t})}else return e instanceof wu?new wu({...e._def,type:l0(e.element)}):e instanceof _u?_u.create(l0(e.unwrap())):e instanceof Sm?Sm.create(l0(e.unwrap())):e instanceof xm?xm.create(e.items.map(t=>l0(t))):e}class Ai extends Ur{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Qr.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==bn.object){const c=this._getOrReturnCtx(t);return fn(c,{code:Zt.invalid_type,expected:bn.object,received:c.parsedType}),ur}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof yh&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Mu(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof yh){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(fn(s,{code:Zt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Mu(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>io.mergeObjectSync(r,c)):io.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return Tn.errToObj,new Ai({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Tn.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Ai({...this._def,unknownKeys:"strip"})}passthrough(){return new Ai({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ai({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ai({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Qt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ai({...this._def,catchall:t})}pick(t){const n={};for(const r of Qr.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Ai({...this._def,shape:()=>n})}omit(t){const n={};for(const r of Qr.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Ai({...this._def,shape:()=>n})}deepPartial(){return l0(this)}partial(t){const n={};for(const r of Qr.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Ai({...this._def,shape:()=>n})}required(t){const n={};for(const r of Qr.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof _u;)i=i._def.innerType;n[r]=i}return new Ai({...this._def,shape:()=>n})}keyof(){return pG(Qr.objectKeys(this.shape))}}Ai.create=(e,t)=>new Ai({shape:()=>e,unknownKeys:"strip",catchall:yh.create(),typeName:Qt.ZodObject,...Ar(t)});Ai.strictCreate=(e,t)=>new Ai({shape:()=>e,unknownKeys:"strict",catchall:yh.create(),typeName:Qt.ZodObject,...Ar(t)});Ai.lazycreate=(e,t)=>new Ai({shape:e,unknownKeys:"strip",catchall:yh.create(),typeName:Qt.ZodObject,...Ar(t)});class mC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Ac(o.ctx.common.issues));return fn(n,{code:Zt.invalid_union,unionErrors:a}),ur}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Ac(l));return fn(n,{code:Zt.invalid_union,unionErrors:o}),ur}}get options(){return this._def.options}}mC.create=(e,t)=>new mC({options:e,typeName:Qt.ZodUnion,...Ar(t)});const vd=e=>e instanceof bC?vd(e.schema):e instanceof _m?vd(e.innerType()):e instanceof vC?[e.value]:e instanceof wm?e.options:e instanceof dj?Qr.objectValues(e.enum):e instanceof wC?vd(e._def.innerType):e instanceof lj?[void 0]:e instanceof pC?[null]:e instanceof _u?[void 0,...vd(e.unwrap())]:e instanceof Sm?[null,...vd(e.unwrap())]:e instanceof mG||e instanceof SC?vd(e.unwrap()):e instanceof _C?vd(e._def.innerType):[];class YP extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==bn.object)return fn(n,{code:Zt.invalid_type,expected:bn.object,received:n.parsedType}),ur;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(fn(n,{code:Zt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ur)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=vd(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new YP({typeName:Qt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Ar(r)})}}function uj(e,t){const n=rh(e),r=rh(t);if(e===t)return{valid:!0,data:e};if(n===bn.object&&r===bn.object){const s=Qr.objectKeys(t),i=Qr.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=uj(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===bn.array&&r===bn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=uj(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===bn.date&&r===bn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class gC extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(VB(i)||VB(a))return ur;const o=uj(i.value,a.value);return o.valid?((WB(i)||WB(a))&&n.dirty(),{status:n.value,value:o.data}):(fn(r,{code:Zt.invalid_intersection_types}),ur)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}gC.create=(e,t,n)=>new gC({left:e,right:t,typeName:Qt.ZodIntersection,...Ar(n)});class xm extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.array)return fn(r,{code:Zt.invalid_type,expected:bn.array,received:r.parsedType}),ur;if(r.data.length<this._def.items.length)return fn(r,{code:Zt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ur;!this._def.rest&&r.data.length>this._def.items.length&&(fn(r,{code:Zt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Mu(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>io.mergeArray(n,a)):io.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new xm({...this._def,rest:t})}}xm.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new xm({items:e,typeName:Qt.ZodTuple,rest:null,...Ar(t)})};class yC extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.object)return fn(r,{code:Zt.invalid_type,expected:bn.object,received:r.parsedType}),ur;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new Mu(r,o,r.path,o)),value:a._parse(new Mu(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?io.mergeObjectAsync(n,s):io.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Ur?new yC({keyType:t,valueType:n,typeName:Qt.ZodRecord,...Ar(r)}):new yC({keyType:Td.create(),valueType:t,typeName:Qt.ZodRecord,...Ar(n)})}}class YB extends Ur{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.map)return fn(r,{code:Zt.invalid_type,expected:bn.map,received:r.parsedType}),ur;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new Mu(r,o,r.path,[c,"key"])),value:i._parse(new Mu(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return ur;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return ur;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}YB.create=(e,t,n)=>new YB({valueType:t,keyType:e,typeName:Qt.ZodMap,...Ar(n)});class Qx extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==bn.set)return fn(r,{code:Zt.invalid_type,expected:bn.set,received:r.parsedType}),ur;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(fn(r,{code:Zt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(fn(r,{code:Zt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return ur;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new Mu(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new Qx({...this._def,minSize:{value:t,message:Tn.toString(n)}})}max(t,n){return new Qx({...this._def,maxSize:{value:t,message:Tn.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Qx.create=(e,t)=>new Qx({valueType:e,minSize:null,maxSize:null,typeName:Qt.ZodSet,...Ar(t)});class bC extends Ur{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}bC.create=(e,t)=>new bC({getter:e,typeName:Qt.ZodLazy,...Ar(t)});class vC extends Ur{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return fn(n,{received:n.data,code:Zt.invalid_literal,expected:this._def.value}),ur}return{status:"valid",value:t.data}}get value(){return this._def.value}}vC.create=(e,t)=>new vC({value:e,typeName:Qt.ZodLiteral,...Ar(t)});function pG(e,t){return new wm({values:e,typeName:Qt.ZodEnum,...Ar(t)})}class wm extends Ur{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{expected:Qr.joinValues(r),received:n.parsedType,code:Zt.invalid_type}),ur}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return fn(n,{received:n.data,code:Zt.invalid_enum_value,options:r}),ur}return Zl(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return wm.create(t,{...this._def,...n})}exclude(t,n=this._def){return wm.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}wm.create=pG;class dj extends Ur{_parse(t){const n=Qr.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==bn.string&&r.parsedType!==bn.number){const s=Qr.objectValues(n);return fn(r,{expected:Qr.joinValues(s),received:r.parsedType,code:Zt.invalid_type}),ur}if(this._cache||(this._cache=new Set(Qr.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=Qr.objectValues(n);return fn(r,{received:r.data,code:Zt.invalid_enum_value,options:s}),ur}return Zl(t.data)}get enum(){return this._def.values}}dj.create=(e,t)=>new dj({values:e,typeName:Qt.ZodNativeEnum,...Ar(t)});class xC extends Ur{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==bn.promise&&n.common.async===!1)return fn(n,{code:Zt.invalid_type,expected:bn.promise,received:n.parsedType}),ur;const r=n.parsedType===bn.promise?n.data:Promise.resolve(n.data);return Zl(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}xC.create=(e,t)=>new xC({type:e,typeName:Qt.ZodPromise,...Ar(t)});class _m extends Ur{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Qt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{fn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return ur;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?ur:l.status==="dirty"||n.value==="dirty"?ex(l.value):l});{if(n.value==="aborted")return ur;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?ur:o.status==="dirty"||n.value==="dirty"?ex(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?ur:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?ur:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Q0(a))return ur;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Q0(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):ur);Qr.assertNever(s)}}_m.create=(e,t,n)=>new _m({schema:e,typeName:Qt.ZodEffects,effect:t,...Ar(n)});_m.createWithPreprocess=(e,t,n)=>new _m({schema:t,effect:{type:"preprocess",transform:e},typeName:Qt.ZodEffects,...Ar(n)});class _u extends Ur{_parse(t){return this._getType(t)===bn.undefined?Zl(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_u.create=(e,t)=>new _u({innerType:e,typeName:Qt.ZodOptional,...Ar(t)});class Sm extends Ur{_parse(t){return this._getType(t)===bn.null?Zl(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Sm.create=(e,t)=>new Sm({innerType:e,typeName:Qt.ZodNullable,...Ar(t)});class wC extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===bn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}wC.create=(e,t)=>new wC({innerType:e,typeName:Qt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Ar(t)});class _C extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return hC(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ac(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ac(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}_C.create=(e,t)=>new _C({innerType:e,typeName:Qt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Ar(t)});class ZB extends Ur{_parse(t){if(this._getType(t)!==bn.nan){const r=this._getOrReturnCtx(t);return fn(r,{code:Zt.invalid_type,expected:bn.nan,received:r.parsedType}),ur}return{status:"valid",value:t.data}}}ZB.create=e=>new ZB({typeName:Qt.ZodNaN,...Ar(e)});class mG extends Ur{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class ZP extends Ur{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ur:i.status==="dirty"?(n.dirty(),ex(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?ur:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new ZP({in:t,out:n,typeName:Qt.ZodPipeline})}}class SC extends Ur{_parse(t){const n=this._def.innerType._parse(t),r=s=>(Q0(s)&&(s.value=Object.freeze(s.value)),s);return hC(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}SC.create=(e,t)=>new SC({innerType:e,typeName:Qt.ZodReadonly,...Ar(t)});function XB(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function gG(e,t={},n){return e?Jx.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=XB(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=XB(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):Jx.create()}var Qt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Qt||(Qt={}));const CC=(e,t={message:`Input not instance of ${e.name}`})=>gG(n=>n instanceof e,t),$e=Td.create,Tt=ey.create,Gn=oj.create,obe=Xx.create,lbe=pC.create,qd=Jx.create,zy=cj.create;yh.create;const on=wu.create,Ge=Ai.create,ps=mC.create,kE=YP.create;gC.create;xm.create;const bh=yC.create,cbe=bC.create,Rn=vC.create,yl=wm.create;xC.create;const ra=_u.create;Sm.create;function ube({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Nu(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new pr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new pr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new pr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function JB(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function kC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var XP=Ge({error:Ge({message:$e(),type:$e().nullish(),param:qd().nullish(),code:ps([$e(),Tt()]).nullish()})}),Iu=Bh({errorSchema:XP,errorToMessage:e=>e.error.message});function EC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function dbe({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new pr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new pr({functionality:`Unsupported tool choice type: ${c}`})}}}var fbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:fj(this.modelId)}get defaultObjectGenerationMode(){return mbe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y,b,v,x,w,S;const k=e.type,C=[];i!=null&&C.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&C.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const R=this.settings.useLegacyFunctionCalling;if(R&&this.settings.parallelToolCalls===!0)throw new pr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(R&&this.supportsStructuredOutputs)throw new pr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:A,warnings:N}=ube({prompt:t,useLegacyFunctionCalling:R,systemMessageMode:gbe(this.modelId)});C.push(...N);const I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(m=d==null?void 0:d.openai)==null?void 0:m.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:A};switch(fj(this.modelId)?(I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,C.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),I.frequency_penalty!=null&&(I.frequency_penalty=void 0,C.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),I.presence_penalty!=null&&(I.presence_penalty=void 0,C.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),I.logit_bias!=null&&(I.logit_bias=void 0,C.push({type:"other",message:"logitBias is not supported for reasoning models"})),I.logprobs!=null&&(I.logprobs=void 0,C.push({type:"other",message:"logprobs is not supported for reasoning models"})),I.top_logprobs!=null&&(I.top_logprobs=void 0,C.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),I.max_tokens!=null&&(I.max_completion_tokens==null&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),k){case"regular":{const{tools:O,tool_choice:B,functions:D,function_call:W,toolWarnings:P}=dbe({mode:e,useLegacyFunctionCalling:R,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:O,tool_choice:B,functions:D,function_call:W},warnings:[...C,...P]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:C};case"object-tool":return{args:R?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:C};default:{const O=k;throw new Error(`Unsupported type: ${O}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:m}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:c,failedResponseHandler:Iu,successfulResponseHandler:$a(hbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(S.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(S.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:ia(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(k=>{var C;return{toolCallType:"function",toolCallId:(C=k.id)!=null?C:ia(),toolName:k.function.name,args:k.function.arguments}}),finishReason:kC(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(c)},response:EC(h),warnings:u,logprobs:JB(v.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:Iu,successfulResponseHandler:$h(pbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:m}=this.settings,y={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,R,A,N,I,O,B,D;if(!b.success){c="error",v.enqueue({type:"error",error:b.error});return}const W=b.value;if("error"in W){c="error",v.enqueue({type:"error",error:W.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...EC(W)})),W.usage!=null){const{prompt_tokens:L,completion_tokens:ne,prompt_tokens_details:V,completion_tokens_details:Q}=W.usage;u={promptTokens:L??void 0,completionTokens:ne??void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(y.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(V==null?void 0:V.cached_tokens)!=null&&(y.openai.cachedPromptTokens=V==null?void 0:V.cached_tokens)}const P=W.choices[0];if((P==null?void 0:P.finish_reason)!=null&&(c=kC(P.finish_reason)),(P==null?void 0:P.delta)==null)return;const Z=P.delta;Z.content!=null&&v.enqueue({type:"text-delta",textDelta:Z.content});const U=JB(P==null?void 0:P.logprobs);U!=null&&U.length&&(d===void 0&&(d=[]),d.push(...U));const H=m&&Z.function_call!=null?[{type:"function",id:ia(),function:Z.function_call,index:0}]:Z.tool_calls;if(H!=null)for(const L of H){const ne=L.index;if(l[ne]==null){if(L.type!=="function")throw new jd({data:L,message:"Expected 'function' type."});if(L.id==null)throw new jd({data:L,message:"Expected 'id' to be a string."});if(((x=L.function)==null?void 0:x.name)==null)throw new jd({data:L,message:"Expected 'function.name' to be a string."});l[ne]={id:L.id,type:"function",function:{name:L.function.name,arguments:(w=L.function.arguments)!=null?w:""},hasFinished:!1};const Q=l[ne];((S=Q.function)==null?void 0:S.name)!=null&&((k=Q.function)==null?void 0:k.arguments)!=null&&(Q.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),um(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=Q.id)!=null?C:ia(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=!0));continue}const V=l[ne];V.hasFinished||(((R=L.function)==null?void 0:R.arguments)!=null&&(V.function.arguments+=(N=(A=L.function)==null?void 0:A.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:V.id,toolName:V.function.name,argsTextDelta:(I=L.function.arguments)!=null?I:""}),((O=V.function)==null?void 0:O.name)!=null&&((B=V.function)==null?void 0:B.arguments)!=null&&um(V.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=V.id)!=null?D:ia(),toolName:V.function.name,args:V.function.arguments}),V.hasFinished=!0))}},flush(b){var v,x;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},yG=Ge({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ge({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ge({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),hbe=Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({message:Ge({role:Rn("assistant").nullish(),content:$e().nullish(),function_call:Ge({arguments:$e(),name:$e()}).nullish(),tool_calls:on(Ge({id:$e().nullish(),type:Rn("function"),function:Ge({name:$e(),arguments:$e()})})).nullish()}),index:Tt(),logprobs:Ge({content:on(Ge({token:$e(),logprob:Tt(),top_logprobs:on(Ge({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish()})),usage:yG}),pbe=ps([Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({delta:Ge({role:yl(["assistant"]).nullish(),content:$e().nullish(),function_call:Ge({name:$e().optional(),arguments:$e().optional()}).nullish(),tool_calls:on(Ge({index:Tt(),id:$e().nullish(),type:Rn("function").nullish(),function:Ge({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ge({content:on(Ge({token:$e(),logprob:Tt(),top_logprobs:on(Ge({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullish(),index:Tt()})),usage:yG}),XP]);function fj(e){return e.startsWith("o")}function mbe(e){return e.startsWith("gpt-4o-audio-preview")}function gbe(e){var t,n;return fj(e)?(n=(t=ybe[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var ybe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function bbe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new pc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new pr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function QB(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var vbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const m=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:v}=bbe({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:x.length>0?x:void 0};switch(m){case"regular":{if((h=e.tools)!=null&&h.length)throw new pr({functionality:"tools"});if(e.toolChoice)throw new pr({functionality:"toolChoice"});return{args:w,warnings:y}}case"object-json":throw new pr({functionality:"object-json mode"});case"object-tool":throw new pr({functionality:"object-tool mode"});default:{const S=m;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:t,failedResponseHandler:Iu,successfulResponseHandler:$a(xbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:kC(l.finish_reason),logprobs:QB(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:EC(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:Iu,successfulResponseHandler:$h(wbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,m){if(!h.success){l="error",m.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",m.enqueue({type:"error",error:y.error});return}d&&(d=!1,m.enqueue({type:"response-metadata",...EC(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=kC(b.finish_reason)),(b==null?void 0:b.text)!=null&&m.enqueue({type:"text-delta",textDelta:b.text});const v=QB(b==null?void 0:b.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},xbe=Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({text:$e(),finish_reason:$e(),logprobs:Ge({tokens:on($e()),token_logprobs:on(Tt()),top_logprobs:on(bh($e(),Tt())).nullable()}).nullish()})),usage:Ge({prompt_tokens:Tt(),completion_tokens:Tt()})}),wbe=ps([Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({text:$e(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ge({tokens:on($e()),token_logprobs:on(Tt()),top_logprobs:on(bh($e(),Tt())).nullable()}).nullish()})),usage:Ge({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),XP]),_be=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new wE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Ws({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Vs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Iu,successfulResponseHandler:$a(Sbe),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},Sbe=Ge({data:on(Ge({embedding:on(Tt())})),usage:Ge({prompt_tokens:Tt()}).nullish()}),Cbe={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},kbe=new Set(["gpt-image-1"]),Ebe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:Cbe[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const m=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await Ws({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Vs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...kbe.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:Iu,successfulResponseHandler:$a(Tbe),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(v=>v.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:b}}}},Tbe=Ge({data:on(Ge({b64_json:$e()}))}),Abe=Ge({include:on($e()).nullish(),language:$e().nullish(),prompt:$e().nullish(),temperature:Tt().min(0).max(1).nullish().default(0),timestampGranularities:on(yl(["word","segment"])).nullish().default(["segment"])}),e$={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},Rbe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=SE({provider:"openai",providerOptions:n,schema:Abe}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([CE(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const m in h){const y=h[m];y!==void 0&&u.append(m,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await Iye({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),formData:l,failedResponseHandler:Iu,successfulResponseHandler:$a(Nbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u.language!=null&&u.language in e$?e$[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?i:[],language:m,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},Nbe=Ge({text:$e(),language:$e().nullish(),duration:Tt().nullish(),words:on(Ge({word:$e(),start:Tt(),end:Tt()})).nullish()});function Mbe({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Nu(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new pr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new pr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function t$({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function Ibe({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new pr({functionality:`Unsupported tool choice type: ${l}`})}}}var jbe=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,m,y;const b=[],v=Xbe(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:S}=Mbe({prompt:c,systemMessageMode:v.systemMessageMode});b.push(...S);const k=SE({provider:"openai",providerOptions:u,schema:Jbe}),C=(h=k==null?void 0:k.strictSchemas)!=null?h:!0,R={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:C,name:(m=d.name)!=null?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:k==null?void 0:k.metadata,parallel_tool_calls:k==null?void 0:k.parallelToolCalls,previous_response_id:k==null?void 0:k.previousResponseId,store:k==null?void 0:k.store,user:k==null?void 0:k.user,instructions:k==null?void 0:k.instructions,...v.isReasoningModel&&((k==null?void 0:k.reasoningEffort)!=null||(k==null?void 0:k.reasoningSummary)!=null)&&{reasoning:{...(k==null?void 0:k.reasoningEffort)!=null&&{effort:k.reasoningEffort},...(k==null?void 0:k.reasoningSummary)!=null&&{summary:k.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(R.temperature!=null&&(R.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),R.top_p!=null&&(R.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:A,tool_choice:N,toolWarnings:I}=Ibe({mode:e,strict:C});return{args:{...R,tools:A,tool_choice:N},warnings:[...b,...I]}}case"object-json":return{args:{...R,text:{format:e.schema!=null?{type:"json_schema",strict:C,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...R,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:C}]},warnings:b};default:{const A=x;throw new Error(`Unsupported type: ${A}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await Ws({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:l,failedResponseHandler:Iu,successfulResponseHandler:$a(Ge({id:$e(),created_at:Tt(),model:$e(),output:on(kE("type",[Ge({type:Rn("message"),role:Rn("assistant"),content:on(Ge({type:Rn("output_text"),text:$e(),annotations:on(Ge({type:Rn("url_citation"),start_index:Tt(),end_index:Tt(),url:$e(),title:$e()}))}))}),Ge({type:Rn("function_call"),call_id:$e(),name:$e(),arguments:$e()}),Ge({type:Rn("web_search_call")}),Ge({type:Rn("computer_call")}),Ge({type:Rn("reasoning"),summary:on(Ge({type:Rn("summary_text"),text:$e()}))})])),incomplete_details:Ge({reason:$e()}).nullable(),usage:bG})),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),y=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),b=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:m.map(v=>v.text).join(`
`),sources:m.flatMap(v=>v.annotations.map(x=>{var w,S,k;return{sourceType:"url",id:(k=(S=(w=this.config).generateId)==null?void 0:S.call(w))!=null?k:ia(),url:x.url,title:x.title}})),finishReason:t$({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Ws({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:Iu,successfulResponseHandler:$h(Ube),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let m=!1;return{stream:s.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,k,C,R,A;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const N=y.value;if(Kbe(N))N.item.type==="function_call"&&(h[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(Gbe(N)){const I=h[N.output_index];I!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:N.delta})}else Hbe(N)?(d=N.response.id,b.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):qbe(N)?b.enqueue({type:"text-delta",textDelta:N.delta}):Zbe(N)?b.enqueue({type:"reasoning",textDelta:N.delta}):Vbe(N)&&N.item.type==="function_call"?(h[N.output_index]=void 0,m=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):Wbe(N)?(a=t$({finishReason:(v=N.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:m}),o=N.response.usage.input_tokens,l=N.response.usage.output_tokens,c=(w=(x=N.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(k=(S=N.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?k:u):Ybe(N)&&b.enqueue({type:"source",source:{sourceType:"url",id:(A=(R=(C=i.config).generateId)==null?void 0:R.call(C))!=null?A:ia(),url:N.annotation.url,title:N.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},bG=Ge({input_tokens:Tt(),input_tokens_details:Ge({cached_tokens:Tt().nullish()}).nullish(),output_tokens:Tt(),output_tokens_details:Ge({reasoning_tokens:Tt().nullish()}).nullish()}),Pbe=Ge({type:Rn("response.output_text.delta"),delta:$e()}),Obe=Ge({type:yl(["response.completed","response.incomplete"]),response:Ge({incomplete_details:Ge({reason:$e()}).nullish(),usage:bG})}),Dbe=Ge({type:Rn("response.created"),response:Ge({id:$e(),created_at:Tt(),model:$e()})}),Fbe=Ge({type:Rn("response.output_item.done"),output_index:Tt(),item:kE("type",[Ge({type:Rn("message")}),Ge({type:Rn("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e(),status:Rn("completed")})])}),Lbe=Ge({type:Rn("response.function_call_arguments.delta"),item_id:$e(),output_index:Tt(),delta:$e()}),Bbe=Ge({type:Rn("response.output_item.added"),output_index:Tt(),item:kE("type",[Ge({type:Rn("message")}),Ge({type:Rn("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e()})])}),$be=Ge({type:Rn("response.output_text.annotation.added"),annotation:Ge({type:Rn("url_citation"),url:$e(),title:$e()})}),zbe=Ge({type:Rn("response.reasoning_summary_text.delta"),item_id:$e(),output_index:Tt(),summary_index:Tt(),delta:$e()}),Ube=ps([Pbe,Obe,Dbe,Fbe,Lbe,Bbe,$be,zbe,Ge({type:$e()}).passthrough()]);function qbe(e){return e.type==="response.output_text.delta"}function Vbe(e){return e.type==="response.output_item.done"}function Wbe(e){return e.type==="response.completed"||e.type==="response.incomplete"}function Hbe(e){return e.type==="response.created"}function Gbe(e){return e.type==="response.function_call_arguments.delta"}function Kbe(e){return e.type==="response.output_item.added"}function Ybe(e){return e.type==="response.output_text.annotation.added"}function Zbe(e){return e.type==="response.reasoning_summary_text.delta"}function Xbe(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var Jbe=Ge({metadata:qd().nullish(),parallelToolCalls:Gn().nullish(),previousResponseId:$e().nullish(),store:Gn().nullish(),user:$e().nullish(),reasoningEffort:$e().nullish(),strictSchemas:Gn().nullish(),instructions:$e().nullish(),reasoningSummary:$e().nullish()}),Qbe=Ge({});function eve({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:Qbe}}var tve={webSearchPreview:eve},nve=Ge({instructions:$e().nullish(),speed:Tt().min(.25).max(4).default(1).nullish()}),rve=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=SE({provider:"openai",providerOptions:i,schema:nve}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Ws({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:i,failedResponseHandler:Iu,successfulResponseHandler:jye(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function vG(e={}){var t,n,r;const s=(t=m1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${KP({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new fbe(x,w,{provider:`${a}.chat`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new vbe(x,w,{provider:`${a}.completion`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new _be(x,w,{provider:`${a}.embedding`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new Ebe(x,w,{provider:`${a}.image`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),h=x=>new Rbe(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),m=x=>new rve(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),y=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},b=x=>new jbe(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return y(x,w)};return v.languageModel=y,v.chat=l,v.completion=c,v.responses=b,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=m,v.speechModel=m,v.tools=tve,v}vG({compatibility:"strict"});function Fl(e){if(sve(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,m={};if(n&&(m.description=n),r&&(m.required=r),c&&(m.format=c),u!==void 0&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(y=>y!=="null")[0],m.nullable=!0):m.type=t:t==="null"?m.type="null":m.type=t),h!==void 0&&(m.enum=h),s!=null&&(m.properties=Object.entries(s).reduce((y,[b,v])=>(y[b]=Fl(v),y),{})),i&&(m.items=Array.isArray(i)?i.map(Fl):Fl(i)),a&&(m.allOf=a.map(Fl)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=Fl(y[0]);typeof b=="object"&&(m.nullable=!0,Object.assign(m,b))}else m.anyOf=y.map(Fl),m.nullable=!0}else m.anyOf=o.map(Fl);return l&&(m.oneOf=l.map(Fl)),d!==void 0&&(m.minLength=d),m}function sve(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function ive(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new pr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Nu(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new pr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new pr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function n$(e){return e.includes("/")?e:`models/${e}`}var ave=Ge({error:Ge({code:Tt().nullable(),message:$e(),status:$e()})}),hj=Bh({errorSchema:ave,errorToMessage:e=>e.error.message});function ove(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const m of a)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):u.push({name:m.name,description:(i=m.description)!=null?i:"",parameters:Fl(m.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const m=h;throw new pr({functionality:`Unsupported tool choice type: ${m}`})}}}function r$({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var lve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y;const b=e.type,v=[],x=SE({provider:"google",providerOptions:d,schema:fve});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?Fl(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:S,systemInstruction:k}=ive(t);switch(b){case"regular":{const{tools:C,toolConfig:R,toolWarnings:A}=ove(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:S,systemInstruction:k,safetySettings:this.settings.safetySettings,tools:C,toolConfig:R,cachedContent:this.settings.cachedContent},warnings:[...v,...A]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?Fl(e.schema):void 0},contents:S,systemInstruction:k,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:Fl(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const C=b;throw new Error(`Unsupported type: ${C}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=Vs(await ij(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await Ws({url:`${this.config.baseURL}/${n$(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:hj,successfulResponseHandler:$a(uve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:m,...y}=a,b=d.candidates[0],v=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=s$({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:i$(v),reasoning:a$(v),files:(t=o$(v))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:x,finishReason:r$({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:m,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:l$({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=Vs(await ij(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Ws({url:`${this.config.baseURL}/${n$(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:hj,successfulResponseHandler:$h(dve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let m=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,k,C;if(!y.success){b.enqueue({type:"error",error:y.error});return}const R=y.value,A=R.usageMetadata;A!=null&&(u={promptTokens:(v=A.promptTokenCount)!=null?v:NaN,completionTokens:(x=A.candidatesTokenCount)!=null?x:NaN});const N=(w=R.candidates)==null?void 0:w[0];if(N==null)return;const I=N.content;if(I!=null){const O=i$(I.parts);O!=null&&b.enqueue({type:"text-delta",textDelta:O});const B=a$(I.parts);if(B!=null)for(const P of B)b.enqueue({type:"reasoning",textDelta:P.text});const D=o$(I.parts);if(D!=null)for(const P of D)b.enqueue({type:"file",mimeType:P.inlineData.mimeType,data:P.inlineData.data});const W=s$({parts:I.parts,generateId:h});if(W!=null)for(const P of W)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:P.toolCallId,toolName:P.toolName,argsTextDelta:P.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:P.toolCallId,toolName:P.toolName,args:P.args}),m=!0}if(N.finishReason!=null){c=r$({finishReason:N.finishReason,hasToolCalls:m});const O=(S=l$({groundingMetadata:N.groundingMetadata,generateId:h}))!=null?S:[];for(const B of O)b.enqueue({type:"source",source:B});d={google:{groundingMetadata:(k=N.groundingMetadata)!=null?k:null,safetyRatings:(C=N.safetyRatings)!=null?C:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function s$({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function i$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function a$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function o$(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function l$({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var xG=Ge({parts:on(ps([Ge({functionCall:Ge({name:$e(),args:zy()})}),Ge({inlineData:Ge({mimeType:$e(),data:$e()})}),Ge({text:$e().nullish(),thought:Gn().nullish()})])).nullish()}),cve=Ge({web:Ge({uri:$e(),title:$e()}).nullish(),retrievedContext:Ge({uri:$e(),title:$e()}).nullish()}),wG=Ge({webSearchQueries:on($e()).nullish(),retrievalQueries:on($e()).nullish(),searchEntryPoint:Ge({renderedContent:$e()}).nullish(),groundingChunks:on(cve).nullish(),groundingSupports:on(Ge({segment:Ge({startIndex:Tt().nullish(),endIndex:Tt().nullish(),text:$e().nullish()}),segment_text:$e().nullish(),groundingChunkIndices:on(Tt()).nullish(),supportChunkIndices:on(Tt()).nullish(),confidenceScores:on(Tt()).nullish(),confidenceScore:on(Tt()).nullish()})).nullish(),retrievalMetadata:ps([Ge({webDynamicRetrievalScore:Tt()}),Ge({})]).nullish()}),_G=Ge({category:$e().nullish(),probability:$e().nullish(),probabilityScore:Tt().nullish(),severity:$e().nullish(),severityScore:Tt().nullish(),blocked:Gn().nullish()}),uve=Ge({candidates:on(Ge({content:xG.nullish().or(Ge({}).strict()),finishReason:$e().nullish(),safetyRatings:on(_G).nullish(),groundingMetadata:wG.nullish()})),usageMetadata:Ge({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),dve=Ge({candidates:on(Ge({content:xG.nullish(),finishReason:$e().nullish(),safetyRatings:on(_G).nullish(),groundingMetadata:wG.nullish()})).nullish(),usageMetadata:Ge({promptTokenCount:Tt().nullish(),candidatesTokenCount:Tt().nullish(),totalTokenCount:Tt().nullish()}).nullish()}),fve=Ge({responseModalities:on(yl(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ge({thinkingBudget:Tt().nullish(),includeThoughts:Gn().nullish()}).nullish()}),hve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new wE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=Vs(await ij(this.config.headers),t),{responseHeaders:s,value:i}=await Ws({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:hj,successfulResponseHandler:$a(pve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},pve=Ge({embeddings:on(Ge({values:on(Tt())}))});function mve(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function SG(e={}){var t;const n=(t=m1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":KP({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new lve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:ia,isSupportedUrl:mve,fetch:e.fetch})},i=(o,l={})=>new hve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}SG();var gve=Object.defineProperty,yve=Object.defineProperties,bve=Object.getOwnPropertyDescriptors,TC=Object.getOwnPropertySymbols,CG=Object.prototype.hasOwnProperty,kG=Object.prototype.propertyIsEnumerable,c$=(e,t,n)=>t in e?gve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ma=(e,t)=>{for(var n in t||(t={}))CG.call(t,n)&&c$(e,n,t[n]);if(TC)for(var n of TC(t))kG.call(t,n)&&c$(e,n,t[n]);return e},R2=(e,t)=>yve(e,bve(t)),AC=(e,t)=>{var n={};for(var r in e)CG.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&TC)for(var r of TC(e))t.indexOf(r)<0&&kG.call(e,r)&&(n[r]=e[r]);return n},vve=Ge({type:Rn("reasoning.summary"),summary:$e()}),xve=Ge({type:Rn("reasoning.encrypted"),data:$e()}),wve=Ge({type:Rn("reasoning.text"),text:$e().nullish(),signature:$e().nullish()}),_ve=ps([vve,xve,wve]),Sve=ps([_ve,zy().transform(()=>null)]),JP=on(Sve).transform(e=>e.filter(t=>!!t));function Yf(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function Cve(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:Yf(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=Yf(o))!=null?n:Yf(a[0].providerMetadata)});break}const l=Yf(o),c=a.map(u=>{var d,h,m,y;const b=(d=Yf(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:b};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${Nu(u.image)}`},cache_control:b};case"file":return{type:"file",file:{filename:String((y=(m=u.providerMetadata)==null?void 0:m.openrouter)==null?void 0:y.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${Nu(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:b};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const m=h;throw new Error(`Unsupported part: ${m}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:Yf(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Yf(o))!=null?r:Yf(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function u$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function RC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var QP=Ge({error:Ge({code:ps([$e(),Tt()]).nullable(),message:$e(),type:$e().nullable(),param:qd().nullable()})}),NC=Bh({errorSchema:QP,errorToMessage:e=>e.error.message});function kve(e){return"parameters"in e}var Eve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const m=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=Ma(Ma(Ma({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:Cve(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),y);switch(m){case"regular":return Ma(Ma({},b),Rve(e));case"object-json":return R2(Ma({},b),{response_format:{type:"json_object"}});case"object-tool":return R2(Ma({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=m;throw new pr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:u,failedResponseHandler:NC,successfulResponseHandler:$a(Tve),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u,{messages:y}=m,b=AC(m,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const S=Object.keys(w).length>0,k=(o=v.message.reasoning_details)!=null?o:[],C=k.length>0?k.map(R=>{var A;switch(R.type){case"reasoning.text":{if(R.text)return{type:"text",text:R.text,signature:(A=R.signature)!=null?A:void 0};break}case"reasoning.summary":{if(R.summary)return{type:"text",text:R.summary};break}case"reasoning.encrypted":{if(R.data)return{type:"redacted",data:R.data};break}}return null}).filter(R=>R!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return Ma({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:C,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(R=>{var A;return{toolCallType:"function",toolCallId:(A=R.id)!=null?A:ia(),toolName:R.function.name,args:R.function.arguments}}),finishReason:RC(v.finish_reason),usage:x,rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d},warnings:[],logprobs:u$(v.logprobs)},S?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:R2(Ma({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?Ma({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:NC,successfulResponseHandler:$h(Ave),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=AC(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const m={},y=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,R,A,N,I,O,B,D,W,P;if(!b.success){u="error",v.enqueue({type:"error",error:b.error});return}const Z=b.value;if("error"in Z){u="error",v.enqueue({type:"error",error:Z.error});return}Z.id&&v.enqueue({type:"response-metadata",id:Z.id}),Z.model&&v.enqueue({type:"response-metadata",modelId:Z.model}),Z.usage!=null&&(d={promptTokens:Z.usage.prompt_tokens,completionTokens:Z.usage.completion_tokens},m.promptTokens=Z.usage.prompt_tokens,Z.usage.prompt_tokens_details&&(m.promptTokensDetails={cachedTokens:(x=Z.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),m.completionTokens=Z.usage.completion_tokens,Z.usage.completion_tokens_details&&(m.completionTokensDetails={reasoningTokens:(w=Z.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),m.cost=Z.usage.cost,m.totalTokens=Z.usage.total_tokens);const U=Z.choices[0];if((U==null?void 0:U.finish_reason)!=null&&(u=RC(U.finish_reason)),(U==null?void 0:U.delta)==null)return;const H=U.delta;if(H.content!=null&&v.enqueue({type:"text-delta",textDelta:H.content}),H.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:H.reasoning}),H.reasoning_details&&H.reasoning_details.length>0)for(const ne of H.reasoning_details)switch(ne.type){case"reasoning.text":{ne.text&&v.enqueue({type:"reasoning",textDelta:ne.text}),ne.signature&&v.enqueue({type:"reasoning-signature",signature:ne.signature});break}case"reasoning.encrypted":{ne.data&&v.enqueue({type:"redacted-reasoning",data:ne.data});break}case"reasoning.summary":{ne.summary&&v.enqueue({type:"reasoning",textDelta:ne.summary});break}}const L=u$(U==null?void 0:U.logprobs);if(L!=null&&L.length&&(h===void 0&&(h=[]),h.push(...L)),H.tool_calls!=null)for(const ne of H.tool_calls){const V=ne.index;if(c[V]==null){if(ne.type!=="function")throw new jd({data:ne,message:"Expected 'function' type."});if(ne.id==null)throw new jd({data:ne,message:"Expected 'id' to be a string."});if(((S=ne.function)==null?void 0:S.name)==null)throw new jd({data:ne,message:"Expected 'function.name' to be a string."});c[V]={id:ne.id,type:"function",function:{name:ne.function.name,arguments:(k=ne.function.arguments)!=null?k:""},sent:!1};const ee=c[V];if(ee==null)throw new Error("Tool call is missing");((C=ee.function)==null?void 0:C.name)!=null&&((R=ee.function)==null?void 0:R.arguments)!=null&&um(ee.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(A=ee.id)!=null?A:ia(),toolName:ee.function.name,args:ee.function.arguments}),ee.sent=!0);continue}const Q=c[V];if(Q==null)throw new Error("Tool call is missing");((N=ne.function)==null?void 0:N.arguments)!=null&&(Q.function.arguments+=(O=(I=ne.function)==null?void 0:I.arguments)!=null?O:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(B=ne.function.arguments)!=null?B:""}),((D=Q.function)==null?void 0:D.name)!=null&&((W=Q.function)==null?void 0:W.arguments)!=null&&um(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=Q.id)!=null?P:ia(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(b){var v;if(u==="tool-calls")for(const S of c)S.sent||(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=S.id)!=null?v:ia(),toolName:S.function.name,args:um(S.function.arguments)?S.function.arguments:"{}"}),S.sent=!0);const x={};y&&(m.totalTokens!==void 0||m.cost!==void 0||m.promptTokensDetails!==void 0||m.completionTokensDetails!==void 0)&&(x.openrouter={usage:m});const w=Object.keys(x).length>0&&y;b.enqueue(Ma({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},EG=Ge({id:$e().optional(),model:$e().optional(),usage:Ge({prompt_tokens:Tt(),prompt_tokens_details:Ge({cached_tokens:Tt()}).nullish(),completion_tokens:Tt(),completion_tokens_details:Ge({reasoning_tokens:Tt()}).nullish(),total_tokens:Tt(),cost:Tt().optional()}).nullish()}),Tve=EG.extend({choices:on(Ge({message:Ge({role:Rn("assistant"),content:$e().nullable().optional(),reasoning:$e().nullable().optional(),reasoning_details:JP.nullish(),tool_calls:on(Ge({id:$e().optional().nullable(),type:Rn("function"),function:Ge({name:$e(),arguments:$e()})})).optional()}),index:Tt(),logprobs:Ge({content:on(Ge({token:$e(),logprob:Tt(),top_logprobs:on(Ge({token:$e(),logprob:Tt()}))})).nullable()}).nullable().optional(),finish_reason:$e().optional().nullable()}))}),Ave=ps([EG.extend({choices:on(Ge({delta:Ge({role:yl(["assistant"]).optional(),content:$e().nullish(),reasoning:$e().nullish().optional(),reasoning_details:JP.nullish(),tool_calls:on(Ge({index:Tt(),id:$e().nullish(),type:Rn("function").optional(),function:Ge({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ge({content:on(Ge({token:$e(),logprob:Tt(),top_logprobs:on(Ge({token:$e(),logprob:Tt()}))})).nullable()}).nullish(),finish_reason:$e().nullable().optional(),index:Tt()}))}),QP]);function Rve(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>kve(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function Nve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new pc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pr({functionality:"images"});case"file":throw new pr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pr({functionality:"tool-call messages"});case"reasoning":throw new pr({functionality:"reasoning messages"});case"redacted-reasoning":throw new pr({functionality:"redacted reasoning messages"});case"file":throw new pr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new pr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function d$(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var Mve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var m,y;const b=e.type,v=(m=h==null?void 0:h.openrouter)!=null?m:{},{prompt:x}=Nve({prompt:n,inputFormat:t}),w=Ma(Ma(Ma({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new pr({functionality:"tools"});if(e.toolChoice)throw new pr({functionality:"toolChoice"});return w}case"object-json":throw new pr({functionality:"object-json mode"});case"object-tool":throw new pr({functionality:"object-tool mode"});default:{const S=b;throw new pr({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:a,failedResponseHandler:NC,successfulResponseHandler:$a(f$),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=AC(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:RC(h.finish_reason),logprobs:d$(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:R2(Ma({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:NC,successfulResponseHandler:$h(f$),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=AC(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const m=h.choices[0];(m==null?void 0:m.finish_reason)!=null&&(o=RC(m.finish_reason)),(m==null?void 0:m.text)!=null&&d.enqueue({type:"text-delta",textDelta:m.text});const y=d$(m==null?void 0:m.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},f$=ps([Ge({id:$e().optional(),model:$e().optional(),choices:on(Ge({text:$e(),reasoning:$e().nullish().optional(),reasoning_details:JP.nullish(),finish_reason:$e().nullish(),index:Tt(),logprobs:Ge({tokens:on($e()),token_logprobs:on(Tt()),top_logprobs:on(bh($e(),Tt())).nullable()}).nullable().optional()})),usage:Ge({prompt_tokens:Tt(),completion_tokens:Tt()}).optional().nullable()}),QP]);function TG(e={}){var t,n,r;const s=(n=m1((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>Ma({Authorization:`Bearer ${KP({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new Eve(d,h,{provider:"openrouter.chat",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new Mve(d,h,{provider:"openrouter.completion",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}TG({compatibility:"strict"});var Op={},xN={},h$;function p$(){return h$||(h$=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(xN)),xN}var m$;function Ive(){return m$||(m$=1,function(e){var t=Op&&Op.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,m)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=Op&&Op.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=p$();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(p$(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const m=C=>{throw new s(`${C} at position ${h}`)},y=C=>{throw new i(`${C} at position ${h}`)},b=()=>(k(),h>=d&&m("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),v=()=>{const C=h;let R=!1;for(h++;h<d&&(c[h]!=='"'||R&&c[h-1]==="\\");)R=c[h]==="\\"?!R:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(C,++h-Number(R)))}catch(A){y(String(A))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(C,h-Number(R))+'"')}catch{return JSON.parse(c.substring(C,c.lastIndexOf("\\"))+'"')}m("Unterminated string literal")},x=()=>{h++,k();const C={};try{for(;c[h]!=="}";){if(k(),h>=d&&r.Allow.OBJ&u)return C;const R=v();k(),h++;try{const A=b();C[R]=A}catch(A){if(r.Allow.OBJ&u)return C;throw A}k(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return C;m("Expected '}' at end of object")}return h++,C},w=()=>{h++;const C=[];try{for(;c[h]!=="]";)C.push(b()),k(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return C;m("Expected ']' at end of array")}return h++,C},S=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(R){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(R))}}const C=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&m("Unterminated number literal");try{return JSON.parse(c.substring(C,h))}catch{c.substring(C,h)==="-"&&m("Not sure what '-' is");try{return JSON.parse(c.substring(C,c.lastIndexOf("e")))}catch(A){y(String(A))}}},k=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(Op)),Op}var jve=Ive();function wN(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new pr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Nu(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var Pve=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=jve.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:ia(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Ove({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Dve=Ge({error:Ge({code:$e().nullable(),message:$e(),param:qd().nullable(),type:$e()})}),pj=Bh({errorSchema:Dve,errorToMessage:e=>e.error.message});function Fve({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new pr({functionality:`Unsupported tool choice type: ${o}`})}}}function Lve(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Bve=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},$ve=e=>async({response:t})=>{const n=By(t);if(t.body===null)throw new FH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Bve).pipeThrough(new TransformStream({transform(r,s){s.enqueue(vm({schema:e,text:r}))}}))}},zve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const m={format:i==null?void 0:i.type,model:this.modelId,options:Lve({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=Fve({mode:n});return{args:{...m,messages:wN(s),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...m,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:wN(s)},type:d,warnings:h};case"object-tool":return{args:{...m,messages:wN(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Ws({abortSignal:e.abortSignal,body:i,failedResponseHandler:pj,fetch:this.config.fetch,headers:Vs(this.config.headers(),e.headers),successfulResponseHandler:$a(Uve),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:ia(),toolCallType:"function",toolName:d.function.name}});return{finishReason:Ove({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const m=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...m.response}),m.text&&b.enqueue({textDelta:m.text,type:"text-delta"}),m.toolCalls)for(const v of m.toolCalls)b.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...v});b.enqueue({finishReason:m.finishReason,logprobs:m.logprobs,providerMetadata:m.providerMetadata,type:"finish",usage:m.usage}),b.close()}});return{rawCall:m.rawCall,rawResponse:m.rawResponse,stream:y,warnings:m.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Ws({abortSignal:e.abortSignal,body:t,failedResponseHandler:pj,fetch:this.config.fetch,headers:Vs(this.config.headers(),e.headers),successfulResponseHandler:$ve(qve),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new Pve({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(m){m.enqueue({finishReason:u,type:"finish",usage:d})},async transform(m,y){if(!m.success){y.enqueue({error:m.error,type:"error"});return}const b=m.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},Uve=Ge({created_at:$e(),done:Rn(!0),done_reason:$e().optional().nullable(),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),message:Ge({content:$e(),role:$e(),tool_calls:on(Ge({function:Ge({arguments:bh(qd()),name:$e()}),id:$e().optional()})).optional().nullable()}),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()}),qve=kE("done",[Ge({created_at:$e(),done:Rn(!1),message:Ge({content:$e(),role:$e()}),model:$e()}),Ge({created_at:$e(),done:Rn(!0),eval_count:Tt(),eval_duration:Tt(),load_duration:Tt().optional(),model:$e(),prompt_eval_count:Tt().optional(),prompt_eval_duration:Tt().optional(),total_duration:Tt()})]),Vve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new wE({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Ws({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:pj,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:$a(Wve),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},Wve=Ge({embeddings:on(on(Tt())),prompt_eval_count:Tt().nullable()});function AG(e={}){var t;const n=(t=m1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new zve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new Vve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}AG();function Nv(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function Hve(e){const t=[];for(const{role:n,content:r,...s}of e){const i=Nv({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Nv(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Nv(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Nu(a.image)}`},...l};case"file":throw new pr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Nv(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=Nv(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function MC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function IC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Gve=Ge({error:Ge({message:$e(),type:$e().nullish(),param:qd().nullish(),code:ps([$e(),Tt()]).nullish()})}),EE={errorSchema:Gve,errorToMessage:e=>e.error.message};function Kve({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new pr({functionality:`Unsupported tool choice type: ${l}`})}}}var Yve=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:EE;this.chunkSchema=Xve(i.errorSchema),this.failedResponseHandler=Bh(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,m,y,b,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(m=l==null?void 0:l[this.providerOptionsName])==null?void 0:m.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:Hve(t)};switch(x){case"regular":{const{tools:k,tool_choice:C,toolWarnings:R}=Kve({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:k,tool_choice:C},warnings:[...w,...R]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const k=x;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:m}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:v,rawValue:x}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$a(Zve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...S}=h,k=v.choices[0],C={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},R=(r=v.usage)==null?void 0:r.completion_tokens_details,A=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(R==null?void 0:R.reasoning_tokens)!=null&&(C[this.providerOptionsName].reasoningTokens=R==null?void 0:R.reasoning_tokens),(R==null?void 0:R.accepted_prediction_tokens)!=null&&(C[this.providerOptionsName].acceptedPredictionTokens=R==null?void 0:R.accepted_prediction_tokens),(R==null?void 0:R.rejected_prediction_tokens)!=null&&(C[this.providerOptionsName].rejectedPredictionTokens=R==null?void 0:R.rejected_prediction_tokens),(A==null?void 0:A.cached_tokens)!=null&&(C[this.providerOptionsName].cachedPromptTokens=A==null?void 0:A.cached_tokens),{text:(i=k.message.content)!=null?i:void 0,reasoning:(a=k.message.reasoning_content)!=null?a:void 0,toolCalls:(o=k.message.tool_calls)==null?void 0:o.map(N=>{var I;return{toolCallType:"function",toolCallId:(I=N.id)!=null?I:ia(),toolName:N.function.name,args:N.function.arguments}}),finishReason:IC(k.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:C,rawCall:{rawPrompt:w,rawSettings:S},rawResponse:{headers:b,body:x},response:MC(v),warnings:m,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const w of b.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$h(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},m=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,R,A,N,I,O,B,D;if(!b.success){d="error",v.enqueue({type:"error",error:b.error});return}const W=b.value;if(i==null||i.processChunk(b.rawValue),"error"in W){d="error",v.enqueue({type:"error",error:W.error.message});return}if(m&&(m=!1,v.enqueue({type:"response-metadata",...MC(W)})),W.usage!=null){const{prompt_tokens:U,completion_tokens:H,prompt_tokens_details:L,completion_tokens_details:ne}=W.usage;h.promptTokens=U??void 0,h.completionTokens=H??void 0,(ne==null?void 0:ne.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=ne==null?void 0:ne.reasoning_tokens),(ne==null?void 0:ne.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=ne==null?void 0:ne.accepted_prediction_tokens),(ne==null?void 0:ne.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=ne==null?void 0:ne.rejected_prediction_tokens),(L==null?void 0:L.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=L==null?void 0:L.cached_tokens)}const P=W.choices[0];if((P==null?void 0:P.finish_reason)!=null&&(d=IC(P.finish_reason)),(P==null?void 0:P.delta)==null)return;const Z=P.delta;if(Z.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:Z.reasoning_content}),Z.content!=null&&v.enqueue({type:"text-delta",textDelta:Z.content}),Z.tool_calls!=null)for(const U of Z.tool_calls){const H=U.index;if(u[H]==null){if(U.type!=="function")throw new jd({data:U,message:"Expected 'function' type."});if(U.id==null)throw new jd({data:U,message:"Expected 'id' to be a string."});if(((x=U.function)==null?void 0:x.name)==null)throw new jd({data:U,message:"Expected 'function.name' to be a string."});u[H]={id:U.id,type:"function",function:{name:U.function.name,arguments:(w=U.function.arguments)!=null?w:""},hasFinished:!1};const ne=u[H];((S=ne.function)==null?void 0:S.name)!=null&&((k=ne.function)==null?void 0:k.arguments)!=null&&(ne.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ne.id,toolName:ne.function.name,argsTextDelta:ne.function.arguments}),um(ne.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=ne.id)!=null?C:ia(),toolName:ne.function.name,args:ne.function.arguments}),ne.hasFinished=!0));continue}const L=u[H];L.hasFinished||(((R=U.function)==null?void 0:R.arguments)!=null&&(L.function.arguments+=(N=(A=U.function)==null?void 0:A.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:L.id,toolName:L.function.name,argsTextDelta:(I=U.function.arguments)!=null?I:""}),((O=L.function)==null?void 0:O.name)!=null&&((B=L.function)==null?void 0:B.arguments)!=null&&um(L.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=L.id)!=null?D:ia(),toolName:L.function.name,args:L.function.arguments}),L.hasFinished=!0))}},flush(b){var v,x;const w={[y]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},RG=Ge({prompt_tokens:Tt().nullish(),completion_tokens:Tt().nullish(),prompt_tokens_details:Ge({cached_tokens:Tt().nullish()}).nullish(),completion_tokens_details:Ge({reasoning_tokens:Tt().nullish(),accepted_prediction_tokens:Tt().nullish(),rejected_prediction_tokens:Tt().nullish()}).nullish()}).nullish(),Zve=Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({message:Ge({role:Rn("assistant").nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:on(Ge({id:$e().nullish(),type:Rn("function"),function:Ge({name:$e(),arguments:$e()})})).nullish()}),finish_reason:$e().nullish()})),usage:RG}),Xve=e=>ps([Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({delta:Ge({role:yl(["assistant"]).nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:on(Ge({index:Tt(),id:$e().nullish(),type:Rn("function").nullish(),function:Ge({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),finish_reason:$e().nullish()})),usage:RG}),e]);function Jve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new pc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new pr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var Qve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:EE;this.chunkSchema=txe(s.errorSchema),this.failedResponseHandler=Bh(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var m;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=Jve({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(y){case"regular":{if((m=e.tools)!=null&&m.length)throw new pr({functionality:"tools"});if(e.toolChoice)throw new pr({functionality:"toolChoice"});return{args:S,warnings:b}}case"object-json":throw new pr({functionality:"object-json mode"});case"object-tool":throw new pr({functionality:"object-tool mode"});default:{const k=y;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$a(exe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:IC(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:MC(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:$h(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){l="error",h.enqueue({type:"error",error:m.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...MC(m)})),m.usage!=null&&(c={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const y=m.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=IC(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},exe=Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({text:$e(),finish_reason:$e()})),usage:Ge({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),txe=e=>ps([Ge({id:$e().nullish(),created:Tt().nullish(),model:$e().nullish(),choices:on(Ge({text:$e(),finish_reason:$e().nullish(),index:Tt()})),usage:Ge({prompt_tokens:Tt(),completion_tokens:Tt()}).nullish()}),e]),nxe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new wE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Vs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Bh((r=this.config.errorStructure)!=null?r:EE),successfulResponseHandler:$a(rxe),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},rxe=Ge({data:on(Ge({embedding:on(Tt())})),usage:Ge({prompt_tokens:Tt()}).nullish()}),sxe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:v}=await Ws({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Vs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Bh((h=this.config.errorStructure)!=null?h:EE),successfulResponseHandler:$a(ixe),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:m,response:{timestamp:y,modelId:this.modelId,headers:v}}}},ixe=Ge({data:on(Ge({b64_json:$e()}))});function axe(e){const t=m1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const m=new URL(`${t}${h}`);return e.queryParams&&(m.search=new URLSearchParams(e.queryParams).toString()),m.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new Yve(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new Qve(d,h,s("completion")),l=(d,h={})=>new nxe(d,h,s("embedding")),c=(d,h={})=>new sxe(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const wx=(e,t)=>`${e}:${t}`,_c=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},ty=e=>e==="openai"||e==="openrouter"||e==="google",jC=e=>e==="ollama"||e==="openai-compatible",dm=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",wo=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],oxe={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},NG=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function eO(e,t,n){try{switch(e.type){case"openai":return vG({apiKey:n})(t);case"google":return SG({apiKey:n})(t);case"openrouter":const s=TG({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return AG({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return axe({baseURL:NG(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function MG(e,t,n){const s=Nr.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=eO(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:wx(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const IG={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Mv=new Map,lxe=5*60*1e3,cxe=(e,t)=>{var i,a,o,l,c,u,d,h,m,y,b,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((m=e.pricing)==null?void 0:m.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??IG[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function uxe(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Mv.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=NG(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),Me.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const v=JSON.parse(b);y=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const m=h.map(y=>cxe(y,e.type));return m.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${m.length} models for ${e.name}`),m}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),Me.error(`Failed to fetch models for ${e.name}: ${d}`),Mv.delete(n),[]}})();return Mv.set(n,s),setTimeout(()=>{Mv.get(n)===s&&(Mv.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},lxe),s}const fr={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},_N="provider:lastModelSelection",g$="provider:globalModelSortOrder",Nr=Bo($o((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(wx(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Pe.emit(fr.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=eO(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:wx(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),St.saveSetting("enableApiKeyManagement",n),Pe.emit(fr.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await St.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([St.loadProviderConfigs(),St.loadApiKeys(),St.loadSetting(g$,[]),St.loadSetting(_N,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await St.saveSetting(_N,c),Pe.emit(fr.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Pe.emit(fr.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),Me.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),St.saveSetting(_N,n),Pe.emit(fr.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=ws(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await St.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),Me.success(`API Key "${n}" added.`),Pe.emit(fr.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),Me.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await St.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),Me.success(`API Key "${r}" deleted.`),Pe.emit(fr.apiKeysChanged,{apiKeys:t().dbApiKeys}),Pe.emit(fr.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),Me.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=ws(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await St.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),Me.success(`Provider "${n.name}" added.`),Pe.emit(fr.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),Me.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await St.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(fr.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),Me.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await St.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(fr.configsChanged,{providerConfigs:t().dbProviderConfigs}),Me.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),Me.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){Me.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await uxe(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),Me.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await St.saveSetting(g$,r),t()._updateGloballyEnabledModelDefinitions(),Pe.emit(fr.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Pe.emit(fr.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Pe.emit(fr.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=_c(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(oxe[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:IG[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:wx(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:fr.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:fr.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:fr.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:fr.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:fr.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:fr.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:fr.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:fr.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:fr.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:fr.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:fr.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),sn={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},dxe=`You are a helpful AI assistant.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

Key principles:
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 

When creating gated blocks, if you can infer a filepath for it, you should create it as follow : 
\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\``,SN="system",CN=dxe,kN=.7,EN=null,TN=null,AN=null,RN=0,NN=0,y$=!0,MN=!0,IN=!0,jN=!1,PN=!1,ON=15,b$=null,v$=null,DN=5,FN=null,LN=!0,BN=null,$N=768,zN=!1,UN=!1,qN=null,VN=16,WN="max-w-7xl",HN=null,GN=1e3,KN=!0,x$=!1,w$=!1,mr=Bo($o((e,t)=>({theme:SN,globalSystemPrompt:CN,temperature:kN,maxTokens:EN,topP:TN,topK:AN,presencePenalty:RN,frequencyPenalty:NN,enableAdvancedSettings:y$,enableStreamingMarkdown:MN,enableStreamingCodeBlockParsing:IN,foldStreamingCodeBlocks:jN,foldUserMessagesOnCompletion:PN,streamingRenderFPS:ON,gitUserName:b$,gitUserEmail:v$,toolMaxSteps:DN,prismThemeUrl:FN,autoTitleEnabled:LN,autoTitleModelId:BN,autoTitlePromptMaxLength:$N,autoTitleIncludeFiles:zN,autoTitleIncludeRules:UN,customFontFamily:qN,customFontSize:VN,chatMaxWidth:WN,customThemeColors:HN,autoScrollInterval:GN,enableAutoScrollOnStream:KN,autoSyncOnStreamComplete:x$,autoInitializeReposOnStartup:w$,setTheme:n=>{e({theme:n}),St.saveSetting("theme",n),Pe.emit(sn.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),St.saveSetting("globalSystemPrompt",n),Pe.emit(sn.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),St.saveSetting("temperature",n),Pe.emit(sn.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),St.saveSetting("maxTokens",n),Pe.emit(sn.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),St.saveSetting("topP",n),Pe.emit(sn.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),St.saveSetting("topK",n),Pe.emit(sn.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),St.saveSetting("presencePenalty",n),Pe.emit(sn.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),St.saveSetting("frequencyPenalty",n),Pe.emit(sn.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),St.saveSetting("enableAdvancedSettings",n),Pe.emit(sn.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),St.saveSetting("enableStreamingMarkdown",n),Pe.emit(sn.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),St.saveSetting("enableStreamingCodeBlockParsing",n),Pe.emit(sn.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),St.saveSetting("foldStreamingCodeBlocks",n),Pe.emit(sn.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),St.saveSetting("foldUserMessagesOnCompletion",n),Pe.emit(sn.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),St.saveSetting("streamingRenderFPS",r),Pe.emit(sn.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),St.saveSetting("gitUserName",r),Pe.emit(sn.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),St.saveSetting("gitUserEmail",r),Pe.emit(sn.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),St.saveSetting("toolMaxSteps",r),Pe.emit(sn.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),St.saveSetting("prismThemeUrl",r),Pe.emit(sn.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),St.saveSetting("autoTitleEnabled",n),Pe.emit(sn.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),St.saveSetting("autoTitleModelId",n),Pe.emit(sn.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),St.saveSetting("autoTitlePromptMaxLength",r),Pe.emit(sn.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),St.saveSetting("autoTitleIncludeFiles",n),Pe.emit(sn.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),St.saveSetting("autoTitleIncludeRules",n),Pe.emit(sn.autoTitleIncludeRulesChanged,{include:n})},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),St.saveSetting("customFontFamily",r),Pe.emit(sn.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),St.saveSetting("customFontSize",r),Pe.emit(sn.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),St.saveSetting("chatMaxWidth",n),Pe.emit(sn.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),St.saveSetting("customThemeColors",n),Pe.emit(sn.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;St.saveSetting("customThemeColors",s),Pe.emit(sn.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),St.saveSetting("autoScrollInterval",r),Pe.emit(sn.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),St.saveSetting("enableAutoScrollOnStream",n),Pe.emit(sn.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),St.saveSetting("autoSyncOnStreamComplete",n),Pe.emit(sn.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),St.saveSetting("autoInitializeReposOnStartup",n),Pe.emit(sn.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,R,A,N,I,O,B,D,W,P,Z,U]=await Promise.all([St.loadSetting("theme",SN),St.loadSetting("temperature",kN),St.loadSetting("maxTokens",EN),St.loadSetting("topP",TN),St.loadSetting("topK",AN),St.loadSetting("presencePenalty",RN),St.loadSetting("frequencyPenalty",NN),St.loadSetting("globalSystemPrompt",CN),St.loadSetting("enableAdvancedSettings",y$),St.loadSetting("enableStreamingMarkdown",MN),St.loadSetting("enableStreamingCodeBlockParsing",IN),St.loadSetting("foldStreamingCodeBlocks",jN),St.loadSetting("foldUserMessagesOnCompletion",PN),St.loadSetting("streamingRenderFPS",ON),St.loadSetting("gitUserName",b$),St.loadSetting("gitUserEmail",v$),St.loadSetting("toolMaxSteps",DN),St.loadSetting("prismThemeUrl",FN),St.loadSetting("autoTitleEnabled",LN),St.loadSetting("autoTitleModelId",BN),St.loadSetting("autoTitlePromptMaxLength",$N),St.loadSetting("autoTitleIncludeFiles",zN),St.loadSetting("autoTitleIncludeRules",UN),St.loadSetting("customFontFamily",qN),St.loadSetting("customFontSize",VN),St.loadSetting("chatMaxWidth",WN),St.loadSetting("customThemeColors",HN),St.loadSetting("autoScrollInterval",GN),St.loadSetting("enableAutoScrollOnStream",KN),St.loadSetting("autoSyncOnStreamComplete",x$),St.loadSetting("autoInitializeReposOnStartup",w$)]),H={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:m,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:S,autoTitleEnabled:k,autoTitleModelId:C,autoTitlePromptMaxLength:R,autoTitleIncludeFiles:A,autoTitleIncludeRules:N,customFontFamily:I,customFontSize:O,chatMaxWidth:B,customThemeColors:D,autoScrollInterval:W,enableAutoScrollOnStream:P,autoSyncOnStreamComplete:Z,autoInitializeReposOnStartup:U};e(H),Pe.emit(sn.loaded,{settings:H})}catch(n){console.error("SettingsStore: Error loading settings",n),Pe.emit(sn.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(MN),t().setEnableStreamingCodeBlockParsing(IN),t().setFoldStreamingCodeBlocks(jN),t().setFoldUserMessagesOnCompletion(PN),t().setStreamingRenderFPS(ON),t().setAutoScrollInterval(GN),t().setEnableAutoScrollOnStream(KN),Me.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),Me.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(CN),t().setTemperature(kN),t().setMaxTokens(EN),t().setTopP(TN),t().setTopK(AN),t().setPresencePenalty(RN),t().setFrequencyPenalty(NN),t().setToolMaxSteps(DN),t().setAutoTitleEnabled(LN),t().setAutoTitleModelId(BN),t().setAutoTitlePromptMaxLength($N),t().setAutoTitleIncludeFiles(zN),t().setAutoTitleIncludeRules(UN),Me.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),Me.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(SN),t().setPrismThemeUrl(FN),t().setCustomFontFamily(qN),t().setCustomFontSize(VN),t().setChatMaxWidth(WN),t().setCustomThemeColors(HN),Me.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),Me.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:sn.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:sn.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:sn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:sn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:sn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:sn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:sn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:sn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:sn.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:sn.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:sn.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:sn.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:sn.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:sn.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:sn.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:sn.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:sn.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:sn.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:sn.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:sn.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:sn.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:sn.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:sn.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:sn.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:sn.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:sn.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:sn.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:sn.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:sn.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:sn.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:sn.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:sn.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:sn.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:sn.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:sn.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:sn.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function PC(e,t){const n=Ui.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function _$(){const e=Ln.getState(),t=Nr.getState(),n=mr.getState(),{providerId:r}=_c(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function fxe(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function S$(e){try{const t=e.type||"application/octet-stream",n=Yx(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:fxe(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),Me.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function mj(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const C$=e=>Symbol.iterator in e,k$=e=>"entries"in e,E$=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},hxe=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function pxe(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!C$(e)||!C$(t)?E$({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):k$(e)&&k$(t)?E$(e,t):hxe(e,t)}function gn(e){const t=Ve.useRef(void 0);return n=>{const r=e(n);return pxe(t.current,r)?t.current:t.current=r}}var ny=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(ny||{});const yn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",focusInputRequest:"prompt.input.focus.request",submitPromptRequest:"prompt.submit.request",inputChanged:"prompt.inputChanged"},ac=(e,t)=>{Pe.emit(yn.parameterChanged,{params:{[e]:t}})},Po=Bo($o((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),ac("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),ac("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),ac("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),ac("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),ac("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),ac("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),ac("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),ac("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),ac("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),ac("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),ac("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Pe.emit(yn.parameterChanged,{params:s})),Pe.emit(yn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Pe.emit(yn.parameterChanged,{params:r})),Pe.emit(yn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:yn.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:yn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:yn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:yn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:yn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:yn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:yn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:yn.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:yn.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:yn.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:yn.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:yn.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:yn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),mxe=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),d=Ui(gn(C=>C.promptControls)),h=Ln(gn(C=>C.status==="streaming")),{attachedFilesMetadata:m,clearAttachedFiles:y}=gh(gn(C=>({attachedFilesMetadata:C.attachedFilesMetadata,clearAttachedFiles:C.clearAttachedFiles}))),b=Po(C=>C.modelId),v=E.useMemo(()=>Object.values(d),[d]),x=E.useMemo(()=>v.filter(C=>C.renderer),[v]),w=E.useMemo(()=>v.filter(C=>C.triggerRenderer),[v]),S=E.useCallback(async C=>{var I,O;const R=((I=s==null?void 0:s.current)==null?void 0:I.getValue())??"",A=C!==void 0?C.trim():R.trim(),N=gh.getState().attachedFilesMetadata;if(!(!A&&N.length===0)&&!(h||o)){l(!0);try{let B={},D={};for(const H of v){if(H.getParameters){const L=await H.getParameters();L&&(B={...B,...L})}if(H.getMetadata){const L=await H.getMetadata();L&&(D={...D,...L})}}N.length>0&&(D.attachedFiles=[...N]),!D.modelId&&b&&(D.modelId=b);const W=v.find(H=>H.id==="core-rules-tags");if(W&&D.activeRuleIds&&D.activeTagIds){const H=[],L=new Set(D.activeRuleIds);D.activeTagIds.forEach(ne=>{W.getRulesForTag(ne).forEach(V=>L.add(V.id))}),L.forEach(ne=>{const V=W.getRuleById(ne);V&&H.push({type:V.type,content:V.content,sourceRuleId:V.id})}),D.effectiveRulesContent=H}let P={id:ws(),content:A,parameters:B,metadata:D};Pe.emit(yn.submitted,{turnData:P});const Z=await PC(ny.PROMPT_TURN_FINALIZE,{turnData:P});if(Z===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const U=Z&&typeof Z=="object"?Z.turnData:P;await t(U),y(),v.forEach(H=>{H.clearOnSubmit&&H.clearOnSubmit()}),(O=s.current)==null||O.clearValue(),u(!1)}catch(B){console.error("Error during prompt submission:",B),Me.error(`Failed to send message: ${B instanceof Error?B.message:String(B)}`)}finally{l(!1)}}},[s,h,o,v,t,y,b]);E.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var C;(C=s.current)==null||C.focus()})},[i,a,s]),E.useEffect(()=>{const C=()=>{requestAnimationFrame(()=>{var N;(N=s.current)==null||N.focus()})},R=N=>{s.current&&(s.current.setValue(N.text),u(N.text.trim().length>0))},A=async N=>{Ln.getState().status==="streaming"||o||await S(N.turnData.content)};return Pe.on(yn.focusInputRequest,C),Pe.on(yn.setInputTextRequest,R),Pe.on(yn.submitPromptRequest,A),()=>{Pe.off(yn.focusInputRequest,C),Pe.off(yn.setInputTextRequest,R),Pe.off(yn.submitPromptRequest,A)}},[s,S,o]);const k=E.useCallback(C=>{u(C.trim().length>0)},[]);return f.jsxs("div",{className:Je("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(NB,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:k,className:"flex-grow"}),f.jsx(pt,{type:"button",size:"icon",onClick:()=>S(void 0),disabled:h||o||!c&&m.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(_ge,{className:"h-4 w-4"})})]})," ",f.jsx(NB,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function gxe(e,t){const n=E.createContext(t),r=i=>{const{children:a,...o}=i,l=E.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=E.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Gi(e,t=[]){let n=[];function r(i,a){const o=E.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:m,...y}=d,b=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=E.useMemo(()=>y,Object.values(y));return f.jsx(b.Provider,{value:v,children:m})};c.displayName=i+"Provider";function u(d,h){var b;const m=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=E.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>E.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,yxe(s,...t)]}function yxe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function bxe(e){const t=vxe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(wxe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function vxe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Sxe(s),o=_xe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?fl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var xxe=Symbol("radix.slottable");function wxe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===xxe}function _xe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Sxe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Cxe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],or=Cxe.reduce((e,t)=>{const n=bxe(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function jG(e,t){e&&il.flushSync(()=>e.dispatchEvent(t))}function Es(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function tO(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e);E.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var kxe="DismissableLayer",gj="dismissableLayer.update",Exe="dismissableLayer.pointerDownOutside",Txe="dismissableLayer.focusOutside",T$,PG=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),TE=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(PG),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Nn(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=Nxe(A=>{const N=A.target,I=[...c.branches].some(O=>O.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),R=Mxe(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return tO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(T$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),A$(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=T$)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),A$())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(gj,A),()=>document.removeEventListener(gj,A)},[]),f.jsx(or.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,R.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});TE.displayName=kxe;var Axe="DismissableLayerBranch",Rxe=E.forwardRef((e,t)=>{const n=E.useContext(PG),r=E.useRef(null),s=Nn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(or.div,{...e,ref:s})});Rxe.displayName=Axe;function Nxe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){OG(Exe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function Mxe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&OG(Txe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function A$(){const e=new CustomEvent(gj);document.dispatchEvent(e)}function OG(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?jG(s,i):s.dispatchEvent(i)}var ri=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},Ixe=YW[" useId ".trim().toString()]||(()=>{}),jxe=0;function oa(e){const[t,n]=E.useState(Ixe());return ri(()=>{n(r=>r??String(jxe++))},[e]),t?`radix-${t}`:""}const Pxe=["top","right","bottom","left"],vh=Math.min,sl=Math.max,OC=Math.round,MS=Math.floor,Su=e=>({x:e,y:e}),Oxe={left:"right",right:"left",bottom:"top",top:"bottom"},Dxe={start:"end",end:"start"};function yj(e,t,n){return sl(e,vh(t,n))}function Vd(e,t){return typeof e=="function"?e(t):e}function Wd(e){return e.split("-")[0]}function Uy(e){return e.split("-")[1]}function nO(e){return e==="x"?"y":"x"}function rO(e){return e==="y"?"height":"width"}function xh(e){return["top","bottom"].includes(Wd(e))?"y":"x"}function sO(e){return nO(xh(e))}function Fxe(e,t,n){n===void 0&&(n=!1);const r=Uy(e),s=sO(e),i=rO(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=DC(a)),[a,DC(a)]}function Lxe(e){const t=DC(e);return[bj(e),t,bj(t)]}function bj(e){return e.replace(/start|end/g,t=>Dxe[t])}function Bxe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function $xe(e,t,n,r){const s=Uy(e);let i=Bxe(Wd(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(bj)))),i}function DC(e){return e.replace(/left|right|bottom|top/g,t=>Oxe[t])}function zxe(e){return{top:0,right:0,bottom:0,left:0,...e}}function DG(e){return typeof e!="number"?zxe(e):{top:e,right:e,bottom:e,left:e}}function FC(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function R$(e,t,n){let{reference:r,floating:s}=e;const i=xh(t),a=sO(t),o=rO(a),l=Wd(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Uy(t)){case"start":m[a]-=h*(n&&c?-1:1);break;case"end":m[a]+=h*(n&&c?-1:1);break}return m}const Uxe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=R$(c,r,l),h=r,m={},y=0;for(let b=0;b<o.length;b++){const{name:v,fn:x}=o[b],{x:w,y:S,data:k,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=S??d,m={...m,[v]:{...m[v],...k}},C&&y<=50&&(y++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):C.rects),{x:u,y:d}=R$(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function ew(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=Vd(t,e),y=DG(m),v=o[h?d==="floating"?"reference":"floating":d],x=FC(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),k=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},C=FC(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-C.top+y.top)/k.y,bottom:(C.bottom-x.bottom+y.bottom)/k.y,left:(x.left-C.left+y.left)/k.x,right:(C.right-x.right+y.right)/k.x}}const qxe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Vd(e,t)||{};if(c==null)return{};const d=DG(u),h={x:n,y:r},m=sO(s),y=rO(m),b=await a.getDimensions(c),v=m==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",k=i.reference[y]+i.reference[m]-h[m]-i.floating[y],C=h[m]-i.reference[m],R=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let A=R?R[S]:0;(!A||!await(a.isElement==null?void 0:a.isElement(R)))&&(A=o.floating[S]||i.floating[y]);const N=k/2-C/2,I=A/2-b[y]/2-1,O=vh(d[x],I),B=vh(d[w],I),D=O,W=A-b[y]-B,P=A/2-b[y]/2+N,Z=yj(D,P,W),U=!l.arrow&&Uy(s)!=null&&P!==Z&&i.reference[y]/2-(P<D?O:B)-b[y]/2<0,H=U?P<D?P-D:P-W:0;return{[m]:h[m]+H,data:{[m]:Z,centerOffset:P-Z-H,...U&&{alignmentOffset:H}},reset:U}}}),Vxe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...v}=Vd(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Wd(s),w=xh(o),S=Wd(o)===o,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(S||!b?[DC(o)]:Lxe(o)),R=y!=="none";!h&&R&&C.push(...$xe(o,b,y,k));const A=[o,...C],N=await ew(t,v),I=[];let O=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&I.push(N[x]),d){const P=Fxe(s,a,k);I.push(N[P[0]],N[P[1]])}if(O=[...O,{placement:s,overflows:I}],!I.every(P=>P<=0)){var B,D;const P=(((B=i.flip)==null?void 0:B.index)||0)+1,Z=A[P];if(Z)return{data:{index:P,overflows:O},reset:{placement:Z}};let U=(D=O.filter(H=>H.overflows[0]<=0).sort((H,L)=>H.overflows[1]-L.overflows[1])[0])==null?void 0:D.placement;if(!U)switch(m){case"bestFit":{var W;const H=(W=O.filter(L=>{if(R){const ne=xh(L.placement);return ne===w||ne==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(ne=>ne>0).reduce((ne,V)=>ne+V,0)]).sort((L,ne)=>L[1]-ne[1])[0])==null?void 0:W[0];H&&(U=H);break}case"initialPlacement":U=o;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function N$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function M$(e){return Pxe.some(t=>e[t]>=0)}const Wxe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=Vd(e,t);switch(r){case"referenceHidden":{const i=await ew(t,{...s,elementContext:"reference"}),a=N$(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:M$(a)}}}case"escaped":{const i=await ew(t,{...s,altBoundary:!0}),a=N$(i,n.floating);return{data:{escapedOffsets:a,escaped:M$(a)}}}default:return{}}}}};async function Hxe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Wd(n),o=Uy(n),l=xh(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=Vd(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const Gxe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await Hxe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},Kxe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=Vd(e,t),c={x:n,y:r},u=await ew(t,l),d=xh(Wd(s)),h=nO(d);let m=c[h],y=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=m+u[v],S=m-u[x];m=yj(w,m,S)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=y+u[v],S=y-u[x];y=yj(w,y,S)}const b=o.fn({...t,[h]:m,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:i,[d]:a}}}}}},Yxe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Vd(e,t),u={x:n,y:r},d=xh(s),h=nO(d);let m=u[h],y=u[d];const b=Vd(o,t),v=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=h==="y"?"height":"width",k=i.reference[h]-i.floating[S]+v.mainAxis,C=i.reference[h]+i.reference[S]-v.mainAxis;m<k?m=k:m>C&&(m=C)}if(c){var x,w;const S=h==="y"?"width":"height",k=["top","left"].includes(Wd(s)),C=i.reference[d]-i.floating[S]+(k&&((x=a.offset)==null?void 0:x[d])||0)+(k?0:v.crossAxis),R=i.reference[d]+i.reference[S]+(k?0:((w=a.offset)==null?void 0:w[d])||0)-(k?v.crossAxis:0);y<C?y=C:y>R&&(y=R)}return{[h]:m,[d]:y}}}},Zxe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Vd(e,t),u=await ew(t,c),d=Wd(s),h=Uy(s),m=xh(s)==="y",{width:y,height:b}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=b-u.top-u.bottom,S=y-u.left-u.right,k=vh(b-u[v],w),C=vh(y-u[x],S),R=!t.middlewareData.shift;let A=k,N=C;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(A=w),R&&!h){const O=sl(u.left,0),B=sl(u.right,0),D=sl(u.top,0),W=sl(u.bottom,0);m?N=y-2*(O!==0||B!==0?O+B:sl(u.left,u.right)):A=b-2*(D!==0||W!==0?D+W:sl(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:A});const I=await a.getDimensions(o.floating);return y!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}};function AE(){return typeof window<"u"}function qy(e){return FG(e)?(e.nodeName||"").toLowerCase():"#document"}function al(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Lu(e){var t;return(t=(FG(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function FG(e){return AE()?e instanceof Node||e instanceof al(e).Node:!1}function Rc(e){return AE()?e instanceof Element||e instanceof al(e).Element:!1}function ju(e){return AE()?e instanceof HTMLElement||e instanceof al(e).HTMLElement:!1}function I$(e){return!AE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof al(e).ShadowRoot}function g1(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Nc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function Xxe(e){return["table","td","th"].includes(qy(e))}function RE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function iO(e){const t=aO(),n=Rc(e)?Nc(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Jxe(e){let t=wh(e);for(;ju(t)&&!ry(t);){if(iO(t))return t;if(RE(t))return null;t=wh(t)}return null}function aO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ry(e){return["html","body","#document"].includes(qy(e))}function Nc(e){return al(e).getComputedStyle(e)}function NE(e){return Rc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function wh(e){if(qy(e)==="html")return e;const t=e.assignedSlot||e.parentNode||I$(e)&&e.host||Lu(e);return I$(t)?t.host:t}function LG(e){const t=wh(e);return ry(t)?e.ownerDocument?e.ownerDocument.body:e.body:ju(t)&&g1(t)?t:LG(t)}function tw(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=LG(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=al(s);if(i){const o=vj(a);return t.concat(a,a.visualViewport||[],g1(s)?s:[],o&&n?tw(o):[])}return t.concat(s,tw(s,[],n))}function vj(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function BG(e){const t=Nc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=ju(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=OC(n)!==i||OC(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function oO(e){return Rc(e)?e:e.contextElement}function R0(e){const t=oO(e);if(!ju(t))return Su(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=BG(t);let a=(i?OC(n.width):n.width)/r,o=(i?OC(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Qxe=Su(0);function $G(e){const t=al(e);return!aO()||!t.visualViewport?Qxe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function ewe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==al(e)?!1:t}function Cm(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=oO(e);let a=Su(1);t&&(r?Rc(r)&&(a=R0(r)):a=R0(e));const o=ewe(i,n,r)?$G(i):Su(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=al(i),m=r&&Rc(r)?al(r):r;let y=h,b=vj(y);for(;b&&r&&m!==y;){const v=R0(b),x=b.getBoundingClientRect(),w=Nc(b),S=x.left+(b.clientLeft+parseFloat(w.paddingLeft))*v.x,k=x.top+(b.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=k,y=al(b),b=vj(y)}}return FC({width:u,height:d,x:l,y:c})}function lO(e,t){const n=NE(e).scrollLeft;return t?t.left+n:Cm(Lu(e)).left+n}function zG(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:lO(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function twe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=Lu(r),o=t?RE(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Su(1);const u=Su(0),d=ju(r);if((d||!d&&!i)&&((qy(r)!=="body"||g1(a))&&(l=NE(r)),ju(r))){const m=Cm(r);c=R0(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=a&&!d&&!i?zG(a,l,!0):Su(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function nwe(e){return Array.from(e.getClientRects())}function rwe(e){const t=Lu(e),n=NE(e),r=e.ownerDocument.body,s=sl(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=sl(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+lO(e);const o=-n.scrollTop;return Nc(r).direction==="rtl"&&(a+=sl(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function swe(e,t){const n=al(e),r=Lu(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=aO();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function iwe(e,t){const n=Cm(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=ju(e)?R0(e):Su(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function j$(e,t,n){let r;if(t==="viewport")r=swe(e,n);else if(t==="document")r=rwe(Lu(e));else if(Rc(t))r=iwe(t,n);else{const s=$G(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return FC(r)}function UG(e,t){const n=wh(e);return n===t||!Rc(n)||ry(n)?!1:Nc(n).position==="fixed"||UG(n,t)}function awe(e,t){const n=t.get(e);if(n)return n;let r=tw(e,[],!1).filter(o=>Rc(o)&&qy(o)!=="body"),s=null;const i=Nc(e).position==="fixed";let a=i?wh(e):e;for(;Rc(a)&&!ry(a);){const o=Nc(a),l=iO(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||g1(a)&&!l&&UG(e,a))?r=r.filter(u=>u!==a):s=o,a=wh(a)}return t.set(e,r),r}function owe(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?RE(t)?[]:awe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=j$(t,u,s);return c.top=sl(d.top,c.top),c.right=vh(d.right,c.right),c.bottom=vh(d.bottom,c.bottom),c.left=sl(d.left,c.left),c},j$(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function lwe(e){const{width:t,height:n}=BG(e);return{width:t,height:n}}function cwe(e,t,n){const r=ju(t),s=Lu(t),i=n==="fixed",a=Cm(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Su(0);if(r||!r&&!i)if((qy(t)!=="body"||g1(s))&&(o=NE(t)),r){const h=Cm(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=lO(s));const c=s&&!r&&!i?zG(s,o):Su(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function YN(e){return Nc(e).position==="static"}function P$(e,t){if(!ju(e)||Nc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Lu(e)===n&&(n=n.ownerDocument.body),n}function qG(e,t){const n=al(e);if(RE(e))return n;if(!ju(e)){let s=wh(e);for(;s&&!ry(s);){if(Rc(s)&&!YN(s))return s;s=wh(s)}return n}let r=P$(e,t);for(;r&&Xxe(r)&&YN(r);)r=P$(r,t);return r&&ry(r)&&YN(r)&&!iO(r)?n:r||Jxe(e)||n}const uwe=async function(e){const t=this.getOffsetParent||qG,n=this.getDimensions,r=await n(e.floating);return{reference:cwe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function dwe(e){return Nc(e).direction==="rtl"}const fwe={convertOffsetParentRelativeRectToViewportRelativeRect:twe,getDocumentElement:Lu,getClippingRect:owe,getOffsetParent:qG,getElementRects:uwe,getClientRects:nwe,getDimensions:lwe,getScale:R0,isElement:Rc,isRTL:dwe};function VG(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function hwe(e,t){let n=null,r;const s=Lu(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=c;if(o||t(),!h||!m)return;const y=MS(d),b=MS(s.clientWidth-(u+h)),v=MS(s.clientHeight-(d+m)),x=MS(u),S={rootMargin:-y+"px "+-b+"px "+-v+"px "+-x+"px",threshold:sl(0,vh(1,l))||1};let k=!0;function C(R){const A=R[0].intersectionRatio;if(A!==l){if(!k)return a();A?a(!1,A):r=setTimeout(()=>{a(!1,1e-7)},1e3)}A===1&&!VG(c,e.getBoundingClientRect())&&a(),k=!1}try{n=new IntersectionObserver(C,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(C,S)}n.observe(e)}return a(!0),i}function cO(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=oO(e),u=s||i?[...c?tw(c):[],...tw(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?hwe(c,n):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let y,b=l?Cm(e):null;l&&v();function v(){const x=Cm(e);b&&!VG(b,x)&&n(),b=x,y=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const pwe=Gxe,mwe=Kxe,gwe=Vxe,ywe=Zxe,bwe=Wxe,O$=qxe,vwe=Yxe,xwe=(e,t,n)=>{const r=new Map,s={platform:fwe,...n},i={...s.platform,_c:r};return Uxe(e,t,{...s,platform:i})};var N2=typeof document<"u"?E.useLayoutEffect:E.useEffect;function LC(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!LC(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!LC(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function WG(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function D$(e,t){const n=WG(e);return Math.round(t*n)/n}function ZN(e){const t=E.useRef(e);return N2(()=>{t.current=e}),t}function uO(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=E.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=E.useState(r);LC(h,r)||m(r);const[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useCallback(L=>{L!==R.current&&(R.current=L,b(L))},[]),S=E.useCallback(L=>{L!==A.current&&(A.current=L,x(L))},[]),k=i||y,C=a||v,R=E.useRef(null),A=E.useRef(null),N=E.useRef(u),I=l!=null,O=ZN(l),B=ZN(s),D=ZN(c),W=E.useCallback(()=>{if(!R.current||!A.current)return;const L={placement:t,strategy:n,middleware:h};B.current&&(L.platform=B.current),xwe(R.current,A.current,L).then(ne=>{const V={...ne,isPositioned:D.current!==!1};P.current&&!LC(N.current,V)&&(N.current=V,il.flushSync(()=>{d(V)}))})},[h,t,n,B,D]);N2(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(L=>({...L,isPositioned:!1})))},[c]);const P=E.useRef(!1);N2(()=>(P.current=!0,()=>{P.current=!1}),[]),N2(()=>{if(k&&(R.current=k),C&&(A.current=C),k&&C){if(O.current)return O.current(k,C,W);W()}},[k,C,W,O,I]);const Z=E.useMemo(()=>({reference:R,floating:A,setReference:w,setFloating:S}),[w,S]),U=E.useMemo(()=>({reference:k,floating:C}),[k,C]),H=E.useMemo(()=>{const L={position:n,left:0,top:0};if(!U.floating)return L;const ne=D$(U.floating,u.x),V=D$(U.floating,u.y);return o?{...L,transform:"translate("+ne+"px, "+V+"px)",...WG(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ne,top:V}},[n,o,U.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:W,refs:Z,elements:U,floatingStyles:H}),[u,W,Z,U,H])}const wwe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?O$({element:r.current,padding:s}).fn(n):{}:r?O$({element:r,padding:s}).fn(n):{}}}},dO=(e,t)=>({...pwe(e),options:[e,t]}),fO=(e,t)=>({...mwe(e),options:[e,t]}),hO=(e,t)=>({...vwe(e),options:[e,t]}),pO=(e,t)=>({...gwe(e),options:[e,t]}),mO=(e,t)=>({...ywe(e),options:[e,t]}),gO=(e,t)=>({...bwe(e),options:[e,t]}),yO=(e,t)=>({...wwe(e),options:[e,t]});var _we="Arrow",HG=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(or.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});HG.displayName=_we;var Swe=HG;function Vy(e){const[t,n]=E.useState(void 0);return ri(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var bO="Popper",[GG,ME]=Gi(bO),[Cwe,KG]=GG(bO),YG=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(Cwe,{scope:t,anchor:r,onAnchorChange:s,children:n})};YG.displayName=bO;var ZG="PopperAnchor",XG=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=KG(ZG,n),a=E.useRef(null),o=Nn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(or.div,{...s,ref:o})});XG.displayName=ZG;var vO="PopperContent",[kwe,Ewe]=GG(vO),JG=E.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=KG(vO,n),[x,w]=E.useState(null),S=Nn(t,Ne=>w(Ne)),[k,C]=E.useState(null),R=Vy(k),A=(R==null?void 0:R.width)??0,N=(R==null?void 0:R.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,W={padding:O,boundary:B.filter(Awe),altBoundary:D},{refs:P,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:L}=uO({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>cO(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[dO({mainAxis:s+N,alignmentAxis:a}),l&&fO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?hO():void 0,...W}),l&&pO({...W}),mO({...W,apply:({elements:Ne,rects:K,availableWidth:ge,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${ge}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&yO({element:k,padding:o}),Rwe({arrowWidth:A,arrowHeight:N}),h&&gO({strategy:"referenceHidden",...W})]}),[ne,V]=tK(U),Q=Es(y);ri(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=L.arrow)==null?void 0:De.x,se=(Se=L.arrow)==null?void 0:Se.y,me=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,je]=E.useState();return ri(()=>{x&&je(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(kwe,{scope:n,placedSide:ne,onArrowChange:C,arrowX:ee,arrowY:se,shouldHideArrow:me,children:f.jsx(or.div,{"data-side":ne,"data-align":V,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});JG.displayName=vO;var QG="PopperArrow",Twe={top:"bottom",right:"left",bottom:"top",left:"right"},eK=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=Ewe(QG,r),a=Twe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(Swe,{...s,ref:n,style:{...s.style,display:"block"}})})});eK.displayName=QG;function Awe(e){return e!==null}var Rwe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=tK(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function tK(e){const[t,n="center"]=e.split("-");return[t,n]}var nK=YG,rK=XG,sK=JG,iK=eK,Nwe="Portal",IE=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);ri(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?xE.createPortal(f.jsx(or.div,{...r,ref:t}),a):null});IE.displayName=Nwe;function Mwe(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var ca=e=>{const{present:t,children:n}=e,r=Iwe(t),s=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),i=Nn(r.ref,jwe(s));return typeof n=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};ca.displayName="Presence";function Iwe(e){const[t,n]=E.useState(),r=E.useRef(null),s=E.useRef(e),i=E.useRef("none"),a=e?"mounted":"unmounted",[o,l]=Mwe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=IS(r.current);i.current=o==="mounted"?c:"none"},[o]),ri(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,m=IS(c);e?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),ri(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const b=IS(r.current).includes(m.animationName);if(m.target===t&&b&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(i.current=IS(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function IS(e){return(e==null?void 0:e.animationName)||"none"}function jwe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Pwe=Symbol("radix.slottable");function Owe(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Pwe,t}var Dwe=YW[" useInsertionEffect ".trim().toString()]||ri;function Mc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=Fwe({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=E.useRef(e!==void 0);E.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=E.useCallback(u=>{var d;if(o){const h=Lwe(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function Fwe({defaultProp:e,onChange:t}){const[n,r]=E.useState(e),s=E.useRef(n),i=E.useRef(t);return Dwe(()=>{i.current=t},[t]),E.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function Lwe(e){return typeof e=="function"}var Bwe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),$we="VisuallyHidden",aK=E.forwardRef((e,t)=>f.jsx(or.span,{...e,ref:t,style:{...Bwe,...e.style}}));aK.displayName=$we;var zwe=aK,[jE,tdt]=Gi("Tooltip",[ME]),PE=ME(),oK="TooltipProvider",Uwe=700,xj="tooltip.open",[qwe,xO]=jE(oK),lK=e=>{const{__scopeTooltip:t,delayDuration:n=Uwe,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=E.useRef(!0),o=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(qwe,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:E.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};lK.displayName=oK;var nw="Tooltip",[Vwe,y1]=jE(nw),cK=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=xO(nw,e.__scopeTooltip),c=PE(t),[u,d]=E.useState(null),h=oa(),m=E.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,v=E.useRef(!1),[x,w]=Mc({prop:r,defaultProp:s??!1,onChange:A=>{A?(l.onOpen(),document.dispatchEvent(new CustomEvent(xj))):l.onClose(),i==null||i(A)},caller:nw}),S=E.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),k=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,w(!0)},[w]),C=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),R=E.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,w(!0),m.current=0},b)},[b,w]);return E.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(nK,{...c,children:f.jsx(Vwe,{scope:t,contentId:h,open:x,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayedRef.current?R():k()},[l.isOpenDelayedRef,R,k]),onTriggerLeave:E.useCallback(()=>{y?C():(window.clearTimeout(m.current),m.current=0)},[C,y]),onOpen:k,onClose:C,disableHoverableContent:y,children:n})})};cK.displayName=nw;var wj="TooltipTrigger",uK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=y1(wj,n),i=xO(wj,n),a=PE(n),o=E.useRef(null),l=Nn(t,o,s.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),d=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(rK,{asChild:!0,...a,children:f.jsx(or.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});uK.displayName=wj;var wO="TooltipPortal",[Wwe,Hwe]=jE(wO,{forceMount:void 0}),dK=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=y1(wO,t);return f.jsx(Wwe,{scope:t,forceMount:n,children:f.jsx(ca,{present:n||i.open,children:f.jsx(IE,{asChild:!0,container:s,children:r})})})};dK.displayName=wO;var sy="TooltipContent",fK=E.forwardRef((e,t)=>{const n=Hwe(sy,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=y1(sy,e.__scopeTooltip);return f.jsx(ca,{present:r||a.open,children:a.disableHoverableContent?f.jsx(hK,{side:s,...i,ref:t}):f.jsx(Gwe,{side:s,...i,ref:t})})}),Gwe=E.forwardRef((e,t)=>{const n=y1(sy,e.__scopeTooltip),r=xO(sy,e.__scopeTooltip),s=E.useRef(null),i=Nn(t,s),[a,o]=E.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=E.useCallback(()=>{o(null),d(!1)},[d]),m=E.useCallback((y,b)=>{const v=y.currentTarget,x={x:y.clientX,y:y.clientY},w=Xwe(x,v.getBoundingClientRect()),S=Jwe(x,w),k=Qwe(b.getBoundingClientRect()),C=t1e([...S,...k]);o(C),d(!0)},[d]);return E.useEffect(()=>()=>h(),[h]),E.useEffect(()=>{if(l&&u){const y=v=>m(v,u),b=v=>m(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,m,h]),E.useEffect(()=>{if(a){const y=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),S=!e1e(x,a);w?h():S&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),f.jsx(hK,{...e,ref:i})}),[Kwe,Ywe]=jE(nw,{isInside:!1}),Zwe=Owe("TooltipContent"),hK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=y1(sy,n),c=PE(n),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(xj,u),()=>document.removeEventListener(xj,u)),[u]),E.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(TE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(sK,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(Zwe,{children:r}),f.jsx(Kwe,{scope:n,isInside:!0,children:f.jsx(zwe,{id:l.contentId,role:"tooltip",children:s||r})})]})})});fK.displayName=sy;var pK="TooltipArrow",mK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=PE(n);return Ywe(pK,n).isInside?null:f.jsx(iK,{...s,...r,ref:t})});mK.displayName=pK;function Xwe(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Jwe(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function Qwe(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function e1e(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function t1e(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),n1e(t)}function n1e(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var r1e=lK,s1e=cK,i1e=uK,a1e=dK,o1e=fK,l1e=mK;function xr({delayDuration:e=0,...t}){return f.jsx(r1e,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function wr({...e}){return f.jsx(xr,{children:f.jsx(s1e,{"data-slot":"tooltip",...e})})}function _r({...e}){return f.jsx(i1e,{"data-slot":"tooltip-trigger",...e})}function Sr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(a1e,{children:f.jsxs(o1e,{"data-slot":"tooltip-content",sideOffset:t,className:Je("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(l1e,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}class c1e{static findRendererForLanguage(t,n){const r=Object.values(n);if(r.length===0)return null;const s=r.filter(o=>{var l;return(l=o.supportedLanguages)==null?void 0:l.includes(t||"")}),i=r.filter(o=>!o.supportedLanguages||o.supportedLanguages.length===0);return[...s,...i].sort((o,l)=>(l.priority||0)-(o.priority||0))[0]||null}static renderBlock(t){const n=Ui.getState().blockRenderers,r=this.findRendererForLanguage(t.lang,n);if(!r)return null;try{return r.renderer(t)}catch(s){return console.error(`[BlockRendererService] Error rendering block with renderer ${r.id}:`,s),null}}static getRegisteredRenderers(){return Ui.getState().blockRenderers}static hasRendererForLanguage(t){const n=Ui.getState().blockRenderers;return this.findRendererForLanguage(t,n)!==null}}const Wy=({lang:e,code:t,filepath:n,isStreaming:r=!1})=>{const s=Ui(gn(o=>o.blockRenderers)),i=E.useMemo(()=>ws(),[]),a=E.useMemo(()=>{const o={lang:e,code:t,filepath:n,isStreaming:r,blockId:i},l=c1e.findRendererForLanguage(e,s);if(!l){const c=e?`language-${e}`:"language-plaintext";return f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:`${c} block p-4 font-mono text-sm leading-relaxed`,children:t})})]})}try{return l.renderer(o)}catch(c){return console.error(`[UniversalBlockRenderer] Error rendering block with renderer ${l.id}:`,c),f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsxs("div",{className:"text-sm font-medium text-destructive",children:[e?e.toUpperCase():"CODE"," (Render Error)"]})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:"block p-4 font-mono text-sm leading-relaxed",children:t})})]})}},[e,t,n,r,i,s]);return f.jsx(f.Fragment,{children:a})};var yt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(yt||(yt={}));const F$={[yt.EPERM]:"Operation not permitted",[yt.ENOENT]:"No such file or directory",[yt.EINTR]:"Interrupted system call",[yt.EIO]:"Input/output error",[yt.ENXIO]:"No such device or address",[yt.EBADF]:"Bad file descriptor",[yt.EAGAIN]:"Resource temporarily unavailable",[yt.ENOMEM]:"Cannot allocate memory",[yt.EACCES]:"Permission denied",[yt.EFAULT]:"Bad address",[yt.ENOTBLK]:"Block device required",[yt.EBUSY]:"Resource busy or locked",[yt.EEXIST]:"File exists",[yt.EXDEV]:"Invalid cross-device link",[yt.ENODEV]:"No such device",[yt.ENOTDIR]:"File is not a directory",[yt.EISDIR]:"File is a directory",[yt.EINVAL]:"Invalid argument",[yt.ENFILE]:"Too many open files in system",[yt.EMFILE]:"Too many open files",[yt.ETXTBSY]:"Text file busy",[yt.EFBIG]:"File is too big",[yt.ENOSPC]:"No space left on disk",[yt.ESPIPE]:"Illegal seek",[yt.EROFS]:"Cannot modify a read-only file system",[yt.EMLINK]:"Too many links",[yt.EPIPE]:"Broken pipe",[yt.EDOM]:"Numerical argument out of domain",[yt.ERANGE]:"Numerical result out of range",[yt.EDEADLK]:"Resource deadlock would occur",[yt.ENAMETOOLONG]:"File name too long",[yt.ENOLCK]:"No locks available",[yt.ENOSYS]:"Function not implemented",[yt.ENOTEMPTY]:"Directory is not empty",[yt.ELOOP]:"Too many levels of symbolic links",[yt.ENOMSG]:"No message of desired type",[yt.EBADE]:"Invalid exchange",[yt.EBADR]:"Invalid request descriptor",[yt.EXFULL]:"Exchange full",[yt.ENOANO]:"No anode",[yt.EBADRQC]:"Invalid request code",[yt.ENOSTR]:"Device not a stream",[yt.ENODATA]:"No data available",[yt.ETIME]:"Timer expired",[yt.ENOSR]:"Out of streams resources",[yt.ENONET]:"Machine is not on the network",[yt.EREMOTE]:"Object is remote",[yt.ENOLINK]:"Link has been severed",[yt.ECOMM]:"Communication error on send",[yt.EPROTO]:"Protocol error",[yt.EBADMSG]:"Bad message",[yt.EOVERFLOW]:"Value too large for defined data type",[yt.EBADFD]:"File descriptor in bad state",[yt.ESTRPIPE]:"Streams pipe error",[yt.ENOTSOCK]:"Socket operation on non-socket",[yt.EDESTADDRREQ]:"Destination address required",[yt.EMSGSIZE]:"Message too long",[yt.EPROTOTYPE]:"Protocol wrong type for socket",[yt.ENOPROTOOPT]:"Protocol not available",[yt.EPROTONOSUPPORT]:"Protocol not supported",[yt.ESOCKTNOSUPPORT]:"Socket type not supported",[yt.ENOTSUP]:"Operation is not supported",[yt.ENETDOWN]:"Network is down",[yt.ENETUNREACH]:"Network is unreachable",[yt.ENETRESET]:"Network dropped connection on reset",[yt.ETIMEDOUT]:"Connection timed out",[yt.ECONNREFUSED]:"Connection refused",[yt.EHOSTDOWN]:"Host is down",[yt.EHOSTUNREACH]:"No route to host",[yt.EALREADY]:"Operation already in progress",[yt.EINPROGRESS]:"Operation now in progress",[yt.ESTALE]:"Stale file handle",[yt.EREMOTEIO]:"Remote I/O error",[yt.EDQUOT]:"Disk quota exceeded"};class Ze extends Error{static fromJSON(t){const n=new Ze(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Ze(yt[t],F$[yt[t]],n,r)}constructor(t,n=F$[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=yt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var XN={exports:{}},L$;function u1e(){return L$||(L$=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,y=new Array(m);h<m;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,m,y){var b=n?n+c:c;if(!this._events[b])return!1;var v=this._events[b],x=arguments.length,w,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,m),!0;case 6:return v.fn.call(v.context,u,d,h,m,y),!0}for(S=1,w=new Array(x-1);S<x;S++)w[S-1]=arguments[S];v.fn.apply(v.context,w)}else{var k=v.length,C;for(S=0;S<k;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),x){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,u);break;case 3:v[S].fn.call(v[S].context,u,d);break;case 4:v[S].fn.call(v[S].context,u,d,h);break;default:if(!w)for(C=1,w=new Array(x-1);C<x;C++)w[C-1]=arguments[C];v[S].fn.apply(v[S].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,m);else{for(var b=0,v=[],x=y.length;b<x;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&v.push(y[b]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(XN)),XN.exports}var d1e=u1e();const _O=Sa(d1e);var VW;let f1e=class extends _O{constructor(n){super();de(this,VW,"List");de(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(VW=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function B$(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function bs(e){throw e}const $$=Intl.NumberFormat("en",{notation:"compact"});$$.format.bind($$);function Bm(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function h1e(e){try{return JSON.parse(e),!0}catch{return!1}}function _j(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function SO(e){return e.at(0).toUpperCase()+e.slice(1)}const p1e=new TextEncoder;function Zp(e){return p1e.encode(e)}const z$=new TextDecoder;function CO(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return z$.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),z$.decode(t)}function rw(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=rw(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function m1e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var g1e={};let y1e="process"in globalThis&&"env"in globalThis.process&&g1e.U_DEBUG=="true";function sw(...e){y1e&&console.debug("[U]",...e)}const U$=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],b1e=[...U$,...U$.map(e=>SO(e)),"char"],kO=/^(u?int|float)(8|16|32|64|128)$/i;function gK(e){return e=="char"?"uint8":e.toLowerCase()}function EO(e){return kO.test(e.toString())}function Sj(e){return e=="char"||kO.test(e.toString().toLowerCase())}function v1e(e){if(!Sj(e))throw new TypeError("Not a valid primitive type: "+e)}const q$=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function yK(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function x1e(e){return e!=null&&typeof e=="object"&&"struct"in e}function OE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Sc(e){return typeof e=="function"&&Symbol.metadata in e&&x1e(e[Symbol.metadata])}function b1(e){return e!=null&&typeof e=="object"&&Sc(e.constructor)}function bK(e){if(!b1(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function TO(e){return b1(e)||Sc(e)}function vK(e){if(!TO(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function AO(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function qs(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=qs(e[i]);return s}if(typeof e=="string")return v1e(e),+gK(e).match(kO)[2]/8;if(AO(e))return e[Symbol.size];vK(e);const t=Sc(e)?e:e.constructor;OE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Sc(e))return r;for(const s of n.members.values()){const i=e[s.name];if(b1(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,qs(i)):r+=qs(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=qs(TO(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function w1e(e,t){var i;vK(e);const n=Sc(e)?e:e.constructor;OE(n);const{struct:r}=n[Symbol.metadata];if(Sc(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??bs(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=qs(TO(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function _1e(e,t){return Math.ceil(e/t)*t}function $m(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of yK(r)){if(!Sj(l)&&!Sc(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!EO(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:Sj(l)?gK(l):l,length:c,decl:u});const d=typeof c=="string"||Sc(l)&&l[Symbol.metadata].struct.isDynamic?0:qs(l)*(c||1);a||(a=Sc(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=_1e(i,e.align||1),sw("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function iw(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return yK(r).push({name:s,type:e,length:t}),n}}function xK(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:bs(new Error("Array lengths must be natural numbers"))}function ya(e){if(AO(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();bK(e),OE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=qs(e),s=new Uint8Array(r),i=new DataView(s.buffer);sw("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=xK(e,l);sw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=b1(d)?qs(d):qs(l.type),!EO(l.type)){s.set(d?ya(d):new Uint8Array(qs(l.type)),a);continue}const h=`set${SO(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&q$,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&q$,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function DE(e,t){const n=m1e(t);if(AO(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);bK(e),OE(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);sw("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=xK(e,l);sw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,m=d[h]===null||d[h]===void 0,y=m&&Sc(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!b1(d[h])&&!y&&(o+=qs(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!EO(l.type)){if(y&&Sc(l.type))d[h]??(d[h]=new l.type);else if(m)continue;DE(d[h],new Uint8Array(n.subarray(a))),o+=qs(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${SO(l.type)}`;if(b=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[b](a,!r.bigEndian)}}}function S1e(e){function t(n,r){return typeof n=="number"||typeof n=="string"?iw(e,n):iw(e)(n,r)}return t}const Jn=Object.fromEntries(b1e.map(e=>[e,S1e(e)]));function C1e(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const Dc={root:"/",pwd:"/",credentials:C1e({uid:0,gid:0}),descriptors:new Map};function wK(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Hd(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:Dc.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=wK(n,!r),r?`/${n}`:n.length?n:"/"}function k1e(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=wK(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function as(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?k1e(t):"."}function _K(e,t){if(e===t||(e=Hd.call(this,e),t=Hd.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function Yr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function iy(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function ou(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var Hn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(Hn||(Hn={}));Hn.EMERG+"",Hn.ALERT+"",Hn.CRIT+"",Hn.ERR+"",Hn.WARN+"",Hn.NOTICE+"",Hn.INFO+"",Hn.DEBUG+"";const E1e=new f1e;function T1e(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};E1e.add(n),O1e(n)}function A1e(e,t){var n,r;if(!(e instanceof Ze))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+as(i,e.path)}function zh(e){return function(t,n={}){return T1e(e,A1e(t,n)),t}}zh(Hn.EMERG);const R1e=zh(Hn.ALERT),FE=zh(Hn.CRIT),_o=zh(Hn.ERR),Oa=zh(Hn.WARN),RO=zh(Hn.NOTICE),SK=zh(Hn.INFO),_x=zh(Hn.DEBUG);function N1e(e,t){return`\x1B[${t}m${e}\x1B[0m`}function M1e(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[N1e(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}Hn.EMERG+"",Hn.ALERT+"",Hn.CRIT+"",Hn.ERR+"",Hn.WARN+"",Hn.NOTICE+"",Hn.INFO+"",Hn.DEBUG+"",Hn.EMERG+"",Hn.ALERT+"",Hn.CRIT+"",Hn.ERR+"",Hn.WARN+"",Hn.NOTICE+"",Hn.INFO+"",Hn.DEBUG+"";Hn.EMERG+"",Hn.ALERT+"",Hn.CRIT+"",Hn.ERR+"",Hn.WARN+"",Hn.NOTICE+"",Hn.INFO+"",Hn.DEBUG+"",Hn.EMERG+"",Hn.ALERT+"",Hn.CRIT+"",Hn.ERR+"",Hn.WARN+"",Hn.NOTICE+"",Hn.INFO+"",Hn.DEBUG+"";let I1e=e=>[...M1e(e),e.message];function j1e(e){const t=I1e(e);return typeof t=="string"?[t]:Array.from(t)}let P1e=console.error;function O1e(e){e.level>D1e||P1e(...j1e(e))}let D1e=Hn.ALERT;function NO(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function F1e(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function L1e(e,t){if(typeof t!="object"||t===null)throw _o(new Ze(yt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){_x("Using default for option: "+n);continue}throw _o(new Ze(yt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw _o(new Ze(yt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function CK(e){return e!=null&&typeof e=="object"&&"backend"in e&&NO(e.backend)}const MO=0,qi=4,li=2,M2=1,IO=1,B1e=2,$1e=4,kK=0,Pa=1,Pd=2,LE=64,BE=128,z1e=256,$E=512,km=1024,U1e=65536,q1e=262144,V1e=131072,zE=1052672,W1e=4096,H1e=32768,G1e=16384,K1e=2048,ks=61440,zm=49152,tf=40960,Cc=32768,Um=24576,Ri=16384,qm=8192,Vm=4096,v1=2048,x1=1024,Y1e=512,Z1e=448,EK=256,TK=128,AK=64,X1e=56,RK=32,NK=16,MK=8,J1e=7,IK=4,jK=2,PK=1,Q1e=0,ao=4294967295,OK=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:IO,COPYFILE_FICLONE:B1e,COPYFILE_FICLONE_FORCE:$1e,F_OK:MO,O_APPEND:km,O_CREAT:LE,O_DIRECT:G1e,O_DIRECTORY:U1e,O_DSYNC:W1e,O_EXCL:BE,O_NOATIME:q1e,O_NOCTTY:z1e,O_NOFOLLOW:V1e,O_NONBLOCK:K1e,O_RDONLY:kK,O_RDWR:Pd,O_SYMLINK:H1e,O_SYNC:zE,O_TRUNC:$E,O_WRONLY:Pa,R_OK:qi,S_IFBLK:Um,S_IFCHR:qm,S_IFDIR:Ri,S_IFIFO:Vm,S_IFLNK:tf,S_IFMT:ks,S_IFREG:Cc,S_IFSOCK:zm,S_IRGRP:RK,S_IROTH:IK,S_IRUSR:EK,S_IRWXG:X1e,S_IRWXO:J1e,S_IRWXU:Z1e,S_ISGID:x1,S_ISUID:v1,S_ISVTX:Y1e,S_IWGRP:NK,S_IWOTH:jK,S_IWUSR:TK,S_IXGRP:MK,S_IXOTH:PK,S_IXUSR:AK,UV_FS_O_FILEMAP:Q1e,W_OK:li,X_OK:M2,size_max:ao},Symbol.toStringTag,{value:"Module"})),jS=BigInt(1e3);class DK{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Cc),(this.mode&ks)==0&&(this.mode=this.mode|this._convert(Cc)),Object.assign(this,u)}isFile(){return(this.mode&ks)===Cc}isDirectory(){return(this.mode&ks)===Ri}isSymbolicLink(){return(this.mode&ks)===tf}isSocket(){return(this.mode&ks)===zm}isBlockDevice(){return(this.mode&ks)===Um}isCharacterDevice(){return(this.mode&ks)===qm}isFIFO(){return(this.mode&ks)===Vm}toJSON(){return Bm(this,Cj)}hasAccess(t,n){return fs(n,this._isBigint?new nf(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*jS}get mtimeNs(){return BigInt(this.mtimeMs)*jS}get ctimeNs(){return BigInt(this.ctimeMs)*jS}get birthtimeNs(){return BigInt(this.birthtimeMs)*jS}}function FK(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<ao?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<ao?e.gid=n:r=!1,r}class nf extends DK{constructor(){super(...arguments),this._isBigint=!1}}class Wm extends DK{constructor(){super(...arguments),this._isBigint=!0}}function e_e(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class t_e{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=ao,this.ffree=ao}}class n_e{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(ao),this.ffree=BigInt(ao)}}var Ps=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Wn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},jO=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const Xo=0,r_e=1024;let V$=(()=>{var e,t;let n=[$m()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,m=[],y=[],b,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,S){this.keySize=Wn(this,o,0),this.valueSize=(Wn(this,l),Wn(this,u,0)),this._key=(Wn(this,d),Wn(this,m,"")),this._value=(Wn(this,y),Wn(this,v,new Uint8Array(r_e))),Wn(this,x),w&&(this.key=w),S&&(this.value=S)}},jO(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=Jn).uint32.bind(e)],c=[(t=Jn).uint32.bind(t)],h=[Jn.char("keySize")],b=[Jn.uint8("valueSize")],Ps(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,k)=>{S.keySize=k}},metadata:w},o,l),Ps(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,k)=>{S.valueSize=k}},metadata:w},u,d),Ps(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,k)=>{S._key=k}},metadata:w},m,y),Ps(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,k)=>{S._value=k}},metadata:w},v,x),Ps(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Wn(i,s)})(),i})(),_h=(()=>{var e;let t=[$m()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const m=this.get(d);if(m){m.value=h;return}this.data.push(new V$(d,h)),this.size++}remove(d){const h=this.data.findIndex(m=>m.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Wn(this,a,0),this.data=(Wn(this,o),Wn(this,c,[])),Wn(this,u)}},jO(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=Jn).uint32.bind(e)],l=[iw(V$,"size")],Ps(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,m)=>{h.size=m}},metadata:d},a,o),Ps(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,m)=>{h.data=m}},metadata:d},c,u),Ps(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Wn(s,r)})(),s})();const Cj=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],s_e=4;var So;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(So||(So={}));let Ei=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,m,y,b;let v=[$m()],x,w=[],S,k,C=[],R=[],A,N=[],I=[],O,B=[],D=[],W,P=[],Z=[],U,H=[],L=[],ne,V=[],Q=[],ee,se=[],me=[],ce,je=[],De=[],Se,Ce=[],qe=[],Qe,We=[],Ne=[],K,ge=[],Ae=[],le,oe=[],re=[],Te,Be=[],ke=[],lt,Rt=[],ft=[],Pt,qt=[],Lt=[],en,xe=[],F=[],X,ye=[],Fe=[],we,Ie=[],fe=[];var vt=S=class{constructor(ot){if(this.data=Wn(this,C,_j(0,ao)),this.__data_old=(Wn(this,R),Wn(this,N,0)),this.size=(Wn(this,I),Wn(this,B,0)),this.mode=(Wn(this,D),Wn(this,P,0)),this.nlink=(Wn(this,Z),Wn(this,H,1)),this.uid=(Wn(this,L),Wn(this,V,0)),this.gid=(Wn(this,Q),Wn(this,se,0)),this.atimeMs=(Wn(this,me),Wn(this,je,Date.now())),this.birthtimeMs=(Wn(this,De),Wn(this,Ce,Date.now())),this.mtimeMs=(Wn(this,qe),Wn(this,We,Date.now())),this.ctimeMs=(Wn(this,Ne),Wn(this,ge,Date.now())),this.ino=(Wn(this,Ae),Wn(this,oe,_j(0,ao))),this.__ino_old=(Wn(this,re),Wn(this,Be,0)),this.flags=(Wn(this,ke),Wn(this,Rt,0)),this.__after_flags=(Wn(this,ft),Wn(this,qt,0)),this.version=(Wn(this,Lt),Wn(this,xe,0)),this.__padding=(Wn(this,F),Wn(this,ye,[])),this.attributes=(Wn(this,Fe),Wn(this,Ie,new _h)),Wn(this,fe),!!ot){if(!("byteLength"in ot)){Object.assign(this,ot);return}if(ot.byteLength<qs(vt))throw FE(new Ze(yt.EIO,"Buffer is too small to create an inode"));DE(this,ot)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Bm(this,Cj),attributes:this.attributes}}toStats(){return new nf(this)}update(ot){if(!ot)return!1;let $=!1;for(const ze of Cj)ot[ze]!==void 0&&(ze=="ino"||ze=="data"||this[ze]!==ot[ze]&&(ze=="atimeMs"&&this.flags&So.NoAtime||(this[ze]=ot[ze],$=!0)));return ot.attributes&&(this.attributes=ot.attributes,$=!0),$&&(this.ctimeMs=Date.now()),$}};return jO(S,"Inode"),(()=>{const ot=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;k=[(e=Jn).uint32.bind(e)],A=[(t=Jn).uint32.bind(t)],O=[(n=Jn).uint32.bind(n)],W=[(r=Jn).uint16.bind(r)],U=[(s=Jn).uint32.bind(s)],ne=[(i=Jn).uint32.bind(i)],ee=[(a=Jn).uint32.bind(a)],ce=[(o=Jn).float64.bind(o)],Se=[(l=Jn).float64.bind(l)],Qe=[(c=Jn).float64.bind(c)],K=[(u=Jn).float64.bind(u)],le=[(d=Jn).uint32.bind(d)],Te=[(h=Jn).uint32.bind(h)],lt=[(m=Jn).uint32.bind(m)],Pt=[(y=Jn).uint16.bind(y)],en=[(b=Jn).uint32.bind(b)],X=[Jn.uint8(48)],we=[iw(_h)],Ps(null,null,k,{kind:"field",name:"data",static:!1,private:!1,access:{has:$=>"data"in $,get:$=>$.data,set:($,ze)=>{$.data=ze}},metadata:ot},C,R),Ps(null,null,A,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:$=>"__data_old"in $,get:$=>$.__data_old,set:($,ze)=>{$.__data_old=ze}},metadata:ot},N,I),Ps(null,null,O,{kind:"field",name:"size",static:!1,private:!1,access:{has:$=>"size"in $,get:$=>$.size,set:($,ze)=>{$.size=ze}},metadata:ot},B,D),Ps(null,null,W,{kind:"field",name:"mode",static:!1,private:!1,access:{has:$=>"mode"in $,get:$=>$.mode,set:($,ze)=>{$.mode=ze}},metadata:ot},P,Z),Ps(null,null,U,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:$=>"nlink"in $,get:$=>$.nlink,set:($,ze)=>{$.nlink=ze}},metadata:ot},H,L),Ps(null,null,ne,{kind:"field",name:"uid",static:!1,private:!1,access:{has:$=>"uid"in $,get:$=>$.uid,set:($,ze)=>{$.uid=ze}},metadata:ot},V,Q),Ps(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:$=>"gid"in $,get:$=>$.gid,set:($,ze)=>{$.gid=ze}},metadata:ot},se,me),Ps(null,null,ce,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:$=>"atimeMs"in $,get:$=>$.atimeMs,set:($,ze)=>{$.atimeMs=ze}},metadata:ot},je,De),Ps(null,null,Se,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:$=>"birthtimeMs"in $,get:$=>$.birthtimeMs,set:($,ze)=>{$.birthtimeMs=ze}},metadata:ot},Ce,qe),Ps(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:$=>"mtimeMs"in $,get:$=>$.mtimeMs,set:($,ze)=>{$.mtimeMs=ze}},metadata:ot},We,Ne),Ps(null,null,K,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:$=>"ctimeMs"in $,get:$=>$.ctimeMs,set:($,ze)=>{$.ctimeMs=ze}},metadata:ot},ge,Ae),Ps(null,null,le,{kind:"field",name:"ino",static:!1,private:!1,access:{has:$=>"ino"in $,get:$=>$.ino,set:($,ze)=>{$.ino=ze}},metadata:ot},oe,re),Ps(null,null,Te,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:$=>"__ino_old"in $,get:$=>$.__ino_old,set:($,ze)=>{$.__ino_old=ze}},metadata:ot},Be,ke),Ps(null,null,lt,{kind:"field",name:"flags",static:!1,private:!1,access:{has:$=>"flags"in $,get:$=>$.flags,set:($,ze)=>{$.flags=ze}},metadata:ot},Rt,ft),Ps(null,null,Pt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:$=>"__after_flags"in $,get:$=>$.__after_flags,set:($,ze)=>{$.__after_flags=ze}},metadata:ot},qt,Lt),Ps(null,null,en,{kind:"field",name:"version",static:!1,private:!1,access:{has:$=>"version"in $,get:$=>$.version,set:($,ze)=>{$.version=ze}},metadata:ot},xe,F),Ps(null,null,X,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:$=>"__padding"in $,get:$=>$.__padding,set:($,ze)=>{$.__padding=ze}},metadata:ot},ye,Fe),Ps(null,null,we,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:$=>"attributes"in $,get:$=>$.attributes,set:($,ze)=>{$.attributes=ze}},metadata:ot},Ie,fe),Ps(null,x={value:S},v,{kind:"class",name:S.name,metadata:ot},null,w),vt=S=x.value,ot&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ot}),Wn(S,w)})(),vt=S})();function i_e(e){return(e.mode&ks)===Cc}function Ic(e){return(e.mode&ks)===Ri}function ay(e){return(e.mode&ks)===tf}function a_e(e){return(e.mode&ks)===zm}function aw(e){return(e.mode&ks)===Um}function ow(e){return(e.mode&ks)===qm}function o_e(e){return(e.mode&ks)===Vm}function fs(e,t,n){const r=(e==null?void 0:e.credentials)||Dc.credentials;if(ay(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&EK&&(s|=qi),t.mode&TK&&(s|=li),t.mode&AK&&(s|=M2)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&RK&&(s|=qi),t.mode&NK&&(s|=li),t.mode&MK&&(s|=M2)),t.mode&IK&&(s|=qi),t.mode&jK&&(s|=li),t.mode&PK&&(s|=M2),(s&n)===n}const W$=1;class BC extends Map{constructor(){super(...arguments),this.maxSize=ao}toJSON(){return{version:W$,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*qs(Ei);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Ze.With("ENOENT",t);if((n.mode&ks)!=Ri)throw Ze.With("ENOTDIR",t);const r={};for(const s of this.keys())Yr(s)==t&&s!=t&&(r[iy(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&ks)!=Ri)continue;const s={};for(const i of this.keys())Yr(i)==n&&i!=n&&(s[iy(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=W$)throw new Ze(yt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=_j(1,ao)),r=="/"&&(s.ino=0),this.set(r,new Ei(s));return this}static parse(t){if(!h1e(t))throw new Ze(yt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new BC;return r.fromJSON(n),r}}const JN=4096;let PO=class kj{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===kj.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===kj.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=JN){const l=o+JN>a?a-o:JN,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function Ka(e){return JSON.parse(CO(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Al(e){return Zp(JSON.stringify(e))}function Uh(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Ze(yt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function $C(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Ze(yt.EINVAL,"Invalid time.")}}function Dn(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Ze(yt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Ze(yt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Ze(yt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Hd(e)}function Od(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:Uh("mode"in e?e==null?void 0:e.mode:null,r)}}class l_e{constructor(t,n,r,s){de(this,"id");de(this,"_size");de(this,"options");de(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=rw(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=rw(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var QN,eM,tM;(QN=Promise.withResolvers)!==null&&QN!==void 0||(Promise.withResolvers=(Oa("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(eM=Symbol.dispose)!==null&&eM!==void 0||(Symbol.dispose=(Oa("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(tM=Symbol.asyncDispose)!==null&&tM!==void 0||(Symbol.asyncDispose=(Oa("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class LK{constructor(t){this.store=t}}class c_e extends LK{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class Ej extends LK{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new l_e(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw _o(Ze.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Oa("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class u_e{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof Ej))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof Ej))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Is=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},js=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class BK extends PO{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=_K(t,s);if(a.startsWith(".."))continue;let o=as(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Oa("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,_x(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,ya(a)),s.has(i)&&await r.set(a.data,Al(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,ya(a)),s.has(i)&&r.setSync(a.data,Al(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new BC,s=Is(n,this.transaction(),!0),i=[["/",0]],a=B$(Ze.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ei(await s.get(l));if(r.set(o,c),c.mode&Ri){const u=Ka((t=await s.get(c.data))!==null&&t!==void 0?t:bs(Ze.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([as(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new BC,s=Is(n,this.transaction(),!1),i=[["/",0]],a=B$(Ze.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ei(s.getSync(l));if(r.set(o,c),c.mode&Ri){const u=Ka((t=s.getSync(c.data))!==null&&t!==void 0?t:bs(Ze.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([as(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!0),l=ou(t),c=ou(n),u=await this.findInode(o,l.dir,"rename"),d=Ka((r=await o.get(u.data))!==null&&r!==void 0?r:bs(Ze.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Ze.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&_o(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ze(yt.EBUSY,l.dir);const m=c.dir==l.dir,y=m?u:await this.findInode(o,c.dir,"rename"),b=m?d:Ka((s=await o.get(y.data))!==null&&s!==void 0?s:bs(Ze.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ei((i=await o.get(b[c.base]))!==null&&i!==void 0?i:bs(Ze.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Ze.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,Al(d)),await o.set(y.data,Al(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!1),l=ou(t),c=ou(n),u=this.findInodeSync(o,l.dir,"rename"),d=Ka((r=o.getSync(u.data))!==null&&r!==void 0?r:bs(Ze.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Ze.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&_o(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ze(yt.EBUSY,l.dir);const m=c.dir===l.dir,y=m?u:this.findInodeSync(o,c.dir,"rename"),b=m?d:Ka((s=o.getSync(y.data))!==null&&s!==void 0?s:bs(Ze.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ei((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:bs(Ze.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Ze.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,Al(d)),o.setSync(y.data,Al(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ya(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=js(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,ya(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{js(r)}}async createFile(t,n){return n.mode|=Cc,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Cc,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Ze.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Ze.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Ri,await this.commitNew(t,n,Zp("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Ri,this.commitNewSync(t,n,Zp("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(Ka((n=await s.get(i.data))!==null&&n!==void 0?n:bs(Ze.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=js(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(Ka((n=s.getSync(i.data))!==null&&n!==void 0?n:bs(Ze.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{js(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,ya(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=js(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,ya(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{js(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!0),a=Yr(n),o=await this.findInode(i,a,"link"),l=Ka((r=await i.get(o.data))!==null&&r!==void 0?r:bs(Ze.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[iy(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,ya(c)),await i.set(o.data,Al(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=js(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!1),a=Yr(n),o=this.findInodeSync(i,a,"link"),l=Ka((r=i.getSync(o.data))!==null&&r!==void 0?r:bs(Ze.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[iy(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,ya(c)),i.setSync(o.data,Al(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{js(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:bs(Ze.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&_o(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:bs(Ze.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&_o(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Is(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=rw((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=js(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Is(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=rw((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{js(i)}}transaction(){return new u_e(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Is(t,this.transaction(),!0);if(await n.get(Xo))return;const r=new Ei({ino:Xo,data:1,mode:511|Ri});await n.set(r.data,Zp("{}")),this._add(Xo,"/"),await n.set(Xo,ya(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=js(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Is(t,this.transaction(),!1);if(n.getSync(Xo))return;const r=new Ei({ino:Xo,data:1,mode:511|Ri});n.setSync(r.data,Zp("{}")),this._add(Xo,"/"),n.setSync(Xo,ya(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{js(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Oa("Attempted to populate tables after initialization");return}_x("Populating tables with existing store metadata");const n=Is(t,this.transaction(),!0),r=await n.get(Xo);if(!r){RO("Store does not have a root inode");const o=new Ei({ino:Xo,data:1,mode:511|Ri});await n.set(o.data,Zp("{}")),this._add(Xo,"/"),await n.set(Xo,ya(o)),await n.commit();return}if(r.length<qs(Ei)){FE("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",Xo]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Oa("Store is missing data for inode: "+l);continue}if(c.length<qs(Ei)){Oa(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Ei(c);if((u.mode&Ri)!=Ri||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Oa("Store is missing directory data: "+u.data);continue}const h=Ka(d);for(const[m,y]of Object.entries(h))a.push([as(o,m),y])}_x(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=js(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Ze.With("ENOENT",n,r);return new Ei((s=await t.get(i))!==null&&s!==void 0?s:bs(Ze.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Ze.With("ENOENT",n,r);return new Ei((s=t.getSync(i))!==null&&s!==void 0?s:bs(Ze.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>ao)throw _o(new Ze(yt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ze.With("EEXIST",t,s);const o=Is(a,this.transaction(),!0),{dir:l,base:c}=ou(t),u=await this.findInode(o,l,s),d=Ka((i=await o.get(u.data))!==null&&i!==void 0?i:bs(Ze.With("ENOENT",l,s)));if(d[c])throw Ze.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ei({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(m.ino,ya(m)),await o.set(m.data,r),d[c]=m.ino,await o.set(u.data,Al(d)),await o.commit(),m}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ze.With("EEXIST",t,s);const o=Is(a,this.transaction(),!1),{dir:l,base:c}=ou(t),u=this.findInodeSync(o,l,s),d=Ka((i=o.getSync(u.data))!==null&&i!==void 0?i:bs(Ze.With("ENOENT",l,s)));if(d[c])throw Ze.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ei({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(m.ino,ya(m)),o.setSync(m.data,r),d[c]=m.ino,o.setSync(u.data,Al(d)),o.commitSync(),m}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Is(i,this.transaction(),!0),{dir:l,base:c}=ou(t),u=await this.findInode(o,l,a),d=Ka((r=await o.get(u.data))!==null&&r!==void 0?r:bs(Ze.With("ENOENT",l,a)));if(!d[c])throw Ze.With("ENOENT",t,a);const h=d[c],m=new Ei((s=await o.get(h))!==null&&s!==void 0?s:bs(Ze.With("ENOENT",t,a)));if(delete d[c],!n&&Ic(m))throw Ze.With("EISDIR",t,a);await o.set(u.data,Al(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),await o.set(m.ino,ya(m))):(await o.remove(m.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=js(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Is(i,this.transaction(),!1),{dir:l,base:c}=ou(t),u=this.findInodeSync(o,l,a),d=Ka((r=o.getSync(u.data))!==null&&r!==void 0?r:bs(Ze.With("ENOENT",l,a))),h=d[c];if(!h)throw Ze.With("ENOENT",t,a);const m=new Ei((s=o.getSync(h))!==null&&s!==void 0?s:bs(Ze.With("ENOENT",t,a)));if(delete d[c],!n&&Ic(m))throw Ze.With("EISDIR",t,a);o.setSync(u.data,Al(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),o.setSync(m.ino,ya(m))):(o.removeSync(m.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{js(i)}}}class d_e extends c_e{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class f_e extends Map{constructor(t=ao,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new d_e(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const h_e={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new BK(new f_e(e,t));return n.checkRootSync(),n}},p_e=h_e;let Vi=!0;class H$ extends _O{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Rl(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Rl(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);PS(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);PS(this.output,0),Rl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Rl(this.output,-s.length,0),Rl(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Rl(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Rl(this.output,-this._cursor,0),Rl(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);PS(this.output,0),Rl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Rl(this.output,-r.length,0),Rl(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(PS(this.output,0),Rl(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Oa("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Oa("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function m_e(e,t,n,r){return"input"in e?new H$(e.input,e.output,e.completer,e.terminal):new H$(e,t,n,r)}function PS(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Rl(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class zC{get position(){return this.flag&km?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&zE||this.inode.flags&So.Sync)}sync(){if(this.closed)throw Ze.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Ze.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Ze.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ze.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Ze.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Ze.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&Pa||this.flag&Pd))throw new Ze(yt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"write");if(!(this.flag&Pa||this.flag&Pd))throw new Ze(yt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&So.Immutable)throw new Ze(yt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!ow(this.inode)&&!aw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"read");if(this.flag&Pa)throw new Ze(yt.EPERM,"File not opened with a readable mode");this.inode.flags&So.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!ow(this.inode)&&!aw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Ze.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>ks?-61441:ks)|t,(this._isSync||t>ks)&&this.sync()}chown(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"chown");this.dirty=!0,FK(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Ze.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Ze.With("EBADF",this.path,"streamWrite");if(this.inode.flags&So.Immutable)throw new Ze(yt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function UC(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:Dc.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function za(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Dc.descriptors).get(t);if(!s)throw new Ze(yt.EBADF);return s}function $K(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:Dc.descriptors).delete(t)}const g_e=/[rwasx]{1,2}\+?/;function Dd(e){if(typeof e=="number")return e;if(!g_e.test(e))throw new Ze(yt.EINVAL,"Invalid flag string: "+e);return y_e(e)}function y_e(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Ze(yt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?kK:LE;return e.includes("w")&&(t|=$E),e.includes("a")&&(t|=km),e.includes("+")?t|=Pd:e.includes("r")||(t|=Pa),e.includes("s")&&(t|=zE),e.includes("x")&&(t|=BE),t}function zK(e){let t=0;return e&Pa||(t|=qi),(e&Pa||e&Pd)&&(t|=li),t}const lw=new Map;OO("/",p_e.create({label:"root"}));function OO(e,t){if(e[0]!="/"&&(e="/"+e),e=Hd.call(this,e),lw.has(e))throw _o(new Ze(yt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,lw.set(e,t),SK(`Mounted ${t.name} on ${e}`),_x(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function UK(e){if(e[0]!="/"&&(e="/"+e),e=Hd.call(this,e),!lw.has(e)){Oa(e+" is already unmounted");return}lw.delete(e),RO("Unmounted "+e)}function Mr(e,t){const n=(t==null?void 0:t.root)||Dc.root;e=Dn(as(n,e));const r=[...lw].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(v_e(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw R1e(new Ze(yt.EIO,"No file system",e))}function nM(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function hs(e,t){typeof e.stack=="string"&&(e.stack=nM(e.stack,t));try{e.message=nM(e.message,t)}catch{}return e.path&&(e.path=nM(e.path,t)),e}function qK(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||ao),files:(t?BigInt:Number)(n.totalNodes||ao),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function b_e(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:Dc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Ze(yt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=as(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Ze.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Ze(yt.EPERM,"Can not chroot() outside of current root");l.root=c}function v_e(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class VK extends _O{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Ze.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Ze.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Ze.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Ze.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Ze.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class WK extends VK{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?as(t.root,n):n,w_e(this.realpath,this)}close(){super.emit("close"),__e(this.realpath,this)}[Symbol.dispose](){this.close()}}class x_e extends VK{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=Sh(this.path);e_e(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=Sh(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const lh=new Map;function w_e(e,t){const n=Dn(e);lh.has(n)||lh.set(n,new Set),lh.get(n).add(t)}function __e(e,t){const n=Dn(e);lh.has(n)&&(lh.get(n).delete(t),lh.get(n).size===0&&lh.delete(n))}function _a(e,t,n){var r;e&&(n=as((r=e.root)!==null&&r!==void 0?r:"/",n)),n=Dn(n);for(let s=n;s!="/";s=Yr(s)){const i=lh.get(s);if(i)for(const a of i)a.emit("change",t,_K.call(a._context,s,n)||iy(n))}}var w1=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},_1=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function S_e(e,t){e=Dn(e),t=Dn(t);const n=Mr(e,this),r=Mr(t,this);if(!Sh.call(this,Yr(e)).hasAccess(li,this))throw Ze.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),_a(this,"rename",e.toString()),_a(this,"change",t.toString());return}$O.call(this,t,BO(e)),LO.call(this,e),_a(this,"rename",e.toString())}catch(s){throw hs(s,{[n.path]:e,[r.path]:t})}}function DO(e){e=Dn(e);try{const{fs:t,path:n}=Mr(qh.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==yt.ENOENT)return!1;throw t}}function Sh(e,t){e=Dn(e);const{fs:n,path:r}=Mr(qh.call(this,e),this);try{const s=n.statSync(r);if(Vi&&!fs(this,s,qi))throw Ze.With("EACCES",r,"stat");return t!=null&&t.bigint?new Wm(s):new nf(s)}catch(s){throw hs(s,{[r]:e})}}function FO(e,t){e=Dn(e);const{fs:n,path:r}=Mr(e,this);try{const s=n.statSync(r);if(Vi&&!fs(this,s,qi))throw Ze.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Wm(s):new nf(s)}catch(s){throw hs(s,{[r]:e})}}function C_e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=w1(n,Hm.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Ze(yt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{_1(n)}}function LO(e){e=Dn(e);const{fs:t,path:n}=Mr(e,this);try{if(Vi&&!fs(this,t.statSync(n),li))throw Ze.With("EACCES",n,"unlink");t.unlinkSync(n),_a(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}function Hm(e,t){var n;e=Dn(e);const r=Uh(t.mode,420),s=Dd(t.flag);e=t.preserveSymlinks?e:qh.call(this,e);const{fs:i,path:a}=Mr(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&LE))throw Ze.With("ENOENT",e,"_open");const c=i.statSync(Yr(a));if(!fs(this,c,li))throw Ze.With("EACCES",Yr(e),"_open");if(!Ic(c))throw Ze.With("ENOTDIR",Yr(e),"_open");if(!t.allowDirectory&&r&Ri)throw Ze.With("EISDIR",e,"_open");if(!fs(this,c,li))throw Ze.With("EACCES",Yr(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Dc.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&v1?c.uid:u,gid:c.mode&x1?c.gid:d});return new zC(this,e,i,a,s,h)}if(!fs(this,o,r)||!fs(this,o,zK(s)))throw Ze.With("EACCES",e,"_open");if(s&BE)throw Ze.With("EEXIST",e,"_open");const l=new zC(this,e,i,a,s,o);if(s&$E&&l.truncate(0),!t.allowDirectory&&o.mode&Ri)throw Ze.With("EISDIR",e,"_open");return l}function UE(e,t,n=MO){return UC(Hm.call(this,e,{flag:t,mode:n}))}function qE(e,t,n){return UC(Hm.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function HK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=w1(r,typeof e=="number"?za(this,e):Hm.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{_1(r)}}function BO(e,t={}){const n=Od(t,null,"r",420);if(Dd(n.flag)&Pa)throw new Ze(yt.EINVAL,"Flag passed to readFile must allow for reading");const s=Ds.from(HK.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function $O(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Od(n,"utf8","w+",420),i=Dd(s.flag);if(!(i&Pa||i&Pd))throw new Ze(yt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Ze(yt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Ze(yt.EINVAL,"Data not specified");w1(r,typeof e=="number"?za(this,e):Hm.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),_a(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{_1(r)}}function k_e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=Od(n,"utf8","a+",420),i=Dd(s.flag);if(!(i&km))throw new Ze(yt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Ze(yt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);w1(r,Hm.call(this,typeof e=="number"?za(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{_1(r)}}function E_e(e,t){const n=za(this,e).stat();return t!=null&&t.bigint?new Wm(n):new nf(n)}function Gm(e){za(this,e).close(),$K(this,e)}function T_e(e,t=0){if(t||(t=0),t<0)throw new Ze(yt.EINVAL);za(this,e).truncate(t)}function A_e(e){za(this,e).sync()}function R_e(e){za(this,e).datasync()}function N_e(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=Ds.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=za(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return _a(this,"change",c.path),u}function M_e(e,t,n,r,s){const i=za(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function zO(e,t,n){za(this,e).chown(t,n)}function UO(e,t){const n=Uh(t,-1);if(n<0)throw new Ze(yt.EINVAL,"Invalid mode.");za(this,e).chmod(n)}function qO(e,t,n){za(this,e).utimes($C(t),$C(n))}function GK(e){e=Dn(e);const{fs:t,path:n}=Mr(qh.call(this,e),this);try{const r=t.statSync(n);if(!Ic(r))throw Ze.With("ENOTDIR",n,"rmdir");if(Vi&&!fs(this,r,li))throw Ze.With("EACCES",n,"rmdir");t.rmdirSync(n),_a(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}function VO(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Dc.credentials;t=typeof t=="object"?t:{mode:t};const a=Uh(t==null?void 0:t.mode,511);e=qh.call(this,e);const{fs:o,path:l,root:c}=Mr(e,this),u={[l]:e},d=(h,m)=>{if(!fs(this,m,li))throw Ze.With("EACCES",Yr(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:m.mode&v1?m.uid:s,gid:m.mode&x1?m.gid:i});return _a(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(Yr(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[o.statSync(Yr(h[0]))];for(const[y,b]of h.entries())m.push(d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw hs(h,u)}}function Hy(e,t){t=typeof t=="object"?t:{encoding:t},e=Dn(e);const{fs:n,path:r}=Mr(qh.call(this,e),this);let s;try{const a=n.statSync(r);if(Vi&&!fs(this,a,qi))throw Ze.With("EACCES",r,"readdir");if(!Ic(a))throw Ze.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw hs(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(as(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new cw(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Ds.from(a)):i.push(a),!(!Ic(o)||!(t!=null&&t.recursive)))for(const l of Hy.call(this,as(e,a),t))l instanceof cw?(l.path=as(a,l.path),i.push(l)):Ds.isBuffer(l)?i.push(Ds.from(as(a,CO(l)))):i.push(as(a,l))}return i}function I_e(e,t){if(e=Dn(e),!Sh(Yr(e)).hasAccess(qi,this))throw Ze.With("EACCES",Yr(e),"link");if(t=Dn(t),!Sh(Yr(t)).hasAccess(li,this))throw Ze.With("EACCES",Yr(t),"link");const{fs:n,path:r}=Mr(e,this),s=Mr(t,this);if(n!=s.fs)throw Ze.With("EXDEV",t,"link");try{if(Vi&&!fs(this,n.statSync(r),qi))throw Ze.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw hs(i,{[r]:e,[s.path]:t})}}function j_e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ze(yt.EINVAL,"Invalid type: "+n);t=Dn(t);const s=w1(r,Hm.call(this,t,{flag:"wx",mode:420}),!1);s.write(Zp(Dn(e,!0))),s.chmod(tf)}catch(s){r.error=s,r.hasError=!0}finally{_1(r)}}function Tj(e,t){const n=Ds.from(HK.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function P_e(e,t,n){const r=UE.call(this,e,"r+");zO.call(this,r,t,n),Gm.call(this,r)}function O_e(e,t,n){const r=qE.call(this,e,"r+");zO.call(this,r,t,n),Gm.call(this,r)}function D_e(e,t){const n=UE.call(this,e,"r+");UO.call(this,n,t),Gm.call(this,n)}function F_e(e,t){const n=qE.call(this,e,"r+");UO.call(this,n,t),Gm.call(this,n)}function KK(e,t,n){const r=UE.call(this,e,"r+");qO.call(this,r,t,n),Gm.call(this,r)}function L_e(e,t,n){const r=qE.call(this,e,"r+");qO.call(this,r,t,n),Gm.call(this,r)}function Aj(e,t,n){try{const l=Mr(t,e),c=l.fs.statSync(l.path);if(!ay(c))return{...l,fullPath:t,stats:c};const u=Hd.call(e,Yr(t),Tj.call(e,t).toString());return Aj(e,u)}catch{}const{base:r,dir:s}=ou(t),i=s=="/"?"/":qh.call(e,s),a=as(i,r),o=Mr(a,e);try{const l=o.fs.statSync(o.path);if(!ay(l))return{...o,fullPath:a,stats:l};const c=Hd.call(e,i,Tj.call(e,a).toString());return Aj(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw hs(l,{[o.path]:a})}}function qh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Dn(e);const{fullPath:s}=Aj(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Ds.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function B_e(e,t=384){if(!fs(this,Sh.call(this,e),t))throw new Ze(yt.EACCES)}function YK(e,t){e=Dn(e);let n;try{n=FO.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&ks){case Ri:if(t!=null&&t.recursive)for(const r of Hy.call(this,e))YK.call(this,as(e,r),t);GK.call(this,e);break;case Cc:case tf:case Um:case qm:LO.call(this,e);break;case Vm:case zm:default:throw new Ze(yt.EPERM,"File type not supported",e,"rm")}}function $_e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return VO.call(this,s),n=="buffer"?Ds.from(s):s}function ZK(e,t,n){if(e=Dn(e),t=Dn(t),n&&n&IO&&DO(t))throw new Ze(yt.EEXIST,"Destination file already exists",t,"copyFile");$O.call(this,t,BO(e)),_a(this,"rename",t.toString())}function z_e(e,t,n){const r=za(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function U_e(e,t,n){const r=za(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function q_e(e,t){return e=Dn(e),new WO(e,this)}function XK(e,t,n){e=Dn(e),t=Dn(t);const r=FO.call(this,e);if(n!=null&&n.errorOnExist&&DO.call(this,t))throw new Ze(yt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&ks){case Ri:if(!(n!=null&&n.recursive))throw new Ze(yt.EISDIR,e+" is a directory (not copied)",e,"cp");VO.call(this,t,{recursive:!0});for(const s of Hy.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(as(e,s.name),as(t,s.name))||XK.call(this,as(e,s.name),as(t,s.name),n);break;case Cc:case tf:ZK.call(this,e,t);break;case Um:case qm:case Vm:case zm:default:throw new Ze(yt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&KK.call(this,t,r.atime,r.mtime)}function V_e(e,t){e=Dn(e);const{fs:n}=Mr(e,this);return qK(n,t==null?void 0:t.bigint)}function W_e(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=Hy(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(Sh(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class cw{get name(){return iy(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return i_e(this.stats)}isDirectory(){return Ic(this.stats)}isBlockDevice(){return aw(this.stats)}isCharacterDevice(){return ow(this.stats)}isSymbolicLink(){return ay(this.stats)}isFIFO(){return o_e(this.stats)}isSocket(){return a_e(this.stats)}}class WO{checkClosed(){if(this.closed)throw new Ze(yt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await Ym.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=Hy.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var rM={exports:{}},sM={exports:{}},iM={},G$;function Vh(){return G$||(G$=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=w.indexOf("=");k===-1&&(k=S);var C=k===S?0:4-k%4;return[k,C]}function u(w){var S=c(w),k=S[0],C=S[1];return(k+C)*3/4-C}function d(w,S,k){return(S+k)*3/4-k}function h(w){var S,k=c(w),C=k[0],R=k[1],A=new i(d(w,C,R)),N=0,I=R>0?C-4:C,O;for(O=0;O<I;O+=4)S=s[w.charCodeAt(O)]<<18|s[w.charCodeAt(O+1)]<<12|s[w.charCodeAt(O+2)]<<6|s[w.charCodeAt(O+3)],A[N++]=S>>16&255,A[N++]=S>>8&255,A[N++]=S&255;return R===2&&(S=s[w.charCodeAt(O)]<<2|s[w.charCodeAt(O+1)]>>4,A[N++]=S&255),R===1&&(S=s[w.charCodeAt(O)]<<10|s[w.charCodeAt(O+1)]<<4|s[w.charCodeAt(O+2)]>>2,A[N++]=S>>8&255,A[N++]=S&255),A}function m(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,S,k){for(var C,R=[],A=S;A<k;A+=3)C=(w[A]<<16&16711680)+(w[A+1]<<8&65280)+(w[A+2]&255),R.push(m(C));return R.join("")}function b(w){for(var S,k=w.length,C=k%3,R=[],A=16383,N=0,I=k-C;N<I;N+=A)R.push(y(w,N,N+A>I?I:N+A));return C===1?(S=w[k-1],R.push(r[S>>2]+r[S<<4&63]+"==")):C===2&&(S=(w[k-2]<<8)+w[k-1],R.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),R.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,S,k,C,R){var A,N,I=R*8-C-1,O=(1<<I)-1,B=O>>1,D=-7,W=k?R-1:0,P=k?-1:1,Z=w[S+W];for(W+=P,A=Z&(1<<-D)-1,Z>>=-D,D+=I;D>0;A=A*256+w[S+W],W+=P,D-=8);for(N=A&(1<<-D)-1,A>>=-D,D+=C;D>0;N=N*256+w[S+W],W+=P,D-=8);if(A===0)A=1-B;else{if(A===O)return N?NaN:(Z?-1:1)*(1/0);N=N+Math.pow(2,C),A=A-B}return(Z?-1:1)*N*Math.pow(2,A-C)},v.write=function(w,S,k,C,R,A){var N,I,O,B=A*8-R-1,D=(1<<B)-1,W=D>>1,P=R===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=C?0:A-1,U=C?1:-1,H=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(I=isNaN(S)?1:0,N=D):(N=Math.floor(Math.log(S)/Math.LN2),S*(O=Math.pow(2,-N))<1&&(N--,O*=2),N+W>=1?S+=P/O:S+=P*Math.pow(2,1-W),S*O>=2&&(N++,O/=2),N+W>=D?(I=0,N=D):N+W>=1?(I=(S*O-1)*Math.pow(2,R),N=N+W):(I=S*Math.pow(2,W-1)*Math.pow(2,R),N=0));R>=8;w[k+Z]=I&255,Z+=U,I/=256,R-=8);for(N=N<<R|I,B+=R;B>0;w[k+Z]=N&255,Z+=U,N/=256,B-=8);w[k+Z-U]|=H*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const S=n,k=v,C=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=D,w.SlowBuffer=se,w.INSPECT_MAX_BYTES=50;const R=2147483647;w.kMaxLength=R;const{Uint8Array:A,ArrayBuffer:N,SharedArrayBuffer:I}=globalThis;D.TYPED_ARRAY_SUPPORT=O(),!D.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function O(){try{const Y=new A(1),G={foo:function(){return 42}};return Object.setPrototypeOf(G,A.prototype),Object.setPrototypeOf(Y,G),Y.foo()===42}catch{return!1}}Object.defineProperty(D.prototype,"parent",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.buffer}}),Object.defineProperty(D.prototype,"offset",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.byteOffset}});function B(Y){if(Y>R)throw new RangeError('The value "'+Y+'" is invalid for option "size"');const G=new A(Y);return Object.setPrototypeOf(G,D.prototype),G}function D(Y,G,J){if(typeof Y=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(Y)}return W(Y,G,J)}D.poolSize=8192;function W(Y,G,J){if(typeof Y=="string")return H(Y,G);if(N.isView(Y))return ne(Y);if(Y==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y);if(be(Y,N)||Y&&be(Y.buffer,N)||typeof I<"u"&&(be(Y,I)||Y&&be(Y.buffer,I)))return V(Y,G,J);if(typeof Y=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ve=Y.valueOf&&Y.valueOf();if(ve!=null&&ve!==Y)return D.from(ve,G,J);const Oe=Q(Y);if(Oe)return Oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Y[Symbol.toPrimitive]=="function")return D.from(Y[Symbol.toPrimitive]("string"),G,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Y)}D.from=function(Y,G,J){return W(Y,G,J)},Object.setPrototypeOf(D.prototype,A.prototype),Object.setPrototypeOf(D,A);function P(Y){if(typeof Y!="number")throw new TypeError('"size" argument must be of type number');if(Y<0)throw new RangeError('The value "'+Y+'" is invalid for option "size"')}function Z(Y,G,J){return P(Y),Y<=0?B(Y):G!==void 0?typeof J=="string"?B(Y).fill(G,J):B(Y).fill(G):B(Y)}D.alloc=function(Y,G,J){return Z(Y,G,J)};function U(Y){return P(Y),B(Y<0?0:ee(Y)|0)}D.allocUnsafe=function(Y){return U(Y)},D.allocUnsafeSlow=function(Y){return U(Y)};function H(Y,G){if((typeof G!="string"||G==="")&&(G="utf8"),!D.isEncoding(G))throw new TypeError("Unknown encoding: "+G);const J=me(Y,G)|0;let ve=B(J);const Oe=ve.write(Y,G);return Oe!==J&&(ve=ve.slice(0,Oe)),ve}function L(Y){const G=Y.length<0?0:ee(Y.length)|0,J=B(G);for(let ve=0;ve<G;ve+=1)J[ve]=Y[ve]&255;return J}function ne(Y){if(be(Y,A)){const G=new A(Y);return V(G.buffer,G.byteOffset,G.byteLength)}return L(Y)}function V(Y,G,J){if(G<0||Y.byteLength<G)throw new RangeError('"offset" is outside of buffer bounds');if(Y.byteLength<G+(J||0))throw new RangeError('"length" is outside of buffer bounds');let ve;return G===void 0&&J===void 0?ve=new A(Y):J===void 0?ve=new A(Y,G):ve=new A(Y,G,J),Object.setPrototypeOf(ve,D.prototype),ve}function Q(Y){if(D.isBuffer(Y)){const G=ee(Y.length)|0,J=B(G);return J.length===0||Y.copy(J,0,0,G),J}if(Y.length!==void 0)return typeof Y.length!="number"||_e(Y.length)?B(0):L(Y);if(Y.type==="Buffer"&&Array.isArray(Y.data))return L(Y.data)}function ee(Y){if(Y>=R)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+R.toString(16)+" bytes");return Y|0}function se(Y){return+Y!=Y&&(Y=0),D.alloc(+Y)}D.isBuffer=function(G){return G!=null&&G._isBuffer===!0&&G!==D.prototype},D.compare=function(G,J){if(be(G,A)&&(G=D.from(G,G.offset,G.byteLength)),be(J,A)&&(J=D.from(J,J.offset,J.byteLength)),!D.isBuffer(G)||!D.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(G===J)return 0;let ve=G.length,Oe=J.length;for(let Ke=0,_t=Math.min(ve,Oe);Ke<_t;++Ke)if(G[Ke]!==J[Ke]){ve=G[Ke],Oe=J[Ke];break}return ve<Oe?-1:Oe<ve?1:0},D.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},D.concat=function(G,J){if(!Array.isArray(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return D.alloc(0);let ve;if(J===void 0)for(J=0,ve=0;ve<G.length;++ve)J+=G[ve].length;const Oe=D.allocUnsafe(J);let Ke=0;for(ve=0;ve<G.length;++ve){let _t=G[ve];if(be(_t,A))Ke+_t.length>Oe.length?(D.isBuffer(_t)||(_t=D.from(_t)),_t.copy(Oe,Ke)):A.prototype.set.call(Oe,_t,Ke);else if(D.isBuffer(_t))_t.copy(Oe,Ke);else throw new TypeError('"list" argument must be an Array of Buffers');Ke+=_t.length}return Oe};function me(Y,G){if(D.isBuffer(Y))return Y.length;if(N.isView(Y)||be(Y,N))return Y.byteLength;if(typeof Y!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Y);const J=Y.length,ve=arguments.length>2&&arguments[2]===!0;if(!ve&&J===0)return 0;let Oe=!1;for(;;)switch(G){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return vt(Y).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return ze(Y).length;default:if(Oe)return ve?-1:vt(Y).length;G=(""+G).toLowerCase(),Oe=!0}}D.byteLength=me;function ce(Y,G,J){let ve=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,G>>>=0,J<=G))return"";for(Y||(Y="utf8");;)switch(Y){case"hex":return Te(this,G,J);case"utf8":case"utf-8":return ge(this,G,J);case"ascii":return oe(this,G,J);case"latin1":case"binary":return re(this,G,J);case"base64":return K(this,G,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,G,J);default:if(ve)throw new TypeError("Unknown encoding: "+Y);Y=(Y+"").toLowerCase(),ve=!0}}D.prototype._isBuffer=!0;function je(Y,G,J){const ve=Y[G];Y[G]=Y[J],Y[J]=ve}D.prototype.swap16=function(){const G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<G;J+=2)je(this,J,J+1);return this},D.prototype.swap32=function(){const G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<G;J+=4)je(this,J,J+3),je(this,J+1,J+2);return this},D.prototype.swap64=function(){const G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<G;J+=8)je(this,J,J+7),je(this,J+1,J+6),je(this,J+2,J+5),je(this,J+3,J+4);return this},D.prototype.toString=function(){const G=this.length;return G===0?"":arguments.length===0?ge(this,0,G):ce.apply(this,arguments)},D.prototype.toLocaleString=D.prototype.toString,D.prototype.equals=function(G){if(!D.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:D.compare(this,G)===0},D.prototype.inspect=function(){let G="";const J=w.INSPECT_MAX_BYTES;return G=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(G+=" ... "),"<Buffer "+G+">"},C&&(D.prototype[C]=D.prototype.inspect),D.prototype.compare=function(G,J,ve,Oe,Ke){if(be(G,A)&&(G=D.from(G,G.offset,G.byteLength)),!D.isBuffer(G))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof G);if(J===void 0&&(J=0),ve===void 0&&(ve=G?G.length:0),Oe===void 0&&(Oe=0),Ke===void 0&&(Ke=this.length),J<0||ve>G.length||Oe<0||Ke>this.length)throw new RangeError("out of range index");if(Oe>=Ke&&J>=ve)return 0;if(Oe>=Ke)return-1;if(J>=ve)return 1;if(J>>>=0,ve>>>=0,Oe>>>=0,Ke>>>=0,this===G)return 0;let _t=Ke-Oe,tn=ve-J;const zn=Math.min(_t,tn),Xt=this.slice(Oe,Ke),nn=G.slice(J,ve);for(let un=0;un<zn;++un)if(Xt[un]!==nn[un]){_t=Xt[un],tn=nn[un];break}return _t<tn?-1:tn<_t?1:0};function De(Y,G,J,ve,Oe){if(Y.length===0)return-1;if(typeof J=="string"?(ve=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,_e(J)&&(J=Oe?0:Y.length-1),J<0&&(J=Y.length+J),J>=Y.length){if(Oe)return-1;J=Y.length-1}else if(J<0)if(Oe)J=0;else return-1;if(typeof G=="string"&&(G=D.from(G,ve)),D.isBuffer(G))return G.length===0?-1:Se(Y,G,J,ve,Oe);if(typeof G=="number")return G=G&255,typeof A.prototype.indexOf=="function"?Oe?A.prototype.indexOf.call(Y,G,J):A.prototype.lastIndexOf.call(Y,G,J):Se(Y,[G],J,ve,Oe);throw new TypeError("val must be string, number or Buffer")}function Se(Y,G,J,ve,Oe){let Ke=1,_t=Y.length,tn=G.length;if(ve!==void 0&&(ve=String(ve).toLowerCase(),ve==="ucs2"||ve==="ucs-2"||ve==="utf16le"||ve==="utf-16le")){if(Y.length<2||G.length<2)return-1;Ke=2,_t/=2,tn/=2,J/=2}function zn(nn,un){return Ke===1?nn[un]:nn.readUInt16BE(un*Ke)}let Xt;if(Oe){let nn=-1;for(Xt=J;Xt<_t;Xt++)if(zn(Y,Xt)===zn(G,nn===-1?0:Xt-nn)){if(nn===-1&&(nn=Xt),Xt-nn+1===tn)return nn*Ke}else nn!==-1&&(Xt-=Xt-nn),nn=-1}else for(J+tn>_t&&(J=_t-tn),Xt=J;Xt>=0;Xt--){let nn=!0;for(let un=0;un<tn;un++)if(zn(Y,Xt+un)!==zn(G,un)){nn=!1;break}if(nn)return Xt}return-1}D.prototype.includes=function(G,J,ve){return this.indexOf(G,J,ve)!==-1},D.prototype.indexOf=function(G,J,ve){return De(this,G,J,ve,!0)},D.prototype.lastIndexOf=function(G,J,ve){return De(this,G,J,ve,!1)};function Ce(Y,G,J,ve){J=Number(J)||0;const Oe=Y.length-J;ve?(ve=Number(ve),ve>Oe&&(ve=Oe)):ve=Oe;const Ke=G.length;ve>Ke/2&&(ve=Ke/2);let _t;for(_t=0;_t<ve;++_t){const tn=parseInt(G.substr(_t*2,2),16);if(_e(tn))return _t;Y[J+_t]=tn}return _t}function qe(Y,G,J,ve){return st(vt(G,Y.length-J),Y,J,ve)}function Qe(Y,G,J,ve){return st(ot(G),Y,J,ve)}function We(Y,G,J,ve){return st(ze(G),Y,J,ve)}function Ne(Y,G,J,ve){return st($(G,Y.length-J),Y,J,ve)}D.prototype.write=function(G,J,ve,Oe){if(J===void 0)Oe="utf8",ve=this.length,J=0;else if(ve===void 0&&typeof J=="string")Oe=J,ve=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(ve)?(ve=ve>>>0,Oe===void 0&&(Oe="utf8")):(Oe=ve,ve=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ke=this.length-J;if((ve===void 0||ve>Ke)&&(ve=Ke),G.length>0&&(ve<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");Oe||(Oe="utf8");let _t=!1;for(;;)switch(Oe){case"hex":return Ce(this,G,J,ve);case"utf8":case"utf-8":return qe(this,G,J,ve);case"ascii":case"latin1":case"binary":return Qe(this,G,J,ve);case"base64":return We(this,G,J,ve);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,G,J,ve);default:if(_t)throw new TypeError("Unknown encoding: "+Oe);Oe=(""+Oe).toLowerCase(),_t=!0}},D.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function K(Y,G,J){return G===0&&J===Y.length?S.fromByteArray(Y):S.fromByteArray(Y.slice(G,J))}function ge(Y,G,J){J=Math.min(Y.length,J);const ve=[];let Oe=G;for(;Oe<J;){const Ke=Y[Oe];let _t=null,tn=Ke>239?4:Ke>223?3:Ke>191?2:1;if(Oe+tn<=J){let zn,Xt,nn,un;switch(tn){case 1:Ke<128&&(_t=Ke);break;case 2:zn=Y[Oe+1],(zn&192)===128&&(un=(Ke&31)<<6|zn&63,un>127&&(_t=un));break;case 3:zn=Y[Oe+1],Xt=Y[Oe+2],(zn&192)===128&&(Xt&192)===128&&(un=(Ke&15)<<12|(zn&63)<<6|Xt&63,un>2047&&(un<55296||un>57343)&&(_t=un));break;case 4:zn=Y[Oe+1],Xt=Y[Oe+2],nn=Y[Oe+3],(zn&192)===128&&(Xt&192)===128&&(nn&192)===128&&(un=(Ke&15)<<18|(zn&63)<<12|(Xt&63)<<6|nn&63,un>65535&&un<1114112&&(_t=un))}}_t===null?(_t=65533,tn=1):_t>65535&&(_t-=65536,ve.push(_t>>>10&1023|55296),_t=56320|_t&1023),ve.push(_t),Oe+=tn}return le(ve)}const Ae=4096;function le(Y){const G=Y.length;if(G<=Ae)return String.fromCharCode.apply(String,Y);let J="",ve=0;for(;ve<G;)J+=String.fromCharCode.apply(String,Y.slice(ve,ve+=Ae));return J}function oe(Y,G,J){let ve="";J=Math.min(Y.length,J);for(let Oe=G;Oe<J;++Oe)ve+=String.fromCharCode(Y[Oe]&127);return ve}function re(Y,G,J){let ve="";J=Math.min(Y.length,J);for(let Oe=G;Oe<J;++Oe)ve+=String.fromCharCode(Y[Oe]);return ve}function Te(Y,G,J){const ve=Y.length;(!G||G<0)&&(G=0),(!J||J<0||J>ve)&&(J=ve);let Oe="";for(let Ke=G;Ke<J;++Ke)Oe+=Ue[Y[Ke]];return Oe}function Be(Y,G,J){const ve=Y.slice(G,J);let Oe="";for(let Ke=0;Ke<ve.length-1;Ke+=2)Oe+=String.fromCharCode(ve[Ke]+ve[Ke+1]*256);return Oe}D.prototype.slice=function(G,J){const ve=this.length;G=~~G,J=J===void 0?ve:~~J,G<0?(G+=ve,G<0&&(G=0)):G>ve&&(G=ve),J<0?(J+=ve,J<0&&(J=0)):J>ve&&(J=ve),J<G&&(J=G);const Oe=this.subarray(G,J);return Object.setPrototypeOf(Oe,D.prototype),Oe};function ke(Y,G,J){if(Y%1!==0||Y<0)throw new RangeError("offset is not uint");if(Y+G>J)throw new RangeError("Trying to access beyond buffer length")}D.prototype.readUintLE=D.prototype.readUIntLE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=this[G],Ke=1,_t=0;for(;++_t<J&&(Ke*=256);)Oe+=this[G+_t]*Ke;return Oe},D.prototype.readUintBE=D.prototype.readUIntBE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=this[G+--J],Ke=1;for(;J>0&&(Ke*=256);)Oe+=this[G+--J]*Ke;return Oe},D.prototype.readUint8=D.prototype.readUInt8=function(G,J){return G=G>>>0,J||ke(G,1,this.length),this[G]},D.prototype.readUint16LE=D.prototype.readUInt16LE=function(G,J){return G=G>>>0,J||ke(G,2,this.length),this[G]|this[G+1]<<8},D.prototype.readUint16BE=D.prototype.readUInt16BE=function(G,J){return G=G>>>0,J||ke(G,2,this.length),this[G]<<8|this[G+1]},D.prototype.readUint32LE=D.prototype.readUInt32LE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},D.prototype.readUint32BE=D.prototype.readUInt32BE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},D.prototype.readBigUInt64LE=Et(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24,Ke=this[++G]+this[++G]*2**8+this[++G]*2**16+ve*2**24;return BigInt(Oe)+(BigInt(Ke)<<BigInt(32))}),D.prototype.readBigUInt64BE=Et(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=J*2**24+this[++G]*2**16+this[++G]*2**8+this[++G],Ke=this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+ve;return(BigInt(Oe)<<BigInt(32))+BigInt(Ke)}),D.prototype.readIntLE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=this[G],Ke=1,_t=0;for(;++_t<J&&(Ke*=256);)Oe+=this[G+_t]*Ke;return Ke*=128,Oe>=Ke&&(Oe-=Math.pow(2,8*J)),Oe},D.prototype.readIntBE=function(G,J,ve){G=G>>>0,J=J>>>0,ve||ke(G,J,this.length);let Oe=J,Ke=1,_t=this[G+--Oe];for(;Oe>0&&(Ke*=256);)_t+=this[G+--Oe]*Ke;return Ke*=128,_t>=Ke&&(_t-=Math.pow(2,8*J)),_t},D.prototype.readInt8=function(G,J){return G=G>>>0,J||ke(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},D.prototype.readInt16LE=function(G,J){G=G>>>0,J||ke(G,2,this.length);const ve=this[G]|this[G+1]<<8;return ve&32768?ve|4294901760:ve},D.prototype.readInt16BE=function(G,J){G=G>>>0,J||ke(G,2,this.length);const ve=this[G+1]|this[G]<<8;return ve&32768?ve|4294901760:ve},D.prototype.readInt32LE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},D.prototype.readInt32BE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},D.prototype.readBigInt64LE=Et(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=this[G+4]+this[G+5]*2**8+this[G+6]*2**16+(ve<<24);return(BigInt(Oe)<<BigInt(32))+BigInt(J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24)}),D.prototype.readBigInt64BE=Et(function(G){G=G>>>0,Fe(G,"offset");const J=this[G],ve=this[G+7];(J===void 0||ve===void 0)&&we(G,this.length-8);const Oe=(J<<24)+this[++G]*2**16+this[++G]*2**8+this[++G];return(BigInt(Oe)<<BigInt(32))+BigInt(this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+ve)}),D.prototype.readFloatLE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),k.read(this,G,!0,23,4)},D.prototype.readFloatBE=function(G,J){return G=G>>>0,J||ke(G,4,this.length),k.read(this,G,!1,23,4)},D.prototype.readDoubleLE=function(G,J){return G=G>>>0,J||ke(G,8,this.length),k.read(this,G,!0,52,8)},D.prototype.readDoubleBE=function(G,J){return G=G>>>0,J||ke(G,8,this.length),k.read(this,G,!1,52,8)};function lt(Y,G,J,ve,Oe,Ke){if(!D.isBuffer(Y))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>Oe||G<Ke)throw new RangeError('"value" argument is out of bounds');if(J+ve>Y.length)throw new RangeError("Index out of range")}D.prototype.writeUintLE=D.prototype.writeUIntLE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,ve=ve>>>0,!Oe){const tn=Math.pow(2,8*ve)-1;lt(this,G,J,ve,tn,0)}let Ke=1,_t=0;for(this[J]=G&255;++_t<ve&&(Ke*=256);)this[J+_t]=G/Ke&255;return J+ve},D.prototype.writeUintBE=D.prototype.writeUIntBE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,ve=ve>>>0,!Oe){const tn=Math.pow(2,8*ve)-1;lt(this,G,J,ve,tn,0)}let Ke=ve-1,_t=1;for(this[J+Ke]=G&255;--Ke>=0&&(_t*=256);)this[J+Ke]=G/_t&255;return J+ve},D.prototype.writeUint8=D.prototype.writeUInt8=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,1,255,0),this[J]=G&255,J+1},D.prototype.writeUint16LE=D.prototype.writeUInt16LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,65535,0),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeUint16BE=D.prototype.writeUInt16BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,65535,0),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeUint32LE=D.prototype.writeUInt32LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,4294967295,0),this[J+3]=G>>>24,this[J+2]=G>>>16,this[J+1]=G>>>8,this[J]=G&255,J+4},D.prototype.writeUint32BE=D.prototype.writeUInt32BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,4294967295,0),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4};function Rt(Y,G,J,ve,Oe){ye(G,ve,Oe,Y,J,7);let Ke=Number(G&BigInt(4294967295));Y[J++]=Ke,Ke=Ke>>8,Y[J++]=Ke,Ke=Ke>>8,Y[J++]=Ke,Ke=Ke>>8,Y[J++]=Ke;let _t=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J++]=_t,_t=_t>>8,Y[J++]=_t,_t=_t>>8,Y[J++]=_t,_t=_t>>8,Y[J++]=_t,J}function ft(Y,G,J,ve,Oe){ye(G,ve,Oe,Y,J,7);let Ke=Number(G&BigInt(4294967295));Y[J+7]=Ke,Ke=Ke>>8,Y[J+6]=Ke,Ke=Ke>>8,Y[J+5]=Ke,Ke=Ke>>8,Y[J+4]=Ke;let _t=Number(G>>BigInt(32)&BigInt(4294967295));return Y[J+3]=_t,_t=_t>>8,Y[J+2]=_t,_t=_t>>8,Y[J+1]=_t,_t=_t>>8,Y[J]=_t,J+8}D.prototype.writeBigUInt64LE=Et(function(G,J=0){return Rt(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeBigUInt64BE=Et(function(G,J=0){return ft(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeIntLE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,!Oe){const zn=Math.pow(2,8*ve-1);lt(this,G,J,ve,zn-1,-zn)}let Ke=0,_t=1,tn=0;for(this[J]=G&255;++Ke<ve&&(_t*=256);)G<0&&tn===0&&this[J+Ke-1]!==0&&(tn=1),this[J+Ke]=(G/_t>>0)-tn&255;return J+ve},D.prototype.writeIntBE=function(G,J,ve,Oe){if(G=+G,J=J>>>0,!Oe){const zn=Math.pow(2,8*ve-1);lt(this,G,J,ve,zn-1,-zn)}let Ke=ve-1,_t=1,tn=0;for(this[J+Ke]=G&255;--Ke>=0&&(_t*=256);)G<0&&tn===0&&this[J+Ke+1]!==0&&(tn=1),this[J+Ke]=(G/_t>>0)-tn&255;return J+ve},D.prototype.writeInt8=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,1,127,-128),G<0&&(G=255+G+1),this[J]=G&255,J+1},D.prototype.writeInt16LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,32767,-32768),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeInt16BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,2,32767,-32768),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeInt32LE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,2147483647,-2147483648),this[J]=G&255,this[J+1]=G>>>8,this[J+2]=G>>>16,this[J+3]=G>>>24,J+4},D.prototype.writeInt32BE=function(G,J,ve){return G=+G,J=J>>>0,ve||lt(this,G,J,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4},D.prototype.writeBigInt64LE=Et(function(G,J=0){return Rt(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),D.prototype.writeBigInt64BE=Et(function(G,J=0){return ft(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pt(Y,G,J,ve,Oe,Ke){if(J+ve>Y.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function qt(Y,G,J,ve,Oe){return G=+G,J=J>>>0,Oe||Pt(Y,G,J,4),k.write(Y,G,J,ve,23,4),J+4}D.prototype.writeFloatLE=function(G,J,ve){return qt(this,G,J,!0,ve)},D.prototype.writeFloatBE=function(G,J,ve){return qt(this,G,J,!1,ve)};function Lt(Y,G,J,ve,Oe){return G=+G,J=J>>>0,Oe||Pt(Y,G,J,8),k.write(Y,G,J,ve,52,8),J+8}D.prototype.writeDoubleLE=function(G,J,ve){return Lt(this,G,J,!0,ve)},D.prototype.writeDoubleBE=function(G,J,ve){return Lt(this,G,J,!1,ve)},D.prototype.copy=function(G,J,ve,Oe){if(!D.isBuffer(G))throw new TypeError("argument should be a Buffer");if(ve||(ve=0),!Oe&&Oe!==0&&(Oe=this.length),J>=G.length&&(J=G.length),J||(J=0),Oe>0&&Oe<ve&&(Oe=ve),Oe===ve||G.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(ve<0||ve>=this.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("sourceEnd out of bounds");Oe>this.length&&(Oe=this.length),G.length-J<Oe-ve&&(Oe=G.length-J+ve);const Ke=Oe-ve;return this===G&&typeof A.prototype.copyWithin=="function"?this.copyWithin(J,ve,Oe):A.prototype.set.call(G,this.subarray(ve,Oe),J),Ke},D.prototype.fill=function(G,J,ve,Oe){if(typeof G=="string"){if(typeof J=="string"?(Oe=J,J=0,ve=this.length):typeof ve=="string"&&(Oe=ve,ve=this.length),Oe!==void 0&&typeof Oe!="string")throw new TypeError("encoding must be a string");if(typeof Oe=="string"&&!D.isEncoding(Oe))throw new TypeError("Unknown encoding: "+Oe);if(G.length===1){const _t=G.charCodeAt(0);(Oe==="utf8"&&_t<128||Oe==="latin1")&&(G=_t)}}else typeof G=="number"?G=G&255:typeof G=="boolean"&&(G=Number(G));if(J<0||this.length<J||this.length<ve)throw new RangeError("Out of range index");if(ve<=J)return this;J=J>>>0,ve=ve===void 0?this.length:ve>>>0,G||(G=0);let Ke;if(typeof G=="number")for(Ke=J;Ke<ve;++Ke)this[Ke]=G;else{const _t=D.isBuffer(G)?G:D.from(G,Oe),tn=_t.length;if(tn===0)throw new TypeError('The value "'+G+'" is invalid for argument "value"');for(Ke=0;Ke<ve-J;++Ke)this[Ke+J]=_t[Ke%tn]}return this};const en={};function xe(Y,G,J){en[Y]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:G.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Y}]`,this.stack,delete this.name}get code(){return Y}set code(Oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Oe,writable:!0})}toString(){return`${this.name} [${Y}]: ${this.message}`}}}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(Y){return Y?`${Y} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(Y,G){return`The "${Y}" argument must be of type number. Received type ${typeof G}`},TypeError),xe("ERR_OUT_OF_RANGE",function(Y,G,J){let ve=`The value of "${Y}" is out of range.`,Oe=J;return Number.isInteger(J)&&Math.abs(J)>2**32?Oe=F(String(J)):typeof J=="bigint"&&(Oe=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(Oe=F(Oe)),Oe+="n"),ve+=` It must be ${G}. Received ${Oe}`,ve},RangeError);function F(Y){let G="",J=Y.length;const ve=Y[0]==="-"?1:0;for(;J>=ve+4;J-=3)G=`_${Y.slice(J-3,J)}${G}`;return`${Y.slice(0,J)}${G}`}function X(Y,G,J){Fe(G,"offset"),(Y[G]===void 0||Y[G+J]===void 0)&&we(G,Y.length-(J+1))}function ye(Y,G,J,ve,Oe,Ke){if(Y>J||Y<G){const _t=typeof G=="bigint"?"n":"";let tn;throw G===0||G===BigInt(0)?tn=`>= 0${_t} and < 2${_t} ** ${(Ke+1)*8}${_t}`:tn=`>= -(2${_t} ** ${(Ke+1)*8-1}${_t}) and < 2 ** ${(Ke+1)*8-1}${_t}`,new en.ERR_OUT_OF_RANGE("value",tn,Y)}X(ve,Oe,Ke)}function Fe(Y,G){if(typeof Y!="number")throw new en.ERR_INVALID_ARG_TYPE(G,"number",Y)}function we(Y,G,J){throw Math.floor(Y)!==Y?(Fe(Y,J),new en.ERR_OUT_OF_RANGE("offset","an integer",Y)):G<0?new en.ERR_BUFFER_OUT_OF_BOUNDS:new en.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${G}`,Y)}const Ie=/[^+/0-9A-Za-z-_]/g;function fe(Y){if(Y=Y.split("=")[0],Y=Y.trim().replace(Ie,""),Y.length<2)return"";for(;Y.length%4!==0;)Y=Y+"=";return Y}function vt(Y,G){G=G||1/0;let J;const ve=Y.length;let Oe=null;const Ke=[];for(let _t=0;_t<ve;++_t){if(J=Y.charCodeAt(_t),J>55295&&J<57344){if(!Oe){if(J>56319){(G-=3)>-1&&Ke.push(239,191,189);continue}else if(_t+1===ve){(G-=3)>-1&&Ke.push(239,191,189);continue}Oe=J;continue}if(J<56320){(G-=3)>-1&&Ke.push(239,191,189),Oe=J;continue}J=(Oe-55296<<10|J-56320)+65536}else Oe&&(G-=3)>-1&&Ke.push(239,191,189);if(Oe=null,J<128){if((G-=1)<0)break;Ke.push(J)}else if(J<2048){if((G-=2)<0)break;Ke.push(J>>6|192,J&63|128)}else if(J<65536){if((G-=3)<0)break;Ke.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((G-=4)<0)break;Ke.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return Ke}function ot(Y){const G=[];for(let J=0;J<Y.length;++J)G.push(Y.charCodeAt(J)&255);return G}function $(Y,G){let J,ve,Oe;const Ke=[];for(let _t=0;_t<Y.length&&!((G-=2)<0);++_t)J=Y.charCodeAt(_t),ve=J>>8,Oe=J%256,Ke.push(Oe),Ke.push(ve);return Ke}function ze(Y){return S.toByteArray(fe(Y))}function st(Y,G,J,ve){let Oe;for(Oe=0;Oe<ve&&!(Oe+J>=G.length||Oe>=Y.length);++Oe)G[Oe+J]=Y[Oe];return Oe}function be(Y,G){return Y instanceof G||Y!=null&&Y.constructor!=null&&Y.constructor.name!=null&&Y.constructor.name===G.name}function _e(Y){return Y!==Y}const Ue=function(){const Y="0123456789abcdef",G=new Array(256);for(let J=0;J<16;++J){const ve=J*16;for(let Oe=0;Oe<16;++Oe)G[ve+Oe]=Y[J]+Y[Oe]}return G}();function Et(Y){return typeof BigInt>"u"?he:Y}function he(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(iM)),iM}var aM,K$;function ti(){if(K$)return aM;K$=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return aM={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},aM}var oM={exports:{}},lM,Y$;function JK(){return Y$||(Y$=1,lM={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),lM}var cM,Z$;function co(){if(Z$)return cM;Z$=1;const{format:e,inspect:t}=JK(),{AggregateError:n}=ti(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const S=v[0]==="-"?1:0;for(;w>=S+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const S=(x.match(/%[dfijoOs]/g)||[]).length;return c(S===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${S}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class S extends w{constructor(...C){super(d(v,x,C))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=v,S.prototype[s]=!0,l[v]=S}function m(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function y(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class b extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let S="The ";v.endsWith(" argument")?S+=`${v} `:S+=`"${v}" ${v.includes(".")?"property":"argument"} `,S+="must be ";const k=[],C=[],R=[];for(const N of x)c(typeof N=="string","All expected entries have to be of type string"),i.includes(N)?k.push(N.toLowerCase()):a.test(N)?C.push(N):(c(N!=="object",'The value "object" should be written as "Object"'),R.push(N));if(C.length>0){const N=k.indexOf("object");N!==-1&&(k.splice(k,N,1),C.push("Object"))}if(k.length>0){switch(k.length){case 1:S+=`of type ${k[0]}`;break;case 2:S+=`one of type ${k[0]} or ${k[1]}`;break;default:{const N=k.pop();S+=`one of type ${k.join(", ")}, or ${N}`}}(C.length>0||R.length>0)&&(S+=" or ")}if(C.length>0){switch(C.length){case 1:S+=`an instance of ${C[0]}`;break;case 2:S+=`an instance of ${C[0]} or ${C[1]}`;break;default:{const N=C.pop();S+=`an instance of ${C.join(", ")}, or ${N}`}}R.length>0&&(S+=" or ")}switch(R.length){case 0:break;case 1:R[0].toLowerCase()!==R[0]&&(S+="an "),S+=`${R[0]}`;break;case 2:S+=`one of ${R[0]} or ${R[1]}`;break;default:{const N=R.pop();S+=`one of ${R.join(", ")}, or ${N}`}}if(w==null)S+=`. Received ${w}`;else if(typeof w=="function"&&w.name)S+=`. Received function ${w.name}`;else if(typeof w=="object"){var A;if((A=w.constructor)!==null&&A!==void 0&&A.name)S+=`. Received an instance of ${w.constructor.name}`;else{const N=t(w,{depth:-1});S+=`. Received ${N}`}}else{let N=t(w,{colors:!1});N.length>25&&(N=`${N.slice(0,25)}...`),S+=`. Received type ${typeof w} (${N})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let S=t(x);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var S;const k=w!=null&&(S=w.constructor)!==null&&S!==void 0&&S.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${k}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(S=>`"${S}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const S=v.pop();x+=`The ${v.join(", ")}, and ${S} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let S;if(Number.isInteger(w)&&Math.abs(w)>2**32)S=u(String(w));else if(typeof w=="bigint"){S=String(w);const k=BigInt(2)**BigInt(32);(w>k||w<-k)&&(S=u(S)),S+="n"}else S=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),cM={AbortError:b,aggregateTwoErrors:m(y),hideStackFrames:m,codes:l},cM}var Iv={exports:{}},X$;function uw(){if(X$)return Iv.exports;X$=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Iv.exports=e,Iv.exports.AbortSignal=t,Iv.exports.default=e,Iv.exports}var OS={exports:{}},J$;function VE(){if(J$)return OS.exports;J$=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(C,R,A){return Function.prototype.apply.call(C,R,A)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:n=function(C){return Object.getOwnPropertyNames(C)};function r(k){console&&console.warn&&console.warn(k)}var s=Number.isNaN||function(C){return C!==C};function i(){i.init.call(this)}OS.exports=i,OS.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");a=k}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function l(k){return k._maxListeners===void 0?i.defaultMaxListeners:k._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(C){for(var R=[],A=1;A<arguments.length;A++)R.push(arguments[A]);var N=C==="error",I=this._events;if(I!==void 0)N=N&&I.error===void 0;else if(!N)return!1;if(N){var O;if(R.length>0&&(O=R[0]),O instanceof Error)throw O;var B=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw B.context=O,B}var D=I[C];if(D===void 0)return!1;if(typeof D=="function")t(D,this,R);else for(var W=D.length,P=y(D,W),A=0;A<W;++A)t(P[A],this,R);return!0};function c(k,C,R,A){var N,I,O;if(o(R),I=k._events,I===void 0?(I=k._events=Object.create(null),k._eventsCount=0):(I.newListener!==void 0&&(k.emit("newListener",C,R.listener?R.listener:R),I=k._events),O=I[C]),O===void 0)O=I[C]=R,++k._eventsCount;else if(typeof O=="function"?O=I[C]=A?[R,O]:[O,R]:A?O.unshift(R):O.push(R),N=l(k),N>0&&O.length>N&&!O.warned){O.warned=!0;var B=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");B.name="MaxListenersExceededWarning",B.emitter=k,B.type=C,B.count=O.length,r(B)}return k}i.prototype.addListener=function(C,R){return c(this,C,R,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(C,R){return c(this,C,R,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(k,C,R){var A={fired:!1,wrapFn:void 0,target:k,type:C,listener:R},N=u.bind(A);return N.listener=R,A.wrapFn=N,N}i.prototype.once=function(C,R){return o(R),this.on(C,d(this,C,R)),this},i.prototype.prependOnceListener=function(C,R){return o(R),this.prependListener(C,d(this,C,R)),this},i.prototype.removeListener=function(C,R){var A,N,I,O,B;if(o(R),N=this._events,N===void 0)return this;if(A=N[C],A===void 0)return this;if(A===R||A.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete N[C],N.removeListener&&this.emit("removeListener",C,A.listener||R));else if(typeof A!="function"){for(I=-1,O=A.length-1;O>=0;O--)if(A[O]===R||A[O].listener===R){B=A[O].listener,I=O;break}if(I<0)return this;I===0?A.shift():b(A,I),A.length===1&&(N[C]=A[0]),N.removeListener!==void 0&&this.emit("removeListener",C,B||R)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(C){var R,A,N;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[C]),this;if(arguments.length===0){var I=Object.keys(A),O;for(N=0;N<I.length;++N)O=I[N],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=A[C],typeof R=="function")this.removeListener(C,R);else if(R!==void 0)for(N=R.length-1;N>=0;N--)this.removeListener(C,R[N]);return this};function h(k,C,R){var A=k._events;if(A===void 0)return[];var N=A[C];return N===void 0?[]:typeof N=="function"?R?[N.listener||N]:[N]:R?v(N):y(N,N.length)}i.prototype.listeners=function(C){return h(this,C,!0)},i.prototype.rawListeners=function(C){return h(this,C,!1)},i.listenerCount=function(k,C){return typeof k.listenerCount=="function"?k.listenerCount(C):m.call(k,C)},i.prototype.listenerCount=m;function m(k){var C=this._events;if(C!==void 0){var R=C[k];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(k,C){for(var R=new Array(C),A=0;A<C;++A)R[A]=k[A];return R}function b(k,C){for(;C+1<k.length;C++)k[C]=k[C+1];k.pop()}function v(k){for(var C=new Array(k.length),R=0;R<C.length;++R)C[R]=k[R].listener||k[R];return C}function x(k,C){return new Promise(function(R,A){function N(O){k.removeListener(C,I),A(O)}function I(){typeof k.removeListener=="function"&&k.removeListener("error",N),R([].slice.call(arguments))}S(k,C,I,{once:!0}),C!=="error"&&w(k,N,{once:!0})})}function w(k,C,R){typeof k.on=="function"&&S(k,"error",C,R)}function S(k,C,R,A){if(typeof k.on=="function")A.once?k.once(C,R):k.on(C,R);else if(typeof k.addEventListener=="function")k.addEventListener(C,function N(I){A.once&&k.removeEventListener(C,N),R(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return OS.exports}var Q$;function Ro(){return Q$||(Q$=1,function(e){const t=Vh(),{format:n,inspect:r}=JK(),{codes:{ERR_INVALID_ARG_TYPE:s}}=co(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=ti(),l=globalThis.AbortSignal||uw().AbortSignal,c=globalThis.AbortController||uw().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},m=(b,v)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(v,"AbortSignal",b)},y=(b,v)=>{if(typeof b!="function")throw new s(v,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let v=!1;return function(...x){v||(v=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,v;return{promise:new Promise((w,S)=>{b=w,v=S}),resolve:b,reject:v}},promisify(b){return new Promise((v,x)=>{b((w,...S)=>w?x(w):v(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,v){return b},addAbortListener:VE().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);m(v,"signal"),y(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var S;(S=w)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(S=>{m(S,"signals"),S.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(oM)),oM.exports}var DS={},uM,e9;function S1(){if(e9)return uM;e9=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:m}=ti(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=co(),{normalizeEncoding:k}=Ro(),{isAsyncFunction:C,isArrayBufferView:R}=Ro().types,A={};function N(re){return re===(re|0)}function I(re){return re===re>>>0}const O=/^[0-7]+$/,B="must be a 32-bit unsigned integer or an octal string";function D(re,Te,Be){if(typeof re>"u"&&(re=Be),typeof re=="string"){if(u(O,re)===null)throw new x(Te,re,B);re=l(re,8)}return Z(re,Te),re}const W=y((re,Te,Be=o,ke=a)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);if(re<Be||re>ke)throw new w(Te,`>= ${Be} && <= ${ke}`,re)}),P=y((re,Te,Be=-2147483648,ke=2147483647)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);if(re<Be||re>ke)throw new w(Te,`>= ${Be} && <= ${ke}`,re)}),Z=y((re,Te,Be=!1)=>{if(typeof re!="number")throw new v(Te,"number",re);if(!s(re))throw new w(Te,"an integer",re);const ke=Be?1:0,lt=4294967295;if(re<ke||re>lt)throw new w(Te,`>= ${ke} && <= ${lt}`,re)});function U(re,Te){if(typeof re!="string")throw new v(Te,"string",re)}function H(re,Te,Be=void 0,ke){if(typeof re!="number")throw new v(Te,"number",re);if(Be!=null&&re<Be||ke!=null&&re>ke||(Be!=null||ke!=null)&&i(re))throw new w(Te,`${Be!=null?`>= ${Be}`:""}${Be!=null&&ke!=null?" && ":""}${ke!=null?`<= ${ke}`:""}`,re)}const L=y((re,Te,Be)=>{if(!t(Be,re)){const lt="must be one of: "+n(r(Be,Rt=>typeof Rt=="string"?`'${Rt}'`:d(Rt)),", ");throw new x(Te,re,lt)}});function ne(re,Te){if(typeof re!="boolean")throw new v(Te,"boolean",re)}function V(re,Te,Be){return re==null||!c(re,Te)?Be:re[Te]}const Q=y((re,Te,Be=null)=>{const ke=V(Be,"allowArray",!1),lt=V(Be,"allowFunction",!1);if(!V(Be,"nullable",!1)&&re===null||!ke&&e(re)||typeof re!="object"&&(!lt||typeof re!="function"))throw new v(Te,"Object",re)}),ee=y((re,Te)=>{if(re!=null&&typeof re!="object"&&typeof re!="function")throw new v(Te,"a dictionary",re)}),se=y((re,Te,Be=0)=>{if(!e(re))throw new v(Te,"Array",re);if(re.length<Be){const ke=`must be longer than ${Be}`;throw new x(Te,re,ke)}});function me(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++)U(re[Be],`${Te}[${Be}]`)}function ce(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++)ne(re[Be],`${Te}[${Be}]`)}function je(re,Te){se(re,Te);for(let Be=0;Be<re.length;Be++){const ke=re[Be],lt=`${Te}[${Be}]`;if(ke==null)throw new v(lt,"AbortSignal",ke);Qe(ke,lt)}}function De(re,Te="signal"){if(U(re,Te),A[re]===void 0)throw A[h(re)]!==void 0?new S(re+" (signals must use all capital letters)"):new S(re)}const Se=y((re,Te="buffer")=>{if(!R(re))throw new v(Te,["Buffer","TypedArray","DataView"],re)});function Ce(re,Te){const Be=k(Te),ke=re.length;if(Be==="hex"&&ke%2!==0)throw new x("encoding",Te,`is invalid for data of length ${ke}`)}function qe(re,Te="Port",Be=!0){if(typeof re!="number"&&typeof re!="string"||typeof re=="string"&&m(re).length===0||+re!==+re>>>0||re>65535||re===0&&!Be)throw new b(Te,re,Be);return re|0}const Qe=y((re,Te)=>{if(re!==void 0&&(re===null||typeof re!="object"||!("aborted"in re)))throw new v(Te,"AbortSignal",re)}),We=y((re,Te)=>{if(typeof re!="function")throw new v(Te,"Function",re)}),Ne=y((re,Te)=>{if(typeof re!="function"||C(re))throw new v(Te,"Function",re)}),K=y((re,Te)=>{if(re!==void 0)throw new v(Te,"undefined",re)});function ge(re,Te,Be){if(!t(Be,re))throw new v(Te,`('${n(Be,"|")}')`,re)}const Ae=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function le(re,Te){if(typeof re>"u"||!u(Ae,re))throw new x(Te,re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(re){if(typeof re=="string")return le(re,"hints"),re;if(e(re)){const Te=re.length;let Be="";if(Te===0)return Be;for(let ke=0;ke<Te;ke++){const lt=re[ke];le(lt,"hints"),Be+=lt,ke!==Te-1&&(Be+=", ")}return Be}throw new x("hints",re,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return uM={isInt32:N,isUint32:I,parseFileMode:D,validateArray:se,validateStringArray:me,validateBooleanArray:ce,validateAbortSignalArray:je,validateBoolean:ne,validateBuffer:Se,validateDictionary:ee,validateEncoding:Ce,validateFunction:We,validateInt32:P,validateInteger:W,validateNumber:H,validateObject:Q,validateOneOf:L,validatePlainFunction:Ne,validatePort:qe,validateSignalName:De,validateString:U,validateUint32:Z,validateUndefined:K,validateUnion:ge,validateAbortSignal:Qe,validateLinkHeaderValue:oe},uM}var FS={exports:{}},dM={},t9;function Km(){return t9||(t9=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(k){if(s===setTimeout)return setTimeout(k,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(k,0);try{return s(k,0)}catch{try{return s.call(null,k,0)}catch{return s.call(this,k,0)}}}function c(k){if(i===clearTimeout)return clearTimeout(k);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(k);try{return i(k)}catch{try{return i.call(null,k)}catch{return i.call(this,k)}}}var u=[],d=!1,h,m=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):m=-1,u.length&&b())}function b(){if(!d){var k=l(y);d=!0;for(var C=u.length;C;){for(h=u,u=[];++m<C;)h&&h[m].run();m=-1,C=u.length}h=null,d=!1,c(k)}}r.nextTick=function(k){var C=new Array(arguments.length-1);if(arguments.length>1)for(var R=1;R<arguments.length;R++)C[R-1]=arguments[R];u.push(new v(k,C)),u.length===1&&!d&&l(b)};function v(k,C){this.fun=k,this.array=C}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(k){return[]},r.binding=function(k){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(k){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const S=t(w);e.default=S,e.process=S}(dM)),dM}var fM,n9;function rf(){if(n9)return fM;n9=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=ti(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(V,Q=!1){var ee;return!!(V&&typeof V.pipe=="function"&&typeof V.on=="function"&&(!Q||typeof V.pause=="function"&&typeof V.resume=="function")&&(!V._writableState||((ee=V._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!V._writableState||V._readableState))}function d(V){var Q;return!!(V&&typeof V.write=="function"&&typeof V.on=="function"&&(!V._readableState||((Q=V._writableState)===null||Q===void 0?void 0:Q.writable)!==!1))}function h(V){return!!(V&&typeof V.pipe=="function"&&V._readableState&&typeof V.on=="function"&&typeof V.write=="function")}function m(V){return V&&(V._readableState||V._writableState||typeof V.write=="function"&&typeof V.on=="function"||typeof V.pipe=="function"&&typeof V.on=="function")}function y(V){return!!(V&&!m(V)&&typeof V.pipeThrough=="function"&&typeof V.getReader=="function"&&typeof V.cancel=="function")}function b(V){return!!(V&&!m(V)&&typeof V.getWriter=="function"&&typeof V.abort=="function")}function v(V){return!!(V&&!m(V)&&typeof V.readable=="object"&&typeof V.writable=="object")}function x(V){return y(V)||b(V)||v(V)}function w(V,Q){return V==null?!1:Q===!0?typeof V[e]=="function":Q===!1?typeof V[t]=="function":typeof V[e]=="function"||typeof V[t]=="function"}function S(V){if(!m(V))return null;const Q=V._writableState,ee=V._readableState,se=Q||ee;return!!(V.destroyed||V[r]||se!=null&&se.destroyed)}function k(V){if(!d(V))return null;if(V.writableEnded===!0)return!0;const Q=V._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function C(V,Q){if(!d(V))return null;if(V.writableFinished===!0)return!0;const ee=V._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||Q===!1&&ee.ended===!0&&ee.length===0)}function R(V){if(!u(V))return null;if(V.readableEnded===!0)return!0;const Q=V._readableState;return!Q||Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function A(V,Q){if(!u(V))return null;const ee=V._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||Q===!1&&ee.ended===!0&&ee.length===0)}function N(V){return V&&V[i]!=null?V[i]:typeof(V==null?void 0:V.readable)!="boolean"?null:S(V)?!1:u(V)&&V.readable&&!A(V)}function I(V){return V&&V[a]!=null?V[a]:typeof(V==null?void 0:V.writable)!="boolean"?null:S(V)?!1:d(V)&&V.writable&&!k(V)}function O(V,Q){return m(V)?S(V)?!0:!((Q==null?void 0:Q.readable)!==!1&&N(V)||(Q==null?void 0:Q.writable)!==!1&&I(V)):null}function B(V){var Q,ee;return m(V)?V.writableErrored?V.writableErrored:(Q=(ee=V._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function D(V){var Q,ee;return m(V)?V.readableErrored?V.readableErrored:(Q=(ee=V._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function W(V){if(!m(V))return null;if(typeof V.closed=="boolean")return V.closed;const Q=V._writableState,ee=V._readableState;return typeof(Q==null?void 0:Q.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(Q==null?void 0:Q.closed)||(ee==null?void 0:ee.closed):typeof V._closed=="boolean"&&P(V)?V._closed:null}function P(V){return typeof V._closed=="boolean"&&typeof V._defaultKeepAlive=="boolean"&&typeof V._removedConnection=="boolean"&&typeof V._removedContLen=="boolean"}function Z(V){return typeof V._sent100=="boolean"&&P(V)}function U(V){var Q;return typeof V._consuming=="boolean"&&typeof V._dumped=="boolean"&&((Q=V.req)===null||Q===void 0?void 0:Q.upgradeOrConnect)===void 0}function H(V){if(!m(V))return null;const Q=V._writableState,ee=V._readableState,se=Q||ee;return!se&&Z(V)||!!(se&&se.autoDestroy&&se.emitClose&&se.closed===!1)}function L(V){var Q;return!!(V&&((Q=V[o])!==null&&Q!==void 0?Q:V.readableDidRead||V.readableAborted))}function ne(V){var Q,ee,se,me,ce,je,De,Se,Ce,qe;return!!(V&&((Q=(ee=(se=(me=(ce=(je=V[s])!==null&&je!==void 0?je:V.readableErrored)!==null&&ce!==void 0?ce:V.writableErrored)!==null&&me!==void 0?me:(De=V._readableState)===null||De===void 0?void 0:De.errorEmitted)!==null&&se!==void 0?se:(Se=V._writableState)===null||Se===void 0?void 0:Se.errorEmitted)!==null&&ee!==void 0?ee:(Ce=V._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&Q!==void 0?Q:!((qe=V._writableState)===null||qe===void 0)&&qe.errored))}return fM={isDestroyed:S,kIsDestroyed:r,isDisturbed:L,kIsDisturbed:o,isErrored:ne,kIsErrored:s,isReadable:N,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:W,isDuplexNodeStream:h,isFinished:O,isIterable:w,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:R,isReadableFinished:A,isReadableErrored:D,isNodeStream:m,isWebStream:x,isWritable:I,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:k,isWritableFinished:C,isWritableErrored:B,isServerRequest:U,isServerResponse:Z,willEmitClose:H,isTransformStream:v},fM}var r9;function Wh(){if(r9)return FS.exports;r9=1;const e=Km(),{AbortError:t,codes:n}=co(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=Ro(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=S1(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:m}=ti(),{isClosed:y,isReadable:b,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:S,isWritable:k,isWritableNodeStream:C,isWritableStream:R,isWritableFinished:A,isWritableErrored:N,isNodeStream:I,willEmitClose:O,kIsClosedPromise:B}=rf();let D;function W(L){return L.setHeader&&typeof L.abort=="function"}const P=()=>{};function Z(L,ne,V){var Q,ee;if(arguments.length===2?(V=ne,ne=i):ne==null?ne=i:c(ne,"options"),l(V,"callback"),o(ne.signal,"options.signal"),V=a(V),x(L)||R(L))return U(L,ne,V);if(!I(L))throw new r("stream",["ReadableStream","WritableStream","Stream"],L);const se=(Q=ne.readable)!==null&&Q!==void 0?Q:v(L),me=(ee=ne.writable)!==null&&ee!==void 0?ee:C(L),ce=L._writableState,je=L._readableState,De=()=>{L.writable||qe()};let Se=O(L)&&v(L)===se&&C(L)===me,Ce=A(L,!1);const qe=()=>{Ce=!0,L.destroyed&&(Se=!1),!(Se&&(!L.readable||se))&&(!se||Qe)&&V.call(L)};let Qe=w(L,!1);const We=()=>{Qe=!0,L.destroyed&&(Se=!1),!(Se&&(!L.writable||me))&&(!me||Ce)&&V.call(L)},Ne=re=>{V.call(L,re)};let K=y(L);const ge=()=>{K=!0;const re=N(L)||S(L);if(re&&typeof re!="boolean")return V.call(L,re);if(se&&!Qe&&v(L,!0)&&!w(L,!1))return V.call(L,new s);if(me&&!Ce&&!A(L,!1))return V.call(L,new s);V.call(L)},Ae=()=>{K=!0;const re=N(L)||S(L);if(re&&typeof re!="boolean")return V.call(L,re);V.call(L)},le=()=>{L.req.on("finish",qe)};W(L)?(L.on("complete",qe),Se||L.on("abort",ge),L.req?le():L.on("request",le)):me&&!ce&&(L.on("end",De),L.on("close",De)),!Se&&typeof L.aborted=="boolean"&&L.on("aborted",ge),L.on("end",We),L.on("finish",qe),ne.error!==!1&&L.on("error",Ne),L.on("close",ge),K?e.nextTick(ge):ce!=null&&ce.errorEmitted||je!=null&&je.errorEmitted?Se||e.nextTick(Ae):(!se&&(!Se||b(L))&&(Ce||k(L)===!1)||!me&&(!Se||k(L))&&(Qe||b(L)===!1)||je&&L.req&&L.aborted)&&e.nextTick(Ae);const oe=()=>{V=P,L.removeListener("aborted",ge),L.removeListener("complete",qe),L.removeListener("abort",ge),L.removeListener("request",le),L.req&&L.req.removeListener("finish",qe),L.removeListener("end",De),L.removeListener("close",De),L.removeListener("finish",qe),L.removeListener("end",We),L.removeListener("error",Ne),L.removeListener("close",ge)};if(ne.signal&&!K){const re=()=>{const Te=V;oe(),Te.call(L,new t(void 0,{cause:ne.signal.reason}))};if(ne.signal.aborted)e.nextTick(re);else{D=D||Ro().addAbortListener;const Te=D(ne.signal,re),Be=V;V=a((...ke)=>{Te[m](),Be.apply(L,ke)})}}return oe}function U(L,ne,V){let Q=!1,ee=P;if(ne.signal)if(ee=()=>{Q=!0,V.call(L,new t(void 0,{cause:ne.signal.reason}))},ne.signal.aborted)e.nextTick(ee);else{D=D||Ro().addAbortListener;const me=D(ne.signal,ee),ce=V;V=a((...je)=>{me[m](),ce.apply(L,je)})}const se=(...me)=>{Q||e.nextTick(()=>V.apply(L,me))};return h(L[B].promise,se,se),P}function H(L,ne){var V;let Q=!1;return ne===null&&(ne=i),(V=ne)!==null&&V!==void 0&&V.cleanup&&(u(ne.cleanup,"cleanup"),Q=ne.cleanup),new d((ee,se)=>{const me=Z(L,ne,ce=>{Q&&me(),ce?se(ce):ee()})})}return FS.exports=Z,FS.exports.finished=H,FS.exports}var hM,s9;function Gy(){if(s9)return hM;s9=1;const e=Km(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=co(),{Symbol:s}=ti(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=rf(),c=s("kDestroy"),u=s("kConstruct");function d(O,B,D){O&&(O.stack,B&&!B.errored&&(B.errored=O),D&&!D.errored&&(D.errored=O))}function h(O,B){const D=this._readableState,W=this._writableState,P=W||D;return W!=null&&W.destroyed||D!=null&&D.destroyed?(typeof B=="function"&&B(),this):(d(O,W,D),W&&(W.destroyed=!0),D&&(D.destroyed=!0),P.constructed?m(this,O,B):this.once(c,function(Z){m(this,t(Z,O),B)}),this)}function m(O,B,D){let W=!1;function P(Z){if(W)return;W=!0;const U=O._readableState,H=O._writableState;d(Z,H,U),H&&(H.closed=!0),U&&(U.closed=!0),typeof D=="function"&&D(Z),Z?e.nextTick(y,O,Z):e.nextTick(b,O)}try{O._destroy(B||null,P)}catch(Z){P(Z)}}function y(O,B){v(O,B),b(O)}function b(O){const B=O._readableState,D=O._writableState;D&&(D.closeEmitted=!0),B&&(B.closeEmitted=!0),(D!=null&&D.emitClose||B!=null&&B.emitClose)&&O.emit("close")}function v(O,B){const D=O._readableState,W=O._writableState;W!=null&&W.errorEmitted||D!=null&&D.errorEmitted||(W&&(W.errorEmitted=!0),D&&(D.errorEmitted=!0),O.emit("error",B))}function x(){const O=this._readableState,B=this._writableState;O&&(O.constructed=!0,O.closed=!1,O.closeEmitted=!1,O.destroyed=!1,O.errored=null,O.errorEmitted=!1,O.reading=!1,O.ended=O.readable===!1,O.endEmitted=O.readable===!1),B&&(B.constructed=!0,B.destroyed=!1,B.closed=!1,B.closeEmitted=!1,B.errored=null,B.errorEmitted=!1,B.finalCalled=!1,B.prefinished=!1,B.ended=B.writable===!1,B.ending=B.writable===!1,B.finished=B.writable===!1)}function w(O,B,D){const W=O._readableState,P=O._writableState;if(P!=null&&P.destroyed||W!=null&&W.destroyed)return this;W!=null&&W.autoDestroy||P!=null&&P.autoDestroy?O.destroy(B):B&&(B.stack,P&&!P.errored&&(P.errored=B),W&&!W.errored&&(W.errored=B),D?e.nextTick(v,O,B):v(O,B))}function S(O,B){if(typeof O._construct!="function")return;const D=O._readableState,W=O._writableState;D&&(D.constructed=!1),W&&(W.constructed=!1),O.once(u,B),!(O.listenerCount(u)>1)&&e.nextTick(k,O)}function k(O){let B=!1;function D(W){if(B){w(O,W??new n);return}B=!0;const P=O._readableState,Z=O._writableState,U=Z||P;P&&(P.constructed=!0),Z&&(Z.constructed=!0),U.destroyed?O.emit(c,W):W?w(O,W,!0):e.nextTick(C,O)}try{O._construct(W=>{e.nextTick(D,W)})}catch(W){e.nextTick(D,W)}}function C(O){O.emit(u)}function R(O){return(O==null?void 0:O.setHeader)&&typeof O.abort=="function"}function A(O){O.emit("close")}function N(O,B){O.emit("error",B),e.nextTick(A,O)}function I(O,B){!O||a(O)||(!B&&!o(O)&&(B=new r),l(O)?(O.socket=null,O.destroy(B)):R(O)?O.abort():R(O.req)?O.req.abort():typeof O.destroy=="function"?O.destroy(B):typeof O.close=="function"?O.close():B?e.nextTick(N,O,B):e.nextTick(A,O),O.destroyed||(O[i]=!0))}return hM={construct:S,destroyer:I,destroy:h,undestroy:x,errorOrDestroy:w},hM}var pM,i9;function HO(){if(i9)return pM;i9=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=ti(),{EventEmitter:n}=VE();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function m(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",m),s(i,"error",m);function y(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",m),i.removeListener("error",m),o.removeListener("end",y),o.removeListener("close",y),i.removeListener("close",y)}return o.on("end",y),o.on("close",y),i.on("close",y),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return pM={Stream:r,prependListener:s},pM}var mM={exports:{}},a9;function WE(){return a9||(a9=1,function(e){const{SymbolDispose:t}=ti(),{AbortError:n,codes:r}=co(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=rf(),o=Wh(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,m){if(u(h,"signal"),!s(m)&&!i(m))throw new l("stream",["ReadableStream","WritableStream","Stream"],m);return e.exports.addAbortSignalNoValidate(h,m)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const m=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)m();else{c=c||Ro().addAbortListener;const y=c(d,m);o(h,y[t])}return h}}(mM)),mM.exports}var gM,o9;function H_e(){if(o9)return gM;o9=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=ti(),{Buffer:s}=Vh(),{inspect:i}=Ro();return gM=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},gM}var yM,l9;function HE(){if(l9)return yM;l9=1;const{MathFloor:e,NumberIsInteger:t}=ti(),{validateInteger:n}=S1(),{ERR_INVALID_ARG_VALUE:r}=co().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,m){const y=a(d,m,h);if(y!=null){if(!t(y)||y<0){const b=m?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return yM={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},yM}var bM={},LS={exports:{}},c9;function GO(){return c9||(c9=1,function(e,t){var n=Vh(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(LS,LS.exports)),LS.exports}var u9;function G_e(){if(u9)return bM;u9=1;var e=GO().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}bM.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=m,this.end=y,w=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,S;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<x.length?w?w+this.text(x,S):this.text(x,S):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,S){var k=w.length-1;if(k<S)return 0;var C=i(w[k]);return C>=0?(C>0&&(x.lastNeed=C-1),C):--k<S||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(x.lastNeed=C-2),C):--k<S||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(C===2?C=0:x.lastNeed=C-3),C):0))}function o(x,w,S){if((w[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var w=this.lastTotal-this.lastNeed,S=o(this,x);if(S!==void 0)return S;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var S=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=S;var k=x.length-(S-this.lastNeed);return x.copy(this.lastChar,0,k),x.toString("utf8",w,k)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"":w}function d(x,w){if((x.length-w)%2===0){var S=x.toString("utf16le",w);if(S){var k=S.charCodeAt(S.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function m(x,w){var S=(x.length-w)%3;return S===0?x.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-S))}function y(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return bM}var vM,d9;function QK(){if(d9)return vM;d9=1;const e=Km(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=ti(),{Buffer:s}=Vh(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=co().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const m=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;m._read=function(){y||(y=!0,v())},m._destroy=function(x,w){t(b(x),()=>e.nextTick(w,x),S=>e.nextTick(w,S||x))};async function b(x){const w=x!=null,S=typeof d.throw=="function";if(w&&S){const{value:k,done:C}=await d.throw(x);if(await k,C)return}if(typeof d.return=="function"){const{value:k}=await d.return();await k}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)m.push(null);else{const S=x&&typeof x.then=="function"?await x:x;if(S===null)throw y=!1,new a;if(m.push(S))continue;y=!1}}catch(x){m.destroy(x)}break}}return m}return vM=o,vM}var xM,f9;function GE(){if(f9)return xM;f9=1;const e=Km(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=ti();xM=ke,ke.ReadableState=Be;const{EventEmitter:m}=VE(),{Stream:y,prependListener:b}=HO(),{Buffer:v}=Vh(),{addAbortSignal:x}=WE(),w=Wh();let S=Ro().debuglog("stream",he=>{S=he});const k=H_e(),C=Gy(),{getHighWaterMark:R,getDefaultHighWaterMark:A}=HE(),{aggregateTwoErrors:N,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:O,ERR_OUT_OF_RANGE:B,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:W},AbortError:P}=co(),{validateObject:Z}=S1(),U=h("kPaused"),{StringDecoder:H}=G_e(),L=QK();o(ke.prototype,y.prototype),o(ke,y);const ne=()=>{},{errorOrDestroy:V}=C,Q=1,ee=2,se=4,me=8,ce=16,je=32,De=64,Se=128,Ce=256,qe=512,Qe=1024,We=2048,Ne=4096,K=8192,ge=16384,Ae=32768,le=65536,oe=1<<17,re=1<<18;function Te(he){return{enumerable:!1,get(){return(this.state&he)!==0},set(Y){Y?this.state|=he:this.state&=~he}}}i(Be.prototype,{objectMode:Te(Q),ended:Te(ee),endEmitted:Te(se),reading:Te(me),constructed:Te(ce),sync:Te(je),needReadable:Te(De),emittedReadable:Te(Se),readableListening:Te(Ce),resumeScheduled:Te(qe),errorEmitted:Te(Qe),emitClose:Te(We),autoDestroy:Te(Ne),destroyed:Te(K),closed:Te(ge),closeEmitted:Te(Ae),multiAwaitDrain:Te(le),readingMore:Te(oe),dataEmitted:Te(re)});function Be(he,Y,G){typeof G!="boolean"&&(G=Y instanceof Gd()),this.state=We|Ne|ce|je,he&&he.objectMode&&(this.state|=Q),G&&he&&he.readableObjectMode&&(this.state|=Q),this.highWaterMark=he?R(this,he,"readableHighWaterMark",G):A(!1),this.buffer=new k,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,he&&he.emitClose===!1&&(this.state&=-2049),he&&he.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=he&&he.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,he&&he.encoding&&(this.decoder=new H(he.encoding),this.encoding=he.encoding)}function ke(he){if(!(this instanceof ke))return new ke(he);const Y=this instanceof Gd();this._readableState=new Be(he,this,Y),he&&(typeof he.read=="function"&&(this._read=he.read),typeof he.destroy=="function"&&(this._destroy=he.destroy),typeof he.construct=="function"&&(this._construct=he.construct),he.signal&&!Y&&x(he.signal,this)),y.call(this,he),C.construct(this,()=>{this._readableState.needReadable&&F(this,this._readableState)})}ke.prototype.destroy=C.destroy,ke.prototype._undestroy=C.undestroy,ke.prototype._destroy=function(he,Y){Y(he)},ke.prototype[m.captureRejectionSymbol]=function(he){this.destroy(he)},ke.prototype[u]=function(){let he;return this.destroyed||(he=this.readableEnded?null:new P,this.destroy(he)),new l((Y,G)=>w(this,J=>J&&J!==he?G(J):Y(null)))},ke.prototype.push=function(he,Y){return lt(this,he,Y,!1)},ke.prototype.unshift=function(he,Y){return lt(this,he,Y,!0)};function lt(he,Y,G,J){S("readableAddChunk",Y);const ve=he._readableState;let Oe;if((ve.state&Q)===0&&(typeof Y=="string"?(G=G||ve.defaultEncoding,ve.encoding!==G&&(J&&ve.encoding?Y=v.from(Y,G).toString(ve.encoding):(Y=v.from(Y,G),G=""))):Y instanceof v?G="":y._isUint8Array(Y)?(Y=y._uint8ArrayToBuffer(Y),G=""):Y!=null&&(Oe=new I("chunk",["string","Buffer","Uint8Array"],Y))),Oe)V(he,Oe);else if(Y===null)ve.state&=-9,Lt(he,ve);else if((ve.state&Q)!==0||Y&&Y.length>0)if(J)if((ve.state&se)!==0)V(he,new W);else{if(ve.destroyed||ve.errored)return!1;Rt(he,ve,Y,!0)}else if(ve.ended)V(he,new D);else{if(ve.destroyed||ve.errored)return!1;ve.state&=-9,ve.decoder&&!G?(Y=ve.decoder.write(Y),ve.objectMode||Y.length!==0?Rt(he,ve,Y,!1):F(he,ve)):Rt(he,ve,Y,!1)}else J||(ve.state&=-9,F(he,ve));return!ve.ended&&(ve.length<ve.highWaterMark||ve.length===0)}function Rt(he,Y,G,J){Y.flowing&&Y.length===0&&!Y.sync&&he.listenerCount("data")>0?((Y.state&le)!==0?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null,Y.dataEmitted=!0,he.emit("data",G)):(Y.length+=Y.objectMode?1:G.length,J?Y.buffer.unshift(G):Y.buffer.push(G),(Y.state&De)!==0&&en(he)),F(he,Y)}ke.prototype.isPaused=function(){const he=this._readableState;return he[U]===!0||he.flowing===!1},ke.prototype.setEncoding=function(he){const Y=new H(he);this._readableState.decoder=Y,this._readableState.encoding=this._readableState.decoder.encoding;const G=this._readableState.buffer;let J="";for(const ve of G)J+=Y.write(ve);return G.clear(),J!==""&&G.push(J),this._readableState.length=J.length,this};const ft=1073741824;function Pt(he){if(he>ft)throw new B("size","<= 1GiB",he);return he--,he|=he>>>1,he|=he>>>2,he|=he>>>4,he|=he>>>8,he|=he>>>16,he++,he}function qt(he,Y){return he<=0||Y.length===0&&Y.ended?0:(Y.state&Q)!==0?1:r(he)?Y.flowing&&Y.length?Y.buffer.first().length:Y.length:he<=Y.length?he:Y.ended?Y.length:0}ke.prototype.read=function(he){S("read",he),he===void 0?he=NaN:n(he)||(he=s(he,10));const Y=this._readableState,G=he;if(he>Y.highWaterMark&&(Y.highWaterMark=Pt(he)),he!==0&&(Y.state&=-129),he===0&&Y.needReadable&&((Y.highWaterMark!==0?Y.length>=Y.highWaterMark:Y.length>0)||Y.ended))return S("read: emitReadable",Y.length,Y.ended),Y.length===0&&Y.ended?st(this):en(this),null;if(he=qt(he,Y),he===0&&Y.ended)return Y.length===0&&st(this),null;let J=(Y.state&De)!==0;if(S("need readable",J),(Y.length===0||Y.length-he<Y.highWaterMark)&&(J=!0,S("length less than watermark",J)),Y.ended||Y.reading||Y.destroyed||Y.errored||!Y.constructed)J=!1,S("reading, ended or constructing",J);else if(J){S("do read"),Y.state|=me|je,Y.length===0&&(Y.state|=De);try{this._read(Y.highWaterMark)}catch(Oe){V(this,Oe)}Y.state&=-33,Y.reading||(he=qt(G,Y))}let ve;return he>0?ve=ze(he,Y):ve=null,ve===null?(Y.needReadable=Y.length<=Y.highWaterMark,he=0):(Y.length-=he,Y.multiAwaitDrain?Y.awaitDrainWriters.clear():Y.awaitDrainWriters=null),Y.length===0&&(Y.ended||(Y.needReadable=!0),G!==he&&Y.ended&&st(this)),ve!==null&&!Y.errorEmitted&&!Y.closeEmitted&&(Y.dataEmitted=!0,this.emit("data",ve)),ve};function Lt(he,Y){if(S("onEofChunk"),!Y.ended){if(Y.decoder){const G=Y.decoder.end();G&&G.length&&(Y.buffer.push(G),Y.length+=Y.objectMode?1:G.length)}Y.ended=!0,Y.sync?en(he):(Y.needReadable=!1,Y.emittedReadable=!0,xe(he))}}function en(he){const Y=he._readableState;S("emitReadable",Y.needReadable,Y.emittedReadable),Y.needReadable=!1,Y.emittedReadable||(S("emitReadable",Y.flowing),Y.emittedReadable=!0,e.nextTick(xe,he))}function xe(he){const Y=he._readableState;S("emitReadable_",Y.destroyed,Y.length,Y.ended),!Y.destroyed&&!Y.errored&&(Y.length||Y.ended)&&(he.emit("readable"),Y.emittedReadable=!1),Y.needReadable=!Y.flowing&&!Y.ended&&Y.length<=Y.highWaterMark,vt(he)}function F(he,Y){!Y.readingMore&&Y.constructed&&(Y.readingMore=!0,e.nextTick(X,he,Y))}function X(he,Y){for(;!Y.reading&&!Y.ended&&(Y.length<Y.highWaterMark||Y.flowing&&Y.length===0);){const G=Y.length;if(S("maybeReadMore read 0"),he.read(0),G===Y.length)break}Y.readingMore=!1}ke.prototype._read=function(he){throw new O("_read()")},ke.prototype.pipe=function(he,Y){const G=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(he),S("pipe count=%d opts=%j",J.pipes.length,Y);const Oe=(!Y||Y.end!==!1)&&he!==e.stdout&&he!==e.stderr?_t:rs;J.endEmitted?e.nextTick(Oe):G.once("end",Oe),he.on("unpipe",Ke);function Ke(Cr,hn){S("onunpipe"),Cr===G&&hn&&hn.hasUnpiped===!1&&(hn.hasUnpiped=!0,Xt())}function _t(){S("onend"),he.end()}let tn,zn=!1;function Xt(){S("cleanup"),he.removeListener("close",Rr),he.removeListener("finish",ns),tn&&he.removeListener("drain",tn),he.removeListener("error",yr),he.removeListener("unpipe",Ke),G.removeListener("end",_t),G.removeListener("end",rs),G.removeListener("data",un),zn=!0,tn&&J.awaitDrainWriters&&(!he._writableState||he._writableState.needDrain)&&tn()}function nn(){zn||(J.pipes.length===1&&J.pipes[0]===he?(S("false write response, pause",0),J.awaitDrainWriters=he,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(he)&&(S("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(he)),G.pause()),tn||(tn=ye(G,he),he.on("drain",tn))}G.on("data",un);function un(Cr){S("ondata");const hn=he.write(Cr);S("dest.write",hn),hn===!1&&nn()}function yr(Cr){if(S("onerror",Cr),rs(),he.removeListener("error",yr),he.listenerCount("error")===0){const hn=he._writableState||he._readableState;hn&&!hn.errorEmitted?V(he,Cr):he.emit("error",Cr)}}b(he,"error",yr);function Rr(){he.removeListener("finish",ns),rs()}he.once("close",Rr);function ns(){S("onfinish"),he.removeListener("close",Rr),rs()}he.once("finish",ns);function rs(){S("unpipe"),G.unpipe(he)}return he.emit("pipe",G),he.writableNeedDrain===!0?nn():J.flowing||(S("pipe resume"),G.resume()),he};function ye(he,Y){return function(){const J=he._readableState;J.awaitDrainWriters===Y?(S("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(S("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Y)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&he.listenerCount("data")&&he.resume()}}ke.prototype.unpipe=function(he){const Y=this._readableState,G={hasUnpiped:!1};if(Y.pipes.length===0)return this;if(!he){const ve=Y.pipes;Y.pipes=[],this.pause();for(let Oe=0;Oe<ve.length;Oe++)ve[Oe].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Y.pipes,he);return J===-1?this:(Y.pipes.splice(J,1),Y.pipes.length===0&&this.pause(),he.emit("unpipe",this,G),this)},ke.prototype.on=function(he,Y){const G=y.prototype.on.call(this,he,Y),J=this._readableState;return he==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):he==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,S("on readable",J.length,J.reading),J.length?en(this):J.reading||e.nextTick(we,this)),G},ke.prototype.addListener=ke.prototype.on,ke.prototype.removeListener=function(he,Y){const G=y.prototype.removeListener.call(this,he,Y);return he==="readable"&&e.nextTick(Fe,this),G},ke.prototype.off=ke.prototype.removeListener,ke.prototype.removeAllListeners=function(he){const Y=y.prototype.removeAllListeners.apply(this,arguments);return(he==="readable"||he===void 0)&&e.nextTick(Fe,this),Y};function Fe(he){const Y=he._readableState;Y.readableListening=he.listenerCount("readable")>0,Y.resumeScheduled&&Y[U]===!1?Y.flowing=!0:he.listenerCount("data")>0?he.resume():Y.readableListening||(Y.flowing=null)}function we(he){S("readable nexttick read 0"),he.read(0)}ke.prototype.resume=function(){const he=this._readableState;return he.flowing||(S("resume"),he.flowing=!he.readableListening,Ie(this,he)),he[U]=!1,this};function Ie(he,Y){Y.resumeScheduled||(Y.resumeScheduled=!0,e.nextTick(fe,he,Y))}function fe(he,Y){S("resume",Y.reading),Y.reading||he.read(0),Y.resumeScheduled=!1,he.emit("resume"),vt(he),Y.flowing&&!Y.reading&&he.read(0)}ke.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function vt(he){const Y=he._readableState;for(S("flow",Y.flowing);Y.flowing&&he.read()!==null;);}ke.prototype.wrap=function(he){let Y=!1;he.on("data",J=>{!this.push(J)&&he.pause&&(Y=!0,he.pause())}),he.on("end",()=>{this.push(null)}),he.on("error",J=>{V(this,J)}),he.on("close",()=>{this.destroy()}),he.on("destroy",()=>{this.destroy()}),this._read=()=>{Y&&he.resume&&(Y=!1,he.resume())};const G=a(he);for(let J=1;J<G.length;J++){const ve=G[J];this[ve]===void 0&&typeof he[ve]=="function"&&(this[ve]=he[ve].bind(he))}return this},ke.prototype[d]=function(){return ot(this)},ke.prototype.iterator=function(he){return he!==void 0&&Z(he,"options"),ot(this,he)};function ot(he,Y){typeof he.read!="function"&&(he=ke.wrap(he,{objectMode:!0}));const G=$(he,Y);return G.stream=he,G}async function*$(he,Y){let G=ne;function J(Ke){this===he?(G(),G=ne):G=Ke}he.on("readable",J);let ve;const Oe=w(he,{writable:!1},Ke=>{ve=Ke?N(ve,Ke):null,G(),G=ne});try{for(;;){const Ke=he.destroyed?null:he.read();if(Ke!==null)yield Ke;else{if(ve)throw ve;if(ve===null)return;await new l(J)}}}catch(Ke){throw ve=N(ve,Ke),ve}finally{(ve||(Y==null?void 0:Y.destroyOnReturn)!==!1)&&(ve===void 0||he._readableState.autoDestroy)?C.destroyer(he,null):(he.off("readable",J),Oe())}}i(ke.prototype,{readable:{__proto__:null,get(){const he=this._readableState;return!!he&&he.readable!==!1&&!he.destroyed&&!he.errorEmitted&&!he.endEmitted},set(he){this._readableState&&(this._readableState.readable=!!he)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(he){this._readableState&&(this._readableState.flowing=he)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(he){this._readableState&&(this._readableState.destroyed=he)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(he){this[U]=!!he}}}),ke._fromList=ze;function ze(he,Y){if(Y.length===0)return null;let G;return Y.objectMode?G=Y.buffer.shift():!he||he>=Y.length?(Y.decoder?G=Y.buffer.join(""):Y.buffer.length===1?G=Y.buffer.first():G=Y.buffer.concat(Y.length),Y.buffer.clear()):G=Y.buffer.consume(he,Y.decoder),G}function st(he){const Y=he._readableState;S("endReadable",Y.endEmitted),Y.endEmitted||(Y.ended=!0,e.nextTick(be,Y,he))}function be(he,Y){if(S("endReadableNT",he.endEmitted,he.length),!he.errored&&!he.closeEmitted&&!he.endEmitted&&he.length===0){if(he.endEmitted=!0,Y.emit("end"),Y.writable&&Y.allowHalfOpen===!1)e.nextTick(_e,Y);else if(he.autoDestroy){const G=Y._writableState;(!G||G.autoDestroy&&(G.finished||G.writable===!1))&&Y.destroy()}}}function _e(he){he.writable&&!he.writableEnded&&!he.destroyed&&he.end()}ke.from=function(he,Y){return L(ke,he,Y)};let Ue;function Et(){return Ue===void 0&&(Ue={}),Ue}return ke.fromWeb=function(he,Y){return Et().newStreamReadableFromReadableStream(he,Y)},ke.toWeb=function(he,Y){return Et().newReadableStreamFromStreamReadable(he,Y)},ke.wrap=function(he,Y){var G,J;return new ke({objectMode:(G=(J=he.readableObjectMode)!==null&&J!==void 0?J:he.objectMode)!==null&&G!==void 0?G:!0,...Y,destroy(ve,Oe){C.destroyer(he,ve),Oe(ve)}}).wrap(he)},xM}var wM,h9;function KO(){if(h9)return wM;h9=1;const e=Km(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=ti();wM=Z,Z.WritableState=W;const{EventEmitter:u}=VE(),d=HO().Stream,{Buffer:h}=Vh(),m=Gy(),{addAbortSignal:y}=WE(),{getHighWaterMark:b,getDefaultHighWaterMark:v}=HE(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:k,ERR_STREAM_DESTROYED:C,ERR_STREAM_ALREADY_FINISHED:R,ERR_STREAM_NULL_VALUES:A,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:I}=co().codes,{errorOrDestroy:O}=m;a(Z.prototype,d.prototype),a(Z,d);function B(){}const D=l("kOnFinished");function W(Ne,K,ge){typeof ge!="boolean"&&(ge=K instanceof Gd()),this.objectMode=!!(Ne&&Ne.objectMode),ge&&(this.objectMode=this.objectMode||!!(Ne&&Ne.writableObjectMode)),this.highWaterMark=Ne?b(this,Ne,"writableHighWaterMark",ge):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Ae=!!(Ne&&Ne.decodeStrings===!1);this.decodeStrings=!Ae,this.defaultEncoding=Ne&&Ne.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=V.bind(void 0,K),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,P(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!Ne||Ne.emitClose!==!1,this.autoDestroy=!Ne||Ne.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[D]=[]}function P(Ne){Ne.buffered=[],Ne.bufferedIndex=0,Ne.allBuffers=!0,Ne.allNoop=!0}W.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(W.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function Z(Ne){const K=this instanceof Gd();if(!K&&!r(Z,this))return new Z(Ne);this._writableState=new W(Ne,this,K),Ne&&(typeof Ne.write=="function"&&(this._write=Ne.write),typeof Ne.writev=="function"&&(this._writev=Ne.writev),typeof Ne.destroy=="function"&&(this._destroy=Ne.destroy),typeof Ne.final=="function"&&(this._final=Ne.final),typeof Ne.construct=="function"&&(this._construct=Ne.construct),Ne.signal&&y(Ne.signal,this)),d.call(this,Ne),m.construct(this,()=>{const ge=this._writableState;ge.writing||me(this,ge),Se(this,ge)})}s(Z,c,{__proto__:null,value:function(Ne){return r(this,Ne)?!0:this!==Z?!1:Ne&&Ne._writableState instanceof W}}),Z.prototype.pipe=function(){O(this,new k)};function U(Ne,K,ge,Ae){const le=Ne._writableState;if(typeof ge=="function")Ae=ge,ge=le.defaultEncoding;else{if(!ge)ge=le.defaultEncoding;else if(ge!=="buffer"&&!h.isEncoding(ge))throw new I(ge);typeof Ae!="function"&&(Ae=B)}if(K===null)throw new A;if(!le.objectMode)if(typeof K=="string")le.decodeStrings!==!1&&(K=h.from(K,ge),ge="buffer");else if(K instanceof h)ge="buffer";else if(d._isUint8Array(K))K=d._uint8ArrayToBuffer(K),ge="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],K);let oe;return le.ending?oe=new N:le.destroyed&&(oe=new C("write")),oe?(e.nextTick(Ae,oe),O(Ne,oe,!0),oe):(le.pendingcb++,H(Ne,le,K,ge,Ae))}Z.prototype.write=function(Ne,K,ge){return U(this,Ne,K,ge)===!0},Z.prototype.cork=function(){this._writableState.corked++},Z.prototype.uncork=function(){const Ne=this._writableState;Ne.corked&&(Ne.corked--,Ne.writing||me(this,Ne))},Z.prototype.setDefaultEncoding=function(K){if(typeof K=="string"&&(K=o(K)),!h.isEncoding(K))throw new I(K);return this._writableState.defaultEncoding=K,this};function H(Ne,K,ge,Ae,le){const oe=K.objectMode?1:ge.length;K.length+=oe;const re=K.length<K.highWaterMark;return re||(K.needDrain=!0),K.writing||K.corked||K.errored||!K.constructed?(K.buffered.push({chunk:ge,encoding:Ae,callback:le}),K.allBuffers&&Ae!=="buffer"&&(K.allBuffers=!1),K.allNoop&&le!==B&&(K.allNoop=!1)):(K.writelen=oe,K.writecb=le,K.writing=!0,K.sync=!0,Ne._write(ge,Ae,K.onwrite),K.sync=!1),re&&!K.errored&&!K.destroyed}function L(Ne,K,ge,Ae,le,oe,re){K.writelen=Ae,K.writecb=re,K.writing=!0,K.sync=!0,K.destroyed?K.onwrite(new C("write")):ge?Ne._writev(le,K.onwrite):Ne._write(le,oe,K.onwrite),K.sync=!1}function ne(Ne,K,ge,Ae){--K.pendingcb,Ae(ge),se(K),O(Ne,ge)}function V(Ne,K){const ge=Ne._writableState,Ae=ge.sync,le=ge.writecb;if(typeof le!="function"){O(Ne,new S);return}ge.writing=!1,ge.writecb=null,ge.length-=ge.writelen,ge.writelen=0,K?(K.stack,ge.errored||(ge.errored=K),Ne._readableState&&!Ne._readableState.errored&&(Ne._readableState.errored=K),Ae?e.nextTick(ne,Ne,ge,K,le):ne(Ne,ge,K,le)):(ge.buffered.length>ge.bufferedIndex&&me(Ne,ge),Ae?ge.afterWriteTickInfo!==null&&ge.afterWriteTickInfo.cb===le?ge.afterWriteTickInfo.count++:(ge.afterWriteTickInfo={count:1,cb:le,stream:Ne,state:ge},e.nextTick(Q,ge.afterWriteTickInfo)):ee(Ne,ge,1,le))}function Q({stream:Ne,state:K,count:ge,cb:Ae}){return K.afterWriteTickInfo=null,ee(Ne,K,ge,Ae)}function ee(Ne,K,ge,Ae){for(!K.ending&&!Ne.destroyed&&K.length===0&&K.needDrain&&(K.needDrain=!1,Ne.emit("drain"));ge-- >0;)K.pendingcb--,Ae();K.destroyed&&se(K),Se(Ne,K)}function se(Ne){if(Ne.writing)return;for(let le=Ne.bufferedIndex;le<Ne.buffered.length;++le){var K;const{chunk:oe,callback:re}=Ne.buffered[le],Te=Ne.objectMode?1:oe.length;Ne.length-=Te,re((K=Ne.errored)!==null&&K!==void 0?K:new C("write"))}const ge=Ne[D].splice(0);for(let le=0;le<ge.length;le++){var Ae;ge[le]((Ae=Ne.errored)!==null&&Ae!==void 0?Ae:new C("end"))}P(Ne)}function me(Ne,K){if(K.corked||K.bufferProcessing||K.destroyed||!K.constructed)return;const{buffered:ge,bufferedIndex:Ae,objectMode:le}=K,oe=ge.length-Ae;if(!oe)return;let re=Ae;if(K.bufferProcessing=!0,oe>1&&Ne._writev){K.pendingcb-=oe-1;const Te=K.allNoop?B:ke=>{for(let lt=re;lt<ge.length;++lt)ge[lt].callback(ke)},Be=K.allNoop&&re===0?ge:t(ge,re);Be.allBuffers=K.allBuffers,L(Ne,K,!0,K.length,Be,"",Te),P(K)}else{do{const{chunk:Te,encoding:Be,callback:ke}=ge[re];ge[re++]=null;const lt=le?1:Te.length;L(Ne,K,!1,lt,Te,Be,ke)}while(re<ge.length&&!K.writing);re===ge.length?P(K):re>256?(ge.splice(0,re),K.bufferedIndex=0):K.bufferedIndex=re}K.bufferProcessing=!1}Z.prototype._write=function(Ne,K,ge){if(this._writev)this._writev([{chunk:Ne,encoding:K}],ge);else throw new w("_write()")},Z.prototype._writev=null,Z.prototype.end=function(Ne,K,ge){const Ae=this._writableState;typeof Ne=="function"?(ge=Ne,Ne=null,K=null):typeof K=="function"&&(ge=K,K=null);let le;if(Ne!=null){const oe=U(this,Ne,K);oe instanceof n&&(le=oe)}return Ae.corked&&(Ae.corked=1,this.uncork()),le||(!Ae.errored&&!Ae.ending?(Ae.ending=!0,Se(this,Ae,!0),Ae.ended=!0):Ae.finished?le=new R("end"):Ae.destroyed&&(le=new C("end"))),typeof ge=="function"&&(le||Ae.finished?e.nextTick(ge,le):Ae[D].push(ge)),this};function ce(Ne){return Ne.ending&&!Ne.destroyed&&Ne.constructed&&Ne.length===0&&!Ne.errored&&Ne.buffered.length===0&&!Ne.finished&&!Ne.writing&&!Ne.errorEmitted&&!Ne.closeEmitted}function je(Ne,K){let ge=!1;function Ae(le){if(ge){O(Ne,le??S());return}if(ge=!0,K.pendingcb--,le){const oe=K[D].splice(0);for(let re=0;re<oe.length;re++)oe[re](le);O(Ne,le,K.sync)}else ce(K)&&(K.prefinished=!0,Ne.emit("prefinish"),K.pendingcb++,e.nextTick(Ce,Ne,K))}K.sync=!0,K.pendingcb++;try{Ne._final(Ae)}catch(le){Ae(le)}K.sync=!1}function De(Ne,K){!K.prefinished&&!K.finalCalled&&(typeof Ne._final=="function"&&!K.destroyed?(K.finalCalled=!0,je(Ne,K)):(K.prefinished=!0,Ne.emit("prefinish")))}function Se(Ne,K,ge){ce(K)&&(De(Ne,K),K.pendingcb===0&&(ge?(K.pendingcb++,e.nextTick((Ae,le)=>{ce(le)?Ce(Ae,le):le.pendingcb--},Ne,K)):ce(K)&&(K.pendingcb++,Ce(Ne,K))))}function Ce(Ne,K){K.pendingcb--,K.finished=!0;const ge=K[D].splice(0);for(let Ae=0;Ae<ge.length;Ae++)ge[Ae]();if(Ne.emit("finish"),K.autoDestroy){const Ae=Ne._readableState;(!Ae||Ae.autoDestroy&&(Ae.endEmitted||Ae.readable===!1))&&Ne.destroy()}}i(Z.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(Ne){this._writableState&&(this._writableState.destroyed=Ne)}},writable:{__proto__:null,get(){const Ne=this._writableState;return!!Ne&&Ne.writable!==!1&&!Ne.destroyed&&!Ne.errored&&!Ne.ending&&!Ne.ended},set(Ne){this._writableState&&(this._writableState.writable=!!Ne)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const Ne=this._writableState;return Ne?!Ne.destroyed&&!Ne.ending&&Ne.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const qe=m.destroy;Z.prototype.destroy=function(Ne,K){const ge=this._writableState;return!ge.destroyed&&(ge.bufferedIndex<ge.buffered.length||ge[D].length)&&e.nextTick(se,ge),qe.call(this,Ne,K),this},Z.prototype._undestroy=m.undestroy,Z.prototype._destroy=function(Ne,K){K(Ne)},Z.prototype[u.captureRejectionSymbol]=function(Ne){this.destroy(Ne)};let Qe;function We(){return Qe===void 0&&(Qe={}),Qe}return Z.fromWeb=function(Ne,K){return We().newStreamWritableFromWritableStream(Ne,K)},Z.toWeb=function(Ne){return We().newWritableStreamFromStreamWritable(Ne)},wM}var _M,p9;function K_e(){if(p9)return _M;p9=1;const e=Km(),t=Vh(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=rf(),d=Wh(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=co(),{destroyer:b}=Gy(),v=Gd(),x=GE(),w=KO(),{createDeferredPromise:S}=Ro(),k=QK(),C=globalThis.Blob||t.Blob,R=typeof C<"u"?function(W){return W instanceof C}:function(W){return!1},A=globalThis.AbortController||uw().AbortController,{FunctionPrototypeCall:N}=ti();class I extends v{constructor(W){super(W),(W==null?void 0:W.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(W==null?void 0:W.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}_M=function D(W,P){if(l(W))return W;if(a(W))return B({readable:W});if(o(W))return B({writable:W});if(i(W))return B({writable:!1,readable:!1});if(c(W))return B({readable:x.fromWeb(W)});if(u(W))return B({writable:w.fromWeb(W)});if(typeof W=="function"){const{value:U,write:H,final:L,destroy:ne}=O(W);if(s(U))return k(I,U,{objectMode:!0,write:H,final:L,destroy:ne});const V=U==null?void 0:U.then;if(typeof V=="function"){let Q;const ee=N(V,U,se=>{if(se!=null)throw new y("nully","body",se)},se=>{b(Q,se)});return Q=new I({objectMode:!0,readable:!1,write:H,final(se){L(async()=>{try{await ee,e.nextTick(se,null)}catch(me){e.nextTick(se,me)}})},destroy:ne})}throw new y("Iterable, AsyncIterable or AsyncFunction",P,U)}if(R(W))return D(W.arrayBuffer());if(s(W))return k(I,W,{objectMode:!0,writable:!1});if(c(W==null?void 0:W.readable)&&u(W==null?void 0:W.writable))return I.fromWeb(W);if(typeof(W==null?void 0:W.writable)=="object"||typeof(W==null?void 0:W.readable)=="object"){const U=W!=null&&W.readable?a(W==null?void 0:W.readable)?W==null?void 0:W.readable:D(W.readable):void 0,H=W!=null&&W.writable?o(W==null?void 0:W.writable)?W==null?void 0:W.writable:D(W.writable):void 0;return B({readable:U,writable:H})}const Z=W==null?void 0:W.then;if(typeof Z=="function"){let U;return N(Z,W,H=>{H!=null&&U.push(H),U.push(null)},H=>{b(U,H)}),U=new I({objectMode:!0,writable:!1,read(){}})}throw new m(P,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],W)};function O(D){let{promise:W,resolve:P}=S();const Z=new A,U=Z.signal;return{value:D(async function*(){for(;;){const L=W;W=null;const{chunk:ne,done:V,cb:Q}=await L;if(e.nextTick(Q),V)return;if(U.aborted)throw new h(void 0,{cause:U.reason});({promise:W,resolve:P}=S()),yield ne}}(),{signal:U}),write(L,ne,V){const Q=P;P=null,Q({chunk:L,done:!1,cb:V})},final(L){const ne=P;P=null,ne({done:!0,cb:L})},destroy(L,ne){Z.abort(),ne(L)}}}function B(D){const W=D.readable&&typeof D.readable.read!="function"?x.wrap(D.readable):D.readable,P=D.writable;let Z=!!n(W),U=!!r(P),H,L,ne,V,Q;function ee(se){const me=V;V=null,me?me(se):se&&Q.destroy(se)}return Q=new I({readableObjectMode:!!(W!=null&&W.readableObjectMode),writableObjectMode:!!(P!=null&&P.writableObjectMode),readable:Z,writable:U}),U&&(d(P,se=>{U=!1,se&&b(W,se),ee(se)}),Q._write=function(se,me,ce){P.write(se,me)?ce():H=ce},Q._final=function(se){P.end(),L=se},P.on("drain",function(){if(H){const se=H;H=null,se()}}),P.on("finish",function(){if(L){const se=L;L=null,se()}})),Z&&(d(W,se=>{Z=!1,se&&b(W,se),ee(se)}),W.on("readable",function(){if(ne){const se=ne;ne=null,se()}}),W.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const se=W.read();if(se===null){ne=Q._read;return}if(!Q.push(se))return}}),Q._destroy=function(se,me){!se&&V!==null&&(se=new h),ne=null,H=null,L=null,V===null?me(se):(V=me,b(P,se),b(W,se))},Q}return _M}var SM,m9;function Gd(){if(m9)return SM;m9=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ti();SM=a;const s=GE(),i=KO();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=K_e()),c(u,"body")},SM}var CM,g9;function eY(){if(g9)return CM;g9=1;const{ObjectSetPrototypeOf:e,Symbol:t}=ti();CM=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=co().codes,r=Gd(),{getHighWaterMark:s}=HE();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,m=this._writableState,y=h.length;this._transform(c,u,(b,v)=>{if(b){d(b);return}v!=null&&this.push(v),m.ended||y===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},CM}var kM,y9;function tY(){if(y9)return kM;y9=1;const{ObjectSetPrototypeOf:e}=ti();kM=n;const t=eY();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},kM}var EM,b9;function YO(){if(b9)return EM;b9=1;const e=Km(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=ti(),i=Wh(),{once:a}=Ro(),o=Gy(),l=Gd(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=co(),{validateFunction:v,validateAbortSignal:x}=S1(),{isIterable:w,isReadable:S,isReadableNodeStream:k,isNodeStream:C,isTransformStream:R,isWebStream:A,isReadableStream:N,isReadableFinished:I}=rf(),O=globalThis.AbortController||uw().AbortController;let B,D,W;function P(se,me,ce){let je=!1;se.on("close",()=>{je=!0});const De=i(se,{readable:me,writable:ce},Se=>{je=!Se});return{destroy:Se=>{je||(je=!0,o.destroyer(se,Se||new m("pipe")))},cleanup:De}}function Z(se){return v(se[se.length-1],"streams[stream.length - 1]"),se.pop()}function U(se){if(w(se))return se;if(k(se))return H(se);throw new u("val",["Readable","Iterable","AsyncIterable"],se)}async function*H(se){D||(D=GE()),yield*D.prototype[r].call(se)}async function L(se,me,ce,{end:je}){let De,Se=null;const Ce=We=>{if(We&&(De=We),Se){const Ne=Se;Se=null,Ne()}},qe=()=>new n((We,Ne)=>{De?Ne(De):Se=()=>{De?Ne(De):We()}});me.on("drain",Ce);const Qe=i(me,{readable:!1},Ce);try{me.writableNeedDrain&&await qe();for await(const We of se)me.write(We)||await qe();je&&(me.end(),await qe()),ce()}catch(We){ce(De!==We?c(De,We):We)}finally{Qe(),me.off("drain",Ce)}}async function ne(se,me,ce,{end:je}){R(me)&&(me=me.writable);const De=me.getWriter();try{for await(const Se of se)await De.ready,De.write(Se).catch(()=>{});await De.ready,je&&await De.close(),ce()}catch(Se){try{await De.abort(Se),ce(Se)}catch(Ce){ce(Ce)}}}function V(...se){return Q(se,a(Z(se)))}function Q(se,me,ce){if(se.length===1&&t(se[0])&&(se=se[0]),se.length<2)throw new h("streams");const je=new O,De=je.signal,Se=ce==null?void 0:ce.signal,Ce=[];x(Se,"options.signal");function qe(){le(new b)}W=W||Ro().addAbortListener;let Qe;Se&&(Qe=W(Se,qe));let We,Ne;const K=[];let ge=0;function Ae(Be){le(Be,--ge===0)}function le(Be,ke){var lt;if(Be&&(!We||We.code==="ERR_STREAM_PREMATURE_CLOSE")&&(We=Be),!(!We&&!ke)){for(;K.length;)K.shift()(We);(lt=Qe)===null||lt===void 0||lt[s](),je.abort(),ke&&(We||Ce.forEach(Rt=>Rt()),e.nextTick(me,We,Ne))}}let oe;for(let Be=0;Be<se.length;Be++){const ke=se[Be],lt=Be<se.length-1,Rt=Be>0,ft=lt||(ce==null?void 0:ce.end)!==!1,Pt=Be===se.length-1;if(C(ke)){let qt=function(Lt){Lt&&Lt.name!=="AbortError"&&Lt.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Ae(Lt)};if(ft){const{destroy:Lt,cleanup:en}=P(ke,lt,Rt);K.push(Lt),S(ke)&&Pt&&Ce.push(en)}ke.on("error",qt),S(ke)&&Pt&&Ce.push(()=>{ke.removeListener("error",qt)})}if(Be===0)if(typeof ke=="function"){if(oe=ke({signal:De}),!w(oe))throw new d("Iterable, AsyncIterable or Stream","source",oe)}else w(ke)||k(ke)||R(ke)?oe=ke:oe=l.from(ke);else if(typeof ke=="function"){if(R(oe)){var re;oe=U((re=oe)===null||re===void 0?void 0:re.readable)}else oe=U(oe);if(oe=ke(oe,{signal:De}),lt){if(!w(oe,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,oe)}else{var Te;B||(B=tY());const qt=new B({objectMode:!0}),Lt=(Te=oe)===null||Te===void 0?void 0:Te.then;if(typeof Lt=="function")ge++,Lt.call(oe,F=>{Ne=F,F!=null&&qt.write(F),ft&&qt.end(),e.nextTick(Ae)},F=>{qt.destroy(F),e.nextTick(Ae,F)});else if(w(oe,!0))ge++,L(oe,qt,Ae,{end:ft});else if(N(oe)||R(oe)){const F=oe.readable||oe;ge++,L(F,qt,Ae,{end:ft})}else throw new d("AsyncIterable or Promise","destination",oe);oe=qt;const{destroy:en,cleanup:xe}=P(oe,!1,!0);K.push(en),Pt&&Ce.push(xe)}}else if(C(ke)){if(k(oe)){ge+=2;const qt=ee(oe,ke,Ae,{end:ft});S(ke)&&Pt&&Ce.push(qt)}else if(R(oe)||N(oe)){const qt=oe.readable||oe;ge++,L(qt,ke,Ae,{end:ft})}else if(w(oe))ge++,L(oe,ke,Ae,{end:ft});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=ke}else if(A(ke)){if(k(oe))ge++,ne(U(oe),ke,Ae,{end:ft});else if(N(oe)||w(oe))ge++,ne(oe,ke,Ae,{end:ft});else if(R(oe))ge++,ne(oe.readable,ke,Ae,{end:ft});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=ke}else oe=l.from(ke)}return(De!=null&&De.aborted||Se!=null&&Se.aborted)&&e.nextTick(qe),oe}function ee(se,me,ce,{end:je}){let De=!1;if(me.on("close",()=>{De||ce(new y)}),se.pipe(me,{end:!1}),je){let Se=function(){De=!0,me.end()};I(se)?e.nextTick(Se):se.once("end",Se)}else ce();return i(se,{readable:!0,writable:!1},Se=>{const Ce=se._readableState;Se&&Se.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ce&&Ce.ended&&!Ce.errored&&!Ce.errorEmitted?se.once("end",ce).once("error",ce):ce(Se)}),i(me,{readable:!1,writable:!0},ce)}return EM={pipelineImpl:Q,pipeline:V},EM}var TM,v9;function nY(){if(v9)return TM;v9=1;const{pipeline:e}=YO(),t=Gd(),{destroyer:n}=Gy(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=rf(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=co(),m=Wh();return TM=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const v=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const B=b.length-1;b[B]=t.from(b[B])}for(let B=0;B<b.length;++B)if(!(!r(b[B])&&!a(b[B]))){if(B<b.length-1&&!(s(b[B])||c(b[B])||o(b[B])))throw new d(`streams[${B}]`,v[B],"must be readable");if(B>0&&!(i(b[B])||l(b[B])||o(b[B])))throw new d(`streams[${B}]`,v[B],"must be writable")}let x,w,S,k,C;function R(B){const D=k;k=null,D?D(B):B?C.destroy(B):!O&&!I&&C.destroy()}const A=b[0],N=e(b,R),I=!!(i(A)||l(A)||o(A)),O=!!(s(N)||c(N)||o(N));if(C=new t({writableObjectMode:!!(A!=null&&A.writableObjectMode),readableObjectMode:!!(N!=null&&N.readableObjectMode),writable:I,readable:O}),I){if(r(A))C._write=function(D,W,P){A.write(D,W)?P():x=P},C._final=function(D){A.end(),w=D},A.on("drain",function(){if(x){const D=x;x=null,D()}});else if(a(A)){const W=(o(A)?A.writable:A).getWriter();C._write=async function(P,Z,U){try{await W.ready,W.write(P).catch(()=>{}),U()}catch(H){U(H)}},C._final=async function(P){try{await W.ready,W.close().catch(()=>{}),w=P}catch(Z){P(Z)}}}const B=o(N)?N.readable:N;m(B,()=>{if(w){const D=w;w=null,D()}})}if(O){if(r(N))N.on("readable",function(){if(S){const B=S;S=null,B()}}),N.on("end",function(){C.push(null)}),C._read=function(){for(;;){const B=N.read();if(B===null){S=C._read;return}if(!C.push(B))return}};else if(a(N)){const D=(o(N)?N.readable:N).getReader();C._read=async function(){for(;;)try{const{value:W,done:P}=await D.read();if(!C.push(W))return;if(P){C.push(null);return}}catch{return}}}}return C._destroy=function(B,D){!B&&k!==null&&(B=new u),S=null,x=null,w=null,k===null?D(B):(k=D,r(N)&&n(N,B))},C},TM}var x9;function Y_e(){if(x9)return DS;x9=1;const e=globalThis.AbortController||uw().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=co(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=S1(),c=ti().Symbol("kWeak"),u=ti().Symbol("kResistStopPropagation"),{finished:d}=Wh(),h=nY(),{addAbortSignalNoValidate:m}=WE(),{isWritable:y,isNodeStream:b}=rf(),{deprecate:v}=Ro(),{ArrayPrototypePush:x,Boolean:w,MathFloor:S,Number:k,NumberIsNaN:C,Promise:R,PromiseReject:A,PromiseResolve:N,PromisePrototypeThen:I,Symbol:O}=ti(),B=O("kEmpty"),D=O("kEof");function W(Se,Ce){if(Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),b(Se)&&!y(Se))throw new t("stream",Se,"must be writable");const qe=h(this,Se);return Ce!=null&&Ce.signal&&m(Ce.signal,qe),qe}function P(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal");let qe=1;(Ce==null?void 0:Ce.concurrency)!=null&&(qe=S(Ce.concurrency));let Qe=qe-1;return(Ce==null?void 0:Ce.highWaterMark)!=null&&(Qe=S(Ce.highWaterMark)),o(qe,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=qe,(async function*(){const Ne=Ro().AbortSignalAny([Ce==null?void 0:Ce.signal].filter(w)),K=this,ge=[],Ae={signal:Ne};let le,oe,re=!1,Te=0;function Be(){re=!0,ke()}function ke(){Te-=1,lt()}function lt(){oe&&!re&&Te<qe&&ge.length<Qe&&(oe(),oe=null)}async function Rt(){try{for await(let ft of K){if(re)return;if(Ne.aborted)throw new i;try{if(ft=Se(ft,Ae),ft===B)continue;ft=N(ft)}catch(Pt){ft=A(Pt)}Te+=1,I(ft,ke,Be),ge.push(ft),le&&(le(),le=null),!re&&(ge.length>=Qe||Te>=qe)&&await new R(Pt=>{oe=Pt})}ge.push(D)}catch(ft){const Pt=A(ft);I(Pt,ke,Be),ge.push(Pt)}finally{re=!0,le&&(le(),le=null)}}Rt();try{for(;;){for(;ge.length>0;){const ft=await ge[0];if(ft===D)return;if(Ne.aborted)throw new i;ft!==B&&(yield ft),ge.shift(),lt()}await new R(ft=>{le=ft})}}finally{re=!0,oe&&(oe(),oe=null)}}).call(this)}function Z(Se=void 0){return Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal"),(async function*(){let qe=0;for await(const We of this){var Qe;if(Se!=null&&(Qe=Se.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Se.signal.reason});yield[qe++,We]}}).call(this)}async function U(Se,Ce=void 0){for await(const qe of V.call(this,Se,Ce))return!0;return!1}async function H(Se,Ce=void 0){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);return!await U.call(this,async(...qe)=>!await Se(...qe),Ce)}async function L(Se,Ce){for await(const qe of V.call(this,Se,Ce))return qe}async function ne(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,We){return await Se(Qe,We),B}for await(const Qe of P.call(this,qe,Ce));}function V(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,We){return await Se(Qe,We)?Qe:B}return P.call(this,qe,Ce)}class Q extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Se,Ce,qe){var Qe;if(typeof Se!="function")throw new n("reducer",["Function","AsyncFunction"],Se);qe!=null&&l(qe,"options"),(qe==null?void 0:qe.signal)!=null&&a(qe.signal,"options.signal");let We=arguments.length>1;if(qe!=null&&(Qe=qe.signal)!==null&&Qe!==void 0&&Qe.aborted){const le=new i(void 0,{cause:qe.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(le)),le}const Ne=new e,K=Ne.signal;if(qe!=null&&qe.signal){const le={once:!0,[c]:this,[u]:!0};qe.signal.addEventListener("abort",()=>Ne.abort(),le)}let ge=!1;try{for await(const le of this){var Ae;if(ge=!0,qe!=null&&(Ae=qe.signal)!==null&&Ae!==void 0&&Ae.aborted)throw new i;We?Ce=await Se(Ce,le,{signal:K}):(Ce=le,We=!0)}if(!ge&&!We)throw new Q}finally{Ne.abort()}return Ce}async function se(Se){Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal");const Ce=[];for await(const Qe of this){var qe;if(Se!=null&&(qe=Se.signal)!==null&&qe!==void 0&&qe.aborted)throw new i(void 0,{cause:Se.signal.reason});x(Ce,Qe)}return Ce}function me(Se,Ce){const qe=P.call(this,Se,Ce);return(async function*(){for await(const We of qe)yield*We}).call(this)}function ce(Se){if(Se=k(Se),C(Se))return 0;if(Se<0)throw new s("number",">= 0",Se);return Se}function je(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ce(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ne of this){var We;if(Ce!=null&&(We=Ce.signal)!==null&&We!==void 0&&We.aborted)throw new i;Se--<=0&&(yield Ne)}}).call(this)}function De(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=ce(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const Ne of this){var We;if(Ce!=null&&(We=Ce.signal)!==null&&We!==void 0&&We.aborted)throw new i;if(Se-- >0&&(yield Ne),Se<=0)return}}).call(this)}return DS.streamReturningOperators={asIndexedPairs:v(Z,"readable.asIndexedPairs will be removed in a future version."),drop:je,filter:V,flatMap:me,map:P,take:De,compose:W},DS.promiseReturningOperators={every:H,forEach:ne,reduce:ee,toArray:se,some:U,find:L},DS}var AM,w9;function rY(){if(w9)return AM;w9=1;const{ArrayPrototypePop:e,Promise:t}=ti(),{isIterable:n,isNodeStream:r,isWebStream:s}=rf(),{pipelineImpl:i}=YO(),{finished:a}=Wh();sY();function o(...l){return new t((c,u)=>{let d,h;const m=l[l.length-1];if(m&&typeof m=="object"&&!r(m)&&!n(m)&&!s(m)){const y=e(l);d=y.signal,h=y.end}i(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return AM={finished:a,pipeline:o},AM}var _9;function sY(){if(_9)return sM.exports;_9=1;const{Buffer:e}=Vh(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ti(),{promisify:{custom:s}}=Ro(),{streamReturningOperators:i,promiseReturningOperators:a}=Y_e(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=co(),l=nY(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=HE(),{pipeline:d}=YO(),{destroyer:h}=Gy(),m=Wh(),y=rY(),b=rf(),v=sM.exports=HO().Stream;v.isDestroyed=b.isDestroyed,v.isDisturbed=b.isDisturbed,v.isErrored=b.isErrored,v.isReadable=b.isReadable,v.isWritable=b.isWritable,v.Readable=GE();for(const w of n(i)){let k=function(...C){if(new.target)throw o();return v.Readable.from(r(S,this,C))};const S=i[w];t(k,"name",{__proto__:null,value:S.name}),t(k,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let k=function(...C){if(new.target)throw o();return r(S,this,C)};const S=a[w];t(k,"name",{__proto__:null,value:S.name}),t(k,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}v.Writable=KO(),v.Duplex=Gd(),v.Transform=eY(),v.PassThrough=tY(),v.pipeline=d;const{addAbortSignal:x}=WE();return v.addAbortSignal=x,v.finished=m,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,s,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(m,s,{__proto__:null,enumerable:!0,get(){return y.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},sM.exports}var S9;function Z_e(){return S9||(S9=1,function(e){const t=sY(),n=rY(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(rM)),rM.exports}var iY=Z_e();class ZO extends iY.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Ze(yt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ze(yt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class XO extends iY.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Oa(new Ze(yt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Oa(new Ze(yt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Ze(yt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Ze(yt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ze(yt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var Xl=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Jl=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class La{get position(){return this.flag&km?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=za(t,n);Object.assign(this,Bm(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&zE||this.inode.flags&So.Sync)}_emitChange(){_a(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"chown");this.dirty=!0,FK(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=Uh(t,-1);if(n<0)throw new Ze(yt.EINVAL,"Invalid mode");if(this.closed)throw Ze.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>ks?-61441:ks)|n,(this._isSync||n>ks)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Ze.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Ze.With("EBADF",this.path,"truncate");if(t<0)throw new Ze(yt.EINVAL);if(this.dirty=!0,!(this.flag&Pa||this.flag&Pd))throw new Ze(yt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Ze.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=$C(t),this.inode.mtimeMs=$C(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=Od(n,"utf8","a",420);if(!(Dd(r.flag)&km))throw new Ze(yt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Ze(yt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Ds.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"read");if(this.flag&Pa)throw new Ze(yt.EPERM,"File not opened with a readable mode");this.inode.flags&So.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!ow(this.inode)&&!aw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=Od(t,null,"r",292);if(Dd(n.flag)&Pa)throw new Ze(yt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Ds.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Ze.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Ze.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&So.Immutable)throw new Ze(yt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&Pa)throw Ze.With("EBADF",this.path,"readLines");return m_e({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Ze.With("EBADF",this.path,"stat");if(!fs(this.context,this.inode,qi))throw Ze.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Wm(this.inode):new nf(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Ze.With("EBADF",this.path,"write");if(this.inode.flags&So.Immutable)throw new Ze(yt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&Pa||this.flag&Pd))throw new Ze(yt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!ow(this.inode)&&!aw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Ds.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=Od(n,"utf8","w",420),s=Dd(r.flag);if(!(s&Pa||s&Pd))throw new Ze(yt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Ze(yt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Ds.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Ze.With("EBADF",this.path,"close");await this.sync(),this.dispose(),$K(this.context,this.fd)}dispose(t){if(this.closed)throw Ze.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ze.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&Pa)throw Ze.With("EBADF",this.path,"createReadStream");return new ZO(t,this)}createWriteStream(t={}){if(this.closed)throw Ze.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&So.Immutable)throw new Ze(yt.EPERM,"File is immutable",this.path,"createWriteStream");return new XO(t,this)}}async function aY(e,t){e=Dn(e),t=Dn(t);const n=Mr(e,this),r=Mr(t,this);if(!(await Ky.call(this,Yr(e))).hasAccess(li,this))throw Ze.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),_a(this,"rename",e.toString()),_a(this,"change",t.toString());return}await XE.call(this,t,await ZE(e)),await YE.call(this,e),_a(this,"rename",e.toString())}catch(s){throw hs(s,{[n.path]:e,[r.path]:t})}}async function C1(e){try{const{fs:t,path:n}=Mr(await Hh.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Ze&&t.code=="ENOENT")return!1;throw t}}async function Ky(e,t){e=Dn(e);const{fs:n,path:r}=Mr(await Hh.call(this,e),this);try{const s=await n.stat(r);if(Vi&&!fs(this,s,qi))throw Ze.With("EACCES",r,"stat");return t!=null&&t.bigint?new Wm(s):new nf(s)}catch(s){throw hs(s,{[r]:e})}}async function KE(e,t){e=Dn(e);const{fs:n,path:r}=Mr(e,this);try{const s=await n.stat(r);if(Vi&&!fs(this,s,qi))throw Ze.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Wm(s):new nf(s)}catch(s){throw hs(s,{[r]:e})}}async function oY(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await Xl(n,await Ql.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Jl(n);r&&await r}}async function YE(e){e=Dn(e);const{fs:t,path:n}=Mr(e,this);try{if(Vi&&!fs(this,await t.stat(n),li))throw Ze.With("EACCES",n,"unlink");await t.unlink(n),_a(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}async function Yy(e,t,n){var r;t=Dn(t);const s=Uh(n.mode,420),i=Dd(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await VC(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&LE))throw Ze.With("ENOENT",a,"_open");const d=await o.stat(Yr(l));if(!fs(e,d,li))throw Ze.With("EACCES",Yr(a),"_open");if(!Ic(d))throw Ze.With("ENOTDIR",Yr(a),"_open");const{euid:h,egid:m}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:Dc.credentials,y=await o.createFile(l,{mode:s,uid:d.mode&v1?d.uid:h,gid:d.mode&x1?d.gid:m});return new La(e,UC(new zC(e,t,o,l,i,y)))}if(!fs(e,c,zK(i)))throw Ze.With("EACCES",a,"_open");if(i&BE)throw Ze.With("EEXIST",a,"_open");const u=new La(e,UC(new zC(e,t,o,l,i,c)));return i&$E&&await u.truncate(0),u}async function Ql(e,t="r",n=420){return await Yy(this,e,{flag:t,mode:n})}async function ZE(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=Od(t,null,"r",292);return await Xl(n,typeof e=="object"&&"fd"in e?e:await Ql.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=Jl(n);r&&await r}}async function XE(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Od(n,"utf8","w+",420),i=Xl(r,e instanceof La?e:await Ql.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Ze(yt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function lY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Od(n,"utf8","a",420);if(!(Dd(s.flag)&km))throw new Ze(yt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Ze(yt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await Xl(r,typeof e=="object"&&"fd"in e?e:await Ql.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function JO(e){e=await Hh.call(this,e);const{fs:t,path:n}=Mr(e,this);try{const r=await t.stat(n);if(!r)throw Ze.With("ENOENT",e,"rmdir");if(!Ic(r))throw Ze.With("ENOTDIR",n,"rmdir");if(Vi&&!fs(this,r,li))throw Ze.With("EACCES",n,"rmdir");await t.rmdir(n),_a(this,"rename",e.toString())}catch(r){throw hs(r,{[n]:e})}}async function JE(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:Dc.credentials;t=typeof t=="object"?t:{mode:t};const a=Uh(t==null?void 0:t.mode,511);e=await Hh.call(this,e);const{fs:o,path:l,root:c}=Mr(e,this),u={[l]:e},d=async(h,m)=>{if(!fs(this,m,li))throw Ze.With("EACCES",Yr(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:m.mode&v1?m.uid:s,gid:m.mode&x1?m.gid:i});return _a(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(Yr(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=Yr(y),b=Yr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[await o.stat(Yr(h[0]))];for(const[y,b]of h.entries())m.push(await d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw hs(h,u)}}async function Ym(e,t){t=typeof t=="object"?t:{encoding:t},e=await Hh.call(this,e);const{fs:n,path:r}=Mr(e,this),s=await n.stat(r).catch(l=>bs(hs(l,{[r]:e})));if(!s)throw Ze.With("ENOENT",e,"readdir");if(!fs(this,s,qi))throw Ze.With("EACCES",e,"readdir");if(!Ic(s))throw Ze.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>bs(hs(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(as(r,l)).catch(u=>{if(u.code!="ENOENT")throw hs(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new cw(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Ds.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Ic(c))))for(const u of await Ym.call(this,as(e,l),t))u instanceof cw?(u.path=as(l,u.path),a.push(u)):Ds.isBuffer(u)?a.push(Ds.from(as(l,CO(u)))):a.push(as(l,u))};return await Promise.all(i.map(o)),a}async function cY(e,t){e=Dn(e),t=Dn(t);const{fs:n,path:r}=Mr(e,this),s=Mr(t,this);if(n!=s.fs)throw Ze.With("EXDEV",t,"link");try{if(Vi&&!fs(this,await n.stat(Yr(r)),qi))throw Ze.With("EACCES",Yr(r),"link");if(Vi&&!(await Ky.call(this,Yr(t))).hasAccess(li,this))throw Ze.With("EACCES",Yr(t),"link");if(Vi&&!fs(this,await n.stat(r),qi))throw Ze.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw hs(i,{[s.path]:t,[r]:e})}}async function uY(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ze(yt.EINVAL,"Invalid symlink type: "+n);if(t=Dn(t),await C1.call(this,t))throw Ze.With("EEXIST",t,"symlink");const s=Xl(r,await Yy(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(Dn(e,!0)),await s.chmod(tf)}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function qC(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await Xl(n,await Yy(this,Dn(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=Jl(n);r&&await r}}async function dY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Xl(r,await Ql.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function fY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Xl(r,await Yy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function hY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Xl(n,await Ql.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Jl(n);r&&await r}}async function pY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Xl(n,await Yy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=Jl(n);r&&await r}}async function QO(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Xl(r,await Ql.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function mY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Xl(r,await Yy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=Jl(r);s&&await s}}async function VC(e,t,n){if(n){const l=Mr(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Mr(t,e),c=await l.fs.stat(l.path);if(!ay(c))return{...l,fullPath:t,stats:c};const u=Hd.call(e,Yr(t),(await qC.call(e,t)).toString());return await VC(e,u)}catch{}const{base:r,dir:s}=ou(t),i=s=="/"?"/":await Hh.call(e,s),a=as(i,r),o=Mr(a,e);try{const l=await o.fs.stat(o.path);if(!ay(l))return{...o,fullPath:a,stats:l};const c=Hd.call(e,i,(await qC.call(e,a)).toString());return await VC(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw hs(l,{[o.path]:a})}}async function Hh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Dn(e);const{fullPath:s}=await VC(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Ds.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function X_e(e,t={}){const n=new WK(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function gY(e,t=MO){if(!(await Ky.call(this,e)).hasAccess(t,this))throw new Ze(yt.EACCES)}async function eD(e,t){e=Dn(e);const n=await KE.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&ks){case Ri:if(t!=null&&t.recursive)for(const r of await Ym.call(this,e))await eD.call(this,as(e,r),t);await JO.call(this,e);break;case Cc:case tf:case Um:case qm:await YE.call(this,e);break;case Vm:case zm:default:throw new Ze(yt.EPERM,"File type not supported",e,"rm")}}async function yY(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await JE.call(this,s),n=="buffer"?Ds.from(s):s}async function tD(e,t,n){if(e=Dn(e),t=Dn(t),n&&n&IO&&await C1.call(this,t))throw new Ze(yt.EEXIST,"Destination file already exists",t,"copyFile");await XE.call(this,t,await ZE.call(this,e)),_a(this,"rename",t.toString())}function bY(e,t){return e=Dn(e),Promise.resolve(new WO(e,this))}async function nD(e,t,n){e=Dn(e),t=Dn(t);const r=await KE.call(this,e);if(n!=null&&n.errorOnExist&&await C1.call(this,t))throw new Ze(yt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&ks){case Ri:{if(!(n!=null&&n.recursive))throw new Ze(yt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([Ym.call(this,e,{withFileTypes:!0}),JE.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(as(e,a.name),as(t,a.name))||await nD.call(this,as(e,a.name),as(t,a.name),n)};await Promise.all(s.map(i));break}case Cc:case tf:await tD.call(this,e,t);break;case Um:case qm:case Vm:case zm:default:throw new Ze(yt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await QO.call(this,t,r.atime,r.mtime)}async function vY(e,t){e=Dn(e);const{fs:n}=Mr(e,this);return Promise.resolve(qK(n,t==null?void 0:t.bigint))}function xY(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await Ym(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await Ky(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const J_e=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:La,access:gY,appendFile:lY,chmod:hY,chown:dY,constants:OK,copyFile:tD,cp:nD,exists:C1,glob:xY,lchmod:pY,lchown:fY,link:cY,lstat:KE,lutimes:mY,mkdir:JE,mkdtemp:yY,open:Ql,opendir:bY,readFile:ZE,readdir:Ym,readlink:qC,realpath:Hh,rename:aY,rm:eD,rmdir:JO,stat:Ky,statfs:vY,symlink:uY,truncate:oY,unlink:YE,utimes:QO,watch:X_e,writeFile:XE},Symbol.toStringTag,{value:"Module"})),gr=()=>{};async function Q_e(e){const t=[];for await(const n of e)t.push(n);return t}function eSe(e,t,n=gr){aY.call(this,e,t).then(()=>n()).catch(n)}function tSe(e,t=gr){C1.call(this,e).then(t).catch(()=>t(!1))}function nSe(e,t,n=gr){n=typeof t=="function"?t:n,Ky.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function rSe(e,t,n=gr){n=typeof t=="function"?t:n,KE.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function sSe(e,t=0,n=gr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;oY.call(this,e,r).then(()=>n()).catch(n)}function iSe(e,t=gr){YE.call(this,e).then(()=>t()).catch(t)}function aSe(e,t,n,r=gr){const s=Uh(n,420);r=typeof n=="function"?n:r,Ql.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function oSe(e,t,n=gr){n=typeof t=="function"?t:n,ZE.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function lSe(e,t,n,r=gr){r=typeof n=="function"?n:r,XE.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function cSe(e,t,n,r=gr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,lY.call(this,e,t,s).then(()=>r()).catch(r)}function uSe(e,t,n=gr){n=typeof t=="function"?t:n,new La(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Wm(r):r)).catch(n)}function dSe(e,t=gr){new La(this,e).close().then(()=>t()).catch(t)}function fSe(e,t,n=gr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new La(this,e);if(r<0)throw new Ze(yt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function hSe(e,t=gr){new La(this,e).sync().then(()=>t()).catch(t)}function pSe(e,t=gr){new La(this,e).datasync().then(()=>t()).catch(t)}function mSe(e,t,n,r,s,i=gr){let a,o,l,c,u;const d=new La(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Ze(yt.EINVAL,"Invalid arguments"));return}a=Ds.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a.toString(u))).catch(h)}else{a=Ds.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a)).catch(h)}}function gSe(e,t,n,r,s,i=gr){new La(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function ySe(e,t,n,r=gr){new La(this,e).chown(t,n).then(()=>r()).catch(r)}function bSe(e,t,n){new La(this,e).chmod(t).then(()=>n()).catch(n)}function vSe(e,t,n,r=gr){new La(this,e).utimes(t,n).then(()=>r()).catch(r)}function xSe(e,t=gr){JO.call(this,e).then(()=>t()).catch(t)}function wSe(e,t,n=gr){JE.call(this,e,t).then(()=>n()).catch(n)}function _Se(e,t,n=gr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};Ym.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function SSe(e,t,n=gr){cY.call(this,e,t).then(()=>n()).catch(n)}function CSe(e,t,n,r=gr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,uY.call(this,e,t,s).then(()=>r()).catch(r)}function kSe(e,t,n=gr){n=typeof t=="function"?t:n,qC.call(this,e).then(r=>n(void 0,r)).catch(n)}function ESe(e,t,n,r=gr){dY.call(this,e,t,n).then(()=>r()).catch(r)}function TSe(e,t,n,r=gr){fY.call(this,e,t,n).then(()=>r()).catch(r)}function ASe(e,t,n=gr){hY.call(this,e,t).then(()=>n()).catch(n)}function RSe(e,t,n=gr){pY.call(this,e,t).then(()=>n()).catch(n)}function NSe(e,t,n,r=gr){QO.call(this,e,t,n).then(()=>r()).catch(r)}function MSe(e,t,n,r=gr){mY.call(this,e,t,n).then(()=>r()).catch(r)}function ISe(e,t,n=gr){n=typeof t=="function"?t:n,Hh.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function jSe(e,t,n=gr){const r=typeof t=="number"?t:qi;n=typeof t=="function"?t:n,gY.call(this,e,r).then(()=>n()).catch(n)}const m0=new Map;function PSe(e,t,n){const r=Dn(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Ze(yt.EINVAL,"No listener specified",e.toString(),"watchFile");if(m0.has(r)){const a=m0.get(r);a&&a.listeners.add(n);return}const i=new x_e(this,r,s);i.on("change",(a,o)=>{const l=m0.get(r);if(l)for(const c of l.listeners)c(a,o)}),m0.set(r,{watcher:i,listeners:new Set})}function OSe(e,t=gr){const n=Dn(e),r=m0.get(n);r&&(t&&t!==gr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),m0.delete(n)))}function DSe(e,t,n){const r=new WK(this,Dn(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||gr),r}function FSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=Ql.call(this,e,"r",t==null?void 0:t.mode);return new ZO({...t,autoClose:!0},n)}function LSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=Ql.call(this,e,"w",t==null?void 0:t.mode);return new XO(t,n)}function BSe(e,t,n=gr){n=typeof t=="function"?t:n,eD.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function $Se(e,t,n=gr){n=typeof t=="function"?t:n,yY.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function zSe(e,t,n,r=gr){r=typeof n=="function"?n:r,tD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function USe(e,t,n,r=gr){r=typeof n=="function"?n:r,new La(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function qSe(e,t,n,r=gr){r=typeof n=="function"?n:r,new La(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function VSe(e,t,n=gr){n=typeof t=="function"?t:n,bY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function WSe(e,t,n,r=gr){r=typeof n=="function"?n:r,nD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function HSe(e,t,n=gr){n=typeof t=="function"?t:n,vY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function GSe(e,t){const n=await Ql.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function KSe(e,t,n=gr){n=typeof t=="function"?t:n;const r=xY.call(this,e,typeof t=="function"?void 0:t);Q_e(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var Dp=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Jo=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},YSe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},WC;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(WC||(WC={}));let wY=(()=>{var e,t,n,r,s;let i=[$m()],a,o=[],l,c,u=[],d=[],h,m=[],y=[],b,v=[],x=[],w,S=[],k=[],C,R=[],A=[],N,I=[],O=[];return l=class{constructor(B=bs(new Ze(yt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Jo(this,u,0),this.extsize=(Jo(this,d),Jo(this,m,0)),this.nextents=(Jo(this,y),Jo(this,v,0)),this.projid=(Jo(this,x),Jo(this,S,0)),this.cowextsize=(Jo(this,k),Jo(this,R,0)),this.pad=(Jo(this,A),Jo(this,I,[])),Jo(this,O),this.extsize=B.size,this.nextents=1,this.projid=B.uid,this.cowextsize=B.size;for(const D of Object.keys(So))B.flags&So[D]&&D in WC&&(this.xflags|=WC[D])}},YSe(l,"fsxattr"),(()=>{const B=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=Jn).uint32.bind(e)],h=[(t=Jn).uint32.bind(t)],b=[(n=Jn).uint32.bind(n)],w=[(r=Jn).uint32.bind(r)],C=[(s=Jn).uint32.bind(s)],N=[Jn.char(8)],Dp(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:D=>"xflags"in D,get:D=>D.xflags,set:(D,W)=>{D.xflags=W}},metadata:B},u,d),Dp(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:D=>"extsize"in D,get:D=>D.extsize,set:(D,W)=>{D.extsize=W}},metadata:B},m,y),Dp(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:D=>"nextents"in D,get:D=>D.nextents,set:(D,W)=>{D.nextents=W}},metadata:B},v,x),Dp(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:D=>"projid"in D,get:D=>D.projid,set:(D,W)=>{D.projid=W}},metadata:B},S,k),Dp(null,null,C,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:D=>"cowextsize"in D,get:D=>D.cowextsize,set:(D,W)=>{D.cowextsize=W}},metadata:B},R,A),Dp(null,null,N,{kind:"field",name:"pad",static:!1,private:!1,access:{has:D=>"pad"in D,get:D=>D.pad,set:(D,W)=>{D.pad=W}},metadata:B},I,O),Dp(null,a={value:l},i,{kind:"class",name:l.name,metadata:B},null,o),l=a.value,B&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:B}),Jo(l,o)})(),l})();var Us;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(Us||(Us={}));var yc;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(yc||(yc={}));async function ZSe(e,t,...n){e=Dn(e);const{fs:r,path:s}=Mr(e,this);try{const i=new Ei(await r.stat(s));switch(t){case Us.GetFlags:case yc.GetFlags:return i.flags;case Us.SetFlags:case yc.SetFlags:i.flags=n[0],await r.touch(s,i);return;case Us.GetVersion:case yc.GetVersion:return i.version;case Us.SetVersion:case yc.SetVersion:i.version=n[0],await r.touch(s,i);return;case Us.Fiemap:break;case Us.GetXattr:return new wY(i);case Us.SetXattr:break;case Us.GetLabel:return r.label;case Us.SetLabel:r.label=n[0];return;case Us.GetUUID:return r.uuid;case Us.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw hs(i,{[s]:e})}throw new Ze(yt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function XSe(e,t,...n){e=Dn(e);const{fs:r,path:s}=Mr(e,this);try{const i=new Ei(r.statSync(s));switch(t){case Us.GetFlags:case yc.GetFlags:return i.flags;case Us.SetFlags:case yc.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case Us.GetVersion:case yc.GetVersion:return i.version;case Us.SetVersion:case yc.SetVersion:i.version=n[0],r.touchSync(s,i);return;case Us.Fiemap:break;case Us.GetXattr:return new wY(i);case Us.SetXattr:break;case Us.GetLabel:return r.label;case Us.SetLabel:r.label=n[0];return;case Us.GetUUID:return r.uuid;case Us.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw hs(i,{[s]:e})}throw new Ze(yt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const JSe=[];function Zy(e,t,n,r){if(!t.startsWith("user.")&&!JSe.includes(t))throw new Ze(yt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function QSe(e,t,n={}){var r;e=Dn(e);const{fs:s,path:i}=Mr(e,this);Zy(this,t,e,"xattr.get");try{const a=await s.stat(i);if(Vi&&!fs(this,a,qi))throw Ze.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new _h);const o=a.attributes.get(t);if(!o)throw Ze.With("ENODATA",i,"xattr.get");const l=Ds.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw hs(a,{[i]:e})}}function e2e(e,t,n={}){var r;e=Dn(e),Zy(this,t,e,"xattr.get");const{fs:s,path:i}=Mr(e,this);try{const a=s.statSync(i);if(Vi&&!fs(this,a,qi))throw Ze.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new _h);const o=a.attributes.get(t);if(!o)throw Ze.With("ENODATA",i,"xattr.get");const l=Ds.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw hs(a,{[i]:e})}}async function t2e(e,t,n,r={}){var s;e=Dn(e);const{fs:i,path:a}=Mr(e,this);Zy(this,t,e,"xattr.set");try{const o=await i.stat(a);if(Vi&&!fs(this,o,li))throw Ze.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new _h);const l=o.attributes.get(t);if(r.create&&l)throw Ze.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ze.With("ENODATA",a,"xattr.set");o.attributes.set(t,Ds.from(n)),await i.touch(a,Bm(o,"attributes"))}catch(o){throw hs(o,{[a]:e})}}function n2e(e,t,n,r={}){var s;e=Dn(e);const{fs:i,path:a}=Mr(e,this);Zy(this,t,e,"xattr.set");try{const o=i.statSync(a);if(Vi&&!fs(this,o,li))throw Ze.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new _h);const l=o.attributes.get(t);if(r.create&&l)throw Ze.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ze.With("ENODATA",a,"xattr.set");o.attributes.set(t,Ds.from(n)),i.touchSync(a,Bm(o,"attributes"))}catch(o){throw hs(o,{[a]:e})}}async function r2e(e,t){var n;e=Dn(e);const{fs:r,path:s}=Mr(e,this);Zy(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(Vi&&!fs(this,i,li))throw Ze.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new _h),!i.attributes.get(t))throw Ze.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,Bm(i,"attributes"))}catch(i){throw hs(i,{[s]:e})}}function s2e(e,t){var n;e=Dn(e);const{fs:r,path:s}=Mr(e,this);Zy(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(Vi&&!fs(this,i,li))throw Ze.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new _h),!i.attributes.get(t))throw Ze.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,Bm(i,"attributes"))}catch(i){throw hs(i,{[s]:e})}}async function i2e(e){e=Dn(e);const{fs:t,path:n}=Mr(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw hs(r,{[n]:e})}}function a2e(e){e=Dn(e);const{fs:t,path:n}=Mr(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw hs(r,{[n]:e})}}const o2e=Object.freeze(Object.defineProperty({__proto__:null,get:QSe,getSync:e2e,list:i2e,listSync:a2e,remove:r2e,removeSync:s2e,set:t2e,setSync:n2e},Symbol.toStringTag,{value:"Module"})),ua=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:n_e,Dir:WO,Dirent:cw,get IOC(){return Us},get IOC32(){return yc},ReadStream:ZO,Stats:nf,StatsFs:t_e,WriteStream:XO,access:jSe,accessSync:B_e,appendFile:cSe,appendFileSync:k_e,chmod:ASe,chmodSync:D_e,chown:ESe,chownSync:P_e,chroot:b_e,close:dSe,closeSync:Gm,constants:OK,copyFile:zSe,copyFileSync:ZK,cp:WSe,cpSync:XK,createReadStream:FSe,createWriteStream:LSe,exists:tSe,existsSync:DO,fchmod:bSe,fchmodSync:UO,fchown:ySe,fchownSync:zO,fdatasync:pSe,fdatasyncSync:R_e,fstat:uSe,fstatSync:E_e,fsync:hSe,fsyncSync:A_e,ftruncate:fSe,ftruncateSync:T_e,futimes:vSe,futimesSync:qO,glob:KSe,globSync:W_e,ioctl:ZSe,ioctlSync:XSe,lchmod:RSe,lchmodSync:F_e,lchown:TSe,lchownSync:O_e,link:SSe,linkSync:I_e,lopenSync:qE,lstat:rSe,lstatSync:FO,lutimes:MSe,lutimesSync:L_e,mkdir:wSe,mkdirSync:VO,mkdtemp:$Se,mkdtempSync:$_e,mount:OO,open:aSe,openAsBlob:GSe,openSync:UE,opendir:VSe,opendirSync:q_e,promises:J_e,read:gSe,readFile:oSe,readFileSync:BO,readSync:M_e,readdir:_Se,readdirSync:Hy,readlink:kSe,readlinkSync:Tj,readv:USe,readvSync:z_e,realpath:ISe,realpathSync:qh,rename:eSe,renameSync:S_e,rm:BSe,rmSync:YK,rmdir:xSe,rmdirSync:GK,stat:nSe,statSync:Sh,statfs:HSe,statfsSync:V_e,symlink:CSe,symlinkSync:j_e,truncate:sSe,truncateSync:C_e,umount:UK,unlink:iSe,unlinkSync:LO,unwatchFile:OSe,utimes:NSe,utimesSync:KK,watch:DSe,watchFile:PSe,write:mSe,writeFile:lSe,writeFileSync:$O,writeSync:N_e,writev:qSe,writevSync:U_e,xattr:o2e},Symbol.toStringTag,{value:"Module"}));function C9(e){return CK(e)||NO(e)||e instanceof PO}async function _Y(e,t=0){if(typeof e!="object"||e==null)throw _o(new Ze(yt.EINVAL,"Invalid options on mount configuration"));if(!C9(e))throw _o(new Ze(yt.EINVAL,"Invalid mount configuration"));if(e instanceof PO)return await e.ready(),e;NO(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&C9(i)){if(SK("Resolving nested mount configuration: "+s),t>10)throw _o(new Ze(yt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await _Y(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw _o(new Ze(yt.EPERM,"Backend not available: "+n.name));L1e(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function l2e(e){if(!CK(e))throw new TypeError("Invalid single mount point configuration");const t=await _Y(e);UK("/"),OO("/",t)}const c2e=["delete"];Math.max(...c2e.map(e=>e.length));F1e("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const SY=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;SY[e]=t}function u2e(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^SY[(t^e[n])&255];return(t^4294967295)>>>0}var zs=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},lr=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},rD=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let k9=(()=>{var e,t,n,r;let s=[$m()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[];return o=class{constructor(){this.id=lr(this,c,0),this.offset_=(lr(this,u),lr(this,h,0)),this.offset=(lr(this,m),lr(this,b,0)),this.size=(lr(this,v),lr(this,w,0)),lr(this,S)}},rD(o,"MetadataEntry"),(()=>{const k=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Jn).uint32.bind(e)],d=[(t=Jn).uint32.bind(t)],y=[(n=Jn).uint32.bind(n)],x=[(r=Jn).uint32.bind(r)],zs(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:C=>"id"in C,get:C=>C.id,set:(C,R)=>{C.id=R}},metadata:k},c,u),zs(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:C=>"offset_"in C,get:C=>C.offset_,set:(C,R)=>{C.offset_=R}},metadata:k},h,m),zs(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:C=>"offset"in C,get:C=>C.offset,set:(C,R)=>{C.offset=R}},metadata:k},b,v),zs(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:C=>"size"in C,get:C=>C.size,set:(C,R)=>{C.size=R}},metadata:k},w,S),zs(null,i={value:o},s,{kind:"class",name:o.name,metadata:k},null,a),o=i.value,k&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k}),lr(o,a)})(),o})();const E9=255;let Fp=(()=>{var e,t,n,r;let s=[$m()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[],k,C=[],R=[];var A=o=class{constructor(N=bs(new Ze(yt.EINVAL,"Metadata block must be initialized with a superblock")),I=0){if(this.superblock=N,this.offset=I,this.checksum=lr(this,c,0),this.timestamp=(lr(this,u),lr(this,h,Date.now())),this.previous_offset_=(lr(this,m),lr(this,b,0)),this.previous_offset=(lr(this,v),lr(this,w,0)),this._previous=lr(this,S),this.entries=lr(this,C,Array.from({length:E9},()=>new k9)),lr(this,R),this.superblock=N,this.offset=I,!!I&&(DE(this,N.store._buffer.subarray(I,I+qs(A))),!CY(this)))throw FE(new Ze(yt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+I.toString(16)))}get previous(){var N;if(this.previous_offset)return(N=this._previous)!==null&&N!==void 0||(this._previous=new A(this.superblock,this.previous_offset)),this._previous}};return rD(o,"MetadataBlock"),(()=>{const N=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=Jn).uint32.bind(e)],d=[(t=Jn).uint32.bind(t)],y=[(n=Jn).uint32.bind(n)],x=[(r=Jn).uint32.bind(r)],k=[iw(k9,E9)],zs(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:I=>"checksum"in I,get:I=>I.checksum,set:(I,O)=>{I.checksum=O}},metadata:N},c,u),zs(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:I=>"timestamp"in I,get:I=>I.timestamp,set:(I,O)=>{I.timestamp=O}},metadata:N},h,m),zs(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:I=>"previous_offset_"in I,get:I=>I.previous_offset_,set:(I,O)=>{I.previous_offset_=O}},metadata:N},b,v),zs(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:I=>"previous_offset"in I,get:I=>I.previous_offset,set:(I,O)=>{I.previous_offset=O}},metadata:N},w,S),zs(null,null,k,{kind:"field",name:"entries",static:!1,private:!1,access:{has:I=>"entries"in I,get:I=>I.entries,set:(I,O)=>{I.entries=O}},metadata:N},C,R),zs(null,i={value:o},s,{kind:"class",name:o.name,metadata:N},null,a),A=o=i.value,N&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:N}),lr(o,a)})(),A=o})();const T9=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[$m()],h,m=[],y,b,v=[],x=[],w,S=[],k=[],C,R=[],A=[],N,I=[],O=[],B,D=[],W=[],P,Z=[],U=[],H,L=[],ne=[],V,Q=[],ee=[],se,me=[],ce=[],je,De=[],Se=[],Ce,qe=[],Qe=[],We,Ne=[],K=[],ge,Ae=[],le=[];var oe=y=class{constructor(re=bs(new Ze(yt.EINVAL,"Super block must be initialized with a store"))){if(this.store=re,this.checksum=lr(this,v,0),this.magic=(lr(this,x),lr(this,S,T9)),this.version=(lr(this,k),lr(this,R,1)),this.inode_format=(lr(this,A),lr(this,I,s_e)),this.flags=(lr(this,O),lr(this,D,0)),this.used_bytes=(lr(this,W),lr(this,Z,BigInt(0))),this.total_bytes=(lr(this,U),lr(this,L,BigInt(0))),this.uuid=(lr(this,ne),lr(this,Q,BigInt(0))),this.metadata_block_size=(lr(this,ee),lr(this,me,qs(Fp))),this.metadata_offset_=(lr(this,ce),lr(this,De,0)),this.metadata_offset=(lr(this,Se),lr(this,qe,0)),this.metadata=lr(this,Qe),this.label=lr(this,Ne,""),this._padding=(lr(this,K),lr(this,Ae,new Array(132).fill(0))),lr(this,le),this.store=re,re._view.getUint32(w1e(oe,"magic"),!0)!=T9){Oa("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new Fp(this),this.metadata.offset=qs(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(qs(oe)+qs(Fp)),this.total_bytes=BigInt(re._buffer.byteLength),re._write(this),re._write(this.metadata);return}if(DE(this,re._buffer.subarray(0,qs(oe))),!CY(this))throw FE(new Ze(yt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new Fp(this,this.metadata_offset)}rotateMetadata(){const re=new Fp(this);return re.offset=Number(this.used_bytes),re.previous_offset=this.metadata_offset,this.metadata=re,this.metadata_offset=re.offset,this.store._write(re),this.used_bytes+=BigInt(qs(Fp)),this.store._write(this),re}isUnused(re,Te){if(!Te)return!0;if(re+Te>this.total_bytes||re<qs(oe))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(re<Be.offset+qs(Fp)&&re+Te>Be.offset)return!1;for(const ke of Be.entries)if(ke.offset&&(re>=ke.offset&&re<ke.offset+ke.size||re+Te>ke.offset&&re+Te<=ke.offset+ke.size||re<=ke.offset&&re+Te>=ke.offset+ke.size))return!1}return!0}};return rD(y,"SuperBlock"),(()=>{const re=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=Jn).uint32.bind(e)],w=[(t=Jn).uint32.bind(t)],C=[(n=Jn).uint16.bind(n)],N=[(r=Jn).uint16.bind(r)],B=[(s=Jn).uint32.bind(s)],P=[(i=Jn).uint64.bind(i)],H=[(a=Jn).uint64.bind(a)],V=[(o=Jn).uint128.bind(o)],se=[(l=Jn).uint32.bind(l)],je=[(c=Jn).uint32.bind(c)],Ce=[(u=Jn).uint32.bind(u)],We=[Jn.char(64)],ge=[Jn.char(132)],zs(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Te=>"checksum"in Te,get:Te=>Te.checksum,set:(Te,Be)=>{Te.checksum=Be}},metadata:re},v,x),zs(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Te=>"magic"in Te,get:Te=>Te.magic,set:(Te,Be)=>{Te.magic=Be}},metadata:re},S,k),zs(null,null,C,{kind:"field",name:"version",static:!1,private:!1,access:{has:Te=>"version"in Te,get:Te=>Te.version,set:(Te,Be)=>{Te.version=Be}},metadata:re},R,A),zs(null,null,N,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Te=>"inode_format"in Te,get:Te=>Te.inode_format,set:(Te,Be)=>{Te.inode_format=Be}},metadata:re},I,O),zs(null,null,B,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Te=>"flags"in Te,get:Te=>Te.flags,set:(Te,Be)=>{Te.flags=Be}},metadata:re},D,W),zs(null,null,P,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Te=>"used_bytes"in Te,get:Te=>Te.used_bytes,set:(Te,Be)=>{Te.used_bytes=Be}},metadata:re},Z,U),zs(null,null,H,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Te=>"total_bytes"in Te,get:Te=>Te.total_bytes,set:(Te,Be)=>{Te.total_bytes=Be}},metadata:re},L,ne),zs(null,null,V,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Te=>"uuid"in Te,get:Te=>Te.uuid,set:(Te,Be)=>{Te.uuid=Be}},metadata:re},Q,ee),zs(null,null,se,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Te=>"metadata_block_size"in Te,get:Te=>Te.metadata_block_size,set:(Te,Be)=>{Te.metadata_block_size=Be}},metadata:re},me,ce),zs(null,null,je,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Te=>"metadata_offset_"in Te,get:Te=>Te.metadata_offset_,set:(Te,Be)=>{Te.metadata_offset_=Be}},metadata:re},De,Se),zs(null,null,Ce,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Te=>"metadata_offset"in Te,get:Te=>Te.metadata_offset,set:(Te,Be)=>{Te.metadata_offset=Be}},metadata:re},qe,Qe),zs(null,null,We,{kind:"field",name:"label",static:!1,private:!1,access:{has:Te=>"label"in Te,get:Te=>Te.label,set:(Te,Be)=>{Te.label=Be}},metadata:re},Ne,K),zs(null,null,ge,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Te=>"_padding"in Te,get:Te=>Te._padding,set:(Te,Be)=>{Te._padding=Be}},metadata:re},Ae,le),zs(null,h={value:y},d,{kind:"class",name:y.name,metadata:re},null,m),oe=y=h.value,re&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:re}),lr(y,m)})(),oe=y})();function CY(e){const t=ya(e),n=u2e(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=ua;function d2e(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function Rj(e,t,n){if(e instanceof Ze)return e;const r=e instanceof DOMException?yt[d2e(e)]:yt.EIO,s=new Ze(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function g0(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(Rj(e.error))}})}class f2e extends Ej{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await g0(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await g0(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await g0(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),g0(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(Rj(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(Rj(this.tx.error)),this.tx.abort(),t}}async function h2e(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Oa("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await g0(n)}class p2e{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new f2e(t,this)}}const m2e={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await g0(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await h2e(e.storeName||"zenfs",e.idbFactory),n=new p2e(t),r=new BK(n);if(e!=null&&e.disableAsyncCache)return RO("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},g2e=m2e,dn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function BS(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var RM={exports:{}},A9;function y2e(){return A9||(A9=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof BS=="function"&&BS;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var m=s[c]={exports:{}};r[c][0].call(m.exports,function(y){var b=r[c][1][y];return a(b||y)},m,m.exports,n,r,s,i)}return s[c].exports}for(var o=typeof BS=="function"&&BS,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,m,y,b,v=[],x=0,w=l.length,S=w,k=i.getTypeOf(l)!=="string";x<l.length;)S=w-x,d=k?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,m=(3&c)<<4|u>>4,y=1<S?(15&u)<<2|d>>6:64,b=2<S?63&d:64,v.push(o.charAt(h)+o.charAt(m)+o.charAt(y)+o.charAt(b));return v.join("")},s.decode=function(l){var c,u,d,h,m,y,b=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|S):new Array(0|S);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(m=o.indexOf(l.charAt(b++)))>>2,d=(3&m)<<6|(y=o.indexOf(l.charAt(b++))),w[v++]=c,m!==64&&(w[v++]=u),y!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,m,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=m,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,y){var b,v="";for(b=0;b<y;b++)v+=String.fromCharCode(255&m),m>>>=8;return v}function a(m,y,b,v,x,w){var S,k,C=m.file,R=m.compression,A=w!==c.utf8encode,N=o.transformTo("string",w(C.name)),I=o.transformTo("string",c.utf8encode(C.name)),O=C.comment,B=o.transformTo("string",w(O)),D=o.transformTo("string",c.utf8encode(O)),W=I.length!==C.name.length,P=D.length!==O.length,Z="",U="",H="",L=C.dir,ne=C.date,V={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(V.crc32=m.crc32,V.compressedSize=m.compressedSize,V.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),A||!W&&!P||(Q|=2048);var ee=0,se=0;L&&(ee|=16),x==="UNIX"?(se=798,ee|=function(ce,je){var De=ce;return ce||(De=je?16893:33204),(65535&De)<<16}(C.unixPermissions,L)):(se=20,ee|=function(ce){return 63&(ce||0)}(C.dosPermissions)),S=ne.getUTCHours(),S<<=6,S|=ne.getUTCMinutes(),S<<=5,S|=ne.getUTCSeconds()/2,k=ne.getUTCFullYear()-1980,k<<=4,k|=ne.getUTCMonth()+1,k<<=5,k|=ne.getUTCDate(),W&&(U=i(1,1)+i(u(N),4)+I,Z+="up"+i(U.length,2)+U),P&&(H=i(1,1)+i(u(B),4)+D,Z+="uc"+i(H.length,2)+H);var me="";return me+=`
\0`,me+=i(Q,2),me+=R.magic,me+=i(S,2),me+=i(k,2),me+=i(V.crc32,4),me+=i(V.compressedSize,4),me+=i(V.uncompressedSize,4),me+=i(N.length,2),me+=i(Z.length,2),{fileRecord:d.LOCAL_FILE_HEADER+me+N+Z,dirRecord:d.CENTRAL_FILE_HEADER+i(se,2)+me+i(B.length,2)+"\0\0\0\0"+i(ee,4)+i(v,4)+N+Z+B}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(m,y,b,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=v,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(m){var y=m.meta.percent||0,b=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-v-1))/b:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var b=a(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,b=a(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-m,v=function(x,w,S,k,C){var R=o.transformTo("string",C(k));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(S,4)+i(R.length,2)+R}(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(b){y.processChunk(b)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var y=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var b=0;b<y.length;b++)try{y[b].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,m){d++;var y=function(w,S){var k=w||S,C=i[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(m.options.compression,l.compression),b=m.options.compressionOptions||l.compressionOptions||{},v=m.dir,x=m.date;m._compressWorker(y,b).withStreamInfo("file",{name:h,dir:v,date:x,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(m,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(v){y(v)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(h,m){var y=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(b){var v=new l(m);return v.load(b),v}).then(function(b){var v=[a.Promise.resolve(b)],x=b.files;if(m.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(b){for(var v=b.shift(),x=v.files,w=0;w<x.length;w++){var S=x[w],k=S.fileNameStr,C=i.resolve(S.fileNameStr);y.file(C,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:m.createFolders}),S.dir||(y.file(C).unsafeOriginalName=k)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof ln<"u",newBufferFrom:function(i,a){if(ln.from&&ln.from!==Uint8Array.from)return ln.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new ln(i,a)},allocBuffer:function(i){if(ln.alloc)return ln.alloc(i);var a=new ln(i);return a.fill(0),a},isBuffer:function(i){return ln.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(C,R,A){var N,I=o.getTypeOf(R),O=o.extend(A||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(C=x(C)),O.createFolders&&(N=v(C))&&w.call(this,N,!0);var B=I==="string"&&O.binary===!1&&O.base64===!1;A&&A.binary!==void 0||(O.binary=!B),(R instanceof d&&R.uncompressedSize===0||O.dir||!R||R.length===0)&&(O.base64=!1,O.binary=!0,R="",O.compression="STORE",I="string");var D=null;D=R instanceof d||R instanceof l?R:y.isNode&&y.isStream(R)?new b(C,R):o.prepareContent(C,R,O.binary,O.optimizedBinaryString,O.base64);var W=new h(C,D,O);this.files[C]=W}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),m=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var R=C.lastIndexOf("/");return 0<R?C.substring(0,R):""},x=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},w=function(C,R){return R=R!==void 0?R:u.createFolders,C=x(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:R}),this.files[C]};function S(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var R,A,N;for(R in this.files)N=this.files[R],(A=R.slice(this.root.length,R.length))&&R.slice(0,this.root.length)===this.root&&C(A,N)},filter:function(C){var R=[];return this.forEach(function(A,N){C(A,N)&&R.push(N)}),R},file:function(C,R,A){if(arguments.length!==1)return C=this.root+C,i.call(this,C,R,A),this;if(S(C)){var N=C;return this.filter(function(O,B){return!B.dir&&N.test(O)})}var I=this.files[this.root+C];return I&&!I.dir?I:null},folder:function(C){if(!C)return this;if(S(C))return this.filter(function(I,O){return O.dir&&C.test(I)});var R=this.root+C,A=w.call(this,R),N=this.clone();return N.root=A.name,N},remove:function(C){C=this.root+C;var R=this.files[C];if(R||(C.slice(-1)!=="/"&&(C+="/"),R=this.files[C]),R&&!R.dir)delete this.files[C];else for(var A=this.filter(function(I,O){return O.name.slice(0,C.length)===C}),N=0;N<A.length;N++)delete this.files[A[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var R,A={};try{if((A=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");o.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var N=A.comment||this.comment||"";R=m.generateWorker(this,A,N)}catch(I){(R=new l("error")).error(I)}return new c(R,A.type||"string",A.mimeType)},generateAsync:function(C,R){return this.generateInternalStream(C).accumulate(R)},generateNodeStream:function(C,R){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(R)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(v,x){var w=[],S=y._internalType,k=y._outputType,C=y._mimeType;y.on("data",function(R,A){w.push(R),b&&b(A)}).on("error",function(R){w=[],x(R)}).on("end",function(){try{var R=function(A,N,I){switch(A){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),I);case"base64":return l.encode(N);default:return i.transformTo(A,N)}}(k,function(A,N){var I,O=0,B=null,D=0;for(I=0;I<N.length;I++)D+=N[I].length;switch(A){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(B=new Uint8Array(D),I=0;I<N.length;I++)B.set(N[I],O),O+=N[I].length;return B;case"nodebuffer":return ln.concat(N);default:throw new Error("concat : unsupported type '"+A+"'")}}(S,w),C);v(R)}catch(A){x(A)}w=[]}).resume()})}function m(y,b,v){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=v,i.checkSupport(x),this._worker=y.pipe(new a(x)),y.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}m.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var v=this;return y==="data"?this._worker.on(y,function(x){b.call(v,x.data,x.meta)}):this._worker.on(y,function(){i.delay(b,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof ln<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):function(y){var b,v,x,w,S,k=y.length,C=0;for(w=0;w<k;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),C+=v<128?1:v<2048?2:v<65536?3:4;for(b=a.uint8array?new Uint8Array(C):new Array(C),w=S=0;S<C;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?b[S++]=v:(v<2048?b[S++]=192|v>>>6:(v<65536?b[S++]=224|v>>>12:(b[S++]=240|v>>>18,b[S++]=128|v>>>12&63),b[S++]=128|v>>>6&63),b[S++]=128|63&v);return b}(m)},s.utf8decode=function(m){return a.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(y){var b,v,x,w,S=y.length,k=new Array(2*S);for(b=v=0;b<S;)if((x=y[b++])<128)k[v++]=x;else if(4<(w=c[x]))k[v++]=65533,b+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&b<S;)x=x<<6|63&y[b++],w--;1<w?k[v++]=65533:x<65536?k[v++]=x:(x-=65536,k[v++]=55296|x>>10&1023,k[v++]=56320|1023&x)}return k.length!==v&&(k.subarray?k=k.subarray(0,v):k.length=v),i.applyFromCharCode(k)}(m=i.transformTo(a.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var y=i.transformTo(a.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,S){var k;for((S=S||w.length)>w.length&&(S=w.length),k=S-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?S:k+c[w[k]]>S?k:S}(y),x=y;v!==y.length&&(a.uint8array?(x=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(x=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(x),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,v){for(var x=0;x<b.length;++x)v[x]=255&b.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(b,v){s.checkSupport("blob");try{return new Blob([b],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,v,x){var w=[],S=0,k=b.length;if(k<=x)return String.fromCharCode.apply(null,b);for(;S<k;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+x,k)))):w.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+x,k)))),S+=x;return w.join("")},stringifyByChar:function(b){for(var v="",x=0;x<b.length;x++)v+=String.fromCharCode(b[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var v=65536,x=s.getTypeOf(b),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(b,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(b)}function m(b,v){for(var x=0;x<b.length;x++)v[x]=b[x];return v}s.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return m(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return m(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,v){if(v=v||"",!b)return v;s.checkSupport(b);var x=s.getTypeOf(v);return y[x][b](v)},s.resolve=function(b){for(var v=b.split("/"),x=[],w=0;w<v.length;w++){var S=v[w];S==="."||S===""&&w!==0&&w!==v.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var v,x,w="";for(x=0;x<(b||"").length;x++)w+="\\x"+((v=b.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(b,v,x){setImmediate(function(){b.apply(x||null,v||[])})},s.inherits=function(b,v){function x(){}x.prototype=v.prototype,b.prototype=new x},s.extend=function(){var b,v,x={};for(b=0;b<arguments.length;b++)for(v in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],v)&&x[v]===void 0&&(x[v]=arguments[b][v]);return x},s.prepareContent=function(b,v,x,w,S){return l.Promise.resolve(v).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,R){var A=new FileReader;A.onload=function(N){C(N.target.result)},A.onerror=function(N){R(N.target.error)},A.readAsArrayBuffer(k)}):k}).then(function(k){var C=s.getTypeOf(k);return C?(C==="arraybuffer"?k=s.transformTo("uint8array",k):C==="string"&&(S?k=a.decode(k):x&&w!==!0&&(k=function(R){return u(R,i.uint8array?new Uint8Array(R.length):new Array(R.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var m=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",m=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,m,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=h-m;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(m,y){this.options=m,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,b;if(m.skip(22),this.fileNameLength=m.readInt(2),b=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,b,v,x=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<x;)y=m.readInt(2),b=m.readInt(2),v=m.readData(b),this.extraFields[y]={id:y,length:b,value:v};m.setIndex(x)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(y,b,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=b,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(y){var b=null,v="string";try{if(!y)throw new Error("No output type specified.");var x=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),b=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!w&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(S){(b=new u("error")).error(S)}return new a(b,v,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new i.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var m=[];function y(){var b,v;o=!0;for(var x=m.length;x;){for(v=m,m=[],b=-1;++b<x;)v[b]();x=m.length}o=!1}r.exports=function(b){m.push(b)!==1||o||a()}}).call(this,typeof Qp<"u"?Qp:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function h(x,w,S){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function m(x,w,S){i(function(){var k;try{k=w(S)}catch(C){return o.reject(x,C)}k===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,k)})}function y(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function b(x,w){var S=!1;function k(A){S||(S=!0,o.reject(x,A))}function C(A){S||(S=!0,o.resolve(x,A))}var R=v(function(){w(C,k)});R.status==="error"&&k(R.value)}function v(x,w){var S={};try{S.value=x(w),S.status="success"}catch(k){S.status="error",S.value=k}return S}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(S){return w.resolve(x()).then(function(){return S})},function(S){return w.resolve(x()).then(function(){throw S})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?m(S,this.state===c?x:w,this.outcome):this.queue.push(new h(S,x,w)),S},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){m(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){m(this.promise,this.onRejected,x)},o.resolve=function(x,w){var S=v(y,w);if(S.status==="error")return o.reject(x,S.value);var k=S.value;if(k)b(x,k);else{x.state=c,x.outcome=w;for(var C=-1,R=x.queue.length;++C<R;)x.queue[C].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var S=-1,k=x.queue.length;++S<k;)x.queue[S].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,k=!1;if(!S)return this.resolve([]);for(var C=new Array(S),R=0,A=-1,N=new this(a);++A<S;)I(x[A],A);return N;function I(O,B){w.resolve(O).then(function(D){C[B]=D,++R!==S||k||(k=!0,o.resolve(N,C))},function(D){k||(k=!0,o.reject(N,D))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,k=!1;if(!S)return this.resolve([]);for(var C=-1,R=new this(a);++C<S;)A=x[C],w.resolve(A).then(function(N){k||(k=!0,o.resolve(R,N))},function(N){k||(k=!0,o.reject(R,N))});var A;return R}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,m=0,y=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(S!==d)throw new Error(l[S]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(S=i.deflateSetDictionary(this.strm,k))!==d)throw new Error(l[S]);this._dict_set=!0}}function v(x,w){var S=new b(w);if(S.push(x,!0),S.err)throw S.msg||l[S.err];return S.result}b.prototype.push=function(x,w){var S,k,C=this.strm,R=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof x=="string"?C.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?C.input=new Uint8Array(x):C.input=x,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(R),C.next_out=0,C.avail_out=R),(S=i.deflate(C,k))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&S!==1);return k===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):k!==2||(this.onEnd(d),!(C.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function m(b){if(!(this instanceof m))return new m(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||b&&b.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function y(b,v){var x=new m(v);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}m.prototype.push=function(b,v){var x,w,S,k,C,R,A=this.strm,N=this.options.chunkSize,I=this.options.dictionary,O=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?A.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?A.input=new Uint8Array(b):A.input=b,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(N),A.next_out=0,A.avail_out=N),(x=i.inflate(A,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(R=typeof I=="string"?o.string2buf(I):h.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,x=i.inflateSetDictionary(this.strm,R)),x===l.Z_BUF_ERROR&&O===!0&&(x=l.Z_OK,O=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&x!==l.Z_STREAM_END&&(A.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(A.output,A.next_out),k=A.next_out-S,C=o.buf2string(A.output,S),A.next_out=k,A.avail_out=N-k,k&&a.arraySet(A.output,A.output,S,k,0),this.onData(C)):this.onData(a.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(O=!0)}while((0<A.avail_in||A.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(A.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=m,s.inflate=y,s.inflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){var c,u,d,h,m,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)m=l[c],y.set(m,h),h+=m.length;return y}},o={arraySet:function(l,c,u,d,h){for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var m="",y=0;y<h;y++)m+=String.fromCharCode(d[y]);return m}l[254]=l[254]=1,s.string2buf=function(d){var h,m,y,b,v,x=d.length,w=0;for(b=0;b<x;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(w),b=v=0;v<w;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?h[v++]=m:(m<2048?h[v++]=192|m>>>6:(m<65536?h[v++]=224|m>>>12:(h[v++]=240|m>>>18,h[v++]=128|m>>>12&63),h[v++]=128|m>>>6&63),h[v++]=128|63&m);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),m=0,y=h.length;m<y;m++)h[m]=d.charCodeAt(m);return h},s.buf2string=function(d,h){var m,y,b,v,x=h||d.length,w=new Array(2*x);for(m=y=0;m<x;)if((b=d[m++])<128)w[y++]=b;else if(4<(v=l[b]))w[y++]=65533,m+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&m<x;)b=b<<6|63&d[m++],v--;1<v?w[y++]=65533:b<65536?w[y++]=b:(b-=65536,w[y++]=55296|b>>10&1023,w[y++]=56320|1023&b)}return u(w,y)},s.utf8border=function(d,h){var m;for((h=h||d.length)>d.length&&(h=d.length),m=h-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?h:m+l[d[m]]>h?m:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,m=0,y=-2,b=-1,v=4,x=2,w=8,S=9,k=286,C=30,R=19,A=2*k+1,N=15,I=3,O=258,B=O+I+1,D=42,W=113,P=1,Z=2,U=3,H=4;function L(K,ge){return K.msg=u[ge],ge}function ne(K){return(K<<1)-(4<K?9:0)}function V(K){for(var ge=K.length;0<=--ge;)K[ge]=0}function Q(K){var ge=K.state,Ae=ge.pending;Ae>K.avail_out&&(Ae=K.avail_out),Ae!==0&&(a.arraySet(K.output,ge.pending_buf,ge.pending_out,Ae,K.next_out),K.next_out+=Ae,ge.pending_out+=Ae,K.total_out+=Ae,K.avail_out-=Ae,ge.pending-=Ae,ge.pending===0&&(ge.pending_out=0))}function ee(K,ge){o._tr_flush_block(K,0<=K.block_start?K.block_start:-1,K.strstart-K.block_start,ge),K.block_start=K.strstart,Q(K.strm)}function se(K,ge){K.pending_buf[K.pending++]=ge}function me(K,ge){K.pending_buf[K.pending++]=ge>>>8&255,K.pending_buf[K.pending++]=255&ge}function ce(K,ge){var Ae,le,oe=K.max_chain_length,re=K.strstart,Te=K.prev_length,Be=K.nice_match,ke=K.strstart>K.w_size-B?K.strstart-(K.w_size-B):0,lt=K.window,Rt=K.w_mask,ft=K.prev,Pt=K.strstart+O,qt=lt[re+Te-1],Lt=lt[re+Te];K.prev_length>=K.good_match&&(oe>>=2),Be>K.lookahead&&(Be=K.lookahead);do if(lt[(Ae=ge)+Te]===Lt&&lt[Ae+Te-1]===qt&&lt[Ae]===lt[re]&&lt[++Ae]===lt[re+1]){re+=2,Ae++;do;while(lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&lt[++re]===lt[++Ae]&&re<Pt);if(le=O-(Pt-re),re=Pt-O,Te<le){if(K.match_start=ge,Be<=(Te=le))break;qt=lt[re+Te-1],Lt=lt[re+Te]}}while((ge=ft[ge&Rt])>ke&&--oe!=0);return Te<=K.lookahead?Te:K.lookahead}function je(K){var ge,Ae,le,oe,re,Te,Be,ke,lt,Rt,ft=K.w_size;do{if(oe=K.window_size-K.lookahead-K.strstart,K.strstart>=ft+(ft-B)){for(a.arraySet(K.window,K.window,ft,ft,0),K.match_start-=ft,K.strstart-=ft,K.block_start-=ft,ge=Ae=K.hash_size;le=K.head[--ge],K.head[ge]=ft<=le?le-ft:0,--Ae;);for(ge=Ae=ft;le=K.prev[--ge],K.prev[ge]=ft<=le?le-ft:0,--Ae;);oe+=ft}if(K.strm.avail_in===0)break;if(Te=K.strm,Be=K.window,ke=K.strstart+K.lookahead,lt=oe,Rt=void 0,Rt=Te.avail_in,lt<Rt&&(Rt=lt),Ae=Rt===0?0:(Te.avail_in-=Rt,a.arraySet(Be,Te.input,Te.next_in,Rt,ke),Te.state.wrap===1?Te.adler=l(Te.adler,Be,Rt,ke):Te.state.wrap===2&&(Te.adler=c(Te.adler,Be,Rt,ke)),Te.next_in+=Rt,Te.total_in+=Rt,Rt),K.lookahead+=Ae,K.lookahead+K.insert>=I)for(re=K.strstart-K.insert,K.ins_h=K.window[re],K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+1])&K.hash_mask;K.insert&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[re+I-1])&K.hash_mask,K.prev[re&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=re,re++,K.insert--,!(K.lookahead+K.insert<I)););}while(K.lookahead<B&&K.strm.avail_in!==0)}function De(K,ge){for(var Ae,le;;){if(K.lookahead<B){if(je(K),K.lookahead<B&&ge===d)return P;if(K.lookahead===0)break}if(Ae=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),Ae!==0&&K.strstart-Ae<=K.w_size-B&&(K.match_length=ce(K,Ae)),K.match_length>=I)if(le=o._tr_tally(K,K.strstart-K.match_start,K.match_length-I),K.lookahead-=K.match_length,K.match_length<=K.max_lazy_match&&K.lookahead>=I){for(K.match_length--;K.strstart++,K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart,--K.match_length!=0;);K.strstart++}else K.strstart+=K.match_length,K.match_length=0,K.ins_h=K.window[K.strstart],K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+1])&K.hash_mask;else le=o._tr_tally(K,0,K.window[K.strstart]),K.lookahead--,K.strstart++;if(le&&(ee(K,!1),K.strm.avail_out===0))return P}return K.insert=K.strstart<I-1?K.strstart:I-1,ge===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?P:Z}function Se(K,ge){for(var Ae,le,oe;;){if(K.lookahead<B){if(je(K),K.lookahead<B&&ge===d)return P;if(K.lookahead===0)break}if(Ae=0,K.lookahead>=I&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),K.prev_length=K.match_length,K.prev_match=K.match_start,K.match_length=I-1,Ae!==0&&K.prev_length<K.max_lazy_match&&K.strstart-Ae<=K.w_size-B&&(K.match_length=ce(K,Ae),K.match_length<=5&&(K.strategy===1||K.match_length===I&&4096<K.strstart-K.match_start)&&(K.match_length=I-1)),K.prev_length>=I&&K.match_length<=K.prev_length){for(oe=K.strstart+K.lookahead-I,le=o._tr_tally(K,K.strstart-1-K.prev_match,K.prev_length-I),K.lookahead-=K.prev_length-1,K.prev_length-=2;++K.strstart<=oe&&(K.ins_h=(K.ins_h<<K.hash_shift^K.window[K.strstart+I-1])&K.hash_mask,Ae=K.prev[K.strstart&K.w_mask]=K.head[K.ins_h],K.head[K.ins_h]=K.strstart),--K.prev_length!=0;);if(K.match_available=0,K.match_length=I-1,K.strstart++,le&&(ee(K,!1),K.strm.avail_out===0))return P}else if(K.match_available){if((le=o._tr_tally(K,0,K.window[K.strstart-1]))&&ee(K,!1),K.strstart++,K.lookahead--,K.strm.avail_out===0)return P}else K.match_available=1,K.strstart++,K.lookahead--}return K.match_available&&(le=o._tr_tally(K,0,K.window[K.strstart-1]),K.match_available=0),K.insert=K.strstart<I-1?K.strstart:I-1,ge===h?(ee(K,!0),K.strm.avail_out===0?U:H):K.last_lit&&(ee(K,!1),K.strm.avail_out===0)?P:Z}function Ce(K,ge,Ae,le,oe){this.good_length=K,this.max_lazy=ge,this.nice_length=Ae,this.max_chain=le,this.func=oe}function qe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*A),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*R+1)),V(this.dyn_ltree),V(this.dyn_dtree),V(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*k+1),V(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),V(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(K){var ge;return K&&K.state?(K.total_in=K.total_out=0,K.data_type=x,(ge=K.state).pending=0,ge.pending_out=0,ge.wrap<0&&(ge.wrap=-ge.wrap),ge.status=ge.wrap?D:W,K.adler=ge.wrap===2?0:1,ge.last_flush=d,o._tr_init(ge),m):L(K,y)}function We(K){var ge=Qe(K);return ge===m&&function(Ae){Ae.window_size=2*Ae.w_size,V(Ae.head),Ae.max_lazy_match=i[Ae.level].max_lazy,Ae.good_match=i[Ae.level].good_length,Ae.nice_match=i[Ae.level].nice_length,Ae.max_chain_length=i[Ae.level].max_chain,Ae.strstart=0,Ae.block_start=0,Ae.lookahead=0,Ae.insert=0,Ae.match_length=Ae.prev_length=I-1,Ae.match_available=0,Ae.ins_h=0}(K.state),ge}function Ne(K,ge,Ae,le,oe,re){if(!K)return y;var Te=1;if(ge===b&&(ge=6),le<0?(Te=0,le=-le):15<le&&(Te=2,le-=16),oe<1||S<oe||Ae!==w||le<8||15<le||ge<0||9<ge||re<0||v<re)return L(K,y);le===8&&(le=9);var Be=new qe;return(K.state=Be).strm=K,Be.wrap=Te,Be.gzhead=null,Be.w_bits=le,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=oe+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+I-1)/I),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<oe+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ge,Be.strategy=re,Be.method=Ae,We(K)}i=[new Ce(0,0,0,0,function(K,ge){var Ae=65535;for(Ae>K.pending_buf_size-5&&(Ae=K.pending_buf_size-5);;){if(K.lookahead<=1){if(je(K),K.lookahead===0&&ge===d)return P;if(K.lookahead===0)break}K.strstart+=K.lookahead,K.lookahead=0;var le=K.block_start+Ae;if((K.strstart===0||K.strstart>=le)&&(K.lookahead=K.strstart-le,K.strstart=le,ee(K,!1),K.strm.avail_out===0)||K.strstart-K.block_start>=K.w_size-B&&(ee(K,!1),K.strm.avail_out===0))return P}return K.insert=0,ge===h?(ee(K,!0),K.strm.avail_out===0?U:H):(K.strstart>K.block_start&&(ee(K,!1),K.strm.avail_out),P)}),new Ce(4,4,8,4,De),new Ce(4,5,16,8,De),new Ce(4,6,32,32,De),new Ce(4,4,16,16,Se),new Ce(8,16,32,32,Se),new Ce(8,16,128,128,Se),new Ce(8,32,128,256,Se),new Ce(32,128,258,1024,Se),new Ce(32,258,258,4096,Se)],s.deflateInit=function(K,ge){return Ne(K,ge,w,15,8,0)},s.deflateInit2=Ne,s.deflateReset=We,s.deflateResetKeep=Qe,s.deflateSetHeader=function(K,ge){return K&&K.state?K.state.wrap!==2?y:(K.state.gzhead=ge,m):y},s.deflate=function(K,ge){var Ae,le,oe,re;if(!K||!K.state||5<ge||ge<0)return K?L(K,y):y;if(le=K.state,!K.output||!K.input&&K.avail_in!==0||le.status===666&&ge!==h)return L(K,K.avail_out===0?-5:y);if(le.strm=K,Ae=le.last_flush,le.last_flush=ge,le.status===D)if(le.wrap===2)K.adler=0,se(le,31),se(le,139),se(le,8),le.gzhead?(se(le,(le.gzhead.text?1:0)+(le.gzhead.hcrc?2:0)+(le.gzhead.extra?4:0)+(le.gzhead.name?8:0)+(le.gzhead.comment?16:0)),se(le,255&le.gzhead.time),se(le,le.gzhead.time>>8&255),se(le,le.gzhead.time>>16&255),se(le,le.gzhead.time>>24&255),se(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),se(le,255&le.gzhead.os),le.gzhead.extra&&le.gzhead.extra.length&&(se(le,255&le.gzhead.extra.length),se(le,le.gzhead.extra.length>>8&255)),le.gzhead.hcrc&&(K.adler=c(K.adler,le.pending_buf,le.pending,0)),le.gzindex=0,le.status=69):(se(le,0),se(le,0),se(le,0),se(le,0),se(le,0),se(le,le.level===9?2:2<=le.strategy||le.level<2?4:0),se(le,3),le.status=W);else{var Te=w+(le.w_bits-8<<4)<<8;Te|=(2<=le.strategy||le.level<2?0:le.level<6?1:le.level===6?2:3)<<6,le.strstart!==0&&(Te|=32),Te+=31-Te%31,le.status=W,me(le,Te),le.strstart!==0&&(me(le,K.adler>>>16),me(le,65535&K.adler)),K.adler=1}if(le.status===69)if(le.gzhead.extra){for(oe=le.pending;le.gzindex<(65535&le.gzhead.extra.length)&&(le.pending!==le.pending_buf_size||(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending!==le.pending_buf_size));)se(le,255&le.gzhead.extra[le.gzindex]),le.gzindex++;le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),le.gzindex===le.gzhead.extra.length&&(le.gzindex=0,le.status=73)}else le.status=73;if(le.status===73)if(le.gzhead.name){oe=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending===le.pending_buf_size)){re=1;break}re=le.gzindex<le.gzhead.name.length?255&le.gzhead.name.charCodeAt(le.gzindex++):0,se(le,re)}while(re!==0);le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),re===0&&(le.gzindex=0,le.status=91)}else le.status=91;if(le.status===91)if(le.gzhead.comment){oe=le.pending;do{if(le.pending===le.pending_buf_size&&(le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),Q(K),oe=le.pending,le.pending===le.pending_buf_size)){re=1;break}re=le.gzindex<le.gzhead.comment.length?255&le.gzhead.comment.charCodeAt(le.gzindex++):0,se(le,re)}while(re!==0);le.gzhead.hcrc&&le.pending>oe&&(K.adler=c(K.adler,le.pending_buf,le.pending-oe,oe)),re===0&&(le.status=103)}else le.status=103;if(le.status===103&&(le.gzhead.hcrc?(le.pending+2>le.pending_buf_size&&Q(K),le.pending+2<=le.pending_buf_size&&(se(le,255&K.adler),se(le,K.adler>>8&255),K.adler=0,le.status=W)):le.status=W),le.pending!==0){if(Q(K),K.avail_out===0)return le.last_flush=-1,m}else if(K.avail_in===0&&ne(ge)<=ne(Ae)&&ge!==h)return L(K,-5);if(le.status===666&&K.avail_in!==0)return L(K,-5);if(K.avail_in!==0||le.lookahead!==0||ge!==d&&le.status!==666){var Be=le.strategy===2?function(ke,lt){for(var Rt;;){if(ke.lookahead===0&&(je(ke),ke.lookahead===0)){if(lt===d)return P;break}if(ke.match_length=0,Rt=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++,Rt&&(ee(ke,!1),ke.strm.avail_out===0))return P}return ke.insert=0,lt===h?(ee(ke,!0),ke.strm.avail_out===0?U:H):ke.last_lit&&(ee(ke,!1),ke.strm.avail_out===0)?P:Z}(le,ge):le.strategy===3?function(ke,lt){for(var Rt,ft,Pt,qt,Lt=ke.window;;){if(ke.lookahead<=O){if(je(ke),ke.lookahead<=O&&lt===d)return P;if(ke.lookahead===0)break}if(ke.match_length=0,ke.lookahead>=I&&0<ke.strstart&&(ft=Lt[Pt=ke.strstart-1])===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]){qt=ke.strstart+O;do;while(ft===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]&&ft===Lt[++Pt]&&Pt<qt);ke.match_length=O-(qt-Pt),ke.match_length>ke.lookahead&&(ke.match_length=ke.lookahead)}if(ke.match_length>=I?(Rt=o._tr_tally(ke,1,ke.match_length-I),ke.lookahead-=ke.match_length,ke.strstart+=ke.match_length,ke.match_length=0):(Rt=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++),Rt&&(ee(ke,!1),ke.strm.avail_out===0))return P}return ke.insert=0,lt===h?(ee(ke,!0),ke.strm.avail_out===0?U:H):ke.last_lit&&(ee(ke,!1),ke.strm.avail_out===0)?P:Z}(le,ge):i[le.level].func(le,ge);if(Be!==U&&Be!==H||(le.status=666),Be===P||Be===U)return K.avail_out===0&&(le.last_flush=-1),m;if(Be===Z&&(ge===1?o._tr_align(le):ge!==5&&(o._tr_stored_block(le,0,0,!1),ge===3&&(V(le.head),le.lookahead===0&&(le.strstart=0,le.block_start=0,le.insert=0))),Q(K),K.avail_out===0))return le.last_flush=-1,m}return ge!==h?m:le.wrap<=0?1:(le.wrap===2?(se(le,255&K.adler),se(le,K.adler>>8&255),se(le,K.adler>>16&255),se(le,K.adler>>24&255),se(le,255&K.total_in),se(le,K.total_in>>8&255),se(le,K.total_in>>16&255),se(le,K.total_in>>24&255)):(me(le,K.adler>>>16),me(le,65535&K.adler)),Q(K),0<le.wrap&&(le.wrap=-le.wrap),le.pending!==0?m:1)},s.deflateEnd=function(K){var ge;return K&&K.state?(ge=K.state.status)!==D&&ge!==69&&ge!==73&&ge!==91&&ge!==103&&ge!==W&&ge!==666?L(K,y):(K.state=null,ge===W?L(K,-3):m):y},s.deflateSetDictionary=function(K,ge){var Ae,le,oe,re,Te,Be,ke,lt,Rt=ge.length;if(!K||!K.state||(re=(Ae=K.state).wrap)===2||re===1&&Ae.status!==D||Ae.lookahead)return y;for(re===1&&(K.adler=l(K.adler,ge,Rt,0)),Ae.wrap=0,Rt>=Ae.w_size&&(re===0&&(V(Ae.head),Ae.strstart=0,Ae.block_start=0,Ae.insert=0),lt=new a.Buf8(Ae.w_size),a.arraySet(lt,ge,Rt-Ae.w_size,Ae.w_size,0),ge=lt,Rt=Ae.w_size),Te=K.avail_in,Be=K.next_in,ke=K.input,K.avail_in=Rt,K.next_in=0,K.input=ge,je(Ae);Ae.lookahead>=I;){for(le=Ae.strstart,oe=Ae.lookahead-(I-1);Ae.ins_h=(Ae.ins_h<<Ae.hash_shift^Ae.window[le+I-1])&Ae.hash_mask,Ae.prev[le&Ae.w_mask]=Ae.head[Ae.ins_h],Ae.head[Ae.ins_h]=le,le++,--oe;);Ae.strstart=le,Ae.lookahead=I-1,je(Ae)}return Ae.strstart+=Ae.lookahead,Ae.block_start=Ae.strstart,Ae.insert=Ae.lookahead,Ae.lookahead=0,Ae.match_length=Ae.prev_length=I-1,Ae.match_available=0,K.next_in=Be,K.input=ke,K.avail_in=Te,Ae.wrap=re,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,R,A,N,I,O,B,D,W,P,Z;o=i.state,l=i.next_in,P=i.input,c=l+(i.avail_in-5),u=i.next_out,Z=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),m=o.dmax,y=o.wsize,b=o.whave,v=o.wnext,x=o.window,w=o.hold,S=o.bits,k=o.lencode,C=o.distcode,R=(1<<o.lenbits)-1,A=(1<<o.distbits)-1;e:do{S<15&&(w+=P[l++]<<S,S+=8,w+=P[l++]<<S,S+=8),N=k[w&R];t:for(;;){if(w>>>=I=N>>>24,S-=I,(I=N>>>16&255)===0)Z[u++]=65535&N;else{if(!(16&I)){if((64&I)==0){N=k[(65535&N)+(w&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}O=65535&N,(I&=15)&&(S<I&&(w+=P[l++]<<S,S+=8),O+=w&(1<<I)-1,w>>>=I,S-=I),S<15&&(w+=P[l++]<<S,S+=8,w+=P[l++]<<S,S+=8),N=C[w&A];n:for(;;){if(w>>>=I=N>>>24,S-=I,!(16&(I=N>>>16&255))){if((64&I)==0){N=C[(65535&N)+(w&(1<<I)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(B=65535&N,S<(I&=15)&&(w+=P[l++]<<S,(S+=8)<I&&(w+=P[l++]<<S,S+=8)),m<(B+=w&(1<<I)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=I,S-=I,(I=u-d)<B){if(b<(I=B-I)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(W=x,(D=0)===v){if(D+=y-I,I<O){for(O-=I;Z[u++]=x[D++],--I;);D=u-B,W=Z}}else if(v<I){if(D+=y+v-I,(I-=v)<O){for(O-=I;Z[u++]=x[D++],--I;);if(D=0,v<O){for(O-=I=v;Z[u++]=x[D++],--I;);D=u-B,W=Z}}}else if(D+=v-I,I<O){for(O-=I;Z[u++]=x[D++],--I;);D=u-B,W=Z}for(;2<O;)Z[u++]=W[D++],Z[u++]=W[D++],Z[u++]=W[D++],O-=3;O&&(Z[u++]=W[D++],1<O&&(Z[u++]=W[D++]))}else{for(D=u-B;Z[u++]=Z[D++],Z[u++]=Z[D++],Z[u++]=Z[D++],2<(O-=3););O&&(Z[u++]=Z[D++],1<O&&(Z[u++]=Z[D++]))}break}}break}}while(l<c&&u<h);l-=O=S>>3,w&=(1<<(S-=O<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=S}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,m=-2,y=1,b=852,v=592;function x(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(D){var W;return D&&D.state?(W=D.state,D.total_in=D.total_out=W.total=0,D.msg="",W.wrap&&(D.adler=1&W.wrap),W.mode=y,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new i.Buf32(b),W.distcode=W.distdyn=new i.Buf32(v),W.sane=1,W.back=-1,h):m}function k(D){var W;return D&&D.state?((W=D.state).wsize=0,W.whave=0,W.wnext=0,S(D)):m}function C(D,W){var P,Z;return D&&D.state?(Z=D.state,W<0?(P=0,W=-W):(P=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?m:(Z.window!==null&&Z.wbits!==W&&(Z.window=null),Z.wrap=P,Z.wbits=W,k(D))):m}function R(D,W){var P,Z;return D?(Z=new w,(D.state=Z).window=null,(P=C(D,W))!==h&&(D.state=null),P):m}var A,N,I=!0;function O(D){if(I){var W;for(A=new i.Buf32(512),N=new i.Buf32(32),W=0;W<144;)D.lens[W++]=8;for(;W<256;)D.lens[W++]=9;for(;W<280;)D.lens[W++]=7;for(;W<288;)D.lens[W++]=8;for(c(u,D.lens,0,288,A,0,D.work,{bits:9}),W=0;W<32;)D.lens[W++]=5;c(d,D.lens,0,32,N,0,D.work,{bits:5}),I=!1}D.lencode=A,D.lenbits=9,D.distcode=N,D.distbits=5}function B(D,W,P,Z){var U,H=D.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new i.Buf8(H.wsize)),Z>=H.wsize?(i.arraySet(H.window,W,P-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(Z<(U=H.wsize-H.wnext)&&(U=Z),i.arraySet(H.window,W,P-Z,U,H.wnext),(Z-=U)?(i.arraySet(H.window,W,P-Z,Z,0),H.wnext=Z,H.whave=H.wsize):(H.wnext+=U,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=U))),0}s.inflateReset=k,s.inflateReset2=C,s.inflateResetKeep=S,s.inflateInit=function(D){return R(D,15)},s.inflateInit2=R,s.inflate=function(D,W){var P,Z,U,H,L,ne,V,Q,ee,se,me,ce,je,De,Se,Ce,qe,Qe,We,Ne,K,ge,Ae,le,oe=0,re=new i.Buf8(4),Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return m;(P=D.state).mode===12&&(P.mode=13),L=D.next_out,U=D.output,V=D.avail_out,H=D.next_in,Z=D.input,ne=D.avail_in,Q=P.hold,ee=P.bits,se=ne,me=V,ge=h;e:for(;;)switch(P.mode){case y:if(P.wrap===0){P.mode=13;break}for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(2&P.wrap&&Q===35615){re[P.check=0]=255&Q,re[1]=Q>>>8&255,P.check=o(P.check,re,2,0),ee=Q=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&Q)<<8)+(Q>>8))%31){D.msg="incorrect header check",P.mode=30;break}if((15&Q)!=8){D.msg="unknown compression method",P.mode=30;break}if(ee-=4,K=8+(15&(Q>>>=4)),P.wbits===0)P.wbits=K;else if(K>P.wbits){D.msg="invalid window size",P.mode=30;break}P.dmax=1<<K,D.adler=P.check=1,P.mode=512&Q?10:12,ee=Q=0;break;case 2:for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(P.flags=Q,(255&P.flags)!=8){D.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){D.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=Q>>8&1),512&P.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,P.check=o(P.check,re,2,0)),ee=Q=0,P.mode=3;case 3:for(;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}P.head&&(P.head.time=Q),512&P.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,re[2]=Q>>>16&255,re[3]=Q>>>24&255,P.check=o(P.check,re,4,0)),ee=Q=0,P.mode=4;case 4:for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}P.head&&(P.head.xflags=255&Q,P.head.os=Q>>8),512&P.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,P.check=o(P.check,re,2,0)),ee=Q=0,P.mode=5;case 5:if(1024&P.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}P.length=Q,P.head&&(P.head.extra_len=Q),512&P.flags&&(re[0]=255&Q,re[1]=Q>>>8&255,P.check=o(P.check,re,2,0)),ee=Q=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(ne<(ce=P.length)&&(ce=ne),ce&&(P.head&&(K=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),i.arraySet(P.head.extra,Z,H,ce,K)),512&P.flags&&(P.check=o(P.check,Z,ce,H)),ne-=ce,H+=ce,P.length-=ce),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(ne===0)break e;for(ce=0;K=Z[H+ce++],P.head&&K&&P.length<65536&&(P.head.name+=String.fromCharCode(K)),K&&ce<ne;);if(512&P.flags&&(P.check=o(P.check,Z,ce,H)),ne-=ce,H+=ce,K)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(ne===0)break e;for(ce=0;K=Z[H+ce++],P.head&&K&&P.length<65536&&(P.head.comment+=String.fromCharCode(K)),K&&ce<ne;);if(512&P.flags&&(P.check=o(P.check,Z,ce,H)),ne-=ce,H+=ce,K)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;ee<16;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Q!==(65535&P.check)){D.msg="header crc mismatch",P.mode=30;break}ee=Q=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),D.adler=P.check=0,P.mode=12;break;case 10:for(;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}D.adler=P.check=x(Q),ee=Q=0,P.mode=11;case 11:if(P.havedict===0)return D.next_out=L,D.avail_out=V,D.next_in=H,D.avail_in=ne,P.hold=Q,P.bits=ee,2;D.adler=P.check=1,P.mode=12;case 12:if(W===5||W===6)break e;case 13:if(P.last){Q>>>=7&ee,ee-=7&ee,P.mode=27;break}for(;ee<3;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}switch(P.last=1&Q,ee-=1,3&(Q>>>=1)){case 0:P.mode=14;break;case 1:if(O(P),P.mode=20,W!==6)break;Q>>>=2,ee-=2;break e;case 2:P.mode=17;break;case 3:D.msg="invalid block type",P.mode=30}Q>>>=2,ee-=2;break;case 14:for(Q>>>=7&ee,ee-=7&ee;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if((65535&Q)!=(Q>>>16^65535)){D.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&Q,ee=Q=0,P.mode=15,W===6)break e;case 15:P.mode=16;case 16:if(ce=P.length){if(ne<ce&&(ce=ne),V<ce&&(ce=V),ce===0)break e;i.arraySet(U,Z,H,ce,L),ne-=ce,H+=ce,V-=ce,L+=ce,P.length-=ce;break}P.mode=12;break;case 17:for(;ee<14;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(P.nlen=257+(31&Q),Q>>>=5,ee-=5,P.ndist=1+(31&Q),Q>>>=5,ee-=5,P.ncode=4+(15&Q),Q>>>=4,ee-=4,286<P.nlen||30<P.ndist){D.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;ee<3;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}P.lens[Te[P.have++]]=7&Q,Q>>>=3,ee-=3}for(;P.have<19;)P.lens[Te[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,Ae={bits:P.lenbits},ge=c(0,P.lens,0,19,P.lencode,0,P.work,Ae),P.lenbits=Ae.bits,ge){D.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;Ce=(oe=P.lencode[Q&(1<<P.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(qe<16)Q>>>=Se,ee-=Se,P.lens[P.have++]=qe;else{if(qe===16){for(le=Se+2;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Q>>>=Se,ee-=Se,P.have===0){D.msg="invalid bit length repeat",P.mode=30;break}K=P.lens[P.have-1],ce=3+(3&Q),Q>>>=2,ee-=2}else if(qe===17){for(le=Se+3;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}ee-=Se,K=0,ce=3+(7&(Q>>>=Se)),Q>>>=3,ee-=3}else{for(le=Se+7;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}ee-=Se,K=0,ce=11+(127&(Q>>>=Se)),Q>>>=7,ee-=7}if(P.have+ce>P.nlen+P.ndist){D.msg="invalid bit length repeat",P.mode=30;break}for(;ce--;)P.lens[P.have++]=K}}if(P.mode===30)break;if(P.lens[256]===0){D.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,Ae={bits:P.lenbits},ge=c(u,P.lens,0,P.nlen,P.lencode,0,P.work,Ae),P.lenbits=Ae.bits,ge){D.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,Ae={bits:P.distbits},ge=c(d,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,Ae),P.distbits=Ae.bits,ge){D.msg="invalid distances set",P.mode=30;break}if(P.mode=20,W===6)break e;case 20:P.mode=21;case 21:if(6<=ne&&258<=V){D.next_out=L,D.avail_out=V,D.next_in=H,D.avail_in=ne,P.hold=Q,P.bits=ee,l(D,me),L=D.next_out,U=D.output,V=D.avail_out,H=D.next_in,Z=D.input,ne=D.avail_in,Q=P.hold,ee=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;Ce=(oe=P.lencode[Q&(1<<P.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Ce&&(240&Ce)==0){for(Qe=Se,We=Ce,Ne=qe;Ce=(oe=P.lencode[Ne+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,P.back+=Qe}if(Q>>>=Se,ee-=Se,P.back+=Se,P.length=qe,Ce===0){P.mode=26;break}if(32&Ce){P.back=-1,P.mode=12;break}if(64&Ce){D.msg="invalid literal/length code",P.mode=30;break}P.extra=15&Ce,P.mode=22;case 22:if(P.extra){for(le=P.extra;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}P.length+=Q&(1<<P.extra)-1,Q>>>=P.extra,ee-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;Ce=(oe=P.distcode[Q&(1<<P.distbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if((240&Ce)==0){for(Qe=Se,We=Ce,Ne=qe;Ce=(oe=P.distcode[Ne+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,P.back+=Qe}if(Q>>>=Se,ee-=Se,P.back+=Se,64&Ce){D.msg="invalid distance code",P.mode=30;break}P.offset=qe,P.extra=15&Ce,P.mode=24;case 24:if(P.extra){for(le=P.extra;ee<le;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}P.offset+=Q&(1<<P.extra)-1,Q>>>=P.extra,ee-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){D.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(V===0)break e;if(ce=me-V,P.offset>ce){if((ce=P.offset-ce)>P.whave&&P.sane){D.msg="invalid distance too far back",P.mode=30;break}je=ce>P.wnext?(ce-=P.wnext,P.wsize-ce):P.wnext-ce,ce>P.length&&(ce=P.length),De=P.window}else De=U,je=L-P.offset,ce=P.length;for(V<ce&&(ce=V),V-=ce,P.length-=ce;U[L++]=De[je++],--ce;);P.length===0&&(P.mode=21);break;case 26:if(V===0)break e;U[L++]=P.length,V--,P.mode=21;break;case 27:if(P.wrap){for(;ee<32;){if(ne===0)break e;ne--,Q|=Z[H++]<<ee,ee+=8}if(me-=V,D.total_out+=me,P.total+=me,me&&(D.adler=P.check=P.flags?o(P.check,U,me,L-me):a(P.check,U,me,L-me)),me=V,(P.flags?Q:x(Q))!==P.check){D.msg="incorrect data check",P.mode=30;break}ee=Q=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;ee<32;){if(ne===0)break e;ne--,Q+=Z[H++]<<ee,ee+=8}if(Q!==(4294967295&P.total)){D.msg="incorrect length check",P.mode=30;break}ee=Q=0}P.mode=29;case 29:ge=1;break e;case 30:ge=-3;break e;case 31:return-4;case 32:default:return m}return D.next_out=L,D.avail_out=V,D.next_in=H,D.avail_in=ne,P.hold=Q,P.bits=ee,(P.wsize||me!==D.avail_out&&P.mode<30&&(P.mode<27||W!==4))&&B(D,D.output,D.next_out,me-D.avail_out)?(P.mode=31,-4):(se-=D.avail_in,me-=D.avail_out,D.total_in+=se,D.total_out+=me,P.total+=me,P.wrap&&me&&(D.adler=P.check=P.flags?o(P.check,U,me,D.next_out-me):a(P.check,U,me,D.next_out-me)),D.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(se==0&&me===0||W===4)&&ge===h&&(ge=-5),ge)},s.inflateEnd=function(D){if(!D||!D.state)return m;var W=D.state;return W.window&&(W.window=null),D.state=null,h},s.inflateGetHeader=function(D,W){var P;return D&&D.state?(2&(P=D.state).wrap)==0?m:((P.head=W).done=!1,h):m},s.inflateSetDictionary=function(D,W){var P,Z=W.length;return D&&D.state?(P=D.state).wrap!==0&&P.mode!==11?m:P.mode===11&&a(1,W,Z,0)!==P.check?-3:B(D,W,Z,Z)?(P.mode=31,-4):(P.havedict=1,h):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,m,y,b,v,x){var w,S,k,C,R,A,N,I,O,B=x.bits,D=0,W=0,P=0,Z=0,U=0,H=0,L=0,ne=0,V=0,Q=0,ee=null,se=0,me=new i.Buf16(16),ce=new i.Buf16(16),je=null,De=0;for(D=0;D<=15;D++)me[D]=0;for(W=0;W<m;W++)me[d[h+W]]++;for(U=B,Z=15;1<=Z&&me[Z]===0;Z--);if(Z<U&&(U=Z),Z===0)return y[b++]=20971520,y[b++]=20971520,x.bits=1,0;for(P=1;P<Z&&me[P]===0;P++);for(U<P&&(U=P),D=ne=1;D<=15;D++)if(ne<<=1,(ne-=me[D])<0)return-1;if(0<ne&&(u===0||Z!==1))return-1;for(ce[1]=0,D=1;D<15;D++)ce[D+1]=ce[D]+me[D];for(W=0;W<m;W++)d[h+W]!==0&&(v[ce[d[h+W]]++]=W);if(A=u===0?(ee=je=v,19):u===1?(ee=a,se-=257,je=o,De-=257,256):(ee=l,je=c,-1),D=P,R=b,L=W=Q=0,k=-1,C=(V=1<<(H=U))-1,u===1&&852<V||u===2&&592<V)return 1;for(;;){for(N=D-L,O=v[W]<A?(I=0,v[W]):v[W]>A?(I=je[De+v[W]],ee[se+v[W]]):(I=96,0),w=1<<D-L,P=S=1<<H;y[R+(Q>>L)+(S-=w)]=N<<24|I<<16|O|0,S!==0;);for(w=1<<D-1;Q&w;)w>>=1;if(w!==0?(Q&=w-1,Q+=w):Q=0,W++,--me[D]==0){if(D===Z)break;D=d[h+v[W]]}if(U<D&&(Q&C)!==k){for(L===0&&(L=U),R+=P,ne=1<<(H=D-L);H+L<Z&&!((ne-=me[H+L])<=0);)H++,ne<<=1;if(V+=1<<H,u===1&&852<V||u===2&&592<V)return 1;y[k=Q&C]=U<<24|H<<16|R-b|0}}return Q!==0&&(y[R+Q]=D-L<<24|64<<16|0),x.bits=U,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var re=oe.length;0<=--re;)oe[re]=0}var c=0,u=29,d=256,h=d+1+u,m=30,y=19,b=2*h+1,v=15,x=16,w=7,S=256,k=16,C=17,R=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=new Array(2*(h+2));l(B);var D=new Array(2*m);l(D);var W=new Array(512);l(W);var P=new Array(256);l(P);var Z=new Array(u);l(Z);var U,H,L,ne=new Array(m);function V(oe,re,Te,Be,ke){this.static_tree=oe,this.extra_bits=re,this.extra_base=Te,this.elems=Be,this.max_length=ke,this.has_stree=oe&&oe.length}function Q(oe,re){this.dyn_tree=oe,this.max_code=0,this.stat_desc=re}function ee(oe){return oe<256?W[oe]:W[256+(oe>>>7)]}function se(oe,re){oe.pending_buf[oe.pending++]=255&re,oe.pending_buf[oe.pending++]=re>>>8&255}function me(oe,re,Te){oe.bi_valid>x-Te?(oe.bi_buf|=re<<oe.bi_valid&65535,se(oe,oe.bi_buf),oe.bi_buf=re>>x-oe.bi_valid,oe.bi_valid+=Te-x):(oe.bi_buf|=re<<oe.bi_valid&65535,oe.bi_valid+=Te)}function ce(oe,re,Te){me(oe,Te[2*re],Te[2*re+1])}function je(oe,re){for(var Te=0;Te|=1&oe,oe>>>=1,Te<<=1,0<--re;);return Te>>>1}function De(oe,re,Te){var Be,ke,lt=new Array(v+1),Rt=0;for(Be=1;Be<=v;Be++)lt[Be]=Rt=Rt+Te[Be-1]<<1;for(ke=0;ke<=re;ke++){var ft=oe[2*ke+1];ft!==0&&(oe[2*ke]=je(lt[ft]++,ft))}}function Se(oe){var re;for(re=0;re<h;re++)oe.dyn_ltree[2*re]=0;for(re=0;re<m;re++)oe.dyn_dtree[2*re]=0;for(re=0;re<y;re++)oe.bl_tree[2*re]=0;oe.dyn_ltree[2*S]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Ce(oe){8<oe.bi_valid?se(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function qe(oe,re,Te,Be){var ke=2*re,lt=2*Te;return oe[ke]<oe[lt]||oe[ke]===oe[lt]&&Be[re]<=Be[Te]}function Qe(oe,re,Te){for(var Be=oe.heap[Te],ke=Te<<1;ke<=oe.heap_len&&(ke<oe.heap_len&&qe(re,oe.heap[ke+1],oe.heap[ke],oe.depth)&&ke++,!qe(re,Be,oe.heap[ke],oe.depth));)oe.heap[Te]=oe.heap[ke],Te=ke,ke<<=1;oe.heap[Te]=Be}function We(oe,re,Te){var Be,ke,lt,Rt,ft=0;if(oe.last_lit!==0)for(;Be=oe.pending_buf[oe.d_buf+2*ft]<<8|oe.pending_buf[oe.d_buf+2*ft+1],ke=oe.pending_buf[oe.l_buf+ft],ft++,Be===0?ce(oe,ke,re):(ce(oe,(lt=P[ke])+d+1,re),(Rt=A[lt])!==0&&me(oe,ke-=Z[lt],Rt),ce(oe,lt=ee(--Be),Te),(Rt=N[lt])!==0&&me(oe,Be-=ne[lt],Rt)),ft<oe.last_lit;);ce(oe,S,re)}function Ne(oe,re){var Te,Be,ke,lt=re.dyn_tree,Rt=re.stat_desc.static_tree,ft=re.stat_desc.has_stree,Pt=re.stat_desc.elems,qt=-1;for(oe.heap_len=0,oe.heap_max=b,Te=0;Te<Pt;Te++)lt[2*Te]!==0?(oe.heap[++oe.heap_len]=qt=Te,oe.depth[Te]=0):lt[2*Te+1]=0;for(;oe.heap_len<2;)lt[2*(ke=oe.heap[++oe.heap_len]=qt<2?++qt:0)]=1,oe.depth[ke]=0,oe.opt_len--,ft&&(oe.static_len-=Rt[2*ke+1]);for(re.max_code=qt,Te=oe.heap_len>>1;1<=Te;Te--)Qe(oe,lt,Te);for(ke=Pt;Te=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Qe(oe,lt,1),Be=oe.heap[1],oe.heap[--oe.heap_max]=Te,oe.heap[--oe.heap_max]=Be,lt[2*ke]=lt[2*Te]+lt[2*Be],oe.depth[ke]=(oe.depth[Te]>=oe.depth[Be]?oe.depth[Te]:oe.depth[Be])+1,lt[2*Te+1]=lt[2*Be+1]=ke,oe.heap[1]=ke++,Qe(oe,lt,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Lt,en){var xe,F,X,ye,Fe,we,Ie=en.dyn_tree,fe=en.max_code,vt=en.stat_desc.static_tree,ot=en.stat_desc.has_stree,$=en.stat_desc.extra_bits,ze=en.stat_desc.extra_base,st=en.stat_desc.max_length,be=0;for(ye=0;ye<=v;ye++)Lt.bl_count[ye]=0;for(Ie[2*Lt.heap[Lt.heap_max]+1]=0,xe=Lt.heap_max+1;xe<b;xe++)st<(ye=Ie[2*Ie[2*(F=Lt.heap[xe])+1]+1]+1)&&(ye=st,be++),Ie[2*F+1]=ye,fe<F||(Lt.bl_count[ye]++,Fe=0,ze<=F&&(Fe=$[F-ze]),we=Ie[2*F],Lt.opt_len+=we*(ye+Fe),ot&&(Lt.static_len+=we*(vt[2*F+1]+Fe)));if(be!==0){do{for(ye=st-1;Lt.bl_count[ye]===0;)ye--;Lt.bl_count[ye]--,Lt.bl_count[ye+1]+=2,Lt.bl_count[st]--,be-=2}while(0<be);for(ye=st;ye!==0;ye--)for(F=Lt.bl_count[ye];F!==0;)fe<(X=Lt.heap[--xe])||(Ie[2*X+1]!==ye&&(Lt.opt_len+=(ye-Ie[2*X+1])*Ie[2*X],Ie[2*X+1]=ye),F--)}}(oe,re),De(lt,qt,oe.bl_count)}function K(oe,re,Te){var Be,ke,lt=-1,Rt=re[1],ft=0,Pt=7,qt=4;for(Rt===0&&(Pt=138,qt=3),re[2*(Te+1)+1]=65535,Be=0;Be<=Te;Be++)ke=Rt,Rt=re[2*(Be+1)+1],++ft<Pt&&ke===Rt||(ft<qt?oe.bl_tree[2*ke]+=ft:ke!==0?(ke!==lt&&oe.bl_tree[2*ke]++,oe.bl_tree[2*k]++):ft<=10?oe.bl_tree[2*C]++:oe.bl_tree[2*R]++,lt=ke,qt=(ft=0)===Rt?(Pt=138,3):ke===Rt?(Pt=6,3):(Pt=7,4))}function ge(oe,re,Te){var Be,ke,lt=-1,Rt=re[1],ft=0,Pt=7,qt=4;for(Rt===0&&(Pt=138,qt=3),Be=0;Be<=Te;Be++)if(ke=Rt,Rt=re[2*(Be+1)+1],!(++ft<Pt&&ke===Rt)){if(ft<qt)for(;ce(oe,ke,oe.bl_tree),--ft!=0;);else ke!==0?(ke!==lt&&(ce(oe,ke,oe.bl_tree),ft--),ce(oe,k,oe.bl_tree),me(oe,ft-3,2)):ft<=10?(ce(oe,C,oe.bl_tree),me(oe,ft-3,3)):(ce(oe,R,oe.bl_tree),me(oe,ft-11,7));lt=ke,qt=(ft=0)===Rt?(Pt=138,3):ke===Rt?(Pt=6,3):(Pt=7,4)}}l(ne);var Ae=!1;function le(oe,re,Te,Be){me(oe,(c<<1)+(Be?1:0),3),function(ke,lt,Rt,ft){Ce(ke),se(ke,Rt),se(ke,~Rt),i.arraySet(ke.pending_buf,ke.window,lt,Rt,ke.pending),ke.pending+=Rt}(oe,re,Te)}s._tr_init=function(oe){Ae||(function(){var re,Te,Be,ke,lt,Rt=new Array(v+1);for(ke=Be=0;ke<u-1;ke++)for(Z[ke]=Be,re=0;re<1<<A[ke];re++)P[Be++]=ke;for(P[Be-1]=ke,ke=lt=0;ke<16;ke++)for(ne[ke]=lt,re=0;re<1<<N[ke];re++)W[lt++]=ke;for(lt>>=7;ke<m;ke++)for(ne[ke]=lt<<7,re=0;re<1<<N[ke]-7;re++)W[256+lt++]=ke;for(Te=0;Te<=v;Te++)Rt[Te]=0;for(re=0;re<=143;)B[2*re+1]=8,re++,Rt[8]++;for(;re<=255;)B[2*re+1]=9,re++,Rt[9]++;for(;re<=279;)B[2*re+1]=7,re++,Rt[7]++;for(;re<=287;)B[2*re+1]=8,re++,Rt[8]++;for(De(B,h+1,Rt),re=0;re<m;re++)D[2*re+1]=5,D[2*re]=je(re,5);U=new V(B,A,d+1,h,v),H=new V(D,N,0,m,v),L=new V(new Array(0),I,0,y,w)}(),Ae=!0),oe.l_desc=new Q(oe.dyn_ltree,U),oe.d_desc=new Q(oe.dyn_dtree,H),oe.bl_desc=new Q(oe.bl_tree,L),oe.bi_buf=0,oe.bi_valid=0,Se(oe)},s._tr_stored_block=le,s._tr_flush_block=function(oe,re,Te,Be){var ke,lt,Rt=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(ft){var Pt,qt=4093624447;for(Pt=0;Pt<=31;Pt++,qt>>>=1)if(1&qt&&ft.dyn_ltree[2*Pt]!==0)return a;if(ft.dyn_ltree[18]!==0||ft.dyn_ltree[20]!==0||ft.dyn_ltree[26]!==0)return o;for(Pt=32;Pt<d;Pt++)if(ft.dyn_ltree[2*Pt]!==0)return o;return a}(oe)),Ne(oe,oe.l_desc),Ne(oe,oe.d_desc),Rt=function(ft){var Pt;for(K(ft,ft.dyn_ltree,ft.l_desc.max_code),K(ft,ft.dyn_dtree,ft.d_desc.max_code),Ne(ft,ft.bl_desc),Pt=y-1;3<=Pt&&ft.bl_tree[2*O[Pt]+1]===0;Pt--);return ft.opt_len+=3*(Pt+1)+5+5+4,Pt}(oe),ke=oe.opt_len+3+7>>>3,(lt=oe.static_len+3+7>>>3)<=ke&&(ke=lt)):ke=lt=Te+5,Te+4<=ke&&re!==-1?le(oe,re,Te,Be):oe.strategy===4||lt===ke?(me(oe,2+(Be?1:0),3),We(oe,B,D)):(me(oe,4+(Be?1:0),3),function(ft,Pt,qt,Lt){var en;for(me(ft,Pt-257,5),me(ft,qt-1,5),me(ft,Lt-4,4),en=0;en<Lt;en++)me(ft,ft.bl_tree[2*O[en]+1],3);ge(ft,ft.dyn_ltree,Pt-1),ge(ft,ft.dyn_dtree,qt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,Rt+1),We(oe,oe.dyn_ltree,oe.dyn_dtree)),Se(oe),Be&&Ce(oe)},s._tr_tally=function(oe,re,Te){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=re>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&re,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Te,oe.last_lit++,re===0?oe.dyn_ltree[2*Te]++:(oe.matches++,re--,oe.dyn_ltree[2*(P[Te]+d+1)]++,oe.dyn_dtree[2*ee(re)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){me(oe,2,3),ce(oe,S,B),function(re){re.bi_valid===16?(se(re,re.bi_buf),re.bi_buf=0,re.bi_valid=0):8<=re.bi_valid&&(re.pending_buf[re.pending++]=255&re.bi_buf,re.bi_buf>>=8,re.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,m={},y=!1,b=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(k){Ni.nextTick(function(){w(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,C=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=C,k}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(k){a.postMessage(d+k,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){u.port2.postMessage(k)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(k){var C=b.createElement("script");C.onreadystatechange=function(){w(k),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(k){setTimeout(w,0,k)},v.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),R=0;R<C.length;R++)C[R]=arguments[R+1];var A={callback:k,args:C};return m[h]=A,l(h),h++},v.clearImmediate=x}function x(k){delete m[k]}function w(k){if(y)setTimeout(w,0,k);else{var C=m[k];if(C){y=!0;try{(function(R){var A=R.callback,N=R.args;switch(N.length){case 0:A();break;case 1:A(N[0]);break;case 2:A(N[0],N[1]);break;case 3:A(N[0],N[1],N[2]);break;default:A.apply(o,N)}})(C)}finally{x(k),y=!1}}}}function S(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(d)===0&&w(+k.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Qp<"u"?Qp:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(RM)),RM.exports}var b2e=y2e();const sD=Sa(b2e),dw=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},zr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Pu=(...e)=>zr(e.map(t=>t.trim()).filter(Boolean).join("/")),QE=e=>{const t=zr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},bi=e=>{const t=zr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},Nj=(e,t)=>zr(e==="/"?`/${t}`:`${e}/${t}`);var NM,R9;function v2e(){if(R9)return NM;R9=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Ni>"u"||typeof Ni.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(S,k){i=S,a=k})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,m=function(S,k,C){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?k?a(k):i(C):typeof r=="function"&&r(k,C),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(S){if(l)return m(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=Ni.domain);var k=s.maxExecutionTime||h.maxExecutionTime;if(k&&(d=setTimeout(function(){h.queues[t]&&m(S,new Error("Maximum execution time is exceeded "+t))},k)),n.length===1){var C=!1;try{n(function(R,A){C||(C=!0,m(S,R,A))})}catch(R){C||(C=!0,m(S,R))}}else h._promiseTry(function(){return n()}).then(function(R){m(S,void 0,R)},function(R){m(S,R)})};h.domainReentrant&&Ni.domain&&(y=Ni.domain.bind(y));var b=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&Ni.domain&&Ni.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)m(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){y(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},NM=e,NM}var MM,N9;function x2e(){return N9||(N9=1,MM=v2e()),MM}var w2e=x2e();const fw=Sa(w2e);var $S={exports:{}},M9;function _2e(){return M9||(M9=1,typeof Object.create=="function"?$S.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:$S.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),$S.exports}var IM,I9;function S2e(){if(I9)return IM;I9=1;var e=GO().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},IM=t,IM}var jM,j9;function C2e(){if(j9)return jM;j9=1;var e=_2e(),t=S2e(),n=GO().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,m){return u===0?d&h|~d&m:u===2?d&h|d&m|h&m:d^h^m}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,m=this._b|0,y=this._c|0,b=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var S=~~(w/20),k=o(h)+c(S,m,y,b)+v+d[w]+r[S]|0;v=b,b=y,y=l(m),m=h,h=k}this._a=h+this._a|0,this._b=m+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},jM=i,jM}var k2e=C2e();const kY=Sa(k2e);var PM,P9;function E2e(){if(P9)return PM;P9=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Ni.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,m=c<h?c:h,y=-1,b=0;b<=m;++b){if(b===m){if(h>m){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>m&&(i.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var v=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(v!==x)break;v===47&&(y=b)}var w="";for(b=o+y+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var m=i.charCodeAt(u);if(m===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(m===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,m=!0,y=i.length-1,b=0;y>=c;--y){if(o=i.charCodeAt(y),o===47){if(!m){d=y+1;break}continue}h===-1&&(m=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,PM=r,PM}var $t=E2e(),OM={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var O9;function T2e(){return O9||(O9=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var N=0,I=new Array(256),O=0;O!=256;++O)N=O,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[O]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=n();function s(N){var I=0,O=0,B=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)D[B]=N[B];for(B=0;B!=256;++B)for(O=N[B],I=256+B;I<4096;I+=256)O=D[I]=O>>>8^N[O&255];var W=[];for(B=1;B!=16;++B)W[B-1]=typeof Int32Array<"u"?D.subarray(B*256,B*256+256):D.slice(B*256,B*256+256);return W}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],m=i[7],y=i[8],b=i[9],v=i[10],x=i[11],w=i[12],S=i[13],k=i[14];function C(N,I){for(var O=I^-1,B=0,D=N.length;B<D;)O=O>>>8^r[(O^N.charCodeAt(B++))&255];return~O}function R(N,I){for(var O=I^-1,B=N.length-15,D=0;D<B;)O=k[N[D++]^O&255]^S[N[D++]^O>>8&255]^w[N[D++]^O>>16&255]^x[N[D++]^O>>>24]^v[N[D++]]^b[N[D++]]^y[N[D++]]^m[N[D++]]^h[N[D++]]^d[N[D++]]^u[N[D++]]^c[N[D++]]^l[N[D++]]^o[N[D++]]^a[N[D++]]^r[N[D++]];for(B+=15;D<B;)O=O>>>8^r[(O^N[D++])&255];return~O}function A(N,I){for(var O=I^-1,B=0,D=N.length,W=0,P=0;B<D;)W=N.charCodeAt(B++),W<128?O=O>>>8^r[(O^W)&255]:W<2048?(O=O>>>8^r[(O^(192|W>>6&31))&255],O=O>>>8^r[(O^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,P=N.charCodeAt(B++)&1023,O=O>>>8^r[(O^(240|W>>8&7))&255],O=O>>>8^r[(O^(128|W>>2&63))&255],O=O>>>8^r[(O^(128|P>>6&15|(W&3)<<4))&255],O=O>>>8^r[(O^(128|P&63))&255]):(O=O>>>8^r[(O^(224|W>>12&15))&255],O=O>>>8^r[(O^(128|W>>6&63))&255],O=O>>>8^r[(O^(128|W&63))&255]);return~O}t.table=r,t.bstr=C,t.buf=R,t.str=A})}(OM)),OM}var A2e=T2e();const R2e=Sa(A2e);var DM={},D9;function Gh(){return D9||(D9=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(DM)),DM}var Zg={},oc={},Lp={},F9;function N2e(){if(F9)return Lp;F9=1;var e=Gh(),t=4,n=0,r=1,s=2;function i(F){for(var X=F.length;--X>=0;)F[X]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,m=h+1+d,y=30,b=19,v=2*m+1,x=15,w=16,S=7,k=256,C=16,R=17,A=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=512,W=new Array((m+2)*2);i(W);var P=new Array(y*2);i(P);var Z=new Array(D);i(Z);var U=new Array(u-c+1);i(U);var H=new Array(d);i(H);var L=new Array(y);i(L);function ne(F,X,ye,Fe,we){this.static_tree=F,this.extra_bits=X,this.extra_base=ye,this.elems=Fe,this.max_length=we,this.has_stree=F&&F.length}var V,Q,ee;function se(F,X){this.dyn_tree=F,this.max_code=0,this.stat_desc=X}function me(F){return F<256?Z[F]:Z[256+(F>>>7)]}function ce(F,X){F.pending_buf[F.pending++]=X&255,F.pending_buf[F.pending++]=X>>>8&255}function je(F,X,ye){F.bi_valid>w-ye?(F.bi_buf|=X<<F.bi_valid&65535,ce(F,F.bi_buf),F.bi_buf=X>>w-F.bi_valid,F.bi_valid+=ye-w):(F.bi_buf|=X<<F.bi_valid&65535,F.bi_valid+=ye)}function De(F,X,ye){je(F,ye[X*2],ye[X*2+1])}function Se(F,X){var ye=0;do ye|=F&1,F>>>=1,ye<<=1;while(--X>0);return ye>>>1}function Ce(F){F.bi_valid===16?(ce(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):F.bi_valid>=8&&(F.pending_buf[F.pending++]=F.bi_buf&255,F.bi_buf>>=8,F.bi_valid-=8)}function qe(F,X){var ye=X.dyn_tree,Fe=X.max_code,we=X.stat_desc.static_tree,Ie=X.stat_desc.has_stree,fe=X.stat_desc.extra_bits,vt=X.stat_desc.extra_base,ot=X.stat_desc.max_length,$,ze,st,be,_e,Ue,Et=0;for(be=0;be<=x;be++)F.bl_count[be]=0;for(ye[F.heap[F.heap_max]*2+1]=0,$=F.heap_max+1;$<v;$++)ze=F.heap[$],be=ye[ye[ze*2+1]*2+1]+1,be>ot&&(be=ot,Et++),ye[ze*2+1]=be,!(ze>Fe)&&(F.bl_count[be]++,_e=0,ze>=vt&&(_e=fe[ze-vt]),Ue=ye[ze*2],F.opt_len+=Ue*(be+_e),Ie&&(F.static_len+=Ue*(we[ze*2+1]+_e)));if(Et!==0){do{for(be=ot-1;F.bl_count[be]===0;)be--;F.bl_count[be]--,F.bl_count[be+1]+=2,F.bl_count[ot]--,Et-=2}while(Et>0);for(be=ot;be!==0;be--)for(ze=F.bl_count[be];ze!==0;)st=F.heap[--$],!(st>Fe)&&(ye[st*2+1]!==be&&(F.opt_len+=(be-ye[st*2+1])*ye[st*2],ye[st*2+1]=be),ze--)}}function Qe(F,X,ye){var Fe=new Array(x+1),we=0,Ie,fe;for(Ie=1;Ie<=x;Ie++)Fe[Ie]=we=we+ye[Ie-1]<<1;for(fe=0;fe<=X;fe++){var vt=F[fe*2+1];vt!==0&&(F[fe*2]=Se(Fe[vt]++,vt))}}function We(){var F,X,ye,Fe,we,Ie=new Array(x+1);for(ye=0,Fe=0;Fe<d-1;Fe++)for(H[Fe]=ye,F=0;F<1<<N[Fe];F++)U[ye++]=Fe;for(U[ye-1]=Fe,we=0,Fe=0;Fe<16;Fe++)for(L[Fe]=we,F=0;F<1<<I[Fe];F++)Z[we++]=Fe;for(we>>=7;Fe<y;Fe++)for(L[Fe]=we<<7,F=0;F<1<<I[Fe]-7;F++)Z[256+we++]=Fe;for(X=0;X<=x;X++)Ie[X]=0;for(F=0;F<=143;)W[F*2+1]=8,F++,Ie[8]++;for(;F<=255;)W[F*2+1]=9,F++,Ie[9]++;for(;F<=279;)W[F*2+1]=7,F++,Ie[7]++;for(;F<=287;)W[F*2+1]=8,F++,Ie[8]++;for(Qe(W,m+1,Ie),F=0;F<y;F++)P[F*2+1]=5,P[F*2]=Se(F,5);V=new ne(W,N,h+1,m,x),Q=new ne(P,I,0,y,x),ee=new ne(new Array(0),O,0,b,S)}function Ne(F){var X;for(X=0;X<m;X++)F.dyn_ltree[X*2]=0;for(X=0;X<y;X++)F.dyn_dtree[X*2]=0;for(X=0;X<b;X++)F.bl_tree[X*2]=0;F.dyn_ltree[k*2]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function K(F){F.bi_valid>8?ce(F,F.bi_buf):F.bi_valid>0&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function ge(F,X,ye,Fe){K(F),ce(F,ye),ce(F,~ye),e.arraySet(F.pending_buf,F.window,X,ye,F.pending),F.pending+=ye}function Ae(F,X,ye,Fe){var we=X*2,Ie=ye*2;return F[we]<F[Ie]||F[we]===F[Ie]&&Fe[X]<=Fe[ye]}function le(F,X,ye){for(var Fe=F.heap[ye],we=ye<<1;we<=F.heap_len&&(we<F.heap_len&&Ae(X,F.heap[we+1],F.heap[we],F.depth)&&we++,!Ae(X,Fe,F.heap[we],F.depth));)F.heap[ye]=F.heap[we],ye=we,we<<=1;F.heap[ye]=Fe}function oe(F,X,ye){var Fe,we,Ie=0,fe,vt;if(F.last_lit!==0)do Fe=F.pending_buf[F.d_buf+Ie*2]<<8|F.pending_buf[F.d_buf+Ie*2+1],we=F.pending_buf[F.l_buf+Ie],Ie++,Fe===0?De(F,we,X):(fe=U[we],De(F,fe+h+1,X),vt=N[fe],vt!==0&&(we-=H[fe],je(F,we,vt)),Fe--,fe=me(Fe),De(F,fe,ye),vt=I[fe],vt!==0&&(Fe-=L[fe],je(F,Fe,vt)));while(Ie<F.last_lit);De(F,k,X)}function re(F,X){var ye=X.dyn_tree,Fe=X.stat_desc.static_tree,we=X.stat_desc.has_stree,Ie=X.stat_desc.elems,fe,vt,ot=-1,$;for(F.heap_len=0,F.heap_max=v,fe=0;fe<Ie;fe++)ye[fe*2]!==0?(F.heap[++F.heap_len]=ot=fe,F.depth[fe]=0):ye[fe*2+1]=0;for(;F.heap_len<2;)$=F.heap[++F.heap_len]=ot<2?++ot:0,ye[$*2]=1,F.depth[$]=0,F.opt_len--,we&&(F.static_len-=Fe[$*2+1]);for(X.max_code=ot,fe=F.heap_len>>1;fe>=1;fe--)le(F,ye,fe);$=Ie;do fe=F.heap[1],F.heap[1]=F.heap[F.heap_len--],le(F,ye,1),vt=F.heap[1],F.heap[--F.heap_max]=fe,F.heap[--F.heap_max]=vt,ye[$*2]=ye[fe*2]+ye[vt*2],F.depth[$]=(F.depth[fe]>=F.depth[vt]?F.depth[fe]:F.depth[vt])+1,ye[fe*2+1]=ye[vt*2+1]=$,F.heap[1]=$++,le(F,ye,1);while(F.heap_len>=2);F.heap[--F.heap_max]=F.heap[1],qe(F,X),Qe(ye,ot,F.bl_count)}function Te(F,X,ye){var Fe,we=-1,Ie,fe=X[0*2+1],vt=0,ot=7,$=4;for(fe===0&&(ot=138,$=3),X[(ye+1)*2+1]=65535,Fe=0;Fe<=ye;Fe++)Ie=fe,fe=X[(Fe+1)*2+1],!(++vt<ot&&Ie===fe)&&(vt<$?F.bl_tree[Ie*2]+=vt:Ie!==0?(Ie!==we&&F.bl_tree[Ie*2]++,F.bl_tree[C*2]++):vt<=10?F.bl_tree[R*2]++:F.bl_tree[A*2]++,vt=0,we=Ie,fe===0?(ot=138,$=3):Ie===fe?(ot=6,$=3):(ot=7,$=4))}function Be(F,X,ye){var Fe,we=-1,Ie,fe=X[0*2+1],vt=0,ot=7,$=4;for(fe===0&&(ot=138,$=3),Fe=0;Fe<=ye;Fe++)if(Ie=fe,fe=X[(Fe+1)*2+1],!(++vt<ot&&Ie===fe)){if(vt<$)do De(F,Ie,F.bl_tree);while(--vt!==0);else Ie!==0?(Ie!==we&&(De(F,Ie,F.bl_tree),vt--),De(F,C,F.bl_tree),je(F,vt-3,2)):vt<=10?(De(F,R,F.bl_tree),je(F,vt-3,3)):(De(F,A,F.bl_tree),je(F,vt-11,7));vt=0,we=Ie,fe===0?(ot=138,$=3):Ie===fe?(ot=6,$=3):(ot=7,$=4)}}function ke(F){var X;for(Te(F,F.dyn_ltree,F.l_desc.max_code),Te(F,F.dyn_dtree,F.d_desc.max_code),re(F,F.bl_desc),X=b-1;X>=3&&F.bl_tree[B[X]*2+1]===0;X--);return F.opt_len+=3*(X+1)+5+5+4,X}function lt(F,X,ye,Fe){var we;for(je(F,X-257,5),je(F,ye-1,5),je(F,Fe-4,4),we=0;we<Fe;we++)je(F,F.bl_tree[B[we]*2+1],3);Be(F,F.dyn_ltree,X-1),Be(F,F.dyn_dtree,ye-1)}function Rt(F){var X=4093624447,ye;for(ye=0;ye<=31;ye++,X>>>=1)if(X&1&&F.dyn_ltree[ye*2]!==0)return n;if(F.dyn_ltree[9*2]!==0||F.dyn_ltree[10*2]!==0||F.dyn_ltree[13*2]!==0)return r;for(ye=32;ye<h;ye++)if(F.dyn_ltree[ye*2]!==0)return r;return n}var ft=!1;function Pt(F){ft||(We(),ft=!0),F.l_desc=new se(F.dyn_ltree,V),F.d_desc=new se(F.dyn_dtree,Q),F.bl_desc=new se(F.bl_tree,ee),F.bi_buf=0,F.bi_valid=0,Ne(F)}function qt(F,X,ye,Fe){je(F,(a<<1)+(Fe?1:0),3),ge(F,X,ye)}function Lt(F){je(F,o<<1,3),De(F,k,W),Ce(F)}function en(F,X,ye,Fe){var we,Ie,fe=0;F.level>0?(F.strm.data_type===s&&(F.strm.data_type=Rt(F)),re(F,F.l_desc),re(F,F.d_desc),fe=ke(F),we=F.opt_len+3+7>>>3,Ie=F.static_len+3+7>>>3,Ie<=we&&(we=Ie)):we=Ie=ye+5,ye+4<=we&&X!==-1?qt(F,X,ye,Fe):F.strategy===t||Ie===we?(je(F,(o<<1)+(Fe?1:0),3),oe(F,W,P)):(je(F,(l<<1)+(Fe?1:0),3),lt(F,F.l_desc.max_code+1,F.d_desc.max_code+1,fe+1),oe(F,F.dyn_ltree,F.dyn_dtree)),Ne(F),Fe&&K(F)}function xe(F,X,ye){return F.pending_buf[F.d_buf+F.last_lit*2]=X>>>8&255,F.pending_buf[F.d_buf+F.last_lit*2+1]=X&255,F.pending_buf[F.l_buf+F.last_lit]=ye&255,F.last_lit++,X===0?F.dyn_ltree[ye*2]++:(F.matches++,X--,F.dyn_ltree[(U[ye]+h+1)*2]++,F.dyn_dtree[me(X)*2]++),F.last_lit===F.lit_bufsize-1}return Lp._tr_init=Pt,Lp._tr_stored_block=qt,Lp._tr_flush_block=en,Lp._tr_tally=xe,Lp._tr_align=Lt,Lp}var FM,L9;function EY(){if(L9)return FM;L9=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return FM=e,FM}var LM,B9;function TY(){if(B9)return LM;B9=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return LM=n,LM}var BM,$9;function iD(){return $9||($9=1,BM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),BM}var z9;function M2e(){if(z9)return oc;z9=1;var e=Gh(),t=N2e(),n=EY(),r=TY(),s=iD(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,m=-3,y=-5,b=-1,v=1,x=2,w=3,S=4,k=0,C=2,R=8,A=9,N=15,I=8,O=29,B=256,D=B+1+O,W=30,P=19,Z=2*D+1,U=15,H=3,L=258,ne=L+H+1,V=32,Q=42,ee=69,se=73,me=91,ce=103,je=113,De=666,Se=1,Ce=2,qe=3,Qe=4,We=3;function Ne($,ze){return $.msg=s[ze],ze}function K($){return($<<1)-($>4?9:0)}function ge($){for(var ze=$.length;--ze>=0;)$[ze]=0}function Ae($){var ze=$.state,st=ze.pending;st>$.avail_out&&(st=$.avail_out),st!==0&&(e.arraySet($.output,ze.pending_buf,ze.pending_out,st,$.next_out),$.next_out+=st,ze.pending_out+=st,$.total_out+=st,$.avail_out-=st,ze.pending-=st,ze.pending===0&&(ze.pending_out=0))}function le($,ze){t._tr_flush_block($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,ze),$.block_start=$.strstart,Ae($.strm)}function oe($,ze){$.pending_buf[$.pending++]=ze}function re($,ze){$.pending_buf[$.pending++]=ze>>>8&255,$.pending_buf[$.pending++]=ze&255}function Te($,ze,st,be){var _e=$.avail_in;return _e>be&&(_e=be),_e===0?0:($.avail_in-=_e,e.arraySet(ze,$.input,$.next_in,_e,st),$.state.wrap===1?$.adler=n($.adler,ze,_e,st):$.state.wrap===2&&($.adler=r($.adler,ze,_e,st)),$.next_in+=_e,$.total_in+=_e,_e)}function Be($,ze){var st=$.max_chain_length,be=$.strstart,_e,Ue,Et=$.prev_length,he=$.nice_match,Y=$.strstart>$.w_size-ne?$.strstart-($.w_size-ne):0,G=$.window,J=$.w_mask,ve=$.prev,Oe=$.strstart+L,Ke=G[be+Et-1],_t=G[be+Et];$.prev_length>=$.good_match&&(st>>=2),he>$.lookahead&&(he=$.lookahead);do if(_e=ze,!(G[_e+Et]!==_t||G[_e+Et-1]!==Ke||G[_e]!==G[be]||G[++_e]!==G[be+1])){be+=2,_e++;do;while(G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&G[++be]===G[++_e]&&be<Oe);if(Ue=L-(Oe-be),be=Oe-L,Ue>Et){if($.match_start=ze,Et=Ue,Ue>=he)break;Ke=G[be+Et-1],_t=G[be+Et]}}while((ze=ve[ze&J])>Y&&--st!==0);return Et<=$.lookahead?Et:$.lookahead}function ke($){var ze=$.w_size,st,be,_e,Ue,Et;do{if(Ue=$.window_size-$.lookahead-$.strstart,$.strstart>=ze+(ze-ne)){e.arraySet($.window,$.window,ze,ze,0),$.match_start-=ze,$.strstart-=ze,$.block_start-=ze,be=$.hash_size,st=be;do _e=$.head[--st],$.head[st]=_e>=ze?_e-ze:0;while(--be);be=ze,st=be;do _e=$.prev[--st],$.prev[st]=_e>=ze?_e-ze:0;while(--be);Ue+=ze}if($.strm.avail_in===0)break;if(be=Te($.strm,$.window,$.strstart+$.lookahead,Ue),$.lookahead+=be,$.lookahead+$.insert>=H)for(Et=$.strstart-$.insert,$.ins_h=$.window[Et],$.ins_h=($.ins_h<<$.hash_shift^$.window[Et+1])&$.hash_mask;$.insert&&($.ins_h=($.ins_h<<$.hash_shift^$.window[Et+H-1])&$.hash_mask,$.prev[Et&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=Et,Et++,$.insert--,!($.lookahead+$.insert<H)););}while($.lookahead<ne&&$.strm.avail_in!==0)}function lt($,ze){var st=65535;for(st>$.pending_buf_size-5&&(st=$.pending_buf_size-5);;){if($.lookahead<=1){if(ke($),$.lookahead===0&&ze===i)return Se;if($.lookahead===0)break}$.strstart+=$.lookahead,$.lookahead=0;var be=$.block_start+st;if(($.strstart===0||$.strstart>=be)&&($.lookahead=$.strstart-be,$.strstart=be,le($,!1),$.strm.avail_out===0)||$.strstart-$.block_start>=$.w_size-ne&&(le($,!1),$.strm.avail_out===0))return Se}return $.insert=0,ze===l?(le($,!0),$.strm.avail_out===0?qe:Qe):($.strstart>$.block_start&&(le($,!1),$.strm.avail_out===0),Se)}function Rt($,ze){for(var st,be;;){if($.lookahead<ne){if(ke($),$.lookahead<ne&&ze===i)return Se;if($.lookahead===0)break}if(st=0,$.lookahead>=H&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,st=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),st!==0&&$.strstart-st<=$.w_size-ne&&($.match_length=Be($,st)),$.match_length>=H)if(be=t._tr_tally($,$.strstart-$.match_start,$.match_length-H),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=H){$.match_length--;do $.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,st=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!==0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else be=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(be&&(le($,!1),$.strm.avail_out===0))return Se}return $.insert=$.strstart<H-1?$.strstart:H-1,ze===l?(le($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(le($,!1),$.strm.avail_out===0)?Se:Ce}function ft($,ze){for(var st,be,_e;;){if($.lookahead<ne){if(ke($),$.lookahead<ne&&ze===i)return Se;if($.lookahead===0)break}if(st=0,$.lookahead>=H&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,st=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=H-1,st!==0&&$.prev_length<$.max_lazy_match&&$.strstart-st<=$.w_size-ne&&($.match_length=Be($,st),$.match_length<=5&&($.strategy===v||$.match_length===H&&$.strstart-$.match_start>4096)&&($.match_length=H-1)),$.prev_length>=H&&$.match_length<=$.prev_length){_e=$.strstart+$.lookahead-H,be=t._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-H),$.lookahead-=$.prev_length-1,$.prev_length-=2;do++$.strstart<=_e&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+H-1])&$.hash_mask,st=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart);while(--$.prev_length!==0);if($.match_available=0,$.match_length=H-1,$.strstart++,be&&(le($,!1),$.strm.avail_out===0))return Se}else if($.match_available){if(be=t._tr_tally($,0,$.window[$.strstart-1]),be&&le($,!1),$.strstart++,$.lookahead--,$.strm.avail_out===0)return Se}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(be=t._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<H-1?$.strstart:H-1,ze===l?(le($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(le($,!1),$.strm.avail_out===0)?Se:Ce}function Pt($,ze){for(var st,be,_e,Ue,Et=$.window;;){if($.lookahead<=L){if(ke($),$.lookahead<=L&&ze===i)return Se;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=H&&$.strstart>0&&(_e=$.strstart-1,be=Et[_e],be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e])){Ue=$.strstart+L;do;while(be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e]&&be===Et[++_e]&&_e<Ue);$.match_length=L-(Ue-_e),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=H?(st=t._tr_tally($,1,$.match_length-H),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(st=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),st&&(le($,!1),$.strm.avail_out===0))return Se}return $.insert=0,ze===l?(le($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(le($,!1),$.strm.avail_out===0)?Se:Ce}function qt($,ze){for(var st;;){if($.lookahead===0&&(ke($),$.lookahead===0)){if(ze===i)return Se;break}if($.match_length=0,st=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,st&&(le($,!1),$.strm.avail_out===0))return Se}return $.insert=0,ze===l?(le($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(le($,!1),$.strm.avail_out===0)?Se:Ce}function Lt($,ze,st,be,_e){this.good_length=$,this.max_lazy=ze,this.nice_length=st,this.max_chain=be,this.func=_e}var en;en=[new Lt(0,0,0,0,lt),new Lt(4,4,8,4,Rt),new Lt(4,5,16,8,Rt),new Lt(4,6,32,32,Rt),new Lt(4,4,16,16,ft),new Lt(8,16,32,32,ft),new Lt(8,16,128,128,ft),new Lt(8,32,128,256,ft),new Lt(32,128,258,1024,ft),new Lt(32,258,258,4096,ft)];function xe($){$.window_size=2*$.w_size,ge($.head),$.max_lazy_match=en[$.level].max_lazy,$.good_match=en[$.level].good_length,$.nice_match=en[$.level].nice_length,$.max_chain_length=en[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=H-1,$.match_available=0,$.ins_h=0}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=R,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(Z*2),this.dyn_dtree=new e.Buf16((2*W+1)*2),this.bl_tree=new e.Buf16((2*P+1)*2),ge(this.dyn_ltree),ge(this.dyn_dtree),ge(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(U+1),this.heap=new e.Buf16(2*D+1),ge(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*D+1),ge(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X($){var ze;return!$||!$.state?Ne($,h):($.total_in=$.total_out=0,$.data_type=C,ze=$.state,ze.pending=0,ze.pending_out=0,ze.wrap<0&&(ze.wrap=-ze.wrap),ze.status=ze.wrap?Q:je,$.adler=ze.wrap===2?0:1,ze.last_flush=i,t._tr_init(ze),u)}function ye($){var ze=X($);return ze===u&&xe($.state),ze}function Fe($,ze){return!$||!$.state||$.state.wrap!==2?h:($.state.gzhead=ze,u)}function we($,ze,st,be,_e,Ue){if(!$)return h;var Et=1;if(ze===b&&(ze=6),be<0?(Et=0,be=-be):be>15&&(Et=2,be-=16),_e<1||_e>A||st!==R||be<8||be>15||ze<0||ze>9||Ue<0||Ue>S)return Ne($,h);be===8&&(be=9);var he=new F;return $.state=he,he.strm=$,he.wrap=Et,he.gzhead=null,he.w_bits=be,he.w_size=1<<he.w_bits,he.w_mask=he.w_size-1,he.hash_bits=_e+7,he.hash_size=1<<he.hash_bits,he.hash_mask=he.hash_size-1,he.hash_shift=~~((he.hash_bits+H-1)/H),he.window=new e.Buf8(he.w_size*2),he.head=new e.Buf16(he.hash_size),he.prev=new e.Buf16(he.w_size),he.lit_bufsize=1<<_e+6,he.pending_buf_size=he.lit_bufsize*4,he.pending_buf=new e.Buf8(he.pending_buf_size),he.d_buf=1*he.lit_bufsize,he.l_buf=3*he.lit_bufsize,he.level=ze,he.strategy=Ue,he.method=st,ye($)}function Ie($,ze){return we($,ze,R,N,I,k)}function fe($,ze){var st,be,_e,Ue;if(!$||!$.state||ze>c||ze<0)return $?Ne($,h):h;if(be=$.state,!$.output||!$.input&&$.avail_in!==0||be.status===De&&ze!==l)return Ne($,$.avail_out===0?y:h);if(be.strm=$,st=be.last_flush,be.last_flush=ze,be.status===Q)if(be.wrap===2)$.adler=0,oe(be,31),oe(be,139),oe(be,8),be.gzhead?(oe(be,(be.gzhead.text?1:0)+(be.gzhead.hcrc?2:0)+(be.gzhead.extra?4:0)+(be.gzhead.name?8:0)+(be.gzhead.comment?16:0)),oe(be,be.gzhead.time&255),oe(be,be.gzhead.time>>8&255),oe(be,be.gzhead.time>>16&255),oe(be,be.gzhead.time>>24&255),oe(be,be.level===9?2:be.strategy>=x||be.level<2?4:0),oe(be,be.gzhead.os&255),be.gzhead.extra&&be.gzhead.extra.length&&(oe(be,be.gzhead.extra.length&255),oe(be,be.gzhead.extra.length>>8&255)),be.gzhead.hcrc&&($.adler=r($.adler,be.pending_buf,be.pending,0)),be.gzindex=0,be.status=ee):(oe(be,0),oe(be,0),oe(be,0),oe(be,0),oe(be,0),oe(be,be.level===9?2:be.strategy>=x||be.level<2?4:0),oe(be,We),be.status=je);else{var Et=R+(be.w_bits-8<<4)<<8,he=-1;be.strategy>=x||be.level<2?he=0:be.level<6?he=1:be.level===6?he=2:he=3,Et|=he<<6,be.strstart!==0&&(Et|=V),Et+=31-Et%31,be.status=je,re(be,Et),be.strstart!==0&&(re(be,$.adler>>>16),re(be,$.adler&65535)),$.adler=1}if(be.status===ee)if(be.gzhead.extra){for(_e=be.pending;be.gzindex<(be.gzhead.extra.length&65535)&&!(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>_e&&($.adler=r($.adler,be.pending_buf,be.pending-_e,_e)),Ae($),_e=be.pending,be.pending===be.pending_buf_size));)oe(be,be.gzhead.extra[be.gzindex]&255),be.gzindex++;be.gzhead.hcrc&&be.pending>_e&&($.adler=r($.adler,be.pending_buf,be.pending-_e,_e)),be.gzindex===be.gzhead.extra.length&&(be.gzindex=0,be.status=se)}else be.status=se;if(be.status===se)if(be.gzhead.name){_e=be.pending;do{if(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>_e&&($.adler=r($.adler,be.pending_buf,be.pending-_e,_e)),Ae($),_e=be.pending,be.pending===be.pending_buf_size)){Ue=1;break}be.gzindex<be.gzhead.name.length?Ue=be.gzhead.name.charCodeAt(be.gzindex++)&255:Ue=0,oe(be,Ue)}while(Ue!==0);be.gzhead.hcrc&&be.pending>_e&&($.adler=r($.adler,be.pending_buf,be.pending-_e,_e)),Ue===0&&(be.gzindex=0,be.status=me)}else be.status=me;if(be.status===me)if(be.gzhead.comment){_e=be.pending;do{if(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>_e&&($.adler=r($.adler,be.pending_buf,be.pending-_e,_e)),Ae($),_e=be.pending,be.pending===be.pending_buf_size)){Ue=1;break}be.gzindex<be.gzhead.comment.length?Ue=be.gzhead.comment.charCodeAt(be.gzindex++)&255:Ue=0,oe(be,Ue)}while(Ue!==0);be.gzhead.hcrc&&be.pending>_e&&($.adler=r($.adler,be.pending_buf,be.pending-_e,_e)),Ue===0&&(be.status=ce)}else be.status=ce;if(be.status===ce&&(be.gzhead.hcrc?(be.pending+2>be.pending_buf_size&&Ae($),be.pending+2<=be.pending_buf_size&&(oe(be,$.adler&255),oe(be,$.adler>>8&255),$.adler=0,be.status=je)):be.status=je),be.pending!==0){if(Ae($),$.avail_out===0)return be.last_flush=-1,u}else if($.avail_in===0&&K(ze)<=K(st)&&ze!==l)return Ne($,y);if(be.status===De&&$.avail_in!==0)return Ne($,y);if($.avail_in!==0||be.lookahead!==0||ze!==i&&be.status!==De){var Y=be.strategy===x?qt(be,ze):be.strategy===w?Pt(be,ze):en[be.level].func(be,ze);if((Y===qe||Y===Qe)&&(be.status=De),Y===Se||Y===qe)return $.avail_out===0&&(be.last_flush=-1),u;if(Y===Ce&&(ze===a?t._tr_align(be):ze!==c&&(t._tr_stored_block(be,0,0,!1),ze===o&&(ge(be.head),be.lookahead===0&&(be.strstart=0,be.block_start=0,be.insert=0))),Ae($),$.avail_out===0))return be.last_flush=-1,u}return ze!==l?u:be.wrap<=0?d:(be.wrap===2?(oe(be,$.adler&255),oe(be,$.adler>>8&255),oe(be,$.adler>>16&255),oe(be,$.adler>>24&255),oe(be,$.total_in&255),oe(be,$.total_in>>8&255),oe(be,$.total_in>>16&255),oe(be,$.total_in>>24&255)):(re(be,$.adler>>>16),re(be,$.adler&65535)),Ae($),be.wrap>0&&(be.wrap=-be.wrap),be.pending!==0?u:d)}function vt($){var ze;return!$||!$.state?h:(ze=$.state.status,ze!==Q&&ze!==ee&&ze!==se&&ze!==me&&ze!==ce&&ze!==je&&ze!==De?Ne($,h):($.state=null,ze===je?Ne($,m):u))}function ot($,ze){var st=ze.length,be,_e,Ue,Et,he,Y,G,J;if(!$||!$.state||(be=$.state,Et=be.wrap,Et===2||Et===1&&be.status!==Q||be.lookahead))return h;for(Et===1&&($.adler=n($.adler,ze,st,0)),be.wrap=0,st>=be.w_size&&(Et===0&&(ge(be.head),be.strstart=0,be.block_start=0,be.insert=0),J=new e.Buf8(be.w_size),e.arraySet(J,ze,st-be.w_size,be.w_size,0),ze=J,st=be.w_size),he=$.avail_in,Y=$.next_in,G=$.input,$.avail_in=st,$.next_in=0,$.input=ze,ke(be);be.lookahead>=H;){_e=be.strstart,Ue=be.lookahead-(H-1);do be.ins_h=(be.ins_h<<be.hash_shift^be.window[_e+H-1])&be.hash_mask,be.prev[_e&be.w_mask]=be.head[be.ins_h],be.head[be.ins_h]=_e,_e++;while(--Ue);be.strstart=_e,be.lookahead=H-1,ke(be)}return be.strstart+=be.lookahead,be.block_start=be.strstart,be.insert=be.lookahead,be.lookahead=0,be.match_length=be.prev_length=H-1,be.match_available=0,$.next_in=Y,$.input=G,$.avail_in=he,be.wrap=Et,u}return oc.deflateInit=Ie,oc.deflateInit2=we,oc.deflateReset=ye,oc.deflateResetKeep=X,oc.deflateSetHeader=Fe,oc.deflate=fe,oc.deflateEnd=vt,oc.deflateSetDictionary=ot,oc.deflateInfo="pako deflate (from Nodeca project)",oc}var Bp={},U9;function AY(){if(U9)return Bp;U9=1;var e=Gh(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,Bp.string2buf=function(a){var o,l,c,u,d,h=a.length,m=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),m+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(m),d=0,u=0;d<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return Bp.buf2binstring=function(a){return i(a,a.length)},Bp.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},Bp.buf2string=function(a,o){var l,c,u,d,h=o||a.length,m=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){m[c++]=u;continue}if(d=r[u],d>4){m[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){m[c++]=65533;continue}u<65536?m[c++]=u:(u-=65536,m[c++]=55296|u>>10&1023,m[c++]=56320|u&1023)}return i(m,c)},Bp.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},Bp}var $M,q9;function RY(){if(q9)return $M;q9=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return $M=e,$M}var V9;function I2e(){if(V9)return Zg;V9=1;var e=M2e(),t=Gh(),n=AY(),r=iD(),s=RY(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,m=8;function y(w){if(!(this instanceof y))return new y(w);this.options=t.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(k!==l)throw new Error(r[k]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var C;if(typeof S.dictionary=="string"?C=n.string2buf(S.dictionary):i.call(S.dictionary)==="[object ArrayBuffer]"?C=new Uint8Array(S.dictionary):C=S.dictionary,k=e.deflateSetDictionary(this.strm,C),k!==l)throw new Error(r[k]);this._dict_set=!0}}y.prototype.push=function(w,S){var k=this.strm,C=this.options.chunkSize,R,A;if(this.ended)return!1;A=S===~~S?S:S===!0?o:a,typeof w=="string"?k.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?k.input=new Uint8Array(w):k.input=w,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new t.Buf8(C),k.next_out=0,k.avail_out=C),R=e.deflate(k,A),R!==c&&R!==l)return this.onEnd(R),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(A===o||A===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(k.output,k.next_out))):this.onData(t.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&R!==c);return A===o?(R=e.deflateEnd(this.strm),this.onEnd(R),this.ended=!0,R===l):(A===u&&(this.onEnd(l),k.avail_out=0),!0)},y.prototype.onData=function(w){this.chunks.push(w)},y.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,S){var k=new y(S);if(k.push(w,!0),k.err)throw k.msg||r[k.err];return k.result}function v(w,S){return S=S||{},S.raw=!0,b(w,S)}function x(w,S){return S=S||{},S.gzip=!0,b(w,S)}return Zg.Deflate=y,Zg.deflate=b,Zg.deflateRaw=v,Zg.gzip=x,Zg}var Xg={},Nl={},zM,W9;function j2e(){if(W9)return zM;W9=1;var e=30,t=12;return zM=function(r,s){var i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,R,A,N,I,O,B,D,W;i=r.state,a=r.next_in,D=r.input,o=a+(r.avail_in-5),l=r.next_out,W=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,m=i.whave,y=i.wnext,b=i.window,v=i.hold,x=i.bits,w=i.lencode,S=i.distcode,k=(1<<i.lenbits)-1,C=(1<<i.distbits)-1;e:do{x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),R=w[v&k];t:for(;;){if(A=R>>>24,v>>>=A,x-=A,A=R>>>16&255,A===0)W[l++]=R&65535;else if(A&16){N=R&65535,A&=15,A&&(x<A&&(v+=D[a++]<<x,x+=8),N+=v&(1<<A)-1,v>>>=A,x-=A),x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),R=S[v&C];n:for(;;){if(A=R>>>24,v>>>=A,x-=A,A=R>>>16&255,A&16){if(I=R&65535,A&=15,x<A&&(v+=D[a++]<<x,x+=8,x<A&&(v+=D[a++]<<x,x+=8)),I+=v&(1<<A)-1,I>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=A,x-=A,A=l-c,I>A){if(A=I-A,A>m&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(O=0,B=b,y===0){if(O+=h-A,A<N){N-=A;do W[l++]=b[O++];while(--A);O=l-I,B=W}}else if(y<A){if(O+=h+y-A,A-=y,A<N){N-=A;do W[l++]=b[O++];while(--A);if(O=0,y<N){A=y,N-=A;do W[l++]=b[O++];while(--A);O=l-I,B=W}}}else if(O+=y-A,A<N){N-=A;do W[l++]=b[O++];while(--A);O=l-I,B=W}for(;N>2;)W[l++]=B[O++],W[l++]=B[O++],W[l++]=B[O++],N-=3;N&&(W[l++]=B[O++],N>1&&(W[l++]=B[O++]))}else{O=l-I;do W[l++]=W[O++],W[l++]=W[O++],W[l++]=W[O++],N-=3;while(N>2);N&&(W[l++]=W[O++],N>1&&(W[l++]=W[O++]))}}else if((A&64)===0){R=S[(R&65535)+(v&(1<<A)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((A&64)===0){R=w[(R&65535)+(v&(1<<A)-1)];continue t}else if(A&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);N=x>>3,a-=N,x-=N<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},zM}var UM,H9;function P2e(){if(H9)return UM;H9=1;var e=Gh(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return UM=function(h,m,y,b,v,x,w,S){var k=S.bits,C=0,R=0,A=0,N=0,I=0,O=0,B=0,D=0,W=0,P=0,Z,U,H,L,ne,V=null,Q=0,ee,se=new e.Buf16(t+1),me=new e.Buf16(t+1),ce=null,je=0,De,Se,Ce;for(C=0;C<=t;C++)se[C]=0;for(R=0;R<b;R++)se[m[y+R]]++;for(I=k,N=t;N>=1&&se[N]===0;N--);if(I>N&&(I=N),N===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,S.bits=1,0;for(A=1;A<N&&se[A]===0;A++);for(I<A&&(I=A),D=1,C=1;C<=t;C++)if(D<<=1,D-=se[C],D<0)return-1;if(D>0&&(h===s||N!==1))return-1;for(me[1]=0,C=1;C<t;C++)me[C+1]=me[C]+se[C];for(R=0;R<b;R++)m[y+R]!==0&&(w[me[m[y+R]]++]=R);if(h===s?(V=ce=w,ee=19):h===i?(V=o,Q-=257,ce=l,je-=257,ee=256):(V=c,ce=u,ee=-1),P=0,R=0,C=A,ne=x,O=I,B=0,H=-1,W=1<<I,L=W-1,h===i&&W>n||h===a&&W>r)return 1;for(;;){De=C-B,w[R]<ee?(Se=0,Ce=w[R]):w[R]>ee?(Se=ce[je+w[R]],Ce=V[Q+w[R]]):(Se=96,Ce=0),Z=1<<C-B,U=1<<O,A=U;do U-=Z,v[ne+(P>>B)+U]=De<<24|Se<<16|Ce|0;while(U!==0);for(Z=1<<C-1;P&Z;)Z>>=1;if(Z!==0?(P&=Z-1,P+=Z):P=0,R++,--se[C]===0){if(C===N)break;C=m[y+w[R]]}if(C>I&&(P&L)!==H){for(B===0&&(B=I),ne+=A,O=C-B,D=1<<O;O+B<N&&(D-=se[O+B],!(D<=0));)O++,D<<=1;if(W+=1<<O,h===i&&W>n||h===a&&W>r)return 1;H=P&L,v[H]=I<<24|O<<16|ne-x|0}}return P!==0&&(v[ne+P]=C-B<<24|64<<16|0),S.bits=I,0},UM}var G9;function O2e(){if(G9)return Nl;G9=1;var e=Gh(),t=EY(),n=TY(),r=j2e(),s=P2e(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,m=2,y=-2,b=-3,v=-4,x=-5,w=8,S=1,k=2,C=3,R=4,A=5,N=6,I=7,O=8,B=9,D=10,W=11,P=12,Z=13,U=14,H=15,L=16,ne=17,V=18,Q=19,ee=20,se=21,me=22,ce=23,je=24,De=25,Se=26,Ce=27,qe=28,Qe=29,We=30,Ne=31,K=32,ge=852,Ae=592,le=15,oe=le;function re(we){return(we>>>24&255)+(we>>>8&65280)+((we&65280)<<8)+((we&255)<<24)}function Te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(we){var Ie;return!we||!we.state?y:(Ie=we.state,we.total_in=we.total_out=Ie.total=0,we.msg="",Ie.wrap&&(we.adler=Ie.wrap&1),Ie.mode=S,Ie.last=0,Ie.havedict=0,Ie.dmax=32768,Ie.head=null,Ie.hold=0,Ie.bits=0,Ie.lencode=Ie.lendyn=new e.Buf32(ge),Ie.distcode=Ie.distdyn=new e.Buf32(Ae),Ie.sane=1,Ie.back=-1,d)}function ke(we){var Ie;return!we||!we.state?y:(Ie=we.state,Ie.wsize=0,Ie.whave=0,Ie.wnext=0,Be(we))}function lt(we,Ie){var fe,vt;return!we||!we.state||(vt=we.state,Ie<0?(fe=0,Ie=-Ie):(fe=(Ie>>4)+1,Ie<48&&(Ie&=15)),Ie&&(Ie<8||Ie>15))?y:(vt.window!==null&&vt.wbits!==Ie&&(vt.window=null),vt.wrap=fe,vt.wbits=Ie,ke(we))}function Rt(we,Ie){var fe,vt;return we?(vt=new Te,we.state=vt,vt.window=null,fe=lt(we,Ie),fe!==d&&(we.state=null),fe):y}function ft(we){return Rt(we,oe)}var Pt=!0,qt,Lt;function en(we){if(Pt){var Ie;for(qt=new e.Buf32(512),Lt=new e.Buf32(32),Ie=0;Ie<144;)we.lens[Ie++]=8;for(;Ie<256;)we.lens[Ie++]=9;for(;Ie<280;)we.lens[Ie++]=7;for(;Ie<288;)we.lens[Ie++]=8;for(s(a,we.lens,0,288,qt,0,we.work,{bits:9}),Ie=0;Ie<32;)we.lens[Ie++]=5;s(o,we.lens,0,32,Lt,0,we.work,{bits:5}),Pt=!1}we.lencode=qt,we.lenbits=9,we.distcode=Lt,we.distbits=5}function xe(we,Ie,fe,vt){var ot,$=we.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new e.Buf8($.wsize)),vt>=$.wsize?(e.arraySet($.window,Ie,fe-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(ot=$.wsize-$.wnext,ot>vt&&(ot=vt),e.arraySet($.window,Ie,fe-vt,ot,$.wnext),vt-=ot,vt?(e.arraySet($.window,Ie,fe-vt,vt,0),$.wnext=vt,$.whave=$.wsize):($.wnext+=ot,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=ot))),0}function F(we,Ie){var fe,vt,ot,$,ze,st,be,_e,Ue,Et,he,Y,G,J,ve=0,Oe,Ke,_t,tn,zn,Xt,nn,un,yr=new e.Buf8(4),Rr,ns,rs=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!we||!we.state||!we.output||!we.input&&we.avail_in!==0)return y;fe=we.state,fe.mode===P&&(fe.mode=Z),ze=we.next_out,ot=we.output,be=we.avail_out,$=we.next_in,vt=we.input,st=we.avail_in,_e=fe.hold,Ue=fe.bits,Et=st,he=be,un=d;e:for(;;)switch(fe.mode){case S:if(fe.wrap===0){fe.mode=Z;break}for(;Ue<16;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(fe.wrap&2&&_e===35615){fe.check=0,yr[0]=_e&255,yr[1]=_e>>>8&255,fe.check=n(fe.check,yr,2,0),_e=0,Ue=0,fe.mode=k;break}if(fe.flags=0,fe.head&&(fe.head.done=!1),!(fe.wrap&1)||(((_e&255)<<8)+(_e>>8))%31){we.msg="incorrect header check",fe.mode=We;break}if((_e&15)!==w){we.msg="unknown compression method",fe.mode=We;break}if(_e>>>=4,Ue-=4,nn=(_e&15)+8,fe.wbits===0)fe.wbits=nn;else if(nn>fe.wbits){we.msg="invalid window size",fe.mode=We;break}fe.dmax=1<<nn,we.adler=fe.check=1,fe.mode=_e&512?D:P,_e=0,Ue=0;break;case k:for(;Ue<16;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(fe.flags=_e,(fe.flags&255)!==w){we.msg="unknown compression method",fe.mode=We;break}if(fe.flags&57344){we.msg="unknown header flags set",fe.mode=We;break}fe.head&&(fe.head.text=_e>>8&1),fe.flags&512&&(yr[0]=_e&255,yr[1]=_e>>>8&255,fe.check=n(fe.check,yr,2,0)),_e=0,Ue=0,fe.mode=C;case C:for(;Ue<32;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}fe.head&&(fe.head.time=_e),fe.flags&512&&(yr[0]=_e&255,yr[1]=_e>>>8&255,yr[2]=_e>>>16&255,yr[3]=_e>>>24&255,fe.check=n(fe.check,yr,4,0)),_e=0,Ue=0,fe.mode=R;case R:for(;Ue<16;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}fe.head&&(fe.head.xflags=_e&255,fe.head.os=_e>>8),fe.flags&512&&(yr[0]=_e&255,yr[1]=_e>>>8&255,fe.check=n(fe.check,yr,2,0)),_e=0,Ue=0,fe.mode=A;case A:if(fe.flags&1024){for(;Ue<16;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}fe.length=_e,fe.head&&(fe.head.extra_len=_e),fe.flags&512&&(yr[0]=_e&255,yr[1]=_e>>>8&255,fe.check=n(fe.check,yr,2,0)),_e=0,Ue=0}else fe.head&&(fe.head.extra=null);fe.mode=N;case N:if(fe.flags&1024&&(Y=fe.length,Y>st&&(Y=st),Y&&(fe.head&&(nn=fe.head.extra_len-fe.length,fe.head.extra||(fe.head.extra=new Array(fe.head.extra_len)),e.arraySet(fe.head.extra,vt,$,Y,nn)),fe.flags&512&&(fe.check=n(fe.check,vt,Y,$)),st-=Y,$+=Y,fe.length-=Y),fe.length))break e;fe.length=0,fe.mode=I;case I:if(fe.flags&2048){if(st===0)break e;Y=0;do nn=vt[$+Y++],fe.head&&nn&&fe.length<65536&&(fe.head.name+=String.fromCharCode(nn));while(nn&&Y<st);if(fe.flags&512&&(fe.check=n(fe.check,vt,Y,$)),st-=Y,$+=Y,nn)break e}else fe.head&&(fe.head.name=null);fe.length=0,fe.mode=O;case O:if(fe.flags&4096){if(st===0)break e;Y=0;do nn=vt[$+Y++],fe.head&&nn&&fe.length<65536&&(fe.head.comment+=String.fromCharCode(nn));while(nn&&Y<st);if(fe.flags&512&&(fe.check=n(fe.check,vt,Y,$)),st-=Y,$+=Y,nn)break e}else fe.head&&(fe.head.comment=null);fe.mode=B;case B:if(fe.flags&512){for(;Ue<16;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(_e!==(fe.check&65535)){we.msg="header crc mismatch",fe.mode=We;break}_e=0,Ue=0}fe.head&&(fe.head.hcrc=fe.flags>>9&1,fe.head.done=!0),we.adler=fe.check=0,fe.mode=P;break;case D:for(;Ue<32;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}we.adler=fe.check=re(_e),_e=0,Ue=0,fe.mode=W;case W:if(fe.havedict===0)return we.next_out=ze,we.avail_out=be,we.next_in=$,we.avail_in=st,fe.hold=_e,fe.bits=Ue,m;we.adler=fe.check=1,fe.mode=P;case P:if(Ie===c||Ie===u)break e;case Z:if(fe.last){_e>>>=Ue&7,Ue-=Ue&7,fe.mode=Ce;break}for(;Ue<3;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}switch(fe.last=_e&1,_e>>>=1,Ue-=1,_e&3){case 0:fe.mode=U;break;case 1:if(en(fe),fe.mode=ee,Ie===u){_e>>>=2,Ue-=2;break e}break;case 2:fe.mode=ne;break;case 3:we.msg="invalid block type",fe.mode=We}_e>>>=2,Ue-=2;break;case U:for(_e>>>=Ue&7,Ue-=Ue&7;Ue<32;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if((_e&65535)!==(_e>>>16^65535)){we.msg="invalid stored block lengths",fe.mode=We;break}if(fe.length=_e&65535,_e=0,Ue=0,fe.mode=H,Ie===u)break e;case H:fe.mode=L;case L:if(Y=fe.length,Y){if(Y>st&&(Y=st),Y>be&&(Y=be),Y===0)break e;e.arraySet(ot,vt,$,Y,ze),st-=Y,$+=Y,be-=Y,ze+=Y,fe.length-=Y;break}fe.mode=P;break;case ne:for(;Ue<14;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(fe.nlen=(_e&31)+257,_e>>>=5,Ue-=5,fe.ndist=(_e&31)+1,_e>>>=5,Ue-=5,fe.ncode=(_e&15)+4,_e>>>=4,Ue-=4,fe.nlen>286||fe.ndist>30){we.msg="too many length or distance symbols",fe.mode=We;break}fe.have=0,fe.mode=V;case V:for(;fe.have<fe.ncode;){for(;Ue<3;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}fe.lens[rs[fe.have++]]=_e&7,_e>>>=3,Ue-=3}for(;fe.have<19;)fe.lens[rs[fe.have++]]=0;if(fe.lencode=fe.lendyn,fe.lenbits=7,Rr={bits:fe.lenbits},un=s(i,fe.lens,0,19,fe.lencode,0,fe.work,Rr),fe.lenbits=Rr.bits,un){we.msg="invalid code lengths set",fe.mode=We;break}fe.have=0,fe.mode=Q;case Q:for(;fe.have<fe.nlen+fe.ndist;){for(;ve=fe.lencode[_e&(1<<fe.lenbits)-1],Oe=ve>>>24,Ke=ve>>>16&255,_t=ve&65535,!(Oe<=Ue);){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(_t<16)_e>>>=Oe,Ue-=Oe,fe.lens[fe.have++]=_t;else{if(_t===16){for(ns=Oe+2;Ue<ns;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(_e>>>=Oe,Ue-=Oe,fe.have===0){we.msg="invalid bit length repeat",fe.mode=We;break}nn=fe.lens[fe.have-1],Y=3+(_e&3),_e>>>=2,Ue-=2}else if(_t===17){for(ns=Oe+3;Ue<ns;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}_e>>>=Oe,Ue-=Oe,nn=0,Y=3+(_e&7),_e>>>=3,Ue-=3}else{for(ns=Oe+7;Ue<ns;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}_e>>>=Oe,Ue-=Oe,nn=0,Y=11+(_e&127),_e>>>=7,Ue-=7}if(fe.have+Y>fe.nlen+fe.ndist){we.msg="invalid bit length repeat",fe.mode=We;break}for(;Y--;)fe.lens[fe.have++]=nn}}if(fe.mode===We)break;if(fe.lens[256]===0){we.msg="invalid code -- missing end-of-block",fe.mode=We;break}if(fe.lenbits=9,Rr={bits:fe.lenbits},un=s(a,fe.lens,0,fe.nlen,fe.lencode,0,fe.work,Rr),fe.lenbits=Rr.bits,un){we.msg="invalid literal/lengths set",fe.mode=We;break}if(fe.distbits=6,fe.distcode=fe.distdyn,Rr={bits:fe.distbits},un=s(o,fe.lens,fe.nlen,fe.ndist,fe.distcode,0,fe.work,Rr),fe.distbits=Rr.bits,un){we.msg="invalid distances set",fe.mode=We;break}if(fe.mode=ee,Ie===u)break e;case ee:fe.mode=se;case se:if(st>=6&&be>=258){we.next_out=ze,we.avail_out=be,we.next_in=$,we.avail_in=st,fe.hold=_e,fe.bits=Ue,r(we,he),ze=we.next_out,ot=we.output,be=we.avail_out,$=we.next_in,vt=we.input,st=we.avail_in,_e=fe.hold,Ue=fe.bits,fe.mode===P&&(fe.back=-1);break}for(fe.back=0;ve=fe.lencode[_e&(1<<fe.lenbits)-1],Oe=ve>>>24,Ke=ve>>>16&255,_t=ve&65535,!(Oe<=Ue);){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(Ke&&(Ke&240)===0){for(tn=Oe,zn=Ke,Xt=_t;ve=fe.lencode[Xt+((_e&(1<<tn+zn)-1)>>tn)],Oe=ve>>>24,Ke=ve>>>16&255,_t=ve&65535,!(tn+Oe<=Ue);){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}_e>>>=tn,Ue-=tn,fe.back+=tn}if(_e>>>=Oe,Ue-=Oe,fe.back+=Oe,fe.length=_t,Ke===0){fe.mode=Se;break}if(Ke&32){fe.back=-1,fe.mode=P;break}if(Ke&64){we.msg="invalid literal/length code",fe.mode=We;break}fe.extra=Ke&15,fe.mode=me;case me:if(fe.extra){for(ns=fe.extra;Ue<ns;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}fe.length+=_e&(1<<fe.extra)-1,_e>>>=fe.extra,Ue-=fe.extra,fe.back+=fe.extra}fe.was=fe.length,fe.mode=ce;case ce:for(;ve=fe.distcode[_e&(1<<fe.distbits)-1],Oe=ve>>>24,Ke=ve>>>16&255,_t=ve&65535,!(Oe<=Ue);){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if((Ke&240)===0){for(tn=Oe,zn=Ke,Xt=_t;ve=fe.distcode[Xt+((_e&(1<<tn+zn)-1)>>tn)],Oe=ve>>>24,Ke=ve>>>16&255,_t=ve&65535,!(tn+Oe<=Ue);){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}_e>>>=tn,Ue-=tn,fe.back+=tn}if(_e>>>=Oe,Ue-=Oe,fe.back+=Oe,Ke&64){we.msg="invalid distance code",fe.mode=We;break}fe.offset=_t,fe.extra=Ke&15,fe.mode=je;case je:if(fe.extra){for(ns=fe.extra;Ue<ns;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}fe.offset+=_e&(1<<fe.extra)-1,_e>>>=fe.extra,Ue-=fe.extra,fe.back+=fe.extra}if(fe.offset>fe.dmax){we.msg="invalid distance too far back",fe.mode=We;break}fe.mode=De;case De:if(be===0)break e;if(Y=he-be,fe.offset>Y){if(Y=fe.offset-Y,Y>fe.whave&&fe.sane){we.msg="invalid distance too far back",fe.mode=We;break}Y>fe.wnext?(Y-=fe.wnext,G=fe.wsize-Y):G=fe.wnext-Y,Y>fe.length&&(Y=fe.length),J=fe.window}else J=ot,G=ze-fe.offset,Y=fe.length;Y>be&&(Y=be),be-=Y,fe.length-=Y;do ot[ze++]=J[G++];while(--Y);fe.length===0&&(fe.mode=se);break;case Se:if(be===0)break e;ot[ze++]=fe.length,be--,fe.mode=se;break;case Ce:if(fe.wrap){for(;Ue<32;){if(st===0)break e;st--,_e|=vt[$++]<<Ue,Ue+=8}if(he-=be,we.total_out+=he,fe.total+=he,he&&(we.adler=fe.check=fe.flags?n(fe.check,ot,he,ze-he):t(fe.check,ot,he,ze-he)),he=be,(fe.flags?_e:re(_e))!==fe.check){we.msg="incorrect data check",fe.mode=We;break}_e=0,Ue=0}fe.mode=qe;case qe:if(fe.wrap&&fe.flags){for(;Ue<32;){if(st===0)break e;st--,_e+=vt[$++]<<Ue,Ue+=8}if(_e!==(fe.total&4294967295)){we.msg="incorrect length check",fe.mode=We;break}_e=0,Ue=0}fe.mode=Qe;case Qe:un=h;break e;case We:un=b;break e;case Ne:return v;case K:default:return y}return we.next_out=ze,we.avail_out=be,we.next_in=$,we.avail_in=st,fe.hold=_e,fe.bits=Ue,(fe.wsize||he!==we.avail_out&&fe.mode<We&&(fe.mode<Ce||Ie!==l))&&xe(we,we.output,we.next_out,he-we.avail_out),Et-=we.avail_in,he-=we.avail_out,we.total_in+=Et,we.total_out+=he,fe.total+=he,fe.wrap&&he&&(we.adler=fe.check=fe.flags?n(fe.check,ot,he,we.next_out-he):t(fe.check,ot,he,we.next_out-he)),we.data_type=fe.bits+(fe.last?64:0)+(fe.mode===P?128:0)+(fe.mode===ee||fe.mode===H?256:0),(Et===0&&he===0||Ie===l)&&un===d&&(un=x),un}function X(we){if(!we||!we.state)return y;var Ie=we.state;return Ie.window&&(Ie.window=null),we.state=null,d}function ye(we,Ie){var fe;return!we||!we.state||(fe=we.state,(fe.wrap&2)===0)?y:(fe.head=Ie,Ie.done=!1,d)}function Fe(we,Ie){var fe=Ie.length,vt,ot,$;return!we||!we.state||(vt=we.state,vt.wrap!==0&&vt.mode!==W)?y:vt.mode===W&&(ot=1,ot=t(ot,Ie,fe,0),ot!==vt.check)?b:($=xe(we,Ie,fe,fe),$?(vt.mode=Ne,v):(vt.havedict=1,d))}return Nl.inflateReset=ke,Nl.inflateReset2=lt,Nl.inflateResetKeep=Be,Nl.inflateInit=ft,Nl.inflateInit2=Rt,Nl.inflate=F,Nl.inflateEnd=X,Nl.inflateGetHeader=ye,Nl.inflateSetDictionary=Fe,Nl.inflateInfo="pako inflate (from Nodeca project)",Nl}var qM,K9;function NY(){return K9||(K9=1,qM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),qM}var VM,Y9;function D2e(){if(Y9)return VM;Y9=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return VM=e,VM}var Z9;function F2e(){if(Z9)return Xg;Z9=1;var e=O2e(),t=Gh(),n=AY(),r=NY(),s=iD(),i=RY(),a=D2e(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,h.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(m=e.inflateSetDictionary(this.strm,h.dictionary),m!==r.Z_OK)))throw new Error(s[m])}l.prototype.push=function(d,h){var m=this.strm,y=this.options.chunkSize,b=this.options.dictionary,v,x,w,S,k,C=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?m.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?m.input=new Uint8Array(d):m.input=d,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new t.Buf8(y),m.next_out=0,m.avail_out=y),v=e.inflate(m,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&b&&(v=e.inflateSetDictionary(this.strm,b)),v===r.Z_BUF_ERROR&&C===!0&&(v=r.Z_OK,C=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;m.next_out&&(m.avail_out===0||v===r.Z_STREAM_END||m.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(m.output,m.next_out),S=m.next_out-w,k=n.buf2string(m.output,w),m.next_out=S,m.avail_out=y-S,S&&t.arraySet(m.output,m.output,w,S,0),this.onData(k)):this.onData(t.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(C=!0)}while((m.avail_in>0||m.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),m.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var m=new l(h);if(m.push(d,!0),m.err)throw m.msg||s[m.err];return m.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return Xg.Inflate=l,Xg.inflate=c,Xg.inflateRaw=u,Xg.ungzip=c,Xg}var WM,X9;function L2e(){if(X9)return WM;X9=1;var e=Gh().assign,t=I2e(),n=F2e(),r=NY(),s={};return e(s,t,n,r),WM=s,WM}var B2e=L2e();const aD=Sa(B2e);var HM,J9;function $2e(){if(J9)return HM;J9=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return HM=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},HM}var z2e=$2e();const GM=Sa(z2e);var KM,Q9;function U2e(){if(Q9)return KM;Q9=1;var e={};function t(H){return Array.isArray(H)?H:[H]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const m=h,y=(H,L,ne)=>Object.defineProperty(H,L,{value:ne}),b=/([0-z])-([0-z])/g,v=()=>!1,x=H=>H.replace(b,(L,ne,V)=>ne.charCodeAt(0)<=V.charCodeAt(0)?L:n),w=H=>{const{length:L}=H;return H.slice(0,L-L%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(H,L,ne)=>L+(ne.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(H,L)=>{const{length:ne}=L;return L.slice(0,ne-ne%2)+r}],[/[\\$.|*+(){^]/g,H=>`\\${H}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(H,L,ne)=>L+6<ne.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(H,L,ne)=>{const V=ne.replace(/\\\*/g,"[^\\/]*");return L+V}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(H,L,ne,V,Q)=>L===s?`\\[${ne}${w(V)}${Q}`:Q==="]"&&V.length%2===0?`[${x(ne)}${V}]`:"[]"],[/(?:[^*])$/,H=>/\/$/.test(H)?`${H}$`:`${H}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(H,L)=>`${L?`${L}[^/]+`:"[^/]*"}(?=$|\\/$)`]],k=Object.create(null),C=(H,L)=>{let ne=k[H];return ne||(ne=S.reduce((V,[Q,ee])=>V.replace(Q,ee.bind(H)),H),k[H]=ne),L?new RegExp(ne,"i"):new RegExp(ne)},R=H=>typeof H=="string",A=H=>H&&R(H)&&!i.test(H)&&!a.test(H)&&H.indexOf("#")!==0,N=H=>H.split(c);class I{constructor(L,ne,V,Q){this.origin=L,this.pattern=ne,this.negative=V,this.regex=Q}}const O=(H,L)=>{const ne=H;let V=!1;H.indexOf("!")===0&&(V=!0,H=H.substr(1)),H=H.replace(o,"!").replace(l,"#");const Q=C(H,L);return new I(ne,H,V,Q)},B=(H,L)=>{throw new L(H)},D=(H,L,ne)=>R(H)?H?D.isNotRelative(H)?ne(`path should be a \`path.relative()\`d string, but got "${L}"`,RangeError):!0:ne("path must not be empty",TypeError):ne(`path must be a string, but got \`${L}\``,TypeError),W=H=>u.test(H);D.isNotRelative=W,D.convert=H=>H;class P{constructor({ignorecase:L=!0,ignoreCase:ne=L,allowRelativePaths:V=!1}={}){y(this,m,!0),this._rules=[],this._ignoreCase=ne,this._allowRelativePaths=V,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(L){if(L&&L[m]){this._rules=this._rules.concat(L._rules),this._added=!0;return}if(A(L)){const ne=O(L,this._ignoreCase);this._added=!0,this._rules.push(ne)}}add(L){return this._added=!1,t(R(L)?N(L):L).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(L){return this.add(L)}_testOne(L,ne){let V=!1,Q=!1;return this._rules.forEach(ee=>{const{negative:se}=ee;if(Q===se&&V!==Q||se&&!V&&!Q&&!ne)return;ee.regex.test(L)&&(V=!se,Q=se)}),{ignored:V,unignored:Q}}_test(L,ne,V,Q){const ee=L&&D.convert(L);return D(ee,L,this._allowRelativePaths?v:B),this._t(ee,ne,V,Q)}_t(L,ne,V,Q){if(L in ne)return ne[L];if(Q||(Q=L.split(d)),Q.pop(),!Q.length)return ne[L]=this._testOne(L,V);const ee=this._t(Q.join(d)+d,ne,V,Q);return ne[L]=ee.ignored?ee:this._testOne(L,V)}ignores(L){return this._test(L,this._ignoreCache,!1).ignored}createFilter(){return L=>!this.ignores(L)}filter(L){return t(L).filter(this.createFilter())}test(L){return this._test(L,this._testCache,!0)}}const Z=H=>new P(H),U=H=>D(H&&D.convert(H),H,v);if(Z.isPathValid=U,Z.default=Z,KM=Z,typeof Ni<"u"&&(e&&e.IGNORE_TEST_WIN32||Ni.platform==="win32")){const H=ne=>/^\\\\\?\\/.test(ne)||/["<>|\u0000-\u001F]+/u.test(ne)?ne:ne.replace(/\\/g,"/");D.convert=H;const L=/^[a-z]:\//i;D.isNotRelative=ne=>L.test(ne)||W(ne)}return KM}var q2e=U2e();const V2e=Sa(q2e);var YM,ez;function W2e(){if(ez)return YM;ez=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return YM=n,YM}var H2e=W2e();const yu=Sa(H2e);var ZM,tz;function G2e(){return tz||(tz=1,ZM=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",m=-1,y=0,b=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},S=function(A,N,I){return{x:A,y:N,k:I}},k=function(A,N){return{elem:A,t:N}},C=function(A,N,I){var O,B,D;for(N>I?O=c[A-1+l]:O=c[A+1+l],D=Math.max(N,I),B=D-A;B<s&&D<i&&n[B]===r[D];)++B,++D;return c[A+l]=u.length,u[u.length]=new S(B,D,O),D},R=function(A){var N,I,O;for(N=I=0,O=A.length-1;O>=0;--O)for(;N<A[O].x||I<A[O].y;)A[O].y-A[O].x>I-N?(a?d[d.length]=new k(r[I],m):d[d.length]=new k(r[I],b),++I):A[O].y-A[O].x<I-N?(a?d[d.length]=new k(n[N],b):d[d.length]=new k(n[N],m),++N):(d[d.length]=new k(n[N],y),h+=n[N],++N,++I)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var A,N,I,O,B,D,W,P;for(A=i-s,N=s+i+3,I={},W=0;W<N;++W)I[W]=-1,c[W]=-1;O=-1;do{for(++O,P=-O;P<=A-1;++P)I[P+l]=C(P,I[P-1+l]+1,I[P+1+l]);for(P=A+O;P>=A+1;--P)I[P+l]=C(P,I[P-1+l]+1,I[P+1+l]);I[A+l]=C(A,I[A-1+l]+1,I[A+1+l])}while(I[A+l]!==i);for(o=A+2*O,B=c[A+l],D=[];B!==-1;)D[D.length]=new S(u[B].x,u[B].y,null),B=u[B].k;R(D)}}}),ZM}var XM,nz;function K2e(){if(nz)return XM;nz=1;var e=G2e();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,m=l.length-1;m>=0;--m)l[m].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[m].t===o.SES_DELETE?d--:l[m].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h(L,ne){d.push([L.file1[0],ne,L.file1[1],L.file2[0],L.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function(L,ne){return L[0]-ne[0]});var m=[],y=0;function b(L){L>y&&(m.push([1,y,L-y]),y=L)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],S=w[0],k=S+w[2];v<d.length-1;){var C=d[v+1],R=C[0];if(R>k)break;k=Math.max(k,R+C[2]),v++}if(b(S),x==v)w[4]>0&&m.push([w[1],w[3],w[4]]);else{var A={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var N=w[1],I=A[N],O=w[0],B=O+w[2],D=w[3],W=D+w[4];I[0]=Math.min(D,I[0]),I[1]=Math.max(W,I[1]),I[2]=Math.min(O,I[2]),I[3]=Math.max(B,I[3])}var P=A[0][0]+(S-A[0][2]),Z=A[0][1]+(k-A[0][3]),U=A[2][0]+(S-A[2][2]),H=A[2][1]+(k-A[2][3]);m.push([-1,P,Z-P,S,k-S,U,H-U])}y=k}return b(a.length),m}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function m(w){for(var S=0;S<w.length;S++)d.push(w[S])}function y(w){if(w[2]!=w[6])return!0;for(var S=w[1],k=w[5],C=0;C<w[2];C++)if(i[C+S]!=o[C+k])return!0;return!1}for(var b=0;b<u.length;b++){var v=u[b],x=v[0];x==-1?y(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):m(c[0].slice(v[1],v[1]+v[2])):m(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return XM=s,XM}var Y2e=K2e();const Z2e=Sa(Y2e);class Jr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new Jr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class k1 extends Jr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=k1.code,this.data={filepaths:t}}}k1.code="UnmergedPathsError";class vr extends Jr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=vr.code,this.data={message:t}}}vr.code="InternalError";class Xy extends Jr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=Xy.code,this.data={filepath:t}}}Xy.code="UnsafeFilepathError";class pu{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function eT(e,t){return-(e<t)||+(e>t)}function MY(e,t){return eT(e.path,t.path)}function IY(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const tu=2**32;function rz(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function oy(e){const[t,n]=rz(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=rz(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%tu,ctimeNanoseconds:n%tu,mtimeSeconds:r%tu,mtimeNanoseconds:s%tu,dev:e.dev%tu,ino:e.ino%tu,mode:IY(e.mode%tu),uid:e.uid%tu,gid:e.gid%tu,size:e.size>-1?e.size%tu:0}}function X2e(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let JM=null;async function Kd(e){return JM===null&&(JM=await Q2e()),JM?jY(e):J2e(e)}function J2e(e){return new kY().update(e).digest("hex")}async function jY(e){const t=await crypto.subtle.digest("SHA-1",e);return X2e(t)}async function Q2e(){try{if(await jY(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function eCe(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function tCe(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(ln.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class Xp{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(ln.isBuffer(t))return Xp.fromBuffer(t);if(t===null)return new Xp(null);throw new vr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new vr("Index file is empty (.git/index)");const n=new Xp,r=new pu(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new vr(`Invalid dircache magic file number: ${s}`);const i=await Kd(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new vr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new vr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=eCe(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new vr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new Xy(u.path);let m=8-(r.tell()-12)%8;for(m===0&&(m=8);m--;){const y=r.readUInt8();if(y!==0)throw new vr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new vr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(MY)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=oy(n);const i=ln.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=ln.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=ln.alloc(r),i=new pu(s),a=oy(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(tCe(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=ln.alloc(12),n=new pu(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(Xp._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(Xp._entryToBuffer(l));r=await Promise.all(r);const s=ln.concat(r),i=ln.concat([t,s]),a=await Kd(i);return ln.concat([i,ln.from(a,"hex")])}}function HC(e,t,n=!0,r=!0){const s=oy(e),i=oy(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let QM=null;const eI=Symbol("IndexCache");function nCe(){return{map:new Map,stats:new Map}}async function rCe(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await Xp.from(s);n.map.set(t,i),n.stats.set(t,r)}async function sCe(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:HC(r,s)}class la{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[eI]||(r[eI]=nCe());const a=`${n}/index`;QM===null&&(QM=new fw({maxPending:1/0}));let o,l=[];return await QM.acquire(a,async()=>{const c=r[eI];await sCe(t,a,c)&&await rCe(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new k1(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function GC(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function ly(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function PY(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:GC(s),metadata:{},children:[]};t.set(s,i),i.parent=n(ly(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:GC(s),metadata:i,parent:n(ly(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function iCe(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class aCe{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=la.acquire({fs:t,gitdir:n,cache:r},async function(i){return PY(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(eT),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:oy(r.metadata);t._type=r.type==="tree"?"tree":iCe(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const tT=Symbol("GitWalkSymbol");function Jy(){const e=Object.create(null);return Object.defineProperty(e,tT,{value:function({fs:t,gitdir:n,cache:r}){return new aCe({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class As extends Jr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=As.code,this.data={what:t}}}As.code="NotFoundError";class uo extends Jr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=uo.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}uo.code="ObjectTypeError";class Ch extends Jr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Ch.code,this.data={value:t}}}Ch.code="InvalidOidError";class E1 extends Jr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=E1.code,this.data={remote:t}}}E1.code="NoRefspecError";class KC{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new KC(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class YC{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new vr("Invalid refspec");return new YC({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class oD{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(YC.from(r));return new oD(n)}add(t){const n=YC.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function oCe(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const lCe=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},jv=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},sz={core:{filemode:jv,bare:jv,logallrefupdates:jv,symlinks:jv,ignorecase:jv,bigFileThreshold:lCe}},cCe=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,uCe=/^[A-Za-z0-9-.]+$/,dCe=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,fCe=/^[A-Za-z][A-Za-z-]*$/,hCe=/^(.*?)( *[#;].*)$/,pCe=e=>{const t=cCe.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},mCe=e=>{const t=dCe.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=gCe(r),i=yCe(s);return[n,i]}return null},gCe=e=>{const t=hCe.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return iz(n)&&iz(r)?`${n}${r}`:n},iz=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,yCe=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),az=e=>e!=null?e.toLowerCase():null,Mj=(e,t,n)=>[az(e),t,az(n)].filter(r=>r!=null).join("."),oz=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:Mj(n,s,r),sectionPath:Mj(n,s,null),isSection:!!n}},bCe=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class lD{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=pCe(o),c=l!=null;if(c)[n,r]=l;else{const d=mCe(o);d!=null&&([i,a]=d)}const u=Mj(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new lD(t)}async get(t,n=!1){const r=oz(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=sz[i]&&sz[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=oz(t),u=bCe(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(m=>m.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(uCe.test(s)&&fCe.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const m={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(m,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class ji{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return lD.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const zS=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],vCe=["config","description","index","shallow","commondir"];let tI;async function Zf(e,t){return tI===void 0&&(tI=new fw),tI.acquire(e,t)}class Kt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new Ch(v);const u=await ji.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new E1(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=oD.from(o),h=new Map;if(c){const v=await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Kt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Kt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const m=d.translate([...s.keys()]);for(const[v,x]of m){const w=s.get(v);h.set(x,w)}const y=d.translate([...i.keys()]);for(const[v,x]of y){const w=i.get(v),S=d.translateOne(w);S&&h.set(x,`ref: ${S}`)}const b=[];if(l){for(const v of d.localNamespaces()){const x=(await Kt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||b.push(w)}b.length>0&&await Kt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[v,x]of h)await Zf(v,async()=>t.write($t.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new Ch(s);await Zf(r,async()=>t.write($t.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await Zf(r,async()=>t.write($t.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Kt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm($t.join(n,o))));let s=await Zf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=KC.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await Zf("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Kt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Kt.packedRefs({fs:t,gitdir:n}),a=zS(r).filter(o=>!vCe.includes(o));for(const o of a){const l=await Zf(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Kt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new As(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Kt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Kt.packedRefs({fs:t,gitdir:n}),i=zS(r);for(const a of i)if(await Zf(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new As(r)}static async expandAgainstMap({ref:t,map:n}){const r=zS(t);for(const s of r)if(await n.has(s))return s;throw new As(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Kt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=zS(t);for(const a of i){const o=s.get(a);if(o)return Kt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new As(t)}static async packedRefs({fs:t,gitdir:n}){const r=await Zf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return KC.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Kt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(oCe),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Kt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Kt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Kt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function xCe(e,t){return eT(lz(e),lz(t))}function lz(e){return e.mode==="040000"?e.path+"/":e.path}function OY(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new vr(`Unexpected GitTree entry mode: ${e}`)}function wCe(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new vr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=OY(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new Xy(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function _Ce(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new vr(`Could not understand file mode: ${e}`)}function SCe(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=_Ce(e.mode),e.type||(e.type=OY(e.mode)),e}class Oo{constructor(t){if(ln.isBuffer(t))this._entries=wCe(t);else if(Array.isArray(t))this._entries=t.map(SCe);else throw new vr("invalid type passed to GitTree constructor");this._entries.sort(MY)}static from(t){return new Oo(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(xCe),ln.concat(t.map(n=>{const r=ln.from(n.mode.replace(/^0/,"")),s=ln.from(" "),i=ln.from(n.path,"utf8"),a=ln.from([0]),o=ln.from(n.oid,"hex");return ln.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class Qy{static wrap({type:t,object:n}){return ln.concat([ln.from(`${t} ${n.byteLength.toString()}\0`),ln.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new vr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:ln.from(t.slice(r+1))}}}async function DY({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function CCe(e,t){const n=new pu(e),r=cz(n);if(r!==t.byteLength)throw new vr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=cz(n);let i;const a=dz(n,t);if(a.byteLength===s)i=a;else{i=ln.alloc(s);const o=new pu(i);for(o.copy(a);!n.eof();)o.copy(dz(n,t));const l=o.tell();if(s!==l)throw new vr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function cz(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function uz(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function dz(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=uz(e,n&s,4);let o=uz(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function kCe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function FY(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:kCe(e)}class LY{constructor(t){if(typeof ln>"u")throw new Error("Missing Buffer dependency");this.stream=FY(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?ln.alloc(0):(n&&(n=ln.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>ECe(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=ln.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function ECe(e){return e.reduce((t,n)=>t+n.length,0)}async function TCe(e,t){const n=new LY(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new vr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new vr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await ACe(n),d=new aD.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new vr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new vr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const m=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:m,reference:u,ofs:c})}}}}async function ACe(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=ln.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function BY(e){return aD.inflate(e)}function RCe(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function NCe(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class cy{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new pu(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new vr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new vr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new cy({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await TCe([t],async({data:v,type:x,reference:w,offset:S,num:k})=>{u===null&&(u=k);const C=Math.floor((u-k)*100/u);C!==d&&r&&await r({phase:"Receiving objects",loaded:u-k,total:u}),d=C,x=s[x],["commit","tree","blob","tag"].includes(x)?i[S]={type:x,offset:S}:x==="ofs-delta"?i[S]={type:x,offset:S}:x==="ref-delta"&&(i[S]={type:x,offset:S})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],S=i[x],k=R2e.buf(t.slice(x,w))>>>0;S.end=w,S.crc=k}const m=new cy({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(y*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=x;const w=i[v];if(!w.oid)try{m.readDepth=0,m.externalReadDepth=0;const{type:S,object:k}=await m.readSlice({start:v});b[m.readDepth]+=1;const C=await Kd(Qy.wrap({type:S,object:k}));w.oid=C,o.push(C),c.set(C,v),l[C]=w.crc}catch{continue}}return o.sort(),m}async toBuffer(){const t=[],n=(c,u)=>{t.push(ln.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new pu(ln.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new pu(ln.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new pu(ln.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=ln.concat(t),o=await Kd(a),l=ln.alloc(20);return l.write(o,"hex"),ln.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new vr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new vr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new pu(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new vr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=NCe(s,l));let d=null,h=null;if(o==="ofs_delta"){const y=RCe(s),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const m=r.slice(s.tell());if(h=ln.from(await BY(m)),h.byteLength!==c)throw new vr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=ln.from(CCe(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const US=Symbol("PackfileCache");async function MCe({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return cy.fromIdx({idx:i,getExternalRefDelta:n})}function cD({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[US]||(t[US]=new Map);let a=t[US].get(n);return a||(a=MCe({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[US].set(n,a)),a}async function ICe({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await cD({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new vr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Zs({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>Zs({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:ln.from("tree 0\0")}),a||(a=await DY({fs:e,gitdir:n,oid:r})),!a){if(a=await ICe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new As(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=ln.from(await BY(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await Kd(a.object);if(o!==r)throw new vr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=Qy.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new vr(`invalid requested format "${s}"`)}class Fc extends Jr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Fc.code,this.data={noun:t,where:n,canForce:r}}}Fc.code="AlreadyExistsError";class T1 extends Jr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=T1.code,this.data={nouns:t,short:n,matches:r}}}T1.code="AmbiguousError";class A1 extends Jr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=A1.code,this.data={filepaths:t}}}A1.code="CheckoutConflictError";class R1 extends Jr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=R1.code,this.data={ref:t,oid:n}}}R1.code="CommitNotFetchedError";class N1 extends Jr{constructor(){super("Empty response from git server."),this.code=this.name=N1.code,this.data={}}}N1.code="EmptyServerResponseError";class M1 extends Jr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=M1.code,this.data={}}}M1.code="FastForwardError";class I1 extends Jr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=I1.code,this.data={prettyDetails:t,result:n}}}I1.code="GitPushError";class uy extends Jr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=uy.code,this.data={statusCode:t,statusMessage:n,response:r}}}uy.code="HttpError";class kh extends Jr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=kh.code,this.data={reason:t}}}kh.code="InvalidFilepathError";class jc extends Jr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=jc.code,this.data={ref:t,suggestion:n}}}jc.code="InvalidRefNameError";class j1 extends Jr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=j1.code,this.data={depth:t}}}j1.code="MaxDepthError";class eb extends Jr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=eb.code,this.data={}}}eb.code="MergeNotSupportedError";class tb extends Jr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=tb.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}tb.code="MergeConflictError";class Ba extends Jr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Ba.code,this.data={role:t}}}Ba.code="MissingNameError";class No extends Jr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=No.code,this.data={parameter:t}}}No.code="MissingParameterError";class P1 extends Jr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=P1.code,this.data={errors:t},this.errors=t}}P1.code="MultipleGitError";class Zm extends Jr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=Zm.code,this.data={expected:t,actual:n}}}Zm.code="ParseError";class dy extends Jr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=dy.code,this.data={reason:t}}}dy.code="PushRejectedError";class ch extends Jr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=ch.code,this.data={capability:t,parameter:n}}}ch.code="RemoteCapabilityError";class O1 extends Jr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=O1.code,this.data={preview:t,response:n}}}O1.code="SmartHttpError";class D1 extends Jr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=D1.code,this.data={url:t,transport:n,suggestion:r}}}D1.code="UnknownTransportError";class F1 extends Jr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=F1.code,this.data={url:t}}}F1.code="UrlParseError";class nb extends Jr{constructor(){super("The operation was canceled."),this.code=this.name=nb.code,this.data={}}}nb.code="UserCanceledError";class L1 extends Jr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=L1.code,this.data={filepath:t}}}L1.code="IndexResetError";class B1 extends Jr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=B1.code,this.data={ref:t}}}B1.code="NoCommitError";var jCe=Object.freeze({__proto__:null,AlreadyExistsError:Fc,AmbiguousError:T1,CheckoutConflictError:A1,CommitNotFetchedError:R1,EmptyServerResponseError:N1,FastForwardError:M1,GitPushError:I1,HttpError:uy,InternalError:vr,InvalidFilepathError:kh,InvalidOidError:Ch,InvalidRefNameError:jc,MaxDepthError:j1,MergeNotSupportedError:eb,MergeConflictError:tb,MissingNameError:Ba,MissingParameterError:No,MultipleGitError:P1,NoRefspecError:E1,NotFoundError:As,ObjectTypeError:uo,ParseError:Zm,PushRejectedError:dy,RemoteCapabilityError:ch,SmartHttpError:O1,UnknownTransportError:D1,UnsafeFilepathError:Xy,UrlParseError:F1,UserCanceledError:nb,UnmergedPathsError:k1,IndexResetError:L1,NoCommitError:B1});function Ij({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=PCe(r),`${e} <${t}> ${n} ${r}`}function PCe(e){const t=OCe(DCe(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function OCe(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function DCe(e){return e===0?e:-e}function Cd(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function ZC(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:FCe(s)}}function FCe(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),LCe(r)}function LCe(e){return e===0?e:-e}class no{constructor(t){if(typeof t=="string")this._tag=t;else if(ln.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=no.render(t);else throw new vr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new no(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Ij(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=ZC(r.tagger)),r.committer&&(r.committer=ZC(r.committer)),r}withoutSignature(){const t=Cd(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return Cd(t)}payload(){return this.withoutSignature()+`
`}toObject(){return ln.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=Cd(i);const a=s+i;return no.from(a)}}function nI(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function BCe(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Ys{constructor(t){if(typeof t=="string")this._commit=t;else if(ln.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Ys.render(t);else throw new vr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Ys.justHeaders(t),s=Ys.justMessage(t),i=Cd(r+`
gpgsig`+nI(n)+`
`+s);return new Ys(i)}static from(t){return new Ys(t)}toObject(){return ln.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Ys.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return Cd(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Ys.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=ZC(r.author)),r.committer&&(r.committer=ZC(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new vr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${Ij(r)}
`;const s=t.committer||t.author;return n+=`committer ${Ij(s)}
`,t.gpgsig&&(n+="gpgsig"+nI(t.gpgsig)),n}static render(t){return Ys.renderHeaders(t)+`
`+Cd(t.message)}render(){return this._commit}withoutSignature(){const t=Cd(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return Cd(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return BCe(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=Ys.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=Cd(a);const l=Ys.justHeaders(t._commit)+`
gpgsig`+nI(a)+`
`+i;return Ys.from(l)}}async function fy({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Oo.from([]),oid:r};const{type:s,object:i}=await Zs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=no.from(i).parse().object,fy({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=Ys.from(i).parse().tree,fy({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new uo(r,s,"tree");return{tree:Oo.from(i),oid:r}}class $Ce{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Kt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof As&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await fy({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Zs({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new uo(l,c,o.type);const d=Oo.from(u);for(const h of d)a.set($t.join(n,h.path),h);return d.entries().map(h=>$t.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=IY(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Zs({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function Ul({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,tT,{value:function({fs:n,gitdir:r,cache:s}){return new $Ce({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class zCe{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir($t.join(s,n));return i===null?null:i.map(a=>$t.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=oy(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await la.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Ni<"u"?Ni.platform!=="win32":!0;if(!l||HC(c,l,d,h)){const m=await t.content();m===void 0?a=void 0:(a=await Kd(Qy.wrap({type:"blob",object:m})),l&&a===l.oid&&(!d||c.mode===l.mode)&&HC(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await ji.get({fs:t,gitdir:n}),this.config)}}function $1(){const e=Object.create(null);return Object.defineProperty(e,tT,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new zCe({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function UCe(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const $Y=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class qCe{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*VCe(e){const t=new qCe;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function Eh({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=$Y(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(m=>m[tT]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=UCe(0,l.length),d=async m=>{u.map(v=>{const x=m[v];m[v]=x&&new l[v].ConstructEntry(x)});const b=(await Promise.all(u.map(v=>{const x=m[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:m,children:VCe(b)}},h=async m=>{const{entries:y,children:b}=await d(m),v=y.find(w=>w&&w._fullpath)._fullpath,x=await i(v,y);if(x!==null){let w=await o(h,b);return w=w.filter(S=>S!==void 0),a(x,w)}};return h(c)}async function jj(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=$t.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?jj(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function WCe(e){return HCe(e)&&fz(e.then)&&fz(e.catch)}function HCe(e){return e&&typeof e=="object"}function fz(e){return typeof e=="function"}function hz(e){return WCe((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const pz=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function mz(e,t){if(hz(t))for(const n of pz)e[`_${n}`]=t[n].bind(t);else for(const n of pz)e[`_${n}`]=GM(t[n].bind(t));hz(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=jj.bind(null,e):t.rm?e._rm=GM(t.rm.bind(t)):t.rmdir.length>2?e._rm=GM(t.rmdir.bind(t)):e._rm=jj.bind(null,e)}class kn{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?mz(this,t.promises):mz(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=ln.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(ly(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=ly(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(eT),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return ln.isBuffer(r)?r:ln.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function ct(e,t){if(t===void 0)throw new No(e)}async function XC(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function GCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r="HEAD",cache:s={}}){try{ct("fs",e),ct("dir",t),ct("gitdir",n);const i=new kn(e),a=[Ul({ref:r}),$1(),Jy()];let o=[];await la.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await Eh({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const m=!await XC(d,h),y=o.includes(c),b=!await XC(h,u);if(m||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new L1(c)}});await la.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class rb{static async isIgnored({fs:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s}){if(GC(s)===".git")return!0;if(s===".")return!1;let i="";const a=$t.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:$t.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:$t.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=V2e().add(i);h.add(d);const m=ly(u.filepath);if(m!=="."&&h.ignores(m))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function KCe({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let rI=null;async function zY(e){return rI===null&&(rI=ZCe()),rI?YCe(e):aD.deflate(e)}async function YCe(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function ZCe(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function zo({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=Qy.wrap({type:n,object:r})),i=await Kd(r),r=ln.from(await zY(r))),a||await KCe({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function UY(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function XCe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r);const o=new kn(e);await la.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await ji.get({fs:o,gitdir:n})).get("core.autocrlf");return Pj({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function Pj({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await rb.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const m=await n.lstat($t.join(e,h));if(!m)throw new As(h);if(m.isDirectory()){const y=await n.readdir($t.join(e,h));if(a){const b=y.map(v=>Pj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await Pj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const y=m.isSymbolicLink()?await n.readlink($t.join(e,h)).then(UY):await n.read($t.join(e,h),{autocrlf:o});if(y===null)throw new As(h);const b=await zo({fs:n,gitdir:t,type:"blob",object:y});s.insert({filepath:h,stats:m,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new P1(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function hw({fs:e,gitdir:t,path:n}){return(await ji.get({fs:e,gitdir:t})).get(n)}function qY(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function Th({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await hw({fs:e,gitdir:t,path:"user.name"}),email:await hw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=qY({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function hy({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await hw({fs:e,gitdir:t,path:"user.name"}),email:await hw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=qY({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function VY({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Zs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=no.from(i).parse().object,VY({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new uo(r,s,"commit");return{commit:Ys.from(i),oid:r}}async function py({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await VY({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function nT({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m}){let y=!1;d||(d=await Kt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,v;try{b=await Kt.resolve({fs:e,gitdir:r,ref:d}),v=await py({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new B1(d);const x=l?await Th({fs:e,gitdir:r,author:i,commit:v.commit}):await Th({fs:e,gitdir:r,author:i});if(!x)throw new Ba("author");const w=l?await hy({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await hy({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new Ba("committer");return la.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const C=PY(S.entries).get(".");if(m||(m=await WY({fs:e,gitdir:r,inode:C,dryRun:c})),h?h=await Promise.all(h.map(N=>Kt.resolve({fs:e,gitdir:r,ref:N}))):l?h=v.commit.parent:h=b?[b]:[],!s)if(l)s=v.commit.message;else throw new No("message");let R=Ys.from({tree:m,parent:h,author:x,committer:w,message:s});o&&(R=await Ys.sign(R,n,o));const A=await zo({fs:e,gitdir:r,type:"commit",object:R.toObject(),dryRun:c});return!u&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:d,value:A}),A})}async function WY({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await WY({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=Oo.from(i);return await zo({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function z1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new kh("leading-slash");if(s.endsWith("/"))throw new kh("trailing-slash");const i=r,a=await fy({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await HY({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function HY({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await Zs({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new uo(i,c,"tree",a);return r=Oo.from(u),HY({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new As(`file or directory found at "${i}:${a}"`)}async function sb({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await z1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await fy({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function U1({fs:e,gitdir:t,tree:n}){const r=Oo.from(n).toObject();return await zo({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function JCe({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof As))throw x}let m=(await sb({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)m=m.filter(x=>x.path!==i);else for(const x of m)if(x.path===i)throw new Fc("note",i);typeof a=="string"&&(a=ln.from(a,"utf8"));const y=await zo({fs:e,gitdir:r,type:"blob",object:a,format:"content"});m.push({mode:"100644",path:i,oid:y,type:"blob"});const b=await U1({fs:e,gitdir:r,tree:m});return await nT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function QCe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i),ct("note",a),u&&ct("onSign",t);const h=new kn(e),m=await Th({fs:h,gitdir:r,author:l});if(!m)throw new Ba("author");const y=await hy({fs:h,gitdir:r,author:m,committer:c});if(!y)throw new Ba("committer");return await JCe({fs:new kn(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:m,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function GY({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==yu.clean(n))throw new jc(n,yu.clean(n));const i=await ji.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new Fc("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await ji.save({fs:e,gitdir:t,config:i})}async function eke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r,url:s,force:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("remote",r),ct("url",s),await GY({fs:new kn(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function tke({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Kt.exists({fs:e,gitdir:r,ref:s}))throw new Fc("tag",s);const d=await Kt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Zs({fs:e,cache:t,gitdir:r,oid:d});let m=no.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(m=await no.sign(m,n,c));const y=await zo({fs:e,gitdir:r,type:"tag",object:m.toObject()});await Kt.writeRef({fs:e,gitdir:r,ref:s,value:y})}async function nke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{ct("fs",e),ct("gitdir",r),ct("ref",s),c&&ct("onSign",t);const h=new kn(e),m=await Th({fs:h,gitdir:r,author:i});if(!m)throw new Ba("tagger");return await tke({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:m,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function rke({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==yu.clean(n))throw new jc(n,yu.clean(n));const a=`refs/heads/${n}`;if(!i&&await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Fc("branch",n,!1);let o;try{o=await Kt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Kt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function ske({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await rke({fs:new kn(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const KY=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function uD({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:m=!0}){let y;if(r)try{y=await Kt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Kt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(b=await Kt.resolve({fs:e,gitdir:i,ref:x}),m){const w=await ji.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await ji.save({fs:e,gitdir:i,config:w})}await Kt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let v;try{v=await ike({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(C){throw C instanceof As&&C.data.what===b?new R1(o,b):C}const x=v.filter(([C])=>C==="conflict").map(([C,R])=>R);if(x.length>0)throw new A1(x);const w=v.filter(([C])=>C==="error").map(([C,R])=>R);if(w.length>0)throw new vr(w.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const k=v.length;await la.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([R])=>R==="delete"||R==="delete-index").map(async function([R,A]){const N=`${s}/${A}`;R==="delete"&&await e.rm(N),C.delete({filepath:A}),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}))}),await la.acquire({fs:e,gitdir:i,cache:t},async function(C){for(const[R,A]of v)if(R==="rmdir"||R==="rmdir-index"){const N=`${s}/${A}`;try{R==="rmdir-index"&&C.delete({filepath:A}),await e.rmdir(N),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}catch(I){if(I.code==="ENOTEMPTY")console.log(`Did not delete ${A} because directory is not empty`);else throw I}}}),await Promise.all(v.filter(([C])=>C==="mkdir"||C==="mkdir-index").map(async function([C,R]){const A=`${s}/${R}`;await e.mkdir(A),n&&await n({phase:"Updating workdir",loaded:++S,total:k})})),await la.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([R])=>R==="create"||R==="create-index"||R==="update"||R==="mkdir-index").map(async function([R,A,N,I,O]){const B=`${s}/${A}`;try{if(R!=="create-index"&&R!=="mkdir-index"){const{object:W}=await Zs({fs:e,cache:t,gitdir:i,oid:N});if(O&&await e.rm(B),I===33188)await e.write(B,W);else if(I===33261)await e.write(B,W,{mode:511});else if(I===40960)await e.writelink(B,W);else throw new vr(`Invalid mode 0o${I.toString(8)} detected in blob ${N}`)}const D=await e.lstat(B);I===33261&&(D.mode=493),R==="mkdir-index"&&(D.mode=57344),C.insert({filepath:A,stats:D,oid:N}),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}catch(D){console.log(D)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Kt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Kt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Kt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function ike({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return Eh({fs:e,cache:t,dir:r,gitdir:s,trees:[Ul({ref:i}),$1(),Jy()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>KY(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=$Y(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function YY({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=$t.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:m={}}){try{ct("fs",e),ct("dir",r),ct("gitdir",s);const y=a||"HEAD";return await uD({fs:new kn(e),cache:m,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const ake=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function tm(e){const t=ake.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function Kh({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Kt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Kt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:tm(s)}function oke(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function ZY({username:e="",password:t=""}){return`Basic ${ln.from(`${e}:${t}`).toString("base64")}`}async function q1(e,t){const n=FY(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function JC(e){let t=0;const n=[];await q1(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function gz(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Oj(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class gi{static flush(){return ln.from("0000","utf8")}static delim(){return ln.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=ln.from(t));const n=t.length+4,r=Oj(4,n);return ln.concat([ln.from(r,"utf8"),t])}static streamReader(t){const n=new LY(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function yz(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function bz(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=gi.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new N1;if(a.includes("version 2"))return yz(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new Zm(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return yz(i);const[l,c]=sI(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=sI(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[m,y]=sI(h.toString("utf8")," "," ");r.set(y,m)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function sI(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new Zm(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const vz=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,xz=(e,t)=>{(t.username||t.password)&&(e.Authorization=ZY(t)),t.headers&&Object.assign(e,t.headers)},iI=async e=>{try{const t=ln.from(await JC(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class QC{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=gz(l);const m=a?vz(a,d):d;(h.username||h.password)&&(c.Authorization=ZY(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,v=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${m}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new nb;h&&(xz(c,h),v=!0,b=!0)}}else y.statusCode===200&&v&&s&&await s(d,h);while(b);if(y.statusCode!==200){const{response:x}=await iI(y);throw new uy(y.statusCode,y.statusMessage,x)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const x=await bz(y.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:S}=await iI(y);try{const k=await bz([S],{service:o});return k.auth=h,k}catch{throw new O1(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=gz(i);c&&(i=c.url),r&&(i=vz(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,xz(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=iI(u);throw new uy(u.statusCode,u.statusMessage,d)}return u}}function lke({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class rT{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",QC),n.set("https",QC);const r=lke({url:t});if(!r)throw new F1(t);if(n.has(r.transport))return n.get(r.transport);throw new D1(t,r.transport,r.transport==="ssh"?oke(t):void 0)}}let $p=null;class pw{static async read({fs:t,gitdir:n}){$p===null&&($p=new fw);const r=$t.join(n,"shallow"),s=new Set;return await $p.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){$p===null&&($p=new fw);const s=$t.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await $p.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await $p.acquire(s,async function(){await t.rm(s)})}}async function cke({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function uke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir($t.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await cD({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new vr(l.error);if(l.offsets.has(r))return!0}return!1}async function wz({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>Zs({fs:e,cache:t,gitdir:n,oid:o});let a=await cke({fs:e,gitdir:n,oid:r});return a||(a=await uke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function dke(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function XY(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const sT={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class I2{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function fke(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function JY(e){const t=new I2;let n="";return(async()=>(await q1(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=fke(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class QY{static demux(t){const n=gi.streamReader(t),r=new I2,s=new I2,i=new I2,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function hke(e){const{packetlines:t,packfile:n,progress:r}=QY.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{q1(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Ch(m)),s.push(m)}else if(h.startsWith("unshallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Ch(m)),i.push(m)}else if(h.startsWith("ACK")){const[,m,y]=h.split(" ");a.push({oid:m,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function pke({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(gi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(gi.encode(`shallow ${c}
`));s!==null&&o.push(gi.encode(`deepen ${s}
`)),i!==null&&o.push(gi.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(gi.encode(`deepen-not ${c}
`));o.push(gi.flush());for(const c of n)o.push(gi.encode(`have ${c}
`));return o.push(gi.encode(`done
`)),o}async function dD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:k={},prune:C=!1,pruneTags:R=!1}){const A=c||await Kh({fs:e,gitdir:l,test:!0}),N=await ji.get({fs:e,gitdir:l}),I=d||A&&await N.get(`branch.${A}.remote`)||"origin",O=h||await N.get(`remote.${I}.url`);if(typeof O>"u")throw new No("remote OR url");const B=u||A&&await N.get(`branch.${A}.merge`)||c||"HEAD";m===void 0&&(m=await N.get("http.corsProxy"));const D=rT.getRemoteHelperFor({url:O}),W=await D.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:m,service:"git-upload-pack",url:O,headers:k,protocolVersion:1}),P=W.auth,Z=W.refs;if(Z.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!W.capabilities.has("shallow"))throw new ch("shallow","depth");if(b!==null&&!W.capabilities.has("deepen-since"))throw new ch("deepen-since","since");if(v.length>0&&!W.capabilities.has("deepen-not"))throw new ch("deepen-not","exclude");if(x===!0&&!W.capabilities.has("deepen-relative"))throw new ch("deepen-relative","relative");const{oid:U,fullref:H}=Kt.resolveAgainstMap({ref:B,map:Z});for(const We of Z.keys())We===H||We==="HEAD"||We.startsWith("refs/heads/")||w&&We.startsWith("refs/tags/")||Z.delete(We);const L=XY([...W.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${sT.agent}`]);x&&L.push("deepen-relative");const ne=S?[U]:Z.values(),V=S?[A]:await Kt.listRefs({fs:e,gitdir:l,filepath:"refs"});let Q=[];for(let We of V)try{We=await Kt.expand({fs:e,gitdir:l,ref:We});const Ne=await Kt.resolve({fs:e,gitdir:l,ref:We});await wz({fs:e,cache:t,gitdir:l,oid:Ne})&&Q.push(Ne)}catch{}Q=[...new Set(Q)];const ee=await pw.read({fs:e,gitdir:l}),se=W.capabilities.has("shallow")?[...ee]:[],me=pke({capabilities:L,wants:ne,haves:Q,shallows:se,depth:y,since:b,exclude:v}),ce=ln.from(await JC(me)),je=await D.connect({http:n,onProgress:r,corsProxy:m,service:"git-upload-pack",url:O,auth:P,body:[ce],headers:k}),De=await hke(je.body);je.headers&&(De.headers=je.headers);for(const We of De.shallows)if(!ee.has(We))try{const{object:Ne}=await Zs({fs:e,cache:t,gitdir:l,oid:We}),K=new Ys(Ne),ge=await Promise.all(K.headers().parent.map(le=>wz({fs:e,cache:t,gitdir:l,oid:le})));ge.length===0||ge.every(le=>le)||ee.add(We)}catch{ee.add(We)}for(const We of De.unshallows)ee.delete(We);if(await pw.write({fs:e,gitdir:l,oids:ee}),S){const We=new Map([[H,U]]),Ne=new Map;let K=10,ge=H;for(;K--;){const oe=W.symrefs.get(ge);if(oe===void 0)break;Ne.set(ge,oe),ge=oe}const Ae=Z.get(ge);Ae&&We.set(ge,Ae);const{pruned:le}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:We,symrefs:Ne,tags:w,prune:C});C&&(De.pruned=le)}else{const{pruned:We}=await Kt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:Z,symrefs:W.symrefs,tags:w,prune:C,pruneTags:R});C&&(De.pruned=We)}if(De.HEAD=W.symrefs.get("HEAD"),De.HEAD===void 0){const{oid:We}=Kt.resolveAgainstMap({ref:"HEAD",map:Z});for(const[Ne,K]of Z.entries())if(Ne!=="HEAD"&&K===We){De.HEAD=Ne;break}}const Se=H.startsWith("refs/tags")?"tag":"branch";if(De.FETCH_HEAD={oid:U,description:`${Se} '${tm(H)}' of ${O}`},r||s){const We=JY(De.progress);q1(We,async Ne=>{if(s&&await s(Ne),r){const K=Ne.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);K&&await r({phase:K[1].trim(),loaded:parseInt(K[2],10),total:parseInt(K[3],10)})}})}const Ce=ln.from(await JC(De.packfile));if(je.body.error)throw je.body.error;const qe=Ce.slice(-20).toString("hex"),Qe={defaultBranch:De.HEAD,fetchHead:De.FETCH_HEAD.oid,fetchHeadDescription:De.FETCH_HEAD.description};if(De.headers&&(Qe.headers=De.headers),C&&(Qe.pruned=De.pruned),qe!==""&&!dke(Ce)){Qe.packfile=`objects/pack/pack-${qe}.pack`;const We=$t.join(l,Qe.packfile);await e.write(We,Ce);const Ne=ge=>Zs({fs:e,cache:t,gitdir:l,oid:ge}),K=await cy.fromPack({pack:Ce,getExternalRefDelta:Ne,onProgress:r});await e.write(We.replace(/\.pack$/,".idx"),await K.toBuffer())}return Qe}async function eZ({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function mke({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:m,remote:y,depth:b,since:v,exclude:x,relative:w,singleBranch:S,noCheckout:k,noTags:C,headers:R}){try{if(await eZ({fs:e,gitdir:u}),await GY({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const I=await ji.get({fs:e,gitdir:u});await I.set("http.corsProxy",h),await ji.save({fs:e,gitdir:u,config:I})}const{defaultBranch:A,fetchHead:N}=await dD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:m,remote:y,corsProxy:h,depth:b,since:v,exclude:x,relative:w,singleBranch:S,headers:R,tags:!C});if(N===null)return;m=m||A,m=m.replace("refs/heads/",""),await uD({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:m,remote:y,noCheckout:k})}catch(A){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),A}}async function gke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=$t.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:m="origin",depth:y=void 0,since:b=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:S=!1,noTags:k=!1,headers:C={},cache:R={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),S||ct("dir",l),ct("url",u),await mke({fs:new kn(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:m,depth:y,since:b,exclude:v,relative:x,singleBranch:w,noCheckout:S,noTags:k,headers:C})}catch(A){throw A.caller="git.clone",A}}async function yke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m,cache:y={}}){try{ct("fs",e),l||ct("message",s),o&&ct("onSign",t);const b=new kn(e);return await nT({fs:b,cache:y,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:m})}catch(b){throw b.caller="git.commit",b}}async function bke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),fullname:r=!1,test:s=!1}){try{return ct("fs",e),ct("gitdir",n),await Kh({fs:new kn(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function vke({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Kt.exists({fs:e,gitdir:t,ref:n}))throw new As(n);const s=await Kt.expand({fs:e,gitdir:t,ref:n}),i=await Kh({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Kt.resolve({fs:e,gitdir:t,ref:s});await Kt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Kt.deleteRef({fs:e,gitdir:t,ref:s});const a=tm(n),o=await ji.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await ji.save({fs:e,gitdir:t,config:o})}async function xke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await vke({fs:new kn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function wke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{ct("fs",e),ct("ref",r),await Kt.deleteRef({fs:new kn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function _ke({fs:e,gitdir:t,remote:n}){const r=await ji.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await ji.save({fs:e,gitdir:t,config:r})}async function Ske({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("remote",r),await _ke({fs:new kn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function Cke({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Kt.deleteRef({fs:e,gitdir:t,ref:n})}async function kke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("ref",r),await Cke({fs:new kn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function Eke({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function Tke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await cD({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new vr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function Ake({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>Zs({fs:e,cache:t,gitdir:n,oid:o}),i=await Eke({fs:e,gitdir:n,oid:r}),a=await Tke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new T1("oids",r,i):new As(`an object matching "${r}"`)}async function Rke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await Ake({fs:new kn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function Nke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Kt.expand({fs:new kn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function fD({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Zs({fs:e,cache:t,gitdir:n,oid:c}),h=Ys.from(d),{parent:m}=h.parseHeaders();for(const y of m)(!s[y]||!s[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const aI=/^.*(\r?\n|$)/gm;function Mke({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(aI),l=s.match(aI),c=a.match(aI),u=Z2e(o,l,c),d=7;let h="",m=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(m=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:m,mergedText:h}}async function Ike({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:m}){const y=Ul({ref:i}),b=Ul({ref:a}),v=Ul({ref:o}),x=[],w=[],S=[],k=[],C=await Eh({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,v],map:async function(R,[A,N,I]){const O=GC(R),B=await XC(A,N),D=await XC(I,N);switch(`${B}-${D}`){case"false-false":return{mode:await N.mode(),path:O,oid:await N.oid(),type:await N.type()};case"false-true":return I?{mode:await I.mode(),path:O,oid:await I.oid(),type:await I.type()}:void 0;case"true-false":return A?{mode:await A.mode(),path:O,oid:await A.oid(),type:await A.type()}:void 0;case"true-true":{if(A&&N&&I&&await A.type()==="blob"&&await N.type()==="blob"&&await I.type()==="blob")return jke({fs:e,gitdir:r,path:O,ours:A,base:N,theirs:I,ourName:l,baseName:c,theirName:u,mergeDriver:m}).then(async W=>{if(W.cleanMerge)h||s.insert({filepath:R,oid:W.mergeResult.oid,stage:0});else if(x.push(R),w.push(R),!h){const P=await N.oid(),Z=await A.oid(),U=await I.oid();s.delete({filepath:R}),s.insert({filepath:R,oid:P,stage:1}),s.insert({filepath:R,oid:Z,stage:2}),s.insert({filepath:R,oid:U,stage:3})}return W.mergeResult});if(N&&!A&&I&&await N.type()==="blob"&&await I.type()==="blob"){if(x.push(R),S.push(R),!h){const W=await N.oid(),P=await I.oid();s.delete({filepath:R}),s.insert({filepath:R,oid:W,stage:1}),s.insert({filepath:R,oid:P,stage:3})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:O}}if(N&&A&&!I&&await N.type()==="blob"&&await A.type()==="blob"){if(x.push(R),k.push(R),!h){const W=await N.oid(),P=await A.oid();s.delete({filepath:R}),s.insert({filepath:R,oid:W,stage:1}),s.insert({filepath:R,oid:P,stage:2})}return{mode:await A.mode(),oid:await A.oid(),type:"blob",path:O}}if(N&&!A&&!I&&await N.type()==="blob")return;throw new eb}}},reduce:x.length!==0&&(!n||h)?void 0:async(R,A)=>{const N=A.filter(Boolean);if(R&&!(R&&R.type==="tree"&&N.length===0)){if(N.length>0){const O=new Oo(N).toObject(),B=await zo({fs:e,gitdir:r,type:"tree",object:O,dryRun:d});R.oid=B}return R}}});return x.length!==0?(n&&!h&&await Eh({fs:e,cache:t,dir:n,gitdir:r,trees:[Ul({ref:C.oid})],map:async function(R,[A]){const N=`${n}/${R}`;if(await A.type()==="blob"){const I=await A.mode(),O=new TextDecoder().decode(await A.content());await e.write(N,O,{mode:I})}return!0}}),new tb(x,w,S,k)):C.oid}async function jke({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=Mke}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const m=ln.from(await r.content()).toString("utf8"),y=ln.from(await s.content()).toString("utf8"),b=ln.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[y,m,b],path:n}),w=await zo({fs:e,gitdir:t,type:"blob",object:ln.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function tZ({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,onSign:b,mergeDriver:v}){s===void 0&&(s=await Kh({fs:e,gitdir:r,fullname:!0})),s=await Kt.expand({fs:e,gitdir:r,ref:s}),i=await Kt.expand({fs:e,gitdir:r,ref:i});const x=await Kt.resolve({fs:e,gitdir:r,ref:s}),w=await Kt.resolve({fs:e,gitdir:r,ref:i}),S=await fD({fs:e,cache:t,gitdir:r,oids:[x,w]});if(S.length!==1)throw new eb;const k=S[0];if(k===w)return{oid:x,alreadyMerged:!0};if(a&&k===x)return!l&&!c&&await Kt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new M1;const C=await la.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async A=>Ike({fs:e,cache:t,dir:n,gitdir:r,index:A,ourOid:x,theirOid:w,baseOid:k,ourName:tm(s),baseName:"base",theirName:tm(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(C instanceof tb)throw C;return d||(d=`Merge branch '${tm(i)}' into ${tm(s)}`),{oid:await nT({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:C,parent:[x,w],author:h,committer:m,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:C,mergeCommit:!0}}}async function nZ({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:m,prune:y,pruneTags:b,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:S,headers:k,author:C,committer:R,signingKey:A}){try{if(!u){const O=await Kh({fs:e,gitdir:c});if(!O)throw new No("ref");u=O}const{fetchHead:N,fetchHeadDescription:I}=await dD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:m,singleBranch:S,headers:k,prune:y,pruneTags:b});await tZ({fs:e,cache:t,gitdir:c,ours:u,theirs:N,fastForward:v,fastForwardOnly:x,message:`Merge ${I}`,author:C,committer:R,signingKey:A,dryRun:!1,noUpdateBranch:!1}),await uD({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(N){throw N.caller="git.pull",N}}async function Pke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:m,singleBranch:y,headers:b={},cache:v={}}){try{ct("fs",e),ct("http",t),ct("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await nZ({fs:new kn(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:m,singleBranch:y,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function Oke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:k={},prune:C=!1,pruneTags:R=!1,cache:A={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",l),await dD({fs:new kn(e),cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y,since:b,exclude:v,relative:x,tags:w,singleBranch:S,headers:k,prune:C,pruneTags:R})}catch(N){throw N.caller="git.fetch",N}}async function Dke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await fD({fs:new kn(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function rZ({fs:e,filepath:t}){if(await e.exists($t.join(t,".git")))return t;{const n=ly(t);if(n===t)throw new As(`git root for ${t}`);return rZ({fs:e,filepath:n})}}async function Fke({fs:e,filepath:t}){try{return ct("fs",e),ct("filepath",t),await rZ({fs:new kn(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function Lke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await hw({fs:new kn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function Bke({fs:e,gitdir:t,path:n}){return(await ji.get({fs:e,gitdir:t})).getall(n)}async function $ke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ct("fs",e),ct("gitdir",n),ct("path",r),await Bke({fs:new kn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function zke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{ct("http",e),ct("url",i);const c=await rT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}for(const[d,h]of c.symrefs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function sZ(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function Uke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{ct("http",e),ct("url",i);const u=await rT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[m,y]=h.split("=");y?d[m]=y:d[m]=!0}return{protocolVersion:1,capabilities:d,refs:sZ(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function qke({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=Qy.wrap({type:e,object:t})),r=await Kd(t)),{oid:r,object:t}}async function Vke({object:e}){try{ct("object",e),typeof e=="string"?e=ln.from(e,"utf8"):e=ln.from(e);const t="blob",{oid:n,object:r}=await qke({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function Wke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=$t.join(r,i);const a=await e.read(i),o=c=>Zs({fs:e,cache:t,gitdir:s,oid:c}),l=await cy.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function Hke({fs:e,onProgress:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s,cache:i={}}){try{return ct("fs",e),ct("dir",n),ct("gitdir",n),ct("filepath",s),await Wke({fs:new kn(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function Gke({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){try{return ct("fs",e),ct("gitdir",r),t||ct("dir",n),await eZ({fs:new kn(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function iZ({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await pw.read({fs:e,gitdir:n});if(!r)throw new No("oid");if(!s)throw new No("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new j1(i);const u=o.shift(),{type:d,object:h}=await Zs({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new uo(u,d,"commit");const m=Ys.from(h).parse();for(const y of m.parent)if(y===s)return!0;if(!a.has(u))for(const y of m.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function Kke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),ct("ancestor",s),await iZ({fs:new kn(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function Yke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("dir",t),ct("gitdir",n),ct("filepath",r),rb.isIgnored({fs:new kn(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function Zke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ct("fs",e),ct("gitdir",n),Kt.listBranches({fs:new kn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function Xke({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Kt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await aZ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return la.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function aZ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await sb({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await aZ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:$t.join(i,o.path)}):s.push($t.join(i,o.path))}async function Jke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),await Xke({fs:new kn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function Qke({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Kt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof As)return[]}return(await sb({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function eEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Qke({fs:new kn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function tEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ct("fs",e),ct("gitdir",n),Kt.listRefs({fs:new kn(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function nEe({fs:e,gitdir:t}){const n=await ji.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function rEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),await nEe({fs:new kn(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function sEe(e){const t=gi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function iEe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(gi.encode(`command=ls-refs
`)),r.push(gi.encode(`agent=${sT.agent}
`)),(n||t||e)&&r.push(gi.delim()),n&&r.push(gi.encode("peel")),t&&r.push(gi.encode("symrefs")),e&&r.push(gi.encode(`ref-prefix ${e}`)),r.push(gi.flush()),r}async function aEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{ct("http",e),ct("url",i);const h=await QC.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return sZ(h,c,u,d);const m=await iEe({prefix:c,symrefs:u,peelTags:d}),y=await QC.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:m});return sEe(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function oEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ct("fs",e),ct("gitdir",n),Kt.listTags({fs:new kn(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function lEe(e,t){return e.committer.timestamp-t.committer.timestamp}const cEe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function _z({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===cEe)return;const i=r;let a;const o=await fy({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await oZ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function oZ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=$t.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Zs({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return oZ({fs:e,cache:t,gitdir:n,tree:Oo.from(d),fileId:s,oid:i,filepaths:a,parentPath:$t.join(o,c.path)})})),u});return await Promise.all(l),a}async function uEe({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await pw.read({fs:e,gitdir:n}),h=await Kt.resolve({fs:e,gitdir:n,ref:s}),m=[await py({fs:e,cache:t,gitdir:n,oid:h})];let y,b,v;function x(w){v&&r&&u.push(w)}for(;m.length>0;){const w=m.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let S;try{S=await z1({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),b&&y!==S&&u.push(b),y=S,b=w,v=!0}catch(k){if(k instanceof As){let C=l&&y;if(C&&(C=await _z({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:y}),C))if(Array.isArray(C)){if(b){const R=await _z({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(R))if(C=C.filter(A=>R.indexOf(A)===-1),C.length===1)C=C[0],r=C,b&&u.push(b);else{C=!1,b&&u.push(b);break}}}else r=C,b&&u.push(b);if(!C){if(v&&y&&(u.push(b),!o))break;if(!o&&!l)throw k}b=w,v=!1}else throw k}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const S of w.commit.parent){const k=await py({fs:e,cache:t,gitdir:n,oid:S});m.map(C=>C.oid).includes(k.oid)||m.push(k)}m.length===0&&x(w),m.sort((S,k)=>lEe(S.commit,k.commit))}return u}async function dEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",s),await uEe({fs:new kn(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function fEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,cache:b={},mergeDriver:v}){try{ct("fs",e),y&&ct("onSign",t);const x=new kn(e),w=await Th({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new Ba("author");const S=await hy({fs:x,gitdir:r,author:w,committer:m});if(!S&&(!o||!a))throw new Ba("committer");return await tZ({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:S,signingKey:y,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const hEe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function lZ({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new kY,a=[];function o(u,d){const h=ln.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=hEe[u];let m=d.length,y=m>15?128:0;const b=m&15;m=m>>>4;let v=(y|h|b).toString(16);for(o(v,"hex");y;)y=m>127?128:0,v=y|m&127,o(Oj(2,v),"hex"),m=m>>>7;o(ln.from(await zY(d)))}o("PACK"),o("00000002","hex"),o(Oj(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await Zs({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function pEe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await lZ({fs:e,cache:t,gitdir:n,oids:r}),a=ln.from(await JC(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write($t.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function mEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oids",r),await pEe({fs:new kn(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function gEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:m=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:S={},author:k,committer:C,signingKey:R,cache:A={}}){try{ct("fs",e),ct("gitdir",l);const N=new kn(e),I=await Th({fs:N,gitdir:l,author:k});if(!I)throw new Ba("author");const O=await hy({fs:N,gitdir:l,author:I,committer:C});if(!O)throw new Ba("committer");return await nZ({fs:N,cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:S,author:I,committer:O,signingKey:R,prune:m,pruneTags:y})}catch(N){throw N.caller="git.pull",N}}async function yEe({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),start:s,finish:i}){const a=await pw.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Kt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Kt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:m}=await Zs({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=no.from(m).headers().object;return u(b)}if(h!=="commit")throw new uo(d,h,"commit");if(!a.has(d)){const b=Ys.from(m).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function oI({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await Zs({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=no.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Ys.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=Oo.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function bEe(e){const t={};let n="";const r=gi.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new Zm('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function vEe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(gi.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(gi.flush()),n}async function xEe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={}}){const w=u||await Kh({fs:e,gitdir:c});if(typeof w>"u")throw new No("ref");const S=await ji.get({fs:e,gitdir:c});h=h||await S.get(`branch.${w}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${w}.remote`)||"origin";const k=m||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof k>"u")throw new No("remote OR url");const C=d||await S.get(`branch.${w}.merge`);if(typeof k>"u")throw new No("remoteRef");v===void 0&&(v=await S.get("http.corsProxy"));const R=await Kt.expand({fs:e,gitdir:c,ref:w}),A=b?"0000000000000000000000000000000000000000":await Kt.resolve({fs:e,gitdir:c,ref:R}),N=rT.getRemoteHelperFor({url:k}),I=await N.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:k,headers:x,protocolVersion:1}),O=I.auth;let B;if(!C)B=R;else try{B=await Kt.expandAgainstMap({ref:C,map:I.refs})}catch(ee){if(ee instanceof As)B=C.startsWith("refs/")?C:`refs/heads/${C}`;else throw ee}const D=I.refs.get(B)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:k,localRef:{ref:b?"(delete)":R,oid:A},remoteRef:{ref:B,oid:D}}))throw new nb;const W=!I.capabilities.has("no-thin");let P=new Set;if(!b){const ee=[...I.refs.values()];let se=new Set;if(D!=="0000000000000000000000000000000000000000"){const me=await fD({fs:e,cache:t,gitdir:c,oids:[A,D]});for(const ce of me)ee.push(ce);W&&(se=await oI({fs:e,cache:t,gitdir:c,oids:me}))}if(!ee.includes(A)){const me=await yEe({fs:e,cache:t,gitdir:c,start:[A],finish:ee});P=await oI({fs:e,cache:t,gitdir:c,oids:me})}if(W){try{const me=await Kt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:ce}=await Kt.resolveAgainstMap({ref:me.replace(`refs/remotes/${h}/`,""),fullref:me,map:I.refs}),je=[ce];for(const De of await oI({fs:e,cache:t,gitdir:c,oids:je}))se.add(De)}catch{}for(const me of se)P.delete(me)}if(A===D&&(y=!0),!y){if(R.startsWith("refs/tags")&&D!=="0000000000000000000000000000000000000000")throw new dy("tag-exists");if(A!=="0000000000000000000000000000000000000000"&&D!=="0000000000000000000000000000000000000000"&&!await iZ({fs:e,cache:t,gitdir:c,oid:A,ancestor:D,depth:-1}))throw new dy("not-fast-forward")}}const Z=XY([...I.capabilities],["report-status","side-band-64k",`agent=${sT.agent}`]),U=await vEe({capabilities:Z,triplets:[{oldoid:D,oid:A,fullRef:B}]}),H=b?[]:await lZ({fs:e,cache:t,gitdir:c,oids:[...P]}),L=await N.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:k,auth:O,headers:x,body:[...U,...H]}),{packfile:ne,progress:V}=await QY.demux(L.body);if(s){const ee=JY(V);q1(ee,async se=>{await s(se)})}const Q=await bEe(ne);if(L.headers&&(Q.headers=L.headers),h&&Q.ok&&Q.refs[B].ok&&!R.startsWith("refs/tags")){const ee=`refs/remotes/${h}/${B.replace("refs/heads","")}`;b?await Kt.deleteRef({fs:e,gitdir:c,ref:ee}):await Kt.writeRef({fs:e,gitdir:c,ref:ee,value:A})}if(Q.ok&&Object.values(Q.refs).every(ee=>ee.ok))return Q;{const ee=Object.entries(Q.refs).filter(([se,me])=>!me.ok).map(([se,me])=>`
  - ${se}: ${me.error}`).join("");throw new I1(ee,Q)}}async function wEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=$t.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={},cache:w={}}){try{return ct("fs",e),ct("http",t),ct("gitdir",c),await xEe({fs:new kn(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y,delete:b,corsProxy:v,headers:x})}catch(S){throw S.caller="git.push",S}}async function cZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Zs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=no.from(i).parse().object,cZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new uo(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function uZ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await z1({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await cZ({fs:e,cache:t,gitdir:n,oid:r})}async function _Ee({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await uZ({fs:new kn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function dZ({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await py({fs:new kn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function SEe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Kt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await uZ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function CEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oid",s),await SEe({fs:new kn(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function kEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{ct("fs",e),ct("gitdir",n),ct("oid",r);const l=new kn(e);i!==void 0&&(r=await z1({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await Zs({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Ys.from(u.object).parse();break;case"tree":u.object=Oo.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=no.from(u.object).parse();break;default:throw new uo(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function EEe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Zs({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new uo(r,s,"tag");const a=no.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function TEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await EEe({fs:new kn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function AEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return ct("fs",e),ct("gitdir",n),ct("oid",r),await sb({fs:new kn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function REe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r),await la.acquire({fs:new kn(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function NEe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Kt.resolve({gitdir:r,fs:e,ref:s})}catch(y){if(!(y instanceof As))throw y}let d=(await sb({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==i);const h=await U1({fs:e,gitdir:r,tree:d});return await nT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function MEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{ct("fs",e),ct("gitdir",r),ct("oid",i);const u=new kn(e),d=await Th({fs:u,gitdir:r,author:a});if(!d)throw new Ba("author");const h=await hy({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new Ba("committer");return await NEe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function IEe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==yu.clean(r))throw new jc(r,yu.clean(r));if(n!==yu.clean(n))throw new jc(n,yu.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Kt.exists({fs:e,gitdir:t,ref:a}))throw new Fc("branch",r,!1);const l=await Kt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Kt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Kt.deleteRef({fs:e,gitdir:t,ref:i});const u=await Kh({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Kt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function jEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),ct("oldref",s),await IEe({fs:new kn(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function fZ({gitdir:e,type:t,object:n}){return Kd(Qy.wrap({type:t,object:n}))}async function PEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const a=new kn(e);let o,l;try{o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await z1({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read($t.join(t,r));u&&(l=await fZ({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat($t.join(t,r)))),await la.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function OEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,depth:s}){try{return ct("fs",e),ct("gitdir",n),ct("ref",r),await Kt.resolve({fs:new kn(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function DEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r,value:s,append:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("path",r);const a=new kn(e),o=await ji.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await ji.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function hZ({fs:e,gitdir:t,commit:n}){const r=Ys.from(n).toObject();return await zo({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class ek{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=ek.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const FEe={stage:Jy,workdir:$1};let lI;async function my(e,t){return lI===void 0&&(lI=new fw),lI.acquire(e,t)}async function LEe(e,t,n,r,s=null){const i=$t.join(n,r),a=await e.lstat(i);if(!a)throw new As(i);if(a.isDirectory())throw new vr(`${i}: file expected, but found directory`);const o=s?await DY({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await my({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(UY):await e.read(i);if(c===null)throw new As(i);l=await zo({fs:e,gitdir:t,type:"blob",object:c})}),l}async function BEe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await U1({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await LEe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function Sz({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(m=>typeof m=="string"?FEe[m]():m),a=[],u=await Eh({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(m,[y,b])=>{if(!(m==="."||await rb.isIgnored({fs:e,dir:t,gitdir:n,filepath:m}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:m,oid:await b.oid(),type:await b.type()}},reduce:async(m,y)=>(y=y.filter(Boolean),m?(m.children=y,m):y.length>0?y:void 0),iterate:async(m,y)=>{const b=[];for(const v of y){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?b.push(v):a.push([null,w])):x&&(w?b.push(v):a.push([x,null]))}return b.length?Promise.all(b.map(m)):[]}});if(a.length===0||u.length===0)return null;const h=(await BEe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(m=>({mode:m.mode,path:m.path,oid:m.oid,type:m.type}));return U1({fs:e,gitdir:n,tree:h})}async function $Ee({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await Eh({fs:e,cache:{},dir:t,gitdir:n,trees:[Ul({ref:s}),Ul({ref:r})],map:async(c,[u,d])=>{if(c==="."||await rb.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const m=await d.oid();if(!u||await u.oid()!==m)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:m,stats:await e.lstat($t.join(t,c))}),{method:"write",filepath:c,oid:m})}});await my({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=$t.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Zs({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await la.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class Fd{constructor({fs:t,dir:n,gitdir:r=$t.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return $t.join(this.gitdir,Fd.refStash)}get refLogsStashPath(){return $t.join(this.gitdir,Fd.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await Th({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Ba("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return hZ({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new jc(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?py({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Kt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Fd.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=ek.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await my({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return ek.getStashReflogEntry(r,t)}}async function zEe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new Fd({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await Kh({fs:e,gitdir:n,fullname:!1}),a=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await dZ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=Ul({ref:"HEAD"});const h=await Sz({fs:e,dir:t,gitdir:n,treePair:[Ul({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=Jy()}const m=await Sz({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(m){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:[c[c.length-1]]});c.push(v),u=m}if(!u||!h&&!m)throw new As("changes, nothing to stash");const y=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:y,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:y}),await YY({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function pZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new Fd({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await py({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await $Ee({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function mZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new Fd({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await my(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await my({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function UEe({fs:e,dir:t,gitdir:n}){return new Fd({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function qEe({fs:e,dir:t,gitdir:n}){const r=new Fd({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await my(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function VEe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await pZ({fs:e,dir:t,gitdir:n,refIdx:r}),await mZ({fs:e,dir:t,gitdir:n,refIdx:r})}async function WEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){ct("fs",e),ct("dir",t),ct("gitdir",n),ct("op",r);const a={push:zEe,apply:pZ,drop:mZ,list:UEe,clear:qEe,pop:VEe},o=["apply","drop","pop"];try{const l=new kn(e);["refs","logs","logs/refs"].map(d=>$t.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new jc(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function HEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ct("fs",e),ct("gitdir",n),ct("filepath",r);const i=new kn(e);if(await rb.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await GEe({fs:i,cache:s,gitdir:n}),l=await gZ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await la.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const v of b)if(v.path===r)return v;return null}),u=await i.lstat($t.join(t,r)),d=l!==null,h=c!==null,m=u!==null,y=async()=>{if(h&&!HC(c,u))return c.oid;{const b=await i.read($t.join(t,r)),v=await fZ({gitdir:n,type:"blob",object:b});return h&&c.oid===v&&u.size!==-1&&la.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!m&&!h)return"absent";if(!d&&!m&&h)return"*absent";if(!d&&m&&!h)return"*added";if(!d&&m&&h)return await y()===c.oid?"added":"*added";if(d&&!m&&!h)return"deleted";if(d&&!m&&h)return l===c.oid,"*deleted";if(d&&m&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&m&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function gZ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await Zs({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=Oo.from(l);return gZ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new uo(a.oid,o,"blob",s.join("/"))}return null}async function GEe({fs:e,cache:t,gitdir:n}){let r;try{r=await Kt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof As)return[]}const{tree:s}=await sb({fs:e,cache:t,gitdir:n,oid:r});return s}async function KEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const l=new kn(e);return await Eh({fs:l,cache:a,dir:t,gitdir:n,trees:[Ul({ref:r}),$1(),Jy()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await rb.isIgnored({fs:l,dir:t,filepath:c})||!s.some(R=>KY(c,R)))return null;if(i&&!i(c))return;const[m,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[m,y,b].includes("blob");if((m==="tree"||m==="special")&&!v)return;if(m==="commit")return null;if((y==="tree"||y==="special")&&!v)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!v)return;const x=m==="blob"?await u.oid():void 0,w=b==="blob"?await h.oid():void 0;let S;m!=="blob"&&y==="blob"&&b!=="blob"?S="42":y==="blob"&&(S=await d.oid());const k=[void 0,x,S,w],C=k.map(R=>k.indexOf(R));return C.shift(),[c,...C]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function YEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,force:i=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r);const a=new kn(e);if(r===void 0)throw new No("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Kt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Kt.exists({fs:a,gitdir:n,ref:r}))throw new Fc("tag",r);await Kt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function ZEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{ct("fs",e),ct("gitdir",n),ct("filepath",s);const u=new kn(e);if(l)return await la.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const m=await u.lstat($t.join(t,s));if(m){if(m.isDirectory())throw new kh("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat($t.join(t,s)),!d)throw new As(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new kh("directory")}return await la.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new As(`file at "${s}" in index and "add" not set`);let m;if(i)m={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{m=d;const y=m.isSymbolicLink()?await u.readlink($t.join(t,s)):await u.read($t.join(t,s));i=await zo({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:s,oid:i,stats:m}),i})}catch(u){throw u.caller="git.updateIndex",u}}function XEe(){try{return sT.version}catch(e){throw e.caller="git.version",e}}async function JEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return ct("fs",e),ct("gitdir",n),ct("trees",r),await Eh({fs:new kn(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function QEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),blob:r}){try{return ct("fs",e),ct("gitdir",n),ct("blob",r),await zo({fs:new kn(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function eTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r}){try{return ct("fs",e),ct("gitdir",n),ct("commit",r),await hZ({fs:new kn(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function tTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new kn(e);if(i==="parsed"){switch(r){case"commit":s=Ys.from(s).toObject();break;case"tree":s=Oo.from(s).toObject();break;case"blob":s=ln.from(s,o);break;case"tag":s=no.from(s).toObject();break;default:throw new uo(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await zo({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function nTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{ct("fs",e),ct("gitdir",n),ct("ref",r),ct("value",s);const o=new kn(e);if(r!==yu.clean(r))throw new jc(r,yu.clean(r));if(!i&&await Kt.exists({fs:o,gitdir:n,ref:r}))throw new Fc("ref",r);a?await Kt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Kt.resolve({fs:o,gitdir:n,ref:s}),await Kt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function rTe({fs:e,gitdir:t,tag:n}){const r=no.from(n).toObject();return await zo({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function sTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tag:r}){try{return ct("fs",e),ct("gitdir",n),ct("tag",r),await rTe({fs:new kn(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function iTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tree:r}){try{return ct("fs",e),ct("gitdir",n),ct("tree",r),await U1({fs:new kn(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var $i={Errors:jCe,STAGE:Jy,TREE:Ul,WORKDIR:$1,add:XCe,abortMerge:GCe,addNote:QCe,addRemote:eke,annotatedTag:nke,branch:ske,checkout:YY,clone:gke,commit:yke,getConfig:Lke,getConfigAll:$ke,setConfig:DEe,currentBranch:bke,deleteBranch:xke,deleteRef:wke,deleteRemote:Ske,deleteTag:kke,expandOid:Rke,expandRef:Nke,fastForward:Pke,fetch:Oke,findMergeBase:Dke,findRoot:Fke,getRemoteInfo:zke,getRemoteInfo2:Uke,hashBlob:Vke,indexPack:Hke,init:Gke,isDescendent:Kke,isIgnored:Yke,listBranches:Zke,listFiles:Jke,listNotes:eEe,listRefs:tEe,listRemotes:rEe,listServerRefs:aEe,listTags:oEe,log:dEe,merge:fEe,packObjects:mEe,pull:gEe,push:wEe,readBlob:_Ee,readCommit:dZ,readNote:CEe,readObject:kEe,readTag:TEe,readTree:AEe,remove:REe,removeNote:MEe,renameBranch:jEe,resetIndex:PEe,updateIndex:ZEe,resolveRef:OEe,status:HEe,statusMatrix:KEe,tag:YEe,version:XEe,walk:JEe,writeBlob:QEe,writeCommit:eTe,writeObject:tTe,writeRef:nTe,writeTag:sTe,writeTree:iTe,stash:WEe};function aTe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function oTe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:aTe(e)}async function lTe(e,t){const n=oTe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function cTe(e){let t=0;const n=[];await lTe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function uTe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function dTe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await cTe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?uTe(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var mw={request:dTe};const gw="https://cors.isomorphic-git.org",gy=new Map,yZ=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=mr.getState();if(!n||!r)return Me.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await $i.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await $i.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await $i.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await $i.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),Me.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},yw=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=gy.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return Me.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(gy.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(Me.error("Authentication cancelled: Password/token not provided."),null)},bw=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),gy.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),gy.delete(n)),null},vw=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!gy.has(n)&&t.username&&t.password&&(gy.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},N0=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},fTe=async(e,t)=>{const n=ua,r=zr(e),s=Pu(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},bZ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??ua,a=zr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Pu(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=QE(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await $i.getRemoteInfo({http:mw,url:t,corsProxy:gw,onAuth:m=>yw(m,r),onAuthFailure:bw,onAuthSuccess:vw})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${N0(h)}`)}await $i.clone({fs:i,http:mw,dir:a,corsProxy:gw,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>yw(h,r),onAuthFailure:bw,onAuthSuccess:vw,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(Pu(a,".git"));const d=await $i.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await $i.checkout({fs:i,dir:a,ref:u})),Me.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=N0(l);if(l instanceof Error&&l.message.includes("already cloned")||Me.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},vZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ua,r=zr(e);try{await $i.init({fs:n,dir:r}),Me.success(`Initialized empty Git repository in "${bi(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),Me.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},hD=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ua,s=zr(e);try{if(!await yZ(s,r))throw new Error("Git user configuration is missing or invalid.");if(await $i.add({fs:r,dir:s,filepath:"."}),!(await $i.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){Me.info("No changes detected to commit.");return}const l=await $i.commit({fs:r,dir:s,message:t,author:{name:mr.getState().gitUserName,email:mr.getState().gitUserEmail}});Me.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),Me.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},iT=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??ua,i=zr(e);try{if(!await yZ(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await $i.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await $i.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await $i.fetch({fs:s,http:mw,dir:i,corsProxy:gw,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>yw(c,n),onAuthFailure:bw,onAuthSuccess:vw}),await $i.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${N0(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${N0(l)}`)}}await $i.pull({fs:s,http:mw,dir:i,ref:t,singleBranch:!0,author:{name:mr.getState().gitUserName,email:mr.getState().gitUserEmail},corsProxy:gw,onAuth:l=>yw(l,n),onAuthFailure:bw,onAuthSuccess:vw}),Me.success(`Pulled changes successfully for "${bi(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?Me.info(`Branch "${t}" is already up-to-date.`):Me.error(`Git pull failed: ${N0(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},pD=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??ua,i=zr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await $i.push({fs:s,http:mw,dir:i,corsProxy:gw,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>yw(c,n),onAuthFailure:bw,onAuthSuccess:vw});if(l!=null&&l.ok)Me.success(`Pushed changes successfully for "${bi(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))Me.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(Me.error(`Push rejected for "${bi(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||Me.error(`Git push failed: ${N0(l)}`),l}},xZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ua,r=zr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await $i.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);Me.info(`Git Status for "${bi(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),Me.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},Em=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ua,r=zr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),Me.error(`Error creating directory "${bi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},hTe=async e=>{try{const t={backend:g2e,name:`litechat_vfs_${e}`};return await l2e(t),ua}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),Me.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},mD=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ua,r=zr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Em(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Pu(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),Me.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},Yh=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ua,r=zr(e);try{const s=await n.promises.readFile(r);return Pe.emit(dn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),Me.error(`Error reading file "${bi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},aT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ua,s=zr(e),i=QE(s);try{i!=="/"&&await Em(i,{fsInstance:r}),await r.promises.writeFile(s,t),Pe.emit(dn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),Me.error(`Error writing file "${bi(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},gD=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??ua,s=zr(e);if(s==="/")throw Me.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Pe.emit(dn.fileDeleted,{path:s})):(await r.promises.unlink(s),Pe.emit(dn.fileDeleted,{path:s})),Me.success(`"${bi(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),Me.error(`Error deleting "${bi(s)}": ${i instanceof Error?i.message:String(i)}`),i}},wZ=async(e,t)=>{await Em(e,t)},pTe=async(e,t,n)=>{try{const r=await Yh(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=zr(e);a.download=t||bi(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||Me.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},_Z=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ua,s=zr(t);let i=0,a=0;const o=Array.from(e);try{await Em(s,{fsInstance:r});for(const l of o){const c=Pu(s,l.name);try{const u=await l.arrayBuffer();await aT(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?Me.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&Me.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":bi(s)}.`)}},mTe=async(e,t,n)=>{const r=ua;if(!e.name.toLowerCase().endsWith(".zip")){Me.error("Please select a valid ZIP file.");return}const s=zr(t);let i;try{await Em(s,{fsInstance:r}),i=await sD.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=Pu(s,d.name);if(d.dir)await Em(h,{fsInstance:r});else{const m=await d.async("uint8array");await aT(h,m,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?Me.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):Me.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":bi(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),Me.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},Cz=async(e,t="/",n)=>{const r=ua,s=new sD,i=zr(t),a=bi(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){Me.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?Me.error(`Cannot export: Path "${a}" not found.`):Me.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,m)=>{const y=await mD(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const v=m.folder(b.name);if(v)await o(b.path,v);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const v=await Yh(b.path,{fsInstance:r});m.file(b.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),Me.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||Me.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},SZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ua,s=zr(e),i=zr(t);if(s==="/"||i==="/")throw Me.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=QE(i);a!=="/"&&await Em(a,{fsInstance:r}),await r.promises.rename(s,i),Me.success(`Renamed "${bi(s)}" to "${bi(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||Me.error(`Rename failed: Original item "${bi(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?Me.error(`Rename failed: An item named "${bi(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||Me.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},gTe=1024*5,yTe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},kz=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},CZ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!0),m=e.type||"application/octet-stream",y=Yx(e.name,m),b=m.startsWith("image/"),v=m.startsWith("audio/"),x=m.startsWith("video/"),w=e.source==="vfs";E.useEffect(()=>{let I=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(I=yTe(e.contentBase64,m),I||a("Failed to decode file content for preview."),s(I)):s(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>gTe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{I&&(URL.revokeObjectURL(I),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,m,y]);const S=async()=>{if(e.source==="vfs"){Me.info("File is already in VFS.");return}const I=kz(e);if(!I){Me.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await _Z([I],"/"),Me.success(`"${e.name}" added to VFS root.`)}catch(O){console.error("Failed to add file to VFS:",O),Me.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},k=async()=>{u(!0);try{let I;if(e.source==="vfs"&&e.path){const D=await Yh(e.path);I=new Blob([D],{type:m})}else{const D=kz(e);if(!D)throw new Error("Could not reconstruct file data.");I=D}const O=URL.createObjectURL(I),B=document.createElement("a");B.href=O,B.download=e.name,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(O)}catch(I){console.error("Failed to download file:",I),Me.error(`Download failed: ${I instanceof Error?I.message:String(I)}`)}finally{u(!1)}},C=()=>h(I=>!I),R=()=>w?f.jsx($P,{className:"h-5 w-5 text-cyan-500"}):y?f.jsx(K3,{className:"h-5 w-5 text-blue-500"}):b?f.jsx(Y0,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(Xme,{className:"h-5 w-5 text-green-500"}):x?f.jsx(Yge,{className:"h-5 w-5 text-orange-500"}):f.jsx(ume,{className:"h-5 w-5 text-muted-foreground"}),A=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(Wl,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):y&&e.contentText!==void 0?f.jsx(Wy,{lang:m==="text/markdown"?"markdown":"text",code:e.contentText,filepath:e.name}):b&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),N=E.useMemo(()=>{let I="File";return w?I="VFS File":y?I="Text":b?I="Image":v?I="Audio":x&&(I="Video"),`${I} (${dw(e.size)})`},[w,y,b,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[R(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",dw(e.size),")"]}),w&&e.path&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:k,disabled:c,"aria-label":"Download file",children:c?f.jsx(Yn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(wc,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Download File"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:C,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(dE,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Yn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(LP,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Add to VFS"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(Wi,{className:"h-3.5 w-3.5"})})}),f.jsx(Sr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:C,children:N}):f.jsx("div",{className:Je("p-2 max-h-80 overflow-y-auto"),children:A()})]})},kZ=6048e5,bTe=864e5,EZ=6e4,TZ=36e5,qS=43200,Ez=1440,Tz=Symbol.for("constructDateFrom");function vi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Tz in e?e[Tz](t):e instanceof Date?new e.constructor(t):new Date(t)}function qr(e,t){return vi(t||e,e)}function AZ(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(t)?vi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function RZ(e,t,n){const r=qr(e,n==null?void 0:n.in);if(isNaN(t))return vi(e,NaN);if(!t)return r;const s=r.getDate(),i=vi(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let vTe={};function ib(){return vTe}function yy(e,t){var o,l,c,u;const n=ib(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function xw(e,t){return yy(e,{...t,weekStartsOn:1})}function NZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=vi(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=xw(s),a=vi(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=xw(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function tk(e){const t=qr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Zh(e,...t){const n=vi.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function ww(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function MZ(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t),i=ww(r),a=ww(s),o=+i-tk(i),l=+a-tk(a);return Math.round((o-l)/bTe)}function xTe(e,t){const n=NZ(e,t),r=vi(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),xw(r)}function wTe(e,t,n){return AZ(e,t*7,n)}function _Te(e,t,n){return RZ(e,t*12,n)}function STe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=vi.bind(null,s));const i=qr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),vi(r,n||NaN)}function CTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=vi.bind(null,s));const i=qr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),vi(r,n||NaN)}function j2(e,t){const n=+qr(e)-+qr(t);return n<0?-1:n>0?1:n}function kTe(e){return vi(e,Date.now())}function ETe(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t);return+ww(r)==+ww(s)}function IZ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function TTe(e){return!(!IZ(e)&&typeof e!="number"||isNaN(+qr(e)))}function jZ(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function ATe(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function RTe(e,t){return+qr(e)-+qr(t)}function NTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function PZ(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function MTe(e,t){const n=qr(e,t==null?void 0:t.in);return+NTe(n,t)==+PZ(n,t)}function ITe(e,t,n){const[r,s,i]=Zh(n==null?void 0:n.in,e,e,t),a=j2(s,i),o=Math.abs(jZ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=j2(s,i)===-a;MTe(r)&&o===1&&j2(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function jTe(e,t,n){const r=RTe(e,t)/1e3;return ATe(n==null?void 0:n.roundingMethod)(r)}function PTe(e,t){const[n,r]=Zh(e,t.start,t.end);return{start:n,end:r}}function OTe(e,t){const{start:n,end:r}=PTe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(vi(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function DTe(e,t){const n=qr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function FTe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function OZ(e,t){const n=qr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function DZ(e,t){var o,l,c,u;const n=ib(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=qr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function LTe(e,t){return DZ(e,{...t,weekStartsOn:1})}const BTe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},$Te=(e,t,n)=>{let r;const s=BTe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function cI(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const zTe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},UTe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qTe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},VTe={date:cI({formats:zTe,defaultWidth:"full"}),time:cI({formats:UTe,defaultWidth:"full"}),dateTime:cI({formats:qTe,defaultWidth:"full"})},WTe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},HTe=(e,t,n,r)=>WTe[e];function Pv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const GTe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},KTe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},YTe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ZTe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},XTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},JTe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},QTe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},eAe={ordinalNumber:QTe,era:Pv({values:GTe,defaultWidth:"wide"}),quarter:Pv({values:KTe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Pv({values:YTe,defaultWidth:"wide"}),day:Pv({values:ZTe,defaultWidth:"wide"}),dayPeriod:Pv({values:XTe,defaultWidth:"wide",formattingValues:JTe,defaultFormattingWidth:"wide"})};function Ov(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?nAe(o,d=>d.test(a)):tAe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function tAe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function nAe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function rAe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const sAe=/^(\d+)(th|st|nd|rd)?/i,iAe=/\d+/i,aAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},oAe={any:[/^b/i,/^(a|c)/i]},lAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cAe={any:[/1/i,/2/i,/3/i,/4/i]},uAe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},dAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},fAe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},hAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},pAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},mAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gAe={ordinalNumber:rAe({matchPattern:sAe,parsePattern:iAe,valueCallback:e=>parseInt(e,10)}),era:Ov({matchPatterns:aAe,defaultMatchWidth:"wide",parsePatterns:oAe,defaultParseWidth:"any"}),quarter:Ov({matchPatterns:lAe,defaultMatchWidth:"wide",parsePatterns:cAe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ov({matchPatterns:uAe,defaultMatchWidth:"wide",parsePatterns:dAe,defaultParseWidth:"any"}),day:Ov({matchPatterns:fAe,defaultMatchWidth:"wide",parsePatterns:hAe,defaultParseWidth:"any"}),dayPeriod:Ov({matchPatterns:pAe,defaultMatchWidth:"any",parsePatterns:mAe,defaultParseWidth:"any"})},oT={code:"en-US",formatDistance:$Te,formatLong:VTe,formatRelative:HTe,localize:eAe,match:gAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function yAe(e,t){const n=qr(e,t==null?void 0:t.in);return MZ(n,OZ(n))+1}function FZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+xw(n)-+xTe(n);return Math.round(r/kZ)+1}function LZ(e,t){var u,d,h,m;const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=ib(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=vi((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=yy(a,t),l=vi((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=yy(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function bAe(e,t){var o,l,c,u;const n=ib(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=LZ(e,t),i=vi((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),yy(i,t)}function BZ(e,t){const n=qr(e,t==null?void 0:t.in),r=+yy(n,t)-+bAe(n,t);return Math.round(r/kZ)+1}function vs(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Xf={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return vs(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):vs(n+1,2)},d(e,t){return vs(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return vs(e.getHours()%12||12,t.length)},H(e,t){return vs(e.getHours(),t.length)},m(e,t){return vs(e.getMinutes(),t.length)},s(e,t){return vs(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return vs(s,t.length)}},Jg={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Az={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Xf.y(e,t)},Y:function(e,t,n,r){const s=LZ(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return vs(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):vs(i,t.length)},R:function(e,t){const n=NZ(e);return vs(n,t.length)},u:function(e,t){const n=e.getFullYear();return vs(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return vs(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return vs(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Xf.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return vs(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=BZ(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):vs(s,t.length)},I:function(e,t,n){const r=FZ(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):vs(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Xf.d(e,t)},D:function(e,t,n){const r=yAe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):vs(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return vs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return vs(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return vs(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=Jg.noon:r===0?s=Jg.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=Jg.evening:r>=12?s=Jg.afternoon:r>=4?s=Jg.morning:s=Jg.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Xf.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Xf.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):vs(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):vs(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Xf.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Xf.s(e,t)},S:function(e,t){return Xf.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Nz(r);case"XXXX":case"XX":return Vp(r);case"XXXXX":case"XXX":default:return Vp(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Nz(r);case"xxxx":case"xx":return Vp(r);case"xxxxx":case"xxx":default:return Vp(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Rz(r,":");case"OOOO":default:return"GMT"+Vp(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Rz(r,":");case"zzzz":default:return"GMT"+Vp(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return vs(r,t.length)},T:function(e,t,n){return vs(+e,t.length)}};function Rz(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+vs(i,2)}function Nz(e,t){return e%60===0?(e>0?"-":"+")+vs(Math.abs(e)/60,2):Vp(e,t)}function Vp(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=vs(Math.trunc(r/60),2),i=vs(r%60,2);return n+s+t+i}const Mz=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},$Z=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},vAe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Mz(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Mz(r,t)).replace("{{time}}",$Z(s,t))},xAe={p:$Z,P:vAe},wAe=/^D+$/,_Ae=/^Y+$/,SAe=["D","DD","YY","YYYY"];function CAe(e){return wAe.test(e)}function kAe(e){return _Ae.test(e)}function EAe(e,t,n){const r=TAe(e,t,n);if(console.warn(r),SAe.includes(e))throw new RangeError(r)}function TAe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const AAe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,RAe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,NAe=/^'([^]*?)'?$/,MAe=/''/g,IAe=/[a-zA-Z]/;function Ad(e,t,n){var u,d,h,m,y,b,v,x;const r=ib(),s=(n==null?void 0:n.locale)??r.locale??oT,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((b=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=qr(e,n==null?void 0:n.in);if(!TTe(o))throw new RangeError("Invalid time value");let l=t.match(RAe).map(w=>{const S=w[0];if(S==="p"||S==="P"){const k=xAe[S];return k(w,s.formatLong)}return w}).join("").match(AAe).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const S=w[0];if(S==="'")return{isToken:!1,value:jAe(w)};if(Az[S])return{isToken:!0,value:w};if(S.match(IAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const S=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&kAe(S)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&CAe(S))&&EAe(S,t,String(e));const k=Az[S[0]];return k(o,S,s.localize,c)}).join("")}function jAe(e){const t=e.match(NAe);return t?t[1].replace(MAe,"'"):e}function PAe(e,t,n){const r=ib(),s=(n==null?void 0:n.locale)??r.locale??oT,i=2520,a=j2(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=Zh(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=jTe(c,l),d=(tk(c)-tk(l))/1e3,h=Math.round((u-d)/60);let m;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<Ez){const y=Math.round(h/60);return s.formatDistance("aboutXHours",y,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<qS){const y=Math.round(h/Ez);return s.formatDistance("xDays",y,o)}else if(h<qS*2)return m=Math.round(h/qS),s.formatDistance("aboutXMonths",m,o)}if(m=ITe(c,l),m<12){const y=Math.round(h/qS);return s.formatDistance("xMonths",y,o)}else{const y=m%12,b=Math.trunc(m/12);return y<3?s.formatDistance("aboutXYears",b,o):y<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function zZ(e,t){return PAe(e,kTe(e),t)}function OAe(e,t){const n=qr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=vi(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function DAe(e,t){return qr(e,t==null?void 0:t.in).getMonth()}function FAe(e,t){return qr(e,t==null?void 0:t.in).getFullYear()}function LAe(e,t){return+qr(e)>+qr(t)}function BAe(e,t){return+qr(e)<+qr(t)}function $Ae(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function zAe(e,t,n){const[r,s]=Zh(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function UAe(e,t){const n=()=>vi(t==null?void 0:t.in,NaN),s=HAe(e);let i;if(s.date){const c=GAe(s.date,2);i=KAe(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=YAe(s.time),isNaN(o)))return n();if(s.timezone){if(l=ZAe(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=qr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return qr(a+o+l,t==null?void 0:t.in)}const VS={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},qAe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,VAe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,WAe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function HAe(e){const t={},n=e.split(VS.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],VS.timeZoneDelimiter.test(t.date)&&(t.date=e.split(VS.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=VS.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function GAe(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function KAe(e,t){if(t===null)return new Date(NaN);const n=e.match(qAe);if(!n)return new Date(NaN);const r=!!n[4],s=Dv(n[1]),i=Dv(n[2])-1,a=Dv(n[3]),o=Dv(n[4]),l=Dv(n[5])-1;if(r)return tRe(t,o,l)?XAe(t,o,l):new Date(NaN);{const c=new Date(0);return!QAe(t,i,a)||!eRe(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function Dv(e){return e?parseInt(e):1}function YAe(e){const t=e.match(VAe);if(!t)return NaN;const n=uI(t[1]),r=uI(t[2]),s=uI(t[3]);return nRe(n,r,s)?n*TZ+r*EZ+s*1e3:NaN}function uI(e){return e&&parseFloat(e.replace(",","."))||0}function ZAe(e){if(e==="Z")return 0;const t=e.match(WAe);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return rRe(r,s)?n*(r*TZ+s*EZ):NaN}function XAe(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const JAe=[31,null,31,30,31,30,31,31,30,31,30,31];function UZ(e){return e%400===0||e%4===0&&e%100!==0}function QAe(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(JAe[t]||(UZ(e)?29:28))}function eRe(e,t){return t>=1&&t<=(UZ(e)?366:365)}function tRe(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function nRe(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function rRe(e,t){return t>=0&&t<=59}function sRe(e,t,n){const r=qr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=vi(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=OAe(a);return r.setMonth(t,Math.min(i,o)),r}function iRe(e,t,n){const r=qr(e,n==null?void 0:n.in);return isNaN(+r)?vi(e,NaN):(r.setFullYear(t),r)}const er=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:a,size:o,onClick:s,disabled:i,className:Je("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Je("h-3.5 w-3.5",n)}):t})}),f.jsx(Sr,{side:r,children:f.jsx("p",{children:e})})]})})},Iz={};function aRe(e){let t=Iz[e];if(t)return t;t=Iz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function by(e,t){typeof t!="string"&&(t=by.defaultChars);const n=aRe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+=""}return s})}by.defaultChars=";/?:@&=+$,#";by.componentChars="";const jz={};function oRe(e){let t=jz[e];if(t)return t;t=jz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function V1(e,t,n){typeof t!="string"&&(n=t,t=V1.defaultChars),typeof n>"u"&&(n=!0);const r=oRe(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}V1.defaultChars=";/?:@&=+$,-_.!~*'()#";V1.componentChars="-_.!~*'()";function yD(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function nk(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const lRe=/^([a-z0-9.+-]+:)/i,cRe=/:[0-9]*$/,uRe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,dRe=["<",">",'"',"`"," ","\r",`
`,"	"],fRe=["{","}","|","\\","^","`"].concat(dRe),hRe=["'"].concat(fRe),Pz=["%","/","?",";","#"].concat(hRe),Oz=["/","?","#"],pRe=255,Dz=/^[+a-z0-9A-Z_-]{0,63}$/,mRe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Fz={javascript:!0,"javascript:":!0},Lz={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function bD(e,t){if(e&&e instanceof nk)return e;const n=new nk;return n.parse(e,t),n}nk.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=uRe.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=lRe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&Fz[a])&&(i=i.substr(2),this.slashes=!0)),!Fz[a]&&(s||a&&!Lz[a])){let c=-1;for(let y=0;y<Oz.length;y++)r=i.indexOf(Oz[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let y=0;y<Pz.length;y++)r=i.indexOf(Pz[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){const y=this.hostname.split(/\./);for(let b=0,v=y.length;b<v;b++){const x=y[b];if(x&&!x.match(Dz)){let w="";for(let S=0,k=x.length;S<k;S++)x.charCodeAt(S)>127?w+="x":w+=x[S];if(!w.match(Dz)){const S=y.slice(0,b),k=y.slice(b+1),C=x.match(mRe);C&&(S.push(C[1]),k.unshift(C[2])),k.length&&(i=k.join(".")+i),this.hostname=S.join(".");break}}}}this.hostname.length>pRe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),Lz[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};nk.prototype.parseHost=function(e){let t=cRe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const gRe=Object.freeze(Object.defineProperty({__proto__:null,decode:by,encode:V1,format:yD,parse:bD},Symbol.toStringTag,{value:"Module"})),qZ=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,VZ=/[\0-\x1F\x7F-\x9F]/,yRe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,vD=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,WZ=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,HZ=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,bRe=Object.freeze(Object.defineProperty({__proto__:null,Any:qZ,Cc:VZ,Cf:yRe,P:vD,S:WZ,Z:HZ},Symbol.toStringTag,{value:"Module"})),vRe=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),xRe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var dI;const wRe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),_Re=(dI=String.fromCodePoint)!==null&&dI!==void 0?dI:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function SRe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=wRe.get(e))!==null&&t!==void 0?t:e}var aa;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(aa||(aa={}));const CRe=32;var uh;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(uh||(uh={}));function Dj(e){return e>=aa.ZERO&&e<=aa.NINE}function kRe(e){return e>=aa.UPPER_A&&e<=aa.UPPER_F||e>=aa.LOWER_A&&e<=aa.LOWER_F}function ERe(e){return e>=aa.UPPER_A&&e<=aa.UPPER_Z||e>=aa.LOWER_A&&e<=aa.LOWER_Z||Dj(e)}function TRe(e){return e===aa.EQUALS||ERe(e)}var ea;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(ea||(ea={}));var oh;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(oh||(oh={}));class ARe{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=ea.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=oh.Strict}startEntity(t){this.decodeMode=t,this.state=ea.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case ea.EntityStart:return t.charCodeAt(n)===aa.NUM?(this.state=ea.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=ea.NamedEntity,this.stateNamedEntity(t,n));case ea.NumericStart:return this.stateNumericStart(t,n);case ea.NumericDecimal:return this.stateNumericDecimal(t,n);case ea.NumericHex:return this.stateNumericHex(t,n);case ea.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|CRe)===aa.LOWER_X?(this.state=ea.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=ea.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Dj(s)||kRe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(Dj(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===aa.SEMI)this.consumed+=1;else if(this.decodeMode===oh.Strict)return 0;return this.emitCodePoint(SRe(this.result),this.consumed),this.errors&&(t!==aa.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&uh.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=RRe(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===oh.Attribute&&(i===0||TRe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&uh.VALUE_LENGTH)>>14,i!==0){if(a===aa.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==oh.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&uh.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~uh.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case ea.NamedEntity:return this.result!==0&&(this.decodeMode!==oh.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case ea.NumericDecimal:return this.emitNumericEntity(0,2);case ea.NumericHex:return this.emitNumericEntity(0,3);case ea.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case ea.EntityStart:return 0}}}function GZ(e){let t="";const n=new ARe(e,r=>t+=_Re(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function RRe(e,t,n,r){const s=(t&uh.BRANCH_LENGTH)>>7,i=t&uh.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const NRe=GZ(vRe);GZ(xRe);function KZ(e,t=oh.Legacy){return NRe(e,t)}function MRe(e){return Object.prototype.toString.call(e)}function xD(e){return MRe(e)==="[object String]"}const IRe=Object.prototype.hasOwnProperty;function jRe(e,t){return IRe.call(e,t)}function lT(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function YZ(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function wD(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function rk(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const ZZ=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,PRe=/&([a-z#][a-z0-9]{1,31});/gi,ORe=new RegExp(ZZ.source+"|"+PRe.source,"gi"),DRe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function FRe(e,t){if(t.charCodeAt(0)===35&&DRe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return wD(r)?rk(r):e}const n=KZ(e);return n!==e?n:e}function LRe(e){return e.indexOf("\\")<0?e:e.replace(ZZ,"$1")}function vy(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(ORe,function(t,n,r){return n||FRe(t,r)})}const BRe=/[&<>"]/,$Re=/[&<>"]/g,zRe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function URe(e){return zRe[e]}function Ah(e){return BRe.test(e)?e.replace($Re,URe):e}const qRe=/[.?*+^$[\]\\(){}|-]/g;function VRe(e){return e.replace(qRe,"\\$&")}function Fs(e){switch(e){case 9:case 32:return!0}return!1}function _w(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Sw(e){return vD.test(e)||WZ.test(e)}function Cw(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function cT(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const WRe={mdurl:gRe,ucmicro:bRe},HRe=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:YZ,assign:lT,escapeHtml:Ah,escapeRE:VRe,fromCodePoint:rk,has:jRe,isMdAsciiPunct:Cw,isPunctChar:Sw,isSpace:Fs,isString:xD,isValidEntityCode:wD,isWhiteSpace:_w,lib:WRe,normalizeReference:cT,unescapeAll:vy,unescapeMd:LRe},Symbol.toStringTag,{value:"Module"}));function GRe(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function KRe(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=vy(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=vy(e.slice(t,s)),i.pos=s,i.ok=!0),i}function YRe(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=vy(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=vy(e.slice(t,i)),a}const ZRe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:KRe,parseLinkLabel:GRe,parseLinkTitle:YRe},Symbol.toStringTag,{value:"Module"})),Bu={};Bu.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+Ah(i.content)+"</code>"};Bu.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+Ah(e[t].content)+`</code></pre>
`};Bu.fence=function(e,t,n,r,s){const i=e[t],a=i.info?vy(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||Ah(i.content):c=Ah(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};Bu.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};Bu.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Bu.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Bu.text=function(e,t){return Ah(e[t].content)};Bu.html_block=function(e,t){return e[t].content};Bu.html_inline=function(e,t){return e[t].content};function ab(){this.rules=lT({},Bu)}ab.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+Ah(t.attrs[n][0])+'="'+Ah(t.attrs[n][1])+'"';return s};ab.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};ab.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};ab.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};ab.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function Do(){this.__rules__=[],this.__cache__=null}Do.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};Do.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};Do.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};Do.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Do.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};Do.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};Do.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};Do.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};Do.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};Do.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function Lc(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Lc.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};Lc.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};Lc.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};Lc.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};Lc.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function XZ(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}XZ.prototype.Token=Lc;const XRe=/\r\n?|\n/g,JRe=/\0/g;function QRe(e){let t;t=e.src.replace(XRe,`
`),t=t.replace(JRe,""),e.src=t}function eNe(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function tNe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function nNe(e){return/^<a[>\s]/i.test(e)}function rNe(e){return/^<\/a\s*>/i.test(e)}function sNe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(nNe(o.content)&&i>0&&i--,rNe(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let m=0;m<c.length;m++){const y=c[m].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let v=c[m].text;c[m].schema?c[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[m].index;if(x>h){const C=new e.Token("text","",0);C.content=l.slice(h,x),C.level=d,u.push(C)}const w=new e.Token("link_open","a",1);w.attrs=[["href",b]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const S=new e.Token("text","",0);S.content=v,S.level=d,u.push(S);const k=new e.Token("link_close","a",-1);k.level=--d,k.markup="linkify",k.info="auto",u.push(k),h=c[m].lastIndex}if(h<l.length){const m=new e.Token("text","",0);m.content=l.slice(h),m.level=d,u.push(m)}t[n].children=s=YZ(s,a,u)}}}}const JZ=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,iNe=/\((c|tm|r)\)/i,aNe=/\((c|tm|r)\)/ig,oNe={c:"",r:"",tm:""};function lNe(e,t){return oNe[t.toLowerCase()]}function cNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(aNe,lNe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function uNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&JZ.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function dNe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(iNe.test(e.tokens[t].content)&&cNe(e.tokens[t].children),JZ.test(e.tokens[t].content)&&uNe(e.tokens[t].children))}const fNe=/['"]/,Bz=/['"]/g,$z="";function WS(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function hNe(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){Bz.lastIndex=l;const u=Bz.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const m=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const v=Cw(y)||Sw(String.fromCharCode(y)),x=Cw(b)||Sw(String.fromCharCode(b)),w=_w(y),S=_w(b);if(S?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(S||x||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){m&&(i.content=WS(i.content,u.index,$z));continue}if(h)for(n=r.length-1;n>=0;n--){let k=r[n];if(r[n].level<a)break;if(k.single===m&&r[n].level===a){k=r[n];let C,R;m?(C=t.md.options.quotes[2],R=t.md.options.quotes[3]):(C=t.md.options.quotes[0],R=t.md.options.quotes[1]),i.content=WS(i.content,u.index,R),e[k.token].content=WS(e[k.token].content,k.pos,C),l+=R.length-1,k.token===s&&(l+=C.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:m,level:a}):h&&m&&(i.content=WS(i.content,u.index,$z))}}}function pNe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!fNe.test(e.tokens[t].content)||hNe(e.tokens[t].children,e)}function mNe(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const fI=[["normalize",QRe],["block",eNe],["inline",tNe],["linkify",sNe],["replacements",dNe],["smartquotes",pNe],["text_join",mNe]];function _D(){this.ruler=new Do;for(let e=0;e<fI.length;e++)this.ruler.push(fI[e][0],fI[e][1])}_D.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};_D.prototype.State=XZ;function $u(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Fs(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}$u.prototype.push=function(e,t,n){const r=new Lc(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};$u.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};$u.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};$u.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Fs(r))break}return t};$u.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Fs(this.src.charCodeAt(--t)))return t+1;return t};$u.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};$u.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};$u.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Fs(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};$u.prototype.Token=Lc;const gNe=65536;function hI(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function zz(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function yNe(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Fs(o)||a===45&&Fs(o))return!1;for(;i<e.eMarks[s];){const k=e.src.charCodeAt(i);if(k!==124&&k!==45&&k!==58&&!Fs(k))return!1;i++}let l=hI(e,t+1),c=l.split("|");const u=[];for(let k=0;k<c.length;k++){const C=c[k].trim();if(!C){if(k===0||k===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(C))return!1;C.charCodeAt(C.length-1)===58?u.push(C.charCodeAt(0)===58?"center":"right"):C.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=hI(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=zz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const m=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let k=0;k<c.length;k++){const C=e.push("th_open","th",1);u[k]&&(C.attrs=[["style","text-align:"+u[k]]]);const R=e.push("inline","",0);R.content=c[k].trim(),R.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,S=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let k=!1;for(let R=0,A=m.length;R<A;R++)if(m[R](e,s,n,!0)){k=!0;break}if(k||(l=hI(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=zz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>gNe))break;if(s===t+2){const R=e.push("tbody_open","tbody",1);R.map=w=[t+2,0]}const C=e.push("tr_open","tr",1);C.map=[s,s+1];for(let R=0;R<d;R++){const A=e.push("td_open","td",1);u[R]&&(A.attrs=[["style","text-align:"+u[R]]]);const N=e.push("inline","",0);N.content=c[R]?c[R].trim():"",N.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=h,e.line=s,!0}function bNe(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function vNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const m=e.push("fence","code",0);return m.info=u,m.content=e.getLines(t+1,d,l,!0),m.markup=c,m.map=[t,e.line],!0}function xNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let m=!1,y;for(y=t;y<n;y++){const S=e.sCount[y]<e.blkIndent;if(s=e.bMarks[y]+e.tShift[y],i=e.eMarks[y],s>=i)break;if(e.src.charCodeAt(s++)===62&&!S){let C=e.sCount[y]+1,R,A;e.src.charCodeAt(s)===32?(s++,C++,A=!1,R=!0):e.src.charCodeAt(s)===9?(R=!0,(e.bsCount[y]+C)%4===3?(s++,C++,A=!1):A=!0):R=!1;let N=C;for(o.push(e.bMarks[y]),e.bMarks[y]=s;s<i;){const I=e.src.charCodeAt(s);if(Fs(I))I===9?N+=4-(N+e.bsCount[y]+(A?1:0))%4:N++;else break;s++}m=s>=i,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(R?1:0),c.push(e.sCount[y]),e.sCount[y]=N-C,u.push(e.tShift[y]),e.tShift[y]=s-e.bMarks[y];continue}if(m)break;let k=!1;for(let C=0,R=d.length;C<R;C++)if(d[C](e,y,n,!0)){k=!0;break}if(k){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,y);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=b,!0}function wNe(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Fs(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function Uz(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Fs(i))return-1}return r}function qz(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Fs(i))?-1:s}function _Ne(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function SNe(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,m;if((m=qz(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,m-1)),u&&h!==1)return!1}else if((m=Uz(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(m)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(m-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(y);let x=!1;const w=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){i=m,s=e.eMarks[l];const k=e.sCount[l]+m-(e.bMarks[l]+e.tShift[l]);let C=k;for(;i<s;){const Z=e.src.charCodeAt(i);if(Z===9)C+=4-(C+e.bsCount[l])%4;else if(Z===32)C++;else break;i++}const R=i;let A;R>=s?A=1:A=C-k,A>4&&(A=1);const N=k+A;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const I=[l,0];o.map=I,d&&(o.info=e.src.slice(a,m-1));const O=e.tight,B=e.tShift[l],D=e.sCount[l],W=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=N,e.tight=!0,e.tShift[l]=R-e.bMarks[l],e.sCount[l]=C,R>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=W,e.tShift[l]=B,e.sCount[l]=D,e.tight=O,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,I[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let P=!1;for(let Z=0,U=w.length;Z<U;Z++)if(w[Z](e,l,n,!0)){P=!0;break}if(P)break;if(d){if(m=qz(e,l),m<0)break;a=e.bMarks[l]+e.tShift[l]}else if(m=Uz(e,l),m<0)break;if(y!==e.src.charCodeAt(m-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),v[1]=l,e.line=l,e.parentType=S,c&&_Ne(e,b),!0}function CNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const S=e.lineMax;if(w>=S||e.isEmpty(w))return null;let k=!1;if(e.sCount[w]-e.blkIndent>3&&(k=!0),e.sCount[w]<0&&(k=!0),!k){const A=e.md.block.ruler.getRules("reference"),N=e.parentType;e.parentType="reference";let I=!1;for(let O=0,B=A.length;O<B;O++)if(A[O](e,w,S,!0)){I=!0;break}if(e.parentType=N,I)return null}const C=e.bMarks[w]+e.tShift[w],R=e.eMarks[w];return e.src.slice(C,R+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Fs(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,m=a,y=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Fs(w))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let v;for(s<i&&y!==s&&b.ok?(v=b.str,s=b.pos):(v="",s=h,a=m);s<i;){const w=l.charCodeAt(s);if(!Fs(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=m;s<i;){const w=l.charCodeAt(s);if(!Fs(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=cT(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const kNe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ENe="[a-zA-Z_:][a-zA-Z0-9:._-]*",TNe="[^\"'=<>`\\x00-\\x20]+",ANe="'[^']*'",RNe='"[^"]*"',NNe="(?:"+TNe+"|"+ANe+"|"+RNe+")",MNe="(?:\\s+"+ENe+"(?:\\s*=\\s*"+NNe+")?)",QZ="<[A-Za-z][A-Za-z0-9\\-]*"+MNe+"*\\s*\\/?>",eX="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",INe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",jNe="<[?][\\s\\S]*?[?]>",PNe="<![A-Za-z][^>]*>",ONe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",DNe=new RegExp("^(?:"+QZ+"|"+eX+"|"+INe+"|"+jNe+"|"+PNe+"|"+ONe+")"),FNe=new RegExp("^(?:"+QZ+"|"+eX+")"),Qg=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+kNe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(FNe.source+"\\s*$"),/^$/,!1]];function LNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<Qg.length&&!Qg[o][0].test(a);o++);if(o===Qg.length)return!1;if(r)return Qg[o][2];let l=t+1;if(!Qg[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),Qg[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function BNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Fs(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Fs(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function $Ne(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let m=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(m<y&&(a=e.src.charCodeAt(m),(a===45||a===61)&&(m=e.skipChars(m,a),m=e.skipSpaces(m),m>=y))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let m=0,y=r.length;m<y;m++)if(r[m](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function zNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const HS=[["table",yNe,["paragraph","reference"]],["code",bNe],["fence",vNe,["paragraph","reference","blockquote","list"]],["blockquote",xNe,["paragraph","reference","blockquote","list"]],["hr",wNe,["paragraph","reference","blockquote","list"]],["list",SNe,["paragraph","reference","blockquote"]],["reference",CNe],["html_block",LNe,["paragraph","reference","blockquote"]],["heading",BNe,["paragraph","reference","blockquote"]],["lheading",$Ne],["paragraph",zNe]];function uT(){this.ruler=new Do;for(let e=0;e<HS.length;e++)this.ruler.push(HS[e][0],HS[e][1],{alt:(HS[e][2]||[]).slice()})}uT.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};uT.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};uT.prototype.State=$u;function W1(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}W1.prototype.pushPending=function(){const e=new Lc("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};W1.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new Lc(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};W1.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=Cw(s)||Sw(String.fromCharCode(s)),c=Cw(o)||Sw(String.fromCharCode(o)),u=_w(s),d=_w(o),h=!d&&(!c||u||l),m=!u&&(!l||d||c);return{can_open:h&&(t||!m||l),can_close:m&&(t||!h||c),length:a}};W1.prototype.Token=Lc;function UNe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function qNe(e,t){let n=e.pos;for(;n<e.posMax&&!UNe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const VNe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function WNe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(VNe);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function HNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Fs(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const SD=[];for(let e=0;e<256;e++)SD.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){SD[e.charCodeAt(0)]=1});function GNe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Fs(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&SD[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function KNe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function YNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function Vz(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function ZNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Vz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Vz(e,t[r].delimiters)}const tX={tokenize:YNe,postProcess:ZNe};function XNe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function Wz(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function JNe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Wz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Wz(e,t[r].delimiters)}const nX={tokenize:XNe,postProcess:JNe};function QNe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,m=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(m<0)return!1;let y=m+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,s=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?y=s.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);if(s=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&s.ok)for(o=s.str,y=s.pos;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=m+1):y=m+1,r||(r=e.src.slice(h,m)),i=e.env.references[cT(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=m;const b=e.push("link_open","a",1),v=[["href",a]];b.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function eMe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const m=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(i=y+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=y+1):i=y+1,s||(s=e.src.slice(m,y)),a=e.env.references[cT(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(m,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=b,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const tMe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,nMe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function rMe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(nMe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(tMe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function sMe(e){return/^<a[>\s]/i.test(e)}function iMe(e){return/^<\/a\s*>/i.test(e)}function aMe(e){const t=e|32;return t>=97&&t<=122}function oMe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!aMe(s))return!1;const i=e.src.slice(r).match(DNe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],sMe(a.content)&&e.linkLevel++,iMe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const lMe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,cMe=/^&([a-z][a-z0-9]{1,31});/i;function uMe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(lMe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=wD(a)?rk(a):rk(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(cMe);if(i){const a=KZ(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function Hz(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const m=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+m,i[c]=m,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function dMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Hz(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Hz(t[r].delimiters)}function fMe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const pI=[["text",qNe],["linkify",WNe],["newline",HNe],["escape",GNe],["backticks",KNe],["strikethrough",tX.tokenize],["emphasis",nX.tokenize],["link",QNe],["image",eMe],["autolink",rMe],["html_inline",oMe],["entity",uMe]],mI=[["balance_pairs",dMe],["strikethrough",tX.postProcess],["emphasis",nX.postProcess],["fragments_join",fMe]];function H1(){this.ruler=new Do;for(let e=0;e<pI.length;e++)this.ruler.push(pI[e][0],pI[e][1]);this.ruler2=new Do;for(let e=0;e<mI.length;e++)this.ruler2.push(mI[e][0],mI[e][1])}H1.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};H1.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};H1.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};H1.prototype.State=W1;function hMe(e){const t={};e=e||{},t.src_Any=qZ.source,t.src_Cc=VZ.source,t.src_Z=HZ.source,t.src_P=vD.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function Fj(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function dT(e){return Object.prototype.toString.call(e)}function pMe(e){return dT(e)==="[object String]"}function mMe(e){return dT(e)==="[object Object]"}function gMe(e){return dT(e)==="[object RegExp]"}function Gz(e){return dT(e)==="[object Function]"}function yMe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const rX={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function bMe(e){return Object.keys(e||{}).reduce(function(t,n){return t||rX.hasOwnProperty(n)},!1)}const vMe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},xMe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",wMe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function _Me(e){e.__index__=-1,e.__text_cache__=""}function SMe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function Kz(){return function(e,t){t.normalize(e)}}function sk(e){const t=e.re=hMe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(xMe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,mMe(l)){gMe(l.validate)?c.validate=SMe(l.validate):Gz(l.validate)?c.validate=l.validate:i(o,l),Gz(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=Kz();return}if(pMe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:Kz()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(yMe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),_Me(e)}function CMe(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function Lj(e,t){const n=new CMe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function pl(e,t){if(!(this instanceof pl))return new pl(e,t);t||bMe(e)&&(t=e,e={}),this.__opts__=Fj({},rX,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Fj({},vMe,e),this.__compiled__={},this.__tlds__=wMe,this.__tlds_replaced__=!1,this.re={},sk(this)}pl.prototype.add=function(t,n){return this.__schemas__[t]=n,sk(this),this};pl.prototype.set=function(t){return this.__opts__=Fj(this.__opts__,t),this};pl.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};pl.prototype.pretest=function(t){return this.re.pretest.test(t)};pl.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};pl.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(Lj(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(Lj(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};pl.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,Lj(this,0)):null};pl.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),sk(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,sk(this),this)};pl.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};pl.prototype.onCompile=function(){};const M0=2147483647,bu=36,CD=1,kw=26,kMe=38,EMe=700,sX=72,iX=128,aX="-",TMe=/^xn--/,AMe=/[^\0-\x7F]/,RMe=/[\x2E\u3002\uFF0E\uFF61]/g,NMe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},gI=bu-CD,vu=Math.floor,yI=String.fromCharCode;function sh(e){throw new RangeError(NMe[e])}function MMe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function oX(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(RMe,".");const s=e.split("."),i=MMe(s,t).join(".");return r+i}function lX(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const IMe=e=>String.fromCodePoint(...e),jMe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:bu},Yz=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},cX=function(e,t,n){let r=0;for(e=n?vu(e/EMe):e>>1,e+=vu(e/t);e>gI*kw>>1;r+=bu)e=vu(e/gI);return vu(r+(gI+1)*e/(e+kMe))},uX=function(e){const t=[],n=e.length;let r=0,s=iX,i=sX,a=e.lastIndexOf(aX);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&sh("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=bu;;d+=bu){o>=n&&sh("invalid-input");const h=jMe(e.charCodeAt(o++));h>=bu&&sh("invalid-input"),h>vu((M0-r)/u)&&sh("overflow"),r+=h*u;const m=d<=i?CD:d>=i+kw?kw:d-i;if(h<m)break;const y=bu-m;u>vu(M0/y)&&sh("overflow"),u*=y}const c=t.length+1;i=cX(r-l,c,l==0),vu(r/c)>M0-s&&sh("overflow"),s+=vu(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},dX=function(e){const t=[];e=lX(e);const n=e.length;let r=iX,s=0,i=sX;for(const l of e)l<128&&t.push(yI(l));const a=t.length;let o=a;for(a&&t.push(aX);o<n;){let l=M0;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>vu((M0-s)/c)&&sh("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>M0&&sh("overflow"),u===r){let d=s;for(let h=bu;;h+=bu){const m=h<=i?CD:h>=i+kw?kw:h-i;if(d<m)break;const y=d-m,b=bu-m;t.push(yI(Yz(m+y%b,0))),d=vu(y/b)}t.push(yI(Yz(d,0))),i=cX(s,c,o===a),s=0,++o}++s,++r}return t.join("")},PMe=function(e){return oX(e,function(t){return TMe.test(t)?uX(t.slice(4).toLowerCase()):t})},OMe=function(e){return oX(e,function(t){return AMe.test(t)?"xn--"+dX(t):t})},fX={version:"2.3.1",ucs2:{decode:lX,encode:IMe},decode:uX,encode:dX,toASCII:OMe,toUnicode:PMe},DMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},FMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},LMe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},BMe={default:DMe,zero:FMe,commonmark:LMe},$Me=/^(vbscript|javascript|file|data):/,zMe=/^data:image\/(gif|png|jpeg|webp);/;function UMe(e){const t=e.trim().toLowerCase();return $Me.test(t)?zMe.test(t):!0}const hX=["http:","https:","mailto:"];function qMe(e){const t=bD(e,!0);if(t.hostname&&(!t.protocol||hX.indexOf(t.protocol)>=0))try{t.hostname=fX.toASCII(t.hostname)}catch{}return V1(yD(t))}function VMe(e){const t=bD(e,!0);if(t.hostname&&(!t.protocol||hX.indexOf(t.protocol)>=0))try{t.hostname=fX.toUnicode(t.hostname)}catch{}return by(yD(t),by.defaultChars+"%")}function ml(e,t){if(!(this instanceof ml))return new ml(e,t);t||xD(e)||(t=e||{},e="default"),this.inline=new H1,this.block=new uT,this.core=new _D,this.renderer=new ab,this.linkify=new pl,this.validateLink=UMe,this.normalizeLink=qMe,this.normalizeLinkText=VMe,this.utils=HRe,this.helpers=lT({},ZRe),this.options={},this.configure(e),t&&this.set(t)}ml.prototype.set=function(e){return lT(this.options,e),this};ml.prototype.configure=function(e){const t=this;if(xD(e)){const n=e;if(e=BMe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};ml.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};ml.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};ml.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};ml.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};ml.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};ml.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};ml.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const bI=new ml({html:!1,linkify:!0,breaks:!0});function fT(e){return E.useMemo(()=>{var n;if(!e)return[];try{const r=bI.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;s.push({type:"block",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=bI.renderer.render(l,bI.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const WMe=({markdownContent:e})=>{const t=fT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>typeof n=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`):n.type==="block"?f.jsx(Wy,{lang:n.lang,code:n.code,filepath:n.filepath},`block-${r}`):null)}):null},hT=Ve.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0})=>{var b,v;const s=mr(x=>x.foldUserMessagesOnCompletion),[i,a]=E.useState(r&&s),[o,l]=E.useState(!1);E.useEffect(()=>{r&&s&&a(!0)},[r,s]);const c=t?zZ(new Date(t),{addSuffix:!0}):"Sending...",u=((b=e.metadata)==null?void 0:b.attachedFiles)&&e.metadata.attachedFiles.length>0,d=e.content&&e.content.trim().length>0,h=E.useCallback(()=>a(x=>!x),[]),m=E.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),l(!0),Me.success("User prompt copied!"),setTimeout(()=>l(!1),1500)}catch(x){Me.error("Failed to copy prompt."),console.error("Clipboard copy failed:",x)}},[e.content]),y=E.useMemo(()=>{var w;let x="";return d&&(x+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),d&&u&&(x+=" + "),u&&(x+=`${(w=e.metadata.attachedFiles)==null?void 0:w.length} file(s)`),x||"[Empty Prompt]"},[d,u,e.content,e.metadata]);return f.jsxs("div",{className:Je("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Je("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(Hge,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[d&&f.jsx(er,{tooltipText:"Copy Prompt",onClick:m,"aria-label":"Copy user prompt",icon:o?f.jsx(so,{className:"text-green-500"}):f.jsx(hE,{}),className:"h-5 w-5"}),(d||u)&&f.jsx(er,{tooltipText:i?"Unfold":"Fold",onClick:h,"aria-label":i?"Unfold prompt":"Fold prompt",icon:i?f.jsx(Yl,{}):f.jsx(Lh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:c})})]}),!i&&f.jsxs(f.Fragment,{children:[u&&f.jsx("div",{className:"mb-2 space-y-1",children:(v=e.metadata.attachedFiles)==null?void 0:v.map(x=>f.jsx(CZ,{fileMeta:x,isReadOnly:!0},x.id))}),f.jsx(WMe,{markdownContent:e.content})]}),i&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:h,children:y})]})});hT.displayName="UserPromptDisplay";const HMe=(e,t,n,r)=>typeof e=="string"?e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null:e.type==="block"?f.jsx(Wy,{lang:e.lang,code:e.code,filepath:e.filepath,isStreaming:n},`block-${t}`):null,GMe=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s}=mr(gn(h=>({enableStreamingMarkdown:h.enableStreamingMarkdown}))),i=fT(s?t:null),a=Ui(gn(h=>Object.values(h.canvasControls))),o=E.useCallback((h,m)=>a.filter(y=>y.type==="tool-call-step"&&y.targetSlot===h&&y.renderer).map(y=>y.renderer?f.jsx(Ve.Fragment,{children:y.renderer(m)},y.id):null).filter(Boolean),[a]),{toolCallStrings:l,toolResultStrings:c}=Ln(gn(h=>{var y,b;const m=h.interactions.find(v=>v.id===e);return{toolCallStrings:(y=m==null?void 0:m.metadata)==null?void 0:y.toolCalls,toolResultStrings:(b=m==null?void 0:m.metadata)==null?void 0:b.toolResults}})),u=E.useMemo(()=>{if(!l)return[];try{const h=l.map(y=>JSON.parse(y)),m=(c==null?void 0:c.map(y=>JSON.parse(y)))??[];return h.map(y=>{const b=m.find(v=>v.toolCallId===y.toolCallId);return{call:y,result:b}})}catch(h){return console.error("[StreamingContentView] Error parsing tool call/result strings:",h),[]}},[l,c]),d=E.useMemo(()=>s?i.map((h,m)=>HMe(h,m,n&&m===i.length-1)).filter(Boolean):[],[s,i,n,e]);return!s&&!t&&u.length===0?n?f.jsx("div",{className:Je("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Je("streaming-content-view overflow-wrap-anywhere",r),children:[u.map(({call:h,result:m},y)=>{const b={interactionId:e,toolCall:h,toolResult:m,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:o("tool-call-content",b)},`tool-step-${h.toolCallId||y}`)}),s?d:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new ml().render(t)}}):null]})},KMe=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(er,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(Pge,{}),variant:r,size:n,className:t}),YMe=Symbol("Let zodToJsonSchema decide on which parser to use"),Zz={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},ZMe=e=>typeof e=="string"?{...Zz,name:e}:{...Zz,...e},XMe=e=>{const t=ZMe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function pX(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function xs(e,t,n,r,s){e[t]=n,pX(e,t,r,s)}function JMe(){return{}}function QMe(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==Qt.ZodAny&&(n.items=ls(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&xs(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&xs(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(xs(n,"minItems",e.exactLength.value,e.exactLength.message,t),xs(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function eIe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?xs(n,"minimum",r.value,r.message,t):xs(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),xs(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?xs(n,"maximum",r.value,r.message,t):xs(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),xs(n,"maximum",r.value,r.message,t));break;case"multipleOf":xs(n,"multipleOf",r.value,r.message,t);break}return n}function tIe(){return{type:"boolean"}}function mX(e,t){return ls(e.type._def,t)}const nIe=(e,t)=>ls(e.innerType._def,t);function gX(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>gX(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return rIe(e,t)}}const rIe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":xs(n,"minimum",r.value,r.message,t);break;case"max":xs(n,"maximum",r.value,r.message,t);break}return n};function sIe(e,t){return{...ls(e.innerType._def,t),default:e.defaultValue()}}function iIe(e,t){return t.effectStrategy==="input"?ls(e.schema._def,t):{}}function aIe(e){return{type:"string",enum:Array.from(e.values)}}const oIe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function lIe(e,t){const n=[ls(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),ls(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(oIe(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function cIe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let vI;const lc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(vI===void 0&&(vI=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),vI),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function yX(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":xs(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":xs(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":cc(n,"email",r.message,t);break;case"format:idn-email":cc(n,"idn-email",r.message,t);break;case"pattern:zod":Ya(n,lc.email,r.message,t);break}break;case"url":cc(n,"uri",r.message,t);break;case"uuid":cc(n,"uuid",r.message,t);break;case"regex":Ya(n,r.regex,r.message,t);break;case"cuid":Ya(n,lc.cuid,r.message,t);break;case"cuid2":Ya(n,lc.cuid2,r.message,t);break;case"startsWith":Ya(n,RegExp(`^${xI(r.value,t)}`),r.message,t);break;case"endsWith":Ya(n,RegExp(`${xI(r.value,t)}$`),r.message,t);break;case"datetime":cc(n,"date-time",r.message,t);break;case"date":cc(n,"date",r.message,t);break;case"time":cc(n,"time",r.message,t);break;case"duration":cc(n,"duration",r.message,t);break;case"length":xs(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),xs(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Ya(n,RegExp(xI(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&cc(n,"ipv4",r.message,t),r.version!=="v4"&&cc(n,"ipv6",r.message,t);break}case"base64url":Ya(n,lc.base64url,r.message,t);break;case"jwt":Ya(n,lc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Ya(n,lc.ipv4Cidr,r.message,t),r.version!=="v4"&&Ya(n,lc.ipv6Cidr,r.message,t);break}case"emoji":Ya(n,lc.emoji(),r.message,t);break;case"ulid":{Ya(n,lc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{cc(n,"binary",r.message,t);break}case"contentEncoding:base64":{xs(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Ya(n,lc.base64,r.message,t);break}}break}case"nanoid":Ya(n,lc.nanoid,r.message,t)}return n}function xI(e,t){return t.patternStrategy==="escape"?dIe(e):e}const uIe=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function dIe(e){let t="";for(let n=0;n<e.length;n++)uIe.has(e[n])||(t+="\\"),t+=e[n];return t}function cc(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):xs(e,"format",t,n,r)}function Ya(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:Xz(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):xs(e,"pattern",Xz(t,r),n,r)}function Xz(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function bX(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Qt.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===Qt.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=yX(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===Qt.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===Qt.ZodBranded&&e.keyType._def.type._def.typeName===Qt.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=mX(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function fIe(e,t){if(t.mapStrategy==="record")return bX(e,t);const n=ls(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function hIe(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function pIe(){return{not:{}}}function mIe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ik={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function gIe(e,t){if(t.target==="openApi3")return Jz(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in ik&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=ik[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return Jz(e,t)}const Jz=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>ls(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function yIe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:ik[e.innerType._def.typeName],nullable:!0}:{type:[ik[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=ls(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=ls(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function bIe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",pX(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?xs(n,"minimum",r.value,r.message,t):xs(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),xs(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?xs(n,"maximum",r.value,r.message,t):xs(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),xs(n,"maximum",r.value,r.message,t));break;case"multipleOf":xs(n,"multipleOf",r.value,r.message,t);break}return n}function vIe(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=wIe(l);c&&n&&(l instanceof _u&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=ls(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=xIe(e,t);return a!==void 0&&(r.additionalProperties=a),r}function xIe(e,t){if(e.catchall._def.typeName!=="ZodNever")return ls(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function wIe(e){try{return e.isOptional()}catch{return!0}}const _Ie=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return ls(e.innerType._def,t);const n=ls(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},SIe=(e,t)=>{if(t.pipeStrategy==="input")return ls(e.in._def,t);if(t.pipeStrategy==="output")return ls(e.out._def,t);const n=ls(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=ls(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function CIe(e,t){return ls(e.type._def,t)}function kIe(e,t){const r={type:"array",uniqueItems:!0,items:ls(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&xs(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&xs(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function EIe(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>ls(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:ls(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>ls(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function TIe(){return{not:{}}}function AIe(){return{}}const RIe=(e,t)=>ls(e.innerType._def,t),NIe=(e,t,n)=>{switch(t){case Qt.ZodString:return yX(e,n);case Qt.ZodNumber:return bIe(e,n);case Qt.ZodObject:return vIe(e,n);case Qt.ZodBigInt:return eIe(e,n);case Qt.ZodBoolean:return tIe();case Qt.ZodDate:return gX(e,n);case Qt.ZodUndefined:return TIe();case Qt.ZodNull:return mIe(n);case Qt.ZodArray:return QMe(e,n);case Qt.ZodUnion:case Qt.ZodDiscriminatedUnion:return gIe(e,n);case Qt.ZodIntersection:return lIe(e,n);case Qt.ZodTuple:return EIe(e,n);case Qt.ZodRecord:return bX(e,n);case Qt.ZodLiteral:return cIe(e,n);case Qt.ZodEnum:return aIe(e);case Qt.ZodNativeEnum:return hIe(e);case Qt.ZodNullable:return yIe(e,n);case Qt.ZodOptional:return _Ie(e,n);case Qt.ZodMap:return fIe(e,n);case Qt.ZodSet:return kIe(e,n);case Qt.ZodLazy:return()=>e.getter()._def;case Qt.ZodPromise:return CIe(e,n);case Qt.ZodNaN:case Qt.ZodNever:return pIe();case Qt.ZodEffects:return iIe(e,n);case Qt.ZodAny:return JMe();case Qt.ZodUnknown:return AIe();case Qt.ZodDefault:return sIe(e,n);case Qt.ZodBranded:return mX(e,n);case Qt.ZodReadonly:return RIe(e,n);case Qt.ZodCatch:return nIe(e,n);case Qt.ZodPipeline:return SIe(e,n);case Qt.ZodFunction:case Qt.ZodVoid:case Qt.ZodSymbol:return;default:return(r=>{})()}};function ls(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==YMe)return l}if(r&&!n){const l=MIe(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=NIe(e,e.typeName,t),a=typeof i=="function"?ls(i(),t):i;if(a&&jIe(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const MIe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:IIe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},IIe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},jIe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),PIe=(e,t)=>{const n=XMe(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:ls(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=ls(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Ew={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Tw={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Aw={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Rw={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Nw={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},OIe=[Ew,Tw,Aw,Rw,Nw];Ew.code+"",Tw.code+"",Aw.code+"",Rw.code+"",Nw.code+"";Ew.name+"",Ew.code,Tw.name+"",Tw.code,Aw.name+"",Aw.code,Rw.name+"",Rw.code,Nw.name+"",Nw.code;OIe.map(e=>e.code);function DIe(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function FIe(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=vm({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=vm({text:DIe(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var LIe={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},BIe={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},$Ie={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},zIe={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},UIe={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},qIe={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},VIe={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},WIe={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},HIe={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},GIe={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},KIe={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},YIe={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},ZIe={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},XIe={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},JIe={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},QIe={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},pT=[LIe,BIe,$Ie,zIe,UIe,qIe,VIe,WIe,HIe,GIe,KIe,YIe,ZIe,XIe,JIe,QIe];Object.fromEntries(pT.map(e=>[e.code,e]));Object.fromEntries(pT.map(e=>[e.name,e.code]));pT.map(e=>e.code);function Ra(e,t){const n=pT.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function e3e(e,t){var n;const r=(n=void 0)!=null?n:!1;return vX(PIe(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var Bj=Symbol.for("vercel.ai.schema");function vX(e,{validate:t}={}){return{[Bj]:!0,_type:void 0,[fC]:!0,jsonSchema:e,validate:t}}function t3e(e){return typeof e=="object"&&e!==null&&Bj in e&&e[Bj]===!0&&"jsonSchema"in e&&"validate"in e}function mT(e){return t3e(e)?e:e3e(e)}const y0=globalThis||void 0||self;var n3e=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof y0=="object"?y0:{},nm="1.9.0",Qz=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function r3e(e){var t=new Set([e]),n=new Set,r=e.match(Qz);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(Qz);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var s3e=r3e(nm),i3e=nm.split(".")[0],Mw=Symbol.for("opentelemetry.js.api."+i3e),Iw=n3e;function kD(e,t,n,r){var s;r===void 0&&(r=!1);var i=Iw[Mw]=(s=Iw[Mw])!==null&&s!==void 0?s:{version:nm};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==nm){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+nm);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+nm+"."),!0}function jw(e){var t,n,r=(t=Iw[Mw])===null||t===void 0?void 0:t.version;if(!(!r||!s3e(r)))return(n=Iw[Mw])===null||n===void 0?void 0:n[e]}function ED(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+nm+".");var n=Iw[Mw];n&&delete n[e]}var a3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},o3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},l3e=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Fv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Fv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Fv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Fv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Fv("verbose",this._namespace,t)},e}();function Fv(e,t,n){var r=jw("diag");if(r)return n.unshift(t),r[e].apply(r,o3e([],a3e(n),!1))}var tl;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(tl||(tl={}));function c3e(e,t){e<tl.NONE?e=tl.NONE:e>tl.ALL&&(e=tl.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",tl.ERROR),warn:n("warn",tl.WARN),info:n("info",tl.INFO),debug:n("debug",tl.DEBUG),verbose:n("verbose",tl.VERBOSE)}}var u3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},d3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},f3e="diag",ak=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=jw("diag");if(o)return o[s].apply(o,d3e([],u3e(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:tl.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=jw("diag"),d=c3e((o=i.logLevel)!==null&&o!==void 0?o:tl.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return kD("diag",d,n,!0)};n.setLogger=r,n.disable=function(){ED(f3e,n)},n.createComponentLogger=function(s){return new l3e(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function h3e(e){return Symbol.for(e)}var p3e=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),m3e=new p3e,g3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},y3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},b3e=function(){function e(){}return e.prototype.active=function(){return m3e},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,y3e([r],g3e(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),v3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},x3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},wI="context",w3e=new b3e,xX=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return kD(wI,t,ak.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,x3e([t,n,r],v3e(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return jw(wI)||w3e},e.prototype.disable=function(){this._getContextManager().disable(),ED(wI,ak.instance())},e}(),$j;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})($j||($j={}));var wX="0000000000000000",_X="00000000000000000000000000000000",_3e={traceId:_X,spanId:wX,traceFlags:$j.NONE},Sx=function(){function e(t){t===void 0&&(t=_3e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),TD=h3e("OpenTelemetry Context Key SPAN");function AD(e){return e.getValue(TD)||void 0}function S3e(){return AD(xX.getInstance().active())}function RD(e,t){return e.setValue(TD,t)}function C3e(e){return e.deleteValue(TD)}function k3e(e,t){return RD(e,new Sx(t))}function SX(e){var t;return(t=AD(e))===null||t===void 0?void 0:t.spanContext()}var E3e=/^([0-9a-f]{32})$/i,T3e=/^[0-9a-f]{16}$/i;function A3e(e){return E3e.test(e)&&e!==_X}function R3e(e){return T3e.test(e)&&e!==wX}function CX(e){return A3e(e.traceId)&&R3e(e.spanId)}function N3e(e){return new Sx(e)}var _I=xX.getInstance(),kX=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=_I.active());var s=!!(n!=null&&n.root);if(s)return new Sx;var i=r&&SX(r);return M3e(i)&&CX(i)?new Sx(i):new Sx},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??_I.active(),c=this.startSpan(t,i,l),u=RD(l,c);return _I.with(u,o,void 0,c)}},e}();function M3e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var I3e=new kX,j3e=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):I3e},e}(),P3e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new kX},e}(),O3e=new P3e,e7=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new j3e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:O3e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),ok;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(ok||(ok={}));var SI="trace",D3e=function(){function e(){this._proxyTracerProvider=new e7,this.wrapSpanContext=N3e,this.isSpanContextValid=CX,this.deleteSpan=C3e,this.getSpan=AD,this.getActiveSpan=S3e,this.getSpanContext=SX,this.setSpan=RD,this.setSpanContext=k3e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=kD(SI,this._proxyTracerProvider,ak.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return jw(SI)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){ED(SI,ak.instance()),this._proxyTracerProvider=new e7},e}(),F3e=D3e.getInstance(),L3e=Object.defineProperty,ND=(e,t)=>{for(var n in t)L3e(e,n,{get:t[n],enumerable:!0})};function lk(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function t7(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function n7({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var EX="AI_InvalidArgumentError",TX=`vercel.ai.error.${EX}`,B3e=Symbol.for(TX),AX,hc=class extends tr{constructor({parameter:e,value:t,message:n}){super({name:EX,message:`Invalid argument for parameter ${e}: ${n}`}),this[AX]=!0,this.parameter=e,this.value=t}static isInstance(e){return tr.hasMarker(e,TX)}};AX=B3e;var RX="AI_RetryError",NX=`vercel.ai.error.${RX}`,$3e=Symbol.for(NX),MX,r7=class extends tr{constructor({message:e,reason:t,errors:n}){super({name:RX,message:e}),this[MX]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return tr.hasMarker(e,NX)}};MX=$3e;var z3e=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>IX(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function IX(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(A2(i)||t===0)throw i;const a=Sye(i),o=[...s,i],l=o.length;if(l>t)throw new r7({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&zl.isInstance(i)&&i.isRetryable===!0&&l<=t)return await wye(n),IX(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new r7({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function U3e({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new hc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new hc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:z3e({maxRetries:t})}}function zj({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function q3e({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var V3e={startSpan(){return GS},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(GS);if(typeof n=="function")return n(GS);if(typeof r=="function")return r(GS)}},GS={spanContext(){return W3e},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},W3e={traceId:"",spanId:"",traceFlags:0};function H3e({isEnabled:e=!1,tracer:t}={}){return e?t||F3e.getTracer("ai"):V3e}function Uj({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:ok.ERROR,message:a.message})):i.setStatus({code:ok.ERROR})}finally{i.end()}throw a}})}function b0({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var G3e=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Nu(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=CE(this.base64Data)),this.uint8ArrayData}},K3e=class extends G3e{constructor(e){super(e),this.type="file"}},Y3e=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],Z3e=e=>{const t=typeof e=="string"?CE(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function X3e(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?Z3e(e):e}function J3e({data:e,signatures:t}){const n=X3e(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var jX="AI_NoObjectGeneratedError",PX=`vercel.ai.error.${jX}`,Q3e=Symbol.for(PX),OX,s7=class extends tr{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:jX,message:e,cause:t}),this[OX]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return tr.hasMarker(e,PX)}};OX=Q3e;var DX="AI_DownloadError",FX=`vercel.ai.error.${DX}`,eje=Symbol.for(FX),LX,CI=class extends tr{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:DX,message:s,cause:r}),this[LX]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return tr.hasMarker(e,FX)}};LX=eje;async function tje({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new CI({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw CI.isInstance(r)?r:new CI({url:n,cause:r})}}var BX="AI_InvalidDataContentError",$X=`vercel.ai.error.${BX}`,nje=Symbol.for($X),zX,i7=class extends tr{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:BX,message:n,cause:t}),this[zX]=!0,this.content=e}static isInstance(e){return tr.hasMarker(e,$X)}};zX=nje;var UX=ps([$e(),CC(Uint8Array),CC(ArrayBuffer),gG(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function MD(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Nu(new Uint8Array(e)):Nu(e)}function ck(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return CE(e)}catch(t){throw new i7({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new i7({content:e})}function rje(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var qX="AI_InvalidMessageRoleError",VX=`vercel.ai.error.${qX}`,sje=Symbol.for(VX),WX,ije=class extends tr{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:qX,message:t}),this[WX]=!0,this.role=e}static isInstance(e){return tr.hasMarker(e,VX)}};WX=sje;function aje(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function oje({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=tje}){const s=await cje(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>lje(i,s))]}function lje(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>uje(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:MD(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new ije({role:c})}}}async function cje(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function uje(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=aje(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=ck(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=ck(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=J3e({data:c,signatures:Y3e}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?MD(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function dje({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new hc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new hc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new hc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new hc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new hc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new hc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new hc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new hc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function a7(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:ck(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:rje(ck(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var HX="AI_MessageConversionError",GX=`vercel.ai.error.${HX}`,fje=Symbol.for(GX),KX,kI=class extends tr{constructor({originalMessage:e,message:t}){super({name:HX,message:t}),this[KX]=!0,this.originalMessage=e}static isInstance(e){return tr.hasMarker(e,GX)}};KX=fje;function hje(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...a7(d)]:u});else{const h=o.parts.filter(m=>m.type==="text").map(m=>({type:"text",text:m.text}));i.push({role:"user",content:d?[...h,...a7(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const w=[];for(const k of x)switch(k.type){case"file":case"text":{w.push(k);break}case"reasoning":{for(const C of k.details)switch(C.type){case"text":w.push({type:"reasoning",text:C.text,signature:C.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:C.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:k.toolInvocation.toolCallId,toolName:k.toolInvocation.toolName,args:k.toolInvocation.args});break;default:{const C=k;throw new Error(`Unsupported part: ${C}`)}}i.push({role:"assistant",content:w});const S=x.filter(k=>k.type==="tool-invocation").map(k=>k.toolInvocation);S.length>0&&i.push({role:"tool",content:S.map(k=>{if(!("result"in k))throw new kI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(k)});const{toolCallId:C,toolName:R,result:A}=k,N=s[R];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:C,toolName:R,result:N.experimental_toToolResultContent(A),experimental_content:N.experimental_toToolResultContent(A)}:{type:"tool-result",toolCallId:C,toolName:R,result:A}})}),x=[],v=!1,b++},b=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&y(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==b&&y(),x.push(w),v=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const m=h.reduce((y,b)=>{var v;return Math.max(y,(v=b.step)!=null?v:0)},0);for(let y=0;y<=m;y++){const b=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===y});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:b.map(v=>{if(!("result"in v))throw new kI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:S}=v,k=s[w];return(k==null?void 0:k.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:k.experimental_toToolResultContent(S),experimental_content:k.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:x,toolName:w,result:S}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new kI({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var qj=cbe(()=>ps([lbe(),$e(),Tt(),Gn(),bh($e(),qj),on(qj)])),ci=bh($e(),bh($e(),qj)),pje=on(ps([Ge({type:Rn("text"),text:$e()}),Ge({type:Rn("image"),data:$e(),mimeType:$e().optional()})])),YX=Ge({type:Rn("text"),text:$e(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),mje=Ge({type:Rn("image"),image:ps([UX,CC(URL)]),mimeType:$e().optional(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),ZX=Ge({type:Rn("file"),data:ps([UX,CC(URL)]),filename:$e().optional(),mimeType:$e(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),gje=Ge({type:Rn("reasoning"),text:$e(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),yje=Ge({type:Rn("redacted-reasoning"),data:$e(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),bje=Ge({type:Rn("tool-call"),toolCallId:$e(),toolName:$e(),args:zy(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),vje=Ge({type:Rn("tool-result"),toolCallId:$e(),toolName:$e(),result:zy(),content:pje.optional(),isError:Gn().optional(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),xje=Ge({role:Rn("system"),content:$e(),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),wje=Ge({role:Rn("user"),content:ps([$e(),on(ps([YX,mje,ZX]))]),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),_je=Ge({role:Rn("assistant"),content:ps([$e(),on(ps([YX,ZX,gje,yje,bje]))]),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),Sje=Ge({role:Rn("tool"),content:on(vje),providerOptions:ci.optional(),experimental_providerMetadata:ci.optional()}),Cje=ps([xje,wje,_je,Sje]);function kje({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new pc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new pc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new pc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new pc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=Eje(e.messages)==="ui-messages"?hje(e.messages,{tools:t}):e.messages;if(r.length===0)throw new pc({prompt:e,message:"messages must not be empty"});const s=$y({value:r,schema:on(Cje)});if(!s.success)throw new pc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function Eje(e){if(!Array.isArray(e))throw new pc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(Tje);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new pc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function Tje(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Aje({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function Rje(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var Nje="JSON schema:",Mje="You MUST answer with a JSON object that matches the JSON schema above.",Ije="You MUST answer with JSON.";function jje({prompt:e,schema:t,schemaPrefix:n=t!=null?Nje:void 0,schemaSuffix:r=t!=null?Mje:Ije}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function EI(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function Pje(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(Oje)}));return JSON.stringify(t)}function Oje(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?MD(e.image):e.image}:e}Lm({prefix:"aiobj",size:24});var yo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function o7(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function Dje(){let e=[],t=null,n=!1,r=o7();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=o7(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function Fje(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Lm({prefix:"aiobj",size:24});var XX="AI_NoOutputSpecifiedError",JX=`vercel.ai.error.${XX}`,Lje=Symbol.for(JX),QX,Bje=class extends tr{constructor({message:e="No output specified."}={}){super({name:XX,message:e}),this[QX]=!0}static isInstance(e){return tr.hasMarker(e,JX)}};QX=Lje;var eJ="AI_ToolExecutionError",tJ=`vercel.ai.error.${eJ}`,$je=Symbol.for(tJ),nJ,zje=class extends tr{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${p1(r)}`}){super({name:eJ,message:s,cause:r}),this[nJ]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return tr.hasMarker(e,tJ)}};nJ=$je;function Uje(e){return e!=null&&Object.keys(e).length>0}function qje({tools:e,toolChoice:t,activeTools:n}){return Uje(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:mT(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var Vje=/^([\s\S]*?)(\s+)(\S*)$/;function Wje(e){const t=e.match(Vje);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var rJ="AI_InvalidToolArgumentsError",sJ=`vercel.ai.error.${rJ}`,Hje=Symbol.for(sJ),iJ,aJ=class extends tr{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${p1(n)}`}){super({name:rJ,message:r,cause:n}),this[iJ]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return tr.hasMarker(e,sJ)}};iJ=Hje;var oJ="AI_NoSuchToolError",lJ=`vercel.ai.error.${oJ}`,Gje=Symbol.for(lJ),cJ,Vj=class extends tr{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:oJ,message:n}),this[cJ]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return tr.hasMarker(e,lJ)}};cJ=Gje;var uJ="AI_ToolCallRepairError",dJ=`vercel.ai.error.${uJ}`,Kje=Symbol.for(dJ),fJ,Yje=class extends tr{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${p1(e)}`}){super({name:uJ,message:n,cause:e}),this[fJ]=!0,this.originalError=t}static isInstance(e){return tr.hasMarker(e,dJ)}};fJ=Kje;async function Zje({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new Vj({toolName:e.toolName});try{return await l7({toolCall:e,tools:t})}catch(i){if(n==null||!(Vj.isInstance(i)||aJ.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>mT(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new Yje({cause:o,originalError:i})}if(a==null)throw i;return await l7({toolCall:a,tools:t})}}async function l7({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new Vj({toolName:e.toolName,availableTools:Object.keys(t)});const s=mT(r.parameters),i=e.args.trim()===""?$y({value:{},schema:s}):vm({text:e.args,schema:s});if(i.success===!1)throw new aJ({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function Xje(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function c7({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Lm({prefix:"aitxt",size:24});Lm({prefix:"msg",size:24});var Jje={};ND(Jje,{object:()=>s4e,text:()=>r4e});var hJ="AI_InvalidStreamPartError",pJ=`vercel.ai.error.${hJ}`,Qje=Symbol.for(pJ),mJ,e4e=class extends tr{constructor({chunk:e,message:t}){super({name:hJ,message:t}),this[mJ]=!0,this.chunk=e}static isInstance(e){return tr.hasMarker(e,pJ)}};mJ=Qje;var t4e="AI_MCPClientError",gJ=`vercel.ai.error.${t4e}`,n4e=Symbol.for(gJ),yJ,na=class extends tr{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[yJ]=!0}static isInstance(e){return tr.hasMarker(e,gJ)}};yJ=n4e;var r4e=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),s4e=({schema:e})=>{const t=mT(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:jje({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=FIe(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=vm({text:n});if(!s.success)throw new s7({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=$y({value:s.value,schema:t});if(!i.success)throw new s7({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function i4e(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function a4e({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function ID(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(m=>({result:m,reader:n})),i.then(m=>({result:m,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function o4e({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let m=!1,y;function b(){m&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const v=new TransformStream({async transform(x,w){const S=x.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new K3e({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const k=await Zje({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(k);const C=e[k.toolName];if(C.execute!=null){const R=ia();h.add(R),Uj({name:"ai.toolCall",attributes:b0({telemetry:s,attributes:{...zj({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":k.toolName,"ai.toolCall.id":k.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(k.args)}}}),tracer:r,fn:async A=>C.execute(k.args,{toolCallId:k.toolCallId,messages:a,abortSignal:o}).then(N=>{c.enqueue({...k,type:"tool-result",result:N}),h.delete(R),b();try{A.setAttributes(b0({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(N)}}}))}catch{}},N=>{c.enqueue({type:"error",error:new zje({toolCallId:k.toolCallId,toolName:k.toolName,toolArgs:k.args,cause:N})}),h.delete(R),b()})})}}catch(k){c.enqueue({type:"error",error:k})}break}case"finish":{y={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:Aje(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const k=S;throw new Error(`Unhandled chunk type: ${k}`)}}},flush(){m=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var l4e=Lm({prefix:"aitxt",size:24}),c4e=Lm({prefix:"msg",size:24});function u4e({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=c4e,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:m,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:S,experimental_transform:k,onChunk:C,onError:R,onFinish:A,onStepFinish:N,_internal:{now:I=Fje,generateId:O=l4e,currentDate:B=()=>new Date}={},...D}){return new f4e({model:e,telemetry:m,headers:l,settings:D,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:i4e(k),activeTools:w,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:C,onError:R,onFinish:A,onStepFinish:N,now:I,currentDate:B,generateId:O,generateMessageId:u})}function d4e(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var f4e=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:m,repairToolCall:y,maxSteps:b,output:v,continueSteps:x,providerOptions:w,now:S,currentDate:k,generateId:C,generateMessageId:R,onChunk:A,onError:N,onFinish:I,onStepFinish:O}){this.warningsPromise=new yo,this.usagePromise=new yo,this.finishReasonPromise=new yo,this.providerMetadataPromise=new yo,this.textPromise=new yo,this.reasoningPromise=new yo,this.reasoningDetailsPromise=new yo,this.sourcesPromise=new yo,this.filesPromise=new yo,this.toolCallsPromise=new yo,this.toolResultsPromise=new yo,this.requestPromise=new yo,this.responsePromise=new yo,this.stepsPromise=new yo;var B;if(b<1)throw new hc({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=v;let D="",W="",P="",Z=[],U=[],H,L=[];const ne=[],V={id:C(),timestamp:k(),modelId:e.modelId,messages:[]};let Q=[],ee=[],se,me,ce="initial";const je=[];let De;const Se=new TransformStream({async transform(le,oe){oe.enqueue(le);const{part:re}=le;if((re.type==="text-delta"||re.type==="reasoning"||re.type==="source"||re.type==="tool-call"||re.type==="tool-result"||re.type==="tool-call-streaming-start"||re.type==="tool-call-delta")&&await(A==null?void 0:A({chunk:re})),re.type==="error"&&await(N==null?void 0:N({error:re.error})),re.type==="text-delta"&&(D+=re.textDelta,W+=re.textDelta,P+=re.textDelta),re.type==="reasoning"&&(H==null?(H={type:"text",text:re.textDelta},Z.push(H)):H.text+=re.textDelta),re.type==="reasoning-signature"){if(H==null)throw new tr({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});H.signature=re.signature,H=void 0}if(re.type==="redacted-reasoning"&&Z.push({type:"redacted",data:re.data}),re.type==="file"&&U.push(re),re.type==="source"&&(ne.push(re.source),L.push(re.source)),re.type==="tool-call"&&Q.push(re),re.type==="tool-result"&&ee.push(re),re.type==="step-finish"){const Te=c7({text:W,files:U,reasoning:Z,tools:c??{},toolCalls:Q,toolResults:ee,messageId:re.messageId,generateMessageId:R}),Be=je.length;let ke="done";Be+1<b&&(x&&re.finishReason==="length"&&Q.length===0?ke="continue":Q.length>0&&ee.length===Q.length&&(ke="tool-result"));const lt={stepType:ce,text:D,reasoning:Xje(Z),reasoningDetails:Z,files:U,sources:L,toolCalls:Q,toolResults:ee,finishReason:re.finishReason,usage:re.usage,warnings:re.warnings,logprobs:re.logprobs,request:re.request,response:{...re.response,messages:[...V.messages,...Te]},providerMetadata:re.experimental_providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,isContinued:re.isContinued};await(O==null?void 0:O(lt)),je.push(lt),Q=[],ee=[],D="",L=[],Z=[],U=[],H=void 0,ke!=="done"&&(ce=ke),ke!=="continue"&&(V.messages.push(...Te),W="")}re.type==="finish"&&(V.id=re.response.id,V.timestamp=re.response.timestamp,V.modelId=re.response.modelId,V.headers=re.response.headers,me=re.usage,se=re.finishReason)},async flush(le){var oe;try{if(je.length===0)return;const re=je[je.length-1];Ae.warningsPromise.resolve(re.warnings),Ae.requestPromise.resolve(re.request),Ae.responsePromise.resolve(re.response),Ae.toolCallsPromise.resolve(re.toolCalls),Ae.toolResultsPromise.resolve(re.toolResults),Ae.providerMetadataPromise.resolve(re.experimental_providerMetadata),Ae.reasoningPromise.resolve(re.reasoning),Ae.reasoningDetailsPromise.resolve(re.reasoningDetails);const Te=se??"unknown",Be=me??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Ae.finishReasonPromise.resolve(Te),Ae.usagePromise.resolve(Be),Ae.textPromise.resolve(P),Ae.sourcesPromise.resolve(ne),Ae.filesPromise.resolve(re.files),Ae.stepsPromise.resolve(je),await(I==null?void 0:I({finishReason:Te,logprobs:void 0,usage:Be,text:P,reasoning:re.reasoning,reasoningDetails:re.reasoningDetails,files:re.files,sources:re.sources,toolCalls:re.toolCalls,toolResults:re.toolResults,request:(oe=re.request)!=null?oe:{},response:re.response,warnings:re.warnings,providerMetadata:re.providerMetadata,experimental_providerMetadata:re.experimental_providerMetadata,steps:je})),De.setAttributes(b0({telemetry:t,attributes:{"ai.response.finishReason":Te,"ai.response.text":{output:()=>P},"ai.response.toolCalls":{output:()=>{var ke;return(ke=re.toolCalls)!=null&&ke.length?JSON.stringify(re.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(re){le.error(re)}finally{De.end()}}}),Ce=Dje();this.addStream=Ce.addStream,this.closeStream=Ce.close;let qe=Ce.stream;for(const le of h)qe=qe.pipeThrough(le({tools:c,stopStream(){Ce.terminate()}}));this.baseStream=qe.pipeThrough(d4e(v)).pipeThrough(Se);const{maxRetries:Qe,retry:We}=U3e({maxRetries:s}),Ne=H3e(t),K=q3e({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),ge=kje({prompt:{system:(B=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?B:a,prompt:o,messages:l},tools:c}),Ae=this;Uj({name:"ai.streamText",attributes:b0({telemetry:t,attributes:{...zj({operationId:"ai.streamText",telemetry:t}),...K,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:Ne,endWhenDone:!1,fn:async le=>{De=le;async function oe({currentStep:re,responseMessages:Te,usage:Be,stepType:ke,previousStepText:lt,hasLeadingWhitespace:Rt,messageId:ft}){var Pt;const qt=Te.length===0?ge.type:"messages",Lt=[...ge.messages,...Te],en=await oje({prompt:{type:qt,system:ge.system,messages:Lt},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Pt=e.supportsUrl)==null?void 0:Pt.bind(e)}),xe={type:"regular",...qje({tools:c,toolChoice:u,activeTools:m})},{result:{stream:F,warnings:X,rawResponse:ye,request:Fe},doStreamSpan:we,startTimestampMs:Ie}=await We(()=>Uj({name:"ai.streamText.doStream",attributes:b0({telemetry:t,attributes:{...zj({operationId:"ai.streamText.doStream",telemetry:t}),...K,"ai.prompt.format":{input:()=>qt},"ai.prompt.messages":{input:()=>Pje(en)},"ai.prompt.tools":{input:()=>{var Xt;return(Xt=xe.tools)==null?void 0:Xt.map(nn=>JSON.stringify(nn))}},"ai.prompt.toolChoice":{input:()=>xe.toolChoice!=null?JSON.stringify(xe.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:Ne,endWhenDone:!1,fn:async Xt=>({startTimestampMs:S(),doStreamSpan:Xt,result:await e.doStream({mode:xe,...dje(r),inputFormat:qt,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:en,providerMetadata:w,abortSignal:i,headers:n})})})),fe=o4e({tools:c,generatorStream:F,toolCallStreaming:d,tracer:Ne,telemetry:t,system:a,messages:Lt,repairToolCall:y,abortSignal:i}),vt=Fe??{},ot=[],$=[],ze=[],st=[];let be,_e="unknown",Ue={promptTokens:0,completionTokens:0,totalTokens:0},Et,he=!0,Y="",G=ke==="continue"?lt:"",J,ve={id:C(),timestamp:k(),modelId:e.modelId},Oe="",Ke=!1,_t=!0,tn=!1;async function zn({controller:Xt,chunk:nn}){Xt.enqueue(nn),Y+=nn.textDelta,G+=nn.textDelta,Ke=!0,tn=nn.textDelta.trimEnd()!==nn.textDelta}Ae.addStream(fe.pipeThrough(new TransformStream({async transform(Xt,nn){var un,yr,Rr;if(he){const rs=S()-Ie;he=!1,we.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":rs}),we.setAttributes({"ai.response.msToFirstChunk":rs}),nn.enqueue({type:"step-start",messageId:ft,request:vt,warnings:X??[]})}if(Xt.type==="text-delta"&&Xt.textDelta.length===0)return;const ns=Xt.type;switch(ns){case"text-delta":{if(x){const rs=_t&&Rt?Xt.textDelta.trimStart():Xt.textDelta;if(rs.length===0)break;_t=!1,Oe+=rs;const Cr=Wje(Oe);Cr!=null&&(Oe=Cr.suffix,await zn({controller:nn,chunk:{type:"text-delta",textDelta:Cr.prefix+Cr.whitespace}}))}else await zn({controller:nn,chunk:Xt});break}case"reasoning":{nn.enqueue(Xt),be==null?(be={type:"text",text:Xt.textDelta},ze.push(be)):be.text+=Xt.textDelta;break}case"reasoning-signature":{if(nn.enqueue(Xt),be==null)throw new e4e({chunk:Xt,message:"reasoning-signature without reasoning"});be.signature=Xt.signature,be=void 0;break}case"redacted-reasoning":{nn.enqueue(Xt),ze.push({type:"redacted",data:Xt.data});break}case"tool-call":{nn.enqueue(Xt),ot.push(Xt);break}case"tool-result":{nn.enqueue(Xt),$.push(Xt);break}case"response-metadata":{ve={id:(un=Xt.id)!=null?un:ve.id,timestamp:(yr=Xt.timestamp)!=null?yr:ve.timestamp,modelId:(Rr=Xt.modelId)!=null?Rr:ve.modelId};break}case"finish":{Ue=Xt.usage,_e=Xt.finishReason,Et=Xt.experimental_providerMetadata,J=Xt.logprobs;const rs=S()-Ie;we.addEvent("ai.stream.finish"),we.setAttributes({"ai.response.msToFinish":rs,"ai.response.avgCompletionTokensPerSecond":1e3*Ue.completionTokens/rs});break}case"file":{st.push(Xt),nn.enqueue(Xt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{nn.enqueue(Xt);break}case"error":{nn.enqueue(Xt),_e="error";break}default:{const rs=ns;throw new Error(`Unknown chunk type: ${rs}`)}}},async flush(Xt){const nn=ot.length>0?JSON.stringify(ot):void 0;let un="done";re+1<b&&(x&&_e==="length"&&ot.length===0?un="continue":ot.length>0&&$.length===ot.length&&(un="tool-result")),x&&Oe.length>0&&(un!=="continue"||ke==="continue"&&!Ke)&&(await zn({controller:Xt,chunk:{type:"text-delta",textDelta:Oe}}),Oe="");try{we.setAttributes(b0({telemetry:t,attributes:{"ai.response.finishReason":_e,"ai.response.text":{output:()=>Y},"ai.response.toolCalls":{output:()=>nn},"ai.response.id":ve.id,"ai.response.model":ve.modelId,"ai.response.timestamp":ve.timestamp.toISOString(),"ai.usage.promptTokens":Ue.promptTokens,"ai.usage.completionTokens":Ue.completionTokens,"gen_ai.response.finish_reasons":[_e],"gen_ai.response.id":ve.id,"gen_ai.response.model":ve.modelId,"gen_ai.usage.input_tokens":Ue.promptTokens,"gen_ai.usage.output_tokens":Ue.completionTokens}}))}catch{}finally{we.end()}Xt.enqueue({type:"step-finish",finishReason:_e,usage:Ue,providerMetadata:Et,experimental_providerMetadata:Et,logprobs:J,request:vt,response:{...ve,headers:ye==null?void 0:ye.headers},warnings:X,isContinued:un==="continue",messageId:ft});const yr=Rje(Be,Ue);if(un==="done")Xt.enqueue({type:"finish",finishReason:_e,usage:yr,providerMetadata:Et,experimental_providerMetadata:Et,logprobs:J,response:{...ve,headers:ye==null?void 0:ye.headers}}),Ae.closeStream();else{if(ke==="continue"){const Rr=Te[Te.length-1];typeof Rr.content=="string"?Rr.content+=Y:Rr.content.push({text:Y,type:"text"})}else Te.push(...c7({text:Y,files:st,reasoning:ze,tools:c??{},toolCalls:ot,toolResults:$,messageId:ft,generateMessageId:R}));await oe({currentStep:re+1,responseMessages:Te,usage:yr,stepType:un,previousStepText:G,hasLeadingWhitespace:tn,messageId:un==="continue"?ft:R()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:R()})}}).catch(le=>{Ae.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:le}),oe.close()}})),Ae.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return EI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return EI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await a4e({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new Bje;return EI(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Ra("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Ra("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Ra("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Ra("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Ra("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Ra("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Ra("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Ra("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Ra("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Ra("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Ra("error",e(i.error)));break}case"step-start":{a.enqueue(Ra("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Ra("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Ra("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){n7({response:e,status:t,statusText:n,headers:t7(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){n7({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:t7(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?ID(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:lk(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:lk(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var bJ="2024-11-05",h4e=[bJ,"2024-10-07"],p4e=Ge({name:$e(),version:$e()}).passthrough(),jD=Ge({_meta:ra(Ge({}).passthrough())}).passthrough(),Pw=jD,m4e=Ge({method:$e(),params:ra(jD)}),g4e=Ge({experimental:ra(Ge({}).passthrough()),logging:ra(Ge({}).passthrough()),prompts:ra(Ge({listChanged:ra(Gn())}).passthrough()),resources:ra(Ge({subscribe:ra(Gn()),listChanged:ra(Gn())}).passthrough()),tools:ra(Ge({listChanged:ra(Gn())}).passthrough())}).passthrough(),y4e=Pw.extend({protocolVersion:$e(),capabilities:g4e,serverInfo:p4e,instructions:ra($e())}),b4e=Pw.extend({nextCursor:ra($e())}),v4e=Ge({name:$e(),description:ra($e()),inputSchema:Ge({type:Rn("object"),properties:ra(Ge({}).passthrough())}).passthrough()}).passthrough(),x4e=b4e.extend({tools:on(v4e)}),w4e=Ge({type:Rn("text"),text:$e()}).passthrough(),_4e=Ge({type:Rn("image"),data:$e().base64(),mimeType:$e()}).passthrough(),vJ=Ge({uri:$e(),mimeType:ra($e())}).passthrough(),S4e=vJ.extend({text:$e()}),C4e=vJ.extend({blob:$e().base64()}),k4e=Ge({type:Rn("resource"),resource:ps([S4e,C4e])}).passthrough(),E4e=Pw.extend({content:on(ps([w4e,_4e,k4e])),isError:Gn().default(!1).optional()}).or(Pw.extend({toolResult:zy()})),gT="2.0",T4e=Ge({jsonrpc:Rn(gT),id:ps([$e(),Tt().int()])}).merge(m4e).strict(),A4e=Ge({jsonrpc:Rn(gT),id:ps([$e(),Tt().int()]),result:Pw}).strict(),R4e=Ge({jsonrpc:Rn(gT),id:ps([$e(),Tt().int()]),error:Ge({code:Tt().int(),message:$e(),data:ra(zy())})}).strict(),N4e=Ge({jsonrpc:Rn(gT)}).merge(Ge({method:$e(),params:ra(jD)})).strict(),M4e=ps([T4e,N4e,A4e,R4e]),I4e=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new na({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(uG()).getReader(),u=async()=>{var d,h,m;try{for(;;){const{done:y,value:b}=await c.read();if(y){if(this.connected)throw this.connected=!1,new na({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=b;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new na({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=M4e.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const S=new na({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,S)}}}catch(y){if(y instanceof Error&&y.name==="AbortError")return;(m=this.onerror)==null||m.call(this,y),t(y)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new na({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new na({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function j4e(e){if(e.type!=="sse")throw new na({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new I4e(e)}function P4e(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var O4e="1.0.0";async function u7(e){const t=new D4e(e);return await t.init(),t}var D4e=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,P4e(e)?this.transport=e:this.transport=j4e(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new na({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:O4e}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:bJ,capabilities:{},clientInfo:this.clientInfo}},resultSchema:y4e});if(e===void 0)throw new na({message:"Server sent invalid initialize result"});if(!h4e.includes(e.protocolVersion))throw new na({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new na({message:"Server does not support tools"});break;default:throw new na({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new na({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new na({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new na({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:x4e,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:E4e,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?vX({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new na({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new na({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new na({message:e.error.message,cause:e.error}))}},F4e={};ND(F4e,{mergeIntoDataStream:()=>$4e,toDataStream:()=>L4e,toDataStreamResponse:()=>B4e});function xJ(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function PD(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&d7((s=n.data)==null?void 0:s.chunk,r);return}d7(n,r)}})).pipeThrough(xJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Ra("text",n))}}))}function L4e(e,t){return PD(e,t).pipeThrough(new TextEncoderStream)}function B4e(e,t){var n;const r=PD(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?ID(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:lk(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function $4e(e,t){t.dataStream.merge(PD(e,t.callbacks))}function d7(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var z4e={};ND(z4e,{mergeIntoDataStream:()=>V4e,toDataStream:()=>U4e,toDataStreamResponse:()=>q4e});function OD(e,t){const n=W4e();return xye(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(xJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Ra("text",r))}}))}function U4e(e,t){return OD(e,t).pipeThrough(new TextEncoderStream)}function q4e(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=OD(e,i).pipeThrough(new TextEncoderStream),o=s?ID(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:lk(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function V4e(e,t){t.dataStream.merge(OD(e,t.callbacks))}function W4e(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class H4e{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await u4e(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const G4e="modulepreload",K4e=function(e){return"/"+e},f7={},Zr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=K4e(c),c in f7)return;f7[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":G4e,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},Y4e=".litechat/conversations",wJ="/synced_repos";async function Z4e(e,t,n,r=!1){n(t.id,"syncing");const s=zr(`${wJ}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(Pu(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||Me.info(`Pulling latest changes for "${t.name}"...`),await iT(s,a,i,{fsInstance:e}),r||Me.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||Me.info(`Cloning repository "${t.name}"...`),await bZ(s,t.remoteUrl,a,i,{fsInstance:e}),r||Me.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function X4e(e,t,n,r,s,i,a,o=!1){var h,m;r(t.id,"syncing");const l=zr(`${wJ}/${n.id}`),c=Pu(l,Y4e,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Pu(l,".git"))}catch(w){if(w.code==="ENOENT"){Me.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||Me.info(`Pulling latest changes for "${n.name}"...`),await iT(l,d,u,{fsInstance:e});let y=null,b=null;try{const w=await Yh(c,{fsInstance:e}),S=new TextDecoder().decode(w);y=JSON.parse(S),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),Me.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!y||v>(b??0)||v>x&&v>=(b??0)){o||Me.info("Local changes detected. Pushing to remote...");const w=await St.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...k}=t,C=JSON.stringify({conversation:k,interactions:w},null,2);await aT(c,C,{fsInstance:e}),await hD(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await pD(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||Me.success("Conversation synced successfully (pushed).")}else if(b&&b>v){o||Me.info("Remote changes detected. Updating local conversation...");const w={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await St.saveConversation(w),await St.deleteInteractionsForConversation(t.id);const S=y.interactions.map(k=>St.saveInteraction({...k,conversationId:t.id,startedAt:k.startedAt?new Date(k.startedAt):null,endedAt:k.endedAt?new Date(k.endedAt):null}));await Promise.all(S),i()===t.id&&a()==="conversation"&&await Ln.getState().loadInteractions(t.id),r(t.id,"idle"),o||Me.success("Conversation synced successfully (pulled).")}else o||Me.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const xa={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},Zn={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},Fo=Bo($o((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await St.loadProjects();e({projects:n,isLoading:!1}),Pe.emit(xa.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Pe.emit(xa.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=ws(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=zr(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await St.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Pe.emit(xa.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=zr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await St.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Pe.emit(xa.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await St.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Pe.emit(Zn.loadConversationsRequest,void 0),Pe.emit(xa.deleted,{projectId:n}),Me.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=mr.getState(),s=Nr.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:xa.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:xa.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:xa.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:xa.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),zp=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},J4e=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${Ad(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${Ad(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${dw(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class v0{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>St.saveInteraction({...u,conversationId:l,id:ws()}));await Promise.all(c),await r(l,"conversation"),Me.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),Me.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=Un.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await St.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=J4e(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");zp(i,a),Me.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),Me.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=Fo.getState(),{conversations:s}=Un.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const m=n.find(x=>x.id===h);if(!m)throw new Error(`Project ${h} not found in state.`);const y=n.filter(x=>x.parentId===h),b=s.filter(x=>x.projectId===h),v=[];for(const x of y)v.push(await a(x.id));for(const x of b){const w=await St.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:m,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;zp(c,d),Me.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),Me.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=Un.getState().conversations,n=[];for(const a of t){const o=await St.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;zp(s,i),Me.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await St.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_full_config_${Ad(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;zp(s,a),Me.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),Me.error(`Export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportPromptTemplates(){try{const n=(await St.loadPromptTemplates()).filter(l=>!l.type||l.type==="prompt"),r={version:1,exportedAt:new Date().toISOString(),promptTemplates:n},s=JSON.stringify(r,null,2),i=new Blob([s],{type:"application/json"}),o=`litechat_prompt_templates_${Ad(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;zp(i,o),Me.success(`Exported ${n.length} prompt templates.`)}catch(t){throw console.error("ImportExportService: Error exporting prompt templates",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportAgents(){try{const t=await St.loadPromptTemplates(),n=t.filter(u=>u.type==="agent"),r=n.map(u=>u.id),s=t.filter(u=>u.type==="task"&&u.parentId&&r.includes(u.parentId)),i={version:1,exportedAt:new Date().toISOString(),agents:[...n,...s]},a=JSON.stringify(i,null,2),o=new Blob([a],{type:"application/json"}),c=`litechat_agents_${Ad(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;zp(o,c),Me.success(`Exported ${n.length} agents with ${s.length} tasks.`)}catch(t){throw console.error("ImportExportService: Error exporting agents",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportMcpServers(){try{const t=await St.loadSetting("mcpServers",[]),n={version:1,exportedAt:new Date().toISOString(),mcpServers:t},r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_mcp_servers_${Ad(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;zp(s,a),Me.success(`Exported ${t.length} MCP server configurations.`)}catch(t){throw console.error("ImportExportService: Error exporting MCP servers",t),Me.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await St.importAllData(s,n),Me.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),Me.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}static async importPromptTemplates(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.promptTemplates||!Array.isArray(r.promptTemplates))throw new Error("Invalid prompt templates file format.");let s=0;for(const i of r.promptTemplates)try{await St.savePromptTemplate({...i,id:i.id||ws(),createdAt:i.createdAt?new Date(i.createdAt):new Date,updatedAt:new Date}),s++}catch(a){console.warn(`Failed to import template ${i.name}:`,a)}Me.success(`Imported ${s} prompt templates.`)}catch(n){throw console.error("ImportExportService: Error importing prompt templates",n),Me.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importAgents(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.agents||!Array.isArray(r.agents))throw new Error("Invalid agents file format.");let s=0,i=0;for(const a of r.agents)try{await St.savePromptTemplate({...a,id:a.id||ws(),createdAt:a.createdAt?new Date(a.createdAt):new Date,updatedAt:new Date}),a.type==="agent"?s++:a.type==="task"&&i++}catch(o){console.warn(`Failed to import ${a.type} ${a.name}:`,o)}Me.success(`Imported ${s} agents with ${i} tasks.`)}catch(n){throw console.error("ImportExportService: Error importing agents",n),Me.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importMcpServers(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.mcpServers||!Array.isArray(r.mcpServers))throw new Error("Invalid MCP servers file format.");await St.saveSetting("mcpServers",r.mcpServers),Me.success(`Imported ${r.mcpServers.length} MCP server configurations.`)}catch(n){throw console.error("ImportExportService: Error importing MCP servers",n),Me.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}}const nu="sync_repos",us={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},Qs=Bo($o((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&Me.error(`VFS Error: ${n}`)}),Pe.emit(dn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Pe.emit(dn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Pe.emit(dn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Pe.emit(dn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Pe.emit(dn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Pe.emit(dn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Pe.emit(dn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((m,y)=>{const b=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(b),v.configuredVfsKey===s&&v.fs?m(v.fs):y(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await hTe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(s),e({initializingKey:null}),Pe.emit(dn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const m="vfs-root";let y=t().nodes[m];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:m,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const m=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${m}`,h),t().initializingKey===s&&(l(m),a||(u(null),d(null))),new Error(m)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=await mD(m,{fsInstance:a}),b=n??l??"",v=new Set(y.map(C=>C.path)),S=(t().childrenMap[b]||[]).map(C=>t().nodes[C]).filter(Boolean).filter(C=>!v.has(C.path)).map(C=>C.id);S.length>0&&t()._removeNodes(S);const k=y.map(C=>{const R=Object.values(t().nodes).find(N=>N.path===C.path),A=Date.now();return{id:(R==null?void 0:R.id)||ws(),parentId:n,name:C.name,path:C.path,type:C.isDirectory?"folder":"file",size:C.size,createdAt:(R==null?void 0:R.createdAt)??A,lastModified:C.lastModified.getTime(),mimeType:C.isDirectory?void 0:C.mimeType}});k.length>0&&i(k),e(C=>{const R=k.map(A=>A.id);(!C.childrenMap[b]||JSON.stringify(C.childrenMap[b].sort())!==JSON.stringify(R.sort()))&&(C.childrenMap[b]=R)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=zr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=zr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=Nj(m,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await wZ(y,{fsInstance:a});const b=Date.now(),x={id:ws(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await _Z(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await gD(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const m=h.parentId?o[h.parentId]:o[c||""],y=m?m.path:"/",b=Nj(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await SZ(h.path,b,{fsInstance:l});const v={name:r.trim(),path:b,lastModified:Date.now()};a(n,v)}catch(m){console.error("Failed to rename item:",m),i(m.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await Yh(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Pe.emit(dn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Pe.emit(dn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:dn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:dn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:dn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:dn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:dn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:dn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:dn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:dn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:dn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:dn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:dn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:dn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:dn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),Q4e="/synced_repos",Un=Bo($o((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),Qs.getState().initializingKey===nu&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),Qs.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{Pe.off(dn.fsInstanceChanged,o),Pe.off(dn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{Qs.getState().configuredVfsKey===nu&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${nu}.`),a(),r(u.fsInstance))},l=u=>{const d=Qs.getState();d.configuredVfsKey===nu&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${nu}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${nu}.`),a(),r(d.fs)))};Pe.on(dn.fsInstanceChanged,o),Pe.on(dn.loadingStateChanged,l);const c=Qs.getState();if(c.configuredVfsKey===nu&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${nu}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${nu}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),Pe.emit(dn.initializeVFSRequest,{vfsKey:nu,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([St.loadConversations(),St.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Pe.emit(Zn.conversationsLoaded,{conversations:n}),Pe.emit(Zn.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Pe.emit(Zn.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=ws(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await St.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Pe.emit(Zn.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,m=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||m>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await St.saveConversation(a),Pe.emit(Zn.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await St.deleteConversation(n),await St.deleteInteractionsForConversation(n),Pe.emit(Zn.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Pe.emit(Xn.setCurrentConversationIdRequest,{id:null}),Pe.emit(Zn.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Pe.emit(Xn.setCurrentConversationIdRequest,{id:a}),Pe.emit(Xn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Pe.emit(Zn.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await v0.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await v0.exportConversation(n,r)},exportProject:async n=>{await v0.exportProject(n)},exportAllConversations:async()=>{await v0.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await St.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Pe.emit(Zn.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Pe.emit(Zn.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=ws(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await St.saveSyncRepo(o),Pe.emit(us.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");Me.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),Me.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await St.saveSyncRepo(a),Pe.emit(us.repoChanged,{repoId:n,action:"updated"}),Me.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),Me.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await St.deleteSyncRepo(n);const i=zr(`${Q4e}/${n}`);try{await gD(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Pe.emit(us.repoChanged,{repoId:n,action:"deleted"}),Me.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),Me.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Pe.emit(Zn.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Pe.emit(us.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||Me.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await Z4e(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||Me.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||Me.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||Me.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await X4e(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>O0);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>O0);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await Zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>O0);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Zn.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:Zn.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:Zn.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:Zn.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:Zn.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:Zn.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:Zn.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:Zn.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:Zn.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:Zn.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:Zn.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:Zn.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:Zn.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:Zn.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:Zn.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:Zn.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:Zn.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),mc={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request"},Cx={async submitPrompt(e){var O,B,D,W,P,Z;console.log("[ConversationService] submitPrompt called",e);const t=Ln.getState(),n=Fo.getState(),r=Po.getState(),s=Un.getState(),i=mr.getState(),a=t.currentConversationId;if(!a){Me.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(U=>U.conversationId===a).length===0&&i.autoTitleEnabled&&((O=e.metadata)==null?void 0:O.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,m=t.interactions.filter(U=>U.parentId===null&&U.status==="COMPLETED").sort((U,H)=>U.index-H.index).map(U=>{var H;if(U.type==="message.assistant_regen"&&((H=U.metadata)!=null&&H.regeneratedFromId)){const L=t.interactions.find(ne=>ne.id===U.metadata.regeneratedFromId);if(L&&L.prompt&&L.type==="message.user_assistant")return{...U,prompt:L.prompt,type:"message.user_assistant"}}return U.type==="message.user_assistant"&&U.prompt?U:null}).filter(Boolean),y=mj(m);let b=e.content;const v=[],x=((B=e.metadata)==null?void 0:B.effectiveRulesContent)??[],w=x.filter(U=>U.type==="system").map(U=>U.content),S=x.filter(U=>U.type==="before").map(U=>U.content),k=x.filter(U=>U.type==="after").map(U=>U.content);S.length>0&&(b=`${S.join(`
`)}

${b}`),k.length>0&&(b=`${b}

    ${k.join(`
`)}`),b&&v.push({type:"text",text:b});const C=((D=e.metadata)==null?void 0:D.attachedFiles)??[];if(C.length>0){const U=await this._processFilesForPrompt(C,a);v.unshift(...U)}v.length>0?y.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let A=((W=e.metadata)==null?void 0:W.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(A=`${A?`${A}

        `:""}${w.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(N).forEach(U=>{(N[U]===null||N[U]===void 0)&&delete N[U]});const I={system:A,messages:y,parameters:N,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:L,effectiveRulesContent:ne,autoTitleEnabledForTurn:V,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:L}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(P=e.metadata.attachedFiles)==null?void 0:P.map(({contentBase64:U,contentText:H,...L})=>L)}};try{const U=fm.startInteraction(I,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const H=(((Z=e.metadata)==null?void 0:Z.effectiveRulesContent)??[]).map(L=>({id:L.sourceRuleId||ws(),name:L.sourceRuleId?`Rule ${L.sourceRuleId.substring(0,4)}`:"Context Rule",content:L.content,type:L.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,H).catch(L=>{console.error("[ConversationService] Background title generation failed:",L)})}await U}catch(U){throw console.error("[ConversationService] Error starting interaction:",U),Me.error(`Failed to start interaction: ${U instanceof Error?U.message:String(U)}`),U}},async generateConversationTitle(e,t,n){var o,l;const r=mr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:ws(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await fm.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var D,W,P,Z;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=Ln.getState(),n=Fo.getState(),r=Po.getState(),s=Un.getState(),i=t.interactions.find(U=>U.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){Me.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),m=i.index,y=t.interactions.filter(U=>U.conversationId===c&&U.index<m&&U.status==="COMPLETED"&&U.type==="message.user_assistant"&&U.parentId===null).sort((U,H)=>U.index-H.index),b=mj(y);let v=l.content;const x=[],w=((D=l.metadata)==null?void 0:D.effectiveRulesContent)??[],S=w.filter(U=>U.type==="system").map(U=>U.content),k=w.filter(U=>U.type==="before").map(U=>U.content),C=w.filter(U=>U.type==="after").map(U=>U.content);k.length>0&&(v=`${k.join(`
`)}

${v}`),C.length>0&&(v=`${v}

    ${C.join(`
`)}`),v&&x.push({type:"text",text:v});const R=((W=l.metadata)==null?void 0:W.attachedFiles)??[];if(R.length>0){const U=await this._processFilesForPrompt(R,c);x.unshift(...U)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let N=((P=l.metadata)==null?void 0:P.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(N=`${N?`${N}

        `:""}${S.join(`
`)}`);const I={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(I).forEach(U=>{(I[U]===null||I[U]===void 0)&&delete I[U]});const O={system:N,messages:b,parameters:I,metadata:{...(({turnSystemPrompt:U,activeTagIds:H,activeRuleIds:L,effectiveRulesContent:ne,autoTitleEnabledForTurn:V,...Q})=>({...Q,effectivelyAppliedTagIds:H,effectivelyAppliedRuleIds:L}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:R.map(({contentBase64:U,contentText:H,...L})=>L)}};let B=null;try{if(B=await fm.startInteraction(O,c,l,"message.assistant_regen"),!B)throw new Error("Failed to create new interaction for regeneration.");const U={};let H=!1;B.index!==o&&(U.index=o,H=!0),B.parentId!==a&&(U.parentId=a,H=!0);let L=B;H&&(t._updateInteractionInState(B.id,U),L={...B,...U},await St.saveInteraction(L)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify(L)));const ne=[];let V=i;for(;V;){ne.push(V);const ee=(Z=V.metadata)==null?void 0:Z.regeneratedFromId;ee?V=t.interactions.find(se=>se.id===ee):V=null}const Q=ne.sort((ee,se)=>{var je,De;const me=((je=ee.startedAt)==null?void 0:je.getTime())??0,ce=((De=se.startedAt)==null?void 0:De.getTime())??0;return me-ce});for(let ee=0;ee<Q.length;ee++){const se=Q[ee],me={parentId:L.id,index:ee};console.log(`[ConversationService] Updating old version ${se.id} to be child of ${L.id} with childIndex ${ee}`,JSON.parse(JSON.stringify(me))),t._updateInteractionInState(se.id,me),await St.saveInteraction({...se,...me})}}catch(U){throw console.error("[ConversationService] Error during regeneration process:",U),Me.error(`Failed to regenerate response: ${U instanceof Error?U.message:String(U)}`),U}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=Un.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{Me.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=S$(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await Yh(i.path,{fsInstance:s});a=S$({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{Qs.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(Qs.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=Qs.getState().fs;l&&(i(),t(l))}},i=()=>{Pe.off(dn.fsInstanceChanged,r),Pe.off(dn.loadingStateChanged,s)};Pe.on(dn.fsInstanceChanged,r),Pe.on(dn.loadingStateChanged,s);const a=Qs.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Pe.emit(dn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},fm={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Pe.on(mc.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=Ln.getState().interactions.find(s=>s.id===t);if(!n){Me.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){Me.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),Me.success("Response copied!")}catch(s){Me.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Pe.on(mc.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=Ln.getState().interactions.find(o=>o.id===t);if(!n){Me.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=Ln.getState();if(r.status==="streaming"){Me.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){Me.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),await Cx.regenerateInteraction(t)}catch(o){Me.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Pe.on(mc.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=Ln.getState().interactions.find(l=>l.id===t);if(!r){Me.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=Ln.getState();if(s.status==="streaming"){Me.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){Me.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=Po.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{await Cx.regenerateInteraction(t)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){Me.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Pe.on(mc.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e,s=Ln.getState().interactions.find(c=>c.id===t);if(!s){Me.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=Ln.getState();if(i.status==="streaming"){Me.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){Me.info("Can only race from the last response in the conversation.");return}if(n.length<2){Me.error("Need at least 2 models to race");return}try{const c=Po.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),Me.info(`Starting race with ${n.length} models...`);const d=n.map((b,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(b),await Cx.regenerateInteraction(t),x({success:!0,modelId:b,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:b,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const m=h.filter(b=>b.success).length,y=h.length-m;m>0?Me.success(`Race completed! ${m} models responded${y>0?`, ${y} failed`:""}`):Me.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){Me.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Pe.on(mc.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){Me.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),Me.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){Me.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var P,Z,U,H,L,ne,V,Q,ee,se,me,ce,je,De;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await PC(ny.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=ws(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=Ln.getState(),u=l.interactions.filter(Se=>Se.conversationId===t),d=r==="conversation.title_generation"?-1:u.reduce((Se,Ce)=>Math.max(Se,Ce.index),-1)+1,h=null,m=performance.now();this._interactionStartTimes.set(a,m);const y={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation"},index:d,parentId:h};r!=="conversation.title_generation"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added title generation interaction ${a} to state.`)),St.saveInteraction({...y}).catch(Se=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,Se)}),Pe.emit(Xn.started,{interactionId:a,conversationId:t,type:y.type});const b=(P=i.metadata)==null?void 0:P.modelId;if(!b)return this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=_c(b);if(!v||!x)return this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const w=Nr.getState().dbProviderConfigs.find(Se=>Se.id===v);if(!w)return this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const S=Nr.getState().getApiKeyForProvider(v),k=eO(w,x,S);if(!k)return this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const C=r!=="conversation.title_generation"?(((Z=i.metadata)==null?void 0:Z.enabledTools)??[]).reduce((Se,Ce)=>{if(Ce.startsWith("mcp_")){const qe=globalThis.mcpToolsModuleInstance;if(qe&&qe.mcpClients){const Qe=Ce.substring(4).split("_");if(Qe.length>=2){const We=Qe[0],Ne=Qe.slice(1).join("_");for(const[,K]of qe.mcpClients)if(K.name===We&&K.tools[Ne]){const ge=Ui.getState().getRegisteredTools(),Ae=`mcp_${We}_${Ne}`,le=ge[Ae];if(le&&le.definition){const oe={description:le.definition.description,parameters:le.definition.parameters,execute:async re=>{if(le.implementation)return await le.implementation(re,_$());throw console.error(`[InteractionService] MCP tool ${Ne} has no implementation`),new Error(`MCP tool ${Ne} has no implementation`)}};Se[Ce]=oe}else console.warn(`[InteractionService] MCP tool ${Ae} not found in control registry`);break}}}}else{const Qe=Ui.getState().getRegisteredTools()[Ce];if(Qe&&Qe.implementation){const We={description:Qe.definition.description,parameters:Qe.definition.parameters,execute:async Ne=>{const K=Ln.getState().currentConversationId,ge=K?Un.getState().getConversationById(K):null;let Ae;ge&&ge.projectId?typeof ge.projectId=="string"?Ae=ge.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${K} is not a string (type: ${typeof ge.projectId}). Defaulting VFS key to "orphan". Value:`,ge.projectId),Ae="orphan"):Ae="orphan";let le;try{if(Pe.emit(dn.initializeVFSRequest,{vfsKey:Ae,options:{force:!0}}),await new Promise(oe=>setTimeout(oe,100)),le=Qs.getState().fs,Qs.getState().configuredVfsKey!==Ae||!le)throw new Error(`Filesystem for key "${Ae}" not ready after request.`)}catch(oe){throw new Error(`Filesystem error: ${oe.message}`)}try{const oe=_$(),re=Qe.definition.parameters.parse(Ne),Te=Qe.implementation,Be={...oe,fsInstance:le};return await Te(re,Be)}catch(oe){throw oe instanceof Ac?new Error(`Invalid arguments: ${oe.errors.map(re=>`${re.path.join(".")} (${re.message})`).join(", ")}`):new Error(oe instanceof Error?oe.message:String(oe))}}};Se[Ce]=We}}return Se},{}):void 0,{getSelectedModel:R}=Nr.getState(),A=R(),N=((H=(U=A==null?void 0:A.metadata)==null?void 0:U.supported_parameters)==null?void 0:H.includes("tools"))??!1,I=(((L=i.metadata)==null?void 0:L.enabledTools)??[]).filter(Se=>Se.startsWith("mcp_")).length,O=(((ne=i.metadata)==null?void 0:ne.enabledTools)??[]).filter(Se=>!Se.startsWith("mcp_")).length;!N&&(I>0||O>0)&&console.warn(`[InteractionService] Model ${(A==null?void 0:A.name)||"unknown"} does not support tools. Ignoring ${I+O} enabled tools.`);const B=((V=i.parameters)==null?void 0:V.maxSteps)??mr.getState().toolMaxSteps,D={model:k,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(Q=i.parameters)==null?void 0:Q.temperature,maxTokens:(ee=i.parameters)==null?void 0:ee.max_tokens,topP:(se=i.parameters)==null?void 0:se.top_p,topK:(me=i.parameters)==null?void 0:me.top_k,presencePenalty:(ce=i.parameters)==null?void 0:ce.presence_penalty,frequencyPenalty:(je=i.parameters)==null?void 0:je.frequency_penalty,maxSteps:B,...N&&C&&Object.keys(C).length>0&&{tools:C},...((De=i.parameters)==null?void 0:De.providerOptions)&&{providerOptions:i.parameters.providerOptions},...N&&i.toolChoice&&{toolChoice:i.toolChoice}},W={onChunk:Se=>this._handleChunk(a,Se),onReasoningChunk:Se=>this._handleReasoningChunk(a,Se),onToolCall:Se=>this._handleToolCall(a,Se),onToolResult:Se=>this._handleToolResult(a,Se),onFinish:Se=>this._handleFinish(a,Se,r),onError:Se=>this._handleError(a,Se,r)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),H4e.executeInteraction(a,D,W).catch(Se=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,Se);const Ce=Ln.getState().interactions.find(qe=>qe.id===a);Ce&&Ce.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",Se instanceof Error?Se:new Error(String(Se)),r)}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),Me.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=Ln.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant"))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await PC(ny.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;Ln.getState().appendInteractionResponseChunk(e,s),Pe.emit(Xn.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){Ln.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),Ln.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),Ln.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},_handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},_finalizeInteraction(e,t,n,r="message.user_assistant",s){var C;const i=Ln.getState(),a=i.interactions.find(R=>R.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),m=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&m?Math.round(m-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const R=x.response.trim().replace(/^"|"$/g,"");R&&a&&(console.log(`[InteractionService] Updating conversation ${a.conversationId} title to: "${R}"`),Pe.emit(Zn.updateConversationRequest,{id:a.conversationId,updates:{title:R}}))}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=Ln.getState().interactions.find(R=>R.id===e);w?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((C=w.response)==null?void 0:C.length)??0}`),St.saveInteraction({...w}).catch(R=>{console.error(`[InteractionService] Failed final persistence for ${e}`,R)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],k=[];try{S=c.calls.map(R=>JSON.parse(R)),k=c.results.map(R=>JSON.parse(R))}catch(R){console.error("[InteractionService] Failed to parse tool strings for event emitter:",R)}Pe.emit(Xn.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:k}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},uk=Ve.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var P;const{interaction:s,interactionStatus:i}=Ln(gn(Z=>{const U=Z.interactions.find(H=>H.id===e);return{interaction:U,interactionStatus:U==null?void 0:U.status}})),a=mr(Z=>Z.streamingRenderFPS),[o,l]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!0),[m,y]=E.useState(!1),b=E.useRef(null),v=E.useRef(0),x=E.useRef(null);E.useEffect(()=>{const Z=1e3/a;let U=!0;const H=L=>{if(!U)return;if(Ln.getState().streamingInteractionIds.includes(e)){if(L-v.current>=Z){const V=Ln.getState().activeStreamBuffers[e]??"",Q=Ln.getState().activeReasoningBuffers[e]??"";l(V),u(Q),v.current=L}b.current=requestAnimationFrame(H)}else{const V=Ln.getState().activeStreamBuffers[e]??"",Q=Ln.getState().activeReasoningBuffers[e]??"";l(V),u(Q),b.current=null}};return b.current=requestAnimationFrame(H),()=>{U=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),E.useEffect(()=>{if(i&&i!=="STREAMING"){const Z=Ln.getState().activeStreamBuffers[e]??"",U=Ln.getState().activeReasoningBuffers[e]??"";l(Z),u(U),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:S}=Nr(gn(Z=>({dbProviderConfigs:Z.dbProviderConfigs,getAllAvailableModelDefsForProvider:Z.getAllAvailableModelDefsForProvider}))),k=E.useMemo(()=>{var ee;const Z=(ee=s==null?void 0:s.metadata)==null?void 0:ee.modelId;if(!Z)return"Loading Model...";const{providerId:U,modelId:H}=_c(Z);if(!U||!H)return Z;const L=w.find(se=>se.id===U),ne=(L==null?void 0:L.name)??U,Q=S(U).find(se=>se.id===H);return`${(Q==null?void 0:Q.name)??H} (${ne})`},[(P=s==null?void 0:s.metadata)==null?void 0:P.modelId,w,S]),C=E.useCallback(()=>h(Z=>!Z),[]),R=E.useCallback(()=>{y(!1)},[]),A=E.useCallback(()=>{y(!0)},[]),N=E.useCallback(()=>{m?R():A()},[m,R,A]);if(!s)return r?f.jsxs("div",{className:Je("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Je("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const I=()=>{fm.abortInteraction(e)},O=n==null?void 0:n("header-actions",s,{isFolded:m,toggleFold:N}),B=n==null?void 0:n("actions",s),D=n==null?void 0:n("content",s),W=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Je("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(hT,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1}),f.jsxs("div",{className:Je("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[W,f.jsxs("div",{className:Je("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(K0,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",k,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:O})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!m&&f.jsxs(f.Fragment,{children:[D,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:C,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Ly,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(er,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:Z=>{Z.stopPropagation(),C()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(Yl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(GMe,{interactionId:e,markdownContent:o,isStreaming:!0})]}),m&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:N,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Je("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[B,f.jsx(KMe,{onStop:I,"aria-label":"Stop Generation"})]})]})});uk.displayName="StreamingInteractionCard";const h7=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,ePe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:s,generationTime:i,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return f.jsxs("div",{className:Je("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(K0,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Ype,{className:"h-3 w-3"}),f.jsx("span",{children:o.toLocaleString()})]}),f.jsxs(Sr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),s!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(Qge,{className:"h-3 w-3"}),f.jsx("span",{children:h7(s)})]}),f.jsx(Sr,{side:"bottom",children:"Time to First Token"})]})}),i!==void 0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsxs(_r,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(qpe,{className:"h-3 w-3"}),f.jsx("span",{children:h7(i)})]}),f.jsx(Sr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},tPe=({markdownContent:e})=>{const t=fT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>typeof n=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`):n.type==="block"?f.jsx(Wy,{lang:n.lang,code:n.code,filepath:n.filepath},`block-${r}`):null)}):null},nPe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=E.useState(!0),[d,h]=E.useState(!1),m=Ui(gn(C=>Object.values(C.canvasControls))),y=E.useCallback((C,R)=>m.filter(A=>A.type==="tool-call-step"&&A.targetSlot===C&&A.renderer).map(A=>A.renderer?f.jsx(Ve.Fragment,{children:A.renderer(R)},A.id):null).filter(Boolean),[m]),b=E.useMemo(()=>{if(!n)return[];const C=n.map(A=>JSON.parse(A)),R=(r==null?void 0:r.map(A=>JSON.parse(A)))??[];return C.map(A=>{const N=R.find(I=>I.toolCallId===A.toolCallId);return{call:A,result:N}})},[n,r]),v=E.useCallback(()=>u(C=>!C),[]),x=E.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),Me.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(C){Me.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",C)}},[s]),w=!!s,S=t&&(typeof t!="string"||t.trim().length>0),k=b&&b.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",k?`[${b==null?void 0:b.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:k||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Ly,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(er,{tooltipText:"Copy Reasoning",onClick:C=>{C.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(so,{className:"text-green-500"}):f.jsx(hE,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(er,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:C=>{C.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(Yl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:C,result:R},A)=>{const N={interactionId:e,toolCall:C,toolResult:R,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:y("tool-call-content",N)},`tool-step-${C.toolCallId||A}`)}),S&&typeof t=="string"&&f.jsx(tPe,{markdownContent:t,interactionId:e}),!S&&!k&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},Wj=Ve.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var O,B,D,W,P,Z,U,H,L,ne,V,Q;const[s,i]=E.useState(!1),a=E.useRef(null),o=E.useCallback(()=>{i(!1)},[]),l=E.useCallback(()=>{i(!0)},[]),c=E.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Nr(gn(ee=>({dbProviderConfigs:ee.dbProviderConfigs,getAllAvailableModelDefsForProvider:ee.getAllAvailableModelDefsForProvider}))),h=e.endedAt?zZ(new Date(e.endedAt),{addSuffix:!0}):"Processing...",m=E.useMemo(()=>{var Ce;const ee=(Ce=e.metadata)==null?void 0:Ce.modelId;if(!ee)return"Unknown Model";const{providerId:se,modelId:me}=_c(ee);if(!se||!me)return ee;const ce=u.find(qe=>qe.id===se),je=(ce==null?void 0:ce.name)??se,Se=d(se).find(qe=>qe.id===me);return`${(Se==null?void 0:Se.name)??me} (${je})`},[(O=e.metadata)==null?void 0:O.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((B=e.metadata)==null?void 0:B.toolCalls)&&e.metadata.toolCalls.length>0,S=((D=e.metadata)==null?void 0:D.toolResults)&&e.metadata.toolResults.length>0,k=!!((W=e.metadata)!=null&&W.reasoning),C=x||w||S||k,R=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),A=n==null?void 0:n("actions",e),N=n==null?void 0:n("content",e),I=n==null?void 0:n("menu",e);return f.jsxs("div",{ref:a,className:Je("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(hT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y}),f.jsxs("div",{className:Je("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[I,f.jsx(ePe,{displayModelName:m,timeAgo:h,isFolded:s,toggleFold:c,canFold:C,promptTokens:(P=e.metadata)==null?void 0:P.promptTokens,completionTokens:(Z=e.metadata)==null?void 0:Z.completionTokens,timeToFirstToken:(U=e.metadata)==null?void 0:U.timeToFirstToken,generationTime:(H=e.metadata)==null?void 0:H.generationTime,headerActionsSlot:R&&R.length>0?f.jsx(f.Fragment,{children:R}):void 0}),N,f.jsx(nPe,{interactionId:e.id,response:e.response,toolCalls:(L=e.metadata)==null?void 0:L.toolCalls,toolResults:(ne=e.metadata)==null?void 0:ne.toolResults,reasoning:(V=e.metadata)==null?void 0:V.reasoning,isError:v,errorMessage:(Q=e.metadata)==null?void 0:Q.error,isFolded:s,toggleFold:c})]}),b&&A&&A.length>0&&f.jsx("div",{className:Je("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:A})]})});Wj.displayName="InteractionCard";const rPe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=E.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx(uk,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(Wj,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(AB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(AB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(bH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(vH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(Pme,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(pt,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx(uk,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(Wj,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};var sPe=E.createContext(void 0);function ob(e){const t=E.useContext(sPe);return e||t||"ltr"}function Ow(e,[t,n]){return Math.min(n,Math.max(t,e))}function iPe(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var DD="ScrollArea",[_J,ldt]=Gi(DD),[aPe,ec]=_J(DD),SJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=E.useState(null),[c,u]=E.useState(null),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(0),[S,k]=E.useState(0),[C,R]=E.useState(!1),[A,N]=E.useState(!1),I=Nn(t,B=>l(B)),O=ob(s);return f.jsx(aPe,{scope:n,type:r,dir:O,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:m,onScrollbarXChange:y,scrollbarXEnabled:C,onScrollbarXEnabledChange:R,scrollbarY:b,onScrollbarYChange:v,scrollbarYEnabled:A,onScrollbarYEnabledChange:N,onCornerWidthChange:w,onCornerHeightChange:k,children:f.jsx(or.div,{dir:O,...a,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});SJ.displayName=DD;var CJ="ScrollAreaViewport",kJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=ec(CJ,n),o=E.useRef(null),l=Nn(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(or.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});kJ.displayName=CJ;var zu="ScrollAreaScrollbar",EJ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=ec(zu,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return E.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(oPe,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(lPe,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(TJ,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(FD,{...r,ref:t}):null});EJ.displayName=zu;var oPe=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=ec(zu,e.__scopeScrollArea),[i,a]=E.useState(!1);return E.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(ca,{present:n||i,children:f.jsx(TJ,{"data-state":i?"visible":"hidden",...r,ref:t})})}),lPe=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=ec(zu,e.__scopeScrollArea),i=e.orientation==="horizontal",a=bT(()=>l("SCROLL_END"),100),[o,l]=iPe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),E.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const m=c[u];d!==m&&(l("SCROLL"),a()),d=m};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(ca,{present:n||o!=="hidden",children:f.jsx(FD,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),TJ=E.forwardRef((e,t)=>{const n=ec(zu,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=E.useState(!1),o=e.orientation==="horizontal",l=bT(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return xy(n.viewport,l),xy(n.content,l),f.jsx(ca,{present:r||i,children:f.jsx(FD,{"data-state":i?"visible":"hidden",...s,ref:t})})}),FD=E.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=ec(zu,e.__scopeScrollArea),i=E.useRef(null),a=E.useRef(0),[o,l]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=IJ(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,m){return pPe(h,a.current,o,m)}return n==="horizontal"?f.jsx(cPe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,m=p7(h,o,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(uPe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,m=p7(h,o);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),cPe=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=ec(zu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Nn(t,l,i.onScrollbarXChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(RJ,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":yT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),PJ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:fk(a.paddingLeft),paddingEnd:fk(a.paddingRight)}})}})}),uPe=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=ec(zu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=Nn(t,l,i.onScrollbarYChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(RJ,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":yT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),PJ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:fk(a.paddingTop),paddingEnd:fk(a.paddingBottom)}})}})}),[dPe,AJ]=_J(zu),RJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,m=ec(zu,n),[y,b]=E.useState(null),v=Nn(t,I=>b(I)),x=E.useRef(null),w=E.useRef(""),S=m.viewport,k=r.content-r.viewport,C=Es(u),R=Es(l),A=bT(d,10);function N(I){if(x.current){const O=I.clientX-x.current.left,B=I.clientY-x.current.top;c({x:O,y:B})}}return E.useEffect(()=>{const I=O=>{const B=O.target;(y==null?void 0:y.contains(B))&&C(O,k)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[S,y,k,C]),E.useEffect(R,[r,R]),xy(y,A),xy(m.content,A),f.jsx(dPe,{scope:n,scrollbar:y,hasThumb:s,onThumbChange:Es(i),onThumbPointerUp:Es(a),onThumbPositionChange:R,onThumbPointerDown:Es(o),children:f.jsx(or.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),x.current=y.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),N(I))}),onPointerMove:Wt(e.onPointerMove,N),onPointerUp:Wt(e.onPointerUp,I=>{const O=I.target;O.hasPointerCapture(I.pointerId)&&O.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),dk="ScrollAreaThumb",NJ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=AJ(dk,e.__scopeScrollArea);return f.jsx(ca,{present:n||s.hasThumb,children:f.jsx(fPe,{ref:t,...r})})}),fPe=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=ec(dk,n),a=AJ(dk,n),{onThumbPositionChange:o}=a,l=Nn(t,d=>a.onThumbChange(d)),c=E.useRef(void 0),u=bT(()=>{c.current&&(c.current(),c.current=void 0)},100);return E.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const m=mPe(d,o);c.current=m,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(or.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const m=d.target.getBoundingClientRect(),y=d.clientX-m.left,b=d.clientY-m.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});NJ.displayName=dk;var LD="ScrollAreaCorner",MJ=E.forwardRef((e,t)=>{const n=ec(LD,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(hPe,{...e,ref:t}):null});MJ.displayName=LD;var hPe=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=ec(LD,n),[i,a]=E.useState(0),[o,l]=E.useState(0),c=!!(i&&o);return xy(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),xy(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(or.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function fk(e){return e?parseInt(e,10):0}function IJ(e,t){const n=e/t;return isNaN(n)?0:n}function yT(e){const t=IJ(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function pPe(e,t,n,r="ltr"){const s=yT(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return jJ([l,c],d)(e)}function p7(e,t,n="ltr"){const r=yT(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=Ow(e,l);return jJ([0,a],[0,o])(c)}function jJ(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function PJ(e,t){return e>0&&e<t}var mPe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function bT(e,t){const n=Es(e),r=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),E.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function xy(e,t){const n=Es(t);ri(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var gPe=SJ,yPe=kJ,bPe=MJ;function Hl({className:e,children:t,...n}){return f.jsxs(gPe,{"data-slot":"scroll-area",className:Je("relative",e),...n,children:[f.jsx(yPe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(vPe,{}),f.jsx(bPe,{})]})}function vPe({className:e,orientation:t="vertical",...n}){return f.jsx(EJ,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Je("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx(NJ,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Wr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Je("bg-accent animate-pulse rounded-md",e),...t})}const xPe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function ol({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Je("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function ll({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Je("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function cl({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Je("leading-none font-semibold",e),...t})}function Ld({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Je("text-muted-foreground text-sm",e),...t})}function ul({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Je("px-6",e),...t})}function wPe({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Je("flex items-center px-6 [.border-t]:pt-6",e),...t})}const Pr={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},_Pe=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(ol,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(ll,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(cl,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx(upe,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx(ul,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),OJ=()=>{const e=(r,s)=>{Pe.emit(Pr.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Pe.emit(Pr.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(sC,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(Z3,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx($P,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx(Z0,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(qx,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(Tc,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(_Pe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},m7=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(xPe,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx(OJ,{})]}),BD=E.createContext({});function $D(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const zD=typeof window<"u",DJ=zD?E.useLayoutEffect:E.useEffect,vT=E.createContext(null),UD=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class SPe extends E.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function CPe({children:e,isPresent:t,anchorX:n}){const r=E.useId(),s=E.useRef(null),i=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=E.useContext(UD);return E.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),f.jsx(SPe,{isPresent:t,childRef:s,sizeRef:i,children:E.cloneElement(e,{ref:s})})}const kPe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=$D(EPe),c=E.useId();let u=!0,d=E.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const m of l.values())if(!m)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),E.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[n]),E.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(CPe,{isPresent:n,anchorX:o,children:e})),f.jsx(vT.Provider,{value:d,children:e})};function EPe(){return new Map}function FJ(e=!0){const t=E.useContext(vT);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=E.useId();E.useEffect(()=>{if(e)return s(i)},[e]);const a=E.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const KS=e=>e.key||"";function g7(e){const t=[];return E.Children.forEach(e,n=>{E.isValidElement(n)&&t.push(n)}),t}const TPe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=FJ(a),u=E.useMemo(()=>g7(e),[e]),d=a&&!l?[]:u.map(KS),h=E.useRef(!0),m=E.useRef(u),y=$D(()=>new Map),[b,v]=E.useState(u),[x,w]=E.useState(u);DJ(()=>{h.current=!1,m.current=u;for(let C=0;C<x.length;C++){const R=KS(x[C]);d.includes(R)?y.delete(R):y.get(R)!==!0&&y.set(R,!1)}},[x,d.length,d.join("-")]);const S=[];if(u!==b){let C=[...u];for(let R=0;R<x.length;R++){const A=x[R],N=KS(A);d.includes(N)||(C.splice(R,0,A),S.push(A))}return i==="wait"&&S.length&&(C=S),w(g7(C)),v(u),null}const{forceRender:k}=E.useContext(BD);return f.jsx(f.Fragment,{children:x.map(C=>{const R=KS(C),A=a&&!l?!1:u===x||d.includes(R),N=()=>{if(y.has(R))y.set(R,!0);else return;let I=!0;y.forEach(O=>{O||(I=!1)}),I&&(k==null||k(),w(m.current),a&&(c==null||c()),r&&r())};return f.jsx(kPe,{isPresent:A,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:A?void 0:N,anchorX:o,children:C},R)})})},YS=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],y7={value:null};function APe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,m=!1)=>{const b=m&&s?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&y7.value&&y7.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Yd={},RPe=40;function LJ(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=YS.reduce((S,k)=>(S[k]=APe(i,t?k:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:m,postRender:y}=a,b=()=>{const S=Yd.useManualTiming?s.timestamp:performance.now();n=!1,Yd.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,RPe),1)),s.timestamp=S,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),y.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},v=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:YS.reduce((S,k)=>{const C=a[k];return S[k]=(R,A=!1,N=!1)=>(n||v(),C.schedule(R,A,N)),S},{}),cancel:S=>{for(let k=0;k<YS.length;k++)a[YS[k]].cancel(S)},state:s,steps:a}}const ql=e=>e,{schedule:ni,cancel:Rh,state:va,steps:TI}=LJ(typeof requestAnimationFrame<"u"?requestAnimationFrame:ql,!0),BJ=E.createContext({strict:!1}),b7={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},wy={};for(const e in b7)wy[e]={isEnabled:t=>b7[e].some(n=>!!t[n])};function NPe(e){for(const t in e)wy[t]={...wy[t],...e[t]}}const MPe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function hk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||MPe.has(e)}let $J=e=>!hk(e);function IPe(e){e&&($J=t=>t.startsWith("on")?!hk(t):e(t))}try{IPe(require("@emotion/is-prop-valid").default)}catch{}function jPe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||($J(s)||n===!0&&hk(s)||!t&&!hk(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function PPe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const xT=E.createContext({});function wT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Dw(e){return typeof e=="string"||Array.isArray(e)}const qD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],VD=["initial",...qD];function _T(e){return wT(e.animate)||VD.some(t=>Dw(e[t]))}function zJ(e){return!!(_T(e)||e.variants)}function OPe(e,t){if(_T(e)){const{initial:n,animate:r}=e;return{initial:n===!1||Dw(n)?n:void 0,animate:Dw(r)?r:void 0}}return e.inherit!==!1?t:{}}function DPe(e){const{initial:t,animate:n}=OPe(e,E.useContext(xT));return E.useMemo(()=>({initial:t,animate:n}),[v7(t),v7(n)])}function v7(e){return Array.isArray(e)?e.join(" "):e}const FPe=Symbol.for("motionComponentSymbol");function x0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function LPe(e,t,n){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):x0(n)&&(n.current=r))},[t])}const WD=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),BPe="framerAppearId",UJ="data-"+WD(BPe),qJ=E.createContext({}),{schedule:HD}=LJ(queueMicrotask,!1);function $Pe(e,t,n,r,s){var b,v;const{visualElement:i}=E.useContext(xT),a=E.useContext(BJ),o=E.useContext(vT),l=E.useContext(UD).reducedMotion,c=E.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=E.useContext(qJ);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&zPe(c.current,n,s,d);const h=E.useRef(!1);E.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const m=n[UJ],y=E.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return DJ(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),HD.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,m)}),y.current=!1))}),u}function zPe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:VJ(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&x0(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function VJ(e){if(e)return e.options.allowProjection!==!1?e.projection:VJ(e.parent)}let GD=()=>{};function UPe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&NPe(e);function i(o,l){let c;const u={...E.useContext(UD),...o,layoutId:qPe(o)},{isStatic:d}=u,h=DPe(o),m=r(o,d);if(!d&&zD){VPe();const y=WPe(u);c=y.MeasureLayout,h.visualElement=$Pe(s,m,u,t,y.ProjectionNode)}return f.jsxs(xT.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,LPe(m,h.visualElement,l),m,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=E.forwardRef(i);return a[FPe]=s,a}function qPe({layoutId:e}){const t=E.useContext(BD).id;return t&&e!==void 0?t+"-"+e:e}function VPe(e,t){E.useContext(BJ).strict}function WPe(e){const{drag:t,layout:n}=wy;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const WJ=e=>t=>typeof t=="string"&&t.startsWith(e),KD=WJ("--"),HPe=WJ("var(--"),YD=e=>HPe(e)?GPe.test(e.split("/*")[0].trim()):!1,GPe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fw={};function KPe(e){for(const t in e)Fw[t]=e[t],KD(t)&&(Fw[t].isCSSVariable=!0)}const lb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],cb=new Set(lb);function HJ(e,{layout:t,layoutId:n}){return cb.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!Fw[e]||e==="opacity")}const Da=e=>!!(e&&e.getVelocity),GJ=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Zd=(e,t,n)=>n>t?t:n<e?e:n,ub={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Lw={...ub,transform:e=>Zd(0,1,e)},ZS={...ub,default:1},x7={...ub,transform:Math.round},G1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Jf=G1("deg"),Cu=G1("%"),ar=G1("px"),YPe=G1("vh"),ZPe=G1("vw"),w7={...Cu,parse:e=>Cu.parse(e)/100,transform:e=>Cu.transform(e*100)},XPe={rotate:Jf,rotateX:Jf,rotateY:Jf,rotateZ:Jf,scale:ZS,scaleX:ZS,scaleY:ZS,scaleZ:ZS,skew:Jf,skewX:Jf,skewY:Jf,distance:ar,translateX:ar,translateY:ar,translateZ:ar,x:ar,y:ar,z:ar,perspective:ar,transformPerspective:ar,opacity:Lw,originX:w7,originY:w7,originZ:ar},ZD={borderWidth:ar,borderTopWidth:ar,borderRightWidth:ar,borderBottomWidth:ar,borderLeftWidth:ar,borderRadius:ar,radius:ar,borderTopLeftRadius:ar,borderTopRightRadius:ar,borderBottomRightRadius:ar,borderBottomLeftRadius:ar,width:ar,maxWidth:ar,height:ar,maxHeight:ar,top:ar,right:ar,bottom:ar,left:ar,padding:ar,paddingTop:ar,paddingRight:ar,paddingBottom:ar,paddingLeft:ar,margin:ar,marginTop:ar,marginRight:ar,marginBottom:ar,marginLeft:ar,backgroundPositionX:ar,backgroundPositionY:ar,...XPe,zIndex:x7,fillOpacity:Lw,strokeOpacity:Lw,numOctaves:x7},JPe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},QPe=lb.length;function eOe(e,t,n){let r="",s=!0;for(let i=0;i<QPe;i++){const a=lb[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=GJ(o,ZD[a]);if(!l){s=!1;const u=JPe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function XD(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(cb.has(l)){a=!0;continue}else if(KD(l)){s[l]=c;continue}else{const u=GJ(c,ZD[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=eOe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const JD=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function KJ(e,t,n){for(const r in t)!Da(t[r])&&!HJ(r,n)&&(e[r]=t[r])}function tOe({transformTemplate:e},t){return E.useMemo(()=>{const n=JD();return XD(n,t,e),Object.assign({},n.vars,n.style)},[t])}function nOe(e,t){const n=e.style||{},r={};return KJ(r,n,e),Object.assign(r,tOe(e,t)),r}function rOe(e,t){const n={},r=nOe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const sOe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function QD(e){return typeof e!="string"||e.includes("-")?!1:!!(sOe.indexOf(e)>-1||/[A-Z]/u.test(e))}const iOe={offset:"stroke-dashoffset",array:"stroke-dasharray"},aOe={offset:"strokeDashoffset",array:"strokeDasharray"};function oOe(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?iOe:aOe;e[i.offset]=ar.transform(-r);const a=ar.transform(t),o=ar.transform(n);e[i.array]=`${a} ${o}`}function YJ(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(XD(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&oOe(d,s,i,a,!1)}const ZJ=()=>({...JD(),attrs:{}}),XJ=e=>typeof e=="string"&&e.toLowerCase()==="svg";function lOe(e,t,n,r){const s=E.useMemo(()=>{const i=ZJ();return YJ(i,t,XJ(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};KJ(i,e.style,e),s.style={...i,...s.style}}return s}function cOe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(QD(n)?lOe:rOe)(r,i,a,n),c=jPe(r,typeof n=="string",e),u=n!==E.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=E.useMemo(()=>Da(d)?d.get():d,[d]);return E.createElement(n,{...u,children:h})}}function _7(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function e6(e,t,n,r){if(typeof t=="function"){const[s,i]=_7(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=_7(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function P2(e){return Da(e)?e.get():e}function uOe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:dOe(n,r,s,e),renderState:t()}}const JJ=e=>(t,n)=>{const r=E.useContext(xT),s=E.useContext(vT),i=()=>uOe(e,t,r,s);return n?i():$D(i)};function dOe(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=P2(i[h]);let{initial:a,animate:o}=e;const l=_T(e),c=zJ(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!wT(d)){const h=Array.isArray(d)?d:[d];for(let m=0;m<h.length;m++){const y=e6(e,h[m]);if(y){const{transitionEnd:b,transition:v,...x}=y;for(const w in x){let S=x[w];if(Array.isArray(S)){const k=u?S.length-1:0;S=S[k]}S!==null&&(s[w]=S)}for(const w in b)s[w]=b[w]}}}return s}function t6(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(Da(r[a])||t.style&&Da(t.style[a])||HJ(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const fOe={useVisualState:JJ({scrapeMotionValuesFromProps:t6,createRenderState:JD})};function QJ(e,t,n){const r=t6(e,t,n);for(const s in e)if(Da(e[s])||Da(t[s])){const i=lb.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const hOe={useVisualState:JJ({scrapeMotionValuesFromProps:QJ,createRenderState:ZJ})};function pOe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...QD(r)?hOe:fOe,preloadedFeatures:e,useRender:cOe(s),createVisualElement:t,Component:r};return UPe(a)}}function Bw(e,t,n){const r=e.getProps();return e6(r,t,n!==void 0?n:r.custom,e)}const Hj=e=>Array.isArray(e);let O2;function mOe(){O2=void 0}const ko={now:()=>(O2===void 0&&ko.set(va.isProcessing||Yd.useManualTiming?va.timestamp:performance.now()),O2),set:e=>{O2=e,queueMicrotask(mOe)}};function n6(e,t){e.indexOf(t)===-1&&e.push(t)}function r6(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class s6{constructor(){this.subscriptions=[]}add(t){return n6(this.subscriptions,t),()=>r6(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function eQ(e,t){return t?e*(1e3/t):0}const S7=30,gOe=e=>!isNaN(parseFloat(e));class yOe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=ko.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=ko.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=gOe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new s6);const r=this.events[t].add(n);return t==="change"?()=>{r(),ni.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=ko.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>S7)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,S7);return eQ(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $w(e,t){return new yOe(e,t)}function bOe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,$w(n))}function vOe(e){return Hj(e)?e[e.length-1]||0:e}function xOe(e,t){const n=Bw(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=vOe(i[a]);bOe(e,a,o)}}function wOe(e){return!!(Da(e)&&e.add)}function Gj(e,t){const n=e.getValue("willChange");if(wOe(n))return n.add(t);if(!n&&Yd.WillChange){const r=new Yd.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function tQ(e){return e.props[UJ]}const _Oe=e=>e!==null;function SOe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(_Oe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const COe={type:"spring",stiffness:500,damping:25,restSpeed:10},kOe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),EOe={type:"keyframes",duration:.8},TOe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AOe=(e,{keyframes:t})=>t.length>2?EOe:cb.has(e)?e.startsWith("scale")?kOe(t[1]):COe:TOe;function ROe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function i6(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const ku=e=>e*1e3,Eu=e=>e/1e3,kx=e=>Math.round(e*1e5)/1e5,a6=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function NOe(e){return e==null}const MOe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,o6=(e,t)=>n=>!!(typeof n=="string"&&MOe.test(n)&&n.startsWith(e)||t&&!NOe(n)&&Object.prototype.hasOwnProperty.call(n,t)),nQ=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(a6);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},IOe=e=>Zd(0,255,e),AI={...ub,transform:e=>Math.round(IOe(e))},rm={test:o6("rgb","red"),parse:nQ("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+AI.transform(e)+", "+AI.transform(t)+", "+AI.transform(n)+", "+kx(Lw.transform(r))+")"};function jOe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const Kj={test:o6("#"),parse:jOe,transform:rm.transform},w0={test:o6("hsl","hue"),parse:nQ("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Cu.transform(kx(t))+", "+Cu.transform(kx(n))+", "+kx(Lw.transform(r))+")"},Ia={test:e=>rm.test(e)||Kj.test(e)||w0.test(e),parse:e=>rm.test(e)?rm.parse(e):w0.test(e)?w0.parse(e):Kj.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?rm.transform(e):w0.transform(e)},POe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function OOe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(a6))==null?void 0:t.length)||0)+(((n=e.match(POe))==null?void 0:n.length)||0)>0}const rQ="number",sQ="color",DOe="var",FOe="var(",C7="${}",LOe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function zw(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(LOe,l=>(Ia.test(l)?(r.color.push(i),s.push(sQ),n.push(Ia.parse(l))):l.startsWith(FOe)?(r.var.push(i),s.push(DOe),n.push(l)):(r.number.push(i),s.push(rQ),n.push(parseFloat(l))),++i,C7)).split(C7);return{values:n,split:o,indexes:r,types:s}}function iQ(e){return zw(e).values}function aQ(e){const{split:t,types:n}=zw(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===rQ?i+=kx(s[a]):o===sQ?i+=Ia.transform(s[a]):i+=s[a]}return i}}const BOe=e=>typeof e=="number"?0:e;function $Oe(e){const t=iQ(e);return aQ(e)(t.map(BOe))}const Nh={test:OOe,parse:iQ,createTransformer:aQ,getAnimatableNone:$Oe};function RI(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function zOe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=RI(l,o,e+1/3),i=RI(l,o,e),a=RI(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function pk(e,t){return n=>n>0?t:e}const ei=(e,t,n)=>e+(t-e)*n,NI=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},UOe=[Kj,rm,w0],qOe=e=>UOe.find(t=>t.test(e));function k7(e){const t=qOe(e);if(!t)return!1;let n=t.parse(e);return t===w0&&(n=zOe(n)),n}const E7=(e,t)=>{const n=k7(e),r=k7(t);if(!n||!r)return pk(e,t);const s={...n};return i=>(s.red=NI(n.red,r.red,i),s.green=NI(n.green,r.green,i),s.blue=NI(n.blue,r.blue,i),s.alpha=ei(n.alpha,r.alpha,i),rm.transform(s))},Yj=new Set(["none","hidden"]);function VOe(e,t){return Yj.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const WOe=(e,t)=>n=>t(e(n)),K1=(...e)=>e.reduce(WOe);function HOe(e,t){return n=>ei(e,t,n)}function l6(e){return typeof e=="number"?HOe:typeof e=="string"?YD(e)?pk:Ia.test(e)?E7:YOe:Array.isArray(e)?oQ:typeof e=="object"?Ia.test(e)?E7:GOe:pk}function oQ(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>l6(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function GOe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=l6(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function KOe(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const YOe=(e,t)=>{const n=Nh.createTransformer(t),r=zw(e),s=zw(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?Yj.has(e)&&!s.values.length||Yj.has(t)&&!r.values.length?VOe(e,t):K1(oQ(KOe(r,s),s.values),n):pk(e,t)};function lQ(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?ei(e,t,n):l6(e)(e,t)}const ZOe=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ni.update(t,!0),stop:()=>Rh(t),now:()=>va.isProcessing?va.timestamp:ko.now()}},cQ=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},mk=2e4;function c6(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<mk;)t+=n,r=e.next(t);return t>=mk?1/0:t}function XOe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(c6(r),mk);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:Eu(s)}}const JOe=5;function uQ(e,t,n){const r=Math.max(t-JOe,0);return eQ(n-e(r),t-r)}const oi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},T7=.001;function QOe({duration:e=oi.duration,bounce:t=oi.bounce,velocity:n=oi.velocity,mass:r=oi.mass}){let s,i,a=1-t;a=Zd(oi.minDamping,oi.maxDamping,a),e=Zd(oi.minDuration,oi.maxDuration,Eu(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,m=Zj(c,a),y=Math.exp(-d);return T7-h/m*y},i=c=>{const d=c*a*e,h=d*n+n,m=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=Zj(Math.pow(c,2),a);return(-s(c)+T7>0?-1:1)*((h-m)*y)/b}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=tDe(s,i,o);if(e=ku(e),isNaN(l))return{stiffness:oi.stiffness,damping:oi.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const eDe=12;function tDe(e,t,n){let r=n;for(let s=1;s<eDe;s++)r=r-e(r)/t(r);return r}function Zj(e,t){return e*Math.sqrt(1-t*t)}const nDe=["duration","bounce"],rDe=["stiffness","damping","mass"];function A7(e,t){return t.some(n=>e[n]!==void 0)}function sDe(e){let t={velocity:oi.velocity,stiffness:oi.stiffness,damping:oi.damping,mass:oi.mass,isResolvedFromDuration:!1,...e};if(!A7(e,rDe)&&A7(e,nDe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*Zd(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:oi.mass,stiffness:s,damping:i}}else{const n=QOe(e);t={...t,...n,mass:oi.mass},t.isResolvedFromDuration=!0}return t}function gk(e=oi.visualDuration,t=oi.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:m}=sDe({...n,velocity:-Eu(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),v=a-i,x=Eu(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?oi.restSpeed.granular:oi.restSpeed.default),s||(s=w?oi.restDelta.granular:oi.restDelta.default);let S;if(b<1){const C=Zj(x,b);S=R=>{const A=Math.exp(-b*x*R);return a-A*((y+b*x*v)/C*Math.sin(C*R)+v*Math.cos(C*R))}}else if(b===1)S=C=>a-Math.exp(-x*C)*(v+(y+x*v)*C);else{const C=x*Math.sqrt(b*b-1);S=R=>{const A=Math.exp(-b*x*R),N=Math.min(C*R,300);return a-A*((y+b*x*v)*Math.sinh(N)+C*v*Math.cosh(N))/C}}const k={calculatedDuration:m&&d||null,next:C=>{const R=S(C);if(m)o.done=C>=d;else{let A=C===0?y:0;b<1&&(A=C===0?ku(y):uQ(S,C,R));const N=Math.abs(A)<=r,I=Math.abs(a-R)<=s;o.done=N&&I}return o.value=o.done?a:R,o},toString:()=>{const C=Math.min(c6(k),mk),R=cQ(A=>k.next(C*A).value,C,30);return C+"ms "+R},toTransition:()=>{}};return k}gk.applyToOptions=e=>{const t=XOe(e,100,gk);return e.ease=t.ease,e.duration=ku(t.duration),e.type="keyframes",e};function Xj({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},m=N=>o!==void 0&&N<o||l!==void 0&&N>l,y=N=>o===void 0?l:l===void 0||Math.abs(o-N)<Math.abs(l-N)?o:l;let b=n*t;const v=d+b,x=a===void 0?v:a(v);x!==v&&(b=x-d);const w=N=>-b*Math.exp(-N/r),S=N=>x+w(N),k=N=>{const I=w(N),O=S(N);h.done=Math.abs(I)<=c,h.value=h.done?x:O};let C,R;const A=N=>{m(h.value)&&(C=N,R=gk({keyframes:[h.value,y(h.value)],velocity:uQ(S,N,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return A(0),{calculatedDuration:null,next:N=>{let I=!1;return!R&&C===void 0&&(I=!0,k(N),A(N)),C!==void 0&&N>=C?R.next(N-C):(!I&&k(N),h)}}}const Uw=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function iDe(e,t,n){const r=[],s=n||Yd.mix||lQ,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||ql:t;o=K1(l,o)}r.push(o)}return r}function aDe(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(GD(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=iDe(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=Uw(e[d],e[d+1],u);return o[d](h)};return n?u=>c(Zd(e[0],e[i-1],u)):c}function oDe(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=Uw(0,t,r);e.push(ei(n,1,s))}}function lDe(e){const t=[0];return oDe(t,e.length-1),t}function cDe(e,t){return e.map(n=>n*t)}const dQ=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,uDe=1e-7,dDe=12;function fDe(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=dQ(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>uDe&&++o<dDe);return a}function Y1(e,t,n,r){if(e===t&&n===r)return ql;const s=i=>fDe(i,0,1,e,n);return i=>i===0||i===1?i:dQ(s(i),t,r)}const hDe=Y1(.42,0,1,1),pDe=Y1(0,0,.58,1),fQ=Y1(.42,0,.58,1),mDe=e=>Array.isArray(e)&&typeof e[0]!="number",hQ=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,pQ=e=>t=>1-e(1-t),mQ=Y1(.33,1.53,.69,.99),u6=pQ(mQ),gQ=hQ(u6),yQ=e=>(e*=2)<1?.5*u6(e):.5*(2-Math.pow(2,-10*(e-1))),d6=e=>1-Math.sin(Math.acos(e)),bQ=pQ(d6),vQ=hQ(d6),xQ=e=>Array.isArray(e)&&typeof e[0]=="number",gDe={linear:ql,easeIn:hDe,easeInOut:fQ,easeOut:pDe,circIn:d6,circInOut:vQ,circOut:bQ,backIn:u6,backInOut:gQ,backOut:mQ,anticipate:yQ},yDe=e=>typeof e=="string",R7=e=>{if(xQ(e)){GD(e.length===4);const[t,n,r,s]=e;return Y1(t,n,r,s)}else if(yDe(e))return gDe[e];return e};function bDe(e,t){return e.map(()=>t||fQ).splice(0,e.length-1)}function Ex({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=mDe(r)?r.map(R7):R7(r),i={done:!1,value:t[0]},a=cDe(n&&n.length===t.length?n:lDe(t),e),o=aDe(a,t,{ease:Array.isArray(s)?s:bDe(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const vDe=e=>e!==null;function f6(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(vDe),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const xDe={decay:Xj,inertia:Xj,tween:Ex,keyframes:Ex,spring:gk};function wQ(e){typeof e.type=="string"&&(e.type=xDe[e.type])}class h6{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const wDe=e=>e/100;class _Q extends h6{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==ko.now()&&this.tick(ko.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;wQ(t);const{type:n=Ex,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||Ex;l!==Ex&&typeof o[0]!="number"&&(this.mixKeyframes=K1(wDe,lQ(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=c6(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:m,type:y,onUpdate:b,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,k=r;if(d){const N=Math.min(this.currentTime,s)/o;let I=Math.floor(N),O=N%1;!O&&N>=1&&(O=1),O===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(O=1-O,m&&(O-=m/o)):h==="mirror"&&(k=a)),S=Zd(0,1,O)*o}const C=w?{done:!1,value:u[0]}:k.next(S);i&&(C.value=i(C.value));let{done:R}=C;!w&&l!==null&&(R=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return A&&y!==Xj&&(C.value=f6(u,this.options,v,this.speed)),b&&b(C.value),A&&this.finish(),C}then(t,n){return this.finished.then(t,n)}get duration(){return Eu(this.calculatedDuration)}get time(){return Eu(this.currentTime)}set time(t){t=ku(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(ko.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Eu(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=ZOe,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ko.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function _De(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const sm=e=>e*180/Math.PI,Jj=e=>{const t=sm(Math.atan2(e[1],e[0]));return Qj(t)},SDe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Jj,rotateZ:Jj,skewX:e=>sm(Math.atan(e[1])),skewY:e=>sm(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Qj=e=>(e=e%360,e<0&&(e+=360),e),N7=Jj,M7=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),I7=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),CDe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:M7,scaleY:I7,scale:e=>(M7(e)+I7(e))/2,rotateX:e=>Qj(sm(Math.atan2(e[6],e[5]))),rotateY:e=>Qj(sm(Math.atan2(-e[2],e[0]))),rotateZ:N7,rotate:N7,skewX:e=>sm(Math.atan(e[4])),skewY:e=>sm(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function j7(e){return e.includes("scale")?1:0}function e4(e,t){if(!e||e==="none")return j7(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=CDe,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=SDe,s=o}if(!s)return j7(t);const i=r[t],a=s[1].split(",").map(EDe);return typeof i=="function"?i(a):a[i]}const kDe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return e4(n,t)};function EDe(e){return parseFloat(e.trim())}const P7=e=>e===ub||e===ar,TDe=new Set(["x","y","z"]),ADe=lb.filter(e=>!TDe.has(e));function RDe(e){const t=[];return ADe.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const hm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>e4(t,"x"),y:(e,{transform:t})=>e4(t,"y")};hm.translateX=hm.x;hm.translateY=hm.y;const pm=new Set;let t4=!1,n4=!1,r4=!1;function SQ(){if(n4){const e=Array.from(pm).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=RDe(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}n4=!1,t4=!1,pm.forEach(e=>e.complete(r4)),pm.clear()}function CQ(){pm.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(n4=!0)})}function NDe(){r4=!0,CQ(),SQ(),r4=!1}class p6{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(pm.add(this),t4||(t4=!0,ni.read(CQ),ni.resolveKeyframes(SQ))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}_De(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),pm.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,pm.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const MDe=e=>e.startsWith("--");function IDe(e,t,n){MDe(t)?e.style.setProperty(t,n):e.style[t]=n}function m6(e){let t;return()=>(t===void 0&&(t=e()),t)}const jDe=m6(()=>window.ScrollTimeline!==void 0),PDe={};function ODe(e,t){const n=m6(e);return()=>PDe[t]??n()}const kQ=ODe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),tx=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,O7={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:tx([0,.65,.55,1]),circOut:tx([.55,0,1,.45]),backIn:tx([.31,.01,.66,-.59]),backOut:tx([.33,1.53,.69,.99])};function EQ(e,t){if(e)return typeof e=="function"?kQ()?cQ(e,t):"ease-out":xQ(e)?tx(e):Array.isArray(e)?e.map(n=>EQ(n,t)||O7.easeOut):O7[e]}function DDe(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=EQ(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function TQ(e){return typeof e=="function"&&"applyToOptions"in e}function FDe({type:e,...t}){return TQ(e)&&kQ()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class LDe extends h6{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,GD(typeof t.type!="string");const c=FDe(t);this.animation=DDe(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=f6(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):IDe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Eu(Number(t))}get time(){return Eu(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=ku(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&jDe()?(this.animation.timeline=t,ql):n(this)}}const AQ={anticipate:yQ,backInOut:gQ,circInOut:vQ};function BDe(e){return e in AQ}function $De(e){typeof e.ease=="string"&&BDe(e.ease)&&(e.ease=AQ[e.ease])}const D7=10;class zDe extends LDe{constructor(t){$De(t),wQ(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new _Q({...a,autoplay:!1}),l=ku(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-D7).value,o.sample(l).value,D7),o.stop()}}const F7=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Nh.test(e)||e==="0")&&!e.startsWith("url("));function UDe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function qDe(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=F7(s,t),o=F7(i,t);return!a||!o?!1:UDe(e)||(n==="spring"||TQ(n))&&r}const VDe=new Set(["opacity","clipPath","filter","transform"]),WDe=m6(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function HDe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return WDe()&&n&&VDe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const GDe=40;class KDe extends h6{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,v;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=ko.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},m=(u==null?void 0:u.KeyframeResolver)||p6;this.keyframeResolver=new m(o,(b,v,x)=>this.onKeyframesResolved(b,v,h,!x),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=ko.now(),qDe(t,i,a,o)||((Yd.instantAnimations||!l)&&(u==null||u(f6(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>GDe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},m=!c&&HDe(h)?new zDe({...h,element:h.motionValue.owner.current}):new _Q(h);m.finished.then(()=>this.notifyFinished()).catch(ql),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||NDe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const g6=(e,t,n,r={},s,i)=>a=>{const o=i6(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-ku(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};ROe(o)||Object.assign(u,AOe(e,u)),u.duration&&(u.duration=ku(u.duration)),u.repeatDelay&&(u.repeatDelay=ku(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Yd.instantAnimations||Yd.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=SOe(u.keyframes,o);if(h!==void 0){ni.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new KDe(u)},RQ=new Set(["width","height","top","left","right","bottom",...lb]);function YDe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function NQ(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&YDe(c,u))continue;const m={delay:n,...i6(i||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=tQ(e);if(x){const w=window.MotionHandoffAnimation(x,u,ni);w!==null&&(m.startTime=w,b=!0)}}Gj(e,u),d.start(g6(u,d,h,e.shouldReduceMotion&&RQ.has(u)?{type:!1}:m,e,b));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{ni.update(()=>{a&&xOe(e,a)})}),l}function s4(e,t,n={}){var l;const r=Bw(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(NQ(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return ZDe(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function ZDe(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(XDe).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(s4(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function XDe(e,t){return e.sortNodePosition(t)}function JDe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>s4(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=s4(e,t,n);else{const s=typeof t=="function"?Bw(e,t,n.custom):t;r=Promise.all(NQ(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function MQ(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const QDe=VD.length;function IQ(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?IQ(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<QDe;n++){const r=VD[n],s=e.props[r];(Dw(s)||s===!1)&&(t[r]=s)}return t}const e6e=[...qD].reverse(),t6e=qD.length;function n6e(e){return t=>Promise.all(t.map(({animation:n,options:r})=>JDe(e,n,r)))}function r6e(e){let t=n6e(e),n=L7(),r=!0;const s=l=>(c,u)=>{var h;const d=Bw(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=IQ(e.parent)||{},d=[],h=new Set;let m={},y=1/0;for(let v=0;v<t6e;v++){const x=e6e[v],w=n[x],S=c[x]!==void 0?c[x]:u[x],k=Dw(S),C=x===l?w.isActive:null;C===!1&&(y=v);let R=S===u[x]&&S!==c[x]&&k;if(R&&r&&e.manuallyAnimateOnMount&&(R=!1),w.protectedKeys={...m},!w.isActive&&C===null||!S&&!w.prevProp||wT(S)||typeof S=="boolean")continue;const A=s6e(w.prevProp,S);let N=A||x===l&&w.isActive&&!R&&k||v>y&&k,I=!1;const O=Array.isArray(S)?S:[S];let B=O.reduce(s(x),{});C===!1&&(B={});const{prevResolvedValues:D={}}=w,W={...D,...B},P=H=>{N=!0,h.has(H)&&(I=!0,h.delete(H)),w.needsAnimating[H]=!0;const L=e.getValue(H);L&&(L.liveStyle=!1)};for(const H in W){const L=B[H],ne=D[H];if(m.hasOwnProperty(H))continue;let V=!1;Hj(L)&&Hj(ne)?V=!MQ(L,ne):V=L!==ne,V?L!=null?P(H):h.add(H):L!==void 0&&h.has(H)?P(H):w.protectedKeys[H]=!0}w.prevProp=S,w.prevResolvedValues=B,w.isActive&&(m={...m,...B}),r&&e.blockInitialAnimation&&(N=!1),N&&(!(R&&A)||I)&&d.push(...O.map(H=>({animation:H,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=Bw(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),S=e.getValue(x);S&&(S.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=L7(),r=!0}}}function s6e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!MQ(t,e):!1}function Up(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function L7(){return{animate:Up(!0),whileInView:Up(),whileHover:Up(),whileTap:Up(),whileDrag:Up(),whileFocus:Up(),exit:Up()}}class Xh{constructor(t){this.isMounted=!1,this.node=t}update(){}}class i6e extends Xh{constructor(t){super(t),t.animationState||(t.animationState=r6e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();wT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let a6e=0;class o6e extends Xh{constructor(){super(...arguments),this.id=a6e++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const l6e={animation:{Feature:i6e},exit:{Feature:o6e}};function qw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const y6=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Z1(e){return{point:{x:e.pageX,y:e.pageY}}}const c6e=e=>t=>y6(t)&&e(t,Z1(t));function Tx(e,t,n,r){return qw(e,t,c6e(n),r)}function jQ({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function u6e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function d6e(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const PQ=1e-4,f6e=1-PQ,h6e=1+PQ,OQ=.01,p6e=0-OQ,m6e=0+OQ;function Ja(e){return e.max-e.min}function g6e(e,t,n){return Math.abs(e-t)<=n}function B7(e,t,n,r=.5){e.origin=r,e.originPoint=ei(t.min,t.max,e.origin),e.scale=Ja(n)/Ja(t),e.translate=ei(n.min,n.max,e.origin)-e.originPoint,(e.scale>=f6e&&e.scale<=h6e||isNaN(e.scale))&&(e.scale=1),(e.translate>=p6e&&e.translate<=m6e||isNaN(e.translate))&&(e.translate=0)}function Ax(e,t,n,r){B7(e.x,t.x,n.x,r?r.originX:void 0),B7(e.y,t.y,n.y,r?r.originY:void 0)}function $7(e,t,n){e.min=n.min+t.min,e.max=e.min+Ja(t)}function y6e(e,t,n){$7(e.x,t.x,n.x),$7(e.y,t.y,n.y)}function z7(e,t,n){e.min=t.min-n.min,e.max=e.min+Ja(t)}function Rx(e,t,n){z7(e.x,t.x,n.x),z7(e.y,t.y,n.y)}const U7=()=>({translate:0,scale:1,origin:0,originPoint:0}),_0=()=>({x:U7(),y:U7()}),q7=()=>({min:0,max:0}),mi=()=>({x:q7(),y:q7()});function Ol(e){return[e("x"),e("y")]}function MI(e){return e===void 0||e===1}function i4({scale:e,scaleX:t,scaleY:n}){return!MI(e)||!MI(t)||!MI(n)}function Wp(e){return i4(e)||DQ(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function DQ(e){return V7(e.x)||V7(e.y)}function V7(e){return e&&e!=="0%"}function yk(e,t,n){const r=e-n,s=t*r;return n+s}function W7(e,t,n,r,s){return s!==void 0&&(e=yk(e,s,r)),yk(e,n,r)+t}function a4(e,t=0,n=1,r,s){e.min=W7(e.min,t,n,r,s),e.max=W7(e.max,t,n,r,s)}function FQ(e,{x:t,y:n}){a4(e.x,t.translate,t.scale,t.originPoint),a4(e.y,n.translate,n.scale,n.originPoint)}const H7=.999999999999,G7=1.0000000000001;function b6e(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&C0(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,FQ(e,a)),r&&Wp(i.latestValues)&&C0(e,i.latestValues))}t.x<G7&&t.x>H7&&(t.x=1),t.y<G7&&t.y>H7&&(t.y=1)}function S0(e,t){e.min=e.min+t,e.max=e.max+t}function K7(e,t,n,r,s=.5){const i=ei(e.min,e.max,s);a4(e,t,n,i,r)}function C0(e,t){K7(e.x,t.x,t.scaleX,t.scale,t.originX),K7(e.y,t.y,t.scaleY,t.scale,t.originY)}function LQ(e,t){return jQ(d6e(e.getBoundingClientRect(),t))}function v6e(e,t,n){const r=LQ(e,n),{scroll:s}=t;return s&&(S0(r.x,s.offset.x),S0(r.y,s.offset.y)),r}const BQ=({current:e})=>e?e.ownerDocument.defaultView:null,Y7=(e,t)=>Math.abs(e-t);function x6e(e,t){const n=Y7(e.x,t.x),r=Y7(e.y,t.y);return Math.sqrt(n**2+r**2)}class $Q{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=jI(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=x6e(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:y}=d,{timestamp:b}=va;this.history.push({...y,timestamp:b});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=II(h,this.transformPagePoint),ni.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=jI(d.type==="pointercancel"?this.lastMoveEventInfo:II(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,v),y&&y(d,v)},!y6(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=Z1(t),o=II(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=va;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,jI(o,this.history)),this.removeListeners=K1(Tx(this.contextWindow,"pointermove",this.handlePointerMove),Tx(this.contextWindow,"pointerup",this.handlePointerUp),Tx(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Rh(this.updatePoint)}}function II(e,t){return t?{point:t(e.point)}:e}function Z7(e,t){return{x:e.x-t.x,y:e.y-t.y}}function jI({point:e},t){return{point:e,delta:Z7(e,zQ(t)),offset:Z7(e,w6e(t)),velocity:_6e(t,.1)}}function w6e(e){return e[0]}function zQ(e){return e[e.length-1]}function _6e(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=zQ(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>ku(t)));)n--;if(!r)return{x:0,y:0};const i=Eu(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function S6e(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?ei(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?ei(n,e,r.max):Math.min(e,n)),e}function X7(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function C6e(e,{top:t,left:n,bottom:r,right:s}){return{x:X7(e.x,n,s),y:X7(e.y,t,r)}}function J7(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function k6e(e,t){return{x:J7(e.x,t.x),y:J7(e.y,t.y)}}function E6e(e,t){let n=.5;const r=Ja(e),s=Ja(t);return s>r?n=Uw(t.min,t.max-r,e.min):r>s&&(n=Uw(e.min,e.max-s,t.min)),Zd(0,1,n)}function T6e(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const o4=.35;function A6e(e=o4){return e===!1?e=0:e===!0&&(e=o4),{x:Q7(e,"left","right"),y:Q7(e,"top","bottom")}}function Q7(e,t,n){return{min:eU(e,t),max:eU(e,n)}}function eU(e,t){return typeof e=="number"?e:e[t]||0}const uc={x:!1,y:!1};function UQ(){return uc.x||uc.y}function R6e(e){return e==="x"||e==="y"?uc[e]?null:(uc[e]=!0,()=>{uc[e]=!1}):uc.x||uc.y?null:(uc.x=uc.y=!0,()=>{uc.x=uc.y=!1})}const N6e=new WeakMap;class M6e{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=mi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Z1(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:m,onDragStart:y}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=R6e(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ol(v=>{let x=this.getAxisMotionValue(v).get()||0;if(Cu.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[v];S&&(x=Ja(S)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&ni.postRender(()=>y(u,d)),Gj(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(m&&this.currentDirection===null){this.currentDirection=I6e(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>Ol(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new $Q(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:BQ(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ni.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!XS(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=S6e(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&x0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=C6e(r.layoutBox,t):this.constraints=!1,this.elastic=A6e(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ol(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=T6e(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!x0(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=v6e(r,s.root,this.visualElement.getTransformPagePoint());let a=k6e(s.layout.layoutBox,i);if(n){const o=n(u6e(a));this.hasMutatedConstraints=!!o,o&&(a=jQ(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ol(u=>{if(!XS(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return Gj(this.visualElement,t),r.start(g6(t,r,0,n,this.visualElement,!1))}stopAnimation(){Ol(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ol(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ol(n=>{const{drag:r}=this.getProps();if(!XS(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-ei(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!x0(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ol(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=E6e({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ol(a=>{if(!XS(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(ei(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;N6e.set(this.visualElement,this);const t=this.visualElement.current,n=Tx(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();x0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ni.read(r);const a=qw(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ol(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=o4,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function XS(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function I6e(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class j6e extends Xh{constructor(t){super(t),this.removeGroupControls=ql,this.removeListeners=ql,this.controls=new M6e(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ql}unmount(){this.removeGroupControls(),this.removeListeners()}}const tU=e=>(t,n)=>{e&&ni.postRender(()=>e(t,n))};class P6e extends Xh{constructor(){super(...arguments),this.removePointerDownListener=ql}onPointerDown(t){this.session=new $Q(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:BQ(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:tU(t),onStart:tU(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ni.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Tx(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const D2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function nU(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Lv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ar.test(e))e=parseFloat(e);else return e;const n=nU(e,t.target.x),r=nU(e,t.target.y);return`${n}% ${r}%`}},O6e={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Nh.parse(e);if(s.length>5)return r;const i=Nh.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=ei(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class D6e extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;KPe(F6e),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),D2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ni.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),HD.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function qQ(e){const[t,n]=FJ(),r=E.useContext(BD);return f.jsx(D6e,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(qJ),isPresent:t,safeToRemove:n})}const F6e={borderRadius:{...Lv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Lv,borderTopRightRadius:Lv,borderBottomLeftRadius:Lv,borderBottomRightRadius:Lv,boxShadow:O6e};function L6e(e,t,n){const r=Da(e)?e:$w(e);return r.start(g6("",r,t,n)),r.animation}function B6e(e){return e instanceof SVGElement&&e.tagName!=="svg"}const $6e=(e,t)=>e.depth-t.depth;class z6e{constructor(){this.children=[],this.isDirty=!1}add(t){n6(this.children,t),this.isDirty=!0}remove(t){r6(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort($6e),this.isDirty=!1,this.children.forEach(t)}}function U6e(e,t){const n=ko.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(Rh(r),e(i-t))};return ni.setup(r,!0),()=>Rh(r)}const VQ=["TopLeft","TopRight","BottomLeft","BottomRight"],q6e=VQ.length,rU=e=>typeof e=="string"?parseFloat(e):e,sU=e=>typeof e=="number"||ar.test(e);function V6e(e,t,n,r,s,i){s?(e.opacity=ei(0,n.opacity??1,W6e(r)),e.opacityExit=ei(t.opacity??1,0,H6e(r))):i&&(e.opacity=ei(t.opacity??1,n.opacity??1,r));for(let a=0;a<q6e;a++){const o=`border${VQ[a]}Radius`;let l=iU(t,o),c=iU(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||sU(l)===sU(c)?(e[o]=Math.max(ei(rU(l),rU(c),r),0),(Cu.test(c)||Cu.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=ei(t.rotate||0,n.rotate||0,r))}function iU(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const W6e=WQ(0,.5,bQ),H6e=WQ(.5,.95,ql);function WQ(e,t,n){return r=>r<e?0:r>t?1:n(Uw(e,t,r))}function aU(e,t){e.min=t.min,e.max=t.max}function Ml(e,t){aU(e.x,t.x),aU(e.y,t.y)}function oU(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function lU(e,t,n,r,s){return e-=t,e=yk(e,1/n,r),s!==void 0&&(e=yk(e,1/s,r)),e}function G6e(e,t=0,n=1,r=.5,s,i=e,a=e){if(Cu.test(t)&&(t=parseFloat(t),t=ei(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=ei(i.min,i.max,r);e===i&&(o-=t),e.min=lU(e.min,t,n,o,s),e.max=lU(e.max,t,n,o,s)}function cU(e,t,[n,r,s],i,a){G6e(e,t[n],t[r],t[s],t.scale,i,a)}const K6e=["x","scaleX","originX"],Y6e=["y","scaleY","originY"];function uU(e,t,n,r){cU(e.x,t,K6e,n?n.x:void 0,r?r.x:void 0),cU(e.y,t,Y6e,n?n.y:void 0,r?r.y:void 0)}function dU(e){return e.translate===0&&e.scale===1}function HQ(e){return dU(e.x)&&dU(e.y)}function fU(e,t){return e.min===t.min&&e.max===t.max}function Z6e(e,t){return fU(e.x,t.x)&&fU(e.y,t.y)}function hU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function GQ(e,t){return hU(e.x,t.x)&&hU(e.y,t.y)}function pU(e){return Ja(e.x)/Ja(e.y)}function mU(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class X6e{constructor(){this.members=[]}add(t){n6(this.members,t),t.scheduleRender()}remove(t){if(r6(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function J6e(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:m,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),m&&(r+=`skewX(${m}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const PI=["","X","Y","Z"],Q6e={visibility:"hidden"},gU=1e3;let e5e=0;function OI(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function KQ(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=tQ(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ni,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&KQ(r)}function YQ({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=e5e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(r5e),this.nodes.forEach(l5e),this.nodes.forEach(c5e),this.nodes.forEach(s5e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new z6e)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new s6),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=B6e(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=U6e(d,250),D2.hasAnimatedSinceResize&&(D2.hasAnimatedSinceResize=!1,this.nodes.forEach(bU))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||p5e,{onLayoutAnimationStart:b,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!GQ(this.targetLayout,m),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const S={...i6(y,"layout"),onPlay:b,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||bU(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Rh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(u5e),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&KQ(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(yU);return}this.isUpdating||this.nodes.forEach(a5e),this.isUpdating=!1,this.nodes.forEach(o5e),this.nodes.forEach(t5e),this.nodes.forEach(n5e),this.clearAllSnapshots();const o=ko.now();va.delta=Zd(0,1e3/60,o-va.timestamp),va.timestamp=o,va.isProcessing=!0,TI.update.process(va),TI.preRender.process(va),TI.render.process(va),va.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,HD.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(i5e),this.sharedNodes.forEach(d5e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ni.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ni.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ja(this.snapshot.measuredBox.x)&&!Ja(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=mi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!HQ(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||Wp(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),m5e(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return mi();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(g5e))){const{scroll:u}=this.root;u&&(S0(o.x,u.offset.x),S0(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=mi();if(Ml(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Ml(o,a),S0(o.x,d.offset.x),S0(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=mi();Ml(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&C0(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Wp(u.latestValues)&&C0(l,u.latestValues)}return Wp(this.latestValues)&&C0(l,this.latestValues),l}removeTransform(a){const o=mi();Ml(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Wp(c.latestValues))continue;i4(c.latestValues)&&c.updateSnapshot();const u=mi(),d=c.measurePageBox();Ml(u,d),uU(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Wp(this.latestValues)&&uU(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==va.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=va.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=mi(),this.relativeTargetOrigin=mi(),Rx(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Ml(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=mi(),this.targetWithTransforms=mi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),y6e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ml(this.target,this.layout.layoutBox),FQ(this.target,this.targetDelta)):Ml(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=mi(),this.relativeTargetOrigin=mi(),Rx(this.relativeTargetOrigin,this.target,m.target),Ml(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||i4(this.parent.latestValues)||DQ(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===va.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Ml(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;b6e(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=mi());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(oU(this.prevProjectionDelta.x,this.projectionDelta.x),oU(this.prevProjectionDelta.y,this.projectionDelta.y)),Ax(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!mU(this.projectionDelta.x,this.prevProjectionDelta.x)||!mU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_0(),this.projectionDelta=_0(),this.projectionDeltaWithTransform=_0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=_0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=mi(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=m!==y,v=this.getStack(),x=!v||v.members.length<=1,w=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(h5e));this.animationProgress=0;let S;this.mixTargetDelta=k=>{const C=k/1e3;vU(d.x,a.x,C),vU(d.y,a.y,C),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Rx(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),f5e(this.relativeTarget,this.relativeTargetOrigin,h,C),S&&Z6e(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=mi()),Ml(S,this.relativeTarget)),b&&(this.animationValues=u,V6e(u,c,this.latestValues,C,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Rh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ni.update(()=>{D2.hasAnimatedSinceResize=!0,this.currentAnimation=L6e(0,gU,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(gU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&ZQ(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||mi();const d=Ja(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=Ja(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Ml(o,l),C0(o,u),Ax(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new X6e),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&OI("z",a,c,this.animationValues);for(let u=0;u<PI.length;u++)OI(`rotate${PI[u]}`,a,c,this.animationValues),OI(`skew${PI[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return Q6e;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=P2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=P2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Wp(this.latestValues)&&(m.transform=l?l({},""):"none",this.hasProjected=!1),m}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=J6e(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in Fw){if(u[m]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:v}=Fw[m],x=o.transform==="none"?u[m]:y(u[m],c);if(b){const w=b.length;for(let S=0;S<w;S++)o[b[S]]=x}else v?this.options.visualElement.renderState.vars[m]=x:o[m]=x}return this.options.layoutId&&(o.pointerEvents=c===this?P2(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(yU),this.root.sharedNodes.clear()}}}function t5e(e){e.updateLayout()}function n5e(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Ol(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=Ja(h);h.min=r[d].min,h.max=h.min+m}):ZQ(i,t.layoutBox,r)&&Ol(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=Ja(r[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const o=_0();Ax(o,r,t.layoutBox);const l=_0();a?Ax(l,e.applyTransform(s,!0),t.measuredBox):Ax(l,r,t.layoutBox);const c=!HQ(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const y=mi();Rx(y,t.layoutBox,h.layoutBox);const b=mi();Rx(b,r,m.layoutBox),GQ(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function r5e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function s5e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function i5e(e){e.clearSnapshot()}function yU(e){e.clearMeasurements()}function a5e(e){e.isLayoutDirty=!1}function o5e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function bU(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function l5e(e){e.resolveTargetDelta()}function c5e(e){e.calcProjection()}function u5e(e){e.resetSkewAndRotation()}function d5e(e){e.removeLeadSnapshot()}function vU(e,t,n){e.translate=ei(t.translate,0,n),e.scale=ei(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function xU(e,t,n,r){e.min=ei(t.min,n.min,r),e.max=ei(t.max,n.max,r)}function f5e(e,t,n,r){xU(e.x,t.x,n.x,r),xU(e.y,t.y,n.y,r)}function h5e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const p5e={duration:.45,ease:[.4,0,.1,1]},wU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),_U=wU("applewebkit/")&&!wU("chrome/")?Math.round:ql;function SU(e){e.min=_U(e.min),e.max=_U(e.max)}function m5e(e){SU(e.x),SU(e.y)}function ZQ(e,t,n){return e==="position"||e==="preserve-aspect"&&!g6e(pU(t),pU(n),.2)}function g5e(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const y5e=YQ({attachResizeListener:(e,t)=>qw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),DI={current:void 0},XQ=YQ({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!DI.current){const e=new y5e({});e.mount(window),e.setOptions({layoutScroll:!0}),DI.current=e}return DI.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),b5e={pan:{Feature:P6e},drag:{Feature:j6e,ProjectionNode:XQ,MeasureLayout:qQ}};function v5e(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function JQ(e,t){const n=v5e(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function CU(e){return!(e.pointerType==="touch"||UQ())}function x5e(e,t,n={}){const[r,s,i]=JQ(e,n),a=o=>{if(!CU(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{CU(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function kU(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ni.postRender(()=>i(t,Z1(t)))}class w5e extends Xh{mount(){const{current:t}=this.node;t&&(this.unmount=x5e(t,(n,r)=>(kU(this.node,r,"Start"),s=>kU(this.node,s,"End"))))}unmount(){}}class _5e extends Xh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=K1(qw(this.node.current,"focus",()=>this.onFocus()),qw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const QQ=(e,t)=>t?e===t?!0:QQ(e,t.parentElement):!1,S5e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function C5e(e){return S5e.has(e.tagName)||e.tabIndex!==-1}const nx=new WeakSet;function EU(e){return t=>{t.key==="Enter"&&e(t)}}function FI(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const k5e=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=EU(()=>{if(nx.has(n))return;FI(n,"down");const s=EU(()=>{FI(n,"up")}),i=()=>FI(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function TU(e){return y6(e)&&!UQ()}function E5e(e,t,n={}){const[r,s,i]=JQ(e,n),a=o=>{const l=o.currentTarget;if(!TU(o)||nx.has(l))return;nx.add(l);const c=t(l,o),u=(m,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!TU(m)||!nx.has(l))&&(nx.delete(l),typeof c=="function"&&c(m,{success:y}))},d=m=>{u(m,l===window||l===document||n.useGlobalTarget||QQ(l,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>k5e(c,s)),!C5e(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function AU(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ni.postRender(()=>i(t,Z1(t)))}class T5e extends Xh{mount(){const{current:t}=this.node;t&&(this.unmount=E5e(t,(n,r)=>(AU(this.node,r,"Start"),(s,{success:i})=>AU(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const l4=new WeakMap,LI=new WeakMap,A5e=e=>{const t=l4.get(e.target);t&&t(e)},R5e=e=>{e.forEach(A5e)};function N5e({root:e,...t}){const n=e||document;LI.has(n)||LI.set(n,{});const r=LI.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(R5e,{root:e,...t})),r[s]}function M5e(e,t,n){const r=N5e(t);return l4.set(e,n),r.observe(e),()=>{l4.delete(e),r.unobserve(e)}}const I5e={some:0,all:1};class j5e extends Xh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:I5e[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return M5e(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(P5e(t,n))&&this.startObserver()}unmount(){}}function P5e({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const O5e={inView:{Feature:j5e},tap:{Feature:T5e},focus:{Feature:_5e},hover:{Feature:w5e}},D5e={layout:{ProjectionNode:XQ,MeasureLayout:qQ}},c4={current:null},eee={current:!1};function F5e(){if(eee.current=!0,!!zD)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>c4.current=e.matches;e.addListener(t),t()}else c4.current=!1}const L5e=new WeakMap;function B5e(e,t,n){for(const r in t){const s=t[r],i=n[r];if(Da(s))e.addValue(r,s);else if(Da(i))e.addValue(r,$w(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,$w(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const tee=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),nee=e=>/^0[^.\s]+$/u.test(e),$5e={test:e=>e==="auto",parse:e=>e},ree=e=>t=>t.test(e),see=[ub,ar,Cu,Jf,ZPe,YPe,$5e],RU=e=>see.find(ree(e)),z5e=[...see,Ia,Nh],U5e=e=>z5e.find(ree(e)),q5e=new Set(["brightness","contrast","saturate","opacity"]);function V5e(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(a6)||[];if(!r)return e;const s=n.replace(r,"");let i=q5e.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const W5e=/\b([a-z-]*)\(.*?\)/gu,u4={...Nh,getAnimatableNone:e=>{const t=e.match(W5e);return t?t.map(V5e).join(" "):e}},H5e={...ZD,color:Ia,backgroundColor:Ia,outlineColor:Ia,fill:Ia,stroke:Ia,borderColor:Ia,borderTopColor:Ia,borderRightColor:Ia,borderBottomColor:Ia,borderLeftColor:Ia,filter:u4,WebkitFilter:u4},iee=e=>H5e[e];function aee(e,t){let n=iee(e);return n!==u4&&(n=Nh),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const NU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class G5e{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=p6,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=ko.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,ni.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=_T(n),this.isVariantNode=zJ(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const m=d[h];l[h]!==void 0&&Da(m)&&m.set(l[h],!1)}}mount(t){this.current=t,L5e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),eee.current||F5e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:c4.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Rh(this.notifyUpdate),Rh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=cb.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ni.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in wy){const n=wy[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):mi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<NU.length;r++){const s=NU[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=B5e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=$w(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(tee(r)||nee(r))?r=parseFloat(r):!U5e(r)&&Nh.test(n)&&(r=aee(t,n)),this.setBaseTarget(t,Da(r)?r.get():r)),Da(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=e6(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Da(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new s6),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const K5e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Y5e(e){const t=K5e.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function oee(e,t,n=1){const[r,s]=Y5e(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return tee(a)?parseFloat(a):a}return YD(s)?oee(s,t,n+1):s}function Z5e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||nee(e):!0}const X5e=new Set(["auto","none","0"]);function J5e(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!X5e.has(i)&&zw(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=aee(n,s)}class Q5e extends p6{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),YD(c))){const u=oee(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!RQ.has(r)||t.length!==2)return;const[s,i]=t,a=RU(s),o=RU(i);if(a!==o)if(P7(a)&&P7(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else hm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||Z5e(t[s]))&&r.push(s);r.length&&J5e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=hm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=hm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class lee extends G5e{constructor(){super(...arguments),this.KeyframeResolver=Q5e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Da(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function cee(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function eFe(e){return window.getComputedStyle(e)}class tFe extends lee{constructor(){super(...arguments),this.type="html",this.renderInstance=cee}readValueFromInstance(t,n){if(cb.has(n))return kDe(t,n);{const r=eFe(t),s=(KD(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return LQ(t,n)}build(t,n,r){XD(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return t6(t,n,r)}}const uee=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function nFe(e,t,n,r){cee(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(uee.has(s)?s:WD(s),t.attrs[s])}class rFe extends lee{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=mi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(cb.has(n)){const r=iee(n);return r&&r.default||0}return n=uee.has(n)?n:WD(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return QJ(t,n,r)}build(t,n,r){YJ(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){nFe(t,n,r,s)}mount(t){this.isSVGTag=XJ(t.tagName),super.mount(t)}}const sFe=(e,t)=>QD(e)?new rFe(t):new tFe(t,{allowProjection:e!==E.Fragment}),iFe=pOe({...l6e,...O5e,...b5e,...D5e},sFe),fu=PPe(iFe),I0=new WeakMap,F2=new WeakMap,bk={current:[]};let BI=!1,Nx=0;const rx=new Set,JS=new Map;function dee(e){const t=Array.from(e).sort((n,r)=>n instanceof Bd&&n.options.deps.includes(r)?1:r instanceof Bd&&r.options.deps.includes(n)?-1:0);for(const n of t){if(bk.current.includes(n))continue;bk.current.push(n),n.recompute();const r=F2.get(n);if(r)for(const s of r){const i=I0.get(s);i&&dee(i)}}}function aFe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function oFe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function fee(e){if(Nx>0&&!JS.has(e)&&JS.set(e,e.prevState),rx.add(e),!(Nx>0)&&!BI)try{for(BI=!0;rx.size>0;){const t=Array.from(rx);rx.clear();for(const n of t){const r=JS.get(n)??n.prevState;n.prevState=r,aFe(n)}for(const n of t){const r=I0.get(n);r&&(bk.current.push(n),dee(r))}for(const n of t){const r=I0.get(n);if(r)for(const s of r)oFe(s)}}}finally{BI=!1,bk.current=[],JS.clear()}}function su(e){Nx++;try{e()}finally{if(Nx--,Nx===0){const t=Array.from(rx)[0];t&&fee(t)}}}function lFe(e){return typeof e=="function"}class d4{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):lFe(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),fee(this)}}class Bd{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof Bd&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof Bd)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof d4){let r=I0.get(n);r||(r=new Set,I0.set(n,r)),r.add(this);let s=F2.get(this);s||(s=new Set,F2.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof Bd)this.unregisterFromGraph(n.options.deps);else if(n instanceof d4){const r=I0.get(n);r&&r.delete(this);const s=F2.get(this);s&&s.delete(n)}}}function ST(e,t){return typeof e=="function"?e(t):e}function sx(e,t){return b6(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function QS(e,t,n){const r=b6(t);function s(i){if(!r.length)return ST(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function cFe(e,t){const n=b6(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const uFe=/^(\d+)$/gm,dFe=/\.(\d+)(?=\.)/gm,fFe=/^(\d+)\./gm,hFe=/\.(\d+$)/gm,pFe=/\.{2,}/gm,f4="__int__",e2=`${f4}$1`;function b6(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(uFe,e2).replace(dFe,`.${e2}.`).replace(fFe,`${e2}.`).replace(hFe,`.${e2}`).replace(pFe,".").split(".").map(t=>t.indexOf(f4)===0?parseInt(t.substring(f4.length),10):t)}function mFe(e){return!(Array.isArray(e)&&e.length===0)}function h4(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=m=>({...m,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function p4(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const m4=e=>!!e&&typeof e=="object"&&"fields"in e;function c0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!c0(e[s],t[s]))return!1;return!0}const MU=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},IU=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function gFe(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const jU=e=>{const t=gFe(e);return{form:t,fields:t}},j0={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:jU(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:jU(r.issues)}},hee=e=>!!e&&"~standard"in e,vk={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function t2(e){function t(d,h,m,y){const b=r(d,h,m,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[m]()}function n(d,h){return`${d}[${h}]`}function r(d,h,m,y){const b=[n(d,h)];if(m==="swap")b.push(n(d,y));else if(m==="move"){const[v,x]=[Math.min(h,y),Math.max(h,y)];for(let w=v;w<=x;w++)b.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)b.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>b.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(m,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=s(y.toString(),h),v=e.getFieldMeta(b);v?e.setFieldMeta(y,v):e.setFieldMeta(y,a())})}const a=()=>vk,o=(d,h,m)=>{i(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,m))&&e.setFieldMeta(y,a())})},l=d=>{i(d,"up")},c=(d,h,m,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,m))).map(v=>[v,e.getFieldMeta(v)]));i(d,m<y?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,y))).forEach(v=>{const x=v.replace(n(h,y),n(h,m)),w=b.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,m,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,m)))return;const v=b.toString().replace(n(h,m),n(h,y)),[x,w]=[e.getFieldMeta(b),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(b,w)})};return{handleArrayFieldMetaShift:t}}function $I(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class yFe{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!c0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!c0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||su(()=>{this.baseStore.setState(()=>$I(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return $I({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return su(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(m=>h.startsWith(m))),u=[];return su(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=p4(r,this.options);let i=!1;const a={};return su(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:m}=L2(d),y=n2(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(b);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,S=m==null?void 0:m[b],{newErrorValue:k,newSource:C}=MU({newFormValidatorError:S,isPreviousErrorFromFormValidator:(w==null?void 0:w[y])==="form",previousErrorValue:x==null?void 0:x[y]});C==="form"&&(a[b]={...a[b],[y]:S}),(x==null?void 0:x[y])!==k&&this.setFieldMeta(b,R=>({...R,errorMap:{...R.errorMap,[y]:k},errorSourceMap:{...R.errorSourceMap,[y]:C}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||m)&&(i=!0)}const c=n2("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=h4(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=n2(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async m=>{let y;try{y=await new Promise((w,S)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(k){S(k)}},c.debounceMs)})}catch(w){y=w}const{formError:b,fieldErrors:v}=L2(y);v&&(a=a?{...a,...v}:v);const x=n2(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(w);if(!S)continue;const{errorMap:k,errorSourceMap:C}=S,R=a==null?void 0:a[w],{newErrorValue:A,newSource:N}=MU({newFormValidatorError:R,isPreviousErrorFromFormValidator:(C==null?void 0:C[x])==="form",previousErrorValue:k==null?void 0:k[x]});(k==null?void 0:k[x])!==A&&this.setFieldMeta(w,I=>({...I,errorMap:{...I.errorMap,[x]:A},errorSourceMap:{...I.errorSourceMap,[x]:N}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:b}})),m(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>sx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:ST(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=vk,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;su(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:QS(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=cFe(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),t2(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),t2(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return QS(QS(o,`${s}`,c),`${i}`,l)},a),t2(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),t2(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:vk},values:this.options.defaultValues?QS(s.values,r,sx(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>j0.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>j0.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new d4($I({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new Bd({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const m={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],v=u==null?void 0:u.fieldMetaBase[y],x=c==null?void 0:c[y],w=sx(d.values,y);let S=x==null?void 0:x.errors;if(!v||b.errorMap!==v.errorMap){S=Object.values(b.errorMap??{}).filter(N=>N!==void 0);const A=(a=this.getFieldInfo(y))==null?void 0:a.instance;A&&!A.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const k=!mFe(S??[]),C=!b.isDirty,R=c0(w,sx(this.options.defaultValues,y))||c0(w,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===C&&x.isValid===k&&x.isDefaultValue===R&&x.errors===S&&b===v){m[y]=x,h++;continue}m[y]={...b,errors:S,isPristine:C,isValid:k,isDefaultValue:R}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:m}}),this.store=new Bd({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],m=s[1],y=Object.values(m).filter(Boolean),b=y.some(L=>L.isValidating),v=y.every(L=>L.isValid),x=y.some(L=>L.isTouched),w=y.some(L=>L.isBlurred),S=y.every(L=>L.isDefaultValue),k=x&&((a=h.errorMap)==null?void 0:a.onMount),C=y.some(L=>L.isDirty),R=!C,A=!!((o=h.errorMap)!=null&&o.onMount||y.some(L=>{var ne;return(ne=L==null?void 0:L.errorMap)==null?void 0:ne.onMount})),N=!!b;let I=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(I=Object.values(h.errorMap).reduce((L,ne)=>ne===void 0?L:ne&&m4(ne)?(L.push(ne.form),L):(L.push(ne),L),[]));const O=I.length===0,B=v&&O,D=this.options.canSubmitWhenInvalid??!1,W=h.submissionAttempts===0&&!x&&!A||!N&&!h.isSubmitting&&B||D;let P=h.errorMap;if(k&&(I=I.filter(L=>L!==h.errorMap.onMount),P=Object.assign(P,{onMount:void 0})),u&&d&&u.errorMap===P&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===I&&u.isFieldsValidating===b&&u.isFieldsValid===v&&u.isFormValid===O&&u.isValid===B&&u.canSubmit===W&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===R&&u.isDefaultValue===S&&u.isDirty===C&&c0(d,h))return u;let Z={...h,errorMap:P,fieldMeta:this.fieldMetaDerived.state,errors:I,isFieldsValidating:b,isFieldsValid:v,isFormValid:O,isValid:B,canSubmit:W,isTouched:x,isBlurred:w,isPristine:R,isDefaultValue:S,isDirty:C};const U=((l=this.options.transform)==null?void 0:l.deps)??[];if(U.length!==this.prevTransformArray.length||U.some((L,ne)=>L!==this.prevTransformArray[ne])){const L=Object.assign({},this,{state:Z});(c=this.options.transform)==null||c.fn(L),Z=L.state,this.prevTransformArray=U}return Z}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return hee(t.validate)?j0[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),su(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}su(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,m,y;(y=(m=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:m.onSubmit)==null||y.call(m,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),su(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){su(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(m4(r)){const{formError:i,fieldErrors:a}=L2(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function L2(e){if(e){if(m4(e)){const t=L2(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function n2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class bFe{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=sx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=p4(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=p4(n,d.options);return h.forEach(m=>{m.field=d}),u.concat(h)},[]);let l=!1;su(()=>{const u=(d,h)=>{var m;const y=r2(h.cause),b=h.validate?PU(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[y],{newErrorValue:x,newSource:w}=IU({formLevelError:v,fieldLevelError:b});((m=d.state.meta.errorMap)==null?void 0:m[y])!==x&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[y]:x},errorSourceMap:{...S.errorSourceMap,[y]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=r2("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=h4(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,m)=>{const y=h4(n,m.options);return y.forEach(b=>{b.field=m}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(m=>({...m,isValidating:!0}));const l=[],c=[],u=(h,m,y)=>{const b=r2(m.cause),v=h.getInfo().validationMetaMap[b];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},y.push(new Promise(async w=>{var S;let k;try{k=await new Promise((I,O)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(x.signal.aborted)return I(void 0);try{I(await this.runValidator({validate:m.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(B){O(B)}},m.debounceMs)})}catch(I){k=I}if(x.signal.aborted)return w(void 0);const C=PU(k),R=(S=i[this.name])==null?void 0:S[b],{newErrorValue:A,newSource:N}=IU({formLevelError:R,fieldLevelError:C});h.setMeta(I=>({...I,errorMap:{...I==null?void 0:I.errorMap,[b]:A},errorSourceMap:{...I.errorSourceMap,[b]:N}})),w(A)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[r2(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>j0.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>j0.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new Bd({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...vk,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return hee(t.validate)?j0[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function PU(e){if(e)return e}function r2(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var zI={exports:{}},UI={},qI={exports:{}},VI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OU;function vFe(){if(OU)return VI;OU=1;var e=d1();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var m=h(),y=r({inst:{value:m,getSnapshot:h}}),b=y[0].inst,v=y[1];return i(function(){b.value=m,b.getSnapshot=h,l(b)&&v({inst:b})},[d,m,h]),s(function(){return l(b)&&v({inst:b}),d(function(){l(b)&&v({inst:b})})},[d]),a(m),m}function l(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return VI.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,VI}var DU;function xFe(){return DU||(DU=1,qI.exports=vFe()),qI.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FU;function wFe(){if(FU)return UI;FU=1;var e=d1(),t=xFe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return UI.useSyncExternalStoreWithSelector=function(c,u,d,h,m){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function x(R){if(!w){if(w=!0,S=R,R=h(R),m!==void 0&&b.hasValue){var A=b.value;if(m(A,R))return k=A}return k=R}if(A=k,r(S,R))return A;var N=h(R);return m!==void 0&&m(A,N)?(S=R,A):(S=R,k=N)}var w=!1,S,k,C=d===void 0?null:d;return[function(){return x(u())},C===null?void 0:function(){return x(C())}]},[u,d,h,m]);var v=s(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},UI}var LU;function _Fe(){return LU||(LU=1,zI.exports=wFe()),zI.exports}var SFe=_Fe();function v6(e,t=n=>n){return SFe.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,CFe)}function CFe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const xk=typeof window<"u"?E.useLayoutEffect:E.useEffect;function kFe(e){const[t]=E.useState(()=>{const r=new bFe({...e,form:e.form,name:e.name});return r.Field=pee,r});return xk(t.mount,[t]),xk(()=>{t.update(e)}),v6(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const pee=({children:e,...t})=>{const n=kFe(t),r=E.useMemo(()=>ST(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function EFe({form:e,selector:t,children:n}){const r=v6(e.store,t);return ST(n,r)}function si(e){const[t]=E.useState(()=>{const n=new yFe(e),r=n;return r.Field=function(i){return f.jsx(pee,{...i,form:n})},r.Subscribe=s=>f.jsx(EFe,{form:n,selector:s.selector,children:s.children}),r});return xk(t.mount,[]),v6(t.store,n=>n.isSubmitting),xk(()=>{t.update(e)}),t}function Sn({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Je("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function TFe(e){const t=e+"CollectionProvider",[n,r]=Gi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),S=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=Au(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),k=Nn(v,S.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=Au(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,k=Ve.useRef(null),C=Nn(v,k),R=i(u,x);return Ve.useEffect(()=>(R.itemMap.set(k,{ref:k,...S}),()=>void R.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((R,A)=>S.indexOf(R.ref.current)-S.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var AFe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],wi=AFe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function RFe(e,t){e&&il.flushSync(()=>e.dispatchEvent(t))}var NFe="DismissableLayer",g4="dismissableLayer.update",MFe="dismissableLayer.pointerDownOutside",IFe="dismissableLayer.focusOutside",BU,mee=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),gee=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(mee),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Nn(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=OFe(A=>{const N=A.target,I=[...c.branches].some(O=>O.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),R=DFe(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return tO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(BU=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),$U(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=BU)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),$U())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(g4,A),()=>document.removeEventListener(g4,A)},[]),f.jsx(wi.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,R.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});gee.displayName=NFe;var jFe="DismissableLayerBranch",PFe=E.forwardRef((e,t)=>{const n=E.useContext(mee),r=E.useRef(null),s=Nn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(wi.div,{...e,ref:s})});PFe.displayName=jFe;function OFe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){yee(MFe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function DFe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&yee(IFe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function $U(){const e=new CustomEvent(g4);document.dispatchEvent(e)}function yee(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?RFe(s,i):s.dispatchEvent(i)}var WI=0;function CT(){E.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??zU()),document.body.insertAdjacentElement("beforeend",e[1]??zU()),WI++,()=>{WI===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),WI--}},[])}function zU(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var HI="focusScope.autoFocusOnMount",GI="focusScope.autoFocusOnUnmount",UU={bubbles:!1,cancelable:!0},FFe="FocusScope",bee=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=Nn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:Qf(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||Qf(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&Qf(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){VU.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(HI,UU);o.addEventListener(HI,c),o.dispatchEvent(x),x.defaultPrevented||(LFe(qFe(vee(o)),{select:!0}),document.activeElement===b&&Qf(o))}return()=>{o.removeEventListener(HI,c),setTimeout(()=>{const x=new CustomEvent(GI,UU);o.addEventListener(GI,u),o.dispatchEvent(x),x.defaultPrevented||Qf(b??document.body,{select:!0}),o.removeEventListener(GI,u),VU.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=BFe(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&Qf(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&Qf(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(wi.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});bee.displayName=FFe;function LFe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(Qf(r,{select:t}),document.activeElement!==n)return}function BFe(e){const t=vee(e),n=qU(t,e),r=qU(t.reverse(),e);return[n,r]}function vee(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function qU(e,t){for(const n of e)if(!$Fe(n,{upTo:t}))return n}function $Fe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function zFe(e){return e instanceof HTMLInputElement&&"select"in e}function Qf(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&zFe(e)&&t&&e.select()}}var VU=UFe();function UFe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=WU(e,t),e.unshift(t)},remove(t){var n;e=WU(e,t),(n=e[0])==null||n.resume()}}}function WU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function qFe(e){return e.filter(t=>t.tagName!=="A")}var VFe="Arrow",xee=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(wi.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});xee.displayName=VFe;var WFe=xee,x6="Popper",[wee,_ee]=Gi(x6),[HFe,See]=wee(x6),Cee=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(HFe,{scope:t,anchor:r,onAnchorChange:s,children:n})};Cee.displayName=x6;var kee="PopperAnchor",Eee=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=See(kee,n),a=E.useRef(null),o=Nn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(wi.div,{...s,ref:o})});Eee.displayName=kee;var w6="PopperContent",[GFe,KFe]=wee(w6),Tee=E.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=See(w6,n),[x,w]=E.useState(null),S=Nn(t,Ne=>w(Ne)),[k,C]=E.useState(null),R=Vy(k),A=(R==null?void 0:R.width)??0,N=(R==null?void 0:R.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,W={padding:O,boundary:B.filter(ZFe),altBoundary:D},{refs:P,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:L}=uO({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>cO(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[dO({mainAxis:s+N,alignmentAxis:a}),l&&fO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?hO():void 0,...W}),l&&pO({...W}),mO({...W,apply:({elements:Ne,rects:K,availableWidth:ge,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${ge}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&yO({element:k,padding:o}),XFe({arrowWidth:A,arrowHeight:N}),h&&gO({strategy:"referenceHidden",...W})]}),[ne,V]=Nee(U),Q=Es(y);ri(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=L.arrow)==null?void 0:De.x,se=(Se=L.arrow)==null?void 0:Se.y,me=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,je]=E.useState();return ri(()=>{x&&je(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(GFe,{scope:n,placedSide:ne,onArrowChange:C,arrowX:ee,arrowY:se,shouldHideArrow:me,children:f.jsx(wi.div,{"data-side":ne,"data-align":V,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});Tee.displayName=w6;var Aee="PopperArrow",YFe={top:"bottom",right:"left",bottom:"top",left:"right"},Ree=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=KFe(Aee,r),a=YFe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(WFe,{...s,ref:n,style:{...s.style,display:"block"}})})});Ree.displayName=Aee;function ZFe(e){return e!==null}var XFe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Nee(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Nee(e){const[t,n="center"]=e.split("-");return[t,n]}var JFe=Cee,QFe=Eee,e8e=Tee,t8e=Ree,n8e="Portal",Mee=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);ri(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?xE.createPortal(f.jsx(wi.div,{...r,ref:t}),a):null});Mee.displayName=n8e;function kT(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Iee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),r8e="VisuallyHidden",s8e=E.forwardRef((e,t)=>f.jsx(wi.span,{...e,ref:t,style:{...Iee,...e.style}}));s8e.displayName=r8e;var i8e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},e0=new WeakMap,s2=new WeakMap,i2={},KI=0,jee=function(e){return e&&(e.host||jee(e.parentNode))},a8e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=jee(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},o8e=function(e,t,n,r){var s=a8e(t,Array.isArray(e)?e:[e]);i2[n]||(i2[n]=new WeakMap);var i=i2[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var m=h.getAttribute(r),y=m!==null&&m!=="false",b=(e0.get(h)||0)+1,v=(i.get(h)||0)+1;e0.set(h,b),i.set(h,v),a.push(h),b===1&&y&&s2.set(h,!0),v===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),KI++,function(){a.forEach(function(d){var h=e0.get(d)-1,m=i.get(d)-1;e0.set(d,h),i.set(d,m),h||(s2.has(d)||d.removeAttribute(r),s2.delete(d)),m||d.removeAttribute(n)}),KI--,KI||(e0=new WeakMap,e0=new WeakMap,s2=new WeakMap,i2={})}},ET=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=i8e(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),o8e(r,s,n,"aria-hidden")):function(){return null}},mu=function(){return mu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},mu.apply(this,arguments)};function Pee(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function l8e(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var B2="right-scroll-bar-position",$2="width-before-scroll-bar",c8e="with-scroll-bars-hidden",u8e="--removed-body-scroll-bar-size";function YI(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function d8e(e,t){var n=E.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var f8e=typeof window<"u"?E.useLayoutEffect:E.useEffect,HU=new WeakMap;function h8e(e,t){var n=d8e(null,function(r){return e.forEach(function(s){return YI(s,r)})});return f8e(function(){var r=HU.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||YI(o,null)}),i.forEach(function(o){s.has(o)||YI(o,a)})}HU.set(n,e)},[e]),n}function p8e(e){return e}function m8e(e,t){t===void 0&&(t=p8e);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function g8e(e){e===void 0&&(e={});var t=m8e(null);return t.options=mu({async:!0,ssr:!1},e),t}var Oee=function(e){var t=e.sideCar,n=Pee(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,mu({},n))};Oee.isSideCarExport=!0;function y8e(e,t){return e.useMedium(t),Oee}var Dee=g8e(),ZI=function(){},TT=E.forwardRef(function(e,t){var n=E.useRef(null),r=E.useState({onScrollCapture:ZI,onWheelCapture:ZI,onTouchMoveCapture:ZI}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=Pee(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,C=h8e([n,t]),R=mu(mu({},S),s);return E.createElement(E.Fragment,null,u&&E.createElement(k,{sideCar:Dee,removeScrollBar:c,shards:d,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:w}),a?E.cloneElement(E.Children.only(o),mu(mu({},R),{ref:C})):E.createElement(x,mu({},R,{className:l,ref:C}),o))});TT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};TT.classNames={fullWidth:$2,zeroRight:B2};var b8e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function v8e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=b8e();return t&&e.setAttribute("nonce",t),e}function x8e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function w8e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var _8e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=v8e())&&(x8e(t,n),w8e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},S8e=function(){var e=_8e();return function(t,n){E.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Fee=function(){var e=S8e(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},C8e={left:0,top:0,right:0,gap:0},XI=function(e){return parseInt(e||"",10)||0},k8e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[XI(n),XI(r),XI(s)]},E8e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return C8e;var t=k8e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},T8e=Fee(),P0="data-scroll-locked",A8e=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(c8e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(P0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(B2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat($2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(B2," .").concat(B2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat($2," .").concat($2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(P0,`] {
    `).concat(u8e,": ").concat(o,`px;
  }
`)},GU=function(){var e=parseInt(document.body.getAttribute(P0)||"0",10);return isFinite(e)?e:0},R8e=function(){E.useEffect(function(){return document.body.setAttribute(P0,(GU()+1).toString()),function(){var e=GU()-1;e<=0?document.body.removeAttribute(P0):document.body.setAttribute(P0,e.toString())}},[])},N8e=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;R8e();var i=E.useMemo(function(){return E8e(s)},[s]);return E.createElement(T8e,{styles:A8e(i,!t,s,n?"":"!important")})},y4=!1;if(typeof window<"u")try{var a2=Object.defineProperty({},"passive",{get:function(){return y4=!0,!0}});window.addEventListener("test",a2,a2),window.removeEventListener("test",a2,a2)}catch{y4=!1}var t0=y4?{passive:!1}:!1,M8e=function(e){return e.tagName==="TEXTAREA"},Lee=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!M8e(e)&&n[t]==="visible")},I8e=function(e){return Lee(e,"overflowY")},j8e=function(e){return Lee(e,"overflowX")},KU=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Bee(e,r);if(s){var i=$ee(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},P8e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},O8e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Bee=function(e,t){return e==="v"?I8e(t):j8e(t)},$ee=function(e,t){return e==="v"?P8e(t):O8e(t)},D8e=function(e,t){return e==="h"&&t==="rtl"?-1:1},F8e=function(e,t,n,r,s){var i=D8e(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=$ee(e,o),y=m[0],b=m[1],v=m[2],x=b-v-i*y;(y||x)&&Bee(e,o)&&(d+=x,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},o2=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},YU=function(e){return[e.deltaX,e.deltaY]},ZU=function(e){return e&&"current"in e?e.current:e},L8e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},B8e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},$8e=0,n0=[];function z8e(e){var t=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),s=E.useState($8e++)[0],i=E.useState(Fee)[0],a=E.useRef(e);E.useEffect(function(){a.current=e},[e]),E.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=l8e([e.lockRef.current],(e.shards||[]).map(ZU),!0).filter(Boolean);return b.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=E.useCallback(function(b,v){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=o2(b),w=n.current,S="deltaX"in b?b.deltaX:w[0]-x[0],k="deltaY"in b?b.deltaY:w[1]-x[1],C,R=b.target,A=Math.abs(S)>Math.abs(k)?"h":"v";if("touches"in b&&A==="h"&&R.type==="range")return!1;var N=KU(A,R);if(!N)return!0;if(N?C=A:(C=A==="v"?"h":"v",N=KU(A,R)),!N)return!1;if(!r.current&&"changedTouches"in b&&(S||k)&&(r.current=C),!C)return!0;var I=r.current||C;return F8e(I,v,b,I==="h"?S:k)},[]),l=E.useCallback(function(b){var v=b;if(!(!n0.length||n0[n0.length-1]!==i)){var x="deltaY"in v?YU(v):o2(v),w=t.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&L8e(C.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(a.current.shards||[]).map(ZU).filter(Boolean).filter(function(C){return C.contains(v.target)}),k=S.length>0?o(v,S[0]):!a.current.noIsolation;k&&v.cancelable&&v.preventDefault()}}},[]),c=E.useCallback(function(b,v,x,w){var S={name:b,delta:v,target:x,should:w,shadowParent:U8e(x)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(k){return k!==S})},1)},[]),u=E.useCallback(function(b){n.current=o2(b),r.current=void 0},[]),d=E.useCallback(function(b){c(b.type,YU(b),b.target,o(b,e.lockRef.current))},[]),h=E.useCallback(function(b){c(b.type,o2(b),b.target,o(b,e.lockRef.current))},[]);E.useEffect(function(){return n0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,t0),document.addEventListener("touchmove",l,t0),document.addEventListener("touchstart",u,t0),function(){n0=n0.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,t0),document.removeEventListener("touchmove",l,t0),document.removeEventListener("touchstart",u,t0)}},[]);var m=e.removeScrollBar,y=e.inert;return E.createElement(E.Fragment,null,y?E.createElement(i,{styles:B8e(s)}):null,m?E.createElement(N8e,{gapMode:e.gapMode}):null)}function U8e(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const q8e=y8e(Dee,z8e);var X1=E.forwardRef(function(e,t){return E.createElement(TT,mu({},e,{ref:t,sideCar:q8e}))});X1.classNames=TT.classNames;var V8e=[" ","Enter","ArrowUp","ArrowDown"],W8e=[" ","Enter"],Tm="Select",[AT,RT,H8e]=TFe(Tm),[db,udt]=Gi(Tm,[H8e,_ee]),NT=_ee(),[G8e,Jh]=db(Tm),[K8e,Y8e]=db(Tm),zee=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:y}=e,b=NT(t),[v,x]=E.useState(null),[w,S]=E.useState(null),[k,C]=E.useState(!1),R=ob(c),[A,N]=Mc({prop:r,defaultProp:s??!1,onChange:i,caller:Tm}),[I,O]=Mc({prop:a,defaultProp:o,onChange:l,caller:Tm}),B=E.useRef(null),D=v?y||!!v.closest("form"):!0,[W,P]=E.useState(new Set),Z=Array.from(W).map(U=>U.props.value).join(";");return f.jsx(JFe,{...b,children:f.jsxs(G8e,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:oa(),value:I,onValueChange:O,open:A,onOpenChange:N,dir:R,triggerPointerDownPosRef:B,disabled:h,children:[f.jsx(AT.Provider,{scope:t,children:f.jsx(K8e,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(U=>{P(H=>new Set(H).add(U))},[]),onNativeOptionRemove:E.useCallback(U=>{P(H=>{const L=new Set(H);return L.delete(U),L})},[]),children:n})}),D?f.jsxs(cte,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:U=>O(U.target.value),disabled:h,form:y,children:[I===void 0?f.jsx("option",{value:""}):null,Array.from(W)]},Z):null]})})};zee.displayName=Tm;var Uee="SelectTrigger",qee=E.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=NT(n),a=Jh(Uee,n),o=a.disabled||r,l=Nn(t,a.onTriggerChange),c=RT(n),u=E.useRef("touch"),[d,h,m]=dte(b=>{const v=c().filter(S=>!S.disabled),x=v.find(S=>S.value===a.value),w=fte(v,b,x);w!==void 0&&a.onValueChange(w.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return f.jsx(QFe,{asChild:!0,...i,children:f.jsx(wi.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":ute(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Wt(s.onPointerDown,b=>{u.current=b.pointerType;const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Wt(s.onKeyDown,b=>{const v=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(v&&b.key===" ")&&V8e.includes(b.key)&&(y(),b.preventDefault())})})})});qee.displayName=Uee;var Vee="SelectValue",Wee=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=Jh(Vee,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=Nn(t,l.onValueNodeChange);return ri(()=>{c(u)},[c,u]),f.jsx(wi.span,{...o,ref:d,style:{pointerEvents:"none"},children:ute(l.value)?f.jsx(f.Fragment,{children:a}):i})});Wee.displayName=Vee;var Z8e="SelectIcon",Hee=E.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(wi.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});Hee.displayName=Z8e;var X8e="SelectPortal",Gee=e=>f.jsx(Mee,{asChild:!0,...e});Gee.displayName=X8e;var Am="SelectContent",Kee=E.forwardRef((e,t)=>{const n=Jh(Am,e.__scopeSelect),[r,s]=E.useState();if(ri(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?il.createPortal(f.jsx(Yee,{scope:e.__scopeSelect,children:f.jsx(AT.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(Zee,{...e,ref:t})});Kee.displayName=Am;var dc=10,[Yee,Qh]=db(Am),J8e="SelectContentImpl",Q8e=Au("SelectContent.RemoveScroll"),Zee=E.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v,...x}=e,w=Jh(Am,n),[S,k]=E.useState(null),[C,R]=E.useState(null),A=Nn(t,De=>k(De)),[N,I]=E.useState(null),[O,B]=E.useState(null),D=RT(n),[W,P]=E.useState(!1),Z=E.useRef(!1);E.useEffect(()=>{if(S)return ET(S)},[S]),CT();const U=E.useCallback(De=>{const[Se,...Ce]=D().map(We=>We.ref.current),[qe]=Ce.slice(-1),Qe=document.activeElement;for(const We of De)if(We===Qe||(We==null||We.scrollIntoView({block:"nearest"}),We===Se&&C&&(C.scrollTop=0),We===qe&&C&&(C.scrollTop=C.scrollHeight),We==null||We.focus(),document.activeElement!==Qe))return},[D,C]),H=E.useCallback(()=>U([N,S]),[U,N,S]);E.useEffect(()=>{W&&H()},[W,H]);const{onOpenChange:L,triggerPointerDownPosRef:ne}=w;E.useEffect(()=>{if(S){let De={x:0,y:0};const Se=qe=>{var Qe,We;De={x:Math.abs(Math.round(qe.pageX)-(((Qe=ne.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(qe.pageY)-(((We=ne.current)==null?void 0:We.y)??0))}},Ce=qe=>{De.x<=10&&De.y<=10?qe.preventDefault():S.contains(qe.target)||L(!1),document.removeEventListener("pointermove",Se),ne.current=null};return ne.current!==null&&(document.addEventListener("pointermove",Se),document.addEventListener("pointerup",Ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Se),document.removeEventListener("pointerup",Ce,{capture:!0})}}},[S,L,ne]),E.useEffect(()=>{const De=()=>L(!1);return window.addEventListener("blur",De),window.addEventListener("resize",De),()=>{window.removeEventListener("blur",De),window.removeEventListener("resize",De)}},[L]);const[V,Q]=dte(De=>{const Se=D().filter(Qe=>!Qe.disabled),Ce=Se.find(Qe=>Qe.ref.current===document.activeElement),qe=fte(Se,De,Ce);qe&&setTimeout(()=>qe.ref.current.focus())}),ee=E.useCallback((De,Se,Ce)=>{const qe=!Z.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&(I(De),qe&&(Z.current=!0))},[w.value]),se=E.useCallback(()=>S==null?void 0:S.focus(),[S]),me=E.useCallback((De,Se,Ce)=>{const qe=!Z.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&B(De)},[w.value]),ce=r==="popper"?b4:Xee,je=ce===b4?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return f.jsx(Yee,{scope:n,content:S,viewport:C,onViewportChange:R,itemRefCallback:ee,selectedItem:N,onItemLeave:se,itemTextRefCallback:me,focusSelectedItem:H,selectedItemText:O,position:r,isPositioned:W,searchRef:V,children:f.jsx(X1,{as:Q8e,allowPinchZoom:!0,children:f.jsx(bee,{asChild:!0,trapped:w.open,onMountAutoFocus:De=>{De.preventDefault()},onUnmountAutoFocus:Wt(s,De=>{var Se;(Se=w.trigger)==null||Se.focus({preventScroll:!0}),De.preventDefault()}),children:f.jsx(gee,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:De=>De.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(ce,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:De=>De.preventDefault(),...x,...je,onPlaced:()=>P(!0),ref:A,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,De=>{const Se=De.ctrlKey||De.altKey||De.metaKey;if(De.key==="Tab"&&De.preventDefault(),!Se&&De.key.length===1&&Q(De.key),["ArrowUp","ArrowDown","Home","End"].includes(De.key)){let qe=D().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(De.key)&&(qe=qe.slice().reverse()),["ArrowUp","ArrowDown"].includes(De.key)){const Qe=De.target,We=qe.indexOf(Qe);qe=qe.slice(We+1)}setTimeout(()=>U(qe)),De.preventDefault()}})})})})})})});Zee.displayName=J8e;var eLe="SelectItemAlignedPosition",Xee=E.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Jh(Am,n),a=Qh(Am,n),[o,l]=E.useState(null),[c,u]=E.useState(null),d=Nn(t,A=>u(A)),h=RT(n),m=E.useRef(!1),y=E.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,S=E.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&v&&x){const A=i.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),O=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=O.left-N.left,We=I.left-Qe,Ne=A.left-We,K=A.width+Ne,ge=Math.max(K,N.width),Ae=window.innerWidth-dc,le=Ow(We,[dc,Math.max(dc,Ae-ge)]);o.style.minWidth=K+"px",o.style.left=le+"px"}else{const Qe=N.right-O.right,We=window.innerWidth-I.right-Qe,Ne=window.innerWidth-A.right-We,K=A.width+Ne,ge=Math.max(K,N.width),Ae=window.innerWidth-dc,le=Ow(We,[dc,Math.max(dc,Ae-ge)]);o.style.minWidth=K+"px",o.style.right=le+"px"}const B=h(),D=window.innerHeight-dc*2,W=b.scrollHeight,P=window.getComputedStyle(c),Z=parseInt(P.borderTopWidth,10),U=parseInt(P.paddingTop,10),H=parseInt(P.borderBottomWidth,10),L=parseInt(P.paddingBottom,10),ne=Z+U+W+L+H,V=Math.min(v.offsetHeight*5,ne),Q=window.getComputedStyle(b),ee=parseInt(Q.paddingTop,10),se=parseInt(Q.paddingBottom,10),me=A.top+A.height/2-dc,ce=D-me,je=v.offsetHeight/2,De=v.offsetTop+je,Se=Z+U+De,Ce=ne-Se;if(Se<=me){const Qe=B.length>0&&v===B[B.length-1].ref.current;o.style.bottom="0px";const We=c.clientHeight-b.offsetTop-b.offsetHeight,Ne=Math.max(ce,je+(Qe?se:0)+We+H),K=Se+Ne;o.style.height=K+"px"}else{const Qe=B.length>0&&v===B[0].ref.current;o.style.top="0px";const Ne=Math.max(me,Z+b.offsetTop+(Qe?ee:0)+je)+Ce;o.style.height=Ne+"px",b.scrollTop=Se-me+b.offsetTop}o.style.margin=`${dc}px 0`,o.style.minHeight=V+"px",o.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,c,b,v,x,i.dir,r]);ri(()=>S(),[S]);const[k,C]=E.useState();ri(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const R=E.useCallback(A=>{A&&y.current===!0&&(S(),w==null||w(),y.current=!1)},[S,w]);return f.jsx(nLe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:R,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:f.jsx(wi.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Xee.displayName=eLe;var tLe="SelectPopperPosition",b4=E.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=dc,...i}=e,a=NT(n);return f.jsx(e8e,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});b4.displayName=tLe;var[nLe,_6]=db(Am,{}),v4="SelectViewport",Jee=E.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=Qh(v4,n),a=_6(v4,n),o=Nn(t,i.onViewportChange),l=E.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(AT.Slot,{scope:n,children:f.jsx(wi.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const y=window.innerHeight-dc*2,b=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(b,v);if(x<y){const w=x+m,S=Math.min(y,w),k=w-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});Jee.displayName=v4;var Qee="SelectGroup",[rLe,sLe]=db(Qee),iLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=oa();return f.jsx(rLe,{scope:n,id:s,children:f.jsx(wi.div,{role:"group","aria-labelledby":s,...r,ref:t})})});iLe.displayName=Qee;var ete="SelectLabel",aLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=sLe(ete,n);return f.jsx(wi.div,{id:s.id,...r,ref:t})});aLe.displayName=ete;var wk="SelectItem",[oLe,tte]=db(wk),nte=E.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=Jh(wk,n),l=Qh(wk,n),c=o.value===r,[u,d]=E.useState(i??""),[h,m]=E.useState(!1),y=Nn(t,w=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,w,r,s)}),b=oa(),v=E.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(oLe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:E.useCallback(w=>{d(S=>S||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(AT.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(wi.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:Wt(a.onFocus,()=>m(!0)),onBlur:Wt(a.onBlur,()=>m(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var S;v.current=w.pointerType,s?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var S;w.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var k;((k=l.searchRef)==null?void 0:k.current)!==""&&w.key===" "||(W8e.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});nte.displayName=wk;var ix="SelectItemText",rte=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=Jh(ix,n),o=Qh(ix,n),l=tte(ix,n),c=Y8e(ix,n),[u,d]=E.useState(null),h=Nn(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),m=u==null?void 0:u.textContent,y=E.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=c;return ri(()=>(b(y),()=>v(y)),[b,v,y]),f.jsxs(f.Fragment,{children:[f.jsx(wi.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?il.createPortal(i.children,a.valueNode):null]})});rte.displayName=ix;var ste="SelectItemIndicator",ite=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return tte(ste,n).isSelected?f.jsx(wi.span,{"aria-hidden":!0,...r,ref:t}):null});ite.displayName=ste;var x4="SelectScrollUpButton",ate=E.forwardRef((e,t)=>{const n=Qh(x4,e.__scopeSelect),r=_6(x4,e.__scopeSelect),[s,i]=E.useState(!1),a=Nn(t,r.onScrollButtonChange);return ri(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(lte,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});ate.displayName=x4;var w4="SelectScrollDownButton",ote=E.forwardRef((e,t)=>{const n=Qh(w4,e.__scopeSelect),r=_6(w4,e.__scopeSelect),[s,i]=E.useState(!1),a=Nn(t,r.onScrollButtonChange);return ri(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(lte,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});ote.displayName=w4;var lte=E.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=Qh("SelectScrollButton",n),a=E.useRef(null),o=RT(n),l=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>l(),[l]),ri(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(wi.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),lLe="SelectSeparator",cLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(wi.div,{"aria-hidden":!0,...r,ref:t})});cLe.displayName=lLe;var _4="SelectArrow",uLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=NT(n),i=Jh(_4,n),a=Qh(_4,n);return i.open&&a.position==="popper"?f.jsx(t8e,{...s,...r,ref:t}):null});uLe.displayName=_4;var dLe="SelectBubbleInput",cte=E.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=E.useRef(null),i=Nn(r,s),a=kT(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(wi.select,{...n,style:{...Iee,...n.style},ref:i,defaultValue:t})});cte.displayName=dLe;function ute(e){return e===""||e===void 0}function dte(e){const t=Es(e),n=E.useRef(""),r=E.useRef(0),s=E.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=E.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function fte(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=fLe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function fLe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var hLe=zee,pLe=qee,mLe=Wee,gLe=Hee,yLe=Gee,bLe=Kee,vLe=Jee,xLe=nte,wLe=rte,_Le=ite,SLe=ate,CLe=ote;function ep({...e}){return f.jsx(hLe,{"data-slot":"select",...e})}function tp({...e}){return f.jsx(mLe,{"data-slot":"select-value",...e})}function np({className:e,size:t="default",children:n,...r}){return f.jsxs(pLe,{"data-slot":"select-trigger","data-size":t,className:Je("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(gLe,{asChild:!0,children:f.jsx(Yl,{className:"size-4 opacity-50"})})]})}function rp({className:e,children:t,position:n="popper",...r}){return f.jsx(yLe,{children:f.jsxs(bLe,{"data-slot":"select-content",className:Je("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(kLe,{}),f.jsx(vLe,{className:Je("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(ELe,{})]})})}function Eo({className:e,children:t,...n}){return f.jsxs(xLe,{"data-slot":"select-item",className:Je("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(_Le,{children:f.jsx(so,{className:"size-4"})})}),f.jsx(wLe,{children:t})]})}function kLe({className:e,...t}){return f.jsx(SLe,{"data-slot":"select-scroll-up-button",className:Je("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Lh,{className:"size-4"})})}function ELe({className:e,...t}){return f.jsx(CLe,{"data-slot":"select-scroll-down-button",className:Je("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Yl,{className:"size-4"})})}var TLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ALe=TLe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),RLe="Label",hte=E.forwardRef((e,t)=>f.jsx(ALe.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));hte.displayName=RLe;var NLe=hte;function jt({className:e,...t}){return f.jsx(NLe,{"data-slot":"label",className:Je("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const Ii=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,MLe=wo.map(e=>e.value),l2=Ge({keyName:$e().min(1,"Key Name is required."),providerType:yl(MLe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:$e().min(1,"API Key Value is required.")}),pte=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=E.useRef(null),l=si({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:l2,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});E.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,v;if(!u)return;const h=(b=wo.find(x=>x.value===u))==null?void 0:b.label,m=l.getFieldValue("providerType"),y=(v=wo.find(x=>x.value===m))==null?void 0:v.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:Je("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(l.Field,{name:"providerType",validators:{onChange:l2.shape.providerType},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:u.name,children:"Provider Type"}),f.jsxs(ep,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[f.jsx(np,{id:u.name,children:f.jsx(tp,{placeholder:"Select Provider Type"})}),f.jsx(rp,{children:wo.map(d=>f.jsx(Eo,{value:d.value,children:d.label},d.value))})]}),f.jsx(Ii,{field:u})]})}),f.jsx(l.Field,{name:"keyName",validators:{onChange:l2.shape.keyName},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:u.name,children:"Key Name"}),f.jsx(Sn,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),f.jsx(Ii,{field:u})]})}),f.jsx(l.Field,{name:"keyValue",validators:{onChange:l2.shape.keyValue},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:u.name,children:"API Key Value"}),f.jsx(Sn,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Ii,{field:u})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(pt,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[f.jsx(Wi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,m])=>f.jsxs(pt,{type:"submit",size:"sm",disabled:i||!u||d||h||!m,children:[(d||h)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},ILe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(ep,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(np,{className:Je("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(tp,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(qx,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(rp,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(Eo,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(Eo,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function Vw({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Je("space-y-1.5",a),children:[f.jsx(jt,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(Sn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Je(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(Ii,{field:c})]})}})}function Mx({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Je("space-y-1.5",a),children:[f.jsx(jt,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(ep,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(np,{id:u.name,onBlur:u.handleBlur,className:Je(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(tp,{placeholder:s})}),f.jsx(rp,{className:l,children:r.map(h=>f.jsx(Eo,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(Ii,{field:u})]})}})}var jLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],mte=jLe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),MT="Switch",[PLe,ddt]=Gi(MT),[OLe,DLe]=PLe(MT),gte=E.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,m]=E.useState(null),y=Nn(t,S=>m(S)),b=E.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=Mc({prop:s,defaultProp:i??!1,onChange:c,caller:MT});return f.jsxs(OLe,{scope:n,checked:x,disabled:o,children:[f.jsx(mte.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":xte(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Wt(e.onClick,S=>{w(k=>!k),v&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),v&&f.jsx(vte,{control:h,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});gte.displayName=MT;var yte="SwitchThumb",bte=E.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=DLe(yte,n);return f.jsx(mte.span,{"data-state":xte(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});bte.displayName=yte;var FLe="SwitchBubbleInput",vte=E.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=Nn(a,i),l=kT(n),c=Vy(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});vte.displayName=FLe;function xte(e){return e?"checked":"unchecked"}var LLe=gte,BLe=bte;function Mo({className:e,...t}){return f.jsx(LLe,{"data-slot":"switch",className:Je("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(BLe,{"data-slot":"switch-thumb",className:Je("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Jp({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Je("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(jt,{htmlFor:c.name,className:Je("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(Mo,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Je(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(Ii,{field:c})]})}})}const $Le=wo.map(e=>e.value),zLe=Ge({name:$e().min(1,"Provider Name is required."),type:yl($Le,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:Gn(),apiKeyId:$e().nullable(),baseURL:$e().url().nullable().or(Rn("")),autoFetchModels:Gn()}).refine(e=>jC(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>ty(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),ULe=wo.map(e=>({value:e.value,label:e.label})),wte=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=si({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=wo[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:zLe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!jC(x.type)?null:x.baseURL};await t(w)}}),c=E.useRef(l.state.values);E.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,S=c.current;if(n&&S)for(const k in w){const C=k;w[C]!==S[C]&&n(C,w[C])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),E.useEffect(()=>{var S,k;const x=(e==null?void 0:e.type)||((S=wo[0])==null?void 0:S.value),w={name:(e==null?void 0:e.name)||((k=wo.find(C=>C.value===x))==null?void 0:k.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??dm(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=ty(u??null),h=jC(u??null),m=dm(u??null),y=E.useCallback(x=>{var S,k;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",dm(x));const C=(S=wo.find(N=>N.value===x))==null?void 0:S.label,R=(k=wo.find(N=>N.value===w))==null?void 0:k.label,A=l.state.values.name;C&&(!(A!=null&&A.trim())||A===R)&&l.setFieldValue("name",C)}},[l]);E.useEffect(()=>{const x=l.state.values.type;x!==void 0&&y(x)},[l.state.values.type,y]);const b=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Je("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(Mx,{form:l,name:"type",label:"Provider Type",options:ULe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx(Vw,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(jt,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx(ILe,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),f.jsx(Ii,{field:x})]})}),h&&f.jsx(Vw,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),m&&f.jsx(Jp,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx(Jp,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(pt,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(Wi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,S,k])=>f.jsxs(pt,{type:"submit",size:"sm",disabled:a||i||!x||w||!k||S,children:[(i||w||S)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"})," ",i||w||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},_te=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=E.useState(!1),[l,c]=E.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:dm(r)});E.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=E.useCallback((h,m)=>new Promise(y=>{c(b=>{var w,S;const v={...b,[h]:m},x=b.name||"";if(h==="type"){const k=m,C=(w=wo.find(A=>A.value===b.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=k?dm(k):!1;const R=(S=wo.find(A=>A.value===k))==null?void 0:S.label;if(R&&(!x.trim()||x===C)&&(v.name=R),k&&ty(k)){const A=(e||[]).filter(N=>N.providerId===k);A.length>0&&(v.apiKeyId=A[0].id)}}return v}),y(void 0)}),[e]),d=E.useCallback(async()=>{var h,m;if(!((h=l.name)!=null&&h.trim())||!l.type){Me.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??dm(y),v={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((m=l.baseURL)==null?void 0:m.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(wte,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},kd=Ve.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Je("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));kd.displayName="Lnk";const qLe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},VLe=OP("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function is({className:e,variant:t,asChild:n=!1,...r}){const s=n?XW:"span";return f.jsx(s,{"data-slot":"badge",className:Je(VLe({variant:t}),e),...r})}const WLe=()=>{const[e,t]=E.useState(!1);E.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(f.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(fu.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(is,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(xH,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(fu.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(fu.div,{variants:r,className:"pt-2",children:[f.jsx(is,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(is,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var S6="Progress",C6=100,[HLe,fdt]=Gi(S6),[GLe,KLe]=HLe(S6),Ste=E.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=YLe,...a}=e;(s||s===0)&&!XU(s)&&console.error(ZLe(`${s}`,"Progress"));const o=XU(s)?s:C6;r!==null&&!JU(r,o)&&console.error(XLe(`${r}`,"Progress"));const l=JU(r,o)?r:null,c=_k(l)?i(l,o):void 0;return f.jsx(GLe,{scope:n,value:l,max:o,children:f.jsx(or.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":_k(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Ete(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});Ste.displayName=S6;var Cte="ProgressIndicator",kte=E.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=KLe(Cte,n);return f.jsx(or.div,{"data-state":Ete(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});kte.displayName=Cte;function YLe(e,t){return`${Math.round(e/t*100)}%`}function Ete(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function _k(e){return typeof e=="number"}function XU(e){return _k(e)&&!isNaN(e)&&e>0}function JU(e,t){return _k(e)&&!isNaN(e)&&e<=t&&e>=0}function ZLe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${C6}\`.`}function XLe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${C6} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Tte=Ste,JLe=kte;const _y=E.forwardRef(({className:e,value:t,...n},r)=>f.jsx(Tte,{ref:r,className:Je("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(JLe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));_y.displayName=Tte.displayName;function r0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return s;r=d;let m;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(m=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-m)*100)/100,v=b/16,x=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c ${x(b,5)} /${x(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function JI(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const QLe=(e,t)=>Math.abs(e-t)<=1,eBe=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},QU=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},tBe=e=>e,nBe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},rBe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(QU(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(QU(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},eq={passive:!0},tq=typeof window>"u"?!0:"onscrollend"in window,sBe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&tq?()=>{}:eBe(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,eq);const c=e.options.useScrollendEvent&&tq;return c&&n.addEventListener("scrollend",l,eq),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},iBe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},aBe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class oBe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:tBe,rangeExtractor:nBe,onChange:()=>{},measureElement:iBe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=r0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=r0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=r0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),m=h?h.end+this.options.gap:r+s,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),v=m+b,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:m,size:b,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=r0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?lBe({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=r0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=r0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return JI(r[Ate(0,r.length-1,s=>JI(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=JI(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();QLe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const Ate=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function lBe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=Ate(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const nq=typeof document<"u"?E.useLayoutEffect:E.useEffect;function cBe(e){const t=E.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?il.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=E.useState(()=>new oBe(n));return r.setOptions(n),nq(()=>r._didMount(),[]),nq(()=>r._willUpdate()),r}function k6(e){return cBe({observeElementRect:rBe,observeElementOffset:sBe,scrollToFn:aBe,...e})}var uBe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],sf=uBe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function dBe(e,t){e&&il.flushSync(()=>e.dispatchEvent(t))}var fBe="DismissableLayer",S4="dismissableLayer.update",hBe="dismissableLayer.pointerDownOutside",pBe="dismissableLayer.focusOutside",rq,Rte=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Nte=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(Rte),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=Nn(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=yBe(A=>{const N=A.target,I=[...c.branches].some(O=>O.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),R=bBe(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return tO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(rq=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),sq(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=rq)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),sq())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(S4,A),()=>document.removeEventListener(S4,A)},[]),f.jsx(sf.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,R.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});Nte.displayName=fBe;var mBe="DismissableLayerBranch",gBe=E.forwardRef((e,t)=>{const n=E.useContext(Rte),r=E.useRef(null),s=Nn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(sf.div,{...e,ref:s})});gBe.displayName=mBe;function yBe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Mte(hBe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function bBe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&Mte(pBe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function sq(){const e=new CustomEvent(S4);document.dispatchEvent(e)}function Mte(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?dBe(s,i):s.dispatchEvent(i)}var QI="focusScope.autoFocusOnMount",e3="focusScope.autoFocusOnUnmount",iq={bubbles:!1,cancelable:!0},vBe="FocusScope",Ite=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=Nn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:eh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||eh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&eh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){oq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(QI,iq);o.addEventListener(QI,c),o.dispatchEvent(x),x.defaultPrevented||(xBe(kBe(jte(o)),{select:!0}),document.activeElement===b&&eh(o))}return()=>{o.removeEventListener(QI,c),setTimeout(()=>{const x=new CustomEvent(e3,iq);o.addEventListener(e3,u),o.dispatchEvent(x),x.defaultPrevented||eh(b??document.body,{select:!0}),o.removeEventListener(e3,u),oq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=wBe(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&eh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&eh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(sf.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Ite.displayName=vBe;function xBe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(eh(r,{select:t}),document.activeElement!==n)return}function wBe(e){const t=jte(e),n=aq(t,e),r=aq(t.reverse(),e);return[n,r]}function jte(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function aq(e,t){for(const n of e)if(!_Be(n,{upTo:t}))return n}function _Be(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function SBe(e){return e instanceof HTMLInputElement&&"select"in e}function eh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&SBe(e)&&t&&e.select()}}var oq=CBe();function CBe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=lq(e,t),e.unshift(t)},remove(t){var n;e=lq(e,t),(n=e[0])==null||n.resume()}}}function lq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function kBe(e){return e.filter(t=>t.tagName!=="A")}var EBe="Arrow",Pte=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(sf.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Pte.displayName=EBe;var TBe=Pte,E6="Popper",[Ote,Dte]=Gi(E6),[ABe,Fte]=Ote(E6),Lte=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(ABe,{scope:t,anchor:r,onAnchorChange:s,children:n})};Lte.displayName=E6;var Bte="PopperAnchor",$te=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Fte(Bte,n),a=E.useRef(null),o=Nn(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(sf.div,{...s,ref:o})});$te.displayName=Bte;var T6="PopperContent",[RBe,NBe]=Ote(T6),zte=E.forwardRef((e,t)=>{var De,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Fte(T6,n),[x,w]=E.useState(null),S=Nn(t,Ne=>w(Ne)),[k,C]=E.useState(null),R=Vy(k),A=(R==null?void 0:R.width)??0,N=(R==null?void 0:R.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,W={padding:O,boundary:B.filter(IBe),altBoundary:D},{refs:P,floatingStyles:Z,placement:U,isPositioned:H,middlewareData:L}=uO({strategy:"fixed",placement:I,whileElementsMounted:(...Ne)=>cO(...Ne,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[dO({mainAxis:s+N,alignmentAxis:a}),l&&fO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?hO():void 0,...W}),l&&pO({...W}),mO({...W,apply:({elements:Ne,rects:K,availableWidth:ge,availableHeight:Ae})=>{const{width:le,height:oe}=K.reference,re=Ne.floating.style;re.setProperty("--radix-popper-available-width",`${ge}px`),re.setProperty("--radix-popper-available-height",`${Ae}px`),re.setProperty("--radix-popper-anchor-width",`${le}px`),re.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&yO({element:k,padding:o}),jBe({arrowWidth:A,arrowHeight:N}),h&&gO({strategy:"referenceHidden",...W})]}),[ne,V]=Vte(U),Q=Es(y);ri(()=>{H&&(Q==null||Q())},[H,Q]);const ee=(De=L.arrow)==null?void 0:De.x,se=(Se=L.arrow)==null?void 0:Se.y,me=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[ce,je]=E.useState();return ri(()=>{x&&je(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...Z,transform:H?Z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(RBe,{scope:n,placedSide:ne,onArrowChange:C,arrowX:ee,arrowY:se,shouldHideArrow:me,children:f.jsx(sf.div,{"data-side":ne,"data-align":V,...b,ref:S,style:{...b.style,animation:H?void 0:"none"}})})})});zte.displayName=T6;var Ute="PopperArrow",MBe={top:"bottom",right:"left",bottom:"top",left:"right"},qte=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=NBe(Ute,r),a=MBe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(TBe,{...s,ref:n,style:{...s.style,display:"block"}})})});qte.displayName=Ute;function IBe(e){return e!==null}var jBe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=Vte(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function Vte(e){const[t,n="center"]=e.split("-");return[t,n]}var PBe=Lte,Wte=$te,OBe=zte,DBe=qte,FBe="Portal",Hte=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);ri(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?xE.createPortal(f.jsx(sf.div,{...r,ref:t}),a):null});Hte.displayName=FBe;var IT="Popover",[Gte,hdt]=Gi(IT,[Dte]),J1=Dte(),[LBe,sp]=Gte(IT),Kte=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=J1(t),l=E.useRef(null),[c,u]=E.useState(!1),[d,h]=Mc({prop:r,defaultProp:s??!1,onChange:i,caller:IT});return f.jsx(PBe,{...o,children:f.jsx(LBe,{scope:t,contentId:oa(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:E.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:c,onCustomAnchorAdd:E.useCallback(()=>u(!0),[]),onCustomAnchorRemove:E.useCallback(()=>u(!1),[]),modal:a,children:n})})};Kte.displayName=IT;var Yte="PopoverAnchor",BBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=sp(Yte,n),i=J1(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return E.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(Wte,{...i,...r,ref:t})});BBe.displayName=Yte;var Zte="PopoverTrigger",Xte=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=sp(Zte,n),i=J1(n),a=Nn(t,s.triggerRef),o=f.jsx(sf.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":nne(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(Wte,{asChild:!0,...i,children:o})});Xte.displayName=Zte;var A6="PopoverPortal",[$Be,zBe]=Gte(A6,{forceMount:void 0}),Jte=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=sp(A6,t);return f.jsx($Be,{scope:t,forceMount:n,children:f.jsx(ca,{present:n||i.open,children:f.jsx(Hte,{asChild:!0,container:s,children:r})})})};Jte.displayName=A6;var Sy="PopoverContent",Qte=E.forwardRef((e,t)=>{const n=zBe(Sy,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=sp(Sy,e.__scopePopover);return f.jsx(ca,{present:r||i.open,children:i.modal?f.jsx(qBe,{...s,ref:t}):f.jsx(VBe,{...s,ref:t})})});Qte.displayName=Sy;var UBe=Au("PopoverContent.RemoveScroll"),qBe=E.forwardRef((e,t)=>{const n=sp(Sy,e.__scopePopover),r=E.useRef(null),s=Nn(t,r),i=E.useRef(!1);return E.useEffect(()=>{const a=r.current;if(a)return ET(a)},[]),f.jsx(X1,{as:UBe,allowPinchZoom:!0,children:f.jsx(ene,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),VBe=E.forwardRef((e,t)=>{const n=sp(Sy,e.__scopePopover),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(ene,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),ene=E.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=sp(Sy,n),m=J1(n);return CT(),f.jsx(Ite,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(Nte,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(OBe,{"data-state":nne(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),tne="PopoverClose",WBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=sp(tne,n);return f.jsx(sf.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});WBe.displayName=tne;var HBe="PopoverArrow",GBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=J1(n);return f.jsx(DBe,{...s,...r,ref:t})});GBe.displayName=HBe;function nne(e){return e?"open":"closed"}var KBe=Kte,YBe=Xte,ZBe=Jte,XBe=Qte;function Bc({...e}){return f.jsx(KBe,{"data-slot":"popover",...e})}function $c({...e}){return f.jsx(YBe,{"data-slot":"popover-trigger",...e})}function zc({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(ZBe,{children:f.jsx(XBe,{"data-slot":"popover-content",align:t,sideOffset:n,className:Je("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}var JBe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],R6=JBe.reduce((e,t)=>{const n=Au(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),jT="Checkbox",[QBe,pdt]=Gi(jT),[e$e,N6]=QBe(jT);function t$e(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,m]=Mc({prop:n,defaultProp:s??!1,onChange:l,caller:jT}),[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useRef(!1),S=y?!!a||!!y.closest("form"):!0,k={checked:h,disabled:i,setChecked:m,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:hh(s)?!1:s,isFormControl:S,bubbleInput:v,setBubbleInput:x};return f.jsx(e$e,{scope:t,...k,children:n$e(d)?d(k):r})}var rne="CheckboxTrigger",sne=E.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:y}=N6(rne,e),b=Nn(s,u),v=E.useRef(l);return E.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(R6.button,{type:"button",role:"checkbox","aria-checked":hh(l)?"mixed":l,"aria-required":c,"data-state":une(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>hh(w)?!0:!w),y&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});sne.displayName=rne;var ine=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(t$e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(sne,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(cne,{__scopeCheckbox:n})]})})});ine.displayName=jT;var ane="CheckboxIndicator",one=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=N6(ane,n);return f.jsx(ca,{present:r||hh(i.checked)||i.checked===!0,children:f.jsx(R6.span,{"data-state":une(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});one.displayName=ane;var lne="CheckboxBubbleInput",cne=E.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:m}=N6(lne,e),y=Nn(n,m),b=kT(i),v=Vy(r);E.useEffect(()=>{const w=h;if(!w)return;const S=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(S,"checked").set,R=!s.current;if(b!==i&&C){const A=new Event("click",{bubbles:R});w.indeterminate=hh(i),C.call(w,hh(i)?!1:i),w.dispatchEvent(A)}},[h,b,i,s]);const x=E.useRef(hh(i)?!1:i);return f.jsx(R6.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:y,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});cne.displayName=lne;function n$e(e){return typeof e=="function"}function hh(e){return e==="indeterminate"}function une(e){return hh(e)?"indeterminate":e?"checked":"unchecked"}function Pc({className:e,...t}){return f.jsx(ine,{"data-slot":"checkbox",className:Je("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(one,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(so,{className:"size-3.5"})})})}const M6=({currentCapabilityFilters:e,onCapabilityFilterChange:t,currentSelectedProviders:n,onProviderFilterChange:r,currentEnabledFilter:s,onEnabledFilterChange:i,currentMinInputPrice:a,currentMaxInputPrice:o,currentMinOutputPrice:l,currentMaxOutputPrice:c,onPriceFilterChange:u,allProviders:d,showCapabilityFilters:h=!0,showProviderFilter:m=!1,showStatusFilter:y=!1,showPriceFilters:b=!1,disabled:v=!1,totalActiveFilters:x})=>{const[w,S]=E.useState(!1),k=E.useCallback(A=>{t({...e,[A]:!e[A]})},[e,t]),C=E.useCallback((A,N)=>{if(!n||!r)return;const I=new Set(n);N?I.add(A):I.delete(A),r(I)},[n,r]),R=E.useCallback((A,N)=>{if(!u)return;u(A==="minInput"?N:a??"",A==="maxInput"?N:o??"",A==="minOutput"?N:l??"",A==="maxOutput"?N:c??"")},[u,a,o,l,c]);return f.jsxs(Bc,{open:w,onOpenChange:S,children:[f.jsx($c,{asChild:!0,children:f.jsxs(pt,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:v,children:[f.jsx(_me,{className:"h-4 w-4 mr-1"}),"Filters",x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsxs(zc,{className:"p-4 space-y-4 w-72 bg-popover shadow-lg relative",style:{zIndex:9999,pointerEvents:"auto"},onMouseDown:A=>A.preventDefault(),onClick:A=>A.stopPropagation(),onPointerDown:A=>A.stopPropagation(),onPointerDownCapture:A=>A.stopPropagation(),align:"end",children:[y&&s!==void 0&&i&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(jt,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(pt,{variant:s==="all"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("all")},children:"All"}),f.jsxs(pt,{variant:s==="enabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("enabled")},children:[f.jsx(so,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(pt,{variant:s==="disabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("disabled")},children:[f.jsx(ppe,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),m&&n&&d&&r&&f.jsxs("div",{onClick:A=>A.stopPropagation(),children:[f.jsx(jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Hl,{className:"h-32 border rounded-md p-1",children:d.map(A=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(Pc,{id:`filter-provider-${A.id}`,checked:n.has(A.id),onCheckedChange:N=>{C(A.id,!!N)}}),f.jsxs(jt,{htmlFor:`filter-provider-${A.id}`,className:"text-sm font-normal cursor-pointer",children:[A.name," (",A.type,")"]})]},A.id))})]}),h&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(jt,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(er,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Ly,{}),onClick:A=>{A.stopPropagation(),k("reasoning")},variant:e.reasoning?"secondary":"outline",className:Je(e.reasoning&&"text-primary")}),f.jsx(er,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(jo,{}),onClick:A=>{A.stopPropagation(),k("webSearch")},variant:e.webSearch?"secondary":"outline",className:Je(e.webSearch&&"text-primary")}),f.jsx(er,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(Vx,{}),onClick:A=>{A.stopPropagation(),k("tools")},variant:e.tools?"secondary":"outline",className:Je(e.tools&&"text-primary")}),f.jsx(er,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(Y0,{}),onClick:A=>{A.stopPropagation(),k("multimodal")},variant:e.multimodal?"secondary":"outline",className:Je(e.multimodal&&"text-primary")})]})]}),b&&a!==void 0&&u&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsxs(jt,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(Qpe,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(Sn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:a,onChange:A=>{A.stopPropagation(),R("minInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(Sn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:o,onChange:A=>{A.stopPropagation(),R("maxInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(Sn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:l,onChange:A=>{A.stopPropagation(),R("minOutput",A.target.value)},className:"h-8 text-xs"}),f.jsx(Sn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:c,onChange:A=>{A.stopPropagation(),R("maxOutput",A.target.value)},className:"h-8 text-xs"})]})]})]})]})},cq=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},I6=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=E.useState(null),u=E.useCallback(Z=>{if(Z){const U=Z.querySelector("[data-radix-scroll-area-viewport]");if(U)c(U);else{const H=new MutationObserver(()=>{const L=Z.querySelector("[data-radix-scroll-area-viewport]");L&&(c(L),H.disconnect())});return H.observe(Z,{childList:!0,subtree:!0}),()=>H.disconnect()}}else c(null)},[]),[d,h]=E.useState(""),[m,y]=E.useState("all"),[b,v]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[x,w]=E.useState(""),[S,k]=E.useState(""),[C,R]=E.useState(""),[A,N]=E.useState(""),I=E.useMemo(()=>{let Z=[...t];if(m==="enabled"?Z=Z.filter(ce=>n.has(ce.id)):m==="disabled"&&(Z=Z.filter(ce=>!n.has(ce.id))),d.trim()){const ce=d.toLowerCase();Z=Z.filter(je=>je.name.toLowerCase().includes(ce)||je.id.toLowerCase().includes(ce))}const U=Object.entries(b).filter(([,ce])=>ce).map(([ce])=>ce);U.length>0&&(Z=Z.filter(ce=>{var Se;const je=new Set(ce.supported_parameters??[]),De=new Set(((Se=ce.architecture)==null?void 0:Se.input_modalities)??[]);return U.every(Ce=>{switch(Ce){case"reasoning":return je.has("reasoning");case"webSearch":return je.has("web_search")||je.has("web_search_options");case"tools":return je.has("tools");case"multimodal":return Array.from(De).some(qe=>qe!=="text");default:return!0}})}));const H=parseFloat(x),L=parseFloat(S),ne=parseFloat(C),V=parseFloat(A),Q=!isNaN(H),ee=!isNaN(L),se=!isNaN(ne),me=!isNaN(V);return(Q||ee||se||me)&&(Z=Z.filter(ce=>{var ge,Ae;const je=cq((ge=ce.pricing)==null?void 0:ge.prompt),De=cq((Ae=ce.pricing)==null?void 0:Ae.completion),Se=Q?H/1e6:-1/0,Ce=ee?L/1e6:1/0,qe=se?ne/1e6:-1/0,Qe=me?V/1e6:1/0,We=je!==null&&je>=Se&&je<=Ce,Ne=De!==null&&De>=qe&&De<=Qe;let K=!0;return(Q||ee)&&K&&(K=We),(se||me)&&K&&(K=Ne),K})),Z},[t,d,m,n,b,x,S,C,A]),O=k6({count:I.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),B=E.useCallback(Z=>{v(Z)},[]),D=E.useCallback(Z=>{y(Z)},[]),W=E.useCallback((Z,U,H,L)=>{w(Z),k(U),R(H),N(L)},[]),P=E.useMemo(()=>(m!=="all"?1:0)+Object.values(b).filter(Boolean).length+(x||S||C||A?1:0),[m,b,x,S,C,A]);return s?f.jsxs("div",{className:Je("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{value:d,onChange:Z=>h(Z.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsx(M6,{currentCapabilityFilters:b,onCapabilityFilterChange:B,currentEnabledFilter:m,onEnabledFilterChange:D,currentMinInputPrice:x,currentMaxInputPrice:S,currentMinOutputPrice:C,currentMaxOutputPrice:A,onPriceFilterChange:W,showStatusFilter:!0,showCapabilityFilters:!0,showPriceFilters:!0,disabled:i,totalActiveFilters:P})]}),f.jsxs(Hl,{className:Je("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${O.getTotalSize()}px`,width:"100%",position:"relative"},children:I.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):O.getVirtualItems().map(Z=>{const U=I[Z.index];return U?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${Z.size}px`,transform:`translateY(${Z.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(Mo,{id:`enable-model-${e}-${U.id}`,checked:n.has(U.id),onCheckedChange:H=>r(U.id,H),disabled:i,"aria-label":`Enable model ${U.name||U.id}`,className:"flex-shrink-0",onClick:H=>H.stopPropagation()}),f.jsx(jt,{htmlFor:`enable-model-${e}-${U.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:U.name||U.id,onClick:o?()=>o(U.id):void 0,children:U.name||U.id})]},U.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},r$e=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=E.useState(!1);return E.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(ol,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(ll,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(fE,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(cl,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx(FP,{className:"h-4 w-4"})})]}),!c&&f.jsx(Ld,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(TPe,{children:c&&f.jsx(fu.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs(ul,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},s$e=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Nr(gn(se=>({apiKeys:se.dbApiKeys,addApiKey:se.addApiKey,providers:se.dbProviderConfigs,addProviderConfig:se.addProviderConfig,updateProviderConfig:se.updateProviderConfig,getAllAvailableModelDefsForProvider:se.getAllAvailableModelDefsForProvider,isLoading:se.isLoading,enableApiKeyManagement:se.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=Un(gn(se=>({addConversation:se.addConversation,selectItem:se.selectItem}))),[u,d]=E.useState(!1),[h,m]=E.useState(!1),[y,b]=E.useState(!1),[v,x]=E.useState(!1),[w,S]=E.useState(!1),k=E.useMemo(()=>!o||e.length>0,[o,e]),C=E.useMemo(()=>n.length>0,[n]),R=E.useMemo(()=>n.some(se=>se.isEnabled&&se.enabledModels&&se.enabledModels.length>0),[n]),A=E.useMemo(()=>{const se=[...n].sort((me,ce)=>ce.createdAt.getTime()-me.createdAt.getTime());return se.length>0?se[0]:null},[n]),N=E.useMemo(()=>A?i(A.id):[],[A,i]),I=E.useMemo(()=>new Set((A==null?void 0:A.enabledModels)??[]),[A]),{initialProviderTypeForForm:O,initialProviderNameForForm:B,initialApiKeyIdForForm:D}=E.useMemo(()=>{var se;if(C)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const ce=[...e].sort((je,De)=>De.createdAt.getTime()-je.createdAt.getTime()).find(je=>ty(je.providerId));if(ce){const je=ce.providerId,De=((se=wo.find(Se=>Se.value===je))==null?void 0:se.label)||je;return{initialProviderTypeForForm:je,initialProviderNameForForm:De,initialApiKeyIdForForm:ce.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,C]),W=E.useCallback(async(se,me,ce)=>{d(!0);try{await t(se,me,ce),Me.success("API key added successfully!")}finally{d(!1)}},[t]),P=E.useCallback(async se=>{m(!0);try{const me={...se,apiKeyId:se.apiKeyId??(ty(se.type)?D??null:null)},ce=await r(me);return Me.success("Provider added successfully!"),ce}finally{m(!1)}},[r,D]),Z=E.useCallback(async(se,me)=>{if(!A)return;x(!0);const ce=new Set(A.enabledModels??[]);me?ce.add(se):ce.delete(se);const je=Array.from(ce);try{await s(A.id,{enabledModels:je}),Me.success(me?"Model enabled successfully!":"Model disabled successfully!")}catch(De){Me.error("Failed to update model status."),console.error("Failed to save model toggle:",De)}finally{x(!1)}},[A,s]),U=E.useCallback(async()=>{b(!0),S(!0);try{await new Promise(me=>setTimeout(me,800));const se=await l({title:"New Chat"});await c(se,"conversation"),Me.success("Welcome to your first chat!")}catch(se){Me.error("Failed to start your first chat."),console.error("Failed to start first chat:",se),b(!1),S(!1)}},[l,c]),H=()=>{Pe.emit(Pr.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},L=[k,C,R].filter(Boolean).length,ne=o?3:2,V=L/ne*100,Q=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(kd,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(kd,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(kd,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(kd,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(kd,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(kd,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:k,content:f.jsx(pte,{onSave:W,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:O}),icon:f.jsx(qx,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:C,content:f.jsx(_te,{apiKeys:e,onAddProvider:P,onCancel:()=>{},initialType:O,initialName:B,initialApiKeyId:D}),icon:f.jsx(Z0,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(A==null?void 0:A.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:R,content:A?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx(I6,{providerId:A.id,allAvailableModels:N,enabledModelIds:I,onToggleModel:Z,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(Wl,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Ly,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(fu.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(_y,{value:y?void 0:100,className:"h-2"})}),f.jsxs(pt,{onClick:U,disabled:y||!R,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(Gme,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),f.jsx(OJ,{})]}),contentClassName:"p-4",icon:f.jsx(yge,{className:"h-4 w-4"})}],ee=Q.findIndex(se=>!se.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(fu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Wr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Wr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Wr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full mb-6"}),f.jsx(Wr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(fu.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(qLe,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(WLe,{})]}),f.jsxs(fu.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(_y,{value:V,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(V),"%"]})]})}),f.jsx(Sr,{children:f.jsxs("p",{children:["Steps completed: ",L," of ",ne]})})]})}),Q.map((se,me)=>{const ce=me===ee;return f.jsx(fu.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:me*.1,duration:.3},children:f.jsx(r$e,{stepNumber:me+1,title:se.title,description:se.description,isComplete:se.id!=="start-chat"&&se.isComplete,isActive:ce,openOnComplete:se.id==="enable-models",contentClassName:se.id==="add-provider"||se.id==="api-key"?"p-0 border-none shadow-none bg-transparent":se.contentClassName,icon:se.icon,children:se.content})},se.id)})]}),!a&&!C&&ee===-1&&f.jsxs(fu.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(Wl,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(pt,{variant:"outline",size:"sm",onClick:H,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},c2=["conversation.title_generation"],i$e=({conversationId:e,interactions:t,status:n,className:r})=>{const s=E.useRef(null),i=E.useRef(null),[a,o]=E.useState(!1),l=E.useRef(null),c=Ln(P=>P.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=mr(gn(P=>({chatMaxWidth:P.chatMaxWidth,autoScrollInterval:P.autoScrollInterval,enableAutoScrollOnStream:P.enableAutoScrollOnStream}))),m=mr(P=>P.setEnableAutoScrollOnStream),y=E.useMemo(()=>P=>({isLoading:P.isLoading}),[]),b=E.useMemo(()=>P=>({conversationCount:P.conversations.length,isConversationLoading:P.isLoading}),[]),{isLoading:v}=Nr(gn(y)),{conversationCount:x,isConversationLoading:w}=Un(gn(b)),{projectCount:S,isProjectLoading:k}=Fo(gn(P=>({projectCount:P.projects.length,isProjectLoading:P.isLoading}))),C=E.useMemo(()=>v||w||k?!1:x===0&&S===0,[x,S,v,w,k]),R=E.useMemo(()=>t.filter(U=>U.parentId===null&&!c2.includes(U.type)).sort((U,H)=>U.index-H.index).map(U=>{const H=t.filter(L=>L.parentId===U.id&&!c2.includes(L.type)).sort((L,ne)=>L.index-ne.index);return[U,...H]}),[t]),A=Ui(gn(P=>Object.values(P.canvasControls))),N=E.useCallback((P,Z,U,H)=>A.filter(ne=>{const V=ne.type===P,Q=ne.targetSlot===Z,ee=!!ne.renderer;return V&&Q&&ee}).map(ne=>{if(ne.renderer){const Q={...{interaction:U,interactionId:U==null?void 0:U.id,responseContent:typeof(U==null?void 0:U.response)=="string"?U.response:void 0,canvasContextType:P},...H};return f.jsx(Ve.Fragment,{children:ne.renderer(Q)},ne.id)}return null}).filter(Boolean),[A]),I=(P="smooth")=>{i.current&&i.current.scrollTo({top:i.current.scrollHeight,behavior:P})};E.useEffect(()=>{if(i.current){const{scrollHeight:P,clientHeight:Z,scrollTop:U}=i.current;(P-Z<=U+150||n!=="streaming")&&requestAnimationFrame(()=>{I(n==="streaming"?"smooth":"auto")})}},[R.length,n]),E.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{I("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),E.useEffect(()=>{const P=i.current;if(!P)return;const Z=()=>{if(!i.current)return;const{scrollHeight:U,clientHeight:H,scrollTop:L}=i.current,ne=L<U-H-H*.5;o(ne)};return P.addEventListener("scroll",Z,{passive:!0}),Z(),()=>{i.current&&i.current.removeEventListener("scroll",Z)}},[]),E.useEffect(()=>{s.current&&(i.current=s.current.querySelector("[data-radix-scroll-area-viewport]"))},[]);const O=E.useMemo(()=>{const P=[];return[...t].sort((H,L)=>{var ne,V;return H.index!==L.index?H.index-L.index:H.parentId===null&&L.parentId!==null?-1:H.parentId!==null&&L.parentId===null?1:H.parentId!==null&&L.parentId!==null&&H.parentId===L.parentId?H.index-L.index:(((ne=H.startedAt)==null?void 0:ne.getTime())??0)-(((V=L.startedAt)==null?void 0:V.getTime())??0)}).filter(H=>H.parentId===null&&!c2.includes(H.type)).forEach(H=>{var Q,ee;let L=null;if(H.type==="message.user_assistant"&&H.prompt)L=H.prompt;else if(H.type==="message.assistant_regen"&&((Q=H.metadata)!=null&&Q.regeneratedFromId)){let se,me=H;const ce=new Set;for(;me&&!ce.has(me.id);){if(ce.add(me.id),me.type==="message.user_assistant"&&me.prompt){se=me;break}if((ee=me.metadata)!=null&&ee.regeneratedFromId)me=t.find(je=>je.id===me.metadata.regeneratedFromId);else break}se?L=se.prompt:H.prompt?L=H.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${H.id} of type ${H.type}. Displaying turn without prompt.`)}if(L)P.push(f.jsx(hT,{turnData:L,timestamp:H.startedAt,isAssistantComplete:H.status==="COMPLETED"||H.status==="ERROR"},`prompt-${H.id}`));else if(H.type!=="message.user_assistant"&&H.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",H.id,H.type);return}const ne=t.filter(se=>se.parentId===H.id&&!c2.includes(se.type)).sort((se,me)=>se.index-me.index),V=[H,...ne];V.length>0&&P.push(f.jsx(rPe,{interactionGroup:V,renderSlot:(se,me,ce)=>N("interaction",se,me,ce),activeStreamingInteractionId:c.find(se=>V.some(me=>me.id===se))},`tabs-${H.id}`))}),P},[t,N,c]),B=E.useMemo(()=>c.filter(P=>!t.some(Z=>Z.id===P)).map(P=>f.jsx(uk,{interactionId:P,renderSlot:(Z,U,H)=>N("interaction",Z,U,H)},`${P}-streaming-new`)),[c,t,N]),D=()=>v||w||k?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-32 w-full"}),f.jsx(Wr,{className:"h-20 w-full"})]}):e?R.length===0&&n!=="streaming"&&c.length===0?f.jsx(m7,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[O,B]}):f.jsx(m7,{}),W=u||"max-w-7xl";return f.jsx("div",{className:Je("flex-grow relative",r),children:C?f.jsx(Hl,{className:"h-full w-full",children:f.jsx("div",{className:Je("mx-auto w-full",W),children:f.jsx(s$e,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(Hl,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Je("mx-auto w-full",W),children:D()})}),a&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>I(),"aria-label":"Scroll to bottom",children:f.jsx(fH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>m(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(age,{className:"h-4 w-4"}):f.jsx(cge,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},a$e=Ve.memo(i$e),s0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Je(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(Ve.Fragment,{children:a?a():null},i.id)})})},Ww=Bo($o((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Pe.emit(Pr.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Pe.emit(Pr.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Pe.emit(Pr.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Pe.emit(Pr.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Pe.emit(Pr.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Pe.emit(Pr.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Pr.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Pr.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Pr.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Pr.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Pr.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Pr.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var o$e=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",v=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...v),l.classList.add(i&&i[m]?i[m]:m)):l.setAttribute(y,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let m=localStorage.getItem(t)||n,y=a&&m==="system"?h():m;u(y)}catch{}},l$e=E.createContext(void 0),c$e={setTheme:e=>{},themes:[]},u$e=()=>{var e;return(e=E.useContext(l$e))!=null?e:c$e};E.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return E.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${o$e.toString()})(${u})`}})});const d$e=({...e})=>{const{theme:t="system"}=u$e();return f.jsx(K0e,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Lo({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Je("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const dne=E.memo(E.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=E.useRef(null),[c,u]=E.useState(e);E.useImperativeHandle(o,()=>({getValue:()=>c,setValue:m=>{u(m),i&&i(m),Pe.emit(yn.inputChanged,{value:m}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},clearValue:()=>{u(""),i&&i(""),Pe.emit(yn.inputChanged,{value:""}),requestAnimationFrame(()=>{const m=l.current;m&&(m.style.height="auto",m.style.height=`${m.scrollHeight}px`,m.style.overflowY="hidden")})}}));const d=m=>{var y;if(m.key==="Enter"&&!m.shiftKey&&!n){m.preventDefault();const b=gh.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=m=>{const y=m.target.value;u(y),i&&i(y),Pe.emit(yn.inputChanged,{value:y})};return E.useEffect(()=>{const m=l.current;if(m){m.style.height="auto";const y=m.scrollHeight,b=250;m.style.height=`${Math.min(y,b)}px`,m.style.overflowY=y>b?"auto":"hidden"}},[c]),E.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),E.useEffect(()=>{const m=y=>{u(y.text),i&&i(y.text),Pe.emit(yn.inputChanged,{value:y.text}),requestAnimationFrame(()=>{const b=l.current;b&&(b.style.height="auto",b.style.height=`${b.scrollHeight}px`,b.style.overflowY=b.scrollHeight>250?"auto":"hidden")})};return Pe.on(yn.setInputTextRequest,m),()=>{Pe.off(yn.setInputTextRequest,m)}},[i]),f.jsx(Lo,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Je("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));dne.displayName="InputArea";const Ti={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},Mh=Bo($o((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await St.loadMods();e({dbMods:n,isLoading:!1}),Pe.emit(Ti.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Pe.emit(Ti.loadingStateChanged,{isLoading:!1,error:r}),Me.error(r)}},addDbMod:async n=>{const r=ws(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await St.saveMod(s),Me.success(`Mod "${s.name}" added.`),Pe.emit(Ti.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Pe.emit(Ti.loadingStateChanged,{isLoading:t().isLoading,error:a}),Me.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await St.saveMod(a),Me.success(`Mod "${a.name}" updated.`),Pe.emit(Ti.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Pe.emit(Ti.loadingStateChanged,{isLoading:t().isLoading,error:l}),Me.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await St.deleteMod(n),Me.success(`Mod "${s}" deleted.`),Pe.emit(Ti.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Pe.emit(Ti.loadingStateChanged,{isLoading:t().isLoading,error:a}),Me.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Pe.emit(Ti.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Pe.emit(Ti.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Pe.emit(Ti.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Ti.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:Ti.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:Ti.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:Ti.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),ip={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function C4(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Pe.emit($r.registerPromptControlRequest,{control:s}),()=>Pe.emit($r.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Pe.emit($r.registerChatControlRequest,{control:i}),()=>Pe.emit($r.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Pe.emit($r.registerCanvasControlRequest,{control:s}),()=>Pe.emit($r.unregisterCanvasControlRequest,{id:s.id})),registerBlockRenderer:s=>(Pe.emit(p0.registerBlockRendererRequest,{renderer:s}),()=>Pe.emit(p0.unregisterBlockRendererRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Pe.emit($r.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Pe.emit($r.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Pe.on(s,i),()=>Pe.off(s,i)),emit:(s,i)=>{Pe.emit(s,i)},addMiddleware:(s,i)=>(Pe.emit($r.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Pe.emit($r.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(Mh.getState()._addSettingsTab(s),()=>Mh.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=Ln.getState(),i=Un.getState(),a=mr.getState(),o=Nr.getState(),{providerId:l}=_c(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{Me[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Pe.emit($r.registerModalProviderRequest,{modalId:s,provider:i}),()=>Pe.emit($r.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>Qs.getState().initializeVFS(s,{force:!0})}}async function f$e(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=C4(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),Me.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=C4(r));const o={id:r.id,name:r.name,api:i,error:a};return Pe.emit(o.error?Ti.modError:Ti.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Pe.emit(ip.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const br={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},uq=null;class h$e{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return uq!==null}static getBundledConfig(){return uq}}class Hw{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){Me.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=Un.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Pe.emit(us.bulkSyncStarted,{progress:a}),Me.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;Pe.emit(us.bulkSyncCompleted,{progress:a,success:!o}),o?(Me.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):Me.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),Me.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Pe.emit(us.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=Un.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){Me.info("No conversations need syncing");return}Me.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=Un.getState().syncRepos;if(n.length===0){Me.info("No repositories configured");return}Me.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),Me.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",Pe.emit(us.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Pe.emit(us.bulkSyncProgress,{progress:r}),await Un.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Pe.emit(us.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",Pe.emit(us.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Pe.emit(us.bulkSyncProgress,{progress:r}),await Un.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Pe.emit(us.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}de(Hw,"isRunning",!1),de(Hw,"abortController",null);const O0=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:Hw},Symbol.toStringTag,{value:"Module"}));class fne{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=Un.getState(),n=mr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await Hw.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await Hw.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}de(fne,"hasRunStartupSync",!1);function p$e(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),Me.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),Me.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function m$e(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await h$e.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(sn.loadSettingsRequest,void 0),t.emit(fr.loadInitialDataRequest,void 0),t.emit(br.loadRulesAndTagsRequest,void 0),t.emit(Zn.loadConversationsRequest,void 0),t.emit(xa.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(sn.loaded,()=>{r=!0,c(),l()}),u=t.on(fr.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(br.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(Zn.conversationsLoaded,()=>{a=!0,h(),l()}),m=t.on(xa.loaded,()=>{o=!0,m(),l()})}),Pe.emit(ip.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{fne.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function g$e(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=p$e(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),Me.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Pe.emit(ip.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function y$e(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),Me.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Pe.emit(ip.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function b$e(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(Ti.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(Ti.dbModsLoaded,()=>{i(),s()})});const n=Mh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await f$e(n);Mh.getState().setLoadedMods(r),Pe.emit(ip.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function v$e(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(yn.initializePromptStateRequest,{effectiveSettings:i}),Pe.emit(ip.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function x$e(e,t){console.log("[Init] LiteChat Full Initialization START"),fm.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(sn.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(fr.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(br.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(Zn.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(xa.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(Ti.loadDbModsRequest,void 0),setLoadedMods:Mh.getState().setLoadedMods,getConversationById:Un.getState().getConversationById,getEffectiveProjectSettings:Fo.getState().getEffectiveProjectSettings,initializePromptState:Po.getState().initializePromptState,selectedItemId:Un.getState().selectedItemId,selectedItemType:Un.getState().selectedItemType};let r=[];try{await m$e(n,t),r=await g$e(e,t),y$e(r,t),await b$e(n,t),v$e(n,t),Pe.emit(ip.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),Me.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),Ww.getState().setGlobalError("Initialization sequence failed."),s}return r}const hne=Bo($o((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([St.loadRules(),St.loadTags(),St.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Pe.emit(br.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),Me.error("Failed to load rules and tags."),Pe.emit(br.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=ws(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await St.saveRule(i),Me.success(`Rule "${i.name}" added.`),Pe.emit(br.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),Me.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw Me.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await St.saveRule(i),Me.success(`Rule "${i.name}" updated.`),Pe.emit(br.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),Me.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw Me.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await St.deleteRule(n),Me.success(`Rule "${r.name}" deleted.`),Pe.emit(br.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),Me.error("Failed to delete rule."),a}},addTag:async n=>{const r=ws(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await St.saveTag(i),Me.success(`Tag "${i.name}" added.`),Pe.emit(br.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),Me.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw Me.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await St.saveTag(i),Me.success(`Tag "${i.name}" updated.`),Pe.emit(br.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),Me.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw Me.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await St.deleteTag(n),Me.success(`Tag "${r.name}" deleted.`),Pe.emit(br.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),Me.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){Me.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await St.saveTagRuleLink(i),Me.success("Tag linked to rule."),br.linkSaved&&Pe.emit(br.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),Me.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||Me.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await St.deleteTagRuleLink(s),Me.success("Tag unlinked from rule."),br.linkDeleted&&Pe.emit(br.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Pe.emit(br.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),Me.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:br.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:br.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:br.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:br.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:br.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:br.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:br.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:br.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:br.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),Xa={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"},Rm=Bo($o((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await St.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),Pe.emit(Xa.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),Me.error(r)}},addPromptTemplate:async n=>{const r={id:ws(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await St.savePromptTemplate(r),Pe.emit(Xa.promptTemplateAdded,{promptTemplate:r}),Me.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),Me.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){Me.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await St.savePromptTemplate(i),Pe.emit(Xa.promptTemplateUpdated,{promptTemplate:i}),Me.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),Me.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){Me.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await St.deletePromptTemplate(n),Pe.emit(Xa.promptTemplateDeleted,{id:n}),Me.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),Me.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{let i=s.prompt;for(const o of s.variables){const l=r[o.name],c=[new RegExp(`{{\\s*${o.name}\\s*}}`,"g"),new RegExp(`{{${o.name}}}`,"g"),new RegExp(`{{ ${o.name} }}`,"g")];if(l!=null){let u;typeof l=="object"?u=JSON.stringify(l):u=String(l);for(const d of c){const h=i;i=i.replace(d,u),h!==i&&console.log(`Replaced "${o.name}" using pattern ${d} in:`,h,"",i)}}else{if(o.required)throw new Error(`Required variable "${o.name}" is missing`);if(o.default)for(const u of c)i=i.replace(u,o.default)}}return{content:i,selectedTools:s.tools,selectedRules:s.rules}}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw Me.error(a),i}},getTemplatesByType:n=>t().promptTemplates.filter(r=>(r.type||"prompt")===n),getAgents:()=>t().promptTemplates.filter(n=>(n.type||"prompt")==="agent"),getTasksForAgent:n=>t().promptTemplates.filter(r=>(r.type||"prompt")==="task"&&r.parentId===n),getAvailableFollowUps:(n,r)=>{const s=t().promptTemplates,i=s.find(a=>a.id===n);return r==="task"&&(i!=null&&i.parentId)?s.filter(a=>(a.type||"prompt")==="task"&&a.parentId===i.parentId&&a.id!==n):s.filter(a=>(a.type||"prompt")==="prompt"&&a.id!==n)},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Xa.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:Xa.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:Xa.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:Xa.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:Xa.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),kr={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},ax=3,ox=2e3,lx=1e4,cx=128e3,w$e={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:ax,retryDelay:ox,connectionTimeout:lx,maxResponseSize:cx,bridgeConfig:{}},nl=Bo($o((e,t)=>({...w$e,setServers:n=>{e(r=>{r.servers=n,r.error=null}),St.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),Pe.emit(kr.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;St.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),Pe.emit(kr.serverAdded,{server:r}),Pe.emit(kr.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;St.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),Pe.emit(kr.serverUpdated,{server:s}),Pe.emit(kr.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;St.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),Pe.emit(kr.serverDeleted,{serverId:n}),Pe.emit(kr.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),Pe.emit(kr.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&Pe.emit(kr.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),Pe.emit(kr.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),St.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),Pe.emit(kr.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),St.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),Pe.emit(kr.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),St.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),Pe.emit(kr.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),St.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),Pe.emit(kr.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),St.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),Pe.emit(kr.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([St.loadSetting("mcpServers",[]),St.loadSetting("mcpRetryAttempts",ax),St.loadSetting("mcpRetryDelay",ox),St.loadSetting("mcpConnectionTimeout",lx),St.loadSetting("mcpMaxResponseSize",cx),St.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),Pe.emit(kr.serversChanged,{servers:n||[]}),Pe.emit(kr.retryAttemptsChanged,{attempts:r}),Pe.emit(kr.retryDelayChanged,{delay:s}),Pe.emit(kr.connectionTimeoutChanged,{timeout:i}),Pe.emit(kr.maxResponseSizeChanged,{size:a}),Pe.emit(kr.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=ax,n.retryDelay=ox,n.connectionTimeout=lx,n.maxResponseSize=cx,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([St.saveSetting("mcpServers",[]),St.saveSetting("mcpRetryAttempts",ax),St.saveSetting("mcpRetryDelay",ox),St.saveSetting("mcpConnectionTimeout",lx),St.saveSetting("mcpMaxResponseSize",cx)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),Pe.emit(kr.serversChanged,{servers:[]}),Pe.emit(kr.retryAttemptsChanged,{attempts:ax}),Pe.emit(kr.retryDelayChanged,{delay:ox}),Pe.emit(kr.connectionTimeoutChanged,{timeout:lx}),Pe.emit(kr.maxResponseSizeChanged,{size:cx})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:kr.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:kr.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:kr.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:kr.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:kr.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:kr.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:kr.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:kr.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:kr.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:kr.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),_$e=[mr,Nr,hne,Un,Fo,Ln,gh,Po,Mh,Ww,Qs,Ui,Rm,nl];class pne{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];_$e.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Pe.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}de(pne,"isInitialized",!1);const S$e=()=>{const[e,t]=E.useState({}),n=Ui(r=>r.modalProviders);return E.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Pe.emit(Pr.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Pe.emit(Pr.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Pe.on(Pr.openModalRequest,r),Pe.on(Pr.closeModalRequest,s),()=>{Pe.off(Pr.openModalRequest,r),Pe.off(Pr.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Pe.emit(Pr.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})};let dq=[],fq=null,md=!1;const C$e=({controls:e=[]})=>{const[t,n]=E.useState(!0),[r,s]=E.useState(!1),i=E.useRef(null),a=E.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=Un(gn(I=>({selectedItemId:I.selectedItemId,selectedItemType:I.selectedItemType,getConversationById:I.getConversationById}))),{getEffectiveProjectSettings:u}=Fo(gn(I=>({getEffectiveProjectSettings:I.getEffectiveProjectSettings}))),{interactions:d,status:h}=Ln(gn(I=>({interactions:I.interactions,status:I.status}))),{globalError:m,isSidebarCollapsed:y,isChatControlPanelOpen:b}=Ww(gn(I=>({globalError:I.globalError,isSidebarCollapsed:I.isSidebarCollapsed,isChatControlPanelOpen:I.isChatControlPanelOpen}))),v=Ui(gn(I=>Object.values(I.chatControls))),x=E.useMemo(()=>v.filter(I=>(I.panel??"main")==="sidebar"&&(I.show?I.show():!0)),[v]),w=E.useMemo(()=>v.filter(I=>I.panel==="sidebar-footer"&&(I.show?I.show():!0)),[v]),S=E.useMemo(()=>v.filter(I=>I.panel==="header"&&(I.show?I.show():!0)),[v]),k=E.useCallback(()=>{s(I=>!I)},[]);E.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),E.useEffect(()=>{a.current||(a.current=C4({id:"core-litechat-app",name:"LiteChat App Core"}));const I=a.current;pne.initialize(),fq||(fq=(async()=>{if(md){n(!1);return}n(!0);try{dq=await x$e(e,I),md=!0}catch(B){console.error("[LiteChat] App: Top-level initialization error:",B),md=!1}finally{n(!1)}})().then(()=>dq))},[e]);const C=E.useRef({itemId:null,itemType:null,effectiveSettingsString:""});E.useEffect(()=>{if(t||!md||!a.current)return;const I=a.current,O={itemId:o,itemType:l};let B=null;if(l==="project")B=o;else if(l==="conversation"&&o){const P=c(o);B=(P==null?void 0:P.projectId)??null}const D=u(B),W=JSON.stringify(D);(O.itemId!==C.current.itemId||O.itemType!==C.current.itemType||W!==C.current.effectiveSettingsString)&&(I.emit(yn.initializePromptStateRequest,{effectiveSettings:D}),I.emit(Pr.contextChanged,{selectedItemId:o,selectedItemType:l}),C.current={...O,effectiveSettingsString:W})},[o,l,c,u,t,md]),E.useEffect(()=>{if(t||!md||!a.current)return;const I=a.current,O=()=>{let Z=null;if(l==="project")Z=o;else if(l==="conversation"&&o){const H=c(o);Z=(H==null?void 0:H.projectId)??null}const U=u(Z);I.emit(yn.initializePromptStateRequest,{effectiveSettings:U})},B=I.on(sn.loaded,O),D=I.on(xa.updated,O),W=I.on(sn.globalSystemPromptChanged,O),P=I.on(sn.temperatureChanged,O);return()=>{B(),D(),W(),P()}},[o,l,c,u,t,md]),E.useEffect(()=>{if(t||!md||!a.current)return;const I=a.current;let O=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")O=o;else if(l==="conversation"){const W=c(o);O=(W==null?void 0:W.projectId)??"orphan"}else O="orphan";else if(l==="conversation"){const W=c(o);O=(W==null?void 0:W.projectId)??"orphan"}let D=null;typeof O=="string"?D=O:O===null?D=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof O}, Value:`,O,"Defaulting to 'orphan'."),D="orphan"),Qs.getState().vfsKey!==D&&I.emit(dn.setVfsKeyRequest,{key:D})},[o,l,c,t,md,b]);const R=async I=>{const O=Un.getState(),B=await O.addConversation(I);return console.log("New conversation ID:",B),await O.selectItem(B,"conversation"),console.log("conv selected:",B),B},A=E.useCallback(async I=>{var W;if(!a.current){Me.error("Application core not ready. Please try again.");return}const O=Un.getState();let B=O.selectedItemType==="conversation"?O.selectedItemId:null;const D=O.selectedItemType==="project"?O.selectedItemId:O.selectedItemType==="conversation"?((W=O.getConversationById(O.selectedItemId))==null?void 0:W.projectId)??null:null;if(!B)try{B=await R({title:"New Chat",projectId:D}),console.log("New conversation ID 2:",B)}catch(P){console.error("[LiteChat] App: Failed to create new conversation",P),Me.error("Failed to start new chat.");return}try{const P=Po.getState(),Z={...I,metadata:{...I.metadata,modelId:P.modelId}};await Cx.submitPrompt(Z)}catch(P){console.error("[LiteChat] App: Error submitting prompt:",P),Me.error("Failed to send message.")}},[]),N=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Yn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(S$e,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Je("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Je(y?"hidden":"block"),children:f.jsx(s0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Je(y?"block":"hidden"),children:f.jsx(s0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Je("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(s0,{controls:w,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:Je("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-40 flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:k}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-10 flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:k,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(Wi,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(s0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(s0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Je("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:k,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(Wi,{className:"h-6 w-6"}):f.jsx(Wme,{className:"h-6 w-6"})}),f.jsx(s0,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(a$e,{conversationId:N,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),m&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",m]}),f.jsx(mxe,{InputAreaRenderer:dne,onSubmit:A,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(d$e,{richColors:!0,position:"bottom-right",closeButton:!0})]})},k$e="prism-theme-link",E$e="prism-default-light-theme-link",T$e="prism-default-dark-theme-link",A$e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",R$e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",t3=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},N$e=()=>{const{prismThemeUrl:e,theme:t}=mr(gn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=E.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=E.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return E.useEffect(()=>{if(typeof window>"u")return;const s=t3(E$e),i=t3(T$e),a=t3(k$e);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=A$e,i.href=R$e,e?(a.href=e,a.disabled=!1):r==="dark"?i.disabled=!1:s.disabled=!1,()=>{}},[e,r]),null},n3=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),r3=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],M$e=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=mr(gn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return E.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),r3.forEach(a=>{i.style.removeProperty(`--${n3(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&r3.includes(a)){const l=`--${n3(a)}`;i.style.setProperty(l,o)}else if(r3.includes(a)){const l=`--${n3(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},I$e=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},hq="0.1.0-dev",pq="https://github.com/DimitriGilbert/LiteChat",mq=({textToCopy:e,label:t,className:n})=>{const[r,s]=E.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),Me.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){Me.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(pt,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(so,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(Xpe,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class j$e extends E.Component{constructor(){super(...arguments);de(this,"state",{hasError:!1,error:null,errorInfo:null});de(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),Me.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${pq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){Me.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${pq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${hq}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${hq}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(I$e,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(pt,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(mq,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(mq,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(pt,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(pE,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const mne=(e,t)=>{if(!t)return null;let n=Tc,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Yn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=Wl,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=UP,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=fE,r="text-green-500",s=`Synced with ${t}`;break;default:n=Tc,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(n,{className:Je("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Sr,{side:"right",children:s})]})})},gne=E.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:m,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const S=e.id===n,k=e.itemType==="project",C=e.id===h&&e.itemType===m,[R,A]=E.useState(k?e.name:e.title),N=E.useRef(null);E.useEffect(()=>{if(C){const ce=k?e.name:e.title;A(ce),requestAnimationFrame(()=>{var je,De;(je=N.current)==null||je.focus(),(De=N.current)==null||De.select()})}},[C,e,k]),E.useEffect(()=>{if(!C){const ce=k?e.name:e.title;R!==ce&&A(ce)}},[k?e.name:e.title,C,R,k]);const I=k&&u.has(e.id),O=k,B=!k&&e.syncRepoId?r[e.id]:void 0,D=!k&&e.syncRepoId?s.get(e.syncRepoId):void 0,W=!k&&D?mne(B,D):null,P=ce=>{ce.stopPropagation(),Pe.emit(Pr.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},Z=()=>{C||(k&&d(e.id),i(e.id,e.itemType))},U=ce=>{ce.stopPropagation(),k?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,ce):a(e.id,ce)},H=ce=>{ce.stopPropagation(),y(e)},L=()=>{A(w),v(e.itemType==="project"&&w==="New Project")},ne=async()=>{if(x)return;const ce=R.trim();await b(e.id,e.itemType,ce)},V=()=>{var De;if(x)return;const ce=R.trim(),je=e.itemType==="project"&&w==="New Project";if(!ce){w!=="New Project"?(Me.error("Name cannot be empty."),A(w),(De=N.current)==null||De.focus()):L();return}ce!==w||je?ne():L()},Q=ce=>{ce.key==="Enter"?(ce.preventDefault(),ne()):ce.key==="Escape"&&(ce.preventDefault(),L())},ee=k?e.name:e.title,se=x?Yn:so,me=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Je("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!C&&"hover:bg-muted/50 hover:text-primary/80",S&&!C?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",C&&"bg-muted ring-1 ring-primary",!C&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:Z,title:C?"":ee,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[O&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:ce=>{ce.stopPropagation(),d(e.id)},children:I?f.jsx(Yl,{className:"h-3 w-3 text-muted-foreground"}):f.jsx(FP,{className:"h-3 w-3 text-muted-foreground"})}),!O&&f.jsx("span",{className:"w-3 flex-shrink-0"}),k?f.jsx(mh,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(Y3,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),C?f.jsx(Sn,{ref:N,value:R,onChange:ce=>A(ce.target.value),onKeyDown:Q,onBlur:V,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:ce=>ce.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:ee}),W]}),f.jsx("div",{className:Je("items-center flex-shrink-0 ml-1",C?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:ce=>ce.stopPropagation(),children:C?f.jsxs(f.Fragment,{children:[f.jsx(er,{tooltipText:"Save (Enter)",onClick:ce=>{ce.stopPropagation(),ne()},disabled:x||!R.trim(),"aria-label":"Save changes",icon:f.jsx(se,{}),iconClassName:me,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(er,{tooltipText:"Cancel (Esc)",onClick:ce=>{ce.stopPropagation(),L()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(Wi,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[k&&f.jsx(er,{tooltipText:"Project Settings",onClick:P,"aria-label":`Settings for ${ee}`,icon:f.jsx(Gpe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(er,{tooltipText:"Edit",onClick:H,"aria-label":`Edit ${ee}`,icon:f.jsx(f1,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),k?f.jsx(er,{tooltipText:"Export Project (JSON)",onClick:ce=>c(e.id,ce),"aria-label":`Export project ${ee}`,icon:f.jsx(lme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs("div",{className:"relative group/export",children:[f.jsx(er,{tooltipText:"Export Conversation","aria-label":`Export ${ee}`,icon:f.jsx(wc,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),f.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:ce=>ce.stopPropagation(),children:[f.jsx(pt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ce=>l(e.id,"json",ce),children:"JSON"}),f.jsx(pt,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:ce=>l(e.id,"md",ce),children:"MD"})]})]}),f.jsx(er,{tooltipText:"Delete",onClick:U,"aria-label":`Delete ${ee}`,icon:f.jsx(Ao,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});gne.displayName="ConversationItemRenderer";function P$e({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(""),[c,u]=E.useState(!1),d=E.useCallback(y=>{s(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=E.useCallback(y=>{const b=r,v=y??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),Me.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),m=E.useCallback(async(y,b,v)=>{if(y!==r||b!==i||c)return;const x=v==null?void 0:v.trim();if(!x){Me.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:x}):await t(y,{title:x}),Me.success("Item renamed successfully."),s(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),Me.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:m,handleCancelEdit:h,originalNameToCompare:o}}const yne=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],m=a.get(e)||[];for(const y of m)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(yne(y.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},O$e=({module:e})=>{const t=E.useRef(null),n=E.useRef(null),[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!Un.getState().isLoading&&!Fo.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const ge=t.current;if(ge){const Ae=ge.querySelector("[data-radix-scroll-area-viewport]");if(Ae&&n.current!==Ae?(n.current=Ae,r||s(!0),i({})):!Ae&&n.current&&(n.current=null,s(!1)),!n.current){const le=new MutationObserver(()=>{const oe=ge.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),le.disconnect())});return le.observe(ge,{childList:!0,subtree:!0}),()=>le.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:m,deleteConversation:y,exportConversation:b,exportProject:v,getConversationById:x}=Un(gn(ge=>({selectedItemId:ge.selectedItemId,selectedItemType:ge.selectedItemType,conversations:ge.conversations,syncRepos:ge.syncRepos,conversationSyncStatus:ge.conversationSyncStatus,selectItem:ge.selectItem,addConversation:ge.addConversation,updateConversation:ge.updateConversation,deleteConversation:ge.deleteConversation,exportConversation:ge.exportConversation,exportProject:ge.exportProject,getConversationById:ge.getConversationById}))),{projects:w,addProject:S,updateProject:k,deleteProject:C,getProjectById:R}=Fo(gn(ge=>({projects:ge.projects,addProject:ge.addProject,updateProject:ge.updateProject,deleteProject:ge.deleteProject,getProjectById:ge.getProjectById}))),A=e.isLoading,[N,I]=Ve.useState(new Set),[O,B]=E.useState(""),D=P$e({updateProject:k,updateConversation:m,deleteProject:C}),{editingItemId:W,editingItemType:P,isSavingEdit:Z,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:L,originalNameToCompare:ne}=D,V=E.useCallback(ge=>{I(Ae=>{const le=new Set(Ae);return le.has(ge)?le.delete(ge):le.add(ge),le})},[]),Q=E.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const ge=x(a);return(ge==null?void 0:ge.projectId)??null}return null},[a,o,x]),ee=E.useCallback(async()=>{if(!W)try{const ge=Q(),Ae=await h({title:"New Chat",projectId:ge});d(Ae,"conversation")}catch(ge){console.error("Failed to create new chat:",ge),Me.error("Failed to create new chat.")}},[W,Q,h,d]),se=E.useCallback(async()=>{if(!W)try{const ge=Q(),Ae=await S({name:"New Project",parentId:ge});d(Ae,"project"),ge&&I(le=>new Set(le).add(ge)),setTimeout(()=>{const le=R(Ae);le&&U({...le,itemType:"project"})},50)}catch(ge){console.error("Failed to create new project:",ge)}},[W,Q,S,d,R,U]),me=E.useCallback((ge,Ae)=>{ge===W&&Ae===P||(W&&(ge!==W||Ae!==P)&&L(),(ge!==a||Ae!==o)&&d(ge,Ae))},[W,P,a,o,L,d]),ce=E.useCallback((ge,Ae)=>{Ae.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(ge).catch(le=>{console.error("Failed to delete conversation:",le),Me.error("Failed to delete conversation.")})},[y]),je=E.useCallback((ge,Ae)=>{Ae.stopPropagation(),C(ge).catch(le=>{console.error("Failed to delete project:",le),Me.error("Failed to delete project.")})},[C]),De=E.useCallback(async(ge,Ae,le)=>{le.stopPropagation();try{await b(ge,Ae)}catch(oe){console.error(`Failed to export conversation as ${Ae}:`,oe)}},[b]),Se=E.useCallback(async(ge,Ae)=>{Ae.stopPropagation();try{await v(ge)}catch(le){console.error("Failed to export project:",le)}},[v]),Ce=E.useMemo(()=>new Map((c||[]).map(ge=>[ge.id,ge.name])),[c]),{projectsById:qe,conversationsByProjectId:Qe,projectsByParentId:We}=E.useMemo(()=>{const ge=new Map(w.map(oe=>[oe.id,oe])),Ae=new Map;l.forEach(oe=>{const re=oe.projectId??null;Ae.has(re)||Ae.set(re,[]),Ae.get(re).push(oe)});const le=new Map;return w.forEach(oe=>{const re=oe.parentId??null;le.has(re)||le.set(re,[]),le.get(re).push(oe)}),{projectsById:ge,conversationsByProjectId:Ae,projectsByParentId:le}},[w,l]),Ne=E.useMemo(()=>{const ge=[],Ae=O.toLowerCase(),le={};function oe(re,Te){const Be=(We.get(re)||[]).filter(Rt=>yne(Rt.id,"project",Ae,w,l,qe,Qe,We,le)),ke=(Qe.get(re)||[]).filter(Rt=>Rt.title.toLowerCase().includes(Ae)),lt=[...Be,...ke];lt.sort((Rt,ft)=>new Date(ft.updatedAt).getTime()-new Date(Rt.updatedAt).getTime()),lt.forEach(Rt=>{"path"in Rt?(ge.push({id:`project-${Rt.id}`,originalId:Rt.id,type:"project",level:Te,data:Rt,updatedAt:Rt.updatedAt}),N.has(Rt.id)&&oe(Rt.id,Te+1)):ge.push({id:`conversation-${Rt.id}`,originalId:Rt.id,type:"conversation",level:Te,data:Rt,updatedAt:Rt.updatedAt})})}return oe(null,0),ge},[w,l,O,N,qe,Qe,We]),K=k6({count:Ne.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(kd,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(pt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Ame,{className:"h-4 w-4"})})}),f.jsx(kd,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(pt,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(wc,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{size:"sm",variant:"ghost",onClick:se,"aria-label":"New Project",disabled:A||!!W,className:"h-7 w-7 p-0",children:f.jsx(mH,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Project"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:A||!!W,className:"h-7 w-7 p-0",children:f.jsx(Ru,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(jo,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter...",value:O,onChange:ge=>B(ge.target.value),className:"h-8 text-xs pl-8",disabled:A})]}),f.jsxs(Hl,{className:"flex-grow",ref:t,children:[A&&Ne.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!A&&Ne.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:O.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${K.getTotalSize()}px`,width:"100%",position:"relative"},children:K.getVirtualItems().map(ge=>{const Ae=Ne[ge.index];if(!Ae)return null;const le={...Ae.data,itemType:Ae.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${ge.size}px`,transform:`translateY(${ge.start}px)`},className:"px-1",children:f.jsx(gne,{item:le,level:Ae.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ce,onSelectItem:()=>me(Ae.originalId,Ae.type),onDeleteConversation:ce,onDeleteProject:je,onExportConversation:De,onExportProject:Se,expandedProjects:N,toggleProjectExpansion:V,editingItemId:W,editingItemType:P,handleStartEditing:U,handleSaveEdit:H,handleCancelEdit:L,isSavingEdit:Z,originalNameToCompare:ne})},Ae.id)})}),!r&&!A&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},D$e=({module:e})=>{const{selectedItemType:t}=Un(gn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Yn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(mh,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(CB,{className:"h-5 w-5 text-primary"}):f.jsx(CB,{className:"h-5 w-5 text-muted-foreground"})};class F$e{constructor(){de(this,"id","core-conversation-list");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"isLoading",!0);de(this,"conversationsLoading",!0);de(this,"projectsLoading",!0);de(this,"notifyComponentUpdate",null);de(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=Un.getState().isLoading,this.projectsLoading=Fo.getState().isLoading,this.updateCombinedLoadingState(),t.emit(Zn.loadConversationsRequest,void 0),t.emit(xa.loadProjectsRequest,void 0);const n=t.on(Zn.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(xa.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(Zn.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(xa.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>Ve.createElement(O$e,{module:this}),iconRenderer:()=>Ve.createElement(D$e,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const gq=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(iC,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Settings"})]})})};var s3="focusScope.autoFocusOnMount",i3="focusScope.autoFocusOnUnmount",yq={bubbles:!1,cancelable:!0},L$e="FocusScope",j6=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=Nn(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:th(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||th(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&th(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){vq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(s3,yq);o.addEventListener(s3,c),o.dispatchEvent(x),x.defaultPrevented||(B$e(V$e(bne(o)),{select:!0}),document.activeElement===b&&th(o))}return()=>{o.removeEventListener(s3,c),setTimeout(()=>{const x=new CustomEvent(i3,yq);o.addEventListener(i3,u),o.dispatchEvent(x),x.defaultPrevented||th(b??document.body,{select:!0}),o.removeEventListener(i3,u),vq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=$$e(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&th(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&th(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(or.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});j6.displayName=L$e;function B$e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(th(r,{select:t}),document.activeElement!==n)return}function $$e(e){const t=bne(e),n=bq(t,e),r=bq(t.reverse(),e);return[n,r]}function bne(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function bq(e,t){for(const n of e)if(!z$e(n,{upTo:t}))return n}function z$e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function U$e(e){return e instanceof HTMLInputElement&&"select"in e}function th(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&U$e(e)&&t&&e.select()}}var vq=q$e();function q$e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=xq(e,t),e.unshift(t)},remove(t){var n;e=xq(e,t),(n=e[0])==null||n.resume()}}}function xq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function V$e(e){return e.filter(t=>t.tagName!=="A")}function W$e(e){const t=H$e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(K$e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function H$e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Z$e(s),o=Y$e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?fl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var G$e=Symbol("radix.slottable");function K$e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===G$e}function Y$e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Z$e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var PT="Dialog",[vne,mdt]=Gi(PT),[X$e,Uc]=vne(PT),xne=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=E.useRef(null),l=E.useRef(null),[c,u]=Mc({prop:r,defaultProp:s??!1,onChange:i,caller:PT});return f.jsx(X$e,{scope:t,triggerRef:o,contentRef:l,contentId:oa(),titleId:oa(),descriptionId:oa(),open:c,onOpenChange:u,onOpenToggle:E.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};xne.displayName=PT;var wne="DialogTrigger",J$e=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(wne,n),i=Nn(t,s.triggerRef);return f.jsx(or.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":D6(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});J$e.displayName=wne;var P6="DialogPortal",[Q$e,_ne]=vne(P6,{forceMount:void 0}),Sne=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=Uc(P6,t);return f.jsx(Q$e,{scope:t,forceMount:n,children:E.Children.map(r,a=>f.jsx(ca,{present:n||i.open,children:f.jsx(IE,{asChild:!0,container:s,children:a})}))})};Sne.displayName=P6;var Sk="DialogOverlay",Cne=E.forwardRef((e,t)=>{const n=_ne(Sk,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Uc(Sk,e.__scopeDialog);return i.modal?f.jsx(ca,{present:r||i.open,children:f.jsx(t9e,{...s,ref:t})}):null});Cne.displayName=Sk;var e9e=W$e("DialogOverlay.RemoveScroll"),t9e=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(Sk,n);return f.jsx(X1,{as:e9e,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(or.div,{"data-state":D6(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Nm="DialogContent",kne=E.forwardRef((e,t)=>{const n=_ne(Nm,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Uc(Nm,e.__scopeDialog);return f.jsx(ca,{present:r||i.open,children:i.modal?f.jsx(n9e,{...s,ref:t}):f.jsx(r9e,{...s,ref:t})})});kne.displayName=Nm;var n9e=E.forwardRef((e,t)=>{const n=Uc(Nm,e.__scopeDialog),r=E.useRef(null),s=Nn(t,n.contentRef,r);return E.useEffect(()=>{const i=r.current;if(i)return ET(i)},[]),f.jsx(Ene,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),r9e=E.forwardRef((e,t)=>{const n=Uc(Nm,e.__scopeDialog),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(Ene,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Ene=E.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=Uc(Nm,n),l=E.useRef(null),c=Nn(t,l);return CT(),f.jsxs(f.Fragment,{children:[f.jsx(j6,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(TE,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":D6(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(s9e,{titleId:o.titleId}),f.jsx(a9e,{contentRef:l,descriptionId:o.descriptionId})]})]})}),O6="DialogTitle",Tne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(O6,n);return f.jsx(or.h2,{id:s.titleId,...r,ref:t})});Tne.displayName=O6;var Ane="DialogDescription",Rne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(Ane,n);return f.jsx(or.p,{id:s.descriptionId,...r,ref:t})});Rne.displayName=Ane;var Nne="DialogClose",Mne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Uc(Nne,n);return f.jsx(or.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});Mne.displayName=Nne;function D6(e){return e?"open":"closed"}var Ine="DialogTitleWarning",[gdt,jne]=gxe(Ine,{contentName:Nm,titleName:O6,docsSlug:"dialog"}),s9e=({titleId:e})=>{const t=jne(Ine),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return E.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},i9e="DialogDescriptionWarning",a9e=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${jne(i9e).contentName}}.`;return E.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Pne=xne,One=Sne,Dne=Cne,Fne=kne,o9e=Tne,l9e=Rne,Lne=Mne;function ap({...e}){return f.jsx(Pne,{"data-slot":"dialog",...e})}function c9e({...e}){return f.jsx(One,{"data-slot":"dialog-portal",...e})}function u9e({...e}){return f.jsx(Lne,{"data-slot":"dialog-close",...e})}function d9e({className:e,...t}){return f.jsx(Dne,{"data-slot":"dialog-overlay",className:Je("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function op({className:e,children:t,...n}){return f.jsxs(c9e,{"data-slot":"dialog-portal",children:[f.jsx(d9e,{}),f.jsxs(Fne,{"data-slot":"dialog-content",className:Je("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs(Lne,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(Wi,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function lp({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Je("flex flex-col gap-2 text-center sm:text-left",e),...t})}function fb({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Je("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function cp({className:e,...t}){return f.jsx(o9e,{"data-slot":"dialog-title",className:Je("text-lg leading-none font-semibold",e),...t})}function Xm({className:e,...t}){return f.jsx(l9e,{"data-slot":"dialog-description",className:Je("text-muted-foreground text-sm",e),...t})}function wq(e){const t=f9e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(p9e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function f9e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=g9e(s),o=m9e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?fl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var h9e=Symbol("radix.slottable");function p9e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===h9e}function m9e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function g9e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function F6(e){const t=e+"CollectionProvider",[n,r]=Gi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),S=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=wq(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),k=Nn(v,S.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=wq(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,k=Ve.useRef(null),C=Nn(v,k),R=i(u,x);return Ve.useEffect(()=>(R.itemMap.set(k,{ref:k,...S}),()=>void R.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((R,A)=>S.indexOf(R.ref.current)-S.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var a3="rovingFocusGroup.onEntryFocus",y9e={bubbles:!1,cancelable:!0},Q1="RovingFocusGroup",[k4,Bne,b9e]=F6(Q1),[v9e,OT]=Gi(Q1,[b9e]),[x9e,w9e]=v9e(Q1),$ne=E.forwardRef((e,t)=>f.jsx(k4.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(k4.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(_9e,{...e,ref:t})})}));$ne.displayName=Q1;var _9e=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=E.useRef(null),m=Nn(t,h),y=ob(i),[b,v]=Mc({prop:a,defaultProp:o??null,onChange:l,caller:Q1}),[x,w]=E.useState(!1),S=Es(c),k=Bne(n),C=E.useRef(!1),[R,A]=E.useState(0);return E.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(a3,S),()=>N.removeEventListener(a3,S)},[S]),f.jsx(x9e,{scope:n,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:E.useCallback(N=>v(N),[v]),onItemShiftTab:E.useCallback(()=>w(!0),[]),onFocusableItemAdd:E.useCallback(()=>A(N=>N+1),[]),onFocusableItemRemove:E.useCallback(()=>A(N=>N-1),[]),children:f.jsx(or.div,{tabIndex:x||R===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{C.current=!0}),onFocus:Wt(e.onFocus,N=>{const I=!C.current;if(N.target===N.currentTarget&&I&&!x){const O=new CustomEvent(a3,y9e);if(N.currentTarget.dispatchEvent(O),!O.defaultPrevented){const B=k().filter(U=>U.focusable),D=B.find(U=>U.active),W=B.find(U=>U.id===b),Z=[D,W,...B].filter(Boolean).map(U=>U.ref.current);qne(Z,u)}}C.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),zne="RovingFocusGroupItem",Une=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=oa(),c=i||l,u=w9e(zne,n),d=u.currentTabStopId===c,h=Bne(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=u;return E.useEffect(()=>{if(r)return m(),()=>y()},[r,m,y]),f.jsx(k4.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(or.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=k9e(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(k=>k.focusable).map(k=>k.ref.current);if(x==="last")S.reverse();else if(x==="prev"||x==="next"){x==="prev"&&S.reverse();const k=S.indexOf(v.currentTarget);S=u.loop?E9e(S,k+1):S.slice(k+1)}setTimeout(()=>qne(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});Une.displayName=zne;var S9e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function C9e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function k9e(e,t,n){const r=C9e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return S9e[r]}function qne(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function E9e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Vne=$ne,Wne=Une,DT="Tabs",[T9e,ydt]=Gi(DT,[OT]),Hne=OT(),[A9e,L6]=T9e(DT),Gne=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=ob(o),[d,h]=Mc({prop:r,onChange:s,defaultProp:i??"",caller:DT});return f.jsx(A9e,{scope:n,baseId:oa(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(or.div,{dir:u,"data-orientation":a,...c,ref:t})})});Gne.displayName=DT;var Kne="TabsList",Yne=E.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=L6(Kne,n),a=Hne(n);return f.jsx(Vne,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(or.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});Yne.displayName=Kne;var Zne="TabsTrigger",Xne=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=L6(Zne,n),o=Hne(n),l=ere(a.baseId,r),c=tre(a.baseId,r),u=r===a.value;return f.jsx(Wne,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(or.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});Xne.displayName=Zne;var Jne="TabsContent",Qne=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=L6(Jne,n),l=ere(o.baseId,r),c=tre(o.baseId,r),u=r===o.value,d=E.useRef(u);return E.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(ca,{present:s||u,children:({present:h})=>f.jsx(or.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});Qne.displayName=Jne;function ere(e,t){return`${e}-trigger-${t}`}function tre(e,t){return`${e}-content-${t}`}var R9e=Gne,N9e=Yne,M9e=Xne,I9e=Qne;function j9e({className:e,...t}){return f.jsx(R9e,{"data-slot":"tabs",className:Je("flex flex-col gap-2",e),...t})}function P9e({className:e,...t}){return f.jsx(N9e,{"data-slot":"tabs-list",className:Je("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function O9e({className:e,...t}){return f.jsx(M9e,{"data-slot":"tabs-trigger",className:Je("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function D9e({className:e,...t}){return f.jsx(I9e,{"data-slot":"tabs-content",className:Je("flex-1 outline-none",e),...t})}const tc=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var m;const[l,c]=E.useState(n??t??((m=e[0])==null?void 0:m.value));E.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{c(y),r&&r(y)},d=Je("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const v=Je(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(Hl,{className:v,children:y}):f.jsx("div",{className:v,children:y})};return f.jsxs(j9e,{value:l,onValueChange:u,defaultValue:t,className:Je("flex flex-col h-full",s),children:[f.jsx(P9e,{className:Je("flex-shrink-0 sticky top-0 bg-background z-10 flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(y=>f.jsx(O9e,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),f.jsx(h,{children:e.map(y=>f.jsx(D9e,{value:y.value,className:"data-[state=inactive]:hidden h-full",children:y.content},y.value))})]})},nre=E.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=Mh(gn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=E.useMemo(()=>[...r.map(h=>{const m=h.component;return{value:h.id,label:h.title,content:f.jsx(m,{}),order:h.order??999}})].sort((h,m)=>(h.order??999)-(m.order??999)),[r]),i=E.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=E.useState(i());E.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),Me.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(ap,{open:e,onOpenChange:l,children:f.jsxs(op,{className:Je("min-w-[95vw] h-[95vh] flex flex-col p-0"),children:[f.jsxs(lp,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsx(cp,{children:"Settings"}),f.jsx(Xm,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(tc,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6",scrollable:!1},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(fb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:f.jsx(pt,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});nre.displayName="SettingsModalComponent";const F9e=nre;class L9e{constructor(){de(this,"id","core-settings-trigger");de(this,"modalId","settingsModal");de(this,"unregisterChatControlCallback",null);de(this,"unregisterModalProviderCallback",null);de(this,"modApiRef",null);de(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Pr.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});de(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Pr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>Ve.createElement(gq,{module:this}),iconRenderer:()=>Ve.createElement(gq,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(F9e,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const B9e=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(rge,{className:"h-4 w-4"}):f.jsx(tge,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class $9e{constructor(){de(this,"id","core-sidebar-toggle");de(this,"unregisterCallback",null);de(this,"notifyComponentUpdate",null);de(this,"modApiRef",null);de(this,"getIsSidebarCollapsed",()=>Ww.getState().isSidebarCollapsed);de(this,"toggleSidebar",t=>{var s,i;const n=Ww.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Pr.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(B9e,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function Cy({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:m=>{const y=x=>{const w=x.target.value;if(w===""&&a)m.handleChange(null);else{const S=parseFloat(w);isNaN(S)?w===""&&!a&&m.handleChange(w):m.handleChange(S)}},b=typeof m.state.value=="number"?m.state.value.toString():(m.state.value===null&&a,""),v=x=>{m.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Je("space-y-1.5",i),children:[" ",f.jsx(jt,{htmlFor:m.name,className:"text-sm",children:n}),f.jsx(Sn,{id:m.name,name:m.name,type:"number",value:b,onBlur:v,onChange:y,placeholder:r,disabled:s??m.form.state.isSubmitting,min:o,max:l,step:c,className:Je(u,m.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(Ii,{field:m})]})}})}var rre=["PageUp","PageDown"],sre=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ire={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},hb="Slider",[E4,z9e,U9e]=F6(hb),[are,bdt]=Gi(hb,[U9e]),[q9e,FT]=are(hb),ore=E.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:y,...b}=e,v=E.useRef(new Set),x=E.useRef(0),S=a==="horizontal"?V9e:W9e,[k=[],C]=Mc({prop:u,defaultProp:c,onChange:B=>{var W;(W=[...v.current][x.current])==null||W.focus(),d(B)}}),R=E.useRef(k);function A(B){const D=Z9e(k,B);O(B,D)}function N(B){O(B,x.current)}function I(){const B=R.current[x.current];k[x.current]!==B&&h(k)}function O(B,D,{commit:W}={commit:!1}){const P=eze(i),Z=tze(Math.round((B-r)/i)*i+r,P),U=Ow(Z,[r,s]);C((H=[])=>{const L=K9e(H,U,D);if(Q9e(L,l*i)){x.current=L.indexOf(U);const ne=String(L)!==String(H);return ne&&W&&h(L),ne?L:H}else return H})}return f.jsx(q9e,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:k,orientation:a,form:y,children:f.jsx(E4.Provider,{scope:e.__scopeSlider,children:f.jsx(E4.Slot,{scope:e.__scopeSlider,children:f.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Wt(b.onPointerDown,()=>{o||(R.current=k)}),min:r,max:s,inverted:m,onSlideStart:o?void 0:A,onSlideMove:o?void 0:N,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&O(r,0,{commit:!0}),onEndKeyDown:()=>!o&&O(s,k.length-1,{commit:!0}),onStepKeyDown:({event:B,direction:D})=>{if(!o){const Z=rre.includes(B.key)||B.shiftKey&&sre.includes(B.key)?10:1,U=x.current,H=k[U],L=i*Z*D;O(H+L,U,{commit:!0})}}})})})})});ore.displayName=hb;var[lre,cre]=are(hb,{startEdge:"left",endEdge:"right",size:"width",direction:1}),V9e=E.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=E.useState(null),m=Nn(t,S=>h(S)),y=E.useRef(void 0),b=ob(s),v=b==="ltr",x=v&&!i||!v&&i;function w(S){const k=y.current||d.getBoundingClientRect(),C=[0,k.width],A=B6(C,x?[n,r]:[r,n]);return y.current=k,A(S-k.left)}return f.jsx(lre,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(ure,{dir:b,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const k=w(S.clientX);a==null||a(k)},onSlideMove:S=>{const k=w(S.clientX);o==null||o(k)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:S=>{const C=ire[x?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:C?-1:1})}})})}),W9e=E.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=E.useRef(null),d=Nn(t,u),h=E.useRef(void 0),m=!s;function y(b){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],S=B6(x,m?[r,n]:[n,r]);return h.current=v,S(b-v.top)}return f.jsx(lre,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(ure,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const v=y(b.clientY);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=ire[m?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),ure=E.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=FT(hb,n);return f.jsx(or.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):rre.concat(sre).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),dre="SliderTrack",fre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=FT(dre,n);return f.jsx(or.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});fre.displayName=dre;var T4="SliderRange",hre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=FT(T4,n),i=cre(T4,n),a=E.useRef(null),o=Nn(t,a),l=s.values.length,c=s.values.map(h=>gre(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(or.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});hre.displayName=T4;var A4="SliderThumb",pre=E.forwardRef((e,t)=>{const n=z9e(e.__scopeSlider),[r,s]=E.useState(null),i=Nn(t,o=>s(o)),a=E.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(H9e,{...e,ref:i,index:a})}),H9e=E.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=FT(A4,n),o=cre(A4,n),[l,c]=E.useState(null),u=Nn(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=Vy(l),m=a.values[r],y=m===void 0?0:gre(m,a.min,a.max),b=Y9e(r,a.values.length),v=h==null?void 0:h[o.size],x=v?X9e(v,y,o.direction):0;return E.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${x}px)`},children:[f.jsx(E4.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(or.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(mre,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},r)]})});pre.displayName=A4;var G9e="RadioBubbleInput",mre=E.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=E.useRef(null),i=Nn(s,r),a=kT(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(or.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});mre.displayName=G9e;function K9e(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function gre(e,t,n){const i=100/(n-t)*(e-t);return Ow(i,[0,100])}function Y9e(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function Z9e(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function X9e(e,t,n){const r=e/2,i=B6([0,50],[0,r]);return(r-i(t)*n)*n}function J9e(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function Q9e(e,t){if(t>0){const n=J9e(e);return Math.min(...n)>=t}return!0}function B6(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function eze(e){return(String(e).split(".")[1]||"").length}function tze(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var nze=ore,rze=fre,sze=hre,ize=pre;function k0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=E.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(nze,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Je("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx(rze,{"data-slot":"slider-track",className:Je("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(sze,{"data-slot":"slider-range",className:Je("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(ize,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function bc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...m}){return f.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,v=b.toFixed(i);return f.jsxs("div",{className:Je("space-y-1.5",l),children:[f.jsxs(jt,{htmlFor:y.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),f.jsx(k0,{id:y.name,name:y.name,value:[b],onValueChange:x=>y.handleChange(x[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:Je(c,y.state.meta.errors.length?"border-destructive":""),...m}),f.jsx(Ii,{field:y})]})}})}const aze=Ge({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),oze=({module:e,className:t})=>{const n=si({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:aze,onChangeAsyncDebounceMs:500}});E.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=Ve.useState({});E.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=E.useCallback((u,d,h)=>{var m;((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0&&d(h)},[n,e]),i=E.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const m=n.getFieldValue(u);d(m)}},[n,e]),a=E.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,m,y="N/A")=>{var b;return!l||m===void 0?null:f.jsxs(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,m??null),disabled:d===null,children:["Use Default (",((b=m==null?void 0:m.toFixed)==null?void 0:b.call(m,2))??y,")"]})};return f.jsxs("div",{className:Je("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(bc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(bc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Cy,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Cy,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(bc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(bc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},lze=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(Bc,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(Tge,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(zc,{className:"w-auto p-0",align:"start",children:f.jsx(oze,{module:e})})]}):null};class cze{constructor(){de(this,"id","core-parameters");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"temperature",null);de(this,"topP",null);de(this,"maxTokens",null);de(this,"topK",null);de(this,"presencePenalty",null);de(this,"frequencyPenalty",null);de(this,"defaultTemperature",null);de(this,"defaultTopP",null);de(this,"defaultMaxTokens",null);de(this,"defaultTopK",null);de(this,"defaultPresencePenalty",null);de(this,"defaultFrequencyPenalty",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"supportedParams",new Set);de(this,"notifyComponentUpdate",null);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(yn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(yn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(yn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(yn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(yn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(yn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(fr.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(sn.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(yn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=mr.getState(),n=Po.getState();this.isStreaming=Ln.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Nr.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=_c(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=MG(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=mr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(lze,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const uze=({module:e})=>{const t=E.useRef(null),[,n]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=E.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),m=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(m&&s){const y=new FileReader,b=new Promise((x,w)=>{y.onload=()=>x(y.result),y.onerror=S=>w(S)});y.readAsDataURL(u);const v=await b;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),Me.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(mE,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o})]})})]})},dze=({module:e})=>{const[,t]=E.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Je("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(CZ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},yre=20,fze=yre*1024*1024;class hze{constructor(){de(this,"id","core-file-attachment");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"isStreaming",!1);de(this,"modelSupportsNonText",!0);de(this,"attachedFiles",[]);de(this,"notifyComponentUpdate",null);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);de(this,"getAttachedFiles",()=>this.attachedFiles);de(this,"isLikelyTextFile",(t,n)=>Yx(t,n));de(this,"onFileAdd",t=>{var r;if(t.size>fze){Me.error(`File "${t.name}" exceeds the ${yre}MB limit.`);return}if(!Yx(t.name,t.type)&&!this.modelSupportsNonText){Me.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(Bl.addAttachedFileRequest,t)});de(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(Bl.removeAttachedFileRequest,{attachmentId:t})});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=Ln.getState().status==="streaming",this.attachedFiles=gh.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(fr.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Bl.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Nr.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(uze,{module:this}),renderer:()=>Ve.createElement(dze,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const pze=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=gh.getState().addAttachedFile,a=()=>{const o=Qs.getState().selectedFileIds;if(o.size===0){Me.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(Me.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):Me.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:Je("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx($P,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(pt,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(mE,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Sr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function af({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Je("w-full caption-bottom text-sm",e),...t})})}function up({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Je("[&_tr]:border-b",e),...t})}function of({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Je("[&_tr:last-child]:border-0",e),...t})}function Ts({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Je("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Tr({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Je("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function On({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Je("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function mze({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Je("text-muted-foreground mt-4 text-sm",e),...t})}const bre=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(mh,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(Sn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(pt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{className:"h-4 w-4"})}),f.jsx(pt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Wi,{className:"h-4 w-4"})})]})]}):f.jsxs(Ts,{className:"bg-muted/30",children:[f.jsx(On,{className:"px-2 py-1"}),f.jsx(On,{className:"px-2 py-1",children:f.jsx(mh,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(On,{className:"py-1 px-2",colSpan:3,children:f.jsx(Sn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(On,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Wi,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};function gze(e){const t=yze(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(vze);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function yze(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=wze(s),o=xze(i,s.props);return s.type!==E.Fragment&&(o.ref=r?fl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var bze=Symbol("radix.slottable");function vze(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===bze}function xze(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function wze(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var R4=["Enter"," "],_ze=["ArrowDown","PageUp","Home"],vre=["ArrowUp","PageDown","End"],Sze=[..._ze,...vre],Cze={ltr:[...R4,"ArrowRight"],rtl:[...R4,"ArrowLeft"]},kze={ltr:["ArrowLeft"],rtl:["ArrowRight"]},e_="Menu",[Gw,Eze,Tze]=F6(e_),[Jm,LT]=Gi(e_,[Tze,ME,OT]),BT=ME(),xre=OT(),[Aze,Qm]=Jm(e_),[Rze,t_]=Jm(e_),wre=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=BT(t),[l,c]=E.useState(null),u=E.useRef(!1),d=Es(i),h=ob(s);return E.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),f.jsx(nK,{...o,children:f.jsx(Aze,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(Rze,{scope:t,onClose:E.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};wre.displayName=e_;var Nze="MenuAnchor",$6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=BT(n);return f.jsx(rK,{...s,...r,ref:t})});$6.displayName=Nze;var z6="MenuPortal",[Mze,_re]=Jm(z6,{forceMount:void 0}),Sre=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=Qm(z6,t);return f.jsx(Mze,{scope:t,forceMount:n,children:f.jsx(ca,{present:n||i.open,children:f.jsx(IE,{asChild:!0,container:s,children:r})})})};Sre.displayName=z6;var Vl="MenuContent",[Ize,U6]=Jm(Vl),Cre=E.forwardRef((e,t)=>{const n=_re(Vl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=Qm(Vl,e.__scopeMenu),a=t_(Vl,e.__scopeMenu);return f.jsx(Gw.Provider,{scope:e.__scopeMenu,children:f.jsx(ca,{present:r||i.open,children:f.jsx(Gw.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(jze,{...s,ref:t}):f.jsx(Pze,{...s,ref:t})})})})}),jze=E.forwardRef((e,t)=>{const n=Qm(Vl,e.__scopeMenu),r=E.useRef(null),s=Nn(t,r);return E.useEffect(()=>{const i=r.current;if(i)return ET(i)},[]),f.jsx(q6,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Pze=E.forwardRef((e,t)=>{const n=Qm(Vl,e.__scopeMenu);return f.jsx(q6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Oze=gze("MenuContent.ScrollLock"),q6=E.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:y,...b}=e,v=Qm(Vl,n),x=t_(Vl,n),w=BT(n),S=xre(n),k=Eze(n),[C,R]=E.useState(null),A=E.useRef(null),N=Nn(t,A,v.onContentChange),I=E.useRef(0),O=E.useRef(""),B=E.useRef(0),D=E.useRef(null),W=E.useRef("right"),P=E.useRef(0),Z=y?X1:E.Fragment,U=y?{as:Oze,allowPinchZoom:!0}:void 0,H=ne=>{var De,Se;const V=O.current+ne,Q=k().filter(Ce=>!Ce.disabled),ee=document.activeElement,se=(De=Q.find(Ce=>Ce.ref.current===ee))==null?void 0:De.textValue,me=Q.map(Ce=>Ce.textValue),ce=Gze(me,V,se),je=(Se=Q.find(Ce=>Ce.textValue===ce))==null?void 0:Se.ref.current;(function Ce(qe){O.current=qe,window.clearTimeout(I.current),qe!==""&&(I.current=window.setTimeout(()=>Ce(""),1e3))})(V),je&&setTimeout(()=>je.focus())};E.useEffect(()=>()=>window.clearTimeout(I.current),[]),CT();const L=E.useCallback(ne=>{var Q,ee;return W.current===((Q=D.current)==null?void 0:Q.side)&&Yze(ne,(ee=D.current)==null?void 0:ee.area)},[]);return f.jsx(Ize,{scope:n,searchRef:O,onItemEnter:E.useCallback(ne=>{L(ne)&&ne.preventDefault()},[L]),onItemLeave:E.useCallback(ne=>{var V;L(ne)||((V=A.current)==null||V.focus(),R(null))},[L]),onTriggerLeave:E.useCallback(ne=>{L(ne)&&ne.preventDefault()},[L]),pointerGraceTimerRef:B,onPointerGraceIntentChange:E.useCallback(ne=>{D.current=ne},[]),children:f.jsx(Z,{...U,children:f.jsx(j6,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,ne=>{var V;ne.preventDefault(),(V=A.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(TE,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:f.jsx(Vne,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:R,onEntryFocus:Wt(l,ne=>{x.isUsingKeyboardRef.current||ne.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(sK,{role:"menu","aria-orientation":"vertical","data-state":$re(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...b,ref:N,style:{outline:"none",...b.style},onKeyDown:Wt(b.onKeyDown,ne=>{const Q=ne.target.closest("[data-radix-menu-content]")===ne.currentTarget,ee=ne.ctrlKey||ne.altKey||ne.metaKey,se=ne.key.length===1;Q&&(ne.key==="Tab"&&ne.preventDefault(),!ee&&se&&H(ne.key));const me=A.current;if(ne.target!==me||!Sze.includes(ne.key))return;ne.preventDefault();const je=k().filter(De=>!De.disabled).map(De=>De.ref.current);vre.includes(ne.key)&&je.reverse(),Wze(je)}),onBlur:Wt(e.onBlur,ne=>{ne.currentTarget.contains(ne.target)||(window.clearTimeout(I.current),O.current="")}),onPointerMove:Wt(e.onPointerMove,Kw(ne=>{const V=ne.target,Q=P.current!==ne.clientX;if(ne.currentTarget.contains(V)&&Q){const ee=ne.clientX>P.current?"right":"left";W.current=ee,P.current=ne.clientX}}))})})})})})})});Cre.displayName=Vl;var Dze="MenuGroup",V6=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(or.div,{role:"group",...r,ref:t})});V6.displayName=Dze;var Fze="MenuLabel",kre=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(or.div,{...r,ref:t})});kre.displayName=Fze;var Ck="MenuItem",_q="menu.itemSelect",$T=E.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=E.useRef(null),a=t_(Ck,e.__scopeMenu),o=U6(Ck,e.__scopeMenu),l=Nn(t,i),c=E.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(_q,{bubbles:!0,cancelable:!0});d.addEventListener(_q,m=>r==null?void 0:r(m),{once:!0}),jG(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(Ere,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||R4.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});$T.displayName=Ck;var Ere=E.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=U6(Ck,n),o=xre(n),l=E.useRef(null),c=Nn(t,l),[u,d]=E.useState(!1),[h,m]=E.useState("");return E.useEffect(()=>{const y=l.current;y&&m((y.textContent??"").trim())},[i.children]),f.jsx(Gw.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(Wne,{asChild:!0,...o,focusable:!r,children:f.jsx(or.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,Kw(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,Kw(y=>a.onItemLeave(y))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),Lze="MenuCheckboxItem",Tre=E.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(Ire,{scope:e.__scopeMenu,checked:n,children:f.jsx($T,{role:"menuitemcheckbox","aria-checked":kk(n)?"mixed":n,...s,ref:t,"data-state":H6(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r(kk(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Tre.displayName=Lze;var Are="MenuRadioGroup",[Bze,$ze]=Jm(Are,{value:void 0,onValueChange:()=>{}}),Rre=E.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Es(r);return f.jsx(Bze,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(V6,{...s,ref:t})})});Rre.displayName=Are;var Nre="MenuRadioItem",Mre=E.forwardRef((e,t)=>{const{value:n,...r}=e,s=$ze(Nre,e.__scopeMenu),i=n===s.value;return f.jsx(Ire,{scope:e.__scopeMenu,checked:i,children:f.jsx($T,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":H6(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});Mre.displayName=Nre;var W6="MenuItemIndicator",[Ire,zze]=Jm(W6,{checked:!1}),jre=E.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=zze(W6,n);return f.jsx(ca,{present:r||kk(i.checked)||i.checked===!0,children:f.jsx(or.span,{...s,ref:t,"data-state":H6(i.checked)})})});jre.displayName=W6;var Uze="MenuSeparator",Pre=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(or.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Pre.displayName=Uze;var qze="MenuArrow",Ore=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=BT(n);return f.jsx(iK,{...s,...r,ref:t})});Ore.displayName=qze;var Vze="MenuSub",[vdt,Dre]=Jm(Vze),ux="MenuSubTrigger",Fre=E.forwardRef((e,t)=>{const n=Qm(ux,e.__scopeMenu),r=t_(ux,e.__scopeMenu),s=Dre(ux,e.__scopeMenu),i=U6(ux,e.__scopeMenu),a=E.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=E.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return E.useEffect(()=>u,[u]),E.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx($6,{asChild:!0,...c,children:f.jsx(Ere,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":$re(n.open),...e,ref:fl(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,Kw(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,Kw(d=>{var m,y;u();const h=(m=n.content)==null?void 0:m.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,v=b==="right",x=v?-5:5,w=h[v?"left":"right"],S=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:w,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||Cze[r.dir].includes(d.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),d.preventDefault())})})})});Fre.displayName=ux;var Lre="MenuSubContent",Bre=E.forwardRef((e,t)=>{const n=_re(Vl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=Qm(Vl,e.__scopeMenu),a=t_(Vl,e.__scopeMenu),o=Dre(Lre,e.__scopeMenu),l=E.useRef(null),c=Nn(t,l);return f.jsx(Gw.Provider,{scope:e.__scopeMenu,children:f.jsx(ca,{present:r||i.open,children:f.jsx(Gw.Slot,{scope:e.__scopeMenu,children:f.jsx(q6,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var m;const d=u.currentTarget.contains(u.target),h=kze[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});Bre.displayName=Lre;function $re(e){return e?"open":"closed"}function kk(e){return e==="indeterminate"}function H6(e){return kk(e)?"indeterminate":e?"checked":"unchecked"}function Wze(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function Hze(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function Gze(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=Hze(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function Kze(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function Yze(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return Kze(n,t)}function Kw(e){return t=>t.pointerType==="mouse"?e(t):void 0}var zre=wre,Ure=$6,qre=Sre,Vre=Cre,Wre=V6,Hre=kre,Gre=$T,Kre=Tre,Yre=Rre,Zre=Mre,Xre=jre,Jre=Pre,Qre=Ore,ese=Fre,tse=Bre,G6="ContextMenu",[Zze,xdt]=Gi(G6,[LT]),fo=LT(),[Xze,nse]=Zze(G6),rse=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=E.useState(!1),l=fo(t),c=Es(r),u=E.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(Xze,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(zre,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};rse.displayName=G6;var sse="ContextMenuTrigger",ise=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=nse(sse,n),a=fo(n),o=E.useRef({x:0,y:0}),l=E.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=E.useRef(0),u=E.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return E.useEffect(()=>u,[u]),E.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Ure,{...a,virtualRef:l}),f.jsx(or.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,u2(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,u2(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,u2(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,u2(u))})]})});ise.displayName=sse;var Jze="ContextMenuPortal",ase=e=>{const{__scopeContextMenu:t,...n}=e,r=fo(t);return f.jsx(qre,{...r,...n})};ase.displayName=Jze;var ose="ContextMenuContent",lse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=nse(ose,n),i=fo(n),a=E.useRef(!1);return f.jsx(Vre,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});lse.displayName=ose;var Qze="ContextMenuGroup",e7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Wre,{...s,...r,ref:t})});e7e.displayName=Qze;var t7e="ContextMenuLabel",n7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Hre,{...s,...r,ref:t})});n7e.displayName=t7e;var r7e="ContextMenuItem",cse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Gre,{...s,...r,ref:t})});cse.displayName=r7e;var s7e="ContextMenuCheckboxItem",i7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Kre,{...s,...r,ref:t})});i7e.displayName=s7e;var a7e="ContextMenuRadioGroup",o7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Yre,{...s,...r,ref:t})});o7e.displayName=a7e;var l7e="ContextMenuRadioItem",c7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Zre,{...s,...r,ref:t})});c7e.displayName=l7e;var u7e="ContextMenuItemIndicator",d7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Xre,{...s,...r,ref:t})});d7e.displayName=u7e;var f7e="ContextMenuSeparator",use=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Jre,{...s,...r,ref:t})});use.displayName=f7e;var h7e="ContextMenuArrow",p7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(Qre,{...s,...r,ref:t})});p7e.displayName=h7e;var m7e="ContextMenuSubTrigger",g7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(ese,{...s,...r,ref:t})});g7e.displayName=m7e;var y7e="ContextMenuSubContent",b7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fo(n);return f.jsx(tse,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});b7e.displayName=y7e;function u2(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var v7e=rse,x7e=ise,w7e=ase,_7e=lse,S7e=cse,C7e=use;function Sq({...e}){return f.jsx(v7e,{"data-slot":"context-menu",...e})}function Cq({...e}){return f.jsx(x7e,{"data-slot":"context-menu-trigger",...e})}function kq({className:e,...t}){return f.jsx(w7e,{children:f.jsx(_7e,{"data-slot":"context-menu-content",className:Je("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function Qo({className:e,inset:t,variant:n="default",...r}){return f.jsx(S7e,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Je("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Eq({className:e,...t}){return f.jsx(C7e,{"data-slot":"context-menu-separator",className:Je("bg-border -mx-1 my-1 h-px",e),...t})}const k7e=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:m,setNewName:y,renameInputRef:b,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:S,handleGitStatus:k})=>{const C=e.type==="folder",R=B=>{B.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(C?o(e):l(!n,e.id))},A=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()},N=C?r?pH:mh:hH,I=C?r?"text-green-400":"text-yellow-400":"text-blue-400",O=f.jsxs(Ts,{className:Je("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!C&&"cursor-pointer"),onClick:R,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(On,{className:"px-2 py-1",children:f.jsx(Pc,{checked:n,onCheckedChange:B=>l(!!B,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||C})}),f.jsx(On,{className:"px-2 py-1",children:f.jsx(N,{className:Je("h-5 w-5",I)})}),f.jsx(On,{className:"py-1 px-2",children:t?f.jsx(Sn,{ref:b,value:s,onChange:B=>y(B.target.value),onBlur:d,onKeyDown:A,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:B=>B.stopPropagation(),disabled:i}):f.jsx("span",{className:Je("truncate",C&&"cursor-pointer hover:underline"),title:e.name,onClick:B=>{C&&(B.stopPropagation(),o(e))},children:e.name})}),f.jsx(On,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?dw(e.size):""}),f.jsx(On,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(On,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Je("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(er,{tooltipText:"Save (Enter)",onClick:B=>{B.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(er,{tooltipText:"Cancel (Esc)",onClick:B=>{B.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(Wi,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(er,{tooltipText:"Rename",onClick:B=>{B.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(fh,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(er,{tooltipText:C?"Download folder (.zip)":"Download file",onClick:B=>{B.stopPropagation(),h(e)},"aria-label":C?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(wc,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(er,{tooltipText:"Delete",onClick:B=>{B.stopPropagation(),m(e)},"aria-label":`Delete ${C?"folder":"file"}`,disabled:i,icon:f.jsx(Ao,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return C?f.jsxs(Sq,{children:[f.jsx(Cq,{disabled:t||i,asChild:!0,children:O}),f.jsxs(kq,{children:[f.jsx(Qo,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx(Eq,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(Qo,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(yH,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(Qo,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(gH,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(Qo,{onSelect:()=>S(e.path),disabled:i,children:[f.jsx(BP,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(Qo,{onSelect:()=>k(e.path),disabled:i,children:[f.jsx(zP,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(Qo,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(Tc,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx(Eq,{}),f.jsxs(Qo,{onSelect:()=>c(e),disabled:i,children:[f.jsx(fh,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(Qo,{onSelect:()=>h(e),disabled:i,children:[f.jsx(wc,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(Qo,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Ao,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(Sq,{children:[f.jsx(Cq,{disabled:t||i,asChild:!0,children:O}),f.jsxs(kq,{children:[f.jsxs(Qo,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(Qo,{onSelect:()=>c(e),disabled:i,children:[f.jsx(fh,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(Qo,{onSelect:()=>h(e),disabled:i,children:[f.jsx(wc,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(Qo,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Ao,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},E7e=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:k,handleGitInit:C,handleGitPull:R,handleGitCommit:A,handleGitPush:N,handleGitStatus:I})=>{const O=E.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(af,{className:"w-full text-sm",children:[f.jsx(up,{className:"sticky top-0 bg-card z-10",children:f.jsxs(Ts,{className:"hover:bg-card",children:[f.jsx(Tr,{className:"w-[40px] px-2"}),f.jsx(Tr,{className:"w-[40px] px-2"}),f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Tr,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Tr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(of,{children:[r&&f.jsx(bre,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),O.map(B=>{const D=t===B.path,W=i.has(B.id),P=k[B.path]??!1;return f.jsx(k7e,{entry:B,isEditingThis:D,isChecked:W,isGitRepo:P,newName:D?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:v,renameInputRef:w,handleGitInit:C,handleGitPull:R,handleGitCommit:A,handleGitPush:N,handleGitStatus:I},B.id)}),e.length===0&&!r&&!a&&f.jsx(Ts,{children:f.jsx(On,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},T7e=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:m,handleCloneClick:y,fileInputRef:b,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:S})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:b,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:S,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(pt,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(Dme,{className:"h-4 w-4"})}),f.jsx(pt,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(vme,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(pt,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(ym,{className:"h-4 w-4"})}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(mH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(LP,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(mh,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(sme,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Tc,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),m()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(dH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),dse=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(ap,{open:e,onOpenChange:t,children:f.jsxs(op,{className:Je(c),children:[f.jsxs(lp,{children:[f.jsx(cp,{children:n}),r&&f.jsx(Xm,{children:r})]}),f.jsx("div",{className:Je("py-4",u),children:s}),f.jsxs(fb,{children:[f.jsx(u9e,{asChild:!0,children:f.jsx(pt,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(pt,{onClick:d,disabled:o||l,children:[o&&f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},A7e=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(dse,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(jt,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(Sn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(jt,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(Sn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),R7e=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(dse,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(jt,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(Sn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var zT="DropdownMenu",[N7e,wdt]=Gi(zT,[LT]),ho=LT(),[M7e,fse]=N7e(zT),hse=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=ho(t),c=E.useRef(null),[u,d]=Mc({prop:s,defaultProp:i??!1,onChange:a,caller:zT});return f.jsx(M7e,{scope:t,triggerId:oa(),triggerRef:c,contentId:oa(),open:u,onOpenChange:d,onOpenToggle:E.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(zre,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};hse.displayName=zT;var pse="DropdownMenuTrigger",mse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=fse(pse,n),a=ho(n);return f.jsx(Ure,{asChild:!0,...a,children:f.jsx(or.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:fl(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});mse.displayName=pse;var I7e="DropdownMenuPortal",gse=e=>{const{__scopeDropdownMenu:t,...n}=e,r=ho(t);return f.jsx(qre,{...r,...n})};gse.displayName=I7e;var yse="DropdownMenuContent",bse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=fse(yse,n),i=ho(n),a=E.useRef(!1);return f.jsx(Vre,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bse.displayName=yse;var j7e="DropdownMenuGroup",P7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Wre,{...s,...r,ref:t})});P7e.displayName=j7e;var O7e="DropdownMenuLabel",D7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Hre,{...s,...r,ref:t})});D7e.displayName=O7e;var F7e="DropdownMenuItem",vse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Gre,{...s,...r,ref:t})});vse.displayName=F7e;var L7e="DropdownMenuCheckboxItem",B7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Kre,{...s,...r,ref:t})});B7e.displayName=L7e;var $7e="DropdownMenuRadioGroup",z7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Yre,{...s,...r,ref:t})});z7e.displayName=$7e;var U7e="DropdownMenuRadioItem",q7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Zre,{...s,...r,ref:t})});q7e.displayName=U7e;var V7e="DropdownMenuItemIndicator",W7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Xre,{...s,...r,ref:t})});W7e.displayName=V7e;var H7e="DropdownMenuSeparator",xse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Jre,{...s,...r,ref:t})});xse.displayName=H7e;var G7e="DropdownMenuArrow",K7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(Qre,{...s,...r,ref:t})});K7e.displayName=G7e;var Y7e="DropdownMenuSubTrigger",Z7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(ese,{...s,...r,ref:t})});Z7e.displayName=Y7e;var X7e="DropdownMenuSubContent",J7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=ho(n);return f.jsx(tse,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});J7e.displayName=X7e;var Q7e=hse,eUe=mse,tUe=gse,nUe=bse,rUe=vse,sUe=xse;function iUe({...e}){return f.jsx(Q7e,{"data-slot":"dropdown-menu",...e})}function aUe({...e}){return f.jsx(eUe,{"data-slot":"dropdown-menu-trigger",...e})}function oUe({className:e,sideOffset:t=4,...n}){return f.jsx(tUe,{children:f.jsx(nUe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Je("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function ru({className:e,inset:t,variant:n="default",...r}){return f.jsx(rUe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Je("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Tq({className:e,...t}){return f.jsx(sUe,{"data-slot":"dropdown-menu-separator",className:Je("bg-border -mx-1 my-1 h-px",e),...t})}const lUe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:k,handleGitInit:C,handleGitPull:R,handleGitCommit:A,handleGitPush:N,handleGitStatus:I})=>{const O=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(bre,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(B=>{const D=t===B.path,W=i.has(B.id),P=k[B.path]??!1,Z=B.type==="folder",U=Z?P?pH:mh:hH,H=Z?P?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Je("flex items-center justify-between p-2 border rounded-md",D&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!D&&"hover:bg-muted/50",!D&&"cursor-pointer"),onClick:()=>{D||a||(Z?o(B):l(!W,B.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!Z&&f.jsx(Pc,{checked:W,onCheckedChange:L=>l(!!L,B.id),"aria-label":`Select ${B.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:L=>L.stopPropagation()}),Z&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(U,{className:Je("h-5 w-5 flex-shrink-0",H)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[D?f.jsx(Sn,{ref:w,value:n,onChange:L=>v(L.target.value),onBlur:d,onKeyDown:O,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:L=>L.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:B.name,children:B.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:B.type==="file"&&B.size!==void 0?dw(B.size):B.type==="folder"?P?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:D?f.jsxs(f.Fragment,{children:[f.jsx(pt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:L=>{L.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(so,{className:"h-4 w-4"})}),f.jsx(pt,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:L=>{L.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(Wi,{className:"h-4 w-4"})})]}):f.jsxs(iUe,{children:[f.jsx(aUe,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:L=>L.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(nme,{className:"h-4 w-4"})})}),f.jsxs(oUe,{align:"end",onClick:L=>L.stopPropagation(),children:[Z&&f.jsx(ru,{onSelect:()=>o(B),children:"Open Folder"}),!Z&&f.jsxs(ru,{onSelect:()=>l(!W,B.id),children:[W?"Deselect":"Select"," File"]}),f.jsxs(ru,{onSelect:()=>c(B),children:[f.jsx(fh,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(ru,{onSelect:()=>y(B),children:[f.jsx(wc,{className:"mr-2 h-4 w-4"})," Download"," ",Z?"as ZIP":""]}),Z&&f.jsx(Tq,{}),Z&&P&&f.jsxs(f.Fragment,{children:[f.jsxs(ru,{onSelect:()=>R(B.path),children:[f.jsx(yH,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(ru,{onSelect:()=>A(B.path),children:[f.jsx(gH,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(ru,{onSelect:()=>N(B.path),children:[f.jsx(BP,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(ru,{onSelect:()=>I(B.path),children:[f.jsx(zP,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),Z&&!P&&f.jsxs(ru,{onSelect:()=>C(B.path),children:[f.jsx(Tc,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(Tq,{}),f.jsxs(ru,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(B),children:[f.jsx(Ao,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},B.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},K6=E.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=Qs(gn(_e=>({nodes:_e.nodes,childrenMap:_e.childrenMap,currentParentId:_e.currentParentId,selectedFileIds:_e.selectedFileIds,loading:_e.loading,operationLoading:_e.operationLoading,error:_e.error,rootId:_e.rootId,vfsKey:_e.vfsKey,configuredVfsKey:_e.configuredVfsKey,initializingKey:_e.initializingKey}))),[d,h]=E.useState(""),[m,y]=E.useState(null),[b,v]=E.useState(!1),[x,w]=E.useState(""),[S,k]=E.useState({}),[C,R]=E.useState(!1),[A,N]=E.useState(""),[I,O]=E.useState(""),[B,D]=E.useState(!1),[W,P]=E.useState(!1),[Z,U]=E.useState(null),[H,L]=E.useState(""),[ne,V]=E.useState(!1),[Q,ee]=E.useState({}),se=E.useRef(null),me=E.useRef(null),ce=E.useRef(null),je=E.useRef(null),De=E.useRef(null),Se=n?e[n]:null,Ce=Se?Se.path:"/",Qe=(t[n||a||""]||[]).map(_e=>e[_e]).filter(_e=>!!_e).sort((_e,Ue)=>_e.type==="folder"&&Ue.type==="file"?-1:_e.type==="file"&&Ue.type==="folder"?1:_e.name.localeCompare(Ue.name)),We=E.useMemo(()=>Qe.filter(_e=>_e.type==="folder").map(_e=>_e.path),[Qe]),Ne=r||u!==null||l!==c,K=s||B||ne||Object.values(Q).some(Boolean);E.useEffect(()=>{n!==null&&!t[n]&&!Ne&&c===l?Pe.emit(dn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!Ne&&c===l&&Pe.emit(dn.fetchNodesRequest,{parentId:a})},[n,t,a,Ne,c,l]),E.useEffect(()=>{var _e,Ue;m&&((_e=je.current)==null||_e.focus(),(Ue=je.current)==null||Ue.select())},[m]),E.useEffect(()=>{var _e;b&&((_e=De.current)==null||_e.focus())},[b]),E.useEffect(()=>{(async()=>{if(Ne||We.length===0)return;const Ue={};let Et=!1;for(const he of We)try{const Y=await fTe(he);S[he]!==Y&&(Ue[he]=Y,Et=!0)}catch(Y){console.error(`Error checking git status for ${he}:`,Y),S[he]!==!1&&(Ue[he]=!1,Et=!0)}Et&&k(he=>({...he,...Ue}))})()},[We,Ne,S]);const ge=E.useCallback(async(_e,Ue,Et)=>{if(!(K||Ne)){Et!==!1&&Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Pe.emit(_e,Ue)}catch(he){console.error("[FileManager Operation Error]:",he),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:he instanceof Error?he.message:String(he)})}finally{Et!==!1&&Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[K,Ne,r,s,i]),Ae=E.useCallback(_e=>{K||Ne||m||_e.type==="folder"&&ge(dn.setCurrentPathRequest,{path:_e.path},!1)},[K,Ne,m,ge]),le=E.useCallback(()=>{if(K||Ne||Ce==="/")return;const _e=QE(Ce);ge(dn.setCurrentPathRequest,{path:_e},!1)},[K,Ne,Ce,ge]),oe=E.useCallback(()=>{K||Ne||Ce==="/"||ge(dn.setCurrentPathRequest,{path:"/"},!1)},[K,Ne,Ce,ge]),re=E.useCallback(()=>{Ne||ge(dn.fetchNodesRequest,{parentId:n},!1)},[ge,n,Ne]),Te=E.useCallback((_e,Ue)=>{const Et=e[Ue];Et&&Et.type==="file"?_e?Pe.emit(dn.selectFileRequest,{fileId:Ue}):Pe.emit(dn.deselectFileRequest,{fileId:Ue}):Et&&Et.type==="folder"&&Me.info("Folders cannot be attached to the prompt.")},[e]),Be=E.useCallback(_e=>{K||Ne||b||(y(_e.path),h(_e.name),v(!1))},[K,Ne,b]),ke=E.useCallback(()=>{y(null),h("")},[]),lt=E.useCallback(async()=>{if(!m||!d.trim()){ke();return}const _e=Object.values(e).find(Ue=>Ue.path===m);_e&&_e.name!==d.trim()&&await ge(dn.renameNodeRequest,{id:_e.id,newName:d.trim()}),ke()},[m,d,e,ke,ge]),Rt=E.useCallback(()=>{K||Ne||m||(v(!0),w(""),y(null))},[K,Ne,m]),ft=E.useCallback(()=>{v(!1),w("")},[]),Pt=E.useCallback(async()=>{if(!x.trim()){ft();return}await ge(dn.createDirectoryRequest,{parentId:n,name:x.trim()}),ft()},[x,n,ft,ge]),qt=()=>{var _e;return(_e=se.current)==null?void 0:_e.click()},Lt=()=>{var _e;return(_e=me.current)==null?void 0:_e.click()},en=()=>{var _e;return(_e=ce.current)==null?void 0:_e.click()},xe=E.useCallback(async _e=>{const Ue=_e.target.files;Ue&&Ue.length>0&&(await ge(dn.uploadFilesRequest,{parentId:n,files:Ue}),_e.target&&(_e.target.value=""))},[n,ge]),F=E.useCallback(async _e=>{var Et;const Ue=(Et=_e.target.files)==null?void 0:Et[0];if(Ue){Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await mTe(Ue,Ce),Pe.emit(dn.fetchNodesRequest,{parentId:n})}catch(he){console.error("Archive upload error:",he)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),_e.target&&(_e.target.value="")}}},[Ce,n,r,i]),X=E.useCallback(async _e=>{window.confirm(`Delete ${_e.type} "${_e.name}"?${_e.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await ge(dn.deleteNodesRequest,{ids:[_e.id]})},[ge]),ye=E.useCallback(async _e=>{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{_e.type==="file"?await pTe(_e.path):await Cz(`${_e.name}.zip`,_e.path)}catch(Ue){console.error("Download error:",Ue)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),Fe=E.useCallback(async()=>{if(Qe.length!==0){Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const _e=bi(Ce)||"root";await Cz(`${_e}_export.zip`,Ce)}catch(_e){console.error("Download all error:",_e)}finally{Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Ce,Qe.length,r,i]),we=E.useCallback(async(_e,Ue)=>{if(!(Q[_e]||Ne||s)){ee(Et=>({...Et,[_e]:!0})),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await Ue()}catch(Et){console.error(`[FileManager Git Op Error @ ${_e}]:`,Et)}finally{ee(Et=>({...Et,[_e]:!1}))}}},[Q,Ne,s,r]),Ie=E.useCallback(_e=>{we(_e,async()=>{await vZ(_e),k(Ue=>({...Ue,[_e]:!0}))})},[we]),fe=E.useCallback(_e=>{Me.info("Pulling default branch (auth not implemented yet)..."),we(_e,()=>iT(_e,"main"))},[we]),vt=E.useCallback(_e=>{U(_e),L(""),P(!0)},[]),ot=E.useCallback(_e=>{Me.info("Pushing default branch (auth not implemented yet)..."),we(_e,()=>pD(_e,"main"))},[we]),$=E.useCallback(_e=>{we(_e,()=>xZ(_e))},[we]),ze=E.useCallback(()=>{N(""),O(""),R(!0)},[]),st=E.useCallback(async()=>{if(!A.trim()){Me.error("Repository URL cannot be empty.");return}D(!0),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const _e=bi(A.trim().replace(/\.git$/,""))||"cloned_repo",Ue=Nj(Ce,_e);await bZ(Ue,A.trim(),I.trim()||void 0),R(!1),Pe.emit(dn.fetchNodesRequest,{parentId:n})}catch{}finally{D(!1)}},[A,I,Ce,n,r,s]),be=E.useCallback(async()=>{if(!Z||!H.trim()){Me.error("Commit message cannot be empty.");return}V(!0),Pe.emit(dn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await hD(Z,H.trim()),P(!1)}catch{}finally{V(!1)}},[Z,H,r,s]);return Ne?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Yn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!Ne?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(pt,{variant:"outline",size:"sm",onClick:()=>Pe.emit(dn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Je("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(T7e,{currentPath:Ce,isAnyLoading:K||Ne,isOperationLoading:s,entries:Qe,editingPath:m,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:le,handleRefresh:re,startCreatingFolder:Rt,handleUploadClick:qt,handleFolderUploadClick:Lt,handleArchiveUploadClick:en,handleDownloadAll:Fe,handleCloneClick:ze,fileInputRef:se,folderInputRef:me,archiveInputRef:ce,handleFileChange:xe,handleArchiveChange:F}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(E7e,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ae,handleCheckboxChange:Te,startEditing:Be,cancelEditing:ke,handleRename:lt,cancelCreatingFolder:ft,handleCreateFolder:Pt,handleDownload:ye,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:je,newFolderInputRef:De,gitRepoStatus:S,handleGitInit:Ie,handleGitPull:fe,handleGitCommit:vt,handleGitPush:ot,handleGitStatus:$})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx(lUe,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:K,handleNavigate:Ae,handleCheckboxChange:Te,startEditing:Be,cancelEditing:ke,handleRename:lt,cancelCreatingFolder:ft,handleCreateFolder:Pt,handleDownload:ye,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:je,newFolderInputRef:De,gitRepoStatus:S,handleGitInit:Ie,handleGitPull:fe,handleGitCommit:vt,handleGitPush:ot,handleGitStatus:$})}),f.jsx(A7e,{isOpen:C,onOpenChange:R,cloneRepoUrl:A,setCloneRepoUrl:N,cloneBranch:I,setCloneBranch:O,isCloning:B,onSubmitClone:st,currentPath:Ce}),f.jsx(R7e,{isOpen:W,onOpenChange:P,commitPath:Z,commitMessage:H,setCommitMessage:L,isCommitting:ne,onSubmitCommit:be})]})});K6.displayName="FileManager";const cUe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(RB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(RB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(mh,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,uUe=({module:e,isOpen:t,onClose:n})=>{const[r,s]=E.useState(e.getSelectedFileIdsCount()),[i,a]=E.useState(null);E.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Pe.on(dn.selectionChanged,u),Pe.on(Zn.selectedItemChanged,d),()=>{Pe.off(dn.selectionChanged,u),Pe.off(Zn.selectedItemChanged,d)}},[]);const o=Qs.getState().vfsKey,l=()=>{const u=Qs.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){Me.info("No files selected in VFS to attach.");return}let h=0;u.forEach(m=>{const y=d[m];y&&y.type==="file"&&(Pe.emit(Bl.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(Me.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):Me.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(ap,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(op,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(lp,{className:"p-4 pb-2 border-b flex-shrink-0",children:[f.jsx(cp,{children:"Virtual Filesystem"}),f.jsx(Xm,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(cUe,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(K6,{})}),f.jsxs(fb,{className:"p-4 pt-2 border-t flex-shrink-0",children:[f.jsx(pt,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(pt,{onClick:l,disabled:r===0,children:[f.jsx(mE,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class dUe{constructor(){de(this,"id","core-vfs");de(this,"modalId","core-vfs-modal-panel");de(this,"unregisterCallbacks",[]);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"notifyTriggerUpdate",null);de(this,"isModalOpenByManager",!1);de(this,"getEnableVfs",()=>Qs.getState().enableVfs);de(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);de(this,"getSelectedFileIdsCount",()=>Qs.getState().selectedFileIds.size);de(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Pr.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Pr.openModalRequest,{modalId:this.modalId})});de(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(dn.clearSelectionRequest,void 0)});de(this,"getVfsNodes",()=>Qs.getState().nodes);de(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Pr.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Pr.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=Un.getState(),r=Qs.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=Un.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=Un.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(dn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>Ve.createElement(pze,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>Ve.createElement(uUe,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const fUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=E.useState(null),[c,u]=E.useState("idle"),[d,h]=E.useState(!1),[m,y]=E.useState(!1);E.useEffect(()=>{if(r==="conversation"&&n){const R=e.getConversationById(n);l((R==null?void 0:R.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=Ve.useMemo(()=>new Map(s.map(R=>[R.id,R.name])),[s]),v=o?b.get(o):void 0,x=E.useCallback(async R=>{if(!n||r!=="conversation")return;h(!0);const A=R==="none"?null:R;await e.linkConversationToRepo(n,A),h(!1)},[n,r,e]),w=E.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),S=mne(c,v),k=!o||m||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(Bc,{children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||m,"aria-label":"Configure Git Sync",children:c==="syncing"||m||d?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Tc,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(zc,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(jt,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(ep,{value:o??"none",onValueChange:x,disabled:d||m||a,children:[f.jsx(np,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(tp,{placeholder:"Select repository..."})}),f.jsxs(rp,{children:[f.jsx(Eo,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(R=>f.jsx(Eo,{value:R.id,children:R.name},R.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),f.jsxs(pt,{size:"sm",variant:"outline",onClick:w,disabled:k,className:"h-8",children:[m||c==="syncing"?f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(BP,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},dx=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Je("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Je("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Je("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Je(a),children:n})]}),hUe=Ge({gitUserName:$e().min(1,"User name cannot be empty."),gitUserEmail:$e().email("Invalid email address.")});function Aq({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const pUe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=mr(gn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=si({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:hUe},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),Me.success("Git user configuration updated!")}catch(a){Me.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return E.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(dx,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Git User Name"}),f.jsx(Sn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(Aq,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Git User Email"}),f.jsx(Sn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(Aq,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(pt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},mUe=Ve.memo(pUe),gUe=OP("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function wse({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Je(gUe({variant:t}),e),...n})}function _se({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Je("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function Sse({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Je("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var yUe="Separator",Rq="horizontal",bUe=["horizontal","vertical"],Cse=E.forwardRef((e,t)=>{const{decorative:n,orientation:r=Rq,...s}=e,i=vUe(r)?r:Rq,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(or.div,{"data-orientation":i,...o,...s,ref:t})});Cse.displayName=yUe;function vUe(e){return bUe.includes(e)}var xUe=Cse;function Ih({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(xUe,{"data-slot":"separator-root",decorative:n,orientation:t,className:Je("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const wUe=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=E.useState(null),[u,d]=E.useState(!1);E.useEffect(()=>{const S=A=>{A&&A.progress&&(c(A.progress),d(!0))},k=A=>{A&&A.progress&&c(A.progress)},C=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},2e3))},R=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Pe.on(us.bulkSyncStarted,S),Pe.on(us.bulkSyncProgress,k),Pe.on(us.bulkSyncCompleted,C),Pe.on(us.bulkSyncFailed,R),()=>{Pe.off(us.bulkSyncStarted,S),Pe.off(us.bulkSyncProgress,k),Pe.off(us.bulkSyncCompleted,C),Pe.off(us.bulkSyncFailed,R)}},[]);const h=s||u,m=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},v=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},x=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},w=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return f.jsxs(ol,{className:"w-full",children:[f.jsxs(ll,{className:"pb-3",children:[f.jsxs(cl,{className:"flex items-center gap-2",children:[f.jsx(Tc,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx(Ld,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs(ul,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Je("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(Ih,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(is,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(_y,{value:m,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(_y,{value:y,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(Wl,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,k)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},k)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(Ih,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(pt,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(wc,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Sr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(pt,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(wH,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Sr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(xr,{children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs(pt,{onClick:b,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(ym,{className:Je("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Sr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(pt,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(Dpe,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},_Ue=Ge({name:$e().min(1,"Repository Name is required."),remoteUrl:$e().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:$e().min(1,"Branch name is required (e.g., main)."),username:$e().nullable().optional(),password:$e().nullable().optional()}),d2={name:"",remoteUrl:"",branch:"main",username:null,password:null},SUe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=Un(gn(k=>({syncRepos:k.syncRepos,addSyncRepo:k.addSyncRepo,updateSyncRepo:k.updateSyncRepo,repoInitializationStatus:k.repoInitializationStatus,isLoading:k.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=mr(gn(k=>({autoSyncOnStreamComplete:k.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:k.setAutoSyncOnStreamComplete}))),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState({});E.useEffect(()=>{const k=C=>{C&&C.action==="deleted"&&C.repoId&&h(R=>({...R,[C.repoId]:!1}))};return Pe.on(us.repoChanged,k),()=>Pe.off(us.repoChanged,k)},[]);const m=si({defaultValues:d2,validators:{onChangeAsync:_Ue,onChangeAsyncDebounceMs:500},onSubmit:async({value:k})=>{var C,R,A,N;if(!((C=k.name)!=null&&C.trim())||!((R=k.remoteUrl)!=null&&R.trim())){Me.error("Repository Name and Remote URL are required.");return}try{const I={name:k.name.trim(),remoteUrl:k.remoteUrl.trim(),branch:((A=k.branch)==null?void 0:A.trim())||"main",username:((N=k.username)==null?void 0:N.trim())||null,password:k.password||null};c?await n(c,I):await t(I),y()}catch(I){console.error("Failed to save sync repo:",I)}}}),y=E.useCallback(()=>{m.reset(d2),l(!1),u(null)},[m]);E.useEffect(()=>{if(c){const k=e.find(C=>C.id===c);k?(m.reset({name:k.name,remoteUrl:k.remoteUrl,branch:k.branch||"main",username:k.username??null,password:k.password??null}),l(!1)):y()}else o||m.reset(d2)},[c,e,m,o,y]);const b=k=>{u(k.id),l(!1)},v=E.useCallback((k,C)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${C}"? This will unlink it from any conversations and remove the local copy.`)){h(R=>({...R,[k]:!0}));try{Pe.emit(Zn.deleteSyncRepoRequest,{id:k}),c===k&&y()}catch(R){console.error("Failed to delete sync repo:",R),h(A=>({...A,[k]:!1}))}}},[c,y]),x=E.useCallback(k=>{Pe.emit(Zn.initializeOrSyncRepoRequest,{repoId:k})},[]),w=()=>{u(null),m.reset(d2),l(!0)},S=()=>f.jsxs("form",{onSubmit:k=>{k.preventDefault(),k.stopPropagation(),m.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(m.Field,{name:"name",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Name"}),f.jsx(Sn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"e.g., My Backup",disabled:m.state.isSubmitting}),f.jsx(Ii,{field:k})]})}),f.jsx(m.Field,{name:"remoteUrl",children:k=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Remote URL (HTTPS)"}),f.jsx(Sn,{id:k.name,type:"url",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:m.state.isSubmitting}),f.jsx(Ii,{field:k})]})}),f.jsx(m.Field,{name:"branch",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Branch"}),f.jsx(Sn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"main",disabled:m.state.isSubmitting}),f.jsx(Ii,{field:k})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(wse,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(UP,{className:"h-4 w-4"}),f.jsx(_se,{children:"Security Warning"}),f.jsx(Sse,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(m.Field,{name:"username",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Username"}),f.jsx(Sn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Git Username (Optional)",disabled:m.state.isSubmitting,autoComplete:"off"}),f.jsx(Ii,{field:k})]})}),f.jsx(m.Field,{name:"password",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Password / Token"}),f.jsx(Sn,{id:k.name,type:"password",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Password or PAT (Optional)",disabled:m.state.isSubmitting,autoComplete:"new-password"}),f.jsx(Ii,{field:k})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(pt,{variant:"ghost",size:"sm",onClick:y,disabled:m.state.isSubmitting,type:"button",children:[f.jsx(Wi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(m.Subscribe,{selector:k=>[k.canSubmit,k.isSubmitting,k.isValidating,k.isValid],children:([k,C,R,A])=>f.jsxs(pt,{variant:"secondary",size:"sm",type:"submit",disabled:C||!k||!A||R,children:[(C||R)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"})," ",C||R?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(jt,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(Mo,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(jt,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(Mo,{id:"auto-init-repos-toggle",checked:mr(k=>k.autoInitializeReposOnStartup),onCheckedChange:mr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(wUe,{onSyncAll:async()=>{await Un.getState().syncAllConversations()},onSyncPending:async()=>{await Un.getState().syncPendingConversations()},onInitializeRepos:async()=>{await Un.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:k}=await Zr(async()=>{const{BulkSyncService:C}=await Promise.resolve().then(()=>O0);return{BulkSyncService:C}},void 0);k.abort()},totalRepos:e.length,totalConversations:Un.getState().conversations.filter(k=>k.syncRepoId).length,pendingConversations:Un.getState().conversations.filter(k=>{const C=Un.getState().conversationSyncStatus[k.id];return k.syncRepoId&&C==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(pt,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Tr,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Tr,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:e.map(k=>{const C=d[k.id],R=c===k.id,A=!!k.username||!!k.password,N=r[k.id]||"idle",I=N==="syncing",O=C||m.state.isSubmitting||!!c||I;let B=null,D="Initialize/Sync Repository";return N==="syncing"?(B=f.jsx(Yn,{className:"h-4 w-4 animate-spin mr-1"}),D="Initializing/Syncing..."):N==="idle"?(B=f.jsx(fE,{className:"h-4 w-4 text-green-500 mr-1"}),D="Sync Successful / Ready"):N==="error"?(B=f.jsx(Wl,{className:"h-4 w-4 text-destructive mr-1"}),D="Sync Failed"):B=f.jsx(ym,{className:"h-4 w-4 mr-1"}),f.jsxs(Ts,{className:Je(R?"bg-muted/50":"",O&&!R?"opacity-70":""),children:[f.jsx(On,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:k.name}),f.jsx(On,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:k.remoteUrl}),f.jsx(On,{className:"hidden lg:table-cell",children:k.branch||"main"}),f.jsx(On,{className:"text-xs hidden lg:table-cell",children:A?"Configured":"None"}),f.jsxs(On,{className:"text-right space-x-1",children:[f.jsx(er,{tooltipText:D,onClick:()=>x(k.id),"aria-label":`Initialize or Sync repo ${k.name}`,disabled:O,icon:B,variant:"outline",className:"h-8 w-8"}),f.jsx(er,{tooltipText:"Edit",onClick:()=>b(k),"aria-label":`Edit repo ${k.name}`,disabled:O,icon:f.jsx(f1,{}),className:"h-8 w-8"}),f.jsx(er,{tooltipText:"Delete",onClick:()=>v(k.id,k.name),"aria-label":`Delete repo ${k.name}`,disabled:O,icon:C?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},k.id)})})]})})]})]})},CUe=Ve.memo(SUe),kUe=()=>{const e=E.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx(mUe,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(CUe,{})}],[]);return f.jsx(tc,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},EUe=Ve.memo(kUe);class TUe{constructor(){de(this,"id","core-git-sync");de(this,"unregisterPromptControlCallback",null);de(this,"unregisterSettingsTabCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"selectedItemId",null);de(this,"selectedItemType",null);de(this,"syncRepos",[]);de(this,"conversationSyncStatus",{});de(this,"isStreaming",!1);de(this,"autoSyncEnabled",!1);de(this,"isBulkSyncing",!1);de(this,"bulkSyncProgress",null);de(this,"notifyComponentUpdate",null);de(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Zn.linkConversationToRepoRequest,{conversationId:t,repoId:n})});de(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(Zn.syncConversationRequest,{conversationId:t})});de(this,"getConversationById",t=>Un.getState().getConversationById(t));de(this,"syncAllConversations",async()=>{await Un.getState().syncAllConversations()});de(this,"syncPendingConversations",async()=>{await Un.getState().syncPendingConversations()});de(this,"initializeAllRepositories",async()=>{await Un.getState().initializeAllRepositories()});de(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await Zr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>O0);return{BulkSyncService:n}},void 0);t.abort()});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Pr.contextChanged,m=>{var y;this.selectedItemId=m.selectedItemId,this.selectedItemType=m.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(us.repoChanged,()=>{var m;this.syncRepos=Un.getState().syncRepos,(m=this.notifyComponentUpdate)==null||m.call(this)}),s=t.on(Zn.conversationSyncStatusChanged,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"status"in m&&(this.conversationSyncStatus={...this.conversationSyncStatus,[m.conversationId]:m.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),i=t.on(Xn.statusChanged,m=>{var y;typeof m=="object"&&m&&"status"in m&&(this.isStreaming=m.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(Xn.completed,async m=>{typeof m=="object"&&m&&"interactionId"in m&&"status"in m&&m.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(sn.autoSyncOnStreamCompleteChanged,m=>{var y;typeof m=="object"&&m&&"enabled"in m&&(this.autoSyncEnabled=m.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(us.bulkSyncStarted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!0,this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(us.bulkSyncProgress,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(us.bulkSyncCompleted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(us.bulkSyncFailed,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(Zn.conversationUpdated,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"updates"in m&&m.conversationId===this.selectedItemId&&m.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=Un.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=Ln.getState().status==="streaming",this.autoSyncEnabled=mr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(fUe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:EUe,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const AUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=Un(gn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(xr,{delayDuration:100,children:f.jsxs(Bc,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Tc,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(zc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Yn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(ym,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Je("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(is,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Yn,{className:"h-3 w-3 animate-spin"}):f.jsx(ym,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings  Git  Sync Repositories to add one."})]})})]})})};class RUe{constructor(){de(this,"id","core-manual-git-sync-sidebar");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"syncRepos",[]);de(this,"repoInitializationStatus",{});de(this,"isSyncing",!1);de(this,"notifyComponentUpdate",null);de(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await Zr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>O0);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});de(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(Zn.initializeOrSyncRepoRequest,{repoId:t})});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(us.repoChanged,()=>{var i;this.syncRepos=Un.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(us.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(Zn.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=Un.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(AUe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const NUe=Ge({path:$e().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),MUe=Ge({path:$e().describe("The path of the file to read within the VFS."),encoding:yl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),IUe=Ge({path:$e().describe("The path where the file should be written."),content:$e().describe("The content to write to the file."),encoding:yl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),jUe=Ge({path:$e().describe("The path of the file or directory to delete."),recursive:Gn().optional().default(!1).describe("Whether to delete directories recursively.")}),PUe=Ge({path:$e().describe("The path of the directory to create (including parents).")}),OUe=Ge({oldPath:$e().describe("The current path of the item to rename."),newName:$e().describe("The new name for the item.")});class DUe{constructor(){de(this,"id","core-vfs-tools");de(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:NUe};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l||"/");try{const h=await mD(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(m=>({name:m.name,type:m.isDirectory?"folder":"file",size:m.size,lastModified:m.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:MUe};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{const m=await Yh(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...m)):y=new TextDecoder().decode(m),{success:!0,path:h,content:y,encoding:c}}catch(m){return{success:!1,path:h,error:m.message}}}));const s={description:"Write content to a file in the VFS.",parameters:IUe};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const m=zr(l);try{let y;if(u==="base64"){const b=atob(c),v=b.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=b.charCodeAt(w);y=x}else y=c;return await aT(m,y,{fsInstance:h}),{success:!0,path:m}}catch(y){return{success:!1,path:m,error:y.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:jUe};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l);try{return await gD(h,c,{fsInstance:d}),{success:!0,path:h}}catch(m){return{success:!1,path:h,error:m.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:PUe};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=zr(l);try{return await wZ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:OUe};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=zr(l),m=zr(h.substring(0,h.lastIndexOf("/"))||"/"),y=Pu(m,c);try{return await SZ(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const FUe=Ge({path:$e().describe("The directory path within the VFS to initialize as a Git repository.")}),LUe=Ge({path:$e().describe("The directory path of the Git repository within the VFS to commit."),message:$e().describe("The commit message.")}),BUe=Ge({path:$e().describe("The directory path of the Git repository within the VFS to pull from."),branch:$e().optional().describe("The branch name to pull.")}),$Ue=Ge({path:$e().describe("The directory path of the Git repository within the VFS to push."),branch:$e().optional().describe("The branch name to push.")}),zUe=Ge({path:$e().describe("The directory path of the Git repository within the VFS to check status.")});class UUe{constructor(){de(this,"id","core-git-tools");de(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:FUe};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await vZ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:LUe};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=mr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await hD(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:BUe};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await iT(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:$Ue};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await pD(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:zUe};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await xZ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class qUe{constructor(){de(this,"id","core-mcp-tools");de(this,"unregisterCallbacks",[]);de(this,"mcpToolUnregisterCallbacks",[]);de(this,"mcpClients",new Map);de(this,"modApi");de(this,"connectionAttempts",new Map);de(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,Pe.emit(kr.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};Pe.on(kr.serversChanged,t),this.unregisterCallbacks.push(()=>{Pe.off(kr.serversChanged,t)})}getRetryConfig(){const t=nl.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=nl.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),Me.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),Me.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),nl.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),Me.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";Me.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return u7({transport:n})}async getBridgeUrl(){const n=nl.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async m=>{const y=`${Date.now()}_${++h}`,b=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:y,method:"tools/call",params:{name:m.name,arguments:m.arguments}})});if(!b.ok)throw new Error(`Tool call failed: ${b.status} ${b.statusText}`);const v=await b.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return u7({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,S]of Object.entries(d.parameters.properties)){let k;switch(S.type){case"string":k=$e();break;case"number":k=Tt();break;case"boolean":k=Gn();break;case"array":k=on(qd());break;case"object":k=Ge({}).passthrough();break;default:k=qd()}S.description&&(k=k.describe(S.description)),x.includes(w)||(k=k.optional()),v[w]=k}h=Ge(v)}else h=Ge({});const m={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},y=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(S=>S.type==="text"?S.text:S.type==="image"?`[Image: ${S.mimeType||"unknown format"}]`:JSON.stringify(S)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},b=this.modApi.registerTool(u,m,y);this.mcpToolUnregisterCallbacks.push(b),Pe.emit(kr.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),nl.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};Me.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=nl.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=nl.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ge({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(m=>m.type==="text"?m.text:m.type==="image"?`[Image: ${m.mimeType||"unknown format"}]`:JSON.stringify(m)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=nl.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),Pe.emit(kr.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;Pe.emit(kr.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const VUe=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",kse=({enabledTools:e,onToggleTool:t,onToggleAll:n,disabled:r=!1,className:s,maxSteps:i,onMaxStepsChange:a,globalDefaultMaxSteps:o=5,showMaxSteps:l=!1,disabledMessage:c})=>{const u=Ui(x=>x.tools),[d,h]=E.useState(""),m=E.useMemo(()=>Object.entries(u).map(([x,{definition:w,modId:S}])=>({name:x,description:w.description??"No description provided.",modId:S})).sort((x,w)=>x.name.localeCompare(w.name)),[u]),y=E.useMemo(()=>{const x=d.trim().toLowerCase();return x?m.filter(w=>w.name.toLowerCase().includes(x)||w.description.toLowerCase().includes(x)||w.modId.toLowerCase().includes(x)):m},[m,d]),b=E.useCallback(x=>{if(!a)return;const w=x.target.value;if(w===""){a(null);return}const S=parseInt(w,10);if(isNaN(S))a(null);else{const k=Math.max(1,Math.min(20,S));a(k)}},[a]),v=i===null?"":String(i);return f.jsxs("div",{className:Je("p-4 max-w-2xl space-y-3",s),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter tools...",value:d,onChange:x=>h(x.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(jt,{className:"text-xs text-muted-foreground",children:[y.length," tools shown (",e.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(pt,{variant:"outline",size:"sm",onClick:()=>n(!0,m.map(x=>x.name)),disabled:r||m.length===0,children:"Enable All"}),f.jsx(pt,{variant:"outline",size:"sm",onClick:()=>n(!1,m.map(x=>x.name)),disabled:r||m.length===0||e.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:r&&c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:c}):m.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):y.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(Hl,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:y.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(Mo,{id:`tool-switch-${x.name}`,checked:e.has(x.name),onCheckedChange:w=>t(x.name,w),className:"flex-shrink-0",disabled:r}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(jt,{htmlFor:`tool-switch-${x.name}`,className:Je("block text-sm font-medium",r?"cursor-not-allowed":"cursor-pointer"),children:x.name}),f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:VUe(x.description)})}),f.jsx(Sr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:x.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",x.modId]}),f.jsx("div",{className:"text-xs",children:x.description})]})})]})]})]},x.name))})})}),l&&f.jsxs("div",{className:"pt-2",children:[f.jsx(jt,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(Sn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o),disabled:r}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},WUe=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=E.useCallback((h,m)=>{e.setEnabledTools(y=>{const b=new Set(y);return m?b.add(h):b.delete(h),b})},[e]),c=E.useCallback((h,m)=>{e.setEnabledTools(()=>h?new Set(m):new Set)},[e]),u=a!=="conversation"||!i;return f.jsx(kse,{enabledTools:s,onToggleTool:l,onToggleAll:c,disabled:u,className:r,maxSteps:t,onMaxStepsChange:n,globalDefaultMaxSteps:o,showMaxSteps:!0,disabledMessage:"Select a conversation to manage tools."})},HUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();E.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=m=>{r(m),!m&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(Bc,{open:n,onOpenChange:u,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(Vx,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(zc,{className:"w-auto p-0",align:"start",children:f.jsx(WUe,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class GUe{constructor(){de(this,"id","core-tool-selector");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"transientEnabledTools",new Set);de(this,"transientMaxStepsOverride",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"selectedItemId",null);de(this,"selectedItemType",null);de(this,"allToolsCount",0);de(this,"globalDefaultMaxSteps",5);de(this,"notifyComponentUpdate",null);de(this,"getEnabledTools",()=>this.transientEnabledTools);de(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"getSelectedItemId",()=>this.selectedItemId);de(this,"getSelectedItemType",()=>this.selectedItemType);de(this,"getAllToolsCount",()=>this.allToolsCount);de(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);de(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(Xn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(fr.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Pr.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(sn.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on($r.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=Ln.getState().status==="streaming",this.selectedItemId=Un.getState().selectedItemId,this.selectedItemType=Un.getState().selectedItemType,this.allToolsCount=Object.keys(Ui.getState().tools).length,this.globalDefaultMaxSteps=mr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Nr.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(HUe,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var Nq=1,KUe=.9,YUe=.8,ZUe=.17,o3=.1,l3=.999,XUe=.9999,JUe=.99,QUe=/[\\\/_+.#"@\[\(\{&]/,eqe=/[\\\/_+.#"@\[\(\{&]/g,tqe=/[\s-]/,Ese=/[\s-]/g;function N4(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?Nq:JUe;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,m,y;c>=0;)d=N4(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=Nq:QUe.test(e.charAt(c-1))?(d*=YUe,m=e.slice(s,c-1).match(eqe),m&&s>0&&(d*=Math.pow(l3,m.length))):tqe.test(e.charAt(c-1))?(d*=KUe,y=e.slice(s,c-1).match(Ese),y&&s>0&&(d*=Math.pow(l3,y.length))):(d*=ZUe,s>0&&(d*=Math.pow(l3,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=XUe)),(d<o3&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=N4(e,t,n,r,c+1,i+2,a),h*o3>d&&(d=h*o3)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function Mq(e){return e.toLowerCase().replace(Ese," ")}function nqe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,N4(e,t,Mq(e),Mq(t),0,0,{})}var Bv='[cmdk-group=""]',c3='[cmdk-group-items=""]',rqe='[cmdk-group-heading=""]',Tse='[cmdk-item=""]',Iq=`${Tse}:not([aria-disabled="true"])`,M4="cmdk-item-select",u0="data-value",sqe=(e,t,n)=>nqe(e,t,n),Ase=E.createContext(void 0),n_=()=>E.useContext(Ase),Rse=E.createContext(void 0),Y6=()=>E.useContext(Rse),Nse=E.createContext(void 0),Mse=E.forwardRef((e,t)=>{let n=d0(()=>{var ee,se;return{search:"",value:(se=(ee=e.value)!=null?ee:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=d0(()=>new Set),s=d0(()=>new Map),i=d0(()=>new Map),a=d0(()=>new Set),o=Ise(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:m,loop:y,disablePointerSelection:b=!1,vimBindings:v=!0,...x}=e,w=oa(),S=oa(),k=oa(),C=E.useRef(null),R=mqe();Mm(()=>{if(u!==void 0){let ee=u.trim();n.current.value=ee,A.emit()}},[u]),Mm(()=>{R(6,W)},[]);let A=E.useMemo(()=>({subscribe:ee=>(a.current.add(ee),()=>a.current.delete(ee)),snapshot:()=>n.current,setState:(ee,se,me)=>{var ce,je,De,Se;if(!Object.is(n.current[ee],se)){if(n.current[ee]=se,ee==="search")D(),O(),R(1,B);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ce=document.getElementById(k);Ce?Ce.focus():(ce=document.getElementById(w))==null||ce.focus()}if(R(7,()=>{var Ce;n.current.selectedItemId=(Ce=P())==null?void 0:Ce.id,A.emit()}),me||R(5,W),((je=o.current)==null?void 0:je.value)!==void 0){let Ce=se??"";(Se=(De=o.current).onValueChange)==null||Se.call(De,Ce);return}}A.emit()}},emit:()=>{a.current.forEach(ee=>ee())}}),[]),N=E.useMemo(()=>({value:(ee,se,me)=>{var ce;se!==((ce=i.current.get(ee))==null?void 0:ce.value)&&(i.current.set(ee,{value:se,keywords:me}),n.current.filtered.items.set(ee,I(se,me)),R(2,()=>{O(),A.emit()}))},item:(ee,se)=>(r.current.add(ee),se&&(s.current.has(se)?s.current.get(se).add(ee):s.current.set(se,new Set([ee]))),R(3,()=>{D(),O(),n.current.value||B(),A.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let me=P();R(4,()=>{D(),(me==null?void 0:me.getAttribute("id"))===ee&&B(),A.emit()})}),group:ee=>(s.current.has(ee)||s.current.set(ee,new Set),()=>{i.current.delete(ee),s.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:k,labelId:S,listInnerRef:C}),[]);function I(ee,se){var me,ce;let je=(ce=(me=o.current)==null?void 0:me.filter)!=null?ce:sqe;return ee?je(ee,n.current.search,se):0}function O(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,se=[];n.current.filtered.groups.forEach(ce=>{let je=s.current.get(ce),De=0;je.forEach(Se=>{let Ce=ee.get(Se);De=Math.max(Ce,De)}),se.push([ce,De])});let me=C.current;Z().sort((ce,je)=>{var De,Se;let Ce=ce.getAttribute("id"),qe=je.getAttribute("id");return((De=ee.get(qe))!=null?De:0)-((Se=ee.get(Ce))!=null?Se:0)}).forEach(ce=>{let je=ce.closest(c3);je?je.appendChild(ce.parentElement===je?ce:ce.closest(`${c3} > *`)):me.appendChild(ce.parentElement===me?ce:ce.closest(`${c3} > *`))}),se.sort((ce,je)=>je[1]-ce[1]).forEach(ce=>{var je;let De=(je=C.current)==null?void 0:je.querySelector(`${Bv}[${u0}="${encodeURIComponent(ce[0])}"]`);De==null||De.parentElement.appendChild(De)})}function B(){let ee=Z().find(me=>me.getAttribute("aria-disabled")!=="true"),se=ee==null?void 0:ee.getAttribute(u0);A.setState("value",se||void 0)}function D(){var ee,se,me,ce;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let je=0;for(let De of r.current){let Se=(se=(ee=i.current.get(De))==null?void 0:ee.value)!=null?se:"",Ce=(ce=(me=i.current.get(De))==null?void 0:me.keywords)!=null?ce:[],qe=I(Se,Ce);n.current.filtered.items.set(De,qe),qe>0&&je++}for(let[De,Se]of s.current)for(let Ce of Se)if(n.current.filtered.items.get(Ce)>0){n.current.filtered.groups.add(De);break}n.current.filtered.count=je}function W(){var ee,se,me;let ce=P();ce&&(((ee=ce.parentElement)==null?void 0:ee.firstChild)===ce&&((me=(se=ce.closest(Bv))==null?void 0:se.querySelector(rqe))==null||me.scrollIntoView({block:"nearest"})),ce.scrollIntoView({block:"nearest"}))}function P(){var ee;return(ee=C.current)==null?void 0:ee.querySelector(`${Tse}[aria-selected="true"]`)}function Z(){var ee;return Array.from(((ee=C.current)==null?void 0:ee.querySelectorAll(Iq))||[])}function U(ee){let se=Z()[ee];se&&A.setState("value",se.getAttribute(u0))}function H(ee){var se;let me=P(),ce=Z(),je=ce.findIndex(Se=>Se===me),De=ce[je+ee];(se=o.current)!=null&&se.loop&&(De=je+ee<0?ce[ce.length-1]:je+ee===ce.length?ce[0]:ce[je+ee]),De&&A.setState("value",De.getAttribute(u0))}function L(ee){let se=P(),me=se==null?void 0:se.closest(Bv),ce;for(;me&&!ce;)me=ee>0?hqe(me,Bv):pqe(me,Bv),ce=me==null?void 0:me.querySelector(Iq);ce?A.setState("value",ce.getAttribute(u0)):H(ee)}let ne=()=>U(Z().length-1),V=ee=>{ee.preventDefault(),ee.metaKey?ne():ee.altKey?L(1):H(1)},Q=ee=>{ee.preventDefault(),ee.metaKey?U(0):ee.altKey?L(-1):H(-1)};return E.createElement(or.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var se;(se=x.onKeyDown)==null||se.call(x,ee);let me=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||me))switch(ee.key){case"n":case"j":{v&&ee.ctrlKey&&V(ee);break}case"ArrowDown":{V(ee);break}case"p":case"k":{v&&ee.ctrlKey&&Q(ee);break}case"ArrowUp":{Q(ee);break}case"Home":{ee.preventDefault(),U(0);break}case"End":{ee.preventDefault(),ne();break}case"Enter":{ee.preventDefault();let ce=P();if(ce){let je=new Event(M4);ce.dispatchEvent(je)}}}}},E.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:yqe},l),UT(e,ee=>E.createElement(Rse.Provider,{value:A},E.createElement(Ase.Provider,{value:N},ee))))}),iqe=E.forwardRef((e,t)=>{var n,r;let s=oa(),i=E.useRef(null),a=E.useContext(Nse),o=n_(),l=Ise(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Mm(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=jse(s,i,[e.value,e.children,i],e.keywords),d=Y6(),h=jh(R=>R.value&&R.value===u.current),m=jh(R=>c||o.filter()===!1?!0:R.search?R.filtered.items.get(s)>0:!0);E.useEffect(()=>{let R=i.current;if(!(!R||e.disabled))return R.addEventListener(M4,y),()=>R.removeEventListener(M4,y)},[m,e.onSelect,e.disabled]);function y(){var R,A;b(),(A=(R=l.current).onSelect)==null||A.call(R,u.current)}function b(){d.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:w,forceMount:S,keywords:k,...C}=e;return E.createElement(or.div,{ref:fl(i,t),...C,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:b,onClick:v?void 0:y},e.children)}),aqe=E.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=oa(),o=E.useRef(null),l=E.useRef(null),c=oa(),u=n_(),d=jh(m=>s||u.filter()===!1?!0:m.search?m.filtered.groups.has(a):!0);Mm(()=>u.group(a),[]),jse(a,o,[e.value,e.heading,l]);let h=E.useMemo(()=>({id:a,forceMount:s}),[s]);return E.createElement(or.div,{ref:fl(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&E.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),UT(e,m=>E.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},E.createElement(Nse.Provider,{value:h},m))))}),oqe=E.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=E.useRef(null),i=jh(a=>!a.search);return!n&&!i?null:E.createElement(or.div,{ref:fl(s,t),...r,"cmdk-separator":"",role:"separator"})}),lqe=E.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=Y6(),a=jh(c=>c.search),o=jh(c=>c.selectedItemId),l=n_();return E.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),E.createElement(or.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),cqe=E.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=E.useRef(null),a=E.useRef(null),o=jh(c=>c.selectedItemId),l=n_();return E.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),E.createElement(or.div,{ref:fl(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},UT(e,c=>E.createElement("div",{ref:fl(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),uqe=E.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return E.createElement(Pne,{open:n,onOpenChange:r},E.createElement(One,{container:a},E.createElement(Dne,{"cmdk-overlay":"",className:s}),E.createElement(Fne,{"aria-label":e.label,"cmdk-dialog":"",className:i},E.createElement(Mse,{ref:t,...o}))))}),dqe=E.forwardRef((e,t)=>jh(n=>n.filtered.count===0)?E.createElement(or.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),fqe=E.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return E.createElement(or.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},UT(e,a=>E.createElement("div",{"aria-hidden":!0},a)))}),pb=Object.assign(Mse,{List:cqe,Item:iqe,Input:lqe,Group:aqe,Separator:oqe,Dialog:uqe,Empty:dqe,Loading:fqe});function hqe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function pqe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function Ise(e){let t=E.useRef(e);return Mm(()=>{t.current=e}),t}var Mm=typeof window>"u"?E.useEffect:E.useLayoutEffect;function d0(e){let t=E.useRef();return t.current===void 0&&(t.current=e()),t}function jh(e){let t=Y6(),n=()=>e(t.snapshot());return E.useSyncExternalStore(t.subscribe,n,n)}function jse(e,t,n,r=[]){let s=E.useRef(),i=n_();return Mm(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(u0,o),s.current=o}),s}var mqe=()=>{let[e,t]=E.useState(),n=d0(()=>new Map);return Mm(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function gqe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function UT({asChild:e,children:t},n){return e&&E.isValidElement(t)?E.cloneElement(gqe(t),{ref:t.ref},n(t.props.children)):n(t)}var yqe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function Pse({className:e,...t}){return f.jsx(pb,{"data-slot":"command",className:Je("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function Ose({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(jo,{className:"size-4 shrink-0 opacity-50"}),f.jsx(pb.Input,{"data-slot":"command-input",className:Je("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function Dse({className:e,...t}){return f.jsx(pb.List,{"data-slot":"command-list",className:Je("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Fse({...e}){return f.jsx(pb.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function Lse({className:e,...t}){return f.jsx(pb.Group,{"data-slot":"command-group",className:Je("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function Bse({className:e,...t}){return f.jsx(pb.Item,{"data-slot":"command-item",className:Je("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const Z6=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=E.useMemo(()=>{let w=e;if(l.trim()){const k=l.toLowerCase();w=e.filter(C=>C.name.toLowerCase().includes(k)||C.providerName.toLowerCase().includes(k)||C.id.toLowerCase().includes(k))}const S=Object.entries(u).filter(([,k])=>k).map(([k])=>k);return S.length===0?w:w.filter(k=>{var N,I,O;const C=new Set(((N=k.metadataSummary)==null?void 0:N.supported_parameters)??[]),R=new Set(((I=k.metadataSummary)==null?void 0:I.input_modalities)??[]),A=new Set(((O=k.metadataSummary)==null?void 0:O.output_modalities)??[]);return S.every(B=>{switch(B){case"reasoning":return C.has("reasoning");case"webSearch":return C.has("web_search")||C.has("web_search_options");case"tools":return C.has("tools");case"multimodal":return Array.from(R).some(D=>D!=="text");case"imageGeneration":return A.has("image");default:return!0}})})},[e,l,u]),m=E.useMemo(()=>e.find(w=>w.id===t),[e,t]),y=E.useCallback(w=>{const S=w===t?null:w;n==null||n(S),o(!1),c("")},[t,n]),b=w=>{d(S=>({...S,[w]:!S[w]}))};if(i)return f.jsx(Wr,{className:Je("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(Bc,{open:a,onOpenChange:o,children:[f.jsx($c,{asChild:!0,children:f.jsxs(pt,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Je("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:m?`${m.name} (${m.providerName})`:"Select Model..."}),f.jsx(dE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(zc,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden"},children:f.jsxs(Pse,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(jo,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(Ose,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(pt,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Je("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(wB,{className:"h-4 w-4"})}),f.jsx(pt,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Je("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(SB,{className:"h-4 w-4"})}),f.jsx(pt,{variant:u.tools?"secondary":"ghost",size:"sm",className:Je("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Vx,{className:"h-4 w-4"})}),f.jsx(pt,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Je("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(Y0,{className:"h-4 w-4"})}),f.jsx(pt,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Je("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(sC,{className:"h-4 w-4"})})]})]}),f.jsxs(Dse,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(Fse,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(Lse,{children:h.map(w=>{var S,k,C,R,A,N,I,O,B,D,W,P;return f.jsx(Bse,{value:w.id,onSelect:y,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((k=(S=w.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:k.includes("reasoning"))&&f.jsx(wB,{className:"h-3.5 w-3.5 text-purple-500"}),(((R=(C=w.metadataSummary)==null?void 0:C.supported_parameters)==null?void 0:R.includes("web_search"))||((N=(A=w.metadataSummary)==null?void 0:A.supported_parameters)==null?void 0:N.includes("web_search_options")))&&f.jsx(SB,{className:"h-3.5 w-3.5 text-blue-500"}),((O=(I=w.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:O.includes("tools"))&&f.jsx(Vx,{className:"h-3.5 w-3.5 text-orange-500"}),((D=(B=w.metadataSummary)==null?void 0:B.input_modalities)==null?void 0:D.some(Z=>Z!=="text"))&&f.jsx(Y0,{className:"h-3.5 w-3.5 text-green-500"}),((P=(W=w.metadataSummary)==null?void 0:W.output_modalities)==null?void 0:P.includes("image"))&&f.jsx(sC,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},u3=Ge({systemPrompt:$e().nullable(),modelId:$e().nullable()}),bqe=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Nr(gn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=si({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:u3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return E.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:u3.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(Lo,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(Ii,{field:d}),f.jsx(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:u3.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(Z6,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(Ii,{field:d}),f.jsxs(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,m,y])=>f.jsxs(pt,{type:"submit",size:"sm",disabled:i||!d||h||m||!y,children:[(h||m)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"}),h||m?"Saving...":"Save Prompt Settings"]})})})]})};function i0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const vqe=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(i0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(i0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(Sn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(i0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(Sn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(i0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(i0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(k0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(i0,{field:l})]})})]}),jq=Ge({syncRepoId:$e().nullable()}),xqe=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=si({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:jq,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return E.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:jq.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(ep,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(np,{id:l.name,children:f.jsx(tp,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(rp,{children:[f.jsx(Eo,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(Eo,{value:c.id,children:c.name},c.id))]})]}),f.jsx(Ii,{field:l}),f.jsx(pt,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(pt,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},wqe=({projectId:e})=>{const t=E.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(K6,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(jt,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(jt,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(tc,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Je("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},_qe=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=E.useState(""),a=E.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Hl,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Pc,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(jt,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},Sqe=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=E.useMemo(()=>new Set(e??[]),[e]),i=E.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(jt,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(_qe,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},Cqe=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=E.useState(""),o=E.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Hl,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Pc,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(jt,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},kqe=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=E.useMemo(()=>new Set(e??[]),[e]),a=E.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(jt,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(Cqe,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},Eqe=Ge({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),Tqe=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=Fo(gn(U=>({getProjectById:U.getProjectById,updateProject:U.updateProject}))),a=Fo(U=>U.getEffectiveProjectSettings),o=Un(U=>U.syncRepos),l=mr(gn(U=>({globalSystemPrompt:U.globalSystemPrompt,temperature:U.temperature,maxTokens:U.maxTokens,topP:U.topP,topK:U.topK,presencePenalty:U.presencePenalty,frequencyPenalty:U.frequencyPenalty}))),c=Nr(U=>U.selectedModelId),u=Qs(U=>U.setVfsKey),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(null),[S,k]=E.useState(null),[C,R]=E.useState(!1),[A,N]=E.useState("prompt"),{project:I,effectiveSettings:O}=E.useMemo(()=>{const U=n?s(n):null,H=n?a(n):null;return{project:U,effectiveSettings:H}},[n,s,a]),B=si({defaultValues:{temperature:(I==null?void 0:I.temperature)??.7,topP:(I==null?void 0:I.topP)??1,maxTokens:(I==null?void 0:I.maxTokens)??null,topK:(I==null?void 0:I.topK)??null,presencePenalty:(I==null?void 0:I.presencePenalty)??0,frequencyPenalty:(I==null?void 0:I.presencePenalty)??0},validators:{onChangeAsync:Eqe,onChangeAsyncDebounceMs:500}}),D=E.useCallback(U=>{var L;if(!U)return null;const H=s(U);return H?((L=H.metadata)==null?void 0:L.syncRepoId)!==void 0?H.metadata.syncRepoId:D(H.parentId):null},[s]),W=n?D(n):null;E.useEffect(()=>{var U;e&&n&&I&&O?(u(n),h(I.systemPrompt??null),y(I.modelId??null),v(((U=I.metadata)==null?void 0:U.syncRepoId)??null),w(I.defaultTagIds??null),k(I.defaultRuleIds??null),B.reset({temperature:I.temperature??.7,topP:I.topP??1,maxTokens:I.maxTokens??null,topK:I.topK??null,presencePenalty:I.presencePenalty??0,frequencyPenalty:I.frequencyPenalty??0}),N("prompt")):e||(u(null),h(null),y(null),v(null),w(null),k(null),B.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,I,O,u,B]);const P=async()=>{if(!(!n||!I)){R(!0);try{const U=I.parentId?a(I.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},H=I.parentId?D(I.parentId):null,L={},ne={...I.metadata??{}},V=B.state.values;d!==U.systemPrompt?L.systemPrompt=d:L.systemPrompt=void 0,m!==U.modelId?L.modelId=m:L.modelId=void 0,V.temperature!==U.temperature?L.temperature=V.temperature:L.temperature=void 0,V.maxTokens!==U.maxTokens?L.maxTokens=V.maxTokens:L.maxTokens=void 0,V.topP!==U.topP?L.topP=V.topP:L.topP=void 0,V.topK!==U.topK?L.topK=V.topK:L.topK=void 0,V.presencePenalty!==U.presencePenalty?L.presencePenalty=V.presencePenalty:L.presencePenalty=void 0,V.frequencyPenalty!==U.frequencyPenalty?L.frequencyPenalty=V.frequencyPenalty:L.frequencyPenalty=void 0,b!==H?ne.syncRepoId=b:delete ne.syncRepoId,JSON.stringify(x)!==JSON.stringify(U.defaultTagIds)?L.defaultTagIds=x:L.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(U.defaultRuleIds)?L.defaultRuleIds=S:L.defaultRuleIds=void 0,L.metadata=ne,await i(n,L),Me.success(`Project "${I.name}" settings updated.`),t()}catch(U){Me.error("Failed to save project settings."),console.error("Failed to save project settings:",U)}finally{R(!1)}}},Z=E.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(bqe,{initialSystemPrompt:d,initialModelId:m,onSave:({systemPrompt:U,modelId:H})=>{h(U),y(H)},effectiveSystemPrompt:(O==null?void 0:O.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(O==null?void 0:O.modelId)??c,isParentSaving:C})},{value:"params",label:"Parameters",content:f.jsx(vqe,{form:B,effectiveTemperature:(O==null?void 0:O.temperature)??l.temperature,effectiveMaxTokens:(O==null?void 0:O.maxTokens)??l.maxTokens,effectiveTopP:(O==null?void 0:O.topP)??l.topP??1,effectiveTopK:(O==null?void 0:O.topK)??l.topK,effectivePresencePenalty:(O==null?void 0:O.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(O==null?void 0:O.frequencyPenalty)??l.frequencyPenalty??0,isSaving:C})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(Sqe,{defaultRuleIds:S,setDefaultRuleIds:k,isSaving:C,allRules:r.getAllRules()}),f.jsx(kqe,{defaultTagIds:x,setDefaultTagIds:w,isSaving:C,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(xqe,{initialSyncRepoId:b,onSave:({syncRepoId:U})=>{v(U)},effectiveSyncRepoId:W,syncRepos:o,isParentSaving:C})},{value:"vfs",label:"Filesystem",content:f.jsx(wqe,{projectId:n,projectName:(I==null?void 0:I.name)??null,isSaving:C})}],[d,m,b,x,S,B,O,l,c,C,W,o,n,I==null?void 0:I.name,r]);return f.jsx(ap,{open:e,onOpenChange:t,children:f.jsxs(op,{className:Je("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(lp,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsxs(cp,{children:["Project Settings: ",I==null?void 0:I.name]}),f.jsx(Xm,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(tc,{tabs:Z,initialValue:A,onValueChange:N,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(fb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[f.jsx(pt,{variant:"outline",onClick:t,disabled:C,children:"Cancel"}),f.jsxs(pt,{onClick:P,disabled:C,children:[C&&f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class Aqe{constructor(){de(this,"id","core-project-settings");de(this,"modalId","projectSettingsModal");de(this,"unregisterModalProviderCallback",null);de(this,"modApiRef",null);de(this,"eventUnsubscribers",[]);de(this,"allRules",[]);de(this,"allTags",[]);de(this,"tagRuleLinks",[]);de(this,"getAllRules",()=>this.allRules);de(this,"getAllTags",()=>this.allTags);de(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});de(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Pr.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});de(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Pr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(br.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(br.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(Tqe,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const X6=Ve.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Nr(h=>h.getGloballyEnabledModelDefinitions()),d=E.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(Z6,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});X6.displayName="GlobalModelSelector";class Rqe{constructor(){de(this,"id","core-global-model-selector");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"selectedModelId",null);de(this,"isStreaming",!1);de(this,"isLoadingProviders",!0);de(this,"globallyEnabledModels",[]);de(this,"notifyComponentUpdate",null);de(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(fr.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(yn.setModelIdRequest,{id:t})});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Nr.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=Ln.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(Xn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(fr.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(yn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(fr.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Nr.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Nr.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(yn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(fr.initialDataLoaded,()=>{var u,d;const o=Nr.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(yn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>Ve.createElement(X6,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Nqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();E.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]);const c=E.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=E.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=m=>{m&&i(e.getTurnSystemPrompt()),r(m)},h=l.trim().length>0;return f.jsxs(Bc,{open:n,onOpenChange:d,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(Bge,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(zc,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(jt,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(Lo,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:m=>i(m.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(pt,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(pt,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class Mqe{constructor(){de(this,"id","core-system-prompt");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"turnSystemPromptValue","");de(this,"effectiveSystemPrompt",null);de(this,"isStreaming",!1);de(this,"notifyComponentUpdate",null);de(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);de(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=Ln.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Pr.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(xa.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(sn.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=Un.getState(),n=Fo.getState(),r=mr.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Nqe,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Iqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=E.useState(!1),[i,a]=E.useState(n??""),[o,l]=E.useState(""),[c,u]=E.useState([]),d=E.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),Me.success("Structured output applied for next turn.")}catch{Me.error("Invalid JSON format.")}},[i,e]),h=E.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),Me.info("Structured output cleared.")},[e]),m=E.useCallback(()=>{if(!o.trim()){Me.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(S=>[...S,w]),l(""),Me.success(`"${w.name}" saved to library.`)}catch{Me.error("Cannot save invalid JSON to library.")}},[i,o]),y=E.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),Me.success(`Loaded "${w.name}" from library.`)},[e]),b=E.useCallback(w=>{u(S=>S.filter(k=>k.id!==w)),Me.info("Item removed from library.")},[]);E.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(jt,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(Lo,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(jt,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(Sn,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(pt,{size:"sm",variant:"outline",onClick:m,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx(ef,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(pt,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(pt,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(pt,{size:"sm",variant:"outline",onClick:()=>y(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(pt,{size:"icon",variant:"ghost",onClick:()=>b(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(Ao,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(Bc,{open:r,onOpenChange:s,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(pE,{className:"h-4 w-4"})})})}),f.jsx(Sr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(zc,{className:"w-[450px] p-0",align:"start",children:f.jsx(tc,{tabs:v,defaultValue:"entry"})})]})},jqe=({module:e})=>{const[,t]=E.useState({});return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(Iqe,{module:e}):null};class Pqe{constructor(){de(this,"id","core-structured-output");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"structuredOutputJson",null);de(this,"isVisible",!0);de(this,"notifyComponentUpdate",null);de(this,"getStructuredOutputJson",()=>this.structuredOutputJson);de(this,"getIsVisible",()=>this.isVisible);de(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(yn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Po.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(fr.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(yn.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Nr.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(jqe,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(yn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Oqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=E.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(Lpe,{className:Je("h-3 w-3 fill-current",l)})})}),f.jsx(Sr,{side:"top",children:u})]})})},$se=4,Dqe=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/$se)};class Fqe{constructor(){de(this,"id","core-usage-display");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"currentInputText","");de(this,"historyTokens",0);de(this,"attachedFiles",[]);de(this,"selectedModelId",null);de(this,"contextLength",0);de(this,"notifyComponentUpdate",null);de(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/$se)});de(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());de(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(yn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Bl.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(fr.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(Xn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Pr.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=gh.getState(),n=Nr.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=Ln.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=Dqe(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Nr.getState(),{providerId:r,modelId:s}=_c(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=MG(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Oqe,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const Lqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Ly,{className:Je("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class Bqe{constructor(){de(this,"id","core-reasoning");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"reasoningEnabled",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"notifyComponentUpdate",null);de(this,"getReasoningEnabled",()=>this.reasoningEnabled);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(yn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Po.getState().reasoningEnabled,this.isStreaming=Ln.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(fr.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(yn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Nr.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Lqe,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(yn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const $qe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(jo,{className:Je("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class zqe{constructor(){de(this,"id","core-web-search");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"webSearchEnabled",null);de(this,"isStreaming",!1);de(this,"isVisible",!0);de(this,"notifyComponentUpdate",null);de(this,"getWebSearchEnabled",()=>this.webSearchEnabled);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsVisible",()=>this.isVisible);de(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(yn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Po.getState().webSearchEnabled,this.isStreaming=Ln.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(fr.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(yn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Nr.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement($qe,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(yn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const zse=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=E.useState(""),[c,u]=E.useState(""),d=E.useMemo(()=>{const w=o.toLowerCase();return w?i.filter(S=>{var k;return S.name.toLowerCase().includes(w)||((k=S.description)==null?void 0:k.toLowerCase().includes(w))}):i},[i,o]),h=E.useMemo(()=>{const w=c.toLowerCase();return w?s.filter(S=>S.name.toLowerCase().includes(w)||S.content.toLowerCase().includes(w)||S.type.toLowerCase().includes(w)):s},[s,c]),m=E.useCallback((w,S)=>{n(w,S)},[n]),y=E.useCallback((w,S)=>{r(w,S)},[r]),b=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter tags...",value:o,onChange:w=>l(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(w=>{const S=a(w.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Pc,{id:`tag-activate-${w.id}`,checked:e.has(w.id),onCheckedChange:k=>m(w.id,!!k),className:"mt-0.5"}),f.jsxs(jt,{htmlFor:`tag-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),w.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:w.description}),S.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",S.map(k=>k.name).join(", ")]})]})]})},w.id)})})})]}),v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter rules...",value:c,onChange:w=>u(w.target.value),className:"pl-8 h-9"})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(w=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(Pc,{id:`rule-activate-${w.id}`,checked:t.has(w.id),onCheckedChange:S=>y(w.id,!!S),className:"mt-0.5"}),f.jsxs(jt,{htmlFor:`rule-activate-${w.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:w.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",w.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",w.content]})]})]})},w.id))})})]}),x=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(tc,{tabs:x,defaultValue:"tags",scrollable:!1})})},Uqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=E.useCallback((v,x)=>{e.setActiveTagIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),h=E.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),m=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},y=s.size>0||i.size>0,b=a;return f.jsxs(Bc,{open:n,onOpenChange:r,children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:o?f.jsx($c,{asChild:!0,children:f.jsx(pt,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:m,children:f.jsx(TB,{className:"h-4 w-4"})})}):f.jsx(pt,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:m,children:f.jsx(TB,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",children:o?y?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(zc,{className:"w-auto p-0",align:"start",children:f.jsx(zse,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function qqe({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Je("space-y-1.5",a),children:[f.jsx(jt,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Lo,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Je(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(Ii,{field:u})]})}})}const Vqe=Ge({name:$e().min(1,"Rule Name is required."),content:$e().min(1,"Rule Content is required."),type:yl(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),Wqe=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],Hqe=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=si({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:Vqe,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(Vw,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(Mx,{form:s,name:"type",label:"Rule Type",options:Wqe,placeholder:"Select Type",disabled:t})]}),f.jsx(qqe,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(pt,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(Wi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(pt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},Gqe=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Type"}),f.jsx(Tr,{children:"Content Preview"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Ts,{children:f.jsx(On,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(Ts,{children:[f.jsx(On,{className:"font-medium",children:a.name}),f.jsx(On,{className:"capitalize",children:a.type}),f.jsx(On,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(On,{className:"text-right space-x-1",children:[f.jsx(er,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(f1,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(er,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},Kqe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),[u,d]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},m=x=>{o(x),i(!0)},y=E.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=E.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),y()}catch{}finally{c(!1)}},[e,a,y]),v=E.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&y()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,y]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(pt,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(Hqe,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(Gqe,{rules:n,isLoading:r,isDeleting:u,onEdit:m,onDelete:v})]})]})},d3=Ge({name:$e().min(1,"Tag Name is required."),description:$e().nullable()}),Yqe=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=si({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:d3,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:d3.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Tag Name"}),f.jsx(Sn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(Ii,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:d3.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(Lo,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(Ii,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(pt,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(Wi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(pt,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Yn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(ef,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},Zqe=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Description"}),f.jsx(Tr,{children:"Linked Rules"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(On,{colSpan:4,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Ts,{children:f.jsx(On,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(Ts,{children:[f.jsx(On,{className:"font-medium",children:o.name}),f.jsx(On,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(On,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(On,{className:"text-right space-x-1",children:[f.jsx(er,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(f1,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(er,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},Xqe=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=E.useState(!1),[o,l]=E.useState(""),c=E.useMemo(()=>[...t].sort((y,b)=>y.name.localeCompare(b.name)),[t]),u=E.useMemo(()=>{const y=o.toLowerCase();return y?c.filter(b=>b.name.toLowerCase().includes(y)||b.content.toLowerCase().includes(y)||b.type.toLowerCase().includes(y)):c},[c,o]),d=E.useCallback(y=>{const b=n.has(y);r(e.id,y,!b),l("")},[n,r,e.id]),h=E.useCallback((y,b)=>{b.stopPropagation(),r(e.id,y,!1)},[r,e.id]),m=E.useMemo(()=>c.filter(y=>n.has(y.id)),[c,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(jt,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs(Bc,{open:i,onOpenChange:a,children:[f.jsx($c,{asChild:!0,children:f.jsxs(pt,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,children:[f.jsx("span",{className:"truncate",children:m.length>0?`${m.length} rule(s) selected`:"Select rules..."}),f.jsx(dE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),f.jsx(zc,{className:"w-[--radix-popover-trigger-width] p-0",children:f.jsxs(Pse,{shouldFilter:!1,children:[f.jsx(Ose,{placeholder:"Search rules...",value:o,onValueChange:l}),f.jsxs(Dse,{children:[f.jsx(Fse,{children:t.length===0?"No rules defined.":"No rules found."}),f.jsx(Lse,{children:u.map(y=>{const b=n.has(y.id);return f.jsxs(Bse,{value:y.id,onSelect:()=>d(y.id),className:"cursor-pointer",children:[f.jsx(so,{className:Je("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:y.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]})})]}),m.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:m.map(y=>f.jsxs(is,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:y.name}),f.jsx(pt,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>h(y.id,b),disabled:s,"aria-label":`Unlink rule ${y.name}`,children:f.jsx(Wi,{className:"h-3 w-3"})})]},y.id))})]})},Jqe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},v=A=>{u(A),l(!0)},x=E.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=E.useCallback(async A=>{h(!0);try{c?e.updateTag(c.id,A):e.addTag(A),c||x()}catch{}finally{h(!1)}},[e,c,x]),S=E.useCallback(async A=>{y(N=>({...N,[A]:!0}));try{e.deleteTag(A),(c==null?void 0:c.id)===A&&x()}catch{}finally{y(N=>({...N,[A]:!1}))}},[e,c,x]),k=E.useCallback(async(A,N,I)=>{try{I?e.linkTagToRule(A,N):e.unlinkTagFromRule(A,N)}catch{}},[e]),C=E.useMemo(()=>{const A=new Map;return n.forEach(N=>{A.set(N.id,i(N.id))}),A},[n,i]),R=E.useMemo(()=>c?new Set(s.filter(A=>A.tagId===c.id).map(A=>A.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(pt,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(Yqe,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(Xqe,{tag:c,allRules:r,linkedRuleIds:R,onLinkChange:k,disabled:d})]}),f.jsx(Ih,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(Zqe,{tags:n,rulesByTagId:C,isLoading:a,isDeleting:m,onEdit:v,onDelete:S})]})]})},Qqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=E.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx(Kqe,{module:e})},{value:"tags",label:"Tags",content:f.jsx(Jqe,{module:e})}],[e]);return f.jsx(tc,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class eVe{constructor(){de(this,"id","core-rules-tags");de(this,"unregisterPromptControlCallback",null);de(this,"unregisterSettingsTabCallback",null);de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"allRules",[]);de(this,"allTags",[]);de(this,"tagRuleLinks",[]);de(this,"transientActiveTagIds",new Set);de(this,"transientActiveRuleIds",new Set);de(this,"isStreaming",!1);de(this,"hasRulesOrTags",!1);de(this,"isLoadingRules",!0);de(this,"notifyComponentUpdate",null);de(this,"notifySettingsComponentUpdate",null);de(this,"getAllRules",()=>this.allRules);de(this,"getAllTags",()=>this.allTags);de(this,"getTagRuleLinks",()=>this.tagRuleLinks);de(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});de(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));de(this,"getTagById",t=>this.allTags.find(n=>n.id===t));de(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});de(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(br.addRuleRequest,t)});de(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(br.updateRuleRequest,{id:t,updates:n})});de(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(br.deleteRuleRequest,{id:t})});de(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(br.addTagRequest,t)});de(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(br.updateTagRequest,{id:t,updates:n})});de(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(br.deleteTagRequest,{id:t})});de(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(br.linkTagToRuleRequest,{tagId:t,ruleId:n})});de(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(br.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});de(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Pr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);de(this,"getIsLoadingRules",()=>this.isLoadingRules);de(this,"getActiveTagIds",()=>this.transientActiveTagIds);de(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);de(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});de(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(br.loadRulesAndTagsRequest,void 0);const n=t.on(Xn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(br.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>Ve.createElement(Uqe,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>Ve.createElement(Qqe,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const tVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=E.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(xH,{className:Je("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class nVe{constructor(){de(this,"id","core-auto-title");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"turnAutoTitleEnabled",!1);de(this,"isStreaming",!1);de(this,"isFirstInteraction",!1);de(this,"globalAutoTitleEnabled",!0);de(this,"notifyComponentUpdate",null);de(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"getIsFirstInteraction",()=>this.isFirstInteraction);de(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);de(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=Ln.getState().status==="streaming",this.globalAutoTitleEnabled=mr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(Xn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Pr.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Xn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(sn.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=Ln.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(tVe,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function rVe(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class sVe{constructor(){de(this,"id","core-url-parameters");de(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(ip.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),Me.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=rVe();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){Me.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(Zn.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(Zn.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(Zn.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Nr.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(yn.setModelIdRequest,{id:o}),t.emit(fr.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);Me.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else Me.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){Me.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await Yh(l,{fsInstance:o}),u=await o.promises.stat(l),d=bi(l),h="application/octet-stream",m=Yx(d,h);let y={};if(m)y.contentText=new TextDecoder().decode(c);else{let b="";const v=c.byteLength;for(let x=0;x<v;x++)b+=String.fromCharCode(c[x]);y.contentBase64=window.btoa(b)}t.emit(Bl.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),Me.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?Me.warning(`VFS file not found: ${l}`):Me.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(yn.inputChanged,{value:n.query}),Me.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=gh.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:ws(),content:n.query,parameters:a,metadata:o};t.emit(yn.submitted,{turnData:c});const u=await PC(ny.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){Me.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await Cx.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(Me.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){Me.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const iVe=({module:e})=>{const[t,n]=E.useState(!1),[,r]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=E.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx(pt,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(sC,{className:Je("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Sr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class aVe{constructor(){de(this,"id","core-image-generation");de(this,"modApiRef",null);de(this,"isImageGenerationEnabled",null);de(this,"unregisterCallback",null);de(this,"notifyComponentUpdate",null);de(this,"eventUnsubscribers",[]);de(this,"isVisible",!1);de(this,"isStreaming",!1);de(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);de(this,"getIsVisible",()=>this.isVisible);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(yn.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=Ln.getState().status==="streaming",this.updateVisibility();const n=t.on(fr.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(Xn.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Nr.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(iVe,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(yn.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(yn.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const oVe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState([]),[i,a]=E.useState(250),[,o]=E.useState({}),{status:l}=Ln(gn(b=>({status:b.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>o({})),()=>e.setNotifyCallback(null)},[e]);const c=(b,v)=>{s(x=>v?[...x,b]:x.filter(w=>w!==b))},u=()=>{if(r.length<2){Me.error("Please select at least 2 models to race");return}e.setRaceMode(!0,r,i),n(!1),Me.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250)},d=()=>{e.setRaceMode(!1),Me.info("Race mode disabled")},h=b=>{if(b.stopPropagation(),e.isRaceModeActive){d();return}if(l==="streaming"){Me.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){Me.info("Need at least 2 models enabled to race");return}n(!0)},m=l!=="streaming"&&e.globallyEnabledModels.length>=2,y=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":l==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(er,{tooltipText:y(),onClick:h,"aria-label":"Race Multiple Models Against Each Other",disabled:!m,icon:f.jsx(bH,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(ap,{open:t,onOpenChange:n,children:f.jsxs(op,{className:"max-w-md",children:[f.jsxs(lp,{children:[f.jsx(cp,{children:"Race Models"}),f.jsx(Xm,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"stagger-input",children:"Stagger Delay (ms)"}),f.jsx(Sn,{id:"stagger-input",type:"number",min:"0",max:"5000",step:"50",value:i,onChange:b=>a(parseInt(b.target.value)||250),placeholder:"250",className:"w-full"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay between starting each model (0-5000ms)"})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(jt,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(Hl,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:e.globallyEnabledModels.map(b=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Pc,{id:`model-${b.id}`,checked:r.includes(b.id),onCheckedChange:v=>c(b.id,v===!0)}),f.jsx(jt,{htmlFor:`model-${b.id}`,className:"text-sm cursor-pointer flex-1 min-w-0",children:f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:b.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",b.providerName,")"]})]})})]},b.id))})}),e.globallyEnabledModels.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No models available"})]})]}),f.jsxs(fb,{children:[f.jsx(pt,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(pt,{onClick:u,disabled:r.length<2||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class lVe{constructor(){de(this,"id","race-prompt-control");de(this,"eventUnsubscribers",[]);de(this,"modApi",null);de(this,"notifyComponentUpdate",null);de(this,"isRaceMode",!1);de(this,"raceModelIds",[]);de(this,"raceStaggerMs",250);de(this,"globallyEnabledModels",[]);de(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Nr.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(fr.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(fr.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(ny.PROMPT_TURN_FINALIZE,async a=>this.isRaceMode?await this.handleRaceSubmission(a.turnData):a);this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n,r){var s;this.isRaceMode=t,t&&n&&r!==void 0?(this.raceModelIds=n,this.raceStaggerMs=r):(this.raceModelIds=[],this.raceStaggerMs=250),(s=this.notifyComponentUpdate)==null||s.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceSubmission(t){try{console.log(`[RacePromptControlModule] Starting race submission with ${this.raceModelIds.length} models:`,this.raceModelIds);const n=Ln.getState(),r=n.currentConversationId;if(!r)return Me.error("No active conversation for racing"),!1;if(this.raceModelIds.length===0)return Me.error("No models selected for racing"),this.setRaceMode(!1),!1;Me.info(`Racing ${this.raceModelIds.length} models with your prompt...`);const i=n.interactions.filter(y=>y.conversationId===r).reduce((y,b)=>Math.max(y,b.index),-1)+1,a=await this.buildPromptObject(t,r,i),o=[...this.raceModelIds],l=this.raceStaggerMs,u=Po.getState().modelId;if(!u)return Me.error("No model currently selected"),this.setRaceMode(!1),!1;this.setRaceMode(!1);const d={...a,metadata:{...a.metadata,modelId:u}},h=await fm.startInteraction(d,r,t,"message.user_assistant");if(!h)throw new Error("Failed to create main race interaction");const m=o.map((y,b)=>new Promise(v=>{setTimeout(async()=>{try{const x={...a,metadata:{...a.metadata,modelId:y,raceTab:!0,raceParticipantIndex:b+1}},w=await fm.startInteraction(x,r,t,"message.assistant_regen");if(w){const S={parentId:h.id,index:b+1};n._updateInteractionInState(w.id,S),await St.saveInteraction({...w,...S})}v()}catch(x){console.error(`[RacePromptControlModule] Race participant ${b+1} failed:`,x),v()}},(b+1)*l)}));return await Promise.all(m),Me.success(`Race started! Current model + ${o.length} race models responding in tabs.`),!1}catch(n){return Me.error(`Race failed: ${String(n)}`),console.error("[RacePromptControlModule] Error during race:",n),this.setRaceMode(!1),!1}}async buildPromptObject(t,n,r){var A,N,I;const s=Ln.getState(),i=Fo.getState(),o=Un.getState().getConversationById(n),l=(o==null?void 0:o.projectId)??null,c=i.getEffectiveProjectSettings(l),u=s.interactions.filter(O=>O.conversationId===n&&O.index<r&&O.status==="COMPLETED"&&O.type==="message.user_assistant"&&O.parentId===null).sort((O,B)=>O.index-B.index),d=mj(u);let h=t.content;const m=[],y=((A=t.metadata)==null?void 0:A.effectiveRulesContent)??[],b=y.filter(O=>O.type==="system").map(O=>O.content),v=y.filter(O=>O.type==="before").map(O=>O.content),x=y.filter(O=>O.type==="after").map(O=>O.content);v.length>0&&(h=`${v.join(`
`)}

${h}`),x.length>0&&(h=`${h}

${x.join(`
`)}`),h&&m.push({type:"text",text:h});const w=((N=t.metadata)==null?void 0:N.attachedFiles)??[];w.length>0,m.length>0&&d.push({role:"user",content:m});let k=((I=t.metadata)==null?void 0:I.turnSystemPrompt)??c.systemPrompt??void 0;b.length>0&&(k=`${k?`${k}

`:""}${b.join(`
`)}`);const C=Po.getState(),R={temperature:C.temperature,max_tokens:C.maxTokens,top_p:C.topP,top_k:C.topK,presence_penalty:C.presencePenalty,frequency_penalty:C.frequencyPenalty,...t.parameters??{}};return Object.keys(R).forEach(O=>{(R[O]===null||R[O]===void 0)&&delete R[O]}),{system:k,messages:d,parameters:R,metadata:{...t.metadata??{},attachedFiles:w.map(({contentBase64:O,contentText:B,...D})=>D)}}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(oVe,{module:this})})}}const fx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,m=y=>{u(y.target.value)};return f.jsxs("div",{className:Je("space-y-1.5",a),children:[t&&f.jsx(jt,{htmlFor:l,className:Je("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(Sn,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:m,placeholder:r,className:Je(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},cVe=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Je("space-y-1.5",o),children:[t&&f.jsx(jt,{htmlFor:e.name,className:Je("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(Lo,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Je(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),uVe=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Je("space-y-1.5",o),children:[t&&f.jsx(jt,{htmlFor:e.name+"-trigger",className:Je("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(ep,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(np,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Je(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(tp,{placeholder:n||"Select an option"})}),f.jsx(rp,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(Eo,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),dVe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Je("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Pc,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(jt,{htmlFor:e.name,className:Je("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),fVe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Je("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Mo,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(jt,{htmlFor:e.name,className:Je("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),hVe=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:m}=e,y=d.value,b=x=>{const w=x.target.value;if(w==="")h(void 0);else{const S=parseFloat(w);h(isNaN(S)?w:S)}};let v="";return(typeof y=="number"||typeof y=="string")&&(v=y),f.jsxs("div",{className:Je("space-y-1.5",a),children:[t&&f.jsx(jt,{htmlFor:u,className:Je("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(Sn,{id:u,name:u,type:"number",value:v,onBlur:m,onChange:b,placeholder:r,min:o,max:l,step:c,className:Je(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},f3={},hx={};function Ix(e,t){try{const r=(f3[e]||(f3[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in hx?hx[r]:Pq(r,r.split(":"))}catch{if(e in hx)return hx[e];const n=e==null?void 0:e.match(pVe);return n?Pq(e,n.slice(1)):NaN}}const pVe=/([+-]\d\d):?(\d\d)?/;function Pq(e,t){const n=+t[0],r=+(t[1]||0);return hx[e]=n>0?n*60+r:n*60-r}class xu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Ix(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Use(this),I4(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new xu(...n,t):new xu(Date.now(),t)}withTimeZone(t){return new xu(+this,t)}getTimezoneOffset(){return-Ix(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),I4(this),+this}[Symbol.for("constructDateFrom")](t){return new xu(+new Date(t),this.timeZone)}}const Oq=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!Oq.test(e))return;const t=e.replace(Oq,"$1UTC");xu.prototype[t]&&(e.startsWith("get")?xu.prototype[e]=function(){return this.internal[t]()}:(xu.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),mVe(this),+this},xu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),I4(this),+this}))});function I4(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function mVe(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Use(e)}function Use(e){const t=Ix(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=Ix(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=Ix(e.timeZone,e),y=l-m;y&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y))}}class ja extends xu{static tz(t,...n){return n.length?new ja(...n,t):new ja(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${gVe(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new ja(+this,t)}[Symbol.for("constructDateFrom")](t){return new ja(+new Date(t),this.timeZone)}}function gVe(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var Fn;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(Fn||(Fn={}));var Js;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Js||(Js={}));var vc;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(vc||(vc={}));var rl;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(rl||(rl={}));const Dq=5,yVe=4;function bVe(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,Dq*7-1);return t.getMonth(e)===t.getMonth(i)?Dq:yVe}function qse(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function vVe(e,t){const n=qse(e,t),r=bVe(e,t);return t.addDays(n,r*7-1)}class lf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?ja.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new ja(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):AZ(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):RZ(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):wTe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):_Te(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):MZ(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):jZ(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):OTe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):vVe(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):LTe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):PZ(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):DZ(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):FTe(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):Ad(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):FZ(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):DAe(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):FAe(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):BZ(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):LAe(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):BAe(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):IZ(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):ETe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):$Ae(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):zAe(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):STe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):CTe(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):sRe(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):iRe(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):qse(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):ww(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):xw(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):DTe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):yy(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):OZ(r)},this.options={locale:oT,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const Uu=new lf;class Vse{constructor(t,n,r=Uu){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class xVe{constructor(t,n){this.date=t,this.weeks=n}}class wVe{constructor(t,n){this.days=n,this.weekNumber=t}}function Rd(e,t,n=!1,r=Uu){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function Wse(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function J6(e){return!!(e&&typeof e=="object"&&"from"in e)}function Hse(e){return!!(e&&typeof e=="object"&&"after"in e)}function Gse(e){return!!(e&&typeof e=="object"&&"before"in e)}function Kse(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Yse(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Nd(e,t,n=Uu){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(Yse(o,n))return o.includes(e);if(J6(o))return Rd(o,e,!1,n);if(Kse(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(Wse(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return Hse(o)?i(e,o.after)>0:Gse(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function _Ve(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:m,isAfter:y}=n,b=t.startMonth&&d(t.startMonth),v=t.endMonth&&m(t.endMonth),x={[Js.focused]:[],[Js.outside]:[],[Js.disabled]:[],[Js.hidden]:[],[Js.today]:[]},w={};for(const S of e){const{date:k,displayMonth:C}=S,R=!!(C&&!u(k,C)),A=!!(b&&h(k,b)),N=!!(v&&y(k,v)),I=!!(r&&Nd(k,r,n)),O=!!(s&&Nd(k,s,n))||A||N||!o&&!a&&R||o&&a===!1&&R,B=c(k,l??n.today());R&&x.outside.push(S),I&&x.disabled.push(S),O&&x.hidden.push(S),B&&x.today.push(S),i&&Object.keys(i).forEach(D=>{const W=i==null?void 0:i[D];W&&Nd(k,W,n)&&(w[D]?w[D].push(S):w[D]=[S])})}return S=>{const k={[Js.focused]:!1,[Js.disabled]:!1,[Js.hidden]:!1,[Js.outside]:!1,[Js.today]:!1},C={};for(const R in x){const A=x[R];k[R]=A.some(N=>N===S)}for(const R in w)C[R]=w[R].some(A=>A===S);return{...k,...C}}}function SVe(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[Js[i]]?s.push(t[Js[i]]):t[vc[i]]&&s.push(t[vc[i]]),s),[t[Fn.Day]])}function CVe(e){return Ve.createElement("button",{...e})}function kVe(e){return Ve.createElement("span",{...e})}function EVe(e){const{size:t=24,orientation:n="left",className:r}=e;return Ve.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&Ve.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&Ve.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&Ve.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&Ve.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function TVe(e){const{day:t,modifiers:n,...r}=e;return Ve.createElement("td",{...r})}function AVe(e){const{day:t,modifiers:n,...r}=e,s=Ve.useRef(null);return Ve.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),Ve.createElement("button",{ref:s,...r})}function RVe(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[Fn.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return Ve.createElement("span",{"data-disabled":i.disabled,className:s[Fn.DropdownRoot]},Ve.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>Ve.createElement(r.Option,{key:l,value:l,disabled:u},c))),Ve.createElement("span",{className:s[Fn.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,Ve.createElement(r.Chevron,{orientation:"down",size:18,className:s[Fn.Chevron]})))}function NVe(e){return Ve.createElement("div",{...e})}function MVe(e){return Ve.createElement("div",{...e})}function IVe(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r},e.children)}function jVe(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r})}function PVe(e){return Ve.createElement("table",{...e})}function OVe(e){return Ve.createElement("div",{...e})}const Zse=E.createContext(void 0);function r_(){const e=E.useContext(Zse);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function DVe(e){const{components:t}=r_();return Ve.createElement(t.Dropdown,{...e})}function FVe(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=r_(),u=E.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=E.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return Ve.createElement("nav",{...i},Ve.createElement(a.PreviousMonthButton,{type:"button",className:o[Fn.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},Ve.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[Fn.Chevron],orientation:"left"})),Ve.createElement(a.NextMonthButton,{type:"button",className:o[Fn.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},Ve.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[Fn.Chevron]})))}function LVe(e){const{components:t}=r_();return Ve.createElement(t.Button,{...e})}function BVe(e){return Ve.createElement("option",{...e})}function $Ve(e){const{components:t}=r_();return Ve.createElement(t.Button,{...e})}function zVe(e){const{rootRef:t,...n}=e;return Ve.createElement("div",{...n,ref:t})}function UVe(e){return Ve.createElement("select",{...e})}function qVe(e){const{week:t,...n}=e;return Ve.createElement("tr",{...n})}function VVe(e){return Ve.createElement("th",{...e})}function WVe(e){return Ve.createElement("thead",{"aria-hidden":!0},Ve.createElement("tr",{...e}))}function HVe(e){const{week:t,...n}=e;return Ve.createElement("th",{...n})}function GVe(e){return Ve.createElement("th",{...e})}function KVe(e){return Ve.createElement("tbody",{...e})}function YVe(e){const{components:t}=r_();return Ve.createElement(t.Dropdown,{...e})}const ZVe=Object.freeze(Object.defineProperty({__proto__:null,Button:CVe,CaptionLabel:kVe,Chevron:EVe,Day:TVe,DayButton:AVe,Dropdown:RVe,DropdownNav:NVe,Footer:MVe,Month:IVe,MonthCaption:jVe,MonthGrid:PVe,Months:OVe,MonthsDropdown:DVe,Nav:FVe,NextMonthButton:LVe,Option:BVe,PreviousMonthButton:$Ve,Root:zVe,Select:UVe,Week:qVe,WeekNumber:HVe,WeekNumberHeader:GVe,Weekday:VVe,Weekdays:WVe,Weeks:KVe,YearsDropdown:YVe},Symbol.toStringTag,{value:"Module"}));function XVe(e){return{...ZVe,...e}}function JVe(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function Q6(){const e={};for(const t in Fn)e[Fn[t]]=`rdp-${Fn[t]}`;for(const t in Js)e[Js[t]]=`rdp-${Js[t]}`;for(const t in vc)e[vc[t]]=`rdp-${vc[t]}`;for(const t in rl)e[rl[t]]=`rdp-${rl[t]}`;return e}function Xse(e,t,n){return(n??new lf(t)).format(e,"LLLL y")}const QVe=Xse;function eWe(e,t,n){return(n??new lf(t)).format(e,"d")}function tWe(e,t=Uu){return t.format(e,"LLLL")}function nWe(e,t=Uu){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function rWe(){return""}function sWe(e,t,n){return(n??new lf(t)).format(e,"cccccc")}function Jse(e,t=Uu){return t.format(e,"yyyy")}const iWe=Jse,aWe=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Xse,formatDay:eWe,formatMonthCaption:QVe,formatMonthDropdown:tWe,formatWeekNumber:nWe,formatWeekNumberHeader:rWe,formatWeekdayName:sWe,formatYearCaption:iWe,formatYearDropdown:Jse},Symbol.toStringTag,{value:"Module"}));function oWe(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...aWe,...e}}function lWe(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const m=r.formatMonthDropdown(h,s),y=c(h),b=t&&h<i(t)||n&&h>i(n)||!1;return{value:y,label:m,disabled:b}})}function cWe(e,t={},n={}){let r={...t==null?void 0:t[Fn.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function uWe(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function dWe(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let m=u;for(;l(m,d)||c(m,d);)h.push(m),m=a(m,1);return h.map(y=>{const b=n.formatYearDropdown(y,r);return{value:o(y),label:b,disabled:!1}})}function Qse(e,t,n){return(n??new lf(t)).format(e,"LLLL y")}const fWe=Qse;function hWe(e,t,n,r){let s=(r??new lf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function eie(e,t,n,r){let s=(r??new lf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const pWe=eie;function mWe(){return""}function gWe(e){return"Choose the Month"}function yWe(e){return"Go to the Next Month"}function bWe(e){return"Go to the Previous Month"}function vWe(e,t,n){return(n??new lf(t)).format(e,"cccc")}function xWe(e,t){return`Week ${e}`}function wWe(e){return"Week Number"}function _We(e){return"Choose the Year"}const SWe=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:fWe,labelDay:pWe,labelDayButton:eie,labelGrid:Qse,labelGridcell:hWe,labelMonthDropdown:gWe,labelNav:mWe,labelNext:yWe,labelPrevious:bWe,labelWeekNumber:xWe,labelWeekNumberHeader:wWe,labelWeekday:vWe,labelYearDropdown:_We},Symbol.toStringTag,{value:"Module"})),s_=e=>e instanceof HTMLElement?e:null,h3=e=>[...e.querySelectorAll("[data-animated-month]")??[]],CWe=e=>s_(e.querySelector("[data-animated-month]")),p3=e=>s_(e.querySelector("[data-animated-caption]")),m3=e=>s_(e.querySelector("[data-animated-weeks]")),kWe=e=>s_(e.querySelector("[data-animated-nav]")),EWe=e=>s_(e.querySelector("[data-animated-weekdays]"));function TWe(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=E.useRef(null),o=E.useRef(r),l=E.useRef(!1);E.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[rl.caption_after_enter]:n[rl.caption_before_enter],m=d?n[rl.weeks_after_enter]:n[rl.weeks_before_enter],y=a.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(h3(b).forEach(S=>{if(!(S instanceof HTMLElement))return;const k=CWe(S);k&&S.contains(k)&&S.removeChild(k);const C=p3(S);C&&C.classList.remove(h);const R=m3(S);R&&R.classList.remove(m)}),a.current=b):a.current=null,l.current||u||s)return;const v=y instanceof HTMLElement?h3(y):[],x=h3(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=kWe(e.current);w&&(w.style.zIndex="1"),x.forEach((S,k)=>{const C=v[k];if(!C)return;S.style.position="relative",S.style.overflow="hidden";const R=p3(S);R&&R.classList.add(h);const A=m3(S);A&&A.classList.add(m);const N=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),R&&R.classList.remove(h),A&&A.classList.remove(m),S.style.position="",S.style.overflow="",S.contains(C)&&S.removeChild(C)};C.style.pointerEvents="none",C.style.position="absolute",C.style.overflow="hidden",C.setAttribute("aria-hidden","true");const I=EWe(C);I&&(I.style.opacity="0");const O=p3(C);O&&(O.classList.add(d?n[rl.caption_before_exit]:n[rl.caption_after_exit]),O.addEventListener("animationend",N));const B=m3(C);B&&B.classList.add(d?n[rl.weeks_before_exit]:n[rl.weeks_after_exit]),S.insertBefore(C,S.firstChild)})}})}function AWe(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:y,endOfWeek:b,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:S}=r,k=l?x(s,r):a?w(s):S(s),C=l?h(i):a?m(y(i)):b(y(i)),R=u(C,k),A=d(i,s)+1,N=[];for(let B=0;B<=R;B++){const D=c(k,B);if(t&&v(D,t))break;N.push(D)}const O=(l?35:42)*A;if(o&&N.length<O){const B=O-N.length;for(let D=0;D<B;D++){const W=c(N[N.length-1],1);N.push(W)}}return N}function RWe(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function NWe(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function Fq(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function MWe(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:m}=r,y=e.reduce((b,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):m(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),S=t.filter(A=>A>=x&&A<=w),k=n.broadcastCalendar?35:42;if(n.fixedWeeks&&S.length<k){const A=t.filter(N=>{const I=k-S.length;return N>w&&N<=s(w,I)});S.push(...A)}const C=S.reduce((A,N)=>{const I=n.ISOWeek?c(N):u(N),O=A.find(D=>D.weekNumber===I),B=new Vse(N,v,r);return O?O.days.push(B):A.push(new wVe(I,[B])),A},[]),R=new xVe(v,C);return b.push(R),b},[]);return n.reverseMonths?y.reverse():y}function IWe(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:m,fromMonth:y,toMonth:b}=e;!n&&y&&(n=y),!n&&h&&(n=t.newDate(h,0,1)),!r&&b&&(r=b),!r&&m&&(r=u(m,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):m?r=u(m,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function jWe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function PWe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function OWe(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function qT(e,t){const[n,r]=E.useState(e);return[t===void 0?n:t,r]}function DWe(e,t){const[n,r]=IWe(e,t),{startOfMonth:s,endOfMonth:i}=t,a=Fq(e,t),[o,l]=qT(a,e.month?a:void 0);E.useEffect(()=>{const R=Fq(e,t);l(R)},[e.timeZone]);const c=NWe(o,r,e,t),u=AWe(c,e.endMonth?i(e.endMonth):void 0,e,t),d=MWe(c,u,e,t),h=OWe(d),m=RWe(d),y=PWe(o,n,e,t),b=jWe(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=R=>h.some(A=>A.days.some(N=>N.isEqualTo(R))),S=R=>{if(v)return;let A=s(R);n&&A<s(n)&&(A=s(n)),r&&A>s(r)&&(A=s(r)),l(A),x==null||x(A)};return{months:d,weeks:h,days:m,navStart:n,navEnd:r,previousMonth:y,nextMonth:b,goToMonth:S,goToDay:R=>{w(R)||S(R.date)}}}var lu;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(lu||(lu={}));function Lq(e){return!e[Js.disabled]&&!e[Js.hidden]&&!e[Js.outside]}function FWe(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);Lq(o)&&(o[Js.focused]&&i<lu.FocusedModifier?(s=a,i=lu.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<lu.LastFocused?(s=a,i=lu.LastFocused):n(a.date)&&i<lu.Selected?(s=a,i=lu.Selected):o[Js.today]&&i<lu.Today&&(s=a,i=lu.Today))}return s||(s=e.find(a=>Lq(t(a)))),s}function LWe(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:y,endOfWeek:b,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:S,startOfWeek:k}=a;let R={day:c,week:d,month:u,year:h,startOfWeek:A=>l?w(A,a):o?S(A):k(A),endOfWeek:A=>l?m(A):o?y(A):b(A)}[e](n,t==="after"?1:-1);return t==="before"&&r?R=v([r,R]):t==="after"&&s&&(R=x([s,R])),R}function tie(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=LWe(e,t,n.date,r,s,i,a),c=!!(i.disabled&&Nd(l,i.disabled,a)),u=!!(i.hidden&&Nd(l,i.hidden,a)),d=l,h=new Vse(l,d,a);return!c&&!u?h:tie(e,t,h,r,s,i,a,o+1)}function BWe(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=E.useState(),l=FWe(t.days,n,r||(()=>!1),a),[c,u]=E.useState(i?l:void 0);return{isFocusTarget:b=>!!(l!=null&&l.isEqualTo(b)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(b,v)=>{if(!c)return;const x=tie(b,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function $We(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=qT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=m=>(o==null?void 0:o.some(y=>l(y,m)))??!1,{min:u,max:d}=e;return{selected:o,select:(m,y,b)=>{let v=[...o??[]];if(c(m)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,m))}else(o==null?void 0:o.length)===d?v=[m]:v=[...v,m];return s||a(v),s==null||s(v,m,y,b),v},isSelected:c}}function zWe(e,t,n=0,r=0,s=!1,i=Uu){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function UWe(e,t,n=Uu){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function Bq(e,t,n=Uu){return Rd(e,t.from,!1,n)||Rd(e,t.to,!1,n)||Rd(t,e.from,!1,n)||Rd(t,e.to,!1,n)}function qWe(e,t,n=Uu){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?Rd(e,o,!1,n):Yse(o,n)?o.some(l=>Rd(e,l,!1,n)):J6(o)?o.from&&o.to?Bq(e,{from:o.from,to:o.to},n):!1:Kse(o)?UWe(e,o.dayOfWeek,n):Wse(o)?n.isAfter(o.before,o.after)?Bq(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):Nd(e.from,o,n)||Nd(e.to,o,n):Hse(o)||Gse(o)?Nd(e.from,o,n)||Nd(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function VWe(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=qT(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,m,y)=>{const{min:b,max:v}=e,x=h?zWe(h,c,b,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&qWe({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,m,y),x},isSelected:h=>c&&Rd(c,h,!1,t)}}function WWe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=qT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,m)=>{let y=d;return!r&&o&&o&&l(d,o)&&(y=void 0),s||a(y),s==null||s(y,d,h,m),y},isSelected:d=>o?l(o,d):!1}}function HWe(e,t){const n=WWe(e,t),r=$We(e,t),s=VWe(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function GWe(e){var vt;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new ja(t.today,t.timeZone)),t.month&&(t.month=new ja(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new ja(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new ja(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new ja(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new ja(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(vt=t.selected)==null?void 0:vt.map(ot=>new ja(ot,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new ja(t.selected.from,t.timeZone):void 0,to:t.selected.to?new ja(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=E.useMemo(()=>{const ot={...oT,...t.locale};return{dateLib:new lf({locale:ot,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:XVe(t.components),formatters:oWe(t.formatters),labels:{...SWe,...t.labels},locale:ot,classNames:{...Q6(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:m,onDayFocus:y,onDayKeyDown:b,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:S,showWeekNumber:k,styles:C}=t,{formatCaption:R,formatDay:A,formatMonthDropdown:N,formatWeekNumber:I,formatWeekNumberHeader:O,formatWeekdayName:B,formatYearDropdown:D}=r,W=DWe(t,i),{days:P,months:Z,navStart:U,navEnd:H,previousMonth:L,nextMonth:ne,goToMonth:V}=W,Q=_Ve(P,t,i),{isSelected:ee,select:se,selected:me}=HWe(t,i)??{},{blur:ce,focused:je,isFocusTarget:De,moveFocus:Se,setFocused:Ce}=BWe(t,W,Q,ee??(()=>!1),i),{labelDayButton:qe,labelGridcell:Qe,labelGrid:We,labelMonthDropdown:Ne,labelNav:K,labelPrevious:ge,labelNext:Ae,labelWeekday:le,labelWeekNumber:oe,labelWeekNumberHeader:re,labelYearDropdown:Te}=s,Be=E.useMemo(()=>uWe(i,t.ISOWeek),[i,t.ISOWeek]),ke=c!==void 0||m!==void 0,lt=E.useCallback(()=>{L&&(V(L),S==null||S(L))},[L,V,S]),Rt=E.useCallback(()=>{ne&&(V(ne),w==null||w(ne))},[V,ne,w]),ft=E.useCallback((ot,$)=>ze=>{ze.preventDefault(),ze.stopPropagation(),Ce(ot),se==null||se(ot.date,$,ze),m==null||m(ot.date,$,ze)},[se,m,Ce]),Pt=E.useCallback((ot,$)=>ze=>{Ce(ot),y==null||y(ot.date,$,ze)},[y,Ce]),qt=E.useCallback((ot,$)=>ze=>{ce(),h==null||h(ot.date,$,ze)},[ce,h]),Lt=E.useCallback((ot,$)=>ze=>{const st={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[ze.shiftKey?"year":"month","before"],PageDown:[ze.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(st[ze.key]){ze.preventDefault(),ze.stopPropagation();const[be,_e]=st[ze.key];Se(be,_e)}b==null||b(ot.date,$,ze)},[Se,b,t.dir]),en=E.useCallback((ot,$)=>ze=>{v==null||v(ot.date,$,ze)},[v]),xe=E.useCallback((ot,$)=>ze=>{x==null||x(ot.date,$,ze)},[x]),F=E.useCallback(ot=>$=>{const ze=Number($.target.value),st=i.setMonth(i.startOfMonth(ot),ze);V(st)},[i,V]),X=E.useCallback(ot=>$=>{const ze=Number($.target.value),st=i.setYear(i.startOfMonth(ot),ze);V(st)},[i,V]),{className:ye,style:Fe}=E.useMemo(()=>({className:[o[Fn.Root],t.className].filter(Boolean).join(" "),style:{...C==null?void 0:C[Fn.Root],...t.style}}),[o,t.className,t.style,C]),we=JVe(t),Ie=E.useRef(null);TWe(Ie,!!t.animate,{classNames:o,months:Z,focused:je,dateLib:i});const fe={dayPickerProps:t,selected:me,select:se,isSelected:ee,months:Z,nextMonth:ne,previousMonth:L,goToMonth:V,getModifiers:Q,components:n,classNames:o,styles:C,labels:s,formatters:r};return Ve.createElement(Zse.Provider,{value:fe},Ve.createElement(n.Root,{rootRef:t.animate?Ie:void 0,className:ye,style:Fe,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...we},Ve.createElement(n.Months,{className:o[Fn.Months],style:C==null?void 0:C[Fn.Months]},!t.hideNavigation&&!u&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Fn.Nav],style:C==null?void 0:C[Fn.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Rt,previousMonth:L,nextMonth:ne}),Z.map((ot,$)=>{const ze=lWe(ot.date,U,H,r,i),st=dWe(U,H,r,i);return Ve.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[Fn.Month],style:C==null?void 0:C[Fn.Month],key:$,displayIndex:$,calendarMonth:ot},u==="around"&&!t.hideNavigation&&$===0&&Ve.createElement(n.PreviousMonthButton,{type:"button",className:o[Fn.PreviousMonthButton],tabIndex:L?void 0:-1,"aria-disabled":L?void 0:!0,"aria-label":ge(L),onClick:lt,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:L?void 0:!0,className:o[Fn.Chevron],orientation:t.dir==="rtl"?"right":"left"})),Ve.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[Fn.MonthCaption],style:C==null?void 0:C[Fn.MonthCaption],calendarMonth:ot,displayIndex:$},l!=null&&l.startsWith("dropdown")?Ve.createElement(n.DropdownNav,{className:o[Fn.Dropdowns],style:C==null?void 0:C[Fn.Dropdowns]},l==="dropdown"||l==="dropdown-months"?Ve.createElement(n.MonthsDropdown,{className:o[Fn.MonthsDropdown],"aria-label":Ne(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:F(ot.date),options:ze,style:C==null?void 0:C[Fn.Dropdown],value:i.getMonth(ot.date)}):Ve.createElement("span",null,N(ot.date,i)),l==="dropdown"||l==="dropdown-years"?Ve.createElement(n.YearsDropdown,{className:o[Fn.YearsDropdown],"aria-label":Te(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:X(ot.date),options:st,style:C==null?void 0:C[Fn.Dropdown],value:i.getYear(ot.date)}):Ve.createElement("span",null,D(ot.date,i)),Ve.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},R(ot.date,i.options,i))):Ve.createElement(n.CaptionLabel,{className:o[Fn.CaptionLabel],role:"status","aria-live":"polite"},R(ot.date,i.options,i))),u==="around"&&!t.hideNavigation&&$===d-1&&Ve.createElement(n.NextMonthButton,{type:"button",className:o[Fn.NextMonthButton],tabIndex:ne?void 0:-1,"aria-disabled":ne?void 0:!0,"aria-label":Ae(ne),onClick:Rt,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:ne?void 0:!0,className:o[Fn.Chevron],orientation:t.dir==="rtl"?"left":"right"})),$===d-1&&u==="after"&&!t.hideNavigation&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[Fn.Nav],style:C==null?void 0:C[Fn.Nav],"aria-label":K(),onPreviousClick:lt,onNextClick:Rt,previousMonth:L,nextMonth:ne}),Ve.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":We(ot.date,i.options,i)||void 0,className:o[Fn.MonthGrid],style:C==null?void 0:C[Fn.MonthGrid]},!t.hideWeekdays&&Ve.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[Fn.Weekdays],style:C==null?void 0:C[Fn.Weekdays]},k&&Ve.createElement(n.WeekNumberHeader,{"aria-label":re(i.options),className:o[Fn.WeekNumberHeader],style:C==null?void 0:C[Fn.WeekNumberHeader],scope:"col"},O()),Be.map((be,_e)=>Ve.createElement(n.Weekday,{"aria-label":le(be,i.options,i),className:o[Fn.Weekday],key:_e,style:C==null?void 0:C[Fn.Weekday],scope:"col"},B(be,i.options,i)))),Ve.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[Fn.Weeks],style:C==null?void 0:C[Fn.Weeks]},ot.weeks.map((be,_e)=>Ve.createElement(n.Week,{className:o[Fn.Week],key:be.weekNumber,style:C==null?void 0:C[Fn.Week],week:be},k&&Ve.createElement(n.WeekNumber,{week:be,style:C==null?void 0:C[Fn.WeekNumber],"aria-label":oe(be.weekNumber,{locale:a}),className:o[Fn.WeekNumber],scope:"row",role:"rowheader"},I(be.weekNumber,i)),be.days.map(Ue=>{const{date:Et}=Ue,he=Q(Ue);if(he[Js.focused]=!he.hidden&&!!(je!=null&&je.isEqualTo(Ue)),he[vc.selected]=(ee==null?void 0:ee(Et))||he.selected,J6(me)){const{from:ve,to:Oe}=me;he[vc.range_start]=!!(ve&&Oe&&i.isSameDay(Et,ve)),he[vc.range_end]=!!(ve&&Oe&&i.isSameDay(Et,Oe)),he[vc.range_middle]=Rd(me,Et,!0,i)}const Y=cWe(he,C,t.modifiersStyles),G=SVe(he,o,t.modifiersClassNames),J=!ke&&!he.hidden?Qe(Et,he,i.options,i):void 0;return Ve.createElement(n.Day,{key:`${i.format(Et,"yyyy-MM-dd")}_${i.format(Ue.displayMonth,"yyyy-MM")}`,day:Ue,modifiers:he,className:G.join(" "),style:Y,role:"gridcell","aria-selected":he.selected||void 0,"aria-label":J,"data-day":i.format(Et,"yyyy-MM-dd"),"data-month":Ue.outside?i.format(Et,"yyyy-MM"):void 0,"data-selected":he.selected||void 0,"data-disabled":he.disabled||void 0,"data-hidden":he.hidden||void 0,"data-outside":Ue.outside||void 0,"data-focused":he.focused||void 0,"data-today":he.today||void 0},!he.hidden&&ke?Ve.createElement(n.DayButton,{className:o[Fn.DayButton],style:C==null?void 0:C[Fn.DayButton],type:"button",day:Ue,modifiers:he,disabled:he.disabled||void 0,tabIndex:De(Ue)?0:-1,"aria-label":qe(Et,he,i.options,i),onClick:ft(Ue,he),onBlur:qt(Ue,he),onFocus:Pt(Ue,he),onKeyDown:Lt(Ue,he),onMouseEnter:en(Ue,he),onMouseLeave:xe(Ue,he)},A(Et,i.options,i)):!he.hidden&&A(Ue.date,i.options,i))}))))))})),t.footer&&Ve.createElement(n.Footer,{className:o[Fn.Footer],style:C==null?void 0:C[Fn.Footer],role:"status","aria-live":"polite"},t.footer)))}function KWe({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=Q6();return f.jsx(GWe,{showOutsideDays:n,className:Je("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Je("w-fit",l.root),months:Je("flex gap-4 flex-col md:flex-row relative",l.months),month:Je("flex flex-col w-full gap-4",l.month),nav:Je("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Je(G3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Je(G3({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Je("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Je("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Je("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Je("absolute inset-0 opacity-0",l.dropdown),caption_label:Je("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Je("flex",l.weekdays),weekday:Je("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Je("flex w-full mt-2",l.week),week_number_header:Je("select-none w-(--cell-size)",l.week_number_header),week_number:Je("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Je("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Je("rounded-l-md bg-accent",l.range_start),range_middle:Je("rounded-none",l.range_middle),range_end:Je("rounded-r-md bg-accent",l.range_end),today:Je("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Je("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Je("text-muted-foreground opacity-50",l.disabled),hidden:Je("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Je(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx(kpe,{className:Je("size-4",c),...d}):u==="right"?f.jsx(FP,{className:Je("size-4",c),...d}):f.jsx(Yl,{className:Je("size-4",c),...d}),DayButton:YWe,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function YWe({className:e,day:t,modifiers:n,...r}){const s=Q6(),i=E.useRef(null);return E.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(pt,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Je("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}const ZWe=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=Ve.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?UAe(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Je("space-y-1.5",a),children:[t&&f.jsx(jt,{htmlFor:e.name+"-trigger",className:Je("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(Bc,{open:o,onOpenChange:l,children:[f.jsx($c,{asChild:!0,children:f.jsxs(pt,{id:e.name+"-trigger",variant:"outline",className:Je("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(wpe,{className:"mr-2 h-4 w-4"}),c?Ad(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(zc,{className:"w-auto p-0",children:f.jsx(KWe,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})},XWe=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:m,state:y,handleChange:b,handleBlur:v}=e,x=typeof y.value=="number"?y.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Je("space-y-1.5",u),children:[t&&f.jsxs(jt,{htmlFor:m,className:Je("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(k0,{id:m,name:m,value:[x],onValueChange:S=>b(S[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Je(d,y.meta.errors.length?"border-destructive":"")}),y.meta.isTouched&&y.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:y.meta.errors.map((S,k)=>f.jsx("p",{children:typeof S=="string"?S:(S==null?void 0:S.message)||"Invalid"},k))})]})},JWe=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=y=>{var v;const b=((v=y.target.files)==null?void 0:v[0])??null;l(b),c()},h=()=>{l(null);const y=document.getElementById(a);y&&(y.value=""),c()},m=()=>{const y=document.getElementById(a);y==null||y.click()};return f.jsxs("div",{className:Je("space-y-1.5",s),children:[t&&f.jsx(jt,{className:"text-sm font-medium cursor-pointer",onClick:m,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(Sn,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(mE,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(pt,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(Wi,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:m,className:Je("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(LP,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},QWe={text:fx,email:fx,password:fx,url:fx,textarea:cVe,select:uVe,checkbox:dVe,switch:fVe,number:hVe,date:ZWe,slider:XWe,file:JWe},eHe=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Je("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(_y,{value:e,className:"h-2"})]}),tHe=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function VT(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:m,autoSubmitOnChange:y=!1,autoSubmitDebounceMs:b=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1}=e,[S,k]=E.useState(1),C={...QWe,...u},R=E.useMemo(()=>{const ne={};return t.forEach(V=>{const Q=V.page||1;ne[Q]||(ne[Q]=[]),ne[Q].push(V)}),ne},[t]),A=Math.max(...Object.keys(R).map(Number),1),N=A>1,I=N?(S-1)/(A-1)*100:100,O={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async ne=>{try{const V=await h.onSubmit(ne);return B.reset(),V}catch(V){throw V}}}},B=si(O);Ve.useEffect(()=>{const ne=[];let V,Q;if(h!=null&&h.onChange||y){const ee=B.store.subscribe(()=>{const se=B,me=se.state.values;h!=null&&h.onChange&&se.state.isValid&&(clearTimeout(Q),Q=setTimeout(()=>{h.onChange({value:me,formApi:se})},300)),y&&!v&&!x&&(clearTimeout(V),V=setTimeout(()=>{B.state.canSubmit&&B.handleSubmit()},b))});ne.push(ee)}return ne.push(()=>{clearTimeout(V),clearTimeout(Q)}),()=>{ne.forEach(ee=>ee())}},[B,y,b,v,x]);const D=()=>R[S]||[],W=()=>l.find(ne=>ne.page===S),P=()=>{if(S<A){const ne=S+1;k(ne),m==null||m(ne,"next")}},Z=()=>{if(S>1){const ne=S-1;k(ne),m==null||m(ne,"previous")}},U=S===A,H=S===1;return{form:B,Form:({className:ne,children:V,onSubmit:Q})=>{const ee=Se=>{Se.preventDefault(),Se.stopPropagation(),Q?Q(Se):U?B.handleSubmit():P()},se=Je("space-y-6",a,ne),me=Se=>{const{name:Ce,type:qe,label:Qe,placeholder:We,description:Ne,options:K,min:ge,max:Ae,step:le,accept:oe,multiple:re,component:Te,wrapper:Be,conditional:ke,validation:lt}=Se;return f.jsx(B.Field,{name:Ce,validators:lt?{onChange:lt}:void 0,children:Rt=>{const ft=Rt.form.state.values;if(ke&&!ke(ft))return null;const Pt={fieldApi:Rt,label:Qe,placeholder:We,description:Ne,wrapperClassName:o,min:ge,max:Ae,step:le,accept:oe,multiple:re,disabled:v||x||Rt.form.state.isSubmitting},qt=Te||C[qe]||fx,Lt=qe==="select"?{...Pt,options:K||[]}:{...Pt,type:["text","email","password","url"].includes(qe)?qe:void 0},en=f.jsx(qt,{...Lt}),xe=Be||d;return xe?f.jsx(xe,{field:Se,children:en}):en}},Ce)},ce=()=>{const Se=D(),Ce=W(),qe=Se.map(We=>me(We)).filter(Boolean),Qe=(Ce==null?void 0:Ce.component)||tHe;return f.jsx(Qe,{title:Ce==null?void 0:Ce.title,description:Ce==null?void 0:Ce.description,page:S,totalPages:A,children:qe})},je=()=>{if(!N||!c)return null;const Se=c.component||eHe;return f.jsx(Se,{value:I,currentPage:S,totalPages:A,className:c.className})},De=()=>N?f.jsx(B.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(pt,{type:"button",variant:"outline",onClick:Z,disabled:H||v||x,className:H?"invisible":"",children:i}),f.jsx(pt,{type:"submit",disabled:(!Ce||qe||v||x)&&U,className:"flex-1 max-w-xs",children:x&&U?"Loading...":qe&&U?"Submitting...":U?r:s})]})}}):f.jsx(B.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsx(pt,{type:"submit",disabled:!Ce||qe||v||x,className:"w-full",children:x?"Loading...":qe?"Submitting...":r})}});return f.jsx("form",{onSubmit:ee,className:se,children:V||f.jsxs(f.Fragment,{children:[je(),ce(),De()]})})},currentPage:S,totalPages:A,goToNextPage:P,goToPreviousPage:Z,setCurrentPage:k,isFirstPage:H,isLastPage:U,progressValue:I}}function nHe({templates:e,onSelect:t}){const[n,r]=E.useState(""),s=e.filter(i=>i.name.toLowerCase().includes(n.toLowerCase())||i.description.toLowerCase().includes(n.toLowerCase())||i.tags.some(a=>a.toLowerCase().includes(n.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(jt,{htmlFor:"search",children:"Search Templates"}),f.jsx(Sn,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:i=>r(i.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(i=>f.jsxs(ol,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(i),children:[f.jsx(ll,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(cl,{className:"text-sm",children:i.name}),f.jsx(Ld,{className:"text-xs",children:i.description})]}),i.isPublic&&f.jsx(is,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx(ul,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[i.tags.map(a=>f.jsx(is,{variant:"outline",className:"text-xs",children:a},a)),i.variables.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.variables.length," variables"]}),i.tools&&i.tools.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.tools.length," tools"]}),i.rules&&i.rules.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[i.rules.length," rules"]})]})})]},i.id))})]})}function rHe({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default||`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>{if(c.default)if(c.type==="number")l[c.name]=parseFloat(c.default)||0;else if(c.type==="boolean")l[c.name]=c.default.toLowerCase()==="true";else if(c.type==="array")try{l[c.name]=JSON.parse(c.default)}catch{l[c.name]=c.default.split(",").map(u=>u.trim())}else l[c.name]=c.default;return l},{}),{Form:o}=VT({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(pt,{variant:"outline",size:"sm",onClick:n,children:" Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(pt,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(jt,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const sHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),i=E.useRef(null),{loadPromptTemplates:a,getTemplatesByType:o}=Rm(gn(m=>({loadPromptTemplates:m.loadPromptTemplates,getTemplatesByType:m.getTemplatesByType}))),l=o("prompt");E.useEffect(()=>{t&&a()},[t,a]);const c=m=>{s(m),i.current&&(i.current.textContent=m.prompt)},u=async m=>{if(r)try{await e.applyTemplate(r.id,m),n(!1),s(null),Me.success("Template applied to input area!")}catch(y){console.error("Failed to Proompt :",y),Me.error("Failed to Proompt !")}},d=()=>{s(null)},h=async m=>{if(!(!r||!i.current))try{const y=await e.compileTemplate(r.id,m);i.current.textContent=y.content}catch(y){i.current.textContent=`Error: ${y instanceof Error?y.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx(gpe,{className:"h-4 w-4"})}),f.jsx(ap,{open:t,onOpenChange:n,children:f.jsxs(op,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(lp,{children:[f.jsx(cp,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(Xm,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(rHe,{template:r,onSubmit:u,onBack:d,module:e,previewElementRef:i,onCompile:h}):f.jsx(nHe,{templates:l,onSelect:c})})]})})]})};class iHe{constructor(){de(this,"id","core-prompt-library");de(this,"unregisterCallback",null);de(this,"eventUnsubscribers",[]);de(this,"notifyComponentUpdate",null);de(this,"isStreaming",!1);de(this,"modApiRef",null);de(this,"getIsStreaming",()=>this.isStreaming);de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});de(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Rm.getState();return await r(t,n)});de(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(yn.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=Ln.getState().status==="streaming";const n=t.on(Xn.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(sHe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const aHe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:f.jsxs("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:[f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`}),f.jsx("path",{d:`M1854 2726 c-92 -40 -150 -139 -141 -239 21 -237 343 -298 446 -84
59 123 -10 287 -138 325 -51 16 -128 15 -167 -2z`}),f.jsx("path",{d:`M3053 2719 c-81 -40 -133 -121 -133 -205 0 -102 47 -180 134 -220 95
-44 193 -27 268 47 78 78 94 181 44 278 -21 38 -76 88 -118 105 -54 23 -144
20 -195 -5z`}),f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})]})})};function oHe({agents:e,onUseAgent:t,onClearAgent:n,hasActiveAgent:r,currentAgentName:s,module:i}){const[a,o]=E.useState(""),l=e.filter(c=>c.name.toLowerCase().includes(a.toLowerCase())||c.description.toLowerCase().includes(a.toLowerCase())||c.tags.some(u=>u.toLowerCase().includes(a.toLowerCase())));return f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(K0,{className:"h-4 w-4 text-primary"}),f.jsxs("span",{className:"text-sm font-medium",children:["Active Agent: ",s]})]}),f.jsx(pt,{variant:"outline",size:"sm",onClick:n,children:"Clear Agent"})]}),f.jsxs("div",{children:[f.jsx(jt,{htmlFor:"search",children:"Search Agents"}),f.jsx(Sn,{id:"search",placeholder:"Search by name, description, or tags...",value:a,onChange:c=>o(c.target.value)})]}),f.jsx("div",{className:"grid gap-3",children:l.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No agents match your search.":"No agents available."}):l.map(c=>{const u=i.getTasksForAgent(c.id);return f.jsxs(ol,{className:"hover:bg-muted/50 transition-colors",children:[f.jsx(ll,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsxs(cl,{className:"text-sm flex items-center gap-2",children:[f.jsx(K0,{className:"h-4 w-4"}),c.name]}),f.jsx(Ld,{className:"text-xs",children:c.description})]}),c.isPublic&&f.jsx(is,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsxs(ul,{className:"pt-0 space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsxs(is,{variant:"secondary",className:"text-xs",children:[u.length," tasks"]}),c.tags.map(d=>f.jsx(is,{variant:"outline",className:"text-xs",children:d},d)),c.variables.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.variables.length," variables"]}),c.tools&&c.tools.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.tools.length," tools"]}),c.rules&&c.rules.length>0&&f.jsxs(is,{variant:"secondary",className:"text-xs",children:[c.rules.length," rules"]})]}),f.jsx(pt,{size:"sm",onClick:()=>t(c),className:"w-full",children:"Use Agent"})]})]},c.id)})})]})}function lHe({agent:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=VT({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This agent has no variables defined. The agent will be applied as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(jt,{className:"text-sm font-medium mb-4 block",children:"Agent Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(jt,{className:"text-sm font-medium",children:"System Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function cHe({task:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=VT({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This task has no variables defined. The task will be executed as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(jt,{className:"text-sm font-medium mb-4 block",children:"Task Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Task Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function uHe({agent:e,tasks:t,onSubmit:n,onBack:r,previewElementRef:s,onCompile:i,autoClearEnabled:a,onAutoClearChange:o,module:l}){const[c,u]=E.useState(""),[d,h]=E.useState({}),[m,y]=E.useState({}),b=E.useRef(null),v=t.find(A=>A.id===c),x=A=>{h(A)},w=A=>{y(A)},S=A=>{u(A),y({})},k=()=>{v?n(d,v,m):n(d)},C=async A=>{if(s.current)try{await i(A)}catch(N){s.current&&(s.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`)}},R=async A=>{if(!(!v||!b.current))try{const N=await l.compileTaskTemplate(v.id,A);b.current.textContent=N.content}catch(N){b.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`}};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsxs(pt,{variant:"ghost",size:"sm",onClick:r,children:[f.jsx(lpe,{className:"h-4 w-4 mr-1"}),"Back to Agents"]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(jt,{htmlFor:"auto-clear",className:"text-sm",children:"Auto-clear after use"}),f.jsx(Mo,{id:"auto-clear",checked:a,onCheckedChange:o})]})]}),t.length>0&&f.jsxs(ol,{className:"mb-4",children:[f.jsxs(ll,{children:[f.jsx(cl,{className:"text-lg",children:"Task Selection (Optional)"}),f.jsx(Ld,{children:"Choose a task to execute with this agent, or leave empty to use the agent alone."})]}),f.jsx(ul,{children:f.jsxs("div",{children:[f.jsx(jt,{htmlFor:"task-select",children:"Select Task"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(ep,{value:c,onValueChange:S,children:[f.jsx(np,{className:"flex-1",children:f.jsx(tp,{placeholder:"Select a task (optional)"})}),f.jsx(rp,{children:t.map(A=>f.jsx(Eo,{value:A.id,children:A.name},A.id))})]}),c&&f.jsx(pt,{variant:"outline",size:"sm",onClick:()=>u(""),children:"Clear"})]})]})})]}),f.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[f.jsxs(ol,{children:[f.jsxs(ll,{children:[f.jsx(cl,{className:"text-lg",children:"Agent Configuration"}),f.jsxs(Ld,{children:["Configure the system prompt and settings for ",e.name]})]}),f.jsx(ul,{children:f.jsx(lHe,{agent:e,onChange:x,previewElementRef:s,onCompile:C})})]}),v&&f.jsxs(ol,{children:[f.jsxs(ll,{children:[f.jsx(cl,{className:"text-lg",children:"Task Configuration"}),f.jsxs(Ld,{children:["Configure the task prompt for ",v.name]})]}),f.jsx(ul,{children:f.jsx(cHe,{task:v,onChange:w,previewElementRef:b,onCompile:R})})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsxs(pt,{onClick:k,size:"lg",children:["Use Agent ",v?`with ${v.name}`:""]})})]})]})}const dHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),[i,a]=E.useState(!1),[o,l]=E.useState(0),c=E.useRef(null);E.useEffect(()=>{const C=()=>{l(R=>R+1)};return e.setNotifyCallback(C),()=>{e.setNotifyCallback(null)}},[e]),E.useEffect(()=>{t&&e.loadPromptTemplates()},[t,e]);const u=e.getAgents(),d=e.hasActiveAgent(),h=e.getCurrentAgentId(),m=h?u.find(C=>C.id===h):null;E.useEffect(()=>{},[o]);const y=C=>{s(C),a(!0)},b=async(C,R,A)=>{var N;if(r)try{R&&A?(await e.applyAgentWithTask(r.id,R.id,C,A),Me.success(`Agent "${r.name}" applied with task "${R.name}"!`)):(await e.applyAgent(r.id,C),Me.success(`Agent "${r.name}" applied!`)),e.getAutoClearEnabled()&&((N=e.clearOnSubmit)==null||N.call(e)),n(!1),s(null),a(!1)}catch(I){console.error("Failed to apply agent:",I),Me.error("Failed to apply agent!")}},v=()=>{s(null),a(!1)},x=()=>{var C;(C=e.clearOnSubmit)==null||C.call(e),Me.success("Agent cleared!")},w=async C=>{if(!(!r||!c.current))try{const R=await e.compileTemplate(r.id,C);c.current.textContent=R.content}catch(R){c.current.textContent=`Error: ${R instanceof Error?R.message:"Compilation failed"}`}},S=()=>i&&r?`Configure ${r.name}`:"Select Agent",k=()=>i&&r?"Configure the agent and optionally select a task to execute.":"Select an AI agent to work with. Each agent has specialized capabilities and tasks.";return f.jsxs(f.Fragment,{children:[f.jsx(pt,{variant:d?"secondary":"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:d?`Active Agent: ${(m==null?void 0:m.name)||"Unknown"}`:"Select Agent",children:f.jsx(aHe,{className:"h-4 w-4"})}),f.jsx(ap,{open:t,onOpenChange:n,children:f.jsxs(op,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(lp,{children:[f.jsx(cp,{children:S()}),f.jsx(Xm,{children:k()})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:i&&r?f.jsx(uHe,{agent:r,tasks:e.getTasksForAgent(r.id),onSubmit:b,onBack:v,previewElementRef:c,onCompile:w,autoClearEnabled:e.getAutoClearEnabled(),onAutoClearChange:e.setAutoClearEnabled,module:e}):f.jsx(oHe,{agents:u,onUseAgent:y,onClearAgent:x,hasActiveAgent:d,currentAgentName:m==null?void 0:m.name,module:e})})]})})]})};class fHe{constructor(){de(this,"id","agent-control");de(this,"unregisterPromptControlCallback",null);de(this,"unregisterCallback");de(this,"eventUnsubscribers",[]);de(this,"modApiRef",null);de(this,"allTemplates",[]);de(this,"isLoadingTemplates",!0);de(this,"notifyComponentUpdate",null);de(this,"currentAgentId",null);de(this,"currentAgentSystemPrompt",null);de(this,"autoClearEnabled",!1);de(this,"getAllTemplates",()=>this.allTemplates);de(this,"getAgents",()=>this.allTemplates.filter(t=>(t.type||"prompt")==="agent"));de(this,"getTasksForAgent",t=>this.allTemplates.filter(n=>(n.type||"prompt")==="task"&&n.parentId===t));de(this,"getIsLoadingTemplates",()=>this.isLoadingTemplates);de(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Rm.getState();return await r(t,n)});de(this,"compileTaskTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Rm.getState();return await r(t,n)});de(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(yn.setInputTextRequest,{text:r.content}),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});de(this,"applyAgent",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);this.currentAgentId=t,this.currentAgentSystemPrompt=r.content,(s=this.notifyComponentUpdate)==null||s.call(this),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});de(this,"applyAgentWithTask",async(t,n,r,s)=>{var a;await this.applyAgent(t,r);const i=await this.compileTemplate(n,s);(a=this.modApiRef)==null||a.emit(yn.setInputTextRequest,{text:i.content}),i.selectedTools&&i.selectedTools.length>0,i.selectedRules&&i.selectedRules.length>0});de(this,"getCurrentAgentId",()=>this.currentAgentId);de(this,"getCurrentAgentSystemPrompt",()=>this.currentAgentSystemPrompt);de(this,"hasActiveAgent",()=>this.currentAgentId!==null);de(this,"getAutoClearEnabled",()=>this.autoClearEnabled);de(this,"setAutoClearEnabled",t=>{this.autoClearEnabled=t});de(this,"clearOnSubmit",()=>{var t;this.currentAgentId=null,this.currentAgentSystemPrompt=null,(t=this.notifyComponentUpdate)==null||t.call(this)});de(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});de(this,"loadPromptTemplates",()=>{var t;(t=this.modApiRef)==null||t.emit(Xa.loadPromptTemplatesRequest,{})})}async initialize(t){this.modApiRef=t,t.emit(Xa.loadPromptTemplatesRequest,{});const n=t.on(Xa.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,this.isLoadingTemplates=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Xa.promptTemplateAdded,a=>{var o;a!=null&&a.promptTemplate&&(this.allTemplates=[...this.allTemplates,a.promptTemplate],(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.on(Xa.promptTemplateUpdated,a=>{var o;if(a!=null&&a.promptTemplate){const l=this.allTemplates.findIndex(c=>c.id===a.promptTemplate.id);l!==-1&&(this.allTemplates[l]=a.promptTemplate,(o=this.notifyComponentUpdate)==null||o.call(this))}}),i=t.on(Xa.promptTemplateDeleted,a=>{var o;a!=null&&a.id&&(this.allTemplates=this.allTemplates.filter(l=>l.id!==a.id),(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s,i)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(dHe,{module:this}),getMetadata:()=>{if(this.currentAgentSystemPrompt)return{turnSystemPrompt:this.currentAgentSystemPrompt}},clearOnSubmit:()=>{var n;this.autoClearEnabled&&(this.currentAgentId=null,this.currentAgentSystemPrompt=null,(n=this.notifyComponentUpdate)==null||n.call(this))}}))}destroy(t){this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.modApiRef=null,this.notifyComponentUpdate=null,this.unregisterCallback&&this.unregisterCallback()}}const hHe=Ge({enableStreamingMarkdown:Gn(),enableStreamingCodeBlockParsing:Gn(),foldStreamingCodeBlocks:Gn(),foldUserMessagesOnCompletion:Gn(),enableAutoScrollOnStream:Gn(),streamingRenderFPS:Tt().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:Tt().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),pHe=()=>{const e=mr(gn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=mr(gn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=si({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:hHe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});E.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx(Jp,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx(Jp,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx(Jp,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx(Jp,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx(Jp,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(bc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(Cy,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Je("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(bc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(Cy,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Je("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(Ih,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(pt,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(h1,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},mHe=Ve.memo(pHe);class gHe{constructor(){de(this,"id","core-settings-general");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:mHe,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const yHe=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=E.useState(n??"");E.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(jt,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(Sn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(Sn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},bHe=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],vHe=yl(["system","light","dark","TijuLight","TijuDark","custom"]),xHe=Ge({theme:vHe,prismThemeUrl:$e(),customFontFamily:$e(),customFontSize:Tt().min(12).max(20),chatMaxWidth:$e(),customThemeColors:bh($e(),$e().nullable())}),wHe=()=>{const e=mr(gn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=mr(gn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=si({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:xHe,onChangeAsyncDebounceMs:300}});E.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(dx,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(jt,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(Mx,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(dx,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx(Vw,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(bc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(Mx,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(dx,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(Mx,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:bHe,triggerClassName:"w-full"}),f.jsx(Vw,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(dx,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(yHe,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(Ih,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(pt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(h1,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(pt,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},_He=Ve.memo(wHe);class SHe{constructor(){de(this,"id","core-settings-theme");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:_He,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const CHe=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var N,I;const[c,u]=E.useState(!0),d=ty(e.type),h=jC(e.type),m=dm(e.type),y=a==="fetching"||o,b=o||a==="fetching",v=o||a==="fetching",x=E.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(O=>O.id===e.apiKeyId):!1,S=d&&!w,k=E.useCallback(async(O,B)=>{const D=new Set(e.enabledModels??[]);B?D.add(O):D.delete(O);const W=Array.from(D);try{await i(e.id,{enabledModels:W})}catch(P){Me.error("Failed to update model status."),console.error("Failed to save model toggle:",P)}},[e.enabledModels,e.id,i]),C=()=>u(O=>!O),R=((N=e.enabledModels)==null?void 0:N.length)??0,A=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx("span",{className:Je("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Sr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{children:f.jsx(Wl,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Sr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(er,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:f.jsx(f1,{}),className:"h-8 w-8"}),f.jsx(er,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((I=t.find(O=>O.id===e.apiKeyId))==null?void 0:I.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),m&&f.jsx("div",{className:"pt-1",children:f.jsxs(pt,{variant:"outline",size:"sm",onClick:s,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Yn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(so,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(Wl,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(ym,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",R," / ",A," enabled)"]}),f.jsx(er,{tooltipText:c?"Show Models":"Hide Models",onClick:C,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(Yl,{}):f.jsx(Lh,{}),className:"h-6 w-6"})]}),!c&&f.jsx(I6,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:k,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},kHe=Ve.memo(CHe),EHe=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=E.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=E.useCallback((d,h)=>{const m=new Set(t.enabledModels??[]);h?m.add(d):m.delete(d);const y=Array.from(m);o("enabledModels",y)},[t.enabledModels,o]),u=E.useCallback((d,h)=>new Promise(m=>{o(d,h),m(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(wte,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx(I6,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},THe=Ve.memo(EHe),AHe=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[m,y]=E.useState({name:"placeholder"}),b=Nr(I=>I.getAllAvailableModelDefsForProvider),[v,x]=E.useState([]),w=E.useMemo(()=>[...b(e.id)].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id)),[e.id,b]);E.useEffect(()=>{if(o){const I=b(e.id);x([...I].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const S=()=>l(!0),k=()=>{l(!1),y({}),u(!1)},C=E.useCallback(async()=>{u(!0);try{const I=m.enabledModels&&m.enabledModels.length>0?m.enabledModels:null,O={name:m.name,type:m.type,isEnabled:m.isEnabled,apiKeyId:m.apiKeyId,baseURL:m.baseURL,autoFetchModels:m.autoFetchModels,enabledModels:I};Object.keys(O).forEach(B=>{O[B]===void 0&&delete O[B]}),await n(e.id,O),l(!1),y({}),Me.success(`Provider "${O.name||e.name}" updated.`)}catch(I){console.error("Failed to save provider update:",I),Me.error("Failed to save provider configuration.")}finally{u(!1)}},[m,n,e.id,e.name]),R=E.useCallback((I,O)=>{y(B=>({...B,[I]:O}))},[]),A=E.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(I){console.error("Failed to delete provider:",I),h(!1)}}},[r,e.id,e.name]),N=E.useCallback(async()=>{if(await s(e.id),o){const I=b(e.id);x([...I].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id)))}},[s,e.id,o,b]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(THe,{providerId:e.id,editData:m,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:k,onSave:C,onChange:R}):f.jsx(kHe,{provider:e,apiKeys:t,onEdit:S,onDelete:A,onFetchModels:N,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},RHe=Ve.memo(AHe);function NHe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const WT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function mb(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function e5(e){return"nodeType"in e}function Uo(e){var t,n;return e?mb(e)?e:e5(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function t5(e){const{Document:t}=Uo(e);return e instanceof t}function i_(e){return mb(e)?!1:e instanceof Uo(e).HTMLElement}function nie(e){return e instanceof Uo(e).SVGElement}function gb(e){return e?mb(e)?e.document:e5(e)?t5(e)?e:i_(e)||nie(e)?e.ownerDocument:document:document:document}const Ou=WT?E.useLayoutEffect:E.useEffect;function n5(e){const t=E.useRef(e);return Ou(()=>{t.current=e}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function MHe(){const e=E.useRef(null),t=E.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Yw(e,t){t===void 0&&(t=[e]);const n=E.useRef(e);return Ou(()=>{n.current!==e&&(n.current=e)},t),n}function a_(e,t){const n=E.useRef();return E.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Ek(e){const t=n5(e),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function j4(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let g3={};function o_(e,t){return E.useMemo(()=>{if(t)return t;const n=g3[e]==null?0:g3[e]+1;return g3[e]=n,e+"-"+n},[e,t])}function rie(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const D0=rie(1),Zw=rie(-1);function IHe(e){return"clientX"in e&&"clientY"in e}function r5(e){if(!e)return!1;const{KeyboardEvent:t}=Uo(e.target);return t&&e instanceof t}function jHe(e){if(!e)return!1;const{TouchEvent:t}=Uo(e.target);return t&&e instanceof t}function P4(e){if(jHe(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return IHe(e)?{x:e.clientX,y:e.clientY}:null}const Xw=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Xw.Translate.toString(e),Xw.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),$q="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function PHe(e){return e.matches($q)?e:e.querySelector($q)}const OHe={display:"none"};function DHe(e){let{id:t,value:n}=e;return Ve.createElement("div",{id:t,style:OHe},n)}function FHe(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ve.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function LHe(){const[e,t]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const sie=E.createContext(null);function BHe(e){const t=E.useContext(sie);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function $He(){const[e]=E.useState(()=>new Set),t=E.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[E.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const zHe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},UHe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function qHe(e){let{announcements:t=UHe,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=zHe}=e;const{announce:i,announcement:a}=LHe(),o=o_("DndLiveRegion"),[l,c]=E.useState(!1);if(E.useEffect(()=>{c(!0)},[]),BHe(E.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:m}=d;t.onDragMove&&i(t.onDragMove({active:h,over:m}))},onDragOver(d){let{active:h,over:m}=d;i(t.onDragOver({active:h,over:m}))},onDragEnd(d){let{active:h,over:m}=d;i(t.onDragEnd({active:h,over:m}))},onDragCancel(d){let{active:h,over:m}=d;i(t.onDragCancel({active:h,over:m}))}}),[i,t])),!l)return null;const u=Ve.createElement(Ve.Fragment,null,Ve.createElement(DHe,{id:r,value:s.draggable}),Ve.createElement(FHe,{id:o,announcement:a}));return n?il.createPortal(u,n):u}var Bi;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Bi||(Bi={}));function Tk(){}function zq(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function VHe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Oc=Object.freeze({x:0,y:0});function iie(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function aie(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function WHe(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Uq(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function oie(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function qq(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const HHe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=qq(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=iie(qq(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(aie)},GHe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=Uq(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=Uq(l),u=s.reduce((h,m,y)=>h+iie(c[y],m),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(aie)};function KHe(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const YHe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=KHe(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(WHe)};function ZHe(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function lie(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Oc}function XHe(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const JHe=XHe(1);function QHe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function eGe(e,t,n){const r=QHe(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const tGe={ignoreTransform:!1};function yb(e,t){t===void 0&&(t=tGe);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=Uo(e).getComputedStyle(e);c&&(n=eGe(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function Vq(e){return yb(e,{ignoreTransform:!0})}function nGe(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function rGe(e,t){return t===void 0&&(t=Uo(e).getComputedStyle(e)),t.position==="fixed"}function sGe(e,t){t===void 0&&(t=Uo(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function HT(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(t5(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!i_(s)||nie(s)||n.includes(s))return n;const i=Uo(e).getComputedStyle(s);return s!==e&&sGe(s,i)&&n.push(s),rGe(s,i)?n:r(s.parentNode)}return e?r(e):n}function cie(e){const[t]=HT(e,1);return t??null}function y3(e){return!WT||!e?null:mb(e)?e:e5(e)?t5(e)||e===gb(e).scrollingElement?window:i_(e)?e:null:null}function uie(e){return mb(e)?e.scrollX:e.scrollLeft}function die(e){return mb(e)?e.scrollY:e.scrollTop}function O4(e){return{x:uie(e),y:die(e)}}var sa;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(sa||(sa={}));function fie(e){return!WT||!e?!1:e===document.scrollingElement}function hie(e){const t={x:0,y:0},n=fie(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const iGe={x:.2,y:.2};function aGe(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=iGe);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=hie(e),m={x:0,y:0},y={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(m.y=sa.Backward,y.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(m.y=sa.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(m.x=sa.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(m.x=sa.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:y}}function oGe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function pie(e){return e.reduce((t,n)=>D0(t,O4(n)),Oc)}function lGe(e){return e.reduce((t,n)=>t+uie(n),0)}function cGe(e){return e.reduce((t,n)=>t+die(n),0)}function uGe(e,t){if(t===void 0&&(t=yb),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);cie(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const dGe=[["x",["left","right"],lGe],["y",["top","bottom"],cGe]];class s5{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=HT(n),s=pie(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of dGe)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class jx{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function fGe(e){const{EventTarget:t}=Uo(e);return e instanceof t?e:gb(e)}function b3(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var Ll;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ll||(Ll={}));function Wq(e){e.preventDefault()}function hGe(e){e.stopPropagation()}var Vr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Vr||(Vr={}));const mie={start:[Vr.Space,Vr.Enter],cancel:[Vr.Esc],end:[Vr.Space,Vr.Enter,Vr.Tab]},pGe=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Vr.Right:return{...n,x:n.x+25};case Vr.Left:return{...n,x:n.x-25};case Vr.Down:return{...n,y:n.y+25};case Vr.Up:return{...n,y:n.y-25}}};class i5{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new jx(gb(n)),this.windowListeners=new jx(Uo(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ll.Resize,this.handleCancel),this.windowListeners.add(Ll.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ll.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&uGe(r),n(Oc)}handleKeyDown(t){if(r5(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=mie,coordinateGetter:a=pGe,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Oc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=Zw(d,u),m={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const v=t.code,{isTop:x,isRight:w,isLeft:S,isBottom:k,maxScroll:C,minScroll:R}=hie(b),A=oGe(b),N={x:Math.min(v===Vr.Right?A.right-A.width/2:A.right,Math.max(v===Vr.Right?A.left:A.left+A.width/2,d.x)),y:Math.min(v===Vr.Down?A.bottom-A.height/2:A.bottom,Math.max(v===Vr.Down?A.top:A.top+A.height/2,d.y))},I=v===Vr.Right&&!w||v===Vr.Left&&!S,O=v===Vr.Down&&!k||v===Vr.Up&&!x;if(I&&N.x!==d.x){const B=b.scrollLeft+h.x,D=v===Vr.Right&&B<=C.x||v===Vr.Left&&B>=R.x;if(D&&!h.y){b.scrollTo({left:B,behavior:o});return}D?m.x=b.scrollLeft-B:m.x=v===Vr.Right?b.scrollLeft-C.x:b.scrollLeft-R.x,m.x&&b.scrollBy({left:-m.x,behavior:o});break}else if(O&&N.y!==d.y){const B=b.scrollTop+h.y,D=v===Vr.Down&&B<=C.y||v===Vr.Up&&B>=R.y;if(D&&!h.x){b.scrollTo({top:B,behavior:o});return}D?m.y=b.scrollTop-B:m.y=v===Vr.Down?b.scrollTop-C.y:b.scrollTop-R.y,m.y&&b.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,D0(Zw(d,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}i5.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=mie,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function Hq(e){return!!(e&&"distance"in e)}function Gq(e){return!!(e&&"delay"in e)}class a5{constructor(t,n,r){var s;r===void 0&&(r=fGe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=gb(a),this.documentListeners=new jx(this.document),this.listeners=new jx(r),this.windowListeners=new jx(Uo(a)),this.initialCoordinates=(s=P4(i))!=null?s:Oc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ll.Resize,this.handleCancel),this.windowListeners.add(Ll.DragStart,Wq),this.windowListeners.add(Ll.VisibilityChange,this.handleCancel),this.windowListeners.add(Ll.ContextMenu,Wq),this.documentListeners.add(Ll.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Gq(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Hq(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ll.Click,hGe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ll.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=P4(t))!=null?n:Oc,c=Zw(s,l);if(!r&&o){if(Hq(o)){if(o.tolerance!=null&&b3(c,o.tolerance))return this.handleCancel();if(b3(c,o.distance))return this.handleStart()}if(Gq(o)&&b3(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Vr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const mGe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class o5 extends a5{constructor(t){const{event:n}=t,r=gb(n.target);super(t,mGe,r)}}o5.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const gGe={move:{name:"mousemove"},end:{name:"mouseup"}};var D4;(function(e){e[e.RightClick=2]="RightClick"})(D4||(D4={}));class yGe extends a5{constructor(t){super(t,gGe,gb(t.event.target))}}yGe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===D4.RightClick?!1:(r==null||r({event:n}),!0)}}];const v3={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class bGe extends a5{constructor(t){super(t,v3)}static setup(){return window.addEventListener(v3.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(v3.move.name,t)};function t(){}}}bGe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var Px;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Px||(Px={}));var Ak;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ak||(Ak={}));function vGe(e){let{acceleration:t,activator:n=Px.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=Ak.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const m=wGe({delta:d,disabled:!i}),[y,b]=MHe(),v=E.useRef({x:0,y:0}),x=E.useRef({x:0,y:0}),w=E.useMemo(()=>{switch(n){case Px.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Px.DraggableRect:return s}},[n,s,l]),S=E.useRef(null),k=E.useCallback(()=>{const R=S.current;if(!R)return;const A=v.current.x*x.current.x,N=v.current.y*x.current.y;R.scrollBy(A,N)},[]),C=E.useMemo(()=>o===Ak.TreeOrder?[...c].reverse():c,[o,c]);E.useEffect(()=>{if(!i||!c.length||!w){b();return}for(const R of C){if((r==null?void 0:r(R))===!1)continue;const A=c.indexOf(R),N=u[A];if(!N)continue;const{direction:I,speed:O}=aGe(R,N,w,t,h);for(const B of["x","y"])m[B][I[B]]||(O[B]=0,I[B]=0);if(O.x>0||O.y>0){b(),S.current=R,y(k,a),v.current=O,x.current=I;return}}v.current={x:0,y:0},x.current={x:0,y:0},b()},[t,k,r,b,i,a,JSON.stringify(w),JSON.stringify(m),y,c,C,u,JSON.stringify(h)])}const xGe={x:{[sa.Backward]:!1,[sa.Forward]:!1},y:{[sa.Backward]:!1,[sa.Forward]:!1}};function wGe(e){let{delta:t,disabled:n}=e;const r=j4(t);return a_(s=>{if(n||!r||!s)return xGe;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[sa.Backward]:s.x[sa.Backward]||i.x===-1,[sa.Forward]:s.x[sa.Forward]||i.x===1},y:{[sa.Backward]:s.y[sa.Backward]||i.y===-1,[sa.Forward]:s.y[sa.Forward]||i.y===1}}},[n,t,r])}function _Ge(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return a_(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function SGe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var Jw;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Jw||(Jw={}));var F4;(function(e){e.Optimized="optimized"})(F4||(F4={}));const Kq=new Map;function CGe(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=E.useState(null),{frequency:o,measure:l,strategy:c}=s,u=E.useRef(e),d=v(),h=Yw(d),m=E.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(S=>!w.includes(S))))},[h]),y=E.useRef(null),b=a_(x=>{if(d&&!n)return Kq;if(!x||x===Kq||u.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const k=S.node.current,C=k?new s5(l(k),k):null;S.rect.current=C,C&&w.set(S.id,C)}return w}return x},[e,i,n,d,l]);return E.useEffect(()=>{u.current=e},[e]),E.useEffect(()=>{d||m()},[n,d]),E.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),E.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},o))},[o,d,m,...r]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function v(){switch(c){case Jw.Always:return!1;case Jw.BeforeDragging:return n;default:return!n}}}function gie(e,t){return a_(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function kGe(e,t){return gie(e,t)}function EGe(e){let{callback:t,disabled:n}=e;const r=n5(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function GT(e){let{callback:t,disabled:n}=e;const r=n5(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function TGe(e){return new s5(yb(e),e)}function Yq(e,t,n){t===void 0&&(t=TGe);const[r,s]=E.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=EGe({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=GT({callback:i});return Ou(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function AGe(e){const t=gie(e);return lie(e,t)}const Zq=[];function RGe(e){const t=E.useRef(e),n=a_(r=>e?r&&r!==Zq&&e&&t.current&&e.parentNode===t.current.parentNode?r:HT(e):Zq,[e]);return E.useEffect(()=>{t.current=e},[e]),n}function NGe(e){const[t,n]=E.useState(null),r=E.useRef(e),s=E.useCallback(i=>{const a=y3(i.target);a&&n(o=>o?(o.set(a,O4(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=y3(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,O4(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=y3(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>D0(i,a),Oc):pie(e):Oc,[e,t])}function Xq(e,t){t===void 0&&(t=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},t),E.useEffect(()=>{const r=e!==Oc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Zw(e,n.current):Oc}function MGe(e){E.useEffect(()=>{if(!WT)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function IGe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function yie(e){return E.useMemo(()=>e?nGe(e):null,[e])}const Jq=[];function jGe(e,t){t===void 0&&(t=yb);const[n]=e,r=yie(n?Uo(n):null),[s,i]=E.useState(Jq);function a(){i(()=>e.length?e.map(l=>fie(l)?r:new s5(t(l),l)):Jq)}const o=GT({callback:a});return Ou(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function PGe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return i_(t)?t:e}function OGe(e){let{measure:t}=e;const[n,r]=E.useState(null),s=E.useCallback(c=>{for(const{target:u}of c)if(i_(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=GT({callback:s}),a=E.useCallback(c=>{const u=PGe(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=Ek(a);return E.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const DGe=[{sensor:o5,options:{}},{sensor:i5,options:{}}],FGe={current:{}},z2={draggable:{measure:Vq},droppable:{measure:Vq,strategy:Jw.WhileDragging,frequency:F4.Optimized},dragOverlay:{measure:yb}};class Ox extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const LGe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ox,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Tk},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:z2,measureDroppableContainers:Tk,windowRect:null,measuringScheduled:!1},BGe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Tk,draggableNodes:new Map,over:null,measureDroppableContainers:Tk},KT=E.createContext(BGe),bie=E.createContext(LGe);function $Ge(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ox}}}function zGe(e,t){switch(t.type){case Bi.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Bi.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Bi.DragEnd:case Bi.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Bi.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Ox(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case Bi.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Ox(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case Bi.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Ox(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function UGe(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(KT),i=j4(r),a=j4(n==null?void 0:n.id);return E.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!r5(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=PHe(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function qGe(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function VGe(e){return E.useMemo(()=>({draggable:{...z2.draggable,...e==null?void 0:e.draggable},droppable:{...z2.droppable,...e==null?void 0:e.droppable},dragOverlay:{...z2.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function WGe(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=E.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Ou(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=lie(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=cie(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const vie=E.createContext({...Oc,scaleX:1,scaleY:1});var ih;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ih||(ih={}));const HGe=E.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=DGe,collisionDetection:d=YHe,measuring:h,modifiers:m,...y}=t;const b=E.useReducer(zGe,void 0,$Ge),[v,x]=b,[w,S]=$He(),[k,C]=E.useState(ih.Uninitialized),R=k===ih.Initialized,{draggable:{active:A,nodes:N,translate:I},droppable:{containers:O}}=v,B=A!=null?N.get(A):null,D=E.useRef({initial:null,translated:null}),W=E.useMemo(()=>{var st;return A!=null?{id:A,data:(st=B==null?void 0:B.data)!=null?st:FGe,rect:D}:null},[A,B]),P=E.useRef(null),[Z,U]=E.useState(null),[H,L]=E.useState(null),ne=Yw(y,Object.values(y)),V=o_("DndDescribedBy",a),Q=E.useMemo(()=>O.getEnabled(),[O]),ee=VGe(h),{droppableRects:se,measureDroppableContainers:me,measuringScheduled:ce}=CGe(Q,{dragging:R,dependencies:[I.x,I.y],config:ee.droppable}),je=_Ge(N,A),De=E.useMemo(()=>H?P4(H):null,[H]),Se=ze(),Ce=kGe(je,ee.draggable.measure);WGe({activeNode:A!=null?N.get(A):null,config:Se.layoutShiftCompensation,initialRect:Ce,measure:ee.draggable.measure});const qe=Yq(je,ee.draggable.measure,Ce),Qe=Yq(je?je.parentElement:null),We=E.useRef({activatorEvent:null,active:null,activeNode:je,collisionRect:null,collisions:null,droppableRects:se,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ne=O.getNodeFor((n=We.current.over)==null?void 0:n.id),K=OGe({measure:ee.dragOverlay.measure}),ge=(r=K.nodeRef.current)!=null?r:je,Ae=R?(s=K.rect)!=null?s:qe:null,le=!!(K.nodeRef.current&&K.rect),oe=AGe(le?null:qe),re=yie(ge?Uo(ge):null),Te=RGe(R?Ne??je:null),Be=jGe(Te),ke=qGe(m,{transform:{x:I.x-oe.x,y:I.y-oe.y,scaleX:1,scaleY:1},activatorEvent:H,active:W,activeNodeRect:qe,containerNodeRect:Qe,draggingNodeRect:Ae,over:We.current.over,overlayNodeRect:K.rect,scrollableAncestors:Te,scrollableAncestorRects:Be,windowRect:re}),lt=De?D0(De,I):null,Rt=NGe(Te),ft=Xq(Rt),Pt=Xq(Rt,[qe]),qt=D0(ke,ft),Lt=Ae?JHe(Ae,ke):null,en=W&&Lt?d({active:W,collisionRect:Lt,droppableRects:se,droppableContainers:Q,pointerCoordinates:lt}):null,xe=oie(en,"id"),[F,X]=E.useState(null),ye=le?ke:D0(ke,Pt),Fe=ZHe(ye,(i=F==null?void 0:F.rect)!=null?i:null,qe),we=E.useRef(null),Ie=E.useCallback((st,be)=>{let{sensor:_e,options:Ue}=be;if(P.current==null)return;const Et=N.get(P.current);if(!Et)return;const he=st.nativeEvent,Y=new _e({active:P.current,activeNode:Et,event:he,options:Ue,context:We,onAbort(J){if(!N.get(J))return;const{onDragAbort:Oe}=ne.current,Ke={id:J};Oe==null||Oe(Ke),w({type:"onDragAbort",event:Ke})},onPending(J,ve,Oe,Ke){if(!N.get(J))return;const{onDragPending:tn}=ne.current,zn={id:J,constraint:ve,initialCoordinates:Oe,offset:Ke};tn==null||tn(zn),w({type:"onDragPending",event:zn})},onStart(J){const ve=P.current;if(ve==null)return;const Oe=N.get(ve);if(!Oe)return;const{onDragStart:Ke}=ne.current,_t={activatorEvent:he,active:{id:ve,data:Oe.data,rect:D}};il.unstable_batchedUpdates(()=>{Ke==null||Ke(_t),C(ih.Initializing),x({type:Bi.DragStart,initialCoordinates:J,active:ve}),w({type:"onDragStart",event:_t}),U(we.current),L(he)})},onMove(J){x({type:Bi.DragMove,coordinates:J})},onEnd:G(Bi.DragEnd),onCancel:G(Bi.DragCancel)});we.current=Y;function G(J){return async function(){const{active:Oe,collisions:Ke,over:_t,scrollAdjustedTranslate:tn}=We.current;let zn=null;if(Oe&&tn){const{cancelDrop:Xt}=ne.current;zn={activatorEvent:he,active:Oe,collisions:Ke,delta:tn,over:_t},J===Bi.DragEnd&&typeof Xt=="function"&&await Promise.resolve(Xt(zn))&&(J=Bi.DragCancel)}P.current=null,il.unstable_batchedUpdates(()=>{x({type:J}),C(ih.Uninitialized),X(null),U(null),L(null),we.current=null;const Xt=J===Bi.DragEnd?"onDragEnd":"onDragCancel";if(zn){const nn=ne.current[Xt];nn==null||nn(zn),w({type:Xt,event:zn})}})}}},[N]),fe=E.useCallback((st,be)=>(_e,Ue)=>{const Et=_e.nativeEvent,he=N.get(Ue);if(P.current!==null||!he||Et.dndKit||Et.defaultPrevented)return;const Y={active:he};st(_e,be.options,Y)===!0&&(Et.dndKit={capturedBy:be.sensor},P.current=Ue,Ie(_e,be))},[N,Ie]),vt=SGe(u,fe);MGe(u),Ou(()=>{qe&&k===ih.Initializing&&C(ih.Initialized)},[qe,k]),E.useEffect(()=>{const{onDragMove:st}=ne.current,{active:be,activatorEvent:_e,collisions:Ue,over:Et}=We.current;if(!be||!_e)return;const he={active:be,activatorEvent:_e,collisions:Ue,delta:{x:qt.x,y:qt.y},over:Et};il.unstable_batchedUpdates(()=>{st==null||st(he),w({type:"onDragMove",event:he})})},[qt.x,qt.y]),E.useEffect(()=>{const{active:st,activatorEvent:be,collisions:_e,droppableContainers:Ue,scrollAdjustedTranslate:Et}=We.current;if(!st||P.current==null||!be||!Et)return;const{onDragOver:he}=ne.current,Y=Ue.get(xe),G=Y&&Y.rect.current?{id:Y.id,rect:Y.rect.current,data:Y.data,disabled:Y.disabled}:null,J={active:st,activatorEvent:be,collisions:_e,delta:{x:Et.x,y:Et.y},over:G};il.unstable_batchedUpdates(()=>{X(G),he==null||he(J),w({type:"onDragOver",event:J})})},[xe]),Ou(()=>{We.current={activatorEvent:H,active:W,activeNode:je,collisionRect:Lt,collisions:en,droppableRects:se,draggableNodes:N,draggingNode:ge,draggingNodeRect:Ae,droppableContainers:O,over:F,scrollableAncestors:Te,scrollAdjustedTranslate:qt},D.current={initial:Ae,translated:Lt}},[W,je,en,Lt,N,ge,Ae,se,O,F,Te,qt]),vGe({...Se,delta:I,draggingRect:Lt,pointerCoordinates:lt,scrollableAncestors:Te,scrollableAncestorRects:Be});const ot=E.useMemo(()=>({active:W,activeNode:je,activeNodeRect:qe,activatorEvent:H,collisions:en,containerNodeRect:Qe,dragOverlay:K,draggableNodes:N,droppableContainers:O,droppableRects:se,over:F,measureDroppableContainers:me,scrollableAncestors:Te,scrollableAncestorRects:Be,measuringConfiguration:ee,measuringScheduled:ce,windowRect:re}),[W,je,qe,H,en,Qe,K,N,O,se,F,me,Te,Be,ee,ce,re]),$=E.useMemo(()=>({activatorEvent:H,activators:vt,active:W,activeNodeRect:qe,ariaDescribedById:{draggable:V},dispatch:x,draggableNodes:N,over:F,measureDroppableContainers:me}),[H,vt,W,qe,x,V,N,F,me]);return Ve.createElement(sie.Provider,{value:S},Ve.createElement(KT.Provider,{value:$},Ve.createElement(bie.Provider,{value:ot},Ve.createElement(vie.Provider,{value:Fe},c)),Ve.createElement(UGe,{disabled:(o==null?void 0:o.restoreFocus)===!1})),Ve.createElement(qHe,{...o,hiddenTextDescribedById:V}));function ze(){const st=(Z==null?void 0:Z.autoScrollEnabled)===!1,be=typeof l=="object"?l.enabled===!1:l===!1,_e=R&&!st&&!be;return typeof l=="object"?{...l,enabled:_e}:{enabled:_e}}}),GGe=E.createContext(null),Qq="button",KGe="Draggable";function YGe(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=o_(KGe),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=E.useContext(KT),{role:m=Qq,roleDescription:y="draggable",tabIndex:b=0}=s??{},v=(l==null?void 0:l.id)===t,x=E.useContext(v?vie:GGe),[w,S]=Ek(),[k,C]=Ek(),R=IGe(a,t),A=Yw(n);Ou(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:k,data:A}),()=>{const I=d.get(t);I&&I.key===i&&d.delete(t)}),[d,t]);const N=E.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&m===Qq?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,m,b,v,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:N,isDragging:v,listeners:r?void 0:R,node:w,over:h,setNodeRef:S,setActivatorNodeRef:C,transform:x}}function ZGe(){return E.useContext(bie)}const XGe="Droppable",JGe={timeout:25};function QGe(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=o_(XGe),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=E.useContext(KT),u=E.useRef({disabled:n}),d=E.useRef(!1),h=E.useRef(null),m=E.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:v}={...JGe,...s},x=Yw(b??r),w=E.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),m.current=null},v)},[v]),S=GT({callback:w,disabled:y||!a}),k=E.useCallback((N,I)=>{S&&(I&&(S.unobserve(I),d.current=!1),N&&S.observe(N))},[S]),[C,R]=Ek(k),A=Yw(t);return E.useEffect(()=>{!S||!C.current||(S.disconnect(),d.current=!1,S.observe(C.current))},[C,S]),E.useEffect(()=>(o({type:Bi.RegisterDroppable,element:{id:r,key:i,disabled:n,node:C,rect:h,data:A}}),()=>o({type:Bi.UnregisterDroppable,key:i,id:r})),[r]),E.useEffect(()=>{n!==u.current.disabled&&(o({type:Bi.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:C,over:l,setNodeRef:R}}function Dx(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function eKe(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function f2(e){return e!==null&&e>=0}function tKe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function nKe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const xie=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=Dx(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},h2={scaleX:1,scaleY:1},rKe=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...h2}:null}const l=sKe(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...h2}:s<n&&s>=a?{x:0,y:o.height+l,...h2}:{x:0,y:0,...h2}};function sKe(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const wie="Sortable",_ie=Ve.createContext({activeIndex:-1,containerId:wie,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:xie,disabled:{draggable:!1,droppable:!1}});function iKe(e){let{children:t,id:n,items:r,strategy:s=xie,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=ZGe(),d=o_(wie,n),h=o.rect!==null,m=E.useMemo(()=>r.map(R=>typeof R=="object"&&"id"in R?R.id:R),[r]),y=a!=null,b=a?m.indexOf(a.id):-1,v=c?m.indexOf(c.id):-1,x=E.useRef(m),w=!tKe(m,x.current),S=v!==-1&&b===-1||w,k=nKe(i);Ou(()=>{w&&y&&u(m)},[w,m,y,u]),E.useEffect(()=>{x.current=m},[m]);const C=E.useMemo(()=>({activeIndex:b,containerId:d,disabled:k,disableTransforms:S,items:m,overIndex:v,useDragOverlay:h,sortedRects:eKe(m,l),strategy:s}),[b,d,k.draggable,k.droppable,S,m,v,l,h,s]);return Ve.createElement(_ie.Provider,{value:C},t)}const aKe=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return Dx(n,r,s).indexOf(t)},oKe=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},lKe={duration:200,easing:"ease"},Sie="transform",cKe=Xw.Transition.toString({property:Sie,duration:0,easing:"linear"}),uKe={roleDescription:"sortable"};function dKe(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=E.useState(null),o=E.useRef(n);return Ou(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=yb(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),E.useEffect(()=>{i&&a(null)},[i]),i}function fKe(e){let{animateLayoutChanges:t=oKe,attributes:n,disabled:r,data:s,getNewIndex:i=aKe,id:a,strategy:o,resizeObserverConfig:l,transition:c=lKe}=e;const{items:u,containerId:d,activeIndex:h,disabled:m,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:x,strategy:w}=E.useContext(_ie),S=hKe(r,m),k=u.indexOf(a),C=E.useMemo(()=>({sortable:{containerId:d,index:k,items:u},...s}),[d,s,k,u]),R=E.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:A,node:N,isOver:I,setNodeRef:O}=QGe({id:a,data:C,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:R,...l}}),{active:B,activatorEvent:D,activeNodeRect:W,attributes:P,setNodeRef:Z,listeners:U,isDragging:H,over:L,setActivatorNodeRef:ne,transform:V}=YGe({id:a,data:C,attributes:{...uKe,...n},disabled:S.draggable}),Q=NHe(O,Z),ee=!!B,se=ee&&!y&&f2(h)&&f2(v),me=!x&&H,ce=me&&se?V:null,De=se?ce??(o??w)({rects:b,activeNodeRect:W,activeIndex:h,overIndex:v,index:k}):null,Se=f2(h)&&f2(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):k,Ce=B==null?void 0:B.id,qe=E.useRef({activeId:Ce,items:u,newIndex:Se,containerId:d}),Qe=u!==qe.current.items,We=t({active:B,containerId:d,isDragging:H,isSorting:ee,id:a,index:k,items:u,newIndex:qe.current.newIndex,previousItems:qe.current.items,previousContainerId:qe.current.containerId,transition:c,wasDragging:qe.current.activeId!=null}),Ne=dKe({disabled:!We,index:k,node:N,rect:A});return E.useEffect(()=>{ee&&qe.current.newIndex!==Se&&(qe.current.newIndex=Se),d!==qe.current.containerId&&(qe.current.containerId=d),u!==qe.current.items&&(qe.current.items=u)},[ee,Se,d,u]),E.useEffect(()=>{if(Ce===qe.current.activeId)return;if(Ce!=null&&qe.current.activeId==null){qe.current.activeId=Ce;return}const ge=setTimeout(()=>{qe.current.activeId=Ce},50);return()=>clearTimeout(ge)},[Ce]),{active:B,activeIndex:h,attributes:P,data:C,rect:A,index:k,newIndex:Se,items:u,isOver:I,isSorting:ee,isDragging:H,listeners:U,node:N,overIndex:v,over:L,setNodeRef:Q,setActivatorNodeRef:ne,setDroppableNodeRef:O,setDraggableNodeRef:Z,transform:Ne??De,transition:K()};function K(){if(Ne||Qe&&qe.current.newIndex===k)return cKe;if(!(me&&!r5(D)||!c)&&(ee||We))return Xw.Transition.toString({...c,property:Sie})}}function hKe(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Rk(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const pKe=[Vr.Down,Vr.Right,Vr.Up,Vr.Left],mKe=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(pKe.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Vr.Down:r.top<h.top&&l.push(d);break;case Vr.Up:r.top>h.top&&l.push(d);break;case Vr.Left:r.left>h.left&&l.push(d);break;case Vr.Right:r.left<h.left&&l.push(d);break}});const c=GHe({collisionRect:r,droppableRects:s,droppableContainers:l});let u=oie(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),m=h?s.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&m&&d&&h){const v=HT(y).some((R,A)=>o[A]!==R),x=Cie(d,h),w=gKe(d,h),S=v||!x?{x:0,y:0}:{x:w?r.width-m.width:0,y:w?r.height-m.height:0},k={x:m.left,y:m.top};return S.x&&S.y?k:Zw(k,S)}}}};function Cie(e,t){return!Rk(e)||!Rk(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function gKe(e,t){return!Rk(e)||!Rk(t)||!Cie(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const yKe=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var C,R,A;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:m}=fKe({id:e,disabled:!1}),y={transform:Xw.Transform.toString(d),transition:h,zIndex:m?10:void 0},b=new Set(((C=t.metadataSummary)==null?void 0:C.supported_parameters)??[]),v=new Set(((R=t.metadataSummary)==null?void 0:R.input_modalities)??[]),x=b.has("reasoning"),w=b.has("web_search")||b.has("web_search_options"),S=b.has("tools"),k=Array.from(v).some(N=>N!=="text");return f.jsxs("div",{ref:u,style:y,className:Je("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",m&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Je("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(Mme,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(jt,{className:Je("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Ly,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(jo,{className:"h-3 w-3 text-green-500"}),S&&f.jsx(Vx,{className:"h-3 w-3 text-orange-500"}),k&&f.jsx(Y0,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((A=t.metadataSummary)==null?void 0:A.description)&&f.jsx(xr,{delayDuration:100,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(zP,{className:"h-4 w-4"})})}),f.jsx(Sr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(er,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(Npe,{}),className:"h-6 w-6"}),f.jsx(er,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(fpe,{}),className:"h-6 w-6"}),f.jsx(er,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(fH,{}),className:"h-6 w-6"})]})]})},bKe=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Nr(gn(S=>({dbProviderConfigs:S.dbProviderConfigs,globalModelSortOrder:S.globalModelSortOrder,isLoading:S.isLoading,getAvailableModelListItems:S.getAvailableModelListItems}))),[i,a]=E.useState(""),[o,l]=E.useState(()=>new Set(t.map(S=>S.id))),[c,u]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});E.useEffect(()=>{l(new Set(t.map(S=>S.id)))},[t]);const d=E.useMemo(()=>{const S=s(),k=new Map(S.map(I=>[I.id,I])),C=new Set;t.forEach(I=>{I.isEnabled&&I.enabledModels&&I.enabledModels.forEach(O=>{C.add(wx(I.id,O))})});const R=S.filter(I=>C.has(I.id)),A=[],N=new Set;return n.forEach(I=>{if(C.has(I)){const O=k.get(I);O&&!N.has(I)&&(A.push(O),N.add(I))}}),R.forEach(I=>{N.has(I.id)||A.push(I)}),A},[t,n,s]),h=E.useMemo(()=>{let S=d;if(o.size!==t.length&&(S=S.filter(C=>o.has(C.providerId))),i.trim()){const C=i.toLowerCase();S=S.filter(R=>R.name.toLowerCase().includes(C)||R.providerName.toLowerCase().includes(C)||R.id.toLowerCase().includes(C))}const k=Object.entries(c).filter(([,C])=>C).map(([C])=>C);return k.length>0&&(S=S.filter(C=>{var N,I;const R=new Set(((N=C.metadataSummary)==null?void 0:N.supported_parameters)??[]),A=new Set(((I=C.metadataSummary)==null?void 0:I.input_modalities)??[]);return k.every(O=>{switch(O){case"reasoning":return R.has("reasoning");case"webSearch":return R.has("web_search")||R.has("web_search_options");case"tools":return R.has("tools");case"multimodal":return Array.from(A).some(B=>B!=="text");default:return!0}})})),S},[d,i,o,t.length,c]),m=E.useMemo(()=>i.trim().length>0||o.size!==t.length||Object.values(c).some(Boolean),[i,o,t.length,c]),y=E.useMemo(()=>{const S=o.size!==t.length?1:0,k=Object.values(c).filter(Boolean).length;return S+k},[o,t.length,c]),b=E.useMemo(()=>h.map(S=>S.id),[h]),v=E.useCallback(S=>{const{active:k,over:C}=S;if(C&&k.id!==C.id){const R=d.map(B=>B.id),A=k.id,N=C.id,I=R.indexOf(A),O=R.indexOf(N);if(I!==-1&&O!==-1){const B=Dx(R,I,O);e(B)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[d,e]),x=E.useCallback((S,k)=>{if(m)return;const C=d.map(N=>N.id),R=C.indexOf(S);if(R===-1)return;let A;if(k==="top"){if(R===0)return;const N=C.splice(R,1)[0];C.unshift(N),A=C}else if(k==="up"){if(R===0)return;A=Dx(C,R,R-1)}else{if(R===C.length-1)return;A=Dx(C,R,R+1)}e(A)},[d,e,m]),w=VHe(zq(o5),zq(i5,{coordinateGetter:mKe}));return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Wr,{className:"h-8 w-1/3"}),f.jsx(Wr,{className:"h-6 w-1/2"}),f.jsx(Wr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(Ih,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(jt,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:S=>a(S.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsx(M6,{currentCapabilityFilters:c,onCapabilityFilterChange:u,currentSelectedProviders:o,onProviderFilterChange:l,allProviders:t,showProviderFilter:!0,showCapabilityFilters:!0,disabled:r||t.length===0,totalActiveFilters:y})]}),f.jsx("div",{className:"w-full rounded-md border border-border p-3 bg-background/50",children:h.length>0?f.jsx(HGe,{sensors:w,collisionDetection:HHe,onDragEnd:v,children:f.jsx(iKe,{items:b,strategy:rKe,children:h.map(S=>f.jsx(yKe,{id:S.id,modelDetails:S,onMoveToTop:()=>x(S.id,"top"),onMoveUp:()=>x(S.id,"up"),onMoveDown:()=>x(S.id,"down"),isFirst:d.findIndex(k=>k.id===S.id)===0,isLast:d.findIndex(k=>k.id===S.id)===d.length-1,buttonsDisabled:m},S.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:m?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},p2=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Il=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(Ts,{children:[f.jsx(On,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(On,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(is,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(is,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),vKe=({modelId:e})=>{var m,y,b,v,x,w,S,k,C,R,A,N;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Nr(gn(I=>({createAiModelConfig:I.createAiModelConfig,dbProviderConfigs:I.dbProviderConfigs,dbApiKeys:I.dbApiKeys,updateProviderConfig:I.updateProviderConfig,isLoading:I.isLoading}))),a=E.useMemo(()=>{if(!e)return;const{providerId:I,modelId:O}=_c(e);if(!I||!O)return;const B=n.find(W=>W.id===I);if(!B)return;const D=r.find(W=>W.id===B.apiKeyId);return t(B,O,D==null?void 0:D.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=E.useCallback(async()=>{if(!a||!e)return;const{providerId:I,modelId:O}=_c(e);if(!I||!O)return;const B=n.find(Z=>Z.id===I);if(!B){Me.error("Provider configuration not found.");return}const D=new Set(B.enabledModels??[]),W=D.has(O);W?D.delete(O):D.add(O);const P=Array.from(D);try{await s(B.id,{enabledModels:P}),Me.success(`Model "${a.name}" ${W?"disabled":"enabled"}.`)}catch{Me.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Wr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(Wl,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(Wl,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=_c(e),d=n.find(I=>I.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((m=d==null?void 0:d.enabledModels)==null?void 0:m.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(jt,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(Mo,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(Hl,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(af,{children:[f.jsxs(mze,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(of,{children:[Il("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),Il("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),Il("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),Il("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Il("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),Il("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),Il("Pricing (Prompt)",p2((k=o.pricing)==null?void 0:k.prompt)),Il("Pricing (Completion)",p2((C=o.pricing)==null?void 0:C.completion)),Il("Pricing (Image)",p2((R=o.pricing)==null?void 0:R.image)),Il("Pricing (Request)",p2((A=o.pricing)==null?void 0:A.request)),Il("Supported Parameters",o.supported_parameters),Il("Moderated",(N=o.top_provider)!=null&&N.is_moderated?f.jsx(fE,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},xKe=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Nr(gn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState({}),u=E.useCallback(async(h,m,y)=>{o(!0);try{await t(h,m,y),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=E.useCallback(async(h,m)=>{if(window.confirm(`Are you sure you want to delete the API key "${m}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&f.jsxs(pt,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(pte,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Wr,{className:"h-10 w-full"}),f.jsx(Wr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Provider Type"}),f.jsx(Tr,{children:"Created"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:(e||[]).map(h=>{const m=l[h.id];return f.jsxs(Ts,{className:m?"opacity-50":"",children:[f.jsx(On,{className:"font-medium",children:h.name||"Unnamed Key"}),f.jsx(On,{children:h.providerId||"Unknown"}),f.jsx(On,{className:"text-xs text-muted-foreground",children:Ad(new Date(h.createdAt),"PPp")}),f.jsx(On,{className:"text-right",children:f.jsx(er,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:m,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:m?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},wKe=Ve.memo(xKe),_Ke=({onSelectModelForDetails:e})=>{const[t,n]=E.useState(null),[r,s]=E.useState(null),i=E.useCallback(C=>{if(C){n(C);const R=C.querySelector("[data-radix-scroll-area-viewport]");if(R)s(R);else{const A=new MutationObserver(()=>{const N=C.querySelector("[data-radix-scroll-area-viewport]");N&&(s(N),A.disconnect())});return A.observe(C,{childList:!0,subtree:!0}),()=>A.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Nr(gn(C=>({getAvailableModelListItems:C.getAvailableModelListItems,isLoading:C.isLoading,dbProviderConfigs:C.dbProviderConfigs}))),[c,u]=E.useState(""),[d,h]=E.useState(()=>new Set(l.map(C=>C.id))),[m,y]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),b=E.useMemo(()=>a(),[a]);E.useEffect(()=>{h(new Set(l.map(C=>C.id)))},[l]);const v=E.useMemo(()=>{let C=b;if(d.size!==l.length&&(C=C.filter(A=>d.has(A.providerId))),c.trim()){const A=c.toLowerCase();C=C.filter(N=>N.name.toLowerCase().includes(A)||N.providerName.toLowerCase().includes(A)||N.id.toLowerCase().includes(A))}const R=Object.entries(m).filter(([,A])=>A).map(([A])=>A);return R.length>0&&(C=C.filter(A=>{var O,B;const N=new Set(((O=A.metadataSummary)==null?void 0:O.supported_parameters)??[]),I=new Set(((B=A.metadataSummary)==null?void 0:B.input_modalities)??[]);return R.every(D=>{switch(D){case"reasoning":return N.has("reasoning");case"webSearch":return N.has("web_search")||N.has("web_search_options");case"tools":return N.has("tools");case"multimodal":return Array.from(I).some(W=>W!=="text");default:return!0}})})),C.sort((A,N)=>{const I=A.providerName.localeCompare(N.providerName);return I!==0?I:A.name.localeCompare(N.name)})},[b,c,d,l.length,m]),x=k6({count:v.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),w=E.useCallback(C=>{e(C)},[e]),S=E.useCallback(C=>{y(C)},[]),k=E.useMemo(()=>(d.size!==l.length?1:0)+Object.values(m).filter(Boolean).length,[d,l.length,m]);return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Wr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Wr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(jo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(Sn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:C=>u(C.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsx(M6,{currentCapabilityFilters:m,onCapabilityFilterChange:S,currentSelectedProviders:d,onProviderFilterChange:h,allProviders:l,showProviderFilter:!0,showCapabilityFilters:!0,disabled:o||l.length===0,totalActiveFilters:k})]}),f.jsxs(Hl,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${x.getTotalSize()}px`,width:"100%",position:"relative"},children:v.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):x.getVirtualItems().map(C=>{var A;const R=v[C.index];return R?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${C.size}px`,transform:`translateY(${C.start}px)`},className:"p-1",children:f.jsx(xr,{delayDuration:300,children:f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>w(R.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:R.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:R.providerName})]})}),((A=R.metadataSummary)==null?void 0:A.description)&&f.jsx(Sr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:R.metadataSummary.description})})]})})},R.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},SKe=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Nr(gn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=E.useState(!1),d=()=>u(!0),h=E.useCallback(()=>u(!1),[]),m=E.useCallback(async b=>{await s(b)},[s]),y=E.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(_te,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(pt,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(Ru,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"}),f.jsx(Wr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>f.jsx(RHe,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:m,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},CKe=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Nr(gn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=E.useState("providers-config"),i=E.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=E.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx(SKe,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(bKe,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(wKe,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(vKe,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(_Ke,{onSelectModelForDetails:i}),scrollable:!1}],[t,i,e]);return f.jsx(tc,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},kKe=Ve.memo(CKe);class EKe{constructor(){de(this,"id","core-provider-settings");de(this,"modApiRef",null);de(this,"eventUnsubscribers",[]);de(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(fr.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>Ve.createElement(kKe,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const TKe=Ge({globalSystemPrompt:$e()});function AKe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const RKe=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=mr(gn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=si({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:TKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),Me.success("Global system prompt updated!")}catch(s){Me.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return E.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(Lo,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx(AKe,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(pt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},NKe=Ge({temperature:Tt().min(0).max(1),topP:Tt().min(0).max(1),maxTokens:Tt().min(1).nullable(),topK:Tt().min(1).nullable(),presencePenalty:Tt().min(-2).max(2),frequencyPenalty:Tt().min(-2).max(2)}),MKe=()=>{const e=mr(gn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=si({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:NKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),Me.success("Assistant parameters updated!")}catch(r){Me.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return E.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(bc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(bc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(Cy,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(Cy,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(bc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(bc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(pt,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(pt,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},IKe=Ge({toolMaxSteps:Tt({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function jKe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const PKe=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=mr(gn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=si({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:IKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),Me.success("Tool settings updated!")}catch(s){Me.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return E.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(Sn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(jKe,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(pt,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},OKe=Ge({autoTitleEnabled:Gn(),autoTitleModelId:$e().nullable(),autoTitlePromptMaxLength:Tt().min(100).max(4e3),autoTitleIncludeFiles:Gn(),autoTitleIncludeRules:Gn()});function $v({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const DKe=()=>{const e=mr(gn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=si({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:OKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),Me.success("Auto-title settings updated!")}catch(r){Me.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return E.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Mo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx($v,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(X6,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx($v,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(Sn,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx($v,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Mo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx($v,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Mo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx($v,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(pt,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},FKe=({selectedTools:e,onToolsChange:t,className:n,disabled:r=!1,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a=5,showMaxSteps:o=!1})=>{const l=E.useMemo(()=>new Set(e),[e]),c=E.useCallback((d,h)=>{const m=h?[...e,d]:e.filter(y=>y!==d);t(m)},[e,t]),u=E.useCallback((d,h)=>{t(d?h:[])},[t]);return f.jsx(kse,{enabledTools:l,onToggleTool:c,onToggleAll:u,disabled:r,className:n,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a,showMaxSteps:o})},LKe=({variables:e,onVariablesChange:t,templateId:n})=>{const[r,s]=E.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""});E.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[n]),E.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[]);const i=()=>{r.name&&(t([...e,{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},a=o=>{t(e.filter((l,c)=>c!==o))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[e.map((o,l)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:o.name}),f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>a(l),children:f.jsx(Wi,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:o.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(is,{variant:o.required?"default":"secondary",children:o.required?"Required":"Optional"}),f.jsx(is,{variant:"outline",children:o.type}),o.default&&f.jsxs(is,{variant:"outline",children:["Default: ",o.default]})]})]},`${o.name}-${l}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(jt,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(jt,{children:"Name"}),f.jsx(Sn,{value:r.name,onChange:o=>s(l=>({...l,name:o.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(jt,{children:"Type"}),f.jsxs(ep,{value:r.type,onValueChange:o=>s(l=>({...l,type:o})),children:[f.jsx(np,{children:f.jsx(tp,{})}),f.jsxs(rp,{children:[f.jsx(Eo,{value:"string",children:"String"}),f.jsx(Eo,{value:"number",children:"Number"}),f.jsx(Eo,{value:"boolean",children:"Boolean"}),f.jsx(Eo,{value:"array",children:"Array"})]})]},`new-variable-type-${n||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(jt,{children:"Description"}),f.jsx(Sn,{value:r.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(jt,{children:"Default Value"}),f.jsx(Sn,{value:r.default,onChange:o=>s(l=>({...l,default:o.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx(Pc,{checked:r.required,onCheckedChange:o=>s(l=>({...l,required:!!o}))}),f.jsx(jt,{children:"Required"})]})]}),f.jsxs(pt,{type:"button",onClick:i,className:"w-full",children:[f.jsx(Ru,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})})},BKe=({selectedFollowUps:e,onFollowUpsChange:t,followUpOptions:n,templateId:r})=>{const[s,i]=E.useState(!1),[a,o]=E.useState(""),l=E.useRef(null),c=n.filter(m=>m.id!==r&&!e.includes(m.id)),u=c.filter(m=>m.name.toLowerCase().includes(a.toLowerCase())||m.description.toLowerCase().includes(a.toLowerCase())),d=m=>{m&&!e.includes(m)&&(t([...e,m]),o(""),i(!1))};E.useEffect(()=>{const m=y=>{l.current&&!l.current.contains(y.target)&&i(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const h=m=>{t(e.filter(y=>y!==m))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Follow-up Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select templates that can be suggested as follow-ups after this template is used."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Selected Follow-ups:"}),e.length===0?f.jsx("p",{className:"text-sm text-muted-foreground",children:"No follow-ups selected yet."}):f.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(m=>{const y=n.find(b=>b.id===m);return y?f.jsxs(is,{variant:"secondary",className:"flex items-center gap-1",children:[y.name,f.jsx(pt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Wi,{className:"h-3 w-3"})})]},m):f.jsxs(is,{variant:"destructive",className:"flex items-center gap-1",children:["Unknown Template (",m,")",f.jsx(pt,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Wi,{className:"h-3 w-3"})})]},m)})})]}),c.length>0&&f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(jt,{className:"text-sm",children:"Add Follow-up Template:"}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm cursor-pointer hover:bg-accent",onClick:()=>i(!s),children:[f.jsx("span",{className:"text-muted-foreground",children:a||"Select a template to add as follow-up"}),f.jsx(Yl,{className:"h-4 w-4 opacity-50"})]}),s&&f.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",children:[f.jsx("div",{className:"p-2",children:f.jsx(Sn,{placeholder:"Search templates...",value:a,onChange:m=>o(m.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:u.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No templates found."}):u.map(m=>f.jsxs("div",{className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",onClick:()=>d(m.id),children:[m.name," - ",m.description]},m.id))})]})]})]}),c.length===0&&e.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"No templates available for follow-ups. Create more templates first."}),c.length===0&&e.length>0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"All available templates have been selected as follow-ups."})]})]})})},$Ke=()=>{const e=Ge({name:$e().min(1,"Name is required"),description:$e(),variables:on(Ge({name:$e().min(1,"Variable name is required"),description:$e(),type:yl(["string","number","boolean","array"]),required:Gn(),default:$e().optional(),instructions:$e().optional()})),prompt:$e().min(1,"Prompt content is required"),tags:on($e()),tools:on($e()),rules:on($e()),followUps:on($e())});return async({value:t})=>{try{await e.parseAsync(t)}catch(n){return n instanceof Ac?n.formErrors.fieldErrors:{root:"Validation failed"}}}},E0=({template:e,onSubmit:t,onSuccess:n,type:r,showFollowUps:s=!1,showMaxSteps:i=!1,followUpOptions:a=[],additionalActions:o})=>{const[l,c]=E.useState(null),{rules:u,tags:d,tagRuleLinks:h,loadRulesAndTags:m}=hne(gn(w=>({rules:w.rules,tags:w.tags,tagRuleLinks:w.tagRuleLinks,loadRulesAndTags:w.loadRulesAndTags})));E.useEffect(()=>{m()},[m]);const y=si({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[],followUps:(e==null?void 0:e.followUps)||[]},validators:{onChangeAsync:$Ke(),onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{t(w),n()}}),b=w=>{const S=h.filter(k=>k.tagId===w).map(k=>k.ruleId);return u.filter(k=>S.includes(k.id))},v=()=>{switch(r){case"agent":return"Agent";case"task":return"Task";default:return"Template"}},x=()=>{switch(r){case"agent":return"Agent Prompt";case"task":return"Task Prompt";default:return"Prompt Template"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?`Edit ${v()}`:`New ${v()}`}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?`Update your ${r}`:`Create a new ${r}${r==="prompt"?" template with variables":""}`})]}),f.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),y.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(y.Field,{name:"name",children:w=>f.jsxs("div",{children:[f.jsxs(jt,{htmlFor:w.name,children:[v()," Name"]}),f.jsx(Sn,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter ${r} name`}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})}),f.jsx(y.Field,{name:"description",children:w=>f.jsxs("div",{children:[f.jsx(jt,{htmlFor:w.name,children:"Description"}),f.jsx(Lo,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Describe what this ${r} does`,rows:3})]})}),f.jsx(y.Field,{name:"prompt",children:w=>f.jsxs("div",{children:[f.jsx(jt,{htmlFor:w.name,children:x()}),f.jsx(Lo,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter your ${r} prompt using {{ variable_name }} syntax`,rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})})]}),f.jsx(LKe,{variables:y.getFieldValue("variables"),onVariablesChange:w=>y.setFieldValue("variables",w),templateId:e==null?void 0:e.id}),s&&f.jsx(y.Field,{name:"followUps",children:w=>f.jsx(BKe,{selectedFollowUps:w.state.value||[],onFollowUpsChange:S=>w.handleChange(S),followUpOptions:a,templateId:e==null?void 0:e.id})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose tools that will be automatically enabled when this ",r,"is applied."]}),f.jsx(y.Field,{name:"tools",children:w=>f.jsx(FKe,{selectedTools:w.state.value,onToolsChange:S=>w.handleChange(S),className:"p-0 max-w-none",maxSteps:l,onMaxStepsChange:c,showMaxSteps:i})})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose rules and tags that will be automatically enabled when this",r," is applied."]}),f.jsx(zse,{activeTagIds:new Set(y.getFieldValue("tags")),activeRuleIds:new Set(y.getFieldValue("rules")),onToggleTag:(w,S)=>{const k=y.getFieldValue("tags");S?y.setFieldValue("tags",[...k,w]):y.setFieldValue("tags",k.filter(C=>C!==w))},onToggleRule:(w,S)=>{const k=y.getFieldValue("rules");S?y.setFieldValue("rules",[...k,w]):y.setFieldValue("rules",k.filter(C=>C!==w))},allRules:u,allTags:d,getRulesForTag:b})]})}),f.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[f.jsxs(pt,{type:"submit",className:"flex-1",children:[f.jsx(ef,{className:"h-4 w-4 mr-2"}),e?`Update ${v()}`:`Create ${v()}`]}),o]})]})]})},L4=({templates:e,onEdit:t,onDelete:n,type:r,emptyMessage:s,additionalActions:i,getTaskCount:a})=>{const o=()=>{switch(r){case"agent":return"Agents";case"task":return"Tasks";default:return"Templates"}},l=()=>{switch(r){case"agent":return"Manage your AI agents and their associated tasks";case"task":return"Manage tasks for this agent";default:return"Manage your reusable prompt templates with dynamic variables"}},c=()=>{if(s)return s;switch(r){case"agent":return"No Agents Yet";case"task":return"No Tasks Yet";default:return"No Templates Yet"}},u=()=>{switch(r){case"agent":return'Use the "New Agent" tab to create your first agent';case"task":return"Create tasks to define what this agent can do";default:return'Use the "New Template" tab to create your first template'}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:o()}),f.jsx("p",{className:"text-sm text-muted-foreground",children:l()})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:c()}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u()})]}):f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Description"}),f.jsx(Tr,{children:"Variables"}),r==="agent"&&f.jsx(Tr,{children:"Tasks"}),(r==="prompt"||r==="task")&&f.jsx(Tr,{children:"Follow-ups"}),f.jsx(Tr,{children:"Tools"}),f.jsx(Tr,{children:"Rules/Tags"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:e.map(d=>{var h,m,y,b;return f.jsxs(Ts,{children:[f.jsx(On,{className:"font-medium",children:d.name}),f.jsx(On,{className:"max-w-xs truncate",children:d.description}),f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:d.variables.length})}),r==="agent"&&f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:a?a(d.id):0})}),(r==="prompt"||r==="task")&&f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:((h=d.followUps)==null?void 0:h.length)||0})}),f.jsx(On,{children:f.jsx(is,{variant:"secondary",children:((m=d.tools)==null?void 0:m.length)||0})}),f.jsx(On,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(is,{variant:"secondary",children:[((y=d.tags)==null?void 0:y.length)||0," tags"]}),f.jsxs(is,{variant:"secondary",children:[((b=d.rules)==null?void 0:b.length)||0," rules"]})]})}),f.jsx(On,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[i&&i(d),f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>t(d),title:`Edit ${r}`,children:f.jsx(fh,{className:"h-4 w-4"})}),f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>n(d.id),title:`Delete ${r}`,children:f.jsx(Ao,{className:"h-4 w-4"})})]})})]},d.id)})})]})]})},zKe=()=>{const[e,t]=E.useState("templates"),[n,r]=E.useState(),{loadPromptTemplates:s,addPromptTemplate:i,updatePromptTemplate:a,deletePromptTemplate:o,getTemplatesByType:l}=Rm(gn(v=>({loadPromptTemplates:v.loadPromptTemplates,addPromptTemplate:v.addPromptTemplate,updatePromptTemplate:v.updatePromptTemplate,deletePromptTemplate:v.deletePromptTemplate,getTemplatesByType:v.getTemplatesByType}))),c=l("prompt");E.useEffect(()=>{s()},[s]);const u=async v=>{await i({...v,type:"prompt",isPublic:!1})},d=async v=>{n&&await a(n.id,v)},h=async v=>{confirm("Are you sure you want to delete this template?")&&await o(v)},m=v=>{r(v),t("edit")},y=()=>{t("templates"),r(void 0)},b=[{value:"templates",label:"Templates",content:f.jsx(L4,{templates:c,onEdit:m,onDelete:h,type:"prompt"})},{value:"new",label:"New Template",content:f.jsx(E0,{onSubmit:u,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},"new-template-form")}];return n&&b.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(E0,{template:n,onSubmit:d,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},`edit-template-form-${n.id}`)}),f.jsx(tc,{tabs:b,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},UKe=()=>{const[e,t]=E.useState("agents"),[n,r]=E.useState(),[s,i]=E.useState(),[a,o]=E.useState(),{loadPromptTemplates:l,addPromptTemplate:c,updatePromptTemplate:u,deletePromptTemplate:d,getAgents:h,getTasksForAgent:m}=Rm(gn(P=>({loadPromptTemplates:P.loadPromptTemplates,addPromptTemplate:P.addPromptTemplate,updatePromptTemplate:P.updatePromptTemplate,deletePromptTemplate:P.deletePromptTemplate,getAgents:P.getAgents,getTasksForAgent:P.getTasksForAgent})));E.useEffect(()=>{l()},[l]);const y=h(),b=s?m(s.id):[],v=async P=>{await c({...P,type:"agent",isPublic:!1})},x=async P=>{n&&await u(n.id,P)},w=async P=>{if(confirm("Are you sure you want to delete this agent and all its tasks?")){const Z=m(P);for(const U of Z)await d(U.id);await d(P)}},S=async P=>{s&&await c({...P,type:"task",parentId:s.id,isPublic:!1})},k=async P=>{!a||!s||await u(a.id,{...P,parentId:s.id})},C=async P=>{confirm("Are you sure you want to delete this task?")&&await d(P)},R=P=>{r(P),t("edit-agent")},A=P=>{i(P),t("manage-tasks")},N=P=>{o(P),t("edit-task")},I=()=>{o(void 0),t("new-task")},O=()=>{t("agents"),r(void 0),i(void 0),o(void 0)},B=()=>{t("agents"),i(void 0),o(void 0)},D=()=>{t("manage-tasks"),o(void 0)},W=[{value:"agents",label:"Agents",content:f.jsx(L4,{templates:y,onEdit:R,onDelete:w,type:"agent",getTaskCount:P=>m(P).length,additionalActions:P=>f.jsxs(pt,{variant:"ghost",size:"sm",onClick:()=>A(P),title:"Manage Tasks",children:[f.jsx(fh,{className:"h-4 w-4"}),"Tasks"]})})},{value:"new-agent",label:"New Agent",content:f.jsx(E0,{onSubmit:v,onSuccess:O,type:"agent",showFollowUps:!1,showMaxSteps:!0},"new-agent-form")}];return n&&W.push({value:"edit-agent",label:`Edit: ${n.name}`,content:f.jsx(E0,{template:n,onSubmit:x,onSuccess:O,type:"agent",showFollowUps:!1,showMaxSteps:!0,additionalActions:f.jsxs(pt,{type:"button",variant:"outline",onClick:()=>A(n),className:"flex items-center gap-2",children:[f.jsx(fh,{className:"h-4 w-4"}),"Tasks (",m(n.id).length,")"]})},`edit-agent-form-${n.id}`)}),s&&W.push({value:"manage-tasks",label:`Tasks: ${s.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(pt,{variant:"outline",onClick:B,children:" Back to Agents"})}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-medium",children:["Tasks for ",s.name]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage tasks for this agent"})]}),f.jsxs(pt,{onClick:I,children:[f.jsx(Ru,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),f.jsx(L4,{templates:b,onEdit:N,onDelete:C,type:"task",emptyMessage:"No Tasks Yet"})]})}),s&&e==="new-task"&&W.push({value:"new-task",label:"New Task",content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(pt,{variant:"outline",onClick:D,children:" Back to Tasks"})}),f.jsx(E0,{onSubmit:S,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b,showMaxSteps:!0},`new-task-form-${s.id}`)]})}),a&&s&&W.push({value:"edit-task",label:`Edit: ${a.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(pt,{variant:"outline",onClick:D,children:" Back to Tasks"})}),f.jsx(E0,{template:a,onSubmit:k,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b.filter(P=>P.id!==a.id),showMaxSteps:!0},`edit-task-form-${a.id}`)]})}),f.jsx(tc,{tabs:W,initialValue:e,onValueChange:t,defaultValue:"agents",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},qKe=Ge({name:$e().min(1,"Name is required"),url:$e().url("Must be a valid URL"),description:$e(),headers:$e(),enabled:Gn()}),VKe=Ge({retryAttempts:Tt().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:Tt().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:Tt().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:Tt().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function xc({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function WKe(){const{bridgeConfig:e,setBridgeConfig:t}=nl(gn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=si({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});E.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(ol,{children:[f.jsxs(ll,{children:[f.jsxs(cl,{className:"text-base flex items-center",children:[f.jsx(iC,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx(Ld,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs(ul,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(Sn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(xc,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(Sn,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(xc,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(Sn,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(xc,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(ol,{children:[f.jsx(ll,{children:f.jsx(cl,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx(ul,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(pt,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(h1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function HKe(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=nl(gn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=si({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:VKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});E.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(ol,{children:[f.jsxs(ll,{children:[f.jsx(cl,{className:"text-base",children:"Retry Configuration"}),f.jsx(Ld,{children:"How LiteChat handles failed connections"})]}),f.jsx(ul,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(Sn,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(xc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(Sn,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(xc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(Sn,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(xc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(Sn,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(xc,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(ol,{children:[f.jsx(ll,{children:f.jsx(cl,{className:"text-base",children:"How It Works"})}),f.jsx(ul,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(pt,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(pt,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(h1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function eV({server:e,onSubmit:t,onCancel:n}){const r=si({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:qKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return E.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(ol,{children:[f.jsx(ll,{children:f.jsxs(cl,{className:"text-base flex items-center",children:[f.jsx(Z0,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs(ul,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Server Name"}),f.jsx(Sn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(xc,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Server URL"}),f.jsx(Sn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(xc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(Lo,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(xc,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(Lo,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(xc,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Mo,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(jt,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(wPe,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(pt,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(pt,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function GKe({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=nl(gn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(pt,{onClick:e,children:[f.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx(Z0,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(pt,{onClick:e,children:[f.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"URL"}),f.jsx(Tr,{children:"Status"}),f.jsx(Tr,{children:"Description"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:n.map(o=>f.jsxs(Ts,{children:[f.jsx(On,{className:"font-medium",children:o.name}),f.jsx(On,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(On,{children:f.jsx(is,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(jpe,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx($pe,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(On,{className:"max-w-xs truncate",children:o.description||""}),f.jsx(On,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(Mo,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(fh,{className:"h-4 w-4"})}),f.jsx(pt,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(Uge,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const KKe=()=>{const[e,t]=E.useState("servers"),[n,r]=E.useState(),{addServer:s,updateServer:i}=nl(gn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const m=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers")}catch(m){console.error("Invalid headers JSON:",m),Me.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const m=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers"),r(void 0)}catch(m){console.error("Invalid headers JSON:",m),Me.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(GKe,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(WKe,{})},{value:"connection",label:"Connection",content:f.jsx(HKe,{})},{value:"new",label:"Add Server",content:f.jsx(eV,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(eV,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(tc,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},YKe=()=>{const{resetAssistantSettings:e}=mr(gn(r=>({resetAssistantSettings:r.resetAssistantSettings}))),t=()=>{window.confirm("Are you sure you want to reset all Assistant settings (Prompt, Parameters, Tools, Auto-Title) to their defaults?")&&e()},n=E.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(RKe,{})},{value:"parameters",label:"Parameters",content:f.jsx(MKe,{})},{value:"tools",label:"Tools",content:f.jsx(PKe,{})},{value:"mcp",label:"MCP",content:f.jsx(KKe,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(DKe,{})},{value:"prompts",label:"Prompts",content:f.jsx(zKe,{})},{value:"agents",label:"Agents",content:f.jsx(UKe,{})}],[]);return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(tc,{tabs:n,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1}),f.jsx(Ih,{className:"mt-auto"}),f.jsx("div",{className:"flex justify-end pt-3 flex-shrink-0",children:f.jsxs(pt,{variant:"outline",size:"sm",onClick:t,children:[f.jsx(h1,{className:"mr-2 h-4 w-4"}),"Reset All Assistant Settings"]})})]})},ZKe=Ve.memo(YKe);class XKe{constructor(){de(this,"id","core-settings-assistant");de(this,"unregisterCallback",null);de(this,"modApiRef",null);de(this,"eventUnsubscribers",[]);de(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=mr.getState().enableAdvancedSettings;const n=t.on(sn.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:ZKe,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const JKe=Ge({importSettings:Gn(),importApiKeys:Gn(),importProviderConfigs:Gn(),importProjects:Gn(),importConversations:Gn(),importRulesAndTags:Gn(),importMods:Gn(),importSyncRepos:Gn(),importMcpServers:Gn(),importPromptTemplates:Gn(),importAgents:Gn()}),QKe=Ge({importSettings:Gn(),importApiKeys:Gn(),importProviderConfigs:Gn(),importProjects:Gn(),importConversations:Gn(),importRulesAndTags:Gn(),importMods:Gn(),importSyncRepos:Gn(),importMcpServers:Gn(),importPromptTemplates:Gn(),importAgents:Gn()}),eYe=()=>{const{importConversation:e,exportAllConversations:t}=Un(gn(N=>({importConversation:N.importConversation,exportAllConversations:N.exportAllConversations}))),n=E.useRef(null),r=E.useRef(null),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(!1),[h,m]=E.useState(!1),y=si({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:JKe}}),b=si({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:QKe}}),v=()=>{var N;(N=n.current)==null||N.click()},x=()=>{var N;(N=r.current)==null||N.click()},w=E.useCallback(async N=>{var O;const I=(O=N.target.files)==null?void 0:O[0];if(I){i(!0);try{await e(I)}catch(B){console.error("Import failed (from component):",B)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),S=E.useCallback(async N=>{var O;const I=(O=N.target.files)==null?void 0:O[0];if(I){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}m(!0);try{await v0.importFullConfiguration(I,y.state.values)}catch(B){console.error("Full import failed (from component):",B)}finally{r.current&&(r.current.value=""),m(!1)}}},[y]),k=E.useCallback(async()=>{o(!0);try{await t()}catch(N){console.error("Export all failed (from component):",N)}finally{o(!1)}},[t]),C=E.useCallback(async()=>{d(!0);try{await v0.exportFullConfiguration(b.state.values)}catch(N){console.error("Full export failed (from component):",N)}finally{d(!1)}},[b]),R=E.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await St.clearAllData(),Me.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(N){const I="Failed to clear all data";console.error(I,N),Me.error(`${I}: ${N instanceof Error?N.message:String(N)}`),c(!1)}}},[]),A=(N,I,O,B,D,W)=>{const P=`${W}-${I}-checkbox`;return f.jsx(N.Field,{name:I,children:Z=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Pc,{id:P,checked:Z.state.value,onCheckedChange:U=>Z.handleChange(!!U),disabled:D}),f.jsxs(jt,{htmlFor:P,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(B,{className:"h-4 w-4 text-muted-foreground"})," ",O]})]})},I)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(jt,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(pt,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(wH,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(jt,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(pt,{onClick:k,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(wc,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(Ih,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(jt,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(y,"importSettings","Settings",iC,h,"import"),A(y,"importApiKeys","API Keys",qx,h,"import"),A(y,"importProviderConfigs","Providers",Z0,h,"import"),A(y,"importProjects","Projects",_B,h,"import"),A(y,"importConversations","Conversations",Y3,h,"import"),A(y,"importRulesAndTags","Rules & Tags",Z3,h,"import"),A(y,"importMods","Mods",EB,h,"import"),A(y,"importSyncRepos","Sync Repos",Tc,h,"import"),A(y,"importMcpServers","MCP Servers",kB,h,"import"),A(y,"importPromptTemplates","Prompt Templates",K3,h,"import"),A(y,"importAgents","Agents",K0,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(pt,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(hme,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(jt,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(b,"importSettings","Settings",iC,u,"export"),A(b,"importApiKeys","API Keys",qx,u,"export"),A(b,"importProviderConfigs","Providers",Z0,u,"export"),A(b,"importProjects","Projects",_B,u,"export"),A(b,"importConversations","Conversations",Y3,u,"export"),A(b,"importRulesAndTags","Rules & Tags",Z3,u,"export"),A(b,"importMods","Mods",EB,u,"export"),A(b,"importSyncRepos","Sync Repos",Tc,u,"export"),A(b,"importMcpServers","MCP Servers",kB,u,"export"),A(b,"importPromptTemplates","Prompt Templates",K3,u,"export"),A(b,"importAgents","Agents",K0,u,"export")]}),f.jsxs(pt,{onClick:C,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(ame,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(pt,{onClick:R,variant:"destructive",disabled:l,children:[l?f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},tYe=Ve.memo(eYe);class nYe{constructor(){de(this,"id","core-settings-data");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:tYe,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const rYe=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=Mh(gn(R=>({loadedMods:R.loadedMods,addDbMod:R.addDbMod,updateDbMod:R.updateDbMod,deleteDbMod:R.deleteDbMod,dbMods:R.dbMods,isLoading:R.isLoading}))),[a,o]=E.useState(""),[l,c]=E.useState(""),[u,d]=E.useState(""),[h,m]=E.useState(!1),[y,b]=E.useState({}),[v,x]=E.useState({}),w=E.useCallback(async()=>{if(!a.trim()){Me.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){Me.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){Me.error("Provide either a Mod URL or Script Content, not both.");return}m(!0);try{const R={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(R),o(""),c(""),d(""),Me.info("Mod added. Reload required for changes to take effect.")}catch(R){console.error("Failed to add mod (from component):",R)}finally{m(!1)}},[a,l,u,t,s==null?void 0:s.length]),S=E.useCallback(async R=>{b(A=>({...A,[R.id]:!0}));try{await n(R.id,{enabled:!R.enabled}),Me.info(`Mod "${R.name}" ${R.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(A){console.error("Failed to update mod (from component):",A)}finally{b(A=>({...A,[R.id]:!1}))}},[n]),k=E.useCallback(async R=>{if(window.confirm(`Are you sure you want to delete the mod "${R.name}"? This cannot be undone.`)){x(A=>({...A,[R.id]:!0}));try{await r(R.id),Me.info("Mod deleted. Reload required for changes to take effect.")}catch(A){console.error("Failed to delete mod (from component):",A)}finally{x(A=>({...A,[R.id]:!1}))}}},[r]),C=E.useCallback(R=>{const A=e.find(I=>I.id===R);if(A)if(A.error){const I=A.error instanceof Error?A.error.message:String(A.error);return{status:"Error",error:A.error,tooltip:I}}else return{status:"Loaded"};const N=(s||[]).find(I=>I.id===R);return N?N.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(wse,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(UP,{className:"h-4 w-4"}),f.jsx(_se,{children:"Security Warning"}),f.jsx(Sse,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(Sn,{id:"mod-name",value:a,onChange:R=>o(R.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(Sn,{id:"mod-url",type:"url",value:l,onChange:R=>c(R.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(Lo,{id:"mod-script",value:u,onChange:R=>d(R.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(pt,{onClick:w,disabled:h,children:[h&&f.jsx(Yn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(xr,{delayDuration:100,children:f.jsxs(af,{children:[f.jsx(up,{children:f.jsxs(Ts,{children:[f.jsx(Tr,{children:"Name"}),f.jsx(Tr,{children:"Source"}),f.jsx(Tr,{children:"Status"}),f.jsx(Tr,{className:"text-center",children:"Enabled"}),f.jsx(Tr,{className:"text-right",children:"Actions"})]})}),f.jsx(of,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(On,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(On,{colSpan:5,children:f.jsx(Wr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(Ts,{children:f.jsx(On,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(R=>{const{status:A,error:N,tooltip:I}=C(R.id),O=R.sourceUrl?new URL(R.sourceUrl).hostname:"Direct Script",B=y[R.id],D=v[R.id],W=B||D,P=A==="Error";return f.jsxs(Ts,{children:[f.jsx(On,{className:"font-medium",children:R.name}),f.jsx(On,{className:"text-muted-foreground",children:O}),f.jsxs(On,{children:[f.jsxs(wr,{children:[f.jsx(_r,{asChild:!0,children:f.jsx("span",{className:P?"text-destructive font-semibold cursor-help":"",children:A})}),I&&f.jsx(Sr,{className:"max-w-xs break-words",children:f.jsx("p",{children:I})})]}),P&&N&&f.jsx("p",{className:"text-xs text-destructive truncate",children:N instanceof Error?N.message:String(N)})]}),f.jsxs(On,{className:"text-center",children:[f.jsx(Mo,{checked:R.enabled??!1,onCheckedChange:()=>S(R),disabled:W,"aria-label":`Enable ${R.name}`}),B&&f.jsx(Yn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(On,{className:"text-right",children:f.jsx(pt,{variant:"ghost",size:"icon",onClick:()=>k(R),disabled:W,"aria-label":`Delete ${R.name}`,className:"text-destructive hover:text-destructive/80",children:D?f.jsx(Yn,{className:"h-4 w-4 animate-spin"}):f.jsx(Ao,{className:"h-4 w-4"})})})]},R.id)})})]})})})]})]})},sYe=Ve.memo(rYe);class iYe{constructor(){de(this,"id","core-settings-mods");de(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:sYe,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const aYe=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=E.useState(!1),s=E.useCallback(async i=>{if(i.stopPropagation(),n||!t){Me.info("No content to copy or action disabled.");return}Pe.emit(mc.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(er,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(so,{className:"text-green-500"}):f.jsx(hE,{}),className:"h-5 w-5"})};class oYe{constructor(){de(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?Ve.createElement(aYe,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const lYe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Me.info("Regeneration is currently disabled.");return}Pe.emit(mc.regenerateInteractionRequest,{interactionId:e})};return f.jsx(er,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(ym,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class cYe{constructor(){de(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=Ln.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(lYe,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const uYe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Pe.emit(mc.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Me.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(Z6,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(er,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(Ume,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class dYe{constructor(){de(this,"id","core-canvas-regenerate-with-model-action");de(this,"eventUnsubscribers",[]);de(this,"notifyComponentUpdate",null);de(this,"globallyEnabledModels",[]);de(this,"isLoadingProviders",!0)}async initialize(t){const n=Nr.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(fr.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Nr.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(fr.initialDataLoaded,()=>{var c;const a=Nr.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=Ln.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(uYe,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const fYe=({interactionId:e,currentRating:t})=>{const n=s=>{const i=s===t?null:s;Pe.emit(Xn.rateInteractionRequest,{interactionId:e,rating:i})},r=Array.from({length:11},(s,i)=>i-5);return f.jsx("div",{className:"flex items-center gap-1",children:r.map(s=>{let i="";s===-5?i="Terrible":s===-4?i="Very Bad":s===-3?i="Bad":s===-2?i="Poor":s===-1?i="Below Average":s===0?i="Neutral":s===1?i="Above Average":s===2?i="Good":s===3?i="Very Good":s===4?i="Excellent":s===5&&(i="Perfect");let a="text-muted-foreground",o="hover:text-foreground",l="";s<0?(o="hover:text-red-500",t===s&&(a="text-red-500",l="fill-red-500")):s===0?(o="hover:text-gray-500",t===s&&(a="text-gray-500",l="fill-gray-500")):(o="hover:text-green-500",t===s&&(a="text-green-500",l="fill-green-500"));const c=t===s?"bg-muted":"";return f.jsx(er,{tooltipText:i,onClick:()=>n(s),"aria-label":`Rate response as ${i}`,icon:f.jsx(Dge,{className:Je(l,t===s?"fill-current":"fill-none")}),variant:"ghost",className:Je("h-4 w-4 md:h-5 md:w-5 p-0",a,o,c)},s)})})};class hYe{constructor(){de(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:Ve.createElement(fYe,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const pYe=({interactionId:e,response:t,disabled:n})=>{const[r,s]=E.useState(!1),[i,a]=E.useState(""),o=u=>{if(u.stopPropagation(),n){Me.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){Me.error("Response cannot be empty");return}Pe.emit(mc.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),Me.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(er,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(vH,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(ap,{open:r,onOpenChange:s,children:f.jsxs(op,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(lp,{children:f.jsx(cp,{children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(jt,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(Lo,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(fb,{className:"flex-shrink-0",children:[f.jsx(pt,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(pt,{onClick:l,children:"Save Changes"})]})]})})]})};class mYe{constructor(){de(this,"id","core-canvas-edit-response-action");de(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(mc.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=Ln.getState(),i=s.interactions.find(y=>y.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=ws(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(y=>y.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=s.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var w,S;const v=((w=y.startedAt)==null?void 0:w.getTime())??0,x=((S=b.startedAt)==null?void 0:S.getTime())??0;return v-x}),h=d.map(async(y,b)=>{const v={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),s._updateInteractionInState(y.id,v),St.saveInteraction({...y,...v})}),m=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return s._updateInteractionInState(y.id,b),St.saveInteraction({...y,...b})});await Promise.all([St.saveInteraction(o),...h,...m]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=Ln.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?Ve.createElement(pYe,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const gYe=({context:e})=>{const t=()=>{Me.info(`Example Canvas Action Clicked! Interaction ID: ${e.interactionId}`)};return f.jsxs(pt,{variant:"outline",size:"sm",onClick:t,className:"h-6 px-2 text-xs",children:[f.jsx(Rge,{className:"h-3 w-3 mr-1"})," Example Action"]})};class yYe{constructor(){de(this,"id","example-canvas-control-module")}async initialize(t){}register(t){t.registerCanvasControl({id:"example-canvas-action",type:"interaction",targetSlot:"actions",renderer:n=>Ve.createElement(gYe,{context:n})})}destroy(t){}}const bYe=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(er,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(Yl,{}):f.jsx(Lh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class vYe{constructor(){de(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:Ve.createElement(bYe,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const xYe=({context:e})=>{const t=fT(e.responseContent||""),n=E.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="block"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=E.useCallback(async()=>{var s;if(n.length===0){Me.info("No code blocks with filepaths found to download");return}try{const i=new sD,a=new Set;n.forEach(({filepath:h,code:m})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let w=1;w<b.length;w++){const S=b.slice(0,w).join("/");a.has(S)||(i.folder(S),a.add(S))}let v=y,x=1;for(;i.file(v);){const w=y.lastIndexOf(".");if(w>0){const S=y.substring(0,w),k=y.substring(w);v=`${S}_${x}${k}`}else v=`${y}_${x}`;x++}i.file(v,m)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),Me.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),Me.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(er,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(dH,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class wYe{constructor(){de(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:Ve.createElement(xYe,{context:n})})}destroy(t){}}const _Ye=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=E.useState(!1),o=E.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Pe.emit(mc.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(er,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(so,{className:"text-green-500"}):f.jsx(hE,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class SYe{constructor(){de(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(_Ye,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const CYe=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(er,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(dE,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class kYe{constructor(){de(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:Ve.createElement(CYe,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const EYe=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=E.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const m=s.split("/");c=m[m.length-1]}else c=`code${TYe(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),Me.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),Me.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>5e3?f.jsx(er,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(wc,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function TYe(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class AYe{constructor(){de(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(EYe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const RYe=({toolCall:e})=>{const[t,n]=E.useState(!0),r=()=>n(i=>!i),s=E.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(er,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(Yl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Wy,{lang:"json",code:s})]})},NYe=({toolResult:e})=>{const[t,n]=E.useState(!0),r=()=>n(a=>!a),s=E.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Je("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Je("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(er,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(Yl,{}):f.jsx(Lh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Wy,{lang:i?"text":"json",code:s})]})},MYe=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(RYe,{toolCall:t}),n&&f.jsx(NYe,{toolResult:n})]});class IYe{constructor(){de(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):Ve.createElement(MYe,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}var x3={exports:{}},tV;function jYe(){return tV||(tV=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(S){return S instanceof l?new l(S.type,w(S.content),S.alias):Array.isArray(S)?S.map(w):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(S,k){k=k||{};var C,R;switch(o.util.type(S)){case"Object":if(R=o.util.objId(S),k[R])return k[R];C={},k[R]=C;for(var A in S)S.hasOwnProperty(A)&&(C[A]=w(S[A],k));return C;case"Array":return R=o.util.objId(S),k[R]?k[R]:(C=[],k[R]=C,S.forEach(function(N,I){C[I]=w(N,k)}),C);default:return S}},getLanguage:function(w){for(;w;){var S=s.exec(w.className);if(S)return S[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,S){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(C){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(C.stack)||[])[1];if(w){var S=document.getElementsByTagName("script");for(var k in S)if(S[k].src==w)return S[k]}return null}},isActive:function(w,S,k){for(var C="no-"+S;w;){var R=w.classList;if(R.contains(S))return!0;if(R.contains(C))return!1;w=w.parentElement}return!!k}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,S){var k=o.util.clone(o.languages[w]);for(var C in S)k[C]=S[C];return k},insertBefore:function(w,S,k,C){C=C||o.languages;var R=C[w],A={};for(var N in R)if(R.hasOwnProperty(N)){if(N==S)for(var I in k)k.hasOwnProperty(I)&&(A[I]=k[I]);k.hasOwnProperty(N)||(A[N]=R[N])}var O=C[w];return C[w]=A,o.languages.DFS(o.languages,function(B,D){D===O&&B!=w&&(this[B]=A)}),A},DFS:function w(S,k,C,R){R=R||{};var A=o.util.objId;for(var N in S)if(S.hasOwnProperty(N)){k.call(S,N,S[N],C||N);var I=S[N],O=o.util.type(I);O==="Object"&&!R[A(I)]?(R[A(I)]=!0,w(I,k,null,R)):O==="Array"&&!R[A(I)]&&(R[A(I)]=!0,w(I,k,N,R))}}},plugins:{},highlightAll:function(w,S){o.highlightAllUnder(document,w,S)},highlightAllUnder:function(w,S,k){var C={callback:k,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",C),C.elements=Array.prototype.slice.apply(C.container.querySelectorAll(C.selector)),o.hooks.run("before-all-elements-highlight",C);for(var R=0,A;A=C.elements[R++];)o.highlightElement(A,S===!0,C.callback)},highlightElement:function(w,S,k){var C=o.util.getLanguage(w),R=o.languages[C];o.util.setLanguage(w,C);var A=w.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,C);var N=w.textContent,I={element:w,language:C,grammar:R,code:N};function O(D){I.highlightedCode=D,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),k&&k.call(I.element)}if(o.hooks.run("before-sanity-check",I),A=I.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),k&&k.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){O(o.util.encode(I.code));return}if(S&&r.Worker){var B=new Worker(o.filename);B.onmessage=function(D){O(D.data)},B.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else O(o.highlight(I.code,I.grammar,I.language))},highlight:function(w,S,k){var C={code:w,grammar:S,language:k};if(o.hooks.run("before-tokenize",C),!C.grammar)throw new Error('The language "'+C.language+'" has no grammar.');return C.tokens=o.tokenize(C.code,C.grammar),o.hooks.run("after-tokenize",C),l.stringify(o.util.encode(C.tokens),C.language)},tokenize:function(w,S){var k=S.rest;if(k){for(var C in k)S[C]=k[C];delete S.rest}var R=new d;return h(R,R.head,w),u(w,R,S,R.head,0),y(R)},hooks:{all:{},add:function(w,S){var k=o.hooks.all;k[w]=k[w]||[],k[w].push(S)},run:function(w,S){var k=o.hooks.all[w];if(!(!k||!k.length))for(var C=0,R;R=k[C++];)R(S)}},Token:l};r.Prism=o;function l(w,S,k,C){this.type=w,this.content=S,this.alias=k,this.length=(C||"").length|0}l.stringify=function w(S,k){if(typeof S=="string")return S;if(Array.isArray(S)){var C="";return S.forEach(function(O){C+=w(O,k)}),C}var R={type:S.type,content:w(S.content,k),tag:"span",classes:["token",S.type],attributes:{},language:k},A=S.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(R.classes,A):R.classes.push(A)),o.hooks.run("wrap",R);var N="";for(var I in R.attributes)N+=" "+I+'="'+(R.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+R.tag+' class="'+R.classes.join(" ")+'"'+N+">"+R.content+"</"+R.tag+">"};function c(w,S,k,C){w.lastIndex=S;var R=w.exec(k);if(R&&C&&R[1]){var A=R[1].length;R.index+=A,R[0]=R[0].slice(A)}return R}function u(w,S,k,C,R,A){for(var N in k)if(!(!k.hasOwnProperty(N)||!k[N])){var I=k[N];I=Array.isArray(I)?I:[I];for(var O=0;O<I.length;++O){if(A&&A.cause==N+","+O)return;var B=I[O],D=B.inside,W=!!B.lookbehind,P=!!B.greedy,Z=B.alias;if(P&&!B.pattern.global){var U=B.pattern.toString().match(/[imsuy]*$/)[0];B.pattern=RegExp(B.pattern.source,U+"g")}for(var H=B.pattern||B,L=C.next,ne=R;L!==S.tail&&!(A&&ne>=A.reach);ne+=L.value.length,L=L.next){var V=L.value;if(S.length>w.length)return;if(!(V instanceof l)){var Q=1,ee;if(P){if(ee=c(H,ne,w,W),!ee||ee.index>=w.length)break;var je=ee.index,se=ee.index+ee[0].length,me=ne;for(me+=L.value.length;je>=me;)L=L.next,me+=L.value.length;if(me-=L.value.length,ne=me,L.value instanceof l)continue;for(var ce=L;ce!==S.tail&&(me<se||typeof ce.value=="string");ce=ce.next)Q++,me+=ce.value.length;Q--,V=w.slice(ne,me),ee.index-=ne}else if(ee=c(H,0,V,W),!ee)continue;var je=ee.index,De=ee[0],Se=V.slice(0,je),Ce=V.slice(je+De.length),qe=ne+V.length;A&&qe>A.reach&&(A.reach=qe);var Qe=L.prev;Se&&(Qe=h(S,Qe,Se),ne+=Se.length),m(S,Qe,Q);var We=new l(N,D?o.tokenize(De,D):De,Z,De);if(L=h(S,Qe,We),Ce&&h(S,L,Ce),Q>1){var Ne={cause:N+","+O,reach:qe};u(w,S,k,L.prev,ne,Ne),A&&Ne.reach>A.reach&&(A.reach=Ne.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},S={value:null,prev:w,next:null};w.next=S,this.head=w,this.tail=S,this.length=0}function h(w,S,k){var C=S.next,R={value:k,prev:S,next:C};return S.next=R,C.prev=R,w.length++,R}function m(w,S,k){for(var C=S.next,R=0;R<k&&C!==w.tail;R++)C=C.next;S.next=C,C.prev=S,w.length-=R}function y(w){for(var S=[],k=w.head.next;k!==w.tail;)S.push(k.value),k=k.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var S=JSON.parse(w.data),k=S.language,C=S.code,R=S.immediateClose;r.postMessage(o.highlight(C,o.languages[k],k)),R&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof Qp<"u"&&(Qp.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(b,v){return" Error "+b+" while fetching file: "+v},i=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,v,x){var w=new XMLHttpRequest;w.open("GET",b,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function m(b){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(v){var x=Number(v[1]),w=v[2],S=v[3];return w?S?[x,Number(S)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(d)){b.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),S=b.language;if(S==="none"){var k=(/\.(\w+)$/.exec(w)||[,"none"])[1];S=a[k]||k}n.util.setLanguage(x,S),n.util.setLanguage(v,S);var C=n.plugins.autoloader;C&&C.loadLanguages(S),h(w,function(R){v.setAttribute(o,c);var A=m(v.getAttribute("data-range"));if(A){var N=R.split(/\r\n?|\n/g),I=A[0],O=A[1]==null?N.length:A[1];I<0&&(I+=N.length),I=Math.max(0,Math.min(I-1,N.length)),O<0&&(O+=N.length),O=Math.max(0,Math.min(O,N.length)),R=N.slice(I,O).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(I+1))}x.textContent=R,n.highlightElement(x)},function(R){v.setAttribute(o,u),x.textContent=R})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,S;S=x[w++];)n.highlightElement(S)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(x3)),x3.exports}var PYe=jYe();const OYe=Sa(PYe);var nV={},rV;function DYe(){return rV||(rV=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),nV}DYe();var sV={},iV;function FYe(){return iV||(iV=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),sV}FYe();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var m=0,y=h.length;m<y;m++){var b=h[m];if(b.type!=="code"){d(b.content);continue}var v=b.content[1],x=b.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var S="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,S]:x.alias.push(S):x.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,m=u.classes.length;h<m;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,m){if(m=m.toLowerCase(),m[0]==="#"){var y;return m[1]==="x"?y=parseInt(m.slice(2),16):y=Number(m.slice(1)),l(y)}else{var b=o[m];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var aV={},oV;function LYe(){return oV||(oV=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),aV}LYe();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const BYe=({lang:e,code:t,filepath:n,isStreaming:r=!1})=>{const{foldStreamingCodeBlocks:s}=mr(gn(b=>({foldStreamingCodeBlocks:b.foldStreamingCodeBlocks}))),[i,a]=E.useState(r?s:!1),o=E.useRef(null),l=Ui(gn(b=>Object.values(b.canvasControls))),c=E.useCallback((b,v,x,w,S,k)=>l.filter(C=>C.type==="codeblock"&&C.targetSlot===b&&C.renderer).map(C=>{if(C.renderer){const R={codeBlockContent:v,codeBlockLang:x,codeBlockFilepath:w,isFolded:S,toggleFold:k,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:C.renderer(R)},C.id)}return null}).filter(Boolean),[l]),u=E.useCallback(()=>{if(o.current&&t)try{o.current.style.whiteSpace!=="pre-wrap"&&(o.current.style.whiteSpace="pre-wrap"),o.current.textContent=t,OYe.highlightElement(o.current)}catch(b){console.error("Prism highlight error:",b),o.current.textContent=t}else o.current&&(o.current.textContent="")},[t]);E.useEffect(()=>{i||u()},[t,e,i,u]);const d=()=>{const b=i;a(v=>!v),b&&setTimeout(u,0)},h=e?`language-${e}`:"language-plaintext",m=E.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),y=c("codeblock-header-actions",t,e,n,i,d);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:y})]}),f.jsx("div",{})]}),!i&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{ref:o,className:h+" block p-4 font-mono text-sm leading-relaxed"})})}),i&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border border border-t-0 border-border rounded-b-lg bg-muted/10 hover:bg-muted/20 transition-colors",onClick:d,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:m})})]})},l5=E.memo(BYe);class $Ye{constructor(){de(this,"id","core-block-renderer-code");de(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:void 0,priority:0,renderer:r=>Ve.createElement(l5,{lang:r.lang,code:r.code,filepath:r.filepath,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}var U2={exports:{}},zYe=U2.exports,lV;function UYe(){return lV||(lV=1,function(e,t){(function(n,r){e.exports=r()})(zYe,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",m="year",y="date",b="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var Z=["th","st","nd","rd"],U=P%100;return"["+P+(Z[(U-20)%10]||Z[U]||Z[0])+"]"}},S=function(P,Z,U){var H=String(P);return!H||H.length>=Z?P:""+Array(Z+1-H.length).join(U)+P},k={s:S,z:function(P){var Z=-P.utcOffset(),U=Math.abs(Z),H=Math.floor(U/60),L=U%60;return(Z<=0?"+":"-")+S(H,2,"0")+":"+S(L,2,"0")},m:function P(Z,U){if(Z.date()<U.date())return-P(U,Z);var H=12*(U.year()-Z.year())+(U.month()-Z.month()),L=Z.clone().add(H,d),ne=U-L<0,V=Z.clone().add(H+(ne?-1:1),d);return+(-(H+(U-L)/(ne?L-V:V-L))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:m,w:u,d:c,D:y,h:l,m:o,s:a,ms:i,Q:h}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},C="en",R={};R[C]=w;var A="$isDayjsObject",N=function(P){return P instanceof D||!(!P||!P[A])},I=function P(Z,U,H){var L;if(!Z)return C;if(typeof Z=="string"){var ne=Z.toLowerCase();R[ne]&&(L=ne),U&&(R[ne]=U,L=ne);var V=Z.split("-");if(!L&&V.length>1)return P(V[0])}else{var Q=Z.name;R[Q]=Z,L=Q}return!H&&L&&(C=L),L||!H&&C},O=function(P,Z){if(N(P))return P.clone();var U=typeof Z=="object"?Z:{};return U.date=P,U.args=arguments,new D(U)},B=k;B.l=I,B.i=N,B.w=function(P,Z){return O(P,{locale:Z.$L,utc:Z.$u,x:Z.$x,$offset:Z.$offset})};var D=function(){function P(U){this.$L=I(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[A]=!0}var Z=P.prototype;return Z.parse=function(U){this.$d=function(H){var L=H.date,ne=H.utc;if(L===null)return new Date(NaN);if(B.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var V=L.match(v);if(V){var Q=V[2]-1||0,ee=(V[7]||"0").substring(0,3);return ne?new Date(Date.UTC(V[1],Q,V[3]||1,V[4]||0,V[5]||0,V[6]||0,ee)):new Date(V[1],Q,V[3]||1,V[4]||0,V[5]||0,V[6]||0,ee)}}return new Date(L)}(U),this.init()},Z.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},Z.$utils=function(){return B},Z.isValid=function(){return this.$d.toString()!==b},Z.isSame=function(U,H){var L=O(U);return this.startOf(H)<=L&&L<=this.endOf(H)},Z.isAfter=function(U,H){return O(U)<this.startOf(H)},Z.isBefore=function(U,H){return this.endOf(H)<O(U)},Z.$g=function(U,H,L){return B.u(U)?this[H]:this.set(L,U)},Z.unix=function(){return Math.floor(this.valueOf()/1e3)},Z.valueOf=function(){return this.$d.getTime()},Z.startOf=function(U,H){var L=this,ne=!!B.u(H)||H,V=B.p(U),Q=function(Ce,qe){var Qe=B.w(L.$u?Date.UTC(L.$y,qe,Ce):new Date(L.$y,qe,Ce),L);return ne?Qe:Qe.endOf(c)},ee=function(Ce,qe){return B.w(L.toDate()[Ce].apply(L.toDate("s"),(ne?[0,0,0,0]:[23,59,59,999]).slice(qe)),L)},se=this.$W,me=this.$M,ce=this.$D,je="set"+(this.$u?"UTC":"");switch(V){case m:return ne?Q(1,0):Q(31,11);case d:return ne?Q(1,me):Q(0,me+1);case u:var De=this.$locale().weekStart||0,Se=(se<De?se+7:se)-De;return Q(ne?ce-Se:ce+(6-Se),me);case c:case y:return ee(je+"Hours",0);case l:return ee(je+"Minutes",1);case o:return ee(je+"Seconds",2);case a:return ee(je+"Milliseconds",3);default:return this.clone()}},Z.endOf=function(U){return this.startOf(U,!1)},Z.$set=function(U,H){var L,ne=B.p(U),V="set"+(this.$u?"UTC":""),Q=(L={},L[c]=V+"Date",L[y]=V+"Date",L[d]=V+"Month",L[m]=V+"FullYear",L[l]=V+"Hours",L[o]=V+"Minutes",L[a]=V+"Seconds",L[i]=V+"Milliseconds",L)[ne],ee=ne===c?this.$D+(H-this.$W):H;if(ne===d||ne===m){var se=this.clone().set(y,1);se.$d[Q](ee),se.init(),this.$d=se.set(y,Math.min(this.$D,se.daysInMonth())).$d}else Q&&this.$d[Q](ee);return this.init(),this},Z.set=function(U,H){return this.clone().$set(U,H)},Z.get=function(U){return this[B.p(U)]()},Z.add=function(U,H){var L,ne=this;U=Number(U);var V=B.p(H),Q=function(me){var ce=O(ne);return B.w(ce.date(ce.date()+Math.round(me*U)),ne)};if(V===d)return this.set(d,this.$M+U);if(V===m)return this.set(m,this.$y+U);if(V===c)return Q(1);if(V===u)return Q(7);var ee=(L={},L[o]=r,L[l]=s,L[a]=n,L)[V]||1,se=this.$d.getTime()+U*ee;return B.w(se,this)},Z.subtract=function(U,H){return this.add(-1*U,H)},Z.format=function(U){var H=this,L=this.$locale();if(!this.isValid())return L.invalidDate||b;var ne=U||"YYYY-MM-DDTHH:mm:ssZ",V=B.z(this),Q=this.$H,ee=this.$m,se=this.$M,me=L.weekdays,ce=L.months,je=L.meridiem,De=function(qe,Qe,We,Ne){return qe&&(qe[Qe]||qe(H,ne))||We[Qe].slice(0,Ne)},Se=function(qe){return B.s(Q%12||12,qe,"0")},Ce=je||function(qe,Qe,We){var Ne=qe<12?"AM":"PM";return We?Ne.toLowerCase():Ne};return ne.replace(x,function(qe,Qe){return Qe||function(We){switch(We){case"YY":return String(H.$y).slice(-2);case"YYYY":return B.s(H.$y,4,"0");case"M":return se+1;case"MM":return B.s(se+1,2,"0");case"MMM":return De(L.monthsShort,se,ce,3);case"MMMM":return De(ce,se);case"D":return H.$D;case"DD":return B.s(H.$D,2,"0");case"d":return String(H.$W);case"dd":return De(L.weekdaysMin,H.$W,me,2);case"ddd":return De(L.weekdaysShort,H.$W,me,3);case"dddd":return me[H.$W];case"H":return String(Q);case"HH":return B.s(Q,2,"0");case"h":return Se(1);case"hh":return Se(2);case"a":return Ce(Q,ee,!0);case"A":return Ce(Q,ee,!1);case"m":return String(ee);case"mm":return B.s(ee,2,"0");case"s":return String(H.$s);case"ss":return B.s(H.$s,2,"0");case"SSS":return B.s(H.$ms,3,"0");case"Z":return V}return null}(qe)||V.replace(":","")})},Z.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Z.diff=function(U,H,L){var ne,V=this,Q=B.p(H),ee=O(U),se=(ee.utcOffset()-this.utcOffset())*r,me=this-ee,ce=function(){return B.m(V,ee)};switch(Q){case m:ne=ce()/12;break;case d:ne=ce();break;case h:ne=ce()/3;break;case u:ne=(me-se)/6048e5;break;case c:ne=(me-se)/864e5;break;case l:ne=me/s;break;case o:ne=me/r;break;case a:ne=me/n;break;default:ne=me}return L?ne:B.a(ne)},Z.daysInMonth=function(){return this.endOf(d).$D},Z.$locale=function(){return R[this.$L]},Z.locale=function(U,H){if(!U)return this.$L;var L=this.clone(),ne=I(U,H,!0);return ne&&(L.$L=ne),L},Z.clone=function(){return B.w(this.$d,this)},Z.toDate=function(){return new Date(this.valueOf())},Z.toJSON=function(){return this.isValid()?this.toISOString():null},Z.toISOString=function(){return this.$d.toISOString()},Z.toString=function(){return this.$d.toUTCString()},P}(),W=D.prototype;return O.prototype=W,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",m],["$D",y]].forEach(function(P){W[P[1]]=function(Z){return this.$g(Z,P[0],P[1])}}),O.extend=function(P,Z){return P.$i||(P(Z,D,O),P.$i=!0),O},O.locale=I,O.isDayjs=N,O.unix=function(P){return O(1e3*P)},O.en=R[C],O.Ls=R,O.p={},O})}(U2)),U2.exports}var qYe=UYe();const VYe=Sa(qYe),q2={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return q2.hue2rgb(i,s,e+1/3)*255;case"g":return q2.hue2rgb(i,s,e)*255;case"b":return q2.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},WYe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},HYe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},cr={channel:q2,lang:WYe,unit:HYe},nh={};for(let e=0;e<=255;e++)nh[e]=cr.unit.dec2hex(e);const Na={ALL:0,RGB:1,HSL:2};class GYe{constructor(){this.type=Na.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Na.ALL}is(t){return this.type===t}}class KYe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new GYe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Na.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=cr.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=cr.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=cr.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=cr.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=cr.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=cr.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Na.HSL)&&n!==void 0?n:(this._ensureHSL(),cr.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Na.HSL)&&n!==void 0?n:(this._ensureHSL(),cr.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Na.HSL)&&n!==void 0?n:(this._ensureHSL(),cr.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Na.RGB)&&n!==void 0?n:(this._ensureRGB(),cr.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Na.RGB)&&n!==void 0?n:(this._ensureRGB(),cr.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Na.RGB)&&n!==void 0?n:(this._ensureRGB(),cr.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Na.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Na.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Na.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Na.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Na.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Na.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const YT=new KYe({r:0,g:0,b:0,a:0},"transparent"),F0={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(F0.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return YT.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${nh[Math.round(t)]}${nh[Math.round(n)]}${nh[Math.round(r)]}${nh[Math.round(s*255)]}`:`#${nh[Math.round(t)]}${nh[Math.round(n)]}${nh[Math.round(r)]}`}},im={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(im.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return cr.channel.clamp.h(parseFloat(n)*.9);case"rad":return cr.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return cr.channel.clamp.h(parseFloat(n)*360)}}return cr.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(im.re);if(!n)return;const[,r,s,i,a,o]=n;return YT.set({h:im._hue2deg(r),s:cr.channel.clamp.s(parseFloat(s)),l:cr.channel.clamp.l(parseFloat(i)),a:a?cr.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${cr.lang.round(t)}, ${cr.lang.round(n)}%, ${cr.lang.round(r)}%, ${s})`:`hsl(${cr.lang.round(t)}, ${cr.lang.round(n)}%, ${cr.lang.round(r)}%)`}},Fx={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=Fx.colors[e];if(t)return F0.parse(t)},stringify:e=>{const t=F0.stringify(e);for(const n in Fx.colors)if(Fx.colors[n]===t)return n}},px={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(px.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return YT.set({r:cr.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:cr.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:cr.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?cr.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${cr.lang.round(t)}, ${cr.lang.round(n)}, ${cr.lang.round(r)}, ${cr.lang.round(s)})`:`rgb(${cr.lang.round(t)}, ${cr.lang.round(n)}, ${cr.lang.round(r)})`}},Du={format:{keyword:Fx,hex:F0,rgb:px,rgba:px,hsl:im,hsla:im},parse:e=>{if(typeof e!="string")return e;const t=F0.parse(e)||px.parse(e)||im.parse(e)||Fx.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Na.HSL)||e.data.r===void 0?im.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?px.stringify(e):F0.stringify(e)},kie=(e,t)=>{const n=Du.parse(e);for(const r in t)n[r]=cr.channel.clamp[r](t[r]);return Du.stringify(n)},Lx=(e,t,n=0,r=1)=>{if(typeof e!="number")return kie(e,{a:t});const s=YT.set({r:cr.channel.clamp.r(e),g:cr.channel.clamp.g(t),b:cr.channel.clamp.b(n),a:cr.channel.clamp.a(r)});return Du.stringify(s)},YYe=e=>{const{r:t,g:n,b:r}=Du.parse(e),s=.2126*cr.channel.toLinear(t)+.7152*cr.channel.toLinear(n)+.0722*cr.channel.toLinear(r);return cr.lang.round(s)},ZYe=e=>YYe(e)>=.5,l_=e=>!ZYe(e),Eie=(e,t,n)=>{const r=Du.parse(e),s=r[t],i=cr.channel.clamp[t](s+n);return s!==i&&(r[t]=i),Du.stringify(r)},_n=(e,t)=>Eie(e,"l",t),$n=(e,t)=>Eie(e,"l",-t),bt=(e,t)=>{const n=Du.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return kie(e,r)},XYe=(e,t,n=50)=>{const{r,g:s,b:i,a}=Du.parse(e),{r:o,g:l,b:c,a:u}=Du.parse(t),d=n/100,h=d*2-1,m=a-u,b=((h*m===-1?h:(h+m)/(1+h*m))+1)/2,v=1-b,x=r*b+o*v,w=s*b+l*v,S=i*b+c*v,k=a*d+u*(1-d);return Lx(x,w,S,k)},cn=(e,t=100)=>{const n=Du.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,XYe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Tie,setPrototypeOf:cV,isFrozen:JYe,getPrototypeOf:QYe,getOwnPropertyDescriptor:eZe}=Object;let{freeze:oo,seal:Gl,create:Aie}=Object,{apply:B4,construct:$4}=typeof Reflect<"u"&&Reflect;oo||(oo=function(t){return t});Gl||(Gl=function(t){return t});B4||(B4=function(t,n,r){return t.apply(n,r)});$4||($4=function(t,n){return new t(...n)});const m2=lo(Array.prototype.forEach),tZe=lo(Array.prototype.lastIndexOf),uV=lo(Array.prototype.pop),zv=lo(Array.prototype.push),nZe=lo(Array.prototype.splice),V2=lo(String.prototype.toLowerCase),w3=lo(String.prototype.toString),dV=lo(String.prototype.match),Uv=lo(String.prototype.replace),rZe=lo(String.prototype.indexOf),sZe=lo(String.prototype.trim),fc=lo(Object.prototype.hasOwnProperty),Za=lo(RegExp.prototype.test),qv=iZe(TypeError);function lo(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return B4(e,t,r)}}function iZe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return $4(e,n)}}function Br(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:V2;cV&&cV(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(JYe(t)||(t[r]=i),s=i)}e[s]=!0}return e}function aZe(e){for(let t=0;t<e.length;t++)fc(e,t)||(e[t]=null);return e}function xd(e){const t=Aie(null);for(const[n,r]of Tie(e))fc(e,n)&&(Array.isArray(r)?t[n]=aZe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=xd(r):t[n]=r);return t}function Vv(e,t){for(;e!==null;){const r=eZe(e,t);if(r){if(r.get)return lo(r.get);if(typeof r.value=="function")return lo(r.value)}e=QYe(e)}function n(){return null}return n}const fV=oo(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),_3=oo(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),S3=oo(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oZe=oo(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),C3=oo(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),lZe=oo(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),hV=oo(["#text"]),pV=oo(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),k3=oo(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mV=oo(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),g2=oo(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),cZe=Gl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),uZe=Gl(/<%[\w\W]*|[\w\W]*%>/gm),dZe=Gl(/\$\{[\w\W]*/gm),fZe=Gl(/^data-[\-\w.\u00B7-\uFFFF]+$/),hZe=Gl(/^aria-[\-\w]+$/),Rie=Gl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),pZe=Gl(/^(?:\w+script|data):/i),mZe=Gl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Nie=Gl(/^html$/i),gZe=Gl(/^[a-z][.\w]*(-[.\w]+)+$/i);var gV=Object.freeze({__proto__:null,ARIA_ATTR:hZe,ATTR_WHITESPACE:mZe,CUSTOM_ELEMENT:gZe,DATA_ATTR:fZe,DOCTYPE_NAME:Nie,ERB_EXPR:uZe,IS_ALLOWED_URI:Rie,IS_SCRIPT_OR_DATA:pZe,MUSTACHE_EXPR:cZe,TMPLIT_EXPR:dZe});const Wv={element:1,text:3,progressingInstruction:7,comment:8,document:9},yZe=function(){return typeof window>"u"?null:window},bZe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},yV=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Mie(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:yZe();const t=hn=>Mie(hn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Wv.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:m}=e,y=l.prototype,b=Vv(y,"cloneNode"),v=Vv(y,"remove"),x=Vv(y,"nextSibling"),w=Vv(y,"childNodes"),S=Vv(y,"parentNode");if(typeof a=="function"){const hn=n.createElement("template");hn.content&&hn.content.ownerDocument&&(n=hn.content.ownerDocument)}let k,C="";const{implementation:R,createNodeIterator:A,createDocumentFragment:N,getElementsByTagName:I}=n,{importNode:O}=r;let B=yV();t.isSupported=typeof Tie=="function"&&typeof S=="function"&&R&&R.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:W,TMPLIT_EXPR:P,DATA_ATTR:Z,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:H,ATTR_WHITESPACE:L,CUSTOM_ELEMENT:ne}=gV;let{IS_ALLOWED_URI:V}=gV,Q=null;const ee=Br({},[...fV,..._3,...S3,...C3,...hV]);let se=null;const me=Br({},[...pV,...k3,...mV,...g2]);let ce=Object.seal(Aie(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),je=null,De=null,Se=!0,Ce=!0,qe=!1,Qe=!0,We=!1,Ne=!0,K=!1,ge=!1,Ae=!1,le=!1,oe=!1,re=!1,Te=!0,Be=!1;const ke="user-content-";let lt=!0,Rt=!1,ft={},Pt=null;const qt=Br({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Lt=null;const en=Br({},["audio","video","img","source","image","track"]);let xe=null;const F=Br({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),X="http://www.w3.org/1998/Math/MathML",ye="http://www.w3.org/2000/svg",Fe="http://www.w3.org/1999/xhtml";let we=Fe,Ie=!1,fe=null;const vt=Br({},[X,ye,Fe],w3);let ot=Br({},["mi","mo","mn","ms","mtext"]),$=Br({},["annotation-xml"]);const ze=Br({},["title","style","font","a","script"]);let st=null;const be=["application/xhtml+xml","text/html"],_e="text/html";let Ue=null,Et=null;const he=n.createElement("form"),Y=function(et){return et instanceof RegExp||et instanceof Function},G=function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Et&&Et===et)){if((!et||typeof et!="object")&&(et={}),et=xd(et),st=be.indexOf(et.PARSER_MEDIA_TYPE)===-1?_e:et.PARSER_MEDIA_TYPE,Ue=st==="application/xhtml+xml"?w3:V2,Q=fc(et,"ALLOWED_TAGS")?Br({},et.ALLOWED_TAGS,Ue):ee,se=fc(et,"ALLOWED_ATTR")?Br({},et.ALLOWED_ATTR,Ue):me,fe=fc(et,"ALLOWED_NAMESPACES")?Br({},et.ALLOWED_NAMESPACES,w3):vt,xe=fc(et,"ADD_URI_SAFE_ATTR")?Br(xd(F),et.ADD_URI_SAFE_ATTR,Ue):F,Lt=fc(et,"ADD_DATA_URI_TAGS")?Br(xd(en),et.ADD_DATA_URI_TAGS,Ue):en,Pt=fc(et,"FORBID_CONTENTS")?Br({},et.FORBID_CONTENTS,Ue):qt,je=fc(et,"FORBID_TAGS")?Br({},et.FORBID_TAGS,Ue):xd({}),De=fc(et,"FORBID_ATTR")?Br({},et.FORBID_ATTR,Ue):xd({}),ft=fc(et,"USE_PROFILES")?et.USE_PROFILES:!1,Se=et.ALLOW_ARIA_ATTR!==!1,Ce=et.ALLOW_DATA_ATTR!==!1,qe=et.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=et.ALLOW_SELF_CLOSE_IN_ATTR!==!1,We=et.SAFE_FOR_TEMPLATES||!1,Ne=et.SAFE_FOR_XML!==!1,K=et.WHOLE_DOCUMENT||!1,le=et.RETURN_DOM||!1,oe=et.RETURN_DOM_FRAGMENT||!1,re=et.RETURN_TRUSTED_TYPE||!1,Ae=et.FORCE_BODY||!1,Te=et.SANITIZE_DOM!==!1,Be=et.SANITIZE_NAMED_PROPS||!1,lt=et.KEEP_CONTENT!==!1,Rt=et.IN_PLACE||!1,V=et.ALLOWED_URI_REGEXP||Rie,we=et.NAMESPACE||Fe,ot=et.MATHML_TEXT_INTEGRATION_POINTS||ot,$=et.HTML_INTEGRATION_POINTS||$,ce=et.CUSTOM_ELEMENT_HANDLING||{},et.CUSTOM_ELEMENT_HANDLING&&Y(et.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ce.tagNameCheck=et.CUSTOM_ELEMENT_HANDLING.tagNameCheck),et.CUSTOM_ELEMENT_HANDLING&&Y(et.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ce.attributeNameCheck=et.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),et.CUSTOM_ELEMENT_HANDLING&&typeof et.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ce.allowCustomizedBuiltInElements=et.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),We&&(Ce=!1),oe&&(le=!0),ft&&(Q=Br({},hV),se=[],ft.html===!0&&(Br(Q,fV),Br(se,pV)),ft.svg===!0&&(Br(Q,_3),Br(se,k3),Br(se,g2)),ft.svgFilters===!0&&(Br(Q,S3),Br(se,k3),Br(se,g2)),ft.mathMl===!0&&(Br(Q,C3),Br(se,mV),Br(se,g2))),et.ADD_TAGS&&(Q===ee&&(Q=xd(Q)),Br(Q,et.ADD_TAGS,Ue)),et.ADD_ATTR&&(se===me&&(se=xd(se)),Br(se,et.ADD_ATTR,Ue)),et.ADD_URI_SAFE_ATTR&&Br(xe,et.ADD_URI_SAFE_ATTR,Ue),et.FORBID_CONTENTS&&(Pt===qt&&(Pt=xd(Pt)),Br(Pt,et.FORBID_CONTENTS,Ue)),lt&&(Q["#text"]=!0),K&&Br(Q,["html","head","body"]),Q.table&&(Br(Q,["tbody"]),delete je.tbody),et.TRUSTED_TYPES_POLICY){if(typeof et.TRUSTED_TYPES_POLICY.createHTML!="function")throw qv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof et.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=et.TRUSTED_TYPES_POLICY,C=k.createHTML("")}else k===void 0&&(k=bZe(m,s)),k!==null&&typeof C=="string"&&(C=k.createHTML(""));oo&&oo(et),Et=et}},J=Br({},[..._3,...S3,...oZe]),ve=Br({},[...C3,...lZe]),Oe=function(et){let Vt=S(et);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:we,tagName:"template"});const pn=V2(et.tagName),rr=V2(Vt.tagName);return fe[et.namespaceURI]?et.namespaceURI===ye?Vt.namespaceURI===Fe?pn==="svg":Vt.namespaceURI===X?pn==="svg"&&(rr==="annotation-xml"||ot[rr]):!!J[pn]:et.namespaceURI===X?Vt.namespaceURI===Fe?pn==="math":Vt.namespaceURI===ye?pn==="math"&&$[rr]:!!ve[pn]:et.namespaceURI===Fe?Vt.namespaceURI===ye&&!$[rr]||Vt.namespaceURI===X&&!ot[rr]?!1:!ve[pn]&&(ze[pn]||!J[pn]):!!(st==="application/xhtml+xml"&&fe[et.namespaceURI]):!1},Ke=function(et){zv(t.removed,{element:et});try{S(et).removeChild(et)}catch{v(et)}},_t=function(et,Vt){try{zv(t.removed,{attribute:Vt.getAttributeNode(et),from:Vt})}catch{zv(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(et),et==="is")if(le||oe)try{Ke(Vt)}catch{}else try{Vt.setAttribute(et,"")}catch{}},tn=function(et){let Vt=null,pn=null;if(Ae)et="<remove></remove>"+et;else{const es=dV(et,/^[\r\n\t ]+/);pn=es&&es[0]}st==="application/xhtml+xml"&&we===Fe&&(et='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+et+"</body></html>");const rr=k?k.createHTML(et):et;if(we===Fe)try{Vt=new h().parseFromString(rr,st)}catch{}if(!Vt||!Vt.documentElement){Vt=R.createDocument(we,"template",null);try{Vt.documentElement.innerHTML=Ie?C:rr}catch{}}const Rs=Vt.body||Vt.documentElement;return et&&pn&&Rs.insertBefore(n.createTextNode(pn),Rs.childNodes[0]||null),we===Fe?I.call(Vt,K?"html":"body")[0]:K?Vt.documentElement:Rs},zn=function(et){return A.call(et.ownerDocument||et,et,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Xt=function(et){return et instanceof d&&(typeof et.nodeName!="string"||typeof et.textContent!="string"||typeof et.removeChild!="function"||!(et.attributes instanceof u)||typeof et.removeAttribute!="function"||typeof et.setAttribute!="function"||typeof et.namespaceURI!="string"||typeof et.insertBefore!="function"||typeof et.hasChildNodes!="function")},nn=function(et){return typeof o=="function"&&et instanceof o};function un(hn,et,Vt){m2(hn,pn=>{pn.call(t,et,Vt,Et)})}const yr=function(et){let Vt=null;if(un(B.beforeSanitizeElements,et,null),Xt(et))return Ke(et),!0;const pn=Ue(et.nodeName);if(un(B.uponSanitizeElement,et,{tagName:pn,allowedTags:Q}),Ne&&et.hasChildNodes()&&!nn(et.firstElementChild)&&Za(/<[/\w!]/g,et.innerHTML)&&Za(/<[/\w!]/g,et.textContent)||et.nodeType===Wv.progressingInstruction||Ne&&et.nodeType===Wv.comment&&Za(/<[/\w]/g,et.data))return Ke(et),!0;if(!Q[pn]||je[pn]){if(!je[pn]&&ns(pn)&&(ce.tagNameCheck instanceof RegExp&&Za(ce.tagNameCheck,pn)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(pn)))return!1;if(lt&&!Pt[pn]){const rr=S(et)||et.parentNode,Rs=w(et)||et.childNodes;if(Rs&&rr){const es=Rs.length;for(let Pi=es-1;Pi>=0;--Pi){const ui=b(Rs[Pi],!0);ui.__removalCount=(et.__removalCount||0)+1,rr.insertBefore(ui,x(et))}}}return Ke(et),!0}return et instanceof l&&!Oe(et)||(pn==="noscript"||pn==="noembed"||pn==="noframes")&&Za(/<\/no(script|embed|frames)/i,et.innerHTML)?(Ke(et),!0):(We&&et.nodeType===Wv.text&&(Vt=et.textContent,m2([D,W,P],rr=>{Vt=Uv(Vt,rr," ")}),et.textContent!==Vt&&(zv(t.removed,{element:et.cloneNode()}),et.textContent=Vt)),un(B.afterSanitizeElements,et,null),!1)},Rr=function(et,Vt,pn){if(Te&&(Vt==="id"||Vt==="name")&&(pn in n||pn in he))return!1;if(!(Ce&&!De[Vt]&&Za(Z,Vt))){if(!(Se&&Za(U,Vt))){if(!se[Vt]||De[Vt]){if(!(ns(et)&&(ce.tagNameCheck instanceof RegExp&&Za(ce.tagNameCheck,et)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(et))&&(ce.attributeNameCheck instanceof RegExp&&Za(ce.attributeNameCheck,Vt)||ce.attributeNameCheck instanceof Function&&ce.attributeNameCheck(Vt))||Vt==="is"&&ce.allowCustomizedBuiltInElements&&(ce.tagNameCheck instanceof RegExp&&Za(ce.tagNameCheck,pn)||ce.tagNameCheck instanceof Function&&ce.tagNameCheck(pn))))return!1}else if(!xe[Vt]){if(!Za(V,Uv(pn,L,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&et!=="script"&&rZe(pn,"data:")===0&&Lt[et])){if(!(qe&&!Za(H,Uv(pn,L,"")))){if(pn)return!1}}}}}}return!0},ns=function(et){return et!=="annotation-xml"&&dV(et,ne)},rs=function(et){un(B.beforeSanitizeAttributes,et,null);const{attributes:Vt}=et;if(!Vt||Xt(et))return;const pn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se,forceKeepAttr:void 0};let rr=Vt.length;for(;rr--;){const Rs=Vt[rr],{name:es,namespaceURI:Pi,value:ui}=Rs,qa=Ue(es),da=ui;let Hs=es==="value"?da:sZe(da);if(pn.attrName=qa,pn.attrValue=Hs,pn.keepAttr=!0,pn.forceKeepAttr=void 0,un(B.uponSanitizeAttribute,et,pn),Hs=pn.attrValue,Be&&(qa==="id"||qa==="name")&&(_t(es,et),Hs=ke+Hs),Ne&&Za(/((--!?|])>)|<\/(style|title)/i,Hs)){_t(es,et);continue}if(pn.forceKeepAttr)continue;if(!pn.keepAttr){_t(es,et);continue}if(!Qe&&Za(/\/>/i,Hs)){_t(es,et);continue}We&&m2([D,W,P],bl=>{Hs=Uv(Hs,bl," ")});const qo=Ue(et.nodeName);if(!Rr(qo,qa,Hs)){_t(es,et);continue}if(k&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Pi)switch(m.getAttributeType(qo,qa)){case"TrustedHTML":{Hs=k.createHTML(Hs);break}case"TrustedScriptURL":{Hs=k.createScriptURL(Hs);break}}if(Hs!==da)try{Pi?et.setAttributeNS(Pi,es,Hs):et.setAttribute(es,Hs),Xt(et)?Ke(et):uV(t.removed)}catch{_t(es,et)}}un(B.afterSanitizeAttributes,et,null)},Cr=function hn(et){let Vt=null;const pn=zn(et);for(un(B.beforeSanitizeShadowDOM,et,null);Vt=pn.nextNode();)un(B.uponSanitizeShadowNode,Vt,null),yr(Vt),rs(Vt),Vt.content instanceof i&&hn(Vt.content);un(B.afterSanitizeShadowDOM,et,null)};return t.sanitize=function(hn){let et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,pn=null,rr=null,Rs=null;if(Ie=!hn,Ie&&(hn="<!-->"),typeof hn!="string"&&!nn(hn))if(typeof hn.toString=="function"){if(hn=hn.toString(),typeof hn!="string")throw qv("dirty is not a string, aborting")}else throw qv("toString is not a function");if(!t.isSupported)return hn;if(ge||G(et),t.removed=[],typeof hn=="string"&&(Rt=!1),Rt){if(hn.nodeName){const ui=Ue(hn.nodeName);if(!Q[ui]||je[ui])throw qv("root node is forbidden and cannot be sanitized in-place")}}else if(hn instanceof o)Vt=tn("<!---->"),pn=Vt.ownerDocument.importNode(hn,!0),pn.nodeType===Wv.element&&pn.nodeName==="BODY"||pn.nodeName==="HTML"?Vt=pn:Vt.appendChild(pn);else{if(!le&&!We&&!K&&hn.indexOf("<")===-1)return k&&re?k.createHTML(hn):hn;if(Vt=tn(hn),!Vt)return le?null:re?C:""}Vt&&Ae&&Ke(Vt.firstChild);const es=zn(Rt?hn:Vt);for(;rr=es.nextNode();)yr(rr),rs(rr),rr.content instanceof i&&Cr(rr.content);if(Rt)return hn;if(le){if(oe)for(Rs=N.call(Vt.ownerDocument);Vt.firstChild;)Rs.appendChild(Vt.firstChild);else Rs=Vt;return(se.shadowroot||se.shadowrootmode)&&(Rs=O.call(r,Rs,!0)),Rs}let Pi=K?Vt.outerHTML:Vt.innerHTML;return K&&Q["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&Za(Nie,Vt.ownerDocument.doctype.name)&&(Pi="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+Pi),We&&m2([D,W,P],ui=>{Pi=Uv(Pi,ui," ")}),k&&re?k.createHTML(Pi):Pi},t.setConfig=function(){let hn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(hn),ge=!0},t.clearConfig=function(){Et=null,ge=!1},t.isValidAttribute=function(hn,et,Vt){Et||G({});const pn=Ue(hn),rr=Ue(et);return Rr(pn,rr,Vt)},t.addHook=function(hn,et){typeof et=="function"&&zv(B[hn],et)},t.removeHook=function(hn,et){if(et!==void 0){const Vt=tZe(B[hn],et);return Vt===-1?void 0:nZe(B[hn],Vt,1)[0]}return uV(B[hn])},t.removeHooks=function(hn){B[hn]=[]},t.removeAllHooks=function(){B=yV()},t}var ky=Mie(),Iie=Object.defineProperty,ie=(e,t)=>Iie(e,"name",{value:t,configurable:!0}),vZe=(e,t)=>{for(var n in t)Iie(e,n,{get:t[n],enumerable:!0})},gd={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},zt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},c5=ie(function(e="fatal"){let t=gd.fatal;typeof e=="string"?e.toLowerCase()in gd&&(t=gd[e]):typeof e=="number"&&(t=e),zt.trace=()=>{},zt.debug=()=>{},zt.info=()=>{},zt.warn=()=>{},zt.error=()=>{},zt.fatal=()=>{},t<=gd.fatal&&(zt.fatal=console.error?console.error.bind(console,jl("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",jl("FATAL"))),t<=gd.error&&(zt.error=console.error?console.error.bind(console,jl("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",jl("ERROR"))),t<=gd.warn&&(zt.warn=console.warn?console.warn.bind(console,jl("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",jl("WARN"))),t<=gd.info&&(zt.info=console.info?console.info.bind(console,jl("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",jl("INFO"))),t<=gd.debug&&(zt.debug=console.debug?console.debug.bind(console,jl("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",jl("DEBUG"))),t<=gd.trace&&(zt.trace=console.debug?console.debug.bind(console,jl("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",jl("TRACE")))},"setLogLevel"),jl=ie(e=>`%c${VYe().format("ss.SSS")} : ${e} : `,"format"),jie=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Bx=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,xZe=/\s*%%.*\n/gm,$0,Pie=($0=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie($0,"UnknownDiagramError"),$0),Ey={},u5=ie(function(e,t){e=e.replace(jie,"").replace(Bx,"").replace(xZe,`
`);for(const[n,{detector:r}]of Object.entries(Ey))if(r(e,t))return n;throw new Pie(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),Oie=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)Die(t,n,r)},"registerLazyLoadedDiagrams"),Die=ie((e,t,n)=>{Ey[e]&&zt.warn(`Detector with key ${e} already exists. Overwriting.`),Ey[e]={detector:t,loader:n},zt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),wZe=ie(e=>Ey[e].loader,"getDiagramLoader"),z4=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>z4(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=z4(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),wa=z4,ZT="#ffffff",XT="#f2f2f2",Qa=ie((e,t)=>t?bt(e,{s:-40,l:10}):bt(e,{s:-40,l:-10}),"mkBorder"),z0,_Ze=(z0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,R;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||bt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||bt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Qa(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Qa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Qa(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Qa(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||cn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||cn(this.tertiaryColor),this.lineColor=this.lineColor||cn(this.background),this.arrowheadColor=this.arrowheadColor||cn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?$n(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||$n(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||cn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||_n(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||$n(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||$n(this.mainBkg,10)):(this.rowOdd=this.rowOdd||_n(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||_n(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330}),this.darkMode)for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=$n(this["cScale"+A],75);else for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=$n(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||cn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this.darkMode?this["cScalePeer"+A]=this["cScalePeer"+A]||_n(this["cScale"+A],10):this["cScalePeer"+A]=this["cScalePeer"+A]||$n(this["cScale"+A],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||bt(this.mainBkg,{h:180,s:-15,l:t*(5+A*3)}),this["surfacePeer"+A]=this["surfacePeer"+A]||bt(this.mainBkg,{h:180,s:-15,l:t*(8+A*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||bt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||bt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||bt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||bt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||bt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||bt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||bt(this.primaryColor,{l:-10}),this.pie5=this.pie5||bt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||bt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||bt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||bt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||bt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||bt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||bt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||bt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||l_(this.quadrant1Fill)?_n(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((m=this.xyChart)==null?void 0:m.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((k=this.xyChart)==null?void 0:k.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((R=this.xyChart)==null?void 0:R.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?$n(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||bt(this.primaryColor,{h:-30}),this.git4=this.git4||bt(this.primaryColor,{h:-60}),this.git5=this.git5||bt(this.primaryColor,{h:-90}),this.git6=this.git6||bt(this.primaryColor,{h:60}),this.git7=this.git7||bt(this.primaryColor,{h:120}),this.darkMode?(this.git0=_n(this.git0,25),this.git1=_n(this.git1,25),this.git2=_n(this.git2,25),this.git3=_n(this.git3,25),this.git4=_n(this.git4,25),this.git5=_n(this.git5,25),this.git6=_n(this.git6,25),this.git7=_n(this.git7,25)):(this.git0=$n(this.git0,25),this.git1=$n(this.git1,25),this.git2=$n(this.git2,25),this.git3=$n(this.git3,25),this.git4=$n(this.git4,25),this.git5=$n(this.git5,25),this.git6=$n(this.git6,25),this.git7=$n(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||ZT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||XT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(z0,"Theme"),z0),SZe=ie(e=>{const t=new _Ze;return t.calculate(e),t},"getThemeVariables"),U0,CZe=(U0=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=_n(this.primaryColor,16),this.tertiaryColor=bt(this.primaryColor,{h:-160}),this.primaryBorderColor=cn(this.background),this.secondaryBorderColor=Qa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Qa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=_n(cn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=Lx(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=$n("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=$n(this.sectionBkgColor,10),this.taskBorderColor=Lx(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=Lx(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||_n(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||$n(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.secondBkg=_n(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=_n(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=_n(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330});for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||cn(this["cScale"+R]);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScalePeer"+R]=this["cScalePeer"+R]||_n(this["cScale"+R],10);for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||bt(this.mainBkg,{h:30,s:-30,l:-(-10+R*4)}),this["surfacePeer"+R]=this["surfacePeer"+R]||bt(this.mainBkg,{h:30,s:-30,l:-(-7+R*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["pie"+R]=this["cScale"+R];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||l_(this.quadrant1Fill)?_n(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?$n(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=_n(this.secondaryColor,20),this.git1=_n(this.pie2||this.secondaryColor,20),this.git2=_n(this.pie3||this.tertiaryColor,20),this.git3=_n(this.pie4||bt(this.primaryColor,{h:-30}),20),this.git4=_n(this.pie5||bt(this.primaryColor,{h:-60}),20),this.git5=_n(this.pie6||bt(this.primaryColor,{h:-90}),10),this.git6=_n(this.pie7||bt(this.primaryColor,{h:60}),10),this.git7=_n(this.pie8||bt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||_n(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||_n(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(U0,"Theme"),U0),kZe=ie(e=>{const t=new CZe;return t.calculate(e),t},"getThemeVariables"),q0,EZe=(q0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=bt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=bt(this.primaryColor,{h:-160}),this.primaryBorderColor=Qa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Qa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Qa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=Lx(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||$n(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||$n(this.tertiaryColor,40);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=$n(this["cScale"+R],10),this["cScalePeer"+R]=this["cScalePeer"+R]||$n(this["cScale"+R],25);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||bt(this["cScale"+R],{h:180});for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||bt(this.mainBkg,{h:30,l:-(5+R*5)}),this["surfacePeer"+R]=this["surfacePeer"+R]||bt(this.mainBkg,{h:30,l:-(7+R*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||cn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||cn(this.labelTextColor);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=_n(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||_n(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||_n(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||bt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||bt(this.primaryColor,{l:-10}),this.pie5=this.pie5||bt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||bt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||bt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||bt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||bt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||bt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||bt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||bt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||l_(this.quadrant1Fill)?_n(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||bt(this.primaryColor,{h:-30}),this.git4=this.git4||bt(this.primaryColor,{h:-60}),this.git5=this.git5||bt(this.primaryColor,{h:-90}),this.git6=this.git6||bt(this.primaryColor,{h:60}),this.git7=this.git7||bt(this.primaryColor,{h:120}),this.darkMode?(this.git0=_n(this.git0,25),this.git1=_n(this.git1,25),this.git2=_n(this.git2,25),this.git3=_n(this.git3,25),this.git4=_n(this.git4,25),this.git5=_n(this.git5,25),this.git6=_n(this.git6,25),this.git7=_n(this.git7,25)):(this.git0=$n(this.git0,25),this.git1=$n(this.git1,25),this.git2=$n(this.git2,25),this.git3=$n(this.git3,25),this.git4=$n(this.git4,25),this.git5=$n(this.git5,25),this.git6=$n(this.git6,25),this.git7=$n(this.git7,25)),this.gitInv0=this.gitInv0||$n(cn(this.git0),25),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||ZT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||XT}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(q0,"Theme"),q0),TZe=ie(e=>{const t=new EZe;return t.calculate(e),t},"getThemeVariables"),V0,AZe=(V0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=_n("#cde498",10),this.primaryBorderColor=Qa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Qa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Qa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.primaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.actorBorder=$n(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||bt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||bt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||bt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||bt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||bt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||bt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||bt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||bt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||bt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||$n(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||$n(this.tertiaryColor,40);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=$n(this["cScale"+R],10),this["cScalePeer"+R]=this["cScalePeer"+R]||$n(this["cScale"+R],25);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||bt(this["cScale"+R],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||bt(this.mainBkg,{h:30,s:-30,l:-(5+R*5)}),this["surfacePeer"+R]=this["surfacePeer"+R]||bt(this.mainBkg,{h:30,s:-30,l:-(8+R*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||_n(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||_n(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||bt(this.primaryColor,{l:-30}),this.pie5=this.pie5||bt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||bt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||bt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||bt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||bt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||bt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||bt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||bt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||l_(this.quadrant1Fill)?_n(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||bt(this.primaryColor,{h:-30}),this.git4=this.git4||bt(this.primaryColor,{h:-60}),this.git5=this.git5||bt(this.primaryColor,{h:-90}),this.git6=this.git6||bt(this.primaryColor,{h:60}),this.git7=this.git7||bt(this.primaryColor,{h:120}),this.darkMode?(this.git0=_n(this.git0,25),this.git1=_n(this.git1,25),this.git2=_n(this.git2,25),this.git3=_n(this.git3,25),this.git4=_n(this.git4,25),this.git5=_n(this.git5,25),this.git6=_n(this.git6,25),this.git7=_n(this.git7,25)):(this.git0=$n(this.git0,25),this.git1=$n(this.git1,25),this.git2=$n(this.git2,25),this.git3=$n(this.git3,25),this.git4=$n(this.git4,25),this.git5=$n(this.git5,25),this.git6=$n(this.git6,25),this.git7=$n(this.git7,25)),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||cn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||cn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||ZT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||XT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(V0,"Theme"),V0),RZe=ie(e=>{const t=new AZe;return t.calculate(e),t},"getThemeVariables"),W0,NZe=(W0=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=_n(this.contrast,55),this.background="#ffffff",this.tertiaryColor=bt(this.primaryColor,{h:-160}),this.primaryBorderColor=Qa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Qa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Qa(this.tertiaryColor,this.darkMode),this.primaryTextColor=cn(this.primaryColor),this.secondaryTextColor=cn(this.secondaryColor),this.tertiaryTextColor=cn(this.tertiaryColor),this.lineColor=cn(this.background),this.textColor=cn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||_n(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.secondBkg=_n(this.contrast,55),this.border2=this.contrast,this.actorBorder=_n(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||cn(this["cScale"+R]);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this.darkMode?this["cScalePeer"+R]=this["cScalePeer"+R]||_n(this["cScale"+R],10):this["cScalePeer"+R]=this["cScalePeer"+R]||$n(this["cScale"+R],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||bt(this.mainBkg,{l:-(5+R*5)}),this["surfacePeer"+R]=this["surfacePeer"+R]||bt(this.mainBkg,{l:-(8+R*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=_n(this.contrast,30),this.sectionBkgColor2=_n(this.contrast,30),this.taskBorderColor=$n(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=_n(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=$n(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=bt(this.primaryColor,{h:64}),this.fillType3=bt(this.secondaryColor,{h:64}),this.fillType4=bt(this.primaryColor,{h:-64}),this.fillType5=bt(this.secondaryColor,{h:-64}),this.fillType6=bt(this.primaryColor,{h:128}),this.fillType7=bt(this.secondaryColor,{h:128});for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["pie"+R]=this["cScale"+R];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||bt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||bt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||bt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||bt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||bt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||bt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||l_(this.quadrant1Fill)?_n(this.quadrant1Fill):$n(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=$n(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||bt(this.primaryColor,{h:-30}),this.git4=this.pie5||bt(this.primaryColor,{h:-60}),this.git5=this.pie6||bt(this.primaryColor,{h:-90}),this.git6=this.pie7||bt(this.primaryColor,{h:60}),this.git7=this.pie8||bt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||cn(this.git0),this.gitInv1=this.gitInv1||cn(this.git1),this.gitInv2=this.gitInv2||cn(this.git2),this.gitInv3=this.gitInv3||cn(this.git3),this.gitInv4=this.gitInv4||cn(this.git4),this.gitInv5=this.gitInv5||cn(this.git5),this.gitInv6=this.gitInv6||cn(this.git6),this.gitInv7=this.gitInv7||cn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||ZT,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||XT}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(W0,"Theme"),W0),MZe=ie(e=>{const t=new NZe;return t.calculate(e),t},"getThemeVariables"),$d={base:{getThemeVariables:SZe},dark:{getThemeVariables:kZe},default:{getThemeVariables:TZe},forest:{getThemeVariables:RZe},neutral:{getThemeVariables:MZe}},yd={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},Fie={...yd,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:$d.default.getThemeVariables(),sequence:{...yd.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...yd.gantt,tickInterval:void 0,useWidth:void 0},c4:{...yd.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...yd.pie,useWidth:984},xyChart:{...yd.xyChart,useWidth:void 0},requirement:{...yd.requirement,useWidth:void 0},packet:{...yd.packet},radar:{...yd.radar}},Lie=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...Lie(e[r],"")]:[...n,t+r],[]),"keyify"),IZe=new Set(Lie(Fie,"")),Bie=Fie,Nk=ie(e=>{if(zt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>Nk(t));return}for(const t of Object.keys(e)){if(zt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!IZe.has(t)||e[t]==null){zt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){zt.debug("sanitizing object",t),Nk(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(zt.debug("sanitizing css option",t),e[t]=jZe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}zt.debug("After sanitization",e)}},"sanitizeDirective"),jZe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),Ty=Object.freeze(Bie),xo=wa({},Ty),$ie,Ay=[],$x=wa({},Ty),JT=ie((e,t)=>{let n=wa({},e),r={};for(const s of t)qie(s),r=wa(r,s);if(n=wa(n,r),r.theme&&r.theme in $d){const s=wa({},$ie),i=wa(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in $d&&(n.themeVariables=$d[n.theme].getThemeVariables(i))}return $x=n,Vie($x),$x},"updateCurrentConfig"),PZe=ie(e=>(xo=wa({},Ty),xo=wa(xo,e),e.theme&&$d[e.theme]&&(xo.themeVariables=$d[e.theme].getThemeVariables(e.themeVariables)),JT(xo,Ay),xo),"setSiteConfig"),OZe=ie(e=>{$ie=wa({},e)},"saveConfigFromInitialize"),DZe=ie(e=>(xo=wa(xo,e),JT(xo,Ay),xo),"updateSiteConfig"),zie=ie(()=>wa({},xo),"getSiteConfig"),Uie=ie(e=>(Vie(e),wa($x,e),Io()),"setConfig"),Io=ie(()=>wa({},$x),"getConfig"),qie=ie(e=>{e&&(["secure",...xo.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(zt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&qie(e[t])}))},"sanitize"),FZe=ie(e=>{var t;Nk(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),Ay.push(e),JT(xo,Ay)},"addDirective"),Mk=ie((e=xo)=>{Ay=[],JT(e,Ay)},"reset"),LZe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},bV={},BZe=ie(e=>{bV[e]||(zt.warn(LZe[e]),bV[e]=!0)},"issueWarning"),Vie=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&BZe("LAZY_LOAD_DEPRECATED")},"checkConfig"),c_=/<br\s*\/?>/gi,$Ze=ie(e=>e?Gie(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),zZe=(()=>{let e=!1;return()=>{e||(Wie(),e=!0)}})();function Wie(){const e="data-temp-href-target";ky.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),ky.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(Wie,"setupDompurifyHooks");var Hie=ie(e=>(zZe(),ky.sanitize(e)),"removeScript"),vV=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=Hie(e):r!=="loose"&&(e=Gie(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=WZe(e))}return e},"sanitizeMore"),Im=ie((e,t)=>e&&(t.dompurifyConfig?e=ky.sanitize(vV(e,t),t.dompurifyConfig).toString():e=ky.sanitize(vV(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),UZe=ie((e,t)=>typeof e=="string"?Im(e,t):e.flat().map(n=>Im(n,t)),"sanitizeTextOrArray"),qZe=ie(e=>c_.test(e),"hasBreaks"),VZe=ie(e=>e.split(c_),"splitBreaks"),WZe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),Gie=ie(e=>e.replace(c_,"#br#"),"breakToPlaceholder"),HZe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Hi=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),GZe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),KZe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),xV=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];YZe(i,a)&&(s=i+","+a,r++,n.pop())}n.push(ZZe(s))}return n.join("")},"parseGenericTypes"),U4=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),YZe=ie((e,t)=>{const n=U4(e,"~"),r=U4(t,"~");return n===1&&r===1},"shouldCombineSets"),ZZe=ie(e=>{const t=U4(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),wV=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),q4=/\$\$(.*)\$\$/g,Ry=ie(e=>{var t;return(((t=e.match(q4))==null?void 0:t.length)??0)>0},"hasKatex"),_dt=ie(async(e,t)=>{e=await d5(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),d5=ie(async(e,t)=>{if(!Ry(e))return e;if(!(wV()||t.legacyMathML||t.forceLegacyMathML))return e.replace(q4,"MathML is unsupported in this environment.");const{default:n}=await Zr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!wV()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(c_).map(s=>Ry(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(q4,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),bb={getRows:$Ze,sanitizeText:Im,sanitizeTextOrArray:UZe,hasBreaks:qZe,splitBreaks:VZe,lineBreakRegex:c_,removeScript:Hie,getUrl:HZe,evaluate:Hi,getMax:GZe,getMin:KZe},XZe=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),JZe=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),Kie=ie(function(e,t,n,r){const s=JZe(t,n,r);XZe(e,s)},"configureSvgSize"),QZe=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;zt.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;zt.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,zt.info(`Calculated bounds: ${o}x${l}`),Kie(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),W2={},eXe=ie((e,t,n)=>{let r="";return e in W2&&W2[e]?r=W2[e](n):zt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),tXe=ie((e,t)=>{t!==void 0&&(W2[e]=t)},"addStylesForDiagram"),nXe=eXe,Yie={};vZe(Yie,{clear:()=>rXe,getAccDescription:()=>oXe,getAccTitle:()=>iXe,getDiagramTitle:()=>cXe,setAccDescription:()=>aXe,setAccTitle:()=>sXe,setDiagramTitle:()=>lXe});var f5="",h5="",p5="",m5=ie(e=>Im(e,Io()),"sanitizeText"),rXe=ie(()=>{f5="",p5="",h5=""},"clear"),sXe=ie(e=>{f5=m5(e).replace(/^\s+/g,"")},"setAccTitle"),iXe=ie(()=>f5,"getAccTitle"),aXe=ie(e=>{p5=m5(e).replace(/\n\s+/g,`
`)},"setAccDescription"),oXe=ie(()=>p5,"getAccDescription"),lXe=ie(e=>{h5=m5(e)},"setDiagramTitle"),cXe=ie(()=>h5,"getDiagramTitle"),_V=zt,uXe=c5,os=Io,Sdt=Uie,Cdt=Ty,g5=ie(e=>Im(e,os()),"sanitizeText"),dXe=QZe,fXe=ie(()=>Yie,"getCommonDb"),Ik={},jk=ie((e,t,n)=>{var r;Ik[e]&&_V.warn(`Diagram with id ${e} already registered. Overwriting.`),Ik[e]=t,n&&Die(e,n),tXe(e,t.styles),(r=t.injectUtils)==null||r.call(t,_V,uXe,os,g5,dXe,fXe(),()=>{})},"registerDiagram"),V4=ie(e=>{if(e in Ik)return Ik[e];throw new hXe(e)},"getDiagram"),H0,hXe=(H0=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(H0,"DiagramNotFoundError"),H0);function y5(e){return typeof e>"u"||e===null}ie(y5,"isNothing");function Zie(e){return typeof e=="object"&&e!==null}ie(Zie,"isObject");function Xie(e){return Array.isArray(e)?e:y5(e)?[]:[e]}ie(Xie,"toArray");function Jie(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(Jie,"extend");function Qie(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(Qie,"repeat");function eae(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(eae,"isNegativeZero");var pXe=y5,mXe=Zie,gXe=Xie,yXe=Qie,bXe=eae,vXe=Jie,zi={isNothing:pXe,isObject:mXe,toArray:gXe,repeat:yXe,isNegativeZero:bXe,extend:vXe};function b5(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(b5,"formatError");function Ny(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=b5(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(Ny,"YAMLException$1");Ny.prototype=Object.create(Error.prototype);Ny.prototype.constructor=Ny;Ny.prototype.toString=ie(function(t){return this.name+": "+b5(this,t)},"toString");var Co=Ny;function H2(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+i.length}}ie(H2,"getLine");function G2(e,t){return zi.repeat(" ",t-e.length)+e}ie(G2,"padStart");function tae(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=H2(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=zi.repeat(" ",t.indent)+G2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=H2(e.buffer,r[a],s[a],e.position,d),o+=zi.repeat(" ",t.indent)+G2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=zi.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=H2(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=zi.repeat(" ",t.indent)+G2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(tae,"makeSnippet");var xXe=tae,wXe=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],_Xe=["scalar","sequence","mapping"];function nae(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(nae,"compileStyleAliases");function rae(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(wXe.indexOf(n)===-1)throw new Co('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=nae(t.styleAliases||null),_Xe.indexOf(this.kind)===-1)throw new Co('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(rae,"Type$1");var Fa=rae;function W4(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie(W4,"compileList");function sae(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(sae,"compileMap");function Pk(e){return this.extend(e)}ie(Pk,"Schema$1");Pk.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof Fa)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Co("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof Fa))throw new Co("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Co("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Co("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Fa))throw new Co("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Pk.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=W4(s,"implicit"),s.compiledExplicit=W4(s,"explicit"),s.compiledTypeMap=sae(s.compiledImplicit,s.compiledExplicit),s},"extend");var SXe=Pk,CXe=new Fa("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),kXe=new Fa("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),EXe=new Fa("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),TXe=new SXe({explicit:[CXe,kXe,EXe]});function iae(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(iae,"resolveYamlNull");function aae(){return null}ie(aae,"constructYamlNull");function oae(e){return e===null}ie(oae,"isNull");var AXe=new Fa("tag:yaml.org,2002:null",{kind:"scalar",resolve:iae,construct:aae,predicate:oae,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function lae(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(lae,"resolveYamlBoolean");function cae(e){return e==="true"||e==="True"||e==="TRUE"}ie(cae,"constructYamlBoolean");function uae(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(uae,"isBoolean");var RXe=new Fa("tag:yaml.org,2002:bool",{kind:"scalar",resolve:lae,construct:cae,predicate:uae,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function dae(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(dae,"isHexCode");function fae(e){return 48<=e&&e<=55}ie(fae,"isOctCode");function hae(e){return 48<=e&&e<=57}ie(hae,"isDecCode");function pae(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!dae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!fae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!hae(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(pae,"resolveYamlInteger");function mae(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(mae,"constructYamlInteger");function gae(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!zi.isNegativeZero(e)}ie(gae,"isInteger");var NXe=new Fa("tag:yaml.org,2002:int",{kind:"scalar",resolve:pae,construct:mae,predicate:gae,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),MXe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function yae(e){return!(e===null||!MXe.test(e)||e[e.length-1]==="_")}ie(yae,"resolveYamlFloat");function bae(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(bae,"constructYamlFloat");var IXe=/^[-+]?[0-9]+e/;function vae(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(zi.isNegativeZero(e))return"-0.0";return n=e.toString(10),IXe.test(n)?n.replace("e",".e"):n}ie(vae,"representYamlFloat");function xae(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||zi.isNegativeZero(e))}ie(xae,"isFloat");var jXe=new Fa("tag:yaml.org,2002:float",{kind:"scalar",resolve:yae,construct:bae,predicate:xae,represent:vae,defaultStyle:"lowercase"}),wae=TXe.extend({implicit:[AXe,RXe,NXe,jXe]}),PXe=wae,_ae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Sae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Cae(e){return e===null?!1:_ae.exec(e)!==null||Sae.exec(e)!==null}ie(Cae,"resolveYamlTimestamp");function kae(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=_ae.exec(e),t===null&&(t=Sae.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(kae,"constructYamlTimestamp");function Eae(e){return e.toISOString()}ie(Eae,"representYamlTimestamp");var OXe=new Fa("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Cae,construct:kae,instanceOf:Date,represent:Eae});function Tae(e){return e==="<<"||e===null}ie(Tae,"resolveYamlMerge");var DXe=new Fa("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Tae}),v5=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Aae(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=v5;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(Aae,"resolveYamlBinary");function Rae(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=v5,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(Rae,"constructYamlBinary");function Nae(e){var t="",n=0,r,s,i=e.length,a=v5;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(Nae,"representYamlBinary");function Mae(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(Mae,"isBinary");var FXe=new Fa("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Aae,construct:Rae,predicate:Mae,represent:Nae}),LXe=Object.prototype.hasOwnProperty,BXe=Object.prototype.toString;function Iae(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,BXe.call(s)!=="[object Object]")return!1;for(i in s)if(LXe.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(Iae,"resolveYamlOmap");function jae(e){return e!==null?e:[]}ie(jae,"constructYamlOmap");var $Xe=new Fa("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Iae,construct:jae}),zXe=Object.prototype.toString;function Pae(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],zXe.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(Pae,"resolveYamlPairs");function Oae(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie(Oae,"constructYamlPairs");var UXe=new Fa("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Pae,construct:Oae}),qXe=Object.prototype.hasOwnProperty;function Dae(e){if(e===null)return!0;var t,n=e;for(t in n)if(qXe.call(n,t)&&n[t]!==null)return!1;return!0}ie(Dae,"resolveYamlSet");function Fae(e){return e!==null?e:{}}ie(Fae,"constructYamlSet");var VXe=new Fa("tag:yaml.org,2002:set",{kind:"mapping",resolve:Dae,construct:Fae}),Lae=PXe.extend({implicit:[OXe,DXe],explicit:[FXe,$Xe,UXe,VXe]}),Ph=Object.prototype.hasOwnProperty,Ok=1,Bae=2,$ae=3,Dk=4,E3=1,WXe=2,SV=3,HXe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,GXe=/[\x85\u2028\u2029]/,KXe=/[,\[\]\{\}]/,zae=/^(?:!|!!|![a-z\-]+!)$/i,Uae=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function H4(e){return Object.prototype.toString.call(e)}ie(H4,"_class");function kc(e){return e===10||e===13}ie(kc,"is_EOL");function ph(e){return e===9||e===32}ie(ph,"is_WHITE_SPACE");function eo(e){return e===9||e===32||e===10||e===13}ie(eo,"is_WS_OR_EOL");function am(e){return e===44||e===91||e===93||e===123||e===125}ie(am,"is_FLOW_INDICATOR");function qae(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(qae,"fromHexCode");function Vae(e){return e===120?2:e===117?4:e===85?8:0}ie(Vae,"escapedHexLen");function Wae(e){return 48<=e&&e<=57?e-48:-1}ie(Wae,"fromDecimalCode");function G4(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}ie(G4,"simpleEscapeSequence");function Hae(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(Hae,"charFromCodepoint");var Gae=new Array(256),Kae=new Array(256);for(qp=0;qp<256;qp++)Gae[qp]=G4(qp)?1:0,Kae[qp]=G4(qp);var qp;function Yae(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Lae,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(Yae,"State$1");function x5(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=xXe(n),new Co(t,n)}ie(x5,"generateError");function Pn(e,t){throw x5(e,t)}ie(Pn,"throwError");function Qw(e,t){e.onWarning&&e.onWarning.call(null,x5(e,t))}ie(Qw,"throwWarning");var CV={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&Pn(t,"duplication of %YAML directive"),r.length!==1&&Pn(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&Pn(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&Pn(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&Qw(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&Pn(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],zae.test(s)||Pn(t,"ill-formed tag handle (first argument) of the TAG directive"),Ph.call(t.tagMap,s)&&Pn(t,'there is a previously declared suffix for "'+s+'" tag handle'),Uae.test(i)||Pn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Pn(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function zd(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||Pn(e,"expected valid JSON character");else HXe.test(o)&&Pn(e,"the stream contains non-printable characters");e.result+=o}}ie(zd,"captureSegment");function K4(e,t,n,r){var s,i,a,o;for(zi.isObject(n)||Pn(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],Ph.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(K4,"mergeMappings");function om(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&Pn(e,"nested arrays are not supported inside keys"),typeof s=="object"&&H4(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&H4(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)K4(e,t,i[c],n);else K4(e,t,i,n);else!e.json&&!Ph.call(n,s)&&Ph.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Pn(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(om,"storeMappingPair");function QT(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Pn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(QT,"readLineBreak");function yi(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;ph(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(kc(s))for(QT(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&Qw(e,"deficient indentation"),r}ie(yi,"skipSeparationSpace");function u_(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||eo(n)))}ie(u_,"testDocumentSeparator");function eA(e,t){t===1?e.result+=" ":t>1&&(e.result+=zi.repeat(`
`,t-1))}ie(eA,"writeFoldedLines");function Zae(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,m;if(m=e.input.charCodeAt(e.position),eo(m)||am(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(s=e.input.charCodeAt(e.position+1),eo(s)||n&&am(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;m!==0;){if(m===58){if(s=e.input.charCodeAt(e.position+1),eo(s)||n&&am(s))break}else if(m===35){if(r=e.input.charCodeAt(e.position-1),eo(r))break}else{if(e.position===e.lineStart&&u_(e)||n&&am(m))break;if(kc(m))if(l=e.line,c=e.lineStart,u=e.lineIndent,yi(e,!1,-1),e.lineIndent>=t){o=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(zd(e,i,a,!1),eA(e,e.line-l),i=a=e.position,o=!1),ph(m)||(a=e.position+1),m=e.input.charCodeAt(++e.position)}return zd(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(Zae,"readPlainScalar");function Xae(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(zd(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else kc(n)?(zd(e,r,s,!0),eA(e,yi(e,!1,t)),r=s=e.position):e.position===e.lineStart&&u_(e)?Pn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);Pn(e,"unexpected end of the stream within a single quoted scalar")}ie(Xae,"readSingleQuotedScalar");function Jae(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return zd(e,n,e.position,!0),e.position++,!0;if(o===92){if(zd(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),kc(o))yi(e,!1,t);else if(o<256&&Gae[o])e.result+=Kae[o],e.position++;else if((a=Vae(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=qae(o))>=0?i=(i<<4)+a:Pn(e,"expected hexadecimal character");e.result+=Hae(i),e.position++}else Pn(e,"unknown escape sequence");n=r=e.position}else kc(o)?(zd(e,n,r,!0),eA(e,yi(e,!1,t)),n=r=e.position):e.position===e.lineStart&&u_(e)?Pn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Pn(e,"unexpected end of the stream within a double quoted scalar")}ie(Jae,"readDoubleQuotedScalar");function Qae(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,m,y=Object.create(null),b,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,m=!1,o=[];else if(w===123)u=125,m=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(yi(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=o,!0;n?w===44&&Pn(e,"expected the node content, but found ','"):Pn(e,"missed comma between flow collection entries"),v=b=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),eo(c)&&(d=h=!0,e.position++,yi(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,jm(e,t,Ok,!1,!0),v=e.tag,b=e.result,yi(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),yi(e,!0,t),jm(e,t,Ok,!1,!0),x=e.result),m?om(e,o,y,v,b,x,r,s,i):d?o.push(om(e,null,y,v,b,x,r,s,i)):o.push(b),yi(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}Pn(e,"unexpected end of the stream within a flow collection")}ie(Qae,"readFlowCollection");function eoe(e,t){var n,r,s=E3,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)E3===s?s=d===43?SV:WXe:Pn(e,"repeat of a chomping mode identifier");else if((u=Wae(d))>=0)u===0?Pn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Pn(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(ph(d)){do d=e.input.charCodeAt(++e.position);while(ph(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!kc(d)&&d!==0)}for(;d!==0;){for(QT(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),kc(d)){l++;continue}if(e.lineIndent<o){s===SV?e.result+=zi.repeat(`
`,i?1+l:l):s===E3&&i&&(e.result+=`
`);break}for(r?ph(d)?(c=!0,e.result+=zi.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=zi.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=zi.repeat(`
`,l):e.result+=zi.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!kc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);zd(e,n,e.position,!1)}return!0}ie(eoe,"readBlockScalar");function Y4(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Pn(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!eo(a))));){if(o=!0,e.position++,yi(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,jm(e,t,$ae,!1,!0),i.push(e.result),yi(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)Pn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(Y4,"readBlockSequence");function toe(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),m=null,y=null,b=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Pn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&eo(r))w===63?(v&&(om(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):Pn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!jm(e,n,Bae,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);ph(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),eo(w)||Pn(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(om(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!1,s=!1,m=e.tag,y=e.result;else if(x)Pn(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)Pn(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),jm(e,t,Dk,!0,s)&&(v?y=e.result:b=e.result),v||(om(e,d,h,m,y,b,a,o,l),m=y=b=null),yi(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)Pn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&om(e,d,h,m,y,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie(toe,"readBlockMapping");function noe(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&Pn(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Pn(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!eo(a);)a===33&&(r?Pn(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),zae.test(s)||Pn(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),KXe.test(i)&&Pn(e,"tag suffix cannot contain flow indicator characters")}i&&!Uae.test(i)&&Pn(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Pn(e,"tag name is malformed: "+i)}return n?e.tag=i:Ph.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:Pn(e,'undeclared tag handle "'+s+'"'),!0}ie(noe,"readTagProperty");function roe(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Pn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!eo(n)&&!am(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Pn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(roe,"readAnchorProperty");function soe(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!eo(r)&&!am(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Pn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Ph.call(e.anchorMap,n)||Pn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],yi(e,!0,-1),!0}ie(soe,"readAlias");function jm(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,m,y,b,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=Dk===n||$ae===n,r&&yi(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;noe(e)||roe(e);)yi(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||Dk===n)&&(Ok===n||Bae===n?b=t:b=t+1,v=e.position-e.lineStart,l===1?o&&(Y4(e,v)||toe(e,v,b))||Qae(e,b)?u=!0:(a&&eoe(e,b)||Xae(e,b)||Jae(e,b)?u=!0:soe(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&Pn(e,"alias node should not have any properties")):Zae(e,b,Ok===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&Y4(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Pn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Ph.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,m=e.typeMap.multi[e.kind||"fallback"],d=0,h=m.length;d<h;d+=1)if(e.tag.slice(0,m[d].tag.length)===m[d].tag){y=m[d];break}y||Pn(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&Pn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Pn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(jm,"composeNode");function ioe(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(yi(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!eo(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&Pn(e,"directive name must not be less than one character in length");a!==0;){for(;ph(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!kc(a));break}if(kc(a))break;for(n=e.position;a!==0&&!eo(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&QT(e),Ph.call(CV,r)?CV[r](e,r,s):Qw(e,'unknown document directive "'+r+'"')}if(yi(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,yi(e,!0,-1)):i&&Pn(e,"directives end mark is expected"),jm(e,e.lineIndent-1,Dk,!1,!0),yi(e,!0,-1),e.checkLineBreaks&&GXe.test(e.input.slice(t,e.position))&&Qw(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&u_(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,yi(e,!0,-1));return}if(e.position<e.length-1)Pn(e,"end of the stream or a document separator is expected");else return}ie(ioe,"readDocument");function w5(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new Yae(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Pn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)ioe(n);return n.documents}ie(w5,"loadDocuments");function YXe(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=w5(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(YXe,"loadAll$1");function aoe(e,t){var n=w5(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Co("expected a single document in the stream, but found more")}}ie(aoe,"load$1");var ZXe=aoe,XXe={load:ZXe},ooe=Object.prototype.toString,loe=Object.prototype.hasOwnProperty,_5=65279,JXe=9,e1=10,QXe=13,eJe=32,tJe=33,nJe=34,Z4=35,rJe=37,sJe=38,iJe=39,aJe=42,coe=44,oJe=45,Fk=58,lJe=61,cJe=62,uJe=63,dJe=64,uoe=91,doe=93,fJe=96,foe=123,hJe=124,hoe=125,Ua={};Ua[0]="\\0";Ua[7]="\\a";Ua[8]="\\b";Ua[9]="\\t";Ua[10]="\\n";Ua[11]="\\v";Ua[12]="\\f";Ua[13]="\\r";Ua[27]="\\e";Ua[34]='\\"';Ua[92]="\\\\";Ua[133]="\\N";Ua[160]="\\_";Ua[8232]="\\L";Ua[8233]="\\P";var pJe=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],mJe=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function poe(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&loe.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(poe,"compileStyleMap");function moe(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Co("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+zi.repeat("0",r-t.length)+t}ie(moe,"encodeHex");var gJe=1,t1=2;function goe(e){this.schema=e.schema||Lae,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=zi.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=poe(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?t1:gJe,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(goe,"State");function X4(e,t){for(var n=zi.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(X4,"indentString");function Lk(e,t){return`
`+zi.repeat(" ",e.indent*t)}ie(Lk,"generateNextLine");function yoe(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(yoe,"testImplicitResolving");function n1(e){return e===eJe||e===JXe}ie(n1,"isWhitespace");function My(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==_5||65536<=e&&e<=1114111}ie(My,"isPrintable");function J4(e){return My(e)&&e!==_5&&e!==QXe&&e!==e1}ie(J4,"isNsCharOrWhitespace");function Q4(e,t,n){var r=J4(e),s=r&&!n1(e);return(n?r:r&&e!==coe&&e!==uoe&&e!==doe&&e!==foe&&e!==hoe)&&e!==Z4&&!(t===Fk&&!s)||J4(t)&&!n1(t)&&e===Z4||t===Fk&&s}ie(Q4,"isPlainSafe");function boe(e){return My(e)&&e!==_5&&!n1(e)&&e!==oJe&&e!==uJe&&e!==Fk&&e!==coe&&e!==uoe&&e!==doe&&e!==foe&&e!==hoe&&e!==Z4&&e!==sJe&&e!==aJe&&e!==tJe&&e!==hJe&&e!==lJe&&e!==cJe&&e!==iJe&&e!==nJe&&e!==rJe&&e!==dJe&&e!==fJe}ie(boe,"isPlainSafeFirst");function voe(e){return!n1(e)&&e!==Fk}ie(voe,"isPlainSafeLast");function T0(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(T0,"codePointAt");function S5(e){var t=/^\n* /;return t.test(e)}ie(S5,"needIndentIndicator");var xoe=1,eP=2,woe=3,_oe=4,f0=5;function Soe(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,m=r!==-1,y=-1,b=boe(T0(e,0))&&voe(T0(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=T0(e,l),!My(c))return f0;b=b&&Q4(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=T0(e,l),c===e1)d=!0,m&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!My(c))return f0;b=b&&Q4(c,u,o),u=c}h=h||m&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!s(e)?xoe:i===t1?f0:eP:n>9&&S5(e)?f0:a?i===t1?f0:eP:h?_oe:woe}ie(Soe,"chooseScalarStyle");function Coe(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===t1?'""':"''";if(!e.noCompatMode&&(pJe.indexOf(t)!==-1||mJe.test(t)))return e.quotingType===t1?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return yoe(e,c)}switch(ie(l,"testAmbiguity"),Soe(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case xoe:return t;case eP:return"'"+t.replace(/'/g,"''")+"'";case woe:return"|"+tP(t,e.indent)+nP(X4(t,i));case _oe:return">"+tP(t,e.indent)+nP(X4(koe(t,a),i));case f0:return'"'+Eoe(t)+'"';default:throw new Co("impossible error: invalid scalar style")}}()}ie(Coe,"writeScalar");function tP(e,t){var n=S5(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(tP,"blockHeader");function nP(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(nP,"dropEndingNewline");function koe(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,rP(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+rP(l,t),s=i}return r}ie(koe,"foldString");function rP(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(rP,"foldLine");function Eoe(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=T0(e,s),r=Ua[n],!r&&My(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||moe(n);return t}ie(Eoe,"escapeString");function Toe(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(Fu(e,t,o,!1,!1)||typeof o>"u"&&Fu(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(Toe,"writeFlowSequence");function sP(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(Fu(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&Fu(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=Lk(e,t)),e.dump&&e1===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(sP,"writeBlockSequence");function Aoe(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),Fu(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Fu(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(Aoe,"writeFlowMapping");function Roe(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Co("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=Lk(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),Fu(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&e1===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=Lk(e,t)),Fu(e,t+1,u,!0,d)&&(e.dump&&e1===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie(Roe,"writeBlockMapping");function iP(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,ooe.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(loe.call(o.represent,l))r=o.represent[l](t,l);else throw new Co("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(iP,"detectType");function Fu(e,t,n,r,s,i,a){e.tag=null,e.dump=n,iP(e,n,!1)||iP(e,n,!0);var o=ooe.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(Roe(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(Aoe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?sP(e,t-1,e.dump,s):sP(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(Toe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&Coe(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Co("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(Fu,"writeNode");function Noe(e,t){var n=[],r=[],s,i;for(Bk(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(Noe,"getDuplicateReferences");function Bk(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)Bk(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)Bk(e[r[s]],t,n)}ie(Bk,"inspectNode");function yJe(e,t){t=t||{};var n=new goe(t);n.noRefs||Noe(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Fu(n,0,r,!0,!0)?n.dump+`
`:""}ie(yJe,"dump$1");function bJe(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(bJe,"renamed");var vJe=wae,xJe=XXe.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var Pl={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function mx(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=Ks(e),t=Ks(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(mx,"calculateDeltaAndAngle");var Ks=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),wJe=ie(e=>({x:ie(function(t,n,r){let s=0;const i=Ks(r[0]).x<Ks(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(Pl,e.arrowTypeStart)){const{angle:m,deltaX:y}=mx(r[0],r[1]);s=Pl[e.arrowTypeStart]*Math.cos(m)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Pl,e.arrowTypeEnd)){const{angle:m,deltaX:y}=mx(r[r.length-1],r[r.length-2]);s=Pl[e.arrowTypeEnd]*Math.cos(m)*(y>=0?1:-1)}const a=Math.abs(Ks(t).x-Ks(r[r.length-1]).x),o=Math.abs(Ks(t).y-Ks(r[r.length-1]).y),l=Math.abs(Ks(t).x-Ks(r[0]).x),c=Math.abs(Ks(t).y-Ks(r[0]).y),u=Pl[e.arrowTypeStart],d=Pl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="right"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="right"?-1:1,s+=m}return Ks(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=Ks(r[0]).y<Ks(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(Pl,e.arrowTypeStart)){const{angle:m,deltaY:y}=mx(r[0],r[1]);s=Pl[e.arrowTypeStart]*Math.abs(Math.sin(m))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Pl,e.arrowTypeEnd)){const{angle:m,deltaY:y}=mx(r[r.length-1],r[r.length-2]);s=Pl[e.arrowTypeEnd]*Math.abs(Math.sin(m))*(y>=0?1:-1)}const a=Math.abs(Ks(t).y-Ks(r[r.length-1]).y),o=Math.abs(Ks(t).x-Ks(r[r.length-1]).x),l=Math.abs(Ks(t).y-Ks(r[0]).y),c=Math.abs(Ks(t).x-Ks(r[0]).x),u=Pl[e.arrowTypeStart],d=Pl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="up"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="up"?-1:1,s+=m}return Ks(t).y+s},"y")}),"getLineFunctionsWithOffset"),C5=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const _Je=Object.freeze({left:0,top:0,width:16,height:16}),$k=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Moe=Object.freeze({..._Je,...$k}),SJe=Object.freeze({...Moe,body:"",hidden:!1}),CJe=Object.freeze({width:null,height:null}),kJe=Object.freeze({...CJe,...$k}),EJe=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return T3(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return T3(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return T3(o,n)?o:null}return null},T3=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function TJe(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function kV(e,t){const n=TJe(e,t);for(const r in SJe)r in $k?r in e&&!(r in n)&&(n[r]=$k[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function AJe(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function EV(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=kV(r[o]||s[o],i)}return a(t),n.forEach(a),kV(e,i)}function RJe(e,t){if(e.icons[t])return EV(e,t,[]);const n=AJe(e,[t])[t];return n?EV(e,t,n):null}const NJe=/(-?[0-9.]*[0-9]+[0-9.]*)/g,MJe=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function TV(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(NJe);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=MJe.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function IJe(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function jJe(e,t){return e?"<defs>"+e+"</defs>"+t:t}function PJe(e,t,n){const r=IJe(e);return jJe(r.defs,t+r.content+n)}const OJe=e=>e==="unset"||e==="undefined"||e==="none";function DJe(e,t){const n={...Moe,...e},r={...kJe,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(b=>{const v=[],x=b.hFlip,w=b.vFlip;let S=b.rotate;x?w?S+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let k;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:k=s.height/2+s.top,v.unshift("rotate(90 "+k.toString()+" "+k.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:k=s.width/2+s.left,v.unshift("rotate(-90 "+k.toString()+" "+k.toString()+")");break}S%2===1&&(s.left!==s.top&&(k=s.left,s.left=s.top,s.top=k),s.width!==s.height&&(k=s.width,s.width=s.height,s.height=k)),v.length&&(i=PJe(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=TV(d,l/c)):(u=a==="auto"?l:a,d=o===null?TV(u,c/l):o==="auto"?c:o);const h={},m=(b,v)=>{OJe(v)||(h[b]=v.toString())};m("width",u),m("height",d);const y=[s.left,s.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:i}}const FJe=/\sid="(\S+)"/g,LJe="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let BJe=0;function $Je(e,t=LJe){const n=[];let r;for(;r=FJe.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(BJe++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function zJe(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var UJe={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},aP=new Map,Ioe=new Map,qJe=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(zt.debug("Registering icon pack:",t.name),"loader"in t)Ioe.set(t.name,t.loader);else if("icons"in t)aP.set(t.name,t.icons);else throw zt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),VJe=ie(async(e,t)=>{const n=EJe(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=aP.get(r);if(!s){const a=Ioe.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},aP.set(r,s)}catch(o){throw zt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=RJe(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),tA=ie(async(e,t)=>{let n;try{n=await VJe(e,t==null?void 0:t.fallbackPrefix)}catch(i){zt.error(i),n=UJe}const r=DJe(n,t);return zJe($Je(r.body),r.attributes)},"getIconSVG"),Hv={},Li={},AV;function WJe(){return AV||(AV=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.BLANK_URL=Li.relativeFirstCharacters=Li.whitespaceEscapeCharsRegex=Li.urlSchemeRegex=Li.ctrlCharactersRegex=Li.htmlCtrlEntityRegex=Li.htmlEntitiesRegex=Li.invalidProtocolRegex=void 0,Li.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,Li.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,Li.htmlCtrlEntityRegex=/&(newline|tab);/gi,Li.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,Li.urlSchemeRegex=/^.+(:|&colon;)/gim,Li.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,Li.relativeFirstCharacters=[".","/"],Li.BLANK_URL="about:blank"),Li}var RV;function HJe(){if(RV)return Hv;RV=1,Object.defineProperty(Hv,"__esModule",{value:!0}),Hv.sanitizeUrl=void 0;var e=WJe();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var m=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return m;if(h==="http:"||h==="https:"){if(!r(m))return e.BLANK_URL;var y=new URL(m);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return m}return Hv.sanitizeUrl=i,Hv}var GJe=HJe(),KJe={value:()=>{}};function joe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new K2(n)}function K2(e){this._=e}function YJe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}K2.prototype=joe.prototype={constructor:K2,on:function(e,t){var n=this._,r=YJe(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=ZJe(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=NV(n[s],e.name,t);else if(t==null)for(s in n)n[s]=NV(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new K2(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function ZJe(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function NV(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=KJe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var oP="http://www.w3.org/1999/xhtml";const MV={svg:"http://www.w3.org/2000/svg",xhtml:oP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function nA(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),MV.hasOwnProperty(t)?{space:MV[t],local:e}:e}function XJe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===oP&&t.documentElement.namespaceURI===oP?t.createElement(e):t.createElementNS(n,e)}}function JJe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Poe(e){var t=nA(e);return(t.local?JJe:XJe)(t)}function QJe(){}function k5(e){return e==null?QJe:function(){return this.querySelector(e)}}function eQe(e){typeof e!="function"&&(e=k5(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new gl(r,this._parents)}function tQe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function nQe(){return[]}function Ooe(e){return e==null?nQe:function(){return this.querySelectorAll(e)}}function rQe(e){return function(){return tQe(e.apply(this,arguments))}}function sQe(e){typeof e=="function"?e=rQe(e):e=Ooe(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new gl(r,s)}function Doe(e){return function(){return this.matches(e)}}function Foe(e){return function(t){return t.matches(e)}}var iQe=Array.prototype.find;function aQe(e){return function(){return iQe.call(this.children,e)}}function oQe(){return this.firstElementChild}function lQe(e){return this.select(e==null?oQe:aQe(typeof e=="function"?e:Foe(e)))}var cQe=Array.prototype.filter;function uQe(){return Array.from(this.children)}function dQe(e){return function(){return cQe.call(this.children,e)}}function fQe(e){return this.selectAll(e==null?uQe:dQe(typeof e=="function"?e:Foe(e)))}function hQe(e){typeof e!="function"&&(e=Doe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new gl(r,this._parents)}function Loe(e){return new Array(e.length)}function pQe(){return new gl(this._enter||this._groups.map(Loe),this._parents)}function zk(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}zk.prototype={constructor:zk,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function mQe(e){return function(){return e}}function gQe(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new zk(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function yQe(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),m;for(o=0;o<u;++o)(l=t[o])&&(h[o]=m=a.call(l,l.__data__,o,t)+"",c.has(m)?s[o]=l:c.set(m,l));for(o=0;o<d;++o)m=a.call(e,i[o],o,i)+"",(l=c.get(m))?(r[o]=l,l.__data__=i[o],c.delete(m)):n[o]=new zk(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function bQe(e){return e.__data__}function vQe(e,t){if(!arguments.length)return Array.from(this,bQe);var n=t?yQe:gQe,r=this._parents,s=this._groups;typeof e!="function"&&(e=mQe(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,m=xQe(e.call(u,u&&u.__data__,c,r)),y=m.length,b=o[c]=new Array(y),v=a[c]=new Array(y),x=l[c]=new Array(h);n(u,d,b,v,x,m,t);for(var w=0,S=0,k,C;w<y;++w)if(k=b[w]){for(w>=S&&(S=w+1);!(C=v[S])&&++S<y;);k._next=C||null}}return a=new gl(a,r),a._enter=o,a._exit=l,a}function xQe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wQe(){return new gl(this._exit||this._groups.map(Loe),this._parents)}function _Qe(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function SQe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),m,y=0;y<d;++y)(m=c[y]||u[y])&&(h[y]=m);for(;l<s;++l)o[l]=n[l];return new gl(o,this._parents)}function CQe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function kQe(e){e||(e=EQe);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new gl(s,this._parents).order()}function EQe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function TQe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function AQe(){return Array.from(this)}function RQe(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function NQe(){let e=0;for(const t of this)++e;return e}function MQe(){return!this.node()}function IQe(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function jQe(e){return function(){this.removeAttribute(e)}}function PQe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function OQe(e,t){return function(){this.setAttribute(e,t)}}function DQe(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function FQe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function LQe(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function BQe(e,t){var n=nA(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?PQe:jQe:typeof t=="function"?n.local?LQe:FQe:n.local?DQe:OQe)(n,t))}function Boe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $Qe(e){return function(){this.style.removeProperty(e)}}function zQe(e,t,n){return function(){this.style.setProperty(e,t,n)}}function UQe(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function qQe(e,t,n){return arguments.length>1?this.each((t==null?$Qe:typeof t=="function"?UQe:zQe)(e,t,n??"")):Iy(this.node(),e)}function Iy(e,t){return e.style.getPropertyValue(t)||Boe(e).getComputedStyle(e,null).getPropertyValue(t)}function VQe(e){return function(){delete this[e]}}function WQe(e,t){return function(){this[e]=t}}function HQe(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function GQe(e,t){return arguments.length>1?this.each((t==null?VQe:typeof t=="function"?HQe:WQe)(e,t)):this.node()[e]}function $oe(e){return e.trim().split(/^|\s+/)}function E5(e){return e.classList||new zoe(e)}function zoe(e){this._node=e,this._names=$oe(e.getAttribute("class")||"")}zoe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Uoe(e,t){for(var n=E5(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function qoe(e,t){for(var n=E5(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function KQe(e){return function(){Uoe(this,e)}}function YQe(e){return function(){qoe(this,e)}}function ZQe(e,t){return function(){(t.apply(this,arguments)?Uoe:qoe)(this,e)}}function XQe(e,t){var n=$oe(e+"");if(arguments.length<2){for(var r=E5(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?ZQe:t?KQe:YQe)(n,t))}function JQe(){this.textContent=""}function QQe(e){return function(){this.textContent=e}}function eet(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function tet(e){return arguments.length?this.each(e==null?JQe:(typeof e=="function"?eet:QQe)(e)):this.node().textContent}function net(){this.innerHTML=""}function ret(e){return function(){this.innerHTML=e}}function set(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function iet(e){return arguments.length?this.each(e==null?net:(typeof e=="function"?set:ret)(e)):this.node().innerHTML}function aet(){this.nextSibling&&this.parentNode.appendChild(this)}function oet(){return this.each(aet)}function cet(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uet(){return this.each(cet)}function det(e){var t=typeof e=="function"?e:Poe(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function fet(){return null}function het(e,t){var n=typeof e=="function"?e:Poe(e),r=t==null?fet:typeof t=="function"?t:k5(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function pet(){var e=this.parentNode;e&&e.removeChild(this)}function met(){return this.each(pet)}function get(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yet(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bet(e){return this.select(e?yet:get)}function vet(e){return arguments.length?this.property("__data__",e):this.node().__data__}function xet(e){return function(t){e.call(this,t,this.__data__)}}function wet(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function _et(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Cet(e,t,n){return function(){var r=this.__on,s,i=xet(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function ket(e,t,n){var r=wet(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?Cet:_et,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function Voe(e,t,n){var r=Boe(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function Eet(e,t){return function(){return Voe(this,e,t)}}function Tet(e,t){return function(){return Voe(this,e,t.apply(this,arguments))}}function Aet(e,t){return this.each((typeof t=="function"?Tet:Eet)(e,t))}function*Ret(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var Woe=[null];function gl(e,t){this._groups=e,this._parents=t}function d_(){return new gl([[document.documentElement]],Woe)}function Net(){return this}gl.prototype=d_.prototype={constructor:gl,select:eQe,selectAll:sQe,selectChild:lQe,selectChildren:fQe,filter:hQe,data:vQe,enter:pQe,exit:wQe,join:_Qe,merge:SQe,selection:Net,order:CQe,sort:kQe,call:TQe,nodes:AQe,node:RQe,size:NQe,empty:MQe,each:IQe,attr:BQe,style:qQe,property:GQe,classed:XQe,text:tet,html:iet,raise:oet,lower:uet,append:det,insert:het,remove:met,clone:bet,datum:vet,on:ket,dispatch:Aet,[Symbol.iterator]:Ret};function Kr(e){return typeof e=="string"?new gl([[document.querySelector(e)]],[document.documentElement]):new gl([[e]],Woe)}function T5(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Hoe(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function f_(){}var r1=.7,Uk=1/r1,L0="\\s*([+-]?\\d+)\\s*",s1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Tu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Met=/^#([0-9a-f]{3,8})$/,Iet=new RegExp(`^rgb\\(${L0},${L0},${L0}\\)$`),jet=new RegExp(`^rgb\\(${Tu},${Tu},${Tu}\\)$`),Pet=new RegExp(`^rgba\\(${L0},${L0},${L0},${s1}\\)$`),Oet=new RegExp(`^rgba\\(${Tu},${Tu},${Tu},${s1}\\)$`),Det=new RegExp(`^hsl\\(${s1},${Tu},${Tu}\\)$`),Fet=new RegExp(`^hsla\\(${s1},${Tu},${Tu},${s1}\\)$`),IV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};T5(f_,i1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:jV,formatHex:jV,formatHex8:Let,formatHsl:Bet,formatRgb:PV,toString:PV});function jV(){return this.rgb().formatHex()}function Let(){return this.rgb().formatHex8()}function Bet(){return Goe(this).formatHsl()}function PV(){return this.rgb().formatRgb()}function i1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Met.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?OV(t):n===3?new To(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?y2(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?y2(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Iet.exec(e))?new To(t[1],t[2],t[3],1):(t=jet.exec(e))?new To(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Pet.exec(e))?y2(t[1],t[2],t[3],t[4]):(t=Oet.exec(e))?y2(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Det.exec(e))?LV(t[1],t[2]/100,t[3]/100,1):(t=Fet.exec(e))?LV(t[1],t[2]/100,t[3]/100,t[4]):IV.hasOwnProperty(e)?OV(IV[e]):e==="transparent"?new To(NaN,NaN,NaN,0):null}function OV(e){return new To(e>>16&255,e>>8&255,e&255,1)}function y2(e,t,n,r){return r<=0&&(e=t=n=NaN),new To(e,t,n,r)}function $et(e){return e instanceof f_||(e=i1(e)),e?(e=e.rgb(),new To(e.r,e.g,e.b,e.opacity)):new To}function lP(e,t,n,r){return arguments.length===1?$et(e):new To(e,t,n,r??1)}function To(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}T5(To,lP,Hoe(f_,{brighter(e){return e=e==null?Uk:Math.pow(Uk,e),new To(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?r1:Math.pow(r1,e),new To(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new To(mm(this.r),mm(this.g),mm(this.b),qk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:DV,formatHex:DV,formatHex8:zet,formatRgb:FV,toString:FV}));function DV(){return`#${lm(this.r)}${lm(this.g)}${lm(this.b)}`}function zet(){return`#${lm(this.r)}${lm(this.g)}${lm(this.b)}${lm((isNaN(this.opacity)?1:this.opacity)*255)}`}function FV(){const e=qk(this.opacity);return`${e===1?"rgb(":"rgba("}${mm(this.r)}, ${mm(this.g)}, ${mm(this.b)}${e===1?")":`, ${e})`}`}function qk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function mm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function lm(e){return e=mm(e),(e<16?"0":"")+e.toString(16)}function LV(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new gc(e,t,n,r)}function Goe(e){if(e instanceof gc)return new gc(e.h,e.s,e.l,e.opacity);if(e instanceof f_||(e=i1(e)),!e)return new gc;if(e instanceof gc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new gc(a,o,l,e.opacity)}function Uet(e,t,n,r){return arguments.length===1?Goe(e):new gc(e,t,n,r??1)}function gc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}T5(gc,Uet,Hoe(f_,{brighter(e){return e=e==null?Uk:Math.pow(Uk,e),new gc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?r1:Math.pow(r1,e),new gc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new To(A3(e>=240?e-240:e+120,s,r),A3(e,s,r),A3(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new gc(BV(this.h),b2(this.s),b2(this.l),qk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=qk(this.opacity);return`${e===1?"hsl(":"hsla("}${BV(this.h)}, ${b2(this.s)*100}%, ${b2(this.l)*100}%${e===1?")":`, ${e})`}`}}));function BV(e){return e=(e||0)%360,e<0?e+360:e}function b2(e){return Math.max(0,Math.min(1,e||0))}function A3(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const A5=e=>()=>e;function Koe(e,t){return function(n){return e+n*t}}function qet(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function kdt(e,t){var n=t-e;return n?Koe(e,n>180||n<-180?n-360*Math.round(n/360):n):A5(isNaN(e)?t:e)}function Vet(e){return(e=+e)==1?Yoe:function(t,n){return n-t?qet(t,n,e):A5(isNaN(t)?n:t)}}function Yoe(e,t){var n=t-e;return n?Koe(e,n):A5(isNaN(e)?t:e)}const $V=function e(t){var n=Vet(t);function r(s,i){var a=n((s=lP(s)).r,(i=lP(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=Yoe(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function ah(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var cP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,R3=new RegExp(cP.source,"g");function Wet(e){return function(){return e}}function Het(e){return function(t){return e(t)+""}}function Get(e,t){var n=cP.lastIndex=R3.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=cP.exec(e))&&(s=R3.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:ah(r,s)})),n=R3.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?Het(l[0].x):Wet(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var zV=180/Math.PI,uP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Zoe(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*zV,skewX:Math.atan(l)*zV,scaleX:a,scaleY:o}}var v2;function Ket(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?uP:Zoe(t.a,t.b,t.c,t.d,t.e,t.f)}function Yet(e){return e==null||(v2||(v2=document.createElementNS("http://www.w3.org/2000/svg","g")),v2.setAttribute("transform",e),!(e=v2.transform.baseVal.consolidate()))?uP:(e=e.matrix,Zoe(e.a,e.b,e.c,e.d,e.e,e.f))}function Xoe(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push("translate(",null,t,null,n);y.push({i:b-4,x:ah(c,d)},{i:b-2,x:ah(u,h)})}else(d||h)&&m.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:ah(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:ah(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push(s(m)+"scale(",null,",",null,")");y.push({i:b-4,x:ah(c,d)},{i:b-2,x:ah(u,h)})}else(d!==1||h!==1)&&m.push(s(m)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(m){for(var y=-1,b=h.length,v;++y<b;)d[(v=h[y]).i]=v.x(m);return d.join("")}}}var Zet=Xoe(Ket,"px, ","px)","deg)"),Xet=Xoe(Yet,", ",")",")"),jy=0,gx=0,Gv=0,Joe=1e3,Vk,yx,Wk=0,Pm=0,rA=0,a1=typeof performance=="object"&&performance.now?performance:Date,Qoe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function R5(){return Pm||(Qoe(Jet),Pm=a1.now()+rA)}function Jet(){Pm=0}function Hk(){this._call=this._time=this._next=null}Hk.prototype=ele.prototype={constructor:Hk,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?R5():+n)+(t==null?0:+t),!this._next&&yx!==this&&(yx?yx._next=this:Vk=this,yx=this),this._call=e,this._time=n,dP()},stop:function(){this._call&&(this._call=null,this._time=1/0,dP())}};function ele(e,t,n){var r=new Hk;return r.restart(e,t,n),r}function Qet(){R5(),++jy;for(var e=Vk,t;e;)(t=Pm-e._time)>=0&&e._call.call(void 0,t),e=e._next;--jy}function UV(){Pm=(Wk=a1.now())+rA,jy=gx=0;try{Qet()}finally{jy=0,ttt(),Pm=0}}function ett(){var e=a1.now(),t=e-Wk;t>Joe&&(rA-=t,Wk=e)}function ttt(){for(var e,t=Vk,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Vk=n);yx=e,dP(r)}function dP(e){if(!jy){gx&&(gx=clearTimeout(gx));var t=e-Pm;t>24?(e<1/0&&(gx=setTimeout(UV,e-a1.now()-rA)),Gv&&(Gv=clearInterval(Gv))):(Gv||(Wk=a1.now(),Gv=setInterval(ett,Joe)),jy=1,Qoe(UV))}}function qV(e,t,n){var r=new Hk;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var ntt=joe("start","end","cancel","interrupt"),rtt=[],tle=0,VV=1,fP=2,Y2=3,WV=4,hP=5,Z2=6;function sA(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;stt(e,n,{name:t,index:r,group:s,on:ntt,tween:rtt,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:tle})}function N5(e,t){var n=qc(e,t);if(n.state>tle)throw new Error("too late; already scheduled");return n}function qu(e,t){var n=qc(e,t);if(n.state>Y2)throw new Error("too late; already running");return n}function qc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function stt(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=ele(i,0,n.time);function i(c){n.state=VV,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,m;if(n.state!==VV)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===Y2)return qV(a);m.state===WV?(m.state=Z2,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=Z2,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(qV(function(){n.state===Y2&&(n.state=WV,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=fP,n.on.call("start",e,e.__data__,n.index,n.group),n.state===fP){for(n.state=Y2,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=m);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=hP,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===hP&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=Z2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function itt(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>fP&&r.state<hP,r.state=Z2,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function att(e){return this.each(function(){itt(this,e)})}function ott(e,t){var n,r;return function(){var s=qu(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function ltt(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=qu(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function ctt(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=qc(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?ott:ltt)(n,e,t))}function M5(e,t,n){var r=e._id;return e.each(function(){var s=qu(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return qc(s,r).value[t]}}function nle(e,t){var n;return(typeof t=="number"?ah:t instanceof i1?$V:(n=i1(t))?(t=n,$V):Get)(e,t)}function utt(e){return function(){this.removeAttribute(e)}}function dtt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ftt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function htt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function ptt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function mtt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function gtt(e,t){var n=nA(e),r=n==="transform"?Xet:nle;return this.attrTween(e,typeof t=="function"?(n.local?mtt:ptt)(n,r,M5(this,"attr."+e,t)):t==null?(n.local?dtt:utt)(n):(n.local?htt:ftt)(n,r,t))}function ytt(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function btt(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function vtt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&btt(e,i)),n}return s._value=t,s}function xtt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&ytt(e,i)),n}return s._value=t,s}function wtt(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=nA(e);return this.tween(n,(r.local?vtt:xtt)(r,t))}function _tt(e,t){return function(){N5(this,e).delay=+t.apply(this,arguments)}}function Stt(e,t){return t=+t,function(){N5(this,e).delay=t}}function Ctt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?_tt:Stt)(t,e)):qc(this.node(),t).delay}function ktt(e,t){return function(){qu(this,e).duration=+t.apply(this,arguments)}}function Ett(e,t){return t=+t,function(){qu(this,e).duration=t}}function Ttt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ktt:Ett)(t,e)):qc(this.node(),t).duration}function Att(e,t){if(typeof t!="function")throw new Error;return function(){qu(this,e).ease=t}}function Rtt(e){var t=this._id;return arguments.length?this.each(Att(t,e)):qc(this.node(),t).ease}function Ntt(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;qu(this,e).ease=n}}function Mtt(e){if(typeof e!="function")throw new Error;return this.each(Ntt(this._id,e))}function Itt(e){typeof e!="function"&&(e=Doe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new Xd(r,this._parents,this._name,this._id)}function jtt(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,m=0;m<u;++m)(h=l[m]||c[m])&&(d[m]=h);for(;o<r;++o)a[o]=t[o];return new Xd(a,this._parents,this._name,this._id)}function Ptt(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Ott(e,t,n){var r,s,i=Ptt(t)?N5:qu;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function Dtt(e,t){var n=this._id;return arguments.length<2?qc(this.node(),n).on.on(e):this.each(Ott(n,e,t))}function Ftt(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Ltt(){return this.on("end.remove",Ftt(this._id))}function Btt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=k5(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,sA(c[h],t,n,h,c,qc(u,n)));return new Xd(i,this._parents,t,n)}function $tt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ooe(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),m,y=qc(u,n),b=0,v=h.length;b<v;++b)(m=h[b])&&sA(m,t,n,b,h,y);i.push(h),a.push(u)}return new Xd(i,a,t,n)}var ztt=d_.prototype.constructor;function Utt(){return new ztt(this._groups,this._parents)}function qtt(e,t){var n,r,s;return function(){var i=Iy(this,e),a=(this.style.removeProperty(e),Iy(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function rle(e){return function(){this.style.removeProperty(e)}}function Vtt(e,t,n){var r,s=n+"",i;return function(){var a=Iy(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function Wtt(e,t,n){var r,s,i;return function(){var a=Iy(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),Iy(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function Htt(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=qu(this,e),c=l.on,u=l.value[i]==null?o||(o=rle(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function Gtt(e,t,n){var r=(e+="")=="transform"?Zet:nle;return t==null?this.styleTween(e,qtt(e,r)).on("end.style."+e,rle(e)):typeof t=="function"?this.styleTween(e,Wtt(e,r,M5(this,"style."+e,t))).each(Htt(this._id,e)):this.styleTween(e,Vtt(e,r,t),n).on("end.style."+e,null)}function Ktt(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Ytt(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&Ktt(e,a,n)),r}return i._value=t,i}function Ztt(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Ytt(e,t,n??""))}function Xtt(e){return function(){this.textContent=e}}function Jtt(e){return function(){var t=e(this);this.textContent=t??""}}function Qtt(e){return this.tween("text",typeof e=="function"?Jtt(M5(this,"text",e)):Xtt(e==null?"":e+""))}function ent(e){return function(t){this.textContent=e.call(this,t)}}function tnt(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&ent(s)),t}return r._value=e,r}function nnt(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,tnt(e))}function rnt(){for(var e=this._name,t=this._id,n=sle(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=qc(l,t);sA(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Xd(r,this._parents,e,n)}function snt(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=qu(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var int=0;function Xd(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function sle(){return++int}var bd=d_.prototype;Xd.prototype={constructor:Xd,select:Btt,selectAll:$tt,selectChild:bd.selectChild,selectChildren:bd.selectChildren,filter:Itt,merge:jtt,selection:Utt,transition:rnt,call:bd.call,nodes:bd.nodes,node:bd.node,size:bd.size,empty:bd.empty,each:bd.each,on:Dtt,attr:gtt,attrTween:wtt,style:Gtt,styleTween:Ztt,text:Qtt,textTween:nnt,remove:Ltt,tween:ctt,delay:Ctt,duration:Ttt,ease:Rtt,easeVarying:Mtt,end:snt,[Symbol.iterator]:bd[Symbol.iterator]};function ant(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ont={time:null,delay:0,duration:250,ease:ant};function lnt(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function cnt(e){var t,n;e instanceof Xd?(t=e._id,e=e._name):(t=sle(),(n=ont).time=R5(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&sA(l,e,t,c,a,n||lnt(l,t));return new Xd(r,this._parents,e,t)}d_.prototype.interrupt=att;d_.prototype.transition=cnt;const pP=Math.PI,mP=2*pP,Hp=1e-6,unt=mP-Hp;function ile(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function dnt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ile;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class fnt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ile:dnt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Hp)if(!(Math.abs(d*l-c*u)>Hp)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,y=s-o,b=l*l+c*c,v=m*m+y*y,x=Math.sqrt(b),w=Math.sqrt(h),S=i*Math.tan((pP-Math.acos((b+h-v)/(2*x*w)))/2),k=S/w,C=S/x;Math.abs(k-1)>Hp&&this._append`L${t+k*u},${n+k*d}`,this._append`A${i},${i},0,0,${+(d*m>u*y)},${this._x1=t+C*l},${this._y1=n+C*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Hp||Math.abs(this._y1-u)>Hp)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%mP+mP),h>unt?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Hp&&this._append`A${r},${r},0,${+(h>=pP)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function a0(e){return function(){return e}}const Edt=Math.abs,Tdt=Math.atan2,Adt=Math.cos,Rdt=Math.max,Ndt=Math.min,Mdt=Math.sin,Idt=Math.sqrt,HV=1e-12,I5=Math.PI,GV=I5/2,jdt=2*I5;function Pdt(e){return e>1?0:e<-1?I5:Math.acos(e)}function Odt(e){return e>=1?GV:e<=-1?-GV:Math.asin(e)}function hnt(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new fnt(t)}function pnt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ale(e){this._context=e}ale.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Gk(e){return new ale(e)}function mnt(e){return e[0]}function gnt(e){return e[1]}function ynt(e,t){var n=a0(!0),r=null,s=Gk,i=null,a=hnt(o);e=typeof e=="function"?e:e===void 0?mnt:a0(e),t=typeof t=="function"?t:t===void 0?gnt:a0(t);function o(l){var c,u=(l=pnt(l)).length,d,h=!1,m;for(r==null&&(i=s(m=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:a0(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:a0(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:a0(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class ole{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function lle(e){return new ole(e,!0)}function cle(e){return new ole(e,!1)}function Oh(){}function Kk(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function iA(e){this._context=e}iA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Kk(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Kk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function X2(e){return new iA(e)}function ule(e){this._context=e}ule.prototype={areaStart:Oh,areaEnd:Oh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Kk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function bnt(e){return new ule(e)}function dle(e){this._context=e}dle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Kk(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vnt(e){return new dle(e)}function fle(e,t){this._basis=new iA(e),this._beta=t}fle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const xnt=function e(t){function n(r){return t===1?new iA(r):new fle(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Yk(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function j5(e,t){this._context=e,this._k=(1-t)/6}j5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Yk(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Yk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const hle=function e(t){function n(r){return new j5(r,t)}return n.tension=function(r){return e(+r)},n}(0);function P5(e,t){this._context=e,this._k=(1-t)/6}P5.prototype={areaStart:Oh,areaEnd:Oh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Yk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const wnt=function e(t){function n(r){return new P5(r,t)}return n.tension=function(r){return e(+r)},n}(0);function O5(e,t){this._context=e,this._k=(1-t)/6}O5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Yk(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const _nt=function e(t){function n(r){return new O5(r,t)}return n.tension=function(r){return e(+r)},n}(0);function D5(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>HV){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>HV){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function ple(e,t){this._context=e,this._alpha=t}ple.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:D5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const mle=function e(t){function n(r){return t?new ple(r,t):new j5(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function gle(e,t){this._context=e,this._alpha=t}gle.prototype={areaStart:Oh,areaEnd:Oh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:D5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Snt=function e(t){function n(r){return t?new gle(r,t):new P5(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function yle(e,t){this._context=e,this._alpha=t}yle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:D5(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Cnt=function e(t){function n(r){return t?new yle(r,t):new O5(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function ble(e){this._context=e}ble.prototype={areaStart:Oh,areaEnd:Oh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function knt(e){return new ble(e)}function KV(e){return e<0?-1:1}function YV(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(KV(i)+KV(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function ZV(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function N3(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function Zk(e){this._context=e}Zk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:N3(this,this._t0,ZV(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,N3(this,ZV(this,n=YV(this,e,t)),n);break;default:N3(this,this._t0,n=YV(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function vle(e){this._context=new xle(e)}(vle.prototype=Object.create(Zk.prototype)).point=function(e,t){Zk.prototype.point.call(this,t,e)};function xle(e){this._context=e}xle.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function wle(e){return new Zk(e)}function _le(e){return new vle(e)}function Sle(e){this._context=e}Sle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=XV(e),s=XV(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function XV(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function Cle(e){return new Sle(e)}function aA(e,t){this._context=e,this._t=t}aA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function kle(e){return new aA(e,.5)}function Ele(e){return new aA(e,0)}function Tle(e){return new aA(e,1)}function bx(e,t,n){this.k=e,this.x=t,this.y=n}bx.prototype={constructor:bx,scale:function(e){return e===1?this:new bx(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new bx(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};bx.prototype;var Ale=typeof y0=="object"&&y0&&y0.Object===Object&&y0,Ent=typeof self=="object"&&self&&self.Object===Object&&self,Vu=Ale||Ent||Function("return this")(),Xk=Vu.Symbol,Rle=Object.prototype,Tnt=Rle.hasOwnProperty,Ant=Rle.toString,Kv=Xk?Xk.toStringTag:void 0;function Rnt(e){var t=Tnt.call(e,Kv),n=e[Kv];try{e[Kv]=void 0;var r=!0}catch{}var s=Ant.call(e);return r&&(t?e[Kv]=n:delete e[Kv]),s}var Nnt=Object.prototype,Mnt=Nnt.toString;function Int(e){return Mnt.call(e)}var jnt="[object Null]",Pnt="[object Undefined]",JV=Xk?Xk.toStringTag:void 0;function vb(e){return e==null?e===void 0?Pnt:jnt:JV&&JV in Object(e)?Rnt(e):Int(e)}function eg(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ont="[object AsyncFunction]",Dnt="[object Function]",Fnt="[object GeneratorFunction]",Lnt="[object Proxy]";function F5(e){if(!eg(e))return!1;var t=vb(e);return t==Dnt||t==Fnt||t==Ont||t==Lnt}var M3=Vu["__core-js_shared__"],QV=function(){var e=/[^.]+$/.exec(M3&&M3.keys&&M3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Bnt(e){return!!QV&&QV in e}var $nt=Function.prototype,znt=$nt.toString;function tg(e){if(e!=null){try{return znt.call(e)}catch{}try{return e+""}catch{}}return""}var Unt=/[\\^$.*+?()[\]{}|]/g,qnt=/^\[object .+?Constructor\]$/,Vnt=Function.prototype,Wnt=Object.prototype,Hnt=Vnt.toString,Gnt=Wnt.hasOwnProperty,Knt=RegExp("^"+Hnt.call(Gnt).replace(Unt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ynt(e){if(!eg(e)||Bnt(e))return!1;var t=F5(e)?Knt:qnt;return t.test(tg(e))}function Znt(e,t){return e==null?void 0:e[t]}function ng(e,t){var n=Znt(e,t);return Ynt(n)?n:void 0}var o1=ng(Object,"create");function Xnt(){this.__data__=o1?o1(null):{},this.size=0}function Jnt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Qnt="__lodash_hash_undefined__",ert=Object.prototype,trt=ert.hasOwnProperty;function nrt(e){var t=this.__data__;if(o1){var n=t[e];return n===Qnt?void 0:n}return trt.call(t,e)?t[e]:void 0}var rrt=Object.prototype,srt=rrt.hasOwnProperty;function irt(e){var t=this.__data__;return o1?t[e]!==void 0:srt.call(t,e)}var art="__lodash_hash_undefined__";function ort(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=o1&&t===void 0?art:t,this}function Om(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Om.prototype.clear=Xnt;Om.prototype.delete=Jnt;Om.prototype.get=nrt;Om.prototype.has=irt;Om.prototype.set=ort;function lrt(){this.__data__=[],this.size=0}function oA(e,t){return e===t||e!==e&&t!==t}function lA(e,t){for(var n=e.length;n--;)if(oA(e[n][0],t))return n;return-1}var crt=Array.prototype,urt=crt.splice;function drt(e){var t=this.__data__,n=lA(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():urt.call(t,n,1),--this.size,!0}function frt(e){var t=this.__data__,n=lA(t,e);return n<0?void 0:t[n][1]}function hrt(e){return lA(this.__data__,e)>-1}function prt(e,t){var n=this.__data__,r=lA(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function cf(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}cf.prototype.clear=lrt;cf.prototype.delete=drt;cf.prototype.get=frt;cf.prototype.has=hrt;cf.prototype.set=prt;var l1=ng(Vu,"Map");function mrt(){this.size=0,this.__data__={hash:new Om,map:new(l1||cf),string:new Om}}function grt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function cA(e,t){var n=e.__data__;return grt(t)?n[typeof t=="string"?"string":"hash"]:n.map}function yrt(e){var t=cA(this,e).delete(e);return this.size-=t?1:0,t}function brt(e){return cA(this,e).get(e)}function vrt(e){return cA(this,e).has(e)}function xrt(e,t){var n=cA(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function dp(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}dp.prototype.clear=mrt;dp.prototype.delete=yrt;dp.prototype.get=brt;dp.prototype.has=vrt;dp.prototype.set=xrt;var wrt="Expected a function";function h_(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(wrt);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(h_.Cache||dp),n}h_.Cache=dp;function _rt(){this.__data__=new cf,this.size=0}function Srt(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Crt(e){return this.__data__.get(e)}function krt(e){return this.__data__.has(e)}var Ert=200;function Trt(e,t){var n=this.__data__;if(n instanceof cf){var r=n.__data__;if(!l1||r.length<Ert-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new dp(r)}return n.set(e,t),this.size=n.size,this}function xb(e){var t=this.__data__=new cf(e);this.size=t.size}xb.prototype.clear=_rt;xb.prototype.delete=Srt;xb.prototype.get=Crt;xb.prototype.has=krt;xb.prototype.set=Trt;var Jk=function(){try{var e=ng(Object,"defineProperty");return e({},"",{}),e}catch{}}();function L5(e,t,n){t=="__proto__"&&Jk?Jk(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function gP(e,t,n){(n!==void 0&&!oA(e[t],n)||n===void 0&&!(t in e))&&L5(e,t,n)}function Art(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var Rrt=Art(),Nle=typeof exports=="object"&&exports&&!exports.nodeType&&exports,eW=Nle&&typeof module=="object"&&module&&!module.nodeType&&module,Nrt=eW&&eW.exports===Nle,tW=Nrt?Vu.Buffer:void 0,nW=tW?tW.allocUnsafe:void 0;function Mrt(e,t){if(t)return e.slice();var n=e.length,r=nW?nW(n):new e.constructor(n);return e.copy(r),r}var rW=Vu.Uint8Array;function Irt(e){var t=new e.constructor(e.byteLength);return new rW(t).set(new rW(e)),t}function jrt(e,t){var n=t?Irt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Prt(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var sW=Object.create,Ort=function(){function e(){}return function(t){if(!eg(t))return{};if(sW)return sW(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Mle(e,t){return function(n){return e(t(n))}}var Ile=Mle(Object.getPrototypeOf,Object),Drt=Object.prototype;function uA(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||Drt;return e===n}function Frt(e){return typeof e.constructor=="function"&&!uA(e)?Ort(Ile(e)):{}}function p_(e){return e!=null&&typeof e=="object"}var Lrt="[object Arguments]";function iW(e){return p_(e)&&vb(e)==Lrt}var jle=Object.prototype,Brt=jle.hasOwnProperty,$rt=jle.propertyIsEnumerable,Qk=iW(function(){return arguments}())?iW:function(e){return p_(e)&&Brt.call(e,"callee")&&!$rt.call(e,"callee")},eE=Array.isArray,zrt=9007199254740991;function Ple(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=zrt}function dA(e){return e!=null&&Ple(e.length)&&!F5(e)}function Urt(e){return p_(e)&&dA(e)}function qrt(){return!1}var Ole=typeof exports=="object"&&exports&&!exports.nodeType&&exports,aW=Ole&&typeof module=="object"&&module&&!module.nodeType&&module,Vrt=aW&&aW.exports===Ole,oW=Vrt?Vu.Buffer:void 0,Wrt=oW?oW.isBuffer:void 0,B5=Wrt||qrt,Hrt="[object Object]",Grt=Function.prototype,Krt=Object.prototype,Dle=Grt.toString,Yrt=Krt.hasOwnProperty,Zrt=Dle.call(Object);function Xrt(e){if(!p_(e)||vb(e)!=Hrt)return!1;var t=Ile(e);if(t===null)return!0;var n=Yrt.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Dle.call(n)==Zrt}var Jrt="[object Arguments]",Qrt="[object Array]",est="[object Boolean]",tst="[object Date]",nst="[object Error]",rst="[object Function]",sst="[object Map]",ist="[object Number]",ast="[object Object]",ost="[object RegExp]",lst="[object Set]",cst="[object String]",ust="[object WeakMap]",dst="[object ArrayBuffer]",fst="[object DataView]",hst="[object Float32Array]",pst="[object Float64Array]",mst="[object Int8Array]",gst="[object Int16Array]",yst="[object Int32Array]",bst="[object Uint8Array]",vst="[object Uint8ClampedArray]",xst="[object Uint16Array]",wst="[object Uint32Array]",$s={};$s[hst]=$s[pst]=$s[mst]=$s[gst]=$s[yst]=$s[bst]=$s[vst]=$s[xst]=$s[wst]=!0;$s[Jrt]=$s[Qrt]=$s[dst]=$s[est]=$s[fst]=$s[tst]=$s[nst]=$s[rst]=$s[sst]=$s[ist]=$s[ast]=$s[ost]=$s[lst]=$s[cst]=$s[ust]=!1;function _st(e){return p_(e)&&Ple(e.length)&&!!$s[vb(e)]}function Sst(e){return function(t){return e(t)}}var Fle=typeof exports=="object"&&exports&&!exports.nodeType&&exports,zx=Fle&&typeof module=="object"&&module&&!module.nodeType&&module,Cst=zx&&zx.exports===Fle,I3=Cst&&Ale.process,lW=function(){try{var e=zx&&zx.require&&zx.require("util").types;return e||I3&&I3.binding&&I3.binding("util")}catch{}}(),cW=lW&&lW.isTypedArray,$5=cW?Sst(cW):_st;function yP(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var kst=Object.prototype,Est=kst.hasOwnProperty;function Tst(e,t,n){var r=e[t];(!(Est.call(e,t)&&oA(r,n))||n===void 0&&!(t in e))&&L5(e,t,n)}function Ast(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?L5(n,o,l):Tst(n,o,l)}return n}function Rst(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Nst=9007199254740991,Mst=/^(?:0|[1-9]\d*)$/;function Lle(e,t){var n=typeof e;return t=t??Nst,!!t&&(n=="number"||n!="symbol"&&Mst.test(e))&&e>-1&&e%1==0&&e<t}var Ist=Object.prototype,jst=Ist.hasOwnProperty;function Pst(e,t){var n=eE(e),r=!n&&Qk(e),s=!n&&!r&&B5(e),i=!n&&!r&&!s&&$5(e),a=n||r||s||i,o=a?Rst(e.length,String):[],l=o.length;for(var c in e)(t||jst.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Lle(c,l)))&&o.push(c);return o}function Ost(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var Dst=Object.prototype,Fst=Dst.hasOwnProperty;function Lst(e){if(!eg(e))return Ost(e);var t=uA(e),n=[];for(var r in e)r=="constructor"&&(t||!Fst.call(e,r))||n.push(r);return n}function Ble(e){return dA(e)?Pst(e,!0):Lst(e)}function Bst(e){return Ast(e,Ble(e))}function $st(e,t,n,r,s,i,a){var o=yP(e,n),l=yP(t,n),c=a.get(l);if(c){gP(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=eE(l),m=!h&&B5(l),y=!h&&!m&&$5(l);u=l,h||m||y?eE(o)?u=o:Urt(o)?u=Prt(o):m?(d=!1,u=Mrt(l,!0)):y?(d=!1,u=jrt(l,!0)):u=[]:Xrt(l)||Qk(l)?(u=o,Qk(o)?u=Bst(o):(!eg(o)||F5(o))&&(u=Frt(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),gP(e,n,u)}function $le(e,t,n,r,s){e!==t&&Rrt(t,function(i,a){if(s||(s=new xb),eg(i))$st(e,t,a,n,$le,r,s);else{var o=r?r(yP(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),gP(e,a,o)}},Ble)}function zle(e){return e}function zst(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var uW=Math.max;function Ust(e,t,n){return t=uW(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=uW(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),zst(e,this,o)}}function qst(e){return function(){return e}}var Vst=Jk?function(e,t){return Jk(e,"toString",{configurable:!0,enumerable:!1,value:qst(t),writable:!0})}:zle,Wst=800,Hst=16,Gst=Date.now;function Kst(e){var t=0,n=0;return function(){var r=Gst(),s=Hst-(r-n);if(n=r,s>0){if(++t>=Wst)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var Yst=Kst(Vst);function Zst(e,t){return Yst(Ust(e,t,zle),e+"")}function Xst(e,t,n){if(!eg(n))return!1;var r=typeof t;return(r=="number"?dA(n)&&Lle(t,n.length):r=="string"&&t in n)?oA(n[t],e):!1}function Jst(e){return Zst(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&Xst(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var Qst=Jst(function(e,t,n){$le(e,t,n)}),eit="",tit={curveBasis:X2,curveBasisClosed:bnt,curveBasisOpen:vnt,curveBumpX:lle,curveBumpY:cle,curveBundle:xnt,curveCardinalClosed:wnt,curveCardinalOpen:_nt,curveCardinal:hle,curveCatmullRomClosed:Snt,curveCatmullRomOpen:Cnt,curveCatmullRom:mle,curveLinear:Gk,curveLinearClosed:knt,curveMonotoneX:wle,curveMonotoneY:_le,curveNatural:Cle,curveStep:kle,curveStepAfter:Tle,curveStepBefore:Ele},nit=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,rit=ie(function(e,t){const n=Ule(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);Nk(a),r=wa(r,[...a])}else r=n.args;if(!r)return;let s=u5(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),Ule=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${nit.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),zt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=Bx.exec(e))!==null;)if(i.index===Bx.lastIndex&&Bx.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return zt.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),sit=ie(function(e){return e.replace(Bx,"")},"removeDirectives"),iit=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function z5(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return tit[n]??t}ie(z5,"interpolateToCurve");function qle(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?GJe.sanitizeUrl(n):n}ie(qle,"formatUrl");var ait=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){zt.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function U5(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(U5,"distance");function Vle(e){let t,n=0;e.forEach(s=>{n+=U5(s,t),t=s});const r=n/2;return q5(e,r)}ie(Vle,"traverseEdge");function Wle(e){return e.length===1?e[0]:Vle(e)}ie(Wle,"calcLabelPosition");var dW=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),q5=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=U5(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:dW((1-a)*n.x+a*s.x,5),y:dW((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),oit=ie((e,t,n)=>{zt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=q5(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function Hle(e,t,n){const r=structuredClone(n);zt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=q5(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(Hle,"calcTerminalLabelPosition");function Gle(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(Gle,"getStylesFromArray");var fW=0,lit=ie(()=>(fW++,"id-"+Math.random().toString(36).substr(2,12)+"-"+fW),"generateId");function Kle(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(Kle,"makeRandomHex");var cit=ie(e=>Kle(e.length),"random"),uit=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),dit=ie(function(e,t){const n=t.text.replace(bb.lineBreakRegex," "),[,r]=fA(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),fit=h_((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),bb.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=Jd(`${a} `,n),c=Jd(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:m}=hit(a,t,"-",n);s.push(i,...h),i=m}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),hit=h_((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(Jd(c,r)>=t){const d=l+1,h=s.length===d,m=`${c}${n}`;i.push(h?c:m),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function Yle(e,t){return V5(e,t).height}ie(Yle,"calculateTextHeight");function Jd(e,t){return V5(e,t).width}ie(Jd,"calculateTextWidth");var V5=h_((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=fA(n),a=["sans-serif",r],o=e.split(bb.lineBreakRegex),l=[],c=Kr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let m=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const v=uit();v.text=b||eit;const x=dit(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,w.width)),m=Math.round(w.height),y.height+=m,y.lineHeight=Math.round(Math.max(y.lineHeight,m))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),G0,pit=(G0=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(G0,"InitIDGenerator"),G0),x2,mit=ie(function(e){return x2=x2||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),x2.innerHTML=e,unescape(x2.textContent)},"entityDecode");function W5(e){return"str"in e}ie(W5,"isDetailedError");var git=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),fA=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function H5(e,t){return Qst({},e,t)}ie(H5,"cleanAndMerge");var gu={assignWithDepth:wa,wrapLabel:fit,calculateTextHeight:Yle,calculateTextWidth:Jd,calculateTextDimensions:V5,cleanAndMerge:H5,detectInit:rit,detectDirective:Ule,isSubstringInArray:iit,interpolateToCurve:z5,calcLabelPosition:Wle,calcCardinalityPosition:oit,calcTerminalLabelPosition:Hle,formatUrl:qle,getStylesFromArray:Gle,generateId:lit,random:cit,runFunc:ait,entityDecode:mit,insertTitle:git,parseFontSize:fA,InitIDGenerator:pit},yit=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?""+r+"":""+r+""}),t},"encodeEntities"),rg=ie(function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),Ddt=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function ro(e){return e??null}ie(ro,"handleUndefinedAttr");function G5(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var sg=G5();function Zle(e){sg=e}var Ux={exec:()=>null};function ms(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(to.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var to={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},bit=/^(?:[ \t]*(?:\n|$))+/,vit=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,xit=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,m_=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,wit=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,K5=/(?:[*+-]|\d{1,9}[.)])/,Xle=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Jle=ms(Xle).replace(/bull/g,K5).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),_it=ms(Xle).replace(/bull/g,K5).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Y5=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Sit=/^[^\n]+/,Z5=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Cit=ms(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Z5).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),kit=ms(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,K5).getRegex(),hA="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",X5=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Eit=ms("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",X5).replace("tag",hA).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Qle=ms(Y5).replace("hr",m_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hA).getRegex(),Tit=ms(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Qle).getRegex(),J5={blockquote:Tit,code:vit,def:Cit,fences:xit,heading:wit,hr:m_,html:Eit,lheading:Jle,list:kit,newline:bit,paragraph:Qle,table:Ux,text:Sit},hW=ms("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",m_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hA).getRegex(),Ait={...J5,lheading:_it,table:hW,paragraph:ms(Y5).replace("hr",m_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",hW).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",hA).getRegex()},Rit={...J5,html:ms(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",X5).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Ux,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ms(Y5).replace("hr",m_).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Jle).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Nit=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,Mit=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,ece=/^( {2,}|\\)\n(?!\s*$)/,Iit=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,pA=/[\p{P}\p{S}]/u,Q5=/[\s\p{P}\p{S}]/u,tce=/[^\s\p{P}\p{S}]/u,jit=ms(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Q5).getRegex(),nce=/(?!~)[\p{P}\p{S}]/u,Pit=/(?!~)[\s\p{P}\p{S}]/u,Oit=/(?:[^\s\p{P}\p{S}]|~)/u,Dit=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,rce=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,Fit=ms(rce,"u").replace(/punct/g,pA).getRegex(),Lit=ms(rce,"u").replace(/punct/g,nce).getRegex(),sce="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",Bit=ms(sce,"gu").replace(/notPunctSpace/g,tce).replace(/punctSpace/g,Q5).replace(/punct/g,pA).getRegex(),$it=ms(sce,"gu").replace(/notPunctSpace/g,Oit).replace(/punctSpace/g,Pit).replace(/punct/g,nce).getRegex(),zit=ms("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,tce).replace(/punctSpace/g,Q5).replace(/punct/g,pA).getRegex(),Uit=ms(/\\(punct)/,"gu").replace(/punct/g,pA).getRegex(),qit=ms(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Vit=ms(X5).replace("(?:-->|$)","-->").getRegex(),Wit=ms("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Vit).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),tE=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Hit=ms(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",tE).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),ice=ms(/^!?\[(label)\]\[(ref)\]/).replace("label",tE).replace("ref",Z5).getRegex(),ace=ms(/^!?\[(ref)\](?:\[\])?/).replace("ref",Z5).getRegex(),Git=ms("reflink|nolink(?!\\()","g").replace("reflink",ice).replace("nolink",ace).getRegex(),eF={_backpedal:Ux,anyPunctuation:Uit,autolink:qit,blockSkip:Dit,br:ece,code:Mit,del:Ux,emStrongLDelim:Fit,emStrongRDelimAst:Bit,emStrongRDelimUnd:zit,escape:Nit,link:Hit,nolink:ace,punctuation:jit,reflink:ice,reflinkSearch:Git,tag:Wit,text:Iit,url:Ux},Kit={...eF,link:ms(/^!?\[(label)\]\((.*?)\)/).replace("label",tE).getRegex(),reflink:ms(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",tE).getRegex()},bP={...eF,emStrongRDelimAst:$it,emStrongLDelim:Lit,url:ms(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Yit={...bP,br:ms(ece).replace("{2,}","*").getRegex(),text:ms(bP.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},w2={normal:J5,gfm:Ait,pedantic:Rit},Yv={normal:eF,gfm:bP,breaks:Yit,pedantic:Kit},Zit={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},pW=e=>Zit[e];function iu(e,t){if(t){if(to.escapeTest.test(e))return e.replace(to.escapeReplace,pW)}else if(to.escapeTestNoEncode.test(e))return e.replace(to.escapeReplaceNoEncode,pW);return e}function mW(e){try{e=encodeURI(e).replace(to.percentDecode,"%")}catch{return null}return e}function gW(e,t){var i;const n=e.replace(to.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(to.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(to.slashPipe,"|");return r}function Zv(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function Xit(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function yW(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function Jit(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var nE=class{constructor(e){de(this,"options");de(this,"rules");de(this,"lexer");this.options=e||sg}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Zv(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=Jit(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=Zv(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:Zv(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=Zv(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.blockquote(y);i[i.length-1]=b,r=r.substring(0,r.length-m.raw.length)+b.raw,s=s.substring(0,s.length-m.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.list(y);i[i.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-m.raw.length)+b.raw,n=y.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],m=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):m?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),m&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(y),w=this.rules.other.hrRegex(y),S=this.rules.other.fencesBeginRegex(y),k=this.rules.other.headingBeginRegex(y),C=this.rules.other.htmlBeginRegex(y);for(;e;){const R=e.split(`
`,1)[0];let A;if(h=R,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),A=h):A=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||k.test(h)||C.test(h)||x.test(h)||w.test(h))break;if(A.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+A.slice(y);else{if(m||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||k.test(d)||w.test(d))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),c+=R+`
`,e=e.substring(R.length+1),d=A.slice(y)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,v;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(v=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!b,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=gW(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push(gW(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=Zv(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=Xit(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),yW(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return yW(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const m=h.slice(2,-2);return{type:"strong",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Md=class vP{constructor(t){de(this,"tokens");de(this,"options");de(this,"state");de(this,"tokenizer");de(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||sg,this.options.tokenizer=this.options.tokenizer||new nE,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:to,block:w2.normal,inline:Yv.normal};this.options.pedantic?(n.block=w2.pedantic,n.inline=Yv.pedantic):this.options.gfm&&(n.block=w2.gfm,this.options.breaks?n.inline=Yv.breaks:n.inline=Yv.gfm),this.tokenizer.rules=n}static get rules(){return{block:w2,inline:Yv}}static lex(t,n){return new vP(n).lex(t)}static lexInline(t,n){return new vP(n).inlineTokens(t)}lex(t){t=t.replace(to.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(to.tabCharGlobal,"    ").replace(to.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const m=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},m),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},rE=class{constructor(e){de(this,"options");de(this,"parser");this.options=e||sg}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(to.notSpaceStart))==null?void 0:i[0],s=e.replace(to.endingNewline,"")+`
`;return r?'<pre><code class="language-'+iu(r)+'">'+(n?s:iu(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:iu(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+iu(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${iu(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=mW(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+iu(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=mW(e);if(s===null)return iu(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${iu(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:iu(e.text)}},tF=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Id=class xP{constructor(t){de(this,"options");de(this,"renderer");de(this,"textRenderer");this.options=t||sg,this.options.renderer=this.options.renderer||new rE,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new tF}static parse(t,n){return new xP(n).parse(t)}static parseInline(t,n){return new xP(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},z3,J2=(z3=class{constructor(e){de(this,"options");de(this,"block");this.options=e||sg}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Md.lex:Md.lexInline}provideParser(){return this.block?Id.parse:Id.parseInline}},de(z3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),z3),Qit=class{constructor(...e){de(this,"defaults",G5());de(this,"options",this.setOptions);de(this,"parse",this.parseMarkdown(!0));de(this,"parseInline",this.parseMarkdown(!1));de(this,"Parser",Id);de(this,"Renderer",rE);de(this,"TextRenderer",tF);de(this,"Lexer",Md);de(this,"Tokenizer",nE);de(this,"Hooks",J2);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new rE(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new nE(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new J2;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];J2.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Md.lex(e,t??this.defaults)}parser(e,t){return Id.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?Md.lex:Md.lexInline,l=i.hooks?i.hooks.provideParser():e?Id.parse:Id.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+iu(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Dm=new Qit;function ds(e,t){return Dm.parse(e,t)}ds.options=ds.setOptions=function(e){return Dm.setOptions(e),ds.defaults=Dm.defaults,Zle(ds.defaults),ds};ds.getDefaults=G5;ds.defaults=sg;ds.use=function(...e){return Dm.use(...e),ds.defaults=Dm.defaults,Zle(ds.defaults),ds};ds.walkTokens=function(e,t){return Dm.walkTokens(e,t)};ds.parseInline=Dm.parseInline;ds.Parser=Id;ds.parser=Id.parse;ds.Renderer=rE;ds.TextRenderer=tF;ds.Lexer=Md;ds.lexer=Md.lex;ds.Tokenizer=nE;ds.Hooks=J2;ds.parse=ds;ds.options;ds.setOptions;ds.use;ds.walkTokens;ds.parseInline;Id.parse;Md.lex;function oce(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,m){return m===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function lce(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=oce(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(lce,"preprocessMarkdown");function cce(e,t={}){const n=lce(e,t),r=ds.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(cce,"markdownToLines");function uce(e,{markdownAutoWrap:t}={}){const n=ds.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie(uce,"markdownToHTML");function dce(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(dce,"splitTextToChars");function fce(e,t){const n=dce(t.content);return nF(e,[],n,t.type)}ie(fce,"splitWordToFitWidth");function nF(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?nF(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(nF,"splitWordToFitWidthRecursion");function hce(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return sE(e,t)}ie(hce,"splitLineToFitWidth");function sE(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return sE(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=fce(t,i);n.push([o]),l.content&&e.unshift(l)}return sE(e,t,n)}ie(sE,"splitLineToFitWidthRecursion");function wP(e,t){t&&e.attr("style",t)}ie(wP,"applyStyle");async function pce(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&Ry(t.label)&&(o=await d5(t.label.replace(bb.lineBreakRegex,`
`),os()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),wP(c,t.labelStyle),c.attr("class",`${l} ${r}`),wP(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(pce,"addHtmlSpan");function mA(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(mA,"createTspan");function mce(e,t,n){const r=e.append("text"),s=mA(r,1,t);gA(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(mce,"computeWidthOfText");function eat(e,t,n){var a;const r=e.append("text"),s=mA(r,1,t);gA(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(eat,"computeDimensionOfText");function gce(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>mce(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:hce(c,u);for(const h of d){const m=mA(o,l,1.1);gA(m,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(gce,"createFormattedText");function gA(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(gA,"updateTextContentAndStyles");function yce(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(yce,"replaceIconSubstring");var fp=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(zt.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=uce(t,c),d=yce(rg(u)),h=t.replace(/\\\\/g,"\\"),m={isNode:a,label:Ry(t)?h:d,labelStyle:n.replace("fill:","color:")};return await pce(e,m,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=cce(u.replace("<br>","<br/>"),c),h=gce(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).attr("style",m)}else{const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Kr(h).select("rect").attr("style",m.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Kr(h).select("text").attr("style",y)}return h}},"createText");function j3(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function tat(e,t){return e[0]===t[0]&&e[1]===t[1]}function nat(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)j3(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const S=[...w];tat(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const m=[];u=Math.max(u,.1);const y=[];for(const w of h)for(let S=0;S<w.length-1;S++){const k=w[S],C=w[S+1];if(k[1]!==C[1]){const R=Math.min(k[1],C[1]);y.push({ymin:R,ymax:Math.max(k[1],C[1]),x:R===k[1]?k[0]:C[0],islope:(C[0]-k[0])/(C[1]-k[1])})}}if(y.sort((w,S)=>w.ymin<S.ymin?-1:w.ymin>S.ymin?1:w.x<S.x?-1:w.x>S.x?1:w.ymax===S.ymax?0:(w.ymax-S.ymax)/Math.abs(w.ymax-S.ymax)),!y.length)return m;let b=[],v=y[0].ymin,x=0;for(;b.length||y.length;){if(y.length){let w=-1;for(let S=0;S<y.length&&!(y[S].ymin>v);S++)w=S;y.splice(0,w+1).forEach(S=>{b.push({s:v,edge:S})})}if(b=b.filter(w=>!(w.edge.ymax<=v)),b.sort((w,S)=>w.edge.x===S.edge.x?0:(w.edge.x-S.edge.x)/Math.abs(w.edge.x-S.edge.x)),(d!==1||x%u==0)&&b.length>1)for(let w=0;w<b.length;w+=2){const S=w+1;if(S>=b.length)break;const k=b[w].edge,C=b[S].edge;m.push([[Math.round(k.x),v],[Math.round(C.x),v]])}v+=d,b.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return m}(a,i,r);if(s){for(const c of a)j3(c,o,-s);(function(c,u,d){const h=[];c.forEach(m=>h.push(...m)),j3(h,u,d)})(l,o,-s)}return l}function g_(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),nat(e,s,r,i||1)}class rF{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=g_(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function yA(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class rat extends rF{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=g_(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)yA([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class sat extends rF{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class iat{constructor(t){this.helper=t}fillPolygons(t,n){const r=g_(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=yA(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,m=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=m+d+y*s,v=h-a+2*Math.random()*a,x=b-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class aat{constructor(t){this.helper=t}fillPolygons(t,n){const r=g_(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=yA(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let m=0;m<l;m++){const y=m*(r+s),b=y+r,v=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],x=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class oat{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=g_(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=yA(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,m=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+m*Math.cos(u),l[1]+m*Math.sin(u)],x=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(b[0],b[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const bo={};class lat{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const cat=0,P3=1,bW=2,_2={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function O3(e,t){return e.type===t}function sF(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:cat,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:P3,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:bW,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!O3(i,bW);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return sF("M0,0"+e);s++,a=_2[i.text],r=i.text}else O3(i,P3)?a=_2[r]:(s++,a=_2[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!O3(c,P3))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof _2[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function bce(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function vce(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let m=0,y=0;n==="Q"||n==="T"?(m=r+(r-o),y=s+(s-l)):(m=r,y=s);const b=r+2*(m-r)/3,v=s+2*(y-s)/3,x=d+2*(m-d)/3,w=h+2*(y-h)/3;t.push({key:"C",data:[b,v,x,w,d,h]}),o=m,l=y,r=d,s=h;break}case"Q":{const[d,h,m,y]=u,b=r+2*(d-r)/3,v=s+2*(h-s)/3,x=m+2*(d-m)/3,w=y+2*(h-y)/3;t.push({key:"C",data:[b,v,x,w,m,y]}),o=d,l=h,r=m,s=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),m=u[2],y=u[3],b=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(xce(r,s,v,x,d,h,m,y,b).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function Xv(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function xce(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],m=0,y=0,b=0,v=0;if(c)[m,y,b,v]=c;else{[e,t]=Xv(e,t,-u),[n,r]=Xv(n,r,-u);const W=(e-n)/2,P=(t-r)/2;let Z=W*W/(s*s)+P*P/(i*i);Z>1&&(Z=Math.sqrt(Z),s*=Z,i*=Z);const U=s*s,H=i*i,L=U*H-U*P*P-H*W*W,ne=U*P*P+H*W*W,V=(o===l?-1:1)*Math.sqrt(Math.abs(L/ne));b=V*s*P/i+(e+n)/2,v=V*-i*W/s+(t+r)/2,m=Math.asin(parseFloat(((t-v)/i).toFixed(9))),y=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<b&&(m=Math.PI-m),n<b&&(y=Math.PI-y),m<0&&(m=2*Math.PI+m),y<0&&(y=2*Math.PI+y),l&&m>y&&(m-=2*Math.PI),!l&&y>m&&(y-=2*Math.PI)}let x=y-m;if(Math.abs(x)>120*Math.PI/180){const W=y,P=n,Z=r;y=l&&y>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,h=xce(n=b+s*Math.cos(y),r=v+i*Math.sin(y),P,Z,s,i,a,0,l,[y,W,b,v])}x=y-m;const w=Math.cos(m),S=Math.sin(m),k=Math.cos(y),C=Math.sin(y),R=Math.tan(x/4),A=4/3*s*R,N=4/3*i*R,I=[e,t],O=[e+A*S,t-N*w],B=[n+A*C,r-N*k],D=[n,r];if(O[0]=2*I[0]-O[0],O[1]=2*I[1]-O[1],c)return[O,B,D].concat(h);{h=[O,B,D].concat(h);const W=[];for(let P=0;P<h.length;P+=3){const Z=Xv(h[P][0],h[P][1],u),U=Xv(h[P+1][0],h[P+1][1],u),H=Xv(h[P+2][0],h[P+2][1],u);W.push([Z[0],Z[1],U[0],U[1],H[0],H[1]])}return W}}const uat={randOffset:function(e,t){return Qn(e,t)},randOffsetWithRange:function(e,t,n){return iE(e,t,n)},ellipse:function(e,t,n,r,s){const i=_ce(n,r,s);return _P(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return Dh(e,t,n,r,s,!0)}};function wce(e,t,n,r,s){return{type:"path",ops:Dh(e,t,n,r,s)}}function Q2(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...Dh(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...Dh(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?wce(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function dat(e,t,n,r,s){return function(i,a){return Q2(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function vW(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=S2(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:S2(n[0],1.5*(1+.22*t.roughness),_W(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=S2(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:S2(a,1.5*(1+.22*t.roughness),_W(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function _ce(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=Qn(a*l,n),o+=Qn(o*l,n),{increment:i,rx:a,ry:o}}function _P(e,t,n,r){const[s,i]=SW(r.increment,e,t,r.rx,r.ry,1,r.increment*iE(.1,iE(.4,1,n),n),n);let a=aE(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=SW(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=aE(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function xW(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=Qn(.01*d,l),h+=Qn(.01*h,l);let m=s,y=i;for(;m<0;)m+=2*Math.PI,y+=2*Math.PI;y-m>2*Math.PI&&(m=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,v=Math.min(b/2,(y-m)/2),x=CW(v,c,u,d,h,m,y,1,l);if(!l.disableMultiStroke){const w=CW(v,c,u,d,h,m,y,1.5,l);x.push(...w)}return a&&(o?x.push(...Dh(c,u,c+d*Math.cos(m),u+h*Math.sin(m),l),...Dh(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(m),u+h*Math.sin(m)]})),{type:"path",ops:x}}function wW(e,t){const n=vce(bce(sF(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...Dh(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,m]=o;r.push(...fat(l,c,u,d,h,m,i,t)),i=[h,m];break}case"Z":r.push(...Dh(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function D3(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+Qn(s,t),r[0][1]+Qn(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+Qn(s,t),r[a][1]+Qn(s,t)]})}}return{type:"fillPath",ops:n}}function o0(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!bo[s])switch(s){case"zigzag":bo[s]||(bo[s]=new rat(r));break;case"cross-hatch":bo[s]||(bo[s]=new sat(r));break;case"dots":bo[s]||(bo[s]=new iat(r));break;case"dashed":bo[s]||(bo[s]=new aat(r));break;case"zigzag-line":bo[s]||(bo[s]=new oat(r));break;default:s="hachure",bo[s]||(bo[s]=new rF(r))}return bo[s]}(t,uat).fillPolygons(e,t)}function _W(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Sce(e){return e.randomizer||(e.randomizer=new lat(e.seed||0)),e.randomizer.next()}function iE(e,t,n,r=1){return n.roughness*r*(Sce(n)*(t-e)+e)}function Qn(e,t,n=1){return iE(-e,e,t,n)}function Dh(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=SP(e,t,n,r,s,!0,!1);if(a)return o;const l=SP(e,t,n,r,s,!0,!0);return o.concat(l)}function SP(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*Sce(s);let m=s.bowing*s.maxRandomnessOffset*(r-t)/200,y=s.bowing*s.maxRandomnessOffset*(e-n)/200;m=Qn(m,s,c),y=Qn(y,s,c);const b=[],v=()=>Qn(d,s,c),x=()=>Qn(u,s,c),w=s.preserveVertices;return a?b.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):b.push({op:"move",data:[e+(w?0:Qn(u,s,c)),t+(w?0:Qn(u,s,c))]}),a?b.push({op:"bcurveTo",data:[m+e+(n-e)*h+v(),y+t+(r-t)*h+v(),m+e+2*(n-e)*h+v(),y+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):b.push({op:"bcurveTo",data:[m+e+(n-e)*h+x(),y+t+(r-t)*h+x(),m+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),b}function S2(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+Qn(t,n),e[0][1]+Qn(t,n)]),r.push([e[0][0]+Qn(t,n),e[0][1]+Qn(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+Qn(t,n),e[s][1]+Qn(t,n)]),s===e.length-1&&r.push([e[s][0]+Qn(t,n),e[s][1]+Qn(t,n)]);return aE(r,null,n)}function aE(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...SP(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function SW(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=Qn(.5,o)-Math.PI/2;c.push([Qn(i,o)+t+.9*r*Math.cos(u-e),Qn(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const m=[Qn(i,o)+t+r*Math.cos(h),Qn(i,o)+n+s*Math.sin(h)];l.push(m),c.push(m)}c.push([Qn(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),Qn(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([Qn(i,o)+t+.98*r*Math.cos(u+a),Qn(i,o)+n+.98*s*Math.sin(u+a)]),c.push([Qn(i,o)+t+.9*r*Math.cos(u+.5*a),Qn(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function CW(e,t,n,r,s,i,a,o,l){const c=i+Qn(.1,l),u=[];u.push([Qn(o,l)+t+.9*r*Math.cos(c-e),Qn(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([Qn(o,l)+t+r*Math.cos(d),Qn(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),aE(u,null,l)}function fat(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let m=0;m<d;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:Qn(c[0],o)),a[1]+(h?0:Qn(c[0],o))]}),u=h?[s,i]:[s+Qn(c[m],o),i+Qn(c[m],o)],l.push({op:"bcurveTo",data:[e+Qn(c[m],o),t+Qn(c[m],o),n+Qn(c[m],o),r+Qn(c[m],o),u[0],u[1]]});return l}function Jv(e){return[...e]}function kW(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(Jv(e[0]),Jv(e[1]),Jv(e[2]),Jv(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(Jv(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function eC(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function hat(e,t,n){const r=eC(t,n);if(r===0)return eC(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),eC(e,Gp(t,n,s))}function Gp(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function CP(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let m=3*u[0]-2*c[0]-h[0];m*=m;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let v=3*d[1]-2*h[1]-c[1];return v*=v,m<b&&(m=b),y<v&&(y=v),m+y}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt(eC(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=Gp(l,c,.5),m=Gp(c,u,.5),y=Gp(u,d,.5),b=Gp(h,m,.5),v=Gp(m,y,.5),x=Gp(b,v,.5);CP([l,h,b,x],0,n,s),CP([x,v,y,d],0,n,s)}var i,a;return s}function pat(e,t){return oE(e,0,e.length,t)}function oE(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=hat(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(oE(e,t,c+1,r,i),oE(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function F3(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)CP(e,3*i,t,r);return n&&n>0?oE(r,0,r.length,n):r}const el="none";class lE{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[wce(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=dat(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(D3([c],a)):o.push(o0([c],a))}return a.stroke!==el&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=_ce(r,s,a),c=_P(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=_P(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(o0([c.estimatedPoints],a));return a.stroke!==el&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[Q2(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=xW(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const m=xW(t,n,r,s,i,a,!0,!1,h);m.type="fillPath",u.push(m)}else u.push(function(h,m,y,b,v,x,w){const S=h,k=m;let C=Math.abs(y/2),R=Math.abs(b/2);C+=Qn(.01*C,w),R+=Qn(.01*R,w);let A=v,N=x;for(;A<0;)A+=2*Math.PI,N+=2*Math.PI;N-A>2*Math.PI&&(A=0,N=2*Math.PI);const I=(N-A)/w.curveStepCount,O=[];for(let B=A;B<=N;B+=I)O.push([S+C*Math.cos(B),k+R*Math.sin(B)]);return O.push([S+C*Math.cos(N),k+R*Math.sin(N)]),O.push([S,k]),o0([O],w)}(t,n,r,s,i,a,c));return c.stroke!==el&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=vW(t,r);if(r.fill&&r.fill!==el)if(r.fillStyle==="solid"){const a=vW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...F3(kW([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...F3(kW(c),10,(1+r.roughness)/2))}a.length&&s.push(o0([a],r))}return r.stroke!==el&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=Q2(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(D3([t],r)):s.push(o0([t],r))),r.stroke!==el&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==el,a=r.stroke!==el,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const m=vce(bce(sF(u))),y=[];let b=[],v=[0,0],x=[];const w=()=>{x.length>=4&&b.push(...F3(x,d)),x=[]},S=()=>{w(),b.length&&(y.push(b),b=[])};for(const{key:C,data:R}of m)switch(C){case"M":S(),v=[R[0],R[1]],b.push(v);break;case"L":w(),b.push([R[0],R[1]]);break;case"C":if(!x.length){const A=b.length?b[b.length-1]:v;x.push([A[0],A[1]])}x.push([R[0],R[1]]),x.push([R[2],R[3]]),x.push([R[4],R[5]]);break;case"Z":w(),b.push([v[0],v[1]])}if(S(),!h)return y;const k=[];for(const C of y){const R=pat(C,h);R.length&&k.push(R)}return k}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=wW(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=wW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(D3(l,r));else s.push(o0(l,r));return a&&(o?l.forEach(u=>{s.push(Q2(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:el};break;case"fillPath":a={d:this.opsToPath(i),stroke:el,strokeWidth:0,fill:r.fill||el};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||el,strokeWidth:r,fill:el}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class mat{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new lE(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const C2="http://www.w3.org/2000/svg";class gat{constructor(t,n){this.svg=t,this.gen=new lE(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(C2,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(C2,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(C2,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(C2,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var En={canvas:(e,t)=>new mat(e,t),svg:(e,t)=>new gat(e,t),generator:e=>new lE(e),newSeed:()=>lE.newSeed()},dr=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||Hi((d=os())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",ro(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await fp(a,Im(rg(o),os()),{useHtmlLabels:s,width:t.width||((h=os().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const m=l.children[0],y=Kr(l),b=m.getElementsByTagName("img");if(b){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(x=>new Promise(w=>{function S(){if(x.style.display="flex",x.style.flexDirection="column",v){const k=os().fontSize?os().fontSize:window.getComputedStyle(document.body).fontSize,C=5,[R=Bie.fontSize]=fA(k),A=R*C+"px";x.style.minWidth=A,x.style.maxWidth=A}else x.style.width="100%";w(x)}ie(S,"setupImage"),setTimeout(()=>{x.complete&&S()}),x.addEventListener("error",S),x.addEventListener("load",S)})))}c=m.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),L3=ie(async(e,t,n)=>{var l,c,u,d,h,m;const r=n.useHtmlLabels||Hi((c=(l=os())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await fp(s,Im(rg(t),os()),{useHtmlLabels:r,width:n.width||((d=(u=os())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(Hi((m=(h=os())==null?void 0:h.flowchart)==null?void 0:m.htmlLabels)){const y=i.children[0],b=Kr(i);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),Mn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),nr=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Xr(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Xr,"createPathFromPoints");function Fh(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let m=0;m<=50;m++){const y=m/50,b=e+y*l,v=h+s*Math.sin(d*(b-e));a.push({x:b,y:v})}return a}ie(Fh,"generateFullSineWavePoints");function iF(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(iF,"generateCirclePoints");var yat=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),wb=yat;function Cce(e,t){t&&e.attr("style",t)}ie(Cce,"applyStyle");async function kce(e){const t=Kr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&Ry(e.label)&&(r=await d5(e.label.replace(bb.lineBreakRegex,`
`),os()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),Cce(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(kce,"addHtmlLabel");var bat=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),Hi(os().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),zt.info("vertexText"+s);const i={isNode:r,label:rg(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await kce(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),cm=bat,uf=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),vat=ie(e=>{const{handDrawnSeed:t}=os();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),_b=ie(e=>{const t=xat([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),xat=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),Ece=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),In=ie(e=>{const{stylesArray:t}=_b(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];Ece(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),An=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=os(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=_b(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),Tce=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=In(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Hi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await fp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Hi(n.flowchart.htmlLabels)){const A=y.children[0],N=Kr(y);b=A.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const A=En.svg(d),N=An(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),I=A.path(uf(w,S,v,x,0),N);k=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=C5(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const A=m.select("span");A&&A.attr("style",o)}const R=k.node().getBBox();return t.offsetX=0,t.width=R.width,t.height=R.height,t.offsetY=b.height-t.padding/2,t.intersect=function(A){return wb(t,A)},{cluster:d,labelBBox:b}},"rect"),wat=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return wb(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),_at=ie(async(e,t)=>{const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const m=d.node().appendChild(await cm(t.label,t.labelStyle,void 0,!0));let y=m.getBBox();if(Hi(n.flowchart.htmlLabels)){const I=m.children[0],O=Kr(m);y=I.getBoundingClientRect(),O.attr("width",y.width),O.attr("height",y.height)}const b=0*t.padding,v=b/2,x=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+b,S=t.height+b-y.height-6,k=t.x-x/2,C=t.y-w/2;t.width=x;const R=t.y-t.height/2-v+y.height+2;let A;if(t.look==="handDrawn"){const I=t.cssClasses.includes("statediagram-cluster-alt"),O=En.svg(c),B=t.rx||t.ry?O.path(uf(k,C,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):O.rectangle(k,C,x,w,{seed:s});A=c.insert(()=>B,":first-child");const D=O.rectangle(k,R,x,S,{fill:I?i:a,fillStyle:I?"hachure":"solid",stroke:l,seed:s});A=c.insert(()=>B,":first-child"),h=c.insert(()=>D)}else A=u.insert("rect",":first-child"),A.attr("class","outer").attr("x",k).attr("y",C).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",k).attr("y",R).attr("width",x).attr("height",S);d.attr("transform",`translate(${t.x-y.width/2}, ${C+1-(Hi(n.flowchart.htmlLabels)?0:3)})`);const N=A.node().getBBox();return t.height=N.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(I){return wb(t,I)},{cluster:c,labelBBox:y}},"roundedWithTitle"),Sat=ie(async(e,t)=>{zt.info("Creating subgraph rect for ",t.id,t);const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=In(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Hi(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await fp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Hi(n.flowchart.htmlLabels)){const A=y.children[0],N=Kr(y);b=A.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;zt.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const A=En.svg(d),N=An(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),I=A.path(uf(w,S,v,x,t.rx),N);k=d.insert(()=>(zt.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=C5(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const A=m.select("span");A&&A.attr("style",o)}const R=k.node().getBBox();return t.offsetX=0,t.width=R.width,t.height=R.height,t.offsetY=b.height-t.padding/2,t.intersect=function(A){return wb(t,A)},{cluster:d,labelBBox:b}},"kanbanSection"),Cat=ie((e,t)=>{const n=os(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let m;if(t.look==="handDrawn"){const v=En.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});m=a.insert(()=>v,":first-child")}else m=o.insert("rect",":first-child"),m.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=m.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return wb(t,b)},{cluster:a,labelBBox:{}}},"divider"),kat=Tce,Eat={rect:Tce,squareRect:kat,roundedWithTitle:_at,noteGroup:wat,divider:Cat,kanbanSection:Sat},Ace=new Map,Tat=ie(async(e,t)=>{const n=t.shape||"rect",r=await Eat[n](e,t);return Ace.set(t.id,r),r},"insertCluster"),Fdt=ie(()=>{Ace=new Map},"clear");function Rce(e,t){return e.intersect(t)}ie(Rce,"intersectNode");var Aat=Rce;function Nce(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(Nce,"intersectEllipse");var Mce=Nce;function Ice(e,t,n){return Mce(e,t,t,n)}ie(Ice,"intersectCircle");var Rat=Ice;function jce(e,t,n,r){var s,i,a,o,l,c,u,d,h,m,y,b,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,m=s*r.x+a*r.y+l,!(h!==0&&m!==0&&kP(h,m))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&kP(u,d))&&(y=s*o-i*a,y!==0)))return b=Math.abs(y/2),v=a*c-o*l,x=v<0?(v-b)/y:(v+b)/y,v=i*l-s*c,w=v<0?(v-b)/y:(v+b)/y,{x,y:w}}ie(jce,"intersectLine");function kP(e,t){return e*t>0}ie(kP,"sameSign");var Nat=jce;function Pce(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],m=Nat(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});m&&i.push(m)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,m=u.y-n.y,y=Math.sqrt(h*h+m*m),b=d.x-n.x,v=d.y-n.y,x=Math.sqrt(b*b+v*v);return y<x?-1:y===x?0:1}),i[0]):e}ie(Pce,"intersectPolygon");var Mat=Pce,Cn={node:Aat,circle:Rat,ellipse:Mce,polygon:Mat,rect:wb};function Oce(e,t){const{labelStyles:n}=In(t);t.labelStyle=n;const r=nr(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=En.svg(i),c=An(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",ro(o)),Mn(t,d),t.intersect=function(h){return zt.info("Circle intersect",t,a,h),Cn.circle(t,a,h)},i}ie(Oce,"anchor");function EP(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,m=d/s,y=h/i,b=Math.sqrt(m**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-b**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),S=Math.atan2((t-w)/i,(e-x)/s);let C=Math.atan2((r-w)/i,(n-x)/s)-S;a&&C<0&&(C+=2*Math.PI),!a&&C>0&&(C-=2*Math.PI);const R=[];for(let A=0;A<20;A++){const N=A/19,I=S+N*C,O=x+s*Math.cos(I),B=w+i*Math.sin(I);R.push({x:O,y:B})}return R}ie(EP,"generateArcPoints");async function Dce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...EP(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...EP(a/2,o/2,a/2,-o/2,c,l,!0)],h=En.svg(s),m=An(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(d),b=h.path(y,m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),Mn(t,v),t.intersect=function(x){return Cn.polygon(t,d,x)},s}ie(Dce,"bowTieRect");function df(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(df,"insertPolygonShape");async function Fce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,m=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const v=En.svg(s),x=An(t,{}),w=Xr(m),S=v.path(w,x);y=s.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=df(s,l,a,m);return r&&y.attr("style",r),Mn(t,y),t.intersect=function(v){return Cn.polygon(t,m,v)},s}ie(Fce,"card");function Lce(e,t){const{nodeStyles:n}=In(t);t.label="";const r=e.insert("g").attr("class",nr(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=En.svg(r),l=An(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Xr(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return Cn.polygon(t,a,h)},r}ie(Lce,"choice");async function Bce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await dr(e,t,nr(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=En.svg(s),d=An(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",ro(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return Mn(t,l),t.intersect=function(u){return zt.info("Circle intersect",t,o,u),Cn.circle(t,o,u)},s}ie(Bce,"circle");function $ce(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie($ce,"createLine");function zce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",nr(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=En.svg(s),l=An(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=$ce(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),Mn(t,h),t.intersect=function(m){return zt.info("crossedCircle intersect",t,{radius:i,point:m}),Cn.circle(t,i,m)},s}ie(zce,"crossedCircle");function wd(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(wd,"generateCirclePoints");async function Uce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...wd(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...wd(o/2+c*2,-c,c,20,-180,-270),...wd(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...wd(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...wd(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...wd(o/2+o*.1,-c,c,20,-180,-270),...wd(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...wd(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],m=En.svg(s),y=An(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>S,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,k),t.intersect=function(C){return Cn.polygon(t,h,C)},s}ie(Uce,"curlyBraceLeft");function _d(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:m,y})}return a}ie(_d,"generateCirclePoints");async function qce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[..._d(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},..._d(o/2+c*2,-c,c,20,-180,-270),..._d(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},..._d(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},..._d(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},..._d(o/2+c*2,-c,c,20,-180,-270),..._d(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},..._d(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],m=En.svg(s),y=An(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Xr(d).replace("Z",""),x=m.path(v,y),w=Xr(h),S=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>S,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,k),t.intersect=function(C){return Cn.polygon(t,h,C)},s}ie(qce,"curlyBraceRight");function ga(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(ga,"generateCirclePoints");async function Vce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...ga(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...ga(o/2+c*2,-c,c,20,-180,-270),...ga(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...ga(o/2,l/2,c,20,0,90)],h=[...ga(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...ga(-o/2-c/2,-c,c,20,0,90),...ga(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...ga(-o/2+c+c/2,l/2,c,30,-180,-270)],m=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...ga(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...ga(o/2+c*2,-c,c,20,-180,-270),...ga(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...ga(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...ga(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...ga(-o/2-c/2,-c,c,20,0,90),...ga(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...ga(-o/2+c+c/2,l/2,c,30,-180,-270)],y=En.svg(s),b=An(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Xr(d).replace("Z",""),w=y.path(x,b),k=Xr(h).replace("Z",""),C=y.path(k,b),R=Xr(m),A=y.path(R,{...b}),N=s.insert("g",":first-child");return N.insert(()=>A,":first-child").attr("stroke-opacity",0),N.insert(()=>w,":first-child"),N.insert(()=>C,":first-child"),N.attr("class","text"),u&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,N),t.intersect=function(I){return Cn.polygon(t,m,I)},s}ie(Vce,"curlyBraces");async function Wce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=En.svg(s),m=An(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=l,b=c,v=y-u,x=b/4,w=[{x:v,y:0},{x,y:0},{x:0,y:b/2},{x,y:b},{x:v,y:b},...iF(-v,-b/2,u,50,270,90)],S=Xr(w),k=h.path(S,m),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",r),C.attr("transform",`translate(${-l/2}, ${-c/2})`),Mn(t,C),t.intersect=function(R){return Cn.polygon(t,w,R)},s}ie(Wce,"curvedTrapezoid");var Iat=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),jat=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),Pat=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Hce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=En.svg(s),y=jat(0,0,o,u,l,c),b=Pat(0,c,o,u,l,c),v=m.path(y,An(t,{})),x=m.path(b,An(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const m=Iat(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",ro(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Mn(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(m){const y=Cn.rect(t,m),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-b*b/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,m.y-(t.y??0)>0&&(v=-v),y.y+=v}return y},s}ie(Hce,"cylinder");async function Gce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,m=En.svg(s),y=An(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),Mn(t,x),t.intersect=function(w){return Cn.rect(t,w)},s}ie(Gce,"dividedRectangle");async function Kce(e,t){var h,m;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await dr(e,t,nr(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=En.svg(s),b=An(t,{roughness:.2,strokeWidth:2.5}),v=An(t,{roughness:.2,strokeWidth:1.5}),x=y.circle(0,0,l*2,b),w=y.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",ro(t.cssClasses)).attr("style",ro(d)),(h=u.node())==null||h.appendChild(x),(m=u.node())==null||m.appendChild(w)}else{u=s.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return Mn(t,u),t.intersect=function(y){return zt.info("DoubleCircle intersect",t,l,y),Cn.circle(t,l,y)},s}ie(Kce,"doublecircle");function Yce(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=In(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",nr(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=En.svg(i),{nodeBorder:c}=n,u=An(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),Mn(t,h),t.intersect=function(m){return zt.info("filledCircle intersect",t,{radius:a,point:m}),Cn.circle(t,a,m)},i}ie(Yce,"filledCircle");async function Zce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=En.svg(s),m=An(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Xr(u),b=h.path(y,m),v=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,Mn(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return zt.info("Triangle intersect",t,u,x),Cn.polygon(t,u,x)},s}ie(Zce,"flippedTriangle");function Xce(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=In(t);t.label="";const a=e.insert("g").attr("class",nr(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=En.svg(a),m=An(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=h.rectangle(u,d,l,c,m),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",i),Mn(t,b);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return Cn.rect(t,x)},a}ie(Xce,"forkJoin");async function Jce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await dr(e,t,nr(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=En.svg(a),m=An(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...iF(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Xr(y),v=h.path(b,m),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),Mn(t,x),t.intersect=function(w){return zt.info("Pill intersect",t,{radius:u,point:w}),Cn.polygon(t,y,w)},a}ie(Jce,"halfRoundedRectangle");var Oat=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function Qce(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=En.svg(s),y=An(t,{}),b=Oat(0,0,c,o,l),v=m.path(b,y);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=df(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,Mn(t,d),t.intersect=function(m){return Cn.polygon(t,u,m)},s}ie(Qce,"hexagon");async function eue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await dr(e,t,nr(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=En.svg(s),c=An(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=Xr(u),h=l.path(d,c),m=s.insert(()=>h,":first-child");return m.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",r),m.attr("transform",`translate(${-i/2}, ${-a/2})`),Mn(t,m),t.intersect=function(y){return zt.info("Pill intersect",t,{points:u}),Cn.polygon(t,u,y)},s}ie(eue,"hourglass");async function tue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await dr(e,t,"icon-shape default"),h=t.pos==="t",m=o,y=o,{nodeBorder:b}=n,{stylesMap:v}=_b(t),x=-y/2,w=-m/2,S=t.label?8:0,k=En.svg(c),C=An(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const R=k.rectangle(x,w,y,m,C),A=Math.max(y,u.width),N=m+u.height+S,I=k.rectangle(-A/2,-N/2,A,N,{...C,fill:"transparent",stroke:"none"}),O=c.insert(()=>R,":first-child"),B=c.insert(()=>I);if(t.icon){const D=c.append("g");D.html(`<g>${await tA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const W=D.node().getBBox(),P=W.width,Z=W.height,U=W.x,H=W.y;D.attr("transform",`translate(${-P/2-U},${h?u.height/2+S/2-Z/2-H:-u.height/2-S/2-Z/2-H})`),D.attr("style",`color: ${v.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-N/2:N/2-u.height})`),O.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),Mn(t,B),t.intersect=function(D){if(zt.info("iconSquare intersect",t,D),!t.label)return Cn.rect(t,D);const W=t.x??0,P=t.y??0,Z=t.height??0;let U=[];return h?U=[{x:W-u.width/2,y:P-Z/2},{x:W+u.width/2,y:P-Z/2},{x:W+u.width/2,y:P-Z/2+u.height+S},{x:W+y/2,y:P-Z/2+u.height+S},{x:W+y/2,y:P+Z/2},{x:W-y/2,y:P+Z/2},{x:W-y/2,y:P-Z/2+u.height+S},{x:W-u.width/2,y:P-Z/2+u.height+S}]:U=[{x:W-y/2,y:P-Z/2},{x:W+y/2,y:P-Z/2},{x:W+y/2,y:P-Z/2+m},{x:W+u.width/2,y:P-Z/2+m},{x:W+u.width/2/2,y:P+Z/2},{x:W-u.width/2,y:P+Z/2},{x:W-u.width/2,y:P-Z/2+m},{x:W-y/2,y:P-Z/2+m}],Cn.polygon(t,U,D)},c}ie(tue,"icon");async function nue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await dr(e,t,"icon-shape default"),h=20,m=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:v}=n,{stylesMap:x}=_b(t),w=En.svg(c),S=An(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=x.get("fill");S.stroke=k??v;const C=c.append("g");t.icon&&C.html(`<g>${await tA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const R=C.node().getBBox(),A=R.width,N=R.height,I=R.x,O=R.y,B=Math.max(A,N)*Math.SQRT2+h*2,D=w.circle(0,0,B,S),W=Math.max(B,u.width),P=B+u.height+m,Z=w.rectangle(-W/2,-P/2,W,P,{...S,fill:"transparent",stroke:"none"}),U=c.insert(()=>D,":first-child"),H=c.insert(()=>Z);return C.attr("transform",`translate(${-A/2-I},${y?u.height/2+m/2-N/2-O:-u.height/2-m/2-N/2-O})`),C.attr("style",`color: ${x.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-P/2:P/2-u.height})`),U.attr("transform",`translate(0,${y?u.height/2+m/2:-u.height/2-m/2})`),Mn(t,H),t.intersect=function(L){return zt.info("iconSquare intersect",t,L),Cn.rect(t,L)},c}ie(nue,"iconCircle");async function rue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await dr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=_b(t),S=-b/2,k=-y/2,C=t.label?8:0,R=En.svg(c),A=An(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=w.get("fill");A.stroke=N??x;const I=R.path(uf(S,k,b,y,5),A),O=Math.max(b,u.width),B=y+u.height+C,D=R.rectangle(-O/2,-B/2,O,B,{...A,fill:"transparent",stroke:"none"}),W=c.insert(()=>I,":first-child").attr("class","icon-shape2"),P=c.insert(()=>D);if(t.icon){const Z=c.append("g");Z.html(`<g>${await tA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=Z.node().getBBox(),H=U.width,L=U.height,ne=U.x,V=U.y;Z.attr("transform",`translate(${-H/2-ne},${m?u.height/2+C/2-L/2-V:-u.height/2-C/2-L/2-V})`),Z.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-B/2:B/2-u.height})`),W.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),Mn(t,P),t.intersect=function(Z){if(zt.info("iconSquare intersect",t,Z),!t.label)return Cn.rect(t,Z);const U=t.x??0,H=t.y??0,L=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2+u.height+C},{x:U+b/2,y:H-L/2+u.height+C},{x:U+b/2,y:H+L/2},{x:U-b/2,y:H+L/2},{x:U-b/2,y:H-L/2+u.height+C},{x:U-u.width/2,y:H-L/2+u.height+C}]:ne=[{x:U-b/2,y:H-L/2},{x:U+b/2,y:H-L/2},{x:U+b/2,y:H-L/2+y},{x:U+u.width/2,y:H-L/2+y},{x:U+u.width/2/2,y:H+L/2},{x:U-u.width/2,y:H+L/2},{x:U-u.width/2,y:H-L/2+y},{x:U-b/2,y:H-L/2+y}],Cn.polygon(t,ne,Z)},c}ie(rue,"iconRounded");async function sue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=In(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await dr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=_b(t),S=-b/2,k=-y/2,C=t.label?8:0,R=En.svg(c),A=An(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=w.get("fill");A.stroke=N??x;const I=R.path(uf(S,k,b,y,.1),A),O=Math.max(b,u.width),B=y+u.height+C,D=R.rectangle(-O/2,-B/2,O,B,{...A,fill:"transparent",stroke:"none"}),W=c.insert(()=>I,":first-child"),P=c.insert(()=>D);if(t.icon){const Z=c.append("g");Z.html(`<g>${await tA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=Z.node().getBBox(),H=U.width,L=U.height,ne=U.x,V=U.y;Z.attr("transform",`translate(${-H/2-ne},${m?u.height/2+C/2-L/2-V:-u.height/2-C/2-L/2-V})`),Z.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-B/2:B/2-u.height})`),W.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),Mn(t,P),t.intersect=function(Z){if(zt.info("iconSquare intersect",t,Z),!t.label)return Cn.rect(t,Z);const U=t.x??0,H=t.y??0,L=t.height??0;let ne=[];return m?ne=[{x:U-u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2},{x:U+u.width/2,y:H-L/2+u.height+C},{x:U+b/2,y:H-L/2+u.height+C},{x:U+b/2,y:H+L/2},{x:U-b/2,y:H+L/2},{x:U-b/2,y:H-L/2+u.height+C},{x:U-u.width/2,y:H-L/2+u.height+C}]:ne=[{x:U-b/2,y:H-L/2},{x:U+b/2,y:H-L/2},{x:U+b/2,y:H-L/2+y},{x:U+u.width/2,y:H-L/2+y},{x:U+u.width/2/2,y:H+L/2},{x:U-u.width/2,y:H+L/2},{x:U-u.width/2,y:H-L/2+y},{x:U-b/2,y:H-L/2+y}],Cn.polygon(t,ne,Z)},c}ie(sue,"iconSquare");async function iue(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=In(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:m}=await dr(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,v=-u/2,x=t.label?8:0,w=En.svg(d),S=An(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=w.rectangle(b,v,c,u,S),C=Math.max(c,h.width),R=u+h.height+x,A=w.rectangle(-C/2,-R/2,C,R,{...S,fill:"none",stroke:"none"}),N=d.insert(()=>k,":first-child"),I=d.insert(()=>A);if(t.img){const O=d.append("image");O.attr("href",t.img),O.attr("width",c),O.attr("height",u),O.attr("preserveAspectRatio","none"),O.attr("transform",`translate(${-c/2},${y?R/2-u:-R/2})`)}return m.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),N.attr("transform",`translate(0,${y?h.height/2+x/2:-h.height/2-x/2})`),Mn(t,I),t.intersect=function(O){if(zt.info("iconSquare intersect",t,O),!t.label)return Cn.rect(t,O);const B=t.x??0,D=t.y??0,W=t.height??0;let P=[];return y?P=[{x:B-h.width/2,y:D-W/2},{x:B+h.width/2,y:D-W/2},{x:B+h.width/2,y:D-W/2+h.height+x},{x:B+c/2,y:D-W/2+h.height+x},{x:B+c/2,y:D+W/2},{x:B-c/2,y:D+W/2},{x:B-c/2,y:D-W/2+h.height+x},{x:B-h.width/2,y:D-W/2+h.height+x}]:P=[{x:B-c/2,y:D-W/2},{x:B+c/2,y:D-W/2},{x:B+c/2,y:D-W/2+u},{x:B+h.width/2,y:D-W/2+u},{x:B+h.width/2/2,y:D+W/2},{x:B-h.width/2,y:D+W/2},{x:B-h.width/2,y:D-W/2+u},{x:B-c/2,y:D-W/2+u}],Cn.polygon(t,P,O)},d}ie(iue,"imageSquare");async function aue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=En.svg(s),h=An(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=df(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Cn.polygon(t,l,d)},s}ie(aue,"inv_trapezoid");async function y_(e,t,n){const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await dr(e,t,nr(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:m}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,m=n.ry),t.look==="handDrawn"){const b=En.svg(i),v=An(t,{}),x=h||m?b.path(uf(c,u,o,l,h||0),v):b.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",ro(y))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",ro(h)).attr("ry",ro(m)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return Mn(t,d),t.intersect=function(b){return Cn.rect(t,b)},i}ie(y_,"drawRect");async function oue(e,t){const{shapeSvg:n,bbox:r,label:s}=await dr(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),Mn(t,i),t.intersect=function(l){return Cn.rect(t,l)},n}ie(oue,"labelRect");async function lue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=En.svg(s),h=An(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=df(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Cn.polygon(t,l,d)},s}ie(lue,"lean_left");async function cue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=En.svg(s),h=An(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=df(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Cn.polygon(t,l,d)},s}ie(cue,"lean_right");function uue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",nr(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=En.svg(s),d=An(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Xr(c),m=u.path(h,d),y=s.insert(()=>m,":first-child");return i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),Mn(t,y),t.intersect=function(b){return zt.info("lightningBolt intersect",t,b),Cn.polygon(t,c,b)},s}ie(uue,"lightningBolt");var Dat=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),Fat=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),Lat=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function due(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:m}=t;if(t.look==="handDrawn"){const y=En.svg(s),b=Fat(0,0,o,u,l,c,d),v=Lat(0,c,o,u,l,c),x=An(t,{}),w=y.path(b,x),S=y.path(v,x);s.insert(()=>S,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),m&&h.attr("style",m)}else{const y=Dat(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",ro(m)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),Mn(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(y){const b=Cn.rect(t,y),v=b.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,y.y-(t.y??0)>0&&(x=-x),b.y+=x}return b},s}ie(due,"linedCylinder");async function fue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=En.svg(s),m=An(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...Fh(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(x=>[x.x,x.y]),m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Mn(t,v),t.intersect=function(x){return Cn.polygon(t,y,x)},s}ie(fue,"linedWaveEdgedRect");async function hue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=En.svg(s),y=An(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),k=m.path(S,{...y,fill:"none"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),Mn(t,C),t.intersect=function(R){return Cn.polygon(t,b,R)},s}ie(hue,"multiRect");async function pue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,m=5,{cssStyles:y}=t,b=Fh(d-m,h+u+m,d+o-m,h+u+m,c,.8),v=b==null?void 0:b[b.length-1],x=[{x:d-m,y:h+m},{x:d-m,y:h+u+m},...b,{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:v.y-2*m},{x:d+o+m,y:v.y-2*m},{x:d+o+m,y:h-m},{x:d+m,y:h-m},{x:d+m,y:h},{x:d,y:h},{x:d,y:h+m}],w=[{x:d,y:h+m},{x:d+o-m,y:h+m},{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:h},{x:d,y:h}],S=En.svg(s),k=An(t,{});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const C=Xr(x),R=S.path(C,k),A=Xr(w),N=S.path(A,k),I=s.insert(()=>R,":first-child");return I.insert(()=>N),I.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",r),I.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-m-(i.x-(i.left??0))}, ${-(i.height/2)+m-c/2-(i.y-(i.top??0))})`),Mn(t,I),t.intersect=function(O){return Cn.polygon(t,x,O)},s}ie(pue,"multiWaveEdgedRectangle");async function mue(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r,t.useHtmlLabels||((x=Io().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await dr(e,t,nr(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,m=En.svg(a),y=An(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=m.rectangle(u,d,l,c,y),v=a.insert(()=>b,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),Mn(t,v),t.intersect=function(w){return Cn.rect(t,w)},a}ie(mue,"note");var Bat=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function gue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=En.svg(s),m=An(t,{}),y=Bat(0,0,l),b=h.path(y,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=df(s,l,l,c);return r&&u.attr("style",r),Mn(t,u),t.intersect=function(h){return zt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,Cn.polygon(t,c,h)),Cn.polygon(t,c,h)},s}ie(gue,"question");async function yue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:m}=t,y=En.svg(s),b=An(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=Xr(h),x=y.path(v,b),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Mn(t,w),t.intersect=function(S){return Cn.polygon(t,h,S)},s}ie(yue,"rect_left_inv_arrow");async function bue(e,t){var N,I;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await cm(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Hi((I=(N=os())==null?void 0:N.flowchart)==null?void 0:I.htmlLabels)){const O=u.children[0],B=Kr(u);d=O.getBoundingClientRect(),B.attr("width",d.width),B.attr("height",d.height)}zt.info("Text 2",l);const h=l||[],m=u.getBBox(),y=o.node().appendChild(await cm(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],v=Kr(y);d=b.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;Kr(y).attr("transform","translate( "+(d.width>m.width?0:(m.width-d.width)/2)+", "+(m.height+x+5)+")"),Kr(u).attr("transform","translate( "+(d.width<m.width?0:-(m.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),S=d.height+(t.padding||0),k=-d.width/2-x,C=-d.height/2-x;let R,A;if(t.look==="handDrawn"){const O=En.svg(i),B=An(t,{}),D=O.path(uf(k,C,w,S,t.rx||0),B),W=O.line(-d.width/2-x,-d.height/2-x+m.height+x,d.width/2+x,-d.height/2-x+m.height+x,B);A=i.insert(()=>(zt.debug("Rough node insert CXC",D),W),":first-child"),R=i.insert(()=>(zt.debug("Rough node insert CXC",D),D),":first-child")}else R=a.insert("rect",":first-child"),A=a.insert("line"),R.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),A.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+m.height+x).attr("y2",-d.height/2-x+m.height+x);return Mn(t,R),t.intersect=function(O){return Cn.rect(t,O)},i}ie(bue,"rectWithTitle");async function vue(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return y_(e,t,n)}ie(vue,"roundedRect");async function xue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,m=En.svg(s),y=An(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",ro(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),Mn(t,x),t.intersect=function(w){return Cn.rect(t,w)},s}ie(xue,"shadedProcess");async function wue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=En.svg(s),m=An(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Xr(y),v=h.path(b,m),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),Mn(t,x),t.intersect=function(w){return Cn.polygon(t,y,w)},s}ie(wue,"slopedRect");async function _ue(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return y_(e,t,n)}ie(_ue,"squareRect");async function Sue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=En.svg(s),d=An(t,{}),h=uf(-o/2,-a/2,o,a,a/2),m=u.path(h,d);l=s.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",ro(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return Mn(t,l),t.intersect=function(u){return Cn.rect(t,u)},s}ie(Sue,"stadium");async function Cue(e,t){return y_(e,t,{rx:5,ry:5})}ie(Cue,"state");function kue(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=En.svg(c),d=An(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),m=o??l,y=u.circle(0,0,5,{...d,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),i&&b.selectAll("path").attr("style",i),s&&b.selectAll("path").attr("style",s),Mn(t,b),t.intersect=function(v){return Cn.circle(t,7,v)},c}ie(kue,"stateEnd");function Eue(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=En.svg(s).circle(0,0,14,vat(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return Mn(t,i),t.intersect=function(a){return Cn.circle(t,7,a)},s}ie(Eue,"stateStart");async function Tue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=En.svg(s),m=An(t,{}),y=h.rectangle(c-8,u,o+16,l,m),b=h.line(c,u,c,u+l,m),v=h.line(c+o,u,c+o,u+l,m);s.insert(()=>b,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>y,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",ro(w)),Mn(t,x)}else{const h=df(s,o,l,d);r&&h.attr("style",r),Mn(t,h)}return t.intersect=function(h){return Cn.polygon(t,d,h)},s}ie(Tue,"subroutine");async function Aue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,m=En.svg(s),y=An(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Xr(b),w=m.path(x,y),S=Xr(v),k=m.path(S,{...y,fillStyle:"solid"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),Mn(t,C),t.intersect=function(R){return Cn.polygon(t,b,R)},s}ie(Aue,"taggedRect");async function Rue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:m}=t,y=En.svg(s),b=An(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...Fh(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,S=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...Fh(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],k=Xr(v),C=y.path(k,b),R=Xr(S),A=y.path(R,{...b,fillStyle:"solid"}),N=s.insert(()=>A,":first-child");return N.insert(()=>C,":first-child"),N.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),Mn(t,N),t.intersect=function(I){return Cn.polygon(t,v,I)},s}ie(Rue,"taggedWaveEdgedRectangle");async function Nue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),Mn(t,u),t.intersect=function(d){return Cn.rect(t,d)},s}ie(Nue,"text");var $at=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),zat=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),Uat=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function Mue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await dr(e,t,nr(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:m}=t;let y;if(t.look==="handDrawn"){const b=En.svg(s),v=zat(0,0,h,c,d,u),x=Uat(0,0,h,c,d,u),w=b.path(v,An(t,{})),S=b.path(x,An(t,{fill:"none"}));y=s.insert(()=>S,":first-child"),y=s.insert(()=>w,":first-child"),y.attr("class","basic label-container"),m&&y.attr("style",m)}else{const b=$at(0,0,h,c,d,u);y=s.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",ro(m)).attr("style",r),y.attr("class","basic label-container"),m&&y.selectAll("path").attr("style",m),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),Mn(t,y),t.intersect=function(b){const v=Cn.rect(t,b),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,b.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(Mue,"tiltedCylinder");async function Iue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=En.svg(s),h=An(t,{}),m=Xr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=df(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,Mn(t,c),t.intersect=function(d){return Cn.polygon(t,l,d)},s}ie(Iue,"trapezoid");async function jue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=En.svg(s),h=An(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const m=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Xr(m),b=d.path(y,h),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),Mn(t,v),t.intersect=function(x){return Cn.polygon(t,m,x)},s}ie(jue,"trapezoidalPentagon");async function Pue(e,t){var w;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Hi((w=os().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,m=En.svg(s),y=An(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Xr(d),v=m.path(b,y),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,Mn(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(S){return zt.info("Triangle intersect",t,d,S),Cn.polygon(t,d,S)},s}ie(Pue,"triangle");async function Oue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,m=70-o,y=m>0?m/2:0,b=En.svg(s),v=An(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-y,y:u/2},...Fh(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],w=Xr(x),S=b.path(w,v),k=s.insert(()=>S,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),Mn(t,k),t.intersect=function(C){return Cn.polygon(t,x,C)},s}ie(Oue,"waveEdgedRectangle");async function Due(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await dr(e,t,nr(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const m=Math.min(h*.2,h/4),y=h+m*2,{cssStyles:b}=t,v=En.svg(s),x=An(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:y/2},...Fh(-d/2,y/2,d/2,y/2,m,1),{x:d/2,y:-y/2},...Fh(d/2,-y/2,-d/2,-y/2,m,-1)],S=Xr(w),k=v.path(S,x),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),Mn(t,C),t.intersect=function(R){return Cn.polygon(t,w,R)},s}ie(Due,"waveRectangle");async function Fue(e,t){const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await dr(e,t,nr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=En.svg(s),y=An(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),Mn(t,w),t.intersect=function(S){return Cn.polygon(t,b,S)},s}ie(Fue,"windowPane");async function aF(e,t){var ne,V,Q;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:ee}=Io(),{background:se}=ee,me={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${se}`]};await aF(e,me)}const r=Io();t.useHtmlLabels=r.htmlLabels;let s=((ne=r.er)==null?void 0:ne.diagramPadding)??10,i=((V=r.er)==null?void 0:V.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=In(t);if(n.attributes.length===0&&t.label){const ee={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};Jd(t.label,r)+ee.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const se=await y_(e,t,ee);if(!Hi(r.htmlLabels)){const me=se.select("text"),ce=(Q=me.node())==null?void 0:Q.getBBox();me.attr("transform",`translate(${-ce.width/2}, 0)`)}return se}r.htmlLabels||(s*=1.25,i*=1.25);let l=nr(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await h0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let m=0,y=0,b=0,v=0,x=!0,w=!0;for(const ee of n.attributes){const se=await h0(c,ee.type,r,0,d,["attribute-type"],o);m=Math.max(m,se.width+s);const me=await h0(c,ee.name,r,0,d,["attribute-name"],o);y=Math.max(y,me.width+s);const ce=await h0(c,ee.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,ce.width+s);const je=await h0(c,ee.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,je.width+s),d+=Math.max(se.height,me.height,ce.height,je.height)+i,h.push(d)}h.pop();let S=4;b<=s&&(x=!1,b=0,S--),v<=s&&(w=!1,v=0,S--);const k=c.node().getBBox();if(u.width+s*2-(m+y+b+v)>0){const ee=u.width+s*2-(m+y+b+v);m+=ee/S,y+=ee/S,b>0&&(b+=ee/S),v>0&&(v+=ee/S)}const C=m+y+b+v,R=En.svg(c),A=An(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=Math.max(k.width+s*2,(t==null?void 0:t.width)||0,C),I=Math.max(k.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),O=-N/2,B=-I/2;c.selectAll("g:not(:first-child)").each((ee,se,me)=>{const ce=Kr(me[se]),je=ce.attr("transform");let De=0,Se=0;if(je){const qe=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(je);qe&&(De=parseFloat(qe[1]),Se=parseFloat(qe[2]),ce.attr("class").includes("attribute-name")?De+=m:ce.attr("class").includes("attribute-keys")?De+=m+y:ce.attr("class").includes("attribute-comment")&&(De+=m+y+b))}ce.attr("transform",`translate(${O+s/2+De}, ${Se+B+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(B+i/2)+")");const D=R.rectangle(O,B,N,I,A),W=c.insert(()=>D,":first-child").attr("style",a.join("")),{themeVariables:P}=Io(),{rowEven:Z,rowOdd:U,nodeBorder:H}=P;h.push(0);for(const[ee,se]of h.entries()){if(ee===0&&h.length>1)continue;const me=ee%2===0&&se!==0,ce=R.rectangle(O,u.height+B+se,N,u.height,{...A,fill:me?Z:U,stroke:H});c.insert(()=>ce,"g.label").attr("style",a.join("")).attr("class",`row-rect-${ee%2===0?"even":"odd"}`)}let L=R.line(O,u.height+B,N+O,u.height+B,A);c.insert(()=>L).attr("class","divider"),L=R.line(m+O,u.height+B,m+O,I+B,A),c.insert(()=>L).attr("class","divider"),x&&(L=R.line(m+y+O,u.height+B,m+y+O,I+B,A),c.insert(()=>L).attr("class","divider")),w&&(L=R.line(m+y+b+O,u.height+B,m+y+b+O,I+B,A),c.insert(()=>L).attr("class","divider"));for(const ee of h)L=R.line(O,u.height+B+ee,N+O,u.height+B+ee,A),c.insert(()=>L).attr("class","divider");return Mn(t,W),t.intersect=function(ee){return Cn.rect(t,ee)},c}ie(aF,"erBox");async function h0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==xV(t)&&(t=xV(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await fp(o,t,{width:Jd(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Hi(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Kr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(h0,"addText");async function Lue(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",nr(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,m=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await vx(o,{text:`${w}`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await vx(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const w of t.members){const S=await vx(c,w,b,[w.parseClassifier()]);b+=S+i}m=c.node().getBBox().height,m<=0&&(m=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const S=await vx(u,w,v,[w.parseClassifier()]);v+=S+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(m?m+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(Lue,"textHelper");async function vx(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=Io();let a="useHtmlLabels"in t?t.useHtmlLabels:Hi(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),Ry(o)&&(a=!0);const l=await fp(s,g5(rg(o)),{width:Jd(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=Kr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const m=d.getElementsByTagName("img");if(m){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(b=>new Promise(v=>{function x(){var w;if(b.style.display="flex",b.style.flexDirection="column",y){const S=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,C=parseInt(S,10)*5+"px";b.style.minWidth=C,b.style.maxWidth=C}else b.style.width="100%";v(b)}ie(x,"setupImage"),setTimeout(()=>{b.complete&&x()}),b.addEventListener("error",x),b.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Kr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(vx,"addText");async function Bue(e,t){var I,O;const n=os(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??Hi(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await Lue(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=In(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((I=a.styles)==null?void 0:I.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((O=n.class)!=null&&O.hideEmptyMembersBox),m=En.svg(o),y=An(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-b/2,w=-v/2,S=m.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),k=o.insert(()=>S,":first-child");k.attr("class","basic label-container");const C=k.node().getBBox();o.selectAll(".text").each((B,D,W)=>{var ne;const P=Kr(W[D]),Z=P.attr("transform");let U=0;if(Z){const Q=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Z);Q&&(U=parseFloat(Q[2]))}let H=U+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(H-=4);let L=x;(P.attr("class").includes("label-group")||P.attr("class").includes("annotation-group"))&&(L=-((ne=P.node())==null?void 0:ne.getBBox().width)/2||0,o.selectAll("text").each(function(V,Q,ee){window.getComputedStyle(ee[Q]).textAnchor==="middle"&&(L=0)})),P.attr("transform",`translate(${L}, ${H})`)});const R=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,A=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,N=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const B=m.line(C.x,R+A+w+r,C.x+C.width,R+A+w+r,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const B=m.line(C.x,R+A+N+w+s*2+r,C.x+C.width,R+A+N+w+r+s*2,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),k.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const B=RegExp(/color\s*:\s*([^;]*)/),D=B.exec(d);if(D){const W=D[0].replace("color","fill");o.selectAll("tspan").attr("style",W)}else if(c){const W=B.exec(c);if(W){const P=W[0].replace("color","fill");o.selectAll("tspan").attr("style",P)}}}return Mn(t,k),t.intersect=function(B){return Cn.rect(t,B)},o}ie(Bue,"classBox");async function $ue(e,t){var R,A;const{labelStyles:n,nodeStyles:r}=In(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=nr(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await au(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await au(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const m=await au(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=m+o,l){const N=await au(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=N;const I=await au(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=I;const O=await au(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=O,await au(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const N=await au(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=N,await au(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const y=(((R=u.node())==null?void 0:R.getBBox().width)??200)+a,b=(((A=u.node())==null?void 0:A.getBBox().height)??200)+a,v=-y/2,x=-b/2,w=En.svg(u),S=An(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=w.rectangle(v,x,y,b,S),C=u.insert(()=>k,":first-child");if(C.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((N,I,O)=>{const B=Kr(O[I]),D=B.attr("transform");let W=0,P=0;if(D){const L=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(D);L&&(W=parseFloat(L[1]),P=parseFloat(L[2]))}const Z=P-b/2;let U=v+a/2;(I===0||I===1)&&(U=W),B.attr("transform",`translate(${U}, ${Z+a})`)}),h>d+m+o){const N=w.line(v,x+d+m+o,v+y,x+d+m+o,S);u.insert(()=>N).attr("style",r)}return Mn(t,C),t.intersect=function(N){return Cn.rect(t,N)},u}ie($ue,"requirementBox");async function au(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=os(),a=i.htmlLabels??!0,o=await fp(s,g5(rg(t)),{width:Jd(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=Kr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(au,"addText");var qat=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function zue(e,t,{config:n}){var D,W;const{labelStyles:r,nodeStyles:s}=In(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await dr(e,t,nr(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((D=n==null?void 0:n.kanban)!=null&&D.ticketBaseUrl)&&(d=(W=n==null?void 0:n.kanban)==null?void 0:W.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await L3(h,"ticket"in t&&t.ticket||"",m):{label:y,bbox:b}=await L3(o,"ticket"in t&&t.ticket||"",m);const{label:v,bbox:x}=await L3(o,"assigned"in t&&t.assigned||"",m);t.width=a;const w=10,S=(t==null?void 0:t.width)||0,k=Math.max(b.height,x.height)/2,C=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+k,R=-S/2,A=-C/2;c.attr("transform","translate("+(u-S/2)+", "+(-k-l.height/2)+")"),y.attr("transform","translate("+(u-S/2)+", "+(-k+l.height/2)+")"),v.attr("transform","translate("+(u+S/2-x.width-2*i)+", "+(-k+l.height/2)+")");let N;const{rx:I,ry:O}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){const P=En.svg(o),Z=An(t,{}),U=I||O?P.path(uf(R,A,S,C,I||0),Z):P.rectangle(R,A,S,C,Z);N=o.insert(()=>U,":first-child"),N.attr("class","basic label-container").attr("style",B||null)}else{N=o.insert("rect",":first-child"),N.attr("class","basic label-container __APA__").attr("style",s).attr("rx",I??5).attr("ry",O??5).attr("x",R).attr("y",A).attr("width",S).attr("height",C);const P="priority"in t&&t.priority;if(P){const Z=o.append("line"),U=R+2,H=A+Math.floor((I??0)/2),L=A+C-Math.floor((I??0)/2);Z.attr("x1",U).attr("y1",H).attr("x2",U).attr("y2",L).attr("stroke-width","4").attr("stroke",qat(P))}}return Mn(t,N),t.height=C,t.intersect=function(P){return Cn.rect(t,P)},o}ie(zue,"kanbanItem");var Vat=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:_ue},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:vue},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Sue},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Tue},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Hce},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Bce},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:gue},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:Qce},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:cue},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:lue},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Iue},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:aue},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:Kce},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:Nue},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Fce},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:xue},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Eue},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:kue},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:Xce},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:eue},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Uce},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:qce},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:Vce},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:uue},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Oue},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:Jce},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Mue},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:due},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:Wce},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:Gce},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Pue},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Fue},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:Yce},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:jue},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:Zce},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:wue},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:pue},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:hue},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Dce},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:zce},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Rue},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Aue},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Due},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:yue},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:fue}],Wat=ie(()=>{const t=[...Object.entries({state:Cue,choice:Lce,note:mue,rectWithTitle:bue,labelRect:oue,iconSquare:sue,iconCircle:nue,icon:tue,iconRounded:rue,imageSquare:iue,anchor:Oce,kanbanItem:zue,classBox:Bue,erBox:aF,requirementBox:$ue}),...Vat.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),Uue=Wat();function Hat(e){return e in Uue}ie(Hat,"isValidShape");var bA=new Map;async function que(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?Uue[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),bA.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(que,"insertNode");var Ldt=ie((e,t)=>{bA.set(t.id,e)},"setNodeElem"),Bdt=ie(()=>{bA.clear()},"clear"),$dt=ie(e=>{const t=bA.get(e.id);zt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),Gat=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&EW(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&EW(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),Kat={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},EW=ie((e,t,n,r,s,i,a)=>{var d;const o=Kat[n];if(!o){zt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),m=`${u}_${h}`;if(!document.getElementById(m)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=m,b.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${m})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),cE=new Map,ba=new Map,zdt=ie(()=>{cE.clear(),ba.clear()},"clear"),Qv=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),Yat=ie(async(e,t)=>{let n=Hi(os().flowchart.htmlLabels);const r=await fp(e,t.label,{style:Qv(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});zt.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Kr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),cE.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await cm(t.startLabelLeft,Qv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ba.get(t.id)||ba.set(t.id,{}),ba.get(t.id).startLeft=c,xx(o,t.startLabelLeft)}if(t.startLabelRight){const l=await cm(t.startLabelRight,Qv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ba.get(t.id)||ba.set(t.id,{}),ba.get(t.id).startRight=c,xx(o,t.startLabelRight)}if(t.endLabelLeft){const l=await cm(t.endLabelLeft,Qv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ba.get(t.id)||ba.set(t.id,{}),ba.get(t.id).endLeft=c,xx(o,t.endLabelLeft)}if(t.endLabelRight){const l=await cm(t.endLabelRight,Qv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ba.get(t.id)||ba.set(t.id,{}),ba.get(t.id).endRight=c,xx(o,t.endLabelRight)}return r},"insertEdgeLabel");function xx(e,t){os().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(xx,"setTerminalWidth");var Zat=ie((e,t)=>{zt.debug("Moving label abc88 ",e.id,e.label,cE.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=os(),{subGraphTitleTotalMargin:s}=C5(r);if(e.label){const i=cE.get(e.id);let a=e.x,o=e.y;if(n){const l=gu.calcLabelPosition(n);zt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=ba.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=gu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=ba.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=gu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=ba.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=gu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=ba.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=gu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),Xat=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),Jat=ie((e,t,n)=>{zt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),zt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,m=n.y<t.y?n.y+d:n.y-d;return zt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:m}),o===0&&(h=t.x,m=t.y),u===0&&(h=t.x),c===0&&(m=t.y),{x:h,y:m}}},"intersection"),TW=ie((e,t)=>{zt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(zt.info("abc88 checking point",i,t),!Xat(t,i)&&!s){const a=Jat(t,r,i);zt.debug("abc88 inside",i,r,a),zt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?zt.warn("abc88 no intersect",a,n):n.push(a),s=!0}else zt.warn("abc88 outside",i,r),r=i,s||n.push(i)}),zt.debug("returning points",n),n},"cutPathAtIntersect");function Vue(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(Vue,"extractCornerPoints");var AW=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),Qat=ie(function(e){const{cornerPointPositions:t}=Vue(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=AW(s,a,5),l=AW(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){zt.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const m=5;a.x===o.x?h={x:c<0?o.x-m+d:o.x+m-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-m+d:o.y+m-d}}else zt.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),eot=ie(function(e,t,n,r,s,i,a){var I;const{handDrawnSeed:o}=os();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const O in t.cssCompiledStyles)Ece(O)||h.push(t.cssCompiledStyles[O]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),zt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(zt.info("to cluster abc88",n.get(t.toCluster)),l=TW(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(zt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=TW(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let m=l.filter(O=>!Number.isNaN(O.y));m=Qat(m);let y=X2;switch(y=Gk,t.curve){case"linear":y=Gk;break;case"basis":y=X2;break;case"cardinal":y=hle;break;case"bumpX":y=lle;break;case"bumpY":y=cle;break;case"catmullRom":y=mle;break;case"monotoneX":y=wle;break;case"monotoneY":y=_le;break;case"natural":y=Cle;break;case"step":y=kle;break;case"stepAfter":y=Tle;break;case"stepBefore":y=Ele;break;default:y=X2}const{x:b,y:v}=wJe(t),x=ynt().x(b).y(v).curve(y);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let S,k=x(m);const C=Array.isArray(t.style)?t.style:[t.style];let R=C.find(O=>O==null?void 0:O.startsWith("stroke:"));if(t.look==="handDrawn"){const O=En.svg(e);Object.assign([],m);const B=O.path(k,{roughness:.3,seed:o});w+=" transition",S=Kr(B).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",C?C.reduce((W,P)=>W+";"+P,""):"");let D=S.attr("d");S.attr("d",D),e.node().appendChild(S.node())}else{const O=h.join(";"),B=C?C.reduce((P,Z)=>P+Z+";",""):"";let D="";t.animate&&(D=" edge-animation-fast"),t.animation&&(D=" edge-animation-"+t.animation);const W=O?O+";"+B+";":B;S=e.append("path").attr("d",k).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(D??"")).attr("style",W),R=(I=W.match(/stroke:([^;]+)/))==null?void 0:I[1]}let A="";(os().flowchart.arrowMarkerAbsolute||os().state.arrowMarkerAbsolute)&&(A=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,A=A.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),zt.info("arrowTypeStart",t.arrowTypeStart),zt.info("arrowTypeEnd",t.arrowTypeEnd),Gat(S,t,A,a,r,R);let N={};return c&&(N.updatedPath=l),N.originalPath=t.points,N},"insertEdge"),tot=ie((e,t,n,r)=>{t.forEach(s=>{yot[s](e,n,r)})},"insertMarkers"),not=ie((e,t,n)=>{zt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),rot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),sot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),iot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),aot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),oot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),lot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),cot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),uot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),dot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),fot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),hot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),pot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),mot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),got=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),yot={extension:not,composition:rot,aggregation:sot,dependency:iot,lollipop:aot,point:oot,circle:lot,cross:cot,barb:uot,only_one:dot,zero_or_one:fot,one_or_more:hot,zero_or_more:pot,requirement_arrow:mot,requirement_contains:got},bot=tot,vot={common:bb,getConfig:Io,insertCluster:Tat,insertEdge:eot,insertEdgeLabel:Yat,insertMarkers:bot,insertNode:que,interpolateToCurve:z5,labelHelper:dr,log:zt,positionEdgeLabel:Zat},c1={},Wue=ie(e=>{for(const t of e)c1[t.name]=t},"registerLayoutLoaders"),xot=ie(()=>{Wue([{name:"dagre",loader:ie(async()=>await Zr(()=>import("./dagre-OKDRZEBW-BjDabwFb.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");xot();var Udt=ie(async(e,t)=>{if(!(e.layoutAlgorithm in c1))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=c1[e.layoutAlgorithm];return(await n.loader()).render(e,t,vot,{algorithm:n.algorithm})},"render"),qdt=ie((e="",{fallback:t="dagre"}={})=>{if(e in c1)return e;if(t in c1)return zt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),RW={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},wot=ie(e=>{var s;const{securityLevel:t}=os();let n=Kr("body");if(t==="sandbox"){const a=((s=Kr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=Kr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),Hue="comm",Gue="rule",Kue="decl",_ot="@import",Sot="@namespace",Cot="@keyframes",kot="@layer",Yue=Math.abs,oF=String.fromCharCode;function Zue(e){return e.trim()}function tC(e,t,n){return e.replace(t,n)}function Eot(e,t,n){return e.indexOf(t,n)}function B0(e,t){return e.charCodeAt(t)|0}function Py(e,t,n){return e.slice(t,n)}function du(e){return e.length}function Tot(e){return e.length}function k2(e,t){return t.push(e),e}var vA=1,Oy=1,Xue=0,Kl=0,Mi=0,Sb="";function lF(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:vA,column:Oy,length:a,return:"",siblings:o}}function Aot(){return Mi}function Rot(){return Mi=Kl>0?B0(Sb,--Kl):0,Oy--,Mi===10&&(Oy=1,vA--),Mi}function Ec(){return Mi=Kl<Xue?B0(Sb,Kl++):0,Oy++,Mi===10&&(Oy=1,vA++),Mi}function dh(){return B0(Sb,Kl)}function nC(){return Kl}function xA(e,t){return Py(Sb,e,t)}function u1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Not(e){return vA=Oy=1,Xue=du(Sb=e),Kl=0,[]}function Mot(e){return Sb="",e}function B3(e){return Zue(xA(Kl-1,TP(e===91?e+2:e===40?e+1:e)))}function Iot(e){for(;(Mi=dh())&&Mi<33;)Ec();return u1(e)>2||u1(Mi)>3?"":" "}function jot(e,t){for(;--t&&Ec()&&!(Mi<48||Mi>102||Mi>57&&Mi<65||Mi>70&&Mi<97););return xA(e,nC()+(t<6&&dh()==32&&Ec()==32))}function TP(e){for(;Ec();)switch(Mi){case e:return Kl;case 34:case 39:e!==34&&e!==39&&TP(Mi);break;case 40:e===41&&TP(e);break;case 92:Ec();break}return Kl}function Pot(e,t){for(;Ec()&&e+Mi!==57;)if(e+Mi===84&&dh()===47)break;return"/*"+xA(t,Kl-1)+"*"+oF(e===47?e:Ec())}function Oot(e){for(;!u1(dh());)Ec();return xA(e,Kl)}function Dot(e){return Mot(rC("",null,null,null,[""],e=Not(e),0,[0],e))}function rC(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,m=0,y=0,b=1,v=1,x=1,w=0,S="",k=s,C=i,R=r,A=S;v;)switch(y=w,w=Ec()){case 40:if(y!=108&&B0(A,d-1)==58){Eot(A+=tC(B3(w),"&","&\f"),"&\f",Yue(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:A+=B3(w);break;case 9:case 10:case 13:case 32:A+=Iot(y);break;case 92:A+=jot(nC()-1,7);continue;case 47:switch(dh()){case 42:case 47:k2(Fot(Pot(Ec(),nC()),t,n,l),l),(u1(y||1)==5||u1(dh()||1)==5)&&du(A)&&Py(A,-1,void 0)!==" "&&(A+=" ");break;default:A+="/"}break;case 123*b:o[c++]=du(A)*x;case 125*b:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(A=tC(A,/\f/g,"")),m>0&&(du(A)-d||b===0&&y===47)&&k2(m>32?MW(A+";",r,n,d-1,l):MW(tC(A," ","")+";",r,n,d-2,l),l);break;case 59:A+=";";default:if(k2(R=NW(A,t,n,c,u,s,o,S,k=[],C=[],d,i),i),w===123)if(u===0)rC(A,t,R,R,k,i,d,o,C);else{switch(h){case 99:if(B0(A,3)===110)break;case 108:if(B0(A,2)===97)break;default:u=0;case 100:case 109:case 115:}u?rC(e,R,R,r&&k2(NW(e,R,R,0,0,s,o,S,s,k=[],d,C),C),s,C,d,o,r?k:C):rC(A,R,R,R,[""],C,0,o,C)}}c=u=m=0,b=x=1,S=A="",d=a;break;case 58:d=1+du(A),m=y;default:if(b<1){if(w==123)--b;else if(w==125&&b++==0&&Rot()==125)continue}switch(A+=oF(w),w*b){case 38:x=u>0?1:(A+="\f",-1);break;case 44:o[c++]=(du(A)-1)*x,x=1;break;case 64:dh()===45&&(A+=B3(Ec())),h=dh(),u=d=du(S=A+=Oot(nC())),w++;break;case 45:y===45&&du(A)==2&&(b=0)}}return i}function NW(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,m=s===0?i:[""],y=Tot(m),b=0,v=0,x=0;b<r;++b)for(var w=0,S=Py(e,h+1,h=Yue(v=a[b])),k=e;w<y;++w)(k=Zue(v>0?m[w]+" "+S:tC(S,/&\f/g,m[w])))&&(l[x++]=k);return lF(e,t,n,s===0?Gue:o,l,c,u,d)}function Fot(e,t,n,r){return lF(e,t,n,Hue,oF(Aot()),Py(e,2,-2),0,r)}function MW(e,t,n,r,s){return lF(e,t,n,Kue,Py(e,0,r),Py(e,r+1,-1),r,s)}function AP(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function Lot(e,t,n,r){switch(e.type){case kot:if(e.children.length)break;case _ot:case Sot:case Kue:return e.return=e.return||e.value;case Hue:return"";case Cot:return e.return=e.value+"{"+AP(e.children,r)+"}";case Gue:if(!du(e.value=e.props.join(",")))return""}return du(n=AP(e.children,r))?e.return=e.value+"{"+n+"}":""}var Bot=Mle(Object.keys,Object),$ot=Object.prototype,zot=$ot.hasOwnProperty;function Uot(e){if(!uA(e))return Bot(e);var t=[];for(var n in Object(e))zot.call(e,n)&&n!="constructor"&&t.push(n);return t}var RP=ng(Vu,"DataView"),NP=ng(Vu,"Promise"),MP=ng(Vu,"Set"),IP=ng(Vu,"WeakMap"),IW="[object Map]",qot="[object Object]",jW="[object Promise]",PW="[object Set]",OW="[object WeakMap]",DW="[object DataView]",Vot=tg(RP),Wot=tg(l1),Hot=tg(NP),Got=tg(MP),Kot=tg(IP),Kp=vb;(RP&&Kp(new RP(new ArrayBuffer(1)))!=DW||l1&&Kp(new l1)!=IW||NP&&Kp(NP.resolve())!=jW||MP&&Kp(new MP)!=PW||IP&&Kp(new IP)!=OW)&&(Kp=function(e){var t=vb(e),n=t==qot?e.constructor:void 0,r=n?tg(n):"";if(r)switch(r){case Vot:return DW;case Wot:return IW;case Hot:return jW;case Got:return PW;case Kot:return OW}return t});var Yot="[object Map]",Zot="[object Set]",Xot=Object.prototype,Jot=Xot.hasOwnProperty;function FW(e){if(e==null)return!0;if(dA(e)&&(eE(e)||typeof e=="string"||typeof e.splice=="function"||B5(e)||$5(e)||Qk(e)))return!e.length;var t=Kp(e);if(t==Yot||t==Zot)return!e.size;if(uA(e))return!Uot(e).length;for(var n in e)if(Jot.call(e,n))return!1;return!0}var Jue="c4",Qot=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),elt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-C66brPs5.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:Jue,diagram:e}},"loader"),tlt={id:Jue,detector:Qot,loader:elt},nlt=tlt,Que="flowchart",rlt=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),slt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-C7Cbrwv_.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Que,diagram:e}},"loader"),ilt={id:Que,detector:rlt,loader:slt},alt=ilt,ede="flowchart-v2",olt=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),llt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-C7Cbrwv_.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:ede,diagram:e}},"loader"),clt={id:ede,detector:olt,loader:llt},ult=clt,tde="er",dlt=ie(e=>/^\s*erDiagram/.test(e),"detector"),flt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-1L6jwj7J.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:tde,diagram:e}},"loader"),hlt={id:tde,detector:dlt,loader:flt},plt=hlt,nde="gitGraph",mlt=ie(e=>/^\s*gitGraph/.test(e),"detector"),glt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-Cj1L176Q.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:nde,diagram:e}},"loader"),ylt={id:nde,detector:mlt,loader:glt},blt=ylt,rde="gantt",vlt=ie(e=>/^\s*gantt/.test(e),"detector"),xlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-Bc7pWP_q.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:rde,diagram:e}},"loader"),wlt={id:rde,detector:vlt,loader:xlt},_lt=wlt,sde="info",Slt=ie(e=>/^\s*info/.test(e),"detector"),Clt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-C_RVqKc-.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:sde,diagram:e}},"loader"),klt={id:sde,detector:Slt,loader:Clt},ide="pie",Elt=ie(e=>/^\s*pie/.test(e),"detector"),Tlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-BaTZdgSq.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:ide,diagram:e}},"loader"),Alt={id:ide,detector:Elt,loader:Tlt},ade="quadrantChart",Rlt=ie(e=>/^\s*quadrantChart/.test(e),"detector"),Nlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-CZdsAYCM.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:ade,diagram:e}},"loader"),Mlt={id:ade,detector:Rlt,loader:Nlt},Ilt=Mlt,ode="xychart",jlt=ie(e=>/^\s*xychart-beta/.test(e),"detector"),Plt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-DK1dQ3gc.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:ode,diagram:e}},"loader"),Olt={id:ode,detector:jlt,loader:Plt},Dlt=Olt,lde="requirement",Flt=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),Llt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-BxIQixlc.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:lde,diagram:e}},"loader"),Blt={id:lde,detector:Flt,loader:Llt},$lt=Blt,cde="sequence",zlt=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),Ult=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-vAeZHIh1.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:cde,diagram:e}},"loader"),qlt={id:cde,detector:zlt,loader:Ult},Vlt=qlt,ude="class",Wlt=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),Hlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-BMKryCrh.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:ude,diagram:e}},"loader"),Glt={id:ude,detector:Wlt,loader:Hlt},Klt=Glt,dde="classDiagram",Ylt=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),Zlt=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-BMKryCrh.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:dde,diagram:e}},"loader"),Xlt={id:dde,detector:Ylt,loader:Zlt},Jlt=Xlt,fde="state",Qlt=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),ect=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-C2kKDehE.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:fde,diagram:e}},"loader"),tct={id:fde,detector:Qlt,loader:ect},nct=tct,hde="stateDiagram",rct=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),sct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-CGVFKI9g.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:hde,diagram:e}},"loader"),ict={id:hde,detector:rct,loader:sct},act=ict,pde="journey",oct=ie(e=>/^\s*journey/.test(e),"detector"),lct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-CrU5rD3D.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:pde,diagram:e}},"loader"),cct={id:pde,detector:oct,loader:lct},uct=cct,dct=ie((e,t,n)=>{zt.debug(`rendering svg for syntax error
`);const r=wot(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),Kie(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),mde={draw:dct},fct=mde,hct={db:{},renderer:mde,parser:{parse:ie(()=>{},"parse")}},pct=hct,gde="flowchart-elk",mct=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),gct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-C7Cbrwv_.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:gde,diagram:e}},"loader"),yct={id:gde,detector:mct,loader:gct},bct=yct,yde="timeline",vct=ie(e=>/^\s*timeline/.test(e),"detector"),xct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-Dzk7G27P.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:yde,diagram:e}},"loader"),wct={id:yde,detector:vct,loader:xct},_ct=wct,bde="mindmap",Sct=ie(e=>/^\s*mindmap/.test(e),"detector"),Cct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-Btd8n0Si.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:bde,diagram:e}},"loader"),kct={id:bde,detector:Sct,loader:Cct},Ect=kct,vde="kanban",Tct=ie(e=>/^\s*kanban/.test(e),"detector"),Act=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-BOJMrqji.js");return{diagram:t}},[]);return{id:vde,diagram:e}},"loader"),Rct={id:vde,detector:Tct,loader:Act},Nct=Rct,xde="sankey",Mct=ie(e=>/^\s*sankey-beta/.test(e),"detector"),Ict=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-VqXnFSpg.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:xde,diagram:e}},"loader"),jct={id:xde,detector:Mct,loader:Ict},Pct=jct,wde="packet",Oct=ie(e=>/^\s*packet-beta/.test(e),"detector"),Dct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-CXLcUM6y.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:wde,diagram:e}},"loader"),Fct={id:wde,detector:Oct,loader:Dct},_de="radar",Lct=ie(e=>/^\s*radar-beta/.test(e),"detector"),Bct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-Bal489ma.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:_de,diagram:e}},"loader"),$ct={id:_de,detector:Lct,loader:Bct},Sde="block",zct=ie(e=>/^\s*block-beta/.test(e),"detector"),Uct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-Dwnsxc5X.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:Sde,diagram:e}},"loader"),qct={id:Sde,detector:zct,loader:Uct},Vct=qct,Cde="architecture",Wct=ie(e=>/^\s*architecture/.test(e),"detector"),Hct=ie(async()=>{const{diagram:e}=await Zr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-DAGVzqzM.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:Cde,diagram:e}},"loader"),Gct={id:Cde,detector:Wct,loader:Hct},Kct=Gct,LW=!1,wA=ie(()=>{LW||(LW=!0,jk("error",pct,e=>e.toLowerCase().trim()==="error"),jk("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),Oie(nlt,Nct,Jlt,Klt,plt,_lt,klt,Alt,$lt,Vlt,bct,ult,alt,Ect,_ct,blt,act,nct,uct,Ilt,Pct,Fct,Dlt,Vct,Kct,$ct))},"addDiagrams"),Yct=ie(async()=>{zt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(Ey).map(async([n,{detector:r,loader:s}])=>{if(s)try{V4(n)}catch{try{const{diagram:i,id:a}=await s();jk(a,i,r)}catch(i){throw zt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete Ey[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){zt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)zt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),Zct="graphics-document document";function kde(e,t){e.attr("role",Zct),t!==""&&e.attr("aria-roledescription",t)}ie(kde,"setA11yDiagramInfo");function Ede(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(Ede,"addSVGa11yTitleDescription");var gm,jP=(gm=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=Io(),s=u5(t,r);t=yit(t)+`
`;try{V4(s)}catch{const d=wZe(s);if(!d)throw new Pie(`Diagram ${s} not found.`);const{id:h,diagram:m}=await d();jk(h,m)}const{db:i,parser:a,renderer:o,init:l}=V4(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new gm(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(gm,"Diagram"),gm),BW=[],Xct=ie(()=>{BW.forEach(e=>{e()}),BW=[]},"attachFunctions"),Jct=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function Tde(e){const t=e.match(jie);if(!t)return{text:e,metadata:{}};let n=xJe(t[1],{schema:vJe})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(Tde,"extractFrontMatter");var Qct=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),eut=ie(e=>{const{text:t,metadata:n}=Tde(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),tut=ie(e=>{const t=gu.detectInit(e)??{},n=gu.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:sit(e),directive:t}},"processDirectives");function cF(e){const t=Qct(e),n=eut(t),r=tut(n.text),s=H5(n.config,r.directive);return e=Jct(r.text),{code:e,title:n.title,config:s}}ie(cF,"preprocessDiagram");function Ade(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(Ade,"toBase64");var nut=5e4,rut="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",sut="sandbox",iut="loose",aut="http://www.w3.org/2000/svg",out="http://www.w3.org/1999/xlink",lut="http://www.w3.org/1999/xhtml",cut="100%",uut="100%",dut="border:0;margin:0;",fut="margin:0",hut="allow-top-navigation-by-user-activation allow-popups",put='The "iframe" tag is not supported by your browser.',mut=["foreignobject"],gut=["dominant-baseline"];function uF(e){const t=cF(e);return Mk(),FZe(t.config??{}),t}ie(uF,"processAndSetConfigs");async function Rde(e,t){wA();try{const{code:n,config:r}=uF(e);return{diagramType:(await Mde(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(Rde,"parse");var $W=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),yut=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{FW(l.styles)||o.forEach(c=>{n+=$W(l.id,c,l.styles)}),FW(l.textStyles)||(n+=$W(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),but=ie((e,t,n,r)=>{const s=yut(e,n),i=nXe(t,s,e.themeVariables);return AP(Dot(`${r}{${i}}`),Lot)},"createUserStyles"),vut=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=rg(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),xut=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":uut,r=Ade(`<body style="${fut}">${e}</body>`);return`<iframe style="width:${cut};height:${n};${dut}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${hut}">
  ${put}
</iframe>`},"putIntoIFrame"),zW=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",aut);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function PP(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(PP,"sandboxedIframe");var wut=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),_ut=ie(async function(e,t,n){var D,W,P,Z,U,H;wA();const r=uF(t);t=r.code;const s=Io();zt.debug(s),t.length>((s==null?void 0:s.maxTextSize)??nut)&&(t=rut);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const ne=Kr(h?o:c).node();ne&&"remove"in ne&&ne.remove()},"removeTempElements");let d=Kr("body");const h=s.securityLevel===sut,m=s.securityLevel===iut,y=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const L=PP(Kr(n),a);d=Kr(L.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr(n);zW(d,e,l,`font-family: ${y}`,out)}else{if(wut(document,e,l,a),h){const L=PP(Kr("body"),a);d=Kr(L.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Kr("body");zW(d,e,l)}let b,v;try{b=await jP.fromText(t,{title:r.title})}catch(L){if(s.suppressErrorRendering)throw u(),L;b=await jP.fromText("error"),v=L}const x=d.select(c).node(),w=b.type,S=x.firstChild,k=S.firstChild,C=(W=(D=b.renderer).getClasses)==null?void 0:W.call(D,t,b),R=but(s,w,C,i),A=document.createElement("style");A.innerHTML=R,S.insertBefore(A,k);try{await b.renderer.draw(t,e,RW.version,b)}catch(L){throw s.suppressErrorRendering?u():fct.draw(t,e,RW.version),L}const N=d.select(`${c} svg`),I=(Z=(P=b.db).getAccTitle)==null?void 0:Z.call(P),O=(H=(U=b.db).getAccDescription)==null?void 0:H.call(U);Ide(w,N,I,O),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",lut);let B=d.select(c).node().innerHTML;if(zt.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),B=vut(B,h,Hi(s.arrowMarkerAbsolute)),h){const L=d.select(c+" svg").node();B=xut(B,L)}else m||(B=ky.sanitize(B,{ADD_TAGS:mut,ADD_ATTR:gut,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(Xct(),v)throw v;return u(),{diagramType:w,svg:B,bindFunctions:b.db.bindFunctions}},"render");function Nde(e={}){var r;const t=wa({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),OZe(t),t!=null&&t.theme&&t.theme in $d?t.themeVariables=$d[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=$d.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?PZe(t):zie();c5(n.logLevel),wA()}ie(Nde,"initialize");var Mde=ie((e,t={})=>{const{code:n}=cF(e);return jP.fromText(n,t)},"getDiagramFromText");function Ide(e,t,n,r){kde(t,e),Ede(t,n,r,t.attr("id"))}ie(Ide,"addA11yInfo");var Fm=Object.freeze({render:_ut,parse:Rde,getDiagramFromText:Mde,initialize:Nde,getConfig:Io,setConfig:Uie,getSiteConfig:zie,updateSiteConfig:DZe,reset:ie(()=>{Mk()},"reset"),globalReset:ie(()=>{Mk(Ty)},"globalReset"),defaultConfig:Ty});c5(Io().logLevel);Mk(Io());var Sut=ie((e,t,n)=>{zt.warn(e),W5(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),jde=ie(async function(e={querySelector:".mermaid"}){try{await Cut(e)}catch(t){if(W5(t)&&zt.error(t.str),dl.parseError&&dl.parseError(t),!e.suppressErrors)throw zt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),Cut=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=Fm.getConfig();zt.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");zt.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(zt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),Fm.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new gu.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(zt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=oce(gu.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=gu.detectInit(a);u&&zt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await Fde(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){Sut(d,o,dl.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),Pde=ie(function(e){Fm.initialize(e)},"initialize"),kut=ie(async function(e,t,n){zt.warn("mermaid.init is deprecated. Please use run instead."),e&&Pde(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await jde(r)},"init"),Eut=ie(async(e,{lazyLoad:t=!0}={})=>{wA(),Oie(...e),t===!1&&await Yct()},"registerExternalDiagrams"),Ode=ie(function(){if(dl.startOnLoad){const{startOnLoad:e}=Fm.getConfig();e&&dl.run().catch(t=>zt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",Ode,!1);var Tut=ie(function(e){dl.parseError=e},"setParseErrorHandler"),uE=[],$3=!1,Dde=ie(async()=>{if(!$3){for($3=!0;uE.length>0;){const e=uE.shift();if(e)try{await e()}catch(t){zt.error("Error executing queue",t)}}$3=!1}},"executeQueue"),Aut=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{Fm.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;zt.error("Error parsing",o),(l=dl.parseError)==null||l.call(dl,o),a(o),r(o)})}),"performCall");uE.push(s),Dde().catch(r)}),"parse"),Fde=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{Fm.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;zt.error("Error parsing",l),(c=dl.parseError)==null||c.call(dl,l),o(l),s(l)})}),"performCall");uE.push(i),Dde().catch(s)}),"render"),dl={startOnLoad:!0,mermaidAPI:Fm,parse:Aut,render:Fde,init:kut,run:jde,registerExternalDiagrams:Eut,registerLayoutLoaders:Wue,initialize:Pde,parseError:void 0,contentLoaded:Ode,setParseErrorHandler:Tut,detectType:u5,registerIconPacks:qJe},Rut=dl;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const Nut=new DOMParser,Mut=new XMLSerializer;function UW(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let qW=0;const Iut=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${qW}`;qW+=1;const{svg:a}=await Rut.render(i,s,n),o=Nut.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=UW(l,"aria-describedby"),h=UW(l,"aria-labelledby"),m={height:c,id:i,svg:Mut.serializeToString(l),width:u};return d&&(m.description=d),h&&(m.title=h),m}));return n.remove(),r},jut=()=>Iut,Put=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=mr(gn(R=>({foldStreamingCodeBlocks:R.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),m=E.useRef(null),y=Ui(gn(R=>Object.values(R.canvasControls))),b=E.useCallback((R,A,N,I,O)=>y.filter(B=>B.type==="codeblock"&&B.targetSlot===R&&B.renderer).map(B=>{if(B.renderer){const D={codeBlockContent:A,codeBlockLang:"mermaid",isFolded:I,toggleFold:O,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:B.renderer(D)},B.id)}return null}).filter(Boolean),[y]),v=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const A=await jut()([e]);if(A.length>0&&A[0].status==="fulfilled")a(A[0].value.svg);else if(A.length>0&&A[0].status==="rejected"){const N=A[0].reason;u((N==null?void 0:N.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(R){console.error("Mermaid rendering error:",R),u(R instanceof Error?R.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&v()},[e,r,d,v]);const x=()=>{const R=r;s(A=>!A),R&&!d&&setTimeout(v,0)},w=E.useCallback(async()=>{if(!i){Me.error("No SVG content to download");return}try{const R=new Blob([i],{type:"image/svg+xml"}),A=URL.createObjectURL(R),N=document.createElement("a");N.href=A,N.download="mermaid-diagram.svg",document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(A),Me.success("SVG downloaded successfully!")}catch(R){console.error("Download error:",R),Me.error("Failed to download SVG")}},[i]),S=E.useCallback(()=>{h(R=>!R)},[]),k=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),C=b("codeblock-header-actions",e,"mermaid",r,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:C})]}),f.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:S,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show diagram":"Show code",children:d?f.jsx(Y0,{className:"h-4 w-4"}):f.jsx(pE,{className:"h-4 w-4"})}),i&&!d&&f.jsx("button",{onClick:w,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:"Download SVG",children:f.jsx(wc,{className:"h-4 w-4"})})]})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(l5,{lang:"mermaid",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Yn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Wl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:m,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:k})})]})},Out=E.memo(Put);class Dut{constructor(){de(this,"id","core-block-renderer-mermaid");de(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["mermaid"],priority:10,renderer:r=>Ve.createElement(Out,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}class Yp{static parse(t){try{const n=this.sanitizeCode(t),r=this.parseObjectLiteral(n);return this.validateAndSanitize(r)}catch(n){throw new Error(`Failed to parse Formedible definition: ${n instanceof Error?n.message:String(n)}`)}}static sanitizeCode(t){let n=t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return n=n.replace(/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,""),n=n.replace(/=>\s*{[^}]*}/g,'""'),n=n.replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""'),n}static parseObjectLiteral(t){try{return JSON.parse(t)}catch{try{let r=t.trim();return r=this.replaceZodExpressions(r),r=r.replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":'),r=r.replace(/,(\s*[}\]])/g,"$1"),r=r.replace(/'/g,'"'),JSON.parse(r)}catch(r){throw new Error(`Invalid syntax. Please use valid JSON format or JavaScript object literal syntax. Error: ${r instanceof Error?r.message:String(r)}`)}}}static replaceZodExpressions(t){let n=t,r=!0;for(;r;){r=!1;const s=n.match(/z\.[a-zA-Z]+\(/);if(s){const i=s.index,a=i+s[0].length-1;let o=1,l=a+1;for(;l<n.length&&o>0;)n[l]==="("?o++:n[l]===")"&&o--,l++;if(o===0){let c=l;for(;c<n.length;){const u=n.slice(c).match(/^\.[a-zA-Z]+\(/);if(u){let d=1,m=c+u[0].length-1+1;for(;m<n.length&&d>0;)n[m]==="("?d++:n[m]===")"&&d--,m++;if(d===0)c=m;else break}else break}n=n.slice(0,i)+'"__ZOD_SCHEMA__"'+n.slice(c),r=!0}else n=n.replace(/z\.[a-zA-Z]+/,'"__ZOD_SCHEMA__"'),r=!0}}return n}static validateAndSanitize(t){if(typeof t!="object"||t===null)throw new Error("Definition must be an object");const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_KEYS.includes(r))switch(r){case"schema":break;case"fields":n[r]=this.validateFields(s);break;case"pages":n[r]=this.validatePages(s);break;case"progress":n[r]=this.validateProgress(s);break;case"formOptions":n[r]=this.validateFormOptions(s);break;case"submitLabel":case"nextLabel":case"previousLabel":case"formClassName":case"fieldClassName":typeof s=="string"&&(n[r]=s);break}return n}static validateFields(t){if(!Array.isArray(t))throw new Error("Fields must be an array");return t.map((n,r)=>{if(typeof n!="object"||n===null)throw new Error(`Field at index ${r} must be an object`);const s={};for(const[i,a]of Object.entries(n))if(this.ALLOWED_FIELD_KEYS.includes(i))switch(i){case"name":typeof a=="string"&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(a)&&(s[i]=a);break;case"type":typeof a=="string"&&this.ALLOWED_FIELD_TYPES.includes(a)&&(s[i]=a);break;case"label":case"placeholder":case"description":case"accept":typeof a=="string"&&(s[i]=a);break;case"options":Array.isArray(a)&&(s[i]=a.filter(o=>typeof o=="string"||typeof o=="object"&&o!==null&&typeof o.value=="string"&&typeof o.label=="string"));break;case"min":case"max":case"step":case"page":typeof a=="number"&&!isNaN(a)&&(s[i]=a);break;case"multiple":typeof a=="boolean"&&(s[i]=a);break}if(!s.name||!s.type)throw new Error(`Field at index ${r} must have 'name' and 'type' properties`);return s})}static validatePages(t){return Array.isArray(t)?t.map(n=>{if(typeof n!="object"||n===null)return null;const r={};for(const[s,i]of Object.entries(n))if(this.ALLOWED_PAGE_KEYS.includes(s))switch(s){case"page":typeof i=="number"&&!isNaN(i)&&(r[s]=i);break;case"title":case"description":typeof i=="string"&&(r[s]=i);break}return r.page?r:null}).filter(Boolean):[]}static validateProgress(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_PROGRESS_KEYS.includes(r))switch(r){case"showSteps":case"showPercentage":typeof s=="boolean"&&(n[r]=s);break;case"className":typeof s=="string"&&(n[r]=s);break}return n}static validateFormOptions(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_FORM_OPTIONS_KEYS.includes(r))switch(r){case"defaultValues":typeof s=="object"&&s!==null&&(n[r]=s);break;case"asyncDebounceMs":typeof s=="number"&&!isNaN(s)&&(n[r]=s);break;case"canSubmitWhenInvalid":typeof s=="boolean"&&(n[r]=s);break}return n}}de(Yp,"ALLOWED_FIELD_TYPES",["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file"]),de(Yp,"ALLOWED_KEYS",["schema","fields","pages","progress","submitLabel","nextLabel","previousLabel","formClassName","fieldClassName","formOptions"]),de(Yp,"ALLOWED_FIELD_KEYS",["name","type","label","placeholder","description","options","min","max","step","accept","multiple","page","conditional"]),de(Yp,"ALLOWED_PAGE_KEYS",["page","title","description"]),de(Yp,"ALLOWED_PROGRESS_KEYS",["showSteps","showPercentage","className"]),de(Yp,"ALLOWED_FORM_OPTIONS_KEYS",["defaultValues","asyncDebounceMs","canSubmitWhenInvalid"]);const Fut=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=mr(gn(W=>({foldStreamingCodeBlocks:W.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState(!1),b=E.useMemo(()=>`_sendOnSubmit_${ws()}`,[]),v=Ui(gn(W=>Object.values(W.canvasControls))),x=E.useCallback((W,P,Z,U,H)=>v.filter(L=>L.type==="codeblock"&&L.targetSlot===W&&L.renderer).map(L=>{if(L.renderer){const ne={codeBlockContent:P,codeBlockLang:"formedible",isFolded:U,toggleFold:H,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:L.renderer(ne)},L.id)}return null}).filter(Boolean),[v]),w=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const W=Yp.parse(e);a(W)}catch(W){console.error("Formedible parsing error:",W),u(W instanceof Error?W.message:"Failed to parse Formedible definition")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&!t&&w()},[e,r,d,t,w]);const S=()=>{const W=r;s(P=>!P),W&&!d&&setTimeout(w,0)},k=E.useCallback(()=>{h(W=>!W)},[]),C=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),R=E.useCallback(W=>{const P={};return W.forEach(Z=>{switch(Z.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":P[Z.name]=$e();break;case"number":case"slider":P[Z.name]=Tt();break;case"checkbox":case"switch":P[Z.name]=Gn();break;case"date":P[Z.name]=obe();break;case"select":P[Z.name]=$e();break;case"file":P[Z.name]=qd();break;default:P[Z.name]=$e()}}),Ge(P)},[]),A=E.useCallback(W=>{const P={};return W.forEach(Z=>{switch(Z.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":P[Z.name]="";break;case"number":case"slider":P[Z.name]=Z.min||0;break;case"checkbox":case"switch":P[Z.name]=!1;break;case"date":P[Z.name]=new Date().toISOString().split("T")[0];break;case"select":if(Z.options&&Z.options.length>0){const U=Z.options[0];P[Z.name]=typeof U=="string"?U:U.value}else P[Z.name]="";break;case"file":P[Z.name]=null;break;default:P[Z.name]=""}}),P},[]),N=E.useCallback(async(W,P)=>{try{const U=`These are the form values:
\`\`\`json
${JSON.stringify(W,null,2)}
\`\`\`
`;Pe.emit(yn.setInputTextRequest,{text:U}),Pe.emit(yn.focusInputRequest,void 0),console.log("Formedible: sendOnSubmit value before conditional: ",P),P?(console.log("Sending form data to prompt"),requestAnimationFrame(()=>{console.log("Setting input text");try{console.log("Creating turn data");const H={id:ws(),content:U,parameters:{},metadata:{}};Pe.emit(yn.submitPromptRequest,{turnData:H}),Me.success("Form submitted and prompt sent!")}catch(H){console.error("Failed to submit prompt:",H),Me.error("Form data added to input, but failed to send prompt")}})):Me.success("Form data added to prompt input")}catch(Z){console.error("Form submission error:",Z),Me.error("Failed to process form submission")}},[]),I=E.useMemo(()=>{var W;if(!i||!i.fields)return null;try{const P=R(i.fields),Z=((W=i.formOptions)==null?void 0:W.defaultValues)||A(i.fields),U=i.pages&&i.pages.length>0?Math.max(...i.pages.map(V=>V.page)):1,H=[...i.fields,{name:b,type:"switch",label:"Send on submit",description:"Automatically send the prompt after form submission",page:U}],L=P.extend({[b]:Gn().default(!1)}),ne={...Z,[b]:!1};return{schema:L,fields:H,pages:i.pages,progress:i.progress,submitLabel:i.submitLabel||"Submit",nextLabel:i.nextLabel||"Next",previousLabel:i.previousLabel||"Previous",formClassName:i.formClassName,fieldClassName:i.fieldClassName,formOptions:{...i.formOptions,defaultValues:ne,canSubmitWhenInvalid:!0,onSubmit:async({value:V})=>{console.log("Formedible onSubmit received full value:",V),console.log("Formedible onSubmit received sendOnSubmit:",V[b]);const Q=V[b],ee={...V};delete ee[b],y(Q),await N(ee,Q)},onSubmitInvalid:({value:V,formApi:Q})=>{console.error("Formedible onSubmitInvalid triggered. Values:",V),console.error("Formedible onSubmitInvalid triggered. Form API errors:",Q.formState.errors),Me.error("Form has validation errors. Please check your input.")}},disabled:!1}}catch(P){return console.error("Form configuration error:",P),{error:P instanceof Error?P.message:"Unknown error"}}},[i,R,A,N,b]),O=VT(I&&!("error"in I)?I:{fields:[],formOptions:{defaultValues:{}}}),B=E.useMemo(()=>I?"error"in I?f.jsx("div",{className:"p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:f.jsxs("div",{className:"text-sm text-destructive",children:["Failed to render form: ",I.error]})}):!i||!i.fields?null:f.jsx(O.Form,{}):null,[I,i,O.Form]),D=x("codeblock-header-actions",e,"formedible",r,S);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"FORMEDIBLE"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:D})]}),f.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx("button",{onClick:k,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show form":"Show code",children:d?f.jsx(pge,{className:"h-4 w-4"}):f.jsx(pE,{className:"h-4 w-4"})})})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(l5,{lang:"formedible",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Yn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Parsing form definition..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Wl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to parse Formedible definition"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),B&&!o&&!c&&f.jsxs("div",{className:"p-4 bg-background border rounded-md",children:[f.jsx("div",{className:"mb-4 p-2 bg-muted/50 rounded text-xs text-muted-foreground",children:" Interactive Form - Fill out and submit to add data to prompt input"}),B]})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:S,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:C})})]})},Lut=E.memo(Fut);class But{constructor(){de(this,"id","core-block-renderer-formedible");de(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["formedible"],priority:10,renderer:r=>Ve.createElement(Lut,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}const $ut=[sVe,gHe,SHe,EKe,XKe,nYe,iYe,F$e,$9e,L9e,Aqe,Rqe,nVe,Fqe,Bqe,zqe,aVe,hze,dUe,eVe,Mqe,GUe,cze,Pqe,lVe,iHe,fHe,TUe,RUe,DUe,UUe,qUe,$Ye,Dut,But,oYe,vYe,wYe,cYe,dYe,mYe,hYe,SYe,kYe,AYe,yYe,IYe];function zut(){return f.jsxs(j$e,{children:[f.jsx(M$e,{}),f.jsx(N$e,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(C$e,{controls:$ut})})})]})}h0e();mhe.createRoot(document.getElementById("root")).render(f.jsx(Ve.StrictMode,{children:f.jsx(zut,{})}));export{hnt as $,Lx as A,vZe as B,dXe as C,H5 as D,Io as E,Bie as F,cit as G,wot as H,RW as I,vJe as J,TZe as K,Ry as L,_dt as M,fA as N,d5 as O,xV as P,ynt as Q,X2 as R,lit as S,c_ as T,QZe as U,l_ as V,_n as W,$n as X,Yie as Y,eit as Z,ie as _,iXe as a,VYe as a$,I5 as a0,Adt as a1,Mdt as a2,a0 as a3,GV as a4,HV as a5,jdt as a6,Idt as a7,Ndt as a8,Edt as a9,Zst as aA,Urt as aB,qst as aC,F5 as aD,FW as aE,eat as aF,pnt as aG,Sa as aH,tA as aI,qJe as aJ,UJe as aK,eg as aL,Xst as aM,Ble as aN,oA as aO,dA as aP,eE as aQ,zle as aR,Lle as aS,Tst as aT,To as aU,$et as aV,T5 as aW,Hoe as aX,f_ as aY,Yoe as aZ,kdt as a_,Tdt as aa,Odt as ab,Rdt as ac,Pdt as ad,Tat as ae,que as af,$dt as ag,wJe as ah,Hi as ai,fp as aj,C5 as ak,yce as al,rg as am,Gle as an,cr as ao,Du as ap,y0 as aq,bot as ar,Bdt as as,zdt as at,Fdt as au,Mn as av,Ldt as aw,eot as ax,Zat as ay,Yat as az,sXe as b,A5 as b0,ah as b1,$V as b2,Get as b3,i1 as b4,Yst as b5,Ust as b6,Rrt as b7,L5 as b8,Sst as b9,Ni as bA,Zr as bB,Qst as ba,p_ as bb,vb as bc,Xk as bd,Pst as be,Uot as bf,h_ as bg,Qk as bh,Ast as bi,Ile as bj,Irt as bk,jrt as bl,Kp as bm,lW as bn,Prt as bo,B5 as bp,Mrt as bq,Frt as br,xb as bs,dp as bt,rW as bu,$5 as bv,Ple as bw,MP as bx,Jst as by,uA as bz,os as c,Kr as d,Kie as e,wa as f,oXe as g,Jd as h,Im as i,GJe as j,bb as k,zt as l,Yle as m,Sdt as n,qdt as o,lXe as p,cXe as q,Udt as r,aXe as s,xJe as t,gu as u,Hat as v,fit as w,Ddt as x,rXe as y,Cdt as z};
