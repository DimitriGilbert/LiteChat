const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-ji5THaZ7.js","assets/graph-Ci0Kgt7D.js","assets/_baseUniq-C5gN_mdA.js","assets/layout-B31Dmfxf.js","assets/_basePickBy-UN2b6qF3.js","assets/clone-CY4RN7cd.js","assets/c4Diagram-VJAJSXHY-Ch5Uo_Zg.js","assets/chunk-D6G4REZN-B7xihGKR.js","assets/flowDiagram-4HSFHLVR-CwHcuQCt.js","assets/chunk-RZ5BOZE2-DwkFe4aM.js","assets/channel-BHt7CQkB.js","assets/erDiagram-Q7BY3M3F-DNyKjoxr.js","assets/gitGraphDiagram-7IBYFJ6S-D0UafhDo.js","assets/chunk-4BMEZGHF-Cb9qT5Yd.js","assets/chunk-XZIHB7SX-83KQDZiO.js","assets/radar-MK3ICKWK-Brk8rhXt.js","assets/ganttDiagram-APWFNJXF-CFVgmY2g.js","assets/linear-BA8vl0bl.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-rQ-DVwCM.js","assets/pieDiagram-IB7DONF6-BQeroX41.js","assets/arc-DHSs2tH5.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-BQCJO31M.js","assets/xychartDiagram-VJFVF3MP-Cga-8etu.js","assets/requirementDiagram-KVF5MWMF-HPZT71Wm.js","assets/sequenceDiagram-X6HHIX6F-BxyPNmiq.js","assets/classDiagram-GIVACNV2-DGbwr2Dn.js","assets/chunk-A2AXSNBT-JejtE4SR.js","assets/classDiagram-v2-COTLJTTW-DGbwr2Dn.js","assets/stateDiagram-DGXRK772-DsASCFOu.js","assets/chunk-AEK57VVT-CA3qLpJb.js","assets/stateDiagram-v2-YXO3MK2T-CWqWliNZ.js","assets/journeyDiagram-U35MCT3I-D1Pv6_md.js","assets/timeline-definition-BDJGKUSR-DbdJxsmN.js","assets/mindmap-definition-ALO5MXBD-D59GPnpC.js","assets/cytoscape.esm-rauTjtkh.js","assets/sankeyDiagram-QLVOVGJD-D8MnYMw9.js","assets/diagram-VNBRO52H-DTJcd4FQ.js","assets/diagram-SSKATNLV-DUjMcu2H.js","assets/blockDiagram-JOT3LUYC-BmASdRVq.js","assets/architectureDiagram-IEHRJDOE-CmcroAkn.js"])))=>i.map(i=>d[i]);
var Gue=Object.defineProperty;var Kue=(e,t,n)=>t in e?Gue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var _e=(e,t,n)=>Kue(e,typeof t!="symbol"?t+"":t,n);function Yue(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var cp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function aa(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var MR={exports:{}},zb={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J8;function Zue(){if(J8)return zb;J8=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var o in i)o!=="key"&&(s[o]=i[o])}else s=i;return i=s.ref,{$$typeof:e,type:r,key:a,ref:i!==void 0?i:null,props:s}}return zb.Fragment=t,zb.jsx=n,zb.jsxs=n,zb}var Q8;function Xue(){return Q8||(Q8=1,MR.exports=Zue()),MR.exports}var m=Xue(),NR={exports:{}};function Jue(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pV={exports:{}},ss=pV.exports={},Pc,Dc;function o3(){throw new Error("setTimeout has not been defined")}function l3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Pc=setTimeout:Pc=o3}catch{Pc=o3}try{typeof clearTimeout=="function"?Dc=clearTimeout:Dc=l3}catch{Dc=l3}})();function mV(e){if(Pc===setTimeout)return setTimeout(e,0);if((Pc===o3||!Pc)&&setTimeout)return Pc=setTimeout,setTimeout(e,0);try{return Pc(e,0)}catch{try{return Pc.call(null,e,0)}catch{return Pc.call(this,e,0)}}}function Que(e){if(Dc===clearTimeout)return clearTimeout(e);if((Dc===l3||!Dc)&&clearTimeout)return Dc=clearTimeout,clearTimeout(e);try{return Dc(e)}catch{try{return Dc.call(null,e)}catch{return Dc.call(this,e)}}}var Qu=[],Lg=!1,up,GS=-1;function ede(){!Lg||!up||(Lg=!1,up.length?Qu=up.concat(Qu):GS=-1,Qu.length&&gV())}function gV(){if(!Lg){var e=mV(ede);Lg=!0;for(var t=Qu.length;t;){for(up=Qu,Qu=[];++GS<t;)up&&up[GS].run();GS=-1,t=Qu.length}up=null,Lg=!1,Que(e)}}ss.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Qu.push(new yV(e,t)),Qu.length===1&&!Lg&&mV(gV)};function yV(e,t){this.fun=e,this.array=t}yV.prototype.run=function(){this.fun.apply(null,this.array)};ss.title="browser";ss.browser=!0;ss.env={};ss.argv=[];ss.version="";ss.versions={};function Sd(){}ss.on=Sd;ss.addListener=Sd;ss.once=Sd;ss.off=Sd;ss.removeListener=Sd;ss.removeAllListeners=Sd;ss.emit=Sd;ss.prependListener=Sd;ss.prependOnceListener=Sd;ss.listeners=function(e){return[]};ss.binding=function(e){throw new Error("process.binding is not supported")};ss.cwd=function(){return"/"};ss.chdir=function(e){throw new Error("process.chdir is not supported")};ss.umask=function(){return 0};var tde=pV.exports;const es=Jue(tde);var vr={},eL;function nde(){if(eL)return vr;eL=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(G){return G===null||typeof G!="object"?null:(G=d&&G[d]||G["@@iterator"],typeof G=="function"?G:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(G,ne,te){this.props=G,this.context=ne,this.refs=b,this.updater=te||p}x.prototype.isReactComponent={},x.prototype.setState=function(G,ne){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,ne,"setState")},x.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function w(){}w.prototype=x.prototype;function _(G,ne,te){this.props=G,this.context=ne,this.refs=b,this.updater=te||p}var S=_.prototype=new w;S.constructor=_,y(S,x.prototype),S.isPureReactComponent=!0;var C=Array.isArray,E={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function R(G,ne,te,se,pe,de){return te=de.ref,{$$typeof:e,type:G,key:ne,ref:te!==void 0?te:null,props:de}}function M(G,ne){return R(G.type,ne,void 0,void 0,void 0,G.props)}function N(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function O(G){var ne={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(te){return ne[te]})}var B=/\/+/g;function P(G,ne){return typeof G=="object"&&G!==null&&G.key!=null?O(""+G.key):ne.toString(36)}function H(){}function F(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(H,H):(G.status="pending",G.then(function(ne){G.status==="pending"&&(G.status="fulfilled",G.value=ne)},function(ne){G.status==="pending"&&(G.status="rejected",G.reason=ne)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function Q(G,ne,te,se,pe){var de=typeof G;(de==="undefined"||de==="boolean")&&(G=null);var Ne=!1;if(G===null)Ne=!0;else switch(de){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(G.$$typeof){case e:case t:Ne=!0;break;case u:return Ne=G._init,Q(Ne(G._payload),ne,te,se,pe)}}if(Ne)return pe=pe(G),Ne=se===""?"."+P(G,0):se,C(pe)?(te="",Ne!=null&&(te=Ne.replace(B,"$&/")+"/"),Q(pe,ne,te,"",function(Ee){return Ee})):pe!=null&&(N(pe)&&(pe=M(pe,te+(pe.key==null||G&&G.key===pe.key?"":(""+pe.key).replace(B,"$&/")+"/")+Ne)),ne.push(pe)),1;Ne=0;var Pe=se===""?".":se+":";if(C(G))for(var Me=0;Me<G.length;Me++)se=G[Me],de=Pe+P(se,Me),Ne+=Q(se,ne,te,de,pe);else if(Me=h(G),typeof Me=="function")for(G=Me.call(G),Me=0;!(se=G.next()).done;)se=se.value,de=Pe+P(se,Me++),Ne+=Q(se,ne,te,de,pe);else if(de==="object"){if(typeof G.then=="function")return Q(F(G),ne,te,se,pe);throw ne=String(G),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function q(G,ne,te){if(G==null)return G;var se=[],pe=0;return Q(G,se,"","",function(de){return ne.call(te,de,pe++)}),se}function K(G){if(G._status===-1){var ne=G._result;ne=ne(),ne.then(function(te){(G._status===0||G._status===-1)&&(G._status=1,G._result=te)},function(te){(G._status===0||G._status===-1)&&(G._status=2,G._result=te)}),G._status===-1&&(G._status=0,G._result=ne)}if(G._status===1)return G._result.default;throw G._result}var U=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ne=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(ne))return}else if(typeof es=="object"&&typeof es.emit=="function"){es.emit("uncaughtException",G);return}console.error(G)};function re(){}return vr.Children={map:q,forEach:function(G,ne,te){q(G,function(){ne.apply(this,arguments)},te)},count:function(G){var ne=0;return q(G,function(){ne++}),ne},toArray:function(G){return q(G,function(ne){return ne})||[]},only:function(G){if(!N(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},vr.Component=x,vr.Fragment=n,vr.Profiler=i,vr.PureComponent=_,vr.StrictMode=r,vr.Suspense=l,vr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,vr.__COMPILER_RUNTIME={__proto__:null,c:function(G){return E.H.useMemoCache(G)}},vr.cache=function(G){return function(){return G.apply(null,arguments)}},vr.cloneElement=function(G,ne,te){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var se=y({},G.props),pe=G.key,de=void 0;if(ne!=null)for(Ne in ne.ref!==void 0&&(de=void 0),ne.key!==void 0&&(pe=""+ne.key),ne)!T.call(ne,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&ne.ref===void 0||(se[Ne]=ne[Ne]);var Ne=arguments.length-2;if(Ne===1)se.children=te;else if(1<Ne){for(var Pe=Array(Ne),Me=0;Me<Ne;Me++)Pe[Me]=arguments[Me+2];se.children=Pe}return R(G.type,pe,void 0,void 0,de,se)},vr.createContext=function(G){return G={$$typeof:a,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:s,_context:G},G},vr.createElement=function(G,ne,te){var se,pe={},de=null;if(ne!=null)for(se in ne.key!==void 0&&(de=""+ne.key),ne)T.call(ne,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(pe[se]=ne[se]);var Ne=arguments.length-2;if(Ne===1)pe.children=te;else if(1<Ne){for(var Pe=Array(Ne),Me=0;Me<Ne;Me++)Pe[Me]=arguments[Me+2];pe.children=Pe}if(G&&G.defaultProps)for(se in Ne=G.defaultProps,Ne)pe[se]===void 0&&(pe[se]=Ne[se]);return R(G,de,void 0,void 0,null,pe)},vr.createRef=function(){return{current:null}},vr.forwardRef=function(G){return{$$typeof:o,render:G}},vr.isValidElement=N,vr.lazy=function(G){return{$$typeof:u,_payload:{_status:-1,_result:G},_init:K}},vr.memo=function(G,ne){return{$$typeof:c,type:G,compare:ne===void 0?null:ne}},vr.startTransition=function(G){var ne=E.T,te={};E.T=te;try{var se=G(),pe=E.S;pe!==null&&pe(te,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(re,U)}catch(de){U(de)}finally{E.T=ne}},vr.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},vr.use=function(G){return E.H.use(G)},vr.useActionState=function(G,ne,te){return E.H.useActionState(G,ne,te)},vr.useCallback=function(G,ne){return E.H.useCallback(G,ne)},vr.useContext=function(G){return E.H.useContext(G)},vr.useDebugValue=function(){},vr.useDeferredValue=function(G,ne){return E.H.useDeferredValue(G,ne)},vr.useEffect=function(G,ne,te){var se=E.H;if(typeof te=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return se.useEffect(G,ne)},vr.useId=function(){return E.H.useId()},vr.useImperativeHandle=function(G,ne,te){return E.H.useImperativeHandle(G,ne,te)},vr.useInsertionEffect=function(G,ne){return E.H.useInsertionEffect(G,ne)},vr.useLayoutEffect=function(G,ne){return E.H.useLayoutEffect(G,ne)},vr.useMemo=function(G,ne){return E.H.useMemo(G,ne)},vr.useOptimistic=function(G,ne){return E.H.useOptimistic(G,ne)},vr.useReducer=function(G,ne,te){return E.H.useReducer(G,ne,te)},vr.useRef=function(G){return E.H.useRef(G)},vr.useState=function(G){return E.H.useState(G)},vr.useSyncExternalStore=function(G,ne,te){return E.H.useSyncExternalStore(G,ne,te)},vr.useTransition=function(){return E.H.useTransition()},vr.version="19.1.0",vr}var tL;function Ew(){return tL||(tL=1,NR.exports=nde()),NR.exports}var A=Ew();const ut=aa(A),bV=Yue({__proto__:null,default:ut},[A]);var jR={exports:{}},Ub={},OR={exports:{}},PR={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nL;function rde(){return nL||(nL=1,function(e){function t(q,K){var U=q.length;q.push(K);e:for(;0<U;){var re=U-1>>>1,G=q[re];if(0<i(G,K))q[re]=K,q[U]=G,U=re;else break e}}function n(q){return q.length===0?null:q[0]}function r(q){if(q.length===0)return null;var K=q[0],U=q.pop();if(U!==K){q[0]=U;e:for(var re=0,G=q.length,ne=G>>>1;re<ne;){var te=2*(re+1)-1,se=q[te],pe=te+1,de=q[pe];if(0>i(se,U))pe<G&&0>i(de,se)?(q[re]=de,q[pe]=U,re=pe):(q[re]=se,q[te]=U,re=te);else if(pe<G&&0>i(de,U))q[re]=de,q[pe]=U,re=pe;else break e}}return K}function i(q,K){var U=q.sortIndex-K.sortIndex;return U!==0?U:q.id-K.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,p=!1,y=!1,b=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(q){for(var K=n(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=q)r(c),K.sortIndex=K.expirationTime,t(l,K);else break;K=n(c)}}function E(q){if(b=!1,C(q),!y)if(n(l)!==null)y=!0,T||(T=!0,P());else{var K=n(c);K!==null&&Q(E,K.startTime-q)}}var T=!1,R=-1,M=5,N=-1;function O(){return x?!0:!(e.unstable_now()-N<M)}function B(){if(x=!1,T){var q=e.unstable_now();N=q;var K=!0;try{e:{y=!1,b&&(b=!1,_(R),R=-1),p=!0;var U=h;try{t:{for(C(q),d=n(l);d!==null&&!(d.expirationTime>q&&O());){var re=d.callback;if(typeof re=="function"){d.callback=null,h=d.priorityLevel;var G=re(d.expirationTime<=q);if(q=e.unstable_now(),typeof G=="function"){d.callback=G,C(q),K=!0;break t}d===n(l)&&r(l),C(q)}else r(l);d=n(l)}if(d!==null)K=!0;else{var ne=n(c);ne!==null&&Q(E,ne.startTime-q),K=!1}}break e}finally{d=null,h=U,p=!1}K=void 0}}finally{K?P():T=!1}}}var P;if(typeof S=="function")P=function(){S(B)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,F=H.port2;H.port1.onmessage=B,P=function(){F.postMessage(null)}}else P=function(){w(B,0)};function Q(q,K){R=w(function(){q(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(q){q.callback=null},e.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<q?Math.floor(1e3/q):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(q){switch(h){case 1:case 2:case 3:var K=3;break;default:K=h}var U=h;h=K;try{return q()}finally{h=U}},e.unstable_requestPaint=function(){x=!0},e.unstable_runWithPriority=function(q,K){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var U=h;h=q;try{return K()}finally{h=U}},e.unstable_scheduleCallback=function(q,K,U){var re=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?re+U:re):U=re,q){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=U+G,q={id:u++,callback:K,priorityLevel:q,startTime:U,expirationTime:G,sortIndex:-1},U>re?(q.sortIndex=U,t(c,q),n(l)===null&&q===n(c)&&(b?(_(R),R=-1):b=!0,Q(E,U-re))):(q.sortIndex=G,t(l,q),y||p||(y=!0,T||(T=!0,P()))),q},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(q){var K=h;return function(){var U=h;h=K;try{return q.apply(this,arguments)}finally{h=U}}}}(PR)),PR}var rL;function ide(){return rL||(rL=1,OR.exports=rde()),OR.exports}var DR={exports:{}},da={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iL;function sde(){if(iL)return da;iL=1;var e=Ew();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return da.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,da.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return s(l,c,null,u)},da.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},da.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},da.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},da.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,p=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:p}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:p,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},da.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},da.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},da.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},da.requestFormReset=function(l){r.d.r(l)},da.unstable_batchedUpdates=function(l,c){return l(c)},da.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},da.useFormStatus=function(){return a.H.useHostTransitionStatus()},da.version="19.1.0",da}var sL;function vV(){if(sL)return DR.exports;sL=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),DR.exports=sde(),DR.exports}var aL;function ade(){if(aL)return Ub;aL=1;var e=ide(),t=Ew(),n=vV();function r(f){var g="https://react.dev/errors/"+f;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)g+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+f+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(f){return!(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)}function s(f){var g=f,v=f;if(f.alternate)for(;g.return;)g=g.return;else{f=g;do g=f,(g.flags&4098)!==0&&(v=g.return),f=g.return;while(f)}return g.tag===3?v:null}function a(f){if(f.tag===13){var g=f.memoizedState;if(g===null&&(f=f.alternate,f!==null&&(g=f.memoizedState)),g!==null)return g.dehydrated}return null}function o(f){if(s(f)!==f)throw Error(r(188))}function l(f){var g=f.alternate;if(!g){if(g=s(f),g===null)throw Error(r(188));return g!==f?null:f}for(var v=f,k=g;;){var j=v.return;if(j===null)break;var V=j.alternate;if(V===null){if(k=j.return,k!==null){v=k;continue}break}if(j.child===V.child){for(V=j.child;V;){if(V===v)return o(j),f;if(V===k)return o(j),g;V=V.sibling}throw Error(r(188))}if(v.return!==k.return)v=j,k=V;else{for(var ue=!1,Ae=j.child;Ae;){if(Ae===v){ue=!0,v=j,k=V;break}if(Ae===k){ue=!0,k=j,v=V;break}Ae=Ae.sibling}if(!ue){for(Ae=V.child;Ae;){if(Ae===v){ue=!0,v=V,k=j;break}if(Ae===k){ue=!0,k=V,v=j;break}Ae=Ae.sibling}if(!ue)throw Error(r(189))}}if(v.alternate!==k)throw Error(r(190))}if(v.tag!==3)throw Error(r(188));return v.stateNode.current===v?f:g}function c(f){var g=f.tag;if(g===5||g===26||g===27||g===6)return f;for(f=f.child;f!==null;){if(g=c(f),g!==null)return g;f=f.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),_=Symbol.for("react.consumer"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function P(f){return f===null||typeof f!="object"?null:(f=B&&f[B]||f["@@iterator"],typeof f=="function"?f:null)}var H=Symbol.for("react.client.reference");function F(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===H?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case y:return"Fragment";case x:return"Profiler";case b:return"StrictMode";case E:return"Suspense";case T:return"SuspenseList";case N:return"Activity"}if(typeof f=="object")switch(f.$$typeof){case p:return"Portal";case S:return(f.displayName||"Context")+".Provider";case _:return(f._context.displayName||"Context")+".Consumer";case C:var g=f.render;return f=f.displayName,f||(f=g.displayName||g.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case R:return g=f.displayName||null,g!==null?g:F(f.type)||"Memo";case M:g=f._payload,f=f._init;try{return F(f(g))}catch{}}return null}var Q=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},re=[],G=-1;function ne(f){return{current:f}}function te(f){0>G||(f.current=re[G],re[G]=null,G--)}function se(f,g){G++,re[G]=f.current,f.current=g}var pe=ne(null),de=ne(null),Ne=ne(null),Pe=ne(null);function Me(f,g){switch(se(Ne,g),se(de,f),se(pe,null),g.nodeType){case 9:case 11:f=(f=g.documentElement)&&(f=f.namespaceURI)?E8(f):0;break;default:if(f=g.tagName,g=g.namespaceURI)g=E8(g),f=T8(g,f);else switch(f){case"svg":f=1;break;case"math":f=2;break;default:f=0}}te(pe),se(pe,f)}function Ee(){te(pe),te(de),te(Ne)}function Ue(f){f.memoizedState!==null&&se(Pe,f);var g=pe.current,v=T8(g,f.type);g!==v&&(se(de,f),se(pe,v))}function nt(f){de.current===f&&(te(pe),te(de)),Pe.current===f&&(te(Pe),Db._currentValue=U)}var He=Object.prototype.hasOwnProperty,je=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,be=e.unstable_shouldYield,Re=e.unstable_requestPaint,ce=e.unstable_now,le=e.unstable_getCurrentPriorityLevel,ae=e.unstable_ImmediatePriority,Te=e.unstable_UserBlockingPriority,$e=e.unstable_NormalPriority,ke=e.unstable_LowPriority,ot=e.unstable_IdlePriority,At=e.log,ft=e.unstable_setDisableYieldValue,jt=null,Bt=null;function Ft(f){if(typeof At=="function"&&ft(f),Bt&&typeof Bt.setStrictMode=="function")try{Bt.setStrictMode(jt,f)}catch{}}var tn=Math.clz32?Math.clz32:X,xe=Math.log,D=Math.LN2;function X(f){return f>>>=0,f===0?32:31-(xe(f)/D|0)|0}var me=256,De=4194304;function we(f){var g=f&42;if(g!==0)return g;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function Ie(f,g,v){var k=f.pendingLanes;if(k===0)return 0;var j=0,V=f.suspendedLanes,ue=f.pingedLanes;f=f.warmLanes;var Ae=k&134217727;return Ae!==0?(k=Ae&~V,k!==0?j=we(k):(ue&=Ae,ue!==0?j=we(ue):v||(v=Ae&~f,v!==0&&(j=we(v))))):(Ae=k&~V,Ae!==0?j=we(Ae):ue!==0?j=we(ue):v||(v=k&~f,v!==0&&(j=we(v)))),j===0?0:g!==0&&g!==j&&(g&V)===0&&(V=j&-j,v=g&-g,V>=v||V===32&&(v&4194048)!==0)?g:j}function fe(f,g){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&g)===0}function yt(f,g){switch(f){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _t(){var f=me;return me<<=1,(me&4194048)===0&&(me=256),f}function z(){var f=De;return De<<=1,(De&62914560)===0&&(De=4194304),f}function qe(f){for(var g=[],v=0;31>v;v++)g.push(f);return g}function rt(f,g){f.pendingLanes|=g,g!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function ve(f,g,v,k,j,V){var ue=f.pendingLanes;f.pendingLanes=v,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=v,f.entangledLanes&=v,f.errorRecoveryDisabledLanes&=v,f.shellSuspendCounter=0;var Ae=f.entanglements,Ge=f.expirationTimes,bt=f.hiddenUpdates;for(v=ue&~v;0<v;){var Mt=31-tn(v),Pt=1<<Mt;Ae[Mt]=0,Ge[Mt]=-1;var wt=bt[Mt];if(wt!==null)for(bt[Mt]=null,Mt=0;Mt<wt.length;Mt++){var St=wt[Mt];St!==null&&(St.lane&=-536870913)}v&=~Pt}k!==0&&Se(f,k,0),V!==0&&j===0&&f.tag!==0&&(f.suspendedLanes|=V&~(ue&~g))}function Se(f,g,v){f.pendingLanes|=g,f.suspendedLanes&=~g;var k=31-tn(g);f.entangledLanes|=g,f.entanglements[k]=f.entanglements[k]|1073741824|v&4194090}function ze(f,g){var v=f.entangledLanes|=g;for(f=f.entanglements;v;){var k=31-tn(v),j=1<<k;j&g|f[k]&g&&(f[k]|=g),v&=~j}}function Tt(f){switch(f){case 2:f=1;break;case 8:f=4;break;case 32:f=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:f=128;break;case 268435456:f=134217728;break;default:f=0}return f}function ge(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function Z(){var f=K.p;return f!==0?f:(f=window.event,f===void 0?32:W8(f.type))}function W(f,g){var v=K.p;try{return K.p=f,g()}finally{K.p=v}}var J=Math.random().toString(36).slice(2),ye="__reactFiber$"+J,Oe="__reactProps$"+J,We="__reactContainer$"+J,vt="__reactEvents$"+J,Xt="__reactListeners$"+J,jn="__reactHandles$"+J,Yt="__reactResources$"+J,Qt="__reactMarker$"+J;function on(f){delete f[ye],delete f[Oe],delete f[vt],delete f[Xt],delete f[jn]}function or(f){var g=f[ye];if(g)return g;for(var v=f.parentNode;v;){if(g=v[We]||v[ye]){if(v=g.alternate,g.child!==null||v!==null&&v.child!==null)for(f=M8(f);f!==null;){if(v=f[ye])return v;f=M8(f)}return g}f=v,v=f.parentNode}return null}function xr(f){if(f=f[ye]||f[We]){var g=f.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return f}return null}function Gr(f){var g=f.tag;if(g===5||g===26||g===27||g===6)return f.stateNode;throw Error(r(33))}function Kr(f){var g=f[Yt];return g||(g=f[Yt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function pr(f){f[Qt]=!0}var un=new Set,Ze={};function $t(f,g){dn(f,g),dn(f+"Capture",g)}function dn(f,g){for(Ze[f]=g,f=0;f<g.length;f++)un.add(g[f])}var Gn=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),gi={},Vr={};function gs(f){return He.call(Vr,f)?!0:He.call(gi,f)?!1:Gn.test(f)?Vr[f]=!0:(gi[f]=!0,!1)}function Ki(f,g,v){if(gs(g))if(v===null)f.removeAttribute(g);else{switch(typeof v){case"undefined":case"function":case"symbol":f.removeAttribute(g);return;case"boolean":var k=g.toLowerCase().slice(0,5);if(k!=="data-"&&k!=="aria-"){f.removeAttribute(g);return}}f.setAttribute(g,""+v)}}function Ta(f,g,v){if(v===null)f.removeAttribute(g);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(g);return}f.setAttribute(g,""+v)}}function Gs(f,g,v,k){if(k===null)f.removeAttribute(v);else{switch(typeof k){case"undefined":case"function":case"symbol":case"boolean":f.removeAttribute(v);return}f.setAttributeNS(g,v,""+k)}}var Mi,_o;function Wo(f){if(Mi===void 0)try{throw Error()}catch(v){var g=v.stack.trim().match(/\n( *(at )?)/);Mi=g&&g[1]||"",_o=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mi+f+_o}var Nd=!1;function ym(f,g){if(!f||Nd)return"";Nd=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var k={DetermineComponentFrameRoot:function(){try{if(g){var Pt=function(){throw Error()};if(Object.defineProperty(Pt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Pt,[])}catch(St){var wt=St}Reflect.construct(f,[],Pt)}else{try{Pt.call()}catch(St){wt=St}f.call(Pt.prototype)}}else{try{throw Error()}catch(St){wt=St}(Pt=f())&&typeof Pt.catch=="function"&&Pt.catch(function(){})}}catch(St){if(St&&wt&&typeof St.stack=="string")return[St.stack,wt.stack]}return[null,null]}};k.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(k.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(k.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var V=k.DetermineComponentFrameRoot(),ue=V[0],Ae=V[1];if(ue&&Ae){var Ge=ue.split(`
`),bt=Ae.split(`
`);for(j=k=0;k<Ge.length&&!Ge[k].includes("DetermineComponentFrameRoot");)k++;for(;j<bt.length&&!bt[j].includes("DetermineComponentFrameRoot");)j++;if(k===Ge.length||j===bt.length)for(k=Ge.length-1,j=bt.length-1;1<=k&&0<=j&&Ge[k]!==bt[j];)j--;for(;1<=k&&0<=j;k--,j--)if(Ge[k]!==bt[j]){if(k!==1||j!==1)do if(k--,j--,0>j||Ge[k]!==bt[j]){var Mt=`
`+Ge[k].replace(" at new "," at ");return f.displayName&&Mt.includes("<anonymous>")&&(Mt=Mt.replace("<anonymous>",f.displayName)),Mt}while(1<=k&&0<=j);break}}}finally{Nd=!1,Error.prepareStackTrace=v}return(v=f?f.displayName||f.name:"")?Wo(v):""}function Ar(f){switch(f.tag){case 26:case 27:case 5:return Wo(f.type);case 16:return Wo("Lazy");case 13:return Wo("Suspense");case 19:return Wo("SuspenseList");case 0:case 15:return ym(f.type,!1);case 11:return ym(f.type.render,!1);case 1:return ym(f.type,!0);case 31:return Wo("Activity");default:return""}}function Ly(f){try{var g="";do g+=Ar(f),f=f.return;while(f);return g}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}function Aa(f){switch(typeof f){case"bigint":case"boolean":case"number":case"string":case"undefined":return f;case"object":return f;default:return""}}function By(f){var g=f.type;return(f=f.nodeName)&&f.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function yi(f){var g=By(f)?"checked":"value",v=Object.getOwnPropertyDescriptor(f.constructor.prototype,g),k=""+f[g];if(!f.hasOwnProperty(g)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var j=v.get,V=v.set;return Object.defineProperty(f,g,{configurable:!0,get:function(){return j.call(this)},set:function(ue){k=""+ue,V.call(this,ue)}}),Object.defineProperty(f,g,{enumerable:v.enumerable}),{getValue:function(){return k},setValue:function(ue){k=""+ue},stopTracking:function(){f._valueTracker=null,delete f[g]}}}}function gc(f){f._valueTracker||(f._valueTracker=yi(f))}function jd(f){if(!f)return!1;var g=f._valueTracker;if(!g)return!0;var v=g.getValue(),k="";return f&&(k=By(f)?f.checked?"true":"false":f.value),f=k,f!==v?(g.setValue(f),!0):!1}function Ml(f){if(f=f||(typeof document<"u"?document:void 0),typeof f>"u")return null;try{return f.activeElement||f.body}catch{return f.body}}var $y=/[\n"\\]/g;function oa(f){return f.replace($y,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Od(f,g,v,k,j,V,ue,Ae){f.name="",ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?f.type=ue:f.removeAttribute("type"),g!=null?ue==="number"?(g===0&&f.value===""||f.value!=g)&&(f.value=""+Aa(g)):f.value!==""+Aa(g)&&(f.value=""+Aa(g)):ue!=="submit"&&ue!=="reset"||f.removeAttribute("value"),g!=null?Pd(f,ue,Aa(g)):v!=null?Pd(f,ue,Aa(v)):k!=null&&f.removeAttribute("value"),j==null&&V!=null&&(f.defaultChecked=!!V),j!=null&&(f.checked=j&&typeof j!="function"&&typeof j!="symbol"),Ae!=null&&typeof Ae!="function"&&typeof Ae!="symbol"&&typeof Ae!="boolean"?f.name=""+Aa(Ae):f.removeAttribute("name")}function zy(f,g,v,k,j,V,ue,Ae){if(V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&(f.type=V),g!=null||v!=null){if(!(V!=="submit"&&V!=="reset"||g!=null))return;v=v!=null?""+Aa(v):"",g=g!=null?""+Aa(g):v,Ae||g===f.value||(f.value=g),f.defaultValue=g}k=k??j,k=typeof k!="function"&&typeof k!="symbol"&&!!k,f.checked=Ae?f.checked:!!k,f.defaultChecked=!!k,ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"&&(f.name=ue)}function Pd(f,g,v){g==="number"&&Ml(f.ownerDocument)===f||f.defaultValue===""+v||(f.defaultValue=""+v)}function gu(f,g,v,k){if(f=f.options,g){g={};for(var j=0;j<v.length;j++)g["$"+v[j]]=!0;for(v=0;v<f.length;v++)j=g.hasOwnProperty("$"+f[v].value),f[v].selected!==j&&(f[v].selected=j),j&&k&&(f[v].defaultSelected=!0)}else{for(v=""+Aa(v),g=null,j=0;j<f.length;j++){if(f[j].value===v){f[j].selected=!0,k&&(f[j].defaultSelected=!0);return}g!==null||f[j].disabled||(g=f[j])}g!==null&&(g.selected=!0)}}function Dd(f,g,v){if(g!=null&&(g=""+Aa(g),g!==f.value&&(f.value=g),v==null)){f.defaultValue!==g&&(f.defaultValue=g);return}f.defaultValue=v!=null?""+Aa(v):""}function Uy(f,g,v,k){if(g==null){if(k!=null){if(v!=null)throw Error(r(92));if(Q(k)){if(1<k.length)throw Error(r(93));k=k[0]}v=k}v==null&&(v=""),g=v}v=Aa(g),f.defaultValue=v,k=f.textContent,k===v&&k!==""&&k!==null&&(f.value=k)}function Fd(f,g){if(g){var v=f.firstChild;if(v&&v===f.lastChild&&v.nodeType===3){v.nodeValue=g;return}}f.textContent=g}var Dr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bm(f,g,v){var k=g.indexOf("--")===0;v==null||typeof v=="boolean"||v===""?k?f.setProperty(g,""):g==="float"?f.cssFloat="":f[g]="":k?f.setProperty(g,v):typeof v!="number"||v===0||Dr.has(g)?g==="float"?f.cssFloat=v:f[g]=(""+v).trim():f[g]=v+"px"}function L1(f,g,v){if(g!=null&&typeof g!="object")throw Error(r(62));if(f=f.style,v!=null){for(var k in v)!v.hasOwnProperty(k)||g!=null&&g.hasOwnProperty(k)||(k.indexOf("--")===0?f.setProperty(k,""):k==="float"?f.cssFloat="":f[k]="");for(var j in g)k=g[j],g.hasOwnProperty(j)&&v[j]!==k&&bm(f,j,k)}else for(var V in g)g.hasOwnProperty(V)&&bm(f,V,g[V])}function qy(f){if(f.indexOf("-")===-1)return!1;switch(f){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ra=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ld=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yu(f){return Ld.test(""+f)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":f}var Go=null;function vm(f){return f=f.target||f.srcElement||window,f.correspondingUseElement&&(f=f.correspondingUseElement),f.nodeType===3?f.parentNode:f}var bu=null,ki=null;function So(f){var g=xr(f);if(g&&(f=g.stateNode)){var v=f[Oe]||null;e:switch(f=g.stateNode,g.type){case"input":if(Od(f,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name),g=v.name,v.type==="radio"&&g!=null){for(v=f;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll('input[name="'+oa(""+g)+'"][type="radio"]'),g=0;g<v.length;g++){var k=v[g];if(k!==f&&k.form===f.form){var j=k[Oe]||null;if(!j)throw Error(r(90));Od(k,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(g=0;g<v.length;g++)k=v[g],k.form===f.form&&jd(k)}break e;case"textarea":Dd(f,v.value,v.defaultValue);break e;case"select":g=v.value,g!=null&&gu(f,!!v.multiple,g,!1)}}}var vu=!1;function Bd(f,g,v){if(vu)return f(g,v);vu=!0;try{var k=f(g);return k}finally{if(vu=!1,(bu!==null||ki!==null)&&(E_(),bu&&(g=bu,f=ki,ki=bu=null,So(g),f)))for(g=0;g<f.length;g++)So(f[g])}}function xu(f,g){var v=f.stateNode;if(v===null)return null;var k=v[Oe]||null;if(k===null)return null;v=k[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(f=f.type,k=!(f==="button"||f==="input"||f==="select"||f==="textarea")),f=!k;break e;default:f=!1}if(f)return null;if(v&&typeof v!="function")throw Error(r(231,g,typeof v));return v}var Ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vy=!1;if(Ts)try{var la={};Object.defineProperty(la,"passive",{get:function(){Vy=!0}}),window.addEventListener("test",la,la),window.removeEventListener("test",la,la)}catch{Vy=!1}var Ko=null,xm=null,$d=null;function zd(){if($d)return $d;var f,g=xm,v=g.length,k,j="value"in Ko?Ko.value:Ko.textContent,V=j.length;for(f=0;f<v&&g[f]===j[f];f++);var ue=v-f;for(k=1;k<=ue&&g[v-k]===j[V-k];k++);return $d=j.slice(f,1<k?1-k:void 0)}function Ud(f){var g=f.keyCode;return"charCode"in f?(f=f.charCode,f===0&&g===13&&(f=13)):f=g,f===10&&(f=13),32<=f||f===13?f:0}function kh(){return!0}function B1(){return!1}function as(f){function g(v,k,j,V,ue){this._reactName=v,this._targetInst=j,this.type=k,this.nativeEvent=V,this.target=ue,this.currentTarget=null;for(var Ae in f)f.hasOwnProperty(Ae)&&(v=f[Ae],this[Ae]=v?v(V):V[Ae]);return this.isDefaultPrevented=(V.defaultPrevented!=null?V.defaultPrevented:V.returnValue===!1)?kh:B1,this.isPropagationStopped=B1,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=kh)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=kh)},persist:function(){},isPersistent:kh}),g}var wu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(f){return f.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wm=as(wu),yc=u({},wu,{view:0,detail:0}),_m=as(yc),Eh,Hy,Th,Sm=u({},yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_u,button:0,buttons:0,relatedTarget:function(f){return f.relatedTarget===void 0?f.fromElement===f.srcElement?f.toElement:f.fromElement:f.relatedTarget},movementX:function(f){return"movementX"in f?f.movementX:(f!==Th&&(Th&&f.type==="mousemove"?(Eh=f.screenX-Th.screenX,Hy=f.screenY-Th.screenY):Hy=Eh=0,Th=f),Eh)},movementY:function(f){return"movementY"in f?f.movementY:Hy}}),Cm=as(Sm),Wy=u({},Sm,{dataTransfer:0}),$1=as(Wy),km=u({},yc,{relatedTarget:0}),qd=as(km),Em=u({},wu,{animationName:0,elapsedTime:0,pseudoElement:0}),z1=as(Em),HT=u({},wu,{clipboardData:function(f){return"clipboardData"in f?f.clipboardData:window.clipboardData}}),Tm=as(HT),Gy=u({},wu,{data:0}),Am=as(Gy),Ky={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yy={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},As={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ah(f){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(f):(f=As[f])?!!g[f]:!1}function _u(){return Ah}var U1=u({},yc,{key:function(f){if(f.key){var g=Ky[f.key]||f.key;if(g!=="Unidentified")return g}return f.type==="keypress"?(f=Ud(f),f===13?"Enter":String.fromCharCode(f)):f.type==="keydown"||f.type==="keyup"?Yy[f.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_u,charCode:function(f){return f.type==="keypress"?Ud(f):0},keyCode:function(f){return f.type==="keydown"||f.type==="keyup"?f.keyCode:0},which:function(f){return f.type==="keypress"?Ud(f):f.type==="keydown"||f.type==="keyup"?f.keyCode:0}}),Rm=as(U1),q1=u({},Sm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zy=as(q1),Im=u({},yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_u}),Xy=as(Im),Su=u({},wu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jy=as(Su),Qy=u({},Sm,{deltaX:function(f){return"deltaX"in f?f.deltaX:"wheelDeltaX"in f?-f.wheelDeltaX:0},deltaY:function(f){return"deltaY"in f?f.deltaY:"wheelDeltaY"in f?-f.wheelDeltaY:"wheelDelta"in f?-f.wheelDelta:0},deltaZ:0,deltaMode:0}),Mm=as(Qy),eb=u({},wu,{newState:0,oldState:0}),V1=as(eb),WT=[9,13,27,32],Rh=Ts&&"CompositionEvent"in window,bc=null;Ts&&"documentMode"in document&&(bc=document.documentMode);var GT=Ts&&"TextEvent"in window&&!bc,Nm=Ts&&(!Rh||bc&&8<bc&&11>=bc),jm=" ",H1=!1;function tb(f,g){switch(f){case"keyup":return WT.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function W1(f){return f=f.detail,typeof f=="object"&&"data"in f?f.data:null}var Cu=!1;function G1(f,g){switch(f){case"compositionend":return W1(g);case"keypress":return g.which!==32?null:(H1=!0,jm);case"textInput":return f=g.data,f===jm&&H1?null:f;default:return null}}function KT(f,g){if(Cu)return f==="compositionend"||!Rh&&tb(f,g)?(f=zd(),$d=xm=Ko=null,Cu=!1,f):null;switch(f){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Nm&&g.locale!=="ko"?null:g.data;default:return null}}var K1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Om(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g==="input"?!!K1[f.type]:g==="textarea"}function nb(f,g,v,k){bu?ki?ki.push(k):ki=[k]:bu=k,g=N_(g,"onChange"),0<g.length&&(v=new wm("onChange","change",null,v,k),f.push({event:v,listeners:g}))}var Vd=null,Ih=null;function YT(f){w8(f,0)}function Pm(f){var g=Gr(f);if(jd(g))return f}function Mh(f,g){if(f==="change")return g}var Yo=!1;if(Ts){var Ei;if(Ts){var Hd="oninput"in document;if(!Hd){var Ia=document.createElement("div");Ia.setAttribute("oninput","return;"),Hd=typeof Ia.oninput=="function"}Ei=Hd}else Ei=!1;Yo=Ei&&(!document.documentMode||9<document.documentMode)}function Y1(){Vd&&(Vd.detachEvent("onpropertychange",Dm),Ih=Vd=null)}function Dm(f){if(f.propertyName==="value"&&Pm(Ih)){var g=[];nb(g,Ih,f,vm(f)),Bd(YT,g)}}function Z1(f,g,v){f==="focusin"?(Y1(),Vd=g,Ih=v,Vd.attachEvent("onpropertychange",Dm)):f==="focusout"&&Y1()}function ku(f){if(f==="selectionchange"||f==="keyup"||f==="keydown")return Pm(Ih)}function rb(f,g){if(f==="click")return Pm(g)}function Wd(f,g){if(f==="input"||f==="change")return Pm(g)}function vc(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var ca=typeof Object.is=="function"?Object.is:vc;function I(f,g){if(ca(f,g))return!0;if(typeof f!="object"||f===null||typeof g!="object"||g===null)return!1;var v=Object.keys(f),k=Object.keys(g);if(v.length!==k.length)return!1;for(k=0;k<v.length;k++){var j=v[k];if(!He.call(g,j)||!ca(f[j],g[j]))return!1}return!0}function $(f){for(;f&&f.firstChild;)f=f.firstChild;return f}function ee(f,g){var v=$(f);f=0;for(var k;v;){if(v.nodeType===3){if(k=f+v.textContent.length,f<=g&&k>=g)return{node:v,offset:g-f};f=k}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=$(v)}}function oe(f,g){return f&&g?f===g?!0:f&&f.nodeType===3?!1:g&&g.nodeType===3?oe(f,g.parentNode):"contains"in f?f.contains(g):f.compareDocumentPosition?!!(f.compareDocumentPosition(g)&16):!1:!1}function he(f){f=f!=null&&f.ownerDocument!=null&&f.ownerDocument.defaultView!=null?f.ownerDocument.defaultView:window;for(var g=Ml(f.document);g instanceof f.HTMLIFrameElement;){try{var v=typeof g.contentWindow.location.href=="string"}catch{v=!1}if(v)f=g.contentWindow;else break;g=Ml(f.document)}return g}function Ce(f){var g=f&&f.nodeName&&f.nodeName.toLowerCase();return g&&(g==="input"&&(f.type==="text"||f.type==="search"||f.type==="tel"||f.type==="url"||f.type==="password")||g==="textarea"||f.contentEditable==="true")}var Le=Ts&&"documentMode"in document&&11>=document.documentMode,Ve=null,Je=null,et=null,at=!1;function Ye(f,g,v){var k=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;at||Ve==null||Ve!==Ml(k)||(k=Ve,"selectionStart"in k&&Ce(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),et&&I(et,k)||(et=k,k=N_(Je,"onSelect"),0<k.length&&(g=new wm("onSelect","select",null,g,v),f.push({event:g,listeners:k}),g.target=Ve)))}function ct(f,g){var v={};return v[f.toLowerCase()]=g.toLowerCase(),v["Webkit"+f]="webkit"+g,v["Moz"+f]="moz"+g,v}var Xe={animationend:ct("Animation","AnimationEnd"),animationiteration:ct("Animation","AnimationIteration"),animationstart:ct("Animation","AnimationStart"),transitionrun:ct("Transition","TransitionRun"),transitionstart:ct("Transition","TransitionStart"),transitioncancel:ct("Transition","TransitionCancel"),transitionend:ct("Transition","TransitionEnd")},st={},ht={};Ts&&(ht=document.createElement("div").style,"AnimationEvent"in window||(delete Xe.animationend.animation,delete Xe.animationiteration.animation,delete Xe.animationstart.animation),"TransitionEvent"in window||delete Xe.transitionend.transition);function tt(f){if(st[f])return st[f];if(!Xe[f])return f;var g=Xe[f],v;for(v in g)if(g.hasOwnProperty(v)&&v in ht)return st[f]=g[v];return f}var xt=tt("animationend"),Ct=tt("animationiteration"),kt=tt("animationstart"),It=tt("transitionrun"),Wt=tt("transitionstart"),en=tt("transitioncancel"),qt=tt("transitionend"),Zt=new Map,rn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rn.push("scrollEnd");function Vt(f,g){Zt.set(f,g),$t(g,[f])}var fn=new WeakMap;function Mn(f,g){if(typeof f=="object"&&f!==null){var v=fn.get(f);return v!==void 0?v:(g={value:f,source:g,stack:Ly(g)},fn.set(f,g),g)}return{value:f,source:g,stack:Ly(g)}}var Fn=[],sr=0,Ks=0;function Kn(){for(var f=sr,g=Ks=sr=0;g<f;){var v=Fn[g];Fn[g++]=null;var k=Fn[g];Fn[g++]=null;var j=Fn[g];Fn[g++]=null;var V=Fn[g];if(Fn[g++]=null,k!==null&&j!==null){var ue=k.pending;ue===null?j.next=j:(j.next=ue.next,ue.next=j),k.pending=j}V!==0&&Rs(v,j,V)}}function Yi(f,g,v,k){Fn[sr++]=f,Fn[sr++]=g,Fn[sr++]=v,Fn[sr++]=k,Ks|=k,f.lanes|=k,f=f.alternate,f!==null&&(f.lanes|=k)}function os(f,g,v,k){return Yi(f,g,v,k),Zo(f)}function Nl(f,g){return Yi(f,null,null,g),Zo(f)}function Rs(f,g,v){f.lanes|=v;var k=f.alternate;k!==null&&(k.lanes|=v);for(var j=!1,V=f.return;V!==null;)V.childLanes|=v,k=V.alternate,k!==null&&(k.childLanes|=v),V.tag===22&&(f=V.stateNode,f===null||f._visibility&1||(j=!0)),f=V,V=V.return;return f.tag===3?(V=f.stateNode,j&&g!==null&&(j=31-tn(v),f=V.hiddenUpdates,k=f[j],k===null?f[j]=[g]:k.push(g),g.lane=v|536870912),V):null}function Zo(f){if(50<Ab)throw Ab=0,tR=null,Error(r(185));for(var g=f.return;g!==null;)f=g,g=f.return;return f.tag===3?f.stateNode:null}var xc={};function Nce(f,g,v,k){this.tag=f,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Co(f,g,v,k){return new Nce(f,g,v,k)}function ZT(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Eu(f,g){var v=f.alternate;return v===null?(v=Co(f.tag,g,f.key,f.mode),v.elementType=f.elementType,v.type=f.type,v.stateNode=f.stateNode,v.alternate=f,f.alternate=v):(v.pendingProps=g,v.type=f.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=f.flags&65011712,v.childLanes=f.childLanes,v.lanes=f.lanes,v.child=f.child,v.memoizedProps=f.memoizedProps,v.memoizedState=f.memoizedState,v.updateQueue=f.updateQueue,g=f.dependencies,v.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},v.sibling=f.sibling,v.index=f.index,v.ref=f.ref,v.refCleanup=f.refCleanup,v}function a5(f,g){f.flags&=65011714;var v=f.alternate;return v===null?(f.childLanes=0,f.lanes=g,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=v.childLanes,f.lanes=v.lanes,f.child=v.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=v.memoizedProps,f.memoizedState=v.memoizedState,f.updateQueue=v.updateQueue,f.type=v.type,g=v.dependencies,f.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),f}function X1(f,g,v,k,j,V){var ue=0;if(k=f,typeof f=="function")ZT(f)&&(ue=1);else if(typeof f=="string")ue=Oue(f,v,pe.current)?26:f==="html"||f==="head"||f==="body"?27:5;else e:switch(f){case N:return f=Co(31,v,g,j),f.elementType=N,f.lanes=V,f;case y:return Nh(v.children,j,V,g);case b:ue=8,j|=24;break;case x:return f=Co(12,v,g,j|2),f.elementType=x,f.lanes=V,f;case E:return f=Co(13,v,g,j),f.elementType=E,f.lanes=V,f;case T:return f=Co(19,v,g,j),f.elementType=T,f.lanes=V,f;default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case w:case S:ue=10;break e;case _:ue=9;break e;case C:ue=11;break e;case R:ue=14;break e;case M:ue=16,k=null;break e}ue=29,v=Error(r(130,f===null?"null":typeof f,"")),k=null}return g=Co(ue,v,g,j),g.elementType=f,g.type=k,g.lanes=V,g}function Nh(f,g,v,k){return f=Co(7,f,k,g),f.lanes=v,f}function XT(f,g,v){return f=Co(6,f,null,g),f.lanes=v,f}function JT(f,g,v){return g=Co(4,f.children!==null?f.children:[],f.key,g),g.lanes=v,g.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},g}var Fm=[],Lm=0,J1=null,Q1=0,Xo=[],Jo=0,jh=null,Tu=1,Au="";function Oh(f,g){Fm[Lm++]=Q1,Fm[Lm++]=J1,J1=f,Q1=g}function o5(f,g,v){Xo[Jo++]=Tu,Xo[Jo++]=Au,Xo[Jo++]=jh,jh=f;var k=Tu;f=Au;var j=32-tn(k)-1;k&=~(1<<j),v+=1;var V=32-tn(g)+j;if(30<V){var ue=j-j%5;V=(k&(1<<ue)-1).toString(32),k>>=ue,j-=ue,Tu=1<<32-tn(g)+j|v<<j|k,Au=V+f}else Tu=1<<V|v<<j|k,Au=f}function QT(f){f.return!==null&&(Oh(f,1),o5(f,1,0))}function eA(f){for(;f===J1;)J1=Fm[--Lm],Fm[Lm]=null,Q1=Fm[--Lm],Fm[Lm]=null;for(;f===jh;)jh=Xo[--Jo],Xo[Jo]=null,Au=Xo[--Jo],Xo[Jo]=null,Tu=Xo[--Jo],Xo[Jo]=null}var Ma=null,qi=null,Yr=!1,Ph=null,wc=!1,tA=Error(r(519));function Dh(f){var g=Error(r(418,""));throw ab(Mn(g,f)),tA}function l5(f){var g=f.stateNode,v=f.type,k=f.memoizedProps;switch(g[ye]=f,g[Oe]=k,v){case"dialog":Ir("cancel",g),Ir("close",g);break;case"iframe":case"object":case"embed":Ir("load",g);break;case"video":case"audio":for(v=0;v<Ib.length;v++)Ir(Ib[v],g);break;case"source":Ir("error",g);break;case"img":case"image":case"link":Ir("error",g),Ir("load",g);break;case"details":Ir("toggle",g);break;case"input":Ir("invalid",g),zy(g,k.value,k.defaultValue,k.checked,k.defaultChecked,k.type,k.name,!0),gc(g);break;case"select":Ir("invalid",g);break;case"textarea":Ir("invalid",g),Uy(g,k.value,k.defaultValue,k.children),gc(g)}v=k.children,typeof v!="string"&&typeof v!="number"&&typeof v!="bigint"||g.textContent===""+v||k.suppressHydrationWarning===!0||k8(g.textContent,v)?(k.popover!=null&&(Ir("beforetoggle",g),Ir("toggle",g)),k.onScroll!=null&&Ir("scroll",g),k.onScrollEnd!=null&&Ir("scrollend",g),k.onClick!=null&&(g.onclick=j_),g=!0):g=!1,g||Dh(f)}function c5(f){for(Ma=f.return;Ma;)switch(Ma.tag){case 5:case 13:wc=!1;return;case 27:case 3:wc=!0;return;default:Ma=Ma.return}}function ib(f){if(f!==Ma)return!1;if(!Yr)return c5(f),Yr=!0,!1;var g=f.tag,v;if((v=g!==3&&g!==27)&&((v=g===5)&&(v=f.type,v=!(v!=="form"&&v!=="button")||yR(f.type,f.memoizedProps)),v=!v),v&&qi&&Dh(f),c5(f),g===13){if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(r(317));e:{for(f=f.nextSibling,g=0;f;){if(f.nodeType===8)if(v=f.data,v==="/$"){if(g===0){qi=Ol(f.nextSibling);break e}g--}else v!=="$"&&v!=="$!"&&v!=="$?"||g++;f=f.nextSibling}qi=null}}else g===27?(g=qi,cf(f.type)?(f=wR,wR=null,qi=f):qi=g):qi=Ma?Ol(f.stateNode.nextSibling):null;return!0}function sb(){qi=Ma=null,Yr=!1}function u5(){var f=Ph;return f!==null&&(Ja===null?Ja=f:Ja.push.apply(Ja,f),Ph=null),f}function ab(f){Ph===null?Ph=[f]:Ph.push(f)}var nA=ne(null),Fh=null,Ru=null;function Gd(f,g,v){se(nA,g._currentValue),g._currentValue=v}function Iu(f){f._currentValue=nA.current,te(nA)}function rA(f,g,v){for(;f!==null;){var k=f.alternate;if((f.childLanes&g)!==g?(f.childLanes|=g,k!==null&&(k.childLanes|=g)):k!==null&&(k.childLanes&g)!==g&&(k.childLanes|=g),f===v)break;f=f.return}}function iA(f,g,v,k){var j=f.child;for(j!==null&&(j.return=f);j!==null;){var V=j.dependencies;if(V!==null){var ue=j.child;V=V.firstContext;e:for(;V!==null;){var Ae=V;V=j;for(var Ge=0;Ge<g.length;Ge++)if(Ae.context===g[Ge]){V.lanes|=v,Ae=V.alternate,Ae!==null&&(Ae.lanes|=v),rA(V.return,v,f),k||(ue=null);break e}V=Ae.next}}else if(j.tag===18){if(ue=j.return,ue===null)throw Error(r(341));ue.lanes|=v,V=ue.alternate,V!==null&&(V.lanes|=v),rA(ue,v,f),ue=null}else ue=j.child;if(ue!==null)ue.return=j;else for(ue=j;ue!==null;){if(ue===f){ue=null;break}if(j=ue.sibling,j!==null){j.return=ue.return,ue=j;break}ue=ue.return}j=ue}}function ob(f,g,v,k){f=null;for(var j=g,V=!1;j!==null;){if(!V){if((j.flags&524288)!==0)V=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var ue=j.alternate;if(ue===null)throw Error(r(387));if(ue=ue.memoizedProps,ue!==null){var Ae=j.type;ca(j.pendingProps.value,ue.value)||(f!==null?f.push(Ae):f=[Ae])}}else if(j===Pe.current){if(ue=j.alternate,ue===null)throw Error(r(387));ue.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(f!==null?f.push(Db):f=[Db])}j=j.return}f!==null&&iA(g,f,v,k),g.flags|=262144}function e_(f){for(f=f.firstContext;f!==null;){if(!ca(f.context._currentValue,f.memoizedValue))return!0;f=f.next}return!1}function Lh(f){Fh=f,Ru=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function ua(f){return d5(Fh,f)}function t_(f,g){return Fh===null&&Lh(f),d5(f,g)}function d5(f,g){var v=g._currentValue;if(g={context:g,memoizedValue:v,next:null},Ru===null){if(f===null)throw Error(r(308));Ru=g,f.dependencies={lanes:0,firstContext:g},f.flags|=524288}else Ru=Ru.next=g;return v}var jce=typeof AbortController<"u"?AbortController:function(){var f=[],g=this.signal={aborted:!1,addEventListener:function(v,k){f.push(k)}};this.abort=function(){g.aborted=!0,f.forEach(function(v){return v()})}},Oce=e.unstable_scheduleCallback,Pce=e.unstable_NormalPriority,ys={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sA(){return{controller:new jce,data:new Map,refCount:0}}function lb(f){f.refCount--,f.refCount===0&&Oce(Pce,function(){f.controller.abort()})}var cb=null,aA=0,Bm=0,$m=null;function Dce(f,g){if(cb===null){var v=cb=[];aA=0,Bm=lR(),$m={status:"pending",value:void 0,then:function(k){v.push(k)}}}return aA++,g.then(f5,f5),g}function f5(){if(--aA===0&&cb!==null){$m!==null&&($m.status="fulfilled");var f=cb;cb=null,Bm=0,$m=null;for(var g=0;g<f.length;g++)(0,f[g])()}}function Fce(f,g){var v=[],k={status:"pending",value:null,reason:null,then:function(j){v.push(j)}};return f.then(function(){k.status="fulfilled",k.value=g;for(var j=0;j<v.length;j++)(0,v[j])(g)},function(j){for(k.status="rejected",k.reason=j,j=0;j<v.length;j++)(0,v[j])(void 0)}),k}var h5=q.S;q.S=function(f,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&Dce(f,g),h5!==null&&h5(f,g)};var Bh=ne(null);function oA(){var f=Bh.current;return f!==null?f:_i.pooledCache}function n_(f,g){g===null?se(Bh,Bh.current):se(Bh,g.pool)}function p5(){var f=oA();return f===null?null:{parent:ys._currentValue,pool:f}}var ub=Error(r(460)),m5=Error(r(474)),r_=Error(r(542)),lA={then:function(){}};function g5(f){return f=f.status,f==="fulfilled"||f==="rejected"}function i_(){}function y5(f,g,v){switch(v=f[v],v===void 0?f.push(g):v!==g&&(g.then(i_,i_),g=v),g.status){case"fulfilled":return g.value;case"rejected":throw f=g.reason,v5(f),f;default:if(typeof g.status=="string")g.then(i_,i_);else{if(f=_i,f!==null&&100<f.shellSuspendCounter)throw Error(r(482));f=g,f.status="pending",f.then(function(k){if(g.status==="pending"){var j=g;j.status="fulfilled",j.value=k}},function(k){if(g.status==="pending"){var j=g;j.status="rejected",j.reason=k}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw f=g.reason,v5(f),f}throw db=g,ub}}var db=null;function b5(){if(db===null)throw Error(r(459));var f=db;return db=null,f}function v5(f){if(f===ub||f===r_)throw Error(r(483))}var Kd=!1;function cA(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uA(f,g){f=f.updateQueue,g.updateQueue===f&&(g.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function Yd(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function Zd(f,g,v){var k=f.updateQueue;if(k===null)return null;if(k=k.shared,(si&2)!==0){var j=k.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),k.pending=g,g=Zo(f),Rs(f,null,v),g}return Yi(f,k,g,v),Zo(f)}function fb(f,g,v){if(g=g.updateQueue,g!==null&&(g=g.shared,(v&4194048)!==0)){var k=g.lanes;k&=f.pendingLanes,v|=k,g.lanes=v,ze(f,v)}}function dA(f,g){var v=f.updateQueue,k=f.alternate;if(k!==null&&(k=k.updateQueue,v===k)){var j=null,V=null;if(v=v.firstBaseUpdate,v!==null){do{var ue={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};V===null?j=V=ue:V=V.next=ue,v=v.next}while(v!==null);V===null?j=V=g:V=V.next=g}else j=V=g;v={baseState:k.baseState,firstBaseUpdate:j,lastBaseUpdate:V,shared:k.shared,callbacks:k.callbacks},f.updateQueue=v;return}f=v.lastBaseUpdate,f===null?v.firstBaseUpdate=g:f.next=g,v.lastBaseUpdate=g}var fA=!1;function hb(){if(fA){var f=$m;if(f!==null)throw f}}function pb(f,g,v,k){fA=!1;var j=f.updateQueue;Kd=!1;var V=j.firstBaseUpdate,ue=j.lastBaseUpdate,Ae=j.shared.pending;if(Ae!==null){j.shared.pending=null;var Ge=Ae,bt=Ge.next;Ge.next=null,ue===null?V=bt:ue.next=bt,ue=Ge;var Mt=f.alternate;Mt!==null&&(Mt=Mt.updateQueue,Ae=Mt.lastBaseUpdate,Ae!==ue&&(Ae===null?Mt.firstBaseUpdate=bt:Ae.next=bt,Mt.lastBaseUpdate=Ge))}if(V!==null){var Pt=j.baseState;ue=0,Mt=bt=Ge=null,Ae=V;do{var wt=Ae.lane&-536870913,St=wt!==Ae.lane;if(St?(Fr&wt)===wt:(k&wt)===wt){wt!==0&&wt===Bm&&(fA=!0),Mt!==null&&(Mt=Mt.next={lane:0,tag:Ae.tag,payload:Ae.payload,callback:null,next:null});e:{var Yn=f,Ln=Ae;wt=g;var fi=v;switch(Ln.tag){case 1:if(Yn=Ln.payload,typeof Yn=="function"){Pt=Yn.call(fi,Pt,wt);break e}Pt=Yn;break e;case 3:Yn.flags=Yn.flags&-65537|128;case 0:if(Yn=Ln.payload,wt=typeof Yn=="function"?Yn.call(fi,Pt,wt):Yn,wt==null)break e;Pt=u({},Pt,wt);break e;case 2:Kd=!0}}wt=Ae.callback,wt!==null&&(f.flags|=64,St&&(f.flags|=8192),St=j.callbacks,St===null?j.callbacks=[wt]:St.push(wt))}else St={lane:wt,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},Mt===null?(bt=Mt=St,Ge=Pt):Mt=Mt.next=St,ue|=wt;if(Ae=Ae.next,Ae===null){if(Ae=j.shared.pending,Ae===null)break;St=Ae,Ae=St.next,St.next=null,j.lastBaseUpdate=St,j.shared.pending=null}}while(!0);Mt===null&&(Ge=Pt),j.baseState=Ge,j.firstBaseUpdate=bt,j.lastBaseUpdate=Mt,V===null&&(j.shared.lanes=0),sf|=ue,f.lanes=ue,f.memoizedState=Pt}}function x5(f,g){if(typeof f!="function")throw Error(r(191,f));f.call(g)}function w5(f,g){var v=f.callbacks;if(v!==null)for(f.callbacks=null,f=0;f<v.length;f++)x5(v[f],g)}var zm=ne(null),s_=ne(0);function _5(f,g){f=Fu,se(s_,f),se(zm,g),Fu=f|g.baseLanes}function hA(){se(s_,Fu),se(zm,zm.current)}function pA(){Fu=s_.current,te(zm),te(s_)}var Xd=0,Sr=null,ui=null,ls=null,a_=!1,Um=!1,$h=!1,o_=0,mb=0,qm=null,Lce=0;function Zi(){throw Error(r(321))}function mA(f,g){if(g===null)return!1;for(var v=0;v<g.length&&v<f.length;v++)if(!ca(f[v],g[v]))return!1;return!0}function gA(f,g,v,k,j,V){return Xd=V,Sr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,q.H=f===null||f.memoizedState===null?sF:aF,$h=!1,V=v(k,j),$h=!1,Um&&(V=C5(g,v,k,j)),S5(f),V}function S5(f){q.H=h_;var g=ui!==null&&ui.next!==null;if(Xd=0,ls=ui=Sr=null,a_=!1,mb=0,qm=null,g)throw Error(r(300));f===null||Is||(f=f.dependencies,f!==null&&e_(f)&&(Is=!0))}function C5(f,g,v,k){Sr=f;var j=0;do{if(Um&&(qm=null),mb=0,Um=!1,25<=j)throw Error(r(301));if(j+=1,ls=ui=null,f.updateQueue!=null){var V=f.updateQueue;V.lastEffect=null,V.events=null,V.stores=null,V.memoCache!=null&&(V.memoCache.index=0)}q.H=Hce,V=g(v,k)}while(Um);return V}function Bce(){var f=q.H,g=f.useState()[0];return g=typeof g.then=="function"?gb(g):g,f=f.useState()[0],(ui!==null?ui.memoizedState:null)!==f&&(Sr.flags|=1024),g}function yA(){var f=o_!==0;return o_=0,f}function bA(f,g,v){g.updateQueue=f.updateQueue,g.flags&=-2053,f.lanes&=~v}function vA(f){if(a_){for(f=f.memoizedState;f!==null;){var g=f.queue;g!==null&&(g.pending=null),f=f.next}a_=!1}Xd=0,ls=ui=Sr=null,Um=!1,mb=o_=0,qm=null}function Za(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ls===null?Sr.memoizedState=ls=f:ls=ls.next=f,ls}function cs(){if(ui===null){var f=Sr.alternate;f=f!==null?f.memoizedState:null}else f=ui.next;var g=ls===null?Sr.memoizedState:ls.next;if(g!==null)ls=g,ui=f;else{if(f===null)throw Sr.alternate===null?Error(r(467)):Error(r(310));ui=f,f={memoizedState:ui.memoizedState,baseState:ui.baseState,baseQueue:ui.baseQueue,queue:ui.queue,next:null},ls===null?Sr.memoizedState=ls=f:ls=ls.next=f}return ls}function xA(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function gb(f){var g=mb;return mb+=1,qm===null&&(qm=[]),f=y5(qm,f,g),g=Sr,(ls===null?g.memoizedState:ls.next)===null&&(g=g.alternate,q.H=g===null||g.memoizedState===null?sF:aF),f}function l_(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return gb(f);if(f.$$typeof===S)return ua(f)}throw Error(r(438,String(f)))}function wA(f){var g=null,v=Sr.updateQueue;if(v!==null&&(g=v.memoCache),g==null){var k=Sr.alternate;k!==null&&(k=k.updateQueue,k!==null&&(k=k.memoCache,k!=null&&(g={data:k.data.map(function(j){return j.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),v===null&&(v=xA(),Sr.updateQueue=v),v.memoCache=g,v=g.data[g.index],v===void 0)for(v=g.data[g.index]=Array(f),k=0;k<f;k++)v[k]=O;return g.index++,v}function Mu(f,g){return typeof g=="function"?g(f):g}function c_(f){var g=cs();return _A(g,ui,f)}function _A(f,g,v){var k=f.queue;if(k===null)throw Error(r(311));k.lastRenderedReducer=v;var j=f.baseQueue,V=k.pending;if(V!==null){if(j!==null){var ue=j.next;j.next=V.next,V.next=ue}g.baseQueue=j=V,k.pending=null}if(V=f.baseState,j===null)f.memoizedState=V;else{g=j.next;var Ae=ue=null,Ge=null,bt=g,Mt=!1;do{var Pt=bt.lane&-536870913;if(Pt!==bt.lane?(Fr&Pt)===Pt:(Xd&Pt)===Pt){var wt=bt.revertLane;if(wt===0)Ge!==null&&(Ge=Ge.next={lane:0,revertLane:0,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null}),Pt===Bm&&(Mt=!0);else if((Xd&wt)===wt){bt=bt.next,wt===Bm&&(Mt=!0);continue}else Pt={lane:0,revertLane:bt.revertLane,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null},Ge===null?(Ae=Ge=Pt,ue=V):Ge=Ge.next=Pt,Sr.lanes|=wt,sf|=wt;Pt=bt.action,$h&&v(V,Pt),V=bt.hasEagerState?bt.eagerState:v(V,Pt)}else wt={lane:Pt,revertLane:bt.revertLane,action:bt.action,hasEagerState:bt.hasEagerState,eagerState:bt.eagerState,next:null},Ge===null?(Ae=Ge=wt,ue=V):Ge=Ge.next=wt,Sr.lanes|=Pt,sf|=Pt;bt=bt.next}while(bt!==null&&bt!==g);if(Ge===null?ue=V:Ge.next=Ae,!ca(V,f.memoizedState)&&(Is=!0,Mt&&(v=$m,v!==null)))throw v;f.memoizedState=V,f.baseState=ue,f.baseQueue=Ge,k.lastRenderedState=V}return j===null&&(k.lanes=0),[f.memoizedState,k.dispatch]}function SA(f){var g=cs(),v=g.queue;if(v===null)throw Error(r(311));v.lastRenderedReducer=f;var k=v.dispatch,j=v.pending,V=g.memoizedState;if(j!==null){v.pending=null;var ue=j=j.next;do V=f(V,ue.action),ue=ue.next;while(ue!==j);ca(V,g.memoizedState)||(Is=!0),g.memoizedState=V,g.baseQueue===null&&(g.baseState=V),v.lastRenderedState=V}return[V,k]}function k5(f,g,v){var k=Sr,j=cs(),V=Yr;if(V){if(v===void 0)throw Error(r(407));v=v()}else v=g();var ue=!ca((ui||j).memoizedState,v);ue&&(j.memoizedState=v,Is=!0),j=j.queue;var Ae=A5.bind(null,k,j,f);if(yb(2048,8,Ae,[f]),j.getSnapshot!==g||ue||ls!==null&&ls.memoizedState.tag&1){if(k.flags|=2048,Vm(9,u_(),T5.bind(null,k,j,v,g),null),_i===null)throw Error(r(349));V||(Xd&124)!==0||E5(k,g,v)}return v}function E5(f,g,v){f.flags|=16384,f={getSnapshot:g,value:v},g=Sr.updateQueue,g===null?(g=xA(),Sr.updateQueue=g,g.stores=[f]):(v=g.stores,v===null?g.stores=[f]:v.push(f))}function T5(f,g,v,k){g.value=v,g.getSnapshot=k,R5(g)&&I5(f)}function A5(f,g,v){return v(function(){R5(g)&&I5(f)})}function R5(f){var g=f.getSnapshot;f=f.value;try{var v=g();return!ca(f,v)}catch{return!0}}function I5(f){var g=Nl(f,2);g!==null&&Ro(g,f,2)}function CA(f){var g=Za();if(typeof f=="function"){var v=f;if(f=v(),$h){Ft(!0);try{v()}finally{Ft(!1)}}}return g.memoizedState=g.baseState=f,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:f},g}function M5(f,g,v,k){return f.baseState=v,_A(f,ui,typeof k=="function"?k:Mu)}function $ce(f,g,v,k,j){if(f_(f))throw Error(r(485));if(f=g.action,f!==null){var V={payload:j,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ue){V.listeners.push(ue)}};q.T!==null?v(!0):V.isTransition=!1,k(V),v=g.pending,v===null?(V.next=g.pending=V,N5(g,V)):(V.next=v.next,g.pending=v.next=V)}}function N5(f,g){var v=g.action,k=g.payload,j=f.state;if(g.isTransition){var V=q.T,ue={};q.T=ue;try{var Ae=v(j,k),Ge=q.S;Ge!==null&&Ge(ue,Ae),j5(f,g,Ae)}catch(bt){kA(f,g,bt)}finally{q.T=V}}else try{V=v(j,k),j5(f,g,V)}catch(bt){kA(f,g,bt)}}function j5(f,g,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?v.then(function(k){O5(f,g,k)},function(k){return kA(f,g,k)}):O5(f,g,v)}function O5(f,g,v){g.status="fulfilled",g.value=v,P5(g),f.state=v,g=f.pending,g!==null&&(v=g.next,v===g?f.pending=null:(v=v.next,g.next=v,N5(f,v)))}function kA(f,g,v){var k=f.pending;if(f.pending=null,k!==null){k=k.next;do g.status="rejected",g.reason=v,P5(g),g=g.next;while(g!==k)}f.action=null}function P5(f){f=f.listeners;for(var g=0;g<f.length;g++)(0,f[g])()}function D5(f,g){return g}function F5(f,g){if(Yr){var v=_i.formState;if(v!==null){e:{var k=Sr;if(Yr){if(qi){t:{for(var j=qi,V=wc;j.nodeType!==8;){if(!V){j=null;break t}if(j=Ol(j.nextSibling),j===null){j=null;break t}}V=j.data,j=V==="F!"||V==="F"?j:null}if(j){qi=Ol(j.nextSibling),k=j.data==="F!";break e}}Dh(k)}k=!1}k&&(g=v[0])}}return v=Za(),v.memoizedState=v.baseState=g,k={pending:null,lanes:0,dispatch:null,lastRenderedReducer:D5,lastRenderedState:g},v.queue=k,v=nF.bind(null,Sr,k),k.dispatch=v,k=CA(!1),V=IA.bind(null,Sr,!1,k.queue),k=Za(),j={state:g,dispatch:null,action:f,pending:null},k.queue=j,v=$ce.bind(null,Sr,j,V,v),j.dispatch=v,k.memoizedState=f,[g,v,!1]}function L5(f){var g=cs();return B5(g,ui,f)}function B5(f,g,v){if(g=_A(f,g,D5)[0],f=c_(Mu)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var k=gb(g)}catch(ue){throw ue===ub?r_:ue}else k=g;g=cs();var j=g.queue,V=j.dispatch;return v!==g.memoizedState&&(Sr.flags|=2048,Vm(9,u_(),zce.bind(null,j,v),null)),[k,V,f]}function zce(f,g){f.action=g}function $5(f){var g=cs(),v=ui;if(v!==null)return B5(g,v,f);cs(),g=g.memoizedState,v=cs();var k=v.queue.dispatch;return v.memoizedState=f,[g,k,!1]}function Vm(f,g,v,k){return f={tag:f,create:v,deps:k,inst:g,next:null},g=Sr.updateQueue,g===null&&(g=xA(),Sr.updateQueue=g),v=g.lastEffect,v===null?g.lastEffect=f.next=f:(k=v.next,v.next=f,f.next=k,g.lastEffect=f),f}function u_(){return{destroy:void 0,resource:void 0}}function z5(){return cs().memoizedState}function d_(f,g,v,k){var j=Za();k=k===void 0?null:k,Sr.flags|=f,j.memoizedState=Vm(1|g,u_(),v,k)}function yb(f,g,v,k){var j=cs();k=k===void 0?null:k;var V=j.memoizedState.inst;ui!==null&&k!==null&&mA(k,ui.memoizedState.deps)?j.memoizedState=Vm(g,V,v,k):(Sr.flags|=f,j.memoizedState=Vm(1|g,V,v,k))}function U5(f,g){d_(8390656,8,f,g)}function q5(f,g){yb(2048,8,f,g)}function V5(f,g){return yb(4,2,f,g)}function H5(f,g){return yb(4,4,f,g)}function W5(f,g){if(typeof g=="function"){f=f();var v=g(f);return function(){typeof v=="function"?v():g(null)}}if(g!=null)return f=f(),g.current=f,function(){g.current=null}}function G5(f,g,v){v=v!=null?v.concat([f]):null,yb(4,4,W5.bind(null,g,f),v)}function EA(){}function K5(f,g){var v=cs();g=g===void 0?null:g;var k=v.memoizedState;return g!==null&&mA(g,k[1])?k[0]:(v.memoizedState=[f,g],f)}function Y5(f,g){var v=cs();g=g===void 0?null:g;var k=v.memoizedState;if(g!==null&&mA(g,k[1]))return k[0];if(k=f(),$h){Ft(!0);try{f()}finally{Ft(!1)}}return v.memoizedState=[k,g],k}function TA(f,g,v){return v===void 0||(Xd&1073741824)!==0?f.memoizedState=g:(f.memoizedState=v,f=JF(),Sr.lanes|=f,sf|=f,v)}function Z5(f,g,v,k){return ca(v,g)?v:zm.current!==null?(f=TA(f,v,k),ca(f,g)||(Is=!0),f):(Xd&42)===0?(Is=!0,f.memoizedState=v):(f=JF(),Sr.lanes|=f,sf|=f,g)}function X5(f,g,v,k,j){var V=K.p;K.p=V!==0&&8>V?V:8;var ue=q.T,Ae={};q.T=Ae,IA(f,!1,g,v);try{var Ge=j(),bt=q.S;if(bt!==null&&bt(Ae,Ge),Ge!==null&&typeof Ge=="object"&&typeof Ge.then=="function"){var Mt=Fce(Ge,k);bb(f,g,Mt,Ao(f))}else bb(f,g,k,Ao(f))}catch(Pt){bb(f,g,{then:function(){},status:"rejected",reason:Pt},Ao())}finally{K.p=V,q.T=ue}}function Uce(){}function AA(f,g,v,k){if(f.tag!==5)throw Error(r(476));var j=J5(f).queue;X5(f,j,g,U,v===null?Uce:function(){return Q5(f),v(k)})}function J5(f){var g=f.memoizedState;if(g!==null)return g;g={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:U},next:null};var v={};return g.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mu,lastRenderedState:v},next:null},f.memoizedState=g,f=f.alternate,f!==null&&(f.memoizedState=g),g}function Q5(f){var g=J5(f).next.queue;bb(f,g,{},Ao())}function RA(){return ua(Db)}function eF(){return cs().memoizedState}function tF(){return cs().memoizedState}function qce(f){for(var g=f.return;g!==null;){switch(g.tag){case 24:case 3:var v=Ao();f=Yd(v);var k=Zd(g,f,v);k!==null&&(Ro(k,g,v),fb(k,g,v)),g={cache:sA()},f.payload=g;return}g=g.return}}function Vce(f,g,v){var k=Ao();v={lane:k,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null},f_(f)?rF(g,v):(v=os(f,g,v,k),v!==null&&(Ro(v,f,k),iF(v,g,k)))}function nF(f,g,v){var k=Ao();bb(f,g,v,k)}function bb(f,g,v,k){var j={lane:k,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(f_(f))rF(g,j);else{var V=f.alternate;if(f.lanes===0&&(V===null||V.lanes===0)&&(V=g.lastRenderedReducer,V!==null))try{var ue=g.lastRenderedState,Ae=V(ue,v);if(j.hasEagerState=!0,j.eagerState=Ae,ca(Ae,ue))return Yi(f,g,j,0),_i===null&&Kn(),!1}catch{}finally{}if(v=os(f,g,j,k),v!==null)return Ro(v,f,k),iF(v,g,k),!0}return!1}function IA(f,g,v,k){if(k={lane:2,revertLane:lR(),action:k,hasEagerState:!1,eagerState:null,next:null},f_(f)){if(g)throw Error(r(479))}else g=os(f,v,k,2),g!==null&&Ro(g,f,2)}function f_(f){var g=f.alternate;return f===Sr||g!==null&&g===Sr}function rF(f,g){Um=a_=!0;var v=f.pending;v===null?g.next=g:(g.next=v.next,v.next=g),f.pending=g}function iF(f,g,v){if((v&4194048)!==0){var k=g.lanes;k&=f.pendingLanes,v|=k,g.lanes=v,ze(f,v)}}var h_={readContext:ua,use:l_,useCallback:Zi,useContext:Zi,useEffect:Zi,useImperativeHandle:Zi,useLayoutEffect:Zi,useInsertionEffect:Zi,useMemo:Zi,useReducer:Zi,useRef:Zi,useState:Zi,useDebugValue:Zi,useDeferredValue:Zi,useTransition:Zi,useSyncExternalStore:Zi,useId:Zi,useHostTransitionStatus:Zi,useFormState:Zi,useActionState:Zi,useOptimistic:Zi,useMemoCache:Zi,useCacheRefresh:Zi},sF={readContext:ua,use:l_,useCallback:function(f,g){return Za().memoizedState=[f,g===void 0?null:g],f},useContext:ua,useEffect:U5,useImperativeHandle:function(f,g,v){v=v!=null?v.concat([f]):null,d_(4194308,4,W5.bind(null,g,f),v)},useLayoutEffect:function(f,g){return d_(4194308,4,f,g)},useInsertionEffect:function(f,g){d_(4,2,f,g)},useMemo:function(f,g){var v=Za();g=g===void 0?null:g;var k=f();if($h){Ft(!0);try{f()}finally{Ft(!1)}}return v.memoizedState=[k,g],k},useReducer:function(f,g,v){var k=Za();if(v!==void 0){var j=v(g);if($h){Ft(!0);try{v(g)}finally{Ft(!1)}}}else j=g;return k.memoizedState=k.baseState=j,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:j},k.queue=f,f=f.dispatch=Vce.bind(null,Sr,f),[k.memoizedState,f]},useRef:function(f){var g=Za();return f={current:f},g.memoizedState=f},useState:function(f){f=CA(f);var g=f.queue,v=nF.bind(null,Sr,g);return g.dispatch=v,[f.memoizedState,v]},useDebugValue:EA,useDeferredValue:function(f,g){var v=Za();return TA(v,f,g)},useTransition:function(){var f=CA(!1);return f=X5.bind(null,Sr,f.queue,!0,!1),Za().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,g,v){var k=Sr,j=Za();if(Yr){if(v===void 0)throw Error(r(407));v=v()}else{if(v=g(),_i===null)throw Error(r(349));(Fr&124)!==0||E5(k,g,v)}j.memoizedState=v;var V={value:v,getSnapshot:g};return j.queue=V,U5(A5.bind(null,k,V,f),[f]),k.flags|=2048,Vm(9,u_(),T5.bind(null,k,V,v,g),null),v},useId:function(){var f=Za(),g=_i.identifierPrefix;if(Yr){var v=Au,k=Tu;v=(k&~(1<<32-tn(k)-1)).toString(32)+v,g=""+g+"R"+v,v=o_++,0<v&&(g+="H"+v.toString(32)),g+=""}else v=Lce++,g=""+g+"r"+v.toString(32)+"";return f.memoizedState=g},useHostTransitionStatus:RA,useFormState:F5,useActionState:F5,useOptimistic:function(f){var g=Za();g.memoizedState=g.baseState=f;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=v,g=IA.bind(null,Sr,!0,v),v.dispatch=g,[f,g]},useMemoCache:wA,useCacheRefresh:function(){return Za().memoizedState=qce.bind(null,Sr)}},aF={readContext:ua,use:l_,useCallback:K5,useContext:ua,useEffect:q5,useImperativeHandle:G5,useInsertionEffect:V5,useLayoutEffect:H5,useMemo:Y5,useReducer:c_,useRef:z5,useState:function(){return c_(Mu)},useDebugValue:EA,useDeferredValue:function(f,g){var v=cs();return Z5(v,ui.memoizedState,f,g)},useTransition:function(){var f=c_(Mu)[0],g=cs().memoizedState;return[typeof f=="boolean"?f:gb(f),g]},useSyncExternalStore:k5,useId:eF,useHostTransitionStatus:RA,useFormState:L5,useActionState:L5,useOptimistic:function(f,g){var v=cs();return M5(v,ui,f,g)},useMemoCache:wA,useCacheRefresh:tF},Hce={readContext:ua,use:l_,useCallback:K5,useContext:ua,useEffect:q5,useImperativeHandle:G5,useInsertionEffect:V5,useLayoutEffect:H5,useMemo:Y5,useReducer:SA,useRef:z5,useState:function(){return SA(Mu)},useDebugValue:EA,useDeferredValue:function(f,g){var v=cs();return ui===null?TA(v,f,g):Z5(v,ui.memoizedState,f,g)},useTransition:function(){var f=SA(Mu)[0],g=cs().memoizedState;return[typeof f=="boolean"?f:gb(f),g]},useSyncExternalStore:k5,useId:eF,useHostTransitionStatus:RA,useFormState:$5,useActionState:$5,useOptimistic:function(f,g){var v=cs();return ui!==null?M5(v,ui,f,g):(v.baseState=f,[f,v.queue.dispatch])},useMemoCache:wA,useCacheRefresh:tF},Hm=null,vb=0;function p_(f){var g=vb;return vb+=1,Hm===null&&(Hm=[]),y5(Hm,f,g)}function xb(f,g){g=g.props.ref,f.ref=g!==void 0?g:null}function m_(f,g){throw g.$$typeof===d?Error(r(525)):(f=Object.prototype.toString.call(g),Error(r(31,f==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":f)))}function oF(f){var g=f._init;return g(f._payload)}function lF(f){function g(lt,Qe){if(f){var gt=lt.deletions;gt===null?(lt.deletions=[Qe],lt.flags|=16):gt.push(Qe)}}function v(lt,Qe){if(!f)return null;for(;Qe!==null;)g(lt,Qe),Qe=Qe.sibling;return null}function k(lt){for(var Qe=new Map;lt!==null;)lt.key!==null?Qe.set(lt.key,lt):Qe.set(lt.index,lt),lt=lt.sibling;return Qe}function j(lt,Qe){return lt=Eu(lt,Qe),lt.index=0,lt.sibling=null,lt}function V(lt,Qe,gt){return lt.index=gt,f?(gt=lt.alternate,gt!==null?(gt=gt.index,gt<Qe?(lt.flags|=67108866,Qe):gt):(lt.flags|=67108866,Qe)):(lt.flags|=1048576,Qe)}function ue(lt){return f&&lt.alternate===null&&(lt.flags|=67108866),lt}function Ae(lt,Qe,gt,Ot){return Qe===null||Qe.tag!==6?(Qe=XT(gt,lt.mode,Ot),Qe.return=lt,Qe):(Qe=j(Qe,gt),Qe.return=lt,Qe)}function Ge(lt,Qe,gt,Ot){var mn=gt.type;return mn===y?Mt(lt,Qe,gt.props.children,Ot,gt.key):Qe!==null&&(Qe.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===M&&oF(mn)===Qe.type)?(Qe=j(Qe,gt.props),xb(Qe,gt),Qe.return=lt,Qe):(Qe=X1(gt.type,gt.key,gt.props,null,lt.mode,Ot),xb(Qe,gt),Qe.return=lt,Qe)}function bt(lt,Qe,gt,Ot){return Qe===null||Qe.tag!==4||Qe.stateNode.containerInfo!==gt.containerInfo||Qe.stateNode.implementation!==gt.implementation?(Qe=JT(gt,lt.mode,Ot),Qe.return=lt,Qe):(Qe=j(Qe,gt.children||[]),Qe.return=lt,Qe)}function Mt(lt,Qe,gt,Ot,mn){return Qe===null||Qe.tag!==7?(Qe=Nh(gt,lt.mode,Ot,mn),Qe.return=lt,Qe):(Qe=j(Qe,gt),Qe.return=lt,Qe)}function Pt(lt,Qe,gt){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return Qe=XT(""+Qe,lt.mode,gt),Qe.return=lt,Qe;if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case h:return gt=X1(Qe.type,Qe.key,Qe.props,null,lt.mode,gt),xb(gt,Qe),gt.return=lt,gt;case p:return Qe=JT(Qe,lt.mode,gt),Qe.return=lt,Qe;case M:var Ot=Qe._init;return Qe=Ot(Qe._payload),Pt(lt,Qe,gt)}if(Q(Qe)||P(Qe))return Qe=Nh(Qe,lt.mode,gt,null),Qe.return=lt,Qe;if(typeof Qe.then=="function")return Pt(lt,p_(Qe),gt);if(Qe.$$typeof===S)return Pt(lt,t_(lt,Qe),gt);m_(lt,Qe)}return null}function wt(lt,Qe,gt,Ot){var mn=Qe!==null?Qe.key:null;if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return mn!==null?null:Ae(lt,Qe,""+gt,Ot);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case h:return gt.key===mn?Ge(lt,Qe,gt,Ot):null;case p:return gt.key===mn?bt(lt,Qe,gt,Ot):null;case M:return mn=gt._init,gt=mn(gt._payload),wt(lt,Qe,gt,Ot)}if(Q(gt)||P(gt))return mn!==null?null:Mt(lt,Qe,gt,Ot,null);if(typeof gt.then=="function")return wt(lt,Qe,p_(gt),Ot);if(gt.$$typeof===S)return wt(lt,Qe,t_(lt,gt),Ot);m_(lt,gt)}return null}function St(lt,Qe,gt,Ot,mn){if(typeof Ot=="string"&&Ot!==""||typeof Ot=="number"||typeof Ot=="bigint")return lt=lt.get(gt)||null,Ae(Qe,lt,""+Ot,mn);if(typeof Ot=="object"&&Ot!==null){switch(Ot.$$typeof){case h:return lt=lt.get(Ot.key===null?gt:Ot.key)||null,Ge(Qe,lt,Ot,mn);case p:return lt=lt.get(Ot.key===null?gt:Ot.key)||null,bt(Qe,lt,Ot,mn);case M:var Tr=Ot._init;return Ot=Tr(Ot._payload),St(lt,Qe,gt,Ot,mn)}if(Q(Ot)||P(Ot))return lt=lt.get(gt)||null,Mt(Qe,lt,Ot,mn,null);if(typeof Ot.then=="function")return St(lt,Qe,gt,p_(Ot),mn);if(Ot.$$typeof===S)return St(lt,Qe,gt,t_(Qe,Ot),mn);m_(Qe,Ot)}return null}function Yn(lt,Qe,gt,Ot){for(var mn=null,Tr=null,Tn=Qe,zn=Qe=0,Ns=null;Tn!==null&&zn<gt.length;zn++){Tn.index>zn?(Ns=Tn,Tn=null):Ns=Tn.sibling;var Hr=wt(lt,Tn,gt[zn],Ot);if(Hr===null){Tn===null&&(Tn=Ns);break}f&&Tn&&Hr.alternate===null&&g(lt,Tn),Qe=V(Hr,Qe,zn),Tr===null?mn=Hr:Tr.sibling=Hr,Tr=Hr,Tn=Ns}if(zn===gt.length)return v(lt,Tn),Yr&&Oh(lt,zn),mn;if(Tn===null){for(;zn<gt.length;zn++)Tn=Pt(lt,gt[zn],Ot),Tn!==null&&(Qe=V(Tn,Qe,zn),Tr===null?mn=Tn:Tr.sibling=Tn,Tr=Tn);return Yr&&Oh(lt,zn),mn}for(Tn=k(Tn);zn<gt.length;zn++)Ns=St(Tn,lt,zn,gt[zn],Ot),Ns!==null&&(f&&Ns.alternate!==null&&Tn.delete(Ns.key===null?zn:Ns.key),Qe=V(Ns,Qe,zn),Tr===null?mn=Ns:Tr.sibling=Ns,Tr=Ns);return f&&Tn.forEach(function(pf){return g(lt,pf)}),Yr&&Oh(lt,zn),mn}function Ln(lt,Qe,gt,Ot){if(gt==null)throw Error(r(151));for(var mn=null,Tr=null,Tn=Qe,zn=Qe=0,Ns=null,Hr=gt.next();Tn!==null&&!Hr.done;zn++,Hr=gt.next()){Tn.index>zn?(Ns=Tn,Tn=null):Ns=Tn.sibling;var pf=wt(lt,Tn,Hr.value,Ot);if(pf===null){Tn===null&&(Tn=Ns);break}f&&Tn&&pf.alternate===null&&g(lt,Tn),Qe=V(pf,Qe,zn),Tr===null?mn=pf:Tr.sibling=pf,Tr=pf,Tn=Ns}if(Hr.done)return v(lt,Tn),Yr&&Oh(lt,zn),mn;if(Tn===null){for(;!Hr.done;zn++,Hr=gt.next())Hr=Pt(lt,Hr.value,Ot),Hr!==null&&(Qe=V(Hr,Qe,zn),Tr===null?mn=Hr:Tr.sibling=Hr,Tr=Hr);return Yr&&Oh(lt,zn),mn}for(Tn=k(Tn);!Hr.done;zn++,Hr=gt.next())Hr=St(Tn,lt,zn,Hr.value,Ot),Hr!==null&&(f&&Hr.alternate!==null&&Tn.delete(Hr.key===null?zn:Hr.key),Qe=V(Hr,Qe,zn),Tr===null?mn=Hr:Tr.sibling=Hr,Tr=Hr);return f&&Tn.forEach(function(Wue){return g(lt,Wue)}),Yr&&Oh(lt,zn),mn}function fi(lt,Qe,gt,Ot){if(typeof gt=="object"&&gt!==null&&gt.type===y&&gt.key===null&&(gt=gt.props.children),typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case h:e:{for(var mn=gt.key;Qe!==null;){if(Qe.key===mn){if(mn=gt.type,mn===y){if(Qe.tag===7){v(lt,Qe.sibling),Ot=j(Qe,gt.props.children),Ot.return=lt,lt=Ot;break e}}else if(Qe.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===M&&oF(mn)===Qe.type){v(lt,Qe.sibling),Ot=j(Qe,gt.props),xb(Ot,gt),Ot.return=lt,lt=Ot;break e}v(lt,Qe);break}else g(lt,Qe);Qe=Qe.sibling}gt.type===y?(Ot=Nh(gt.props.children,lt.mode,Ot,gt.key),Ot.return=lt,lt=Ot):(Ot=X1(gt.type,gt.key,gt.props,null,lt.mode,Ot),xb(Ot,gt),Ot.return=lt,lt=Ot)}return ue(lt);case p:e:{for(mn=gt.key;Qe!==null;){if(Qe.key===mn)if(Qe.tag===4&&Qe.stateNode.containerInfo===gt.containerInfo&&Qe.stateNode.implementation===gt.implementation){v(lt,Qe.sibling),Ot=j(Qe,gt.children||[]),Ot.return=lt,lt=Ot;break e}else{v(lt,Qe);break}else g(lt,Qe);Qe=Qe.sibling}Ot=JT(gt,lt.mode,Ot),Ot.return=lt,lt=Ot}return ue(lt);case M:return mn=gt._init,gt=mn(gt._payload),fi(lt,Qe,gt,Ot)}if(Q(gt))return Yn(lt,Qe,gt,Ot);if(P(gt)){if(mn=P(gt),typeof mn!="function")throw Error(r(150));return gt=mn.call(gt),Ln(lt,Qe,gt,Ot)}if(typeof gt.then=="function")return fi(lt,Qe,p_(gt),Ot);if(gt.$$typeof===S)return fi(lt,Qe,t_(lt,gt),Ot);m_(lt,gt)}return typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint"?(gt=""+gt,Qe!==null&&Qe.tag===6?(v(lt,Qe.sibling),Ot=j(Qe,gt),Ot.return=lt,lt=Ot):(v(lt,Qe),Ot=XT(gt,lt.mode,Ot),Ot.return=lt,lt=Ot),ue(lt)):v(lt,Qe)}return function(lt,Qe,gt,Ot){try{vb=0;var mn=fi(lt,Qe,gt,Ot);return Hm=null,mn}catch(Tn){if(Tn===ub||Tn===r_)throw Tn;var Tr=Co(29,Tn,null,lt.mode);return Tr.lanes=Ot,Tr.return=lt,Tr}finally{}}}var Wm=lF(!0),cF=lF(!1),Qo=ne(null),_c=null;function Jd(f){var g=f.alternate;se(bs,bs.current&1),se(Qo,f),_c===null&&(g===null||zm.current!==null||g.memoizedState!==null)&&(_c=f)}function uF(f){if(f.tag===22){if(se(bs,bs.current),se(Qo,f),_c===null){var g=f.alternate;g!==null&&g.memoizedState!==null&&(_c=f)}}else Qd()}function Qd(){se(bs,bs.current),se(Qo,Qo.current)}function Nu(f){te(Qo),_c===f&&(_c=null),te(bs)}var bs=ne(0);function g_(f){for(var g=f;g!==null;){if(g.tag===13){var v=g.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||xR(v)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function MA(f,g,v,k){g=f.memoizedState,v=v(k,g),v=v==null?g:u({},g,v),f.memoizedState=v,f.lanes===0&&(f.updateQueue.baseState=v)}var NA={enqueueSetState:function(f,g,v){f=f._reactInternals;var k=Ao(),j=Yd(k);j.payload=g,v!=null&&(j.callback=v),g=Zd(f,j,k),g!==null&&(Ro(g,f,k),fb(g,f,k))},enqueueReplaceState:function(f,g,v){f=f._reactInternals;var k=Ao(),j=Yd(k);j.tag=1,j.payload=g,v!=null&&(j.callback=v),g=Zd(f,j,k),g!==null&&(Ro(g,f,k),fb(g,f,k))},enqueueForceUpdate:function(f,g){f=f._reactInternals;var v=Ao(),k=Yd(v);k.tag=2,g!=null&&(k.callback=g),g=Zd(f,k,v),g!==null&&(Ro(g,f,v),fb(g,f,v))}};function dF(f,g,v,k,j,V,ue){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(k,V,ue):g.prototype&&g.prototype.isPureReactComponent?!I(v,k)||!I(j,V):!0}function fF(f,g,v,k){f=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(v,k),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(v,k),g.state!==f&&NA.enqueueReplaceState(g,g.state,null)}function zh(f,g){var v=g;if("ref"in g){v={};for(var k in g)k!=="ref"&&(v[k]=g[k])}if(f=f.defaultProps){v===g&&(v=u({},v));for(var j in f)v[j]===void 0&&(v[j]=f[j])}return v}var y_=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(g))return}else if(typeof es=="object"&&typeof es.emit=="function"){es.emit("uncaughtException",f);return}console.error(f)};function hF(f){y_(f)}function pF(f){console.error(f)}function mF(f){y_(f)}function b_(f,g){try{var v=f.onUncaughtError;v(g.value,{componentStack:g.stack})}catch(k){setTimeout(function(){throw k})}}function gF(f,g,v){try{var k=f.onCaughtError;k(v.value,{componentStack:v.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function jA(f,g,v){return v=Yd(v),v.tag=3,v.payload={element:null},v.callback=function(){b_(f,g)},v}function yF(f){return f=Yd(f),f.tag=3,f}function bF(f,g,v,k){var j=v.type.getDerivedStateFromError;if(typeof j=="function"){var V=k.value;f.payload=function(){return j(V)},f.callback=function(){gF(g,v,k)}}var ue=v.stateNode;ue!==null&&typeof ue.componentDidCatch=="function"&&(f.callback=function(){gF(g,v,k),typeof j!="function"&&(af===null?af=new Set([this]):af.add(this));var Ae=k.stack;this.componentDidCatch(k.value,{componentStack:Ae!==null?Ae:""})})}function Wce(f,g,v,k,j){if(v.flags|=32768,k!==null&&typeof k=="object"&&typeof k.then=="function"){if(g=v.alternate,g!==null&&ob(g,v,j,!0),v=Qo.current,v!==null){switch(v.tag){case 13:return _c===null?rR():v.alternate===null&&Vi===0&&(Vi=3),v.flags&=-257,v.flags|=65536,v.lanes=j,k===lA?v.flags|=16384:(g=v.updateQueue,g===null?v.updateQueue=new Set([k]):g.add(k),sR(f,k,j)),!1;case 22:return v.flags|=65536,k===lA?v.flags|=16384:(g=v.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([k])},v.updateQueue=g):(v=g.retryQueue,v===null?g.retryQueue=new Set([k]):v.add(k)),sR(f,k,j)),!1}throw Error(r(435,v.tag))}return sR(f,k,j),rR(),!1}if(Yr)return g=Qo.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=j,k!==tA&&(f=Error(r(422),{cause:k}),ab(Mn(f,v)))):(k!==tA&&(g=Error(r(423),{cause:k}),ab(Mn(g,v))),f=f.current.alternate,f.flags|=65536,j&=-j,f.lanes|=j,k=Mn(k,v),j=jA(f.stateNode,k,j),dA(f,j),Vi!==4&&(Vi=2)),!1;var V=Error(r(520),{cause:k});if(V=Mn(V,v),Tb===null?Tb=[V]:Tb.push(V),Vi!==4&&(Vi=2),g===null)return!0;k=Mn(k,v),v=g;do{switch(v.tag){case 3:return v.flags|=65536,f=j&-j,v.lanes|=f,f=jA(v.stateNode,k,f),dA(v,f),!1;case 1:if(g=v.type,V=v.stateNode,(v.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||V!==null&&typeof V.componentDidCatch=="function"&&(af===null||!af.has(V))))return v.flags|=65536,j&=-j,v.lanes|=j,j=yF(j),bF(j,f,v,k),dA(v,j),!1}v=v.return}while(v!==null);return!1}var vF=Error(r(461)),Is=!1;function Ys(f,g,v,k){g.child=f===null?cF(g,null,v,k):Wm(g,f.child,v,k)}function xF(f,g,v,k,j){v=v.render;var V=g.ref;if("ref"in k){var ue={};for(var Ae in k)Ae!=="ref"&&(ue[Ae]=k[Ae])}else ue=k;return Lh(g),k=gA(f,g,v,ue,V,j),Ae=yA(),f!==null&&!Is?(bA(f,g,j),ju(f,g,j)):(Yr&&Ae&&QT(g),g.flags|=1,Ys(f,g,k,j),g.child)}function wF(f,g,v,k,j){if(f===null){var V=v.type;return typeof V=="function"&&!ZT(V)&&V.defaultProps===void 0&&v.compare===null?(g.tag=15,g.type=V,_F(f,g,V,k,j)):(f=X1(v.type,null,k,g,g.mode,j),f.ref=g.ref,f.return=g,g.child=f)}if(V=f.child,!zA(f,j)){var ue=V.memoizedProps;if(v=v.compare,v=v!==null?v:I,v(ue,k)&&f.ref===g.ref)return ju(f,g,j)}return g.flags|=1,f=Eu(V,k),f.ref=g.ref,f.return=g,g.child=f}function _F(f,g,v,k,j){if(f!==null){var V=f.memoizedProps;if(I(V,k)&&f.ref===g.ref)if(Is=!1,g.pendingProps=k=V,zA(f,j))(f.flags&131072)!==0&&(Is=!0);else return g.lanes=f.lanes,ju(f,g,j)}return OA(f,g,v,k,j)}function SF(f,g,v){var k=g.pendingProps,j=k.children,V=f!==null?f.memoizedState:null;if(k.mode==="hidden"){if((g.flags&128)!==0){if(k=V!==null?V.baseLanes|v:v,f!==null){for(j=g.child=f.child,V=0;j!==null;)V=V|j.lanes|j.childLanes,j=j.sibling;g.childLanes=V&~k}else g.childLanes=0,g.child=null;return CF(f,g,k,v)}if((v&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},f!==null&&n_(g,V!==null?V.cachePool:null),V!==null?_5(g,V):hA(),uF(g);else return g.lanes=g.childLanes=536870912,CF(f,g,V!==null?V.baseLanes|v:v,v)}else V!==null?(n_(g,V.cachePool),_5(g,V),Qd(),g.memoizedState=null):(f!==null&&n_(g,null),hA(),Qd());return Ys(f,g,j,v),g.child}function CF(f,g,v,k){var j=oA();return j=j===null?null:{parent:ys._currentValue,pool:j},g.memoizedState={baseLanes:v,cachePool:j},f!==null&&n_(g,null),hA(),uF(g),f!==null&&ob(f,g,k,!0),null}function v_(f,g){var v=g.ref;if(v===null)f!==null&&f.ref!==null&&(g.flags|=4194816);else{if(typeof v!="function"&&typeof v!="object")throw Error(r(284));(f===null||f.ref!==v)&&(g.flags|=4194816)}}function OA(f,g,v,k,j){return Lh(g),v=gA(f,g,v,k,void 0,j),k=yA(),f!==null&&!Is?(bA(f,g,j),ju(f,g,j)):(Yr&&k&&QT(g),g.flags|=1,Ys(f,g,v,j),g.child)}function kF(f,g,v,k,j,V){return Lh(g),g.updateQueue=null,v=C5(g,k,v,j),S5(f),k=yA(),f!==null&&!Is?(bA(f,g,V),ju(f,g,V)):(Yr&&k&&QT(g),g.flags|=1,Ys(f,g,v,V),g.child)}function EF(f,g,v,k,j){if(Lh(g),g.stateNode===null){var V=xc,ue=v.contextType;typeof ue=="object"&&ue!==null&&(V=ua(ue)),V=new v(k,V),g.memoizedState=V.state!==null&&V.state!==void 0?V.state:null,V.updater=NA,g.stateNode=V,V._reactInternals=g,V=g.stateNode,V.props=k,V.state=g.memoizedState,V.refs={},cA(g),ue=v.contextType,V.context=typeof ue=="object"&&ue!==null?ua(ue):xc,V.state=g.memoizedState,ue=v.getDerivedStateFromProps,typeof ue=="function"&&(MA(g,v,ue,k),V.state=g.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof V.getSnapshotBeforeUpdate=="function"||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(ue=V.state,typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount(),ue!==V.state&&NA.enqueueReplaceState(V,V.state,null),pb(g,k,V,j),hb(),V.state=g.memoizedState),typeof V.componentDidMount=="function"&&(g.flags|=4194308),k=!0}else if(f===null){V=g.stateNode;var Ae=g.memoizedProps,Ge=zh(v,Ae);V.props=Ge;var bt=V.context,Mt=v.contextType;ue=xc,typeof Mt=="object"&&Mt!==null&&(ue=ua(Mt));var Pt=v.getDerivedStateFromProps;Mt=typeof Pt=="function"||typeof V.getSnapshotBeforeUpdate=="function",Ae=g.pendingProps!==Ae,Mt||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(Ae||bt!==ue)&&fF(g,V,k,ue),Kd=!1;var wt=g.memoizedState;V.state=wt,pb(g,k,V,j),hb(),bt=g.memoizedState,Ae||wt!==bt||Kd?(typeof Pt=="function"&&(MA(g,v,Pt,k),bt=g.memoizedState),(Ge=Kd||dF(g,v,Ge,k,wt,bt,ue))?(Mt||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount()),typeof V.componentDidMount=="function"&&(g.flags|=4194308)):(typeof V.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=k,g.memoizedState=bt),V.props=k,V.state=bt,V.context=ue,k=Ge):(typeof V.componentDidMount=="function"&&(g.flags|=4194308),k=!1)}else{V=g.stateNode,uA(f,g),ue=g.memoizedProps,Mt=zh(v,ue),V.props=Mt,Pt=g.pendingProps,wt=V.context,bt=v.contextType,Ge=xc,typeof bt=="object"&&bt!==null&&(Ge=ua(bt)),Ae=v.getDerivedStateFromProps,(bt=typeof Ae=="function"||typeof V.getSnapshotBeforeUpdate=="function")||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(ue!==Pt||wt!==Ge)&&fF(g,V,k,Ge),Kd=!1,wt=g.memoizedState,V.state=wt,pb(g,k,V,j),hb();var St=g.memoizedState;ue!==Pt||wt!==St||Kd||f!==null&&f.dependencies!==null&&e_(f.dependencies)?(typeof Ae=="function"&&(MA(g,v,Ae,k),St=g.memoizedState),(Mt=Kd||dF(g,v,Mt,k,wt,St,Ge)||f!==null&&f.dependencies!==null&&e_(f.dependencies))?(bt||typeof V.UNSAFE_componentWillUpdate!="function"&&typeof V.componentWillUpdate!="function"||(typeof V.componentWillUpdate=="function"&&V.componentWillUpdate(k,St,Ge),typeof V.UNSAFE_componentWillUpdate=="function"&&V.UNSAFE_componentWillUpdate(k,St,Ge)),typeof V.componentDidUpdate=="function"&&(g.flags|=4),typeof V.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof V.componentDidUpdate!="function"||ue===f.memoizedProps&&wt===f.memoizedState||(g.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||ue===f.memoizedProps&&wt===f.memoizedState||(g.flags|=1024),g.memoizedProps=k,g.memoizedState=St),V.props=k,V.state=St,V.context=Ge,k=Mt):(typeof V.componentDidUpdate!="function"||ue===f.memoizedProps&&wt===f.memoizedState||(g.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||ue===f.memoizedProps&&wt===f.memoizedState||(g.flags|=1024),k=!1)}return V=k,v_(f,g),k=(g.flags&128)!==0,V||k?(V=g.stateNode,v=k&&typeof v.getDerivedStateFromError!="function"?null:V.render(),g.flags|=1,f!==null&&k?(g.child=Wm(g,f.child,null,j),g.child=Wm(g,null,v,j)):Ys(f,g,v,j),g.memoizedState=V.state,f=g.child):f=ju(f,g,j),f}function TF(f,g,v,k){return sb(),g.flags|=256,Ys(f,g,v,k),g.child}var PA={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function DA(f){return{baseLanes:f,cachePool:p5()}}function FA(f,g,v){return f=f!==null?f.childLanes&~v:0,g&&(f|=el),f}function AF(f,g,v){var k=g.pendingProps,j=!1,V=(g.flags&128)!==0,ue;if((ue=V)||(ue=f!==null&&f.memoizedState===null?!1:(bs.current&2)!==0),ue&&(j=!0,g.flags&=-129),ue=(g.flags&32)!==0,g.flags&=-33,f===null){if(Yr){if(j?Jd(g):Qd(),Yr){var Ae=qi,Ge;if(Ge=Ae){e:{for(Ge=Ae,Ae=wc;Ge.nodeType!==8;){if(!Ae){Ae=null;break e}if(Ge=Ol(Ge.nextSibling),Ge===null){Ae=null;break e}}Ae=Ge}Ae!==null?(g.memoizedState={dehydrated:Ae,treeContext:jh!==null?{id:Tu,overflow:Au}:null,retryLane:536870912,hydrationErrors:null},Ge=Co(18,null,null,0),Ge.stateNode=Ae,Ge.return=g,g.child=Ge,Ma=g,qi=null,Ge=!0):Ge=!1}Ge||Dh(g)}if(Ae=g.memoizedState,Ae!==null&&(Ae=Ae.dehydrated,Ae!==null))return xR(Ae)?g.lanes=32:g.lanes=536870912,null;Nu(g)}return Ae=k.children,k=k.fallback,j?(Qd(),j=g.mode,Ae=x_({mode:"hidden",children:Ae},j),k=Nh(k,j,v,null),Ae.return=g,k.return=g,Ae.sibling=k,g.child=Ae,j=g.child,j.memoizedState=DA(v),j.childLanes=FA(f,ue,v),g.memoizedState=PA,k):(Jd(g),LA(g,Ae))}if(Ge=f.memoizedState,Ge!==null&&(Ae=Ge.dehydrated,Ae!==null)){if(V)g.flags&256?(Jd(g),g.flags&=-257,g=BA(f,g,v)):g.memoizedState!==null?(Qd(),g.child=f.child,g.flags|=128,g=null):(Qd(),j=k.fallback,Ae=g.mode,k=x_({mode:"visible",children:k.children},Ae),j=Nh(j,Ae,v,null),j.flags|=2,k.return=g,j.return=g,k.sibling=j,g.child=k,Wm(g,f.child,null,v),k=g.child,k.memoizedState=DA(v),k.childLanes=FA(f,ue,v),g.memoizedState=PA,g=j);else if(Jd(g),xR(Ae)){if(ue=Ae.nextSibling&&Ae.nextSibling.dataset,ue)var bt=ue.dgst;ue=bt,k=Error(r(419)),k.stack="",k.digest=ue,ab({value:k,source:null,stack:null}),g=BA(f,g,v)}else if(Is||ob(f,g,v,!1),ue=(v&f.childLanes)!==0,Is||ue){if(ue=_i,ue!==null&&(k=v&-v,k=(k&42)!==0?1:Tt(k),k=(k&(ue.suspendedLanes|v))!==0?0:k,k!==0&&k!==Ge.retryLane))throw Ge.retryLane=k,Nl(f,k),Ro(ue,f,k),vF;Ae.data==="$?"||rR(),g=BA(f,g,v)}else Ae.data==="$?"?(g.flags|=192,g.child=f.child,g=null):(f=Ge.treeContext,qi=Ol(Ae.nextSibling),Ma=g,Yr=!0,Ph=null,wc=!1,f!==null&&(Xo[Jo++]=Tu,Xo[Jo++]=Au,Xo[Jo++]=jh,Tu=f.id,Au=f.overflow,jh=g),g=LA(g,k.children),g.flags|=4096);return g}return j?(Qd(),j=k.fallback,Ae=g.mode,Ge=f.child,bt=Ge.sibling,k=Eu(Ge,{mode:"hidden",children:k.children}),k.subtreeFlags=Ge.subtreeFlags&65011712,bt!==null?j=Eu(bt,j):(j=Nh(j,Ae,v,null),j.flags|=2),j.return=g,k.return=g,k.sibling=j,g.child=k,k=j,j=g.child,Ae=f.child.memoizedState,Ae===null?Ae=DA(v):(Ge=Ae.cachePool,Ge!==null?(bt=ys._currentValue,Ge=Ge.parent!==bt?{parent:bt,pool:bt}:Ge):Ge=p5(),Ae={baseLanes:Ae.baseLanes|v,cachePool:Ge}),j.memoizedState=Ae,j.childLanes=FA(f,ue,v),g.memoizedState=PA,k):(Jd(g),v=f.child,f=v.sibling,v=Eu(v,{mode:"visible",children:k.children}),v.return=g,v.sibling=null,f!==null&&(ue=g.deletions,ue===null?(g.deletions=[f],g.flags|=16):ue.push(f)),g.child=v,g.memoizedState=null,v)}function LA(f,g){return g=x_({mode:"visible",children:g},f.mode),g.return=f,f.child=g}function x_(f,g){return f=Co(22,f,null,g),f.lanes=0,f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},f}function BA(f,g,v){return Wm(g,f.child,null,v),f=LA(g,g.pendingProps.children),f.flags|=2,g.memoizedState=null,f}function RF(f,g,v){f.lanes|=g;var k=f.alternate;k!==null&&(k.lanes|=g),rA(f.return,g,v)}function $A(f,g,v,k,j){var V=f.memoizedState;V===null?f.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:k,tail:v,tailMode:j}:(V.isBackwards=g,V.rendering=null,V.renderingStartTime=0,V.last=k,V.tail=v,V.tailMode=j)}function IF(f,g,v){var k=g.pendingProps,j=k.revealOrder,V=k.tail;if(Ys(f,g,k.children,v),k=bs.current,(k&2)!==0)k=k&1|2,g.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=g.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&RF(f,v,g);else if(f.tag===19)RF(f,v,g);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===g)break e;for(;f.sibling===null;){if(f.return===null||f.return===g)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}k&=1}switch(se(bs,k),j){case"forwards":for(v=g.child,j=null;v!==null;)f=v.alternate,f!==null&&g_(f)===null&&(j=v),v=v.sibling;v=j,v===null?(j=g.child,g.child=null):(j=v.sibling,v.sibling=null),$A(g,!1,j,v,V);break;case"backwards":for(v=null,j=g.child,g.child=null;j!==null;){if(f=j.alternate,f!==null&&g_(f)===null){g.child=j;break}f=j.sibling,j.sibling=v,v=j,j=f}$A(g,!0,v,null,V);break;case"together":$A(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function ju(f,g,v){if(f!==null&&(g.dependencies=f.dependencies),sf|=g.lanes,(v&g.childLanes)===0)if(f!==null){if(ob(f,g,v,!1),(v&g.childLanes)===0)return null}else return null;if(f!==null&&g.child!==f.child)throw Error(r(153));if(g.child!==null){for(f=g.child,v=Eu(f,f.pendingProps),g.child=v,v.return=g;f.sibling!==null;)f=f.sibling,v=v.sibling=Eu(f,f.pendingProps),v.return=g;v.sibling=null}return g.child}function zA(f,g){return(f.lanes&g)!==0?!0:(f=f.dependencies,!!(f!==null&&e_(f)))}function Gce(f,g,v){switch(g.tag){case 3:Me(g,g.stateNode.containerInfo),Gd(g,ys,f.memoizedState.cache),sb();break;case 27:case 5:Ue(g);break;case 4:Me(g,g.stateNode.containerInfo);break;case 10:Gd(g,g.type,g.memoizedProps.value);break;case 13:var k=g.memoizedState;if(k!==null)return k.dehydrated!==null?(Jd(g),g.flags|=128,null):(v&g.child.childLanes)!==0?AF(f,g,v):(Jd(g),f=ju(f,g,v),f!==null?f.sibling:null);Jd(g);break;case 19:var j=(f.flags&128)!==0;if(k=(v&g.childLanes)!==0,k||(ob(f,g,v,!1),k=(v&g.childLanes)!==0),j){if(k)return IF(f,g,v);g.flags|=128}if(j=g.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),se(bs,bs.current),k)break;return null;case 22:case 23:return g.lanes=0,SF(f,g,v);case 24:Gd(g,ys,f.memoizedState.cache)}return ju(f,g,v)}function MF(f,g,v){if(f!==null)if(f.memoizedProps!==g.pendingProps)Is=!0;else{if(!zA(f,v)&&(g.flags&128)===0)return Is=!1,Gce(f,g,v);Is=(f.flags&131072)!==0}else Is=!1,Yr&&(g.flags&1048576)!==0&&o5(g,Q1,g.index);switch(g.lanes=0,g.tag){case 16:e:{f=g.pendingProps;var k=g.elementType,j=k._init;if(k=j(k._payload),g.type=k,typeof k=="function")ZT(k)?(f=zh(k,f),g.tag=1,g=EF(null,g,k,f,v)):(g.tag=0,g=OA(null,g,k,f,v));else{if(k!=null){if(j=k.$$typeof,j===C){g.tag=11,g=xF(null,g,k,f,v);break e}else if(j===R){g.tag=14,g=wF(null,g,k,f,v);break e}}throw g=F(k)||k,Error(r(306,g,""))}}return g;case 0:return OA(f,g,g.type,g.pendingProps,v);case 1:return k=g.type,j=zh(k,g.pendingProps),EF(f,g,k,j,v);case 3:e:{if(Me(g,g.stateNode.containerInfo),f===null)throw Error(r(387));k=g.pendingProps;var V=g.memoizedState;j=V.element,uA(f,g),pb(g,k,null,v);var ue=g.memoizedState;if(k=ue.cache,Gd(g,ys,k),k!==V.cache&&iA(g,[ys],v,!0),hb(),k=ue.element,V.isDehydrated)if(V={element:k,isDehydrated:!1,cache:ue.cache},g.updateQueue.baseState=V,g.memoizedState=V,g.flags&256){g=TF(f,g,k,v);break e}else if(k!==j){j=Mn(Error(r(424)),g),ab(j),g=TF(f,g,k,v);break e}else{switch(f=g.stateNode.containerInfo,f.nodeType){case 9:f=f.body;break;default:f=f.nodeName==="HTML"?f.ownerDocument.body:f}for(qi=Ol(f.firstChild),Ma=g,Yr=!0,Ph=null,wc=!0,v=cF(g,null,k,v),g.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling}else{if(sb(),k===j){g=ju(f,g,v);break e}Ys(f,g,k,v)}g=g.child}return g;case 26:return v_(f,g),f===null?(v=P8(g.type,null,g.pendingProps,null))?g.memoizedState=v:Yr||(v=g.type,f=g.pendingProps,k=O_(Ne.current).createElement(v),k[ye]=g,k[Oe]=f,Xs(k,v,f),pr(k),g.stateNode=k):g.memoizedState=P8(g.type,f.memoizedProps,g.pendingProps,f.memoizedState),null;case 27:return Ue(g),f===null&&Yr&&(k=g.stateNode=N8(g.type,g.pendingProps,Ne.current),Ma=g,wc=!0,j=qi,cf(g.type)?(wR=j,qi=Ol(k.firstChild)):qi=j),Ys(f,g,g.pendingProps.children,v),v_(f,g),f===null&&(g.flags|=4194304),g.child;case 5:return f===null&&Yr&&((j=k=qi)&&(k=wue(k,g.type,g.pendingProps,wc),k!==null?(g.stateNode=k,Ma=g,qi=Ol(k.firstChild),wc=!1,j=!0):j=!1),j||Dh(g)),Ue(g),j=g.type,V=g.pendingProps,ue=f!==null?f.memoizedProps:null,k=V.children,yR(j,V)?k=null:ue!==null&&yR(j,ue)&&(g.flags|=32),g.memoizedState!==null&&(j=gA(f,g,Bce,null,null,v),Db._currentValue=j),v_(f,g),Ys(f,g,k,v),g.child;case 6:return f===null&&Yr&&((f=v=qi)&&(v=_ue(v,g.pendingProps,wc),v!==null?(g.stateNode=v,Ma=g,qi=null,f=!0):f=!1),f||Dh(g)),null;case 13:return AF(f,g,v);case 4:return Me(g,g.stateNode.containerInfo),k=g.pendingProps,f===null?g.child=Wm(g,null,k,v):Ys(f,g,k,v),g.child;case 11:return xF(f,g,g.type,g.pendingProps,v);case 7:return Ys(f,g,g.pendingProps,v),g.child;case 8:return Ys(f,g,g.pendingProps.children,v),g.child;case 12:return Ys(f,g,g.pendingProps.children,v),g.child;case 10:return k=g.pendingProps,Gd(g,g.type,k.value),Ys(f,g,k.children,v),g.child;case 9:return j=g.type._context,k=g.pendingProps.children,Lh(g),j=ua(j),k=k(j),g.flags|=1,Ys(f,g,k,v),g.child;case 14:return wF(f,g,g.type,g.pendingProps,v);case 15:return _F(f,g,g.type,g.pendingProps,v);case 19:return IF(f,g,v);case 31:return k=g.pendingProps,v=g.mode,k={mode:k.mode,children:k.children},f===null?(v=x_(k,v),v.ref=g.ref,g.child=v,v.return=g,g=v):(v=Eu(f.child,k),v.ref=g.ref,g.child=v,v.return=g,g=v),g;case 22:return SF(f,g,v);case 24:return Lh(g),k=ua(ys),f===null?(j=oA(),j===null&&(j=_i,V=sA(),j.pooledCache=V,V.refCount++,V!==null&&(j.pooledCacheLanes|=v),j=V),g.memoizedState={parent:k,cache:j},cA(g),Gd(g,ys,j)):((f.lanes&v)!==0&&(uA(f,g),pb(g,null,null,v),hb()),j=f.memoizedState,V=g.memoizedState,j.parent!==k?(j={parent:k,cache:k},g.memoizedState=j,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=j),Gd(g,ys,k)):(k=V.cache,Gd(g,ys,k),k!==j.cache&&iA(g,[ys],v,!0))),Ys(f,g,g.pendingProps.children,v),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function Ou(f){f.flags|=4}function NF(f,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)f.flags&=-16777217;else if(f.flags|=16777216,!$8(g)){if(g=Qo.current,g!==null&&((Fr&4194048)===Fr?_c!==null:(Fr&62914560)!==Fr&&(Fr&536870912)===0||g!==_c))throw db=lA,m5;f.flags|=8192}}function w_(f,g){g!==null&&(f.flags|=4),f.flags&16384&&(g=f.tag!==22?z():536870912,f.lanes|=g,Zm|=g)}function wb(f,g){if(!Yr)switch(f.tailMode){case"hidden":g=f.tail;for(var v=null;g!==null;)g.alternate!==null&&(v=g),g=g.sibling;v===null?f.tail=null:v.sibling=null;break;case"collapsed":v=f.tail;for(var k=null;v!==null;)v.alternate!==null&&(k=v),v=v.sibling;k===null?g||f.tail===null?f.tail=null:f.tail.sibling=null:k.sibling=null}}function Fi(f){var g=f.alternate!==null&&f.alternate.child===f.child,v=0,k=0;if(g)for(var j=f.child;j!==null;)v|=j.lanes|j.childLanes,k|=j.subtreeFlags&65011712,k|=j.flags&65011712,j.return=f,j=j.sibling;else for(j=f.child;j!==null;)v|=j.lanes|j.childLanes,k|=j.subtreeFlags,k|=j.flags,j.return=f,j=j.sibling;return f.subtreeFlags|=k,f.childLanes=v,g}function Kce(f,g,v){var k=g.pendingProps;switch(eA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fi(g),null;case 1:return Fi(g),null;case 3:return v=g.stateNode,k=null,f!==null&&(k=f.memoizedState.cache),g.memoizedState.cache!==k&&(g.flags|=2048),Iu(ys),Ee(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(f===null||f.child===null)&&(ib(g)?Ou(g):f===null||f.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,u5())),Fi(g),null;case 26:return v=g.memoizedState,f===null?(Ou(g),v!==null?(Fi(g),NF(g,v)):(Fi(g),g.flags&=-16777217)):v?v!==f.memoizedState?(Ou(g),Fi(g),NF(g,v)):(Fi(g),g.flags&=-16777217):(f.memoizedProps!==k&&Ou(g),Fi(g),g.flags&=-16777217),null;case 27:nt(g),v=Ne.current;var j=g.type;if(f!==null&&g.stateNode!=null)f.memoizedProps!==k&&Ou(g);else{if(!k){if(g.stateNode===null)throw Error(r(166));return Fi(g),null}f=pe.current,ib(g)?l5(g):(f=N8(j,k,v),g.stateNode=f,Ou(g))}return Fi(g),null;case 5:if(nt(g),v=g.type,f!==null&&g.stateNode!=null)f.memoizedProps!==k&&Ou(g);else{if(!k){if(g.stateNode===null)throw Error(r(166));return Fi(g),null}if(f=pe.current,ib(g))l5(g);else{switch(j=O_(Ne.current),f){case 1:f=j.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:f=j.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":f=j.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":f=j.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":f=j.createElement("div"),f.innerHTML="<script><\/script>",f=f.removeChild(f.firstChild);break;case"select":f=typeof k.is=="string"?j.createElement("select",{is:k.is}):j.createElement("select"),k.multiple?f.multiple=!0:k.size&&(f.size=k.size);break;default:f=typeof k.is=="string"?j.createElement(v,{is:k.is}):j.createElement(v)}}f[ye]=g,f[Oe]=k;e:for(j=g.child;j!==null;){if(j.tag===5||j.tag===6)f.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===g)break e;for(;j.sibling===null;){if(j.return===null||j.return===g)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}g.stateNode=f;e:switch(Xs(f,v,k),v){case"button":case"input":case"select":case"textarea":f=!!k.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Ou(g)}}return Fi(g),g.flags&=-16777217,null;case 6:if(f&&g.stateNode!=null)f.memoizedProps!==k&&Ou(g);else{if(typeof k!="string"&&g.stateNode===null)throw Error(r(166));if(f=Ne.current,ib(g)){if(f=g.stateNode,v=g.memoizedProps,k=null,j=Ma,j!==null)switch(j.tag){case 27:case 5:k=j.memoizedProps}f[ye]=g,f=!!(f.nodeValue===v||k!==null&&k.suppressHydrationWarning===!0||k8(f.nodeValue,v)),f||Dh(g)}else f=O_(f).createTextNode(k),f[ye]=g,g.stateNode=f}return Fi(g),null;case 13:if(k=g.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(j=ib(g),k!==null&&k.dehydrated!==null){if(f===null){if(!j)throw Error(r(318));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[ye]=g}else sb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Fi(g),j=!1}else j=u5(),f!==null&&f.memoizedState!==null&&(f.memoizedState.hydrationErrors=j),j=!0;if(!j)return g.flags&256?(Nu(g),g):(Nu(g),null)}if(Nu(g),(g.flags&128)!==0)return g.lanes=v,g;if(v=k!==null,f=f!==null&&f.memoizedState!==null,v){k=g.child,j=null,k.alternate!==null&&k.alternate.memoizedState!==null&&k.alternate.memoizedState.cachePool!==null&&(j=k.alternate.memoizedState.cachePool.pool);var V=null;k.memoizedState!==null&&k.memoizedState.cachePool!==null&&(V=k.memoizedState.cachePool.pool),V!==j&&(k.flags|=2048)}return v!==f&&v&&(g.child.flags|=8192),w_(g,g.updateQueue),Fi(g),null;case 4:return Ee(),f===null&&fR(g.stateNode.containerInfo),Fi(g),null;case 10:return Iu(g.type),Fi(g),null;case 19:if(te(bs),j=g.memoizedState,j===null)return Fi(g),null;if(k=(g.flags&128)!==0,V=j.rendering,V===null)if(k)wb(j,!1);else{if(Vi!==0||f!==null&&(f.flags&128)!==0)for(f=g.child;f!==null;){if(V=g_(f),V!==null){for(g.flags|=128,wb(j,!1),f=V.updateQueue,g.updateQueue=f,w_(g,f),g.subtreeFlags=0,f=v,v=g.child;v!==null;)a5(v,f),v=v.sibling;return se(bs,bs.current&1|2),g.child}f=f.sibling}j.tail!==null&&ce()>C_&&(g.flags|=128,k=!0,wb(j,!1),g.lanes=4194304)}else{if(!k)if(f=g_(V),f!==null){if(g.flags|=128,k=!0,f=f.updateQueue,g.updateQueue=f,w_(g,f),wb(j,!0),j.tail===null&&j.tailMode==="hidden"&&!V.alternate&&!Yr)return Fi(g),null}else 2*ce()-j.renderingStartTime>C_&&v!==536870912&&(g.flags|=128,k=!0,wb(j,!1),g.lanes=4194304);j.isBackwards?(V.sibling=g.child,g.child=V):(f=j.last,f!==null?f.sibling=V:g.child=V,j.last=V)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=ce(),g.sibling=null,f=bs.current,se(bs,k?f&1|2:f&1),g):(Fi(g),null);case 22:case 23:return Nu(g),pA(),k=g.memoizedState!==null,f!==null?f.memoizedState!==null!==k&&(g.flags|=8192):k&&(g.flags|=8192),k?(v&536870912)!==0&&(g.flags&128)===0&&(Fi(g),g.subtreeFlags&6&&(g.flags|=8192)):Fi(g),v=g.updateQueue,v!==null&&w_(g,v.retryQueue),v=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),k=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(k=g.memoizedState.cachePool.pool),k!==v&&(g.flags|=2048),f!==null&&te(Bh),null;case 24:return v=null,f!==null&&(v=f.memoizedState.cache),g.memoizedState.cache!==v&&(g.flags|=2048),Iu(ys),Fi(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function Yce(f,g){switch(eA(g),g.tag){case 1:return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 3:return Iu(ys),Ee(),f=g.flags,(f&65536)!==0&&(f&128)===0?(g.flags=f&-65537|128,g):null;case 26:case 27:case 5:return nt(g),null;case 13:if(Nu(g),f=g.memoizedState,f!==null&&f.dehydrated!==null){if(g.alternate===null)throw Error(r(340));sb()}return f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 19:return te(bs),null;case 4:return Ee(),null;case 10:return Iu(g.type),null;case 22:case 23:return Nu(g),pA(),f!==null&&te(Bh),f=g.flags,f&65536?(g.flags=f&-65537|128,g):null;case 24:return Iu(ys),null;case 25:return null;default:return null}}function jF(f,g){switch(eA(g),g.tag){case 3:Iu(ys),Ee();break;case 26:case 27:case 5:nt(g);break;case 4:Ee();break;case 13:Nu(g);break;case 19:te(bs);break;case 10:Iu(g.type);break;case 22:case 23:Nu(g),pA(),f!==null&&te(Bh);break;case 24:Iu(ys)}}function _b(f,g){try{var v=g.updateQueue,k=v!==null?v.lastEffect:null;if(k!==null){var j=k.next;v=j;do{if((v.tag&f)===f){k=void 0;var V=v.create,ue=v.inst;k=V(),ue.destroy=k}v=v.next}while(v!==j)}}catch(Ae){bi(g,g.return,Ae)}}function ef(f,g,v){try{var k=g.updateQueue,j=k!==null?k.lastEffect:null;if(j!==null){var V=j.next;k=V;do{if((k.tag&f)===f){var ue=k.inst,Ae=ue.destroy;if(Ae!==void 0){ue.destroy=void 0,j=g;var Ge=v,bt=Ae;try{bt()}catch(Mt){bi(j,Ge,Mt)}}}k=k.next}while(k!==V)}}catch(Mt){bi(g,g.return,Mt)}}function OF(f){var g=f.updateQueue;if(g!==null){var v=f.stateNode;try{w5(g,v)}catch(k){bi(f,f.return,k)}}}function PF(f,g,v){v.props=zh(f.type,f.memoizedProps),v.state=f.memoizedState;try{v.componentWillUnmount()}catch(k){bi(f,g,k)}}function Sb(f,g){try{var v=f.ref;if(v!==null){switch(f.tag){case 26:case 27:case 5:var k=f.stateNode;break;case 30:k=f.stateNode;break;default:k=f.stateNode}typeof v=="function"?f.refCleanup=v(k):v.current=k}}catch(j){bi(f,g,j)}}function Sc(f,g){var v=f.ref,k=f.refCleanup;if(v!==null)if(typeof k=="function")try{k()}catch(j){bi(f,g,j)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof v=="function")try{v(null)}catch(j){bi(f,g,j)}else v.current=null}function DF(f){var g=f.type,v=f.memoizedProps,k=f.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":v.autoFocus&&k.focus();break e;case"img":v.src?k.src=v.src:v.srcSet&&(k.srcset=v.srcSet)}}catch(j){bi(f,f.return,j)}}function UA(f,g,v){try{var k=f.stateNode;gue(k,f.type,v,g),k[Oe]=g}catch(j){bi(f,f.return,j)}}function FF(f){return f.tag===5||f.tag===3||f.tag===26||f.tag===27&&cf(f.type)||f.tag===4}function qA(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||FF(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.tag===27&&cf(f.type)||f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function VA(f,g,v){var k=f.tag;if(k===5||k===6)f=f.stateNode,g?(v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v).insertBefore(f,g):(g=v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v,g.appendChild(f),v=v._reactRootContainer,v!=null||g.onclick!==null||(g.onclick=j_));else if(k!==4&&(k===27&&cf(f.type)&&(v=f.stateNode,g=null),f=f.child,f!==null))for(VA(f,g,v),f=f.sibling;f!==null;)VA(f,g,v),f=f.sibling}function __(f,g,v){var k=f.tag;if(k===5||k===6)f=f.stateNode,g?v.insertBefore(f,g):v.appendChild(f);else if(k!==4&&(k===27&&cf(f.type)&&(v=f.stateNode),f=f.child,f!==null))for(__(f,g,v),f=f.sibling;f!==null;)__(f,g,v),f=f.sibling}function LF(f){var g=f.stateNode,v=f.memoizedProps;try{for(var k=f.type,j=g.attributes;j.length;)g.removeAttributeNode(j[0]);Xs(g,k,v),g[ye]=f,g[Oe]=v}catch(V){bi(f,f.return,V)}}var Pu=!1,Xi=!1,HA=!1,BF=typeof WeakSet=="function"?WeakSet:Set,Ms=null;function Zce(f,g){if(f=f.containerInfo,mR=$_,f=he(f),Ce(f)){if("selectionStart"in f)var v={start:f.selectionStart,end:f.selectionEnd};else e:{v=(v=f.ownerDocument)&&v.defaultView||window;var k=v.getSelection&&v.getSelection();if(k&&k.rangeCount!==0){v=k.anchorNode;var j=k.anchorOffset,V=k.focusNode;k=k.focusOffset;try{v.nodeType,V.nodeType}catch{v=null;break e}var ue=0,Ae=-1,Ge=-1,bt=0,Mt=0,Pt=f,wt=null;t:for(;;){for(var St;Pt!==v||j!==0&&Pt.nodeType!==3||(Ae=ue+j),Pt!==V||k!==0&&Pt.nodeType!==3||(Ge=ue+k),Pt.nodeType===3&&(ue+=Pt.nodeValue.length),(St=Pt.firstChild)!==null;)wt=Pt,Pt=St;for(;;){if(Pt===f)break t;if(wt===v&&++bt===j&&(Ae=ue),wt===V&&++Mt===k&&(Ge=ue),(St=Pt.nextSibling)!==null)break;Pt=wt,wt=Pt.parentNode}Pt=St}v=Ae===-1||Ge===-1?null:{start:Ae,end:Ge}}else v=null}v=v||{start:0,end:0}}else v=null;for(gR={focusedElem:f,selectionRange:v},$_=!1,Ms=g;Ms!==null;)if(g=Ms,f=g.child,(g.subtreeFlags&1024)!==0&&f!==null)f.return=g,Ms=f;else for(;Ms!==null;){switch(g=Ms,V=g.alternate,f=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((f&1024)!==0&&V!==null){f=void 0,v=g,j=V.memoizedProps,V=V.memoizedState,k=v.stateNode;try{var Yn=zh(v.type,j,v.elementType===v.type);f=k.getSnapshotBeforeUpdate(Yn,V),k.__reactInternalSnapshotBeforeUpdate=f}catch(Ln){bi(v,v.return,Ln)}}break;case 3:if((f&1024)!==0){if(f=g.stateNode.containerInfo,v=f.nodeType,v===9)vR(f);else if(v===1)switch(f.nodeName){case"HEAD":case"HTML":case"BODY":vR(f);break;default:f.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(r(163))}if(f=g.sibling,f!==null){f.return=g.return,Ms=f;break}Ms=g.return}}function $F(f,g,v){var k=v.flags;switch(v.tag){case 0:case 11:case 15:tf(f,v),k&4&&_b(5,v);break;case 1:if(tf(f,v),k&4)if(f=v.stateNode,g===null)try{f.componentDidMount()}catch(ue){bi(v,v.return,ue)}else{var j=zh(v.type,g.memoizedProps);g=g.memoizedState;try{f.componentDidUpdate(j,g,f.__reactInternalSnapshotBeforeUpdate)}catch(ue){bi(v,v.return,ue)}}k&64&&OF(v),k&512&&Sb(v,v.return);break;case 3:if(tf(f,v),k&64&&(f=v.updateQueue,f!==null)){if(g=null,v.child!==null)switch(v.child.tag){case 27:case 5:g=v.child.stateNode;break;case 1:g=v.child.stateNode}try{w5(f,g)}catch(ue){bi(v,v.return,ue)}}break;case 27:g===null&&k&4&&LF(v);case 26:case 5:tf(f,v),g===null&&k&4&&DF(v),k&512&&Sb(v,v.return);break;case 12:tf(f,v);break;case 13:tf(f,v),k&4&&qF(f,v),k&64&&(f=v.memoizedState,f!==null&&(f=f.dehydrated,f!==null&&(v=sue.bind(null,v),Sue(f,v))));break;case 22:if(k=v.memoizedState!==null||Pu,!k){g=g!==null&&g.memoizedState!==null||Xi,j=Pu;var V=Xi;Pu=k,(Xi=g)&&!V?nf(f,v,(v.subtreeFlags&8772)!==0):tf(f,v),Pu=j,Xi=V}break;case 30:break;default:tf(f,v)}}function zF(f){var g=f.alternate;g!==null&&(f.alternate=null,zF(g)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(g=f.stateNode,g!==null&&on(g)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}var Ni=null,Xa=!1;function Du(f,g,v){for(v=v.child;v!==null;)UF(f,g,v),v=v.sibling}function UF(f,g,v){if(Bt&&typeof Bt.onCommitFiberUnmount=="function")try{Bt.onCommitFiberUnmount(jt,v)}catch{}switch(v.tag){case 26:Xi||Sc(v,g),Du(f,g,v),v.memoizedState?v.memoizedState.count--:v.stateNode&&(v=v.stateNode,v.parentNode.removeChild(v));break;case 27:Xi||Sc(v,g);var k=Ni,j=Xa;cf(v.type)&&(Ni=v.stateNode,Xa=!1),Du(f,g,v),Nb(v.stateNode),Ni=k,Xa=j;break;case 5:Xi||Sc(v,g);case 6:if(k=Ni,j=Xa,Ni=null,Du(f,g,v),Ni=k,Xa=j,Ni!==null)if(Xa)try{(Ni.nodeType===9?Ni.body:Ni.nodeName==="HTML"?Ni.ownerDocument.body:Ni).removeChild(v.stateNode)}catch(V){bi(v,g,V)}else try{Ni.removeChild(v.stateNode)}catch(V){bi(v,g,V)}break;case 18:Ni!==null&&(Xa?(f=Ni,I8(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,v.stateNode),$b(f)):I8(Ni,v.stateNode));break;case 4:k=Ni,j=Xa,Ni=v.stateNode.containerInfo,Xa=!0,Du(f,g,v),Ni=k,Xa=j;break;case 0:case 11:case 14:case 15:Xi||ef(2,v,g),Xi||ef(4,v,g),Du(f,g,v);break;case 1:Xi||(Sc(v,g),k=v.stateNode,typeof k.componentWillUnmount=="function"&&PF(v,g,k)),Du(f,g,v);break;case 21:Du(f,g,v);break;case 22:Xi=(k=Xi)||v.memoizedState!==null,Du(f,g,v),Xi=k;break;default:Du(f,g,v)}}function qF(f,g){if(g.memoizedState===null&&(f=g.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{$b(f)}catch(v){bi(g,g.return,v)}}function Xce(f){switch(f.tag){case 13:case 19:var g=f.stateNode;return g===null&&(g=f.stateNode=new BF),g;case 22:return f=f.stateNode,g=f._retryCache,g===null&&(g=f._retryCache=new BF),g;default:throw Error(r(435,f.tag))}}function WA(f,g){var v=Xce(f);g.forEach(function(k){var j=aue.bind(null,f,k);v.has(k)||(v.add(k),k.then(j,j))})}function ko(f,g){var v=g.deletions;if(v!==null)for(var k=0;k<v.length;k++){var j=v[k],V=f,ue=g,Ae=ue;e:for(;Ae!==null;){switch(Ae.tag){case 27:if(cf(Ae.type)){Ni=Ae.stateNode,Xa=!1;break e}break;case 5:Ni=Ae.stateNode,Xa=!1;break e;case 3:case 4:Ni=Ae.stateNode.containerInfo,Xa=!0;break e}Ae=Ae.return}if(Ni===null)throw Error(r(160));UF(V,ue,j),Ni=null,Xa=!1,V=j.alternate,V!==null&&(V.return=null),j.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)VF(g,f),g=g.sibling}var jl=null;function VF(f,g){var v=f.alternate,k=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:ko(g,f),Eo(f),k&4&&(ef(3,f,f.return),_b(3,f),ef(5,f,f.return));break;case 1:ko(g,f),Eo(f),k&512&&(Xi||v===null||Sc(v,v.return)),k&64&&Pu&&(f=f.updateQueue,f!==null&&(k=f.callbacks,k!==null&&(v=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=v===null?k:v.concat(k))));break;case 26:var j=jl;if(ko(g,f),Eo(f),k&512&&(Xi||v===null||Sc(v,v.return)),k&4){var V=v!==null?v.memoizedState:null;if(k=f.memoizedState,v===null)if(k===null)if(f.stateNode===null){e:{k=f.type,v=f.memoizedProps,j=j.ownerDocument||j;t:switch(k){case"title":V=j.getElementsByTagName("title")[0],(!V||V[Qt]||V[ye]||V.namespaceURI==="http://www.w3.org/2000/svg"||V.hasAttribute("itemprop"))&&(V=j.createElement(k),j.head.insertBefore(V,j.querySelector("head > title"))),Xs(V,k,v),V[ye]=f,pr(V),k=V;break e;case"link":var ue=L8("link","href",j).get(k+(v.href||""));if(ue){for(var Ae=0;Ae<ue.length;Ae++)if(V=ue[Ae],V.getAttribute("href")===(v.href==null||v.href===""?null:v.href)&&V.getAttribute("rel")===(v.rel==null?null:v.rel)&&V.getAttribute("title")===(v.title==null?null:v.title)&&V.getAttribute("crossorigin")===(v.crossOrigin==null?null:v.crossOrigin)){ue.splice(Ae,1);break t}}V=j.createElement(k),Xs(V,k,v),j.head.appendChild(V);break;case"meta":if(ue=L8("meta","content",j).get(k+(v.content||""))){for(Ae=0;Ae<ue.length;Ae++)if(V=ue[Ae],V.getAttribute("content")===(v.content==null?null:""+v.content)&&V.getAttribute("name")===(v.name==null?null:v.name)&&V.getAttribute("property")===(v.property==null?null:v.property)&&V.getAttribute("http-equiv")===(v.httpEquiv==null?null:v.httpEquiv)&&V.getAttribute("charset")===(v.charSet==null?null:v.charSet)){ue.splice(Ae,1);break t}}V=j.createElement(k),Xs(V,k,v),j.head.appendChild(V);break;default:throw Error(r(468,k))}V[ye]=f,pr(V),k=V}f.stateNode=k}else B8(j,f.type,f.stateNode);else f.stateNode=F8(j,k,f.memoizedProps);else V!==k?(V===null?v.stateNode!==null&&(v=v.stateNode,v.parentNode.removeChild(v)):V.count--,k===null?B8(j,f.type,f.stateNode):F8(j,k,f.memoizedProps)):k===null&&f.stateNode!==null&&UA(f,f.memoizedProps,v.memoizedProps)}break;case 27:ko(g,f),Eo(f),k&512&&(Xi||v===null||Sc(v,v.return)),v!==null&&k&4&&UA(f,f.memoizedProps,v.memoizedProps);break;case 5:if(ko(g,f),Eo(f),k&512&&(Xi||v===null||Sc(v,v.return)),f.flags&32){j=f.stateNode;try{Fd(j,"")}catch(St){bi(f,f.return,St)}}k&4&&f.stateNode!=null&&(j=f.memoizedProps,UA(f,j,v!==null?v.memoizedProps:j)),k&1024&&(HA=!0);break;case 6:if(ko(g,f),Eo(f),k&4){if(f.stateNode===null)throw Error(r(162));k=f.memoizedProps,v=f.stateNode;try{v.nodeValue=k}catch(St){bi(f,f.return,St)}}break;case 3:if(F_=null,j=jl,jl=P_(g.containerInfo),ko(g,f),jl=j,Eo(f),k&4&&v!==null&&v.memoizedState.isDehydrated)try{$b(g.containerInfo)}catch(St){bi(f,f.return,St)}HA&&(HA=!1,HF(f));break;case 4:k=jl,jl=P_(f.stateNode.containerInfo),ko(g,f),Eo(f),jl=k;break;case 12:ko(g,f),Eo(f);break;case 13:ko(g,f),Eo(f),f.child.flags&8192&&f.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(JA=ce()),k&4&&(k=f.updateQueue,k!==null&&(f.updateQueue=null,WA(f,k)));break;case 22:j=f.memoizedState!==null;var Ge=v!==null&&v.memoizedState!==null,bt=Pu,Mt=Xi;if(Pu=bt||j,Xi=Mt||Ge,ko(g,f),Xi=Mt,Pu=bt,Eo(f),k&8192)e:for(g=f.stateNode,g._visibility=j?g._visibility&-2:g._visibility|1,j&&(v===null||Ge||Pu||Xi||Uh(f)),v=null,g=f;;){if(g.tag===5||g.tag===26){if(v===null){Ge=v=g;try{if(V=Ge.stateNode,j)ue=V.style,typeof ue.setProperty=="function"?ue.setProperty("display","none","important"):ue.display="none";else{Ae=Ge.stateNode;var Pt=Ge.memoizedProps.style,wt=Pt!=null&&Pt.hasOwnProperty("display")?Pt.display:null;Ae.style.display=wt==null||typeof wt=="boolean"?"":(""+wt).trim()}}catch(St){bi(Ge,Ge.return,St)}}}else if(g.tag===6){if(v===null){Ge=g;try{Ge.stateNode.nodeValue=j?"":Ge.memoizedProps}catch(St){bi(Ge,Ge.return,St)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===f)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===f)break e;for(;g.sibling===null;){if(g.return===null||g.return===f)break e;v===g&&(v=null),g=g.return}v===g&&(v=null),g.sibling.return=g.return,g=g.sibling}k&4&&(k=f.updateQueue,k!==null&&(v=k.retryQueue,v!==null&&(k.retryQueue=null,WA(f,v))));break;case 19:ko(g,f),Eo(f),k&4&&(k=f.updateQueue,k!==null&&(f.updateQueue=null,WA(f,k)));break;case 30:break;case 21:break;default:ko(g,f),Eo(f)}}function Eo(f){var g=f.flags;if(g&2){try{for(var v,k=f.return;k!==null;){if(FF(k)){v=k;break}k=k.return}if(v==null)throw Error(r(160));switch(v.tag){case 27:var j=v.stateNode,V=qA(f);__(f,V,j);break;case 5:var ue=v.stateNode;v.flags&32&&(Fd(ue,""),v.flags&=-33);var Ae=qA(f);__(f,Ae,ue);break;case 3:case 4:var Ge=v.stateNode.containerInfo,bt=qA(f);VA(f,bt,Ge);break;default:throw Error(r(161))}}catch(Mt){bi(f,f.return,Mt)}f.flags&=-3}g&4096&&(f.flags&=-4097)}function HF(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var g=f;HF(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),f=f.sibling}}function tf(f,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)$F(f,g.alternate,g),g=g.sibling}function Uh(f){for(f=f.child;f!==null;){var g=f;switch(g.tag){case 0:case 11:case 14:case 15:ef(4,g,g.return),Uh(g);break;case 1:Sc(g,g.return);var v=g.stateNode;typeof v.componentWillUnmount=="function"&&PF(g,g.return,v),Uh(g);break;case 27:Nb(g.stateNode);case 26:case 5:Sc(g,g.return),Uh(g);break;case 22:g.memoizedState===null&&Uh(g);break;case 30:Uh(g);break;default:Uh(g)}f=f.sibling}}function nf(f,g,v){for(v=v&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var k=g.alternate,j=f,V=g,ue=V.flags;switch(V.tag){case 0:case 11:case 15:nf(j,V,v),_b(4,V);break;case 1:if(nf(j,V,v),k=V,j=k.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(bt){bi(k,k.return,bt)}if(k=V,j=k.updateQueue,j!==null){var Ae=k.stateNode;try{var Ge=j.shared.hiddenCallbacks;if(Ge!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Ge.length;j++)x5(Ge[j],Ae)}catch(bt){bi(k,k.return,bt)}}v&&ue&64&&OF(V),Sb(V,V.return);break;case 27:LF(V);case 26:case 5:nf(j,V,v),v&&k===null&&ue&4&&DF(V),Sb(V,V.return);break;case 12:nf(j,V,v);break;case 13:nf(j,V,v),v&&ue&4&&qF(j,V);break;case 22:V.memoizedState===null&&nf(j,V,v),Sb(V,V.return);break;case 30:break;default:nf(j,V,v)}g=g.sibling}}function GA(f,g){var v=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),f=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(f=g.memoizedState.cachePool.pool),f!==v&&(f!=null&&f.refCount++,v!=null&&lb(v))}function KA(f,g){f=null,g.alternate!==null&&(f=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==f&&(g.refCount++,f!=null&&lb(f))}function Cc(f,g,v,k){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)WF(f,g,v,k),g=g.sibling}function WF(f,g,v,k){var j=g.flags;switch(g.tag){case 0:case 11:case 15:Cc(f,g,v,k),j&2048&&_b(9,g);break;case 1:Cc(f,g,v,k);break;case 3:Cc(f,g,v,k),j&2048&&(f=null,g.alternate!==null&&(f=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==f&&(g.refCount++,f!=null&&lb(f)));break;case 12:if(j&2048){Cc(f,g,v,k),f=g.stateNode;try{var V=g.memoizedProps,ue=V.id,Ae=V.onPostCommit;typeof Ae=="function"&&Ae(ue,g.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(Ge){bi(g,g.return,Ge)}}else Cc(f,g,v,k);break;case 13:Cc(f,g,v,k);break;case 23:break;case 22:V=g.stateNode,ue=g.alternate,g.memoizedState!==null?V._visibility&2?Cc(f,g,v,k):Cb(f,g):V._visibility&2?Cc(f,g,v,k):(V._visibility|=2,Gm(f,g,v,k,(g.subtreeFlags&10256)!==0)),j&2048&&GA(ue,g);break;case 24:Cc(f,g,v,k),j&2048&&KA(g.alternate,g);break;default:Cc(f,g,v,k)}}function Gm(f,g,v,k,j){for(j=j&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var V=f,ue=g,Ae=v,Ge=k,bt=ue.flags;switch(ue.tag){case 0:case 11:case 15:Gm(V,ue,Ae,Ge,j),_b(8,ue);break;case 23:break;case 22:var Mt=ue.stateNode;ue.memoizedState!==null?Mt._visibility&2?Gm(V,ue,Ae,Ge,j):Cb(V,ue):(Mt._visibility|=2,Gm(V,ue,Ae,Ge,j)),j&&bt&2048&&GA(ue.alternate,ue);break;case 24:Gm(V,ue,Ae,Ge,j),j&&bt&2048&&KA(ue.alternate,ue);break;default:Gm(V,ue,Ae,Ge,j)}g=g.sibling}}function Cb(f,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var v=f,k=g,j=k.flags;switch(k.tag){case 22:Cb(v,k),j&2048&&GA(k.alternate,k);break;case 24:Cb(v,k),j&2048&&KA(k.alternate,k);break;default:Cb(v,k)}g=g.sibling}}var kb=8192;function Km(f){if(f.subtreeFlags&kb)for(f=f.child;f!==null;)GF(f),f=f.sibling}function GF(f){switch(f.tag){case 26:Km(f),f.flags&kb&&f.memoizedState!==null&&Due(jl,f.memoizedState,f.memoizedProps);break;case 5:Km(f);break;case 3:case 4:var g=jl;jl=P_(f.stateNode.containerInfo),Km(f),jl=g;break;case 22:f.memoizedState===null&&(g=f.alternate,g!==null&&g.memoizedState!==null?(g=kb,kb=16777216,Km(f),kb=g):Km(f));break;default:Km(f)}}function KF(f){var g=f.alternate;if(g!==null&&(f=g.child,f!==null)){g.child=null;do g=f.sibling,f.sibling=null,f=g;while(f!==null)}}function Eb(f){var g=f.deletions;if((f.flags&16)!==0){if(g!==null)for(var v=0;v<g.length;v++){var k=g[v];Ms=k,ZF(k,f)}KF(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)YF(f),f=f.sibling}function YF(f){switch(f.tag){case 0:case 11:case 15:Eb(f),f.flags&2048&&ef(9,f,f.return);break;case 3:Eb(f);break;case 12:Eb(f);break;case 22:var g=f.stateNode;f.memoizedState!==null&&g._visibility&2&&(f.return===null||f.return.tag!==13)?(g._visibility&=-3,S_(f)):Eb(f);break;default:Eb(f)}}function S_(f){var g=f.deletions;if((f.flags&16)!==0){if(g!==null)for(var v=0;v<g.length;v++){var k=g[v];Ms=k,ZF(k,f)}KF(f)}for(f=f.child;f!==null;){switch(g=f,g.tag){case 0:case 11:case 15:ef(8,g,g.return),S_(g);break;case 22:v=g.stateNode,v._visibility&2&&(v._visibility&=-3,S_(g));break;default:S_(g)}f=f.sibling}}function ZF(f,g){for(;Ms!==null;){var v=Ms;switch(v.tag){case 0:case 11:case 15:ef(8,v,g);break;case 23:case 22:if(v.memoizedState!==null&&v.memoizedState.cachePool!==null){var k=v.memoizedState.cachePool.pool;k!=null&&k.refCount++}break;case 24:lb(v.memoizedState.cache)}if(k=v.child,k!==null)k.return=v,Ms=k;else e:for(v=f;Ms!==null;){k=Ms;var j=k.sibling,V=k.return;if(zF(k),k===v){Ms=null;break e}if(j!==null){j.return=V,Ms=j;break e}Ms=V}}}var Jce={getCacheForType:function(f){var g=ua(ys),v=g.data.get(f);return v===void 0&&(v=f(),g.data.set(f,v)),v}},Qce=typeof WeakMap=="function"?WeakMap:Map,si=0,_i=null,Rr=null,Fr=0,ai=0,To=null,rf=!1,Ym=!1,YA=!1,Fu=0,Vi=0,sf=0,qh=0,ZA=0,el=0,Zm=0,Tb=null,Ja=null,XA=!1,JA=0,C_=1/0,k_=null,af=null,Zs=0,of=null,Xm=null,Jm=0,QA=0,eR=null,XF=null,Ab=0,tR=null;function Ao(){if((si&2)!==0&&Fr!==0)return Fr&-Fr;if(q.T!==null){var f=Bm;return f!==0?f:lR()}return Z()}function JF(){el===0&&(el=(Fr&536870912)===0||Yr?_t():536870912);var f=Qo.current;return f!==null&&(f.flags|=32),el}function Ro(f,g,v){(f===_i&&(ai===2||ai===9)||f.cancelPendingCommit!==null)&&(Qm(f,0),lf(f,Fr,el,!1)),rt(f,v),((si&2)===0||f!==_i)&&(f===_i&&((si&2)===0&&(qh|=v),Vi===4&&lf(f,Fr,el,!1)),kc(f))}function QF(f,g,v){if((si&6)!==0)throw Error(r(327));var k=!v&&(g&124)===0&&(g&f.expiredLanes)===0||fe(f,g),j=k?nue(f,g):iR(f,g,!0),V=k;do{if(j===0){Ym&&!k&&lf(f,g,0,!1);break}else{if(v=f.current.alternate,V&&!eue(v)){j=iR(f,g,!1),V=!1;continue}if(j===2){if(V=g,f.errorRecoveryDisabledLanes&V)var ue=0;else ue=f.pendingLanes&-536870913,ue=ue!==0?ue:ue&536870912?536870912:0;if(ue!==0){g=ue;e:{var Ae=f;j=Tb;var Ge=Ae.current.memoizedState.isDehydrated;if(Ge&&(Qm(Ae,ue).flags|=256),ue=iR(Ae,ue,!1),ue!==2){if(YA&&!Ge){Ae.errorRecoveryDisabledLanes|=V,qh|=V,j=4;break e}V=Ja,Ja=j,V!==null&&(Ja===null?Ja=V:Ja.push.apply(Ja,V))}j=ue}if(V=!1,j!==2)continue}}if(j===1){Qm(f,0),lf(f,g,0,!0);break}e:{switch(k=f,V=j,V){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:lf(k,g,el,!rf);break e;case 2:Ja=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(j=JA+300-ce(),10<j)){if(lf(k,g,el,!rf),Ie(k,0,!0)!==0)break e;k.timeoutHandle=A8(e8.bind(null,k,v,Ja,k_,XA,g,el,qh,Zm,rf,V,2,-0,0),j);break e}e8(k,v,Ja,k_,XA,g,el,qh,Zm,rf,V,0,-0,0)}}break}while(!0);kc(f)}function e8(f,g,v,k,j,V,ue,Ae,Ge,bt,Mt,Pt,wt,St){if(f.timeoutHandle=-1,Pt=g.subtreeFlags,(Pt&8192||(Pt&16785408)===16785408)&&(Pb={stylesheets:null,count:0,unsuspend:Pue},GF(g),Pt=Fue(),Pt!==null)){f.cancelPendingCommit=Pt(o8.bind(null,f,g,V,v,k,j,ue,Ae,Ge,Mt,1,wt,St)),lf(f,V,ue,!bt);return}o8(f,g,V,v,k,j,ue,Ae,Ge)}function eue(f){for(var g=f;;){var v=g.tag;if((v===0||v===11||v===15)&&g.flags&16384&&(v=g.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var k=0;k<v.length;k++){var j=v[k],V=j.getSnapshot;j=j.value;try{if(!ca(V(),j))return!1}catch{return!1}}if(v=g.child,g.subtreeFlags&16384&&v!==null)v.return=g,g=v;else{if(g===f)break;for(;g.sibling===null;){if(g.return===null||g.return===f)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function lf(f,g,v,k){g&=~ZA,g&=~qh,f.suspendedLanes|=g,f.pingedLanes&=~g,k&&(f.warmLanes|=g),k=f.expirationTimes;for(var j=g;0<j;){var V=31-tn(j),ue=1<<V;k[V]=-1,j&=~ue}v!==0&&Se(f,v,g)}function E_(){return(si&6)===0?(Rb(0),!1):!0}function nR(){if(Rr!==null){if(ai===0)var f=Rr.return;else f=Rr,Ru=Fh=null,vA(f),Hm=null,vb=0,f=Rr;for(;f!==null;)jF(f.alternate,f),f=f.return;Rr=null}}function Qm(f,g){var v=f.timeoutHandle;v!==-1&&(f.timeoutHandle=-1,bue(v)),v=f.cancelPendingCommit,v!==null&&(f.cancelPendingCommit=null,v()),nR(),_i=f,Rr=v=Eu(f.current,null),Fr=g,ai=0,To=null,rf=!1,Ym=fe(f,g),YA=!1,Zm=el=ZA=qh=sf=Vi=0,Ja=Tb=null,XA=!1,(g&8)!==0&&(g|=g&32);var k=f.entangledLanes;if(k!==0)for(f=f.entanglements,k&=g;0<k;){var j=31-tn(k),V=1<<j;g|=f[j],k&=~V}return Fu=g,Kn(),v}function t8(f,g){Sr=null,q.H=h_,g===ub||g===r_?(g=b5(),ai=3):g===m5?(g=b5(),ai=4):ai=g===vF?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,To=g,Rr===null&&(Vi=1,b_(f,Mn(g,f.current)))}function n8(){var f=q.H;return q.H=h_,f===null?h_:f}function r8(){var f=q.A;return q.A=Jce,f}function rR(){Vi=4,rf||(Fr&4194048)!==Fr&&Qo.current!==null||(Ym=!0),(sf&134217727)===0&&(qh&134217727)===0||_i===null||lf(_i,Fr,el,!1)}function iR(f,g,v){var k=si;si|=2;var j=n8(),V=r8();(_i!==f||Fr!==g)&&(k_=null,Qm(f,g)),g=!1;var ue=Vi;e:do try{if(ai!==0&&Rr!==null){var Ae=Rr,Ge=To;switch(ai){case 8:nR(),ue=6;break e;case 3:case 2:case 9:case 6:Qo.current===null&&(g=!0);var bt=ai;if(ai=0,To=null,eg(f,Ae,Ge,bt),v&&Ym){ue=0;break e}break;default:bt=ai,ai=0,To=null,eg(f,Ae,Ge,bt)}}tue(),ue=Vi;break}catch(Mt){t8(f,Mt)}while(!0);return g&&f.shellSuspendCounter++,Ru=Fh=null,si=k,q.H=j,q.A=V,Rr===null&&(_i=null,Fr=0,Kn()),ue}function tue(){for(;Rr!==null;)i8(Rr)}function nue(f,g){var v=si;si|=2;var k=n8(),j=r8();_i!==f||Fr!==g?(k_=null,C_=ce()+500,Qm(f,g)):Ym=fe(f,g);e:do try{if(ai!==0&&Rr!==null){g=Rr;var V=To;t:switch(ai){case 1:ai=0,To=null,eg(f,g,V,1);break;case 2:case 9:if(g5(V)){ai=0,To=null,s8(g);break}g=function(){ai!==2&&ai!==9||_i!==f||(ai=7),kc(f)},V.then(g,g);break e;case 3:ai=7;break e;case 4:ai=5;break e;case 7:g5(V)?(ai=0,To=null,s8(g)):(ai=0,To=null,eg(f,g,V,7));break;case 5:var ue=null;switch(Rr.tag){case 26:ue=Rr.memoizedState;case 5:case 27:var Ae=Rr;if(!ue||$8(ue)){ai=0,To=null;var Ge=Ae.sibling;if(Ge!==null)Rr=Ge;else{var bt=Ae.return;bt!==null?(Rr=bt,T_(bt)):Rr=null}break t}}ai=0,To=null,eg(f,g,V,5);break;case 6:ai=0,To=null,eg(f,g,V,6);break;case 8:nR(),Vi=6;break e;default:throw Error(r(462))}}rue();break}catch(Mt){t8(f,Mt)}while(!0);return Ru=Fh=null,q.H=k,q.A=j,si=v,Rr!==null?0:(_i=null,Fr=0,Kn(),Vi)}function rue(){for(;Rr!==null&&!be();)i8(Rr)}function i8(f){var g=MF(f.alternate,f,Fu);f.memoizedProps=f.pendingProps,g===null?T_(f):Rr=g}function s8(f){var g=f,v=g.alternate;switch(g.tag){case 15:case 0:g=kF(v,g,g.pendingProps,g.type,void 0,Fr);break;case 11:g=kF(v,g,g.pendingProps,g.type.render,g.ref,Fr);break;case 5:vA(g);default:jF(v,g),g=Rr=a5(g,Fu),g=MF(v,g,Fu)}f.memoizedProps=f.pendingProps,g===null?T_(f):Rr=g}function eg(f,g,v,k){Ru=Fh=null,vA(g),Hm=null,vb=0;var j=g.return;try{if(Wce(f,j,g,v,Fr)){Vi=1,b_(f,Mn(v,f.current)),Rr=null;return}}catch(V){if(j!==null)throw Rr=j,V;Vi=1,b_(f,Mn(v,f.current)),Rr=null;return}g.flags&32768?(Yr||k===1?f=!0:Ym||(Fr&536870912)!==0?f=!1:(rf=f=!0,(k===2||k===9||k===3||k===6)&&(k=Qo.current,k!==null&&k.tag===13&&(k.flags|=16384))),a8(g,f)):T_(g)}function T_(f){var g=f;do{if((g.flags&32768)!==0){a8(g,rf);return}f=g.return;var v=Kce(g.alternate,g,Fu);if(v!==null){Rr=v;return}if(g=g.sibling,g!==null){Rr=g;return}Rr=g=f}while(g!==null);Vi===0&&(Vi=5)}function a8(f,g){do{var v=Yce(f.alternate,f);if(v!==null){v.flags&=32767,Rr=v;return}if(v=f.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!g&&(f=f.sibling,f!==null)){Rr=f;return}Rr=f=v}while(f!==null);Vi=6,Rr=null}function o8(f,g,v,k,j,V,ue,Ae,Ge){f.cancelPendingCommit=null;do A_();while(Zs!==0);if((si&6)!==0)throw Error(r(327));if(g!==null){if(g===f.current)throw Error(r(177));if(V=g.lanes|g.childLanes,V|=Ks,ve(f,v,V,ue,Ae,Ge),f===_i&&(Rr=_i=null,Fr=0),Xm=g,of=f,Jm=v,QA=V,eR=j,XF=k,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(f.callbackNode=null,f.callbackPriority=0,oue($e,function(){return f8(),null})):(f.callbackNode=null,f.callbackPriority=0),k=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||k){k=q.T,q.T=null,j=K.p,K.p=2,ue=si,si|=4;try{Zce(f,g,v)}finally{si=ue,K.p=j,q.T=k}}Zs=1,l8(),c8(),u8()}}function l8(){if(Zs===1){Zs=0;var f=of,g=Xm,v=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||v){v=q.T,q.T=null;var k=K.p;K.p=2;var j=si;si|=4;try{VF(g,f);var V=gR,ue=he(f.containerInfo),Ae=V.focusedElem,Ge=V.selectionRange;if(ue!==Ae&&Ae&&Ae.ownerDocument&&oe(Ae.ownerDocument.documentElement,Ae)){if(Ge!==null&&Ce(Ae)){var bt=Ge.start,Mt=Ge.end;if(Mt===void 0&&(Mt=bt),"selectionStart"in Ae)Ae.selectionStart=bt,Ae.selectionEnd=Math.min(Mt,Ae.value.length);else{var Pt=Ae.ownerDocument||document,wt=Pt&&Pt.defaultView||window;if(wt.getSelection){var St=wt.getSelection(),Yn=Ae.textContent.length,Ln=Math.min(Ge.start,Yn),fi=Ge.end===void 0?Ln:Math.min(Ge.end,Yn);!St.extend&&Ln>fi&&(ue=fi,fi=Ln,Ln=ue);var lt=ee(Ae,Ln),Qe=ee(Ae,fi);if(lt&&Qe&&(St.rangeCount!==1||St.anchorNode!==lt.node||St.anchorOffset!==lt.offset||St.focusNode!==Qe.node||St.focusOffset!==Qe.offset)){var gt=Pt.createRange();gt.setStart(lt.node,lt.offset),St.removeAllRanges(),Ln>fi?(St.addRange(gt),St.extend(Qe.node,Qe.offset)):(gt.setEnd(Qe.node,Qe.offset),St.addRange(gt))}}}}for(Pt=[],St=Ae;St=St.parentNode;)St.nodeType===1&&Pt.push({element:St,left:St.scrollLeft,top:St.scrollTop});for(typeof Ae.focus=="function"&&Ae.focus(),Ae=0;Ae<Pt.length;Ae++){var Ot=Pt[Ae];Ot.element.scrollLeft=Ot.left,Ot.element.scrollTop=Ot.top}}$_=!!mR,gR=mR=null}finally{si=j,K.p=k,q.T=v}}f.current=g,Zs=2}}function c8(){if(Zs===2){Zs=0;var f=of,g=Xm,v=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||v){v=q.T,q.T=null;var k=K.p;K.p=2;var j=si;si|=4;try{$F(f,g.alternate,g)}finally{si=j,K.p=k,q.T=v}}Zs=3}}function u8(){if(Zs===4||Zs===3){Zs=0,Re();var f=of,g=Xm,v=Jm,k=XF;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?Zs=5:(Zs=0,Xm=of=null,d8(f,f.pendingLanes));var j=f.pendingLanes;if(j===0&&(af=null),ge(v),g=g.stateNode,Bt&&typeof Bt.onCommitFiberRoot=="function")try{Bt.onCommitFiberRoot(jt,g,void 0,(g.current.flags&128)===128)}catch{}if(k!==null){g=q.T,j=K.p,K.p=2,q.T=null;try{for(var V=f.onRecoverableError,ue=0;ue<k.length;ue++){var Ae=k[ue];V(Ae.value,{componentStack:Ae.stack})}}finally{q.T=g,K.p=j}}(Jm&3)!==0&&A_(),kc(f),j=f.pendingLanes,(v&4194090)!==0&&(j&42)!==0?f===tR?Ab++:(Ab=0,tR=f):Ab=0,Rb(0)}}function d8(f,g){(f.pooledCacheLanes&=g)===0&&(g=f.pooledCache,g!=null&&(f.pooledCache=null,lb(g)))}function A_(f){return l8(),c8(),u8(),f8()}function f8(){if(Zs!==5)return!1;var f=of,g=QA;QA=0;var v=ge(Jm),k=q.T,j=K.p;try{K.p=32>v?32:v,q.T=null,v=eR,eR=null;var V=of,ue=Jm;if(Zs=0,Xm=of=null,Jm=0,(si&6)!==0)throw Error(r(331));var Ae=si;if(si|=4,YF(V.current),WF(V,V.current,ue,v),si=Ae,Rb(0,!1),Bt&&typeof Bt.onPostCommitFiberRoot=="function")try{Bt.onPostCommitFiberRoot(jt,V)}catch{}return!0}finally{K.p=j,q.T=k,d8(f,g)}}function h8(f,g,v){g=Mn(v,g),g=jA(f.stateNode,g,2),f=Zd(f,g,2),f!==null&&(rt(f,2),kc(f))}function bi(f,g,v){if(f.tag===3)h8(f,f,v);else for(;g!==null;){if(g.tag===3){h8(g,f,v);break}else if(g.tag===1){var k=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(af===null||!af.has(k))){f=Mn(v,f),v=yF(2),k=Zd(g,v,2),k!==null&&(bF(v,k,g,f),rt(k,2),kc(k));break}}g=g.return}}function sR(f,g,v){var k=f.pingCache;if(k===null){k=f.pingCache=new Qce;var j=new Set;k.set(g,j)}else j=k.get(g),j===void 0&&(j=new Set,k.set(g,j));j.has(v)||(YA=!0,j.add(v),f=iue.bind(null,f,g,v),g.then(f,f))}function iue(f,g,v){var k=f.pingCache;k!==null&&k.delete(g),f.pingedLanes|=f.suspendedLanes&v,f.warmLanes&=~v,_i===f&&(Fr&v)===v&&(Vi===4||Vi===3&&(Fr&62914560)===Fr&&300>ce()-JA?(si&2)===0&&Qm(f,0):ZA|=v,Zm===Fr&&(Zm=0)),kc(f)}function p8(f,g){g===0&&(g=z()),f=Nl(f,g),f!==null&&(rt(f,g),kc(f))}function sue(f){var g=f.memoizedState,v=0;g!==null&&(v=g.retryLane),p8(f,v)}function aue(f,g){var v=0;switch(f.tag){case 13:var k=f.stateNode,j=f.memoizedState;j!==null&&(v=j.retryLane);break;case 19:k=f.stateNode;break;case 22:k=f.stateNode._retryCache;break;default:throw Error(r(314))}k!==null&&k.delete(g),p8(f,v)}function oue(f,g){return je(f,g)}var R_=null,tg=null,aR=!1,I_=!1,oR=!1,Vh=0;function kc(f){f!==tg&&f.next===null&&(tg===null?R_=tg=f:tg=tg.next=f),I_=!0,aR||(aR=!0,cue())}function Rb(f,g){if(!oR&&I_){oR=!0;do for(var v=!1,k=R_;k!==null;){if(f!==0){var j=k.pendingLanes;if(j===0)var V=0;else{var ue=k.suspendedLanes,Ae=k.pingedLanes;V=(1<<31-tn(42|f)+1)-1,V&=j&~(ue&~Ae),V=V&201326741?V&201326741|1:V?V|2:0}V!==0&&(v=!0,b8(k,V))}else V=Fr,V=Ie(k,k===_i?V:0,k.cancelPendingCommit!==null||k.timeoutHandle!==-1),(V&3)===0||fe(k,V)||(v=!0,b8(k,V));k=k.next}while(v);oR=!1}}function lue(){m8()}function m8(){I_=aR=!1;var f=0;Vh!==0&&(yue()&&(f=Vh),Vh=0);for(var g=ce(),v=null,k=R_;k!==null;){var j=k.next,V=g8(k,g);V===0?(k.next=null,v===null?R_=j:v.next=j,j===null&&(tg=v)):(v=k,(f!==0||(V&3)!==0)&&(I_=!0)),k=j}Rb(f)}function g8(f,g){for(var v=f.suspendedLanes,k=f.pingedLanes,j=f.expirationTimes,V=f.pendingLanes&-62914561;0<V;){var ue=31-tn(V),Ae=1<<ue,Ge=j[ue];Ge===-1?((Ae&v)===0||(Ae&k)!==0)&&(j[ue]=yt(Ae,g)):Ge<=g&&(f.expiredLanes|=Ae),V&=~Ae}if(g=_i,v=Fr,v=Ie(f,f===g?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),k=f.callbackNode,v===0||f===g&&(ai===2||ai===9)||f.cancelPendingCommit!==null)return k!==null&&k!==null&&Y(k),f.callbackNode=null,f.callbackPriority=0;if((v&3)===0||fe(f,v)){if(g=v&-v,g===f.callbackPriority)return g;switch(k!==null&&Y(k),ge(v)){case 2:case 8:v=Te;break;case 32:v=$e;break;case 268435456:v=ot;break;default:v=$e}return k=y8.bind(null,f),v=je(v,k),f.callbackPriority=g,f.callbackNode=v,g}return k!==null&&k!==null&&Y(k),f.callbackPriority=2,f.callbackNode=null,2}function y8(f,g){if(Zs!==0&&Zs!==5)return f.callbackNode=null,f.callbackPriority=0,null;var v=f.callbackNode;if(A_()&&f.callbackNode!==v)return null;var k=Fr;return k=Ie(f,f===_i?k:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),k===0?null:(QF(f,k,g),g8(f,ce()),f.callbackNode!=null&&f.callbackNode===v?y8.bind(null,f):null)}function b8(f,g){if(A_())return null;QF(f,g,!0)}function cue(){vue(function(){(si&6)!==0?je(ae,lue):m8()})}function lR(){return Vh===0&&(Vh=_t()),Vh}function v8(f){return f==null||typeof f=="symbol"||typeof f=="boolean"?null:typeof f=="function"?f:yu(""+f)}function x8(f,g){var v=g.ownerDocument.createElement("input");return v.name=g.name,v.value=g.value,f.id&&v.setAttribute("form",f.id),g.parentNode.insertBefore(v,g),f=new FormData(f),v.parentNode.removeChild(v),f}function uue(f,g,v,k,j){if(g==="submit"&&v&&v.stateNode===j){var V=v8((j[Oe]||null).action),ue=k.submitter;ue&&(g=(g=ue[Oe]||null)?v8(g.formAction):ue.getAttribute("formAction"),g!==null&&(V=g,ue=null));var Ae=new wm("action","action",null,k,j);f.push({event:Ae,listeners:[{instance:null,listener:function(){if(k.defaultPrevented){if(Vh!==0){var Ge=ue?x8(j,ue):new FormData(j);AA(v,{pending:!0,data:Ge,method:j.method,action:V},null,Ge)}}else typeof V=="function"&&(Ae.preventDefault(),Ge=ue?x8(j,ue):new FormData(j),AA(v,{pending:!0,data:Ge,method:j.method,action:V},V,Ge))},currentTarget:j}]})}}for(var cR=0;cR<rn.length;cR++){var uR=rn[cR],due=uR.toLowerCase(),fue=uR[0].toUpperCase()+uR.slice(1);Vt(due,"on"+fue)}Vt(xt,"onAnimationEnd"),Vt(Ct,"onAnimationIteration"),Vt(kt,"onAnimationStart"),Vt("dblclick","onDoubleClick"),Vt("focusin","onFocus"),Vt("focusout","onBlur"),Vt(It,"onTransitionRun"),Vt(Wt,"onTransitionStart"),Vt(en,"onTransitionCancel"),Vt(qt,"onTransitionEnd"),dn("onMouseEnter",["mouseout","mouseover"]),dn("onMouseLeave",["mouseout","mouseover"]),dn("onPointerEnter",["pointerout","pointerover"]),dn("onPointerLeave",["pointerout","pointerover"]),$t("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$t("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$t("onBeforeInput",["compositionend","keypress","textInput","paste"]),$t("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$t("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$t("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ib="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hue=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ib));function w8(f,g){g=(g&4)!==0;for(var v=0;v<f.length;v++){var k=f[v],j=k.event;k=k.listeners;e:{var V=void 0;if(g)for(var ue=k.length-1;0<=ue;ue--){var Ae=k[ue],Ge=Ae.instance,bt=Ae.currentTarget;if(Ae=Ae.listener,Ge!==V&&j.isPropagationStopped())break e;V=Ae,j.currentTarget=bt;try{V(j)}catch(Mt){y_(Mt)}j.currentTarget=null,V=Ge}else for(ue=0;ue<k.length;ue++){if(Ae=k[ue],Ge=Ae.instance,bt=Ae.currentTarget,Ae=Ae.listener,Ge!==V&&j.isPropagationStopped())break e;V=Ae,j.currentTarget=bt;try{V(j)}catch(Mt){y_(Mt)}j.currentTarget=null,V=Ge}}}}function Ir(f,g){var v=g[vt];v===void 0&&(v=g[vt]=new Set);var k=f+"__bubble";v.has(k)||(_8(g,f,2,!1),v.add(k))}function dR(f,g,v){var k=0;g&&(k|=4),_8(v,f,k,g)}var M_="_reactListening"+Math.random().toString(36).slice(2);function fR(f){if(!f[M_]){f[M_]=!0,un.forEach(function(v){v!=="selectionchange"&&(hue.has(v)||dR(v,!1,f),dR(v,!0,f))});var g=f.nodeType===9?f:f.ownerDocument;g===null||g[M_]||(g[M_]=!0,dR("selectionchange",!1,g))}}function _8(f,g,v,k){switch(W8(g)){case 2:var j=$ue;break;case 8:j=zue;break;default:j=ER}v=j.bind(null,g,v,f),j=void 0,!Vy||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(j=!0),k?j!==void 0?f.addEventListener(g,v,{capture:!0,passive:j}):f.addEventListener(g,v,!0):j!==void 0?f.addEventListener(g,v,{passive:j}):f.addEventListener(g,v,!1)}function hR(f,g,v,k,j){var V=k;if((g&1)===0&&(g&2)===0&&k!==null)e:for(;;){if(k===null)return;var ue=k.tag;if(ue===3||ue===4){var Ae=k.stateNode.containerInfo;if(Ae===j)break;if(ue===4)for(ue=k.return;ue!==null;){var Ge=ue.tag;if((Ge===3||Ge===4)&&ue.stateNode.containerInfo===j)return;ue=ue.return}for(;Ae!==null;){if(ue=or(Ae),ue===null)return;if(Ge=ue.tag,Ge===5||Ge===6||Ge===26||Ge===27){k=V=ue;continue e}Ae=Ae.parentNode}}k=k.return}Bd(function(){var bt=V,Mt=vm(v),Pt=[];e:{var wt=Zt.get(f);if(wt!==void 0){var St=wm,Yn=f;switch(f){case"keypress":if(Ud(v)===0)break e;case"keydown":case"keyup":St=Rm;break;case"focusin":Yn="focus",St=qd;break;case"focusout":Yn="blur",St=qd;break;case"beforeblur":case"afterblur":St=qd;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":St=Cm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":St=$1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":St=Xy;break;case xt:case Ct:case kt:St=z1;break;case qt:St=Jy;break;case"scroll":case"scrollend":St=_m;break;case"wheel":St=Mm;break;case"copy":case"cut":case"paste":St=Tm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":St=Zy;break;case"toggle":case"beforetoggle":St=V1}var Ln=(g&4)!==0,fi=!Ln&&(f==="scroll"||f==="scrollend"),lt=Ln?wt!==null?wt+"Capture":null:wt;Ln=[];for(var Qe=bt,gt;Qe!==null;){var Ot=Qe;if(gt=Ot.stateNode,Ot=Ot.tag,Ot!==5&&Ot!==26&&Ot!==27||gt===null||lt===null||(Ot=xu(Qe,lt),Ot!=null&&Ln.push(Mb(Qe,Ot,gt))),fi)break;Qe=Qe.return}0<Ln.length&&(wt=new St(wt,Yn,null,v,Mt),Pt.push({event:wt,listeners:Ln}))}}if((g&7)===0){e:{if(wt=f==="mouseover"||f==="pointerover",St=f==="mouseout"||f==="pointerout",wt&&v!==Go&&(Yn=v.relatedTarget||v.fromElement)&&(or(Yn)||Yn[We]))break e;if((St||wt)&&(wt=Mt.window===Mt?Mt:(wt=Mt.ownerDocument)?wt.defaultView||wt.parentWindow:window,St?(Yn=v.relatedTarget||v.toElement,St=bt,Yn=Yn?or(Yn):null,Yn!==null&&(fi=s(Yn),Ln=Yn.tag,Yn!==fi||Ln!==5&&Ln!==27&&Ln!==6)&&(Yn=null)):(St=null,Yn=bt),St!==Yn)){if(Ln=Cm,Ot="onMouseLeave",lt="onMouseEnter",Qe="mouse",(f==="pointerout"||f==="pointerover")&&(Ln=Zy,Ot="onPointerLeave",lt="onPointerEnter",Qe="pointer"),fi=St==null?wt:Gr(St),gt=Yn==null?wt:Gr(Yn),wt=new Ln(Ot,Qe+"leave",St,v,Mt),wt.target=fi,wt.relatedTarget=gt,Ot=null,or(Mt)===bt&&(Ln=new Ln(lt,Qe+"enter",Yn,v,Mt),Ln.target=gt,Ln.relatedTarget=fi,Ot=Ln),fi=Ot,St&&Yn)t:{for(Ln=St,lt=Yn,Qe=0,gt=Ln;gt;gt=ng(gt))Qe++;for(gt=0,Ot=lt;Ot;Ot=ng(Ot))gt++;for(;0<Qe-gt;)Ln=ng(Ln),Qe--;for(;0<gt-Qe;)lt=ng(lt),gt--;for(;Qe--;){if(Ln===lt||lt!==null&&Ln===lt.alternate)break t;Ln=ng(Ln),lt=ng(lt)}Ln=null}else Ln=null;St!==null&&S8(Pt,wt,St,Ln,!1),Yn!==null&&fi!==null&&S8(Pt,fi,Yn,Ln,!0)}}e:{if(wt=bt?Gr(bt):window,St=wt.nodeName&&wt.nodeName.toLowerCase(),St==="select"||St==="input"&&wt.type==="file")var mn=Mh;else if(Om(wt))if(Yo)mn=Wd;else{mn=ku;var Tr=Z1}else St=wt.nodeName,!St||St.toLowerCase()!=="input"||wt.type!=="checkbox"&&wt.type!=="radio"?bt&&qy(bt.elementType)&&(mn=Mh):mn=rb;if(mn&&(mn=mn(f,bt))){nb(Pt,mn,v,Mt);break e}Tr&&Tr(f,wt,bt),f==="focusout"&&bt&&wt.type==="number"&&bt.memoizedProps.value!=null&&Pd(wt,"number",wt.value)}switch(Tr=bt?Gr(bt):window,f){case"focusin":(Om(Tr)||Tr.contentEditable==="true")&&(Ve=Tr,Je=bt,et=null);break;case"focusout":et=Je=Ve=null;break;case"mousedown":at=!0;break;case"contextmenu":case"mouseup":case"dragend":at=!1,Ye(Pt,v,Mt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Ye(Pt,v,Mt)}var Tn;if(Rh)e:{switch(f){case"compositionstart":var zn="onCompositionStart";break e;case"compositionend":zn="onCompositionEnd";break e;case"compositionupdate":zn="onCompositionUpdate";break e}zn=void 0}else Cu?tb(f,v)&&(zn="onCompositionEnd"):f==="keydown"&&v.keyCode===229&&(zn="onCompositionStart");zn&&(Nm&&v.locale!=="ko"&&(Cu||zn!=="onCompositionStart"?zn==="onCompositionEnd"&&Cu&&(Tn=zd()):(Ko=Mt,xm="value"in Ko?Ko.value:Ko.textContent,Cu=!0)),Tr=N_(bt,zn),0<Tr.length&&(zn=new Am(zn,f,null,v,Mt),Pt.push({event:zn,listeners:Tr}),Tn?zn.data=Tn:(Tn=W1(v),Tn!==null&&(zn.data=Tn)))),(Tn=GT?G1(f,v):KT(f,v))&&(zn=N_(bt,"onBeforeInput"),0<zn.length&&(Tr=new Am("onBeforeInput","beforeinput",null,v,Mt),Pt.push({event:Tr,listeners:zn}),Tr.data=Tn)),uue(Pt,f,bt,v,Mt)}w8(Pt,g)})}function Mb(f,g,v){return{instance:f,listener:g,currentTarget:v}}function N_(f,g){for(var v=g+"Capture",k=[];f!==null;){var j=f,V=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||V===null||(j=xu(f,v),j!=null&&k.unshift(Mb(f,j,V)),j=xu(f,g),j!=null&&k.push(Mb(f,j,V))),f.tag===3)return k;f=f.return}return[]}function ng(f){if(f===null)return null;do f=f.return;while(f&&f.tag!==5&&f.tag!==27);return f||null}function S8(f,g,v,k,j){for(var V=g._reactName,ue=[];v!==null&&v!==k;){var Ae=v,Ge=Ae.alternate,bt=Ae.stateNode;if(Ae=Ae.tag,Ge!==null&&Ge===k)break;Ae!==5&&Ae!==26&&Ae!==27||bt===null||(Ge=bt,j?(bt=xu(v,V),bt!=null&&ue.unshift(Mb(v,bt,Ge))):j||(bt=xu(v,V),bt!=null&&ue.push(Mb(v,bt,Ge)))),v=v.return}ue.length!==0&&f.push({event:g,listeners:ue})}var pue=/\r\n?/g,mue=/\u0000|\uFFFD/g;function C8(f){return(typeof f=="string"?f:""+f).replace(pue,`
`).replace(mue,"")}function k8(f,g){return g=C8(g),C8(f)===g}function j_(){}function di(f,g,v,k,j,V){switch(v){case"children":typeof k=="string"?g==="body"||g==="textarea"&&k===""||Fd(f,k):(typeof k=="number"||typeof k=="bigint")&&g!=="body"&&Fd(f,""+k);break;case"className":Ta(f,"class",k);break;case"tabIndex":Ta(f,"tabindex",k);break;case"dir":case"role":case"viewBox":case"width":case"height":Ta(f,v,k);break;case"style":L1(f,k,V);break;case"data":if(g!=="object"){Ta(f,"data",k);break}case"src":case"href":if(k===""&&(g!=="a"||v!=="href")){f.removeAttribute(v);break}if(k==null||typeof k=="function"||typeof k=="symbol"||typeof k=="boolean"){f.removeAttribute(v);break}k=yu(""+k),f.setAttribute(v,k);break;case"action":case"formAction":if(typeof k=="function"){f.setAttribute(v,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof V=="function"&&(v==="formAction"?(g!=="input"&&di(f,g,"name",j.name,j,null),di(f,g,"formEncType",j.formEncType,j,null),di(f,g,"formMethod",j.formMethod,j,null),di(f,g,"formTarget",j.formTarget,j,null)):(di(f,g,"encType",j.encType,j,null),di(f,g,"method",j.method,j,null),di(f,g,"target",j.target,j,null)));if(k==null||typeof k=="symbol"||typeof k=="boolean"){f.removeAttribute(v);break}k=yu(""+k),f.setAttribute(v,k);break;case"onClick":k!=null&&(f.onclick=j_);break;case"onScroll":k!=null&&Ir("scroll",f);break;case"onScrollEnd":k!=null&&Ir("scrollend",f);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(r(61));if(v=k.__html,v!=null){if(j.children!=null)throw Error(r(60));f.innerHTML=v}}break;case"multiple":f.multiple=k&&typeof k!="function"&&typeof k!="symbol";break;case"muted":f.muted=k&&typeof k!="function"&&typeof k!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(k==null||typeof k=="function"||typeof k=="boolean"||typeof k=="symbol"){f.removeAttribute("xlink:href");break}v=yu(""+k),f.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",v);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":k!=null&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(v,""+k):f.removeAttribute(v);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":k&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(v,""):f.removeAttribute(v);break;case"capture":case"download":k===!0?f.setAttribute(v,""):k!==!1&&k!=null&&typeof k!="function"&&typeof k!="symbol"?f.setAttribute(v,k):f.removeAttribute(v);break;case"cols":case"rows":case"size":case"span":k!=null&&typeof k!="function"&&typeof k!="symbol"&&!isNaN(k)&&1<=k?f.setAttribute(v,k):f.removeAttribute(v);break;case"rowSpan":case"start":k==null||typeof k=="function"||typeof k=="symbol"||isNaN(k)?f.removeAttribute(v):f.setAttribute(v,k);break;case"popover":Ir("beforetoggle",f),Ir("toggle",f),Ki(f,"popover",k);break;case"xlinkActuate":Gs(f,"http://www.w3.org/1999/xlink","xlink:actuate",k);break;case"xlinkArcrole":Gs(f,"http://www.w3.org/1999/xlink","xlink:arcrole",k);break;case"xlinkRole":Gs(f,"http://www.w3.org/1999/xlink","xlink:role",k);break;case"xlinkShow":Gs(f,"http://www.w3.org/1999/xlink","xlink:show",k);break;case"xlinkTitle":Gs(f,"http://www.w3.org/1999/xlink","xlink:title",k);break;case"xlinkType":Gs(f,"http://www.w3.org/1999/xlink","xlink:type",k);break;case"xmlBase":Gs(f,"http://www.w3.org/XML/1998/namespace","xml:base",k);break;case"xmlLang":Gs(f,"http://www.w3.org/XML/1998/namespace","xml:lang",k);break;case"xmlSpace":Gs(f,"http://www.w3.org/XML/1998/namespace","xml:space",k);break;case"is":Ki(f,"is",k);break;case"innerText":case"textContent":break;default:(!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N")&&(v=Ra.get(v)||v,Ki(f,v,k))}}function pR(f,g,v,k,j,V){switch(v){case"style":L1(f,k,V);break;case"dangerouslySetInnerHTML":if(k!=null){if(typeof k!="object"||!("__html"in k))throw Error(r(61));if(v=k.__html,v!=null){if(j.children!=null)throw Error(r(60));f.innerHTML=v}}break;case"children":typeof k=="string"?Fd(f,k):(typeof k=="number"||typeof k=="bigint")&&Fd(f,""+k);break;case"onScroll":k!=null&&Ir("scroll",f);break;case"onScrollEnd":k!=null&&Ir("scrollend",f);break;case"onClick":k!=null&&(f.onclick=j_);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ze.hasOwnProperty(v))e:{if(v[0]==="o"&&v[1]==="n"&&(j=v.endsWith("Capture"),g=v.slice(2,j?v.length-7:void 0),V=f[Oe]||null,V=V!=null?V[v]:null,typeof V=="function"&&f.removeEventListener(g,V,j),typeof k=="function")){typeof V!="function"&&V!==null&&(v in f?f[v]=null:f.hasAttribute(v)&&f.removeAttribute(v)),f.addEventListener(g,k,j);break e}v in f?f[v]=k:k===!0?f.setAttribute(v,""):Ki(f,v,k)}}}function Xs(f,g,v){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ir("error",f),Ir("load",f);var k=!1,j=!1,V;for(V in v)if(v.hasOwnProperty(V)){var ue=v[V];if(ue!=null)switch(V){case"src":k=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:di(f,g,V,ue,v,null)}}j&&di(f,g,"srcSet",v.srcSet,v,null),k&&di(f,g,"src",v.src,v,null);return;case"input":Ir("invalid",f);var Ae=V=ue=j=null,Ge=null,bt=null;for(k in v)if(v.hasOwnProperty(k)){var Mt=v[k];if(Mt!=null)switch(k){case"name":j=Mt;break;case"type":ue=Mt;break;case"checked":Ge=Mt;break;case"defaultChecked":bt=Mt;break;case"value":V=Mt;break;case"defaultValue":Ae=Mt;break;case"children":case"dangerouslySetInnerHTML":if(Mt!=null)throw Error(r(137,g));break;default:di(f,g,k,Mt,v,null)}}zy(f,V,Ae,Ge,bt,ue,j,!1),gc(f);return;case"select":Ir("invalid",f),k=ue=V=null;for(j in v)if(v.hasOwnProperty(j)&&(Ae=v[j],Ae!=null))switch(j){case"value":V=Ae;break;case"defaultValue":ue=Ae;break;case"multiple":k=Ae;default:di(f,g,j,Ae,v,null)}g=V,v=ue,f.multiple=!!k,g!=null?gu(f,!!k,g,!1):v!=null&&gu(f,!!k,v,!0);return;case"textarea":Ir("invalid",f),V=j=k=null;for(ue in v)if(v.hasOwnProperty(ue)&&(Ae=v[ue],Ae!=null))switch(ue){case"value":k=Ae;break;case"defaultValue":j=Ae;break;case"children":V=Ae;break;case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(r(91));break;default:di(f,g,ue,Ae,v,null)}Uy(f,k,j,V),gc(f);return;case"option":for(Ge in v)if(v.hasOwnProperty(Ge)&&(k=v[Ge],k!=null))switch(Ge){case"selected":f.selected=k&&typeof k!="function"&&typeof k!="symbol";break;default:di(f,g,Ge,k,v,null)}return;case"dialog":Ir("beforetoggle",f),Ir("toggle",f),Ir("cancel",f),Ir("close",f);break;case"iframe":case"object":Ir("load",f);break;case"video":case"audio":for(k=0;k<Ib.length;k++)Ir(Ib[k],f);break;case"image":Ir("error",f),Ir("load",f);break;case"details":Ir("toggle",f);break;case"embed":case"source":case"link":Ir("error",f),Ir("load",f);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(bt in v)if(v.hasOwnProperty(bt)&&(k=v[bt],k!=null))switch(bt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:di(f,g,bt,k,v,null)}return;default:if(qy(g)){for(Mt in v)v.hasOwnProperty(Mt)&&(k=v[Mt],k!==void 0&&pR(f,g,Mt,k,v,void 0));return}}for(Ae in v)v.hasOwnProperty(Ae)&&(k=v[Ae],k!=null&&di(f,g,Ae,k,v,null))}function gue(f,g,v,k){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,V=null,ue=null,Ae=null,Ge=null,bt=null,Mt=null;for(St in v){var Pt=v[St];if(v.hasOwnProperty(St)&&Pt!=null)switch(St){case"checked":break;case"value":break;case"defaultValue":Ge=Pt;default:k.hasOwnProperty(St)||di(f,g,St,null,k,Pt)}}for(var wt in k){var St=k[wt];if(Pt=v[wt],k.hasOwnProperty(wt)&&(St!=null||Pt!=null))switch(wt){case"type":V=St;break;case"name":j=St;break;case"checked":bt=St;break;case"defaultChecked":Mt=St;break;case"value":ue=St;break;case"defaultValue":Ae=St;break;case"children":case"dangerouslySetInnerHTML":if(St!=null)throw Error(r(137,g));break;default:St!==Pt&&di(f,g,wt,St,k,Pt)}}Od(f,ue,Ae,Ge,bt,Mt,V,j);return;case"select":St=ue=Ae=wt=null;for(V in v)if(Ge=v[V],v.hasOwnProperty(V)&&Ge!=null)switch(V){case"value":break;case"multiple":St=Ge;default:k.hasOwnProperty(V)||di(f,g,V,null,k,Ge)}for(j in k)if(V=k[j],Ge=v[j],k.hasOwnProperty(j)&&(V!=null||Ge!=null))switch(j){case"value":wt=V;break;case"defaultValue":Ae=V;break;case"multiple":ue=V;default:V!==Ge&&di(f,g,j,V,k,Ge)}g=Ae,v=ue,k=St,wt!=null?gu(f,!!v,wt,!1):!!k!=!!v&&(g!=null?gu(f,!!v,g,!0):gu(f,!!v,v?[]:"",!1));return;case"textarea":St=wt=null;for(Ae in v)if(j=v[Ae],v.hasOwnProperty(Ae)&&j!=null&&!k.hasOwnProperty(Ae))switch(Ae){case"value":break;case"children":break;default:di(f,g,Ae,null,k,j)}for(ue in k)if(j=k[ue],V=v[ue],k.hasOwnProperty(ue)&&(j!=null||V!=null))switch(ue){case"value":wt=j;break;case"defaultValue":St=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==V&&di(f,g,ue,j,k,V)}Dd(f,wt,St);return;case"option":for(var Yn in v)if(wt=v[Yn],v.hasOwnProperty(Yn)&&wt!=null&&!k.hasOwnProperty(Yn))switch(Yn){case"selected":f.selected=!1;break;default:di(f,g,Yn,null,k,wt)}for(Ge in k)if(wt=k[Ge],St=v[Ge],k.hasOwnProperty(Ge)&&wt!==St&&(wt!=null||St!=null))switch(Ge){case"selected":f.selected=wt&&typeof wt!="function"&&typeof wt!="symbol";break;default:di(f,g,Ge,wt,k,St)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ln in v)wt=v[Ln],v.hasOwnProperty(Ln)&&wt!=null&&!k.hasOwnProperty(Ln)&&di(f,g,Ln,null,k,wt);for(bt in k)if(wt=k[bt],St=v[bt],k.hasOwnProperty(bt)&&wt!==St&&(wt!=null||St!=null))switch(bt){case"children":case"dangerouslySetInnerHTML":if(wt!=null)throw Error(r(137,g));break;default:di(f,g,bt,wt,k,St)}return;default:if(qy(g)){for(var fi in v)wt=v[fi],v.hasOwnProperty(fi)&&wt!==void 0&&!k.hasOwnProperty(fi)&&pR(f,g,fi,void 0,k,wt);for(Mt in k)wt=k[Mt],St=v[Mt],!k.hasOwnProperty(Mt)||wt===St||wt===void 0&&St===void 0||pR(f,g,Mt,wt,k,St);return}}for(var lt in v)wt=v[lt],v.hasOwnProperty(lt)&&wt!=null&&!k.hasOwnProperty(lt)&&di(f,g,lt,null,k,wt);for(Pt in k)wt=k[Pt],St=v[Pt],!k.hasOwnProperty(Pt)||wt===St||wt==null&&St==null||di(f,g,Pt,wt,k,St)}var mR=null,gR=null;function O_(f){return f.nodeType===9?f:f.ownerDocument}function E8(f){switch(f){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function T8(f,g){if(f===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return f===1&&g==="foreignObject"?0:f}function yR(f,g){return f==="textarea"||f==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var bR=null;function yue(){var f=window.event;return f&&f.type==="popstate"?f===bR?!1:(bR=f,!0):(bR=null,!1)}var A8=typeof setTimeout=="function"?setTimeout:void 0,bue=typeof clearTimeout=="function"?clearTimeout:void 0,R8=typeof Promise=="function"?Promise:void 0,vue=typeof queueMicrotask=="function"?queueMicrotask:typeof R8<"u"?function(f){return R8.resolve(null).then(f).catch(xue)}:A8;function xue(f){setTimeout(function(){throw f})}function cf(f){return f==="head"}function I8(f,g){var v=g,k=0,j=0;do{var V=v.nextSibling;if(f.removeChild(v),V&&V.nodeType===8)if(v=V.data,v==="/$"){if(0<k&&8>k){v=k;var ue=f.ownerDocument;if(v&1&&Nb(ue.documentElement),v&2&&Nb(ue.body),v&4)for(v=ue.head,Nb(v),ue=v.firstChild;ue;){var Ae=ue.nextSibling,Ge=ue.nodeName;ue[Qt]||Ge==="SCRIPT"||Ge==="STYLE"||Ge==="LINK"&&ue.rel.toLowerCase()==="stylesheet"||v.removeChild(ue),ue=Ae}}if(j===0){f.removeChild(V),$b(g);return}j--}else v==="$"||v==="$?"||v==="$!"?j++:k=v.charCodeAt(0)-48;else k=0;v=V}while(v);$b(g)}function vR(f){var g=f.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var v=g;switch(g=g.nextSibling,v.nodeName){case"HTML":case"HEAD":case"BODY":vR(v),on(v);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(v.rel.toLowerCase()==="stylesheet")continue}f.removeChild(v)}}function wue(f,g,v,k){for(;f.nodeType===1;){var j=v;if(f.nodeName.toLowerCase()!==g.toLowerCase()){if(!k&&(f.nodeName!=="INPUT"||f.type!=="hidden"))break}else if(k){if(!f[Qt])switch(g){case"meta":if(!f.hasAttribute("itemprop"))break;return f;case"link":if(V=f.getAttribute("rel"),V==="stylesheet"&&f.hasAttribute("data-precedence"))break;if(V!==j.rel||f.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||f.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||f.getAttribute("title")!==(j.title==null?null:j.title))break;return f;case"style":if(f.hasAttribute("data-precedence"))break;return f;case"script":if(V=f.getAttribute("src"),(V!==(j.src==null?null:j.src)||f.getAttribute("type")!==(j.type==null?null:j.type)||f.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&V&&f.hasAttribute("async")&&!f.hasAttribute("itemprop"))break;return f;default:return f}}else if(g==="input"&&f.type==="hidden"){var V=j.name==null?null:""+j.name;if(j.type==="hidden"&&f.getAttribute("name")===V)return f}else return f;if(f=Ol(f.nextSibling),f===null)break}return null}function _ue(f,g,v){if(g==="")return null;for(;f.nodeType!==3;)if((f.nodeType!==1||f.nodeName!=="INPUT"||f.type!=="hidden")&&!v||(f=Ol(f.nextSibling),f===null))return null;return f}function xR(f){return f.data==="$!"||f.data==="$?"&&f.ownerDocument.readyState==="complete"}function Sue(f,g){var v=f.ownerDocument;if(f.data!=="$?"||v.readyState==="complete")g();else{var k=function(){g(),v.removeEventListener("DOMContentLoaded",k)};v.addEventListener("DOMContentLoaded",k),f._reactRetry=k}}function Ol(f){for(;f!=null;f=f.nextSibling){var g=f.nodeType;if(g===1||g===3)break;if(g===8){if(g=f.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return f}var wR=null;function M8(f){f=f.previousSibling;for(var g=0;f;){if(f.nodeType===8){var v=f.data;if(v==="$"||v==="$!"||v==="$?"){if(g===0)return f;g--}else v==="/$"&&g++}f=f.previousSibling}return null}function N8(f,g,v){switch(g=O_(v),f){case"html":if(f=g.documentElement,!f)throw Error(r(452));return f;case"head":if(f=g.head,!f)throw Error(r(453));return f;case"body":if(f=g.body,!f)throw Error(r(454));return f;default:throw Error(r(451))}}function Nb(f){for(var g=f.attributes;g.length;)f.removeAttributeNode(g[0]);on(f)}var tl=new Map,j8=new Set;function P_(f){return typeof f.getRootNode=="function"?f.getRootNode():f.nodeType===9?f:f.ownerDocument}var Lu=K.d;K.d={f:Cue,r:kue,D:Eue,C:Tue,L:Aue,m:Rue,X:Mue,S:Iue,M:Nue};function Cue(){var f=Lu.f(),g=E_();return f||g}function kue(f){var g=xr(f);g!==null&&g.tag===5&&g.type==="form"?Q5(g):Lu.r(f)}var rg=typeof document>"u"?null:document;function O8(f,g,v){var k=rg;if(k&&typeof g=="string"&&g){var j=oa(g);j='link[rel="'+f+'"][href="'+j+'"]',typeof v=="string"&&(j+='[crossorigin="'+v+'"]'),j8.has(j)||(j8.add(j),f={rel:f,crossOrigin:v,href:g},k.querySelector(j)===null&&(g=k.createElement("link"),Xs(g,"link",f),pr(g),k.head.appendChild(g)))}}function Eue(f){Lu.D(f),O8("dns-prefetch",f,null)}function Tue(f,g){Lu.C(f,g),O8("preconnect",f,g)}function Aue(f,g,v){Lu.L(f,g,v);var k=rg;if(k&&f&&g){var j='link[rel="preload"][as="'+oa(g)+'"]';g==="image"&&v&&v.imageSrcSet?(j+='[imagesrcset="'+oa(v.imageSrcSet)+'"]',typeof v.imageSizes=="string"&&(j+='[imagesizes="'+oa(v.imageSizes)+'"]')):j+='[href="'+oa(f)+'"]';var V=j;switch(g){case"style":V=ig(f);break;case"script":V=sg(f)}tl.has(V)||(f=u({rel:"preload",href:g==="image"&&v&&v.imageSrcSet?void 0:f,as:g},v),tl.set(V,f),k.querySelector(j)!==null||g==="style"&&k.querySelector(jb(V))||g==="script"&&k.querySelector(Ob(V))||(g=k.createElement("link"),Xs(g,"link",f),pr(g),k.head.appendChild(g)))}}function Rue(f,g){Lu.m(f,g);var v=rg;if(v&&f){var k=g&&typeof g.as=="string"?g.as:"script",j='link[rel="modulepreload"][as="'+oa(k)+'"][href="'+oa(f)+'"]',V=j;switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":V=sg(f)}if(!tl.has(V)&&(f=u({rel:"modulepreload",href:f},g),tl.set(V,f),v.querySelector(j)===null)){switch(k){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(v.querySelector(Ob(V)))return}k=v.createElement("link"),Xs(k,"link",f),pr(k),v.head.appendChild(k)}}}function Iue(f,g,v){Lu.S(f,g,v);var k=rg;if(k&&f){var j=Kr(k).hoistableStyles,V=ig(f);g=g||"default";var ue=j.get(V);if(!ue){var Ae={loading:0,preload:null};if(ue=k.querySelector(jb(V)))Ae.loading=5;else{f=u({rel:"stylesheet",href:f,"data-precedence":g},v),(v=tl.get(V))&&_R(f,v);var Ge=ue=k.createElement("link");pr(Ge),Xs(Ge,"link",f),Ge._p=new Promise(function(bt,Mt){Ge.onload=bt,Ge.onerror=Mt}),Ge.addEventListener("load",function(){Ae.loading|=1}),Ge.addEventListener("error",function(){Ae.loading|=2}),Ae.loading|=4,D_(ue,g,k)}ue={type:"stylesheet",instance:ue,count:1,state:Ae},j.set(V,ue)}}}function Mue(f,g){Lu.X(f,g);var v=rg;if(v&&f){var k=Kr(v).hoistableScripts,j=sg(f),V=k.get(j);V||(V=v.querySelector(Ob(j)),V||(f=u({src:f,async:!0},g),(g=tl.get(j))&&SR(f,g),V=v.createElement("script"),pr(V),Xs(V,"link",f),v.head.appendChild(V)),V={type:"script",instance:V,count:1,state:null},k.set(j,V))}}function Nue(f,g){Lu.M(f,g);var v=rg;if(v&&f){var k=Kr(v).hoistableScripts,j=sg(f),V=k.get(j);V||(V=v.querySelector(Ob(j)),V||(f=u({src:f,async:!0,type:"module"},g),(g=tl.get(j))&&SR(f,g),V=v.createElement("script"),pr(V),Xs(V,"link",f),v.head.appendChild(V)),V={type:"script",instance:V,count:1,state:null},k.set(j,V))}}function P8(f,g,v,k){var j=(j=Ne.current)?P_(j):null;if(!j)throw Error(r(446));switch(f){case"meta":case"title":return null;case"style":return typeof v.precedence=="string"&&typeof v.href=="string"?(g=ig(v.href),v=Kr(j).hoistableStyles,k=v.get(g),k||(k={type:"style",instance:null,count:0,state:null},v.set(g,k)),k):{type:"void",instance:null,count:0,state:null};case"link":if(v.rel==="stylesheet"&&typeof v.href=="string"&&typeof v.precedence=="string"){f=ig(v.href);var V=Kr(j).hoistableStyles,ue=V.get(f);if(ue||(j=j.ownerDocument||j,ue={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},V.set(f,ue),(V=j.querySelector(jb(f)))&&!V._p&&(ue.instance=V,ue.state.loading=5),tl.has(f)||(v={rel:"preload",as:"style",href:v.href,crossOrigin:v.crossOrigin,integrity:v.integrity,media:v.media,hrefLang:v.hrefLang,referrerPolicy:v.referrerPolicy},tl.set(f,v),V||jue(j,f,v,ue.state))),g&&k===null)throw Error(r(528,""));return ue}if(g&&k!==null)throw Error(r(529,""));return null;case"script":return g=v.async,v=v.src,typeof v=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=sg(v),v=Kr(j).hoistableScripts,k=v.get(g),k||(k={type:"script",instance:null,count:0,state:null},v.set(g,k)),k):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,f))}}function ig(f){return'href="'+oa(f)+'"'}function jb(f){return'link[rel="stylesheet"]['+f+"]"}function D8(f){return u({},f,{"data-precedence":f.precedence,precedence:null})}function jue(f,g,v,k){f.querySelector('link[rel="preload"][as="style"]['+g+"]")?k.loading=1:(g=f.createElement("link"),k.preload=g,g.addEventListener("load",function(){return k.loading|=1}),g.addEventListener("error",function(){return k.loading|=2}),Xs(g,"link",v),pr(g),f.head.appendChild(g))}function sg(f){return'[src="'+oa(f)+'"]'}function Ob(f){return"script[async]"+f}function F8(f,g,v){if(g.count++,g.instance===null)switch(g.type){case"style":var k=f.querySelector('style[data-href~="'+oa(v.href)+'"]');if(k)return g.instance=k,pr(k),k;var j=u({},v,{"data-href":v.href,"data-precedence":v.precedence,href:null,precedence:null});return k=(f.ownerDocument||f).createElement("style"),pr(k),Xs(k,"style",j),D_(k,v.precedence,f),g.instance=k;case"stylesheet":j=ig(v.href);var V=f.querySelector(jb(j));if(V)return g.state.loading|=4,g.instance=V,pr(V),V;k=D8(v),(j=tl.get(j))&&_R(k,j),V=(f.ownerDocument||f).createElement("link"),pr(V);var ue=V;return ue._p=new Promise(function(Ae,Ge){ue.onload=Ae,ue.onerror=Ge}),Xs(V,"link",k),g.state.loading|=4,D_(V,v.precedence,f),g.instance=V;case"script":return V=sg(v.src),(j=f.querySelector(Ob(V)))?(g.instance=j,pr(j),j):(k=v,(j=tl.get(V))&&(k=u({},v),SR(k,j)),f=f.ownerDocument||f,j=f.createElement("script"),pr(j),Xs(j,"link",k),f.head.appendChild(j),g.instance=j);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(k=g.instance,g.state.loading|=4,D_(k,v.precedence,f));return g.instance}function D_(f,g,v){for(var k=v.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=k.length?k[k.length-1]:null,V=j,ue=0;ue<k.length;ue++){var Ae=k[ue];if(Ae.dataset.precedence===g)V=Ae;else if(V!==j)break}V?V.parentNode.insertBefore(f,V.nextSibling):(g=v.nodeType===9?v.head:v,g.insertBefore(f,g.firstChild))}function _R(f,g){f.crossOrigin==null&&(f.crossOrigin=g.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=g.referrerPolicy),f.title==null&&(f.title=g.title)}function SR(f,g){f.crossOrigin==null&&(f.crossOrigin=g.crossOrigin),f.referrerPolicy==null&&(f.referrerPolicy=g.referrerPolicy),f.integrity==null&&(f.integrity=g.integrity)}var F_=null;function L8(f,g,v){if(F_===null){var k=new Map,j=F_=new Map;j.set(v,k)}else j=F_,k=j.get(v),k||(k=new Map,j.set(v,k));if(k.has(f))return k;for(k.set(f,null),v=v.getElementsByTagName(f),j=0;j<v.length;j++){var V=v[j];if(!(V[Qt]||V[ye]||f==="link"&&V.getAttribute("rel")==="stylesheet")&&V.namespaceURI!=="http://www.w3.org/2000/svg"){var ue=V.getAttribute(g)||"";ue=f+ue;var Ae=k.get(ue);Ae?Ae.push(V):k.set(ue,[V])}}return k}function B8(f,g,v){f=f.ownerDocument||f,f.head.insertBefore(v,g==="title"?f.querySelector("head > title"):null)}function Oue(f,g,v){if(v===1||g.itemProp!=null)return!1;switch(f){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return f=g.disabled,typeof g.precedence=="string"&&f==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function $8(f){return!(f.type==="stylesheet"&&(f.state.loading&3)===0)}var Pb=null;function Pue(){}function Due(f,g,v){if(Pb===null)throw Error(r(475));var k=Pb;if(g.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var j=ig(v.href),V=f.querySelector(jb(j));if(V){f=V._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(k.count++,k=L_.bind(k),f.then(k,k)),g.state.loading|=4,g.instance=V,pr(V);return}V=f.ownerDocument||f,v=D8(v),(j=tl.get(j))&&_R(v,j),V=V.createElement("link"),pr(V);var ue=V;ue._p=new Promise(function(Ae,Ge){ue.onload=Ae,ue.onerror=Ge}),Xs(V,"link",v),g.instance=V}k.stylesheets===null&&(k.stylesheets=new Map),k.stylesheets.set(g,f),(f=g.state.preload)&&(g.state.loading&3)===0&&(k.count++,g=L_.bind(k),f.addEventListener("load",g),f.addEventListener("error",g))}}function Fue(){if(Pb===null)throw Error(r(475));var f=Pb;return f.stylesheets&&f.count===0&&CR(f,f.stylesheets),0<f.count?function(g){var v=setTimeout(function(){if(f.stylesheets&&CR(f,f.stylesheets),f.unsuspend){var k=f.unsuspend;f.unsuspend=null,k()}},6e4);return f.unsuspend=g,function(){f.unsuspend=null,clearTimeout(v)}}:null}function L_(){if(this.count--,this.count===0){if(this.stylesheets)CR(this,this.stylesheets);else if(this.unsuspend){var f=this.unsuspend;this.unsuspend=null,f()}}}var B_=null;function CR(f,g){f.stylesheets=null,f.unsuspend!==null&&(f.count++,B_=new Map,g.forEach(Lue,f),B_=null,L_.call(f))}function Lue(f,g){if(!(g.state.loading&4)){var v=B_.get(f);if(v)var k=v.get(null);else{v=new Map,B_.set(f,v);for(var j=f.querySelectorAll("link[data-precedence],style[data-precedence]"),V=0;V<j.length;V++){var ue=j[V];(ue.nodeName==="LINK"||ue.getAttribute("media")!=="not all")&&(v.set(ue.dataset.precedence,ue),k=ue)}k&&v.set(null,k)}j=g.instance,ue=j.getAttribute("data-precedence"),V=v.get(ue)||k,V===k&&v.set(null,j),v.set(ue,j),this.count++,k=L_.bind(this),j.addEventListener("load",k),j.addEventListener("error",k),V?V.parentNode.insertBefore(j,V.nextSibling):(f=f.nodeType===9?f.head:f,f.insertBefore(j,f.firstChild)),g.state.loading|=4}}var Db={$$typeof:S,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function Bue(f,g,v,k,j,V,ue,Ae){this.tag=1,this.containerInfo=f,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qe(0),this.hiddenUpdates=qe(null),this.identifierPrefix=k,this.onUncaughtError=j,this.onCaughtError=V,this.onRecoverableError=ue,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ae,this.incompleteTransitions=new Map}function z8(f,g,v,k,j,V,ue,Ae,Ge,bt,Mt,Pt){return f=new Bue(f,g,v,ue,Ae,Ge,bt,Pt),g=1,V===!0&&(g|=24),V=Co(3,null,null,g),f.current=V,V.stateNode=f,g=sA(),g.refCount++,f.pooledCache=g,g.refCount++,V.memoizedState={element:k,isDehydrated:v,cache:g},cA(V),f}function U8(f){return f?(f=xc,f):xc}function q8(f,g,v,k,j,V){j=U8(j),k.context===null?k.context=j:k.pendingContext=j,k=Yd(g),k.payload={element:v},V=V===void 0?null:V,V!==null&&(k.callback=V),v=Zd(f,k,g),v!==null&&(Ro(v,f,g),fb(v,f,g))}function V8(f,g){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var v=f.retryLane;f.retryLane=v!==0&&v<g?v:g}}function kR(f,g){V8(f,g),(f=f.alternate)&&V8(f,g)}function H8(f){if(f.tag===13){var g=Nl(f,67108864);g!==null&&Ro(g,f,67108864),kR(f,67108864)}}var $_=!0;function $ue(f,g,v,k){var j=q.T;q.T=null;var V=K.p;try{K.p=2,ER(f,g,v,k)}finally{K.p=V,q.T=j}}function zue(f,g,v,k){var j=q.T;q.T=null;var V=K.p;try{K.p=8,ER(f,g,v,k)}finally{K.p=V,q.T=j}}function ER(f,g,v,k){if($_){var j=TR(k);if(j===null)hR(f,g,k,z_,v),G8(f,k);else if(que(j,f,g,v,k))k.stopPropagation();else if(G8(f,k),g&4&&-1<Uue.indexOf(f)){for(;j!==null;){var V=xr(j);if(V!==null)switch(V.tag){case 3:if(V=V.stateNode,V.current.memoizedState.isDehydrated){var ue=we(V.pendingLanes);if(ue!==0){var Ae=V;for(Ae.pendingLanes|=2,Ae.entangledLanes|=2;ue;){var Ge=1<<31-tn(ue);Ae.entanglements[1]|=Ge,ue&=~Ge}kc(V),(si&6)===0&&(C_=ce()+500,Rb(0))}}break;case 13:Ae=Nl(V,2),Ae!==null&&Ro(Ae,V,2),E_(),kR(V,2)}if(V=TR(k),V===null&&hR(f,g,k,z_,v),V===j)break;j=V}j!==null&&k.stopPropagation()}else hR(f,g,k,null,v)}}function TR(f){return f=vm(f),AR(f)}var z_=null;function AR(f){if(z_=null,f=or(f),f!==null){var g=s(f);if(g===null)f=null;else{var v=g.tag;if(v===13){if(f=a(g),f!==null)return f;f=null}else if(v===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;f=null}else g!==f&&(f=null)}}return z_=f,null}function W8(f){switch(f){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case ae:return 2;case Te:return 8;case $e:case ke:return 32;case ot:return 268435456;default:return 32}default:return 32}}var RR=!1,uf=null,df=null,ff=null,Fb=new Map,Lb=new Map,hf=[],Uue="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function G8(f,g){switch(f){case"focusin":case"focusout":uf=null;break;case"dragenter":case"dragleave":df=null;break;case"mouseover":case"mouseout":ff=null;break;case"pointerover":case"pointerout":Fb.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lb.delete(g.pointerId)}}function Bb(f,g,v,k,j,V){return f===null||f.nativeEvent!==V?(f={blockedOn:g,domEventName:v,eventSystemFlags:k,nativeEvent:V,targetContainers:[j]},g!==null&&(g=xr(g),g!==null&&H8(g)),f):(f.eventSystemFlags|=k,g=f.targetContainers,j!==null&&g.indexOf(j)===-1&&g.push(j),f)}function que(f,g,v,k,j){switch(g){case"focusin":return uf=Bb(uf,f,g,v,k,j),!0;case"dragenter":return df=Bb(df,f,g,v,k,j),!0;case"mouseover":return ff=Bb(ff,f,g,v,k,j),!0;case"pointerover":var V=j.pointerId;return Fb.set(V,Bb(Fb.get(V)||null,f,g,v,k,j)),!0;case"gotpointercapture":return V=j.pointerId,Lb.set(V,Bb(Lb.get(V)||null,f,g,v,k,j)),!0}return!1}function K8(f){var g=or(f.target);if(g!==null){var v=s(g);if(v!==null){if(g=v.tag,g===13){if(g=a(v),g!==null){f.blockedOn=g,W(f.priority,function(){if(v.tag===13){var k=Ao();k=Tt(k);var j=Nl(v,k);j!==null&&Ro(j,v,k),kR(v,k)}});return}}else if(g===3&&v.stateNode.current.memoizedState.isDehydrated){f.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}f.blockedOn=null}function U_(f){if(f.blockedOn!==null)return!1;for(var g=f.targetContainers;0<g.length;){var v=TR(f.nativeEvent);if(v===null){v=f.nativeEvent;var k=new v.constructor(v.type,v);Go=k,v.target.dispatchEvent(k),Go=null}else return g=xr(v),g!==null&&H8(g),f.blockedOn=v,!1;g.shift()}return!0}function Y8(f,g,v){U_(f)&&v.delete(g)}function Vue(){RR=!1,uf!==null&&U_(uf)&&(uf=null),df!==null&&U_(df)&&(df=null),ff!==null&&U_(ff)&&(ff=null),Fb.forEach(Y8),Lb.forEach(Y8)}function q_(f,g){f.blockedOn===g&&(f.blockedOn=null,RR||(RR=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Vue)))}var V_=null;function Z8(f){V_!==f&&(V_=f,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){V_===f&&(V_=null);for(var g=0;g<f.length;g+=3){var v=f[g],k=f[g+1],j=f[g+2];if(typeof k!="function"){if(AR(k||v)===null)continue;break}var V=xr(v);V!==null&&(f.splice(g,3),g-=3,AA(V,{pending:!0,data:j,method:v.method,action:k},k,j))}}))}function $b(f){function g(Ge){return q_(Ge,f)}uf!==null&&q_(uf,f),df!==null&&q_(df,f),ff!==null&&q_(ff,f),Fb.forEach(g),Lb.forEach(g);for(var v=0;v<hf.length;v++){var k=hf[v];k.blockedOn===f&&(k.blockedOn=null)}for(;0<hf.length&&(v=hf[0],v.blockedOn===null);)K8(v),v.blockedOn===null&&hf.shift();if(v=(f.ownerDocument||f).$$reactFormReplay,v!=null)for(k=0;k<v.length;k+=3){var j=v[k],V=v[k+1],ue=j[Oe]||null;if(typeof V=="function")ue||Z8(v);else if(ue){var Ae=null;if(V&&V.hasAttribute("formAction")){if(j=V,ue=V[Oe]||null)Ae=ue.formAction;else if(AR(j)!==null)continue}else Ae=ue.action;typeof Ae=="function"?v[k+1]=Ae:(v.splice(k,3),k-=3),Z8(v)}}}function IR(f){this._internalRoot=f}H_.prototype.render=IR.prototype.render=function(f){var g=this._internalRoot;if(g===null)throw Error(r(409));var v=g.current,k=Ao();q8(v,k,f,g,null,null)},H_.prototype.unmount=IR.prototype.unmount=function(){var f=this._internalRoot;if(f!==null){this._internalRoot=null;var g=f.containerInfo;q8(f.current,2,null,f,null,null),E_(),g[We]=null}};function H_(f){this._internalRoot=f}H_.prototype.unstable_scheduleHydration=function(f){if(f){var g=Z();f={blockedOn:null,target:f,priority:g};for(var v=0;v<hf.length&&g!==0&&g<hf[v].priority;v++);hf.splice(v,0,f),v===0&&K8(f)}};var X8=t.version;if(X8!=="19.1.0")throw Error(r(527,X8,"19.1.0"));K.findDOMNode=function(f){var g=f._reactInternals;if(g===void 0)throw typeof f.render=="function"?Error(r(188)):(f=Object.keys(f).join(","),Error(r(268,f)));return f=l(g),f=f!==null?c(f):null,f=f===null?null:f.stateNode,f};var Hue={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var W_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!W_.isDisabled&&W_.supportsFiber)try{jt=W_.inject(Hue),Bt=W_}catch{}}return Ub.createRoot=function(f,g){if(!i(f))throw Error(r(299));var v=!1,k="",j=hF,V=pF,ue=mF,Ae=null;return g!=null&&(g.unstable_strictMode===!0&&(v=!0),g.identifierPrefix!==void 0&&(k=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(V=g.onCaughtError),g.onRecoverableError!==void 0&&(ue=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Ae=g.unstable_transitionCallbacks)),g=z8(f,1,!1,null,null,v,k,j,V,ue,Ae,null),f[We]=g.current,fR(f),new IR(g)},Ub.hydrateRoot=function(f,g,v){if(!i(f))throw Error(r(299));var k=!1,j="",V=hF,ue=pF,Ae=mF,Ge=null,bt=null;return v!=null&&(v.unstable_strictMode===!0&&(k=!0),v.identifierPrefix!==void 0&&(j=v.identifierPrefix),v.onUncaughtError!==void 0&&(V=v.onUncaughtError),v.onCaughtError!==void 0&&(ue=v.onCaughtError),v.onRecoverableError!==void 0&&(Ae=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(Ge=v.unstable_transitionCallbacks),v.formState!==void 0&&(bt=v.formState)),g=z8(f,1,!0,g,v??null,k,j,V,ue,Ae,Ge,bt),g.context=U8(null),v=g.current,k=Ao(),k=Tt(k),j=Yd(k),j.callback=null,Zd(v,j,k),v=k,g.current.lanes=v,rt(g,v),kc(g),f[We]=g.current,fR(f),new H_(g)},Ub.version="19.1.0",Ub}var oL;function ode(){if(oL)return jR.exports;oL=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),jR.exports=ade(),jR.exports}var lde=ode();const cde=aa(lde);function lL(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function cd(...e){return t=>{let n=!1;const r=e.map(i=>{const s=lL(i,t);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():lL(e[i],null)}}}}function tr(...e){return A.useCallback(cd(...e),e)}function Nf(e){const t=ude(e),n=A.forwardRef((r,i)=>{const{children:s,...a}=r,o=A.Children.toArray(s),l=o.find(fde);if(l){const c=l.props.children,u=o.map(d=>d===l?A.Children.count(c)>1?A.Children.only(null):A.isValidElement(c)?c.props.children:null:d);return m.jsx(t,{...a,ref:i,children:A.isValidElement(c)?A.cloneElement(c,void 0,u):null})}return m.jsx(t,{...a,ref:i,children:s})});return n.displayName=`${e}.Slot`,n}var xV=Nf("Slot");function ude(e){const t=A.forwardRef((n,r)=>{const{children:i,...s}=n;if(A.isValidElement(i)){const a=pde(i),o=hde(s,i.props);return i.type!==A.Fragment&&(o.ref=r?cd(r,a):a),A.cloneElement(i,o)}return A.Children.count(i)>1?A.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var wV=Symbol("radix.slottable");function dde(e){const t=({children:n})=>m.jsx(m.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=wV,t}function fde(e){return A.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===wV}function hde(e,t){const n={...t};for(const r in t){const i=e[r],s=t[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...o)=>{s(...o),i(...o)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...e,...n}}function pde(e){var r,i;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function _V(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=_V(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function SV(){for(var e,t,n=0,r="",i=arguments.length;n<i;n++)(e=arguments[n])&&(t=_V(e))&&(r&&(r+=" "),r+=t);return r}const cL=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,uL=SV,Z4=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return uL(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=t,a=Object.keys(i).map(c=>{const u=n==null?void 0:n[c],d=s==null?void 0:s[c];if(u===null)return null;const h=cL(u)||cL(d);return i[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...p}=u;return Object.entries(p).every(y=>{let[b,x]=y;return Array.isArray(x)?x.includes({...s,...o}[b]):{...s,...o}[b]===x})?[...c,d,h]:c},[]);return uL(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},X4="-",mde=e=>{const t=yde(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(X4);return o[0]===""&&o.length!==1&&o.shift(),CV(o,t)||gde(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},CV=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),i=r?CV(e.slice(1),r):void 0;if(i)return i;if(t.validators.length===0)return;const s=e.join(X4);return(a=t.validators.find(({validator:o})=>o(s)))==null?void 0:a.classGroupId},dL=/^\[(.+)\]$/,gde=e=>{if(dL.test(e)){const t=dL.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},yde=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const i in n)c3(n[i],r,i,t);return r},c3=(e,t,n,r)=>{e.forEach(i=>{if(typeof i=="string"){const s=i===""?t:fL(t,i);s.classGroupId=n;return}if(typeof i=="function"){if(bde(i)){c3(i(r),t,n,r);return}t.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([s,a])=>{c3(a,fL(t,s),n,r)})})},fL=(e,t)=>{let n=e;return t.split(X4).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},bde=e=>e.isThemeGetter,vde=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const i=(s,a)=>{n.set(s,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(s){let a=n.get(s);if(a!==void 0)return a;if((a=r.get(s))!==void 0)return i(s,a),a},set(s,a){n.has(s)?n.set(s,a):i(s,a)}}},u3="!",d3=":",xde=d3.length,wde=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=i=>{const s=[];let a=0,o=0,l=0,c;for(let y=0;y<i.length;y++){let b=i[y];if(a===0&&o===0){if(b===d3){s.push(i.slice(l,y)),l=y+xde;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=s.length===0?i:i.substring(l),d=_de(u),h=d!==u,p=c&&c>l?c-l:void 0;return{modifiers:s,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:p}};if(t){const i=t+d3,s=r;r=a=>a.startsWith(i)?s(a.substring(i.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const i=r;r=s=>n({className:s,parseClassName:i})}return r},_de=e=>e.endsWith(u3)?e.substring(0,e.length-1):e.startsWith(u3)?e.substring(1):e,Sde=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const i=[];let s=[];return r.forEach(a=>{a[0]==="["||t[a]?(i.push(...s.sort(),a),s=[]):s.push(a)}),i.push(...s.sort()),i}},Cde=e=>({cache:vde(e.cacheSize),parseClassName:wde(e),sortModifiers:Sde(e),...mde(e)}),kde=/\s+/,Ede=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i,sortModifiers:s}=t,a=[],o=e.trim().split(kde);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let x=!!b,w=r(x?y.substring(0,b):y);if(!w){if(!x){l=u+(l.length>0?" "+l:l);continue}if(w=r(y),!w){l=u+(l.length>0?" "+l:l);continue}x=!1}const _=s(h).join(":"),S=p?_+u3:_,C=S+w;if(a.includes(C))continue;a.push(C);const E=i(w,x);for(let T=0;T<E.length;++T){const R=E[T];a.push(S+R)}l=u+(l.length>0?" "+l:l)}return l};function Tde(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=kV(t))&&(r&&(r+=" "),r+=n);return r}const kV=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=kV(e[r]))&&(n&&(n+=" "),n+=t);return n};function Ade(e,...t){let n,r,i,s=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=Cde(c),r=n.cache.get,i=n.cache.set,s=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=Ede(l,n);return i(l,u),u}return function(){return s(Tde.apply(null,arguments))}}const vs=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},EV=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,TV=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Rde=/^\d+\/\d+$/,Ide=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Mde=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Nde=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,jde=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Ode=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ag=e=>Rde.test(e),Cr=e=>!!e&&!Number.isNaN(Number(e)),mf=e=>!!e&&Number.isInteger(Number(e)),FR=e=>e.endsWith("%")&&Cr(e.slice(0,-1)),Bu=e=>Ide.test(e),Pde=()=>!0,Dde=e=>Mde.test(e)&&!Nde.test(e),AV=()=>!1,Fde=e=>jde.test(e),Lde=e=>Ode.test(e),Bde=e=>!gn(e)&&!yn(e),$de=e=>V0(e,MV,AV),gn=e=>EV.test(e),Hh=e=>V0(e,NV,Dde),LR=e=>V0(e,Hde,Cr),hL=e=>V0(e,RV,AV),zde=e=>V0(e,IV,Lde),G_=e=>V0(e,jV,Fde),yn=e=>TV.test(e),qb=e=>H0(e,NV),Ude=e=>H0(e,Wde),pL=e=>H0(e,RV),qde=e=>H0(e,MV),Vde=e=>H0(e,IV),K_=e=>H0(e,jV,!0),V0=(e,t,n)=>{const r=EV.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},H0=(e,t,n=!1)=>{const r=TV.exec(e);return r?r[1]?t(r[1]):n:!1},RV=e=>e==="position"||e==="percentage",IV=e=>e==="image"||e==="url",MV=e=>e==="length"||e==="size"||e==="bg-size",NV=e=>e==="length",Hde=e=>e==="number",Wde=e=>e==="family-name",jV=e=>e==="shadow",Gde=()=>{const e=vs("color"),t=vs("font"),n=vs("text"),r=vs("font-weight"),i=vs("tracking"),s=vs("leading"),a=vs("breakpoint"),o=vs("container"),l=vs("spacing"),c=vs("radius"),u=vs("shadow"),d=vs("inset-shadow"),h=vs("text-shadow"),p=vs("drop-shadow"),y=vs("blur"),b=vs("perspective"),x=vs("aspect"),w=vs("ease"),_=vs("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],E=()=>[...C(),yn,gn],T=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto","contain","none"],M=()=>[yn,gn,l],N=()=>[ag,"full","auto",...M()],O=()=>[mf,"none","subgrid",yn,gn],B=()=>["auto",{span:["full",mf,yn,gn]},mf,yn,gn],P=()=>[mf,"auto",yn,gn],H=()=>["auto","min","max","fr",yn,gn],F=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Q=()=>["start","end","center","stretch","center-safe","end-safe"],q=()=>["auto",...M()],K=()=>[ag,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...M()],U=()=>[e,yn,gn],re=()=>[...C(),pL,hL,{position:[yn,gn]}],G=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ne=()=>["auto","cover","contain",qde,$de,{size:[yn,gn]}],te=()=>[FR,qb,Hh],se=()=>["","none","full",c,yn,gn],pe=()=>["",Cr,qb,Hh],de=()=>["solid","dashed","dotted","double"],Ne=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Pe=()=>[Cr,FR,pL,hL],Me=()=>["","none",y,yn,gn],Ee=()=>["none",Cr,yn,gn],Ue=()=>["none",Cr,yn,gn],nt=()=>[Cr,yn,gn],He=()=>[ag,"full",...M()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Bu],breakpoint:[Bu],color:[Pde],container:[Bu],"drop-shadow":[Bu],ease:["in","out","in-out"],font:[Bde],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Bu],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Bu],shadow:[Bu],spacing:["px",Cr],text:[Bu],"text-shadow":[Bu],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ag,gn,yn,x]}],container:["container"],columns:[{columns:[Cr,gn,yn,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:E()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:N()}],"inset-x":[{"inset-x":N()}],"inset-y":[{"inset-y":N()}],start:[{start:N()}],end:[{end:N()}],top:[{top:N()}],right:[{right:N()}],bottom:[{bottom:N()}],left:[{left:N()}],visibility:["visible","invisible","collapse"],z:[{z:[mf,"auto",yn,gn]}],basis:[{basis:[ag,"full","auto",o,...M()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Cr,ag,"auto","initial","none",gn]}],grow:[{grow:["",Cr,yn,gn]}],shrink:[{shrink:["",Cr,yn,gn]}],order:[{order:[mf,"first","last","none",yn,gn]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":H()}],"auto-rows":[{"auto-rows":H()}],gap:[{gap:M()}],"gap-x":[{"gap-x":M()}],"gap-y":[{"gap-y":M()}],"justify-content":[{justify:[...F(),"normal"]}],"justify-items":[{"justify-items":[...Q(),"normal"]}],"justify-self":[{"justify-self":["auto",...Q()]}],"align-content":[{content:["normal",...F()]}],"align-items":[{items:[...Q(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Q(),{baseline:["","last"]}]}],"place-content":[{"place-content":F()}],"place-items":[{"place-items":[...Q(),"baseline"]}],"place-self":[{"place-self":["auto",...Q()]}],p:[{p:M()}],px:[{px:M()}],py:[{py:M()}],ps:[{ps:M()}],pe:[{pe:M()}],pt:[{pt:M()}],pr:[{pr:M()}],pb:[{pb:M()}],pl:[{pl:M()}],m:[{m:q()}],mx:[{mx:q()}],my:[{my:q()}],ms:[{ms:q()}],me:[{me:q()}],mt:[{mt:q()}],mr:[{mr:q()}],mb:[{mb:q()}],ml:[{ml:q()}],"space-x":[{"space-x":M()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":M()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[o,"screen",...K()]}],"min-w":[{"min-w":[o,"screen","none",...K()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...K()]}],h:[{h:["screen",...K()]}],"min-h":[{"min-h":["screen","none",...K()]}],"max-h":[{"max-h":["screen",...K()]}],"font-size":[{text:["base",n,qb,Hh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,yn,LR]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",FR,gn]}],"font-family":[{font:[Ude,gn,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[i,yn,gn]}],"line-clamp":[{"line-clamp":[Cr,"none",yn,LR]}],leading:[{leading:[s,...M()]}],"list-image":[{"list-image":["none",yn,gn]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",yn,gn]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:U()}],"text-color":[{text:U()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:[Cr,"from-font","auto",yn,Hh]}],"text-decoration-color":[{decoration:U()}],"underline-offset":[{"underline-offset":[Cr,"auto",yn,gn]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",yn,gn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",yn,gn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:re()}],"bg-repeat":[{bg:G()}],"bg-size":[{bg:ne()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},mf,yn,gn],radial:["",yn,gn],conic:[mf,yn,gn]},Vde,zde]}],"bg-color":[{bg:U()}],"gradient-from-pos":[{from:te()}],"gradient-via-pos":[{via:te()}],"gradient-to-pos":[{to:te()}],"gradient-from":[{from:U()}],"gradient-via":[{via:U()}],"gradient-to":[{to:U()}],rounded:[{rounded:se()}],"rounded-s":[{"rounded-s":se()}],"rounded-e":[{"rounded-e":se()}],"rounded-t":[{"rounded-t":se()}],"rounded-r":[{"rounded-r":se()}],"rounded-b":[{"rounded-b":se()}],"rounded-l":[{"rounded-l":se()}],"rounded-ss":[{"rounded-ss":se()}],"rounded-se":[{"rounded-se":se()}],"rounded-ee":[{"rounded-ee":se()}],"rounded-es":[{"rounded-es":se()}],"rounded-tl":[{"rounded-tl":se()}],"rounded-tr":[{"rounded-tr":se()}],"rounded-br":[{"rounded-br":se()}],"rounded-bl":[{"rounded-bl":se()}],"border-w":[{border:pe()}],"border-w-x":[{"border-x":pe()}],"border-w-y":[{"border-y":pe()}],"border-w-s":[{"border-s":pe()}],"border-w-e":[{"border-e":pe()}],"border-w-t":[{"border-t":pe()}],"border-w-r":[{"border-r":pe()}],"border-w-b":[{"border-b":pe()}],"border-w-l":[{"border-l":pe()}],"divide-x":[{"divide-x":pe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":pe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...de(),"hidden","none"]}],"divide-style":[{divide:[...de(),"hidden","none"]}],"border-color":[{border:U()}],"border-color-x":[{"border-x":U()}],"border-color-y":[{"border-y":U()}],"border-color-s":[{"border-s":U()}],"border-color-e":[{"border-e":U()}],"border-color-t":[{"border-t":U()}],"border-color-r":[{"border-r":U()}],"border-color-b":[{"border-b":U()}],"border-color-l":[{"border-l":U()}],"divide-color":[{divide:U()}],"outline-style":[{outline:[...de(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Cr,yn,gn]}],"outline-w":[{outline:["",Cr,qb,Hh]}],"outline-color":[{outline:U()}],shadow:[{shadow:["","none",u,K_,G_]}],"shadow-color":[{shadow:U()}],"inset-shadow":[{"inset-shadow":["none",d,K_,G_]}],"inset-shadow-color":[{"inset-shadow":U()}],"ring-w":[{ring:pe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:U()}],"ring-offset-w":[{"ring-offset":[Cr,Hh]}],"ring-offset-color":[{"ring-offset":U()}],"inset-ring-w":[{"inset-ring":pe()}],"inset-ring-color":[{"inset-ring":U()}],"text-shadow":[{"text-shadow":["none",h,K_,G_]}],"text-shadow-color":[{"text-shadow":U()}],opacity:[{opacity:[Cr,yn,gn]}],"mix-blend":[{"mix-blend":[...Ne(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Ne()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Cr]}],"mask-image-linear-from-pos":[{"mask-linear-from":Pe()}],"mask-image-linear-to-pos":[{"mask-linear-to":Pe()}],"mask-image-linear-from-color":[{"mask-linear-from":U()}],"mask-image-linear-to-color":[{"mask-linear-to":U()}],"mask-image-t-from-pos":[{"mask-t-from":Pe()}],"mask-image-t-to-pos":[{"mask-t-to":Pe()}],"mask-image-t-from-color":[{"mask-t-from":U()}],"mask-image-t-to-color":[{"mask-t-to":U()}],"mask-image-r-from-pos":[{"mask-r-from":Pe()}],"mask-image-r-to-pos":[{"mask-r-to":Pe()}],"mask-image-r-from-color":[{"mask-r-from":U()}],"mask-image-r-to-color":[{"mask-r-to":U()}],"mask-image-b-from-pos":[{"mask-b-from":Pe()}],"mask-image-b-to-pos":[{"mask-b-to":Pe()}],"mask-image-b-from-color":[{"mask-b-from":U()}],"mask-image-b-to-color":[{"mask-b-to":U()}],"mask-image-l-from-pos":[{"mask-l-from":Pe()}],"mask-image-l-to-pos":[{"mask-l-to":Pe()}],"mask-image-l-from-color":[{"mask-l-from":U()}],"mask-image-l-to-color":[{"mask-l-to":U()}],"mask-image-x-from-pos":[{"mask-x-from":Pe()}],"mask-image-x-to-pos":[{"mask-x-to":Pe()}],"mask-image-x-from-color":[{"mask-x-from":U()}],"mask-image-x-to-color":[{"mask-x-to":U()}],"mask-image-y-from-pos":[{"mask-y-from":Pe()}],"mask-image-y-to-pos":[{"mask-y-to":Pe()}],"mask-image-y-from-color":[{"mask-y-from":U()}],"mask-image-y-to-color":[{"mask-y-to":U()}],"mask-image-radial":[{"mask-radial":[yn,gn]}],"mask-image-radial-from-pos":[{"mask-radial-from":Pe()}],"mask-image-radial-to-pos":[{"mask-radial-to":Pe()}],"mask-image-radial-from-color":[{"mask-radial-from":U()}],"mask-image-radial-to-color":[{"mask-radial-to":U()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":C()}],"mask-image-conic-pos":[{"mask-conic":[Cr]}],"mask-image-conic-from-pos":[{"mask-conic-from":Pe()}],"mask-image-conic-to-pos":[{"mask-conic-to":Pe()}],"mask-image-conic-from-color":[{"mask-conic-from":U()}],"mask-image-conic-to-color":[{"mask-conic-to":U()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:re()}],"mask-repeat":[{mask:G()}],"mask-size":[{mask:ne()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",yn,gn]}],filter:[{filter:["","none",yn,gn]}],blur:[{blur:Me()}],brightness:[{brightness:[Cr,yn,gn]}],contrast:[{contrast:[Cr,yn,gn]}],"drop-shadow":[{"drop-shadow":["","none",p,K_,G_]}],"drop-shadow-color":[{"drop-shadow":U()}],grayscale:[{grayscale:["",Cr,yn,gn]}],"hue-rotate":[{"hue-rotate":[Cr,yn,gn]}],invert:[{invert:["",Cr,yn,gn]}],saturate:[{saturate:[Cr,yn,gn]}],sepia:[{sepia:["",Cr,yn,gn]}],"backdrop-filter":[{"backdrop-filter":["","none",yn,gn]}],"backdrop-blur":[{"backdrop-blur":Me()}],"backdrop-brightness":[{"backdrop-brightness":[Cr,yn,gn]}],"backdrop-contrast":[{"backdrop-contrast":[Cr,yn,gn]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Cr,yn,gn]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Cr,yn,gn]}],"backdrop-invert":[{"backdrop-invert":["",Cr,yn,gn]}],"backdrop-opacity":[{"backdrop-opacity":[Cr,yn,gn]}],"backdrop-saturate":[{"backdrop-saturate":[Cr,yn,gn]}],"backdrop-sepia":[{"backdrop-sepia":["",Cr,yn,gn]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":M()}],"border-spacing-x":[{"border-spacing-x":M()}],"border-spacing-y":[{"border-spacing-y":M()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",yn,gn]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Cr,"initial",yn,gn]}],ease:[{ease:["linear","initial",w,yn,gn]}],delay:[{delay:[Cr,yn,gn]}],animate:[{animate:["none",_,yn,gn]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,yn,gn]}],"perspective-origin":[{"perspective-origin":E()}],rotate:[{rotate:Ee()}],"rotate-x":[{"rotate-x":Ee()}],"rotate-y":[{"rotate-y":Ee()}],"rotate-z":[{"rotate-z":Ee()}],scale:[{scale:Ue()}],"scale-x":[{"scale-x":Ue()}],"scale-y":[{"scale-y":Ue()}],"scale-z":[{"scale-z":Ue()}],"scale-3d":["scale-3d"],skew:[{skew:nt()}],"skew-x":[{"skew-x":nt()}],"skew-y":[{"skew-y":nt()}],transform:[{transform:[yn,gn,"","none","gpu","cpu"]}],"transform-origin":[{origin:E()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:He()}],"translate-x":[{"translate-x":He()}],"translate-y":[{"translate-y":He()}],"translate-z":[{"translate-z":He()}],"translate-none":["translate-none"],accent:[{accent:U()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:U()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",yn,gn]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",yn,gn]}],fill:[{fill:["none",...U()]}],"stroke-w":[{stroke:[Cr,qb,Hh,LR]}],stroke:[{stroke:["none",...U()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Kde=Ade(Gde);function dt(...e){return Kde(SV(e))}const Yde=Z4("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function Et({className:e,variant:t,size:n,asChild:r=!1,...i}){const s=r?xV:"button";return m.jsx(s,{"data-slot":"button",className:dt(Yde({variant:t,size:n,className:e})),...i})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zde=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Xde=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),mL=e=>{const t=Xde(e);return t.charAt(0).toUpperCase()+t.slice(1)},OV=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Jde={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qde=A.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>A.createElement("svg",{ref:l,...Jde,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:OV("lucide",i),...o},[...a.map(([c,u])=>A.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=(e,t)=>{const n=A.forwardRef(({className:r,...i},s)=>A.createElement(Qde,{ref:s,iconNode:t,className:OV(`lucide-${Zde(mL(e))}`,`lucide-${e}`,r),...i}));return n.displayName=mL(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const efe=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],PV=zt("archive",efe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tfe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],DV=zt("arrow-down",tfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nfe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],rfe=zt("arrow-right",nfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ife=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],sfe=zt("arrow-up",ife);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const afe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],ofe=zt("ban",afe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lfe=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],FV=zt("bot",lfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cfe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],sh=zt("brain-circuit",cfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ufe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],gL=zt("brain",ufe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dfe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],za=zt("check",dfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ffe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],cu=zt("chevron-down",ffe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hfe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],LV=zt("chevron-right",hfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pfe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ah=zt("chevron-up",pfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mfe=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Pk=zt("chevrons-up-down",mfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gfe=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],yfe=zt("chevrons-up",gfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bfe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],nc=zt("circle-alert",bfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vfe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Dk=zt("circle-check",vfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xfe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],wfe=zt("circle-stop",xfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _fe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Sfe=zt("circle",_fe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cfe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],Fk=zt("clipboard",Cfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kfe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Efe=zt("clock",kfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tfe=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],BV=zt("cloud-upload",Tfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Afe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],$V=zt("code",Afe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rfe=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],Ife=zt("cog",Rfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mfe=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],Nfe=zt("coins",Mfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jfe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Ofe=zt("copy",jfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pfe=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Dfe=zt("dollar-sign",Pfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ffe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Gc=zt("download",Ffe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lfe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Bfe=zt("ellipsis-vertical",Lfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $fe=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],zfe=zt("file-archive",$fe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ufe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],qfe=zt("file-down",Ufe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vfe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],Hfe=zt("file-json",Vfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wfe=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],Gfe=zt("file-question",Wfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kfe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Yfe=zt("file-text",Kfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zfe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Xfe=zt("file-up",Zfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jfe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],zV=zt("file",Jfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qfe=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],UV=zt("folder-git",Qfe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ehe=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],qV=zt("folder-plus",ehe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const the=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],yL=zt("folder-tree",the);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nhe=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],rhe=zt("folder-up",nhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ihe=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],jf=zt("folder",ihe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const she=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],J4=zt("funnel",she);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ahe=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],rc=zt("git-branch",ahe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ohe=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],VV=zt("git-commit-horizontal",ohe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lhe=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],HV=zt("git-merge",lhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const che=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],Q4=zt("git-pull-request",che);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uhe=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],dhe=zt("github",uhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fhe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],bL=zt("globe",fhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hhe=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],phe=zt("grip-vertical",hhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mhe=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],eO=zt("hard-drive",mhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ghe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],yhe=zt("history",ghe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bhe=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],vhe=zt("house",bhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xhe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Tp=zt("image",xhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const whe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],tO=zt("info",whe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _he=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Zv=zt("key",_he);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const She=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],WV=zt("land-plot",She);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Che=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],khe=zt("list-restart",Che);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ehe=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Hn=zt("loader-circle",Ehe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const The=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],Ahe=zt("menu",The);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rhe=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],Ihe=zt("message-square-plus",Rhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mhe=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],vL=zt("message-square-text",Mhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nhe=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],f3=zt("message-square",Nhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jhe=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Ohe=zt("music",jhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Phe=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],GV=zt("notebook-pen",Phe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dhe=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],T2=zt("palette",Dhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fhe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],Lhe=zt("panel-left-close",Fhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bhe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],$he=zt("panel-right-close",Bhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zhe=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],nO=zt("paperclip",zhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uhe=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],qhe=zt("pause",Uhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vhe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Tw=zt("pen",Vhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hhe=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],Whe=zt("play",Hhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ghe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],W0=zt("plus",Ghe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Khe=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],xL=zt("puzzle",Khe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yhe=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ap=zt("refresh-cw",Yhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zhe=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Xhe=zt("rocket",Zhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jhe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],rO=zt("rotate-ccw",Jhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qhe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oh=zt("save",Qhe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const epe=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],va=zt("search",epe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tpe=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],npe=zt("send-horizontal",tpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rpe=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],A2=zt("server",rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ipe=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],h3=zt("settings",ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const spe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],wL=zt("shield-alert",spe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ape=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],ope=zt("sliders-horizontal",ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],cpe=zt("smile",lpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const upe=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],KV=zt("sparkles",upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dpe=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],_L=zt("sparkle",dpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fpe=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],KS=zt("square-pen",fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hpe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],ppe=zt("square",hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mpe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],gpe=zt("star",mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ype=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],p3=zt("tags",ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bpe=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],vpe=zt("text",bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xpe=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Fo=zt("trash-2",xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wpe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],iO=zt("triangle-alert",wpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _pe=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],YV=zt("upload",_pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Spe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Cpe=zt("user",Spe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kpe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],SL=zt("users",kpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Epe=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],Tpe=zt("video",Epe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ape=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Rp=zt("wrench",Ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rpe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],po=zt("x",Rpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ipe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Mpe=zt("zap",Ipe),CL=({controls:e,area:t,className:n})=>{const r=e.filter(i=>t==="trigger"?!!i.triggerRenderer:!!i.renderer);return r.length===0?null:m.jsx("div",{className:dt(n),children:r.map(i=>{var a,o;const s=t==="trigger"?(a=i.triggerRenderer)==null?void 0:a.call(i):(o=i.renderer)==null?void 0:o.call(i);return s?m.jsx(ut.Fragment,{children:s},i.id):null})})},kL=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(p=>p(t,h))}},i=()=>t,o={setState:r,getState:i,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,i,o);return o},Npe=e=>e?kL(e):kL,jpe=e=>e;function Ope(e,t=jpe){const n=ut.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return ut.useDebugValue(n),n}const EL=e=>{const t=Npe(e),n=r=>Ope(t,r);return Object.assign(n,t),n},_l=e=>e?EL(e):EL;var ZV=Symbol.for("immer-nothing"),TL=Symbol.for("immer-draftable"),Qr=Symbol.for("immer-state");function ml(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var a0=Object.getPrototypeOf;function o0(e){return!!e&&!!e[Qr]}function ud(e){var t;return e?XV(e)||Array.isArray(e)||!!e[TL]||!!((t=e.constructor)!=null&&t[TL])||Bk(e)||$k(e):!1}var Ppe=Object.prototype.constructor.toString();function XV(e){if(!e||typeof e!="object")return!1;const t=a0(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Ppe}function Xv(e,t){Lk(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function Lk(e){const t=e[Qr];return t?t.type_:Array.isArray(e)?1:Bk(e)?2:$k(e)?3:0}function m3(e,t){return Lk(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function JV(e,t,n){const r=Lk(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function Dpe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Bk(e){return e instanceof Map}function $k(e){return e instanceof Set}function Ps(e){return e.copy_||e.base_}function g3(e,t){if(Bk(e))return new Map(e);if($k(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=XV(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[Qr];let i=Reflect.ownKeys(r);for(let s=0;s<i.length;s++){const a=i[s],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(a0(e),r)}else{const r=a0(e);if(r!==null&&n)return{...e};const i=Object.create(r);return Object.assign(i,e)}}function sO(e,t=!1){return zk(e)||o0(e)||!ud(e)||(Lk(e)>1&&(e.set=e.add=e.clear=e.delete=Fpe),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>sO(r,!0))),e}function Fpe(){ml(2)}function zk(e){return Object.isFrozen(e)}var y3={};function Ip(e){const t=y3[e];return t||ml(0,e),t}function Lpe(e,t){y3[e]||(y3[e]=t)}var Jv;function R2(){return Jv}function Bpe(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function AL(e,t){t&&(Ip("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function b3(e){v3(e),e.drafts_.forEach($pe),e.drafts_=null}function v3(e){e===Jv&&(Jv=e.parent_)}function RL(e){return Jv=Bpe(Jv,e)}function $pe(e){const t=e[Qr];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function IL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Qr].modified_&&(b3(t),ml(4)),ud(e)&&(e=I2(t,e),t.parent_||M2(t,e)),t.patches_&&Ip("Patches").generateReplacementPatches_(n[Qr].base_,e,t.patches_,t.inversePatches_)):e=I2(t,n,[]),b3(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==ZV?e:void 0}function I2(e,t,n){if(zk(t))return t;const r=t[Qr];if(!r)return Xv(t,(i,s)=>ML(e,r,t,i,s,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return M2(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const i=r.copy_;let s=i,a=!1;r.type_===3&&(s=new Set(i),i.clear(),a=!0),Xv(s,(o,l)=>ML(e,r,i,o,l,n,a)),M2(e,i,!1),n&&e.patches_&&Ip("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function ML(e,t,n,r,i,s,a){if(o0(i)){const o=s&&t&&t.type_!==3&&!m3(t.assigned_,r)?s.concat(r):void 0,l=I2(e,i,o);if(JV(n,r,l),o0(l))e.canAutoFreeze_=!1;else return}else a&&n.add(i);if(ud(i)&&!zk(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;I2(e,i),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&M2(e,i)}}function M2(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&sO(t,n)}function zpe(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:R2(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=r,s=aO;n&&(i=[r],s=Qv);const{revoke:a,proxy:o}=Proxy.revocable(i,s);return r.draft_=o,r.revoke_=a,o}var aO={get(e,t){if(t===Qr)return e;const n=Ps(e);if(!m3(n,t))return Upe(e,n,t);const r=n[t];return e.finalized_||!ud(r)?r:r===BR(e.base_,t)?($R(e),e.copy_[t]=ex(r,e)):r},has(e,t){return t in Ps(e)},ownKeys(e){return Reflect.ownKeys(Ps(e))},set(e,t,n){const r=QV(Ps(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const i=BR(Ps(e),t),s=i==null?void 0:i[Qr];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(Dpe(n,i)&&(n!==void 0||m3(e.base_,t)))return!0;$R(e),Ku(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return BR(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,$R(e),Ku(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Ps(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){ml(11)},getPrototypeOf(e){return a0(e.base_)},setPrototypeOf(){ml(12)}},Qv={};Xv(aO,(e,t)=>{Qv[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Qv.deleteProperty=function(e,t){return Qv.set.call(this,e,t,void 0)};Qv.set=function(e,t,n){return aO.set.call(this,e[0],t,n,e[0])};function BR(e,t){const n=e[Qr];return(n?Ps(n):e)[t]}function Upe(e,t,n){var i;const r=QV(t,n);return r?"value"in r?r.value:(i=r.get)==null?void 0:i.call(e.draft_):void 0}function QV(e,t){if(!(t in e))return;let n=a0(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=a0(n)}}function Ku(e){e.modified_||(e.modified_=!0,e.parent_&&Ku(e.parent_))}function $R(e){e.copy_||(e.copy_=g3(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var qpe=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const s=n;n=t;const a=this;return function(l=s,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&ml(6),r!==void 0&&typeof r!="function"&&ml(7);let i;if(ud(t)){const s=RL(this),a=ex(t,void 0);let o=!0;try{i=n(a),o=!1}finally{o?b3(s):v3(s)}return AL(s,r),IL(i,s)}else if(!t||typeof t!="object"){if(i=n(t),i===void 0&&(i=t),i===ZV&&(i=void 0),this.autoFreeze_&&sO(i,!0),r){const s=[],a=[];Ip("Patches").generateReplacementPatches_(t,i,s,a),r(s,a)}return i}else ml(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,i;return[this.produce(t,n,(a,o)=>{r=a,i=o}),r,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){ud(e)||ml(8),o0(e)&&(e=Vpe(e));const t=RL(this),n=ex(e,void 0);return n[Qr].isManual_=!0,v3(t),n}finishDraft(e,t){const n=e&&e[Qr];(!n||!n.isManual_)&&ml(9);const{scope_:r}=n;return AL(r,t),IL(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const i=t[n];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}n>-1&&(t=t.slice(n+1));const r=Ip("Patches").applyPatches_;return o0(e)?r(e,t):this.produce(e,i=>r(i,t))}};function ex(e,t){const n=Bk(e)?Ip("MapSet").proxyMap_(e,t):$k(e)?Ip("MapSet").proxySet_(e,t):zpe(e,t);return(t?t.scope_:R2()).drafts_.push(n),n}function Vpe(e){return o0(e)||ml(10,e),eH(e)}function eH(e){if(!ud(e)||zk(e))return e;const t=e[Qr];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=g3(e,t.scope_.immer_.useStrictShallowCopy_)}else n=g3(e,!0);return Xv(n,(r,i)=>{JV(n,r,eH(i))}),t&&(t.finalized_=!1),n}function Hpe(){class e extends Map{constructor(l,c){super(),this[Qr]={type_:2,parent_:c,scope_:c?c.scope_:R2(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return Ps(this[Qr]).size}has(l){return Ps(this[Qr]).has(l)}set(l,c){const u=this[Qr];return a(u),(!Ps(u).has(l)||Ps(u).get(l)!==c)&&(n(u),Ku(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[Qr];return a(c),n(c),Ku(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[Qr];a(l),Ps(l).size&&(n(l),Ku(l),l.assigned_=new Map,Xv(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[Qr];Ps(u).forEach((d,h,p)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[Qr];a(c);const u=Ps(c).get(l);if(c.finalized_||!ud(u)||u!==c.base_.get(l))return u;const d=ex(u,c);return n(c),c.copy_.set(l,d),d}keys(){return Ps(this[Qr]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[Qr]={type_:3,parent_:c,scope_:c?c.scope_:R2(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return Ps(this[Qr]).size}has(l){const c=this[Qr];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[Qr];return a(c),this.has(l)||(s(c),Ku(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[Qr];return a(c),s(c),Ku(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[Qr];a(l),Ps(l).size&&(s(l),Ku(l),l.copy_.clear())}values(){const l=this[Qr];return a(l),s(l),l.copy_.values()}entries(){const l=this[Qr];return a(l),s(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function i(o,l){return new r(o,l)}function s(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(ud(l)){const c=ex(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&ml(3,JSON.stringify(Ps(o)))}Lpe("MapSet",{proxyMap_:t,proxySet_:i})}var zo=new qpe,Wpe=zo.produce;zo.produceWithPatches.bind(zo);zo.setAutoFreeze.bind(zo);zo.setUseStrictShallowCopy.bind(zo);zo.applyPatches.bind(zo);zo.createDraft.bind(zo);zo.finishDraft.bind(zo);const Gpe=e=>(t,n,r)=>(r.setState=(i,s,...a)=>{const o=typeof i=="function"?Wpe(i):i;return t(o,s,...a)},e(r.setState,n,r)),Sl=Gpe;function Kpe(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(i){i(n)}),(r=e.get("*"))&&r.slice().map(function(i){i(t,n)})}}}const Be=Kpe(),Nr={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},Ho=_l(Sl((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Be.emit(Nr.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Be.emit(Nr.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Be.emit(Nr.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Be.emit(Nr.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Be.emit(Nr.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Be.emit(Nr.canvasControlsChanged,{controls:t().canvasControls})},registerMiddleware:(n,r,i,s=0)=>{const a={modId:r,callback:i,order:s};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Be.emit(Nr.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,i)},unregisterMiddleware:(n,r,i)=>{e(s=>{var a;s.middlewareRegistry[n]?(s.middlewareRegistry[n]=s.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===i)),((a=s.middlewareRegistry[n])==null?void 0:a.length)===0&&delete s.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Be.emit(Nr.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((i,s)=>(i.order??0)-(s.order??0)))},registerTool:(n,r,i,s)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:i,implementation:s,modId:n}}),Be.emit(Nr.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Be.emit(Nr.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(i=>{i.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),i.modalProviders[n]=r}),Be.emit(Nr.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Be.emit(Nr.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:Nr.registerPromptControlRequest,handler:i=>{r.registerPromptControl(i.control)},storeId:n},{eventName:Nr.unregisterPromptControlRequest,handler:i=>{r.unregisterPromptControl(i.id)},storeId:n},{eventName:Nr.registerChatControlRequest,handler:i=>{r.registerChatControl(i.control)},storeId:n},{eventName:Nr.unregisterChatControlRequest,handler:i=>{r.unregisterChatControl(i.id)},storeId:n},{eventName:Nr.registerCanvasControlRequest,handler:i=>{r.registerCanvasControl(i.control)},storeId:n},{eventName:Nr.unregisterCanvasControlRequest,handler:i=>{r.unregisterCanvasControl(i.id)},storeId:n},{eventName:Nr.registerMiddlewareRequest,handler:i=>{r.registerMiddleware(i.hookName,i.modId,i.callback,i.order)},storeId:n},{eventName:Nr.unregisterMiddlewareRequest,handler:i=>{r.unregisterMiddleware(i.hookName,i.modId,i.callback)},storeId:n},{eventName:Nr.registerToolRequest,handler:i=>{r.registerTool(i.modId,i.toolName,i.definition,i.implementation)},storeId:n},{eventName:Nr.unregisterToolRequest,handler:i=>{r.unregisterTool(i.toolName)},storeId:n},{eventName:Nr.registerModalProviderRequest,handler:i=>{r.registerModalProvider(i.modalId,i.provider)},storeId:n},{eventName:Nr.unregisterModalProviderRequest,handler:i=>{r.unregisterModalProvider(i.modalId)},storeId:n}]}})));var YS={exports:{}},Ype=YS.exports,NL;function Zpe(){return NL||(NL=1,function(e,t){(function(n,r){e.exports=r()})(Ype,function(){var n=function(I,$){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ee,oe){ee.__proto__=oe}||function(ee,oe){for(var he in oe)Object.prototype.hasOwnProperty.call(oe,he)&&(ee[he]=oe[he])})(I,$)},r=function(){return(r=Object.assign||function(I){for(var $,ee=1,oe=arguments.length;ee<oe;ee++)for(var he in $=arguments[ee])Object.prototype.hasOwnProperty.call($,he)&&(I[he]=$[he]);return I}).apply(this,arguments)};function i(I,$,ee){for(var oe,he=0,Ce=$.length;he<Ce;he++)!oe&&he in $||((oe=oe||Array.prototype.slice.call($,0,he))[he]=$[he]);return I.concat(oe||Array.prototype.slice.call($))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:cp,a=Object.keys,o=Array.isArray;function l(I,$){return typeof $!="object"||a($).forEach(function(ee){I[ee]=$[ee]}),I}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(I,$){return u.call(I,$)}function h(I,$){typeof $=="function"&&($=$(c(I))),(typeof Reflect>"u"?a:Reflect.ownKeys)($).forEach(function(ee){y(I,ee,$[ee])})}var p=Object.defineProperty;function y(I,$,ee,oe){p(I,$,l(ee&&d(ee,"get")&&typeof ee.get=="function"?{get:ee.get,set:ee.set,configurable:!0}:{value:ee,configurable:!0,writable:!0},oe))}function b(I){return{from:function($){return I.prototype=Object.create($.prototype),y(I.prototype,"constructor",I),{extend:h.bind(null,I.prototype)}}}}var x=Object.getOwnPropertyDescriptor,w=[].slice;function _(I,$,ee){return w.call(I,$,ee)}function S(I,$){return $(I)}function C(I){if(!I)throw new Error("Assertion Failed")}function E(I){s.setImmediate?setImmediate(I):setTimeout(I,0)}function T(I,$){if(typeof $=="string"&&d(I,$))return I[$];if(!$)return I;if(typeof $!="string"){for(var ee=[],oe=0,he=$.length;oe<he;++oe){var Ce=T(I,$[oe]);ee.push(Ce)}return ee}var Le=$.indexOf(".");if(Le!==-1){var Ve=I[$.substr(0,Le)];return Ve==null?void 0:T(Ve,$.substr(Le+1))}}function R(I,$,ee){if(I&&$!==void 0&&!("isFrozen"in Object&&Object.isFrozen(I)))if(typeof $!="string"&&"length"in $){C(typeof ee!="string"&&"length"in ee);for(var oe=0,he=$.length;oe<he;++oe)R(I,$[oe],ee[oe])}else{var Ce,Le,Ve=$.indexOf(".");Ve!==-1?(Ce=$.substr(0,Ve),(Le=$.substr(Ve+1))===""?ee===void 0?o(I)&&!isNaN(parseInt(Ce))?I.splice(Ce,1):delete I[Ce]:I[Ce]=ee:R(Ve=!(Ve=I[Ce])||!d(I,Ce)?I[Ce]={}:Ve,Le,ee)):ee===void 0?o(I)&&!isNaN(parseInt($))?I.splice($,1):delete I[$]:I[$]=ee}}function M(I){var $,ee={};for($ in I)d(I,$)&&(ee[$]=I[$]);return ee}var N=[].concat;function O(I){return N.apply([],I)}var jt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(O([8,16,32,64].map(function(I){return["Int","Uint","Float"].map(function($){return $+I+"Array"})}))).filter(function(I){return s[I]}),B=new Set(jt.map(function(I){return s[I]})),P=null;function H(I){return P=new WeakMap,I=function $(ee){if(!ee||typeof ee!="object")return ee;var oe=P.get(ee);if(oe)return oe;if(o(ee)){oe=[],P.set(ee,oe);for(var he=0,Ce=ee.length;he<Ce;++he)oe.push($(ee[he]))}else if(B.has(ee.constructor))oe=ee;else{var Le,Ve=c(ee);for(Le in oe=Ve===Object.prototype?{}:Object.create(Ve),P.set(ee,oe),ee)d(ee,Le)&&(oe[Le]=$(ee[Le]))}return oe}(I),P=null,I}var F={}.toString;function Q(I){return F.call(I).slice(8,-1)}var q=typeof Symbol<"u"?Symbol.iterator:"@@iterator",K=typeof q=="symbol"?function(I){var $;return I!=null&&($=I[q])&&$.apply(I)}:function(){return null};function U(I,$){return $=I.indexOf($),0<=$&&I.splice($,1),0<=$}var re={};function G(I){var $,ee,oe,he;if(arguments.length===1){if(o(I))return I.slice();if(this===re&&typeof I=="string")return[I];if(he=K(I)){for(ee=[];!(oe=he.next()).done;)ee.push(oe.value);return ee}if(I==null)return[I];if(typeof($=I.length)!="number")return[I];for(ee=new Array($);$--;)ee[$]=I[$];return ee}for($=arguments.length,ee=new Array($);$--;)ee[$]=arguments[$];return ee}var ne=typeof Symbol<"u"?function(I){return I[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ft=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ia=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(ft),te={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function se(I,$){this.name=I,this.message=$}function pe(I,$){return I+". Errors: "+Object.keys($).map(function(ee){return $[ee].toString()}).filter(function(ee,oe,he){return he.indexOf(ee)===oe}).join(`
`)}function de(I,$,ee,oe){this.failures=$,this.failedKeys=oe,this.successCount=ee,this.message=pe(I,$)}function Ne(I,$){this.name="BulkError",this.failures=Object.keys($).map(function(ee){return $[ee]}),this.failuresByPos=$,this.message=pe(I,this.failures)}b(se).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(de).from(se),b(Ne).from(se);var Pe=Ia.reduce(function(I,$){return I[$]=$+"Error",I},{}),Me=se,Ee=Ia.reduce(function(I,$){var ee=$+"Error";function oe(he,Ce){this.name=ee,he?typeof he=="string"?(this.message="".concat(he).concat(Ce?`
 `+Ce:""),this.inner=Ce||null):typeof he=="object"&&(this.message="".concat(he.name," ").concat(he.message),this.inner=he):(this.message=te[$]||ee,this.inner=null)}return b(oe).from(Me),I[$]=oe,I},{});Ee.Syntax=SyntaxError,Ee.Type=TypeError,Ee.Range=RangeError;var Ue=ft.reduce(function(I,$){return I[$+"Error"]=Ee[$],I},{}),nt=Ia.reduce(function(I,$){return["Syntax","Type","Range"].indexOf($)===-1&&(I[$+"Error"]=Ee[$]),I},{});function He(){}function je(I){return I}function Y(I,$){return I==null||I===je?$:function(ee){return $(I(ee))}}function be(I,$){return function(){I.apply(this,arguments),$.apply(this,arguments)}}function Re(I,$){return I===He?$:function(){var ee=I.apply(this,arguments);ee!==void 0&&(arguments[0]=ee);var oe=this.onsuccess,he=this.onerror;this.onsuccess=null,this.onerror=null;var Ce=$.apply(this,arguments);return oe&&(this.onsuccess=this.onsuccess?be(oe,this.onsuccess):oe),he&&(this.onerror=this.onerror?be(he,this.onerror):he),Ce!==void 0?Ce:ee}}function ce(I,$){return I===He?$:function(){I.apply(this,arguments);var ee=this.onsuccess,oe=this.onerror;this.onsuccess=this.onerror=null,$.apply(this,arguments),ee&&(this.onsuccess=this.onsuccess?be(ee,this.onsuccess):ee),oe&&(this.onerror=this.onerror?be(oe,this.onerror):oe)}}function le(I,$){return I===He?$:function(ee){var oe=I.apply(this,arguments);l(ee,oe);var he=this.onsuccess,Ce=this.onerror;return this.onsuccess=null,this.onerror=null,ee=$.apply(this,arguments),he&&(this.onsuccess=this.onsuccess?be(he,this.onsuccess):he),Ce&&(this.onerror=this.onerror?be(Ce,this.onerror):Ce),oe===void 0?ee===void 0?void 0:ee:l(oe,ee)}}function ae(I,$){return I===He?$:function(){return $.apply(this,arguments)!==!1&&I.apply(this,arguments)}}function Te(I,$){return I===He?$:function(){var ee=I.apply(this,arguments);if(ee&&typeof ee.then=="function"){for(var oe=this,he=arguments.length,Ce=new Array(he);he--;)Ce[he]=arguments[he];return ee.then(function(){return $.apply(oe,Ce)})}return $.apply(this,arguments)}}nt.ModifyError=de,nt.DexieError=se,nt.BulkError=Ne;var $e=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ke(I){$e=I}var ot={},At=100,jt=typeof Promise>"u"?[]:function(){var I=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[I,c(I),I];var $=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[$,c($),I]}(),ft=jt[0],Ia=jt[1],jt=jt[2],Ia=Ia&&Ia.then,Bt=ft&&ft.constructor,Ft=!!jt,tn=function(I,$){fe.push([I,$]),D&&(queueMicrotask(ge),D=!1)},xe=!0,D=!0,X=[],me=[],De=je,we={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:He,pgp:!1,env:{},finalize:He},Ie=we,fe=[],yt=0,_t=[];function z(I){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var $=this._PSD=Ie;if(typeof I!="function"){if(I!==ot)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ve(this,this._value))}this._state=null,this._value=null,++$.ref,function ee(oe,he){try{he(function(Ce){if(oe._state===null){if(Ce===oe)throw new TypeError("A promise cannot be resolved with itself.");var Le=oe._lib&&Z();Ce&&typeof Ce.then=="function"?ee(oe,function(Ve,Je){Ce instanceof z?Ce._then(Ve,Je):Ce.then(Ve,Je)}):(oe._state=!0,oe._value=Ce,Se(oe)),Le&&W()}},ve.bind(null,oe))}catch(Ce){ve(oe,Ce)}}(this,I)}var qe={get:function(){var I=Ie,$=Yt;function ee(oe,he){var Ce=this,Le=!I.global&&(I!==Ie||$!==Yt),Ve=Le&&!xr(),Je=new z(function(et,at){ze(Ce,new rt($t(oe,I,Le,Ve),$t(he,I,Le,Ve),et,at,I))});return this._consoleTask&&(Je._consoleTask=this._consoleTask),Je}return ee.prototype=ot,ee},set:function(I){y(this,"then",I&&I.prototype===ot?qe:{get:function(){return I},set:qe.set})}};function rt(I,$,ee,oe,he){this.onFulfilled=typeof I=="function"?I:null,this.onRejected=typeof $=="function"?$:null,this.resolve=ee,this.reject=oe,this.psd=he}function ve(I,$){var ee,oe;me.push($),I._state===null&&(ee=I._lib&&Z(),$=De($),I._state=!1,I._value=$,oe=I,X.some(function(he){return he._value===oe._value})||X.push(oe),Se(I),ee&&W())}function Se(I){var $=I._listeners;I._listeners=[];for(var ee=0,oe=$.length;ee<oe;++ee)ze(I,$[ee]);var he=I._PSD;--he.ref||he.finalize(),yt===0&&(++yt,tn(function(){--yt==0&&J()},[]))}function ze(I,$){if(I._state!==null){var ee=I._state?$.onFulfilled:$.onRejected;if(ee===null)return(I._state?$.resolve:$.reject)(I._value);++$.psd.ref,++yt,tn(Tt,[ee,I,$])}else I._listeners.push($)}function Tt(I,$,ee){try{var oe,he=$._value;!$._state&&me.length&&(me=[]),oe=$e&&$._consoleTask?$._consoleTask.run(function(){return I(he)}):I(he),$._state||me.indexOf(he)!==-1||function(Ce){for(var Le=X.length;Le;)if(X[--Le]._value===Ce._value)return X.splice(Le,1)}($),ee.resolve(oe)}catch(Ce){ee.reject(Ce)}finally{--yt==0&&J(),--ee.psd.ref||ee.psd.finalize()}}function ge(){Ze(we,function(){Z()&&W()})}function Z(){var I=xe;return D=xe=!1,I}function W(){var I,$,ee;do for(;0<fe.length;)for(I=fe,fe=[],ee=I.length,$=0;$<ee;++$){var oe=I[$];oe[0].apply(null,oe[1])}while(0<fe.length);D=xe=!0}function J(){var I=X;X=[],I.forEach(function(oe){oe._PSD.onunhandled.call(null,oe._value,oe)});for(var $=_t.slice(0),ee=$.length;ee;)$[--ee]()}function ye(I){return new z(ot,!1,I)}function Oe(I,$){var ee=Ie;return function(){var oe=Z(),he=Ie;try{return pr(ee,!0),I.apply(this,arguments)}catch(Ce){$&&$(Ce)}finally{pr(he,!1),oe&&W()}}}h(z.prototype,{then:qe,_then:function(I,$){ze(this,new rt(null,null,I,$,Ie))},catch:function(I){if(arguments.length===1)return this.then(null,I);var $=I,ee=arguments[1];return typeof $=="function"?this.then(null,function(oe){return(oe instanceof $?ee:ye)(oe)}):this.then(null,function(oe){return(oe&&oe.name===$?ee:ye)(oe)})},finally:function(I){return this.then(function($){return z.resolve(I()).then(function(){return $})},function($){return z.resolve(I()).then(function(){return ye($)})})},timeout:function(I,$){var ee=this;return I<1/0?new z(function(oe,he){var Ce=setTimeout(function(){return he(new Ee.Timeout($))},I);ee.then(oe,he).finally(clearTimeout.bind(null,Ce))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y(z.prototype,Symbol.toStringTag,"Dexie.Promise"),we.env=un(),h(z,{all:function(){var I=G.apply(null,arguments).map(Gr);return new z(function($,ee){I.length===0&&$([]);var oe=I.length;I.forEach(function(he,Ce){return z.resolve(he).then(function(Le){I[Ce]=Le,--oe||$(I)},ee)})})},resolve:function(I){return I instanceof z?I:I&&typeof I.then=="function"?new z(function($,ee){I.then($,ee)}):new z(ot,!0,I)},reject:ye,race:function(){var I=G.apply(null,arguments).map(Gr);return new z(function($,ee){I.map(function(oe){return z.resolve(oe).then($,ee)})})},PSD:{get:function(){return Ie},set:function(I){return Ie=I}},totalEchoes:{get:function(){return Yt}},newPSD:on,usePSD:Ze,scheduler:{get:function(){return tn},set:function(I){tn=I}},rejectionMapper:{get:function(){return De},set:function(I){De=I}},follow:function(I,$){return new z(function(ee,oe){return on(function(he,Ce){var Le=Ie;Le.unhandleds=[],Le.onunhandled=Ce,Le.finalize=be(function(){var Ve,Je=this;Ve=function(){Je.unhandleds.length===0?he():Ce(Je.unhandleds[0])},_t.push(function et(){Ve(),_t.splice(_t.indexOf(et),1)}),++yt,tn(function(){--yt==0&&J()},[])},Le.finalize),I()},$,ee,oe)})}}),Bt&&(Bt.allSettled&&y(z,"allSettled",function(){var I=G.apply(null,arguments).map(Gr);return new z(function($){I.length===0&&$([]);var ee=I.length,oe=new Array(ee);I.forEach(function(he,Ce){return z.resolve(he).then(function(Le){return oe[Ce]={status:"fulfilled",value:Le}},function(Le){return oe[Ce]={status:"rejected",reason:Le}}).then(function(){return--ee||$(oe)})})})}),Bt.any&&typeof AggregateError<"u"&&y(z,"any",function(){var I=G.apply(null,arguments).map(Gr);return new z(function($,ee){I.length===0&&ee(new AggregateError([]));var oe=I.length,he=new Array(oe);I.forEach(function(Ce,Le){return z.resolve(Ce).then(function(Ve){return $(Ve)},function(Ve){he[Le]=Ve,--oe||ee(new AggregateError(he))})})})}),Bt.withResolvers&&(z.withResolvers=Bt.withResolvers));var We={awaits:0,echoes:0,id:0},vt=0,Xt=[],jn=0,Yt=0,Qt=0;function on(I,$,ee,oe){var he=Ie,Ce=Object.create(he);return Ce.parent=he,Ce.ref=0,Ce.global=!1,Ce.id=++Qt,we.env,Ce.env=Ft?{Promise:z,PromiseProp:{value:z,configurable:!0,writable:!0},all:z.all,race:z.race,allSettled:z.allSettled,any:z.any,resolve:z.resolve,reject:z.reject}:{},$&&l(Ce,$),++he.ref,Ce.finalize=function(){--this.parent.ref||this.parent.finalize()},oe=Ze(Ce,I,ee,oe),Ce.ref===0&&Ce.finalize(),oe}function or(){return We.id||(We.id=++vt),++We.awaits,We.echoes+=At,We.id}function xr(){return!!We.awaits&&(--We.awaits==0&&(We.id=0),We.echoes=We.awaits*At,!0)}function Gr(I){return We.echoes&&I&&I.constructor===Bt?(or(),I.then(function($){return xr(),$},function($){return xr(),Gn($)})):I}function Kr(){var I=Xt[Xt.length-1];Xt.pop(),pr(I,!1)}function pr(I,$){var ee,oe=Ie;($?!We.echoes||jn++&&I===Ie:!jn||--jn&&I===Ie)||queueMicrotask($?(function(he){++Yt,We.echoes&&--We.echoes!=0||(We.echoes=We.awaits=We.id=0),Xt.push(Ie),pr(he,!0)}).bind(null,I):Kr),I!==Ie&&(Ie=I,oe===we&&(we.env=un()),Ft&&(ee=we.env.Promise,$=I.env,(oe.global||I.global)&&(Object.defineProperty(s,"Promise",$.PromiseProp),ee.all=$.all,ee.race=$.race,ee.resolve=$.resolve,ee.reject=$.reject,$.allSettled&&(ee.allSettled=$.allSettled),$.any&&(ee.any=$.any))))}function un(){var I=s.Promise;return Ft?{Promise:I,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:I.all,race:I.race,allSettled:I.allSettled,any:I.any,resolve:I.resolve,reject:I.reject}:{}}function Ze(I,$,ee,oe,he){var Ce=Ie;try{return pr(I,!0),$(ee,oe,he)}finally{pr(Ce,!1)}}function $t(I,$,ee,oe){return typeof I!="function"?I:function(){var he=Ie;ee&&or(),pr($,!0);try{return I.apply(this,arguments)}finally{pr(he,!1),oe&&queueMicrotask(xr)}}}function dn(I){Promise===Bt&&We.echoes===0?jn===0?I():enqueueNativeMicroTask(I):setTimeout(I,0)}(""+Ia).indexOf("[native code]")===-1&&(or=xr=He);var Gn=z.reject,gi="",Vr="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",gs="String expected.",Ki=[],Ta="__dbnames",Gs="readonly",Mi="readwrite";function _o(I,$){return I?$?function(){return I.apply(this,arguments)&&$.apply(this,arguments)}:I:$}var Wo={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Nd(I){return typeof I!="string"||/\./.test(I)?function($){return $}:function($){return $[I]===void 0&&I in $&&delete($=H($))[I],$}}function ym(){throw Ee.Type()}function Ar(I,$){try{var ee=Ly(I),oe=Ly($);if(ee!==oe)return ee==="Array"?1:oe==="Array"?-1:ee==="binary"?1:oe==="binary"?-1:ee==="string"?1:oe==="string"?-1:ee==="Date"?1:oe!=="Date"?NaN:-1;switch(ee){case"number":case"Date":case"string":return $<I?1:I<$?-1:0;case"binary":return function(he,Ce){for(var Le=he.length,Ve=Ce.length,Je=Le<Ve?Le:Ve,et=0;et<Je;++et)if(he[et]!==Ce[et])return he[et]<Ce[et]?-1:1;return Le===Ve?0:Le<Ve?-1:1}(Aa(I),Aa($));case"Array":return function(he,Ce){for(var Le=he.length,Ve=Ce.length,Je=Le<Ve?Le:Ve,et=0;et<Je;++et){var at=Ar(he[et],Ce[et]);if(at!==0)return at}return Le===Ve?0:Le<Ve?-1:1}(I,$)}}catch{}return NaN}function Ly(I){var $=typeof I;return $!="object"?$:ArrayBuffer.isView(I)?"binary":(I=Q(I),I==="ArrayBuffer"?"binary":I)}function Aa(I){return I instanceof Uint8Array?I:ArrayBuffer.isView(I)?new Uint8Array(I.buffer,I.byteOffset,I.byteLength):new Uint8Array(I)}var By=(yi.prototype._trans=function(I,$,ee){var oe=this._tx||Ie.trans,he=this.name,Ce=$e&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(I==="readonly"?"read":"write"," ").concat(this.name));function Le(et,at,Ye){if(!Ye.schema[he])throw new Ee.NotFound("Table "+he+" not part of transaction");return $(Ye.idbtrans,Ye)}var Ve=Z();try{var Je=oe&&oe.db._novip===this.db._novip?oe===Ie.trans?oe._promise(I,Le,ee):on(function(){return oe._promise(I,Le,ee)},{trans:oe,transless:Ie.transless||Ie}):function et(at,Ye,ct,Xe){if(at.idbdb&&(at._state.openComplete||Ie.letThrough||at._vip)){var st=at._createTransaction(Ye,ct,at._dbSchema);try{st.create(),at._state.PR1398_maxLoop=3}catch(ht){return ht.name===Pe.InvalidState&&at.isOpen()&&0<--at._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),at.close({disableAutoOpen:!1}),at.open().then(function(){return et(at,Ye,ct,Xe)})):Gn(ht)}return st._promise(Ye,function(ht,tt){return on(function(){return Ie.trans=st,Xe(ht,tt,st)})}).then(function(ht){if(Ye==="readwrite")try{st.idbtrans.commit()}catch{}return Ye==="readonly"?ht:st._completion.then(function(){return ht})})}if(at._state.openComplete)return Gn(new Ee.DatabaseClosed(at._state.dbOpenError));if(!at._state.isBeingOpened){if(!at._state.autoOpen)return Gn(new Ee.DatabaseClosed);at.open().catch(He)}return at._state.dbReadyPromise.then(function(){return et(at,Ye,ct,Xe)})}(this.db,I,[this.name],Le);return Ce&&(Je._consoleTask=Ce,Je=Je.catch(function(et){return console.trace(et),Gn(et)})),Je}finally{Ve&&W()}},yi.prototype.get=function(I,$){var ee=this;return I&&I.constructor===Object?this.where(I).first($):I==null?Gn(new Ee.Type("Invalid argument to Table.get()")):this._trans("readonly",function(oe){return ee.core.get({trans:oe,key:I}).then(function(he){return ee.hook.reading.fire(he)})}).then($)},yi.prototype.where=function(I){if(typeof I=="string")return new this.db.WhereClause(this,I);if(o(I))return new this.db.WhereClause(this,"[".concat(I.join("+"),"]"));var $=a(I);if($.length===1)return this.where($[0]).equals(I[$[0]]);var ee=this.schema.indexes.concat(this.schema.primKey).filter(function(Ve){if(Ve.compound&&$.every(function(et){return 0<=Ve.keyPath.indexOf(et)})){for(var Je=0;Je<$.length;++Je)if($.indexOf(Ve.keyPath[Je])===-1)return!1;return!0}return!1}).sort(function(Ve,Je){return Ve.keyPath.length-Je.keyPath.length})[0];if(ee&&this.db._maxKey!==gi){var Ce=ee.keyPath.slice(0,$.length);return this.where(Ce).equals(Ce.map(function(Je){return I[Je]}))}!ee&&$e&&console.warn("The query ".concat(JSON.stringify(I)," on ").concat(this.name," would benefit from a ")+"compound index [".concat($.join("+"),"]"));var oe=this.schema.idxByName;function he(Ve,Je){return Ar(Ve,Je)===0}var Le=$.reduce(function(Ye,Je){var et=Ye[0],at=Ye[1],Ye=oe[Je],ct=I[Je];return[et||Ye,et||!Ye?_o(at,Ye&&Ye.multi?function(Xe){return Xe=T(Xe,Je),o(Xe)&&Xe.some(function(st){return he(ct,st)})}:function(Xe){return he(ct,T(Xe,Je))}):at]},[null,null]),Ce=Le[0],Le=Le[1];return Ce?this.where(Ce.name).equals(I[Ce.keyPath]).filter(Le):ee?this.filter(Le):this.where($).equals("")},yi.prototype.filter=function(I){return this.toCollection().and(I)},yi.prototype.count=function(I){return this.toCollection().count(I)},yi.prototype.offset=function(I){return this.toCollection().offset(I)},yi.prototype.limit=function(I){return this.toCollection().limit(I)},yi.prototype.each=function(I){return this.toCollection().each(I)},yi.prototype.toArray=function(I){return this.toCollection().toArray(I)},yi.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},yi.prototype.orderBy=function(I){return new this.db.Collection(new this.db.WhereClause(this,o(I)?"[".concat(I.join("+"),"]"):I))},yi.prototype.reverse=function(){return this.toCollection().reverse()},yi.prototype.mapToClass=function(I){var $,ee=this.db,oe=this.name;function he(){return $!==null&&$.apply(this,arguments)||this}(this.schema.mappedClass=I).prototype instanceof ym&&(function(Je,et){if(typeof et!="function"&&et!==null)throw new TypeError("Class extends value "+String(et)+" is not a constructor or null");function at(){this.constructor=Je}n(Je,et),Je.prototype=et===null?Object.create(et):(at.prototype=et.prototype,new at)}(he,$=I),Object.defineProperty(he.prototype,"db",{get:function(){return ee},enumerable:!1,configurable:!0}),he.prototype.table=function(){return oe},I=he);for(var Ce=new Set,Le=I.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(Je){return Ce.add(Je)});function Ve(Je){if(!Je)return Je;var et,at=Object.create(I.prototype);for(et in Je)if(!Ce.has(et))try{at[et]=Je[et]}catch{}return at}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Ve,this.hook("reading",Ve),I},yi.prototype.defineClass=function(){return this.mapToClass(function(I){l(this,I)})},yi.prototype.add=function(I,$){var ee=this,oe=this.schema.primKey,he=oe.auto,Ce=oe.keyPath,Le=I;return Ce&&he&&(Le=Nd(Ce)(I)),this._trans("readwrite",function(Ve){return ee.core.mutate({trans:Ve,type:"add",keys:$!=null?[$]:null,values:[Le]})}).then(function(Ve){return Ve.numFailures?z.reject(Ve.failures[0]):Ve.lastResult}).then(function(Ve){if(Ce)try{R(I,Ce,Ve)}catch{}return Ve})},yi.prototype.update=function(I,$){return typeof I!="object"||o(I)?this.where(":id").equals(I).modify($):(I=T(I,this.schema.primKey.keyPath),I===void 0?Gn(new Ee.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(I).modify($))},yi.prototype.put=function(I,$){var ee=this,oe=this.schema.primKey,he=oe.auto,Ce=oe.keyPath,Le=I;return Ce&&he&&(Le=Nd(Ce)(I)),this._trans("readwrite",function(Ve){return ee.core.mutate({trans:Ve,type:"put",values:[Le],keys:$!=null?[$]:null})}).then(function(Ve){return Ve.numFailures?z.reject(Ve.failures[0]):Ve.lastResult}).then(function(Ve){if(Ce)try{R(I,Ce,Ve)}catch{}return Ve})},yi.prototype.delete=function(I){var $=this;return this._trans("readwrite",function(ee){return $.core.mutate({trans:ee,type:"delete",keys:[I]})}).then(function(ee){return ee.numFailures?z.reject(ee.failures[0]):void 0})},yi.prototype.clear=function(){var I=this;return this._trans("readwrite",function($){return I.core.mutate({trans:$,type:"deleteRange",range:Wo})}).then(function($){return $.numFailures?z.reject($.failures[0]):void 0})},yi.prototype.bulkGet=function(I){var $=this;return this._trans("readonly",function(ee){return $.core.getMany({keys:I,trans:ee}).then(function(oe){return oe.map(function(he){return $.hook.reading.fire(he)})})})},yi.prototype.bulkAdd=function(I,$,ee){var oe=this,he=Array.isArray($)?$:void 0,Ce=(ee=ee||(he?void 0:$))?ee.allKeys:void 0;return this._trans("readwrite",function(Le){var et=oe.schema.primKey,Ve=et.auto,et=et.keyPath;if(et&&he)throw new Ee.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(he&&he.length!==I.length)throw new Ee.InvalidArgument("Arguments objects and keys must have the same length");var Je=I.length,et=et&&Ve?I.map(Nd(et)):I;return oe.core.mutate({trans:Le,type:"add",keys:he,values:et,wantResults:Ce}).then(function(st){var Ye=st.numFailures,ct=st.results,Xe=st.lastResult,st=st.failures;if(Ye===0)return Ce?ct:Xe;throw new Ne("".concat(oe.name,".bulkAdd(): ").concat(Ye," of ").concat(Je," operations failed"),st)})})},yi.prototype.bulkPut=function(I,$,ee){var oe=this,he=Array.isArray($)?$:void 0,Ce=(ee=ee||(he?void 0:$))?ee.allKeys:void 0;return this._trans("readwrite",function(Le){var et=oe.schema.primKey,Ve=et.auto,et=et.keyPath;if(et&&he)throw new Ee.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(he&&he.length!==I.length)throw new Ee.InvalidArgument("Arguments objects and keys must have the same length");var Je=I.length,et=et&&Ve?I.map(Nd(et)):I;return oe.core.mutate({trans:Le,type:"put",keys:he,values:et,wantResults:Ce}).then(function(st){var Ye=st.numFailures,ct=st.results,Xe=st.lastResult,st=st.failures;if(Ye===0)return Ce?ct:Xe;throw new Ne("".concat(oe.name,".bulkPut(): ").concat(Ye," of ").concat(Je," operations failed"),st)})})},yi.prototype.bulkUpdate=function(I){var $=this,ee=this.core,oe=I.map(function(Le){return Le.key}),he=I.map(function(Le){return Le.changes}),Ce=[];return this._trans("readwrite",function(Le){return ee.getMany({trans:Le,keys:oe,cache:"clone"}).then(function(Ve){var Je=[],et=[];I.forEach(function(Ye,ct){var Xe=Ye.key,st=Ye.changes,ht=Ve[ct];if(ht){for(var tt=0,xt=Object.keys(st);tt<xt.length;tt++){var Ct=xt[tt],kt=st[Ct];if(Ct===$.schema.primKey.keyPath){if(Ar(kt,Xe)!==0)throw new Ee.Constraint("Cannot update primary key in bulkUpdate()")}else R(ht,Ct,kt)}Ce.push(ct),Je.push(Xe),et.push(ht)}});var at=Je.length;return ee.mutate({trans:Le,type:"put",keys:Je,values:et,updates:{keys:oe,changeSpecs:he}}).then(function(Ye){var ct=Ye.numFailures,Xe=Ye.failures;if(ct===0)return at;for(var st=0,ht=Object.keys(Xe);st<ht.length;st++){var tt,xt=ht[st],Ct=Ce[Number(xt)];Ct!=null&&(tt=Xe[xt],delete Xe[xt],Xe[Ct]=tt)}throw new Ne("".concat($.name,".bulkUpdate(): ").concat(ct," of ").concat(at," operations failed"),Xe)})})})},yi.prototype.bulkDelete=function(I){var $=this,ee=I.length;return this._trans("readwrite",function(oe){return $.core.mutate({trans:oe,type:"delete",keys:I})}).then(function(Le){var he=Le.numFailures,Ce=Le.lastResult,Le=Le.failures;if(he===0)return Ce;throw new Ne("".concat($.name,".bulkDelete(): ").concat(he," of ").concat(ee," operations failed"),Le)})},yi);function yi(){}function gc(I){function $(Le,Ve){if(Ve){for(var Je=arguments.length,et=new Array(Je-1);--Je;)et[Je-1]=arguments[Je];return ee[Le].subscribe.apply(null,et),I}if(typeof Le=="string")return ee[Le]}var ee={};$.addEventType=Ce;for(var oe=1,he=arguments.length;oe<he;++oe)Ce(arguments[oe]);return $;function Ce(Le,Ve,Je){if(typeof Le!="object"){var et;Ve=Ve||ae;var at={subscribers:[],fire:Je=Je||He,subscribe:function(Ye){at.subscribers.indexOf(Ye)===-1&&(at.subscribers.push(Ye),at.fire=Ve(at.fire,Ye))},unsubscribe:function(Ye){at.subscribers=at.subscribers.filter(function(ct){return ct!==Ye}),at.fire=at.subscribers.reduce(Ve,Je)}};return ee[Le]=$[Le]=at}a(et=Le).forEach(function(Ye){var ct=et[Ye];if(o(ct))Ce(Ye,et[Ye][0],et[Ye][1]);else{if(ct!=="asap")throw new Ee.InvalidArgument("Invalid event config");var Xe=Ce(Ye,je,function(){for(var st=arguments.length,ht=new Array(st);st--;)ht[st]=arguments[st];Xe.subscribers.forEach(function(tt){E(function(){tt.apply(null,ht)})})})}})}}function jd(I,$){return b($).from({prototype:I}),$}function Ml(I,$){return!(I.filter||I.algorithm||I.or)&&($?I.justLimit:!I.replayFilter)}function $y(I,$){I.filter=_o(I.filter,$)}function oa(I,$,ee){var oe=I.replayFilter;I.replayFilter=oe?function(){return _o(oe(),$())}:$,I.justLimit=ee&&!oe}function Od(I,$){if(I.isPrimKey)return $.primaryKey;var ee=$.getIndexByKeyPath(I.index);if(!ee)throw new Ee.Schema("KeyPath "+I.index+" on object store "+$.name+" is not indexed");return ee}function zy(I,$,ee){var oe=Od(I,$.schema);return $.openCursor({trans:ee,values:!I.keysOnly,reverse:I.dir==="prev",unique:!!I.unique,query:{index:oe,range:I.range}})}function Pd(I,$,ee,oe){var he=I.replayFilter?_o(I.filter,I.replayFilter()):I.filter;if(I.or){var Ce={},Le=function(Ve,Je,et){var at,Ye;he&&!he(Je,et,function(ct){return Je.stop(ct)},function(ct){return Je.fail(ct)})||((Ye=""+(at=Je.primaryKey))=="[object ArrayBuffer]"&&(Ye=""+new Uint8Array(at)),d(Ce,Ye)||(Ce[Ye]=!0,$(Ve,Je,et)))};return Promise.all([I.or._iterate(Le,ee),gu(zy(I,oe,ee),I.algorithm,Le,!I.keysOnly&&I.valueMapper)])}return gu(zy(I,oe,ee),_o(I.algorithm,he),$,!I.keysOnly&&I.valueMapper)}function gu(I,$,ee,oe){var he=Oe(oe?function(Ce,Le,Ve){return ee(oe(Ce),Le,Ve)}:ee);return I.then(function(Ce){if(Ce)return Ce.start(function(){var Le=function(){return Ce.continue()};$&&!$(Ce,function(Ve){return Le=Ve},function(Ve){Ce.stop(Ve),Le=He},function(Ve){Ce.fail(Ve),Le=He})||he(Ce.value,Ce,function(Ve){return Le=Ve}),Le()})})}var Dd=(Uy.prototype.execute=function(I){var $=this["@@propmod"];if($.add!==void 0){var ee=$.add;if(o(ee))return i(i([],o(I)?I:[],!0),ee).sort();if(typeof ee=="number")return(Number(I)||0)+ee;if(typeof ee=="bigint")try{return BigInt(I)+ee}catch{return BigInt(0)+ee}throw new TypeError("Invalid term ".concat(ee))}if($.remove!==void 0){var oe=$.remove;if(o(oe))return o(I)?I.filter(function(he){return!oe.includes(he)}).sort():[];if(typeof oe=="number")return Number(I)-oe;if(typeof oe=="bigint")try{return BigInt(I)-oe}catch{return BigInt(0)-oe}throw new TypeError("Invalid subtrahend ".concat(oe))}return ee=(ee=$.replacePrefix)===null||ee===void 0?void 0:ee[0],ee&&typeof I=="string"&&I.startsWith(ee)?$.replacePrefix[1]+I.substring(ee.length):I},Uy);function Uy(I){this["@@propmod"]=I}var Fd=(Dr.prototype._read=function(I,$){var ee=this._ctx;return ee.error?ee.table._trans(null,Gn.bind(null,ee.error)):ee.table._trans("readonly",I).then($)},Dr.prototype._write=function(I){var $=this._ctx;return $.error?$.table._trans(null,Gn.bind(null,$.error)):$.table._trans("readwrite",I,"locked")},Dr.prototype._addAlgorithm=function(I){var $=this._ctx;$.algorithm=_o($.algorithm,I)},Dr.prototype._iterate=function(I,$){return Pd(this._ctx,I,$,this._ctx.table.core)},Dr.prototype.clone=function(I){var $=Object.create(this.constructor.prototype),ee=Object.create(this._ctx);return I&&l(ee,I),$._ctx=ee,$},Dr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Dr.prototype.each=function(I){var $=this._ctx;return this._read(function(ee){return Pd($,I,ee,$.table.core)})},Dr.prototype.count=function(I){var $=this;return this._read(function(ee){var oe=$._ctx,he=oe.table.core;if(Ml(oe,!0))return he.count({trans:ee,query:{index:Od(oe,he.schema),range:oe.range}}).then(function(Le){return Math.min(Le,oe.limit)});var Ce=0;return Pd(oe,function(){return++Ce,!1},ee,he).then(function(){return Ce})}).then(I)},Dr.prototype.sortBy=function(I,$){var ee=I.split(".").reverse(),oe=ee[0],he=ee.length-1;function Ce(Je,et){return et?Ce(Je[ee[et]],et-1):Je[oe]}var Le=this._ctx.dir==="next"?1:-1;function Ve(Je,et){return Ar(Ce(Je,he),Ce(et,he))*Le}return this.toArray(function(Je){return Je.sort(Ve)}).then($)},Dr.prototype.toArray=function(I){var $=this;return this._read(function(ee){var oe=$._ctx;if(oe.dir==="next"&&Ml(oe,!0)&&0<oe.limit){var he=oe.valueMapper,Ce=Od(oe,oe.table.core.schema);return oe.table.core.query({trans:ee,limit:oe.limit,values:!0,query:{index:Ce,range:oe.range}}).then(function(Ve){return Ve=Ve.result,he?Ve.map(he):Ve})}var Le=[];return Pd(oe,function(Ve){return Le.push(Ve)},ee,oe.table.core).then(function(){return Le})},I)},Dr.prototype.offset=function(I){var $=this._ctx;return I<=0||($.offset+=I,Ml($)?oa($,function(){var ee=I;return function(oe,he){return ee===0||(ee===1?--ee:he(function(){oe.advance(ee),ee=0}),!1)}}):oa($,function(){var ee=I;return function(){return--ee<0}})),this},Dr.prototype.limit=function(I){return this._ctx.limit=Math.min(this._ctx.limit,I),oa(this._ctx,function(){var $=I;return function(ee,oe,he){return--$<=0&&oe(he),0<=$}},!0),this},Dr.prototype.until=function(I,$){return $y(this._ctx,function(ee,oe,he){return!I(ee.value)||(oe(he),$)}),this},Dr.prototype.first=function(I){return this.limit(1).toArray(function($){return $[0]}).then(I)},Dr.prototype.last=function(I){return this.reverse().first(I)},Dr.prototype.filter=function(I){var $;return $y(this._ctx,function(ee){return I(ee.value)}),($=this._ctx).isMatch=_o($.isMatch,I),this},Dr.prototype.and=function(I){return this.filter(I)},Dr.prototype.or=function(I){return new this.db.WhereClause(this._ctx.table,I,this)},Dr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Dr.prototype.desc=function(){return this.reverse()},Dr.prototype.eachKey=function(I){var $=this._ctx;return $.keysOnly=!$.isMatch,this.each(function(ee,oe){I(oe.key,oe)})},Dr.prototype.eachUniqueKey=function(I){return this._ctx.unique="unique",this.eachKey(I)},Dr.prototype.eachPrimaryKey=function(I){var $=this._ctx;return $.keysOnly=!$.isMatch,this.each(function(ee,oe){I(oe.primaryKey,oe)})},Dr.prototype.keys=function(I){var $=this._ctx;$.keysOnly=!$.isMatch;var ee=[];return this.each(function(oe,he){ee.push(he.key)}).then(function(){return ee}).then(I)},Dr.prototype.primaryKeys=function(I){var $=this._ctx;if($.dir==="next"&&Ml($,!0)&&0<$.limit)return this._read(function(oe){var he=Od($,$.table.core.schema);return $.table.core.query({trans:oe,values:!1,limit:$.limit,query:{index:he,range:$.range}})}).then(function(oe){return oe.result}).then(I);$.keysOnly=!$.isMatch;var ee=[];return this.each(function(oe,he){ee.push(he.primaryKey)}).then(function(){return ee}).then(I)},Dr.prototype.uniqueKeys=function(I){return this._ctx.unique="unique",this.keys(I)},Dr.prototype.firstKey=function(I){return this.limit(1).keys(function($){return $[0]}).then(I)},Dr.prototype.lastKey=function(I){return this.reverse().firstKey(I)},Dr.prototype.distinct=function(){var I=this._ctx,I=I.index&&I.table.schema.idxByName[I.index];if(!I||!I.multi)return this;var $={};return $y(this._ctx,function(he){var oe=he.primaryKey.toString(),he=d($,oe);return $[oe]=!0,!he}),this},Dr.prototype.modify=function(I){var $=this,ee=this._ctx;return this._write(function(oe){var he,Ce,Le;Le=typeof I=="function"?I:(he=a(I),Ce=he.length,function(tt){for(var xt=!1,Ct=0;Ct<Ce;++Ct){var kt=he[Ct],It=I[kt],Wt=T(tt,kt);It instanceof Dd?(R(tt,kt,It.execute(Wt)),xt=!0):Wt!==It&&(R(tt,kt,It),xt=!0)}return xt});var Ve=ee.table.core,Ye=Ve.schema.primaryKey,Je=Ye.outbound,et=Ye.extractKey,at=200,Ye=$.db._options.modifyChunkSize;Ye&&(at=typeof Ye=="object"?Ye[Ve.name]||Ye["*"]||200:Ye);function ct(tt,kt){var Ct=kt.failures,kt=kt.numFailures;st+=tt-kt;for(var It=0,Wt=a(Ct);It<Wt.length;It++){var en=Wt[It];Xe.push(Ct[en])}}var Xe=[],st=0,ht=[];return $.clone().primaryKeys().then(function(tt){function xt(kt){var It=Math.min(at,tt.length-kt);return Ve.getMany({trans:oe,keys:tt.slice(kt,kt+It),cache:"immutable"}).then(function(Wt){for(var en=[],qt=[],Zt=Je?[]:null,rn=[],Vt=0;Vt<It;++Vt){var fn=Wt[Vt],Mn={value:H(fn),primKey:tt[kt+Vt]};Le.call(Mn,Mn.value,Mn)!==!1&&(Mn.value==null?rn.push(tt[kt+Vt]):Je||Ar(et(fn),et(Mn.value))===0?(qt.push(Mn.value),Je&&Zt.push(tt[kt+Vt])):(rn.push(tt[kt+Vt]),en.push(Mn.value)))}return Promise.resolve(0<en.length&&Ve.mutate({trans:oe,type:"add",values:en}).then(function(Fn){for(var sr in Fn.failures)rn.splice(parseInt(sr),1);ct(en.length,Fn)})).then(function(){return(0<qt.length||Ct&&typeof I=="object")&&Ve.mutate({trans:oe,type:"put",keys:Zt,values:qt,criteria:Ct,changeSpec:typeof I!="function"&&I,isAdditionalChunk:0<kt}).then(function(Fn){return ct(qt.length,Fn)})}).then(function(){return(0<rn.length||Ct&&I===bm)&&Ve.mutate({trans:oe,type:"delete",keys:rn,criteria:Ct,isAdditionalChunk:0<kt}).then(function(Fn){return ct(rn.length,Fn)})}).then(function(){return tt.length>kt+It&&xt(kt+at)})})}var Ct=Ml(ee)&&ee.limit===1/0&&(typeof I!="function"||I===bm)&&{index:ee.index,range:ee.range};return xt(0).then(function(){if(0<Xe.length)throw new de("Error modifying one or more objects",Xe,st,ht);return tt.length})})})},Dr.prototype.delete=function(){var I=this._ctx,$=I.range;return Ml(I)&&(I.isPrimKey||$.type===3)?this._write(function(ee){var oe=I.table.core.schema.primaryKey,he=$;return I.table.core.count({trans:ee,query:{index:oe,range:he}}).then(function(Ce){return I.table.core.mutate({trans:ee,type:"deleteRange",range:he}).then(function(Le){var Ve=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new de("Could not delete some values",Object.keys(Ve).map(function(Je){return Ve[Je]}),Ce-Le);return Ce-Le})})}):this.modify(bm)},Dr);function Dr(){}var bm=function(I,$){return $.value=null};function L1(I,$){return I<$?-1:I===$?0:1}function qy(I,$){return $<I?-1:I===$?0:1}function Ra(I,$,ee){return I=I instanceof bu?new I.Collection(I):I,I._ctx.error=new(ee||TypeError)($),I}function Ld(I){return new I.Collection(I,function(){return vm("")}).limit(0)}function yu(I,$,ee,oe){var he,Ce,Le,Ve,Je,et,at,Ye=ee.length;if(!ee.every(function(st){return typeof st=="string"}))return Ra(I,gs);function ct(st){he=st==="next"?function(tt){return tt.toUpperCase()}:function(tt){return tt.toLowerCase()},Ce=st==="next"?function(tt){return tt.toLowerCase()}:function(tt){return tt.toUpperCase()},Le=st==="next"?L1:qy;var ht=ee.map(function(tt){return{lower:Ce(tt),upper:he(tt)}}).sort(function(tt,xt){return Le(tt.lower,xt.lower)});Ve=ht.map(function(tt){return tt.upper}),Je=ht.map(function(tt){return tt.lower}),at=(et=st)==="next"?"":oe}ct("next"),I=new I.Collection(I,function(){return Go(Ve[0],Je[Ye-1]+oe)}),I._ondirectionchange=function(st){ct(st)};var Xe=0;return I._addAlgorithm(function(st,ht,tt){var xt=st.key;if(typeof xt!="string")return!1;var Ct=Ce(xt);if($(Ct,Je,Xe))return!0;for(var kt=null,It=Xe;It<Ye;++It){var Wt=function(en,qt,Zt,rn,Vt,fn){for(var Mn=Math.min(en.length,rn.length),Fn=-1,sr=0;sr<Mn;++sr){var Ks=qt[sr];if(Ks!==rn[sr])return Vt(en[sr],Zt[sr])<0?en.substr(0,sr)+Zt[sr]+Zt.substr(sr+1):Vt(en[sr],rn[sr])<0?en.substr(0,sr)+rn[sr]+Zt.substr(sr+1):0<=Fn?en.substr(0,Fn)+qt[Fn]+Zt.substr(Fn+1):null;Vt(en[sr],Ks)<0&&(Fn=sr)}return Mn<rn.length&&fn==="next"?en+Zt.substr(en.length):Mn<en.length&&fn==="prev"?en.substr(0,Zt.length):Fn<0?null:en.substr(0,Fn)+rn[Fn]+Zt.substr(Fn+1)}(xt,Ct,Ve[It],Je[It],Le,et);Wt===null&&kt===null?Xe=It+1:(kt===null||0<Le(kt,Wt))&&(kt=Wt)}return ht(kt!==null?function(){st.continue(kt+at)}:tt),!1}),I}function Go(I,$,ee,oe){return{type:2,lower:I,upper:$,lowerOpen:ee,upperOpen:oe}}function vm(I){return{type:1,lower:I,upper:I}}var bu=(Object.defineProperty(ki.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ki.prototype.between=function(I,$,ee,oe){ee=ee!==!1,oe=oe===!0;try{return 0<this._cmp(I,$)||this._cmp(I,$)===0&&(ee||oe)&&(!ee||!oe)?Ld(this):new this.Collection(this,function(){return Go(I,$,!ee,!oe)})}catch{return Ra(this,Vr)}},ki.prototype.equals=function(I){return I==null?Ra(this,Vr):new this.Collection(this,function(){return vm(I)})},ki.prototype.above=function(I){return I==null?Ra(this,Vr):new this.Collection(this,function(){return Go(I,void 0,!0)})},ki.prototype.aboveOrEqual=function(I){return I==null?Ra(this,Vr):new this.Collection(this,function(){return Go(I,void 0,!1)})},ki.prototype.below=function(I){return I==null?Ra(this,Vr):new this.Collection(this,function(){return Go(void 0,I,!1,!0)})},ki.prototype.belowOrEqual=function(I){return I==null?Ra(this,Vr):new this.Collection(this,function(){return Go(void 0,I)})},ki.prototype.startsWith=function(I){return typeof I!="string"?Ra(this,gs):this.between(I,I+gi,!0,!0)},ki.prototype.startsWithIgnoreCase=function(I){return I===""?this.startsWith(I):yu(this,function($,ee){return $.indexOf(ee[0])===0},[I],gi)},ki.prototype.equalsIgnoreCase=function(I){return yu(this,function($,ee){return $===ee[0]},[I],"")},ki.prototype.anyOfIgnoreCase=function(){var I=G.apply(re,arguments);return I.length===0?Ld(this):yu(this,function($,ee){return ee.indexOf($)!==-1},I,"")},ki.prototype.startsWithAnyOfIgnoreCase=function(){var I=G.apply(re,arguments);return I.length===0?Ld(this):yu(this,function($,ee){return ee.some(function(oe){return $.indexOf(oe)===0})},I,gi)},ki.prototype.anyOf=function(){var I=this,$=G.apply(re,arguments),ee=this._cmp;try{$.sort(ee)}catch{return Ra(this,Vr)}if($.length===0)return Ld(this);var oe=new this.Collection(this,function(){return Go($[0],$[$.length-1])});oe._ondirectionchange=function(Ce){ee=Ce==="next"?I._ascending:I._descending,$.sort(ee)};var he=0;return oe._addAlgorithm(function(Ce,Le,Ve){for(var Je=Ce.key;0<ee(Je,$[he]);)if(++he===$.length)return Le(Ve),!1;return ee(Je,$[he])===0||(Le(function(){Ce.continue($[he])}),!1)}),oe},ki.prototype.notEqual=function(I){return this.inAnyRange([[-1/0,I],[I,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ki.prototype.noneOf=function(){var I=G.apply(re,arguments);if(I.length===0)return new this.Collection(this);try{I.sort(this._ascending)}catch{return Ra(this,Vr)}var $=I.reduce(function(ee,oe){return ee?ee.concat([[ee[ee.length-1][1],oe]]):[[-1/0,oe]]},null);return $.push([I[I.length-1],this.db._maxKey]),this.inAnyRange($,{includeLowers:!1,includeUppers:!1})},ki.prototype.inAnyRange=function(xt,$){var ee=this,oe=this._cmp,he=this._ascending,Ce=this._descending,Le=this._min,Ve=this._max;if(xt.length===0)return Ld(this);if(!xt.every(function(Ct){return Ct[0]!==void 0&&Ct[1]!==void 0&&he(Ct[0],Ct[1])<=0}))return Ra(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ee.InvalidArgument);var Je=!$||$.includeLowers!==!1,et=$&&$.includeUppers===!0,at,Ye=he;function ct(Ct,kt){return Ye(Ct[0],kt[0])}try{(at=xt.reduce(function(Ct,kt){for(var It=0,Wt=Ct.length;It<Wt;++It){var en=Ct[It];if(oe(kt[0],en[1])<0&&0<oe(kt[1],en[0])){en[0]=Le(en[0],kt[0]),en[1]=Ve(en[1],kt[1]);break}}return It===Wt&&Ct.push(kt),Ct},[])).sort(ct)}catch{return Ra(this,Vr)}var Xe=0,st=et?function(Ct){return 0<he(Ct,at[Xe][1])}:function(Ct){return 0<=he(Ct,at[Xe][1])},ht=Je?function(Ct){return 0<Ce(Ct,at[Xe][0])}:function(Ct){return 0<=Ce(Ct,at[Xe][0])},tt=st,xt=new this.Collection(this,function(){return Go(at[0][0],at[at.length-1][1],!Je,!et)});return xt._ondirectionchange=function(Ct){Ye=Ct==="next"?(tt=st,he):(tt=ht,Ce),at.sort(ct)},xt._addAlgorithm(function(Ct,kt,It){for(var Wt,en=Ct.key;tt(en);)if(++Xe===at.length)return kt(It),!1;return!st(Wt=en)&&!ht(Wt)||(ee._cmp(en,at[Xe][1])===0||ee._cmp(en,at[Xe][0])===0||kt(function(){Ye===he?Ct.continue(at[Xe][0]):Ct.continue(at[Xe][1])}),!1)}),xt},ki.prototype.startsWithAnyOf=function(){var I=G.apply(re,arguments);return I.every(function($){return typeof $=="string"})?I.length===0?Ld(this):this.inAnyRange(I.map(function($){return[$,$+gi]})):Ra(this,"startsWithAnyOf() only works with strings")},ki);function ki(){}function So(I){return Oe(function($){return vu($),I($.target.error),!1})}function vu(I){I.stopPropagation&&I.stopPropagation(),I.preventDefault&&I.preventDefault()}var Bd="storagemutated",xu="x-storagemutated-1",Ts=gc(null,Bd),Vy=(la.prototype._lock=function(){return C(!Ie.global),++this._reculock,this._reculock!==1||Ie.global||(Ie.lockOwnerFor=this),this},la.prototype._unlock=function(){if(C(!Ie.global),--this._reculock==0)for(Ie.global||(Ie.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var I=this._blockedFuncs.shift();try{Ze(I[1],I[0])}catch{}}return this},la.prototype._locked=function(){return this._reculock&&Ie.lockOwnerFor!==this},la.prototype.create=function(I){var $=this;if(!this.mode)return this;var ee=this.db.idbdb,oe=this.db._state.dbOpenError;if(C(!this.idbtrans),!I&&!ee)switch(oe&&oe.name){case"DatabaseClosedError":throw new Ee.DatabaseClosed(oe);case"MissingAPIError":throw new Ee.MissingAPI(oe.message,oe);default:throw new Ee.OpenFailed(oe)}if(!this.active)throw new Ee.TransactionInactive;return C(this._completion._state===null),(I=this.idbtrans=I||(this.db.core||ee).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Oe(function(he){vu(he),$._reject(I.error)}),I.onabort=Oe(function(he){vu(he),$.active&&$._reject(new Ee.Abort(I.error)),$.active=!1,$.on("abort").fire(he)}),I.oncomplete=Oe(function(){$.active=!1,$._resolve(),"mutatedParts"in I&&Ts.storagemutated.fire(I.mutatedParts)}),this},la.prototype._promise=function(I,$,ee){var oe=this;if(I==="readwrite"&&this.mode!=="readwrite")return Gn(new Ee.ReadOnly("Transaction is readonly"));if(!this.active)return Gn(new Ee.TransactionInactive);if(this._locked())return new z(function(Ce,Le){oe._blockedFuncs.push([function(){oe._promise(I,$,ee).then(Ce,Le)},Ie])});if(ee)return on(function(){var Ce=new z(function(Le,Ve){oe._lock();var Je=$(Le,Ve,oe);Je&&Je.then&&Je.then(Le,Ve)});return Ce.finally(function(){return oe._unlock()}),Ce._lib=!0,Ce});var he=new z(function(Ce,Le){var Ve=$(Ce,Le,oe);Ve&&Ve.then&&Ve.then(Ce,Le)});return he._lib=!0,he},la.prototype._root=function(){return this.parent?this.parent._root():this},la.prototype.waitFor=function(I){var $,ee=this._root(),oe=z.resolve(I);ee._waitingFor?ee._waitingFor=ee._waitingFor.then(function(){return oe}):(ee._waitingFor=oe,ee._waitingQueue=[],$=ee.idbtrans.objectStore(ee.storeNames[0]),function Ce(){for(++ee._spinCount;ee._waitingQueue.length;)ee._waitingQueue.shift()();ee._waitingFor&&($.get(-1/0).onsuccess=Ce)}());var he=ee._waitingFor;return new z(function(Ce,Le){oe.then(function(Ve){return ee._waitingQueue.push(Oe(Ce.bind(null,Ve)))},function(Ve){return ee._waitingQueue.push(Oe(Le.bind(null,Ve)))}).finally(function(){ee._waitingFor===he&&(ee._waitingFor=null)})})},la.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ee.Abort))},la.prototype.table=function(I){var $=this._memoizedTables||(this._memoizedTables={});if(d($,I))return $[I];var ee=this.schema[I];if(!ee)throw new Ee.NotFound("Table "+I+" not part of transaction");return ee=new this.db.Table(I,ee,this),ee.core=this.db.core.table(I),$[I]=ee},la);function la(){}function Ko(I,$,ee,oe,he,Ce,Le){return{name:I,keyPath:$,unique:ee,multi:oe,auto:he,compound:Ce,src:(ee&&!Le?"&":"")+(oe?"*":"")+(he?"++":"")+xm($)}}function xm(I){return typeof I=="string"?I:I?"["+[].join.call(I,"+")+"]":""}function $d(I,$,ee){return{name:I,primKey:$,indexes:ee,mappedClass:null,idxByName:(oe=function(he){return[he.name,he]},ee.reduce(function(he,Ce,Le){return Le=oe(Ce,Le),Le&&(he[Le[0]]=Le[1]),he},{}))};var oe}var zd=function(I){try{return I.only([[]]),zd=function(){return[[]]},[[]]}catch{return zd=function(){return gi},gi}};function Ud(I){return I==null?function(){}:typeof I=="string"?($=I).split(".").length===1?function(ee){return ee[$]}:function(ee){return T(ee,$)}:function(ee){return T(ee,I)};var $}function kh(I){return[].slice.call(I)}var B1=0;function as(I){return I==null?":id":typeof I=="string"?I:"[".concat(I.join("+"),"]")}function wu(I,$,Je){function oe(tt){if(tt.type===3)return null;if(tt.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Xe=tt.lower,st=tt.upper,ht=tt.lowerOpen,tt=tt.upperOpen;return Xe===void 0?st===void 0?null:$.upperBound(st,!!tt):st===void 0?$.lowerBound(Xe,!!ht):$.bound(Xe,st,!!ht,!!tt)}function he(ct){var Xe,st=ct.name;return{name:st,schema:ct,mutate:function(ht){var tt=ht.trans,xt=ht.type,Ct=ht.keys,kt=ht.values,It=ht.range;return new Promise(function(Wt,en){Wt=Oe(Wt);var qt=tt.objectStore(st),Zt=qt.keyPath==null,rn=xt==="put"||xt==="add";if(!rn&&xt!=="delete"&&xt!=="deleteRange")throw new Error("Invalid operation type: "+xt);var Vt,fn=(Ct||kt||{length:1}).length;if(Ct&&kt&&Ct.length!==kt.length)throw new Error("Given keys array must have same length as given values array.");if(fn===0)return Wt({numFailures:0,failures:{},results:[],lastResult:void 0});function Mn(Rs){++Ks,vu(Rs)}var Fn=[],sr=[],Ks=0;if(xt==="deleteRange"){if(It.type===4)return Wt({numFailures:Ks,failures:sr,results:[],lastResult:void 0});It.type===3?Fn.push(Vt=qt.clear()):Fn.push(Vt=qt.delete(oe(It)))}else{var Zt=rn?Zt?[kt,Ct]:[kt,null]:[Ct,null],Kn=Zt[0],Yi=Zt[1];if(rn)for(var os=0;os<fn;++os)Fn.push(Vt=Yi&&Yi[os]!==void 0?qt[xt](Kn[os],Yi[os]):qt[xt](Kn[os])),Vt.onerror=Mn;else for(os=0;os<fn;++os)Fn.push(Vt=qt[xt](Kn[os])),Vt.onerror=Mn}function Nl(Rs){Rs=Rs.target.result,Fn.forEach(function(Zo,xc){return Zo.error!=null&&(sr[xc]=Zo.error)}),Wt({numFailures:Ks,failures:sr,results:xt==="delete"?Ct:Fn.map(function(Zo){return Zo.result}),lastResult:Rs})}Vt.onerror=function(Rs){Mn(Rs),Nl(Rs)},Vt.onsuccess=Nl})},getMany:function(ht){var tt=ht.trans,xt=ht.keys;return new Promise(function(Ct,kt){Ct=Oe(Ct);for(var It,Wt=tt.objectStore(st),en=xt.length,qt=new Array(en),Zt=0,rn=0,Vt=function(Fn){Fn=Fn.target,qt[Fn._pos]=Fn.result,++rn===Zt&&Ct(qt)},fn=So(kt),Mn=0;Mn<en;++Mn)xt[Mn]!=null&&((It=Wt.get(xt[Mn]))._pos=Mn,It.onsuccess=Vt,It.onerror=fn,++Zt);Zt===0&&Ct(qt)})},get:function(ht){var tt=ht.trans,xt=ht.key;return new Promise(function(Ct,kt){Ct=Oe(Ct);var It=tt.objectStore(st).get(xt);It.onsuccess=function(Wt){return Ct(Wt.target.result)},It.onerror=So(kt)})},query:(Xe=et,function(ht){return new Promise(function(tt,xt){tt=Oe(tt);var Ct,kt,It,Zt=ht.trans,Wt=ht.values,en=ht.limit,Vt=ht.query,qt=en===1/0?void 0:en,rn=Vt.index,Vt=Vt.range,Zt=Zt.objectStore(st),rn=rn.isPrimaryKey?Zt:Zt.index(rn.name),Vt=oe(Vt);if(en===0)return tt({result:[]});Xe?((qt=Wt?rn.getAll(Vt,qt):rn.getAllKeys(Vt,qt)).onsuccess=function(fn){return tt({result:fn.target.result})},qt.onerror=So(xt)):(Ct=0,kt=!Wt&&"openKeyCursor"in rn?rn.openKeyCursor(Vt):rn.openCursor(Vt),It=[],kt.onsuccess=function(fn){var Mn=kt.result;return Mn?(It.push(Wt?Mn.value:Mn.primaryKey),++Ct===en?tt({result:It}):void Mn.continue()):tt({result:It})},kt.onerror=So(xt))})}),openCursor:function(ht){var tt=ht.trans,xt=ht.values,Ct=ht.query,kt=ht.reverse,It=ht.unique;return new Promise(function(Wt,en){Wt=Oe(Wt);var rn=Ct.index,qt=Ct.range,Zt=tt.objectStore(st),Zt=rn.isPrimaryKey?Zt:Zt.index(rn.name),rn=kt?It?"prevunique":"prev":It?"nextunique":"next",Vt=!xt&&"openKeyCursor"in Zt?Zt.openKeyCursor(oe(qt),rn):Zt.openCursor(oe(qt),rn);Vt.onerror=So(en),Vt.onsuccess=Oe(function(fn){var Mn,Fn,sr,Ks,Kn=Vt.result;Kn?(Kn.___id=++B1,Kn.done=!1,Mn=Kn.continue.bind(Kn),Fn=(Fn=Kn.continuePrimaryKey)&&Fn.bind(Kn),sr=Kn.advance.bind(Kn),Ks=function(){throw new Error("Cursor not stopped")},Kn.trans=tt,Kn.stop=Kn.continue=Kn.continuePrimaryKey=Kn.advance=function(){throw new Error("Cursor not started")},Kn.fail=Oe(en),Kn.next=function(){var Yi=this,os=1;return this.start(function(){return os--?Yi.continue():Yi.stop()}).then(function(){return Yi})},Kn.start=function(Yi){function os(){if(Vt.result)try{Yi()}catch(Rs){Kn.fail(Rs)}else Kn.done=!0,Kn.start=function(){throw new Error("Cursor behind last entry")},Kn.stop()}var Nl=new Promise(function(Rs,Zo){Rs=Oe(Rs),Vt.onerror=So(Zo),Kn.fail=Zo,Kn.stop=function(xc){Kn.stop=Kn.continue=Kn.continuePrimaryKey=Kn.advance=Ks,Rs(xc)}});return Vt.onsuccess=Oe(function(Rs){Vt.onsuccess=os,os()}),Kn.continue=Mn,Kn.continuePrimaryKey=Fn,Kn.advance=sr,os(),Nl},Wt(Kn)):Wt(null)},en)})},count:function(ht){var tt=ht.query,xt=ht.trans,Ct=tt.index,kt=tt.range;return new Promise(function(It,Wt){var en=xt.objectStore(st),qt=Ct.isPrimaryKey?en:en.index(Ct.name),en=oe(kt),qt=en?qt.count(en):qt.count();qt.onsuccess=Oe(function(Zt){return It(Zt.target.result)}),qt.onerror=So(Wt)})}}}var Ce,Le,Ve,at=(Le=Je,Ve=kh((Ce=I).objectStoreNames),{schema:{name:Ce.name,tables:Ve.map(function(ct){return Le.objectStore(ct)}).map(function(ct){var Xe=ct.keyPath,tt=ct.autoIncrement,st=o(Xe),ht={},tt={name:ct.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Xe==null,compound:st,keyPath:Xe,autoIncrement:tt,unique:!0,extractKey:Ud(Xe)},indexes:kh(ct.indexNames).map(function(xt){return ct.index(xt)}).map(function(It){var Ct=It.name,kt=It.unique,Wt=It.multiEntry,It=It.keyPath,Wt={name:Ct,compound:o(It),keyPath:It,unique:kt,multiEntry:Wt,extractKey:Ud(It)};return ht[as(It)]=Wt}),getIndexByKeyPath:function(xt){return ht[as(xt)]}};return ht[":id"]=tt.primaryKey,Xe!=null&&(ht[as(Xe)]=tt.primaryKey),tt})},hasGetAll:0<Ve.length&&"getAll"in Le.objectStore(Ve[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Je=at.schema,et=at.hasGetAll,at=Je.tables.map(he),Ye={};return at.forEach(function(ct){return Ye[ct.name]=ct}),{stack:"dbcore",transaction:I.transaction.bind(I),table:function(ct){if(!Ye[ct])throw new Error("Table '".concat(ct,"' not found"));return Ye[ct]},MIN_KEY:-1/0,MAX_KEY:zd($),schema:Je}}function wm(I,$,ee,oe){var he=ee.IDBKeyRange;return ee.indexedDB,{dbcore:(oe=wu($,he,oe),I.dbcore.reduce(function(Ce,Le){return Le=Le.create,r(r({},Ce),Le(Ce))},oe))}}function yc(I,oe){var ee=oe.db,oe=wm(I._middlewares,ee,I._deps,oe);I.core=oe.dbcore,I.tables.forEach(function(he){var Ce=he.name;I.core.schema.tables.some(function(Le){return Le.name===Ce})&&(he.core=I.core.table(Ce),I[Ce]instanceof I.Table&&(I[Ce].core=he.core))})}function _m(I,$,ee,oe){ee.forEach(function(he){var Ce=oe[he];$.forEach(function(Le){var Ve=function Je(et,at){return x(et,at)||(et=c(et))&&Je(et,at)}(Le,he);(!Ve||"value"in Ve&&Ve.value===void 0)&&(Le===I.Transaction.prototype||Le instanceof I.Transaction?y(Le,he,{get:function(){return this.table(he)},set:function(Je){p(this,he,{value:Je,writable:!0,configurable:!0,enumerable:!0})}}):Le[he]=new I.Table(he,Ce))})})}function Eh(I,$){$.forEach(function(ee){for(var oe in ee)ee[oe]instanceof I.Table&&delete ee[oe]})}function Hy(I,$){return I._cfg.version-$._cfg.version}function Th(I,$,ee,oe){var he=I._dbSchema;ee.objectStoreNames.contains("$meta")&&!he.$meta&&(he.$meta=$d("$meta",z1("")[0],[]),I._storeNames.push("$meta"));var Ce=I._createTransaction("readwrite",I._storeNames,he);Ce.create(ee),Ce._completion.catch(oe);var Le=Ce._reject.bind(Ce),Ve=Ie.transless||Ie;on(function(){return Ie.trans=Ce,Ie.transless=Ve,$!==0?(yc(I,ee),et=$,((Je=Ce).storeNames.includes("$meta")?Je.table("$meta").get("version").then(function(at){return at??et}):z.resolve(et)).then(function(at){return ct=at,Xe=Ce,st=ee,ht=[],at=(Ye=I)._versions,tt=Ye._dbSchema=qd(0,Ye.idbdb,st),(at=at.filter(function(xt){return xt._cfg.version>=ct})).length!==0?(at.forEach(function(xt){ht.push(function(){var Ct=tt,kt=xt._cfg.dbschema;Em(Ye,Ct,st),Em(Ye,kt,st),tt=Ye._dbSchema=kt;var It=Cm(Ct,kt);It.add.forEach(function(rn){Wy(st,rn[0],rn[1].primKey,rn[1].indexes)}),It.change.forEach(function(rn){if(rn.recreate)throw new Ee.Upgrade("Not yet support for changing primary key");var Vt=st.objectStore(rn.name);rn.add.forEach(function(fn){return km(Vt,fn)}),rn.change.forEach(function(fn){Vt.deleteIndex(fn.name),km(Vt,fn)}),rn.del.forEach(function(fn){return Vt.deleteIndex(fn)})});var Wt=xt._cfg.contentUpgrade;if(Wt&&xt._cfg.version>ct){yc(Ye,st),Xe._memoizedTables={};var en=M(kt);It.del.forEach(function(rn){en[rn]=Ct[rn]}),Eh(Ye,[Ye.Transaction.prototype]),_m(Ye,[Ye.Transaction.prototype],a(en),en),Xe.schema=en;var qt,Zt=ne(Wt);return Zt&&or(),It=z.follow(function(){var rn;(qt=Wt(Xe))&&Zt&&(rn=xr.bind(null,null),qt.then(rn,rn))}),qt&&typeof qt.then=="function"?z.resolve(qt):It.then(function(){return qt})}}),ht.push(function(Ct){var kt,It,Wt=xt._cfg.dbschema;kt=Wt,It=Ct,[].slice.call(It.db.objectStoreNames).forEach(function(en){return kt[en]==null&&It.db.deleteObjectStore(en)}),Eh(Ye,[Ye.Transaction.prototype]),_m(Ye,[Ye.Transaction.prototype],Ye._storeNames,Ye._dbSchema),Xe.schema=Ye._dbSchema}),ht.push(function(Ct){Ye.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Ye.idbdb.version/10)===xt._cfg.version?(Ye.idbdb.deleteObjectStore("$meta"),delete Ye._dbSchema.$meta,Ye._storeNames=Ye._storeNames.filter(function(kt){return kt!=="$meta"})):Ct.objectStore("$meta").put(xt._cfg.version,"version"))})}),function xt(){return ht.length?z.resolve(ht.shift()(Xe.idbtrans)).then(xt):z.resolve()}().then(function(){$1(tt,st)})):z.resolve();var Ye,ct,Xe,st,ht,tt}).catch(Le)):(a(he).forEach(function(at){Wy(ee,at,he[at].primKey,he[at].indexes)}),yc(I,ee),void z.follow(function(){return I.on.populate.fire(Ce)}).catch(Le));var Je,et})}function Sm(I,$){$1(I._dbSchema,$),$.db.version%10!=0||$.objectStoreNames.contains("$meta")||$.db.createObjectStore("$meta").add(Math.ceil($.db.version/10-1),"version");var ee=qd(0,I.idbdb,$);Em(I,I._dbSchema,$);for(var oe=0,he=Cm(ee,I._dbSchema).change;oe<he.length;oe++){var Ce=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var Ve=$.objectStore(Le.name);Le.add.forEach(function(Je){$e&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(Je.src)),km(Ve,Je)})}(he[oe]);if(typeof Ce=="object")return Ce.value}}function Cm(I,$){var ee,oe={del:[],add:[],change:[]};for(ee in I)$[ee]||oe.del.push(ee);for(ee in $){var he=I[ee],Ce=$[ee];if(he){var Le={name:ee,def:Ce,recreate:!1,del:[],add:[],change:[]};if(""+(he.primKey.keyPath||"")!=""+(Ce.primKey.keyPath||"")||he.primKey.auto!==Ce.primKey.auto)Le.recreate=!0,oe.change.push(Le);else{var Ve=he.idxByName,Je=Ce.idxByName,et=void 0;for(et in Ve)Je[et]||Le.del.push(et);for(et in Je){var at=Ve[et],Ye=Je[et];at?at.src!==Ye.src&&Le.change.push(Ye):Le.add.push(Ye)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&oe.change.push(Le)}}else oe.add.push([ee,Ce])}return oe}function Wy(I,$,ee,oe){var he=I.db.createObjectStore($,ee.keyPath?{keyPath:ee.keyPath,autoIncrement:ee.auto}:{autoIncrement:ee.auto});return oe.forEach(function(Ce){return km(he,Ce)}),he}function $1(I,$){a(I).forEach(function(ee){$.db.objectStoreNames.contains(ee)||($e&&console.debug("Dexie: Creating missing table",ee),Wy($,ee,I[ee].primKey,I[ee].indexes))})}function km(I,$){I.createIndex($.name,$.keyPath,{unique:$.unique,multiEntry:$.multi})}function qd(I,$,ee){var oe={};return _($.objectStoreNames,0).forEach(function(he){for(var Ce=ee.objectStore(he),Le=Ko(xm(et=Ce.keyPath),et||"",!0,!1,!!Ce.autoIncrement,et&&typeof et!="string",!0),Ve=[],Je=0;Je<Ce.indexNames.length;++Je){var at=Ce.index(Ce.indexNames[Je]),et=at.keyPath,at=Ko(at.name,et,!!at.unique,!!at.multiEntry,!1,et&&typeof et!="string",!1);Ve.push(at)}oe[he]=$d(he,Le,Ve)}),oe}function Em(I,$,ee){for(var oe=ee.db.objectStoreNames,he=0;he<oe.length;++he){var Ce=oe[he],Le=ee.objectStore(Ce);I._hasGetAll="getAll"in Le;for(var Ve=0;Ve<Le.indexNames.length;++Ve){var Je=Le.indexNames[Ve],et=Le.index(Je).keyPath,at=typeof et=="string"?et:"["+_(et).join("+")+"]";!$[Ce]||(et=$[Ce].idxByName[at])&&(et.name=Je,delete $[Ce].idxByName[at],$[Ce].idxByName[Je]=et)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(I._hasGetAll=!1)}function z1(I){return I.split(",").map(function($,ee){var oe=($=$.trim()).replace(/([&*]|\+\+)/g,""),he=/^\[/.test(oe)?oe.match(/^\[(.*)\]$/)[1].split("+"):oe;return Ko(oe,he||null,/\&/.test($),/\*/.test($),/\+\+/.test($),o(he),ee===0)})}var HT=(Tm.prototype._parseStoresSpec=function(I,$){a(I).forEach(function(ee){if(I[ee]!==null){var oe=z1(I[ee]),he=oe.shift();if(he.unique=!0,he.multi)throw new Ee.Schema("Primary key cannot be multi-valued");oe.forEach(function(Ce){if(Ce.auto)throw new Ee.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ce.keyPath)throw new Ee.Schema("Index must have a name and cannot be an empty string")}),$[ee]=$d(ee,he,oe)}})},Tm.prototype.stores=function(ee){var $=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,ee):ee;var ee=$._versions,oe={},he={};return ee.forEach(function(Ce){l(oe,Ce._cfg.storesSource),he=Ce._cfg.dbschema={},Ce._parseStoresSpec(oe,he)}),$._dbSchema=he,Eh($,[$._allTables,$,$.Transaction.prototype]),_m($,[$._allTables,$,$.Transaction.prototype,this._cfg.tables],a(he),he),$._storeNames=a(he),this},Tm.prototype.upgrade=function(I){return this._cfg.contentUpgrade=Te(this._cfg.contentUpgrade||He,I),this},Tm);function Tm(){}function Gy(I,$){var ee=I._dbNamesDB;return ee||(ee=I._dbNamesDB=new Yo(Ta,{addons:[],indexedDB:I,IDBKeyRange:$})).version(1).stores({dbnames:"name"}),ee.table("dbnames")}function Am(I){return I&&typeof I.databases=="function"}function Ky(I){return on(function(){return Ie.letThrough=!0,I()})}function Yy(I){return!("from"in I)}var As=function(I,$){if(!this){var ee=new As;return I&&"d"in I&&l(ee,I),ee}l(this,arguments.length?{d:1,from:I,to:1<arguments.length?$:I}:{d:0})};function Ah(I,$,ee){var oe=Ar($,ee);if(!isNaN(oe)){if(0<oe)throw RangeError();if(Yy(I))return l(I,{from:$,to:ee,d:1});var he=I.l,oe=I.r;if(Ar(ee,I.from)<0)return he?Ah(he,$,ee):I.l={from:$,to:ee,d:1,l:null,r:null},q1(I);if(0<Ar($,I.to))return oe?Ah(oe,$,ee):I.r={from:$,to:ee,d:1,l:null,r:null},q1(I);Ar($,I.from)<0&&(I.from=$,I.l=null,I.d=oe?oe.d+1:1),0<Ar(ee,I.to)&&(I.to=ee,I.r=null,I.d=I.l?I.l.d+1:1),ee=!I.r,he&&!I.l&&_u(I,he),oe&&ee&&_u(I,oe)}}function _u(I,$){Yy($)||function ee(oe,Je){var Ce=Je.from,Le=Je.to,Ve=Je.l,Je=Je.r;Ah(oe,Ce,Le),Ve&&ee(oe,Ve),Je&&ee(oe,Je)}(I,$)}function U1(I,$){var ee=Rm($),oe=ee.next();if(oe.done)return!1;for(var he=oe.value,Ce=Rm(I),Le=Ce.next(he.from),Ve=Le.value;!oe.done&&!Le.done;){if(Ar(Ve.from,he.to)<=0&&0<=Ar(Ve.to,he.from))return!0;Ar(he.from,Ve.from)<0?he=(oe=ee.next(Ve.from)).value:Ve=(Le=Ce.next(he.from)).value}return!1}function Rm(I){var $=Yy(I)?null:{s:0,n:I};return{next:function(ee){for(var oe=0<arguments.length;$;)switch($.s){case 0:if($.s=1,oe)for(;$.n.l&&Ar(ee,$.n.from)<0;)$={up:$,n:$.n.l,s:1};else for(;$.n.l;)$={up:$,n:$.n.l,s:1};case 1:if($.s=2,!oe||Ar(ee,$.n.to)<=0)return{value:$.n,done:!1};case 2:if($.n.r){$.s=3,$={up:$,n:$.n.r,s:0};continue}case 3:$=$.up}return{done:!0}}}}function q1(I){var $,ee,oe=((($=I.r)===null||$===void 0?void 0:$.d)||0)-(((ee=I.l)===null||ee===void 0?void 0:ee.d)||0),he=1<oe?"r":oe<-1?"l":"";he&&($=he=="r"?"l":"r",ee=r({},I),oe=I[he],I.from=oe.from,I.to=oe.to,I[he]=oe[he],ee[he]=oe[$],(I[$]=ee).d=Zy(ee)),I.d=Zy(I)}function Zy(ee){var $=ee.r,ee=ee.l;return($?ee?Math.max($.d,ee.d):$.d:ee?ee.d:0)+1}function Im(I,$){return a($).forEach(function(ee){I[ee]?_u(I[ee],$[ee]):I[ee]=function oe(he){var Ce,Le,Ve={};for(Ce in he)d(he,Ce)&&(Le=he[Ce],Ve[Ce]=!Le||typeof Le!="object"||B.has(Le.constructor)?Le:oe(Le));return Ve}($[ee])}),I}function Xy(I,$){return I.all||$.all||Object.keys(I).some(function(ee){return $[ee]&&U1($[ee],I[ee])})}h(As.prototype,((Ia={add:function(I){return _u(this,I),this},addKey:function(I){return Ah(this,I,I),this},addKeys:function(I){var $=this;return I.forEach(function(ee){return Ah($,ee,ee)}),this},hasKey:function(I){var $=Rm(this).next(I).value;return $&&Ar($.from,I)<=0&&0<=Ar($.to,I)}})[q]=function(){return Rm(this)},Ia));var Su={},Jy={},Qy=!1;function Mm(I){Im(Jy,I),Qy||(Qy=!0,setTimeout(function(){Qy=!1,eb(Jy,!(Jy={}))},0))}function eb(I,$){$===void 0&&($=!1);var ee=new Set;if(I.all)for(var oe=0,he=Object.values(Su);oe<he.length;oe++)V1(Le=he[oe],I,ee,$);else for(var Ce in I){var Le,Ve=/^idb\:\/\/(.*)\/(.*)\//.exec(Ce);Ve&&(Ce=Ve[1],Ve=Ve[2],(Le=Su["idb://".concat(Ce,"/").concat(Ve)])&&V1(Le,I,ee,$))}ee.forEach(function(Je){return Je()})}function V1(I,$,ee,oe){for(var he=[],Ce=0,Le=Object.entries(I.queries.query);Ce<Le.length;Ce++){for(var Ve=Le[Ce],Je=Ve[0],et=[],at=0,Ye=Ve[1];at<Ye.length;at++){var ct=Ye[at];Xy($,ct.obsSet)?ct.subscribers.forEach(function(tt){return ee.add(tt)}):oe&&et.push(ct)}oe&&he.push([Je,et])}if(oe)for(var Xe=0,st=he;Xe<st.length;Xe++){var ht=st[Xe],Je=ht[0],et=ht[1];I.queries.query[Je]=et}}function WT(I){var $=I._state,ee=I._deps.indexedDB;if($.isBeingOpened||I.idbdb)return $.dbReadyPromise.then(function(){return $.dbOpenError?Gn($.dbOpenError):I});$.isBeingOpened=!0,$.dbOpenError=null,$.openComplete=!1;var oe=$.openCanceller,he=Math.round(10*I.verno),Ce=!1;function Le(){if($.openCanceller!==oe)throw new Ee.DatabaseClosed("db.open() was cancelled")}function Ve(){return new z(function(ct,Xe){if(Le(),!ee)throw new Ee.MissingAPI;var st=I.name,ht=$.autoSchema||!he?ee.open(st):ee.open(st,he);if(!ht)throw new Ee.MissingAPI;ht.onerror=So(Xe),ht.onblocked=Oe(I._fireOnBlocked),ht.onupgradeneeded=Oe(function(tt){var xt;at=ht.transaction,$.autoSchema&&!I._options.allowEmptyDB?(ht.onerror=vu,at.abort(),ht.result.close(),(xt=ee.deleteDatabase(st)).onsuccess=xt.onerror=Oe(function(){Xe(new Ee.NoSuchDatabase("Database ".concat(st," doesnt exist")))})):(at.onerror=So(Xe),tt=tt.oldVersion>Math.pow(2,62)?0:tt.oldVersion,Ye=tt<1,I.idbdb=ht.result,Ce&&Sm(I,at),Th(I,tt/10,at,Xe))},Xe),ht.onsuccess=Oe(function(){at=null;var tt,xt,Ct,kt,It,Wt=I.idbdb=ht.result,en=_(Wt.objectStoreNames);if(0<en.length)try{var qt=Wt.transaction((kt=en).length===1?kt[0]:kt,"readonly");if($.autoSchema)xt=Wt,Ct=qt,(tt=I).verno=xt.version/10,Ct=tt._dbSchema=qd(0,xt,Ct),tt._storeNames=_(xt.objectStoreNames,0),_m(tt,[tt._allTables],a(Ct),Ct);else if(Em(I,I._dbSchema,qt),((It=Cm(qd(0,(It=I).idbdb,qt),It._dbSchema)).add.length||It.change.some(function(Zt){return Zt.add.length||Zt.change.length}))&&!Ce)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Wt.close(),he=Wt.version+1,Ce=!0,ct(Ve());yc(I,qt)}catch{}Ki.push(I),Wt.onversionchange=Oe(function(Zt){$.vcFired=!0,I.on("versionchange").fire(Zt)}),Wt.onclose=Oe(function(Zt){I.on("close").fire(Zt)}),Ye&&(It=I._deps,qt=st,Wt=It.indexedDB,It=It.IDBKeyRange,Am(Wt)||qt===Ta||Gy(Wt,It).put({name:qt}).catch(He)),ct()},Xe)}).catch(function(ct){switch(ct==null?void 0:ct.name){case"UnknownError":if(0<$.PR1398_maxLoop)return $.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Ve();break;case"VersionError":if(0<he)return he=0,Ve()}return z.reject(ct)})}var Je,et=$.dbReadyResolve,at=null,Ye=!1;return z.race([oe,(typeof navigator>"u"?z.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ct){function Xe(){return indexedDB.databases().finally(ct)}Je=setInterval(Xe,100),Xe()}).finally(function(){return clearInterval(Je)}):Promise.resolve()).then(Ve)]).then(function(){return Le(),$.onReadyBeingFired=[],z.resolve(Ky(function(){return I.on.ready.fire(I.vip)})).then(function ct(){if(0<$.onReadyBeingFired.length){var Xe=$.onReadyBeingFired.reduce(Te,He);return $.onReadyBeingFired=[],z.resolve(Ky(function(){return Xe(I.vip)})).then(ct)}})}).finally(function(){$.openCanceller===oe&&($.onReadyBeingFired=null,$.isBeingOpened=!1)}).catch(function(ct){$.dbOpenError=ct;try{at&&at.abort()}catch{}return oe===$.openCanceller&&I._close(),Gn(ct)}).finally(function(){$.openComplete=!0,et()}).then(function(){var ct;return Ye&&(ct={},I.tables.forEach(function(Xe){Xe.schema.indexes.forEach(function(st){st.name&&(ct["idb://".concat(I.name,"/").concat(Xe.name,"/").concat(st.name)]=new As(-1/0,[[[]]]))}),ct["idb://".concat(I.name,"/").concat(Xe.name,"/")]=ct["idb://".concat(I.name,"/").concat(Xe.name,"/:dels")]=new As(-1/0,[[[]]])}),Ts(Bd).fire(ct),eb(ct,!0)),I})}function Rh(I){function $(Ce){return I.next(Ce)}var ee=he($),oe=he(function(Ce){return I.throw(Ce)});function he(Ce){return function(Je){var Ve=Ce(Je),Je=Ve.value;return Ve.done?Je:Je&&typeof Je.then=="function"?Je.then(ee,oe):o(Je)?Promise.all(Je).then(ee,oe):ee(Je)}}return he($)()}function bc(I,$,ee){for(var oe=o(I)?I.slice():[I],he=0;he<ee;++he)oe.push($);return oe}var GT={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(I){return r(r({},I),{table:function($){var ee=I.table($),oe=ee.schema,he={},Ce=[];function Le(Ye,ct,Xe){var st=as(Ye),ht=he[st]=he[st]||[],tt=Ye==null?0:typeof Ye=="string"?1:Ye.length,xt=0<ct,xt=r(r({},Xe),{name:xt?"".concat(st,"(virtual-from:").concat(Xe.name,")"):Xe.name,lowLevelIndex:Xe,isVirtual:xt,keyTail:ct,keyLength:tt,extractKey:Ud(Ye),unique:!xt&&Xe.unique});return ht.push(xt),xt.isPrimaryKey||Ce.push(xt),1<tt&&Le(tt===2?Ye[0]:Ye.slice(0,tt-1),ct+1,Xe),ht.sort(function(Ct,kt){return Ct.keyTail-kt.keyTail}),xt}$=Le(oe.primaryKey.keyPath,0,oe.primaryKey),he[":id"]=[$];for(var Ve=0,Je=oe.indexes;Ve<Je.length;Ve++){var et=Je[Ve];Le(et.keyPath,0,et)}function at(Ye){var ct,Xe=Ye.query.index;return Xe.isVirtual?r(r({},Ye),{query:{index:Xe.lowLevelIndex,range:(ct=Ye.query.range,Xe=Xe.keyTail,{type:ct.type===1?2:ct.type,lower:bc(ct.lower,ct.lowerOpen?I.MAX_KEY:I.MIN_KEY,Xe),lowerOpen:!0,upper:bc(ct.upper,ct.upperOpen?I.MIN_KEY:I.MAX_KEY,Xe),upperOpen:!0})}}):Ye}return r(r({},ee),{schema:r(r({},oe),{primaryKey:$,indexes:Ce,getIndexByKeyPath:function(Ye){return(Ye=he[as(Ye)])&&Ye[0]}}),count:function(Ye){return ee.count(at(Ye))},query:function(Ye){return ee.query(at(Ye))},openCursor:function(Ye){var ct=Ye.query.index,Xe=ct.keyTail,st=ct.isVirtual,ht=ct.keyLength;return st?ee.openCursor(at(Ye)).then(function(xt){return xt&&tt(xt)}):ee.openCursor(Ye);function tt(xt){return Object.create(xt,{continue:{value:function(Ct){Ct!=null?xt.continue(bc(Ct,Ye.reverse?I.MAX_KEY:I.MIN_KEY,Xe)):Ye.unique?xt.continue(xt.key.slice(0,ht).concat(Ye.reverse?I.MIN_KEY:I.MAX_KEY,Xe)):xt.continue()}},continuePrimaryKey:{value:function(Ct,kt){xt.continuePrimaryKey(bc(Ct,I.MAX_KEY,Xe),kt)}},primaryKey:{get:function(){return xt.primaryKey}},key:{get:function(){var Ct=xt.key;return ht===1?Ct[0]:Ct.slice(0,ht)}},value:{get:function(){return xt.value}}})}}})}})}};function Nm(I,$,ee,oe){return ee=ee||{},oe=oe||"",a(I).forEach(function(he){var Ce,Le,Ve;d($,he)?(Ce=I[he],Le=$[he],typeof Ce=="object"&&typeof Le=="object"&&Ce&&Le?(Ve=Q(Ce))!==Q(Le)?ee[oe+he]=$[he]:Ve==="Object"?Nm(Ce,Le,ee,oe+he+"."):Ce!==Le&&(ee[oe+he]=$[he]):Ce!==Le&&(ee[oe+he]=$[he])):ee[oe+he]=void 0}),a($).forEach(function(he){d(I,he)||(ee[oe+he]=$[he])}),ee}function jm(I,$){return $.type==="delete"?$.keys:$.keys||$.values.map(I.extractKey)}var H1={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(I){return r(r({},I),{table:function($){var ee=I.table($),oe=ee.schema.primaryKey;return r(r({},ee),{mutate:function(he){var Ce=Ie.trans,Le=Ce.table($).hook,Ve=Le.deleting,Je=Le.creating,et=Le.updating;switch(he.type){case"add":if(Je.fire===He)break;return Ce._promise("readwrite",function(){return at(he)},!0);case"put":if(Je.fire===He&&et.fire===He)break;return Ce._promise("readwrite",function(){return at(he)},!0);case"delete":if(Ve.fire===He)break;return Ce._promise("readwrite",function(){return at(he)},!0);case"deleteRange":if(Ve.fire===He)break;return Ce._promise("readwrite",function(){return function Ye(ct,Xe,st){return ee.query({trans:ct,values:!1,query:{index:oe,range:Xe},limit:st}).then(function(ht){var tt=ht.result;return at({type:"delete",keys:tt,trans:ct}).then(function(xt){return 0<xt.numFailures?Promise.reject(xt.failures[0]):tt.length<st?{failures:[],numFailures:0,lastResult:void 0}:Ye(ct,r(r({},Xe),{lower:tt[tt.length-1],lowerOpen:!0}),st)})})}(he.trans,he.range,1e4)},!0)}return ee.mutate(he);function at(Ye){var ct,Xe,st,ht=Ie.trans,tt=Ye.keys||jm(oe,Ye);if(!tt)throw new Error("Keys missing");return(Ye=Ye.type==="add"||Ye.type==="put"?r(r({},Ye),{keys:tt}):r({},Ye)).type!=="delete"&&(Ye.values=i([],Ye.values)),Ye.keys&&(Ye.keys=i([],Ye.keys)),ct=ee,st=tt,((Xe=Ye).type==="add"?Promise.resolve([]):ct.getMany({trans:Xe.trans,keys:st,cache:"immutable"})).then(function(xt){var Ct=tt.map(function(kt,It){var Wt,en,qt,Zt=xt[It],rn={onerror:null,onsuccess:null};return Ye.type==="delete"?Ve.fire.call(rn,kt,Zt,ht):Ye.type==="add"||Zt===void 0?(Wt=Je.fire.call(rn,kt,Ye.values[It],ht),kt==null&&Wt!=null&&(Ye.keys[It]=kt=Wt,oe.outbound||R(Ye.values[It],oe.keyPath,kt))):(Wt=Nm(Zt,Ye.values[It]),(en=et.fire.call(rn,Wt,kt,Zt,ht))&&(qt=Ye.values[It],Object.keys(en).forEach(function(Vt){d(qt,Vt)?qt[Vt]=en[Vt]:R(qt,Vt,en[Vt])}))),rn});return ee.mutate(Ye).then(function(kt){for(var It=kt.failures,Wt=kt.results,en=kt.numFailures,kt=kt.lastResult,qt=0;qt<tt.length;++qt){var Zt=(Wt||tt)[qt],rn=Ct[qt];Zt==null?rn.onerror&&rn.onerror(It[qt]):rn.onsuccess&&rn.onsuccess(Ye.type==="put"&&xt[qt]?Ye.values[qt]:Zt)}return{failures:It,results:Wt,numFailures:en,lastResult:kt}}).catch(function(kt){return Ct.forEach(function(It){return It.onerror&&It.onerror(kt)}),Promise.reject(kt)})})}}})}})}};function tb(I,$,ee){try{if(!$||$.keys.length<I.length)return null;for(var oe=[],he=0,Ce=0;he<$.keys.length&&Ce<I.length;++he)Ar($.keys[he],I[Ce])===0&&(oe.push(ee?H($.values[he]):$.values[he]),++Ce);return oe.length===I.length?oe:null}catch{return null}}var W1={stack:"dbcore",level:-1,create:function(I){return{table:function($){var ee=I.table($);return r(r({},ee),{getMany:function(oe){if(!oe.cache)return ee.getMany(oe);var he=tb(oe.keys,oe.trans._cache,oe.cache==="clone");return he?z.resolve(he):ee.getMany(oe).then(function(Ce){return oe.trans._cache={keys:oe.keys,values:oe.cache==="clone"?H(Ce):Ce},Ce})},mutate:function(oe){return oe.type!=="add"&&(oe.trans._cache=null),ee.mutate(oe)}})}}}};function Cu(I,$){return I.trans.mode==="readonly"&&!!I.subscr&&!I.trans.explicit&&I.trans.db._options.cache!=="disabled"&&!$.schema.primaryKey.outbound}function G1(I,$){switch(I){case"query":return $.values&&!$.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var KT={stack:"dbcore",level:0,name:"Observability",create:function(I){var $=I.schema.name,ee=new As(I.MIN_KEY,I.MAX_KEY);return r(r({},I),{transaction:function(oe,he,Ce){if(Ie.subscr&&he!=="readonly")throw new Ee.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ie.querier));return I.transaction(oe,he,Ce)},table:function(oe){var he=I.table(oe),Ce=he.schema,Le=Ce.primaryKey,Ye=Ce.indexes,Ve=Le.extractKey,Je=Le.outbound,et=Le.autoIncrement&&Ye.filter(function(Xe){return Xe.compound&&Xe.keyPath.includes(Le.keyPath)}),at=r(r({},he),{mutate:function(Xe){function st(Vt){return Vt="idb://".concat($,"/").concat(oe,"/").concat(Vt),kt[Vt]||(kt[Vt]=new As)}var ht,tt,xt,Ct=Xe.trans,kt=Xe.mutatedParts||(Xe.mutatedParts={}),It=st(""),Wt=st(":dels"),en=Xe.type,rn=Xe.type==="deleteRange"?[Xe.range]:Xe.type==="delete"?[Xe.keys]:Xe.values.length<50?[jm(Le,Xe).filter(function(Vt){return Vt}),Xe.values]:[],qt=rn[0],Zt=rn[1],rn=Xe.trans._cache;return o(qt)?(It.addKeys(qt),(rn=en==="delete"||qt.length===Zt.length?tb(qt,rn):null)||Wt.addKeys(qt),(rn||Zt)&&(ht=st,tt=rn,xt=Zt,Ce.indexes.forEach(function(Vt){var fn=ht(Vt.name||"");function Mn(sr){return sr!=null?Vt.extractKey(sr):null}function Fn(sr){return Vt.multiEntry&&o(sr)?sr.forEach(function(Ks){return fn.addKey(Ks)}):fn.addKey(sr)}(tt||xt).forEach(function(sr,Yi){var Kn=tt&&Mn(tt[Yi]),Yi=xt&&Mn(xt[Yi]);Ar(Kn,Yi)!==0&&(Kn!=null&&Fn(Kn),Yi!=null&&Fn(Yi))})}))):qt?(Zt={from:(Zt=qt.lower)!==null&&Zt!==void 0?Zt:I.MIN_KEY,to:(Zt=qt.upper)!==null&&Zt!==void 0?Zt:I.MAX_KEY},Wt.add(Zt),It.add(Zt)):(It.add(ee),Wt.add(ee),Ce.indexes.forEach(function(Vt){return st(Vt.name).add(ee)})),he.mutate(Xe).then(function(Vt){return!qt||Xe.type!=="add"&&Xe.type!=="put"||(It.addKeys(Vt.results),et&&et.forEach(function(fn){for(var Mn=Xe.values.map(function(Kn){return fn.extractKey(Kn)}),Fn=fn.keyPath.findIndex(function(Kn){return Kn===Le.keyPath}),sr=0,Ks=Vt.results.length;sr<Ks;++sr)Mn[sr][Fn]=Vt.results[sr];st(fn.name).addKeys(Mn)})),Ct.mutatedParts=Im(Ct.mutatedParts||{},kt),Vt})}}),Ye=function(st){var ht=st.query,st=ht.index,ht=ht.range;return[st,new As((st=ht.lower)!==null&&st!==void 0?st:I.MIN_KEY,(ht=ht.upper)!==null&&ht!==void 0?ht:I.MAX_KEY)]},ct={get:function(Xe){return[Le,new As(Xe.key)]},getMany:function(Xe){return[Le,new As().addKeys(Xe.keys)]},count:Ye,query:Ye,openCursor:Ye};return a(ct).forEach(function(Xe){at[Xe]=function(st){var ht=Ie.subscr,tt=!!ht,xt=Cu(Ie,he)&&G1(Xe,st)?st.obsSet={}:ht;if(tt){var Ct=function(Zt){return Zt="idb://".concat($,"/").concat(oe,"/").concat(Zt),xt[Zt]||(xt[Zt]=new As)},kt=Ct(""),It=Ct(":dels"),ht=ct[Xe](st),tt=ht[0],ht=ht[1];if((Xe==="query"&&tt.isPrimaryKey&&!st.values?It:Ct(tt.name||"")).add(ht),!tt.isPrimaryKey){if(Xe!=="count"){var Wt=Xe==="query"&&Je&&st.values&&he.query(r(r({},st),{values:!1}));return he[Xe].apply(this,arguments).then(function(Zt){if(Xe==="query"){if(Je&&st.values)return Wt.then(function(Mn){return Mn=Mn.result,kt.addKeys(Mn),Zt});var rn=st.values?Zt.result.map(Ve):Zt.result;(st.values?kt:It).addKeys(rn)}else if(Xe==="openCursor"){var Vt=Zt,fn=st.values;return Vt&&Object.create(Vt,{key:{get:function(){return It.addKey(Vt.primaryKey),Vt.key}},primaryKey:{get:function(){var Mn=Vt.primaryKey;return It.addKey(Mn),Mn}},value:{get:function(){return fn&&kt.addKey(Vt.primaryKey),Vt.value}}})}return Zt})}It.add(ee)}}return he[Xe].apply(this,arguments)}}),at}})}};function K1(I,$,ee){if(ee.numFailures===0)return $;if($.type==="deleteRange")return null;var oe=$.keys?$.keys.length:"values"in $&&$.values?$.values.length:1;return ee.numFailures===oe?null:($=r({},$),o($.keys)&&($.keys=$.keys.filter(function(he,Ce){return!(Ce in ee.failures)})),"values"in $&&o($.values)&&($.values=$.values.filter(function(he,Ce){return!(Ce in ee.failures)})),$)}function Om(I,$){return ee=I,((oe=$).lower===void 0||(oe.lowerOpen?0<Ar(ee,oe.lower):0<=Ar(ee,oe.lower)))&&(I=I,($=$).upper===void 0||($.upperOpen?Ar(I,$.upper)<0:Ar(I,$.upper)<=0));var ee,oe}function nb(I,$,ct,oe,he,Ce){if(!ct||ct.length===0)return I;var Le=$.query.index,Ve=Le.multiEntry,Je=$.query.range,et=oe.schema.primaryKey.extractKey,at=Le.extractKey,Ye=(Le.lowLevelIndex||Le).extractKey,ct=ct.reduce(function(Xe,st){var ht=Xe,tt=[];if(st.type==="add"||st.type==="put")for(var xt=new As,Ct=st.values.length-1;0<=Ct;--Ct){var kt,It=st.values[Ct],Wt=et(It);xt.hasKey(Wt)||(kt=at(It),(Ve&&o(kt)?kt.some(function(Vt){return Om(Vt,Je)}):Om(kt,Je))&&(xt.addKey(Wt),tt.push(It)))}switch(st.type){case"add":var en=new As().addKeys($.values?Xe.map(function(fn){return et(fn)}):Xe),ht=Xe.concat($.values?tt.filter(function(fn){return fn=et(fn),!en.hasKey(fn)&&(en.addKey(fn),!0)}):tt.map(function(fn){return et(fn)}).filter(function(fn){return!en.hasKey(fn)&&(en.addKey(fn),!0)}));break;case"put":var qt=new As().addKeys(st.values.map(function(fn){return et(fn)}));ht=Xe.filter(function(fn){return!qt.hasKey($.values?et(fn):fn)}).concat($.values?tt:tt.map(function(fn){return et(fn)}));break;case"delete":var Zt=new As().addKeys(st.keys);ht=Xe.filter(function(fn){return!Zt.hasKey($.values?et(fn):fn)});break;case"deleteRange":var rn=st.range;ht=Xe.filter(function(fn){return!Om(et(fn),rn)})}return ht},I);return ct===I?I:(ct.sort(function(Xe,st){return Ar(Ye(Xe),Ye(st))||Ar(et(Xe),et(st))}),$.limit&&$.limit<1/0&&(ct.length>$.limit?ct.length=$.limit:I.length===$.limit&&ct.length<$.limit&&(he.dirty=!0)),Ce?Object.freeze(ct):ct)}function Vd(I,$){return Ar(I.lower,$.lower)===0&&Ar(I.upper,$.upper)===0&&!!I.lowerOpen==!!$.lowerOpen&&!!I.upperOpen==!!$.upperOpen}function Ih(I,$){return function(ee,oe,he,Ce){if(ee===void 0)return oe!==void 0?-1:0;if(oe===void 0)return 1;if((oe=Ar(ee,oe))===0){if(he&&Ce)return 0;if(he)return 1;if(Ce)return-1}return oe}(I.lower,$.lower,I.lowerOpen,$.lowerOpen)<=0&&0<=function(ee,oe,he,Ce){if(ee===void 0)return oe!==void 0?1:0;if(oe===void 0)return-1;if((oe=Ar(ee,oe))===0){if(he&&Ce)return 0;if(he)return-1;if(Ce)return 1}return oe}(I.upper,$.upper,I.upperOpen,$.upperOpen)}function YT(I,$,ee,oe){I.subscribers.add(ee),oe.addEventListener("abort",function(){var he,Ce;I.subscribers.delete(ee),I.subscribers.size===0&&(he=I,Ce=$,setTimeout(function(){he.subscribers.size===0&&U(Ce,he)},3e3))})}var Pm={stack:"dbcore",level:0,name:"Cache",create:function(I){var $=I.schema.name;return r(r({},I),{transaction:function(ee,oe,he){var Ce,Le,Ve=I.transaction(ee,oe,he);return oe==="readwrite"&&(Le=(Ce=new AbortController).signal,he=function(Je){return function(){if(Ce.abort(),oe==="readwrite"){for(var et=new Set,at=0,Ye=ee;at<Ye.length;at++){var ct=Ye[at],Xe=Su["idb://".concat($,"/").concat(ct)];if(Xe){var st=I.table(ct),ht=Xe.optimisticOps.filter(function(fn){return fn.trans===Ve});if(Ve._explicit&&Je&&Ve.mutatedParts)for(var tt=0,xt=Object.values(Xe.queries.query);tt<xt.length;tt++)for(var Ct=0,kt=(en=xt[tt]).slice();Ct<kt.length;Ct++)Xy((qt=kt[Ct]).obsSet,Ve.mutatedParts)&&(U(en,qt),qt.subscribers.forEach(function(fn){return et.add(fn)}));else if(0<ht.length){Xe.optimisticOps=Xe.optimisticOps.filter(function(fn){return fn.trans!==Ve});for(var It=0,Wt=Object.values(Xe.queries.query);It<Wt.length;It++)for(var en,qt,Zt,rn=0,Vt=(en=Wt[It]).slice();rn<Vt.length;rn++)(qt=Vt[rn]).res!=null&&Ve.mutatedParts&&(Je&&!qt.dirty?(Zt=Object.isFrozen(qt.res),Zt=nb(qt.res,qt.req,ht,st,qt,Zt),qt.dirty?(U(en,qt),qt.subscribers.forEach(function(fn){return et.add(fn)})):Zt!==qt.res&&(qt.res=Zt,qt.promise=z.resolve({result:Zt}))):(qt.dirty&&U(en,qt),qt.subscribers.forEach(function(fn){return et.add(fn)})))}}}et.forEach(function(fn){return fn()})}}},Ve.addEventListener("abort",he(!1),{signal:Le}),Ve.addEventListener("error",he(!1),{signal:Le}),Ve.addEventListener("complete",he(!0),{signal:Le})),Ve},table:function(ee){var oe=I.table(ee),he=oe.schema.primaryKey;return r(r({},oe),{mutate:function(Ce){var Le=Ie.trans;if(he.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return oe.mutate(Ce);var Ve=Su["idb://".concat($,"/").concat(ee)];return Ve?(Le=oe.mutate(Ce),Ce.type!=="add"&&Ce.type!=="put"||!(50<=Ce.values.length||jm(he,Ce).some(function(Je){return Je==null}))?(Ve.optimisticOps.push(Ce),Ce.mutatedParts&&Mm(Ce.mutatedParts),Le.then(function(Je){0<Je.numFailures&&(U(Ve.optimisticOps,Ce),(Je=K1(0,Ce,Je))&&Ve.optimisticOps.push(Je),Ce.mutatedParts&&Mm(Ce.mutatedParts))}),Le.catch(function(){U(Ve.optimisticOps,Ce),Ce.mutatedParts&&Mm(Ce.mutatedParts)})):Le.then(function(Je){var et=K1(0,r(r({},Ce),{values:Ce.values.map(function(at,Ye){var ct;return Je.failures[Ye]?at:(at=(ct=he.keyPath)!==null&&ct!==void 0&&ct.includes(".")?H(at):r({},at),R(at,he.keyPath,Je.results[Ye]),at)})}),Je);Ve.optimisticOps.push(et),queueMicrotask(function(){return Ce.mutatedParts&&Mm(Ce.mutatedParts)})}),Le):oe.mutate(Ce)},query:function(Ce){if(!Cu(Ie,oe)||!G1("query",Ce))return oe.query(Ce);var Le=((et=Ie.trans)===null||et===void 0?void 0:et.db._options.cache)==="immutable",Ye=Ie,Ve=Ye.requery,Je=Ye.signal,et=function(st,ht,tt,xt){var Ct=Su["idb://".concat(st,"/").concat(ht)];if(!Ct)return[];if(!(ht=Ct.queries[tt]))return[null,!1,Ct,null];var kt=ht[(xt.query?xt.query.index.name:null)||""];if(!kt)return[null,!1,Ct,null];switch(tt){case"query":var It=kt.find(function(Wt){return Wt.req.limit===xt.limit&&Wt.req.values===xt.values&&Vd(Wt.req.query.range,xt.query.range)});return It?[It,!0,Ct,kt]:[kt.find(function(Wt){return("limit"in Wt.req?Wt.req.limit:1/0)>=xt.limit&&(!xt.values||Wt.req.values)&&Ih(Wt.req.query.range,xt.query.range)}),!1,Ct,kt];case"count":return It=kt.find(function(Wt){return Vd(Wt.req.query.range,xt.query.range)}),[It,!!It,Ct,kt]}}($,ee,"query",Ce),at=et[0],Ye=et[1],ct=et[2],Xe=et[3];return at&&Ye?at.obsSet=Ce.obsSet:(Ye=oe.query(Ce).then(function(st){var ht=st.result;if(at&&(at.res=ht),Le){for(var tt=0,xt=ht.length;tt<xt;++tt)Object.freeze(ht[tt]);Object.freeze(ht)}else st.result=H(ht);return st}).catch(function(st){return Xe&&at&&U(Xe,at),Promise.reject(st)}),at={obsSet:Ce.obsSet,promise:Ye,subscribers:new Set,type:"query",req:Ce,dirty:!1},Xe?Xe.push(at):(Xe=[at],(ct=ct||(Su["idb://".concat($,"/").concat(ee)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ce.query.index.name||""]=Xe)),YT(at,Xe,Ve,Je),at.promise.then(function(st){return{result:nb(st.result,Ce,ct==null?void 0:ct.optimisticOps,oe,at,Le)}})}})}})}};function Mh(I,$){return new Proxy(I,{get:function(ee,oe,he){return oe==="db"?$:Reflect.get(ee,oe,he)}})}var Yo=(Ei.prototype.version=function(I){if(isNaN(I)||I<.1)throw new Ee.Type("Given version is not a positive number");if(I=Math.round(10*I)/10,this.idbdb||this._state.isBeingOpened)throw new Ee.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,I);var $=this._versions,ee=$.filter(function(oe){return oe._cfg.version===I})[0];return ee||(ee=new this.Version(I),$.push(ee),$.sort(Hy),ee.stores({}),this._state.autoSchema=!1,ee)},Ei.prototype._whenReady=function(I){var $=this;return this.idbdb&&(this._state.openComplete||Ie.letThrough||this._vip)?I():new z(function(ee,oe){if($._state.openComplete)return oe(new Ee.DatabaseClosed($._state.dbOpenError));if(!$._state.isBeingOpened){if(!$._state.autoOpen)return void oe(new Ee.DatabaseClosed);$.open().catch(He)}$._state.dbReadyPromise.then(ee,oe)}).then(I)},Ei.prototype.use=function(I){var $=I.stack,ee=I.create,oe=I.level,he=I.name;return he&&this.unuse({stack:$,name:he}),I=this._middlewares[$]||(this._middlewares[$]=[]),I.push({stack:$,create:ee,level:oe??10,name:he}),I.sort(function(Ce,Le){return Ce.level-Le.level}),this},Ei.prototype.unuse=function(I){var $=I.stack,ee=I.name,oe=I.create;return $&&this._middlewares[$]&&(this._middlewares[$]=this._middlewares[$].filter(function(he){return oe?he.create!==oe:!!ee&&he.name!==ee})),this},Ei.prototype.open=function(){var I=this;return Ze(we,function(){return WT(I)})},Ei.prototype._close=function(){var I=this._state,$=Ki.indexOf(this);if(0<=$&&Ki.splice($,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}I.isBeingOpened||(I.dbReadyPromise=new z(function(ee){I.dbReadyResolve=ee}),I.openCanceller=new z(function(ee,oe){I.cancelOpen=oe}))},Ei.prototype.close=function(ee){var $=(ee===void 0?{disableAutoOpen:!0}:ee).disableAutoOpen,ee=this._state;$?(ee.isBeingOpened&&ee.cancelOpen(new Ee.DatabaseClosed),this._close(),ee.autoOpen=!1,ee.dbOpenError=new Ee.DatabaseClosed):(this._close(),ee.autoOpen=this._options.autoOpen||ee.isBeingOpened,ee.openComplete=!1,ee.dbOpenError=null)},Ei.prototype.delete=function(I){var $=this;I===void 0&&(I={disableAutoOpen:!0});var ee=0<arguments.length&&typeof arguments[0]!="object",oe=this._state;return new z(function(he,Ce){function Le(){$.close(I);var Ve=$._deps.indexedDB.deleteDatabase($.name);Ve.onsuccess=Oe(function(){var Je,et,at;Je=$._deps,et=$.name,at=Je.indexedDB,Je=Je.IDBKeyRange,Am(at)||et===Ta||Gy(at,Je).delete(et).catch(He),he()}),Ve.onerror=So(Ce),Ve.onblocked=$._fireOnBlocked}if(ee)throw new Ee.InvalidArgument("Invalid closeOptions argument to db.delete()");oe.isBeingOpened?oe.dbReadyPromise.then(Le):Le()})},Ei.prototype.backendDB=function(){return this.idbdb},Ei.prototype.isOpen=function(){return this.idbdb!==null},Ei.prototype.hasBeenClosed=function(){var I=this._state.dbOpenError;return I&&I.name==="DatabaseClosed"},Ei.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ei.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ei.prototype,"tables",{get:function(){var I=this;return a(this._allTables).map(function($){return I._allTables[$]})},enumerable:!1,configurable:!0}),Ei.prototype.transaction=function(){var I=(function($,ee,oe){var he=arguments.length;if(he<2)throw new Ee.InvalidArgument("Too few arguments");for(var Ce=new Array(he-1);--he;)Ce[he-1]=arguments[he];return oe=Ce.pop(),[$,O(Ce),oe]}).apply(this,arguments);return this._transaction.apply(this,I)},Ei.prototype._transaction=function(I,$,ee){var oe=this,he=Ie.trans;he&&he.db===this&&I.indexOf("!")===-1||(he=null);var Ce,Le,Ve=I.indexOf("?")!==-1;I=I.replace("!","").replace("?","");try{if(Le=$.map(function(et){if(et=et instanceof oe.Table?et.name:et,typeof et!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return et}),I=="r"||I===Gs)Ce=Gs;else{if(I!="rw"&&I!=Mi)throw new Ee.InvalidArgument("Invalid transaction mode: "+I);Ce=Mi}if(he){if(he.mode===Gs&&Ce===Mi){if(!Ve)throw new Ee.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");he=null}he&&Le.forEach(function(et){if(he&&he.storeNames.indexOf(et)===-1){if(!Ve)throw new Ee.SubTransaction("Table "+et+" not included in parent transaction.");he=null}}),Ve&&he&&!he.active&&(he=null)}}catch(et){return he?he._promise(null,function(at,Ye){Ye(et)}):Gn(et)}var Je=(function et(at,Ye,ct,Xe,st){return z.resolve().then(function(){var ht=Ie.transless||Ie,tt=at._createTransaction(Ye,ct,at._dbSchema,Xe);if(tt.explicit=!0,ht={trans:tt,transless:ht},Xe)tt.idbtrans=Xe.idbtrans;else try{tt.create(),tt.idbtrans._explicit=!0,at._state.PR1398_maxLoop=3}catch(kt){return kt.name===Pe.InvalidState&&at.isOpen()&&0<--at._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),at.close({disableAutoOpen:!1}),at.open().then(function(){return et(at,Ye,ct,null,st)})):Gn(kt)}var xt,Ct=ne(st);return Ct&&or(),ht=z.follow(function(){var kt;(xt=st.call(tt,tt))&&(Ct?(kt=xr.bind(null,null),xt.then(kt,kt)):typeof xt.next=="function"&&typeof xt.throw=="function"&&(xt=Rh(xt)))},ht),(xt&&typeof xt.then=="function"?z.resolve(xt).then(function(kt){return tt.active?kt:Gn(new Ee.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ht.then(function(){return xt})).then(function(kt){return Xe&&tt._resolve(),tt._completion.then(function(){return kt})}).catch(function(kt){return tt._reject(kt),Gn(kt)})})}).bind(null,this,Ce,Le,he,ee);return he?he._promise(Ce,Je,"lock"):Ie.trans?Ze(Ie.transless,function(){return oe._whenReady(Je)}):this._whenReady(Je)},Ei.prototype.table=function(I){if(!d(this._allTables,I))throw new Ee.InvalidTable("Table ".concat(I," does not exist"));return this._allTables[I]},Ei);function Ei(I,$){var ee=this;this._middlewares={},this.verno=0;var oe=Ei.dependencies;this._options=$=r({addons:Ei.addons,autoOpen:!0,indexedDB:oe.indexedDB,IDBKeyRange:oe.IDBKeyRange,cache:"cloned"},$),this._deps={indexedDB:$.indexedDB,IDBKeyRange:$.IDBKeyRange},oe=$.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var he,Ce,Le,Ve,Je,et={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:He,dbReadyPromise:null,cancelOpen:He,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:$.autoOpen};et.dbReadyPromise=new z(function(Ye){et.dbReadyResolve=Ye}),et.openCanceller=new z(function(Ye,ct){et.cancelOpen=ct}),this._state=et,this.name=I,this.on=gc(this,"populate","blocked","versionchange","close",{ready:[Te,He]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Ye){return function(ct,Xe){Ei.vip(function(){var st,ht=ee._state;ht.openComplete?(ht.dbOpenError||z.resolve().then(ct),Xe&&Ye(ct)):ht.onReadyBeingFired?(ht.onReadyBeingFired.push(ct),Xe&&Ye(ct)):(Ye(ct),st=ee,Xe||Ye(function tt(){st.on.ready.unsubscribe(ct),st.on.ready.unsubscribe(tt)}))})}}),this.Collection=(he=this,jd(Fd.prototype,function(xt,tt){this.db=he;var Xe=Wo,st=null;if(tt)try{Xe=tt()}catch(Ct){st=Ct}var ht=xt._ctx,tt=ht.table,xt=tt.hook.reading.fire;this._ctx={table:tt,index:ht.index,isPrimKey:!ht.index||tt.schema.primKey.keyPath&&ht.index===tt.schema.primKey.name,range:Xe,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:st,or:ht.or,valueMapper:xt!==je?xt:null}})),this.Table=(Ce=this,jd(By.prototype,function(Ye,ct,Xe){this.db=Ce,this._tx=Xe,this.name=Ye,this.schema=ct,this.hook=Ce._allTables[Ye]?Ce._allTables[Ye].hook:gc(null,{creating:[Re,He],reading:[Y,je],updating:[le,He],deleting:[ce,He]})})),this.Transaction=(Le=this,jd(Vy.prototype,function(Ye,ct,Xe,st,ht){var tt=this;this.db=Le,this.mode=Ye,this.storeNames=ct,this.schema=Xe,this.chromeTransactionDurability=st,this.idbtrans=null,this.on=gc(this,"complete","error","abort"),this.parent=ht||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new z(function(xt,Ct){tt._resolve=xt,tt._reject=Ct}),this._completion.then(function(){tt.active=!1,tt.on.complete.fire()},function(xt){var Ct=tt.active;return tt.active=!1,tt.on.error.fire(xt),tt.parent?tt.parent._reject(xt):Ct&&tt.idbtrans&&tt.idbtrans.abort(),Gn(xt)})})),this.Version=(Ve=this,jd(HT.prototype,function(Ye){this.db=Ve,this._cfg={version:Ye,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Je=this,jd(bu.prototype,function(Ye,ct,Xe){if(this.db=Je,this._ctx={table:Ye,index:ct===":id"?null:ct,or:Xe},this._cmp=this._ascending=Ar,this._descending=function(st,ht){return Ar(ht,st)},this._max=function(st,ht){return 0<Ar(st,ht)?st:ht},this._min=function(st,ht){return Ar(st,ht)<0?st:ht},this._IDBKeyRange=Je._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ee.MissingAPI})),this.on("versionchange",function(Ye){0<Ye.newVersion?console.warn("Another connection wants to upgrade database '".concat(ee.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(ee.name,"'. Closing db now to resume the delete request.")),ee.close({disableAutoOpen:!1})}),this.on("blocked",function(Ye){!Ye.newVersion||Ye.newVersion<Ye.oldVersion?console.warn("Dexie.delete('".concat(ee.name,"') was blocked")):console.warn("Upgrade '".concat(ee.name,"' blocked by other connection holding version ").concat(Ye.oldVersion/10))}),this._maxKey=zd($.IDBKeyRange),this._createTransaction=function(Ye,ct,Xe,st){return new ee.Transaction(Ye,ct,Xe,ee._options.chromeTransactionDurability,st)},this._fireOnBlocked=function(Ye){ee.on("blocked").fire(Ye),Ki.filter(function(ct){return ct.name===ee.name&&ct!==ee&&!ct._state.vcFired}).map(function(ct){return ct.on("versionchange").fire(Ye)})},this.use(W1),this.use(Pm),this.use(KT),this.use(GT),this.use(H1);var at=new Proxy(this,{get:function(Ye,ct,Xe){if(ct==="_vip")return!0;if(ct==="table")return function(ht){return Mh(ee.table(ht),at)};var st=Reflect.get(Ye,ct,Xe);return st instanceof By?Mh(st,at):ct==="tables"?st.map(function(ht){return Mh(ht,at)}):ct==="_createTransaction"?function(){return Mh(st.apply(this,arguments),at)}:st}});this.vip=at,oe.forEach(function(Ye){return Ye(ee)})}var Hd,Ia=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Y1=(Dm.prototype.subscribe=function(I,$,ee){return this._subscribe(I&&typeof I!="function"?I:{next:I,error:$,complete:ee})},Dm.prototype[Ia]=function(){return this},Dm);function Dm(I){this._subscribe=I}try{Hd={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{Hd={indexedDB:null,IDBKeyRange:null}}function Z1(I){var $,ee=!1,oe=new Y1(function(he){var Ce=ne(I),Le,Ve=!1,Je={},et={},at={get closed(){return Ve},unsubscribe:function(){Ve||(Ve=!0,Le&&Le.abort(),Ye&&Ts.storagemutated.unsubscribe(Xe))}};he.start&&he.start(at);var Ye=!1,ct=function(){return dn(st)},Xe=function(ht){Im(Je,ht),Xy(et,Je)&&ct()},st=function(){var ht,tt,xt;!Ve&&Hd.indexedDB&&(Je={},ht={},Le&&Le.abort(),Le=new AbortController,xt=function(Ct){var kt=Z();try{Ce&&or();var It=on(I,Ct);return It=Ce?It.finally(xr):It}finally{kt&&W()}}(tt={subscr:ht,signal:Le.signal,requery:ct,querier:I,trans:null}),Promise.resolve(xt).then(function(Ct){ee=!0,$=Ct,Ve||tt.signal.aborted||(Je={},function(kt){for(var It in kt)if(d(kt,It))return;return 1}(et=ht)||Ye||(Ts(Bd,Xe),Ye=!0),dn(function(){return!Ve&&he.next&&he.next(Ct)}))},function(Ct){ee=!1,["DatabaseClosedError","AbortError"].includes(Ct==null?void 0:Ct.name)||Ve||dn(function(){Ve||he.error&&he.error(Ct)})}))};return setTimeout(ct,0),at});return oe.hasValue=function(){return ee},oe.getValue=function(){return $},oe}var ku=Yo;function rb(I){var $=vc;try{vc=!0,Ts.storagemutated.fire(I),eb(I,!0)}finally{vc=$}}h(ku,r(r({},nt),{delete:function(I){return new ku(I,{addons:[]}).delete()},exists:function(I){return new ku(I,{addons:[]}).open().then(function($){return $.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(I){try{return $=ku.dependencies,ee=$.indexedDB,$=$.IDBKeyRange,(Am(ee)?Promise.resolve(ee.databases()).then(function(oe){return oe.map(function(he){return he.name}).filter(function(he){return he!==Ta})}):Gy(ee,$).toCollection().primaryKeys()).then(I)}catch{return Gn(new Ee.MissingAPI)}var $,ee},defineClass:function(){return function(I){l(this,I)}},ignoreTransaction:function(I){return Ie.trans?Ze(Ie.transless,I):I()},vip:Ky,async:function(I){return function(){try{var $=Rh(I.apply(this,arguments));return $&&typeof $.then=="function"?$:z.resolve($)}catch(ee){return Gn(ee)}}},spawn:function(I,$,ee){try{var oe=Rh(I.apply(ee,$||[]));return oe&&typeof oe.then=="function"?oe:z.resolve(oe)}catch(he){return Gn(he)}},currentTransaction:{get:function(){return Ie.trans||null}},waitFor:function(I,$){return $=z.resolve(typeof I=="function"?ku.ignoreTransaction(I):I).timeout($||6e4),Ie.trans?Ie.trans.waitFor($):$},Promise:z,debug:{get:function(){return $e},set:function(I){ke(I)}},derive:b,extend:l,props:h,override:S,Events:gc,on:Ts,liveQuery:Z1,extendObservabilitySet:Im,getByKeyPath:T,setByKeyPath:R,delByKeyPath:function(I,$){typeof $=="string"?R(I,$,void 0):"length"in $&&[].map.call($,function(ee){R(I,ee,void 0)})},shallowClone:M,deepClone:H,getObjectDiff:Nm,cmp:Ar,asap:E,minKey:-1/0,addons:[],connections:Ki,errnames:Pe,dependencies:Hd,cache:Su,semVer:"4.0.11",version:"4.0.11".split(".").map(function(I){return parseInt(I)}).reduce(function(I,$,ee){return I+$/Math.pow(10,2*ee)})})),ku.maxKey=zd(ku.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ts(Bd,function(I){vc||(I=new CustomEvent(xu,{detail:I}),vc=!0,dispatchEvent(I),vc=!1)}),addEventListener(xu,function(I){I=I.detail,vc||rb(I)}));var Wd,vc=!1,ca=function(){};return typeof BroadcastChannel<"u"&&((ca=function(){(Wd=new BroadcastChannel(xu)).onmessage=function(I){return I.data&&rb(I.data)}})(),typeof Wd.unref=="function"&&Wd.unref(),Ts(Bd,function(I){vc||Wd.postMessage(I)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(I){if(!Yo.disableBfCache&&I.persisted){$e&&console.debug("Dexie: handling persisted pagehide"),Wd!=null&&Wd.close();for(var $=0,ee=Ki;$<ee.length;$++)ee[$].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(I){!Yo.disableBfCache&&I.persisted&&($e&&console.debug("Dexie: handling persisted pageshow"),ca(),rb({all:new As(-1/0,[[]])}))})),z.rejectionMapper=function(I,$){return!I||I instanceof se||I instanceof TypeError||I instanceof SyntaxError||!I.name||!Ue[I.name]?I:($=new Ue[I.name]($||I.message,I),"stack"in I&&y($,"stack",{get:function(){return this.inner.stack}}),$)},ke($e),r(Yo,Object.freeze({__proto__:null,Dexie:Yo,liveQuery:Z1,Entity:ym,cmp:Ar,PropModification:Dd,replacePrefix:function(I,$){return new Dd({replacePrefix:[I,$]})},add:function(I){return new Dd({add:I})},remove:function(I){return new Dd({remove:I})},default:Yo,RangeSet:As,mergeRanges:_u,rangesOverlap:U1}),{default:Yo}),Yo})}(YS)),YS.exports}var Xpe=Zpe();const x3=aa(Xpe),jL=Symbol.for("Dexie"),N2=globalThis[jL]||(globalThis[jL]=x3);if(x3.semVer!==N2.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${x3.semVer} and ${N2.semVer}`);const{liveQuery:Xit,mergeRanges:Jit,rangesOverlap:Qit,RangeSet:est,cmp:tst,Entity:nst,PropModification:rst,replacePrefix:ist,add:sst,remove:ast}=N2;class Jpe extends N2{constructor(){super("LiteChatDatabase_Rewrite_v1");_e(this,"conversations");_e(this,"interactions");_e(this,"mods");_e(this,"appState");_e(this,"providerConfigs");_e(this,"apiKeys");_e(this,"syncRepos");_e(this,"projects");_e(this,"rules");_e(this,"tags");_e(this,"tagRuleLinks");this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const Nt=new Jpe,js=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class Rt{static async loadConversations(){try{return(await Nt.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>js(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await Nt.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await Nt.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await Nt.interactions.where({conversationId:t}).sortBy("index")).map(r=>js(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await Nt.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await Nt.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await Nt.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await Nt.mods.orderBy("loadOrder").toArray()).map(n=>js(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await Nt.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await Nt.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await Nt.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await Nt.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=Nt.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>js(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await Nt.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await Nt.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=Nt.apiKeys)==null?void 0:t.toArray())??[]).map(r=>js(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await Nt.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await Nt.transaction("rw",[Nt.apiKeys,Nt.providerConfigs],async()=>{const n=await Nt.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(i=>Nt.providerConfigs.update(i.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await Nt.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await Nt.syncRepos.toArray()).map(n=>js(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await Nt.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await Nt.transaction("rw",[Nt.syncRepos,Nt.conversations],async()=>{const n=await Nt.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(i=>Nt.conversations.update(i.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await Nt.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await Nt.projects.orderBy("updatedAt").reverse().toArray()).map(n=>js(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await Nt.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const i=await Nt.projects.where("parentId").equals(r).toArray();for(const s of i)await n(s.id);await Nt.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await Nt.transaction("rw",[Nt.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await Nt.rules.orderBy("name").toArray()).map(n=>js(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await Nt.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await Nt.transaction("rw",[Nt.rules,Nt.tagRuleLinks],async()=>{await Nt.tagRuleLinks.where("ruleId").equals(t).delete(),await Nt.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await Nt.tags.orderBy("name").toArray()).map(n=>js(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await Nt.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await Nt.transaction("rw",[Nt.tags,Nt.tagRuleLinks],async()=>{await Nt.tagRuleLinks.where("tagId").equals(t).delete(),await Nt.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await Nt.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await Nt.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await Nt.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await Nt.appState.toArray();n.settings={},r.forEach(i=>{i.key.startsWith("settings:")&&(n.settings[i.key.substring(9)]=i.value)})}return t.importApiKeys&&(n.apiKeys=await Nt.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await Nt.providerConfigs.toArray()),t.importProjects&&(n.projects=await Nt.projects.toArray()),t.importConversations&&(n.conversations=await Nt.conversations.toArray(),n.interactions=await Nt.interactions.toArray()),t.importRulesAndTags&&(n.rules=await Nt.rules.toArray(),n.tags=await Nt.tags.toArray(),n.tagRuleLinks=await Nt.tagRuleLinks.toArray()),t.importMods&&(n.mods=await Nt.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await Nt.syncRepos.toArray()),n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await Nt.transaction("rw",[Nt.appState,Nt.apiKeys,Nt.providerConfigs,Nt.projects,Nt.conversations,Nt.interactions,Nt.rules,Nt.tags,Nt.tagRuleLinks,Nt.mods,Nt.syncRepos],async()=>{if(n.importSettings&&await Nt.appState.clear(),n.importApiKeys&&await Nt.apiKeys.clear(),n.importProviderConfigs&&await Nt.providerConfigs.clear(),n.importProjects&&await Nt.projects.clear(),n.importConversations&&(await Nt.conversations.clear(),await Nt.interactions.clear()),n.importRulesAndTags&&(await Nt.rules.clear(),await Nt.tags.clear(),await Nt.tagRuleLinks.clear()),n.importMods&&await Nt.mods.clear(),n.importSyncRepos&&await Nt.syncRepos.clear(),n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([i,s])=>({key:`settings:${i}`,value:s}));await Nt.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await Nt.apiKeys.bulkPut(t.apiKeys.map(r=>js(r))),n.importProviderConfigs&&t.providerConfigs&&await Nt.providerConfigs.bulkPut(t.providerConfigs.map(r=>js(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await Nt.projects.bulkPut(t.projects.map(r=>js(r))),n.importConversations&&t.conversations&&(await Nt.conversations.bulkPut(t.conversations.map(r=>js(r,["lastSyncedAt"]))),t.interactions&&await Nt.interactions.bulkPut(t.interactions.map(r=>js(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await Nt.rules.bulkPut(t.rules.map(r=>js(r))),t.tags&&await Nt.tags.bulkPut(t.tags.map(r=>js(r))),t.tagRuleLinks&&await Nt.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await Nt.mods.bulkPut(t.mods.map(r=>js(r))),n.importSyncRepos&&t.syncRepos&&await Nt.syncRepos.bulkPut(t.syncRepos.map(r=>js(r,["lastPulledAt","lastPushedAt"])))})}static async clearAllData(){try{await Nt.transaction("rw",[Nt.conversations,Nt.interactions,Nt.mods,Nt.appState,Nt.providerConfigs,Nt.apiKeys,Nt.syncRepos,Nt.projects,Nt.rules,Nt.tags,Nt.tagRuleLinks],async()=>{await Nt.interactions.clear(),await Nt.conversations.clear(),await Nt.projects.clear(),await Nt.mods.clear(),await Nt.appState.clear(),await Nt.providerConfigs.clear(),await Nt.apiKeys.clear(),await Nt.syncRepos.clear(),await Nt.rules.clear(),await Nt.tags.clear(),await Nt.tagRuleLinks.clear()}),console.log("PersistenceService: All data cleared.")}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const Xn={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var Hl=vV();const tH=aa(Hl);function Qpe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const eme=e=>{switch(e){case"success":return rme;case"info":return sme;case"warning":return ime;case"error":return ame;default:return null}},tme=Array(12).fill(0),nme=({visible:e,className:t})=>ut.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},ut.createElement("div",{className:"sonner-spinner"},tme.map((n,r)=>ut.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),rme=ut.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ut.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),ime=ut.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ut.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),sme=ut.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ut.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ame=ut.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ut.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ome=ut.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ut.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ut.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),lme=()=>{const[e,t]=ut.useState(document.hidden);return ut.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let w3=1;class cme{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...i}=t,s=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:w3++,a=this.toasts.find(l=>l.id===s),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),a?this.toasts=this.toasts.map(l=>l.id===s?(this.publish({...l,...t,id:s,title:r}),{...l,...t,id:s,dismissible:o,title:r}):l):this.addToast({title:r,...i,dismissible:o,id:s}),s},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const i=Promise.resolve(t instanceof Function?t():t);let s=r!==void 0,a;const o=i.then(async c=>{if(a=["resolve",c],ut.isValidElement(c))s=!1,this.create({id:r,type:"default",message:c});else if(dme(c)&&!c.ok){s=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!ut.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){s=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!ut.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){s=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!ut.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){s=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,p=typeof u=="object"&&!ut.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...p})}}).finally(()=>{s&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||w3++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const to=new cme,ume=(e,t)=>{const n=(t==null?void 0:t.id)||w3++;return to.addToast({title:e,...t,id:n}),n},dme=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",fme=ume,hme=()=>to.toasts,pme=()=>to.getActiveToasts(),Fe=Object.assign(fme,{success:to.success,info:to.info,warning:to.warning,error:to.error,custom:to.custom,message:to.message,promise:to.promise,dismiss:to.dismiss,loading:to.loading},{getHistory:hme,getToasts:pme});Qpe("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function Y_(e){return e.label!==void 0}const mme=3,gme="24px",yme="16px",OL=4e3,bme=356,vme=14,xme=45,wme=200;function Ec(...e){return e.filter(Boolean).join(" ")}function _me(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const Sme=e=>{var t,n,r,i,s,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:p,setHeights:y,visibleToasts:b,heights:x,index:w,toasts:_,expanded:S,removeToast:C,defaultRichColors:E,closeButton:T,style:R,cancelButtonStyle:M,actionButtonStyle:N,className:O="",descriptionClassName:B="",duration:P,position:H,gap:F,expandByDefault:Q,classNames:q,icons:K,closeButtonAriaLabel:U="Close toast"}=e,[re,G]=ut.useState(null),[ne,te]=ut.useState(null),[se,pe]=ut.useState(!1),[de,Ne]=ut.useState(!1),[Pe,Me]=ut.useState(!1),[Ee,Ue]=ut.useState(!1),[nt,He]=ut.useState(!1),[je,Y]=ut.useState(0),[be,Re]=ut.useState(0),ce=ut.useRef(d.duration||P||OL),le=ut.useRef(null),ae=ut.useRef(null),Te=w===0,$e=w+1<=b,ke=d.type,ot=d.dismissible!==!1,At=d.className||"",ft=d.descriptionClassName||"",jt=ut.useMemo(()=>x.findIndex(Se=>Se.toastId===d.id)||0,[x,d.id]),Bt=ut.useMemo(()=>{var Se;return(Se=d.closeButton)!=null?Se:T},[d.closeButton,T]),Ft=ut.useMemo(()=>d.duration||P||OL,[d.duration,P]),tn=ut.useRef(0),xe=ut.useRef(0),D=ut.useRef(0),X=ut.useRef(null),[me,De]=H.split("-"),we=ut.useMemo(()=>x.reduce((Se,ze,Tt)=>Tt>=jt?Se:Se+ze.height,0),[x,jt]),Ie=lme(),fe=d.invert||u,yt=ke==="loading";xe.current=ut.useMemo(()=>jt*F+we,[jt,we]),ut.useEffect(()=>{ce.current=Ft},[Ft]),ut.useEffect(()=>{pe(!0)},[]),ut.useEffect(()=>{const Se=ae.current;if(Se){const ze=Se.getBoundingClientRect().height;return Re(ze),y(Tt=>[{toastId:d.id,height:ze,position:d.position},...Tt]),()=>y(Tt=>Tt.filter(ge=>ge.toastId!==d.id))}},[y,d.id]),ut.useLayoutEffect(()=>{if(!se)return;const Se=ae.current,ze=Se.style.height;Se.style.height="auto";const Tt=Se.getBoundingClientRect().height;Se.style.height=ze,Re(Tt),y(ge=>ge.find(W=>W.toastId===d.id)?ge.map(W=>W.toastId===d.id?{...W,height:Tt}:W):[{toastId:d.id,height:Tt,position:d.position},...ge])},[se,d.title,d.description,y,d.id]);const _t=ut.useCallback(()=>{Ne(!0),Y(xe.current),y(Se=>Se.filter(ze=>ze.toastId!==d.id)),setTimeout(()=>{C(d)},wme)},[d,C,y,xe]);ut.useEffect(()=>{if(d.promise&&ke==="loading"||d.duration===1/0||d.type==="loading")return;let Se;return S||p||Ie?(()=>{if(D.current<tn.current){const ge=new Date().getTime()-tn.current;ce.current=ce.current-ge}D.current=new Date().getTime()})():(()=>{ce.current!==1/0&&(tn.current=new Date().getTime(),Se=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),_t()},ce.current))})(),()=>clearTimeout(Se)},[S,p,d,ke,Ie,_t]),ut.useEffect(()=>{d.delete&&_t()},[_t,d.delete]);function z(){var Se;if(K!=null&&K.loading){var ze;return ut.createElement("div",{className:Ec(q==null?void 0:q.loader,d==null||(ze=d.classNames)==null?void 0:ze.loader,"sonner-loader"),"data-visible":ke==="loading"},K.loading)}return ut.createElement(nme,{className:Ec(q==null?void 0:q.loader,d==null||(Se=d.classNames)==null?void 0:Se.loader),visible:ke==="loading"})}const qe=d.icon||(K==null?void 0:K[ke])||eme(ke);var rt,ve;return ut.createElement("li",{tabIndex:0,ref:ae,className:Ec(O,At,q==null?void 0:q.toast,d==null||(t=d.classNames)==null?void 0:t.toast,q==null?void 0:q.default,q==null?void 0:q[ke],d==null||(n=d.classNames)==null?void 0:n[ke]),"data-sonner-toast":"","data-rich-colors":(rt=d.richColors)!=null?rt:E,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":se,"data-promise":!!d.promise,"data-swiped":nt,"data-removed":de,"data-visible":$e,"data-y-position":me,"data-x-position":De,"data-index":w,"data-front":Te,"data-swiping":Pe,"data-dismissible":ot,"data-type":ke,"data-invert":fe,"data-swipe-out":Ee,"data-swipe-direction":ne,"data-expanded":!!(S||Q&&se),style:{"--index":w,"--toasts-before":w,"--z-index":_.length-w,"--offset":`${de?je:xe.current}px`,"--initial-height":Q?"auto":`${be}px`,...R,...d.style},onDragEnd:()=>{Me(!1),G(null),X.current=null},onPointerDown:Se=>{yt||!ot||(le.current=new Date,Y(xe.current),Se.target.setPointerCapture(Se.pointerId),Se.target.tagName!=="BUTTON"&&(Me(!0),X.current={x:Se.clientX,y:Se.clientY}))},onPointerUp:()=>{var Se,ze,Tt;if(Ee||!ot)return;X.current=null;const ge=Number(((Se=ae.current)==null?void 0:Se.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Z=Number(((ze=ae.current)==null?void 0:ze.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),W=new Date().getTime()-((Tt=le.current)==null?void 0:Tt.getTime()),J=re==="x"?ge:Z,ye=Math.abs(J)/W;if(Math.abs(J)>=xme||ye>.11){Y(xe.current),d.onDismiss==null||d.onDismiss.call(d,d),te(re==="x"?ge>0?"right":"left":Z>0?"down":"up"),_t(),Ue(!0);return}else{var Oe,We;(Oe=ae.current)==null||Oe.style.setProperty("--swipe-amount-x","0px"),(We=ae.current)==null||We.style.setProperty("--swipe-amount-y","0px")}He(!1),Me(!1),G(null)},onPointerMove:Se=>{var ze,Tt,ge;if(!X.current||!ot||((ze=window.getSelection())==null?void 0:ze.toString().length)>0)return;const W=Se.clientY-X.current.y,J=Se.clientX-X.current.x;var ye;const Oe=(ye=e.swipeDirections)!=null?ye:_me(H);!re&&(Math.abs(J)>1||Math.abs(W)>1)&&G(Math.abs(J)>Math.abs(W)?"x":"y");let We={x:0,y:0};const vt=Xt=>1/(1.5+Math.abs(Xt)/20);if(re==="y"){if(Oe.includes("top")||Oe.includes("bottom"))if(Oe.includes("top")&&W<0||Oe.includes("bottom")&&W>0)We.y=W;else{const Xt=W*vt(W);We.y=Math.abs(Xt)<Math.abs(W)?Xt:W}}else if(re==="x"&&(Oe.includes("left")||Oe.includes("right")))if(Oe.includes("left")&&J<0||Oe.includes("right")&&J>0)We.x=J;else{const Xt=J*vt(J);We.x=Math.abs(Xt)<Math.abs(J)?Xt:J}(Math.abs(We.x)>0||Math.abs(We.y)>0)&&He(!0),(Tt=ae.current)==null||Tt.style.setProperty("--swipe-amount-x",`${We.x}px`),(ge=ae.current)==null||ge.style.setProperty("--swipe-amount-y",`${We.y}px`)}},Bt&&!d.jsx&&ke!=="loading"?ut.createElement("button",{"aria-label":U,"data-disabled":yt,"data-close-button":!0,onClick:yt||!ot?()=>{}:()=>{_t(),d.onDismiss==null||d.onDismiss.call(d,d)},className:Ec(q==null?void 0:q.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(ve=K==null?void 0:K.close)!=null?ve:ome):null,(ke||d.icon||d.promise)&&d.icon!==null&&((K==null?void 0:K[ke])!==null||d.icon)?ut.createElement("div",{"data-icon":"",className:Ec(q==null?void 0:q.icon,d==null||(i=d.classNames)==null?void 0:i.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||z():null,d.type!=="loading"?qe:null):null,ut.createElement("div",{"data-content":"",className:Ec(q==null?void 0:q.content,d==null||(s=d.classNames)==null?void 0:s.content)},ut.createElement("div",{"data-title":"",className:Ec(q==null?void 0:q.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?ut.createElement("div",{"data-description":"",className:Ec(B,ft,q==null?void 0:q.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),ut.isValidElement(d.cancel)?d.cancel:d.cancel&&Y_(d.cancel)?ut.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||M,onClick:Se=>{Y_(d.cancel)&&ot&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,Se),_t())},className:Ec(q==null?void 0:q.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,ut.isValidElement(d.action)?d.action:d.action&&Y_(d.action)?ut.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||N,onClick:Se=>{Y_(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,Se),!Se.defaultPrevented&&_t())},className:Ec(q==null?void 0:q.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function PL(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Cme(e,t){const n={};return[e,t].forEach((r,i)=>{const s=i===1,a=s?"--mobile-offset":"--offset",o=s?yme:gme;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const kme=ut.forwardRef(function(t,n){const{invert:r,position:i="bottom-right",hotkey:s=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:p,style:y,visibleToasts:b=mme,toastOptions:x,dir:w=PL(),gap:_=vme,icons:S,containerAriaLabel:C="Notifications"}=t,[E,T]=ut.useState([]),R=ut.useMemo(()=>Array.from(new Set([i].concat(E.filter(ne=>ne.position).map(ne=>ne.position)))),[E,i]),[M,N]=ut.useState([]),[O,B]=ut.useState(!1),[P,H]=ut.useState(!1),[F,Q]=ut.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),q=ut.useRef(null),K=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),U=ut.useRef(null),re=ut.useRef(!1),G=ut.useCallback(ne=>{T(te=>{var se;return(se=te.find(pe=>pe.id===ne.id))!=null&&se.delete||to.dismiss(ne.id),te.filter(({id:pe})=>pe!==ne.id)})},[]);return ut.useEffect(()=>to.subscribe(ne=>{if(ne.dismiss){requestAnimationFrame(()=>{T(te=>te.map(se=>se.id===ne.id?{...se,delete:!0}:se))});return}setTimeout(()=>{tH.flushSync(()=>{T(te=>{const se=te.findIndex(pe=>pe.id===ne.id);return se!==-1?[...te.slice(0,se),{...te[se],...ne},...te.slice(se+1)]:[ne,...te]})})})}),[E]),ut.useEffect(()=>{if(d!=="system"){Q(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Q("dark"):Q("light")),typeof window>"u")return;const ne=window.matchMedia("(prefers-color-scheme: dark)");try{ne.addEventListener("change",({matches:te})=>{Q(te?"dark":"light")})}catch{ne.addListener(({matches:se})=>{try{Q(se?"dark":"light")}catch(pe){console.error(pe)}})}},[d]),ut.useEffect(()=>{E.length<=1&&B(!1)},[E]),ut.useEffect(()=>{const ne=te=>{var se;if(s.every(Ne=>te[Ne]||te.code===Ne)){var de;B(!0),(de=q.current)==null||de.focus()}te.code==="Escape"&&(document.activeElement===q.current||(se=q.current)!=null&&se.contains(document.activeElement))&&B(!1)};return document.addEventListener("keydown",ne),()=>document.removeEventListener("keydown",ne)},[s]),ut.useEffect(()=>{if(q.current)return()=>{U.current&&(U.current.focus({preventScroll:!0}),U.current=null,re.current=!1)}},[q.current]),ut.createElement("section",{ref:n,"aria-label":`${C} ${K}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},R.map((ne,te)=>{var se;const[pe,de]=ne.split("-");return E.length?ut.createElement("ol",{key:ne,dir:w==="auto"?PL():w,tabIndex:-1,ref:q,className:l,"data-sonner-toaster":!0,"data-sonner-theme":F,"data-y-position":pe,"data-lifted":O&&E.length>1&&!a,"data-x-position":de,style:{"--front-toast-height":`${((se=M[0])==null?void 0:se.height)||0}px`,"--width":`${bme}px`,"--gap":`${_}px`,...y,...Cme(c,u)},onBlur:Ne=>{re.current&&!Ne.currentTarget.contains(Ne.relatedTarget)&&(re.current=!1,U.current&&(U.current.focus({preventScroll:!0}),U.current=null))},onFocus:Ne=>{Ne.target instanceof HTMLElement&&Ne.target.dataset.dismissible==="false"||re.current||(re.current=!0,U.current=Ne.relatedTarget)},onMouseEnter:()=>B(!0),onMouseMove:()=>B(!0),onMouseLeave:()=>{P||B(!1)},onDragEnd:()=>B(!1),onPointerDown:Ne=>{Ne.target instanceof HTMLElement&&Ne.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},E.filter(Ne=>!Ne.position&&te===0||Ne.position===ne).map((Ne,Pe)=>{var Me,Ee;return ut.createElement(Sme,{key:Ne.id,icons:S,index:Pe,toast:Ne,defaultRichColors:h,duration:(Me=x==null?void 0:x.duration)!=null?Me:p,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ee=x==null?void 0:x.closeButton)!=null?Ee:o,interacting:P,position:ne,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,closeButtonAriaLabel:x==null?void 0:x.closeButtonAriaLabel,removeToast:G,toasts:E.filter(Ue=>Ue.position==Ne.position),heights:M.filter(Ue=>Ue.position==Ne.position),setHeights:N,expandByDefault:a,gap:_,expanded:O,swipeDirections:t.swipeDirections})})):null}))}),On=_l(Sl((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Be.emit(Xn.statusChanged,{status:"loading"});try{const i=await Rt.loadInteractionsForConversation(n);i.sort((l,c)=>l.index-c.index);const s=t().interactions.filter(l=>l.conversationId===n),a=new Set(i.map(l=>l.id)),o=[...i,...s.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Be.emit(Xn.loaded,{conversationId:n,interactions:o}),Be.emit(Xn.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(i){console.error(`InteractionStore: Error loading interactions for ${n}`,i),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Be.emit(Xn.statusChanged,{status:"error"}),Be.emit(Xn.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(i=>i.id===n.id))r.interactions.push(n),r.interactions.sort((i,s)=>i.index-s.index);else{const i=r.interactions.findIndex(s=>s.id===n.id);i!==-1&&(r.interactions[i]={...r.interactions[i],...n})}}),Be.emit(Xn.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(i=>{const s=i.interactions.findIndex(a=>a.id===n);if(s!==-1){if(i.currentConversationId!==i.interactions[s].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${i.currentConversationId}. Skipping.`);return}const a=i.interactions[s];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),i.interactions[s]=l}}),Be.emit(Xn.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(i=>{var s;i.streamingInteractionIds.includes(n)&&i.currentConversationId===((s=i.interactions.find(a=>a.id===n))==null?void 0:s.conversationId)&&(i.activeStreamBuffers[n]=(i.activeStreamBuffers[n]||"")+r)}),Be.emit(Xn.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(i=>{var s;i.streamingInteractionIds.includes(n)&&i.currentConversationId===((s=i.interactions.find(a=>a.id===n))==null?void 0:s.conversationId)&&(i.activeReasoningBuffers[n]=(i.activeReasoningBuffers[n]||"")+r)}),Be.emit(Xn.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(i=>i.id!==n)})},rateInteraction:async(n,r)=>{const i=t().interactions.find(s=>s.id===n);if(i&&t().currentConversationId===i.conversationId){t()._updateInteractionInState(n,{rating:r});try{await Rt.saveInteraction({...i,rating:r}),Be.emit(Xn.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:i.rating}),Fe.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Be.emit(Xn.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Be.emit(Xn.statusChanged,{status:"idle"}),Be.emit(Xn.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let i="idle";e(s=>{s.error=n,n?(i="error",s.status="error"):s.status==="error"?(i=s.streamingInteractionIds.length>0?"streaming":"idle",s.status=i):i=s.status}),r!==i&&Be.emit(Xn.statusChanged,{status:i}),Be.emit(Xn.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Be.emit(Xn.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(i=>{i.streamingInteractionIds.includes(n)||(i.streamingInteractionIds.push(n),i.activeStreamBuffers[n]="",i.activeReasoningBuffers[n]="",i.streamingInteractionIds.length===1&&(i.status="streaming",r=!0),i.error=null)}),r&&Be.emit(Xn.statusChanged,{status:"streaming"}),Be.emit(Xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(i=>{const s=i.streamingInteractionIds.indexOf(n);s!==-1&&(i.streamingInteractionIds.splice(s,1),delete i.activeStreamBuffers[n],delete i.activeReasoningBuffers[n],i.streamingInteractionIds.length===0&&i.status==="streaming"&&(i.status=i.error?"error":"idle",r=!0))}),r&&Be.emit(Xn.statusChanged,{status:t().status}),Be.emit(Xn.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:Xn.loadInteractionsRequest,handler:i=>r.loadInteractions(i.conversationId),storeId:n},{eventName:Xn.rateInteractionRequest,handler:i=>r.rateInteraction(i.interactionId,i.rating),storeId:n},{eventName:Xn.setCurrentConversationIdRequest,handler:i=>r.setCurrentConversationId(i.id),storeId:n},{eventName:Xn.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:Xn.setErrorRequest,handler:i=>r.setError(i.error),storeId:n},{eventName:Xn.setStatusRequest,handler:i=>r.setStatus(i.status),storeId:n}]}}))),Eme="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let zs=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=Eme[n[e]&63];return t};const hl={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},Of=_l(Sl((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(i=>{if(i.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:zs(),...n};i.attachedFilesMetadata.push(a),r=!0}}),r&&Be.emit(hl.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(i=>{const s=i.attachedFilesMetadata.length;i.attachedFilesMetadata=i.attachedFilesMetadata.filter(a=>a.id!==n),r=i.attachedFilesMetadata.length<s}),r&&Be.emit(hl.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Be.emit(hl.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:hl.addAttachedFileRequest,handler:i=>r.addAttachedFile(i),storeId:n},{eventName:hl.removeAttachedFileRequest,handler:i=>r.removeAttachedFile(i.attachmentId),storeId:n},{eventName:hl.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),nH=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(nH);const tx=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const i="."+n.split(".").pop();return nH.has(i)};var rH="vercel.ai.error",Tme=Symbol.for(rH),iH,Ame=class sH extends Error{constructor({name:t,message:n,cause:r}){super(n),this[iH]=!0,this.name=t,this.cause=r}static isInstance(t){return sH.hasMarker(t,rH)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};iH=Tme;var nr=Ame,aH="AI_APICallError",oH=`vercel.ai.error.${aH}`,Rme=Symbol.for(oH),lH,gl=class extends nr{constructor({message:t,url:n,requestBodyValues:r,statusCode:i,responseHeaders:s,responseBody:a,cause:o,isRetryable:l=i!=null&&(i===408||i===409||i===429||i>=500),data:c}){super({name:aH,message:t,cause:o}),this[lH]=!0,this.url=n,this.requestBodyValues=r,this.statusCode=i,this.responseHeaders=s,this.responseBody=a,this.isRetryable=l,this.data=c}static isInstance(t){return nr.hasMarker(t,oH)}};lH=Rme;var cH="AI_EmptyResponseBodyError",uH=`vercel.ai.error.${cH}`,Ime=Symbol.for(uH),dH,fH=class extends nr{constructor({message:t="Empty response body"}={}){super({name:cH,message:t}),this[dH]=!0}static isInstance(t){return nr.hasMarker(t,uH)}};dH=Ime;function Aw(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var hH="AI_InvalidArgumentError",pH=`vercel.ai.error.${hH}`,Mme=Symbol.for(pH),mH,gH=class extends nr{constructor({message:t,cause:n,argument:r}){super({name:hH,message:t,cause:n}),this[mH]=!0,this.argument=r}static isInstance(t){return nr.hasMarker(t,pH)}};mH=Mme;var yH="AI_InvalidPromptError",bH=`vercel.ai.error.${yH}`,Nme=Symbol.for(bH),vH,Lc=class extends nr{constructor({prompt:t,message:n,cause:r}){super({name:yH,message:`Invalid prompt: ${n}`,cause:r}),this[vH]=!0,this.prompt=t}static isInstance(t){return nr.hasMarker(t,bH)}};vH=Nme;var xH="AI_InvalidResponseDataError",wH=`vercel.ai.error.${xH}`,jme=Symbol.for(wH),_H,Bg=class extends nr{constructor({data:t,message:n=`Invalid response data: ${JSON.stringify(t)}.`}){super({name:xH,message:n}),this[_H]=!0,this.data=t}static isInstance(t){return nr.hasMarker(t,wH)}};_H=jme;var SH="AI_JSONParseError",CH=`vercel.ai.error.${SH}`,Ome=Symbol.for(CH),kH,j2=class extends nr{constructor({text:t,cause:n}){super({name:SH,message:`JSON parsing failed: Text: ${t}.
Error message: ${Aw(n)}`,cause:n}),this[kH]=!0,this.text=t}static isInstance(t){return nr.hasMarker(t,CH)}};kH=Ome;var EH="AI_LoadAPIKeyError",TH=`vercel.ai.error.${EH}`,Pme=Symbol.for(TH),AH,Z_=class extends nr{constructor({message:t}){super({name:EH,message:t}),this[AH]=!0}static isInstance(t){return nr.hasMarker(t,TH)}};AH=Pme;var RH="AI_TooManyEmbeddingValuesForCallError",IH=`vercel.ai.error.${RH}`,Dme=Symbol.for(IH),MH,Uk=class extends nr{constructor(e){super({name:RH,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[MH]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return nr.hasMarker(e,IH)}};MH=Dme;var NH="AI_TypeValidationError",jH=`vercel.ai.error.${NH}`,Fme=Symbol.for(jH),OH,Lme=class _3 extends nr{constructor({value:t,cause:n}){super({name:NH,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${Aw(n)}`,cause:n}),this[OH]=!0,this.value=t}static isInstance(t){return nr.hasMarker(t,jH)}static wrap({value:t,cause:n}){return _3.isInstance(n)&&n.value===t?n:new _3({value:t,cause:n})}};OH=Fme;var O2=Lme,PH="AI_UnsupportedFunctionalityError",DH=`vercel.ai.error.${PH}`,Bme=Symbol.for(DH),FH,Wr=class extends nr{constructor({functionality:t,message:n=`'${t}' functionality not supported.`}){super({name:PH,message:n}),this[FH]=!0,this.functionality=t}static isInstance(t){return nr.hasMarker(t,DH)}};FH=Bme;let $me=(e,t=21)=>(n=t)=>{let r="",i=n|0;for(;i--;)r+=e[Math.random()*e.length|0];return r};var oO={},qk={};qk.byteLength=qme;qk.toByteArray=Hme;qk.fromByteArray=Kme;var $c=[],ul=[],zme=typeof Uint8Array<"u"?Uint8Array:Array,zR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var og=0,Ume=zR.length;og<Ume;++og)$c[og]=zR[og],ul[zR.charCodeAt(og)]=og;ul[45]=62;ul[95]=63;function LH(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function qme(e){var t=LH(e),n=t[0],r=t[1];return(n+r)*3/4-r}function Vme(e,t,n){return(t+n)*3/4-n}function Hme(e){var t,n=LH(e),r=n[0],i=n[1],s=new zme(Vme(e,r,i)),a=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)t=ul[e.charCodeAt(l)]<<18|ul[e.charCodeAt(l+1)]<<12|ul[e.charCodeAt(l+2)]<<6|ul[e.charCodeAt(l+3)],s[a++]=t>>16&255,s[a++]=t>>8&255,s[a++]=t&255;return i===2&&(t=ul[e.charCodeAt(l)]<<2|ul[e.charCodeAt(l+1)]>>4,s[a++]=t&255),i===1&&(t=ul[e.charCodeAt(l)]<<10|ul[e.charCodeAt(l+1)]<<4|ul[e.charCodeAt(l+2)]>>2,s[a++]=t>>8&255,s[a++]=t&255),s}function Wme(e){return $c[e>>18&63]+$c[e>>12&63]+$c[e>>6&63]+$c[e&63]}function Gme(e,t,n){for(var r,i=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(e[s+2]&255),i.push(Wme(r));return i.join("")}function Kme(e){for(var t,n=e.length,r=n%3,i=[],s=16383,a=0,o=n-r;a<o;a+=s)i.push(Gme(e,a,a+s>o?o:a+s));return r===1?(t=e[n-1],i.push($c[t>>2]+$c[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],i.push($c[t>>10]+$c[t>>4&63]+$c[t<<2&63]+"=")),i.join("")}var lO={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */lO.read=function(e,t,n,r,i){var s,a,o=i*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,s=p&(1<<-u)-1,p>>=-u,u+=o;u>0;s=s*256+e[t+d],d+=h,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(s===0)s=1-c;else{if(s===l)return a?NaN:(p?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-c}return(p?-1:1)*a*Math.pow(2,s-r)};lO.write=function(e,t,n,r,i,s){var a,o,l,c=s*8-i-1,u=(1<<c)-1,d=u>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,i),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=o&255,p+=y,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;e[n+p]=a&255,p+=y,a/=256,c-=8);e[n+p-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=qk,n=lO,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=E,e.INSPECT_MAX_BYTES=50;const i=2147483647;e.kMaxLength=i;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const xe=new s(1),D={foo:function(){return 42}};return Object.setPrototypeOf(D,s.prototype),Object.setPrototypeOf(xe,D),xe.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(xe){if(xe>i)throw new RangeError('The value "'+xe+'" is invalid for option "size"');const D=new s(xe);return Object.setPrototypeOf(D,u.prototype),D}function u(xe,D,X){if(typeof xe=="number"){if(typeof D=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(xe)}return d(xe,D,X)}u.poolSize=8192;function d(xe,D,X){if(typeof xe=="string")return b(xe,D);if(a.isView(xe))return w(xe);if(xe==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe);if(ft(xe,a)||xe&&ft(xe.buffer,a)||typeof o<"u"&&(ft(xe,o)||xe&&ft(xe.buffer,o)))return _(xe,D,X);if(typeof xe=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const me=xe.valueOf&&xe.valueOf();if(me!=null&&me!==xe)return u.from(me,D,X);const De=S(xe);if(De)return De;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof xe[Symbol.toPrimitive]=="function")return u.from(xe[Symbol.toPrimitive]("string"),D,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xe)}u.from=function(xe,D,X){return d(xe,D,X)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function h(xe){if(typeof xe!="number")throw new TypeError('"size" argument must be of type number');if(xe<0)throw new RangeError('The value "'+xe+'" is invalid for option "size"')}function p(xe,D,X){return h(xe),xe<=0?c(xe):D!==void 0?typeof X=="string"?c(xe).fill(D,X):c(xe).fill(D):c(xe)}u.alloc=function(xe,D,X){return p(xe,D,X)};function y(xe){return h(xe),c(xe<0?0:C(xe)|0)}u.allocUnsafe=function(xe){return y(xe)},u.allocUnsafeSlow=function(xe){return y(xe)};function b(xe,D){if((typeof D!="string"||D==="")&&(D="utf8"),!u.isEncoding(D))throw new TypeError("Unknown encoding: "+D);const X=T(xe,D)|0;let me=c(X);const De=me.write(xe,D);return De!==X&&(me=me.slice(0,De)),me}function x(xe){const D=xe.length<0?0:C(xe.length)|0,X=c(D);for(let me=0;me<D;me+=1)X[me]=xe[me]&255;return X}function w(xe){if(ft(xe,s)){const D=new s(xe);return _(D.buffer,D.byteOffset,D.byteLength)}return x(xe)}function _(xe,D,X){if(D<0||xe.byteLength<D)throw new RangeError('"offset" is outside of buffer bounds');if(xe.byteLength<D+(X||0))throw new RangeError('"length" is outside of buffer bounds');let me;return D===void 0&&X===void 0?me=new s(xe):X===void 0?me=new s(xe,D):me=new s(xe,D,X),Object.setPrototypeOf(me,u.prototype),me}function S(xe){if(u.isBuffer(xe)){const D=C(xe.length)|0,X=c(D);return X.length===0||xe.copy(X,0,0,D),X}if(xe.length!==void 0)return typeof xe.length!="number"||jt(xe.length)?c(0):x(xe);if(xe.type==="Buffer"&&Array.isArray(xe.data))return x(xe.data)}function C(xe){if(xe>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return xe|0}function E(xe){return+xe!=xe&&(xe=0),u.alloc(+xe)}u.isBuffer=function(D){return D!=null&&D._isBuffer===!0&&D!==u.prototype},u.compare=function(D,X){if(ft(D,s)&&(D=u.from(D,D.offset,D.byteLength)),ft(X,s)&&(X=u.from(X,X.offset,X.byteLength)),!u.isBuffer(D)||!u.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(D===X)return 0;let me=D.length,De=X.length;for(let we=0,Ie=Math.min(me,De);we<Ie;++we)if(D[we]!==X[we]){me=D[we],De=X[we];break}return me<De?-1:De<me?1:0},u.isEncoding=function(D){switch(String(D).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(D,X){if(!Array.isArray(D))throw new TypeError('"list" argument must be an Array of Buffers');if(D.length===0)return u.alloc(0);let me;if(X===void 0)for(X=0,me=0;me<D.length;++me)X+=D[me].length;const De=u.allocUnsafe(X);let we=0;for(me=0;me<D.length;++me){let Ie=D[me];if(ft(Ie,s))we+Ie.length>De.length?(u.isBuffer(Ie)||(Ie=u.from(Ie)),Ie.copy(De,we)):s.prototype.set.call(De,Ie,we);else if(u.isBuffer(Ie))Ie.copy(De,we);else throw new TypeError('"list" argument must be an Array of Buffers');we+=Ie.length}return De};function T(xe,D){if(u.isBuffer(xe))return xe.length;if(a.isView(xe)||ft(xe,a))return xe.byteLength;if(typeof xe!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof xe);const X=xe.length,me=arguments.length>2&&arguments[2]===!0;if(!me&&X===0)return 0;let De=!1;for(;;)switch(D){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return Te(xe).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return ot(xe).length;default:if(De)return me?-1:Te(xe).length;D=(""+D).toLowerCase(),De=!0}}u.byteLength=T;function R(xe,D,X){let me=!1;if((D===void 0||D<0)&&(D=0),D>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,D>>>=0,X<=D))return"";for(xe||(xe="utf8");;)switch(xe){case"hex":return te(this,D,X);case"utf8":case"utf-8":return K(this,D,X);case"ascii":return G(this,D,X);case"latin1":case"binary":return ne(this,D,X);case"base64":return q(this,D,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se(this,D,X);default:if(me)throw new TypeError("Unknown encoding: "+xe);xe=(xe+"").toLowerCase(),me=!0}}u.prototype._isBuffer=!0;function M(xe,D,X){const me=xe[D];xe[D]=xe[X],xe[X]=me}u.prototype.swap16=function(){const D=this.length;if(D%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<D;X+=2)M(this,X,X+1);return this},u.prototype.swap32=function(){const D=this.length;if(D%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<D;X+=4)M(this,X,X+3),M(this,X+1,X+2);return this},u.prototype.swap64=function(){const D=this.length;if(D%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<D;X+=8)M(this,X,X+7),M(this,X+1,X+6),M(this,X+2,X+5),M(this,X+3,X+4);return this},u.prototype.toString=function(){const D=this.length;return D===0?"":arguments.length===0?K(this,0,D):R.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(D){if(!u.isBuffer(D))throw new TypeError("Argument must be a Buffer");return this===D?!0:u.compare(this,D)===0},u.prototype.inspect=function(){let D="";const X=e.INSPECT_MAX_BYTES;return D=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(D+=" ... "),"<Buffer "+D+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(D,X,me,De,we){if(ft(D,s)&&(D=u.from(D,D.offset,D.byteLength)),!u.isBuffer(D))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof D);if(X===void 0&&(X=0),me===void 0&&(me=D?D.length:0),De===void 0&&(De=0),we===void 0&&(we=this.length),X<0||me>D.length||De<0||we>this.length)throw new RangeError("out of range index");if(De>=we&&X>=me)return 0;if(De>=we)return-1;if(X>=me)return 1;if(X>>>=0,me>>>=0,De>>>=0,we>>>=0,this===D)return 0;let Ie=we-De,fe=me-X;const yt=Math.min(Ie,fe),_t=this.slice(De,we),z=D.slice(X,me);for(let qe=0;qe<yt;++qe)if(_t[qe]!==z[qe]){Ie=_t[qe],fe=z[qe];break}return Ie<fe?-1:fe<Ie?1:0};function N(xe,D,X,me,De){if(xe.length===0)return-1;if(typeof X=="string"?(me=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,jt(X)&&(X=De?0:xe.length-1),X<0&&(X=xe.length+X),X>=xe.length){if(De)return-1;X=xe.length-1}else if(X<0)if(De)X=0;else return-1;if(typeof D=="string"&&(D=u.from(D,me)),u.isBuffer(D))return D.length===0?-1:O(xe,D,X,me,De);if(typeof D=="number")return D=D&255,typeof s.prototype.indexOf=="function"?De?s.prototype.indexOf.call(xe,D,X):s.prototype.lastIndexOf.call(xe,D,X):O(xe,[D],X,me,De);throw new TypeError("val must be string, number or Buffer")}function O(xe,D,X,me,De){let we=1,Ie=xe.length,fe=D.length;if(me!==void 0&&(me=String(me).toLowerCase(),me==="ucs2"||me==="ucs-2"||me==="utf16le"||me==="utf-16le")){if(xe.length<2||D.length<2)return-1;we=2,Ie/=2,fe/=2,X/=2}function yt(z,qe){return we===1?z[qe]:z.readUInt16BE(qe*we)}let _t;if(De){let z=-1;for(_t=X;_t<Ie;_t++)if(yt(xe,_t)===yt(D,z===-1?0:_t-z)){if(z===-1&&(z=_t),_t-z+1===fe)return z*we}else z!==-1&&(_t-=_t-z),z=-1}else for(X+fe>Ie&&(X=Ie-fe),_t=X;_t>=0;_t--){let z=!0;for(let qe=0;qe<fe;qe++)if(yt(xe,_t+qe)!==yt(D,qe)){z=!1;break}if(z)return _t}return-1}u.prototype.includes=function(D,X,me){return this.indexOf(D,X,me)!==-1},u.prototype.indexOf=function(D,X,me){return N(this,D,X,me,!0)},u.prototype.lastIndexOf=function(D,X,me){return N(this,D,X,me,!1)};function B(xe,D,X,me){X=Number(X)||0;const De=xe.length-X;me?(me=Number(me),me>De&&(me=De)):me=De;const we=D.length;me>we/2&&(me=we/2);let Ie;for(Ie=0;Ie<me;++Ie){const fe=parseInt(D.substr(Ie*2,2),16);if(jt(fe))return Ie;xe[X+Ie]=fe}return Ie}function P(xe,D,X,me){return At(Te(D,xe.length-X),xe,X,me)}function H(xe,D,X,me){return At($e(D),xe,X,me)}function F(xe,D,X,me){return At(ot(D),xe,X,me)}function Q(xe,D,X,me){return At(ke(D,xe.length-X),xe,X,me)}u.prototype.write=function(D,X,me,De){if(X===void 0)De="utf8",me=this.length,X=0;else if(me===void 0&&typeof X=="string")De=X,me=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(me)?(me=me>>>0,De===void 0&&(De="utf8")):(De=me,me=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const we=this.length-X;if((me===void 0||me>we)&&(me=we),D.length>0&&(me<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");let Ie=!1;for(;;)switch(De){case"hex":return B(this,D,X,me);case"utf8":case"utf-8":return P(this,D,X,me);case"ascii":case"latin1":case"binary":return H(this,D,X,me);case"base64":return F(this,D,X,me);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q(this,D,X,me);default:if(Ie)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),Ie=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function q(xe,D,X){return D===0&&X===xe.length?t.fromByteArray(xe):t.fromByteArray(xe.slice(D,X))}function K(xe,D,X){X=Math.min(xe.length,X);const me=[];let De=D;for(;De<X;){const we=xe[De];let Ie=null,fe=we>239?4:we>223?3:we>191?2:1;if(De+fe<=X){let yt,_t,z,qe;switch(fe){case 1:we<128&&(Ie=we);break;case 2:yt=xe[De+1],(yt&192)===128&&(qe=(we&31)<<6|yt&63,qe>127&&(Ie=qe));break;case 3:yt=xe[De+1],_t=xe[De+2],(yt&192)===128&&(_t&192)===128&&(qe=(we&15)<<12|(yt&63)<<6|_t&63,qe>2047&&(qe<55296||qe>57343)&&(Ie=qe));break;case 4:yt=xe[De+1],_t=xe[De+2],z=xe[De+3],(yt&192)===128&&(_t&192)===128&&(z&192)===128&&(qe=(we&15)<<18|(yt&63)<<12|(_t&63)<<6|z&63,qe>65535&&qe<1114112&&(Ie=qe))}}Ie===null?(Ie=65533,fe=1):Ie>65535&&(Ie-=65536,me.push(Ie>>>10&1023|55296),Ie=56320|Ie&1023),me.push(Ie),De+=fe}return re(me)}const U=4096;function re(xe){const D=xe.length;if(D<=U)return String.fromCharCode.apply(String,xe);let X="",me=0;for(;me<D;)X+=String.fromCharCode.apply(String,xe.slice(me,me+=U));return X}function G(xe,D,X){let me="";X=Math.min(xe.length,X);for(let De=D;De<X;++De)me+=String.fromCharCode(xe[De]&127);return me}function ne(xe,D,X){let me="";X=Math.min(xe.length,X);for(let De=D;De<X;++De)me+=String.fromCharCode(xe[De]);return me}function te(xe,D,X){const me=xe.length;(!D||D<0)&&(D=0),(!X||X<0||X>me)&&(X=me);let De="";for(let we=D;we<X;++we)De+=Bt[xe[we]];return De}function se(xe,D,X){const me=xe.slice(D,X);let De="";for(let we=0;we<me.length-1;we+=2)De+=String.fromCharCode(me[we]+me[we+1]*256);return De}u.prototype.slice=function(D,X){const me=this.length;D=~~D,X=X===void 0?me:~~X,D<0?(D+=me,D<0&&(D=0)):D>me&&(D=me),X<0?(X+=me,X<0&&(X=0)):X>me&&(X=me),X<D&&(X=D);const De=this.subarray(D,X);return Object.setPrototypeOf(De,u.prototype),De};function pe(xe,D,X){if(xe%1!==0||xe<0)throw new RangeError("offset is not uint");if(xe+D>X)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(D,X,me){D=D>>>0,X=X>>>0,me||pe(D,X,this.length);let De=this[D],we=1,Ie=0;for(;++Ie<X&&(we*=256);)De+=this[D+Ie]*we;return De},u.prototype.readUintBE=u.prototype.readUIntBE=function(D,X,me){D=D>>>0,X=X>>>0,me||pe(D,X,this.length);let De=this[D+--X],we=1;for(;X>0&&(we*=256);)De+=this[D+--X]*we;return De},u.prototype.readUint8=u.prototype.readUInt8=function(D,X){return D=D>>>0,X||pe(D,1,this.length),this[D]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(D,X){return D=D>>>0,X||pe(D,2,this.length),this[D]|this[D+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(D,X){return D=D>>>0,X||pe(D,2,this.length),this[D]<<8|this[D+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(D,X){return D=D>>>0,X||pe(D,4,this.length),(this[D]|this[D+1]<<8|this[D+2]<<16)+this[D+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(D,X){return D=D>>>0,X||pe(D,4,this.length),this[D]*16777216+(this[D+1]<<16|this[D+2]<<8|this[D+3])},u.prototype.readBigUInt64LE=Ft(function(D){D=D>>>0,Re(D,"offset");const X=this[D],me=this[D+7];(X===void 0||me===void 0)&&ce(D,this.length-8);const De=X+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24,we=this[++D]+this[++D]*2**8+this[++D]*2**16+me*2**24;return BigInt(De)+(BigInt(we)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ft(function(D){D=D>>>0,Re(D,"offset");const X=this[D],me=this[D+7];(X===void 0||me===void 0)&&ce(D,this.length-8);const De=X*2**24+this[++D]*2**16+this[++D]*2**8+this[++D],we=this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+me;return(BigInt(De)<<BigInt(32))+BigInt(we)}),u.prototype.readIntLE=function(D,X,me){D=D>>>0,X=X>>>0,me||pe(D,X,this.length);let De=this[D],we=1,Ie=0;for(;++Ie<X&&(we*=256);)De+=this[D+Ie]*we;return we*=128,De>=we&&(De-=Math.pow(2,8*X)),De},u.prototype.readIntBE=function(D,X,me){D=D>>>0,X=X>>>0,me||pe(D,X,this.length);let De=X,we=1,Ie=this[D+--De];for(;De>0&&(we*=256);)Ie+=this[D+--De]*we;return we*=128,Ie>=we&&(Ie-=Math.pow(2,8*X)),Ie},u.prototype.readInt8=function(D,X){return D=D>>>0,X||pe(D,1,this.length),this[D]&128?(255-this[D]+1)*-1:this[D]},u.prototype.readInt16LE=function(D,X){D=D>>>0,X||pe(D,2,this.length);const me=this[D]|this[D+1]<<8;return me&32768?me|4294901760:me},u.prototype.readInt16BE=function(D,X){D=D>>>0,X||pe(D,2,this.length);const me=this[D+1]|this[D]<<8;return me&32768?me|4294901760:me},u.prototype.readInt32LE=function(D,X){return D=D>>>0,X||pe(D,4,this.length),this[D]|this[D+1]<<8|this[D+2]<<16|this[D+3]<<24},u.prototype.readInt32BE=function(D,X){return D=D>>>0,X||pe(D,4,this.length),this[D]<<24|this[D+1]<<16|this[D+2]<<8|this[D+3]},u.prototype.readBigInt64LE=Ft(function(D){D=D>>>0,Re(D,"offset");const X=this[D],me=this[D+7];(X===void 0||me===void 0)&&ce(D,this.length-8);const De=this[D+4]+this[D+5]*2**8+this[D+6]*2**16+(me<<24);return(BigInt(De)<<BigInt(32))+BigInt(X+this[++D]*2**8+this[++D]*2**16+this[++D]*2**24)}),u.prototype.readBigInt64BE=Ft(function(D){D=D>>>0,Re(D,"offset");const X=this[D],me=this[D+7];(X===void 0||me===void 0)&&ce(D,this.length-8);const De=(X<<24)+this[++D]*2**16+this[++D]*2**8+this[++D];return(BigInt(De)<<BigInt(32))+BigInt(this[++D]*2**24+this[++D]*2**16+this[++D]*2**8+me)}),u.prototype.readFloatLE=function(D,X){return D=D>>>0,X||pe(D,4,this.length),n.read(this,D,!0,23,4)},u.prototype.readFloatBE=function(D,X){return D=D>>>0,X||pe(D,4,this.length),n.read(this,D,!1,23,4)},u.prototype.readDoubleLE=function(D,X){return D=D>>>0,X||pe(D,8,this.length),n.read(this,D,!0,52,8)},u.prototype.readDoubleBE=function(D,X){return D=D>>>0,X||pe(D,8,this.length),n.read(this,D,!1,52,8)};function de(xe,D,X,me,De,we){if(!u.isBuffer(xe))throw new TypeError('"buffer" argument must be a Buffer instance');if(D>De||D<we)throw new RangeError('"value" argument is out of bounds');if(X+me>xe.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(D,X,me,De){if(D=+D,X=X>>>0,me=me>>>0,!De){const fe=Math.pow(2,8*me)-1;de(this,D,X,me,fe,0)}let we=1,Ie=0;for(this[X]=D&255;++Ie<me&&(we*=256);)this[X+Ie]=D/we&255;return X+me},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(D,X,me,De){if(D=+D,X=X>>>0,me=me>>>0,!De){const fe=Math.pow(2,8*me)-1;de(this,D,X,me,fe,0)}let we=me-1,Ie=1;for(this[X+we]=D&255;--we>=0&&(Ie*=256);)this[X+we]=D/Ie&255;return X+me},u.prototype.writeUint8=u.prototype.writeUInt8=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,1,255,0),this[X]=D&255,X+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,2,65535,0),this[X]=D&255,this[X+1]=D>>>8,X+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,2,65535,0),this[X]=D>>>8,this[X+1]=D&255,X+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,4,4294967295,0),this[X+3]=D>>>24,this[X+2]=D>>>16,this[X+1]=D>>>8,this[X]=D&255,X+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,4,4294967295,0),this[X]=D>>>24,this[X+1]=D>>>16,this[X+2]=D>>>8,this[X+3]=D&255,X+4};function Ne(xe,D,X,me,De){be(D,me,De,xe,X,7);let we=Number(D&BigInt(4294967295));xe[X++]=we,we=we>>8,xe[X++]=we,we=we>>8,xe[X++]=we,we=we>>8,xe[X++]=we;let Ie=Number(D>>BigInt(32)&BigInt(4294967295));return xe[X++]=Ie,Ie=Ie>>8,xe[X++]=Ie,Ie=Ie>>8,xe[X++]=Ie,Ie=Ie>>8,xe[X++]=Ie,X}function Pe(xe,D,X,me,De){be(D,me,De,xe,X,7);let we=Number(D&BigInt(4294967295));xe[X+7]=we,we=we>>8,xe[X+6]=we,we=we>>8,xe[X+5]=we,we=we>>8,xe[X+4]=we;let Ie=Number(D>>BigInt(32)&BigInt(4294967295));return xe[X+3]=Ie,Ie=Ie>>8,xe[X+2]=Ie,Ie=Ie>>8,xe[X+1]=Ie,Ie=Ie>>8,xe[X]=Ie,X+8}u.prototype.writeBigUInt64LE=Ft(function(D,X=0){return Ne(this,D,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ft(function(D,X=0){return Pe(this,D,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(D,X,me,De){if(D=+D,X=X>>>0,!De){const yt=Math.pow(2,8*me-1);de(this,D,X,me,yt-1,-yt)}let we=0,Ie=1,fe=0;for(this[X]=D&255;++we<me&&(Ie*=256);)D<0&&fe===0&&this[X+we-1]!==0&&(fe=1),this[X+we]=(D/Ie>>0)-fe&255;return X+me},u.prototype.writeIntBE=function(D,X,me,De){if(D=+D,X=X>>>0,!De){const yt=Math.pow(2,8*me-1);de(this,D,X,me,yt-1,-yt)}let we=me-1,Ie=1,fe=0;for(this[X+we]=D&255;--we>=0&&(Ie*=256);)D<0&&fe===0&&this[X+we+1]!==0&&(fe=1),this[X+we]=(D/Ie>>0)-fe&255;return X+me},u.prototype.writeInt8=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,1,127,-128),D<0&&(D=255+D+1),this[X]=D&255,X+1},u.prototype.writeInt16LE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,2,32767,-32768),this[X]=D&255,this[X+1]=D>>>8,X+2},u.prototype.writeInt16BE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,2,32767,-32768),this[X]=D>>>8,this[X+1]=D&255,X+2},u.prototype.writeInt32LE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,4,2147483647,-2147483648),this[X]=D&255,this[X+1]=D>>>8,this[X+2]=D>>>16,this[X+3]=D>>>24,X+4},u.prototype.writeInt32BE=function(D,X,me){return D=+D,X=X>>>0,me||de(this,D,X,4,2147483647,-2147483648),D<0&&(D=4294967295+D+1),this[X]=D>>>24,this[X+1]=D>>>16,this[X+2]=D>>>8,this[X+3]=D&255,X+4},u.prototype.writeBigInt64LE=Ft(function(D,X=0){return Ne(this,D,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ft(function(D,X=0){return Pe(this,D,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Me(xe,D,X,me,De,we){if(X+me>xe.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function Ee(xe,D,X,me,De){return D=+D,X=X>>>0,De||Me(xe,D,X,4),n.write(xe,D,X,me,23,4),X+4}u.prototype.writeFloatLE=function(D,X,me){return Ee(this,D,X,!0,me)},u.prototype.writeFloatBE=function(D,X,me){return Ee(this,D,X,!1,me)};function Ue(xe,D,X,me,De){return D=+D,X=X>>>0,De||Me(xe,D,X,8),n.write(xe,D,X,me,52,8),X+8}u.prototype.writeDoubleLE=function(D,X,me){return Ue(this,D,X,!0,me)},u.prototype.writeDoubleBE=function(D,X,me){return Ue(this,D,X,!1,me)},u.prototype.copy=function(D,X,me,De){if(!u.isBuffer(D))throw new TypeError("argument should be a Buffer");if(me||(me=0),!De&&De!==0&&(De=this.length),X>=D.length&&(X=D.length),X||(X=0),De>0&&De<me&&(De=me),De===me||D.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(me<0||me>=this.length)throw new RangeError("Index out of range");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),D.length-X<De-me&&(De=D.length-X+me);const we=De-me;return this===D&&typeof s.prototype.copyWithin=="function"?this.copyWithin(X,me,De):s.prototype.set.call(D,this.subarray(me,De),X),we},u.prototype.fill=function(D,X,me,De){if(typeof D=="string"){if(typeof X=="string"?(De=X,X=0,me=this.length):typeof me=="string"&&(De=me,me=this.length),De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!u.isEncoding(De))throw new TypeError("Unknown encoding: "+De);if(D.length===1){const Ie=D.charCodeAt(0);(De==="utf8"&&Ie<128||De==="latin1")&&(D=Ie)}}else typeof D=="number"?D=D&255:typeof D=="boolean"&&(D=Number(D));if(X<0||this.length<X||this.length<me)throw new RangeError("Out of range index");if(me<=X)return this;X=X>>>0,me=me===void 0?this.length:me>>>0,D||(D=0);let we;if(typeof D=="number")for(we=X;we<me;++we)this[we]=D;else{const Ie=u.isBuffer(D)?D:u.from(D,De),fe=Ie.length;if(fe===0)throw new TypeError('The value "'+D+'" is invalid for argument "value"');for(we=0;we<me-X;++we)this[we+X]=Ie[we%fe]}return this};const nt={};function He(xe,D,X){nt[xe]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:D.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${xe}]`,this.stack,delete this.name}get code(){return xe}set code(De){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:De,writable:!0})}toString(){return`${this.name} [${xe}]: ${this.message}`}}}He("ERR_BUFFER_OUT_OF_BOUNDS",function(xe){return xe?`${xe} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),He("ERR_INVALID_ARG_TYPE",function(xe,D){return`The "${xe}" argument must be of type number. Received type ${typeof D}`},TypeError),He("ERR_OUT_OF_RANGE",function(xe,D,X){let me=`The value of "${xe}" is out of range.`,De=X;return Number.isInteger(X)&&Math.abs(X)>2**32?De=je(String(X)):typeof X=="bigint"&&(De=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(De=je(De)),De+="n"),me+=` It must be ${D}. Received ${De}`,me},RangeError);function je(xe){let D="",X=xe.length;const me=xe[0]==="-"?1:0;for(;X>=me+4;X-=3)D=`_${xe.slice(X-3,X)}${D}`;return`${xe.slice(0,X)}${D}`}function Y(xe,D,X){Re(D,"offset"),(xe[D]===void 0||xe[D+X]===void 0)&&ce(D,xe.length-(X+1))}function be(xe,D,X,me,De,we){if(xe>X||xe<D){const Ie=typeof D=="bigint"?"n":"";let fe;throw D===0||D===BigInt(0)?fe=`>= 0${Ie} and < 2${Ie} ** ${(we+1)*8}${Ie}`:fe=`>= -(2${Ie} ** ${(we+1)*8-1}${Ie}) and < 2 ** ${(we+1)*8-1}${Ie}`,new nt.ERR_OUT_OF_RANGE("value",fe,xe)}Y(me,De,we)}function Re(xe,D){if(typeof xe!="number")throw new nt.ERR_INVALID_ARG_TYPE(D,"number",xe)}function ce(xe,D,X){throw Math.floor(xe)!==xe?(Re(xe,X),new nt.ERR_OUT_OF_RANGE("offset","an integer",xe)):D<0?new nt.ERR_BUFFER_OUT_OF_BOUNDS:new nt.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${D}`,xe)}const le=/[^+/0-9A-Za-z-_]/g;function ae(xe){if(xe=xe.split("=")[0],xe=xe.trim().replace(le,""),xe.length<2)return"";for(;xe.length%4!==0;)xe=xe+"=";return xe}function Te(xe,D){D=D||1/0;let X;const me=xe.length;let De=null;const we=[];for(let Ie=0;Ie<me;++Ie){if(X=xe.charCodeAt(Ie),X>55295&&X<57344){if(!De){if(X>56319){(D-=3)>-1&&we.push(239,191,189);continue}else if(Ie+1===me){(D-=3)>-1&&we.push(239,191,189);continue}De=X;continue}if(X<56320){(D-=3)>-1&&we.push(239,191,189),De=X;continue}X=(De-55296<<10|X-56320)+65536}else De&&(D-=3)>-1&&we.push(239,191,189);if(De=null,X<128){if((D-=1)<0)break;we.push(X)}else if(X<2048){if((D-=2)<0)break;we.push(X>>6|192,X&63|128)}else if(X<65536){if((D-=3)<0)break;we.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((D-=4)<0)break;we.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return we}function $e(xe){const D=[];for(let X=0;X<xe.length;++X)D.push(xe.charCodeAt(X)&255);return D}function ke(xe,D){let X,me,De;const we=[];for(let Ie=0;Ie<xe.length&&!((D-=2)<0);++Ie)X=xe.charCodeAt(Ie),me=X>>8,De=X%256,we.push(De),we.push(me);return we}function ot(xe){return t.toByteArray(ae(xe))}function At(xe,D,X,me){let De;for(De=0;De<me&&!(De+X>=D.length||De>=xe.length);++De)D[De+X]=xe[De];return De}function ft(xe,D){return xe instanceof D||xe!=null&&xe.constructor!=null&&xe.constructor.name!=null&&xe.constructor.name===D.name}function jt(xe){return xe!==xe}const Bt=function(){const xe="0123456789abcdef",D=new Array(256);for(let X=0;X<16;++X){const me=X*16;for(let De=0;De<16;++De)D[me+De]=xe[X]+xe[De]}return D}();function Ft(xe){return typeof BigInt>"u"?tn:xe}function tn(){throw new Error("BigInt not supported")}})(oO);const sn=oO.Buffer,Si=oO.Buffer;var Wh={exports:{}},DL;function Yme(){if(DL)return Wh.exports;DL=1;const e=typeof sn<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&sn.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return i(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function i(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const p of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(p,"constructor")&&Object.prototype.hasOwnProperty.call(p.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete p.constructor}for(const y in p){const b=p[y];b&&typeof b=="object"&&d.push(b)}}}return o}function s(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return Wh.exports=s,Wh.exports.default=s,Wh.exports.parse=s,Wh.exports.safeParse=a,Wh.exports.scan=i,Wh.exports}var Zme=Yme();const G0=aa(Zme);var Xme={};function rs(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Jme(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function Qme(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function ege(){let e="",t,n=[],r,i;function s(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,p=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,p)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:i}),n=[],t=void 0,i=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(i=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=tge(e,l);e=d;for(let h=0;h<u.length;h++)s(u[h],c)},flush(l){s(e,l),a(l)}})}function tge(e,t){const n=[];let r=e;for(let i=0;i<t.length;){const s=t[i++];s===`
`?(n.push(r),r=""):s==="\r"?(n.push(r),r="",t[i]===`
`&&i++):r+=s}return{lines:n,incompleteLine:r}}function K0(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Kp=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const i=$me(n,t);if(e==null)return i;if(n.includes(r))throw new gH({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return s=>`${e}${r}${i(s)}`},ro=Kp();function nge(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function rge(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function ZS(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function BH({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new Z_({message:`${r} API key must be a string.`});if(typeof es>"u")throw new Z_({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=Xme[t],e==null)throw new Z_({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new Z_({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var P2=Symbol.for("vercel.ai.validator");function ige(e){return{[P2]:!0,validate:e}}function sge(e){return typeof e=="object"&&e!==null&&P2 in e&&e[P2]===!0&&"validate"in e}function age(e){return sge(e)?e:oge(e)}function oge(e){return ige(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function lge({value:e,schema:t}){const n=Y0({value:e,schema:t});if(!n.success)throw O2.wrap({value:e,cause:n.error});return n.value}function Y0({value:e,schema:t}){const n=age(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:O2.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:O2.wrap({value:e,cause:r})}}}function cge({text:e,schema:t}){try{const n=G0.parse(e);return t==null?n:lge({value:n,schema:t})}catch(n){throw j2.isInstance(n)||O2.isInstance(n)?n:new j2({text:e,cause:n})}}function Mp({text:e,schema:t}){try{const n=G0.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Y0({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:j2.isInstance(n)?n:new j2({text:e,cause:n})}}}function D2(e){try{return G0.parse(e),!0}catch{return!1}}function Vk({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Y0({value:t[e],schema:n});if(!r.success)throw new gH({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var uge=()=>globalThis.fetch,is=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:i,abortSignal:s,fetch:a})=>$H({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:i,abortSignal:s,fetch:a}),dge=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:i,abortSignal:s,fetch:a})=>$H({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:i,abortSignal:s,fetch:a}),$H=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:i,abortSignal:s,fetch:a=uge()})=>{try{const o=await a(e,{method:"POST",headers:rge(t),body:n.content,signal:s}),l=K0(o);if(!o.ok){let c;try{c=await i({response:o,url:e,requestBodyValues:n.values})}catch(u){throw ZS(u)||gl.isInstance(u)?u:new gl({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(ZS(c)||gl.isInstance(c))?c:new gl({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(ZS(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new gl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function S3(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var Yp=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:i,requestBodyValues:s})=>{const a=await r.text(),o=K0(r);if(a.trim()==="")return{responseHeaders:o,value:new gl({message:r.statusText,url:i,requestBodyValues:s,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=cge({text:a,schema:e});return{responseHeaders:o,value:new gl({message:t(l),url:i,requestBodyValues:s,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new gl({message:r.statusText,url:i,requestBodyValues:s,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},Z0=e=>async({response:t})=>{const n=K0(t);if(t.body==null)throw new fH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(ege()).pipeThrough(new TransformStream({transform({data:r},i){r!=="[DONE]"&&i.enqueue(Mp({text:r,schema:e}))}}))}},vo=e=>async({response:t,url:n,requestBodyValues:r})=>{const i=await t.text(),s=Mp({text:i,schema:e}),a=K0(t);if(!s.success)throw new gl({message:"Invalid JSON response",cause:s.error,statusCode:t.status,responseHeaders:a,responseBody:i,url:n,requestBodyValues:r});return{responseHeaders:a,value:s.value,rawValue:s.rawValue}},fge=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=K0(e);if(!e.body)throw new gl({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const i=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(i)}}catch(i){throw new gl({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:i})}},{btoa:hge,atob:pge}=globalThis;function Hk(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=pge(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Pf(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return hge(t)}function Wk(e){return e==null?void 0:e.replace(/\/$/,"")}var Br;(function(e){e.assertEqual=i=>i;function t(i){}e.assertIs=t;function n(i){throw new Error}e.assertNever=n,e.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},e.getValidEnumValues=i=>{const s=e.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return e.objectValues(a)},e.objectValues=i=>e.objectKeys(i).map(function(s){return i[s]}),e.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},e.find=(i,s)=>{for(const a of i)if(s(a))return a},e.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}e.joinValues=r,e.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(Br||(Br={}));var C3;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(C3||(C3={}));const hn=Br.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yu=e=>{switch(typeof e){case"undefined":return hn.undefined;case"string":return hn.string;case"number":return isNaN(e)?hn.nan:hn.number;case"boolean":return hn.boolean;case"function":return hn.function;case"bigint":return hn.bigint;case"symbol":return hn.symbol;case"object":return Array.isArray(e)?hn.array:e===null?hn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?hn.promise:typeof Map<"u"&&e instanceof Map?hn.map:typeof Set<"u"&&e instanceof Set?hn.set:typeof Date<"u"&&e instanceof Date?hn.date:hn.object;default:return hn.unknown}},Ut=Br.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),mge=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class Lo extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(this),r}static assert(t){if(!(t instanceof Lo))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Br.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(t(i))):r.push(t(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Lo.create=e=>new Lo(e);const l0=(e,t)=>{let n;switch(e.code){case Ut.invalid_type:e.received===hn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Ut.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Br.jsonStringifyReplacer)}`;break;case Ut.unrecognized_keys:n=`Unrecognized key(s) in object: ${Br.joinValues(e.keys,", ")}`;break;case Ut.invalid_union:n="Invalid input";break;case Ut.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Br.joinValues(e.options)}`;break;case Ut.invalid_enum_value:n=`Invalid enum value. Expected ${Br.joinValues(e.options)}, received '${e.received}'`;break;case Ut.invalid_arguments:n="Invalid function arguments";break;case Ut.invalid_return_type:n="Invalid function return type";break;case Ut.invalid_date:n="Invalid date";break;case Ut.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Br.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Ut.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Ut.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Ut.custom:n="Invalid input";break;case Ut.invalid_intersection_types:n="Intersection results could not be merged";break;case Ut.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Ut.not_finite:n="Number must be finite";break;default:n=t.defaultError,Br.assertNever(e)}return{message:n}};let zH=l0;function gge(e){zH=e}function F2(){return zH}const L2=e=>{const{data:t,path:n,errorMaps:r,issueData:i}=e,s=[...n,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...i,path:s,message:o}},yge=[];function cn(e,t){const n=F2(),r=L2({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===l0?void 0:l0].filter(i=>!!i)});e.common.issues.push(r)}class xa{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const i of n){if(i.status==="aborted")return Jn;i.status==="dirty"&&t.dirty(),r.push(i.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const i of n){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return xa.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const i of n){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return Jn;s.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{status:t.value,value:r}}}const Jn=Object.freeze({status:"aborted"}),Eg=e=>({status:"dirty",value:e}),Ua=e=>({status:"valid",value:e}),k3=e=>e.status==="aborted",E3=e=>e.status==="dirty",Np=e=>e.status==="valid",nx=e=>typeof Promise<"u"&&e instanceof Promise;function B2(e,t,n,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function UH(e,t,n,r,i){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}var _n;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(_n||(_n={}));var hv,pv;class eu{constructor(t,n,r,i){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const FL=(e,t)=>{if(Np(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Lo(e.common.issues);return this._error=n,this._error}}};function br(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:i}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:i}:{errorMap:(a,o)=>{var l,c;const{message:u}=e;return a.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(l=u??r)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??n)!==null&&c!==void 0?c:o.defaultError}},description:i}}class wr{get description(){return this._def.description}_getType(t){return Yu(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Yu(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new xa,ctx:{common:t.parent.common,data:t.data,parsedType:Yu(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(nx(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){var r;const i={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yu(t)},s=this._parseSync({data:t,path:i.path,parent:i});return FL(i,s)}"~validate"(t){var n,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yu(t)};if(!this["~standard"].async)try{const s=this._parseSync({data:t,path:[],parent:i});return Np(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((r=(n=s==null?void 0:s.message)===null||n===void 0?void 0:n.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:i}).then(s=>Np(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yu(t)},i=this._parse({data:t,path:r.path,parent:r}),s=await(nx(i)?i:Promise.resolve(i));return FL(r,s)}refine(t,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const a=t(i),o=()=>s.addIssue({code:Ut.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,i)=>t(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(t){return new ic({schema:this,typeName:Gt.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Zl.create(this,this._def)}nullable(){return Bf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yl.create(this)}promise(){return u0.create(this,this._def)}or(t){return ax.create([this,t],this._def)}and(t){return ox.create(this,t,this._def)}transform(t){return new ic({...br(this._def),schema:this,typeName:Gt.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new fx({...br(this._def),innerType:this,defaultValue:n,typeName:Gt.ZodDefault})}brand(){return new cO({typeName:Gt.ZodBranded,type:this,...br(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new hx({...br(this._def),innerType:this,catchValue:n,typeName:Gt.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return Rw.create(this,t)}readonly(){return px.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const bge=/^c[^\s-]{8,}$/i,vge=/^[0-9a-z]+$/,xge=/^[0-9A-HJKMNP-TV-Z]{26}$/i,wge=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,_ge=/^[a-z0-9_-]{21}$/i,Sge=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Cge=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,kge=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ege="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let UR;const Tge=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Age=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Rge=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Ige=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Mge=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Nge=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,qH="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",jge=new RegExp(`^${qH}$`);function VH(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function Oge(e){return new RegExp(`^${VH(e)}$`)}function HH(e){let t=`${qH}T${VH(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Pge(e,t){return!!((t==="v4"||!t)&&Tge.test(e)||(t==="v6"||!t)&&Rge.test(e))}function Dge(e,t){if(!Sge.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||!i.typ||!i.alg||t&&i.alg!==t)}catch{return!1}}function Fge(e,t){return!!((t==="v4"||!t)&&Age.test(e)||(t==="v6"||!t)&&Ige.test(e))}class Wl extends wr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==hn.string){const s=this._getOrReturnCtx(t);return cn(s,{code:Ut.invalid_type,expected:hn.string,received:s.parsedType}),Jn}const r=new xa;let i;for(const s of this._def.checks)if(s.kind==="min")t.data.length<s.value&&(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")t.data.length>s.value&&(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=t.data.length>s.value,o=t.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(t,i),a?cn(i,{code:Ut.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&cn(i,{code:Ut.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")kge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"email",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")UR||(UR=new RegExp(Ege,"u")),UR.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"emoji",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")wge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"uuid",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")_ge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"nanoid",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")bge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"cuid",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")vge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"cuid2",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")xge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"ulid",code:Ut.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(t.data)}catch{i=this._getOrReturnCtx(t,i),cn(i,{validation:"url",code:Ut.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"regex",code:Ut.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?t.data=t.data.trim():s.kind==="includes"?t.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?t.data=t.data.toLowerCase():s.kind==="toUpperCase"?t.data=t.data.toUpperCase():s.kind==="startsWith"?t.data.startsWith(s.value)||(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?t.data.endsWith(s.value)||(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?HH(s).test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?jge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?Oge(s).test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?Cge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"duration",code:Ut.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?Pge(t.data,s.version)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"ip",code:Ut.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?Dge(t.data,s.alg)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"jwt",code:Ut.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?Fge(t.data,s.version)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"cidr",code:Ut.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?Mge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"base64",code:Ut.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?Nge.test(t.data)||(i=this._getOrReturnCtx(t,i),cn(i,{validation:"base64url",code:Ut.invalid_string,message:s.message}),r.dirty()):Br.assertNever(s);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(i=>t.test(i),{validation:n,code:Ut.invalid_string,..._n.errToObj(r)})}_addCheck(t){return new Wl({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",..._n.errToObj(t)})}url(t){return this._addCheck({kind:"url",..._n.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",..._n.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",..._n.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",..._n.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",..._n.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",..._n.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",..._n.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",..._n.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",..._n.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",..._n.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",..._n.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",..._n.errToObj(t)})}datetime(t){var n,r;return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(n=t==null?void 0:t.offset)!==null&&n!==void 0?n:!1,local:(r=t==null?void 0:t.local)!==null&&r!==void 0?r:!1,..._n.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,..._n.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",..._n.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,..._n.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,..._n.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,..._n.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,..._n.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,..._n.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,..._n.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,..._n.errToObj(n)})}nonempty(t){return this.min(1,_n.errToObj(t))}trim(){return new Wl({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Wl({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Wl({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Wl.create=e=>{var t;return new Wl({checks:[],typeName:Gt.ZodString,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...br(e)})};function Lge(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,i=n>r?n:r,s=parseInt(e.toFixed(i).replace(".","")),a=parseInt(t.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class Df extends wr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==hn.number){const s=this._getOrReturnCtx(t);return cn(s,{code:Ut.invalid_type,expected:hn.number,received:s.parsedType}),Jn}let r;const i=new xa;for(const s of this._def.checks)s.kind==="int"?Br.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?Lge(t.data,s.value)!==0&&(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.not_finite,message:s.message}),i.dirty()):Br.assertNever(s);return{status:i.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,_n.toString(n))}gt(t,n){return this.setLimit("min",t,!1,_n.toString(n))}lte(t,n){return this.setLimit("max",t,!0,_n.toString(n))}lt(t,n){return this.setLimit("max",t,!1,_n.toString(n))}setLimit(t,n,r,i){return new Df({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:_n.toString(i)}]})}_addCheck(t){return new Df({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:_n.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:_n.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:_n.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:_n.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:_n.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:_n.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:_n.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:_n.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:_n.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Br.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}Df.create=e=>new Df({checks:[],typeName:Gt.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...br(e)});class Ff extends wr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==hn.bigint)return this._getInvalidInput(t);let r;const i=new xa;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?t.data<s.value:t.data<=s.value)&&(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?t.data>s.value:t.data>=s.value)&&(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?t.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),cn(r,{code:Ut.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):Br.assertNever(s);return{status:i.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return cn(n,{code:Ut.invalid_type,expected:hn.bigint,received:n.parsedType}),Jn}gte(t,n){return this.setLimit("min",t,!0,_n.toString(n))}gt(t,n){return this.setLimit("min",t,!1,_n.toString(n))}lte(t,n){return this.setLimit("max",t,!0,_n.toString(n))}lt(t,n){return this.setLimit("max",t,!1,_n.toString(n))}setLimit(t,n,r,i){return new Ff({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:_n.toString(i)}]})}_addCheck(t){return new Ff({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:_n.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:_n.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:_n.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:_n.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:_n.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Ff.create=e=>{var t;return new Ff({checks:[],typeName:Gt.ZodBigInt,coerce:(t=e==null?void 0:e.coerce)!==null&&t!==void 0?t:!1,...br(e)})};class rx extends wr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==hn.boolean){const r=this._getOrReturnCtx(t);return cn(r,{code:Ut.invalid_type,expected:hn.boolean,received:r.parsedType}),Jn}return Ua(t.data)}}rx.create=e=>new rx({typeName:Gt.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...br(e)});class jp extends wr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==hn.date){const s=this._getOrReturnCtx(t);return cn(s,{code:Ut.invalid_type,expected:hn.date,received:s.parsedType}),Jn}if(isNaN(t.data.getTime())){const s=this._getOrReturnCtx(t);return cn(s,{code:Ut.invalid_date}),Jn}const r=new xa;let i;for(const s of this._def.checks)s.kind==="min"?t.data.getTime()<s.value&&(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?t.data.getTime()>s.value&&(i=this._getOrReturnCtx(t,i),cn(i,{code:Ut.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):Br.assertNever(s);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new jp({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:_n.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:_n.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}jp.create=e=>new jp({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Gt.ZodDate,...br(e)});class $2 extends wr{_parse(t){if(this._getType(t)!==hn.symbol){const r=this._getOrReturnCtx(t);return cn(r,{code:Ut.invalid_type,expected:hn.symbol,received:r.parsedType}),Jn}return Ua(t.data)}}$2.create=e=>new $2({typeName:Gt.ZodSymbol,...br(e)});class ix extends wr{_parse(t){if(this._getType(t)!==hn.undefined){const r=this._getOrReturnCtx(t);return cn(r,{code:Ut.invalid_type,expected:hn.undefined,received:r.parsedType}),Jn}return Ua(t.data)}}ix.create=e=>new ix({typeName:Gt.ZodUndefined,...br(e)});class sx extends wr{_parse(t){if(this._getType(t)!==hn.null){const r=this._getOrReturnCtx(t);return cn(r,{code:Ut.invalid_type,expected:hn.null,received:r.parsedType}),Jn}return Ua(t.data)}}sx.create=e=>new sx({typeName:Gt.ZodNull,...br(e)});class c0 extends wr{constructor(){super(...arguments),this._any=!0}_parse(t){return Ua(t.data)}}c0.create=e=>new c0({typeName:Gt.ZodAny,...br(e)});class xp extends wr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ua(t.data)}}xp.create=e=>new xp({typeName:Gt.ZodUnknown,...br(e)});class dd extends wr{_parse(t){const n=this._getOrReturnCtx(t);return cn(n,{code:Ut.invalid_type,expected:hn.never,received:n.parsedType}),Jn}}dd.create=e=>new dd({typeName:Gt.ZodNever,...br(e)});class z2 extends wr{_parse(t){if(this._getType(t)!==hn.undefined){const r=this._getOrReturnCtx(t);return cn(r,{code:Ut.invalid_type,expected:hn.void,received:r.parsedType}),Jn}return Ua(t.data)}}z2.create=e=>new z2({typeName:Gt.ZodVoid,...br(e)});class Yl extends wr{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),i=this._def;if(n.parsedType!==hn.array)return cn(n,{code:Ut.invalid_type,expected:hn.array,received:n.parsedType}),Jn;if(i.exactLength!==null){const a=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(a||o)&&(cn(n,{code:a?Ut.too_big:Ut.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(cn(n,{code:Ut.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(cn(n,{code:Ut.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>i.type._parseAsync(new eu(n,a,n.path,o)))).then(a=>xa.mergeArray(r,a));const s=[...n.data].map((a,o)=>i.type._parseSync(new eu(n,a,n.path,o)));return xa.mergeArray(r,s)}get element(){return this._def.type}min(t,n){return new Yl({...this._def,minLength:{value:t,message:_n.toString(n)}})}max(t,n){return new Yl({...this._def,maxLength:{value:t,message:_n.toString(n)}})}length(t,n){return new Yl({...this._def,exactLength:{value:t,message:_n.toString(n)}})}nonempty(t){return this.min(1,t)}}Yl.create=(e,t)=>new Yl({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Gt.ZodArray,...br(t)});function xg(e){if(e instanceof Li){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Zl.create(xg(r))}return new Li({...e._def,shape:()=>t})}else return e instanceof Yl?new Yl({...e._def,type:xg(e.element)}):e instanceof Zl?Zl.create(xg(e.unwrap())):e instanceof Bf?Bf.create(xg(e.unwrap())):e instanceof tu?tu.create(e.items.map(t=>xg(t))):e}class Li extends wr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=Br.objectKeys(t);return this._cached={shape:t,keys:n}}_parse(t){if(this._getType(t)!==hn.object){const c=this._getOrReturnCtx(t);return cn(c,{code:Ut.invalid_type,expected:hn.object,received:c.parsedType}),Jn}const{status:r,ctx:i}=this._processInputParams(t),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof dd&&this._def.unknownKeys==="strip"))for(const c in i.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=s[c],d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new eu(i,d,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof dd){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")o.length>0&&(cn(i,{code:Ut.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new eu(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>xa.mergeObjectSync(r,c)):xa.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return _n.errToObj,new Li({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,s,a,o;const l=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=_n.errToObj(t).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new Li({...this._def,unknownKeys:"strip"})}passthrough(){return new Li({...this._def,unknownKeys:"passthrough"})}extend(t){return new Li({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Li({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Gt.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Li({...this._def,catchall:t})}pick(t){const n={};return Br.objectKeys(t).forEach(r=>{t[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Li({...this._def,shape:()=>n})}omit(t){const n={};return Br.objectKeys(this.shape).forEach(r=>{t[r]||(n[r]=this.shape[r])}),new Li({...this._def,shape:()=>n})}deepPartial(){return xg(this)}partial(t){const n={};return Br.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];t&&!t[r]?n[r]=i:n[r]=i.optional()}),new Li({...this._def,shape:()=>n})}required(t){const n={};return Br.objectKeys(this.shape).forEach(r=>{if(t&&!t[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Zl;)s=s._def.innerType;n[r]=s}}),new Li({...this._def,shape:()=>n})}keyof(){return WH(Br.objectKeys(this.shape))}}Li.create=(e,t)=>new Li({shape:()=>e,unknownKeys:"strip",catchall:dd.create(),typeName:Gt.ZodObject,...br(t)});Li.strictCreate=(e,t)=>new Li({shape:()=>e,unknownKeys:"strict",catchall:dd.create(),typeName:Gt.ZodObject,...br(t)});Li.lazycreate=(e,t)=>new Li({shape:e,unknownKeys:"strip",catchall:dd.create(),typeName:Gt.ZodObject,...br(t)});class ax extends wr{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Lo(o.ctx.common.issues));return cn(n,{code:Ut.invalid_union,unionErrors:a}),Jn}if(n.common.async)return Promise.all(r.map(async s=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new Lo(l));return cn(n,{code:Ut.invalid_union,unionErrors:o}),Jn}}get options(){return this._def.options}}ax.create=(e,t)=>new ax({options:e,typeName:Gt.ZodUnion,...br(t)});const Vu=e=>e instanceof cx?Vu(e.schema):e instanceof ic?Vu(e.innerType()):e instanceof ux?[e.value]:e instanceof Lf?e.options:e instanceof dx?Br.objectValues(e.enum):e instanceof fx?Vu(e._def.innerType):e instanceof ix?[void 0]:e instanceof sx?[null]:e instanceof Zl?[void 0,...Vu(e.unwrap())]:e instanceof Bf?[null,...Vu(e.unwrap())]:e instanceof cO||e instanceof px?Vu(e.unwrap()):e instanceof hx?Vu(e._def.innerType):[];class Gk extends wr{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==hn.object)return cn(n,{code:Ut.invalid_type,expected:hn.object,received:n.parsedType}),Jn;const r=this.discriminator,i=n.data[r],s=this.optionsMap.get(i);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(cn(n,{code:Ut.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Jn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const i=new Map;for(const s of n){const a=Vu(s.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);i.set(o,s)}}return new Gk({typeName:Gt.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:i,...br(r)})}}function T3(e,t){const n=Yu(e),r=Yu(t);if(e===t)return{valid:!0,data:e};if(n===hn.object&&r===hn.object){const i=Br.objectKeys(t),s=Br.objectKeys(e).filter(o=>i.indexOf(o)!==-1),a={...e,...t};for(const o of s){const l=T3(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===hn.array&&r===hn.array){if(e.length!==t.length)return{valid:!1};const i=[];for(let s=0;s<e.length;s++){const a=e[s],o=t[s],l=T3(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===hn.date&&r===hn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class ox extends wr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),i=(s,a)=>{if(k3(s)||k3(a))return Jn;const o=T3(s.value,a.value);return o.valid?((E3(s)||E3(a))&&n.dirty(),{status:n.value,value:o.data}):(cn(r,{code:Ut.invalid_intersection_types}),Jn)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ox.create=(e,t,n)=>new ox({left:e,right:t,typeName:Gt.ZodIntersection,...br(n)});class tu extends wr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==hn.array)return cn(r,{code:Ut.invalid_type,expected:hn.array,received:r.parsedType}),Jn;if(r.data.length<this._def.items.length)return cn(r,{code:Ut.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Jn;!this._def.rest&&r.data.length>this._def.items.length&&(cn(r,{code:Ut.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new eu(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).then(a=>xa.mergeArray(n,a)):xa.mergeArray(n,s)}get items(){return this._def.items}rest(t){return new tu({...this._def,rest:t})}}tu.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tu({items:e,typeName:Gt.ZodTuple,rest:null,...br(t)})};class lx extends wr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==hn.object)return cn(r,{code:Ut.invalid_type,expected:hn.object,received:r.parsedType}),Jn;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in r.data)i.push({key:s._parse(new eu(r,o,r.path,o)),value:a._parse(new eu(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?xa.mergeObjectAsync(n,i):xa.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof wr?new lx({keyType:t,valueType:n,typeName:Gt.ZodRecord,...br(r)}):new lx({keyType:Wl.create(),valueType:t,typeName:Gt.ZodRecord,...br(n)})}}class U2 extends wr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==hn.map)return cn(r,{code:Ut.invalid_type,expected:hn.map,received:r.parsedType}),Jn;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:i._parse(new eu(r,o,r.path,[c,"key"])),value:s._parse(new eu(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return Jn;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return Jn;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}U2.create=(e,t,n)=>new U2({valueType:t,keyType:e,typeName:Gt.ZodMap,...br(n)});class Op extends wr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==hn.set)return cn(r,{code:Ut.invalid_type,expected:hn.set,received:r.parsedType}),Jn;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(cn(r,{code:Ut.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(cn(r,{code:Ut.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return Jn;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>s._parse(new eu(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new Op({...this._def,minSize:{value:t,message:_n.toString(n)}})}max(t,n){return new Op({...this._def,maxSize:{value:t,message:_n.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}Op.create=(e,t)=>new Op({valueType:e,minSize:null,maxSize:null,typeName:Gt.ZodSet,...br(t)});class $g extends wr{constructor(){super(...arguments),this.validate=this.implement}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==hn.function)return cn(n,{code:Ut.invalid_type,expected:hn.function,received:n.parsedType}),Jn;function r(o,l){return L2({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,F2(),l0].filter(c=>!!c),issueData:{code:Ut.invalid_arguments,argumentsError:l}})}function i(o,l){return L2({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,F2(),l0].filter(c=>!!c),issueData:{code:Ut.invalid_return_type,returnTypeError:l}})}const s={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof u0){const o=this;return Ua(async function(...l){const c=new Lo([]),u=await o._def.args.parseAsync(l,s).catch(p=>{throw c.addIssue(r(l,p)),c}),d=await Reflect.apply(a,this,u);return await o._def.returns._def.type.parseAsync(d,s).catch(p=>{throw c.addIssue(i(d,p)),c})})}else{const o=this;return Ua(function(...l){const c=o._def.args.safeParse(l,s);if(!c.success)throw new Lo([r(l,c.error)]);const u=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(u,s);if(!d.success)throw new Lo([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new $g({...this._def,args:tu.create(t).rest(xp.create())})}returns(t){return new $g({...this._def,returns:t})}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new $g({args:t||tu.create([]).rest(xp.create()),returns:n||xp.create(),typeName:Gt.ZodFunction,...br(r)})}}class cx extends wr{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}cx.create=(e,t)=>new cx({getter:e,typeName:Gt.ZodLazy,...br(t)});class ux extends wr{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return cn(n,{received:n.data,code:Ut.invalid_literal,expected:this._def.value}),Jn}return{status:"valid",value:t.data}}get value(){return this._def.value}}ux.create=(e,t)=>new ux({value:e,typeName:Gt.ZodLiteral,...br(t)});function WH(e,t){return new Lf({values:e,typeName:Gt.ZodEnum,...br(t)})}class Lf extends wr{constructor(){super(...arguments),hv.set(this,void 0)}_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return cn(n,{expected:Br.joinValues(r),received:n.parsedType,code:Ut.invalid_type}),Jn}if(B2(this,hv)||UH(this,hv,new Set(this._def.values)),!B2(this,hv).has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return cn(n,{received:n.data,code:Ut.invalid_enum_value,options:r}),Jn}return Ua(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Lf.create(t,{...this._def,...n})}exclude(t,n=this._def){return Lf.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}hv=new WeakMap;Lf.create=WH;class dx extends wr{constructor(){super(...arguments),pv.set(this,void 0)}_parse(t){const n=Br.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==hn.string&&r.parsedType!==hn.number){const i=Br.objectValues(n);return cn(r,{expected:Br.joinValues(i),received:r.parsedType,code:Ut.invalid_type}),Jn}if(B2(this,pv)||UH(this,pv,new Set(Br.getValidEnumValues(this._def.values))),!B2(this,pv).has(t.data)){const i=Br.objectValues(n);return cn(r,{received:r.data,code:Ut.invalid_enum_value,options:i}),Jn}return Ua(t.data)}get enum(){return this._def.values}}pv=new WeakMap;dx.create=(e,t)=>new dx({values:e,typeName:Gt.ZodNativeEnum,...br(t)});class u0 extends wr{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==hn.promise&&n.common.async===!1)return cn(n,{code:Ut.invalid_type,expected:hn.promise,received:n.parsedType}),Jn;const r=n.parsedType===hn.promise?n.data:Promise.resolve(n.data);return Ua(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}u0.create=(e,t)=>new u0({type:e,typeName:Gt.ZodPromise,...br(t)});class ic extends wr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Gt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),i=this._def.effect||null,s={addIssue:a=>{cn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return Jn;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?Jn:l.status==="dirty"||n.value==="dirty"?Eg(l.value):l});{if(n.value==="aborted")return Jn;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?Jn:o.status==="dirty"||n.value==="dirty"?Eg(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?Jn:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?Jn:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Np(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Np(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:n.value,value:o})):a);Br.assertNever(i)}}ic.create=(e,t,n)=>new ic({schema:e,typeName:Gt.ZodEffects,effect:t,...br(n)});ic.createWithPreprocess=(e,t,n)=>new ic({schema:t,effect:{type:"preprocess",transform:e},typeName:Gt.ZodEffects,...br(n)});class Zl extends wr{_parse(t){return this._getType(t)===hn.undefined?Ua(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Zl.create=(e,t)=>new Zl({innerType:e,typeName:Gt.ZodOptional,...br(t)});class Bf extends wr{_parse(t){return this._getType(t)===hn.null?Ua(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Bf.create=(e,t)=>new Bf({innerType:e,typeName:Gt.ZodNullable,...br(t)});class fx extends wr{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===hn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}fx.create=(e,t)=>new fx({innerType:e,typeName:Gt.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...br(t)});class hx extends wr{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return nx(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Lo(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Lo(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}hx.create=(e,t)=>new hx({innerType:e,typeName:Gt.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...br(t)});class q2 extends wr{_parse(t){if(this._getType(t)!==hn.nan){const r=this._getOrReturnCtx(t);return cn(r,{code:Ut.invalid_type,expected:hn.nan,received:r.parsedType}),Jn}return{status:"valid",value:t.data}}}q2.create=e=>new q2({typeName:Gt.ZodNaN,...br(e)});const Bge=Symbol("zod_brand");class cO extends wr{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Rw extends wr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Jn:s.status==="dirty"?(n.dirty(),Eg(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Jn:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(t,n){return new Rw({in:t,out:n,typeName:Gt.ZodPipeline})}}class px extends wr{_parse(t){const n=this._def.innerType._parse(t),r=i=>(Np(i)&&(i.value=Object.freeze(i.value)),i);return nx(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}px.create=(e,t)=>new px({innerType:e,typeName:Gt.ZodReadonly,...br(t)});function LL(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function GH(e,t={},n){return e?c0.create().superRefine((r,i)=>{var s,a;const o=e(r);if(o instanceof Promise)return o.then(l=>{var c,u;if(!l){const d=LL(t,r),h=(u=(c=d.fatal)!==null&&c!==void 0?c:n)!==null&&u!==void 0?u:!0;i.addIssue({code:"custom",...d,fatal:h})}});if(!o){const l=LL(t,r),c=(a=(s=l.fatal)!==null&&s!==void 0?s:n)!==null&&a!==void 0?a:!0;i.addIssue({code:"custom",...l,fatal:c})}}):c0.create()}const $ge={object:Li.lazycreate};var Gt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Gt||(Gt={}));const zge=(e,t={message:`Input not instance of ${e.name}`})=>GH(n=>n instanceof e,t),KH=Wl.create,YH=Df.create,Uge=q2.create,qge=Ff.create,ZH=rx.create,Vge=jp.create,Hge=$2.create,Wge=ix.create,Gge=sx.create,Kge=c0.create,Yge=xp.create,Zge=dd.create,Xge=z2.create,Jge=Yl.create,Qge=Li.create,e0e=Li.strictCreate,t0e=ax.create,n0e=Gk.create,r0e=ox.create,i0e=tu.create,s0e=lx.create,a0e=U2.create,o0e=Op.create,l0e=$g.create,c0e=cx.create,u0e=ux.create,d0e=Lf.create,f0e=dx.create,h0e=u0.create,BL=ic.create,p0e=Zl.create,m0e=Bf.create,g0e=ic.createWithPreprocess,y0e=Rw.create,b0e=()=>KH().optional(),v0e=()=>YH().optional(),x0e=()=>ZH().optional(),w0e={string:e=>Wl.create({...e,coerce:!0}),number:e=>Df.create({...e,coerce:!0}),boolean:e=>rx.create({...e,coerce:!0}),bigint:e=>Ff.create({...e,coerce:!0}),date:e=>jp.create({...e,coerce:!0})},_0e=Jn;var L=Object.freeze({__proto__:null,defaultErrorMap:l0,setErrorMap:gge,getErrorMap:F2,makeIssue:L2,EMPTY_PATH:yge,addIssueToContext:cn,ParseStatus:xa,INVALID:Jn,DIRTY:Eg,OK:Ua,isAborted:k3,isDirty:E3,isValid:Np,isAsync:nx,get util(){return Br},get objectUtil(){return C3},ZodParsedType:hn,getParsedType:Yu,ZodType:wr,datetimeRegex:HH,ZodString:Wl,ZodNumber:Df,ZodBigInt:Ff,ZodBoolean:rx,ZodDate:jp,ZodSymbol:$2,ZodUndefined:ix,ZodNull:sx,ZodAny:c0,ZodUnknown:xp,ZodNever:dd,ZodVoid:z2,ZodArray:Yl,ZodObject:Li,ZodUnion:ax,ZodDiscriminatedUnion:Gk,ZodIntersection:ox,ZodTuple:tu,ZodRecord:lx,ZodMap:U2,ZodSet:Op,ZodFunction:$g,ZodLazy:cx,ZodLiteral:ux,ZodEnum:Lf,ZodNativeEnum:dx,ZodPromise:u0,ZodEffects:ic,ZodTransformer:ic,ZodOptional:Zl,ZodNullable:Bf,ZodDefault:fx,ZodCatch:hx,ZodNaN:q2,BRAND:Bge,ZodBranded:cO,ZodPipeline:Rw,ZodReadonly:px,custom:GH,Schema:wr,ZodSchema:wr,late:$ge,get ZodFirstPartyTypeKind(){return Gt},coerce:w0e,any:Kge,array:Jge,bigint:qge,boolean:ZH,date:Vge,discriminatedUnion:n0e,effect:BL,enum:d0e,function:l0e,instanceof:zge,intersection:r0e,lazy:c0e,literal:u0e,map:a0e,nan:Uge,nativeEnum:f0e,never:Zge,null:Gge,nullable:m0e,number:YH,object:Qge,oboolean:x0e,onumber:v0e,optional:p0e,ostring:b0e,pipeline:y0e,preprocess:g0e,promise:h0e,record:s0e,set:o0e,strictObject:e0e,string:KH,symbol:Hge,transformer:BL,tuple:i0e,undefined:Wge,union:t0e,unknown:Yge,void:Xge,NEVER:_0e,ZodIssueCode:Ut,quotelessJson:mge,ZodError:Lo});function S0e({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],i=[];for(const{role:s,content:a}of e)switch(s){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{i.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Pf(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new Wr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new Wr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new Wr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=s;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:i}}function $L(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:i,top_logprobs:s})=>({token:r,logprob:i,topLogprobs:s?s.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function V2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var uO=L.object({error:L.object({message:L.string(),type:L.string().nullish(),param:L.any().nullish(),code:L.union([L.string(),L.number()]).nullish()})}),nu=Yp({errorSchema:uO,errorToMessage:e=>e.error.message});function H2({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function C0e({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const i=(r=e.tools)!=null&&r.length?e.tools:void 0,s=[];if(i==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const a=e.toolChoice;if(t){const c=[];for(const d of i)d.type==="provider-defined"?s.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:s};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:s};case"required":throw new Wr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:s}}}const o=[];for(const c of i)c.type==="provider-defined"?s.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:s};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:s};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:s};default:{const c=l;throw new Wr({functionality:`Unsupported tool choice type: ${c}`})}}}var k0e=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:A3(this.modelId)}get defaultObjectGenerationMode(){return A0e(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:i,topK:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,p,y,b,x,w,_,S;const C=e.type,E=[];s!=null&&E.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&E.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const T=this.settings.useLegacyFunctionCalling;if(T&&this.settings.parallelToolCalls===!0)throw new Wr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(T&&this.supportsStructuredOutputs)throw new Wr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:R,warnings:M}=S0e({prompt:t,useLegacyFunctionCalling:T,systemMessageMode:R0e(this.modelId)});E.push(...M);const N={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:i,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(p=d==null?void 0:d.openai)==null?void 0:p.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(x=d==null?void 0:d.openai)==null?void 0:x.prediction,reasoning_effort:(_=(w=d==null?void 0:d.openai)==null?void 0:w.reasoningEffort)!=null?_:this.settings.reasoningEffort,messages:R};switch(A3(this.modelId)?(N.temperature!=null&&(N.temperature=void 0,E.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),N.top_p!=null&&(N.top_p=void 0,E.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),N.frequency_penalty!=null&&(N.frequency_penalty=void 0,E.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),N.presence_penalty!=null&&(N.presence_penalty=void 0,E.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),N.logit_bias!=null&&(N.logit_bias=void 0,E.push({type:"other",message:"logitBias is not supported for reasoning models"})),N.logprobs!=null&&(N.logprobs=void 0,E.push({type:"other",message:"logprobs is not supported for reasoning models"})),N.top_logprobs!=null&&(N.top_logprobs=void 0,E.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),N.max_tokens!=null&&(N.max_completion_tokens==null&&(N.max_completion_tokens=N.max_tokens),N.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&N.temperature!=null&&(N.temperature=void 0,E.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),C){case"regular":{const{tools:O,tool_choice:B,functions:P,function_call:H,toolWarnings:F}=C0e({mode:e,useLegacyFunctionCalling:T,structuredOutputs:this.supportsStructuredOutputs});return{args:{...N,tools:O,tool_choice:B,functions:P,function_call:H},warnings:[...E,...F]}}case"object-json":return{args:{...N,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:E};case"object-tool":return{args:T?{...N,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...N,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:E};default:{const O=C;throw new Error(`Unsupported type: ${O}`)}}}async doGenerate(e){var t,n,r,i,s,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:p}=await is({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:c,failedResponseHandler:nu,successfulResponseHandler:vo(E0e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,x=h.choices[0],w=(t=h.usage)==null?void 0:t.completion_tokens_details,_=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(w==null?void 0:w.reasoning_tokens)!=null&&(S.openai.reasoningTokens=w==null?void 0:w.reasoning_tokens),(w==null?void 0:w.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=w==null?void 0:w.accepted_prediction_tokens),(w==null?void 0:w.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=w==null?void 0:w.rejected_prediction_tokens),(_==null?void 0:_.cached_tokens)!=null&&(S.openai.cachedPromptTokens=_==null?void 0:_.cached_tokens),{text:(r=x.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&x.message.function_call?[{toolCallType:"function",toolCallId:ro(),toolName:x.message.function_call.name,args:x.message.function_call.arguments}]:(i=x.message.tool_calls)==null?void 0:i.map(C=>{var E;return{toolCallType:"function",toolCallId:(E=C.id)!=null?E:ro(),toolName:C.function.name,args:C.function.arguments}}),finishReason:V2(x.finish_reason),usage:{promptTokens:(a=(s=h.usage)==null?void 0:s.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:p},request:{body:JSON.stringify(c)},response:H2(h),warnings:u,logprobs:$L(x.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(w){if(w.enqueue({type:"response-metadata",...b.response}),b.text&&w.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const _ of b.toolCalls)w.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:_.toolCallId,toolName:_.toolName,argsTextDelta:_.args}),w.enqueue({type:"tool-call",..._});w.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),w.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:i,value:s}=await is({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:r,failedResponseHandler:nu,successfulResponseHandler:Z0(T0e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:p}=this.settings,y={openai:{}};return{stream:s.pipeThrough(new TransformStream({transform(b,x){var w,_,S,C,E,T,R,M,N,O,B,P;if(!b.success){c="error",x.enqueue({type:"error",error:b.error});return}const H=b.value;if("error"in H){c="error",x.enqueue({type:"error",error:H.error});return}if(h&&(h=!1,x.enqueue({type:"response-metadata",...H2(H)})),H.usage!=null){const{prompt_tokens:U,completion_tokens:re,prompt_tokens_details:G,completion_tokens_details:ne}=H.usage;u={promptTokens:U??void 0,completionTokens:re??void 0},(ne==null?void 0:ne.reasoning_tokens)!=null&&(y.openai.reasoningTokens=ne==null?void 0:ne.reasoning_tokens),(ne==null?void 0:ne.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=ne==null?void 0:ne.accepted_prediction_tokens),(ne==null?void 0:ne.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=ne==null?void 0:ne.rejected_prediction_tokens),(G==null?void 0:G.cached_tokens)!=null&&(y.openai.cachedPromptTokens=G==null?void 0:G.cached_tokens)}const F=H.choices[0];if((F==null?void 0:F.finish_reason)!=null&&(c=V2(F.finish_reason)),(F==null?void 0:F.delta)==null)return;const Q=F.delta;Q.content!=null&&x.enqueue({type:"text-delta",textDelta:Q.content});const q=$L(F==null?void 0:F.logprobs);q!=null&&q.length&&(d===void 0&&(d=[]),d.push(...q));const K=p&&Q.function_call!=null?[{type:"function",id:ro(),function:Q.function_call,index:0}]:Q.tool_calls;if(K!=null)for(const U of K){const re=U.index;if(l[re]==null){if(U.type!=="function")throw new Bg({data:U,message:"Expected 'function' type."});if(U.id==null)throw new Bg({data:U,message:"Expected 'id' to be a string."});if(((w=U.function)==null?void 0:w.name)==null)throw new Bg({data:U,message:"Expected 'function.name' to be a string."});l[re]={id:U.id,type:"function",function:{name:U.function.name,arguments:(_=U.function.arguments)!=null?_:""},hasFinished:!1};const ne=l[re];((S=ne.function)==null?void 0:S.name)!=null&&((C=ne.function)==null?void 0:C.arguments)!=null&&(ne.function.arguments.length>0&&x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ne.id,toolName:ne.function.name,argsTextDelta:ne.function.arguments}),D2(ne.function.arguments)&&(x.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(E=ne.id)!=null?E:ro(),toolName:ne.function.name,args:ne.function.arguments}),ne.hasFinished=!0));continue}const G=l[re];G.hasFinished||(((T=U.function)==null?void 0:T.arguments)!=null&&(G.function.arguments+=(M=(R=U.function)==null?void 0:R.arguments)!=null?M:""),x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:G.id,toolName:G.function.name,argsTextDelta:(N=U.function.arguments)!=null?N:""}),((O=G.function)==null?void 0:O.name)!=null&&((B=G.function)==null?void 0:B.arguments)!=null&&D2(G.function.arguments)&&(x.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=G.id)!=null?P:ro(),toolName:G.function.name,args:G.function.arguments}),G.hasFinished=!0))}},flush(b){var x,w;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(x=u.promptTokens)!=null?x:NaN,completionTokens:(w=u.completionTokens)!=null?w:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:i},request:{body:JSON.stringify(r)},warnings:n}}},XH=L.object({prompt_tokens:L.number().nullish(),completion_tokens:L.number().nullish(),prompt_tokens_details:L.object({cached_tokens:L.number().nullish()}).nullish(),completion_tokens_details:L.object({reasoning_tokens:L.number().nullish(),accepted_prediction_tokens:L.number().nullish(),rejected_prediction_tokens:L.number().nullish()}).nullish()}).nullish(),E0e=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({message:L.object({role:L.literal("assistant").nullish(),content:L.string().nullish(),function_call:L.object({arguments:L.string(),name:L.string()}).nullish(),tool_calls:L.array(L.object({id:L.string().nullish(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),index:L.number(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullish(),finish_reason:L.string().nullish()})),usage:XH}),T0e=L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).nullish(),content:L.string().nullish(),function_call:L.object({name:L.string().optional(),arguments:L.string().optional()}).nullish(),tool_calls:L.array(L.object({index:L.number(),id:L.string().nullish(),type:L.literal("function").nullish(),function:L.object({name:L.string().nullish(),arguments:L.string().nullish()})})).nullish()}).nullish(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullish(),finish_reason:L.string().nullish(),index:L.number()})),usage:XH}),uO]);function A3(e){return e.startsWith("o")}function A0e(e){return e.startsWith("gpt-4o-audio-preview")}function R0e(e){var t,n;return A3(e)?(n=(t=I0e[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var I0e={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function M0e({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let i="";e[0].role==="system"&&(i+=`${e[0].content}

`,e=e.slice(1));for(const{role:s,content:a}of e)switch(s){case"system":throw new Lc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new Wr({functionality:"images"})}}).join("");i+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new Wr({functionality:"tool-call messages"})}}).join("");i+=`${r}:
${o}

`;break}case"tool":throw new Wr({functionality:"tool messages"});default:{const o=s;throw new Error(`Unsupported role: ${o}`)}}return i+=`${r}:
`,{prompt:i,stopSequences:[`
${n}:`]}}function zL(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,i])=>({token:r,logprob:i})):[]}))}var N0e=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:i,topP:s,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const p=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:x}=M0e({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],_={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:i,top_p:s,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:w.length>0?w:void 0};switch(p){case"regular":{if((h=e.tools)!=null&&h.length)throw new Wr({functionality:"tools"});if(e.toolChoice)throw new Wr({functionality:"toolChoice"});return{args:_,warnings:y}}case"object-json":throw new Wr({functionality:"object-json mode"});case"object-tool":throw new Wr({functionality:"object-tool mode"});default:{const S=p;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:i,rawValue:s}=await is({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:t,failedResponseHandler:nu,successfulResponseHandler:vo(j0e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=i.choices[0];return{text:l.text,usage:{promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},finishReason:V2(l.finish_reason),logprobs:zL(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:s},response:H2(i),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:i,value:s}=await is({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:r,failedResponseHandler:nu,successfulResponseHandler:Z0(O0e),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:s.pipeThrough(new TransformStream({transform(h,p){if(!h.success){l="error",p.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",p.enqueue({type:"error",error:y.error});return}d&&(d=!1,p.enqueue({type:"response-metadata",...H2(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=V2(b.finish_reason)),(b==null?void 0:b.text)!=null&&p.enqueue({type:"text-delta",textDelta:b.text});const x=zL(b==null?void 0:b.logprobs);x!=null&&x.length&&(u===void 0&&(u=[]),u.push(...x))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:i},warnings:n,request:{body:JSON.stringify(r)}}}},j0e=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullish()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()})}),O0e=L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string().nullish(),index:L.number(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullish()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()}),uO]),P0e=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new Uk({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:i}=await is({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:rs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:nu,successfulResponseHandler:vo(D0e),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(s=>s.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},D0e=L.object({data:L.array(L.object({embedding:L.array(L.number())})),usage:L.object({prompt_tokens:L.number()}).nullish()}),F0e={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},L0e=new Set(["gpt-image-1"]),B0e=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:F0e[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:i,providerOptions:s,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),i!=null&&h.push({type:"unsupported-setting",setting:"seed"});const p=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await is({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:rs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=s.openai)!=null?d:{},...L0e.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:nu,successfulResponseHandler:vo($0e),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(x=>x.b64_json),warnings:h,response:{timestamp:p,modelId:this.modelId,headers:b}}}},$0e=L.object({data:L.array(L.object({b64_json:L.string()}))}),z0e=L.object({include:L.array(L.string()).nullish(),language:L.string().nullish(),prompt:L.string().nullish(),temperature:L.number().min(0).max(1).nullish().default(0),timestampGranularities:L.array(L.enum(["word","segment"])).nullish().default(["segment"])}),UL={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},U0e=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,i,s,a,o;const l=[],c=Vk({provider:"openai",providerOptions:n,schema:z0e}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([Hk(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(i=c.language)!=null?i:void 0,prompt:(s=c.prompt)!=null?s:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const p in h){const y=h[p];y!==void 0&&u.append(p,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,i,s,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await dge({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),formData:l,failedResponseHandler:nu,successfulResponseHandler:vo(q0e),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=u.language!=null&&u.language in UL?UL[u.language]:void 0;return{text:u.text,segments:(s=(i=u.words)==null?void 0:i.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?s:[],language:p,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},q0e=L.object({text:L.string(),language:L.string().nullish(),duration:L.number().nullish(),words:L.array(L.object({word:L.string(),start:L.number(),end:L.number()})).nullish()});function V0e({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:i,content:s}of e)switch(i){case"system":{switch(t){case"system":{n.push({role:"system",content:s});break}case"developer":{n.push({role:"developer",content:s});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:s.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Pf(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new Wr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new Wr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of s)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of s)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function qL({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function H0e({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,i=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const s=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:i.push({type:"unsupported-tool",tool:l});break}break;default:i.push({type:"unsupported-tool",tool:l});break}if(s==null)return{tools:a,tool_choice:void 0,toolWarnings:i};const o=s.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:i};case"tool":return s.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:i}:{tools:a,tool_choice:{type:"function",name:s.toolName},toolWarnings:i};default:{const l=o;throw new Wr({functionality:`Unsupported tool choice type: ${l}`})}}}var W0e=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:i,topK:s,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,p,y;const b=[],x=uye(this.modelId),w=e.type;s!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:_,warnings:S}=V0e({prompt:c,systemMessageMode:x.systemMessageMode});b.push(...S);const C=Vk({provider:"openai",providerOptions:u,schema:dye}),E=(h=C==null?void 0:C.strictSchemas)!=null?h:!0,T={model:this.modelId,input:_,temperature:n,top_p:i,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:E,name:(p=d.name)!=null?p:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:C==null?void 0:C.metadata,parallel_tool_calls:C==null?void 0:C.parallelToolCalls,previous_response_id:C==null?void 0:C.previousResponseId,store:C==null?void 0:C.store,user:C==null?void 0:C.user,instructions:C==null?void 0:C.instructions,...x.isReasoningModel&&((C==null?void 0:C.reasoningEffort)!=null||(C==null?void 0:C.reasoningSummary)!=null)&&{reasoning:{...(C==null?void 0:C.reasoningEffort)!=null&&{effort:C.reasoningEffort},...(C==null?void 0:C.reasoningSummary)!=null&&{summary:C.reasoningSummary}}},...x.requiredAutoTruncation&&{truncation:"auto"}};switch(x.isReasoningModel&&(T.temperature!=null&&(T.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),T.top_p!=null&&(T.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),w){case"regular":{const{tools:R,tool_choice:M,toolWarnings:N}=H0e({mode:e,strict:E});return{args:{...T,tools:R,tool_choice:M},warnings:[...b,...N]}}case"object-json":return{args:{...T,text:{format:e.schema!=null?{type:"json_schema",strict:E,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:E}]},warnings:b};default:{const R=w;throw new Error(`Unsupported type: ${R}`)}}}async doGenerate(e){var t,n,r,i,s,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await is({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:l,failedResponseHandler:nu,successfulResponseHandler:vo(L.object({id:L.string(),created_at:L.number(),model:L.string(),output:L.array(L.discriminatedUnion("type",[L.object({type:L.literal("message"),role:L.literal("assistant"),content:L.array(L.object({type:L.literal("output_text"),text:L.string(),annotations:L.array(L.object({type:L.literal("url_citation"),start_index:L.number(),end_index:L.number(),url:L.string(),title:L.string()}))}))}),L.object({type:L.literal("function_call"),call_id:L.string(),name:L.string(),arguments:L.string()}),L.object({type:L.literal("web_search_call")}),L.object({type:L.literal("computer_call")}),L.object({type:L.literal("reasoning"),summary:L.array(L.object({type:L.literal("summary_text"),text:L.string()}))})])),incomplete_details:L.object({reason:L.string()}).nullable(),usage:JH})),abortSignal:e.abortSignal,fetch:this.config.fetch}),p=d.output.filter(x=>x.type==="message").flatMap(x=>x.content).filter(x=>x.type==="output_text"),y=d.output.filter(x=>x.type==="function_call").map(x=>({toolCallType:"function",toolCallId:x.call_id,toolName:x.name,args:x.arguments})),b=(n=(t=d.output.find(x=>x.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:p.map(x=>x.text).join(`
`),sources:p.flatMap(x=>x.annotations.map(w=>{var _,S,C;return{sourceType:"url",id:(C=(S=(_=this.config).generateId)==null?void 0:S.call(_))!=null?C:ro(),url:w.url,title:w.title}})),finishReason:qL({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(x=>({type:"text",text:x.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(s=(i=d.usage.input_tokens_details)==null?void 0:i.cached_tokens)!=null?s:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:i}=await is({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:nu,successfulResponseHandler:Z0(tye),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let p=!1;return{stream:i.pipeThrough(new TransformStream({transform(y,b){var x,w,_,S,C,E,T,R;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const M=y.value;if(oye(M))M.item.type==="function_call"&&(h[M.output_index]={toolName:M.item.name,toolCallId:M.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:M.item.call_id,toolName:M.item.name,argsTextDelta:M.item.arguments}));else if(aye(M)){const N=h[M.output_index];N!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.toolCallId,toolName:N.toolName,argsTextDelta:M.delta})}else sye(M)?(d=M.response.id,b.enqueue({type:"response-metadata",id:M.response.id,timestamp:new Date(M.response.created_at*1e3),modelId:M.response.model})):nye(M)?b.enqueue({type:"text-delta",textDelta:M.delta}):cye(M)?b.enqueue({type:"reasoning",textDelta:M.delta}):rye(M)&&M.item.type==="function_call"?(h[M.output_index]=void 0,p=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:M.item.call_id,toolName:M.item.name,args:M.item.arguments})):iye(M)?(a=qL({finishReason:(x=M.response.incomplete_details)==null?void 0:x.reason,hasToolCalls:p}),o=M.response.usage.input_tokens,l=M.response.usage.output_tokens,c=(_=(w=M.response.usage.input_tokens_details)==null?void 0:w.cached_tokens)!=null?_:c,u=(C=(S=M.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?C:u):lye(M)&&b.enqueue({type:"source",source:{sourceType:"url",id:(R=(T=(E=s.config).generateId)==null?void 0:T.call(E))!=null?R:ro(),url:M.annotation.url,title:M.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},JH=L.object({input_tokens:L.number(),input_tokens_details:L.object({cached_tokens:L.number().nullish()}).nullish(),output_tokens:L.number(),output_tokens_details:L.object({reasoning_tokens:L.number().nullish()}).nullish()}),G0e=L.object({type:L.literal("response.output_text.delta"),delta:L.string()}),K0e=L.object({type:L.enum(["response.completed","response.incomplete"]),response:L.object({incomplete_details:L.object({reason:L.string()}).nullish(),usage:JH})}),Y0e=L.object({type:L.literal("response.created"),response:L.object({id:L.string(),created_at:L.number(),model:L.string()})}),Z0e=L.object({type:L.literal("response.output_item.done"),output_index:L.number(),item:L.discriminatedUnion("type",[L.object({type:L.literal("message")}),L.object({type:L.literal("function_call"),id:L.string(),call_id:L.string(),name:L.string(),arguments:L.string(),status:L.literal("completed")})])}),X0e=L.object({type:L.literal("response.function_call_arguments.delta"),item_id:L.string(),output_index:L.number(),delta:L.string()}),J0e=L.object({type:L.literal("response.output_item.added"),output_index:L.number(),item:L.discriminatedUnion("type",[L.object({type:L.literal("message")}),L.object({type:L.literal("function_call"),id:L.string(),call_id:L.string(),name:L.string(),arguments:L.string()})])}),Q0e=L.object({type:L.literal("response.output_text.annotation.added"),annotation:L.object({type:L.literal("url_citation"),url:L.string(),title:L.string()})}),eye=L.object({type:L.literal("response.reasoning_summary_text.delta"),item_id:L.string(),output_index:L.number(),summary_index:L.number(),delta:L.string()}),tye=L.union([G0e,K0e,Y0e,Z0e,X0e,J0e,Q0e,eye,L.object({type:L.string()}).passthrough()]);function nye(e){return e.type==="response.output_text.delta"}function rye(e){return e.type==="response.output_item.done"}function iye(e){return e.type==="response.completed"||e.type==="response.incomplete"}function sye(e){return e.type==="response.created"}function aye(e){return e.type==="response.function_call_arguments.delta"}function oye(e){return e.type==="response.output_item.added"}function lye(e){return e.type==="response.output_text.annotation.added"}function cye(e){return e.type==="response.reasoning_summary_text.delta"}function uye(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var dye=L.object({metadata:L.any().nullish(),parallelToolCalls:L.boolean().nullish(),previousResponseId:L.string().nullish(),store:L.boolean().nullish(),user:L.string().nullish(),reasoningEffort:L.string().nullish(),strictSchemas:L.boolean().nullish(),instructions:L.string().nullish(),reasoningSummary:L.string().nullish()}),fye=L.object({});function hye({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:fye}}var pye={webSearchPreview:hye},mye=L.object({instructions:L.string().nullish(),speed:L.number().min(.25).max(4).default(1).nullish()}),gye=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:i,providerOptions:s}){const a=[],o=Vk({provider:"openai",providerOptions:s,schema:mye}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:i};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const i=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:s,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await is({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:s,failedResponseHandler:nu,successfulResponseHandler:fge(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(s)},response:{timestamp:i,modelId:this.modelId,headers:l,body:c}}}};function QH(e={}){var t,n,r;const i=(t=Wk(e.baseURL))!=null?t:"https://api.openai.com/v1",s=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${BH({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(w,_={})=>new k0e(w,_,{provider:`${a}.chat`,url:({path:S})=>`${i}${S}`,headers:o,compatibility:s,fetch:e.fetch}),c=(w,_={})=>new N0e(w,_,{provider:`${a}.completion`,url:({path:S})=>`${i}${S}`,headers:o,compatibility:s,fetch:e.fetch}),u=(w,_={})=>new P0e(w,_,{provider:`${a}.embedding`,url:({path:S})=>`${i}${S}`,headers:o,fetch:e.fetch}),d=(w,_={})=>new B0e(w,_,{provider:`${a}.image`,url:({path:S})=>`${i}${S}`,headers:o,fetch:e.fetch}),h=w=>new U0e(w,{provider:`${a}.transcription`,url:({path:_})=>`${i}${_}`,headers:o,fetch:e.fetch}),p=w=>new gye(w,{provider:`${a}.speech`,url:({path:_})=>`${i}${_}`,headers:o,fetch:e.fetch}),y=(w,_)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return w==="gpt-3.5-turbo-instruct"?c(w,_):l(w,_)},b=w=>new W0e(w,{provider:`${a}.responses`,url:({path:_})=>`${i}${_}`,headers:o,fetch:e.fetch}),x=function(w,_){return y(w,_)};return x.languageModel=y,x.chat=l,x.completion=c,x.responses=b,x.embedding=u,x.textEmbedding=u,x.textEmbeddingModel=u,x.image=d,x.imageModel=d,x.transcription=h,x.transcriptionModel=h,x.speech=p,x.speechModel=p,x.tools=pye,x}QH({compatibility:"strict"});function dl(e){if(yye(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:i,items:s,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,p={};if(n&&(p.description=n),r&&(p.required=r),c&&(p.format=c),u!==void 0&&(p.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(p.type=t.filter(y=>y!=="null")[0],p.nullable=!0):p.type=t:t==="null"?p.type="null":p.type=t),h!==void 0&&(p.enum=h),i!=null&&(p.properties=Object.entries(i).reduce((y,[b,x])=>(y[b]=dl(x),y),{})),s&&(p.items=Array.isArray(s)?s.map(dl):dl(s)),a&&(p.allOf=a.map(dl)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=dl(y[0]);typeof b=="object"&&(p.nullable=!0,Object.assign(p,b))}else p.anyOf=y.map(dl),p.nullable=!0}else p.anyOf=o.map(dl);return l&&(p.oneOf=l.map(dl)),d!==void 0&&(p.minLength=d),p}function yye(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function bye(e){var t,n;const r=[],i=[];let s=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!s)throw new Wr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{s=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Pf(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}i.push({role:"user",parts:l});break}case"assistant":{s=!1,i.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new Wr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new Wr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{s=!1,i.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:i}}function VL(e){return e.includes("/")?e:`models/${e}`}var vye=L.object({error:L.object({code:L.number().nullable(),message:L.string(),status:L.string()})}),R3=Yp({errorSchema:vye,errorToMessage:e=>e.error.message});function xye(e,t,n,r){var i,s;const a=(i=e.tools)!=null&&i.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const p of a)p.type==="provider-defined"?o.push({type:"unsupported-tool",tool:p}):u.push({name:p.name,description:(s=p.description)!=null?s:"",parameters:dl(p.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const p=h;throw new Wr({functionality:`Unsupported tool choice type: ${p}`})}}}function HL({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var wye=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:i,topK:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,p,y;const b=e.type,x=[],w=Vk({provider:"google",providerOptions:d,schema:kye});((h=w==null?void 0:w.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&x.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const _={maxOutputTokens:n,temperature:r,topK:s,topP:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?dl(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:w==null?void 0:w.responseModalities,thinkingConfig:w==null?void 0:w.thinkingConfig},{contents:S,systemInstruction:C}=bye(t);switch(b){case"regular":{const{tools:E,toolConfig:T,toolWarnings:R}=xye(e,(p=this.settings.useSearchGrounding)!=null?p:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:_,contents:S,systemInstruction:C,safetySettings:this.settings.safetySettings,tools:E,toolConfig:T,cachedContent:this.settings.cachedContent},warnings:[...x,...R]}}case"object-json":return{args:{generationConfig:{..._,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?dl(e.schema):void 0},contents:S,systemInstruction:C,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:x};case"object-tool":return{args:{generationConfig:_,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:dl(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:x};default:{const E=b;throw new Error(`Unsupported type: ${E}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,i,s;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=rs(await S3(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await is({url:`${this.config.baseURL}/${VL(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:R3,successfulResponseHandler:vo(Sye),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:p,...y}=a,b=d.candidates[0],x=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,w=WL({parts:x,generateId:this.config.generateId}),_=d.usageMetadata;return{text:GL(x),reasoning:KL(x),files:(t=YL(x))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:w,finishReason:HL({finishReason:b.finishReason,hasToolCalls:w!=null&&w.length>0}),usage:{promptTokens:(n=_==null?void 0:_.promptTokenCount)!=null?n:NaN,completionTokens:(r=_==null?void 0:_.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:p,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(i=b.groundingMetadata)!=null?i:null,safetyRatings:(s=b.safetyRatings)!=null?s:null}},sources:ZL({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),i=rs(await S3(this.config.headers),e.headers),{responseHeaders:s,value:a}=await is({url:`${this.config.baseURL}/${VL(this.modelId)}:streamGenerateContent?alt=sse`,headers:i,body:t,failedResponseHandler:R3,successfulResponseHandler:Z0(Cye),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let p=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var x,w,_,S,C,E;if(!y.success){b.enqueue({type:"error",error:y.error});return}const T=y.value,R=T.usageMetadata;R!=null&&(u={promptTokens:(x=R.promptTokenCount)!=null?x:NaN,completionTokens:(w=R.candidatesTokenCount)!=null?w:NaN});const M=(_=T.candidates)==null?void 0:_[0];if(M==null)return;const N=M.content;if(N!=null){const O=GL(N.parts);O!=null&&b.enqueue({type:"text-delta",textDelta:O});const B=KL(N.parts);if(B!=null)for(const F of B)b.enqueue({type:"reasoning",textDelta:F.text});const P=YL(N.parts);if(P!=null)for(const F of P)b.enqueue({type:"file",mimeType:F.inlineData.mimeType,data:F.inlineData.data});const H=WL({parts:N.parts,generateId:h});if(H!=null)for(const F of H)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:F.toolCallId,toolName:F.toolName,argsTextDelta:F.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:F.toolCallId,toolName:F.toolName,args:F.args}),p=!0}if(M.finishReason!=null){c=HL({finishReason:M.finishReason,hasToolCalls:p});const O=(S=ZL({groundingMetadata:M.groundingMetadata,generateId:h}))!=null?S:[];for(const B of O)b.enqueue({type:"source",source:B});d={google:{groundingMetadata:(C=M.groundingMetadata)!=null?C:null,safetyRatings:(E=M.safetyRatings)!=null?E:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:n,request:{body:r}}}};function WL({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function GL(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function KL(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function YL(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function ZL({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var eW=L.object({parts:L.array(L.union([L.object({functionCall:L.object({name:L.string(),args:L.unknown()})}),L.object({inlineData:L.object({mimeType:L.string(),data:L.string()})}),L.object({text:L.string().nullish(),thought:L.boolean().nullish()})])).nullish()}),_ye=L.object({web:L.object({uri:L.string(),title:L.string()}).nullish(),retrievedContext:L.object({uri:L.string(),title:L.string()}).nullish()}),tW=L.object({webSearchQueries:L.array(L.string()).nullish(),retrievalQueries:L.array(L.string()).nullish(),searchEntryPoint:L.object({renderedContent:L.string()}).nullish(),groundingChunks:L.array(_ye).nullish(),groundingSupports:L.array(L.object({segment:L.object({startIndex:L.number().nullish(),endIndex:L.number().nullish(),text:L.string().nullish()}),segment_text:L.string().nullish(),groundingChunkIndices:L.array(L.number()).nullish(),supportChunkIndices:L.array(L.number()).nullish(),confidenceScores:L.array(L.number()).nullish(),confidenceScore:L.array(L.number()).nullish()})).nullish(),retrievalMetadata:L.union([L.object({webDynamicRetrievalScore:L.number()}),L.object({})]).nullish()}),nW=L.object({category:L.string().nullish(),probability:L.string().nullish(),probabilityScore:L.number().nullish(),severity:L.string().nullish(),severityScore:L.number().nullish(),blocked:L.boolean().nullish()}),Sye=L.object({candidates:L.array(L.object({content:eW.nullish().or(L.object({}).strict()),finishReason:L.string().nullish(),safetyRatings:L.array(nW).nullish(),groundingMetadata:tW.nullish()})),usageMetadata:L.object({promptTokenCount:L.number().nullish(),candidatesTokenCount:L.number().nullish(),totalTokenCount:L.number().nullish()}).nullish()}),Cye=L.object({candidates:L.array(L.object({content:eW.nullish(),finishReason:L.string().nullish(),safetyRatings:L.array(nW).nullish(),groundingMetadata:tW.nullish()})).nullish(),usageMetadata:L.object({promptTokenCount:L.number().nullish(),candidatesTokenCount:L.number().nullish(),totalTokenCount:L.number().nullish()}).nullish()}),kye=L.object({responseModalities:L.array(L.enum(["TEXT","IMAGE"])).nullish(),thinkingConfig:L.object({thinkingBudget:L.number().nullish(),includeThoughts:L.boolean().nullish()}).nullish()}),Eye=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new Uk({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=rs(await S3(this.config.headers),t),{responseHeaders:i,value:s}=await is({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:R3,successfulResponseHandler:vo(Tye),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:i}}}},Tye=L.object({embeddings:L.array(L.object({values:L.array(L.number())}))});function Aye(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function rW(e={}){var t;const n=(t=Wk(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":BH({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),i=(o,l={})=>{var c;return new wye(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:ro,isSupportedUrl:Aye,fetch:e.fetch})},s=(o,l={})=>new Eye(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return i(o,l)};return a.languageModel=i,a.chat=i,a.generativeAI=i,a.embedding=s,a.textEmbedding=s,a.textEmbeddingModel=s,a}rW();var iW="vercel.ai.error",Rye=Symbol.for(iW),sW,Iye=class aW extends Error{constructor({name:t,message:n,cause:r}){super(n),this[sW]=!0,this.name=t,this.cause=r}static isInstance(t){return aW.hasMarker(t,iW)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};sW=Rye;var Us=Iye,oW="AI_APICallError",lW=`vercel.ai.error.${oW}`,Mye=Symbol.for(lW),cW,Ju=class extends Us{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:i,responseBody:s,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:oW,message:e,cause:a}),this[cW]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=i,this.responseBody=s,this.isRetryable=o,this.data=l}static isInstance(e){return Us.hasMarker(e,lW)}};cW=Mye;var uW="AI_EmptyResponseBodyError",dW=`vercel.ai.error.${uW}`,Nye=Symbol.for(dW),fW,jye=class extends Us{constructor({message:e="Empty response body"}={}){super({name:uW,message:e}),this[fW]=!0}static isInstance(e){return Us.hasMarker(e,dW)}};fW=Nye;function hW(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var pW="AI_InvalidArgumentError",mW=`vercel.ai.error.${pW}`,Oye=Symbol.for(mW),gW,Pye=class extends Us{constructor({message:t,cause:n,argument:r}){super({name:pW,message:t,cause:n}),this[gW]=!0,this.argument=r}static isInstance(t){return Us.hasMarker(t,mW)}};gW=Oye;var yW="AI_InvalidPromptError",bW=`vercel.ai.error.${yW}`,Dye=Symbol.for(bW),vW,Fye=class extends Us{constructor({prompt:e,message:t,cause:n}){super({name:yW,message:`Invalid prompt: ${t}`,cause:n}),this[vW]=!0,this.prompt=e}static isInstance(e){return Us.hasMarker(e,bW)}};vW=Dye;var xW="AI_InvalidResponseDataError",wW=`vercel.ai.error.${xW}`,Lye=Symbol.for(wW),_W,qR=class extends Us{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:xW,message:t}),this[_W]=!0,this.data=e}static isInstance(e){return Us.hasMarker(e,wW)}};_W=Lye;var SW="AI_JSONParseError",CW=`vercel.ai.error.${SW}`,Bye=Symbol.for(CW),kW,W2=class extends Us{constructor({text:e,cause:t}){super({name:SW,message:`JSON parsing failed: Text: ${e}.
Error message: ${hW(t)}`,cause:t}),this[kW]=!0,this.text=e}static isInstance(e){return Us.hasMarker(e,CW)}};kW=Bye;var EW="AI_LoadAPIKeyError",TW=`vercel.ai.error.${EW}`,$ye=Symbol.for(TW),AW,X_=class extends Us{constructor({message:e}){super({name:EW,message:e}),this[AW]=!0}static isInstance(e){return Us.hasMarker(e,TW)}};AW=$ye;var RW="AI_TypeValidationError",IW=`vercel.ai.error.${RW}`,zye=Symbol.for(IW),MW,Uye=class I3 extends Us{constructor({value:t,cause:n}){super({name:RW,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${hW(n)}`,cause:n}),this[MW]=!0,this.value=t}static isInstance(t){return Us.hasMarker(t,IW)}static wrap({value:t,cause:n}){return I3.isInstance(n)&&n.value===t?n:new I3({value:t,cause:n})}};MW=zye;var G2=Uye,NW="AI_UnsupportedFunctionalityError",jW=`vercel.ai.error.${NW}`,qye=Symbol.for(jW),OW,pl=class extends Us{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:NW,message:t}),this[OW]=!0,this.functionality=e}static isInstance(e){return Us.hasMarker(e,jW)}};OW=qye;let Vye=(e,t=21)=>(n=t)=>{let r="",i=n|0;for(;i--;)r+=e[Math.random()*e.length|0];return r},XL=class extends Error{constructor(t,n){super(t),this.name="ParseError",this.type=n.type,this.field=n.field,this.value=n.value,this.line=n.line}};function VR(e){}function Hye(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=VR,onError:n=VR,onRetry:r=VR,onComment:i}=e;let s="",a=!0,o,l="",c="";function u(b){const x=a?b.replace(/^\xEF\xBB\xBF/,""):b,[w,_]=Wye(`${s}${x}`);for(const S of w)d(S);s=_,a=!1}function d(b){if(b===""){p();return}if(b.startsWith(":")){i&&i(b.slice(b.startsWith(": ")?2:1));return}const x=b.indexOf(":");if(x!==-1){const w=b.slice(0,x),_=b[x+1]===" "?2:1,S=b.slice(x+_);h(w,S,b);return}h(b,"",b)}function h(b,x,w){switch(b){case"event":c=x;break;case"data":l=`${l}${x}
`;break;case"id":o=x.includes("\0")?void 0:x;break;case"retry":/^\d+$/.test(x)?r(parseInt(x,10)):n(new XL(`Invalid \`retry\` value: "${x}"`,{type:"invalid-retry",value:x,line:w}));break;default:n(new XL(`Unknown field "${b.length>20?`${b.slice(0,20)}`:b}"`,{type:"unknown-field",field:b,value:x,line:w}));break}}function p(){l.length>0&&t({id:o,event:c||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),o=void 0,l="",c=""}function y(b={}){s&&b.consume&&d(s),a=!0,o=void 0,l="",c="",s=""}return{feed:u,reset:y}}function Wye(e){const t=[];let n="",r=0;for(;r<e.length;){const i=e.indexOf("\r",r),s=e.indexOf(`
`,r);let a=-1;if(i!==-1&&s!==-1?a=Math.min(i,s):i!==-1?a=i:s!==-1&&(a=s),a===-1){n=e.slice(r);break}else{const o=e.slice(r,a);t.push(o),r=a+1,e[r-1]==="\r"&&e[r]===`
`&&r++}}return[t,n]}class Gye extends TransformStream{constructor({onError:t,onRetry:n,onComment:r}={}){let i;super({start(s){i=Hye({onEvent:a=>{s.enqueue(a)},onError(a){t==="terminate"?s.error(a):typeof t=="function"&&t(a)},onRetry:n,onComment:r})},transform(s){i.feed(s)}})}}var Kye={};function K2(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Kk(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Yye=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const i=Vye(n,t);if(e==null)return i;if(n.includes(r))throw new Pye({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return s=>`${e}${r}${i(s)}`},J_=Yye();function Zye(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function HR(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function Xye({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new X_({message:`${r} API key must be a string.`});if(typeof es>"u")throw new X_({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=Kye[t],e==null)throw new X_({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new X_({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var M3=Symbol.for("vercel.ai.validator");function Jye(e){return{[M3]:!0,validate:e}}function Qye(e){return typeof e=="object"&&e!==null&&M3 in e&&e[M3]===!0&&"validate"in e}function ebe(e){return Qye(e)?e:tbe(e)}function tbe(e){return Jye(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function nbe({value:e,schema:t}){const n=PW({value:e,schema:t});if(!n.success)throw G2.wrap({value:e,cause:n.error});return n.value}function PW({value:e,schema:t}){const n=ebe(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:G2.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:G2.wrap({value:e,cause:r})}}}function rbe({text:e,schema:t}){try{const n=G0.parse(e);return t==null?n:nbe({value:n,schema:t})}catch(n){throw W2.isInstance(n)||G2.isInstance(n)?n:new W2({text:e,cause:n})}}function DW({text:e,schema:t}){try{const n=G0.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=PW({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:W2.isInstance(n)?n:new W2({text:e,cause:n})}}}function WR(e){try{return G0.parse(e),!0}catch{return!1}}var ibe=()=>globalThis.fetch,Y2=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:i,abortSignal:s,fetch:a})=>sbe({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:i,abortSignal:s,fetch:a}),sbe=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:i,abortSignal:s,fetch:a=ibe()})=>{try{const o=await a(e,{method:"POST",headers:Zye(t),body:n.content,signal:s}),l=Kk(o);if(!o.ok){let c;try{c=await i({response:o,url:e,requestBodyValues:n.values})}catch(u){throw HR(u)||Ju.isInstance(u)?u:new Ju({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(HR(c)||Ju.isInstance(c))?c:new Ju({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(HR(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Ju({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}},abe=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:i,requestBodyValues:s})=>{const a=await r.text(),o=Kk(r);if(a.trim()==="")return{responseHeaders:o,value:new Ju({message:r.statusText,url:i,requestBodyValues:s,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=rbe({text:a,schema:e});return{responseHeaders:o,value:new Ju({message:t(l),url:i,requestBodyValues:s,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Ju({message:r.statusText,url:i,requestBodyValues:s,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},FW=e=>async({response:t})=>{const n=Kk(t);if(t.body==null)throw new jye({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Gye).pipeThrough(new TransformStream({transform({data:r},i){r!=="[DONE]"&&i.enqueue(DW({text:r,schema:e}))}}))}},LW=e=>async({response:t,url:n,requestBodyValues:r})=>{const i=await t.text(),s=DW({text:i,schema:e}),a=Kk(t);if(!s.success)throw new Ju({message:"Invalid JSON response",cause:s.error,statusCode:t.status,responseHeaders:a,responseBody:i,url:n,requestBodyValues:r});return{responseHeaders:a,value:s.value,rawValue:s.rawValue}},{btoa:obe}=globalThis;function JL(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return obe(t)}function lbe(e){return e==null?void 0:e.replace(/\/$/,"")}var cbe=Object.defineProperty,ube=Object.defineProperties,dbe=Object.getOwnPropertyDescriptors,Z2=Object.getOwnPropertySymbols,BW=Object.prototype.hasOwnProperty,$W=Object.prototype.propertyIsEnumerable,QL=(e,t,n)=>t in e?cbe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Po=(e,t)=>{for(var n in t||(t={}))BW.call(t,n)&&QL(e,n,t[n]);if(Z2)for(var n of Z2(t))$W.call(t,n)&&QL(e,n,t[n]);return e},XS=(e,t)=>ube(e,dbe(t)),X2=(e,t)=>{var n={};for(var r in e)BW.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Z2)for(var r of Z2(e))t.indexOf(r)<0&&$W.call(e,r)&&(n[r]=e[r]);return n};function Tc(e){var t,n,r;const i=e==null?void 0:e.anthropic,s=e==null?void 0:e.openrouter;return(r=(n=(t=s==null?void 0:s.cacheControl)!=null?t:s==null?void 0:s.cache_control)!=null?n:i==null?void 0:i.cacheControl)!=null?r:i==null?void 0:i.cache_control}function fbe(e){var t,n,r;const i=[];for(const{role:s,content:a,providerMetadata:o}of e)switch(s){case"system":{i.push({role:"system",content:a,cache_control:Tc(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){i.push({role:"user",content:a[0].text,cache_control:(n=Tc(o))!=null?n:Tc(a[0].providerMetadata)});break}const l=Tc(o),c=a.map(u=>{var d,h,p,y,b,x;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:(d=Tc(u.providerMetadata))!=null?d:l};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${JL(u.image)}`},cache_control:(p=Tc(u.providerMetadata))!=null?p:l};case"file":return{type:"file",file:{filename:String((b=(y=u.providerMetadata)==null?void 0:y.openrouter)==null?void 0:b.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${JL(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:(x=Tc(u.providerMetadata))!=null?x:l};default:{const w=u;throw new Error(`Unsupported content part type: ${w}`)}}});i.push({role:"user",content:c});break}case"assistant":{let l="";const c=[];for(const u of a)switch(u.type){case"text":{l+=u.text;break}case"tool-call":{c.push({id:u.toolCallId,type:"function",function:{name:u.toolName,arguments:JSON.stringify(u.args)}});break}case"reasoning":case"redacted-reasoning":break;default:{const d=u;throw new Error(`Unsupported part: ${d}`)}}i.push({role:"assistant",content:l,tool_calls:c.length>0?c:void 0,cache_control:Tc(o)});break}case"tool":{for(const l of a)i.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=Tc(o))!=null?r:Tc(l.providerMetadata)});break}default:{const l=s;throw new Error(`Unsupported role: ${l}`)}}return i}function eB(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:i,top_logprobs:s})=>({token:r,logprob:i,topLogprobs:s?s.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function J2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var dO=L.object({error:L.object({message:L.string(),type:L.string(),param:L.any().nullable(),code:L.string().nullable()})}),Q2=abe({errorSchema:dO,errorToMessage:e=>e.error.message});function hbe(e){return"parameters"in e}var pbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:i,frequencyPenalty:s,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const p=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=Po(Po(Po({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:i,frequency_penalty:s,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:fbe(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),y);switch(p){case"regular":return Po(Po({},b),ybe(e));case"object-json":return XS(Po({},b),{response_format:{type:"json_object"}});case"object-tool":return XS(Po({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const x=p;throw new pl({functionality:`${x} mode`})}}}async doGenerate(e){var t,n,r,i,s,a,o;const l=this.getArgs(e),{responseHeaders:c,value:u}=await Y2({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:K2(this.config.headers(),e.headers),body:l,failedResponseHandler:Q2,successfulResponseHandler:LW(mbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),d=l,{messages:h}=d,p=X2(d,["messages"]),y=u.choices[0];if(!y)throw new Error("No choice in response");return{response:{id:u.id,modelId:u.model},text:(t=y.message.content)!=null?t:void 0,reasoning:(n=y.message.reasoning)!=null?n:void 0,toolCalls:(r=y.message.tool_calls)==null?void 0:r.map(b=>{var x;return{toolCallType:"function",toolCallId:(x=b.id)!=null?x:J_(),toolName:b.function.name,args:b.function.arguments}}),finishReason:J2(y.finish_reason),usage:{promptTokens:(s=(i=u.usage)==null?void 0:i.prompt_tokens)!=null?s:0,completionTokens:(o=(a=u.usage)==null?void 0:a.completion_tokens)!=null?o:0},rawCall:{rawPrompt:h,rawSettings:p},rawResponse:{headers:c},warnings:[],logprobs:eB(y.logprobs)}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Y2({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:K2(this.config.headers(),e.headers),body:XS(Po({},t),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:Q2,successfulResponseHandler:FW(gbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=t,{messages:s}=i,a=X2(i,["messages"]),o=[];let l="other",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u;return{stream:r.pipeThrough(new TransformStream({transform(d,h){var p,y,b,x,w,_,S,C,E,T,R,M;if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const N=d.value;if("error"in N){l="error",h.enqueue({type:"error",error:N.error});return}N.id&&h.enqueue({type:"response-metadata",id:N.id}),N.model&&h.enqueue({type:"response-metadata",modelId:N.model}),N.usage!=null&&(c={promptTokens:N.usage.prompt_tokens,completionTokens:N.usage.completion_tokens});const O=N.choices[0];if((O==null?void 0:O.finish_reason)!=null&&(l=J2(O.finish_reason)),(O==null?void 0:O.delta)==null)return;const B=O.delta;B.content!=null&&h.enqueue({type:"text-delta",textDelta:B.content}),B.reasoning!=null&&h.enqueue({type:"reasoning",textDelta:B.reasoning});const P=eB(O==null?void 0:O.logprobs);if(P!=null&&P.length&&(u===void 0&&(u=[]),u.push(...P)),B.tool_calls!=null)for(const H of B.tool_calls){const F=H.index;if(o[F]==null){if(H.type!=="function")throw new qR({data:H,message:"Expected 'function' type."});if(H.id==null)throw new qR({data:H,message:"Expected 'id' to be a string."});if(((p=H.function)==null?void 0:p.name)==null)throw new qR({data:H,message:"Expected 'function.name' to be a string."});o[F]={id:H.id,type:"function",function:{name:H.function.name,arguments:(y=H.function.arguments)!=null?y:""},sent:!1};const q=o[F];if(q==null)throw new Error("Tool call is missing");((b=q.function)==null?void 0:b.name)!=null&&((x=q.function)==null?void 0:x.arguments)!=null&&WR(q.function.arguments)&&(h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:q.id,toolName:q.function.name,argsTextDelta:q.function.arguments}),h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(w=q.id)!=null?w:J_(),toolName:q.function.name,args:q.function.arguments}),q.sent=!0);continue}const Q=o[F];if(Q==null)throw new Error("Tool call is missing");((_=H.function)==null?void 0:_.arguments)!=null&&(Q.function.arguments+=(C=(S=H.function)==null?void 0:S.arguments)!=null?C:""),h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(E=H.function.arguments)!=null?E:""}),((T=Q.function)==null?void 0:T.name)!=null&&((R=Q.function)==null?void 0:R.arguments)!=null&&WR(Q.function.arguments)&&(h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(M=Q.id)!=null?M:J_(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(d){var h;if(l==="tool-calls")for(const p of o)p.sent||(d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(h=p.id)!=null?h:J_(),toolName:p.function.name,args:WR(p.function.arguments)?p.function.arguments:"{}"}),p.sent=!0);d.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:s,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},zW=L.object({id:L.string().optional(),model:L.string().optional(),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number(),total_tokens:L.number()}).nullish()}),mbe=zW.extend({choices:L.array(L.object({message:L.object({role:L.literal("assistant"),content:L.string().nullable().optional(),reasoning:L.string().nullable().optional(),tool_calls:L.array(L.object({id:L.string().optional().nullable(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).optional()}),index:L.number(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullable().optional(),finish_reason:L.string().optional().nullable()}))}),gbe=L.union([zW.extend({choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).optional(),content:L.string().nullish(),reasoning:L.string().nullish().optional(),tool_calls:L.array(L.object({index:L.number(),id:L.string().nullish(),type:L.literal("function").optional(),function:L.object({name:L.string().nullish(),arguments:L.string().nullish()})})).nullish()}).nullish(),logprobs:L.object({content:L.array(L.object({token:L.string(),logprob:L.number(),top_logprobs:L.array(L.object({token:L.string(),logprob:L.number()}))})).nullable()}).nullish(),finish_reason:L.string().nullable().optional(),index:L.number()}))}),dO]);function ybe(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>hbe(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),i=e.toolChoice;if(i==null)return{tools:r,tool_choice:void 0};const s=i.type;switch(s){case"auto":case"none":case"required":return{tools:r,tool_choice:s};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:i.toolName}}};default:{const a=s;throw new Error(`Unsupported tool choice type: ${a}`)}}}function bbe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let i="";e[0]&&e[0].role==="system"&&(i+=`${e[0].content}

`,e=e.slice(1));for(const{role:s,content:a}of e)switch(s){case"system":throw new Fye({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new pl({functionality:"images"});case"file":throw new pl({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");i+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new pl({functionality:"tool-call messages"});case"reasoning":throw new pl({functionality:"reasoning messages"});case"redacted-reasoning":throw new pl({functionality:"redacted reasoning messages"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");i+=`${r}:
${o}

`;break}case"tool":throw new pl({functionality:"tool messages"});default:{const o=s;throw new Error(`Unsupported role: ${o}`)}}return i+=`${r}:
`,{prompt:i}}function tB(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,i;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((i=e.top_logprobs[n])!=null?i:{}).map(([s,a])=>({token:s,logprob:a})):[]}})}var vbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:i,topP:s,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var p,y;const b=e.type,x=(p=h==null?void 0:h.openrouter)!=null?p:{},{prompt:w}=bbe({prompt:n,inputFormat:t}),_=Po(Po(Po({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:i,top_p:s,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:w,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),x);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new pl({functionality:"tools"});if(e.toolChoice)throw new pl({functionality:"toolChoice"});return _}case"object-json":throw new pl({functionality:"object-json mode"});case"object-tool":throw new pl({functionality:"object-tool mode"});default:{const S=b;throw new pl({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,i,s;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Y2({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:K2(this.config.headers(),e.headers),body:a,failedResponseHandler:Q2,successfulResponseHandler:LW(nB),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=X2(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(s=(i=l.usage)==null?void 0:i.completion_tokens)!=null?s:0},finishReason:J2(h.finish_reason),logprobs:tB(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Y2({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:K2(this.config.headers(),e.headers),body:XS(Po({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:Q2,successfulResponseHandler:FW(nB),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=t,{prompt:s}=i,a=X2(i,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const p=h.choices[0];(p==null?void 0:p.finish_reason)!=null&&(o=J2(p.finish_reason)),(p==null?void 0:p.text)!=null&&d.enqueue({type:"text-delta",textDelta:p.text});const y=tB(p==null?void 0:p.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:s,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},nB=L.union([L.object({id:L.string().optional(),model:L.string().optional(),choices:L.array(L.object({text:L.string(),reasoning:L.string().nullish().optional(),finish_reason:L.string().nullish(),index:L.number(),logprobs:L.object({tokens:L.array(L.string()),token_logprobs:L.array(L.number()),top_logprobs:L.array(L.record(L.string(),L.number())).nullable()}).nullable().optional()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).optional().nullable()}),dO]);function UW(e={}){var t,n,r;const i=(n=lbe((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",s=(r=e.compatibility)!=null?r:"compatible",a=()=>Po({Authorization:`Bearer ${Xye({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new pbe(d,h,{provider:"openrouter.chat",url:({path:p})=>`${i}${p}`,headers:a,compatibility:s,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new vbe(d,h,{provider:"openrouter.completion",url:({path:p})=>`${i}${p}`,headers:a,compatibility:s,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=function(d,h){return c(d,h)};return u.languageModel=c,u.chat=o,u.completion=l,u}UW({compatibility:"strict"});var Gh={},GR={},rB;function iB(){return rB||(rB=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(GR)),GR}var sB;function xbe(){return sB||(sB=1,function(e){var t=Gh&&Gh.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var p=Object.getOwnPropertyDescriptor(u,d);(!p||("get"in p?!u.__esModule:p.writable||p.configurable))&&(p={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,p)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=Gh&&Gh.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=iB();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(iB(),e);class i extends Error{}e.PartialJSON=i;class s extends Error{}e.MalformedJSON=s;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const p=E=>{throw new i(`${E} at position ${h}`)},y=E=>{throw new s(`${E} at position ${h}`)},b=()=>(C(),h>=d&&p("Unexpected end of input"),c[h]==='"'?x():c[h]==="{"?w():c[h]==="["?_():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),x=()=>{const E=h;let T=!1;for(h++;h<d&&(c[h]!=='"'||T&&c[h-1]==="\\");)T=c[h]==="\\"?!T:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(E,++h-Number(T)))}catch(R){y(String(R))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(E,h-Number(T))+'"')}catch{return JSON.parse(c.substring(E,c.lastIndexOf("\\"))+'"')}p("Unterminated string literal")},w=()=>{h++,C();const E={};try{for(;c[h]!=="}";){if(C(),h>=d&&r.Allow.OBJ&u)return E;const T=x();C(),h++;try{const R=b();E[T]=R}catch(R){if(r.Allow.OBJ&u)return E;throw R}C(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return E;p("Expected '}' at end of object")}return h++,E},_=()=>{h++;const E=[];try{for(;c[h]!=="]";)E.push(b()),C(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return E;p("Expected ']' at end of array")}return h++,E},S=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(T){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(T))}}const E=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&p("Unterminated number literal");try{return JSON.parse(c.substring(E,h))}catch{c.substring(E,h)==="-"&&p("Not sure what '-' is");try{return JSON.parse(c.substring(E,c.lastIndexOf("e")))}catch(R){y(String(R))}}},C=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(Gh)),Gh}var wbe=xbe();function KR(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((i,s)=>{if(s.type==="text")i.content+=s.text;else{if(s.type==="image"&&s.image instanceof URL)throw new Wr({functionality:"Image URLs in user messages"});s.type==="image"&&s.image instanceof Uint8Array&&(i.images=i.images||[],i.images.push(Pf(s.image)))}return i},{content:""}),role:"user"});break}case"assistant":{const i=[],s=[];for(const a of n)switch(a.type){case"text":{i.push(a.text);break}case"tool-call":{s.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:i.join(","),role:"assistant",tool_calls:s.length>0?s:void 0});break}case"tool":{t.push(...n.map(i=>({content:typeof i.result=="object"?JSON.stringify(i.result):`${i.result}`,role:"tool",tool_call_id:i.toolCallId})));break}default:{const i=r;throw new Error(`Unsupported role: ${i}`)}}return t}var _be=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=wbe.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[i,s]of r.entries()){const a=(n=JSON.stringify(s==null?void 0:s.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[i]||(this._toolCalls[i]={function:{arguments:"",name:s.name},id:ro(),type:"function"});const o=this._toolCalls[i];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Sbe({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Cbe=L.object({error:L.object({code:L.string().nullable(),message:L.string(),param:L.any().nullable(),type:L.string()})}),N3=Yp({errorSchema:Cbe,errorToMessage:e=>e.error.message});function kbe({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],i=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const s=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):s.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(i===void 0)return{tools:s,toolWarnings:r};const a=i.type;switch(a){case"auto":return{tools:s,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new Wr({functionality:`Unsupported tool choice type: ${o}`})}}}function Ebe(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Tbe=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},Abe=e=>async({response:t})=>{const n=K0(t);if(t.body===null)throw new fH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Tbe).pipeThrough(new TransformStream({transform(r,i){i.enqueue(Mp({schema:e,text:r}))}}))}},Rbe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:i,responseFormat:s,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];s!==void 0&&s.type==="json"&&s.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const p={format:s==null?void 0:s.type,model:this.modelId,options:Ebe({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=kbe({mode:n});return{args:{...p,messages:KR(i),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...p,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:KR(i)},type:d,warnings:h};case"object-tool":return{args:{...p,messages:KR(i),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:i}=this.getArguments(e),s={...r,stream:!1},{responseHeaders:a,value:o}=await is({abortSignal:e.abortSignal,body:s,failedResponseHandler:N3,fetch:this.config.fetch,headers:rs(this.config.headers(),e.headers),successfulResponseHandler:vo(Ibe),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=s,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:ro(),toolCallType:"function",toolName:d.function.name}});return{finishReason:Sbe({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(s)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:i}}async doStream(e){if(this.settings.simulateStreaming){const p=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...p.response}),p.text&&b.enqueue({textDelta:p.text,type:"text-delta"}),p.toolCalls)for(const x of p.toolCalls)b.enqueue({argsTextDelta:x.args,toolCallId:x.toolCallId,toolCallType:"function",toolName:x.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...x});b.enqueue({finishReason:p.finishReason,logprobs:p.logprobs,providerMetadata:p.providerMetadata,type:"finish",usage:p.usage}),b.close()}});return{rawCall:p.rawCall,rawResponse:p.rawResponse,stream:y,warnings:p.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:i,value:s}=await is({abortSignal:e.abortSignal,body:t,failedResponseHandler:N3,fetch:this.config.fetch,headers:rs(this.config.headers(),e.headers),successfulResponseHandler:Abe(Mbe),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new _be({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:i},request:{body:JSON.stringify(t)},stream:s.pipeThrough(new TransformStream({async flush(p){p.enqueue({finishReason:u,type:"finish",usage:d})},async transform(p,y){if(!p.success){y.enqueue({error:p.error,type:"error"});return}const b=p.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},Ibe=L.object({created_at:L.string(),done:L.literal(!0),done_reason:L.string().optional().nullable(),eval_count:L.number(),eval_duration:L.number(),load_duration:L.number().optional(),message:L.object({content:L.string(),role:L.string(),tool_calls:L.array(L.object({function:L.object({arguments:L.record(L.any()),name:L.string()}),id:L.string().optional()})).optional().nullable()}),model:L.string(),prompt_eval_count:L.number().optional(),prompt_eval_duration:L.number().optional(),total_duration:L.number()}),Mbe=L.discriminatedUnion("done",[L.object({created_at:L.string(),done:L.literal(!1),message:L.object({content:L.string(),role:L.string()}),model:L.string()}),L.object({created_at:L.string(),done:L.literal(!0),eval_count:L.number(),eval_duration:L.number(),load_duration:L.number().optional(),model:L.string(),prompt_eval_count:L.number().optional(),prompt_eval_duration:L.number().optional(),total_duration:L.number()})]),Nbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new Uk({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await is({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:N3,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:vo(jbe),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},jbe=L.object({embeddings:L.array(L.array(L.number())),prompt_eval_count:L.number().nullable()});function qW(e={}){var t;const n=(t=Wk(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),i=(o,l={})=>new Rbe(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),s=(o,l={})=>new Nbe(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return i(o,l)};return a.chat=i,a.embedding=s,a.languageModel=i,a.textEmbedding=s,a.textEmbeddingModel=s,a}qW();function Vb(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function Obe(e){const t=[];for(const{role:n,content:r,...i}of e){const s=Vb({...i});switch(n){case"system":{t.push({role:"system",content:r,...s});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Vb(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Vb(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Pf(a.image)}`},...l};case"file":throw new Wr({functionality:"File content parts in user messages"})}}),...s});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Vb(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...s});break}case"tool":{for(const a of r){const o=Vb(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function eC({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function tC(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var Pbe=L.object({error:L.object({message:L.string(),type:L.string().nullish(),param:L.any().nullish(),code:L.union([L.string(),L.number()]).nullish()})}),Yk={errorSchema:Pbe,errorToMessage:e=>e.error.message};function Dbe({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,i=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const s=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?i.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(s==null)return{tools:a,tool_choice:void 0,toolWarnings:i};const o=s.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:i};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:s.toolName}},toolWarnings:i};default:{const l=o;throw new Wr({functionality:`Unsupported tool choice type: ${l}`})}}}var Fbe=class{constructor(e,t,n){this.specificationVersion="v1";var r,i;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:Yk;this.chunkSchema=Bbe(s.errorSchema),this.failedResponseHandler=Yp(s),this.supportsStructuredOutputs=(i=n.supportsStructuredOutputs)!=null?i:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:i,topK:s,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,p,y,b,x;const w=e.type,_=[];s!=null&&_.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&_.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:i,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(p=l==null?void 0:l[this.providerOptionsName])==null?void 0:p.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:Obe(t)};switch(w){case"regular":{const{tools:C,tool_choice:E,toolWarnings:T}=Dbe({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:C,tool_choice:E},warnings:[..._,...T]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(x=e.name)!=null?x:"response",description:e.description}}:{type:"json_object"}},warnings:_};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:_};default:{const C=w;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,i,s,a,o,l,c,u,d;const{args:h,warnings:p}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:x,rawValue:w}=await is({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:vo(Lbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:_,...S}=h,C=x.choices[0],E={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:w})},T=(r=x.usage)==null?void 0:r.completion_tokens_details,R=(i=x.usage)==null?void 0:i.prompt_tokens_details;return(T==null?void 0:T.reasoning_tokens)!=null&&(E[this.providerOptionsName].reasoningTokens=T==null?void 0:T.reasoning_tokens),(T==null?void 0:T.accepted_prediction_tokens)!=null&&(E[this.providerOptionsName].acceptedPredictionTokens=T==null?void 0:T.accepted_prediction_tokens),(T==null?void 0:T.rejected_prediction_tokens)!=null&&(E[this.providerOptionsName].rejectedPredictionTokens=T==null?void 0:T.rejected_prediction_tokens),(R==null?void 0:R.cached_tokens)!=null&&(E[this.providerOptionsName].cachedPromptTokens=R==null?void 0:R.cached_tokens),{text:(s=C.message.content)!=null?s:void 0,reasoning:(a=C.message.reasoning_content)!=null?a:void 0,toolCalls:(o=C.message.tool_calls)==null?void 0:o.map(M=>{var N;return{toolCallType:"function",toolCallId:(N=M.id)!=null?N:ro(),toolName:M.function.name,args:M.function.arguments}}),finishReason:tC(C.finish_reason),usage:{promptTokens:(c=(l=x.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=x.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:E,rawCall:{rawPrompt:_,rawSettings:S},rawResponse:{headers:b,body:w},response:eC(x),warnings:p,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(w){if(w.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const _ of b.reasoning)_.type==="text"&&w.enqueue({type:"reasoning",textDelta:_.text});else w.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&w.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const _ of b.toolCalls)w.enqueue({type:"tool-call",..._});w.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),w.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),i={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},s=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await is({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Z0(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},p=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,x){var w,_,S,C,E,T,R,M,N,O,B,P;if(!b.success){d="error",x.enqueue({type:"error",error:b.error});return}const H=b.value;if(s==null||s.processChunk(b.rawValue),"error"in H){d="error",x.enqueue({type:"error",error:H.error.message});return}if(p&&(p=!1,x.enqueue({type:"response-metadata",...eC(H)})),H.usage!=null){const{prompt_tokens:q,completion_tokens:K,prompt_tokens_details:U,completion_tokens_details:re}=H.usage;h.promptTokens=q??void 0,h.completionTokens=K??void 0,(re==null?void 0:re.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=re==null?void 0:re.reasoning_tokens),(re==null?void 0:re.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=re==null?void 0:re.accepted_prediction_tokens),(re==null?void 0:re.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=re==null?void 0:re.rejected_prediction_tokens),(U==null?void 0:U.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=U==null?void 0:U.cached_tokens)}const F=H.choices[0];if((F==null?void 0:F.finish_reason)!=null&&(d=tC(F.finish_reason)),(F==null?void 0:F.delta)==null)return;const Q=F.delta;if(Q.reasoning_content!=null&&x.enqueue({type:"reasoning",textDelta:Q.reasoning_content}),Q.content!=null&&x.enqueue({type:"text-delta",textDelta:Q.content}),Q.tool_calls!=null)for(const q of Q.tool_calls){const K=q.index;if(u[K]==null){if(q.type!=="function")throw new Bg({data:q,message:"Expected 'function' type."});if(q.id==null)throw new Bg({data:q,message:"Expected 'id' to be a string."});if(((w=q.function)==null?void 0:w.name)==null)throw new Bg({data:q,message:"Expected 'function.name' to be a string."});u[K]={id:q.id,type:"function",function:{name:q.function.name,arguments:(_=q.function.arguments)!=null?_:""},hasFinished:!1};const re=u[K];((S=re.function)==null?void 0:S.name)!=null&&((C=re.function)==null?void 0:C.arguments)!=null&&(re.function.arguments.length>0&&x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:re.id,toolName:re.function.name,argsTextDelta:re.function.arguments}),D2(re.function.arguments)&&(x.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(E=re.id)!=null?E:ro(),toolName:re.function.name,args:re.function.arguments}),re.hasFinished=!0));continue}const U=u[K];U.hasFinished||(((T=q.function)==null?void 0:T.arguments)!=null&&(U.function.arguments+=(M=(R=q.function)==null?void 0:R.arguments)!=null?M:""),x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:U.id,toolName:U.function.name,argsTextDelta:(N=q.function.arguments)!=null?N:""}),((O=U.function)==null?void 0:O.name)!=null&&((B=U.function)==null?void 0:B.arguments)!=null&&D2(U.function.arguments)&&(x.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=U.id)!=null?P:ro(),toolName:U.function.name,args:U.function.arguments}),U.hasFinished=!0))}},flush(b){var x,w;const _={[y]:{},...s==null?void 0:s.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(_[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(_[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(_[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(_[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(x=h.promptTokens)!=null?x:NaN,completionTokens:(w=h.completionTokens)!=null?w:NaN},providerMetadata:_})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(i)}}}},VW=L.object({prompt_tokens:L.number().nullish(),completion_tokens:L.number().nullish(),prompt_tokens_details:L.object({cached_tokens:L.number().nullish()}).nullish(),completion_tokens_details:L.object({reasoning_tokens:L.number().nullish(),accepted_prediction_tokens:L.number().nullish(),rejected_prediction_tokens:L.number().nullish()}).nullish()}).nullish(),Lbe=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({message:L.object({role:L.literal("assistant").nullish(),content:L.string().nullish(),reasoning_content:L.string().nullish(),tool_calls:L.array(L.object({id:L.string().nullish(),type:L.literal("function"),function:L.object({name:L.string(),arguments:L.string()})})).nullish()}),finish_reason:L.string().nullish()})),usage:VW}),Bbe=e=>L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({delta:L.object({role:L.enum(["assistant"]).nullish(),content:L.string().nullish(),reasoning_content:L.string().nullish(),tool_calls:L.array(L.object({index:L.number(),id:L.string().nullish(),type:L.literal("function").nullish(),function:L.object({name:L.string().nullish(),arguments:L.string().nullish()})})).nullish()}).nullish(),finish_reason:L.string().nullish()})),usage:VW}),e]);function $be({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let i="";e[0].role==="system"&&(i+=`${e[0].content}

`,e=e.slice(1));for(const{role:s,content:a}of e)switch(s){case"system":throw new Lc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new Wr({functionality:"images"})}}).join("");i+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new Wr({functionality:"tool-call messages"})}}).join("");i+=`${r}:
${o}

`;break}case"tool":throw new Wr({functionality:"tool messages"});default:{const o=s;throw new Error(`Unsupported role: ${o}`)}}return i+=`${r}:
`,{prompt:i,stopSequences:[`
${n}:`]}}var zbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:Yk;this.chunkSchema=qbe(i.errorSchema),this.failedResponseHandler=Yp(i)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:i,topP:s,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var p;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:x,stopSequences:w}=$be({prompt:n,inputFormat:t}),_=[...w??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:i,top_p:s,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:x,stop:_.length>0?_:void 0};switch(y){case"regular":{if((p=e.tools)!=null&&p.length)throw new Wr({functionality:"tools"});if(e.toolChoice)throw new Wr({functionality:"toolChoice"});return{args:S,warnings:b}}case"object-json":throw new Wr({functionality:"object-json mode"});case"object-tool":throw new Wr({functionality:"object-tool mode"});default:{const C=y;throw new Error(`Unsupported type: ${C}`)}}}async doGenerate(e){var t,n,r,i;const{args:s,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await is({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:vo(Ube),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=s,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(i=(r=l.usage)==null?void 0:r.completion_tokens)!=null?i:NaN},finishReason:tC(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:eC(l),warnings:a,request:{body:JSON.stringify(s)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:i,value:s}=await is({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:rs(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Z0(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:s.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const p=d.value;if("error"in p){l="error",h.enqueue({type:"error",error:p.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...eC(p)})),p.usage!=null&&(c={promptTokens:p.usage.prompt_tokens,completionTokens:p.usage.completion_tokens});const y=p.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=tC(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:i},warnings:n,request:{body:JSON.stringify(r)}}}},Ube=L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()}),qbe=e=>L.union([L.object({id:L.string().nullish(),created:L.number().nullish(),model:L.string().nullish(),choices:L.array(L.object({text:L.string(),finish_reason:L.string().nullish(),index:L.number()})),usage:L.object({prompt_tokens:L.number(),completion_tokens:L.number()}).nullish()}),e]),Vbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new Uk({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:i,value:s}=await is({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:rs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Yp((r=this.config.errorStructure)!=null?r:Yk),successfulResponseHandler:vo(Hbe),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(a=>a.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:i}}}},Hbe=L.object({data:L.array(L.object({embedding:L.array(L.number())})),usage:L.object({prompt_tokens:L.number()}).nullish()}),Wbe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:i,providerOptions:s,headers:a,abortSignal:o}){var l,c,u,d,h;const p=[];r!=null&&p.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),i!=null&&p.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:x}=await is({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:rs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=s.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Yp((h=this.config.errorStructure)!=null?h:Yk),successfulResponseHandler:vo(Gbe),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(w=>w.b64_json),warnings:p,response:{timestamp:y,modelId:this.modelId,headers:x}}}},Gbe=L.object({data:L.array(L.object({b64_json:L.string()}))});function Kbe(e){const t=Wk(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),i=d=>({provider:`${n}.${d}`,url:({path:h})=>{const p=new URL(`${t}${h}`);return e.queryParams&&(p.search=new URLSearchParams(e.queryParams).toString()),p.toString()},headers:r,fetch:e.fetch}),s=(d,h={})=>a(d,h),a=(d,h={})=>new Fbe(d,h,{...i("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new zbe(d,h,i("completion")),l=(d,h={})=>new Vbe(d,h,i("embedding")),c=(d,h={})=>new Wbe(d,h,i("image")),u=(d,h)=>s(d,h);return u.languageModel=s,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const Rv=(e,t)=>`${e}:${t}`,Xl=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},d0=e=>e==="openai"||e==="openrouter"||e==="google",nC=e=>e==="ollama"||e==="openai-compatible",wp=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",io=[{value:"openai",label:"OpenAI"},{value:"google",label:"Google Gemini"},{value:"openrouter",label:"OpenRouter"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"}],Ybe={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"}],google:[{id:"gemini-1.5-flash-latest",name:"Gemini 1.5 Flash"},{id:"gemini-1.5-pro-latest",name:"Gemini 1.5 Pro"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},HW=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function fO(e,t,n){try{switch(e.type){case"openai":return QH({apiKey:n})(t);case"google":return rW({apiKey:n})(t);case"openrouter":return UW({apiKey:n,extraBody:{include_reasoning:!0}})(t);case"ollama":return qW({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return Kbe({baseURL:HW(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function WW(e,t,n){const i=Er.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!i){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const s=fO(e,t,n);if(!s){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:Rv(e.id,t),name:i.name,providerId:e.id,providerName:e.name,instance:s,metadata:i}}const GW={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Hb=new Map,Zbe=5*60*1e3,Xbe=(e,t)=>{var s,a,o,l,c,u,d,h,p,y,b,x,w,_;const n=e.id||e.name,r=e.name||n,i={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((s=e.architecture)==null?void 0:s.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((p=e.pricing)==null?void 0:p.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((x=e.top_provider)==null?void 0:x.context_length)??e.context_length??null,max_completion_tokens:((w=e.top_provider)==null?void 0:w.max_completion_tokens)??null,is_moderated:((_=e.top_provider)==null?void 0:_.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??GW[t]??[]};return t==="ollama"?(i.context_length=i.context_length??4096,i.top_provider&&(i.top_provider.context_length=i.context_length),i.architecture&&(i.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(i.context_length=8192),n.includes("gpt-4-32k")&&(i.context_length=32768),n.includes("gpt-4-turbo")&&(i.context_length=128e3),n.includes("gpt-4o")&&(i.context_length=128e3),n.includes("gpt-3.5-turbo")&&(i.context_length=16385),i.top_provider&&(i.top_provider.context_length=i.context_length),i.architecture&&(i.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?i.context_length=1048576:n.includes("gemini")&&(i.context_length=32768),i.top_provider&&(i.top_provider.context_length=i.context_length),i.architecture&&(i.architecture.tokenizer="Google")):t==="openai-compatible"&&(i.context_length=i.context_length??4096,i.top_provider&&(i.top_provider.context_length=i.context_length),i.architecture&&(i.architecture.tokenizer="Compatible")),i};async function Jbe(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Hb.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const i=(async()=>{var o,l,c;let s;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");s="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");s="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";s=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=HW(e.baseURL);s=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),Fe.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${s}`);try{const u=await fetch(s,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const x=JSON.parse(b);y=((c=x==null?void 0:x.error)==null?void 0:c.message)||(x==null?void 0:x.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const p=h.map(y=>Xbe(y,e.type));return p.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${p.length} models for ${e.name}`),p}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),Fe.error(`Failed to fetch models for ${e.name}: ${d}`),Hb.delete(n),[]}})();return Hb.set(n,i),setTimeout(()=>{Hb.get(n)===i&&(Hb.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},Zbe),i}const ir={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},YR="provider:lastModelSelection",aB="provider:globalModelSortOrder",Er=_l(Sl((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),i=t().getAvailableModelListItems(),s=new Map(i.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(Rv(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=s.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=i.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Be.emit(ir.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,i)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=fO(n,r,i);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:Rv(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),Rt.saveSetting("enableApiKeyManagement",n),Be.emit(ir.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await Rt.loadSetting("enableApiKeyManagement",!0),[r,i,s,a]=await Promise.all([Rt.loadProviderConfigs(),Rt.loadApiKeys(),Rt.loadSetting(aB,[]),Rt.loadSetting(YR,null)]);e({dbProviderConfigs:r,dbApiKeys:i,enableApiKeyManagement:n,globalModelSortOrder:s}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await Rt.saveSetting(YR,c),Be.emit(ir.initialDataLoaded,{configs:r,apiKeys:i,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Be.emit(ir.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),Fe.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),Rt.saveSetting(YR,n),Be.emit(ir.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,i)=>{const s=zs(),a=new Date,o={id:s,name:n,value:i,providerId:r,createdAt:a,updatedAt:a};try{return await Rt.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),Fe.success(`API Key "${n}" added.`),Be.emit(ir.apiKeysChanged,{apiKeys:t().dbApiKeys}),s}catch(l){throw console.error("ProviderStore: Error adding API key",l),Fe.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var i;const r=((i=t().dbApiKeys.find(s=>s.id===n))==null?void 0:i.name)??"Unknown Key";try{await Rt.deleteApiKey(n),e(s=>{s.dbApiKeys=s.dbApiKeys.filter(a=>a.id!==n),s.dbProviderConfigs=s.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),Fe.success(`API Key "${r}" deleted.`),Be.emit(ir.apiKeysChanged,{apiKeys:t().dbApiKeys}),Be.emit(ir.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(s){throw console.error("ProviderStore: Error deleting API key",s),Fe.error(`Failed to delete API Key: ${s instanceof Error?s.message:String(s)}`),s}},addProviderConfig:async n=>{const r=zs(),i=new Date,s={id:r,createdAt:i,updatedAt:i,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await Rt.saveProviderConfig(s),e(a=>{a.dbProviderConfigs.push(s)}),t()._updateGloballyEnabledModelDefinitions(),Fe.success(`Provider "${n.name}" added.`),Be.emit(ir.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),Fe.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const i=t().dbProviderConfigs.find(a=>a.id===n);if(!i)return;const s={...i,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:i.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:i.modelsLastFetchedAt,updatedAt:new Date};try{await Rt.saveProviderConfig(s),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=s)}),t()._updateGloballyEnabledModelDefinitions(),Be.emit(ir.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),Fe.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(s=>s.id===n);if(!r)return;const i=r.name;try{await Rt.deleteProviderConfig(n),e(s=>{s.dbProviderConfigs=s.dbProviderConfigs.filter(a=>a.id!==n),delete s.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Be.emit(ir.configsChanged,{providerConfigs:t().dbProviderConfigs}),Fe.success(`Provider "${i}" deleted.`)}catch(s){throw console.error("ProviderStore: Error deleting provider config",s),Fe.error(`Failed to delete Provider: ${s instanceof Error?s.message:String(s)}`),s}},fetchModels:async n=>{var i;const r=t().dbProviderConfigs.find(s=>s.id===n);if(!r){Fe.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const s=r.apiKeyId,a=(i=t().dbApiKeys.find(l=>l.id===s))==null?void 0:i.value,o=await Jbe(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),Fe.success(`Models fetched successfully for ${r.name}`)}catch(s){console.error(`Error fetching models for ${r.name}:`,s),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await Rt.saveSetting(aB,r),t()._updateGloballyEnabledModelDefinitions(),Be.emit(ir.globalModelSortOrderChanged,{ids:r});const i=t().selectedModelId,s=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(s);if(!i||!a.has(i)){const o=s[0]??null;o!==i&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(i=>{i.providerFetchStatus[n]=r}),Be.emit(ir.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Be.emit(ir.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:i}=Xl(n);if(!r||!i)return;const s=t().dbProviderConfigs.find(o=>o.id===r);if(!s)return;const a=t().dbApiKeys.find(o=>o.id===s.apiKeyId);return t().createAiModelConfig(s,i,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var i;const r=t().dbProviderConfigs.find(s=>s.id===n);return(i=t().dbApiKeys.find(s=>s.id===(r==null?void 0:r.apiKeyId)))==null?void 0:i.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const i=r.type;return(Ybe[i]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:GW[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(i=>{t().getAllAvailableModelDefsForProvider(i.id).forEach(a=>{var o,l,c;r.push({id:Rv(i.id,a.id),name:a.name,providerId:i.id,providerName:i.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:ir.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:ir.selectModelRequest,handler:i=>r.selectModel(i.modelId),storeId:n},{eventName:ir.addApiKeyRequest,handler:i=>r.addApiKey(i.name,i.providerId,i.value).then(()=>{}),storeId:n},{eventName:ir.deleteApiKeyRequest,handler:i=>r.deleteApiKey(i.id),storeId:n},{eventName:ir.addProviderConfigRequest,handler:i=>r.addProviderConfig(i).then(()=>{}),storeId:n},{eventName:ir.updateProviderConfigRequest,handler:i=>r.updateProviderConfig(i.id,i.changes),storeId:n},{eventName:ir.deleteProviderConfigRequest,handler:i=>r.deleteProviderConfig(i.id),storeId:n},{eventName:ir.fetchModelsRequest,handler:i=>r.fetchModels(i.providerConfigId),storeId:n},{eventName:ir.setGlobalModelSortOrderRequest,handler:i=>r.setGlobalModelSortOrder(i.ids),storeId:n},{eventName:ir.setEnableApiKeyManagementRequest,handler:i=>r.setEnableApiKeyManagement(i.enabled),storeId:n},{eventName:ir.setSelectedModelForDetailsRequest,handler:i=>r.setSelectedModelForDetails(i.modelId),storeId:n}]}}))),nn={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},Qbe=`You are a helpful AI assistant.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

Key principles:
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly`,ZR="system",XR=Qbe,JR=.7,QR=null,eI=null,tI=null,nI=0,rI=0,oB=!0,iI=!0,sI=!0,aI=!1,oI=!1,lI=15,lB=null,cB=null,cI=5,uI=null,dI=!0,fI=null,hI=768,pI=!1,mI=!1,gI=null,yI=16,bI="max-w-7xl",vI=null,xI=1e3,wI=!0,uB=!1,dB=!1,dr=_l(Sl((e,t)=>({theme:ZR,globalSystemPrompt:XR,temperature:JR,maxTokens:QR,topP:eI,topK:tI,presencePenalty:nI,frequencyPenalty:rI,enableAdvancedSettings:oB,enableStreamingMarkdown:iI,enableStreamingCodeBlockParsing:sI,foldStreamingCodeBlocks:aI,foldUserMessagesOnCompletion:oI,streamingRenderFPS:lI,gitUserName:lB,gitUserEmail:cB,toolMaxSteps:cI,prismThemeUrl:uI,autoTitleEnabled:dI,autoTitleModelId:fI,autoTitlePromptMaxLength:hI,autoTitleIncludeFiles:pI,autoTitleIncludeRules:mI,customFontFamily:gI,customFontSize:yI,chatMaxWidth:bI,customThemeColors:vI,autoScrollInterval:xI,enableAutoScrollOnStream:wI,autoSyncOnStreamComplete:uB,autoInitializeReposOnStartup:dB,setTheme:n=>{e({theme:n}),Rt.saveSetting("theme",n),Be.emit(nn.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),Rt.saveSetting("globalSystemPrompt",n),Be.emit(nn.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),Rt.saveSetting("temperature",n),Be.emit(nn.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),Rt.saveSetting("maxTokens",n),Be.emit(nn.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),Rt.saveSetting("topP",n),Be.emit(nn.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),Rt.saveSetting("topK",n),Be.emit(nn.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),Rt.saveSetting("presencePenalty",n),Be.emit(nn.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),Rt.saveSetting("frequencyPenalty",n),Be.emit(nn.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),Rt.saveSetting("enableAdvancedSettings",n),Be.emit(nn.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),Rt.saveSetting("enableStreamingMarkdown",n),Be.emit(nn.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),Rt.saveSetting("enableStreamingCodeBlockParsing",n),Be.emit(nn.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),Rt.saveSetting("foldStreamingCodeBlocks",n),Be.emit(nn.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),Rt.saveSetting("foldUserMessagesOnCompletion",n),Be.emit(nn.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),Rt.saveSetting("streamingRenderFPS",r),Be.emit(nn.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),Rt.saveSetting("gitUserName",r),Be.emit(nn.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),Rt.saveSetting("gitUserEmail",r),Be.emit(nn.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),Rt.saveSetting("toolMaxSteps",r),Be.emit(nn.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),Rt.saveSetting("prismThemeUrl",r),Be.emit(nn.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),Rt.saveSetting("autoTitleEnabled",n),Be.emit(nn.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),Rt.saveSetting("autoTitleModelId",n),Be.emit(nn.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),Rt.saveSetting("autoTitlePromptMaxLength",r),Be.emit(nn.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),Rt.saveSetting("autoTitleIncludeFiles",n),Be.emit(nn.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),Rt.saveSetting("autoTitleIncludeRules",n),Be.emit(nn.autoTitleIncludeRulesChanged,{include:n})},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),Rt.saveSetting("customFontFamily",r),Be.emit(nn.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),Rt.saveSetting("customFontSize",r),Be.emit(nn.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),Rt.saveSetting("chatMaxWidth",n),Be.emit(nn.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),Rt.saveSetting("customThemeColors",n),Be.emit(nn.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(s=>{const o={...s.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),s.customThemeColors=Object.keys(o).length>0?o:null});const i=t().customThemeColors;Rt.saveSetting("customThemeColors",i),Be.emit(nn.customThemeColorsChanged,{colors:i})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),Rt.saveSetting("autoScrollInterval",r),Be.emit(nn.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),Rt.saveSetting("enableAutoScrollOnStream",n),Be.emit(nn.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),Rt.saveSetting("autoSyncOnStreamComplete",n),Be.emit(nn.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),Rt.saveSetting("autoInitializeReposOnStartup",n),Be.emit(nn.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,i,s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E,T,R,M,N,O,B,P,H,F,Q,q]=await Promise.all([Rt.loadSetting("theme",ZR),Rt.loadSetting("temperature",JR),Rt.loadSetting("maxTokens",QR),Rt.loadSetting("topP",eI),Rt.loadSetting("topK",tI),Rt.loadSetting("presencePenalty",nI),Rt.loadSetting("frequencyPenalty",rI),Rt.loadSetting("globalSystemPrompt",XR),Rt.loadSetting("enableAdvancedSettings",oB),Rt.loadSetting("enableStreamingMarkdown",iI),Rt.loadSetting("enableStreamingCodeBlockParsing",sI),Rt.loadSetting("foldStreamingCodeBlocks",aI),Rt.loadSetting("foldUserMessagesOnCompletion",oI),Rt.loadSetting("streamingRenderFPS",lI),Rt.loadSetting("gitUserName",lB),Rt.loadSetting("gitUserEmail",cB),Rt.loadSetting("toolMaxSteps",cI),Rt.loadSetting("prismThemeUrl",uI),Rt.loadSetting("autoTitleEnabled",dI),Rt.loadSetting("autoTitleModelId",fI),Rt.loadSetting("autoTitlePromptMaxLength",hI),Rt.loadSetting("autoTitleIncludeFiles",pI),Rt.loadSetting("autoTitleIncludeRules",mI),Rt.loadSetting("customFontFamily",gI),Rt.loadSetting("customFontSize",yI),Rt.loadSetting("chatMaxWidth",bI),Rt.loadSetting("customThemeColors",vI),Rt.loadSetting("autoScrollInterval",xI),Rt.loadSetting("enableAutoScrollOnStream",wI),Rt.loadSetting("autoSyncOnStreamComplete",uB),Rt.loadSetting("autoInitializeReposOnStartup",dB)]),K={theme:n,temperature:r,maxTokens:i,topP:s,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:p,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:x,gitUserEmail:w,toolMaxSteps:_,prismThemeUrl:S,autoTitleEnabled:C,autoTitleModelId:E,autoTitlePromptMaxLength:T,autoTitleIncludeFiles:R,autoTitleIncludeRules:M,customFontFamily:N,customFontSize:O,chatMaxWidth:B,customThemeColors:P,autoScrollInterval:H,enableAutoScrollOnStream:F,autoSyncOnStreamComplete:Q,autoInitializeReposOnStartup:q};e(K),Be.emit(nn.loaded,{settings:K})}catch(n){console.error("SettingsStore: Error loading settings",n),Be.emit(nn.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(iI),t().setEnableStreamingCodeBlockParsing(sI),t().setFoldStreamingCodeBlocks(aI),t().setFoldUserMessagesOnCompletion(oI),t().setStreamingRenderFPS(lI),t().setAutoScrollInterval(xI),t().setEnableAutoScrollOnStream(wI),Fe.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),Fe.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(XR),t().setTemperature(JR),t().setMaxTokens(QR),t().setTopP(eI),t().setTopK(tI),t().setPresencePenalty(nI),t().setFrequencyPenalty(rI),t().setToolMaxSteps(cI),t().setAutoTitleEnabled(dI),t().setAutoTitleModelId(fI),t().setAutoTitlePromptMaxLength(hI),t().setAutoTitleIncludeFiles(pI),t().setAutoTitleIncludeRules(mI),Fe.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),Fe.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(ZR),t().setPrismThemeUrl(uI),t().setCustomFontFamily(gI),t().setCustomFontSize(yI),t().setChatMaxWidth(bI),t().setCustomThemeColors(vI),Fe.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),Fe.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:nn.setThemeRequest,handler:i=>r.setTheme(i.theme),storeId:n},{eventName:nn.setGlobalSystemPromptRequest,handler:i=>r.setGlobalSystemPrompt(i.prompt),storeId:n},{eventName:nn.setTemperatureRequest,handler:i=>r.setTemperature(i.value),storeId:n},{eventName:nn.setMaxTokensRequest,handler:i=>r.setMaxTokens(i.value),storeId:n},{eventName:nn.setTopPRequest,handler:i=>r.setTopP(i.value),storeId:n},{eventName:nn.setTopKRequest,handler:i=>r.setTopK(i.value),storeId:n},{eventName:nn.setPresencePenaltyRequest,handler:i=>r.setPresencePenalty(i.value),storeId:n},{eventName:nn.setFrequencyPenaltyRequest,handler:i=>r.setFrequencyPenalty(i.value),storeId:n},{eventName:nn.setEnableAdvancedSettingsRequest,handler:i=>r.setEnableAdvancedSettings(i.enabled),storeId:n},{eventName:nn.setEnableStreamingMarkdownRequest,handler:i=>r.setEnableStreamingMarkdown(i.enabled),storeId:n},{eventName:nn.setEnableStreamingCodeBlockParsingRequest,handler:i=>r.setEnableStreamingCodeBlockParsing(i.enabled),storeId:n},{eventName:nn.setFoldStreamingCodeBlocksRequest,handler:i=>r.setFoldStreamingCodeBlocks(i.fold),storeId:n},{eventName:nn.setFoldUserMessagesOnCompletionRequest,handler:i=>r.setFoldUserMessagesOnCompletion(i.fold),storeId:n},{eventName:nn.setStreamingRenderFpsRequest,handler:i=>r.setStreamingRenderFPS(i.fps),storeId:n},{eventName:nn.setGitUserNameRequest,handler:i=>r.setGitUserName(i.name),storeId:n},{eventName:nn.setGitUserEmailRequest,handler:i=>r.setGitUserEmail(i.email),storeId:n},{eventName:nn.setToolMaxStepsRequest,handler:i=>r.setToolMaxSteps(i.steps),storeId:n},{eventName:nn.setPrismThemeUrlRequest,handler:i=>r.setPrismThemeUrl(i.url),storeId:n},{eventName:nn.setAutoTitleEnabledRequest,handler:i=>r.setAutoTitleEnabled(i.enabled),storeId:n},{eventName:nn.setAutoTitleModelIdRequest,handler:i=>r.setAutoTitleModelId(i.modelId),storeId:n},{eventName:nn.setAutoTitlePromptMaxLengthRequest,handler:i=>r.setAutoTitlePromptMaxLength(i.length),storeId:n},{eventName:nn.setAutoTitleIncludeFilesRequest,handler:i=>r.setAutoTitleIncludeFiles(i.include),storeId:n},{eventName:nn.setAutoTitleIncludeRulesRequest,handler:i=>r.setAutoTitleIncludeRules(i.include),storeId:n},{eventName:nn.setCustomFontFamilyRequest,handler:i=>r.setCustomFontFamily(i.fontFamily),storeId:n},{eventName:nn.setCustomFontSizeRequest,handler:i=>r.setCustomFontSize(i.fontSize),storeId:n},{eventName:nn.setChatMaxWidthRequest,handler:i=>r.setChatMaxWidth(i.maxWidth),storeId:n},{eventName:nn.setCustomThemeColorsRequest,handler:i=>r.setCustomThemeColors(i.colors),storeId:n},{eventName:nn.setCustomThemeColorRequest,handler:i=>r.setCustomThemeColor(i.colorKey,i.value),storeId:n},{eventName:nn.setAutoScrollIntervalRequest,handler:i=>r.setAutoScrollInterval(i.interval),storeId:n},{eventName:nn.setEnableAutoScrollOnStreamRequest,handler:i=>r.setEnableAutoScrollOnStream(i.enabled),storeId:n},{eventName:nn.setAutoSyncOnStreamCompleteRequest,handler:i=>r.setAutoSyncOnStreamComplete(i.enabled),storeId:n},{eventName:nn.setAutoInitializeReposOnStartupRequest,handler:i=>r.setAutoInitializeReposOnStartup(i.enabled),storeId:n},{eventName:nn.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:nn.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:nn.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:nn.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function rC(e,t){const n=Ho.getState().getMiddlewareForHook,r=n(e);let i=t;for(const s of r)try{const a=await s.callback(i);if(a===!1)return console.log(`Middleware ${s.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(i=a)}catch(a){return console.error(`Middleware error in mod ${s.modId} for hook ${e}:`,a),!1}return i}function eve(){const e=On.getState(),t=Er.getState(),n=dr.getState(),{providerId:r}=Xl(t.selectedModelId),i={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(i)}function tve(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function fB(e){try{const t=e.type||"application/octet-stream",n=tx(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:tve(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),Fe.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function j3(e){return e.flatMap(t=>{var i,s,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(i=r.metadata)!=null&&i.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(s=t.metadata)!=null&&s.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const hB=e=>Symbol.iterator in e,pB=e=>"entries"in e,mB=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[i,s]of n)if(!Object.is(s,r.get(i)))return!1;return!0},nve=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let i=n.next(),s=r.next();for(;!i.done&&!s.done;){if(!Object.is(i.value,s.value))return!1;i=n.next(),s=r.next()}return!!i.done&&!!s.done};function rve(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!hB(e)||!hB(t)?mB({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):pB(e)&&pB(t)?mB(e,t):nve(e,t)}function Cn(e){const t=ut.useRef(void 0);return n=>{const r=e(n);return rve(t.current,r)?t.current:t.current=r}}var f0=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(f0||{});const Pn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",inputChanged:"prompt.inputChanged"},Pl=(e,t)=>{Be.emit(Pn.parameterChanged,{params:{[e]:t}})},mo=_l(Sl((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),Pl("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),Pl("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),Pl("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),Pl("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),Pl("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),Pl("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),Pl("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),Pl("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),Pl("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),Pl("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),Pl("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),i={};let s=!1;r.modelId!==n.modelId&&(i.modelId=n.modelId,s=!0),r.temperature!==n.temperature&&(i.temperature=n.temperature,s=!0),r.maxTokens!==n.maxTokens&&(i.maxTokens=n.maxTokens,s=!0),r.topP!==n.topP&&(i.topP=n.topP,s=!0),r.topK!==n.topK&&(i.topK=n.topK,s=!0),r.presencePenalty!==n.presencePenalty&&(i.presencePenalty=n.presencePenalty,s=!0),r.frequencyPenalty!==n.frequencyPenalty&&(i.frequencyPenalty=n.frequencyPenalty,s=!0),s&&(e(i),Be.emit(Pn.parameterChanged,{params:i})),Be.emit(Pn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let i=!1;n.temperature!==null&&(r.temperature=null,i=!0),n.maxTokens!==null&&(r.maxTokens=null,i=!0),n.topP!==null&&(r.topP=null,i=!0),n.topK!==null&&(r.topK=null,i=!0),n.presencePenalty!==null&&(r.presencePenalty=null,i=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,i=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,i=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,i=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,i=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,i=!0),i&&(e(r),Be.emit(Pn.parameterChanged,{params:r})),Be.emit(Pn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:Pn.setModelIdRequest,handler:i=>r.setModelId(i.id),storeId:n},{eventName:Pn.setTemperatureRequest,handler:i=>r.setTemperature(i.value),storeId:n},{eventName:Pn.setMaxTokensRequest,handler:i=>r.setMaxTokens(i.value),storeId:n},{eventName:Pn.setTopPRequest,handler:i=>r.setTopP(i.value),storeId:n},{eventName:Pn.setTopKRequest,handler:i=>r.setTopK(i.value),storeId:n},{eventName:Pn.setPresencePenaltyRequest,handler:i=>r.setPresencePenalty(i.value),storeId:n},{eventName:Pn.setFrequencyPenaltyRequest,handler:i=>r.setFrequencyPenalty(i.value),storeId:n},{eventName:Pn.setReasoningEnabledRequest,handler:i=>r.setReasoningEnabled(i.enabled),storeId:n},{eventName:Pn.setWebSearchEnabledRequest,handler:i=>r.setWebSearchEnabled(i.enabled),storeId:n},{eventName:Pn.setImageGenerationEnabledRequest,handler:i=>r.setImageGenerationEnabled(i.enabled),storeId:n},{eventName:Pn.setStructuredOutputJsonRequest,handler:i=>r.setStructuredOutputJson(i.json),storeId:n},{eventName:Pn.initializePromptStateRequest,handler:i=>r.initializePromptState(i.effectiveSettings),storeId:n},{eventName:Pn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),ive=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:i,selectedItemId:s,selectedItemType:a})=>{const[o,l]=A.useState(!1),[c,u]=A.useState(!1),d=Ho(Cn(E=>E.promptControls)),h=On(Cn(E=>E.status==="streaming")),{attachedFilesMetadata:p,clearAttachedFiles:y}=Of(Cn(E=>({attachedFilesMetadata:E.attachedFilesMetadata,clearAttachedFiles:E.clearAttachedFiles}))),b=mo(E=>E.modelId);A.useEffect(()=>{a==="conversation"&&s&&requestAnimationFrame(()=>{var E;(E=i.current)==null||E.focus()})},[s,a,i]);const x=A.useMemo(()=>Object.values(d),[d]),w=A.useMemo(()=>x.filter(E=>E.renderer),[x]),_=A.useMemo(()=>x.filter(E=>E.triggerRenderer),[x]),S=A.useCallback(async()=>{var M,N;const T=(((M=i==null?void 0:i.current)==null?void 0:M.getValue())??"").trim(),R=Of.getState().attachedFilesMetadata;if(!(!T&&R.length===0)&&!(h||o)){l(!0);try{let O={},B={};for(const q of x){if(q.getParameters){const K=await q.getParameters();K&&(O={...O,...K})}if(q.getMetadata){const K=await q.getMetadata();K&&(B={...B,...K})}}R.length>0&&(B.attachedFiles=[...R]),!B.modelId&&b&&(B.modelId=b);const P=x.find(q=>q.id==="core-rules-tags");if(P&&B.activeRuleIds&&B.activeTagIds){const q=[],K=new Set(B.activeRuleIds);B.activeTagIds.forEach(U=>{P.getRulesForTag(U).forEach(re=>K.add(re.id))}),K.forEach(U=>{const re=P.getRuleById(U);re&&q.push({type:re.type,content:re.content,sourceRuleId:re.id})}),B.effectiveRulesContent=q}let H={id:zs(),content:T,parameters:O,metadata:B};Be.emit(Pn.submitted,{turnData:H});const F=await rC(f0.PROMPT_TURN_FINALIZE,{turnData:H});if(F===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const Q=F&&typeof F=="object"?F.turnData:H;await t(Q),y(),x.forEach(q=>{q.clearOnSubmit&&q.clearOnSubmit()}),(N=i.current)==null||N.clearValue(),u(!1)}catch(O){console.error("Error during prompt submission:",O),Fe.error(`Failed to send message: ${O instanceof Error?O.message:String(O)}`)}finally{l(!1)}}},[i,h,o,x,t,y,b]),C=A.useCallback(E=>{u(E.trim().length>0)},[]);return m.jsxs("div",{className:dt("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[w.length>0&&m.jsx(CL,{controls:w,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),m.jsxs("div",{className:"flex items-end gap-2",children:[m.jsx(e,{ref:i,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:C,className:"flex-grow"}),m.jsx(Et,{type:"button",size:"icon",onClick:S,disabled:h||o||!c&&p.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(npe,{className:"h-4 w-4"})})]})," ",m.jsx(CL,{controls:_,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Kt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(i){if(e==null||e(i),n===!1||!i.defaultPrevented)return t==null?void 0:t(i)}}function sve(e,t){const n=A.createContext(t),r=s=>{const{children:a,...o}=s,l=A.useMemo(()=>o,Object.values(o));return m.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function i(s){const a=A.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${s}\` must be used within \`${e}\``)}return[r,i]}function Ca(e,t=[]){let n=[];function r(s,a){const o=A.createContext(a),l=n.length;n=[...n,a];const c=d=>{var w;const{scope:h,children:p,...y}=d,b=((w=h==null?void 0:h[e])==null?void 0:w[l])||o,x=A.useMemo(()=>y,Object.values(y));return m.jsx(b.Provider,{value:x,children:p})};c.displayName=s+"Provider";function u(d,h){var b;const p=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=A.useContext(p);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const i=()=>{const s=n.map(a=>A.createContext(a));return function(o){const l=(o==null?void 0:o[e])||s;return A.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return i.scopeName=e,[r,ave(i,...t)]}function ave(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...o,...d}},{});return A.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}var ove=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],pn=ove.reduce((e,t)=>{const n=Nf(`Primitive.${t}`),r=A.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(l,{...o,ref:s})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function KW(e,t){e&&Hl.flushSync(()=>e.dispatchEvent(t))}function Fs(e){const t=A.useRef(e);return A.useEffect(()=>{t.current=e}),A.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function lve(e,t=globalThis==null?void 0:globalThis.document){const n=Fs(e);A.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var cve="DismissableLayer",O3="dismissableLayer.update",uve="dismissableLayer.pointerDownOutside",dve="dismissableLayer.focusOutside",gB,YW=A.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),X0=A.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=e,c=A.useContext(YW),[u,d]=A.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=A.useState({}),y=tr(t,R=>d(R)),b=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),w=b.indexOf(x),_=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=_>=w,E=pve(R=>{const M=R.target,N=[...c.branches].some(O=>O.contains(M));!C||N||(i==null||i(R),a==null||a(R),R.defaultPrevented||o==null||o())},h),T=mve(R=>{const M=R.target;[...c.branches].some(O=>O.contains(M))||(s==null||s(R),a==null||a(R),R.defaultPrevented||o==null||o())},h);return lve(R=>{_===c.layers.size-1&&(r==null||r(R),!R.defaultPrevented&&o&&(R.preventDefault(),o()))},h),A.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(gB=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),yB(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=gB)}},[u,h,n,c]),A.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),yB())},[u,c]),A.useEffect(()=>{const R=()=>p({});return document.addEventListener(O3,R),()=>document.removeEventListener(O3,R)},[]),m.jsx(pn.div,{...l,ref:y,style:{pointerEvents:S?C?"auto":"none":void 0,...e.style},onFocusCapture:Kt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Kt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Kt(e.onPointerDownCapture,E.onPointerDownCapture)})});X0.displayName=cve;var fve="DismissableLayerBranch",hve=A.forwardRef((e,t)=>{const n=A.useContext(YW),r=A.useRef(null),i=tr(t,r);return A.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),m.jsx(pn.div,{...e,ref:i})});hve.displayName=fve;function pve(e,t=globalThis==null?void 0:globalThis.document){const n=Fs(e),r=A.useRef(!1),i=A.useRef(()=>{});return A.useEffect(()=>{const s=o=>{if(o.target&&!r.current){let l=function(){ZW(uve,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=l,t.addEventListener("click",i.current,{once:!0})):l()}else t.removeEventListener("click",i.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",s),t.removeEventListener("click",i.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function mve(e,t=globalThis==null?void 0:globalThis.document){const n=Fs(e),r=A.useRef(!1);return A.useEffect(()=>{const i=s=>{s.target&&!r.current&&ZW(dve,n,{originalEvent:s},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function yB(){const e=new CustomEvent(O3);document.dispatchEvent(e)}function ZW(e,t,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&i.addEventListener(e,t,{once:!0}),r?KW(i,s):i.dispatchEvent(s)}var sa=globalThis!=null&&globalThis.document?A.useLayoutEffect:()=>{},gve=bV[" useId ".trim().toString()]||(()=>{}),yve=0;function Bs(e){const[t,n]=A.useState(gve());return sa(()=>{n(r=>r??String(yve++))},[e]),t?`radix-${t}`:""}const bve=["top","right","bottom","left"],$f=Math.min,Do=Math.max,iC=Math.round,Q_=Math.floor,Kc=e=>({x:e,y:e}),vve={left:"right",right:"left",bottom:"top",top:"bottom"},xve={start:"end",end:"start"};function P3(e,t,n){return Do(e,$f(t,n))}function fd(e,t){return typeof e=="function"?e(t):e}function hd(e){return e.split("-")[0]}function J0(e){return e.split("-")[1]}function hO(e){return e==="x"?"y":"x"}function pO(e){return e==="y"?"height":"width"}function zf(e){return["top","bottom"].includes(hd(e))?"y":"x"}function mO(e){return hO(zf(e))}function wve(e,t,n){n===void 0&&(n=!1);const r=J0(e),i=mO(e),s=pO(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=sC(a)),[a,sC(a)]}function _ve(e){const t=sC(e);return[D3(e),t,D3(t)]}function D3(e){return e.replace(/start|end/g,t=>xve[t])}function Sve(e,t,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?i:r:t?r:i;case"left":case"right":return t?s:a;default:return[]}}function Cve(e,t,n,r){const i=J0(e);let s=Sve(hd(e),n==="start",r);return i&&(s=s.map(a=>a+"-"+i),t&&(s=s.concat(s.map(D3)))),s}function sC(e){return e.replace(/left|right|bottom|top/g,t=>vve[t])}function kve(e){return{top:0,right:0,bottom:0,left:0,...e}}function XW(e){return typeof e!="number"?kve(e):{top:e,right:e,bottom:e,left:e}}function aC(e){const{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function bB(e,t,n){let{reference:r,floating:i}=e;const s=zf(t),a=mO(t),o=pO(a),l=hd(t),c=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[o]/2-i[o]/2;let p;switch(l){case"top":p={x:u,y:r.y-i.height};break;case"bottom":p={x:u,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:d};break;case"left":p={x:r.x-i.width,y:d};break;default:p={x:r.x,y:r.y}}switch(J0(t)){case"start":p[a]-=h*(n&&c?-1:1);break;case"end":p[a]+=h*(n&&c?-1:1);break}return p}const Eve=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:u,y:d}=bB(c,r,l),h=r,p={},y=0;for(let b=0;b<o.length;b++){const{name:x,fn:w}=o[b],{x:_,y:S,data:C,reset:E}=await w({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:p,rects:c,platform:a,elements:{reference:e,floating:t}});u=_??u,d=S??d,p={...p,[x]:{...p[x],...C}},E&&y<=50&&(y++,typeof E=="object"&&(E.placement&&(h=E.placement),E.rects&&(c=E.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):E.rects),{x:u,y:d}=bB(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:p}};async function mx(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=fd(t,e),y=XW(p),x=o[h?d==="floating"?"reference":"floating":d],w=aC(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(x)))==null||n?x:x.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),_=d==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,S=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),C=await(s.isElement==null?void 0:s.isElement(S))?await(s.getScale==null?void 0:s.getScale(S))||{x:1,y:1}:{x:1,y:1},E=aC(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:_,offsetParent:S,strategy:l}):_);return{top:(w.top-E.top+y.top)/C.y,bottom:(E.bottom-w.bottom+y.bottom)/C.y,left:(w.left-E.left+y.left)/C.x,right:(E.right-w.right+y.right)/C.x}}const Tve=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=fd(e,t)||{};if(c==null)return{};const d=XW(u),h={x:n,y:r},p=mO(i),y=pO(p),b=await a.getDimensions(c),x=p==="y",w=x?"top":"left",_=x?"bottom":"right",S=x?"clientHeight":"clientWidth",C=s.reference[y]+s.reference[p]-h[p]-s.floating[y],E=h[p]-s.reference[p],T=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let R=T?T[S]:0;(!R||!await(a.isElement==null?void 0:a.isElement(T)))&&(R=o.floating[S]||s.floating[y]);const M=C/2-E/2,N=R/2-b[y]/2-1,O=$f(d[w],N),B=$f(d[_],N),P=O,H=R-b[y]-B,F=R/2-b[y]/2+M,Q=P3(P,F,H),q=!l.arrow&&J0(i)!=null&&F!==Q&&s.reference[y]/2-(F<P?O:B)-b[y]/2<0,K=q?F<P?F-P:F-H:0;return{[p]:h[p]+K,data:{[p]:Q,centerOffset:F-Q-K,...q&&{alignmentOffset:K}},reset:q}}}),Ave=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...x}=fd(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const w=hd(i),_=zf(o),S=hd(o)===o,C=await(l.isRTL==null?void 0:l.isRTL(c.floating)),E=h||(S||!b?[sC(o)]:_ve(o)),T=y!=="none";!h&&T&&E.push(...Cve(o,b,y,C));const R=[o,...E],M=await mx(t,x),N=[];let O=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&N.push(M[w]),d){const F=wve(i,a,C);N.push(M[F[0]],M[F[1]])}if(O=[...O,{placement:i,overflows:N}],!N.every(F=>F<=0)){var B,P;const F=(((B=s.flip)==null?void 0:B.index)||0)+1,Q=R[F];if(Q)return{data:{index:F,overflows:O},reset:{placement:Q}};let q=(P=O.filter(K=>K.overflows[0]<=0).sort((K,U)=>K.overflows[1]-U.overflows[1])[0])==null?void 0:P.placement;if(!q)switch(p){case"bestFit":{var H;const K=(H=O.filter(U=>{if(T){const re=zf(U.placement);return re===_||re==="y"}return!0}).map(U=>[U.placement,U.overflows.filter(re=>re>0).reduce((re,G)=>re+G,0)]).sort((U,re)=>U[1]-re[1])[0])==null?void 0:H[0];K&&(q=K);break}case"initialPlacement":q=o;break}if(i!==q)return{reset:{placement:q}}}return{}}}};function vB(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function xB(e){return bve.some(t=>e[t]>=0)}const Rve=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...i}=fd(e,t);switch(r){case"referenceHidden":{const s=await mx(t,{...i,elementContext:"reference"}),a=vB(s,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:xB(a)}}}case"escaped":{const s=await mx(t,{...i,altBoundary:!0}),a=vB(s,n.floating);return{data:{escapedOffsets:a,escaped:xB(a)}}}default:return{}}}}};async function Ive(e,t){const{placement:n,platform:r,elements:i}=e,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=hd(n),o=J0(n),l=zf(n)==="y",c=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,d=fd(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(p=o==="end"?y*-1:y),l?{x:p*u,y:h*c}:{x:h*c,y:p*u}}const Mve=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:s,placement:a,middlewareData:o}=t,l=await Ive(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},Nve=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:x=>{let{x:w,y:_}=x;return{x:w,y:_}}},...l}=fd(e,t),c={x:n,y:r},u=await mx(t,l),d=zf(hd(i)),h=hO(d);let p=c[h],y=c[d];if(s){const x=h==="y"?"top":"left",w=h==="y"?"bottom":"right",_=p+u[x],S=p-u[w];p=P3(_,p,S)}if(a){const x=d==="y"?"top":"left",w=d==="y"?"bottom":"right",_=y+u[x],S=y-u[w];y=P3(_,y,S)}const b=o.fn({...t,[h]:p,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:s,[d]:a}}}}}},jve=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:i,rects:s,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=fd(e,t),u={x:n,y:r},d=zf(i),h=hO(d);let p=u[h],y=u[d];const b=fd(o,t),x=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=h==="y"?"height":"width",C=s.reference[h]-s.floating[S]+x.mainAxis,E=s.reference[h]+s.reference[S]-x.mainAxis;p<C?p=C:p>E&&(p=E)}if(c){var w,_;const S=h==="y"?"width":"height",C=["top","left"].includes(hd(i)),E=s.reference[d]-s.floating[S]+(C&&((w=a.offset)==null?void 0:w[d])||0)+(C?0:x.crossAxis),T=s.reference[d]+s.reference[S]+(C?0:((_=a.offset)==null?void 0:_[d])||0)-(C?x.crossAxis:0);y<E?y=E:y>T&&(y=T)}return{[h]:p,[d]:y}}}},Ove=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:i,rects:s,platform:a,elements:o}=t,{apply:l=()=>{},...c}=fd(e,t),u=await mx(t,c),d=hd(i),h=J0(i),p=zf(i)==="y",{width:y,height:b}=s.floating;let x,w;d==="top"||d==="bottom"?(x=d,w=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(w=d,x=h==="end"?"top":"bottom");const _=b-u.top-u.bottom,S=y-u.left-u.right,C=$f(b-u[x],_),E=$f(y-u[w],S),T=!t.middlewareData.shift;let R=C,M=E;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(M=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(R=_),T&&!h){const O=Do(u.left,0),B=Do(u.right,0),P=Do(u.top,0),H=Do(u.bottom,0);p?M=y-2*(O!==0||B!==0?O+B:Do(u.left,u.right)):R=b-2*(P!==0||H!==0?P+H:Do(u.top,u.bottom))}await l({...t,availableWidth:M,availableHeight:R});const N=await a.getDimensions(o.floating);return y!==N.width||b!==N.height?{reset:{rects:!0}}:{}}}};function Zk(){return typeof window<"u"}function Q0(e){return JW(e)?(e.nodeName||"").toLowerCase():"#document"}function Bo(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function uu(e){var t;return(t=(JW(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function JW(e){return Zk()?e instanceof Node||e instanceof Bo(e).Node:!1}function sc(e){return Zk()?e instanceof Element||e instanceof Bo(e).Element:!1}function ru(e){return Zk()?e instanceof HTMLElement||e instanceof Bo(e).HTMLElement:!1}function wB(e){return!Zk()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Bo(e).ShadowRoot}function Iw(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=ac(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(i)}function Pve(e){return["table","td","th"].includes(Q0(e))}function Xk(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function gO(e){const t=yO(),n=sc(e)?ac(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Dve(e){let t=Uf(e);for(;ru(t)&&!h0(t);){if(gO(t))return t;if(Xk(t))return null;t=Uf(t)}return null}function yO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function h0(e){return["html","body","#document"].includes(Q0(e))}function ac(e){return Bo(e).getComputedStyle(e)}function Jk(e){return sc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Uf(e){if(Q0(e)==="html")return e;const t=e.assignedSlot||e.parentNode||wB(e)&&e.host||uu(e);return wB(t)?t.host:t}function QW(e){const t=Uf(e);return h0(t)?e.ownerDocument?e.ownerDocument.body:e.body:ru(t)&&Iw(t)?t:QW(t)}function gx(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=QW(e),s=i===((r=e.ownerDocument)==null?void 0:r.body),a=Bo(i);if(s){const o=F3(a);return t.concat(a,a.visualViewport||[],Iw(i)?i:[],o&&n?gx(o):[])}return t.concat(i,gx(i,[],n))}function F3(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function eG(e){const t=ac(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=ru(e),s=i?e.offsetWidth:n,a=i?e.offsetHeight:r,o=iC(n)!==s||iC(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function bO(e){return sc(e)?e:e.contextElement}function zg(e){const t=bO(e);if(!ru(t))return Kc(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=eG(t);let a=(s?iC(n.width):n.width)/r,o=(s?iC(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Fve=Kc(0);function tG(e){const t=Bo(e);return!yO()||!t.visualViewport?Fve:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Lve(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Bo(e)?!1:t}function Pp(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=bO(e);let a=Kc(1);t&&(r?sc(r)&&(a=zg(r)):a=zg(e));const o=Lve(s,n,r)?tG(s):Kc(0);let l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,u=i.width/a.x,d=i.height/a.y;if(s){const h=Bo(s),p=r&&sc(r)?Bo(r):r;let y=h,b=F3(y);for(;b&&r&&p!==y;){const x=zg(b),w=b.getBoundingClientRect(),_=ac(b),S=w.left+(b.clientLeft+parseFloat(_.paddingLeft))*x.x,C=w.top+(b.clientTop+parseFloat(_.paddingTop))*x.y;l*=x.x,c*=x.y,u*=x.x,d*=x.y,l+=S,c+=C,y=Bo(b),b=F3(y)}}return aC({width:u,height:d,x:l,y:c})}function vO(e,t){const n=Jk(e).scrollLeft;return t?t.left+n:Pp(uu(e)).left+n}function nG(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),i=r.left+t.scrollLeft-(n?0:vO(e,r)),s=r.top+t.scrollTop;return{x:i,y:s}}function Bve(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const s=i==="fixed",a=uu(r),o=t?Xk(t.floating):!1;if(r===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=Kc(1);const u=Kc(0),d=ru(r);if((d||!d&&!s)&&((Q0(r)!=="body"||Iw(a))&&(l=Jk(r)),ru(r))){const p=Pp(r);c=zg(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}const h=a&&!d&&!s?nG(a,l,!0):Kc(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function $ve(e){return Array.from(e.getClientRects())}function zve(e){const t=uu(e),n=Jk(e),r=e.ownerDocument.body,i=Do(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=Do(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+vO(e);const o=-n.scrollTop;return ac(r).direction==="rtl"&&(a+=Do(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}function Uve(e,t){const n=Bo(e),r=uu(e),i=n.visualViewport;let s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const c=yO();(!c||c&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function qve(e,t){const n=Pp(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=ru(e)?zg(e):Kc(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:a,height:o,x:l,y:c}}function _B(e,t,n){let r;if(t==="viewport")r=Uve(e,n);else if(t==="document")r=zve(uu(e));else if(sc(t))r=qve(t,n);else{const i=tG(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return aC(r)}function rG(e,t){const n=Uf(e);return n===t||!sc(n)||h0(n)?!1:ac(n).position==="fixed"||rG(n,t)}function Vve(e,t){const n=t.get(e);if(n)return n;let r=gx(e,[],!1).filter(o=>sc(o)&&Q0(o)!=="body"),i=null;const s=ac(e).position==="fixed";let a=s?Uf(e):e;for(;sc(a)&&!h0(a);){const o=ac(a),l=gO(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Iw(a)&&!l&&rG(e,a))?r=r.filter(u=>u!==a):i=o,a=Uf(a)}return t.set(e,r),r}function Hve(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[...n==="clippingAncestors"?Xk(t)?[]:Vve(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=_B(t,u,i);return c.top=Do(d.top,c.top),c.right=$f(d.right,c.right),c.bottom=$f(d.bottom,c.bottom),c.left=Do(d.left,c.left),c},_B(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Wve(e){const{width:t,height:n}=eG(e);return{width:t,height:n}}function Gve(e,t,n){const r=ru(t),i=uu(t),s=n==="fixed",a=Pp(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=Kc(0);if(r||!r&&!s)if((Q0(t)!=="body"||Iw(i))&&(o=Jk(t)),r){const h=Pp(t,!0,s,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else i&&(l.x=vO(i));const c=i&&!r&&!s?nG(i,o):Kc(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function _I(e){return ac(e).position==="static"}function SB(e,t){if(!ru(e)||ac(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return uu(e)===n&&(n=n.ownerDocument.body),n}function iG(e,t){const n=Bo(e);if(Xk(e))return n;if(!ru(e)){let i=Uf(e);for(;i&&!h0(i);){if(sc(i)&&!_I(i))return i;i=Uf(i)}return n}let r=SB(e,t);for(;r&&Pve(r)&&_I(r);)r=SB(r,t);return r&&h0(r)&&_I(r)&&!gO(r)?n:r||Dve(e)||n}const Kve=async function(e){const t=this.getOffsetParent||iG,n=this.getDimensions,r=await n(e.floating);return{reference:Gve(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Yve(e){return ac(e).direction==="rtl"}const Zve={convertOffsetParentRelativeRectToViewportRelativeRect:Bve,getDocumentElement:uu,getClippingRect:Hve,getOffsetParent:iG,getElementRects:Kve,getClientRects:$ve,getDimensions:Wve,getScale:zg,isElement:sc,isRTL:Yve};function sG(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Xve(e,t){let n=null,r;const i=uu(e);function s(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:p}=c;if(o||t(),!h||!p)return;const y=Q_(d),b=Q_(i.clientWidth-(u+h)),x=Q_(i.clientHeight-(d+p)),w=Q_(u),S={rootMargin:-y+"px "+-b+"px "+-x+"px "+-w+"px",threshold:Do(0,$f(1,l))||1};let C=!0;function E(T){const R=T[0].intersectionRatio;if(R!==l){if(!C)return a();R?a(!1,R):r=setTimeout(()=>{a(!1,1e-7)},1e3)}R===1&&!sG(c,e.getBoundingClientRect())&&a(),C=!1}try{n=new IntersectionObserver(E,{...S,root:i.ownerDocument})}catch{n=new IntersectionObserver(E,S)}n.observe(e)}return a(!0),s}function Jve(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=bO(e),u=i||s?[...c?gx(c):[],...gx(t)]:[];u.forEach(w=>{i&&w.addEventListener("scroll",n,{passive:!0}),s&&w.addEventListener("resize",n)});const d=c&&o?Xve(c,n):null;let h=-1,p=null;a&&(p=new ResizeObserver(w=>{let[_]=w;_&&_.target===c&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=p)==null||S.observe(t)})),n()}),c&&!l&&p.observe(c),p.observe(t));let y,b=l?Pp(e):null;l&&x();function x(){const w=Pp(e);b&&!sG(b,w)&&n(),b=w,y=requestAnimationFrame(x)}return n(),()=>{var w;u.forEach(_=>{i&&_.removeEventListener("scroll",n),s&&_.removeEventListener("resize",n)}),d==null||d(),(w=p)==null||w.disconnect(),p=null,l&&cancelAnimationFrame(y)}}const Qve=Mve,exe=Nve,txe=Ave,nxe=Ove,rxe=Rve,CB=Tve,ixe=jve,sxe=(e,t,n)=>{const r=new Map,i={platform:Zve,...n},s={...i.platform,_c:r};return Eve(e,t,{...i,platform:s})};var JS=typeof document<"u"?A.useLayoutEffect:A.useEffect;function oC(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!oC(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&e.$$typeof)&&!oC(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function aG(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function kB(e,t){const n=aG(e);return Math.round(t*n)/n}function SI(e){const t=A.useRef(e);return JS(()=>{t.current=e}),t}function axe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=A.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=A.useState(r);oC(h,r)||p(r);const[y,b]=A.useState(null),[x,w]=A.useState(null),_=A.useCallback(U=>{U!==T.current&&(T.current=U,b(U))},[]),S=A.useCallback(U=>{U!==R.current&&(R.current=U,w(U))},[]),C=s||y,E=a||x,T=A.useRef(null),R=A.useRef(null),M=A.useRef(u),N=l!=null,O=SI(l),B=SI(i),P=SI(c),H=A.useCallback(()=>{if(!T.current||!R.current)return;const U={placement:t,strategy:n,middleware:h};B.current&&(U.platform=B.current),sxe(T.current,R.current,U).then(re=>{const G={...re,isPositioned:P.current!==!1};F.current&&!oC(M.current,G)&&(M.current=G,Hl.flushSync(()=>{d(G)}))})},[h,t,n,B,P]);JS(()=>{c===!1&&M.current.isPositioned&&(M.current.isPositioned=!1,d(U=>({...U,isPositioned:!1})))},[c]);const F=A.useRef(!1);JS(()=>(F.current=!0,()=>{F.current=!1}),[]),JS(()=>{if(C&&(T.current=C),E&&(R.current=E),C&&E){if(O.current)return O.current(C,E,H);H()}},[C,E,H,O,N]);const Q=A.useMemo(()=>({reference:T,floating:R,setReference:_,setFloating:S}),[_,S]),q=A.useMemo(()=>({reference:C,floating:E}),[C,E]),K=A.useMemo(()=>{const U={position:n,left:0,top:0};if(!q.floating)return U;const re=kB(q.floating,u.x),G=kB(q.floating,u.y);return o?{...U,transform:"translate("+re+"px, "+G+"px)",...aG(q.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:re,top:G}},[n,o,q.floating,u.x,u.y]);return A.useMemo(()=>({...u,update:H,refs:Q,elements:q,floatingStyles:K}),[u,H,Q,q,K])}const oxe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:i}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?CB({element:r.current,padding:i}).fn(n):{}:r?CB({element:r,padding:i}).fn(n):{}}}},lxe=(e,t)=>({...Qve(e),options:[e,t]}),cxe=(e,t)=>({...exe(e),options:[e,t]}),uxe=(e,t)=>({...ixe(e),options:[e,t]}),dxe=(e,t)=>({...txe(e),options:[e,t]}),fxe=(e,t)=>({...nxe(e),options:[e,t]}),hxe=(e,t)=>({...rxe(e),options:[e,t]}),pxe=(e,t)=>({...oxe(e),options:[e,t]});var mxe="Arrow",oG=A.forwardRef((e,t)=>{const{children:n,width:r=10,height:i=5,...s}=e;return m.jsx(pn.svg,{...s,ref:t,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:m.jsx("polygon",{points:"0,0 30,0 15,10"})})});oG.displayName=mxe;var gxe=oG;function Qk(e){const[t,n]=A.useState(void 0);return sa(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var xO="Popper",[lG,lh]=Ca(xO),[yxe,cG]=lG(xO),uG=e=>{const{__scopePopper:t,children:n}=e,[r,i]=A.useState(null);return m.jsx(yxe,{scope:t,anchor:r,onAnchorChange:i,children:n})};uG.displayName=xO;var dG="PopperAnchor",fG=A.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...i}=e,s=cG(dG,n),a=A.useRef(null),o=tr(t,a);return A.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:m.jsx(pn.div,{...i,ref:o})});fG.displayName=dG;var wO="PopperContent",[bxe,vxe]=lG(wO),hG=A.forwardRef((e,t)=>{var Pe,Me,Ee,Ue,nt,He;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:y,...b}=e,x=cG(wO,n),[w,_]=A.useState(null),S=tr(t,je=>_(je)),[C,E]=A.useState(null),T=Qk(C),R=(T==null?void 0:T.width)??0,M=(T==null?void 0:T.height)??0,N=r+(s!=="center"?"-"+s:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],P=B.length>0,H={padding:O,boundary:B.filter(wxe),altBoundary:P},{refs:F,floatingStyles:Q,placement:q,isPositioned:K,middlewareData:U}=axe({strategy:"fixed",placement:N,whileElementsMounted:(...je)=>Jve(...je,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[lxe({mainAxis:i+M,alignmentAxis:a}),l&&cxe({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?uxe():void 0,...H}),l&&dxe({...H}),fxe({...H,apply:({elements:je,rects:Y,availableWidth:be,availableHeight:Re})=>{const{width:ce,height:le}=Y.reference,ae=je.floating.style;ae.setProperty("--radix-popper-available-width",`${be}px`),ae.setProperty("--radix-popper-available-height",`${Re}px`),ae.setProperty("--radix-popper-anchor-width",`${ce}px`),ae.setProperty("--radix-popper-anchor-height",`${le}px`)}}),C&&pxe({element:C,padding:o}),_xe({arrowWidth:R,arrowHeight:M}),h&&hxe({strategy:"referenceHidden",...H})]}),[re,G]=gG(q),ne=Fs(y);sa(()=>{K&&(ne==null||ne())},[K,ne]);const te=(Pe=U.arrow)==null?void 0:Pe.x,se=(Me=U.arrow)==null?void 0:Me.y,pe=((Ee=U.arrow)==null?void 0:Ee.centerOffset)!==0,[de,Ne]=A.useState();return sa(()=>{w&&Ne(window.getComputedStyle(w).zIndex)},[w]),m.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...Q,transform:K?Q.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:de,"--radix-popper-transform-origin":[(Ue=U.transformOrigin)==null?void 0:Ue.x,(nt=U.transformOrigin)==null?void 0:nt.y].join(" "),...((He=U.hide)==null?void 0:He.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:m.jsx(bxe,{scope:n,placedSide:re,onArrowChange:E,arrowX:te,arrowY:se,shouldHideArrow:pe,children:m.jsx(pn.div,{"data-side":re,"data-align":G,...b,ref:S,style:{...b.style,animation:K?void 0:"none"}})})})});hG.displayName=wO;var pG="PopperArrow",xxe={top:"bottom",right:"left",bottom:"top",left:"right"},mG=A.forwardRef(function(t,n){const{__scopePopper:r,...i}=t,s=vxe(pG,r),a=xxe[s.placedSide];return m.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:m.jsx(gxe,{...i,ref:n,style:{...i.style,display:"block"}})})});mG.displayName=pG;function wxe(e){return e!==null}var _xe=e=>({name:"transformOrigin",options:e,fn(t){var x,w,_;const{placement:n,rects:r,middlewareData:i}=t,a=((x=i.arrow)==null?void 0:x.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=gG(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((w=i.arrow)==null?void 0:w.x)??0)+o/2,p=(((_=i.arrow)==null?void 0:_.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${p}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${p}px`),{data:{x:y,y:b}}}});function gG(e){const[t,n="center"]=e.split("-");return[t,n]}var eE=uG,Mw=fG,tE=hG,nE=mG,Sxe="Portal",ey=A.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[i,s]=A.useState(!1);sa(()=>s(!0),[]);const a=n||i&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?tH.createPortal(m.jsx(pn.div,{...r,ref:t}),a):null});ey.displayName=Sxe;function Cxe(e,t){return A.useReducer((n,r)=>t[n][r]??n,e)}var Hs=e=>{const{present:t,children:n}=e,r=kxe(t),i=typeof n=="function"?n({present:r.isPresent}):A.Children.only(n),s=tr(r.ref,Exe(i));return typeof n=="function"||r.isPresent?A.cloneElement(i,{ref:s}):null};Hs.displayName="Presence";function kxe(e){const[t,n]=A.useState(),r=A.useRef(null),i=A.useRef(e),s=A.useRef("none"),a=e?"mounted":"unmounted",[o,l]=Cxe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return A.useEffect(()=>{const c=eS(r.current);s.current=o==="mounted"?c:"none"},[o]),sa(()=>{const c=r.current,u=i.current;if(u!==e){const h=s.current,p=eS(c);e?l("MOUNT"):p==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==p?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,l]),sa(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=p=>{const b=eS(r.current).includes(p.animationName);if(p.target===t&&b&&(l("ANIMATION_END"),!i.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},h=p=>{p.target===t&&(s.current=eS(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:A.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function eS(e){return(e==null?void 0:e.animationName)||"none"}function Exe(e){var r,i;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(i=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:i.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Txe=bV[" useInsertionEffect ".trim().toString()]||sa;function oc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[i,s,a]=Axe({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:i;{const u=A.useRef(e!==void 0);A.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=A.useCallback(u=>{var d;if(o){const h=Rxe(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else s(u)},[o,e,s,a]);return[l,c]}function Axe({defaultProp:e,onChange:t}){const[n,r]=A.useState(e),i=A.useRef(n),s=A.useRef(t);return Txe(()=>{s.current=t},[t]),A.useEffect(()=>{var a;i.current!==n&&((a=s.current)==null||a.call(s,n),i.current=n)},[n,i]),[n,r,s]}function Rxe(e){return typeof e=="function"}var yG=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Ixe="VisuallyHidden",bG=A.forwardRef((e,t)=>m.jsx(pn.span,{...e,ref:t,style:{...yG,...e.style}}));bG.displayName=Ixe;var Mxe=bG,[rE,bst]=Ca("Tooltip",[lh]),iE=lh(),vG="TooltipProvider",Nxe=700,L3="tooltip.open",[jxe,_O]=rE(vG),xG=e=>{const{__scopeTooltip:t,delayDuration:n=Nxe,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:s}=e,a=A.useRef(!0),o=A.useRef(!1),l=A.useRef(0);return A.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),m.jsx(jxe,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:A.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:A.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:A.useCallback(c=>{o.current=c},[]),disableHoverableContent:i,children:s})};xG.displayName=vG;var yx="Tooltip",[Oxe,Nw]=rE(yx),wG=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:i,onOpenChange:s,disableHoverableContent:a,delayDuration:o}=e,l=_O(yx,e.__scopeTooltip),c=iE(t),[u,d]=A.useState(null),h=Bs(),p=A.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,x=A.useRef(!1),[w,_]=oc({prop:r,defaultProp:i??!1,onChange:R=>{R?(l.onOpen(),document.dispatchEvent(new CustomEvent(L3))):l.onClose(),s==null||s(R)},caller:yx}),S=A.useMemo(()=>w?x.current?"delayed-open":"instant-open":"closed",[w]),C=A.useCallback(()=>{window.clearTimeout(p.current),p.current=0,x.current=!1,_(!0)},[_]),E=A.useCallback(()=>{window.clearTimeout(p.current),p.current=0,_(!1)},[_]),T=A.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{x.current=!0,_(!0),p.current=0},b)},[b,_]);return A.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),m.jsx(eE,{...c,children:m.jsx(Oxe,{scope:t,contentId:h,open:w,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:A.useCallback(()=>{l.isOpenDelayedRef.current?T():C()},[l.isOpenDelayedRef,T,C]),onTriggerLeave:A.useCallback(()=>{y?E():(window.clearTimeout(p.current),p.current=0)},[E,y]),onOpen:C,onClose:E,disableHoverableContent:y,children:n})})};wG.displayName=yx;var B3="TooltipTrigger",_G=A.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,i=Nw(B3,n),s=_O(B3,n),a=iE(n),o=A.useRef(null),l=tr(t,o,i.onTriggerChange),c=A.useRef(!1),u=A.useRef(!1),d=A.useCallback(()=>c.current=!1,[]);return A.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),m.jsx(Mw,{asChild:!0,...a,children:m.jsx(pn.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:l,onPointerMove:Kt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:Kt(e.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:Kt(e.onPointerDown,()=>{i.open&&i.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Kt(e.onFocus,()=>{c.current||i.onOpen()}),onBlur:Kt(e.onBlur,i.onClose),onClick:Kt(e.onClick,i.onClose)})})});_G.displayName=B3;var SO="TooltipPortal",[Pxe,Dxe]=rE(SO,{forceMount:void 0}),SG=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:i}=e,s=Nw(SO,t);return m.jsx(Pxe,{scope:t,forceMount:n,children:m.jsx(Hs,{present:n||s.open,children:m.jsx(ey,{asChild:!0,container:i,children:r})})})};SG.displayName=SO;var p0="TooltipContent",CG=A.forwardRef((e,t)=>{const n=Dxe(p0,e.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...s}=e,a=Nw(p0,e.__scopeTooltip);return m.jsx(Hs,{present:r||a.open,children:a.disableHoverableContent?m.jsx(kG,{side:i,...s,ref:t}):m.jsx(Fxe,{side:i,...s,ref:t})})}),Fxe=A.forwardRef((e,t)=>{const n=Nw(p0,e.__scopeTooltip),r=_O(p0,e.__scopeTooltip),i=A.useRef(null),s=tr(t,i),[a,o]=A.useState(null),{trigger:l,onClose:c}=n,u=i.current,{onPointerInTransitChange:d}=r,h=A.useCallback(()=>{o(null),d(!1)},[d]),p=A.useCallback((y,b)=>{const x=y.currentTarget,w={x:y.clientX,y:y.clientY},_=zxe(w,x.getBoundingClientRect()),S=Uxe(w,_),C=qxe(b.getBoundingClientRect()),E=Hxe([...S,...C]);o(E),d(!0)},[d]);return A.useEffect(()=>()=>h(),[h]),A.useEffect(()=>{if(l&&u){const y=x=>p(x,u),b=x=>p(x,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,p,h]),A.useEffect(()=>{if(a){const y=b=>{const x=b.target,w={x:b.clientX,y:b.clientY},_=(l==null?void 0:l.contains(x))||(u==null?void 0:u.contains(x)),S=!Vxe(w,a);_?h():S&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),m.jsx(kG,{...e,ref:s})}),[Lxe,Bxe]=rE(yx,{isInside:!1}),$xe=dde("TooltipContent"),kG=A.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...o}=e,l=Nw(p0,n),c=iE(n),{onClose:u}=l;return A.useEffect(()=>(document.addEventListener(L3,u),()=>document.removeEventListener(L3,u)),[u]),A.useEffect(()=>{if(l.trigger){const d=h=>{const p=h.target;p!=null&&p.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),m.jsx(X0,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:m.jsxs(tE,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[m.jsx($xe,{children:r}),m.jsx(Lxe,{scope:n,isInside:!0,children:m.jsx(Mxe,{id:l.contentId,role:"tooltip",children:i||r})})]})})});CG.displayName=p0;var EG="TooltipArrow",TG=A.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,i=iE(n);return Bxe(EG,n).isInside?null:m.jsx(nE,{...i,...r,ref:t})});TG.displayName=EG;function zxe(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),i=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(n,r,i,s)){case s:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function Uxe(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function qxe(e){const{top:t,right:n,bottom:r,left:i}=e;return[{x:i,y:t},{x:n,y:t},{x:n,y:r},{x:i,y:r}]}function Vxe(e,t){const{x:n,y:r}=e;let i=!1;for(let s=0,a=t.length-1;s<t.length;a=s++){const o=t[s],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(i=!i)}return i}function Hxe(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Wxe(t)}function Wxe(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const i=e[r];for(;t.length>=2;){const s=t[t.length-1],a=t[t.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))t.pop();else break}t.push(i)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const i=e[r];for(;n.length>=2;){const s=n[n.length-1],a=n[n.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))n.pop();else break}n.push(i)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var Gxe=xG,Kxe=wG,Yxe=_G,Zxe=SG,Xxe=CG,Jxe=TG;function hr({delayDuration:e=0,...t}){return m.jsx(Gxe,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function mr({...e}){return m.jsx(hr,{children:m.jsx(Kxe,{"data-slot":"tooltip",...e})})}function gr({...e}){return m.jsx(Yxe,{"data-slot":"tooltip-trigger",...e})}function yr({className:e,sideOffset:t=0,children:n,...r}){return m.jsx(Zxe,{children:m.jsxs(Xxe,{"data-slot":"tooltip-content",sideOffset:t,className:dt("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,m.jsx(Jxe,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}var CI={exports:{}},EB;function Qxe(){return EB||(EB=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var i=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,s=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function _(S){return S instanceof l?new l(S.type,_(S.content),S.alias):Array.isArray(S)?S.map(_):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(_){return Object.prototype.toString.call(_).slice(8,-1)},objId:function(_){return _.__id||Object.defineProperty(_,"__id",{value:++s}),_.__id},clone:function _(S,C){C=C||{};var E,T;switch(o.util.type(S)){case"Object":if(T=o.util.objId(S),C[T])return C[T];E={},C[T]=E;for(var R in S)S.hasOwnProperty(R)&&(E[R]=_(S[R],C));return E;case"Array":return T=o.util.objId(S),C[T]?C[T]:(E=[],C[T]=E,S.forEach(function(M,N){E[N]=_(M,C)}),E);default:return S}},getLanguage:function(_){for(;_;){var S=i.exec(_.className);if(S)return S[1].toLowerCase();_=_.parentElement}return"none"},setLanguage:function(_,S){_.className=_.className.replace(RegExp(i,"gi"),""),_.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(E){var _=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(_){var S=document.getElementsByTagName("script");for(var C in S)if(S[C].src==_)return S[C]}return null}},isActive:function(_,S,C){for(var E="no-"+S;_;){var T=_.classList;if(T.contains(S))return!0;if(T.contains(E))return!1;_=_.parentElement}return!!C}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(_,S){var C=o.util.clone(o.languages[_]);for(var E in S)C[E]=S[E];return C},insertBefore:function(_,S,C,E){E=E||o.languages;var T=E[_],R={};for(var M in T)if(T.hasOwnProperty(M)){if(M==S)for(var N in C)C.hasOwnProperty(N)&&(R[N]=C[N]);C.hasOwnProperty(M)||(R[M]=T[M])}var O=E[_];return E[_]=R,o.languages.DFS(o.languages,function(B,P){P===O&&B!=_&&(this[B]=R)}),R},DFS:function _(S,C,E,T){T=T||{};var R=o.util.objId;for(var M in S)if(S.hasOwnProperty(M)){C.call(S,M,S[M],E||M);var N=S[M],O=o.util.type(N);O==="Object"&&!T[R(N)]?(T[R(N)]=!0,_(N,C,null,T)):O==="Array"&&!T[R(N)]&&(T[R(N)]=!0,_(N,C,M,T))}}},plugins:{},highlightAll:function(_,S){o.highlightAllUnder(document,_,S)},highlightAllUnder:function(_,S,C){var E={callback:C,container:_,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var T=0,R;R=E.elements[T++];)o.highlightElement(R,S===!0,E.callback)},highlightElement:function(_,S,C){var E=o.util.getLanguage(_),T=o.languages[E];o.util.setLanguage(_,E);var R=_.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(R,E);var M=_.textContent,N={element:_,language:E,grammar:T,code:M};function O(P){N.highlightedCode=P,o.hooks.run("before-insert",N),N.element.innerHTML=N.highlightedCode,o.hooks.run("after-highlight",N),o.hooks.run("complete",N),C&&C.call(N.element)}if(o.hooks.run("before-sanity-check",N),R=N.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!N.code){o.hooks.run("complete",N),C&&C.call(N.element);return}if(o.hooks.run("before-highlight",N),!N.grammar){O(o.util.encode(N.code));return}if(S&&r.Worker){var B=new Worker(o.filename);B.onmessage=function(P){O(P.data)},B.postMessage(JSON.stringify({language:N.language,code:N.code,immediateClose:!0}))}else O(o.highlight(N.code,N.grammar,N.language))},highlight:function(_,S,C){var E={code:_,grammar:S,language:C};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),l.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(_,S){var C=S.rest;if(C){for(var E in C)S[E]=C[E];delete S.rest}var T=new d;return h(T,T.head,_),u(_,T,S,T.head,0),y(T)},hooks:{all:{},add:function(_,S){var C=o.hooks.all;C[_]=C[_]||[],C[_].push(S)},run:function(_,S){var C=o.hooks.all[_];if(!(!C||!C.length))for(var E=0,T;T=C[E++];)T(S)}},Token:l};r.Prism=o;function l(_,S,C,E){this.type=_,this.content=S,this.alias=C,this.length=(E||"").length|0}l.stringify=function _(S,C){if(typeof S=="string")return S;if(Array.isArray(S)){var E="";return S.forEach(function(O){E+=_(O,C)}),E}var T={type:S.type,content:_(S.content,C),tag:"span",classes:["token",S.type],attributes:{},language:C},R=S.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(T.classes,R):T.classes.push(R)),o.hooks.run("wrap",T);var M="";for(var N in T.attributes)M+=" "+N+'="'+(T.attributes[N]||"").replace(/"/g,"&quot;")+'"';return"<"+T.tag+' class="'+T.classes.join(" ")+'"'+M+">"+T.content+"</"+T.tag+">"};function c(_,S,C,E){_.lastIndex=S;var T=_.exec(C);if(T&&E&&T[1]){var R=T[1].length;T.index+=R,T[0]=T[0].slice(R)}return T}function u(_,S,C,E,T,R){for(var M in C)if(!(!C.hasOwnProperty(M)||!C[M])){var N=C[M];N=Array.isArray(N)?N:[N];for(var O=0;O<N.length;++O){if(R&&R.cause==M+","+O)return;var B=N[O],P=B.inside,H=!!B.lookbehind,F=!!B.greedy,Q=B.alias;if(F&&!B.pattern.global){var q=B.pattern.toString().match(/[imsuy]*$/)[0];B.pattern=RegExp(B.pattern.source,q+"g")}for(var K=B.pattern||B,U=E.next,re=T;U!==S.tail&&!(R&&re>=R.reach);re+=U.value.length,U=U.next){var G=U.value;if(S.length>_.length)return;if(!(G instanceof l)){var ne=1,te;if(F){if(te=c(K,re,_,H),!te||te.index>=_.length)break;var Ne=te.index,se=te.index+te[0].length,pe=re;for(pe+=U.value.length;Ne>=pe;)U=U.next,pe+=U.value.length;if(pe-=U.value.length,re=pe,U.value instanceof l)continue;for(var de=U;de!==S.tail&&(pe<se||typeof de.value=="string");de=de.next)ne++,pe+=de.value.length;ne--,G=_.slice(re,pe),te.index-=re}else if(te=c(K,0,G,H),!te)continue;var Ne=te.index,Pe=te[0],Me=G.slice(0,Ne),Ee=G.slice(Ne+Pe.length),Ue=re+G.length;R&&Ue>R.reach&&(R.reach=Ue);var nt=U.prev;Me&&(nt=h(S,nt,Me),re+=Me.length),p(S,nt,ne);var He=new l(M,P?o.tokenize(Pe,P):Pe,Q,Pe);if(U=h(S,nt,He),Ee&&h(S,U,Ee),ne>1){var je={cause:M+","+O,reach:Ue};u(_,S,C,U.prev,re,je),R&&je.reach>R.reach&&(R.reach=je.reach)}}}}}}function d(){var _={value:null,prev:null,next:null},S={value:null,prev:_,next:null};_.next=S,this.head=_,this.tail=S,this.length=0}function h(_,S,C){var E=S.next,T={value:C,prev:S,next:E};return S.next=T,E.prev=T,_.length++,T}function p(_,S,C){for(var E=S.next,T=0;T<C&&E!==_.tail;T++)E=E.next;S.next=E,E.prev=S,_.length-=T}function y(_){for(var S=[],C=_.head.next;C!==_.tail;)S.push(C.value),C=C.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(_){var S=JSON.parse(_.data),C=S.language,E=S.code,T=S.immediateClose;r.postMessage(o.highlight(E,o.languages[C],C)),T&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function x(){o.manual||o.highlightAll()}if(!o.manual){var w=document.readyState;w==="loading"||w==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",x):window.requestAnimationFrame?window.requestAnimationFrame(x):window.setTimeout(x,16)}return o}(t);e.exports&&(e.exports=n),typeof cp<"u"&&(cp.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(i,s){var a={};a["language-"+s]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[s]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+s]={pattern:/[\s\S]+/,inside:n.languages[s]};var l={};l[i]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return i}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,i){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[i,"language-"+i],inside:n.languages[i]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var i=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+i.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+i.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+i.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+i.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:i,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var s=r.languages.markup;s&&(s.tag.addInlined("style","css"),s.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",i=function(b,x){return" Error "+b+" while fetching file: "+x},s=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,x,w){var _=new XMLHttpRequest;_.open("GET",b,!0),_.onreadystatechange=function(){_.readyState==4&&(_.status<400&&_.responseText?x(_.responseText):_.status>=400?w(i(_.status,_.statusText)):w(s))},_.send(null)}function p(b){var x=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(x){var w=Number(x[1]),_=x[2],S=x[3];return _?S?[w,Number(S)]:[w,void 0]:[w,w]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var x=b.element;if(x.matches(d)){b.code="",x.setAttribute(o,l);var w=x.appendChild(document.createElement("CODE"));w.textContent=r;var _=x.getAttribute("data-src"),S=b.language;if(S==="none"){var C=(/\.(\w+)$/.exec(_)||[,"none"])[1];S=a[C]||C}n.util.setLanguage(w,S),n.util.setLanguage(x,S);var E=n.plugins.autoloader;E&&E.loadLanguages(S),h(_,function(T){x.setAttribute(o,c);var R=p(x.getAttribute("data-range"));if(R){var M=T.split(/\r\n?|\n/g),N=R[0],O=R[1]==null?M.length:R[1];N<0&&(N+=M.length),N=Math.max(0,Math.min(N-1,M.length)),O<0&&(O+=M.length),O=Math.max(0,Math.min(O,M.length)),T=M.slice(N,O).join(`
`),x.hasAttribute("data-start")||x.setAttribute("data-start",String(N+1))}w.textContent=T,n.highlightElement(w)},function(T){x.setAttribute(o,u),w.textContent=T})}}),n.plugins.fileHighlight={highlight:function(x){for(var w=(x||document).querySelectorAll(d),_=0,S;S=w[_++];)n.highlightElement(S)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(CI)),CI.exports}var ewe=Qxe();const twe=aa(ewe);var TB={},AB;function nwe(){return AB||(AB=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),TB}nwe();var RB={},IB;function rwe(){return IB||(IB=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),RB}rwe();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var i=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],s=r.variable[1].inside,a=0;a<i.length;a++)s[i[a]]=e.languages.bash[i[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,i=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),s=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+i+s+"(?:"+i+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+i+s+")(?:"+i+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+i+")"+s+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+i+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var p=0,y=h.length;p<y;p++){var b=h[p];if(b.type!=="code"){d(b.content);continue}var x=b.content[1],w=b.content[3];if(x&&w&&x.type==="code-language"&&w.type==="code-block"&&typeof x.content=="string"){var _=x.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");_=(/[a-z][\w-]*/i.exec(_)||[""])[0].toLowerCase();var S="language-"+_;w.alias?typeof w.alias=="string"?w.alias=[w.alias,S]:w.alias.push(S):w.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,p=u.classes.length;h<p;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var x=e.languages[d];if(x)u.content=e.highlight(c(u.content),x,d);else if(d&&d!=="none"&&e.plugins.autoloader){var w="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=w,e.plugins.autoloader.loadLanguages(d,function(){var _=document.getElementById(w);_&&(_.innerHTML=e.highlight(_.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,p){if(p=p.toLowerCase(),p[0]==="#"){var y;return p[1]==="x"?y=parseInt(p.slice(2),16):y=Number(p.slice(1)),l(y)}else{var b=o[p];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],i=[];/^\w+$/.test(n)||i.push(/\w+/.exec(n)[0]),n==="diff"&&i.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:i,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",i=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),s=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+i+"|"+s+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(s),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var MB={},NB;function iwe(){return NB||(NB=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),MB}iwe();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const swe=({lang:e,code:t,filepath:n,isStreaming:r=!1})=>{const{foldStreamingCodeBlocks:i}=dr(Cn(b=>({foldStreamingCodeBlocks:b.foldStreamingCodeBlocks}))),[s,a]=A.useState(r?i:!1),o=A.useRef(null),l=Ho(Cn(b=>Object.values(b.canvasControls))),c=A.useCallback((b,x,w,_,S,C)=>l.filter(E=>E.type==="codeblock"&&E.targetSlot===b&&E.renderer).map(E=>{if(E.renderer){const T={codeBlockContent:x,codeBlockLang:w,codeBlockFilepath:_,isFolded:S,toggleFold:C,canvasContextType:"codeblock"};return m.jsx(ut.Fragment,{children:E.renderer(T)},E.id)}return null}).filter(Boolean),[l]),u=A.useCallback(()=>{if(o.current&&t)try{o.current.style.whiteSpace!=="pre-wrap"&&(o.current.style.whiteSpace="pre-wrap"),o.current.textContent=t,twe.highlightElement(o.current)}catch(b){console.error("Prism highlight error:",b),o.current.textContent=t}else o.current&&(o.current.textContent="")},[t]);A.useEffect(()=>{s||u()},[t,e,s,u]);const d=()=>{const b=s;a(x=>!x),b&&setTimeout(u,0)},h=e?`language-${e}`:"language-plaintext",p=A.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),y=c("codeblock-header-actions",t,e,n,s,d);return m.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[m.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&m.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),m.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:y})]}),m.jsx("div",{})]}),!s&&m.jsx("div",{className:"overflow-hidden w-full",children:m.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere",children:m.jsx("code",{ref:o,className:h+" block"})})}),s&&m.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:d,children:m.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:p})})]})},ty=A.memo(swe);var pt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(pt||(pt={}));const jB={[pt.EPERM]:"Operation not permitted",[pt.ENOENT]:"No such file or directory",[pt.EINTR]:"Interrupted system call",[pt.EIO]:"Input/output error",[pt.ENXIO]:"No such device or address",[pt.EBADF]:"Bad file descriptor",[pt.EAGAIN]:"Resource temporarily unavailable",[pt.ENOMEM]:"Cannot allocate memory",[pt.EACCES]:"Permission denied",[pt.EFAULT]:"Bad address",[pt.ENOTBLK]:"Block device required",[pt.EBUSY]:"Resource busy or locked",[pt.EEXIST]:"File exists",[pt.EXDEV]:"Invalid cross-device link",[pt.ENODEV]:"No such device",[pt.ENOTDIR]:"File is not a directory",[pt.EISDIR]:"File is a directory",[pt.EINVAL]:"Invalid argument",[pt.ENFILE]:"Too many open files in system",[pt.EMFILE]:"Too many open files",[pt.ETXTBSY]:"Text file busy",[pt.EFBIG]:"File is too big",[pt.ENOSPC]:"No space left on disk",[pt.ESPIPE]:"Illegal seek",[pt.EROFS]:"Cannot modify a read-only file system",[pt.EMLINK]:"Too many links",[pt.EPIPE]:"Broken pipe",[pt.EDOM]:"Numerical argument out of domain",[pt.ERANGE]:"Numerical result out of range",[pt.EDEADLK]:"Resource deadlock would occur",[pt.ENAMETOOLONG]:"File name too long",[pt.ENOLCK]:"No locks available",[pt.ENOSYS]:"Function not implemented",[pt.ENOTEMPTY]:"Directory is not empty",[pt.ELOOP]:"Too many levels of symbolic links",[pt.ENOMSG]:"No message of desired type",[pt.EBADE]:"Invalid exchange",[pt.EBADR]:"Invalid request descriptor",[pt.EXFULL]:"Exchange full",[pt.ENOANO]:"No anode",[pt.EBADRQC]:"Invalid request code",[pt.ENOSTR]:"Device not a stream",[pt.ENODATA]:"No data available",[pt.ETIME]:"Timer expired",[pt.ENOSR]:"Out of streams resources",[pt.ENONET]:"Machine is not on the network",[pt.EREMOTE]:"Object is remote",[pt.ENOLINK]:"Link has been severed",[pt.ECOMM]:"Communication error on send",[pt.EPROTO]:"Protocol error",[pt.EBADMSG]:"Bad message",[pt.EOVERFLOW]:"Value too large for defined data type",[pt.EBADFD]:"File descriptor in bad state",[pt.ESTRPIPE]:"Streams pipe error",[pt.ENOTSOCK]:"Socket operation on non-socket",[pt.EDESTADDRREQ]:"Destination address required",[pt.EMSGSIZE]:"Message too long",[pt.EPROTOTYPE]:"Protocol wrong type for socket",[pt.ENOPROTOOPT]:"Protocol not available",[pt.EPROTONOSUPPORT]:"Protocol not supported",[pt.ESOCKTNOSUPPORT]:"Socket type not supported",[pt.ENOTSUP]:"Operation is not supported",[pt.ENETDOWN]:"Network is down",[pt.ENETUNREACH]:"Network is unreachable",[pt.ENETRESET]:"Network dropped connection on reset",[pt.ETIMEDOUT]:"Connection timed out",[pt.ECONNREFUSED]:"Connection refused",[pt.EHOSTDOWN]:"Host is down",[pt.EHOSTUNREACH]:"No route to host",[pt.EALREADY]:"Operation already in progress",[pt.EINPROGRESS]:"Operation now in progress",[pt.ESTALE]:"Stale file handle",[pt.EREMOTEIO]:"Remote I/O error",[pt.EDQUOT]:"Disk quota exceeded"};class Ke extends Error{static fromJSON(t){const n=new Ke(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Ke(pt[t],jB[pt[t]],n,r)}constructor(t,n=jB[t],r,i=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=i,this.code=pt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var kI={exports:{}},OB;function awe(){return OB||(OB=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],p]:l._events[y].push(p):(l._events[y]=p,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,p=d.length,y=new Array(p);h<p;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,p,y){var b=n?n+c:c;if(!this._events[b])return!1;var x=this._events[b],w=arguments.length,_,S;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),w){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,d),!0;case 4:return x.fn.call(x.context,u,d,h),!0;case 5:return x.fn.call(x.context,u,d,h,p),!0;case 6:return x.fn.call(x.context,u,d,h,p,y),!0}for(S=1,_=new Array(w-1);S<w;S++)_[S-1]=arguments[S];x.fn.apply(x.context,_)}else{var C=x.length,E;for(S=0;S<C;S++)switch(x[S].once&&this.removeListener(c,x[S].fn,void 0,!0),w){case 1:x[S].fn.call(x[S].context);break;case 2:x[S].fn.call(x[S].context,u);break;case 3:x[S].fn.call(x[S].context,u,d);break;case 4:x[S].fn.call(x[S].context,u,d,h);break;default:if(!_)for(E=1,_=new Array(w-1);E<w;E++)_[E-1]=arguments[E];x[S].fn.apply(x[S].context,_)}}return!0},o.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var p=n?n+c:c;if(!this._events[p])return this;if(!u)return a(this,p),this;var y=this._events[p];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,p);else{for(var b=0,x=[],w=y.length;b<w;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&x.push(y[b]);x.length?this._events[p]=x.length===1?x[0]:x:a(this,p)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(kI)),kI.exports}var owe=awe();const CO=aa(owe);var hV;let lwe=class extends CO{constructor(n){super();_e(this,hV,"List");_e(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,i=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const s=Array.from(this.data);s.splice(n,+i,r),this.data=new Set(s),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...i){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const s=Array.from(this.data),a=s.splice(n,r,...i);return this.data=new Set(s),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(hV=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function PB(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function oi(e){throw e}const DB=Intl.NumberFormat("en",{notation:"compact"});DB.format.bind(DB);function Zp(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function cwe(e){try{return JSON.parse(e),!0}catch{return!1}}function $3(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function kO(e){return e.at(0).toUpperCase()+e.slice(1)}const uwe=new TextEncoder;function ap(e){return uwe.encode(e)}const FB=new TextDecoder;function EO(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return FB.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),FB.decode(t)}function bx(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=bx(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function dwe(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var fwe={};let hwe="process"in globalThis&&"env"in globalThis.process&&fwe.U_DEBUG=="true";function vx(...e){hwe&&console.debug("[U]",...e)}const LB=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],pwe=[...LB,...LB.map(e=>kO(e)),"char"],TO=/^(u?int|float)(8|16|32|64|128)$/i;function AG(e){return e=="char"?"uint8":e.toLowerCase()}function AO(e){return TO.test(e.toString())}function z3(e){return e=="char"||TO.test(e.toString().toLowerCase())}function mwe(e){if(!z3(e))throw new TypeError("Not a valid primitive type: "+e)}const BB=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function RG(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function gwe(e){return e!=null&&typeof e=="object"&&"struct"in e}function sE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Jl(e){return typeof e=="function"&&Symbol.metadata in e&&gwe(e[Symbol.metadata])}function jw(e){return e!=null&&typeof e=="object"&&Jl(e.constructor)}function IG(e){if(!jw(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function RO(e){return jw(e)||Jl(e)}function MG(e){if(!RO(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function IO(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function Ii(e){if(e==null)return 0;if(Array.isArray(e)){let i=0;for(let s=0;s<e.length;s++)i+=Ii(e[s]);return i}if(typeof e=="string")return mwe(e),+AG(e).match(TO)[2]/8;if(IO(e))return e[Symbol.size];MG(e);const t=Jl(e)?e:e.constructor;sE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Jl(e))return r;for(const i of n.members.values()){const s=e[i.name];if(jw(s)&&s.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,Ii(s)):r+=Ii(s);continue}if(typeof i.length!="string")continue;let a=0;for(let o=0;o<e[i.length];o++)a+=Ii(RO(s[o])?s[o]:i.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function ywe(e,t){var s;MG(e);const n=Jl(e)?e:e.constructor;sE(n);const{struct:r}=n[Symbol.metadata];if(Jl(e)||!r.isDynamic)return((s=r.members.get(t))==null?void 0:s.staticOffset)??oi(new Error("Struct does not have member: "+t));let i=0;for(const a of r.members.values()){if(a.name==t)return i;const o=e[a.name];i+=Ii(RO(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function bwe(e,t){return Math.ceil(e/t)*t}function Xp(e={}){return function(n,r){const i=new Map;let s=0,a=!1;for(const{name:o,type:l,length:c}of RG(r)){if(!z3(l)&&!Jl(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=i.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!AO(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),i.set(o,{name:o,staticOffset:e.isUnion?0:s,type:z3(l)?AG(l):l,length:c,decl:u});const d=typeof c=="string"||Jl(l)&&l[Symbol.metadata].struct.isDynamic?0:Ii(l)*(c||1);a||(a=Jl(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),s=e.isUnion?Math.max(s,d):s+d,s=bwe(s,e.align||1),vx("define",n.name+"."+o)}return r.metadata.struct={options:e,members:i,staticSize:s,isDynamic:a,isUnion:e.isUnion??!1},n}}function xx(e,t){return function(n,r){let i=r.name;if(typeof i=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+i.toString()),i=i.toString()),!i)throw new ReferenceError("Invalid name for struct member");return RG(r).push({name:i,type:e,length:t}),n}}function NG(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:oi(new Error("Array lengths must be natural numbers"))}function Qs(e){if(IO(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();IG(e),sE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=Ii(e),i=new Uint8Array(r),s=new DataView(i.buffer);vx("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=NG(e,l);vx("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=jw(d)?Ii(d):Ii(l.type),!AO(l.type)){i.set(d?Qs(d):new Uint8Array(Ii(l.type)),a);continue}const h=`set${kO(l.type)}`;if(h=="setInt64"){s.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){s.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){s.setBigUint64(a+(t.bigEndian?8:0),d&BB,!t.bigEndian),s.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){s.setBigUint64(a+(t.bigEndian?8:0),d&BB,!t.bigEndian),s.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){s.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),s.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}s[h](a,Number(d),!t.bigEndian)}}return i}function aE(e,t){const n=dwe(t);if(IO(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);IG(e),sE(e.constructor);const{options:r,members:i}=e.constructor[Symbol.metadata].struct,s=new DataView(n.buffer,n.byteOffset,n.byteLength);vx("deserialize",e.constructor.name);let a=0,o=0;for(const l of i.values()){const c=NG(e,l);vx("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,p=d[h]===null||d[h]===void 0,y=p&&Jl(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!jw(d[h])&&!y&&(o+=Ii(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(s.getUint8(a))+e[l.name].slice(u+1);continue}if(!AO(l.type)){if(y&&Jl(l.type))d[h]??(d[h]=new l.type);else if(p)continue;aE(d[h],new Uint8Array(n.subarray(a))),o+=Ii(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${kO(l.type)}`;if(b=="getInt64"){d[h]=s.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=s.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=s.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|s.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=s.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|s.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=s.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=s[b](a,!r.bigEndian)}}}function vwe(e){function t(n,r){return typeof n=="number"||typeof n=="string"?xx(e,n):xx(e)(n,r)}return t}const qn=Object.fromEntries(pwe.map(e=>[e,vwe(e)]));function xwe(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const dc={root:"/",pwd:"/",credentials:xwe({uid:0,gid:0}),descriptors:new Map};function jG(e,t){let n="",r=0,i=-1,s=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(i===o-1||s===1))if(s===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),i=o,s=0;continue}else if(n.length!==0){n="",r=0,i=o,s=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(i+1,o):n=e.slice(i+1,o),r=o-i-1;i=o,s=0}else a==="."&&s!==-1?++s:s=-1}return n}function pd(...e){var t;let n="";for(const i of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:dc.pwd])if(i!=null&&i.length&&(n=`${i}/${n}`,i.startsWith("/")))break;const r=n.startsWith("/");return n=jG(n,!r),r?`/${n}`:n.length?n:"/"}function wwe(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=jG(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function Zr(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?wwe(t):"."}function OG(e,t){if(e===t||(e=pd.call(this,e),t=pd.call(this,t),e===t))return"";const n=1,r=e.length,i=r-n,s=1,a=t.length-s,o=i<a?i:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[s+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[s+c]==="/")return t.slice(s+c+1);if(c===0)return t.slice(s+c)}else i>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(s+l)}`}function $r(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let i=e.length-1;i>=1;--i)if(e[i]==="/"){if(!r){n=i;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function m0(e,t){let n=0,r=-1,i=!0;for(let s=e.length-1;s>=0;--s)if(e[s]==="/"){if(!i){n=s+1;break}}else r===-1&&(i=!1,r=s+1);return r===-1?"":e.slice(n,r)}function Oc(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let i=-1,s=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){s=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?i===-1?i=l:c!==1&&(c=1):i!==-1&&(c=-1)}if(a!==-1){const u=s===0&&t?1:s;i===-1||c===0||c===1&&i===a-1&&i===s+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,i),n.base=e.slice(u,a),n.ext=e.slice(i,a))}return s>0?n.dir=e.slice(0,s-1):t&&(n.dir="/"),n}var $n;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})($n||($n={}));$n.EMERG+"",$n.ALERT+"",$n.CRIT+"",$n.ERR+"",$n.WARN+"",$n.NOTICE+"",$n.INFO+"",$n.DEBUG+"";const _we=new lwe;function Swe(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};_we.add(n),Mwe(n)}function Cwe(e,t){var n,r;if(!(e instanceof Ke))return e.toString();const i=e.code+": "+e.message;if(!e.path)return i;const s=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return i+": "+Zr(s,e.path)}function ch(e){return function(t,n={}){return Swe(e,Cwe(t,n)),t}}ch($n.EMERG);const kwe=ch($n.ALERT),oE=ch($n.CRIT),so=ch($n.ERR),ga=ch($n.WARN),MO=ch($n.NOTICE),PG=ch($n.INFO),Iv=ch($n.DEBUG);function Ewe(e,t){return`\x1B[${t}m${e}\x1B[0m`}function Twe(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[Ewe(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}$n.EMERG+"",$n.ALERT+"",$n.CRIT+"",$n.ERR+"",$n.WARN+"",$n.NOTICE+"",$n.INFO+"",$n.DEBUG+"",$n.EMERG+"",$n.ALERT+"",$n.CRIT+"",$n.ERR+"",$n.WARN+"",$n.NOTICE+"",$n.INFO+"",$n.DEBUG+"";$n.EMERG+"",$n.ALERT+"",$n.CRIT+"",$n.ERR+"",$n.WARN+"",$n.NOTICE+"",$n.INFO+"",$n.DEBUG+"",$n.EMERG+"",$n.ALERT+"",$n.CRIT+"",$n.ERR+"",$n.WARN+"",$n.NOTICE+"",$n.INFO+"",$n.DEBUG+"";let Awe=e=>[...Twe(e),e.message];function Rwe(e){const t=Awe(e);return typeof t=="string"?[t]:Array.from(t)}let Iwe=console.error;function Mwe(e){e.level>Nwe||Iwe(...Rwe(e))}let Nwe=$n.ALERT;function NO(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function jwe(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function Owe(e,t){if(typeof t!="object"||t===null)throw so(new Ke(pt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const i=t==null?void 0:t[n];if(i==null){if(!r.required){Iv("Using default for option: "+n);continue}throw so(new Ke(pt.EINVAL,"Missing required option: "+n))}const s=(c,u=i)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?i instanceof c:c(i):typeof i===c||((d=i==null?void 0:i.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>s(c)):s(r.type))continue;const a=typeof i=="object"&&"constructor"in i?i.constructor.name:typeof i,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw so(new Ke(pt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function DG(e){return e!=null&&typeof e=="object"&&"backend"in e&&NO(e.backend)}const jO=0,Cs=4,Wi=2,QS=1,OO=1,Pwe=2,Dwe=4,FG=0,ma=1,nd=2,lE=64,cE=128,Fwe=256,uE=512,Dp=1024,Lwe=65536,Bwe=262144,$we=131072,dE=1052672,zwe=4096,Uwe=32768,qwe=16384,Vwe=2048,hi=61440,Jp=49152,Cd=40960,Ql=32768,Qp=24576,fs=16384,em=8192,tm=4096,Ow=2048,Pw=1024,Hwe=512,Wwe=448,LG=256,BG=128,$G=64,Gwe=56,zG=32,UG=16,qG=8,Kwe=7,VG=4,HG=2,WG=1,Ywe=0,qa=4294967295,GG=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:OO,COPYFILE_FICLONE:Pwe,COPYFILE_FICLONE_FORCE:Dwe,F_OK:jO,O_APPEND:Dp,O_CREAT:lE,O_DIRECT:qwe,O_DIRECTORY:Lwe,O_DSYNC:zwe,O_EXCL:cE,O_NOATIME:Bwe,O_NOCTTY:Fwe,O_NOFOLLOW:$we,O_NONBLOCK:Vwe,O_RDONLY:FG,O_RDWR:nd,O_SYMLINK:Uwe,O_SYNC:dE,O_TRUNC:uE,O_WRONLY:ma,R_OK:Cs,S_IFBLK:Qp,S_IFCHR:em,S_IFDIR:fs,S_IFIFO:tm,S_IFLNK:Cd,S_IFMT:hi,S_IFREG:Ql,S_IFSOCK:Jp,S_IRGRP:zG,S_IROTH:VG,S_IRUSR:LG,S_IRWXG:Gwe,S_IRWXO:Kwe,S_IRWXU:Wwe,S_ISGID:Pw,S_ISUID:Ow,S_ISVTX:Hwe,S_IWGRP:UG,S_IWOTH:HG,S_IWUSR:BG,S_IXGRP:qG,S_IXOTH:WG,S_IXUSR:$G,UV_FS_O_FILEMAP:Ywe,W_OK:Wi,X_OK:QS,size_max:qa},Symbol.toStringTag,{value:"Module"})),tS=BigInt(1e3);class KG{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:i,uid:s,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(i??d),this.uid=this._convert(s??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Ql),(this.mode&hi)==0&&(this.mode=this.mode|this._convert(Ql)),Object.assign(this,u)}isFile(){return(this.mode&hi)===Ql}isDirectory(){return(this.mode&hi)===fs}isSymbolicLink(){return(this.mode&hi)===Cd}isSocket(){return(this.mode&hi)===Jp}isBlockDevice(){return(this.mode&hi)===Qp}isCharacterDevice(){return(this.mode&hi)===em}isFIFO(){return(this.mode&hi)===tm}toJSON(){return Zp(this,U3)}hasAccess(t,n){return ni(n,this._isBigint?new kd(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*tS}get mtimeNs(){return BigInt(this.mtimeMs)*tS}get ctimeNs(){return BigInt(this.ctimeMs)*tS}get birthtimeNs(){return BigInt(this.birthtimeMs)*tS}}function YG(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<qa?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<qa?e.gid=n:r=!1,r}class kd extends KG{constructor(){super(...arguments),this._isBigint=!1}}class nm extends KG{constructor(){super(...arguments),this._isBigint=!0}}function Zwe(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class Xwe{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=qa,this.ffree=qa}}class Jwe{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(qa),this.ffree=BigInt(qa)}}var wi=function(e,t,n,r,i,s){function a(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,p=n.length-1;p>=0;p--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(w||null))};var x=(0,n[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(d=a(x.get))&&(u.get=d),(d=a(x.set))&&(u.set=d),(d=a(x.init))&&i.unshift(d)}else(d=a(x))&&(o==="field"?i.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Bn=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0},PO=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const Io=0,Qwe=1024;let $B=(()=>{var e,t;let n=[Xp()],r,i=[],s,a,o=[],l=[],c,u=[],d=[],h,p=[],y=[],b,x=[],w=[];return s=class{get key(){return this._key}set key(_){this._key=_,this.keySize=_.length}get value(){return this._value.subarray(0,this.valueSize)}set value(_){this._value=_,this.valueSize=_.length}constructor(_,S){this.keySize=Bn(this,o,0),this.valueSize=(Bn(this,l),Bn(this,u,0)),this._key=(Bn(this,d),Bn(this,p,"")),this._value=(Bn(this,y),Bn(this,x,new Uint8Array(Qwe))),Bn(this,w),_&&(this.key=_),S&&(this.value=S)}},PO(s,"Attribute"),(()=>{const _=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=qn).uint32.bind(e)],c=[(t=qn).uint32.bind(t)],h=[qn.char("keySize")],b=[qn.uint8("valueSize")],wi(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,C)=>{S.keySize=C}},metadata:_},o,l),wi(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,C)=>{S.valueSize=C}},metadata:_},u,d),wi(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,C)=>{S._key=C}},metadata:_},p,y),wi(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,C)=>{S._value=C}},metadata:_},x,w),wi(null,r={value:s},n,{kind:"class",name:s.name,metadata:_},null,i),s=r.value,_&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_}),Bn(s,i)})(),s})(),qf=(()=>{var e;let t=[Xp()],n,r=[],i,s,a=[],o=[],l,c=[],u=[];return i=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const p=this.get(d);if(p){p.value=h;return}this.data.push(new $B(d,h)),this.size++}remove(d){const h=this.data.findIndex(p=>p.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Bn(this,a,0),this.data=(Bn(this,o),Bn(this,c,[])),Bn(this,u)}},PO(i,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;s=[(e=qn).uint32.bind(e)],l=[xx($B,"size")],wi(null,null,s,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,p)=>{h.size=p}},metadata:d},a,o),wi(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,p)=>{h.data=p}},metadata:d},c,u),wi(null,n={value:i},t,{kind:"class",name:i.name,metadata:d},null,r),i=n.value,d&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Bn(i,r)})(),i})();const U3=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],e1e=4;var ao;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(ao||(ao={}));let us=(()=>{var e,t,n,r,i,s,a,o,l,c,u,d,h,p,y,b;let x=[Xp()],w,_=[],S,C,E=[],T=[],R,M=[],N=[],O,B=[],P=[],H,F=[],Q=[],q,K=[],U=[],re,G=[],ne=[],te,se=[],pe=[],de,Ne=[],Pe=[],Me,Ee=[],Ue=[],nt,He=[],je=[],Y,be=[],Re=[],ce,le=[],ae=[],Te,$e=[],ke=[],ot,At=[],ft=[],jt,Bt=[],Ft=[],tn,xe=[],D=[],X,me=[],De=[],we,Ie=[],fe=[];var yt=S=class{constructor(_t){if(this.data=Bn(this,E,$3(0,qa)),this.__data_old=(Bn(this,T),Bn(this,M,0)),this.size=(Bn(this,N),Bn(this,B,0)),this.mode=(Bn(this,P),Bn(this,F,0)),this.nlink=(Bn(this,Q),Bn(this,K,1)),this.uid=(Bn(this,U),Bn(this,G,0)),this.gid=(Bn(this,ne),Bn(this,se,0)),this.atimeMs=(Bn(this,pe),Bn(this,Ne,Date.now())),this.birthtimeMs=(Bn(this,Pe),Bn(this,Ee,Date.now())),this.mtimeMs=(Bn(this,Ue),Bn(this,He,Date.now())),this.ctimeMs=(Bn(this,je),Bn(this,be,Date.now())),this.ino=(Bn(this,Re),Bn(this,le,$3(0,qa))),this.__ino_old=(Bn(this,ae),Bn(this,$e,0)),this.flags=(Bn(this,ke),Bn(this,At,0)),this.__after_flags=(Bn(this,ft),Bn(this,Bt,0)),this.version=(Bn(this,Ft),Bn(this,xe,0)),this.__padding=(Bn(this,D),Bn(this,me,[])),this.attributes=(Bn(this,De),Bn(this,Ie,new qf)),Bn(this,fe),!!_t){if(!("byteLength"in _t)){Object.assign(this,_t);return}if(_t.byteLength<Ii(yt))throw oE(new Ke(pt.EIO,"Buffer is too small to create an inode"));aE(this,_t)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Zp(this,U3),attributes:this.attributes}}toStats(){return new kd(this)}update(_t){if(!_t)return!1;let z=!1;for(const qe of U3)_t[qe]!==void 0&&(qe=="ino"||qe=="data"||this[qe]!==_t[qe]&&(qe=="atimeMs"&&this.flags&ao.NoAtime||(this[qe]=_t[qe],z=!0)));return _t.attributes&&(this.attributes=_t.attributes,z=!0),z&&(this.ctimeMs=Date.now()),z}};return PO(S,"Inode"),(()=>{const _t=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;C=[(e=qn).uint32.bind(e)],R=[(t=qn).uint32.bind(t)],O=[(n=qn).uint32.bind(n)],H=[(r=qn).uint16.bind(r)],q=[(i=qn).uint32.bind(i)],re=[(s=qn).uint32.bind(s)],te=[(a=qn).uint32.bind(a)],de=[(o=qn).float64.bind(o)],Me=[(l=qn).float64.bind(l)],nt=[(c=qn).float64.bind(c)],Y=[(u=qn).float64.bind(u)],ce=[(d=qn).uint32.bind(d)],Te=[(h=qn).uint32.bind(h)],ot=[(p=qn).uint32.bind(p)],jt=[(y=qn).uint16.bind(y)],tn=[(b=qn).uint32.bind(b)],X=[qn.uint8(48)],we=[xx(qf)],wi(null,null,C,{kind:"field",name:"data",static:!1,private:!1,access:{has:z=>"data"in z,get:z=>z.data,set:(z,qe)=>{z.data=qe}},metadata:_t},E,T),wi(null,null,R,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:z=>"__data_old"in z,get:z=>z.__data_old,set:(z,qe)=>{z.__data_old=qe}},metadata:_t},M,N),wi(null,null,O,{kind:"field",name:"size",static:!1,private:!1,access:{has:z=>"size"in z,get:z=>z.size,set:(z,qe)=>{z.size=qe}},metadata:_t},B,P),wi(null,null,H,{kind:"field",name:"mode",static:!1,private:!1,access:{has:z=>"mode"in z,get:z=>z.mode,set:(z,qe)=>{z.mode=qe}},metadata:_t},F,Q),wi(null,null,q,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:z=>"nlink"in z,get:z=>z.nlink,set:(z,qe)=>{z.nlink=qe}},metadata:_t},K,U),wi(null,null,re,{kind:"field",name:"uid",static:!1,private:!1,access:{has:z=>"uid"in z,get:z=>z.uid,set:(z,qe)=>{z.uid=qe}},metadata:_t},G,ne),wi(null,null,te,{kind:"field",name:"gid",static:!1,private:!1,access:{has:z=>"gid"in z,get:z=>z.gid,set:(z,qe)=>{z.gid=qe}},metadata:_t},se,pe),wi(null,null,de,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:z=>"atimeMs"in z,get:z=>z.atimeMs,set:(z,qe)=>{z.atimeMs=qe}},metadata:_t},Ne,Pe),wi(null,null,Me,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:z=>"birthtimeMs"in z,get:z=>z.birthtimeMs,set:(z,qe)=>{z.birthtimeMs=qe}},metadata:_t},Ee,Ue),wi(null,null,nt,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:z=>"mtimeMs"in z,get:z=>z.mtimeMs,set:(z,qe)=>{z.mtimeMs=qe}},metadata:_t},He,je),wi(null,null,Y,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:z=>"ctimeMs"in z,get:z=>z.ctimeMs,set:(z,qe)=>{z.ctimeMs=qe}},metadata:_t},be,Re),wi(null,null,ce,{kind:"field",name:"ino",static:!1,private:!1,access:{has:z=>"ino"in z,get:z=>z.ino,set:(z,qe)=>{z.ino=qe}},metadata:_t},le,ae),wi(null,null,Te,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:z=>"__ino_old"in z,get:z=>z.__ino_old,set:(z,qe)=>{z.__ino_old=qe}},metadata:_t},$e,ke),wi(null,null,ot,{kind:"field",name:"flags",static:!1,private:!1,access:{has:z=>"flags"in z,get:z=>z.flags,set:(z,qe)=>{z.flags=qe}},metadata:_t},At,ft),wi(null,null,jt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:z=>"__after_flags"in z,get:z=>z.__after_flags,set:(z,qe)=>{z.__after_flags=qe}},metadata:_t},Bt,Ft),wi(null,null,tn,{kind:"field",name:"version",static:!1,private:!1,access:{has:z=>"version"in z,get:z=>z.version,set:(z,qe)=>{z.version=qe}},metadata:_t},xe,D),wi(null,null,X,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:z=>"__padding"in z,get:z=>z.__padding,set:(z,qe)=>{z.__padding=qe}},metadata:_t},me,De),wi(null,null,we,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:z=>"attributes"in z,get:z=>z.attributes,set:(z,qe)=>{z.attributes=qe}},metadata:_t},Ie,fe),wi(null,w={value:S},x,{kind:"class",name:S.name,metadata:_t},null,_),yt=S=w.value,_t&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:_t}),Bn(S,_)})(),yt=S})();function t1e(e){return(e.mode&hi)===Ql}function lc(e){return(e.mode&hi)===fs}function g0(e){return(e.mode&hi)===Cd}function n1e(e){return(e.mode&hi)===Jp}function wx(e){return(e.mode&hi)===Qp}function _x(e){return(e.mode&hi)===em}function r1e(e){return(e.mode&hi)===tm}function ni(e,t,n){const r=(e==null?void 0:e.credentials)||dc.credentials;if(g0(t)||r.euid===0||r.egid===0)return!0;let i=0;return r.uid===t.uid&&(t.mode&LG&&(i|=Cs),t.mode&BG&&(i|=Wi),t.mode&$G&&(i|=QS)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&zG&&(i|=Cs),t.mode&UG&&(i|=Wi),t.mode&qG&&(i|=QS)),t.mode&VG&&(i|=Cs),t.mode&HG&&(i|=Wi),t.mode&WG&&(i|=QS),(i&n)===n}const zB=1;class lC extends Map{constructor(){super(...arguments),this.maxSize=qa}toJSON(){return{version:zB,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*Ii(us);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Ke.With("ENOENT",t);if((n.mode&hi)!=fs)throw Ke.With("ENOTDIR",t);const r={};for(const i of this.keys())$r(i)==t&&i!=t&&(r[m0(i)]=this.get(i).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&hi)!=fs)continue;const i={};for(const s of this.keys())$r(s)==n&&s!=n&&(i[m0(s)]=this.get(s).ino);t.set(n,i)}return t}fromJSON(t){var n;if(t.version!=zB)throw new Ke(pt.EINVAL,"Index version mismatch");this.clear();for(const[r,i]of Object.entries(t.entries))(n=i.data)!==null&&n!==void 0||(i.data=$3(1,qa)),r=="/"&&(i.ino=0),this.set(r,new us(i));return this}static parse(t){if(!cwe(t))throw new Ke(pt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new lC;return r.fromJSON(n),r}}const EI=4096;let DO=class q3{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===q3.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===q3.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:i}=await this.stat(t),{start:s=0,end:a=i}=n;for(let o=s;o<a;o+=EI){const l=o+EI>a?a-o:EI,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let i=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(s,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,s,i).catch(l),!o&&(i+=s.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,i)}).catch(l))}})}};function Na(e){return JSON.parse(EO(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function nl(e){return ap(JSON.stringify(e))}function uh(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Ke(pt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function cC(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Ke(pt.EINVAL,"Invalid time.")}}function In(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Ke(pt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Ke(pt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Ke(pt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:pd(e)}function rd(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:uh("mode"in e?e==null?void 0:e.mode:null,r)}}class i1e{constructor(t,n,r,i){_e(this,"id");_e(this,"_size");_e(this,"options");_e(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),i==null||i.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const i=t-r.offset;r.data.byteLength>i&&(r.data=r.data.subarray(0,i)),r.ranges=r.ranges.filter(s=>s.start<t).map(s=>s.end>t?{start:s.start,end:t}:s)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],i=this.regions[n+1];if(i.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...i.ranges),r.ranges.sort((s,a)=>s.start-a.start),r.ranges=r.ranges.reduce((s,a)=>(!s.length||s.at(-1).end<a.start?s.push(a):s.at(-1).end=Math.max(s.at(-1).end,a.end),s),[]),r.data=bx(r.data,i.offset+i.data.byteLength),r.data.set(i.data,i.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const s of i.ranges)if(!(s.end<=t)&&(s.start>=n||(s.start>t&&r.push({start:t,end:Math.min(s.start,n)}),s.end>t&&(t=Math.max(t,s.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const a of s.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((s,a)=>s.start-a.start);const i=[];for(const s of r){const a=i.at(-1);a&&s.start<=a.end?a.end=Math.max(a.end,s.end):i.push(s)}return i}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,i=this.regionAt(n);if(i)return i.data=bx(i.data,r),i.data.set(t,n),i.ranges.push({start:n,end:r}),i.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const s={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(s):this.regions.splice(a,0,s),this.collect(),this}}var TI,AI,RI;(TI=Promise.withResolvers)!==null&&TI!==void 0||(Promise.withResolvers=(ga("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}}));(AI=Symbol.dispose)!==null&&AI!==void 0||(Symbol.dispose=(ga("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(RI=Symbol.asyncDispose)!==null&&RI!==void 0||(Symbol.asyncDispose=(ga("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class ZG{constructor(t){this.store=t}}class s1e extends ZG{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class V3 extends ZG{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,i;(r=(i=this.store).cache)!==null&&r!==void 0||(i.cache=new Map);const s=this.store.cache.get(t);return s?(n&&(s.size=n.size),s):n?new i1e(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var i;const s=this._cached(t);if(!s)return;r??(r=s.size);const a=s.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw so(Ke.With("EAGAIN",(i=this.store._fs)===null||i===void 0?void 0:i._path(t)));const o=s.regionAt(n);if(!o){ga("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class a1e{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const i=await this.raw.get(t,n,r);return this.stash(t),i}getSync(t,n=0,r){const i=this.raw.getSync(t,n,r);return this.stash(t),i}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const i=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,i),n)}catch(s){if(!(this.raw instanceof V3))throw s;const o=this.raw._cached(t);if(!o)throw s;for(const l of o.cached(n,i??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const i=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,i),n)}catch(s){if(!(this.raw instanceof V3))throw s;const o=this.raw._cached(t);if(!o)throw s;for(const l of o.cached(n,i??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var vi=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},xi=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(a).then(s,function(o){return n(o),s()})}else i|=1}catch(o){n(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class XG extends DO{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[i,s]of this._ids){const a=OG(t,i);if(a.startsWith(".."))continue;let o=Zr(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:i,newKey:o,ino:s})}for(const{oldKey:i,newKey:s,ino:a}of r){this._ids.delete(i),this._ids.set(s,a);const o=this._paths.get(a);if(!o){ga("Missing paths in table for ino "+a);continue}o.delete(i),o.add(s)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,i;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,Iv(this.name+": supports features: "+((i=this.store.flags)===null||i===void 0?void 0:i.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=vi(n,this.transaction(),!0),i=t.directories();for(const[s,a]of t)this._add(a.ino,s),await r.set(a.ino,Qs(a)),i.has(s)&&await r.set(a.data,nl(i.get(s)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=xi(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=vi(n,this.transaction(),!1),i=t.directories();for(const[s,a]of t)this._add(a.ino,s),r.setSync(a.ino,Qs(a)),i.has(s)&&r.setSync(a.data,nl(i.get(s)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{xi(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new lC,i=vi(n,this.transaction(),!0),s=[["/",0]],a=PB(Ke.With("EDEADLK"));for(;s.length;){const[o,l]=s.shift(),c=new us(await i.get(l));if(r.set(o,c),c.mode&fs){const u=Na((t=await i.get(c.data))!==null&&t!==void 0?t:oi(Ke.With("ENODATA",o)));for(const[d,h]of Object.entries(u))s.push([Zr(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=xi(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new lC,i=vi(n,this.transaction(),!1),s=[["/",0]],a=PB(Ke.With("EDEADLK"));for(;s.length;){const[o,l]=s.shift(),c=new us(i.getSync(l));if(r.set(o,c),c.mode&fs){const u=Na((t=i.getSync(c.data))!==null&&t!==void 0?t:oi(Ke.With("ENODATA",o)));for(const[d,h]of Object.entries(u))s.push([Zr(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{xi(n)}}async rename(t,n){var r,i,s;const a={stack:[],error:void 0,hasError:!1};try{const o=vi(a,this.transaction(),!0),l=Oc(t),c=Oc(n),u=await this.findInode(o,l.dir,"rename"),d=Na((r=await o.get(u.data))!==null&&r!==void 0?r:oi(Ke.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Ke.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&so(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ke(pt.EBUSY,l.dir);const p=c.dir==l.dir,y=p?u:await this.findInode(o,c.dir,"rename"),b=p?d:Na((i=await o.get(y.data))!==null&&i!==void 0?i:oi(Ke.With("ENODATA",c.dir,"rename")));if(b[c.base]){const x=new us((s=await o.get(b[c.base]))!==null&&s!==void 0?s:oi(Ke.With("ENOENT",n,"rename")));if(!x.toStats().isFile())throw Ke.With("EPERM",n,"rename");await o.remove(x.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,nl(d)),await o.set(y.data,nl(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=xi(a);o&&await o}}renameSync(t,n){var r,i,s;const a={stack:[],error:void 0,hasError:!1};try{const o=vi(a,this.transaction(),!1),l=Oc(t),c=Oc(n),u=this.findInodeSync(o,l.dir,"rename"),d=Na((r=o.getSync(u.data))!==null&&r!==void 0?r:oi(Ke.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Ke.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&so(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Ke(pt.EBUSY,l.dir);const p=c.dir===l.dir,y=p?u:this.findInodeSync(o,c.dir,"rename"),b=p?d:Na((i=o.getSync(y.data))!==null&&i!==void 0?i:oi(Ke.With("ENODATA",c.dir,"rename")));if(b[c.base]){const x=new us((s=o.getSync(b[c.base]))!==null&&s!==void 0?s:oi(Ke.With("ENOENT",n,"rename")));if(!x.toStats().isFile())throw Ke.With("EPERM",n,"rename");o.removeSync(x.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,nl(d)),o.setSync(y.data,nl(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{xi(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=vi(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=xi(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=vi(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{xi(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=vi(r,this.transaction(),!0),s=await this.findInode(i,t,"touch");s.update(n)&&(this._add(s.ino,t),i.setSync(s.ino,Qs(s))),await i.commit()}catch(i){r.error=i,r.hasError=!0}finally{const i=xi(r);i&&await i}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=vi(r,this.transaction(),!1),s=this.findInodeSync(i,t,"touch");s.update(n)&&(this._add(s.ino,t),i.setSync(s.ino,Qs(s))),i.commitSync()}catch(i){r.error=i,r.hasError=!0}finally{xi(r)}}async createFile(t,n){return n.mode|=Ql,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Ql,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Ke.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Ke.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=fs,await this.commitNew(t,n,ap("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=fs,this.commitNewSync(t,n,ap("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const i=vi(r,this.transaction(),!0),s=await this.findInode(i,t,"readdir");return Object.keys(Na((n=await i.get(s.data))!==null&&n!==void 0?n:oi(Ke.With("ENOENT",t,"readdir"))))}catch(i){r.error=i,r.hasError=!0}finally{const i=xi(r);i&&await i}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const i=vi(r,this.transaction(),!1),s=this.findInodeSync(i,t,"readdir");return Object.keys(Na((n=i.getSync(s.data))!==null&&n!==void 0?n:oi(Ke.With("ENOENT",t,"readdir"))))}catch(i){r.error=i,r.hasError=!0}finally{xi(r)}}async sync(t,n,r){const i={stack:[],error:void 0,hasError:!1};try{const s=vi(i,this.transaction(),!0),a=await this.findInode(s,t,"sync");n&&await s.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await s.set(a.ino,Qs(a))),await s.commit()}catch(s){i.error=s,i.hasError=!0}finally{const s=xi(i);s&&await s}}syncSync(t,n,r){const i={stack:[],error:void 0,hasError:!1};try{const s=vi(i,this.transaction(),!1),a=this.findInodeSync(s,t,"sync");n&&s.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),s.setSync(a.ino,Qs(a))),s.commitSync()}catch(s){i.error=s,i.hasError=!0}finally{xi(i)}}async link(t,n){var r;const i={stack:[],error:void 0,hasError:!1};try{const s=vi(i,this.transaction(),!0),a=$r(n),o=await this.findInode(s,a,"link"),l=Na((r=await s.get(o.data))!==null&&r!==void 0?r:oi(Ke.With("ENOENT",a,"link"))),c=await this.findInode(s,t,"link");c.nlink++,l[m0(n)]=c.ino,this._add(c.ino,n),await s.set(c.ino,Qs(c)),await s.set(o.data,nl(l)),await s.commit()}catch(s){i.error=s,i.hasError=!0}finally{const s=xi(i);s&&await s}}linkSync(t,n){var r;const i={stack:[],error:void 0,hasError:!1};try{const s=vi(i,this.transaction(),!1),a=$r(n),o=this.findInodeSync(s,a,"link"),l=Na((r=s.getSync(o.data))!==null&&r!==void 0?r:oi(Ke.With("ENOENT",a,"link"))),c=this.findInodeSync(s,t,"link");c.nlink++,l[m0(n)]=c.ino,this._add(c.ino,n),s.setSync(c.ino,Qs(c)),s.setSync(o.data,nl(l)),s.commitSync()}catch(s){i.error=s,i.hasError=!0}finally{xi(i)}}async read(t,n,r,i){var s;const a={stack:[],error:void 0,hasError:!1};try{const o=vi(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(s=await o.get(l.data,r,i))!==null&&s!==void 0?s:oi(Ke.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,i);u.byteLength>n.byteLength&&so(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=xi(a);o&&await o}}readSync(t,n,r,i){var s;const a={stack:[],error:void 0,hasError:!1};try{const o=vi(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(s=o.getSync(l.data,r,i))!==null&&s!==void 0?s:oi(Ke.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,i);u.byteLength>n.byteLength&&so(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{xi(a)}}async write(t,n,r){var i;const s={stack:[],error:void 0,hasError:!1};try{const a=vi(s,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=bx((i=await a.get(o.data))!==null&&i!==void 0?i:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){s.error=a,s.hasError=!0}finally{const a=xi(s);a&&await a}}writeSync(t,n,r){var i;const s={stack:[],error:void 0,hasError:!1};try{const a=vi(s,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=bx((i=a.getSync(o.data))!==null&&i!==void 0?i:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){s.error=a,s.hasError=!0}finally{xi(s)}}transaction(){return new a1e(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=vi(t,this.transaction(),!0);if(await n.get(Io))return;const r=new us({ino:Io,data:1,mode:511|fs});await n.set(r.data,ap("{}")),this._add(Io,"/"),await n.set(Io,Qs(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=xi(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=vi(t,this.transaction(),!1);if(n.getSync(Io))return;const r=new us({ino:Io,data:1,mode:511|fs});n.setSync(r.data,ap("{}")),this._add(Io,"/"),n.setSync(Io,Qs(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{xi(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){ga("Attempted to populate tables after initialization");return}Iv("Populating tables with existing store metadata");const n=vi(t,this.transaction(),!0),r=await n.get(Io);if(!r){MO("Store does not have a root inode");const o=new us({ino:Io,data:1,mode:511|fs});await n.set(o.data,ap("{}")),this._add(Io,"/"),await n.set(Io,Qs(o)),await n.commit();return}if(r.length<Ii(us)){oE("Store contains an invalid root inode. Refusing to populate tables");return}const i=new Set;let s=0;const a=[["/",Io]];for(;a.length>0;){s++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){ga("Store is missing data for inode: "+l);continue}if(c.length<Ii(us)){ga(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new us(c);if((u.mode&fs)!=fs||i.has(l))continue;i.add(l);const d=await n.get(u.data);if(!d){ga("Store is missing directory data: "+u.data);continue}const h=Na(d);for(const[p,y]of Object.entries(h))a.push([Zr(o,p),y])}Iv(`Added ${s} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=xi(t);n&&await n}}async findInode(t,n,r){var i;const s=this._ids.get(n);if(s===void 0)throw Ke.With("ENOENT",n,r);return new us((i=await t.get(s))!==null&&i!==void 0?i:oi(Ke.With("ENOENT",n,r)))}findInodeSync(t,n,r){var i;const s=this._ids.get(n);if(s===void 0)throw Ke.With("ENOENT",n,r);return new us((i=t.getSync(s))!==null&&i!==void 0?i:oi(Ke.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const i=this._lastID;if(i>qa)throw so(new Ke(pt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(i,t),i}async commitNew(t,n,r,i){var s;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ke.With("EEXIST",t,i);const o=vi(a,this.transaction(),!0),{dir:l,base:c}=Oc(t),u=await this.findInode(o,l,i),d=Na((s=await o.get(u.data))!==null&&s!==void 0?s:oi(Ke.With("ENOENT",l,i)));if(d[c])throw Ke.With("EEXIST",t,i);const h=this.allocNew(t,i),p=new us({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(p.ino,Qs(p)),await o.set(p.data,r),d[c]=p.ino,await o.set(u.data,nl(d)),await o.commit(),p}catch(o){a.error=o,a.hasError=!0}finally{const o=xi(a);o&&await o}}commitNewSync(t,n,r,i){var s;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Ke.With("EEXIST",t,i);const o=vi(a,this.transaction(),!1),{dir:l,base:c}=Oc(t),u=this.findInodeSync(o,l,i),d=Na((s=o.getSync(u.data))!==null&&s!==void 0?s:oi(Ke.With("ENOENT",l,i)));if(d[c])throw Ke.With("EEXIST",t,i);const h=this.allocNew(t,i),p=new us({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(p.ino,Qs(p)),o.setSync(p.data,r),d[c]=p.ino,o.setSync(u.data,nl(d)),o.commitSync(),p}catch(o){a.error=o,a.hasError=!0}finally{xi(a)}}async remove(t,n){var r,i;const s={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=vi(s,this.transaction(),!0),{dir:l,base:c}=Oc(t),u=await this.findInode(o,l,a),d=Na((r=await o.get(u.data))!==null&&r!==void 0?r:oi(Ke.With("ENOENT",l,a)));if(!d[c])throw Ke.With("ENOENT",t,a);const h=d[c],p=new us((i=await o.get(h))!==null&&i!==void 0?i:oi(Ke.With("ENOENT",t,a)));if(delete d[c],!n&&lc(p))throw Ke.With("EISDIR",t,a);await o.set(u.data,nl(d)),p.nlink>1?(p.update({nlink:p.nlink-1}),await o.set(p.ino,Qs(p))):(await o.remove(p.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){s.error=a,s.hasError=!0}finally{const a=xi(s);a&&await a}}removeSync(t,n){var r,i;const s={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=vi(s,this.transaction(),!1),{dir:l,base:c}=Oc(t),u=this.findInodeSync(o,l,a),d=Na((r=o.getSync(u.data))!==null&&r!==void 0?r:oi(Ke.With("ENOENT",l,a))),h=d[c];if(!h)throw Ke.With("ENOENT",t,a);const p=new us((i=o.getSync(h))!==null&&i!==void 0?i:oi(Ke.With("ENOENT",t,a)));if(delete d[c],!n&&lc(p))throw Ke.With("EISDIR",t,a);o.setSync(u.data,nl(d)),p.nlink>1?(p.update({nlink:p.nlink-1}),o.setSync(p.ino,Qs(p))):(o.removeSync(p.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){s.error=a,s.hasError=!0}finally{xi(s)}}}class o1e extends s1e{async keys(){return this.store.keys()}async get(t){var n,r,i;return await((i=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&i!==void 0?i:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class l1e extends Map{constructor(t=qa,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new o1e(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const c1e={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new XG(new l1e(e,t));return n.checkRootSync(),n}},u1e=c1e;let ks=!0;class UB extends CO{get cursor(){return this._cursor}constructor(t,n,r,i=!1){super(),this.input=t,this.output=n,this.terminal=i,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=s=>{if(!(this._paused||this._closed)){this._buffer+=typeof s=="string"?s:s.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;rl(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;rl(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);nS(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);nS(this.output,0),rl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const i=this.line.slice(0,r+1)+this.line.slice(this._cursor),s=r+1;this._renderLine(i),this._cursor=s,this._cursor=s,rl(this.output,-i.length,0),rl(this.output,s,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const i=Math.max(0,Math.min(this.line.length,this._cursor+r));if(i==this._cursor)return;rl(this.output,r,0),this._cursor=i,this._cursor=i;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(rl(this.output,-this._cursor,0),rl(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);nS(this.output,0),rl(this.output,0,0),this.output.write(this._prompt+r),this.line=r,rl(this.output,-r.length,0),rl(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&(nS(this.output,0),rl(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const i=typeof n=="function"?n:r;if(this._closed||!this.output){i("");return}this.output.write(t),this.once("line",i)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return ga("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return ga("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",i=>n({value:i,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function d1e(e,t,n,r){return"input"in e?new UB(e.input,e.output,e.completer,e.terminal):new UB(e,t,n,r)}function nS(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function rl(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class uC{get position(){return this.flag&Dp?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,i,s,a){this.context=t,this.path=n,this.fs=r,this.internalPath=i,this.flag=s,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&dE||this.inode.flags&ao.Sync)}sync(){if(this.closed)throw Ke.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Ke.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Ke.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ke.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Ke.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Ke.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&ma||this.flag&nd))throw new Ke(pt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,i=this.position){if(this.closed)throw Ke.With("EBADF",this.path,"write");if(!(this.flag&ma||this.flag&nd))throw new Ke(pt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&ao.Immutable)throw new Ke(pt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const s=i+r,a=t.subarray(n,n+r);return!_x(this.inode)&&!wx(this.inode)&&s>this.inode.size&&(this.inode.size=s),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=i+a.byteLength,this.fs.writeSync(this.internalPath,a,i),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,i=this.position){if(this.closed)throw Ke.With("EBADF",this.path,"read");if(this.flag&ma)throw new Ke(pt.EPERM,"File not opened with a readable mode");this.inode.flags&ao.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let s=i+r;!_x(this.inode)&&!wx(this.inode)&&s>this.inode.size&&(s=i+Math.max(this.inode.size-i,0)),this._position=s;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),i,s),this._isSync&&this.sync(),s-i}chmod(t){if(this.closed)throw Ke.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>hi?-61441:hi)|t,(this._isSync||t>hi)&&this.sync()}chown(t,n){if(this.closed)throw Ke.With("EBADF",this.path,"chown");this.dirty=!0,YG(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Ke.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Ke.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Ke.With("EBADF",this.path,"streamWrite");if(this.inode.flags&ao.Immutable)throw new Ke(pt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function dC(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:dc.descriptors,i=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(i,e),i}function ka(e,t){var n;const i=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:dc.descriptors).get(t);if(!i)throw new Ke(pt.EBADF);return i}function JG(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:dc.descriptors).delete(t)}const f1e=/[rwasx]{1,2}\+?/;function id(e){if(typeof e=="number")return e;if(!f1e.test(e))throw new Ke(pt.EINVAL,"Invalid flag string: "+e);return h1e(e)}function h1e(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Ke(pt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?FG:lE;return e.includes("w")&&(t|=uE),e.includes("a")&&(t|=Dp),e.includes("+")?t|=nd:e.includes("r")||(t|=ma),e.includes("s")&&(t|=dE),e.includes("x")&&(t|=cE),t}function QG(e){let t=0;return e&ma||(t|=Cs),(e&ma||e&nd)&&(t|=Wi),t}const Sx=new Map;FO("/",u1e.create({label:"root"}));function FO(e,t){if(e[0]!="/"&&(e="/"+e),e=pd.call(this,e),Sx.has(e))throw so(new Ke(pt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,Sx.set(e,t),PG(`Mounted ${t.name} on ${e}`),Iv(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function eK(e){if(e[0]!="/"&&(e="/"+e),e=pd.call(this,e),!Sx.has(e)){ga(e+" is already unmounted");return}Sx.delete(e),MO("Unmounted "+e)}function _r(e,t){const n=(t==null?void 0:t.root)||dc.root;e=In(Zr(n,e));const r=[...Sx].sort((i,s)=>i[0].length>s[0].length?-1:1);for(const[i,s]of r)if(m1e(i,e))return e=e.slice(i.length>1?i.length:0),e===""&&(e=n),{fs:s,path:e,mountPoint:i,root:n};throw kwe(new Ke(pt.EIO,"No file system",e))}function II(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function ri(e,t){typeof e.stack=="string"&&(e.stack=II(e.stack,t));try{e.message=II(e.message,t)}catch{}return e.path&&(e.path=II(e.path,t)),e}function tK(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||qa),files:(t?BigInt:Number)(n.totalNodes||qa),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function p1e(e){var t,n,r,i,s,a,o;const l=this!==null&&this!==void 0?this:dc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((i=l.credentials)===null||i===void 0?void 0:i.egid)!==0)throw new Ke(pt.EPERM,"Can not chroot() as non-root user");(s=l.root)!==null&&s!==void 0||(l.root="/");const c=Zr(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Ke.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Ke(pt.EPERM,"Can not chroot() outside of current root");l.root=c}function m1e(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class nK extends CO{off(t,n,r,i){return super.off(t,n,r,i)}removeListener(t,n,r,i){return super.removeListener(t,n,r,i)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Ke.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Ke.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Ke.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Ke.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Ke.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class rK extends nK{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?Zr(t.root,n):n,y1e(this.realpath,this)}close(){super.emit("close"),b1e(this.realpath,this)}[Symbol.dispose](){this.close()}}class g1e extends nK{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=Vf(this.path);Zwe(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=Vf(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const kf=new Map;function y1e(e,t){const n=In(e);kf.has(n)||kf.set(n,new Set),kf.get(n).add(t)}function b1e(e,t){const n=In(e);kf.has(n)&&(kf.get(n).delete(t),kf.get(n).size===0&&kf.delete(n))}function ia(e,t,n){var r;e&&(n=Zr((r=e.root)!==null&&r!==void 0?r:"/",n)),n=In(n);for(let i=n;i!="/";i=$r(i)){const s=kf.get(i);if(s)for(const a of s)a.emit("change",t,OG.call(a._context,i,n)||m0(n))}}var Dw=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},Fw=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(a).then(s,function(o){return n(o),s()})}else i|=1}catch(o){n(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function v1e(e,t){e=In(e),t=In(t);const n=_r(e,this),r=_r(t,this);if(!Vf.call(this,$r(e)).hasAccess(Wi,this))throw Ke.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),ia(this,"rename",e.toString()),ia(this,"change",t.toString());return}UO.call(this,t,zO(e)),$O.call(this,e),ia(this,"rename",e.toString())}catch(i){throw ri(i,{[n.path]:e,[r.path]:t})}}function LO(e){e=In(e);try{const{fs:t,path:n}=_r(dh.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==pt.ENOENT)return!1;throw t}}function Vf(e,t){e=In(e);const{fs:n,path:r}=_r(dh.call(this,e),this);try{const i=n.statSync(r);if(ks&&!ni(this,i,Cs))throw Ke.With("EACCES",r,"stat");return t!=null&&t.bigint?new nm(i):new kd(i)}catch(i){throw ri(i,{[r]:e})}}function BO(e,t){e=In(e);const{fs:n,path:r}=_r(e,this);try{const i=n.statSync(r);if(ks&&!ni(this,i,Cs))throw Ke.With("EACCES",r,"lstat");return t!=null&&t.bigint?new nm(i):new kd(i)}catch(i){throw ri(i,{[r]:e})}}function x1e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=Dw(n,rm.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Ke(pt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{Fw(n)}}function $O(e){e=In(e);const{fs:t,path:n}=_r(e,this);try{if(ks&&!ni(this,t.statSync(n),Wi))throw Ke.With("EACCES",n,"unlink");t.unlinkSync(n),ia(this,"rename",e.toString())}catch(r){throw ri(r,{[n]:e})}}function rm(e,t){var n;e=In(e);const r=uh(t.mode,420),i=id(t.flag);e=t.preserveSymlinks?e:dh.call(this,e);const{fs:s,path:a}=_r(e,this);let o;try{o=s.statSync(a)}catch{}if(!o){if(!(i&lE))throw Ke.With("ENOENT",e,"_open");const c=s.statSync($r(a));if(!ni(this,c,Wi))throw Ke.With("EACCES",$r(e),"_open");if(!lc(c))throw Ke.With("ENOTDIR",$r(e),"_open");if(!t.allowDirectory&&r&fs)throw Ke.With("EISDIR",e,"_open");if(!ni(this,c,Wi))throw Ke.With("EACCES",$r(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:dc.credentials,h=s.createFileSync(a,{mode:r,uid:c.mode&Ow?c.uid:u,gid:c.mode&Pw?c.gid:d});return new uC(this,e,s,a,i,h)}if(!ni(this,o,r)||!ni(this,o,QG(i)))throw Ke.With("EACCES",e,"_open");if(i&cE)throw Ke.With("EEXIST",e,"_open");const l=new uC(this,e,s,a,i,o);if(i&uE&&l.truncate(0),!t.allowDirectory&&o.mode&fs)throw Ke.With("EISDIR",e,"_open");return l}function fE(e,t,n=jO){return dC(rm.call(this,e,{flag:t,mode:n}))}function hE(e,t,n){return dC(rm.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function iK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=Dw(r,typeof e=="number"?ka(this,e):rm.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:s}=i.stat(),a=new Uint8Array(s);return i.read(a,0,s,0),a}catch(i){r.error=i,r.hasError=!0}finally{Fw(r)}}function zO(e,t={}){const n=rd(t,null,"r",420);if(id(n.flag)&ma)throw new Ke(pt.EINVAL,"Flag passed to readFile must allow for reading");const i=Si.from(iK.call(this,e,n.flag,!1));return n.encoding?i.toString(n.encoding):i}function UO(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const i=rd(n,"utf8","w+",420),s=id(i.flag);if(!(s&ma||s&nd))throw new Ke(pt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!i.encoding)throw new Ke(pt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Si.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Ke(pt.EINVAL,"Data not specified");Dw(r,typeof e=="number"?ka(this,e):rm.call(this,e.toString(),{flag:s,mode:i.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),ia(this,"change",e.toString())}catch(i){r.error=i,r.hasError=!0}finally{Fw(r)}}function w1e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const i=rd(n,"utf8","a+",420),s=id(i.flag);if(!(s&Dp))throw new Ke(pt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!i.encoding)throw new Ke(pt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Si.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);Dw(r,rm.call(this,typeof e=="number"?ka(this,e).path:e.toString(),{flag:s,mode:i.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(i){r.error=i,r.hasError=!0}finally{Fw(r)}}function _1e(e,t){const n=ka(this,e).stat();return t!=null&&t.bigint?new nm(n):new kd(n)}function im(e){ka(this,e).close(),JG(this,e)}function S1e(e,t=0){if(t||(t=0),t<0)throw new Ke(pt.EINVAL);ka(this,e).truncate(t)}function C1e(e){ka(this,e).sync()}function k1e(e){ka(this,e).datasync()}function E1e(e,t,n,r,i){let s,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,s=Si.from(t,d),o=s.byteLength}else s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof i=="number"?i:null;const c=ka(this,e);l??(l=c.position);const u=c.write(s,a,o,l);return ia(this,"change",c.path),u}function T1e(e,t,n,r,i){const s=ka(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,i=n.position),i=Number(i),isNaN(i)&&(i=s.position),s.read(t,a,r,i)}function qO(e,t,n){ka(this,e).chown(t,n)}function VO(e,t){const n=uh(t,-1);if(n<0)throw new Ke(pt.EINVAL,"Invalid mode.");ka(this,e).chmod(n)}function HO(e,t,n){ka(this,e).utimes(cC(t),cC(n))}function sK(e){e=In(e);const{fs:t,path:n}=_r(dh.call(this,e),this);try{const r=t.statSync(n);if(!lc(r))throw Ke.With("ENOTDIR",n,"rmdir");if(ks&&!ni(this,r,Wi))throw Ke.With("EACCES",n,"rmdir");t.rmdirSync(n),ia(this,"rename",e.toString())}catch(r){throw ri(r,{[n]:e})}}function WO(e,t){var n,r;const{euid:i,egid:s}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:dc.credentials;t=typeof t=="object"?t:{mode:t};const a=uh(t==null?void 0:t.mode,511);e=dh.call(this,e);const{fs:o,path:l,root:c}=_r(e,this),u={[l]:e},d=(h,p)=>{if(!ni(this,p,Wi))throw Ke.With("EACCES",$r(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:p.mode&Ow?p.uid:i,gid:p.mode&Pw?p.gid:s});return ia(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync($r(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=$r(y),b=$r(b))h.unshift(y),u[y]=b;if(!h.length)return;const p=[o.statSync($r(h[0]))];for(const[y,b]of h.entries())p.push(d(b,p[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ri(h,u)}}function ny(e,t){t=typeof t=="object"?t:{encoding:t},e=In(e);const{fs:n,path:r}=_r(dh.call(this,e),this);let i;try{const a=n.statSync(r);if(ks&&!ni(this,a,Cs))throw Ke.With("EACCES",r,"readdir");if(!lc(a))throw Ke.With("ENOTDIR",r,"readdir");i=n.readdirSync(r)}catch(a){throw ri(a,{[r]:e})}const s=[];for(const a of i){let o;try{o=n.statSync(Zr(r,a))}catch{continue}if(t!=null&&t.withFileTypes?s.push(new Cx(a,o)):(t==null?void 0:t.encoding)=="buffer"?s.push(Si.from(a)):s.push(a),!(!lc(o)||!(t!=null&&t.recursive)))for(const l of ny.call(this,Zr(e,a),t))l instanceof Cx?(l.path=Zr(a,l.path),s.push(l)):Si.isBuffer(l)?s.push(Si.from(Zr(a,EO(l)))):s.push(Zr(a,l))}return s}function A1e(e,t){if(e=In(e),!Vf($r(e)).hasAccess(Cs,this))throw Ke.With("EACCES",$r(e),"link");if(t=In(t),!Vf($r(t)).hasAccess(Wi,this))throw Ke.With("EACCES",$r(t),"link");const{fs:n,path:r}=_r(e,this),i=_r(t,this);if(n!=i.fs)throw Ke.With("EXDEV",t,"link");try{if(ks&&!ni(this,n.statSync(r),Cs))throw Ke.With("EACCES",r,"link");return n.linkSync(r,i.path)}catch(s){throw ri(s,{[r]:e,[i.path]:t})}}function R1e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ke(pt.EINVAL,"Invalid type: "+n);t=In(t);const i=Dw(r,rm.call(this,t,{flag:"wx",mode:420}),!1);i.write(ap(In(e,!0))),i.chmod(Cd)}catch(i){r.error=i,r.hasError=!0}finally{Fw(r)}}function H3(e,t){const n=Si.from(iK.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function I1e(e,t,n){const r=fE.call(this,e,"r+");qO.call(this,r,t,n),im.call(this,r)}function M1e(e,t,n){const r=hE.call(this,e,"r+");qO.call(this,r,t,n),im.call(this,r)}function N1e(e,t){const n=fE.call(this,e,"r+");VO.call(this,n,t),im.call(this,n)}function j1e(e,t){const n=hE.call(this,e,"r+");VO.call(this,n,t),im.call(this,n)}function aK(e,t,n){const r=fE.call(this,e,"r+");HO.call(this,r,t,n),im.call(this,r)}function O1e(e,t,n){const r=hE.call(this,e,"r+");HO.call(this,r,t,n),im.call(this,r)}function W3(e,t,n){try{const l=_r(t,e),c=l.fs.statSync(l.path);if(!g0(c))return{...l,fullPath:t,stats:c};const u=pd.call(e,$r(t),H3.call(e,t).toString());return W3(e,u)}catch{}const{base:r,dir:i}=Oc(t),s=i=="/"?"/":dh.call(e,i),a=Zr(s,r),o=_r(a,e);try{const l=o.fs.statSync(o.path);if(!g0(l))return{...o,fullPath:a,stats:l};const c=pd.call(e,s,H3.call(e,a).toString());return W3(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ri(l,{[o.path]:a})}}function dh(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=In(e);const{fullPath:i}=W3(this,e);if(r=="utf8"||r=="utf-8")return i;const s=Si.from(i,"utf-8");return r=="buffer"?s:s.toString(r)}function P1e(e,t=384){if(!ni(this,Vf.call(this,e),t))throw new Ke(pt.EACCES)}function oK(e,t){e=In(e);let n;try{n=BO.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&hi){case fs:if(t!=null&&t.recursive)for(const r of ny.call(this,e))oK.call(this,Zr(e,r),t);sK.call(this,e);break;case Ql:case Cd:case Qp:case em:$O.call(this,e);break;case tm:case Jp:default:throw new Ke(pt.EPERM,"File type not supported",e,"rm")}}function D1e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",i="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return WO.call(this,i),n=="buffer"?Si.from(i):i}function lK(e,t,n){if(e=In(e),t=In(t),n&&n&OO&&LO(t))throw new Ke(pt.EEXIST,"Destination file already exists",t,"copyFile");UO.call(this,t,zO(e)),ia(this,"rename",t.toString())}function F1e(e,t,n){const r=ka(this,e);let i=0;for(const s of t)i+=r.read(s,0,s.byteLength,n+i);return i}function L1e(e,t,n){const r=ka(this,e);let i=0;for(const s of t)i+=r.write(new Uint8Array(s.buffer),0,s.byteLength,n+i);return i}function B1e(e,t){return e=In(e),new GO(e,this)}function cK(e,t,n){e=In(e),t=In(t);const r=BO.call(this,e);if(n!=null&&n.errorOnExist&&LO.call(this,t))throw new Ke(pt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&hi){case fs:if(!(n!=null&&n.recursive))throw new Ke(pt.EISDIR,e+" is a directory (not copied)",e,"cp");WO.call(this,t,{recursive:!0});for(const i of ny.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(Zr(e,i.name),Zr(t,i.name))||cK.call(this,Zr(e,i.name),Zr(t,i.name),n);break;case Ql:case Cd:lK.call(this,e,t);break;case Qp:case em:case tm:case Jp:default:throw new Ke(pt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&aK.call(this,t,r.atime,r.mtime)}function $1e(e,t){e=In(e);const{fs:n}=_r(e,this);return tK(n,t==null?void 0:t.bigint)}function z1e(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:i=()=>!1}=t,s=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=ny(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;i(r?u:d)||(Vf(d).isDirectory()&&s.some(h=>h.source.includes(".*"))&&o(d),s.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class Cx{get name(){return m0(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return t1e(this.stats)}isDirectory(){return lc(this.stats)}isBlockDevice(){return wx(this.stats)}isCharacterDevice(){return _x(this.stats)}isSymbolicLink(){return g0(this.stats)}isFIFO(){return r1e(this.stats)}isSocket(){return n1e(this.stats)}}class GO{checkClosed(){if(this.closed)throw new Ke(pt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await am.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=ny.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var MI={exports:{}},NI={exports:{}},jI={},qB;function fh(){return qB||(qB=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],i=[],s=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],i[a.charCodeAt(o)]=o;i[45]=62,i[95]=63;function c(_){var S=_.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var C=_.indexOf("=");C===-1&&(C=S);var E=C===S?0:4-C%4;return[C,E]}function u(_){var S=c(_),C=S[0],E=S[1];return(C+E)*3/4-E}function d(_,S,C){return(S+C)*3/4-C}function h(_){var S,C=c(_),E=C[0],T=C[1],R=new s(d(_,E,T)),M=0,N=T>0?E-4:E,O;for(O=0;O<N;O+=4)S=i[_.charCodeAt(O)]<<18|i[_.charCodeAt(O+1)]<<12|i[_.charCodeAt(O+2)]<<6|i[_.charCodeAt(O+3)],R[M++]=S>>16&255,R[M++]=S>>8&255,R[M++]=S&255;return T===2&&(S=i[_.charCodeAt(O)]<<2|i[_.charCodeAt(O+1)]>>4,R[M++]=S&255),T===1&&(S=i[_.charCodeAt(O)]<<10|i[_.charCodeAt(O+1)]<<4|i[_.charCodeAt(O+2)]>>2,R[M++]=S>>8&255,R[M++]=S&255),R}function p(_){return r[_>>18&63]+r[_>>12&63]+r[_>>6&63]+r[_&63]}function y(_,S,C){for(var E,T=[],R=S;R<C;R+=3)E=(_[R]<<16&16711680)+(_[R+1]<<8&65280)+(_[R+2]&255),T.push(p(E));return T.join("")}function b(_){for(var S,C=_.length,E=C%3,T=[],R=16383,M=0,N=C-E;M<N;M+=R)T.push(y(_,M,M+R>N?N:M+R));return E===1?(S=_[C-1],T.push(r[S>>2]+r[S<<4&63]+"==")):E===2&&(S=(_[C-2]<<8)+_[C-1],T.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),T.join("")}var x={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */x.read=function(_,S,C,E,T){var R,M,N=T*8-E-1,O=(1<<N)-1,B=O>>1,P=-7,H=C?T-1:0,F=C?-1:1,Q=_[S+H];for(H+=F,R=Q&(1<<-P)-1,Q>>=-P,P+=N;P>0;R=R*256+_[S+H],H+=F,P-=8);for(M=R&(1<<-P)-1,R>>=-P,P+=E;P>0;M=M*256+_[S+H],H+=F,P-=8);if(R===0)R=1-B;else{if(R===O)return M?NaN:(Q?-1:1)*(1/0);M=M+Math.pow(2,E),R=R-B}return(Q?-1:1)*M*Math.pow(2,R-E)},x.write=function(_,S,C,E,T,R){var M,N,O,B=R*8-T-1,P=(1<<B)-1,H=P>>1,F=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,Q=E?0:R-1,q=E?1:-1,K=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(N=isNaN(S)?1:0,M=P):(M=Math.floor(Math.log(S)/Math.LN2),S*(O=Math.pow(2,-M))<1&&(M--,O*=2),M+H>=1?S+=F/O:S+=F*Math.pow(2,1-H),S*O>=2&&(M++,O/=2),M+H>=P?(N=0,M=P):M+H>=1?(N=(S*O-1)*Math.pow(2,T),M=M+H):(N=S*Math.pow(2,H-1)*Math.pow(2,T),M=0));T>=8;_[C+Q]=N&255,Q+=q,N/=256,T-=8);for(M=M<<T|N,B+=T;B>0;_[C+Q]=M&255,Q+=q,M/=256,B-=8);_[C+Q-q]|=K*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(_){const S=n,C=x,E=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;_.Buffer=P,_.SlowBuffer=se,_.INSPECT_MAX_BYTES=50;const T=2147483647;_.kMaxLength=T;const{Uint8Array:R,ArrayBuffer:M,SharedArrayBuffer:N}=globalThis;P.TYPED_ARRAY_SUPPORT=O(),!P.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function O(){try{const Z=new R(1),W={foo:function(){return 42}};return Object.setPrototypeOf(W,R.prototype),Object.setPrototypeOf(Z,W),Z.foo()===42}catch{return!1}}Object.defineProperty(P.prototype,"parent",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.buffer}}),Object.defineProperty(P.prototype,"offset",{enumerable:!0,get:function(){if(P.isBuffer(this))return this.byteOffset}});function B(Z){if(Z>T)throw new RangeError('The value "'+Z+'" is invalid for option "size"');const W=new R(Z);return Object.setPrototypeOf(W,P.prototype),W}function P(Z,W,J){if(typeof Z=="number"){if(typeof W=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return q(Z)}return H(Z,W,J)}P.poolSize=8192;function H(Z,W,J){if(typeof Z=="string")return K(Z,W);if(M.isView(Z))return re(Z);if(Z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z);if(ve(Z,M)||Z&&ve(Z.buffer,M)||typeof N<"u"&&(ve(Z,N)||Z&&ve(Z.buffer,N)))return G(Z,W,J);if(typeof Z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ye=Z.valueOf&&Z.valueOf();if(ye!=null&&ye!==Z)return P.from(ye,W,J);const Oe=ne(Z);if(Oe)return Oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Z[Symbol.toPrimitive]=="function")return P.from(Z[Symbol.toPrimitive]("string"),W,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z)}P.from=function(Z,W,J){return H(Z,W,J)},Object.setPrototypeOf(P.prototype,R.prototype),Object.setPrototypeOf(P,R);function F(Z){if(typeof Z!="number")throw new TypeError('"size" argument must be of type number');if(Z<0)throw new RangeError('The value "'+Z+'" is invalid for option "size"')}function Q(Z,W,J){return F(Z),Z<=0?B(Z):W!==void 0?typeof J=="string"?B(Z).fill(W,J):B(Z).fill(W):B(Z)}P.alloc=function(Z,W,J){return Q(Z,W,J)};function q(Z){return F(Z),B(Z<0?0:te(Z)|0)}P.allocUnsafe=function(Z){return q(Z)},P.allocUnsafeSlow=function(Z){return q(Z)};function K(Z,W){if((typeof W!="string"||W==="")&&(W="utf8"),!P.isEncoding(W))throw new TypeError("Unknown encoding: "+W);const J=pe(Z,W)|0;let ye=B(J);const Oe=ye.write(Z,W);return Oe!==J&&(ye=ye.slice(0,Oe)),ye}function U(Z){const W=Z.length<0?0:te(Z.length)|0,J=B(W);for(let ye=0;ye<W;ye+=1)J[ye]=Z[ye]&255;return J}function re(Z){if(ve(Z,R)){const W=new R(Z);return G(W.buffer,W.byteOffset,W.byteLength)}return U(Z)}function G(Z,W,J){if(W<0||Z.byteLength<W)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<W+(J||0))throw new RangeError('"length" is outside of buffer bounds');let ye;return W===void 0&&J===void 0?ye=new R(Z):J===void 0?ye=new R(Z,W):ye=new R(Z,W,J),Object.setPrototypeOf(ye,P.prototype),ye}function ne(Z){if(P.isBuffer(Z)){const W=te(Z.length)|0,J=B(W);return J.length===0||Z.copy(J,0,0,W),J}if(Z.length!==void 0)return typeof Z.length!="number"||Se(Z.length)?B(0):U(Z);if(Z.type==="Buffer"&&Array.isArray(Z.data))return U(Z.data)}function te(Z){if(Z>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return Z|0}function se(Z){return+Z!=Z&&(Z=0),P.alloc(+Z)}P.isBuffer=function(W){return W!=null&&W._isBuffer===!0&&W!==P.prototype},P.compare=function(W,J){if(ve(W,R)&&(W=P.from(W,W.offset,W.byteLength)),ve(J,R)&&(J=P.from(J,J.offset,J.byteLength)),!P.isBuffer(W)||!P.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(W===J)return 0;let ye=W.length,Oe=J.length;for(let We=0,vt=Math.min(ye,Oe);We<vt;++We)if(W[We]!==J[We]){ye=W[We],Oe=J[We];break}return ye<Oe?-1:Oe<ye?1:0},P.isEncoding=function(W){switch(String(W).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},P.concat=function(W,J){if(!Array.isArray(W))throw new TypeError('"list" argument must be an Array of Buffers');if(W.length===0)return P.alloc(0);let ye;if(J===void 0)for(J=0,ye=0;ye<W.length;++ye)J+=W[ye].length;const Oe=P.allocUnsafe(J);let We=0;for(ye=0;ye<W.length;++ye){let vt=W[ye];if(ve(vt,R))We+vt.length>Oe.length?(P.isBuffer(vt)||(vt=P.from(vt)),vt.copy(Oe,We)):R.prototype.set.call(Oe,vt,We);else if(P.isBuffer(vt))vt.copy(Oe,We);else throw new TypeError('"list" argument must be an Array of Buffers');We+=vt.length}return Oe};function pe(Z,W){if(P.isBuffer(Z))return Z.length;if(M.isView(Z)||ve(Z,M))return Z.byteLength;if(typeof Z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Z);const J=Z.length,ye=arguments.length>2&&arguments[2]===!0;if(!ye&&J===0)return 0;let Oe=!1;for(;;)switch(W){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return yt(Z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return qe(Z).length;default:if(Oe)return ye?-1:yt(Z).length;W=(""+W).toLowerCase(),Oe=!0}}P.byteLength=pe;function de(Z,W,J){let ye=!1;if((W===void 0||W<0)&&(W=0),W>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,W>>>=0,J<=W))return"";for(Z||(Z="utf8");;)switch(Z){case"hex":return Te(this,W,J);case"utf8":case"utf-8":return be(this,W,J);case"ascii":return le(this,W,J);case"latin1":case"binary":return ae(this,W,J);case"base64":return Y(this,W,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $e(this,W,J);default:if(ye)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase(),ye=!0}}P.prototype._isBuffer=!0;function Ne(Z,W,J){const ye=Z[W];Z[W]=Z[J],Z[J]=ye}P.prototype.swap16=function(){const W=this.length;if(W%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<W;J+=2)Ne(this,J,J+1);return this},P.prototype.swap32=function(){const W=this.length;if(W%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<W;J+=4)Ne(this,J,J+3),Ne(this,J+1,J+2);return this},P.prototype.swap64=function(){const W=this.length;if(W%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<W;J+=8)Ne(this,J,J+7),Ne(this,J+1,J+6),Ne(this,J+2,J+5),Ne(this,J+3,J+4);return this},P.prototype.toString=function(){const W=this.length;return W===0?"":arguments.length===0?be(this,0,W):de.apply(this,arguments)},P.prototype.toLocaleString=P.prototype.toString,P.prototype.equals=function(W){if(!P.isBuffer(W))throw new TypeError("Argument must be a Buffer");return this===W?!0:P.compare(this,W)===0},P.prototype.inspect=function(){let W="";const J=_.INSPECT_MAX_BYTES;return W=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(W+=" ... "),"<Buffer "+W+">"},E&&(P.prototype[E]=P.prototype.inspect),P.prototype.compare=function(W,J,ye,Oe,We){if(ve(W,R)&&(W=P.from(W,W.offset,W.byteLength)),!P.isBuffer(W))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof W);if(J===void 0&&(J=0),ye===void 0&&(ye=W?W.length:0),Oe===void 0&&(Oe=0),We===void 0&&(We=this.length),J<0||ye>W.length||Oe<0||We>this.length)throw new RangeError("out of range index");if(Oe>=We&&J>=ye)return 0;if(Oe>=We)return-1;if(J>=ye)return 1;if(J>>>=0,ye>>>=0,Oe>>>=0,We>>>=0,this===W)return 0;let vt=We-Oe,Xt=ye-J;const jn=Math.min(vt,Xt),Yt=this.slice(Oe,We),Qt=W.slice(J,ye);for(let on=0;on<jn;++on)if(Yt[on]!==Qt[on]){vt=Yt[on],Xt=Qt[on];break}return vt<Xt?-1:Xt<vt?1:0};function Pe(Z,W,J,ye,Oe){if(Z.length===0)return-1;if(typeof J=="string"?(ye=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,Se(J)&&(J=Oe?0:Z.length-1),J<0&&(J=Z.length+J),J>=Z.length){if(Oe)return-1;J=Z.length-1}else if(J<0)if(Oe)J=0;else return-1;if(typeof W=="string"&&(W=P.from(W,ye)),P.isBuffer(W))return W.length===0?-1:Me(Z,W,J,ye,Oe);if(typeof W=="number")return W=W&255,typeof R.prototype.indexOf=="function"?Oe?R.prototype.indexOf.call(Z,W,J):R.prototype.lastIndexOf.call(Z,W,J):Me(Z,[W],J,ye,Oe);throw new TypeError("val must be string, number or Buffer")}function Me(Z,W,J,ye,Oe){let We=1,vt=Z.length,Xt=W.length;if(ye!==void 0&&(ye=String(ye).toLowerCase(),ye==="ucs2"||ye==="ucs-2"||ye==="utf16le"||ye==="utf-16le")){if(Z.length<2||W.length<2)return-1;We=2,vt/=2,Xt/=2,J/=2}function jn(Qt,on){return We===1?Qt[on]:Qt.readUInt16BE(on*We)}let Yt;if(Oe){let Qt=-1;for(Yt=J;Yt<vt;Yt++)if(jn(Z,Yt)===jn(W,Qt===-1?0:Yt-Qt)){if(Qt===-1&&(Qt=Yt),Yt-Qt+1===Xt)return Qt*We}else Qt!==-1&&(Yt-=Yt-Qt),Qt=-1}else for(J+Xt>vt&&(J=vt-Xt),Yt=J;Yt>=0;Yt--){let Qt=!0;for(let on=0;on<Xt;on++)if(jn(Z,Yt+on)!==jn(W,on)){Qt=!1;break}if(Qt)return Yt}return-1}P.prototype.includes=function(W,J,ye){return this.indexOf(W,J,ye)!==-1},P.prototype.indexOf=function(W,J,ye){return Pe(this,W,J,ye,!0)},P.prototype.lastIndexOf=function(W,J,ye){return Pe(this,W,J,ye,!1)};function Ee(Z,W,J,ye){J=Number(J)||0;const Oe=Z.length-J;ye?(ye=Number(ye),ye>Oe&&(ye=Oe)):ye=Oe;const We=W.length;ye>We/2&&(ye=We/2);let vt;for(vt=0;vt<ye;++vt){const Xt=parseInt(W.substr(vt*2,2),16);if(Se(Xt))return vt;Z[J+vt]=Xt}return vt}function Ue(Z,W,J,ye){return rt(yt(W,Z.length-J),Z,J,ye)}function nt(Z,W,J,ye){return rt(_t(W),Z,J,ye)}function He(Z,W,J,ye){return rt(qe(W),Z,J,ye)}function je(Z,W,J,ye){return rt(z(W,Z.length-J),Z,J,ye)}P.prototype.write=function(W,J,ye,Oe){if(J===void 0)Oe="utf8",ye=this.length,J=0;else if(ye===void 0&&typeof J=="string")Oe=J,ye=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(ye)?(ye=ye>>>0,Oe===void 0&&(Oe="utf8")):(Oe=ye,ye=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const We=this.length-J;if((ye===void 0||ye>We)&&(ye=We),W.length>0&&(ye<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");Oe||(Oe="utf8");let vt=!1;for(;;)switch(Oe){case"hex":return Ee(this,W,J,ye);case"utf8":case"utf-8":return Ue(this,W,J,ye);case"ascii":case"latin1":case"binary":return nt(this,W,J,ye);case"base64":return He(this,W,J,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return je(this,W,J,ye);default:if(vt)throw new TypeError("Unknown encoding: "+Oe);Oe=(""+Oe).toLowerCase(),vt=!0}},P.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Y(Z,W,J){return W===0&&J===Z.length?S.fromByteArray(Z):S.fromByteArray(Z.slice(W,J))}function be(Z,W,J){J=Math.min(Z.length,J);const ye=[];let Oe=W;for(;Oe<J;){const We=Z[Oe];let vt=null,Xt=We>239?4:We>223?3:We>191?2:1;if(Oe+Xt<=J){let jn,Yt,Qt,on;switch(Xt){case 1:We<128&&(vt=We);break;case 2:jn=Z[Oe+1],(jn&192)===128&&(on=(We&31)<<6|jn&63,on>127&&(vt=on));break;case 3:jn=Z[Oe+1],Yt=Z[Oe+2],(jn&192)===128&&(Yt&192)===128&&(on=(We&15)<<12|(jn&63)<<6|Yt&63,on>2047&&(on<55296||on>57343)&&(vt=on));break;case 4:jn=Z[Oe+1],Yt=Z[Oe+2],Qt=Z[Oe+3],(jn&192)===128&&(Yt&192)===128&&(Qt&192)===128&&(on=(We&15)<<18|(jn&63)<<12|(Yt&63)<<6|Qt&63,on>65535&&on<1114112&&(vt=on))}}vt===null?(vt=65533,Xt=1):vt>65535&&(vt-=65536,ye.push(vt>>>10&1023|55296),vt=56320|vt&1023),ye.push(vt),Oe+=Xt}return ce(ye)}const Re=4096;function ce(Z){const W=Z.length;if(W<=Re)return String.fromCharCode.apply(String,Z);let J="",ye=0;for(;ye<W;)J+=String.fromCharCode.apply(String,Z.slice(ye,ye+=Re));return J}function le(Z,W,J){let ye="";J=Math.min(Z.length,J);for(let Oe=W;Oe<J;++Oe)ye+=String.fromCharCode(Z[Oe]&127);return ye}function ae(Z,W,J){let ye="";J=Math.min(Z.length,J);for(let Oe=W;Oe<J;++Oe)ye+=String.fromCharCode(Z[Oe]);return ye}function Te(Z,W,J){const ye=Z.length;(!W||W<0)&&(W=0),(!J||J<0||J>ye)&&(J=ye);let Oe="";for(let We=W;We<J;++We)Oe+=ze[Z[We]];return Oe}function $e(Z,W,J){const ye=Z.slice(W,J);let Oe="";for(let We=0;We<ye.length-1;We+=2)Oe+=String.fromCharCode(ye[We]+ye[We+1]*256);return Oe}P.prototype.slice=function(W,J){const ye=this.length;W=~~W,J=J===void 0?ye:~~J,W<0?(W+=ye,W<0&&(W=0)):W>ye&&(W=ye),J<0?(J+=ye,J<0&&(J=0)):J>ye&&(J=ye),J<W&&(J=W);const Oe=this.subarray(W,J);return Object.setPrototypeOf(Oe,P.prototype),Oe};function ke(Z,W,J){if(Z%1!==0||Z<0)throw new RangeError("offset is not uint");if(Z+W>J)throw new RangeError("Trying to access beyond buffer length")}P.prototype.readUintLE=P.prototype.readUIntLE=function(W,J,ye){W=W>>>0,J=J>>>0,ye||ke(W,J,this.length);let Oe=this[W],We=1,vt=0;for(;++vt<J&&(We*=256);)Oe+=this[W+vt]*We;return Oe},P.prototype.readUintBE=P.prototype.readUIntBE=function(W,J,ye){W=W>>>0,J=J>>>0,ye||ke(W,J,this.length);let Oe=this[W+--J],We=1;for(;J>0&&(We*=256);)Oe+=this[W+--J]*We;return Oe},P.prototype.readUint8=P.prototype.readUInt8=function(W,J){return W=W>>>0,J||ke(W,1,this.length),this[W]},P.prototype.readUint16LE=P.prototype.readUInt16LE=function(W,J){return W=W>>>0,J||ke(W,2,this.length),this[W]|this[W+1]<<8},P.prototype.readUint16BE=P.prototype.readUInt16BE=function(W,J){return W=W>>>0,J||ke(W,2,this.length),this[W]<<8|this[W+1]},P.prototype.readUint32LE=P.prototype.readUInt32LE=function(W,J){return W=W>>>0,J||ke(W,4,this.length),(this[W]|this[W+1]<<8|this[W+2]<<16)+this[W+3]*16777216},P.prototype.readUint32BE=P.prototype.readUInt32BE=function(W,J){return W=W>>>0,J||ke(W,4,this.length),this[W]*16777216+(this[W+1]<<16|this[W+2]<<8|this[W+3])},P.prototype.readBigUInt64LE=Tt(function(W){W=W>>>0,De(W,"offset");const J=this[W],ye=this[W+7];(J===void 0||ye===void 0)&&we(W,this.length-8);const Oe=J+this[++W]*2**8+this[++W]*2**16+this[++W]*2**24,We=this[++W]+this[++W]*2**8+this[++W]*2**16+ye*2**24;return BigInt(Oe)+(BigInt(We)<<BigInt(32))}),P.prototype.readBigUInt64BE=Tt(function(W){W=W>>>0,De(W,"offset");const J=this[W],ye=this[W+7];(J===void 0||ye===void 0)&&we(W,this.length-8);const Oe=J*2**24+this[++W]*2**16+this[++W]*2**8+this[++W],We=this[++W]*2**24+this[++W]*2**16+this[++W]*2**8+ye;return(BigInt(Oe)<<BigInt(32))+BigInt(We)}),P.prototype.readIntLE=function(W,J,ye){W=W>>>0,J=J>>>0,ye||ke(W,J,this.length);let Oe=this[W],We=1,vt=0;for(;++vt<J&&(We*=256);)Oe+=this[W+vt]*We;return We*=128,Oe>=We&&(Oe-=Math.pow(2,8*J)),Oe},P.prototype.readIntBE=function(W,J,ye){W=W>>>0,J=J>>>0,ye||ke(W,J,this.length);let Oe=J,We=1,vt=this[W+--Oe];for(;Oe>0&&(We*=256);)vt+=this[W+--Oe]*We;return We*=128,vt>=We&&(vt-=Math.pow(2,8*J)),vt},P.prototype.readInt8=function(W,J){return W=W>>>0,J||ke(W,1,this.length),this[W]&128?(255-this[W]+1)*-1:this[W]},P.prototype.readInt16LE=function(W,J){W=W>>>0,J||ke(W,2,this.length);const ye=this[W]|this[W+1]<<8;return ye&32768?ye|4294901760:ye},P.prototype.readInt16BE=function(W,J){W=W>>>0,J||ke(W,2,this.length);const ye=this[W+1]|this[W]<<8;return ye&32768?ye|4294901760:ye},P.prototype.readInt32LE=function(W,J){return W=W>>>0,J||ke(W,4,this.length),this[W]|this[W+1]<<8|this[W+2]<<16|this[W+3]<<24},P.prototype.readInt32BE=function(W,J){return W=W>>>0,J||ke(W,4,this.length),this[W]<<24|this[W+1]<<16|this[W+2]<<8|this[W+3]},P.prototype.readBigInt64LE=Tt(function(W){W=W>>>0,De(W,"offset");const J=this[W],ye=this[W+7];(J===void 0||ye===void 0)&&we(W,this.length-8);const Oe=this[W+4]+this[W+5]*2**8+this[W+6]*2**16+(ye<<24);return(BigInt(Oe)<<BigInt(32))+BigInt(J+this[++W]*2**8+this[++W]*2**16+this[++W]*2**24)}),P.prototype.readBigInt64BE=Tt(function(W){W=W>>>0,De(W,"offset");const J=this[W],ye=this[W+7];(J===void 0||ye===void 0)&&we(W,this.length-8);const Oe=(J<<24)+this[++W]*2**16+this[++W]*2**8+this[++W];return(BigInt(Oe)<<BigInt(32))+BigInt(this[++W]*2**24+this[++W]*2**16+this[++W]*2**8+ye)}),P.prototype.readFloatLE=function(W,J){return W=W>>>0,J||ke(W,4,this.length),C.read(this,W,!0,23,4)},P.prototype.readFloatBE=function(W,J){return W=W>>>0,J||ke(W,4,this.length),C.read(this,W,!1,23,4)},P.prototype.readDoubleLE=function(W,J){return W=W>>>0,J||ke(W,8,this.length),C.read(this,W,!0,52,8)},P.prototype.readDoubleBE=function(W,J){return W=W>>>0,J||ke(W,8,this.length),C.read(this,W,!1,52,8)};function ot(Z,W,J,ye,Oe,We){if(!P.isBuffer(Z))throw new TypeError('"buffer" argument must be a Buffer instance');if(W>Oe||W<We)throw new RangeError('"value" argument is out of bounds');if(J+ye>Z.length)throw new RangeError("Index out of range")}P.prototype.writeUintLE=P.prototype.writeUIntLE=function(W,J,ye,Oe){if(W=+W,J=J>>>0,ye=ye>>>0,!Oe){const Xt=Math.pow(2,8*ye)-1;ot(this,W,J,ye,Xt,0)}let We=1,vt=0;for(this[J]=W&255;++vt<ye&&(We*=256);)this[J+vt]=W/We&255;return J+ye},P.prototype.writeUintBE=P.prototype.writeUIntBE=function(W,J,ye,Oe){if(W=+W,J=J>>>0,ye=ye>>>0,!Oe){const Xt=Math.pow(2,8*ye)-1;ot(this,W,J,ye,Xt,0)}let We=ye-1,vt=1;for(this[J+We]=W&255;--We>=0&&(vt*=256);)this[J+We]=W/vt&255;return J+ye},P.prototype.writeUint8=P.prototype.writeUInt8=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,1,255,0),this[J]=W&255,J+1},P.prototype.writeUint16LE=P.prototype.writeUInt16LE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,2,65535,0),this[J]=W&255,this[J+1]=W>>>8,J+2},P.prototype.writeUint16BE=P.prototype.writeUInt16BE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,2,65535,0),this[J]=W>>>8,this[J+1]=W&255,J+2},P.prototype.writeUint32LE=P.prototype.writeUInt32LE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,4,4294967295,0),this[J+3]=W>>>24,this[J+2]=W>>>16,this[J+1]=W>>>8,this[J]=W&255,J+4},P.prototype.writeUint32BE=P.prototype.writeUInt32BE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,4,4294967295,0),this[J]=W>>>24,this[J+1]=W>>>16,this[J+2]=W>>>8,this[J+3]=W&255,J+4};function At(Z,W,J,ye,Oe){me(W,ye,Oe,Z,J,7);let We=Number(W&BigInt(4294967295));Z[J++]=We,We=We>>8,Z[J++]=We,We=We>>8,Z[J++]=We,We=We>>8,Z[J++]=We;let vt=Number(W>>BigInt(32)&BigInt(4294967295));return Z[J++]=vt,vt=vt>>8,Z[J++]=vt,vt=vt>>8,Z[J++]=vt,vt=vt>>8,Z[J++]=vt,J}function ft(Z,W,J,ye,Oe){me(W,ye,Oe,Z,J,7);let We=Number(W&BigInt(4294967295));Z[J+7]=We,We=We>>8,Z[J+6]=We,We=We>>8,Z[J+5]=We,We=We>>8,Z[J+4]=We;let vt=Number(W>>BigInt(32)&BigInt(4294967295));return Z[J+3]=vt,vt=vt>>8,Z[J+2]=vt,vt=vt>>8,Z[J+1]=vt,vt=vt>>8,Z[J]=vt,J+8}P.prototype.writeBigUInt64LE=Tt(function(W,J=0){return At(this,W,J,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeBigUInt64BE=Tt(function(W,J=0){return ft(this,W,J,BigInt(0),BigInt("0xffffffffffffffff"))}),P.prototype.writeIntLE=function(W,J,ye,Oe){if(W=+W,J=J>>>0,!Oe){const jn=Math.pow(2,8*ye-1);ot(this,W,J,ye,jn-1,-jn)}let We=0,vt=1,Xt=0;for(this[J]=W&255;++We<ye&&(vt*=256);)W<0&&Xt===0&&this[J+We-1]!==0&&(Xt=1),this[J+We]=(W/vt>>0)-Xt&255;return J+ye},P.prototype.writeIntBE=function(W,J,ye,Oe){if(W=+W,J=J>>>0,!Oe){const jn=Math.pow(2,8*ye-1);ot(this,W,J,ye,jn-1,-jn)}let We=ye-1,vt=1,Xt=0;for(this[J+We]=W&255;--We>=0&&(vt*=256);)W<0&&Xt===0&&this[J+We+1]!==0&&(Xt=1),this[J+We]=(W/vt>>0)-Xt&255;return J+ye},P.prototype.writeInt8=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,1,127,-128),W<0&&(W=255+W+1),this[J]=W&255,J+1},P.prototype.writeInt16LE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,2,32767,-32768),this[J]=W&255,this[J+1]=W>>>8,J+2},P.prototype.writeInt16BE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,2,32767,-32768),this[J]=W>>>8,this[J+1]=W&255,J+2},P.prototype.writeInt32LE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,4,2147483647,-2147483648),this[J]=W&255,this[J+1]=W>>>8,this[J+2]=W>>>16,this[J+3]=W>>>24,J+4},P.prototype.writeInt32BE=function(W,J,ye){return W=+W,J=J>>>0,ye||ot(this,W,J,4,2147483647,-2147483648),W<0&&(W=4294967295+W+1),this[J]=W>>>24,this[J+1]=W>>>16,this[J+2]=W>>>8,this[J+3]=W&255,J+4},P.prototype.writeBigInt64LE=Tt(function(W,J=0){return At(this,W,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),P.prototype.writeBigInt64BE=Tt(function(W,J=0){return ft(this,W,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function jt(Z,W,J,ye,Oe,We){if(J+ye>Z.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function Bt(Z,W,J,ye,Oe){return W=+W,J=J>>>0,Oe||jt(Z,W,J,4),C.write(Z,W,J,ye,23,4),J+4}P.prototype.writeFloatLE=function(W,J,ye){return Bt(this,W,J,!0,ye)},P.prototype.writeFloatBE=function(W,J,ye){return Bt(this,W,J,!1,ye)};function Ft(Z,W,J,ye,Oe){return W=+W,J=J>>>0,Oe||jt(Z,W,J,8),C.write(Z,W,J,ye,52,8),J+8}P.prototype.writeDoubleLE=function(W,J,ye){return Ft(this,W,J,!0,ye)},P.prototype.writeDoubleBE=function(W,J,ye){return Ft(this,W,J,!1,ye)},P.prototype.copy=function(W,J,ye,Oe){if(!P.isBuffer(W))throw new TypeError("argument should be a Buffer");if(ye||(ye=0),!Oe&&Oe!==0&&(Oe=this.length),J>=W.length&&(J=W.length),J||(J=0),Oe>0&&Oe<ye&&(Oe=ye),Oe===ye||W.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(ye<0||ye>=this.length)throw new RangeError("Index out of range");if(Oe<0)throw new RangeError("sourceEnd out of bounds");Oe>this.length&&(Oe=this.length),W.length-J<Oe-ye&&(Oe=W.length-J+ye);const We=Oe-ye;return this===W&&typeof R.prototype.copyWithin=="function"?this.copyWithin(J,ye,Oe):R.prototype.set.call(W,this.subarray(ye,Oe),J),We},P.prototype.fill=function(W,J,ye,Oe){if(typeof W=="string"){if(typeof J=="string"?(Oe=J,J=0,ye=this.length):typeof ye=="string"&&(Oe=ye,ye=this.length),Oe!==void 0&&typeof Oe!="string")throw new TypeError("encoding must be a string");if(typeof Oe=="string"&&!P.isEncoding(Oe))throw new TypeError("Unknown encoding: "+Oe);if(W.length===1){const vt=W.charCodeAt(0);(Oe==="utf8"&&vt<128||Oe==="latin1")&&(W=vt)}}else typeof W=="number"?W=W&255:typeof W=="boolean"&&(W=Number(W));if(J<0||this.length<J||this.length<ye)throw new RangeError("Out of range index");if(ye<=J)return this;J=J>>>0,ye=ye===void 0?this.length:ye>>>0,W||(W=0);let We;if(typeof W=="number")for(We=J;We<ye;++We)this[We]=W;else{const vt=P.isBuffer(W)?W:P.from(W,Oe),Xt=vt.length;if(Xt===0)throw new TypeError('The value "'+W+'" is invalid for argument "value"');for(We=0;We<ye-J;++We)this[We+J]=vt[We%Xt]}return this};const tn={};function xe(Z,W,J){tn[Z]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:W.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Z}]`,this.stack,delete this.name}get code(){return Z}set code(Oe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Oe,writable:!0})}toString(){return`${this.name} [${Z}]: ${this.message}`}}}xe("ERR_BUFFER_OUT_OF_BOUNDS",function(Z){return Z?`${Z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),xe("ERR_INVALID_ARG_TYPE",function(Z,W){return`The "${Z}" argument must be of type number. Received type ${typeof W}`},TypeError),xe("ERR_OUT_OF_RANGE",function(Z,W,J){let ye=`The value of "${Z}" is out of range.`,Oe=J;return Number.isInteger(J)&&Math.abs(J)>2**32?Oe=D(String(J)):typeof J=="bigint"&&(Oe=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(Oe=D(Oe)),Oe+="n"),ye+=` It must be ${W}. Received ${Oe}`,ye},RangeError);function D(Z){let W="",J=Z.length;const ye=Z[0]==="-"?1:0;for(;J>=ye+4;J-=3)W=`_${Z.slice(J-3,J)}${W}`;return`${Z.slice(0,J)}${W}`}function X(Z,W,J){De(W,"offset"),(Z[W]===void 0||Z[W+J]===void 0)&&we(W,Z.length-(J+1))}function me(Z,W,J,ye,Oe,We){if(Z>J||Z<W){const vt=typeof W=="bigint"?"n":"";let Xt;throw W===0||W===BigInt(0)?Xt=`>= 0${vt} and < 2${vt} ** ${(We+1)*8}${vt}`:Xt=`>= -(2${vt} ** ${(We+1)*8-1}${vt}) and < 2 ** ${(We+1)*8-1}${vt}`,new tn.ERR_OUT_OF_RANGE("value",Xt,Z)}X(ye,Oe,We)}function De(Z,W){if(typeof Z!="number")throw new tn.ERR_INVALID_ARG_TYPE(W,"number",Z)}function we(Z,W,J){throw Math.floor(Z)!==Z?(De(Z,J),new tn.ERR_OUT_OF_RANGE("offset","an integer",Z)):W<0?new tn.ERR_BUFFER_OUT_OF_BOUNDS:new tn.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${W}`,Z)}const Ie=/[^+/0-9A-Za-z-_]/g;function fe(Z){if(Z=Z.split("=")[0],Z=Z.trim().replace(Ie,""),Z.length<2)return"";for(;Z.length%4!==0;)Z=Z+"=";return Z}function yt(Z,W){W=W||1/0;let J;const ye=Z.length;let Oe=null;const We=[];for(let vt=0;vt<ye;++vt){if(J=Z.charCodeAt(vt),J>55295&&J<57344){if(!Oe){if(J>56319){(W-=3)>-1&&We.push(239,191,189);continue}else if(vt+1===ye){(W-=3)>-1&&We.push(239,191,189);continue}Oe=J;continue}if(J<56320){(W-=3)>-1&&We.push(239,191,189),Oe=J;continue}J=(Oe-55296<<10|J-56320)+65536}else Oe&&(W-=3)>-1&&We.push(239,191,189);if(Oe=null,J<128){if((W-=1)<0)break;We.push(J)}else if(J<2048){if((W-=2)<0)break;We.push(J>>6|192,J&63|128)}else if(J<65536){if((W-=3)<0)break;We.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((W-=4)<0)break;We.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return We}function _t(Z){const W=[];for(let J=0;J<Z.length;++J)W.push(Z.charCodeAt(J)&255);return W}function z(Z,W){let J,ye,Oe;const We=[];for(let vt=0;vt<Z.length&&!((W-=2)<0);++vt)J=Z.charCodeAt(vt),ye=J>>8,Oe=J%256,We.push(Oe),We.push(ye);return We}function qe(Z){return S.toByteArray(fe(Z))}function rt(Z,W,J,ye){let Oe;for(Oe=0;Oe<ye&&!(Oe+J>=W.length||Oe>=Z.length);++Oe)W[Oe+J]=Z[Oe];return Oe}function ve(Z,W){return Z instanceof W||Z!=null&&Z.constructor!=null&&Z.constructor.name!=null&&Z.constructor.name===W.name}function Se(Z){return Z!==Z}const ze=function(){const Z="0123456789abcdef",W=new Array(256);for(let J=0;J<16;++J){const ye=J*16;for(let Oe=0;Oe<16;++Oe)W[ye+Oe]=Z[J]+Z[Oe]}return W}();function Tt(Z){return typeof BigInt>"u"?ge:Z}function ge(){throw new Error("BigInt not supported")}})(t);const w=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=w,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(jI)),jI}var OI,VB;function zi(){if(VB)return OI;VB=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let i=0;i<n.length;i++)r+=`    ${n[i].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return OI={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},OI}var PI={exports:{}},DI,HB;function uK(){return HB||(HB=1,DI={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const i=t.shift();return r==="f"?i.toFixed(6):r==="j"?JSON.stringify(i):r==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),DI}var FI,WB;function Wa(){if(WB)return FI;WB=1;const{format:e,inspect:t}=uK(),{AggregateError:n}=zi(),r=globalThis.AggregateError||n,i=Symbol("kIsNodeError"),s=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(x,w){if(!x)throw new l.ERR_INTERNAL_ASSERTION(w)}function u(x){let w="",_=x.length;const S=x[0]==="-"?1:0;for(;_>=S+4;_-=3)w=`_${x.slice(_-3,_)}${w}`;return`${x.slice(0,_)}${w}`}function d(x,w,_){if(typeof w=="function")return c(w.length<=_.length,`Code: ${x}; The provided arguments length (${_.length}) does not match the required ones (${w.length}).`),w(..._);const S=(w.match(/%[dfijoOs]/g)||[]).length;return c(S===_.length,`Code: ${x}; The provided arguments length (${_.length}) does not match the required ones (${S}).`),_.length===0?w:e(w,..._)}function h(x,w,_){_||(_=Error);class S extends _{constructor(...E){super(d(x,w,E))}toString(){return`${this.name} [${x}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:_.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${x}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=x,S.prototype[i]=!0,l[x]=S}function p(x){const w=o+x.name;return Object.defineProperty(x,"name",{value:w}),x}function y(x,w){if(x&&w&&x!==w){if(Array.isArray(w.errors))return w.errors.push(x),w;const _=new r([w,x],w.message);return _.code=w.code,_}return x||w}class b extends Error{constructor(w="The operation was aborted",_=void 0){if(_!==void 0&&typeof _!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",_);super(w,_),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(x,w,_)=>{c(typeof x=="string","'name' must be a string"),Array.isArray(w)||(w=[w]);let S="The ";x.endsWith(" argument")?S+=`${x} `:S+=`"${x}" ${x.includes(".")?"property":"argument"} `,S+="must be ";const C=[],E=[],T=[];for(const M of w)c(typeof M=="string","All expected entries have to be of type string"),s.includes(M)?C.push(M.toLowerCase()):a.test(M)?E.push(M):(c(M!=="object",'The value "object" should be written as "Object"'),T.push(M));if(E.length>0){const M=C.indexOf("object");M!==-1&&(C.splice(C,M,1),E.push("Object"))}if(C.length>0){switch(C.length){case 1:S+=`of type ${C[0]}`;break;case 2:S+=`one of type ${C[0]} or ${C[1]}`;break;default:{const M=C.pop();S+=`one of type ${C.join(", ")}, or ${M}`}}(E.length>0||T.length>0)&&(S+=" or ")}if(E.length>0){switch(E.length){case 1:S+=`an instance of ${E[0]}`;break;case 2:S+=`an instance of ${E[0]} or ${E[1]}`;break;default:{const M=E.pop();S+=`an instance of ${E.join(", ")}, or ${M}`}}T.length>0&&(S+=" or ")}switch(T.length){case 0:break;case 1:T[0].toLowerCase()!==T[0]&&(S+="an "),S+=`${T[0]}`;break;case 2:S+=`one of ${T[0]} or ${T[1]}`;break;default:{const M=T.pop();S+=`one of ${T.join(", ")}, or ${M}`}}if(_==null)S+=`. Received ${_}`;else if(typeof _=="function"&&_.name)S+=`. Received function ${_.name}`;else if(typeof _=="object"){var R;if((R=_.constructor)!==null&&R!==void 0&&R.name)S+=`. Received an instance of ${_.constructor.name}`;else{const M=t(_,{depth:-1});S+=`. Received ${M}`}}else{let M=t(_,{colors:!1});M.length>25&&(M=`${M.slice(0,25)}...`),S+=`. Received type ${typeof _} (${M})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(x,w,_="is invalid")=>{let S=t(w);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${x.includes(".")?"property":"argument"} '${x}' ${_}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(x,w,_)=>{var S;const C=_!=null&&(S=_.constructor)!==null&&S!==void 0&&S.name?`instance of ${_.constructor.name}`:`type ${typeof _}`;return`Expected ${x} to be returned from the "${w}" function but got ${C}.`},TypeError),h("ERR_MISSING_ARGS",(...x)=>{c(x.length>0,"At least one arg needs to be specified");let w;const _=x.length;switch(x=(Array.isArray(x)?x:[x]).map(S=>`"${S}"`).join(" or "),_){case 1:w+=`The ${x[0]} argument`;break;case 2:w+=`The ${x[0]} and ${x[1]} arguments`;break;default:{const S=x.pop();w+=`The ${x.join(", ")}, and ${S} arguments`}break}return`${w} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(x,w,_)=>{c(w,'Missing "range" argument');let S;if(Number.isInteger(_)&&Math.abs(_)>2**32)S=u(String(_));else if(typeof _=="bigint"){S=String(_);const C=BigInt(2)**BigInt(32);(_>C||_<-C)&&(S=u(S)),S+="n"}else S=t(_);return`The value of "${x}" is out of range. It must be ${w}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),FI={AbortError:b,aggregateTwoErrors:p(y),hideStackFrames:p,codes:l},FI}var Wb={exports:{}},GB;function kx(){if(GB)return Wb.exports;GB=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return Wb.exports=e,Wb.exports.AbortSignal=t,Wb.exports.default=e,Wb.exports}var rS={exports:{}},KB;function pE(){if(KB)return rS.exports;KB=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(E,T,R){return Function.prototype.apply.call(E,T,R)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(E){return Object.getOwnPropertyNames(E).concat(Object.getOwnPropertySymbols(E))}:n=function(E){return Object.getOwnPropertyNames(E)};function r(C){console&&console.warn&&console.warn(C)}var i=Number.isNaN||function(E){return E!==E};function s(){s.init.call(this)}rS.exports=s,rS.exports.once=w,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(C){if(typeof C!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof C)}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(C){if(typeof C!="number"||C<0||i(C))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+C+".");a=C}}),s.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(E){if(typeof E!="number"||E<0||i(E))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+E+".");return this._maxListeners=E,this};function l(C){return C._maxListeners===void 0?s.defaultMaxListeners:C._maxListeners}s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(E){for(var T=[],R=1;R<arguments.length;R++)T.push(arguments[R]);var M=E==="error",N=this._events;if(N!==void 0)M=M&&N.error===void 0;else if(!M)return!1;if(M){var O;if(T.length>0&&(O=T[0]),O instanceof Error)throw O;var B=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw B.context=O,B}var P=N[E];if(P===void 0)return!1;if(typeof P=="function")t(P,this,T);else for(var H=P.length,F=y(P,H),R=0;R<H;++R)t(F[R],this,T);return!0};function c(C,E,T,R){var M,N,O;if(o(T),N=C._events,N===void 0?(N=C._events=Object.create(null),C._eventsCount=0):(N.newListener!==void 0&&(C.emit("newListener",E,T.listener?T.listener:T),N=C._events),O=N[E]),O===void 0)O=N[E]=T,++C._eventsCount;else if(typeof O=="function"?O=N[E]=R?[T,O]:[O,T]:R?O.unshift(T):O.push(T),M=l(C),M>0&&O.length>M&&!O.warned){O.warned=!0;var B=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(E)+" listeners added. Use emitter.setMaxListeners() to increase limit");B.name="MaxListenersExceededWarning",B.emitter=C,B.type=E,B.count=O.length,r(B)}return C}s.prototype.addListener=function(E,T){return c(this,E,T,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(E,T){return c(this,E,T,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(C,E,T){var R={fired:!1,wrapFn:void 0,target:C,type:E,listener:T},M=u.bind(R);return M.listener=T,R.wrapFn=M,M}s.prototype.once=function(E,T){return o(T),this.on(E,d(this,E,T)),this},s.prototype.prependOnceListener=function(E,T){return o(T),this.prependListener(E,d(this,E,T)),this},s.prototype.removeListener=function(E,T){var R,M,N,O,B;if(o(T),M=this._events,M===void 0)return this;if(R=M[E],R===void 0)return this;if(R===T||R.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete M[E],M.removeListener&&this.emit("removeListener",E,R.listener||T));else if(typeof R!="function"){for(N=-1,O=R.length-1;O>=0;O--)if(R[O]===T||R[O].listener===T){B=R[O].listener,N=O;break}if(N<0)return this;N===0?R.shift():b(R,N),R.length===1&&(M[E]=R[0]),M.removeListener!==void 0&&this.emit("removeListener",E,B||T)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(E){var T,R,M;if(R=this._events,R===void 0)return this;if(R.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):R[E]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete R[E]),this;if(arguments.length===0){var N=Object.keys(R),O;for(M=0;M<N.length;++M)O=N[M],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=R[E],typeof T=="function")this.removeListener(E,T);else if(T!==void 0)for(M=T.length-1;M>=0;M--)this.removeListener(E,T[M]);return this};function h(C,E,T){var R=C._events;if(R===void 0)return[];var M=R[E];return M===void 0?[]:typeof M=="function"?T?[M.listener||M]:[M]:T?x(M):y(M,M.length)}s.prototype.listeners=function(E){return h(this,E,!0)},s.prototype.rawListeners=function(E){return h(this,E,!1)},s.listenerCount=function(C,E){return typeof C.listenerCount=="function"?C.listenerCount(E):p.call(C,E)},s.prototype.listenerCount=p;function p(C){var E=this._events;if(E!==void 0){var T=E[C];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(C,E){for(var T=new Array(E),R=0;R<E;++R)T[R]=C[R];return T}function b(C,E){for(;E+1<C.length;E++)C[E]=C[E+1];C.pop()}function x(C){for(var E=new Array(C.length),T=0;T<E.length;++T)E[T]=C[T].listener||C[T];return E}function w(C,E){return new Promise(function(T,R){function M(O){C.removeListener(E,N),R(O)}function N(){typeof C.removeListener=="function"&&C.removeListener("error",M),T([].slice.call(arguments))}S(C,E,N,{once:!0}),E!=="error"&&_(C,M,{once:!0})})}function _(C,E,T){typeof C.on=="function"&&S(C,"error",E,T)}function S(C,E,T,R){if(typeof C.on=="function")R.once?C.once(E,T):C.on(E,T);else if(typeof C.addEventListener=="function")C.addEventListener(E,function M(N){R.once&&C.removeEventListener(E,M),T(N)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof C)}return rS.exports}var YB;function uo(){return YB||(YB=1,function(e){const t=fh(),{format:n,inspect:r}=uK(),{codes:{ERR_INVALID_ARG_TYPE:i}}=Wa(),{kResistStopPropagation:s,AggregateError:a,SymbolDispose:o}=zi(),l=globalThis.AbortSignal||kx().AbortSignal,c=globalThis.AbortController||kx().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(x){return x instanceof d}:function(x){return!1},p=(b,x)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new i(x,"AbortSignal",b)},y=(b,x)=>{if(typeof b!="function")throw new i(x,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let x=!1;return function(...w){x||(x=!0,b.apply(this,w))}},createDeferredPromise:function(){let b,x;return{promise:new Promise((_,S)=>{b=_,x=S}),resolve:b,reject:x}},promisify(b){return new Promise((x,w)=>{b((_,...S)=>_?w(_):x(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,x){return b},addAbortListener:pE().addAbortListener||function(x,w){if(x===void 0)throw new i("signal","AbortSignal",x);p(x,"signal"),y(w,"listener");let _;return x.aborted?queueMicrotask(()=>w()):(x.addEventListener("abort",w,{__proto__:null,once:!0,[s]:!0}),_=()=>{x.removeEventListener("abort",w)}),{__proto__:null,[o](){var S;(S=_)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(x){if(x.length===1)return x[0];const w=new c,_=()=>w.abort();return x.forEach(S=>{p(S,"signals"),S.addEventListener("abort",_,{once:!0})}),w.signal.addEventListener("abort",()=>{x.forEach(S=>S.removeEventListener("abort",_))},{once:!0}),w.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(PI)),PI.exports}var iS={},LI,ZB;function Lw(){if(ZB)return LI;ZB=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:i,NumberIsNaN:s,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:p}=zi(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:x,ERR_INVALID_ARG_VALUE:w,ERR_OUT_OF_RANGE:_,ERR_UNKNOWN_SIGNAL:S}}=Wa(),{normalizeEncoding:C}=uo(),{isAsyncFunction:E,isArrayBufferView:T}=uo().types,R={};function M(ae){return ae===(ae|0)}function N(ae){return ae===ae>>>0}const O=/^[0-7]+$/,B="must be a 32-bit unsigned integer or an octal string";function P(ae,Te,$e){if(typeof ae>"u"&&(ae=$e),typeof ae=="string"){if(u(O,ae)===null)throw new w(Te,ae,B);ae=l(ae,8)}return Q(ae,Te),ae}const H=y((ae,Te,$e=o,ke=a)=>{if(typeof ae!="number")throw new x(Te,"number",ae);if(!i(ae))throw new _(Te,"an integer",ae);if(ae<$e||ae>ke)throw new _(Te,`>= ${$e} && <= ${ke}`,ae)}),F=y((ae,Te,$e=-2147483648,ke=2147483647)=>{if(typeof ae!="number")throw new x(Te,"number",ae);if(!i(ae))throw new _(Te,"an integer",ae);if(ae<$e||ae>ke)throw new _(Te,`>= ${$e} && <= ${ke}`,ae)}),Q=y((ae,Te,$e=!1)=>{if(typeof ae!="number")throw new x(Te,"number",ae);if(!i(ae))throw new _(Te,"an integer",ae);const ke=$e?1:0,ot=4294967295;if(ae<ke||ae>ot)throw new _(Te,`>= ${ke} && <= ${ot}`,ae)});function q(ae,Te){if(typeof ae!="string")throw new x(Te,"string",ae)}function K(ae,Te,$e=void 0,ke){if(typeof ae!="number")throw new x(Te,"number",ae);if($e!=null&&ae<$e||ke!=null&&ae>ke||($e!=null||ke!=null)&&s(ae))throw new _(Te,`${$e!=null?`>= ${$e}`:""}${$e!=null&&ke!=null?" && ":""}${ke!=null?`<= ${ke}`:""}`,ae)}const U=y((ae,Te,$e)=>{if(!t($e,ae)){const ot="must be one of: "+n(r($e,At=>typeof At=="string"?`'${At}'`:d(At)),", ");throw new w(Te,ae,ot)}});function re(ae,Te){if(typeof ae!="boolean")throw new x(Te,"boolean",ae)}function G(ae,Te,$e){return ae==null||!c(ae,Te)?$e:ae[Te]}const ne=y((ae,Te,$e=null)=>{const ke=G($e,"allowArray",!1),ot=G($e,"allowFunction",!1);if(!G($e,"nullable",!1)&&ae===null||!ke&&e(ae)||typeof ae!="object"&&(!ot||typeof ae!="function"))throw new x(Te,"Object",ae)}),te=y((ae,Te)=>{if(ae!=null&&typeof ae!="object"&&typeof ae!="function")throw new x(Te,"a dictionary",ae)}),se=y((ae,Te,$e=0)=>{if(!e(ae))throw new x(Te,"Array",ae);if(ae.length<$e){const ke=`must be longer than ${$e}`;throw new w(Te,ae,ke)}});function pe(ae,Te){se(ae,Te);for(let $e=0;$e<ae.length;$e++)q(ae[$e],`${Te}[${$e}]`)}function de(ae,Te){se(ae,Te);for(let $e=0;$e<ae.length;$e++)re(ae[$e],`${Te}[${$e}]`)}function Ne(ae,Te){se(ae,Te);for(let $e=0;$e<ae.length;$e++){const ke=ae[$e],ot=`${Te}[${$e}]`;if(ke==null)throw new x(ot,"AbortSignal",ke);nt(ke,ot)}}function Pe(ae,Te="signal"){if(q(ae,Te),R[ae]===void 0)throw R[h(ae)]!==void 0?new S(ae+" (signals must use all capital letters)"):new S(ae)}const Me=y((ae,Te="buffer")=>{if(!T(ae))throw new x(Te,["Buffer","TypedArray","DataView"],ae)});function Ee(ae,Te){const $e=C(Te),ke=ae.length;if($e==="hex"&&ke%2!==0)throw new w("encoding",Te,`is invalid for data of length ${ke}`)}function Ue(ae,Te="Port",$e=!0){if(typeof ae!="number"&&typeof ae!="string"||typeof ae=="string"&&p(ae).length===0||+ae!==+ae>>>0||ae>65535||ae===0&&!$e)throw new b(Te,ae,$e);return ae|0}const nt=y((ae,Te)=>{if(ae!==void 0&&(ae===null||typeof ae!="object"||!("aborted"in ae)))throw new x(Te,"AbortSignal",ae)}),He=y((ae,Te)=>{if(typeof ae!="function")throw new x(Te,"Function",ae)}),je=y((ae,Te)=>{if(typeof ae!="function"||E(ae))throw new x(Te,"Function",ae)}),Y=y((ae,Te)=>{if(ae!==void 0)throw new x(Te,"undefined",ae)});function be(ae,Te,$e){if(!t($e,ae))throw new x(Te,`('${n($e,"|")}')`,ae)}const Re=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ce(ae,Te){if(typeof ae>"u"||!u(Re,ae))throw new w(Te,ae,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function le(ae){if(typeof ae=="string")return ce(ae,"hints"),ae;if(e(ae)){const Te=ae.length;let $e="";if(Te===0)return $e;for(let ke=0;ke<Te;ke++){const ot=ae[ke];ce(ot,"hints"),$e+=ot,ke!==Te-1&&($e+=", ")}return $e}throw new w("hints",ae,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return LI={isInt32:M,isUint32:N,parseFileMode:P,validateArray:se,validateStringArray:pe,validateBooleanArray:de,validateAbortSignalArray:Ne,validateBoolean:re,validateBuffer:Me,validateDictionary:te,validateEncoding:Ee,validateFunction:He,validateInt32:F,validateInteger:H,validateNumber:K,validateObject:ne,validateOneOf:U,validatePlainFunction:je,validatePort:Ue,validateSignalName:Pe,validateString:q,validateUint32:Q,validateUndefined:Y,validateUnion:be,validateAbortSignal:nt,validateLinkHeaderValue:le},LI}var sS={exports:{}},BI={},XB;function sm(){return XB||(XB=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var n={exports:{}},r=n.exports={},i,s;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?i=setTimeout:i=a}catch{i=a}try{typeof clearTimeout=="function"?s=clearTimeout:s=o}catch{s=o}})();function l(C){if(i===setTimeout)return setTimeout(C,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(C,0);try{return i(C,0)}catch{try{return i.call(null,C,0)}catch{return i.call(this,C,0)}}}function c(C){if(s===clearTimeout)return clearTimeout(C);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(C);try{return s(C)}catch{try{return s.call(null,C)}catch{return s.call(this,C)}}}var u=[],d=!1,h,p=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):p=-1,u.length&&b())}function b(){if(!d){var C=l(y);d=!0;for(var E=u.length;E;){for(h=u,u=[];++p<E;)h&&h[p].run();p=-1,E=u.length}h=null,d=!1,c(C)}}r.nextTick=function(C){var E=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)E[T-1]=arguments[T];u.push(new x(C,E)),u.length===1&&!d&&l(b)};function x(C,E){this.fun=C,this.array=E}x.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function w(){}r.on=w,r.addListener=w,r.once=w,r.off=w,r.removeListener=w,r.removeAllListeners=w,r.emit=w,r.prependListener=w,r.prependOnceListener=w,r.listeners=function(C){return[]},r.binding=function(C){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(C){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var _=n.exports;const S=t(_);e.default=S,e.process=S}(BI)),BI}var $I,JB;function Ed(){if(JB)return $I;JB=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=zi(),r=n("nodejs.stream.destroyed"),i=n("nodejs.stream.errored"),s=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(G,ne=!1){var te;return!!(G&&typeof G.pipe=="function"&&typeof G.on=="function"&&(!ne||typeof G.pause=="function"&&typeof G.resume=="function")&&(!G._writableState||((te=G._readableState)===null||te===void 0?void 0:te.readable)!==!1)&&(!G._writableState||G._readableState))}function d(G){var ne;return!!(G&&typeof G.write=="function"&&typeof G.on=="function"&&(!G._readableState||((ne=G._writableState)===null||ne===void 0?void 0:ne.writable)!==!1))}function h(G){return!!(G&&typeof G.pipe=="function"&&G._readableState&&typeof G.on=="function"&&typeof G.write=="function")}function p(G){return G&&(G._readableState||G._writableState||typeof G.write=="function"&&typeof G.on=="function"||typeof G.pipe=="function"&&typeof G.on=="function")}function y(G){return!!(G&&!p(G)&&typeof G.pipeThrough=="function"&&typeof G.getReader=="function"&&typeof G.cancel=="function")}function b(G){return!!(G&&!p(G)&&typeof G.getWriter=="function"&&typeof G.abort=="function")}function x(G){return!!(G&&!p(G)&&typeof G.readable=="object"&&typeof G.writable=="object")}function w(G){return y(G)||b(G)||x(G)}function _(G,ne){return G==null?!1:ne===!0?typeof G[e]=="function":ne===!1?typeof G[t]=="function":typeof G[e]=="function"||typeof G[t]=="function"}function S(G){if(!p(G))return null;const ne=G._writableState,te=G._readableState,se=ne||te;return!!(G.destroyed||G[r]||se!=null&&se.destroyed)}function C(G){if(!d(G))return null;if(G.writableEnded===!0)return!0;const ne=G._writableState;return ne!=null&&ne.errored?!1:typeof(ne==null?void 0:ne.ended)!="boolean"?null:ne.ended}function E(G,ne){if(!d(G))return null;if(G.writableFinished===!0)return!0;const te=G._writableState;return te!=null&&te.errored?!1:typeof(te==null?void 0:te.finished)!="boolean"?null:!!(te.finished||ne===!1&&te.ended===!0&&te.length===0)}function T(G){if(!u(G))return null;if(G.readableEnded===!0)return!0;const ne=G._readableState;return!ne||ne.errored?!1:typeof(ne==null?void 0:ne.ended)!="boolean"?null:ne.ended}function R(G,ne){if(!u(G))return null;const te=G._readableState;return te!=null&&te.errored?!1:typeof(te==null?void 0:te.endEmitted)!="boolean"?null:!!(te.endEmitted||ne===!1&&te.ended===!0&&te.length===0)}function M(G){return G&&G[s]!=null?G[s]:typeof(G==null?void 0:G.readable)!="boolean"?null:S(G)?!1:u(G)&&G.readable&&!R(G)}function N(G){return G&&G[a]!=null?G[a]:typeof(G==null?void 0:G.writable)!="boolean"?null:S(G)?!1:d(G)&&G.writable&&!C(G)}function O(G,ne){return p(G)?S(G)?!0:!((ne==null?void 0:ne.readable)!==!1&&M(G)||(ne==null?void 0:ne.writable)!==!1&&N(G)):null}function B(G){var ne,te;return p(G)?G.writableErrored?G.writableErrored:(ne=(te=G._writableState)===null||te===void 0?void 0:te.errored)!==null&&ne!==void 0?ne:null:null}function P(G){var ne,te;return p(G)?G.readableErrored?G.readableErrored:(ne=(te=G._readableState)===null||te===void 0?void 0:te.errored)!==null&&ne!==void 0?ne:null:null}function H(G){if(!p(G))return null;if(typeof G.closed=="boolean")return G.closed;const ne=G._writableState,te=G._readableState;return typeof(ne==null?void 0:ne.closed)=="boolean"||typeof(te==null?void 0:te.closed)=="boolean"?(ne==null?void 0:ne.closed)||(te==null?void 0:te.closed):typeof G._closed=="boolean"&&F(G)?G._closed:null}function F(G){return typeof G._closed=="boolean"&&typeof G._defaultKeepAlive=="boolean"&&typeof G._removedConnection=="boolean"&&typeof G._removedContLen=="boolean"}function Q(G){return typeof G._sent100=="boolean"&&F(G)}function q(G){var ne;return typeof G._consuming=="boolean"&&typeof G._dumped=="boolean"&&((ne=G.req)===null||ne===void 0?void 0:ne.upgradeOrConnect)===void 0}function K(G){if(!p(G))return null;const ne=G._writableState,te=G._readableState,se=ne||te;return!se&&Q(G)||!!(se&&se.autoDestroy&&se.emitClose&&se.closed===!1)}function U(G){var ne;return!!(G&&((ne=G[o])!==null&&ne!==void 0?ne:G.readableDidRead||G.readableAborted))}function re(G){var ne,te,se,pe,de,Ne,Pe,Me,Ee,Ue;return!!(G&&((ne=(te=(se=(pe=(de=(Ne=G[i])!==null&&Ne!==void 0?Ne:G.readableErrored)!==null&&de!==void 0?de:G.writableErrored)!==null&&pe!==void 0?pe:(Pe=G._readableState)===null||Pe===void 0?void 0:Pe.errorEmitted)!==null&&se!==void 0?se:(Me=G._writableState)===null||Me===void 0?void 0:Me.errorEmitted)!==null&&te!==void 0?te:(Ee=G._readableState)===null||Ee===void 0?void 0:Ee.errored)!==null&&ne!==void 0?ne:!((Ue=G._writableState)===null||Ue===void 0)&&Ue.errored))}return $I={isDestroyed:S,kIsDestroyed:r,isDisturbed:U,kIsDisturbed:o,isErrored:re,kIsErrored:i,isReadable:M,kIsReadable:s,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:H,isDuplexNodeStream:h,isFinished:O,isIterable:_,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:T,isReadableFinished:R,isReadableErrored:P,isNodeStream:p,isWebStream:w,isWritable:N,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:C,isWritableFinished:E,isWritableErrored:B,isServerRequest:q,isServerResponse:Q,willEmitClose:K,isTransformStream:x},$I}var QB;function hh(){if(QB)return sS.exports;QB=1;const e=sm(),{AbortError:t,codes:n}=Wa(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:i}=n,{kEmptyObject:s,once:a}=uo(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=Lw(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:p}=zi(),{isClosed:y,isReadable:b,isReadableNodeStream:x,isReadableStream:w,isReadableFinished:_,isReadableErrored:S,isWritable:C,isWritableNodeStream:E,isWritableStream:T,isWritableFinished:R,isWritableErrored:M,isNodeStream:N,willEmitClose:O,kIsClosedPromise:B}=Ed();let P;function H(U){return U.setHeader&&typeof U.abort=="function"}const F=()=>{};function Q(U,re,G){var ne,te;if(arguments.length===2?(G=re,re=s):re==null?re=s:c(re,"options"),l(G,"callback"),o(re.signal,"options.signal"),G=a(G),w(U)||T(U))return q(U,re,G);if(!N(U))throw new r("stream",["ReadableStream","WritableStream","Stream"],U);const se=(ne=re.readable)!==null&&ne!==void 0?ne:x(U),pe=(te=re.writable)!==null&&te!==void 0?te:E(U),de=U._writableState,Ne=U._readableState,Pe=()=>{U.writable||Ue()};let Me=O(U)&&x(U)===se&&E(U)===pe,Ee=R(U,!1);const Ue=()=>{Ee=!0,U.destroyed&&(Me=!1),!(Me&&(!U.readable||se))&&(!se||nt)&&G.call(U)};let nt=_(U,!1);const He=()=>{nt=!0,U.destroyed&&(Me=!1),!(Me&&(!U.writable||pe))&&(!pe||Ee)&&G.call(U)},je=ae=>{G.call(U,ae)};let Y=y(U);const be=()=>{Y=!0;const ae=M(U)||S(U);if(ae&&typeof ae!="boolean")return G.call(U,ae);if(se&&!nt&&x(U,!0)&&!_(U,!1))return G.call(U,new i);if(pe&&!Ee&&!R(U,!1))return G.call(U,new i);G.call(U)},Re=()=>{Y=!0;const ae=M(U)||S(U);if(ae&&typeof ae!="boolean")return G.call(U,ae);G.call(U)},ce=()=>{U.req.on("finish",Ue)};H(U)?(U.on("complete",Ue),Me||U.on("abort",be),U.req?ce():U.on("request",ce)):pe&&!de&&(U.on("end",Pe),U.on("close",Pe)),!Me&&typeof U.aborted=="boolean"&&U.on("aborted",be),U.on("end",He),U.on("finish",Ue),re.error!==!1&&U.on("error",je),U.on("close",be),Y?e.nextTick(be):de!=null&&de.errorEmitted||Ne!=null&&Ne.errorEmitted?Me||e.nextTick(Re):(!se&&(!Me||b(U))&&(Ee||C(U)===!1)||!pe&&(!Me||C(U))&&(nt||b(U)===!1)||Ne&&U.req&&U.aborted)&&e.nextTick(Re);const le=()=>{G=F,U.removeListener("aborted",be),U.removeListener("complete",Ue),U.removeListener("abort",be),U.removeListener("request",ce),U.req&&U.req.removeListener("finish",Ue),U.removeListener("end",Pe),U.removeListener("close",Pe),U.removeListener("finish",Ue),U.removeListener("end",He),U.removeListener("error",je),U.removeListener("close",be)};if(re.signal&&!Y){const ae=()=>{const Te=G;le(),Te.call(U,new t(void 0,{cause:re.signal.reason}))};if(re.signal.aborted)e.nextTick(ae);else{P=P||uo().addAbortListener;const Te=P(re.signal,ae),$e=G;G=a((...ke)=>{Te[p](),$e.apply(U,ke)})}}return le}function q(U,re,G){let ne=!1,te=F;if(re.signal)if(te=()=>{ne=!0,G.call(U,new t(void 0,{cause:re.signal.reason}))},re.signal.aborted)e.nextTick(te);else{P=P||uo().addAbortListener;const pe=P(re.signal,te),de=G;G=a((...Ne)=>{pe[p](),de.apply(U,Ne)})}const se=(...pe)=>{ne||e.nextTick(()=>G.apply(U,pe))};return h(U[B].promise,se,se),F}function K(U,re){var G;let ne=!1;return re===null&&(re=s),(G=re)!==null&&G!==void 0&&G.cleanup&&(u(re.cleanup,"cleanup"),ne=re.cleanup),new d((te,se)=>{const pe=Q(U,re,de=>{ne&&pe(),de?se(de):te()})})}return sS.exports=Q,sS.exports.finished=K,sS.exports}var zI,e$;function ry(){if(e$)return zI;e$=1;const e=sm(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=Wa(),{Symbol:i}=zi(),{kIsDestroyed:s,isDestroyed:a,isFinished:o,isServerRequest:l}=Ed(),c=i("kDestroy"),u=i("kConstruct");function d(O,B,P){O&&(O.stack,B&&!B.errored&&(B.errored=O),P&&!P.errored&&(P.errored=O))}function h(O,B){const P=this._readableState,H=this._writableState,F=H||P;return H!=null&&H.destroyed||P!=null&&P.destroyed?(typeof B=="function"&&B(),this):(d(O,H,P),H&&(H.destroyed=!0),P&&(P.destroyed=!0),F.constructed?p(this,O,B):this.once(c,function(Q){p(this,t(Q,O),B)}),this)}function p(O,B,P){let H=!1;function F(Q){if(H)return;H=!0;const q=O._readableState,K=O._writableState;d(Q,K,q),K&&(K.closed=!0),q&&(q.closed=!0),typeof P=="function"&&P(Q),Q?e.nextTick(y,O,Q):e.nextTick(b,O)}try{O._destroy(B||null,F)}catch(Q){F(Q)}}function y(O,B){x(O,B),b(O)}function b(O){const B=O._readableState,P=O._writableState;P&&(P.closeEmitted=!0),B&&(B.closeEmitted=!0),(P!=null&&P.emitClose||B!=null&&B.emitClose)&&O.emit("close")}function x(O,B){const P=O._readableState,H=O._writableState;H!=null&&H.errorEmitted||P!=null&&P.errorEmitted||(H&&(H.errorEmitted=!0),P&&(P.errorEmitted=!0),O.emit("error",B))}function w(){const O=this._readableState,B=this._writableState;O&&(O.constructed=!0,O.closed=!1,O.closeEmitted=!1,O.destroyed=!1,O.errored=null,O.errorEmitted=!1,O.reading=!1,O.ended=O.readable===!1,O.endEmitted=O.readable===!1),B&&(B.constructed=!0,B.destroyed=!1,B.closed=!1,B.closeEmitted=!1,B.errored=null,B.errorEmitted=!1,B.finalCalled=!1,B.prefinished=!1,B.ended=B.writable===!1,B.ending=B.writable===!1,B.finished=B.writable===!1)}function _(O,B,P){const H=O._readableState,F=O._writableState;if(F!=null&&F.destroyed||H!=null&&H.destroyed)return this;H!=null&&H.autoDestroy||F!=null&&F.autoDestroy?O.destroy(B):B&&(B.stack,F&&!F.errored&&(F.errored=B),H&&!H.errored&&(H.errored=B),P?e.nextTick(x,O,B):x(O,B))}function S(O,B){if(typeof O._construct!="function")return;const P=O._readableState,H=O._writableState;P&&(P.constructed=!1),H&&(H.constructed=!1),O.once(u,B),!(O.listenerCount(u)>1)&&e.nextTick(C,O)}function C(O){let B=!1;function P(H){if(B){_(O,H??new n);return}B=!0;const F=O._readableState,Q=O._writableState,q=Q||F;F&&(F.constructed=!0),Q&&(Q.constructed=!0),q.destroyed?O.emit(c,H):H?_(O,H,!0):e.nextTick(E,O)}try{O._construct(H=>{e.nextTick(P,H)})}catch(H){e.nextTick(P,H)}}function E(O){O.emit(u)}function T(O){return(O==null?void 0:O.setHeader)&&typeof O.abort=="function"}function R(O){O.emit("close")}function M(O,B){O.emit("error",B),e.nextTick(R,O)}function N(O,B){!O||a(O)||(!B&&!o(O)&&(B=new r),l(O)?(O.socket=null,O.destroy(B)):T(O)?O.abort():T(O.req)?O.req.abort():typeof O.destroy=="function"?O.destroy(B):typeof O.close=="function"?O.close():B?e.nextTick(M,O,B):e.nextTick(R,O),O.destroyed||(O[s]=!0))}return zI={construct:S,destroyer:N,destroy:h,undestroy:w,errorOrDestroy:_},zI}var UI,t$;function KO(){if(t$)return UI;t$=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=zi(),{EventEmitter:n}=pE();function r(s){n.call(this,s)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(s,a){const o=this;function l(b){s.writable&&s.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}s.on("drain",c),!s._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,s.end())}function h(){u||(u=!0,typeof s.destroy=="function"&&s.destroy())}function p(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}i(o,"error",p),i(s,"error",p);function y(){o.removeListener("data",l),s.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",p),s.removeListener("error",p),o.removeListener("end",y),o.removeListener("close",y),s.removeListener("close",y)}return o.on("end",y),o.on("close",y),s.on("close",y),s.emit("pipe",o),s};function i(s,a,o){if(typeof s.prependListener=="function")return s.prependListener(a,o);!s._events||!s._events[a]?s.on(a,o):e(s._events[a])?s._events[a].unshift(o):s._events[a]=[o,s._events[a]]}return UI={Stream:r,prependListener:i},UI}var qI={exports:{}},n$;function mE(){return n$||(n$=1,function(e){const{SymbolDispose:t}=zi(),{AbortError:n,codes:r}=Wa(),{isNodeStream:i,isWebStream:s,kControllerErrorFunction:a}=Ed(),o=hh(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,p){if(u(h,"signal"),!i(p)&&!s(p))throw new l("stream",["ReadableStream","WritableStream","Stream"],p);return e.exports.addAbortSignalNoValidate(h,p)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const p=i(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)p();else{c=c||uo().addAbortListener;const y=c(d,p);o(h,y[t])}return h}}(qI)),qI.exports}var VI,r$;function U1e(){if(r$)return VI;r$=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=zi(),{Buffer:i}=fh(),{inspect:s}=uo();return VI=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return i.alloc(0);const l=i.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=i.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return s(this,{...l,depth:0,customInspect:!1})}},VI}var HI,i$;function gE(){if(i$)return HI;i$=1;const{MathFloor:e,NumberIsInteger:t}=zi(),{validateInteger:n}=Lw(),{ERR_INVALID_ARG_VALUE:r}=Wa().codes;let i=16*1024,s=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?s:i}function l(u,d){n(d,"value",0),u?s=d:i=d}function c(u,d,h,p){const y=a(d,p,h);if(y!=null){if(!t(y)||y<0){const b=p?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return HI={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},HI}var WI={},aS={exports:{}},s$;function YO(){return s$||(s$=1,function(e,t){var n=fh(),r=n.Buffer;function i(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=s);function s(a,o,l){return r(a,o,l)}i(r,s),s.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},s.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(aS,aS.exports)),aS.exports}var a$;function q1e(){if(a$)return WI;a$=1;var e=YO().Buffer,t=e.isEncoding||function(w){switch(w=""+w,w&&w.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(w){if(!w)return"utf8";for(var _;;)switch(w){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return w;default:if(_)return;w=(""+w).toLowerCase(),_=!0}}function r(w){var _=n(w);if(typeof _!="string"&&(e.isEncoding===t||!t(w)))throw new Error("Unknown encoding: "+w);return _||w}WI.StringDecoder=i;function i(w){this.encoding=r(w);var _;switch(this.encoding){case"utf16le":this.text=d,this.end=h,_=4;break;case"utf8":this.fillLast=l,_=4;break;case"base64":this.text=p,this.end=y,_=3;break;default:this.write=b,this.end=x;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(_)}i.prototype.write=function(w){if(w.length===0)return"";var _,S;if(this.lastNeed){if(_=this.fillLast(w),_===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<w.length?_?_+this.text(w,S):this.text(w,S):_||""},i.prototype.end=u,i.prototype.text=c,i.prototype.fillLast=function(w){if(this.lastNeed<=w.length)return w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,this.lastTotal-this.lastNeed,0,w.length),this.lastNeed-=w.length};function s(w){return w<=127?0:w>>5===6?2:w>>4===14?3:w>>3===30?4:w>>6===2?-1:-2}function a(w,_,S){var C=_.length-1;if(C<S)return 0;var E=s(_[C]);return E>=0?(E>0&&(w.lastNeed=E-1),E):--C<S||E===-2?0:(E=s(_[C]),E>=0?(E>0&&(w.lastNeed=E-2),E):--C<S||E===-2?0:(E=s(_[C]),E>=0?(E>0&&(E===2?E=0:w.lastNeed=E-3),E):0))}function o(w,_,S){if((_[0]&192)!==128)return w.lastNeed=0,"";if(w.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return w.lastNeed=1,"";if(w.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return w.lastNeed=2,""}}function l(w){var _=this.lastTotal-this.lastNeed,S=o(this,w);if(S!==void 0)return S;if(this.lastNeed<=w.length)return w.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);w.copy(this.lastChar,_,0,w.length),this.lastNeed-=w.length}function c(w,_){var S=a(this,w,_);if(!this.lastNeed)return w.toString("utf8",_);this.lastTotal=S;var C=w.length-(S-this.lastNeed);return w.copy(this.lastChar,0,C),w.toString("utf8",_,C)}function u(w){var _=w&&w.length?this.write(w):"";return this.lastNeed?_+"":_}function d(w,_){if((w.length-_)%2===0){var S=w.toString("utf16le",_);if(S){var C=S.charCodeAt(S.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=w[w.length-1],w.toString("utf16le",_,w.length-1)}function h(w){var _=w&&w.length?this.write(w):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,S)}return _}function p(w,_){var S=(w.length-_)%3;return S===0?w.toString("base64",_):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=w[w.length-1]:(this.lastChar[0]=w[w.length-2],this.lastChar[1]=w[w.length-1]),w.toString("base64",_,w.length-S))}function y(w){var _=w&&w.length?this.write(w):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function b(w){return w.toString(this.encoding)}function x(w){return w&&w.length?this.write(w):""}return WI}var GI,o$;function dK(){if(o$)return GI;o$=1;const e=sm(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=zi(),{Buffer:i}=fh(),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_NULL_VALUES:a}=Wa().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof i)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new s("iterable",["Iterable"],c);const p=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;p._read=function(){y||(y=!0,x())},p._destroy=function(w,_){t(b(w),()=>e.nextTick(_,w),S=>e.nextTick(_,S||w))};async function b(w){const _=w!=null,S=typeof d.throw=="function";if(_&&S){const{value:C,done:E}=await d.throw(w);if(await C,E)return}if(typeof d.return=="function"){const{value:C}=await d.return();await C}}async function x(){for(;;){try{const{value:w,done:_}=h?await d.next():d.next();if(_)p.push(null);else{const S=w&&typeof w.then=="function"?await w:w;if(S===null)throw y=!1,new a;if(p.push(S))continue;y=!1}}catch(w){p.destroy(w)}break}}return p}return GI=o,GI}var KI,l$;function yE(){if(l$)return KI;l$=1;const e=sm(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:i,ObjectDefineProperties:s,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=zi();KI=ke,ke.ReadableState=$e;const{EventEmitter:p}=pE(),{Stream:y,prependListener:b}=KO(),{Buffer:x}=fh(),{addAbortSignal:w}=mE(),_=hh();let S=uo().debuglog("stream",ge=>{S=ge});const C=U1e(),E=ry(),{getHighWaterMark:T,getDefaultHighWaterMark:R}=gE(),{aggregateTwoErrors:M,codes:{ERR_INVALID_ARG_TYPE:N,ERR_METHOD_NOT_IMPLEMENTED:O,ERR_OUT_OF_RANGE:B,ERR_STREAM_PUSH_AFTER_EOF:P,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:H},AbortError:F}=Wa(),{validateObject:Q}=Lw(),q=h("kPaused"),{StringDecoder:K}=q1e(),U=dK();o(ke.prototype,y.prototype),o(ke,y);const re=()=>{},{errorOrDestroy:G}=E,ne=1,te=2,se=4,pe=8,de=16,Ne=32,Pe=64,Me=128,Ee=256,Ue=512,nt=1024,He=2048,je=4096,Y=8192,be=16384,Re=32768,ce=65536,le=1<<17,ae=1<<18;function Te(ge){return{enumerable:!1,get(){return(this.state&ge)!==0},set(Z){Z?this.state|=ge:this.state&=~ge}}}s($e.prototype,{objectMode:Te(ne),ended:Te(te),endEmitted:Te(se),reading:Te(pe),constructed:Te(de),sync:Te(Ne),needReadable:Te(Pe),emittedReadable:Te(Me),readableListening:Te(Ee),resumeScheduled:Te(Ue),errorEmitted:Te(nt),emitClose:Te(He),autoDestroy:Te(je),destroyed:Te(Y),closed:Te(be),closeEmitted:Te(Re),multiAwaitDrain:Te(ce),readingMore:Te(le),dataEmitted:Te(ae)});function $e(ge,Z,W){typeof W!="boolean"&&(W=Z instanceof md()),this.state=He|je|de|Ne,ge&&ge.objectMode&&(this.state|=ne),W&&ge&&ge.readableObjectMode&&(this.state|=ne),this.highWaterMark=ge?T(this,ge,"readableHighWaterMark",W):R(!1),this.buffer=new C,this.length=0,this.pipes=[],this.flowing=null,this[q]=null,ge&&ge.emitClose===!1&&(this.state&=-2049),ge&&ge.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=ge&&ge.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,ge&&ge.encoding&&(this.decoder=new K(ge.encoding),this.encoding=ge.encoding)}function ke(ge){if(!(this instanceof ke))return new ke(ge);const Z=this instanceof md();this._readableState=new $e(ge,this,Z),ge&&(typeof ge.read=="function"&&(this._read=ge.read),typeof ge.destroy=="function"&&(this._destroy=ge.destroy),typeof ge.construct=="function"&&(this._construct=ge.construct),ge.signal&&!Z&&w(ge.signal,this)),y.call(this,ge),E.construct(this,()=>{this._readableState.needReadable&&D(this,this._readableState)})}ke.prototype.destroy=E.destroy,ke.prototype._undestroy=E.undestroy,ke.prototype._destroy=function(ge,Z){Z(ge)},ke.prototype[p.captureRejectionSymbol]=function(ge){this.destroy(ge)},ke.prototype[u]=function(){let ge;return this.destroyed||(ge=this.readableEnded?null:new F,this.destroy(ge)),new l((Z,W)=>_(this,J=>J&&J!==ge?W(J):Z(null)))},ke.prototype.push=function(ge,Z){return ot(this,ge,Z,!1)},ke.prototype.unshift=function(ge,Z){return ot(this,ge,Z,!0)};function ot(ge,Z,W,J){S("readableAddChunk",Z);const ye=ge._readableState;let Oe;if((ye.state&ne)===0&&(typeof Z=="string"?(W=W||ye.defaultEncoding,ye.encoding!==W&&(J&&ye.encoding?Z=x.from(Z,W).toString(ye.encoding):(Z=x.from(Z,W),W=""))):Z instanceof x?W="":y._isUint8Array(Z)?(Z=y._uint8ArrayToBuffer(Z),W=""):Z!=null&&(Oe=new N("chunk",["string","Buffer","Uint8Array"],Z))),Oe)G(ge,Oe);else if(Z===null)ye.state&=-9,Ft(ge,ye);else if((ye.state&ne)!==0||Z&&Z.length>0)if(J)if((ye.state&se)!==0)G(ge,new H);else{if(ye.destroyed||ye.errored)return!1;At(ge,ye,Z,!0)}else if(ye.ended)G(ge,new P);else{if(ye.destroyed||ye.errored)return!1;ye.state&=-9,ye.decoder&&!W?(Z=ye.decoder.write(Z),ye.objectMode||Z.length!==0?At(ge,ye,Z,!1):D(ge,ye)):At(ge,ye,Z,!1)}else J||(ye.state&=-9,D(ge,ye));return!ye.ended&&(ye.length<ye.highWaterMark||ye.length===0)}function At(ge,Z,W,J){Z.flowing&&Z.length===0&&!Z.sync&&ge.listenerCount("data")>0?((Z.state&ce)!==0?Z.awaitDrainWriters.clear():Z.awaitDrainWriters=null,Z.dataEmitted=!0,ge.emit("data",W)):(Z.length+=Z.objectMode?1:W.length,J?Z.buffer.unshift(W):Z.buffer.push(W),(Z.state&Pe)!==0&&tn(ge)),D(ge,Z)}ke.prototype.isPaused=function(){const ge=this._readableState;return ge[q]===!0||ge.flowing===!1},ke.prototype.setEncoding=function(ge){const Z=new K(ge);this._readableState.decoder=Z,this._readableState.encoding=this._readableState.decoder.encoding;const W=this._readableState.buffer;let J="";for(const ye of W)J+=Z.write(ye);return W.clear(),J!==""&&W.push(J),this._readableState.length=J.length,this};const ft=1073741824;function jt(ge){if(ge>ft)throw new B("size","<= 1GiB",ge);return ge--,ge|=ge>>>1,ge|=ge>>>2,ge|=ge>>>4,ge|=ge>>>8,ge|=ge>>>16,ge++,ge}function Bt(ge,Z){return ge<=0||Z.length===0&&Z.ended?0:(Z.state&ne)!==0?1:r(ge)?Z.flowing&&Z.length?Z.buffer.first().length:Z.length:ge<=Z.length?ge:Z.ended?Z.length:0}ke.prototype.read=function(ge){S("read",ge),ge===void 0?ge=NaN:n(ge)||(ge=i(ge,10));const Z=this._readableState,W=ge;if(ge>Z.highWaterMark&&(Z.highWaterMark=jt(ge)),ge!==0&&(Z.state&=-129),ge===0&&Z.needReadable&&((Z.highWaterMark!==0?Z.length>=Z.highWaterMark:Z.length>0)||Z.ended))return S("read: emitReadable",Z.length,Z.ended),Z.length===0&&Z.ended?rt(this):tn(this),null;if(ge=Bt(ge,Z),ge===0&&Z.ended)return Z.length===0&&rt(this),null;let J=(Z.state&Pe)!==0;if(S("need readable",J),(Z.length===0||Z.length-ge<Z.highWaterMark)&&(J=!0,S("length less than watermark",J)),Z.ended||Z.reading||Z.destroyed||Z.errored||!Z.constructed)J=!1,S("reading, ended or constructing",J);else if(J){S("do read"),Z.state|=pe|Ne,Z.length===0&&(Z.state|=Pe);try{this._read(Z.highWaterMark)}catch(Oe){G(this,Oe)}Z.state&=-33,Z.reading||(ge=Bt(W,Z))}let ye;return ge>0?ye=qe(ge,Z):ye=null,ye===null?(Z.needReadable=Z.length<=Z.highWaterMark,ge=0):(Z.length-=ge,Z.multiAwaitDrain?Z.awaitDrainWriters.clear():Z.awaitDrainWriters=null),Z.length===0&&(Z.ended||(Z.needReadable=!0),W!==ge&&Z.ended&&rt(this)),ye!==null&&!Z.errorEmitted&&!Z.closeEmitted&&(Z.dataEmitted=!0,this.emit("data",ye)),ye};function Ft(ge,Z){if(S("onEofChunk"),!Z.ended){if(Z.decoder){const W=Z.decoder.end();W&&W.length&&(Z.buffer.push(W),Z.length+=Z.objectMode?1:W.length)}Z.ended=!0,Z.sync?tn(ge):(Z.needReadable=!1,Z.emittedReadable=!0,xe(ge))}}function tn(ge){const Z=ge._readableState;S("emitReadable",Z.needReadable,Z.emittedReadable),Z.needReadable=!1,Z.emittedReadable||(S("emitReadable",Z.flowing),Z.emittedReadable=!0,e.nextTick(xe,ge))}function xe(ge){const Z=ge._readableState;S("emitReadable_",Z.destroyed,Z.length,Z.ended),!Z.destroyed&&!Z.errored&&(Z.length||Z.ended)&&(ge.emit("readable"),Z.emittedReadable=!1),Z.needReadable=!Z.flowing&&!Z.ended&&Z.length<=Z.highWaterMark,yt(ge)}function D(ge,Z){!Z.readingMore&&Z.constructed&&(Z.readingMore=!0,e.nextTick(X,ge,Z))}function X(ge,Z){for(;!Z.reading&&!Z.ended&&(Z.length<Z.highWaterMark||Z.flowing&&Z.length===0);){const W=Z.length;if(S("maybeReadMore read 0"),ge.read(0),W===Z.length)break}Z.readingMore=!1}ke.prototype._read=function(ge){throw new O("_read()")},ke.prototype.pipe=function(ge,Z){const W=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(ge),S("pipe count=%d opts=%j",J.pipes.length,Z);const Oe=(!Z||Z.end!==!1)&&ge!==e.stdout&&ge!==e.stderr?vt:Kr;J.endEmitted?e.nextTick(Oe):W.once("end",Oe),ge.on("unpipe",We);function We(pr,un){S("onunpipe"),pr===W&&un&&un.hasUnpiped===!1&&(un.hasUnpiped=!0,Yt())}function vt(){S("onend"),ge.end()}let Xt,jn=!1;function Yt(){S("cleanup"),ge.removeListener("close",xr),ge.removeListener("finish",Gr),Xt&&ge.removeListener("drain",Xt),ge.removeListener("error",or),ge.removeListener("unpipe",We),W.removeListener("end",vt),W.removeListener("end",Kr),W.removeListener("data",on),jn=!0,Xt&&J.awaitDrainWriters&&(!ge._writableState||ge._writableState.needDrain)&&Xt()}function Qt(){jn||(J.pipes.length===1&&J.pipes[0]===ge?(S("false write response, pause",0),J.awaitDrainWriters=ge,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(ge)&&(S("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(ge)),W.pause()),Xt||(Xt=me(W,ge),ge.on("drain",Xt))}W.on("data",on);function on(pr){S("ondata");const un=ge.write(pr);S("dest.write",un),un===!1&&Qt()}function or(pr){if(S("onerror",pr),Kr(),ge.removeListener("error",or),ge.listenerCount("error")===0){const un=ge._writableState||ge._readableState;un&&!un.errorEmitted?G(ge,pr):ge.emit("error",pr)}}b(ge,"error",or);function xr(){ge.removeListener("finish",Gr),Kr()}ge.once("close",xr);function Gr(){S("onfinish"),ge.removeListener("close",xr),Kr()}ge.once("finish",Gr);function Kr(){S("unpipe"),W.unpipe(ge)}return ge.emit("pipe",W),ge.writableNeedDrain===!0?Qt():J.flowing||(S("pipe resume"),W.resume()),ge};function me(ge,Z){return function(){const J=ge._readableState;J.awaitDrainWriters===Z?(S("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(S("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Z)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&ge.listenerCount("data")&&ge.resume()}}ke.prototype.unpipe=function(ge){const Z=this._readableState,W={hasUnpiped:!1};if(Z.pipes.length===0)return this;if(!ge){const ye=Z.pipes;Z.pipes=[],this.pause();for(let Oe=0;Oe<ye.length;Oe++)ye[Oe].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Z.pipes,ge);return J===-1?this:(Z.pipes.splice(J,1),Z.pipes.length===0&&this.pause(),ge.emit("unpipe",this,W),this)},ke.prototype.on=function(ge,Z){const W=y.prototype.on.call(this,ge,Z),J=this._readableState;return ge==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):ge==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,S("on readable",J.length,J.reading),J.length?tn(this):J.reading||e.nextTick(we,this)),W},ke.prototype.addListener=ke.prototype.on,ke.prototype.removeListener=function(ge,Z){const W=y.prototype.removeListener.call(this,ge,Z);return ge==="readable"&&e.nextTick(De,this),W},ke.prototype.off=ke.prototype.removeListener,ke.prototype.removeAllListeners=function(ge){const Z=y.prototype.removeAllListeners.apply(this,arguments);return(ge==="readable"||ge===void 0)&&e.nextTick(De,this),Z};function De(ge){const Z=ge._readableState;Z.readableListening=ge.listenerCount("readable")>0,Z.resumeScheduled&&Z[q]===!1?Z.flowing=!0:ge.listenerCount("data")>0?ge.resume():Z.readableListening||(Z.flowing=null)}function we(ge){S("readable nexttick read 0"),ge.read(0)}ke.prototype.resume=function(){const ge=this._readableState;return ge.flowing||(S("resume"),ge.flowing=!ge.readableListening,Ie(this,ge)),ge[q]=!1,this};function Ie(ge,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,e.nextTick(fe,ge,Z))}function fe(ge,Z){S("resume",Z.reading),Z.reading||ge.read(0),Z.resumeScheduled=!1,ge.emit("resume"),yt(ge),Z.flowing&&!Z.reading&&ge.read(0)}ke.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[q]=!0,this};function yt(ge){const Z=ge._readableState;for(S("flow",Z.flowing);Z.flowing&&ge.read()!==null;);}ke.prototype.wrap=function(ge){let Z=!1;ge.on("data",J=>{!this.push(J)&&ge.pause&&(Z=!0,ge.pause())}),ge.on("end",()=>{this.push(null)}),ge.on("error",J=>{G(this,J)}),ge.on("close",()=>{this.destroy()}),ge.on("destroy",()=>{this.destroy()}),this._read=()=>{Z&&ge.resume&&(Z=!1,ge.resume())};const W=a(ge);for(let J=1;J<W.length;J++){const ye=W[J];this[ye]===void 0&&typeof ge[ye]=="function"&&(this[ye]=ge[ye].bind(ge))}return this},ke.prototype[d]=function(){return _t(this)},ke.prototype.iterator=function(ge){return ge!==void 0&&Q(ge,"options"),_t(this,ge)};function _t(ge,Z){typeof ge.read!="function"&&(ge=ke.wrap(ge,{objectMode:!0}));const W=z(ge,Z);return W.stream=ge,W}async function*z(ge,Z){let W=re;function J(We){this===ge?(W(),W=re):W=We}ge.on("readable",J);let ye;const Oe=_(ge,{writable:!1},We=>{ye=We?M(ye,We):null,W(),W=re});try{for(;;){const We=ge.destroyed?null:ge.read();if(We!==null)yield We;else{if(ye)throw ye;if(ye===null)return;await new l(J)}}}catch(We){throw ye=M(ye,We),ye}finally{(ye||(Z==null?void 0:Z.destroyOnReturn)!==!1)&&(ye===void 0||ge._readableState.autoDestroy)?E.destroyer(ge,null):(ge.off("readable",J),Oe())}}s(ke.prototype,{readable:{__proto__:null,get(){const ge=this._readableState;return!!ge&&ge.readable!==!1&&!ge.destroyed&&!ge.errorEmitted&&!ge.endEmitted},set(ge){this._readableState&&(this._readableState.readable=!!ge)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(ge){this._readableState&&(this._readableState.flowing=ge)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(ge){this._readableState&&(this._readableState.destroyed=ge)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),s($e.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[q]!==!1},set(ge){this[q]=!!ge}}}),ke._fromList=qe;function qe(ge,Z){if(Z.length===0)return null;let W;return Z.objectMode?W=Z.buffer.shift():!ge||ge>=Z.length?(Z.decoder?W=Z.buffer.join(""):Z.buffer.length===1?W=Z.buffer.first():W=Z.buffer.concat(Z.length),Z.buffer.clear()):W=Z.buffer.consume(ge,Z.decoder),W}function rt(ge){const Z=ge._readableState;S("endReadable",Z.endEmitted),Z.endEmitted||(Z.ended=!0,e.nextTick(ve,Z,ge))}function ve(ge,Z){if(S("endReadableNT",ge.endEmitted,ge.length),!ge.errored&&!ge.closeEmitted&&!ge.endEmitted&&ge.length===0){if(ge.endEmitted=!0,Z.emit("end"),Z.writable&&Z.allowHalfOpen===!1)e.nextTick(Se,Z);else if(ge.autoDestroy){const W=Z._writableState;(!W||W.autoDestroy&&(W.finished||W.writable===!1))&&Z.destroy()}}}function Se(ge){ge.writable&&!ge.writableEnded&&!ge.destroyed&&ge.end()}ke.from=function(ge,Z){return U(ke,ge,Z)};let ze;function Tt(){return ze===void 0&&(ze={}),ze}return ke.fromWeb=function(ge,Z){return Tt().newStreamReadableFromReadableStream(ge,Z)},ke.toWeb=function(ge,Z){return Tt().newReadableStreamFromStreamReadable(ge,Z)},ke.wrap=function(ge,Z){var W,J;return new ke({objectMode:(W=(J=ge.readableObjectMode)!==null&&J!==void 0?J:ge.objectMode)!==null&&W!==void 0?W:!0,...Z,destroy(ye,Oe){E.destroyer(ge,ye),Oe(ye)}}).wrap(ge)},KI}var YI,c$;function ZO(){if(c$)return YI;c$=1;const e=sm(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:i,ObjectDefineProperties:s,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=zi();YI=Q,Q.WritableState=H;const{EventEmitter:u}=pE(),d=KO().Stream,{Buffer:h}=fh(),p=ry(),{addAbortSignal:y}=mE(),{getHighWaterMark:b,getDefaultHighWaterMark:x}=gE(),{ERR_INVALID_ARG_TYPE:w,ERR_METHOD_NOT_IMPLEMENTED:_,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:C,ERR_STREAM_DESTROYED:E,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:R,ERR_STREAM_WRITE_AFTER_END:M,ERR_UNKNOWN_ENCODING:N}=Wa().codes,{errorOrDestroy:O}=p;a(Q.prototype,d.prototype),a(Q,d);function B(){}const P=l("kOnFinished");function H(je,Y,be){typeof be!="boolean"&&(be=Y instanceof md()),this.objectMode=!!(je&&je.objectMode),be&&(this.objectMode=this.objectMode||!!(je&&je.writableObjectMode)),this.highWaterMark=je?b(this,je,"writableHighWaterMark",be):x(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Re=!!(je&&je.decodeStrings===!1);this.decodeStrings=!Re,this.defaultEncoding=je&&je.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=G.bind(void 0,Y),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,F(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!je||je.emitClose!==!1,this.autoDestroy=!je||je.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[P]=[]}function F(je){je.buffered=[],je.bufferedIndex=0,je.allBuffers=!0,je.allNoop=!0}H.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},i(H.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function Q(je){const Y=this instanceof md();if(!Y&&!r(Q,this))return new Q(je);this._writableState=new H(je,this,Y),je&&(typeof je.write=="function"&&(this._write=je.write),typeof je.writev=="function"&&(this._writev=je.writev),typeof je.destroy=="function"&&(this._destroy=je.destroy),typeof je.final=="function"&&(this._final=je.final),typeof je.construct=="function"&&(this._construct=je.construct),je.signal&&y(je.signal,this)),d.call(this,je),p.construct(this,()=>{const be=this._writableState;be.writing||pe(this,be),Me(this,be)})}i(Q,c,{__proto__:null,value:function(je){return r(this,je)?!0:this!==Q?!1:je&&je._writableState instanceof H}}),Q.prototype.pipe=function(){O(this,new C)};function q(je,Y,be,Re){const ce=je._writableState;if(typeof be=="function")Re=be,be=ce.defaultEncoding;else{if(!be)be=ce.defaultEncoding;else if(be!=="buffer"&&!h.isEncoding(be))throw new N(be);typeof Re!="function"&&(Re=B)}if(Y===null)throw new R;if(!ce.objectMode)if(typeof Y=="string")ce.decodeStrings!==!1&&(Y=h.from(Y,be),be="buffer");else if(Y instanceof h)be="buffer";else if(d._isUint8Array(Y))Y=d._uint8ArrayToBuffer(Y),be="buffer";else throw new w("chunk",["string","Buffer","Uint8Array"],Y);let le;return ce.ending?le=new M:ce.destroyed&&(le=new E("write")),le?(e.nextTick(Re,le),O(je,le,!0),le):(ce.pendingcb++,K(je,ce,Y,be,Re))}Q.prototype.write=function(je,Y,be){return q(this,je,Y,be)===!0},Q.prototype.cork=function(){this._writableState.corked++},Q.prototype.uncork=function(){const je=this._writableState;je.corked&&(je.corked--,je.writing||pe(this,je))},Q.prototype.setDefaultEncoding=function(Y){if(typeof Y=="string"&&(Y=o(Y)),!h.isEncoding(Y))throw new N(Y);return this._writableState.defaultEncoding=Y,this};function K(je,Y,be,Re,ce){const le=Y.objectMode?1:be.length;Y.length+=le;const ae=Y.length<Y.highWaterMark;return ae||(Y.needDrain=!0),Y.writing||Y.corked||Y.errored||!Y.constructed?(Y.buffered.push({chunk:be,encoding:Re,callback:ce}),Y.allBuffers&&Re!=="buffer"&&(Y.allBuffers=!1),Y.allNoop&&ce!==B&&(Y.allNoop=!1)):(Y.writelen=le,Y.writecb=ce,Y.writing=!0,Y.sync=!0,je._write(be,Re,Y.onwrite),Y.sync=!1),ae&&!Y.errored&&!Y.destroyed}function U(je,Y,be,Re,ce,le,ae){Y.writelen=Re,Y.writecb=ae,Y.writing=!0,Y.sync=!0,Y.destroyed?Y.onwrite(new E("write")):be?je._writev(ce,Y.onwrite):je._write(ce,le,Y.onwrite),Y.sync=!1}function re(je,Y,be,Re){--Y.pendingcb,Re(be),se(Y),O(je,be)}function G(je,Y){const be=je._writableState,Re=be.sync,ce=be.writecb;if(typeof ce!="function"){O(je,new S);return}be.writing=!1,be.writecb=null,be.length-=be.writelen,be.writelen=0,Y?(Y.stack,be.errored||(be.errored=Y),je._readableState&&!je._readableState.errored&&(je._readableState.errored=Y),Re?e.nextTick(re,je,be,Y,ce):re(je,be,Y,ce)):(be.buffered.length>be.bufferedIndex&&pe(je,be),Re?be.afterWriteTickInfo!==null&&be.afterWriteTickInfo.cb===ce?be.afterWriteTickInfo.count++:(be.afterWriteTickInfo={count:1,cb:ce,stream:je,state:be},e.nextTick(ne,be.afterWriteTickInfo)):te(je,be,1,ce))}function ne({stream:je,state:Y,count:be,cb:Re}){return Y.afterWriteTickInfo=null,te(je,Y,be,Re)}function te(je,Y,be,Re){for(!Y.ending&&!je.destroyed&&Y.length===0&&Y.needDrain&&(Y.needDrain=!1,je.emit("drain"));be-- >0;)Y.pendingcb--,Re();Y.destroyed&&se(Y),Me(je,Y)}function se(je){if(je.writing)return;for(let ce=je.bufferedIndex;ce<je.buffered.length;++ce){var Y;const{chunk:le,callback:ae}=je.buffered[ce],Te=je.objectMode?1:le.length;je.length-=Te,ae((Y=je.errored)!==null&&Y!==void 0?Y:new E("write"))}const be=je[P].splice(0);for(let ce=0;ce<be.length;ce++){var Re;be[ce]((Re=je.errored)!==null&&Re!==void 0?Re:new E("end"))}F(je)}function pe(je,Y){if(Y.corked||Y.bufferProcessing||Y.destroyed||!Y.constructed)return;const{buffered:be,bufferedIndex:Re,objectMode:ce}=Y,le=be.length-Re;if(!le)return;let ae=Re;if(Y.bufferProcessing=!0,le>1&&je._writev){Y.pendingcb-=le-1;const Te=Y.allNoop?B:ke=>{for(let ot=ae;ot<be.length;++ot)be[ot].callback(ke)},$e=Y.allNoop&&ae===0?be:t(be,ae);$e.allBuffers=Y.allBuffers,U(je,Y,!0,Y.length,$e,"",Te),F(Y)}else{do{const{chunk:Te,encoding:$e,callback:ke}=be[ae];be[ae++]=null;const ot=ce?1:Te.length;U(je,Y,!1,ot,Te,$e,ke)}while(ae<be.length&&!Y.writing);ae===be.length?F(Y):ae>256?(be.splice(0,ae),Y.bufferedIndex=0):Y.bufferedIndex=ae}Y.bufferProcessing=!1}Q.prototype._write=function(je,Y,be){if(this._writev)this._writev([{chunk:je,encoding:Y}],be);else throw new _("_write()")},Q.prototype._writev=null,Q.prototype.end=function(je,Y,be){const Re=this._writableState;typeof je=="function"?(be=je,je=null,Y=null):typeof Y=="function"&&(be=Y,Y=null);let ce;if(je!=null){const le=q(this,je,Y);le instanceof n&&(ce=le)}return Re.corked&&(Re.corked=1,this.uncork()),ce||(!Re.errored&&!Re.ending?(Re.ending=!0,Me(this,Re,!0),Re.ended=!0):Re.finished?ce=new T("end"):Re.destroyed&&(ce=new E("end"))),typeof be=="function"&&(ce||Re.finished?e.nextTick(be,ce):Re[P].push(be)),this};function de(je){return je.ending&&!je.destroyed&&je.constructed&&je.length===0&&!je.errored&&je.buffered.length===0&&!je.finished&&!je.writing&&!je.errorEmitted&&!je.closeEmitted}function Ne(je,Y){let be=!1;function Re(ce){if(be){O(je,ce??S());return}if(be=!0,Y.pendingcb--,ce){const le=Y[P].splice(0);for(let ae=0;ae<le.length;ae++)le[ae](ce);O(je,ce,Y.sync)}else de(Y)&&(Y.prefinished=!0,je.emit("prefinish"),Y.pendingcb++,e.nextTick(Ee,je,Y))}Y.sync=!0,Y.pendingcb++;try{je._final(Re)}catch(ce){Re(ce)}Y.sync=!1}function Pe(je,Y){!Y.prefinished&&!Y.finalCalled&&(typeof je._final=="function"&&!Y.destroyed?(Y.finalCalled=!0,Ne(je,Y)):(Y.prefinished=!0,je.emit("prefinish")))}function Me(je,Y,be){de(Y)&&(Pe(je,Y),Y.pendingcb===0&&(be?(Y.pendingcb++,e.nextTick((Re,ce)=>{de(ce)?Ee(Re,ce):ce.pendingcb--},je,Y)):de(Y)&&(Y.pendingcb++,Ee(je,Y))))}function Ee(je,Y){Y.pendingcb--,Y.finished=!0;const be=Y[P].splice(0);for(let Re=0;Re<be.length;Re++)be[Re]();if(je.emit("finish"),Y.autoDestroy){const Re=je._readableState;(!Re||Re.autoDestroy&&(Re.endEmitted||Re.readable===!1))&&je.destroy()}}s(Q.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(je){this._writableState&&(this._writableState.destroyed=je)}},writable:{__proto__:null,get(){const je=this._writableState;return!!je&&je.writable!==!1&&!je.destroyed&&!je.errored&&!je.ending&&!je.ended},set(je){this._writableState&&(this._writableState.writable=!!je)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const je=this._writableState;return je?!je.destroyed&&!je.ending&&je.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const Ue=p.destroy;Q.prototype.destroy=function(je,Y){const be=this._writableState;return!be.destroyed&&(be.bufferedIndex<be.buffered.length||be[P].length)&&e.nextTick(se,be),Ue.call(this,je,Y),this},Q.prototype._undestroy=p.undestroy,Q.prototype._destroy=function(je,Y){Y(je)},Q.prototype[u.captureRejectionSymbol]=function(je){this.destroy(je)};let nt;function He(){return nt===void 0&&(nt={}),nt}return Q.fromWeb=function(je,Y){return He().newStreamWritableFromWritableStream(je,Y)},Q.toWeb=function(je){return He().newWritableStreamFromStreamWritable(je)},YI}var ZI,u$;function V1e(){if(u$)return ZI;u$=1;const e=sm(),t=fh(),{isReadable:n,isWritable:r,isIterable:i,isNodeStream:s,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=Ed(),d=hh(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:y}}=Wa(),{destroyer:b}=ry(),x=md(),w=yE(),_=ZO(),{createDeferredPromise:S}=uo(),C=dK(),E=globalThis.Blob||t.Blob,T=typeof E<"u"?function(H){return H instanceof E}:function(H){return!1},R=globalThis.AbortController||kx().AbortController,{FunctionPrototypeCall:M}=zi();class N extends x{constructor(H){super(H),(H==null?void 0:H.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(H==null?void 0:H.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}ZI=function P(H,F){if(l(H))return H;if(a(H))return B({readable:H});if(o(H))return B({writable:H});if(s(H))return B({writable:!1,readable:!1});if(c(H))return B({readable:w.fromWeb(H)});if(u(H))return B({writable:_.fromWeb(H)});if(typeof H=="function"){const{value:q,write:K,final:U,destroy:re}=O(H);if(i(q))return C(N,q,{objectMode:!0,write:K,final:U,destroy:re});const G=q==null?void 0:q.then;if(typeof G=="function"){let ne;const te=M(G,q,se=>{if(se!=null)throw new y("nully","body",se)},se=>{b(ne,se)});return ne=new N({objectMode:!0,readable:!1,write:K,final(se){U(async()=>{try{await te,e.nextTick(se,null)}catch(pe){e.nextTick(se,pe)}})},destroy:re})}throw new y("Iterable, AsyncIterable or AsyncFunction",F,q)}if(T(H))return P(H.arrayBuffer());if(i(H))return C(N,H,{objectMode:!0,writable:!1});if(c(H==null?void 0:H.readable)&&u(H==null?void 0:H.writable))return N.fromWeb(H);if(typeof(H==null?void 0:H.writable)=="object"||typeof(H==null?void 0:H.readable)=="object"){const q=H!=null&&H.readable?a(H==null?void 0:H.readable)?H==null?void 0:H.readable:P(H.readable):void 0,K=H!=null&&H.writable?o(H==null?void 0:H.writable)?H==null?void 0:H.writable:P(H.writable):void 0;return B({readable:q,writable:K})}const Q=H==null?void 0:H.then;if(typeof Q=="function"){let q;return M(Q,H,K=>{K!=null&&q.push(K),q.push(null)},K=>{b(q,K)}),q=new N({objectMode:!0,writable:!1,read(){}})}throw new p(F,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],H)};function O(P){let{promise:H,resolve:F}=S();const Q=new R,q=Q.signal;return{value:P(async function*(){for(;;){const U=H;H=null;const{chunk:re,done:G,cb:ne}=await U;if(e.nextTick(ne),G)return;if(q.aborted)throw new h(void 0,{cause:q.reason});({promise:H,resolve:F}=S()),yield re}}(),{signal:q}),write(U,re,G){const ne=F;F=null,ne({chunk:U,done:!1,cb:G})},final(U){const re=F;F=null,re({done:!0,cb:U})},destroy(U,re){Q.abort(),re(U)}}}function B(P){const H=P.readable&&typeof P.readable.read!="function"?w.wrap(P.readable):P.readable,F=P.writable;let Q=!!n(H),q=!!r(F),K,U,re,G,ne;function te(se){const pe=G;G=null,pe?pe(se):se&&ne.destroy(se)}return ne=new N({readableObjectMode:!!(H!=null&&H.readableObjectMode),writableObjectMode:!!(F!=null&&F.writableObjectMode),readable:Q,writable:q}),q&&(d(F,se=>{q=!1,se&&b(H,se),te(se)}),ne._write=function(se,pe,de){F.write(se,pe)?de():K=de},ne._final=function(se){F.end(),U=se},F.on("drain",function(){if(K){const se=K;K=null,se()}}),F.on("finish",function(){if(U){const se=U;U=null,se()}})),Q&&(d(H,se=>{Q=!1,se&&b(H,se),te(se)}),H.on("readable",function(){if(re){const se=re;re=null,se()}}),H.on("end",function(){ne.push(null)}),ne._read=function(){for(;;){const se=H.read();if(se===null){re=ne._read;return}if(!ne.push(se))return}}),ne._destroy=function(se,pe){!se&&G!==null&&(se=new h),re=null,K=null,U=null,G===null?pe(se):(G=pe,b(F,se),b(H,se))},ne}return ZI}var XI,d$;function md(){if(d$)return XI;d$=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=zi();XI=a;const i=yE(),s=ZO();r(a.prototype,i.prototype),r(a,i);{const u=n(s.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=s.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);i.call(this,u),s.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(s.prototype,"writableLength")},writableFinished:{__proto__:null,...t(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=V1e()),c(u,"body")},XI}var JI,f$;function fK(){if(f$)return JI;f$=1;const{ObjectSetPrototypeOf:e,Symbol:t}=zi();JI=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=Wa().codes,r=md(),{getHighWaterMark:i}=gE();e(a.prototype,r.prototype),e(a,r);const s=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?i(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[s]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,p=this._writableState,y=h.length;this._transform(c,u,(b,x)=>{if(b){d(b);return}x!=null&&this.push(x),p.ended||y===h.length||h.length<h.highWaterMark?d():this[s]=d})},a.prototype._read=function(){if(this[s]){const c=this[s];this[s]=null,c()}},JI}var QI,h$;function hK(){if(h$)return QI;h$=1;const{ObjectSetPrototypeOf:e}=zi();QI=n;const t=fK();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,i,s){s(null,r)},QI}var eM,p$;function XO(){if(p$)return eM;p$=1;const e=sm(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:i}=zi(),s=hh(),{once:a}=uo(),o=ry(),l=md(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:p,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=Wa(),{validateFunction:x,validateAbortSignal:w}=Lw(),{isIterable:_,isReadable:S,isReadableNodeStream:C,isNodeStream:E,isTransformStream:T,isWebStream:R,isReadableStream:M,isReadableFinished:N}=Ed(),O=globalThis.AbortController||kx().AbortController;let B,P,H;function F(se,pe,de){let Ne=!1;se.on("close",()=>{Ne=!0});const Pe=s(se,{readable:pe,writable:de},Me=>{Ne=!Me});return{destroy:Me=>{Ne||(Ne=!0,o.destroyer(se,Me||new p("pipe")))},cleanup:Pe}}function Q(se){return x(se[se.length-1],"streams[stream.length - 1]"),se.pop()}function q(se){if(_(se))return se;if(C(se))return K(se);throw new u("val",["Readable","Iterable","AsyncIterable"],se)}async function*K(se){P||(P=yE()),yield*P.prototype[r].call(se)}async function U(se,pe,de,{end:Ne}){let Pe,Me=null;const Ee=He=>{if(He&&(Pe=He),Me){const je=Me;Me=null,je()}},Ue=()=>new n((He,je)=>{Pe?je(Pe):Me=()=>{Pe?je(Pe):He()}});pe.on("drain",Ee);const nt=s(pe,{readable:!1},Ee);try{pe.writableNeedDrain&&await Ue();for await(const He of se)pe.write(He)||await Ue();Ne&&(pe.end(),await Ue()),de()}catch(He){de(Pe!==He?c(Pe,He):He)}finally{nt(),pe.off("drain",Ee)}}async function re(se,pe,de,{end:Ne}){T(pe)&&(pe=pe.writable);const Pe=pe.getWriter();try{for await(const Me of se)await Pe.ready,Pe.write(Me).catch(()=>{});await Pe.ready,Ne&&await Pe.close(),de()}catch(Me){try{await Pe.abort(Me),de(Me)}catch(Ee){de(Ee)}}}function G(...se){return ne(se,a(Q(se)))}function ne(se,pe,de){if(se.length===1&&t(se[0])&&(se=se[0]),se.length<2)throw new h("streams");const Ne=new O,Pe=Ne.signal,Me=de==null?void 0:de.signal,Ee=[];w(Me,"options.signal");function Ue(){ce(new b)}H=H||uo().addAbortListener;let nt;Me&&(nt=H(Me,Ue));let He,je;const Y=[];let be=0;function Re($e){ce($e,--be===0)}function ce($e,ke){var ot;if($e&&(!He||He.code==="ERR_STREAM_PREMATURE_CLOSE")&&(He=$e),!(!He&&!ke)){for(;Y.length;)Y.shift()(He);(ot=nt)===null||ot===void 0||ot[i](),Ne.abort(),ke&&(He||Ee.forEach(At=>At()),e.nextTick(pe,He,je))}}let le;for(let $e=0;$e<se.length;$e++){const ke=se[$e],ot=$e<se.length-1,At=$e>0,ft=ot||(de==null?void 0:de.end)!==!1,jt=$e===se.length-1;if(E(ke)){let Bt=function(Ft){Ft&&Ft.name!=="AbortError"&&Ft.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Re(Ft)};if(ft){const{destroy:Ft,cleanup:tn}=F(ke,ot,At);Y.push(Ft),S(ke)&&jt&&Ee.push(tn)}ke.on("error",Bt),S(ke)&&jt&&Ee.push(()=>{ke.removeListener("error",Bt)})}if($e===0)if(typeof ke=="function"){if(le=ke({signal:Pe}),!_(le))throw new d("Iterable, AsyncIterable or Stream","source",le)}else _(ke)||C(ke)||T(ke)?le=ke:le=l.from(ke);else if(typeof ke=="function"){if(T(le)){var ae;le=q((ae=le)===null||ae===void 0?void 0:ae.readable)}else le=q(le);if(le=ke(le,{signal:Pe}),ot){if(!_(le,!0))throw new d("AsyncIterable",`transform[${$e-1}]`,le)}else{var Te;B||(B=hK());const Bt=new B({objectMode:!0}),Ft=(Te=le)===null||Te===void 0?void 0:Te.then;if(typeof Ft=="function")be++,Ft.call(le,D=>{je=D,D!=null&&Bt.write(D),ft&&Bt.end(),e.nextTick(Re)},D=>{Bt.destroy(D),e.nextTick(Re,D)});else if(_(le,!0))be++,U(le,Bt,Re,{end:ft});else if(M(le)||T(le)){const D=le.readable||le;be++,U(D,Bt,Re,{end:ft})}else throw new d("AsyncIterable or Promise","destination",le);le=Bt;const{destroy:tn,cleanup:xe}=F(le,!1,!0);Y.push(tn),jt&&Ee.push(xe)}}else if(E(ke)){if(C(le)){be+=2;const Bt=te(le,ke,Re,{end:ft});S(ke)&&jt&&Ee.push(Bt)}else if(T(le)||M(le)){const Bt=le.readable||le;be++,U(Bt,ke,Re,{end:ft})}else if(_(le))be++,U(le,ke,Re,{end:ft});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],le);le=ke}else if(R(ke)){if(C(le))be++,re(q(le),ke,Re,{end:ft});else if(M(le)||_(le))be++,re(le,ke,Re,{end:ft});else if(T(le))be++,re(le.readable,ke,Re,{end:ft});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],le);le=ke}else le=l.from(ke)}return(Pe!=null&&Pe.aborted||Me!=null&&Me.aborted)&&e.nextTick(Ue),le}function te(se,pe,de,{end:Ne}){let Pe=!1;if(pe.on("close",()=>{Pe||de(new y)}),se.pipe(pe,{end:!1}),Ne){let Me=function(){Pe=!0,pe.end()};N(se)?e.nextTick(Me):se.once("end",Me)}else de();return s(se,{readable:!0,writable:!1},Me=>{const Ee=se._readableState;Me&&Me.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ee&&Ee.ended&&!Ee.errored&&!Ee.errorEmitted?se.once("end",de).once("error",de):de(Me)}),s(pe,{readable:!1,writable:!0},de)}return eM={pipelineImpl:ne,pipeline:G},eM}var tM,m$;function pK(){if(m$)return tM;m$=1;const{pipeline:e}=XO(),t=md(),{destroyer:n}=ry(),{isNodeStream:r,isReadable:i,isWritable:s,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=Ed(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=Wa(),p=hh();return tM=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const x=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const B=b.length-1;b[B]=t.from(b[B])}for(let B=0;B<b.length;++B)if(!(!r(b[B])&&!a(b[B]))){if(B<b.length-1&&!(i(b[B])||c(b[B])||o(b[B])))throw new d(`streams[${B}]`,x[B],"must be readable");if(B>0&&!(s(b[B])||l(b[B])||o(b[B])))throw new d(`streams[${B}]`,x[B],"must be writable")}let w,_,S,C,E;function T(B){const P=C;C=null,P?P(B):B?E.destroy(B):!O&&!N&&E.destroy()}const R=b[0],M=e(b,T),N=!!(s(R)||l(R)||o(R)),O=!!(i(M)||c(M)||o(M));if(E=new t({writableObjectMode:!!(R!=null&&R.writableObjectMode),readableObjectMode:!!(M!=null&&M.readableObjectMode),writable:N,readable:O}),N){if(r(R))E._write=function(P,H,F){R.write(P,H)?F():w=F},E._final=function(P){R.end(),_=P},R.on("drain",function(){if(w){const P=w;w=null,P()}});else if(a(R)){const H=(o(R)?R.writable:R).getWriter();E._write=async function(F,Q,q){try{await H.ready,H.write(F).catch(()=>{}),q()}catch(K){q(K)}},E._final=async function(F){try{await H.ready,H.close().catch(()=>{}),_=F}catch(Q){F(Q)}}}const B=o(M)?M.readable:M;p(B,()=>{if(_){const P=_;_=null,P()}})}if(O){if(r(M))M.on("readable",function(){if(S){const B=S;S=null,B()}}),M.on("end",function(){E.push(null)}),E._read=function(){for(;;){const B=M.read();if(B===null){S=E._read;return}if(!E.push(B))return}};else if(a(M)){const P=(o(M)?M.readable:M).getReader();E._read=async function(){for(;;)try{const{value:H,done:F}=await P.read();if(!E.push(H))return;if(F){E.push(null);return}}catch{return}}}}return E._destroy=function(B,P){!B&&C!==null&&(B=new u),S=null,w=null,_=null,C===null?P(B):(C=P,r(M)&&n(M,B))},E},tM}var g$;function H1e(){if(g$)return iS;g$=1;const e=globalThis.AbortController||kx().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:i},AbortError:s}=Wa(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=Lw(),c=zi().Symbol("kWeak"),u=zi().Symbol("kResistStopPropagation"),{finished:d}=hh(),h=pK(),{addAbortSignalNoValidate:p}=mE(),{isWritable:y,isNodeStream:b}=Ed(),{deprecate:x}=uo(),{ArrayPrototypePush:w,Boolean:_,MathFloor:S,Number:C,NumberIsNaN:E,Promise:T,PromiseReject:R,PromiseResolve:M,PromisePrototypeThen:N,Symbol:O}=zi(),B=O("kEmpty"),P=O("kEof");function H(Me,Ee){if(Ee!=null&&l(Ee,"options"),(Ee==null?void 0:Ee.signal)!=null&&a(Ee.signal,"options.signal"),b(Me)&&!y(Me))throw new t("stream",Me,"must be writable");const Ue=h(this,Me);return Ee!=null&&Ee.signal&&p(Ee.signal,Ue),Ue}function F(Me,Ee){if(typeof Me!="function")throw new n("fn",["Function","AsyncFunction"],Me);Ee!=null&&l(Ee,"options"),(Ee==null?void 0:Ee.signal)!=null&&a(Ee.signal,"options.signal");let Ue=1;(Ee==null?void 0:Ee.concurrency)!=null&&(Ue=S(Ee.concurrency));let nt=Ue-1;return(Ee==null?void 0:Ee.highWaterMark)!=null&&(nt=S(Ee.highWaterMark)),o(Ue,"options.concurrency",1),o(nt,"options.highWaterMark",0),nt+=Ue,(async function*(){const je=uo().AbortSignalAny([Ee==null?void 0:Ee.signal].filter(_)),Y=this,be=[],Re={signal:je};let ce,le,ae=!1,Te=0;function $e(){ae=!0,ke()}function ke(){Te-=1,ot()}function ot(){le&&!ae&&Te<Ue&&be.length<nt&&(le(),le=null)}async function At(){try{for await(let ft of Y){if(ae)return;if(je.aborted)throw new s;try{if(ft=Me(ft,Re),ft===B)continue;ft=M(ft)}catch(jt){ft=R(jt)}Te+=1,N(ft,ke,$e),be.push(ft),ce&&(ce(),ce=null),!ae&&(be.length>=nt||Te>=Ue)&&await new T(jt=>{le=jt})}be.push(P)}catch(ft){const jt=R(ft);N(jt,ke,$e),be.push(jt)}finally{ae=!0,ce&&(ce(),ce=null)}}At();try{for(;;){for(;be.length>0;){const ft=await be[0];if(ft===P)return;if(je.aborted)throw new s;ft!==B&&(yield ft),be.shift(),ot()}await new T(ft=>{ce=ft})}}finally{ae=!0,le&&(le(),le=null)}}).call(this)}function Q(Me=void 0){return Me!=null&&l(Me,"options"),(Me==null?void 0:Me.signal)!=null&&a(Me.signal,"options.signal"),(async function*(){let Ue=0;for await(const He of this){var nt;if(Me!=null&&(nt=Me.signal)!==null&&nt!==void 0&&nt.aborted)throw new s({cause:Me.signal.reason});yield[Ue++,He]}}).call(this)}async function q(Me,Ee=void 0){for await(const Ue of G.call(this,Me,Ee))return!0;return!1}async function K(Me,Ee=void 0){if(typeof Me!="function")throw new n("fn",["Function","AsyncFunction"],Me);return!await q.call(this,async(...Ue)=>!await Me(...Ue),Ee)}async function U(Me,Ee){for await(const Ue of G.call(this,Me,Ee))return Ue}async function re(Me,Ee){if(typeof Me!="function")throw new n("fn",["Function","AsyncFunction"],Me);async function Ue(nt,He){return await Me(nt,He),B}for await(const nt of F.call(this,Ue,Ee));}function G(Me,Ee){if(typeof Me!="function")throw new n("fn",["Function","AsyncFunction"],Me);async function Ue(nt,He){return await Me(nt,He)?nt:B}return F.call(this,Ue,Ee)}class ne extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function te(Me,Ee,Ue){var nt;if(typeof Me!="function")throw new n("reducer",["Function","AsyncFunction"],Me);Ue!=null&&l(Ue,"options"),(Ue==null?void 0:Ue.signal)!=null&&a(Ue.signal,"options.signal");let He=arguments.length>1;if(Ue!=null&&(nt=Ue.signal)!==null&&nt!==void 0&&nt.aborted){const ce=new s(void 0,{cause:Ue.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(ce)),ce}const je=new e,Y=je.signal;if(Ue!=null&&Ue.signal){const ce={once:!0,[c]:this,[u]:!0};Ue.signal.addEventListener("abort",()=>je.abort(),ce)}let be=!1;try{for await(const ce of this){var Re;if(be=!0,Ue!=null&&(Re=Ue.signal)!==null&&Re!==void 0&&Re.aborted)throw new s;He?Ee=await Me(Ee,ce,{signal:Y}):(Ee=ce,He=!0)}if(!be&&!He)throw new ne}finally{je.abort()}return Ee}async function se(Me){Me!=null&&l(Me,"options"),(Me==null?void 0:Me.signal)!=null&&a(Me.signal,"options.signal");const Ee=[];for await(const nt of this){var Ue;if(Me!=null&&(Ue=Me.signal)!==null&&Ue!==void 0&&Ue.aborted)throw new s(void 0,{cause:Me.signal.reason});w(Ee,nt)}return Ee}function pe(Me,Ee){const Ue=F.call(this,Me,Ee);return(async function*(){for await(const He of Ue)yield*He}).call(this)}function de(Me){if(Me=C(Me),E(Me))return 0;if(Me<0)throw new i("number",">= 0",Me);return Me}function Ne(Me,Ee=void 0){return Ee!=null&&l(Ee,"options"),(Ee==null?void 0:Ee.signal)!=null&&a(Ee.signal,"options.signal"),Me=de(Me),(async function*(){var nt;if(Ee!=null&&(nt=Ee.signal)!==null&&nt!==void 0&&nt.aborted)throw new s;for await(const je of this){var He;if(Ee!=null&&(He=Ee.signal)!==null&&He!==void 0&&He.aborted)throw new s;Me--<=0&&(yield je)}}).call(this)}function Pe(Me,Ee=void 0){return Ee!=null&&l(Ee,"options"),(Ee==null?void 0:Ee.signal)!=null&&a(Ee.signal,"options.signal"),Me=de(Me),(async function*(){var nt;if(Ee!=null&&(nt=Ee.signal)!==null&&nt!==void 0&&nt.aborted)throw new s;for await(const je of this){var He;if(Ee!=null&&(He=Ee.signal)!==null&&He!==void 0&&He.aborted)throw new s;if(Me-- >0&&(yield je),Me<=0)return}}).call(this)}return iS.streamReturningOperators={asIndexedPairs:x(Q,"readable.asIndexedPairs will be removed in a future version."),drop:Ne,filter:G,flatMap:pe,map:F,take:Pe,compose:H},iS.promiseReturningOperators={every:K,forEach:re,reduce:te,toArray:se,some:q,find:U},iS}var nM,y$;function mK(){if(y$)return nM;y$=1;const{ArrayPrototypePop:e,Promise:t}=zi(),{isIterable:n,isNodeStream:r,isWebStream:i}=Ed(),{pipelineImpl:s}=XO(),{finished:a}=hh();gK();function o(...l){return new t((c,u)=>{let d,h;const p=l[l.length-1];if(p&&typeof p=="object"&&!r(p)&&!n(p)&&!i(p)){const y=e(l);d=y.signal,h=y.end}s(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return nM={finished:a,pipeline:o},nM}var b$;function gK(){if(b$)return NI.exports;b$=1;const{Buffer:e}=fh(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=zi(),{promisify:{custom:i}}=uo(),{streamReturningOperators:s,promiseReturningOperators:a}=H1e(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=Wa(),l=pK(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=gE(),{pipeline:d}=XO(),{destroyer:h}=ry(),p=hh(),y=mK(),b=Ed(),x=NI.exports=KO().Stream;x.isDestroyed=b.isDestroyed,x.isDisturbed=b.isDisturbed,x.isErrored=b.isErrored,x.isReadable=b.isReadable,x.isWritable=b.isWritable,x.Readable=yE();for(const _ of n(s)){let C=function(...E){if(new.target)throw o();return x.Readable.from(r(S,this,E))};const S=s[_];t(C,"name",{__proto__:null,value:S.name}),t(C,"length",{__proto__:null,value:S.length}),t(x.Readable.prototype,_,{__proto__:null,value:C,enumerable:!1,configurable:!0,writable:!0})}for(const _ of n(a)){let C=function(...E){if(new.target)throw o();return r(S,this,E)};const S=a[_];t(C,"name",{__proto__:null,value:S.name}),t(C,"length",{__proto__:null,value:S.length}),t(x.Readable.prototype,_,{__proto__:null,value:C,enumerable:!1,configurable:!0,writable:!0})}x.Writable=ZO(),x.Duplex=md(),x.Transform=fK(),x.PassThrough=hK(),x.pipeline=d;const{addAbortSignal:w}=mE();return x.addAbortSignal=w,x.finished=p,x.destroy=h,x.compose=l,x.setDefaultHighWaterMark=c,x.getDefaultHighWaterMark=u,t(x,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,i,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(p,i,{__proto__:null,enumerable:!0,get(){return y.finished}}),x.Stream=x,x._isUint8Array=function(S){return S instanceof Uint8Array},x._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},NI.exports}var v$;function W1e(){return v$||(v$=1,function(e){const t=gK(),n=mK(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(MI)),MI.exports}var yK=W1e();class JO extends yK.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(i=>{this._path=i.path;const s=i.readableWebStream({start:t.start,end:t.end});this.reader=s.getReader(),this.pending=!1}).catch(i=>{this.destroy(i)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Ke(pt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ke(pt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class QO extends yK.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const i=r.writableWebStream({start:t.start});this.writer=i.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(ga(new Ke(pt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(ga(new Ke(pt.ENOTSUP,"Unsupported encoding for stream",this._path)));const i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(i),this._bytesWritten+=t.byteLength,r()}catch(s){r(new Ke(pt.EIO,s.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Ke(pt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Ke(pt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var Cl=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},kl=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,i=0;function s(){for(;r=t.stack.pop();)try{if(!r.async&&i===1)return i=0,t.stack.push(r),Promise.resolve().then(s);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return i|=2,Promise.resolve(a).then(s,function(o){return n(o),s()})}else i|=1}catch(o){n(o)}if(i===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return s()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class wa{get position(){return this.flag&Dp?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=ka(t,n);Object.assign(this,Zp(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&dE||this.inode.flags&ao.Sync)}_emitChange(){ia(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Ke.With("EBADF",this.path,"chown");this.dirty=!0,YG(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=uh(t,-1);if(n<0)throw new Ke(pt.EINVAL,"Invalid mode");if(this.closed)throw Ke.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>hi?-61441:hi)|n,(this._isSync||n>hi)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Ke.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Ke.With("EBADF",this.path,"truncate");if(t<0)throw new Ke(pt.EINVAL);if(this.dirty=!0,!(this.flag&ma||this.flag&nd))throw new Ke(pt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Ke.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=cC(t),this.inode.mtimeMs=cC(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=rd(n,"utf8","a",420);if(!(id(r.flag)&Dp))throw new Ke(pt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Ke(pt.EINVAL,"Encoding not specified");const s=typeof t=="string"?Si.from(t,r.encoding):t;await this._write(s,0,s.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,i=this.position){if(this.closed)throw Ke.With("EBADF",this.path,"read");if(this.flag&ma)throw new Ke(pt.EPERM,"File not opened with a readable mode");this.inode.flags&ao.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let s=i+r;!_x(this.inode)&&!wx(this.inode)&&s>this.inode.size&&(s=i+Math.max(this.inode.size-i,0)),this._position=s;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),i,s),this._isSync&&await this.sync(),{bytesRead:s-i,buffer:t}}async read(t,n,r,i){typeof n=="object"&&n!=null&&(i=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(i=t.position,r=t.length,n=t.offset,t=t.buffer);const s=Number.isSafeInteger(i)?i:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,s)}async readFile(t){const n=rd(t,null,"r",292);if(id(n.flag)&ma)throw new Ke(pt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:i}=await this.stat(),{buffer:s}=await this._read(new Uint8Array(i),0,i,0),a=Si.from(s);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Ke.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Ke.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&ao.Immutable)throw new Ke(pt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&ma)throw Ke.With("EBADF",this.path,"readLines");return d1e({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Ke.With("EBADF",this.path,"stat");if(!ni(this.context,this.inode,Cs))throw Ke.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new nm(this.inode):new kd(this.inode)}async _write(t,n=0,r=t.byteLength-n,i=this.position){if(this.closed)throw Ke.With("EBADF",this.path,"write");if(this.inode.flags&ao.Immutable)throw new Ke(pt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&ma||this.flag&nd))throw new Ke(pt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const s=i+r,a=t.subarray(n,n+r);return!_x(this.inode)&&!wx(this.inode)&&s>this.inode.size&&(this.inode.size=s),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=i+a.byteLength,await this.fs.write(this.internalPath,a,i),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,i){let s,a,o;typeof n=="object"&&n!=null&&(r=n.length,i=n.position,n=n.offset),typeof t=="string"?(i=typeof n=="number"?n:null,a=0,s=Si.from(t,typeof r=="string"?r:"utf8"),o=s.length):(s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:s.byteLength,i=typeof i=="number"?i:null),i??(i=this.position);const l=await this._write(s,a,o,i);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=rd(n,"utf8","w",420),i=id(r.flag);if(!(i&ma||i&nd))throw new Ke(pt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Ke(pt.EINVAL,"Encoding not specified");const s=typeof t=="string"?Si.from(t,r.encoding):t;await this._write(s,0,s.length,0),this._emitChange()}async close(){if(this.closed)throw Ke.With("EBADF",this.path,"close");await this.sync(),this.dispose(),JG(this.context,this.fd)}dispose(t){if(this.closed)throw Ke.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Ke.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const i of t)r+=(await this.write(i)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const i of t)r+=(await this.read(i)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&ma)throw Ke.With("EBADF",this.path,"createReadStream");return new JO(t,this)}createWriteStream(t={}){if(this.closed)throw Ke.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&ao.Immutable)throw new Ke(pt.EPERM,"File is immutable",this.path,"createWriteStream");return new QO(t,this)}}async function bK(e,t){e=In(e),t=In(t);const n=_r(e,this),r=_r(t,this);if(!(await iy.call(this,$r(e))).hasAccess(Wi,this))throw Ke.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),ia(this,"rename",e.toString()),ia(this,"change",t.toString());return}await wE.call(this,t,await xE(e)),await vE.call(this,e),ia(this,"rename",e.toString())}catch(i){throw ri(i,{[n.path]:e,[r.path]:t})}}async function Bw(e){try{const{fs:t,path:n}=_r(await ph.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Ke&&t.code=="ENOENT")return!1;throw t}}async function iy(e,t){e=In(e);const{fs:n,path:r}=_r(await ph.call(this,e),this);try{const i=await n.stat(r);if(ks&&!ni(this,i,Cs))throw Ke.With("EACCES",r,"stat");return t!=null&&t.bigint?new nm(i):new kd(i)}catch(i){throw ri(i,{[r]:e})}}async function bE(e,t){e=In(e);const{fs:n,path:r}=_r(e,this);try{const i=await n.stat(r);if(ks&&!ni(this,i,Cs))throw Ke.With("EACCES",r,"lstat");return t!=null&&t.bigint?new nm(i):new kd(i)}catch(i){throw ri(i,{[r]:e})}}async function vK(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await Cl(n,await El.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=kl(n);r&&await r}}async function vE(e){e=In(e);const{fs:t,path:n}=_r(e,this);try{if(ks&&!ni(this,await t.stat(n),Wi))throw Ke.With("EACCES",n,"unlink");await t.unlink(n),ia(this,"rename",e.toString())}catch(r){throw ri(r,{[n]:e})}}async function sy(e,t,n){var r;t=In(t);const i=uh(n.mode,420),s=id(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await hC(e,t.toString(),n.preserveSymlinks);if(!c){if(!(s&lE))throw Ke.With("ENOENT",a,"_open");const d=await o.stat($r(l));if(!ni(e,d,Wi))throw Ke.With("EACCES",$r(a),"_open");if(!lc(d))throw Ke.With("ENOTDIR",$r(a),"_open");const{euid:h,egid:p}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:dc.credentials,y=await o.createFile(l,{mode:i,uid:d.mode&Ow?d.uid:h,gid:d.mode&Pw?d.gid:p});return new wa(e,dC(new uC(e,t,o,l,s,y)))}if(!ni(e,c,QG(s)))throw Ke.With("EACCES",a,"_open");if(s&cE)throw Ke.With("EEXIST",a,"_open");const u=new wa(e,dC(new uC(e,t,o,l,s,c)));return s&uE&&await u.truncate(0),u}async function El(e,t="r",n=420){return await sy(this,e,{flag:t,mode:n})}async function xE(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=rd(t,null,"r",292);return await Cl(n,typeof e=="object"&&"fd"in e?e:await El.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=kl(n);r&&await r}}async function wE(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=rd(n,"utf8","w+",420),s=Cl(r,e instanceof wa?e:await El.call(this,e.toString(),i.flag,i.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Ke(pt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,s.path,"writeFile");await s.writeFile(a,i)}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function xK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const i=rd(n,"utf8","a",420);if(!(id(i.flag)&Dp))throw new Ke(pt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!i.encoding)throw new Ke(pt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Si.from(t,i.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await Cl(r,typeof e=="object"&&"fd"in e?e:await El.call(this,e,i.flag,i.mode),!0).appendFile(a,i)}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function eP(e){e=await ph.call(this,e);const{fs:t,path:n}=_r(e,this);try{const r=await t.stat(n);if(!r)throw Ke.With("ENOENT",e,"rmdir");if(!lc(r))throw Ke.With("ENOTDIR",n,"rmdir");if(ks&&!ni(this,r,Wi))throw Ke.With("EACCES",n,"rmdir");await t.rmdir(n),ia(this,"rename",e.toString())}catch(r){throw ri(r,{[n]:e})}}async function _E(e,t){var n,r;const{euid:i,egid:s}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:dc.credentials;t=typeof t=="object"?t:{mode:t};const a=uh(t==null?void 0:t.mode,511);e=await ph.call(this,e);const{fs:o,path:l,root:c}=_r(e,this),u={[l]:e},d=async(h,p)=>{if(!ni(this,p,Wi))throw Ke.With("EACCES",$r(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:p.mode&Ow?p.uid:i,gid:p.mode&Pw?p.gid:s});return ia(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat($r(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=$r(y),b=$r(b))h.unshift(y),u[y]=b;if(!h.length)return;const p=[await o.stat($r(h[0]))];for(const[y,b]of h.entries())p.push(await d(b,p[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ri(h,u)}}async function am(e,t){t=typeof t=="object"?t:{encoding:t},e=await ph.call(this,e);const{fs:n,path:r}=_r(e,this),i=await n.stat(r).catch(l=>oi(ri(l,{[r]:e})));if(!i)throw Ke.With("ENOENT",e,"readdir");if(!ni(this,i,Cs))throw Ke.With("EACCES",e,"readdir");if(!lc(i))throw Ke.With("ENOTDIR",e,"readdir");const s=await n.readdir(r).catch(l=>oi(ri(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(Zr(r,l)).catch(u=>{if(u.code!="ENOENT")throw ri(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new Cx(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Si.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!lc(c))))for(const u of await am.call(this,Zr(e,l),t))u instanceof Cx?(u.path=Zr(l,u.path),a.push(u)):Si.isBuffer(u)?a.push(Si.from(Zr(l,EO(u)))):a.push(Zr(l,u))};return await Promise.all(s.map(o)),a}async function wK(e,t){e=In(e),t=In(t);const{fs:n,path:r}=_r(e,this),i=_r(t,this);if(n!=i.fs)throw Ke.With("EXDEV",t,"link");try{if(ks&&!ni(this,await n.stat($r(r)),Cs))throw Ke.With("EACCES",$r(r),"link");if(ks&&!(await iy.call(this,$r(t))).hasAccess(Wi,this))throw Ke.With("EACCES",$r(t),"link");if(ks&&!ni(this,await n.stat(r),Cs))throw Ke.With("EACCES",r,"link");return await n.link(r,i.path)}catch(s){throw ri(s,{[i.path]:t,[r]:e})}}async function _K(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Ke(pt.EINVAL,"Invalid symlink type: "+n);if(t=In(t),await Bw.call(this,t))throw Ke.With("EEXIST",t,"symlink");const i=Cl(r,await sy(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await i.writeFile(In(e,!0)),await i.chmod(Cd)}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function fC(e,t){const n={stack:[],error:void 0,hasError:!1};try{const i=await Cl(n,await sy(this,In(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),s=typeof t=="object"?t==null?void 0:t.encoding:t;return s=="buffer"?i:i.toString(s??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=kl(n);r&&await r}}async function SK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Cl(r,await El.call(this,e,"r+"),!0).chown(t,n)}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function CK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Cl(r,await sy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function kK(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Cl(n,await El.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=kl(n);r&&await r}}async function EK(e,t){const n={stack:[],error:void 0,hasError:!1};try{await Cl(n,await sy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=kl(n);r&&await r}}async function tP(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Cl(r,await El.call(this,e,"r+"),!0).utimes(t,n)}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function TK(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await Cl(r,await sy(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(i){r.error=i,r.hasError=!0}finally{const i=kl(r);i&&await i}}async function hC(e,t,n){if(n){const l=_r(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=_r(t,e),c=await l.fs.stat(l.path);if(!g0(c))return{...l,fullPath:t,stats:c};const u=pd.call(e,$r(t),(await fC.call(e,t)).toString());return await hC(e,u)}catch{}const{base:r,dir:i}=Oc(t),s=i=="/"?"/":await ph.call(e,i),a=Zr(s,r),o=_r(a,e);try{const l=await o.fs.stat(o.path);if(!g0(l))return{...o,fullPath:a,stats:l};const c=pd.call(e,s,(await fC.call(e,a)).toString());return await hC(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ri(l,{[o.path]:a})}}async function ph(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=In(e);const{fullPath:i}=await hC(this,e);if(r=="utf8"||r=="utf-8")return i;const s=Si.from(i,"utf-8");return r=="buffer"?s:s.toString(r)}function G1e(e,t={}){const n=new rK(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let i=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function s(){i=!0,n.close();for(const a of r)a({value:null,done:i});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(i)return Promise.resolve({value:null,done:i});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:s,throw:s,async[Symbol.asyncDispose](){await s()},[Symbol.asyncIterator](){return this}}}async function AK(e,t=jO){if(!(await iy.call(this,e)).hasAccess(t,this))throw new Ke(pt.EACCES)}async function nP(e,t){e=In(e);const n=await bE.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&hi){case fs:if(t!=null&&t.recursive)for(const r of await am.call(this,e))await nP.call(this,Zr(e,r),t);await eP.call(this,e);break;case Ql:case Cd:case Qp:case em:await vE.call(this,e);break;case tm:case Jp:default:throw new Ke(pt.EPERM,"File type not supported",e,"rm")}}async function RK(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",i="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await _E.call(this,i),n=="buffer"?Si.from(i):i}async function rP(e,t,n){if(e=In(e),t=In(t),n&&n&OO&&await Bw.call(this,t))throw new Ke(pt.EEXIST,"Destination file already exists",t,"copyFile");await wE.call(this,t,await xE.call(this,e)),ia(this,"rename",t.toString())}function IK(e,t){return e=In(e),Promise.resolve(new GO(e,this))}async function iP(e,t,n){e=In(e),t=In(t);const r=await bE.call(this,e);if(n!=null&&n.errorOnExist&&await Bw.call(this,t))throw new Ke(pt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&hi){case fs:{if(!(n!=null&&n.recursive))throw new Ke(pt.EISDIR,e+" is a directory (not copied)",e,"cp");const[i]=await Promise.all([am.call(this,e,{withFileTypes:!0}),_E.call(this,t,{recursive:!0})]),s=async a=>{n.filter&&!n.filter(Zr(e,a.name),Zr(t,a.name))||await iP.call(this,Zr(e,a.name),Zr(t,a.name),n)};await Promise.all(i.map(s));break}case Ql:case Cd:await rP.call(this,e,t);break;case Qp:case em:case tm:case Jp:default:throw new Ke(pt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await tP.call(this,t,r.atime,r.mtime)}async function MK(e,t){e=In(e);const{fs:n}=_r(e,this);return Promise.resolve(tK(n,t==null?void 0:t.bigint))}function NK(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:i=()=>!1}=t||{},s=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await am(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;i(r?c:u)||((await iy(u)).isDirectory()&&s.some(d=>d.source.includes(".*"))&&(yield*a(u)),s.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const K1e=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:wa,access:AK,appendFile:xK,chmod:kK,chown:SK,constants:GG,copyFile:rP,cp:iP,exists:Bw,glob:NK,lchmod:EK,lchown:CK,link:wK,lstat:bE,lutimes:TK,mkdir:_E,mkdtemp:RK,open:El,opendir:IK,readFile:xE,readdir:am,readlink:fC,realpath:ph,rename:bK,rm:nP,rmdir:eP,stat:iy,statfs:MK,symlink:_K,truncate:vK,unlink:vE,utimes:tP,watch:G1e,writeFile:wE},Symbol.toStringTag,{value:"Module"})),ar=()=>{};async function Y1e(e){const t=[];for await(const n of e)t.push(n);return t}function Z1e(e,t,n=ar){bK.call(this,e,t).then(()=>n()).catch(n)}function X1e(e,t=ar){Bw.call(this,e).then(t).catch(()=>t(!1))}function J1e(e,t,n=ar){n=typeof t=="function"?t:n,iy.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function Q1e(e,t,n=ar){n=typeof t=="function"?t:n,bE.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function e_e(e,t=0,n=ar){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;vK.call(this,e,r).then(()=>n()).catch(n)}function t_e(e,t=ar){vE.call(this,e).then(()=>t()).catch(t)}function n_e(e,t,n,r=ar){const i=uh(n,420);r=typeof n=="function"?n:r,El.call(this,e,t,i).then(s=>r(void 0,s.fd)).catch(r)}function r_e(e,t,n=ar){n=typeof t=="function"?t:n,xE.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function i_e(e,t,n,r=ar){r=typeof n=="function"?n:r,wE.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function s_e(e,t,n,r=ar){const i=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,xK.call(this,e,t,i).then(()=>r()).catch(r)}function a_e(e,t,n=ar){n=typeof t=="function"?t:n,new wa(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new nm(r):r)).catch(n)}function o_e(e,t=ar){new wa(this,e).close().then(()=>t()).catch(t)}function l_e(e,t,n=ar){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const i=new wa(this,e);if(r<0)throw new Ke(pt.EINVAL);i.truncate(r).then(()=>n()).catch(n)}function c_e(e,t=ar){new wa(this,e).sync().then(()=>t()).catch(t)}function u_e(e,t=ar){new wa(this,e).datasync().then(()=>t()).catch(t)}function d_e(e,t,n,r,i,s=ar){let a,o,l,c,u;const d=new wa(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":s=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",s=typeof i=="function"?i:s;break;default:s=typeof r=="function"?r:typeof i=="function"?i:s,s(new Ke(pt.EINVAL,"Invalid arguments"));return}a=Si.from(t),o=0,l=a.length;const h=s;d.write(a,o,l,c).then(({bytesWritten:p})=>h(void 0,p,a.toString(u))).catch(h)}else{a=Si.from(t.buffer),o=n,l=r,c=typeof i=="number"?i:null;const h=typeof i=="function"?i:s;d.write(a,o,l,c).then(({bytesWritten:p})=>h(void 0,p,a)).catch(h)}}function f_e(e,t,n,r,i,s=ar){new wa(this,e).read(t,n,r,i).then(({bytesRead:a,buffer:o})=>s(void 0,a,o)).catch(s)}function h_e(e,t,n,r=ar){new wa(this,e).chown(t,n).then(()=>r()).catch(r)}function p_e(e,t,n){new wa(this,e).chmod(t).then(()=>n()).catch(n)}function m_e(e,t,n,r=ar){new wa(this,e).utimes(t,n).then(()=>r()).catch(r)}function g_e(e,t=ar){eP.call(this,e).then(()=>t()).catch(t)}function y_e(e,t,n=ar){_E.call(this,e,t).then(()=>n()).catch(n)}function b_e(e,t,n=ar){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};am.call(this,e,r).then(i=>n(void 0,i)).catch(n)}function v_e(e,t,n=ar){wK.call(this,e,t).then(()=>n()).catch(n)}function x_e(e,t,n,r=ar){const i=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,_K.call(this,e,t,i).then(()=>r()).catch(r)}function w_e(e,t,n=ar){n=typeof t=="function"?t:n,fC.call(this,e).then(r=>n(void 0,r)).catch(n)}function __e(e,t,n,r=ar){SK.call(this,e,t,n).then(()=>r()).catch(r)}function S_e(e,t,n,r=ar){CK.call(this,e,t,n).then(()=>r()).catch(r)}function C_e(e,t,n=ar){kK.call(this,e,t).then(()=>n()).catch(n)}function k_e(e,t,n=ar){EK.call(this,e,t).then(()=>n()).catch(n)}function E_e(e,t,n,r=ar){tP.call(this,e,t,n).then(()=>r()).catch(r)}function T_e(e,t,n,r=ar){TK.call(this,e,t,n).then(()=>r()).catch(r)}function A_e(e,t,n=ar){n=typeof t=="function"?t:n,ph.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function R_e(e,t,n=ar){const r=typeof t=="number"?t:Cs;n=typeof t=="function"?t:n,AK.call(this,e,r).then(()=>n()).catch(n)}const Tg=new Map;function I_e(e,t,n){const r=In(e),i=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Ke(pt.EINVAL,"No listener specified",e.toString(),"watchFile");if(Tg.has(r)){const a=Tg.get(r);a&&a.listeners.add(n);return}const s=new g1e(this,r,i);s.on("change",(a,o)=>{const l=Tg.get(r);if(l)for(const c of l.listeners)c(a,o)}),Tg.set(r,{watcher:s,listeners:new Set})}function M_e(e,t=ar){const n=In(e),r=Tg.get(n);r&&(t&&t!==ar?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),Tg.delete(n)))}function N_e(e,t,n){const r=new rK(this,In(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||ar),r}function j_e(e,t){t=typeof t=="object"?t:{encoding:t};const n=El.call(this,e,"r",t==null?void 0:t.mode);return new JO({...t,autoClose:!0},n)}function O_e(e,t){t=typeof t=="object"?t:{encoding:t};const n=El.call(this,e,"w",t==null?void 0:t.mode);return new QO(t,n)}function P_e(e,t,n=ar){n=typeof t=="function"?t:n,nP.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function D_e(e,t,n=ar){n=typeof t=="function"?t:n,RK.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function F_e(e,t,n,r=ar){r=typeof n=="function"?n:r,rP.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function L_e(e,t,n,r=ar){r=typeof n=="function"?n:r,new wa(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:i,bytesRead:s})=>r(void 0,s,i)).catch(r)}function B_e(e,t,n,r=ar){r=typeof n=="function"?n:r,new wa(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:i,bytesWritten:s})=>r(void 0,s,i)).catch(r)}function $_e(e,t,n=ar){n=typeof t=="function"?t:n,IK.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function z_e(e,t,n,r=ar){r=typeof n=="function"?n:r,iP.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function U_e(e,t,n=ar){n=typeof t=="function"?t:n,MK.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function q_e(e,t){const n=await El.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function V_e(e,t,n=ar){n=typeof t=="function"?t:n;const r=NK.call(this,e,typeof t=="function"?void 0:t);Y1e(r).then(i=>{var s;return n(null,(s=i)!==null&&s!==void 0?s:[])}).catch(i=>n(i))}var Kh=function(e,t,n,r,i,s){function a(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,p=n.length-1;p>=0;p--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(w||null))};var x=(0,n[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(d=a(x.get))&&(u.get=d),(d=a(x.set))&&(u.set=d),(d=a(x.init))&&i.unshift(d)}else(d=a(x))&&(o==="field"?i.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Mo=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0},H_e=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},pC;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(pC||(pC={}));let jK=(()=>{var e,t,n,r,i;let s=[Xp()],a,o=[],l,c,u=[],d=[],h,p=[],y=[],b,x=[],w=[],_,S=[],C=[],E,T=[],R=[],M,N=[],O=[];return l=class{constructor(B=oi(new Ke(pt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=Mo(this,u,0),this.extsize=(Mo(this,d),Mo(this,p,0)),this.nextents=(Mo(this,y),Mo(this,x,0)),this.projid=(Mo(this,w),Mo(this,S,0)),this.cowextsize=(Mo(this,C),Mo(this,T,0)),this.pad=(Mo(this,R),Mo(this,N,[])),Mo(this,O),this.extsize=B.size,this.nextents=1,this.projid=B.uid,this.cowextsize=B.size;for(const P of Object.keys(ao))B.flags&ao[P]&&P in pC&&(this.xflags|=pC[P])}},H_e(l,"fsxattr"),(()=>{const B=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=qn).uint32.bind(e)],h=[(t=qn).uint32.bind(t)],b=[(n=qn).uint32.bind(n)],_=[(r=qn).uint32.bind(r)],E=[(i=qn).uint32.bind(i)],M=[qn.char(8)],Kh(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:P=>"xflags"in P,get:P=>P.xflags,set:(P,H)=>{P.xflags=H}},metadata:B},u,d),Kh(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:P=>"extsize"in P,get:P=>P.extsize,set:(P,H)=>{P.extsize=H}},metadata:B},p,y),Kh(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:P=>"nextents"in P,get:P=>P.nextents,set:(P,H)=>{P.nextents=H}},metadata:B},x,w),Kh(null,null,_,{kind:"field",name:"projid",static:!1,private:!1,access:{has:P=>"projid"in P,get:P=>P.projid,set:(P,H)=>{P.projid=H}},metadata:B},S,C),Kh(null,null,E,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:P=>"cowextsize"in P,get:P=>P.cowextsize,set:(P,H)=>{P.cowextsize=H}},metadata:B},T,R),Kh(null,null,M,{kind:"field",name:"pad",static:!1,private:!1,access:{has:P=>"pad"in P,get:P=>P.pad,set:(P,H)=>{P.pad=H}},metadata:B},N,O),Kh(null,a={value:l},s,{kind:"class",name:l.name,metadata:B},null,o),l=a.value,B&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:B}),Mo(l,o)})(),l})();var Ri;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(Ri||(Ri={}));var Gl;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(Gl||(Gl={}));async function W_e(e,t,...n){e=In(e);const{fs:r,path:i}=_r(e,this);try{const s=new us(await r.stat(i));switch(t){case Ri.GetFlags:case Gl.GetFlags:return s.flags;case Ri.SetFlags:case Gl.SetFlags:s.flags=n[0],await r.touch(i,s);return;case Ri.GetVersion:case Gl.GetVersion:return s.version;case Ri.SetVersion:case Gl.SetVersion:s.version=n[0],await r.touch(i,s);return;case Ri.Fiemap:break;case Ri.GetXattr:return new jK(s);case Ri.SetXattr:break;case Ri.GetLabel:return r.label;case Ri.SetLabel:r.label=n[0];return;case Ri.GetUUID:return r.uuid;case Ri.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(s){throw ri(s,{[i]:e})}throw new Ke(pt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function G_e(e,t,...n){e=In(e);const{fs:r,path:i}=_r(e,this);try{const s=new us(r.statSync(i));switch(t){case Ri.GetFlags:case Gl.GetFlags:return s.flags;case Ri.SetFlags:case Gl.SetFlags:s.flags=n[0],r.touchSync(i,s);return;case Ri.GetVersion:case Gl.GetVersion:return s.version;case Ri.SetVersion:case Gl.SetVersion:s.version=n[0],r.touchSync(i,s);return;case Ri.Fiemap:break;case Ri.GetXattr:return new jK(s);case Ri.SetXattr:break;case Ri.GetLabel:return r.label;case Ri.SetLabel:r.label=n[0];return;case Ri.GetUUID:return r.uuid;case Ri.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(s){throw ri(s,{[i]:e})}throw new Ke(pt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const K_e=[];function ay(e,t,n,r){if(!t.startsWith("user.")&&!K_e.includes(t))throw new Ke(pt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function Y_e(e,t,n={}){var r;e=In(e);const{fs:i,path:s}=_r(e,this);ay(this,t,e,"xattr.get");try{const a=await i.stat(s);if(ks&&!ni(this,a,Cs))throw Ke.With("EACCES",s,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new qf);const o=a.attributes.get(t);if(!o)throw Ke.With("ENODATA",s,"xattr.get");const l=Si.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ri(a,{[s]:e})}}function Z_e(e,t,n={}){var r;e=In(e),ay(this,t,e,"xattr.get");const{fs:i,path:s}=_r(e,this);try{const a=i.statSync(s);if(ks&&!ni(this,a,Cs))throw Ke.With("EACCES",s,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new qf);const o=a.attributes.get(t);if(!o)throw Ke.With("ENODATA",s,"xattr.get");const l=Si.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ri(a,{[s]:e})}}async function X_e(e,t,n,r={}){var i;e=In(e);const{fs:s,path:a}=_r(e,this);ay(this,t,e,"xattr.set");try{const o=await s.stat(a);if(ks&&!ni(this,o,Wi))throw Ke.With("EACCES",a,"xattr.set");(i=o.attributes)!==null&&i!==void 0||(o.attributes=new qf);const l=o.attributes.get(t);if(r.create&&l)throw Ke.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ke.With("ENODATA",a,"xattr.set");o.attributes.set(t,Si.from(n)),await s.touch(a,Zp(o,"attributes"))}catch(o){throw ri(o,{[a]:e})}}function J_e(e,t,n,r={}){var i;e=In(e);const{fs:s,path:a}=_r(e,this);ay(this,t,e,"xattr.set");try{const o=s.statSync(a);if(ks&&!ni(this,o,Wi))throw Ke.With("EACCES",a,"xattr.set");(i=o.attributes)!==null&&i!==void 0||(o.attributes=new qf);const l=o.attributes.get(t);if(r.create&&l)throw Ke.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Ke.With("ENODATA",a,"xattr.set");o.attributes.set(t,Si.from(n)),s.touchSync(a,Zp(o,"attributes"))}catch(o){throw ri(o,{[a]:e})}}async function Q_e(e,t){var n;e=In(e);const{fs:r,path:i}=_r(e,this);ay(this,t,e,"xattr.remove");try{const s=await r.stat(i);if(ks&&!ni(this,s,Wi))throw Ke.With("EACCES",i,"xattr.remove");if((n=s.attributes)!==null&&n!==void 0||(s.attributes=new qf),!s.attributes.get(t))throw Ke.With("ENODATA",i,"xattr.remove");s.attributes.remove(t),await r.touch(i,Zp(s,"attributes"))}catch(s){throw ri(s,{[i]:e})}}function eSe(e,t){var n;e=In(e);const{fs:r,path:i}=_r(e,this);ay(this,t,e,"xattr.remove");try{const s=r.statSync(i);if(ks&&!ni(this,s,Wi))throw Ke.With("EACCES",i,"xattr.remove");if((n=s.attributes)!==null&&n!==void 0||(s.attributes=new qf),!s.attributes.get(t))throw Ke.With("ENODATA",i,"xattr.remove");s.attributes.remove(t),r.touchSync(i,Zp(s,"attributes"))}catch(s){throw ri(s,{[i]:e})}}async function tSe(e){e=In(e);const{fs:t,path:n}=_r(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ri(r,{[n]:e})}}function nSe(e){e=In(e);const{fs:t,path:n}=_r(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ri(r,{[n]:e})}}const rSe=Object.freeze(Object.defineProperty({__proto__:null,get:Y_e,getSync:Z_e,list:tSe,listSync:nSe,remove:Q_e,removeSync:eSe,set:X_e,setSync:J_e},Symbol.toStringTag,{value:"Module"})),Ws=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:Jwe,Dir:GO,Dirent:Cx,get IOC(){return Ri},get IOC32(){return Gl},ReadStream:JO,Stats:kd,StatsFs:Xwe,WriteStream:QO,access:R_e,accessSync:P1e,appendFile:s_e,appendFileSync:w1e,chmod:C_e,chmodSync:N1e,chown:__e,chownSync:I1e,chroot:p1e,close:o_e,closeSync:im,constants:GG,copyFile:F_e,copyFileSync:lK,cp:z_e,cpSync:cK,createReadStream:j_e,createWriteStream:O_e,exists:X1e,existsSync:LO,fchmod:p_e,fchmodSync:VO,fchown:h_e,fchownSync:qO,fdatasync:u_e,fdatasyncSync:k1e,fstat:a_e,fstatSync:_1e,fsync:c_e,fsyncSync:C1e,ftruncate:l_e,ftruncateSync:S1e,futimes:m_e,futimesSync:HO,glob:V_e,globSync:z1e,ioctl:W_e,ioctlSync:G_e,lchmod:k_e,lchmodSync:j1e,lchown:S_e,lchownSync:M1e,link:v_e,linkSync:A1e,lopenSync:hE,lstat:Q1e,lstatSync:BO,lutimes:T_e,lutimesSync:O1e,mkdir:y_e,mkdirSync:WO,mkdtemp:D_e,mkdtempSync:D1e,mount:FO,open:n_e,openAsBlob:q_e,openSync:fE,opendir:$_e,opendirSync:B1e,promises:K1e,read:f_e,readFile:r_e,readFileSync:zO,readSync:T1e,readdir:b_e,readdirSync:ny,readlink:w_e,readlinkSync:H3,readv:L_e,readvSync:F1e,realpath:A_e,realpathSync:dh,rename:Z1e,renameSync:v1e,rm:P_e,rmSync:oK,rmdir:g_e,rmdirSync:sK,stat:J1e,statSync:Vf,statfs:U_e,statfsSync:$1e,symlink:x_e,symlinkSync:R1e,truncate:e_e,truncateSync:x1e,umount:eK,unlink:t_e,unlinkSync:$O,unwatchFile:M_e,utimes:E_e,utimesSync:aK,watch:N_e,watchFile:I_e,write:d_e,writeFile:i_e,writeFileSync:UO,writeSync:E1e,writev:B_e,writevSync:L1e,xattr:rSe},Symbol.toStringTag,{value:"Module"}));function x$(e){return DG(e)||NO(e)||e instanceof DO}async function OK(e,t=0){if(typeof e!="object"||e==null)throw so(new Ke(pt.EINVAL,"Invalid options on mount configuration"));if(!x$(e))throw so(new Ke(pt.EINVAL,"Invalid mount configuration"));if(e instanceof DO)return await e.ready(),e;NO(e)&&(e={backend:e});for(const[i,s]of Object.entries(e))if(i!="backend"&&x$(s)){if(PG("Resolving nested mount configuration: "+i),t>10)throw so(new Ke(pt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[i]=await OK(s,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw so(new Ke(pt.EPERM,"Backend not available: "+n.name));Owe(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function iSe(e){if(!DG(e))throw new TypeError("Invalid single mount point configuration");const t=await OK(e);eK("/"),FO("/",t)}const sSe=["delete"];Math.max(...sSe.map(e=>e.length));jwe("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const PK=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;PK[e]=t}function aSe(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^PK[(t^e[n])&255];return(t^4294967295)>>>0}var Ai=function(e,t,n,r,i,s){function a(w){if(w!==void 0&&typeof w!="function")throw new TypeError("Function expected");return w}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,p=n.length-1;p>=0;p--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(w){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(w||null))};var x=(0,n[p])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(d=a(x.get))&&(u.get=d),(d=a(x.set))&&(u.set=d),(d=a(x.init))&&i.unshift(d)}else(d=a(x))&&(o==="field"?i.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Qn=function(e,t,n){for(var r=arguments.length>2,i=0;i<t.length;i++)n=r?t[i].call(e,n):t[i].call(e);return r?n:void 0},sP=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let w$=(()=>{var e,t,n,r;let i=[Xp()],s,a=[],o,l,c=[],u=[],d,h=[],p=[],y,b=[],x=[],w,_=[],S=[];return o=class{constructor(){this.id=Qn(this,c,0),this.offset_=(Qn(this,u),Qn(this,h,0)),this.offset=(Qn(this,p),Qn(this,b,0)),this.size=(Qn(this,x),Qn(this,_,0)),Qn(this,S)}},sP(o,"MetadataEntry"),(()=>{const C=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=qn).uint32.bind(e)],d=[(t=qn).uint32.bind(t)],y=[(n=qn).uint32.bind(n)],w=[(r=qn).uint32.bind(r)],Ai(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:E=>"id"in E,get:E=>E.id,set:(E,T)=>{E.id=T}},metadata:C},c,u),Ai(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:E=>"offset_"in E,get:E=>E.offset_,set:(E,T)=>{E.offset_=T}},metadata:C},h,p),Ai(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:E=>"offset"in E,get:E=>E.offset,set:(E,T)=>{E.offset=T}},metadata:C},b,x),Ai(null,null,w,{kind:"field",name:"size",static:!1,private:!1,access:{has:E=>"size"in E,get:E=>E.size,set:(E,T)=>{E.size=T}},metadata:C},_,S),Ai(null,s={value:o},i,{kind:"class",name:o.name,metadata:C},null,a),o=s.value,C&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:C}),Qn(o,a)})(),o})();const _$=255;let Yh=(()=>{var e,t,n,r;let i=[Xp()],s,a=[],o,l,c=[],u=[],d,h=[],p=[],y,b=[],x=[],w,_=[],S=[],C,E=[],T=[];var R=o=class{constructor(M=oi(new Ke(pt.EINVAL,"Metadata block must be initialized with a superblock")),N=0){if(this.superblock=M,this.offset=N,this.checksum=Qn(this,c,0),this.timestamp=(Qn(this,u),Qn(this,h,Date.now())),this.previous_offset_=(Qn(this,p),Qn(this,b,0)),this.previous_offset=(Qn(this,x),Qn(this,_,0)),this._previous=Qn(this,S),this.entries=Qn(this,E,Array.from({length:_$},()=>new w$)),Qn(this,T),this.superblock=M,this.offset=N,!!N&&(aE(this,M.store._buffer.subarray(N,N+Ii(R))),!DK(this)))throw oE(new Ke(pt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+N.toString(16)))}get previous(){var M;if(this.previous_offset)return(M=this._previous)!==null&&M!==void 0||(this._previous=new R(this.superblock,this.previous_offset)),this._previous}};return sP(o,"MetadataBlock"),(()=>{const M=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=qn).uint32.bind(e)],d=[(t=qn).uint32.bind(t)],y=[(n=qn).uint32.bind(n)],w=[(r=qn).uint32.bind(r)],C=[xx(w$,_$)],Ai(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:N=>"checksum"in N,get:N=>N.checksum,set:(N,O)=>{N.checksum=O}},metadata:M},c,u),Ai(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:N=>"timestamp"in N,get:N=>N.timestamp,set:(N,O)=>{N.timestamp=O}},metadata:M},h,p),Ai(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:N=>"previous_offset_"in N,get:N=>N.previous_offset_,set:(N,O)=>{N.previous_offset_=O}},metadata:M},b,x),Ai(null,null,w,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:N=>"previous_offset"in N,get:N=>N.previous_offset,set:(N,O)=>{N.previous_offset=O}},metadata:M},_,S),Ai(null,null,C,{kind:"field",name:"entries",static:!1,private:!1,access:{has:N=>"entries"in N,get:N=>N.entries,set:(N,O)=>{N.entries=O}},metadata:M},E,T),Ai(null,s={value:o},i,{kind:"class",name:o.name,metadata:M},null,a),R=o=s.value,M&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:M}),Qn(o,a)})(),R=o})();const S$=2049864546;(()=>{var e,t,n,r,i,s,a,o,l,c,u;let d=[Xp()],h,p=[],y,b,x=[],w=[],_,S=[],C=[],E,T=[],R=[],M,N=[],O=[],B,P=[],H=[],F,Q=[],q=[],K,U=[],re=[],G,ne=[],te=[],se,pe=[],de=[],Ne,Pe=[],Me=[],Ee,Ue=[],nt=[],He,je=[],Y=[],be,Re=[],ce=[];var le=y=class{constructor(ae=oi(new Ke(pt.EINVAL,"Super block must be initialized with a store"))){if(this.store=ae,this.checksum=Qn(this,x,0),this.magic=(Qn(this,w),Qn(this,S,S$)),this.version=(Qn(this,C),Qn(this,T,1)),this.inode_format=(Qn(this,R),Qn(this,N,e1e)),this.flags=(Qn(this,O),Qn(this,P,0)),this.used_bytes=(Qn(this,H),Qn(this,Q,BigInt(0))),this.total_bytes=(Qn(this,q),Qn(this,U,BigInt(0))),this.uuid=(Qn(this,re),Qn(this,ne,BigInt(0))),this.metadata_block_size=(Qn(this,te),Qn(this,pe,Ii(Yh))),this.metadata_offset_=(Qn(this,de),Qn(this,Pe,0)),this.metadata_offset=(Qn(this,Me),Qn(this,Ue,0)),this.metadata=Qn(this,nt),this.label=Qn(this,je,""),this._padding=(Qn(this,Y),Qn(this,Re,new Array(132).fill(0))),Qn(this,ce),this.store=ae,ae._view.getUint32(ywe(le,"magic"),!0)!=S$){ga("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new Yh(this),this.metadata.offset=Ii(le),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(Ii(le)+Ii(Yh)),this.total_bytes=BigInt(ae._buffer.byteLength),ae._write(this),ae._write(this.metadata);return}if(aE(this,ae._buffer.subarray(0,Ii(le))),!DK(this))throw oE(new Ke(pt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new Yh(this,this.metadata_offset)}rotateMetadata(){const ae=new Yh(this);return ae.offset=Number(this.used_bytes),ae.previous_offset=this.metadata_offset,this.metadata=ae,this.metadata_offset=ae.offset,this.store._write(ae),this.used_bytes+=BigInt(Ii(Yh)),this.store._write(this),ae}isUnused(ae,Te){if(!Te)return!0;if(ae+Te>this.total_bytes||ae<Ii(le))return!1;for(let $e=this.metadata;$e;$e=$e.previous){if(ae<$e.offset+Ii(Yh)&&ae+Te>$e.offset)return!1;for(const ke of $e.entries)if(ke.offset&&(ae>=ke.offset&&ae<ke.offset+ke.size||ae+Te>ke.offset&&ae+Te<=ke.offset+ke.size||ae<=ke.offset&&ae+Te>=ke.offset+ke.size))return!1}return!0}};return sP(y,"SuperBlock"),(()=>{const ae=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=qn).uint32.bind(e)],_=[(t=qn).uint32.bind(t)],E=[(n=qn).uint16.bind(n)],M=[(r=qn).uint16.bind(r)],B=[(i=qn).uint32.bind(i)],F=[(s=qn).uint64.bind(s)],K=[(a=qn).uint64.bind(a)],G=[(o=qn).uint128.bind(o)],se=[(l=qn).uint32.bind(l)],Ne=[(c=qn).uint32.bind(c)],Ee=[(u=qn).uint32.bind(u)],He=[qn.char(64)],be=[qn.char(132)],Ai(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Te=>"checksum"in Te,get:Te=>Te.checksum,set:(Te,$e)=>{Te.checksum=$e}},metadata:ae},x,w),Ai(null,null,_,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Te=>"magic"in Te,get:Te=>Te.magic,set:(Te,$e)=>{Te.magic=$e}},metadata:ae},S,C),Ai(null,null,E,{kind:"field",name:"version",static:!1,private:!1,access:{has:Te=>"version"in Te,get:Te=>Te.version,set:(Te,$e)=>{Te.version=$e}},metadata:ae},T,R),Ai(null,null,M,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Te=>"inode_format"in Te,get:Te=>Te.inode_format,set:(Te,$e)=>{Te.inode_format=$e}},metadata:ae},N,O),Ai(null,null,B,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Te=>"flags"in Te,get:Te=>Te.flags,set:(Te,$e)=>{Te.flags=$e}},metadata:ae},P,H),Ai(null,null,F,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Te=>"used_bytes"in Te,get:Te=>Te.used_bytes,set:(Te,$e)=>{Te.used_bytes=$e}},metadata:ae},Q,q),Ai(null,null,K,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Te=>"total_bytes"in Te,get:Te=>Te.total_bytes,set:(Te,$e)=>{Te.total_bytes=$e}},metadata:ae},U,re),Ai(null,null,G,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Te=>"uuid"in Te,get:Te=>Te.uuid,set:(Te,$e)=>{Te.uuid=$e}},metadata:ae},ne,te),Ai(null,null,se,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Te=>"metadata_block_size"in Te,get:Te=>Te.metadata_block_size,set:(Te,$e)=>{Te.metadata_block_size=$e}},metadata:ae},pe,de),Ai(null,null,Ne,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Te=>"metadata_offset_"in Te,get:Te=>Te.metadata_offset_,set:(Te,$e)=>{Te.metadata_offset_=$e}},metadata:ae},Pe,Me),Ai(null,null,Ee,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Te=>"metadata_offset"in Te,get:Te=>Te.metadata_offset,set:(Te,$e)=>{Te.metadata_offset=$e}},metadata:ae},Ue,nt),Ai(null,null,He,{kind:"field",name:"label",static:!1,private:!1,access:{has:Te=>"label"in Te,get:Te=>Te.label,set:(Te,$e)=>{Te.label=$e}},metadata:ae},je,Y),Ai(null,null,be,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Te=>"_padding"in Te,get:Te=>Te._padding,set:(Te,$e)=>{Te._padding=$e}},metadata:ae},Re,ce),Ai(null,h={value:y},d,{kind:"class",name:y.name,metadata:ae},null,p),le=y=h.value,ae&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:ae}),Qn(y,p)})(),le=y})();function DK(e){const t=Qs(e),n=aSe(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=Ws;function oSe(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function G3(e,t,n){if(e instanceof Ke)return e;const r=e instanceof DOMException?pt[oSe(e)]:pt.EIO,i=new Ke(r,e.message,t,n);return i.stack=e.stack,i.cause=e.cause,i}function Ag(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(G3(e.error))}})}class lSe extends V3{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await Ag(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await Ag(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await Ag(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),Ag(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(G3(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(G3(this.tx.error)),this.tx.abort(),t}}async function cSe(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(ga("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await Ag(n)}class uSe{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new lSe(t,this)}}const dSe={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await Ag(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await cSe(e.storeName||"zenfs",e.idbFactory),n=new uSe(t),r=new XG(n);if(e!=null&&e.disableAsyncCache)return MO("Async preloading disabled for IndexedDB"),r;const i=n.transaction();for(const s of await i.keys())await i.get(s);return r}},fSe=dSe,ln={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function oS(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rM={exports:{}},C$;function hSe(){return C$||(C$=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,i,s){function a(c,u){if(!i[c]){if(!r[c]){var d=typeof oS=="function"&&oS;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[c]={exports:{}};r[c][0].call(p.exports,function(y){var b=r[c][1][y];return a(b||y)},p,p.exports,n,r,i,s)}return i[c].exports}for(var o=typeof oS=="function"&&oS,l=0;l<s.length;l++)a(s[l]);return a}({1:[function(n,r,i){var s=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,d,h,p,y,b,x=[],w=0,_=l.length,S=_,C=s.getTypeOf(l)!=="string";w<l.length;)S=_-w,d=C?(c=l[w++],u=w<_?l[w++]:0,w<_?l[w++]:0):(c=l.charCodeAt(w++),u=w<_?l.charCodeAt(w++):0,w<_?l.charCodeAt(w++):0),h=c>>2,p=(3&c)<<4|u>>4,y=1<S?(15&u)<<2|d>>6:64,b=2<S?63&d:64,x.push(o.charAt(h)+o.charAt(p)+o.charAt(y)+o.charAt(b));return x.join("")},i.decode=function(l){var c,u,d,h,p,y,b=0,x=0,w="data:";if(l.substr(0,w.length)===w)throw new Error("Invalid base64 input, it looks like a data url.");var _,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(_=a.uint8array?new Uint8Array(0|S):new Array(0|S);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(p=o.indexOf(l.charAt(b++)))>>2,d=(3&p)<<6|(y=o.indexOf(l.charAt(b++))),_[x++]=c,p!==64&&(_[x++]=u),y!==64&&(_[x++]=d);return _}},{"./support":30,"./utils":32}],2:[function(n,r,i){var s=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,p,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=p,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,i){var s=n("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,i){var s=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?function(c,u,d,h){var p=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^p[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var p=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^p[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(n,r,i){var s=null;s=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:s}},{lie:37}],7:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=s?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}i.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},i.compressWorker=function(d){return new u("Deflate",d)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,i){function s(p,y){var b,x="";for(b=0;b<y;b++)x+=String.fromCharCode(255&p),p>>>=8;return x}function a(p,y,b,x,w,_){var S,C,E=p.file,T=p.compression,R=_!==c.utf8encode,M=o.transformTo("string",_(E.name)),N=o.transformTo("string",c.utf8encode(E.name)),O=E.comment,B=o.transformTo("string",_(O)),P=o.transformTo("string",c.utf8encode(O)),H=N.length!==E.name.length,F=P.length!==O.length,Q="",q="",K="",U=E.dir,re=E.date,G={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(G.crc32=p.crc32,G.compressedSize=p.compressedSize,G.uncompressedSize=p.uncompressedSize);var ne=0;y&&(ne|=8),R||!H&&!F||(ne|=2048);var te=0,se=0;U&&(te|=16),w==="UNIX"?(se=798,te|=function(de,Ne){var Pe=de;return de||(Pe=Ne?16893:33204),(65535&Pe)<<16}(E.unixPermissions,U)):(se=20,te|=function(de){return 63&(de||0)}(E.dosPermissions)),S=re.getUTCHours(),S<<=6,S|=re.getUTCMinutes(),S<<=5,S|=re.getUTCSeconds()/2,C=re.getUTCFullYear()-1980,C<<=4,C|=re.getUTCMonth()+1,C<<=5,C|=re.getUTCDate(),H&&(q=s(1,1)+s(u(M),4)+N,Q+="up"+s(q.length,2)+q),F&&(K=s(1,1)+s(u(B),4)+P,Q+="uc"+s(K.length,2)+K);var pe="";return pe+=`
\0`,pe+=s(ne,2),pe+=T.magic,pe+=s(S,2),pe+=s(C,2),pe+=s(G.crc32,4),pe+=s(G.compressedSize,4),pe+=s(G.uncompressedSize,4),pe+=s(M.length,2),pe+=s(Q.length,2),{fileRecord:d.LOCAL_FILE_HEADER+pe+M+Q,dirRecord:d.CENTRAL_FILE_HEADER+s(se,2)+pe+s(B.length,2)+"\0\0\0\0"+s(te,4)+s(x,4)+M+Q+B}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(p,y,b,x){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=x,this.streamFiles=p,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(p){var y=p.meta.percent||0,b=this.entriesCount,x=this._sources.length;this.accumulate?this.contentBuffer.push(p):(this.bytesWritten+=p.data.length,l.prototype.push.call(this,{data:p.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-x-1))/b:100}}))},h.prototype.openedSource=function(p){this.currentSourceOffset=this.bytesWritten,this.currentFile=p.file.name;var y=this.streamFiles&&!p.file.dir;if(y){var b=a(p,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(p){this.accumulate=!1;var y=this.streamFiles&&!p.file.dir,b=a(p,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(x){return d.DATA_DESCRIPTOR+s(x.crc32,4)+s(x.compressedSize,4)+s(x.uncompressedSize,4)}(p),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var p=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-p,x=function(w,_,S,C,E){var T=o.transformTo("string",E(C));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(w,2)+s(w,2)+s(_,4)+s(S,4)+s(T.length,2)+T}(this.dirRecords.length,b,p,this.zipComment,this.encodeFileName);this.push({data:x,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(p){this._sources.push(p);var y=this;return p.on("data",function(b){y.processChunk(b)}),p.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),p.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(p){var y=this._sources;if(!l.prototype.error.call(this,p))return!1;for(var b=0;b<y.length;b++)try{y[b].error(p)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var p=this._sources,y=0;y<p.length;y++)p[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,i){var s=n("../compressions"),a=n("./ZipFileWorker");i.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,p){d++;var y=function(_,S){var C=_||S,E=s[C];if(!E)throw new Error(C+" is not a valid compression method !");return E}(p.options.compression,l.compression),b=p.options.compressionOptions||l.compressionOptions||{},x=p.dir,w=p.date;p._compressWorker(y,b).withStreamInfo("file",{name:h,dir:x,date:w,comment:p.comment||"",unixPermissions:p.unixPermissions,dosPermissions:p.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=n("./object")).loadAsync=n("./load"),s.support=n("./support"),s.defaults=n("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=n("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,i){var s=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(p,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(x){y(x)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):p()}).resume()})}r.exports=function(h,p){var y=this;return p=s.extend(p||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",h,!0,p.optimizedBinaryString,p.base64).then(function(b){var x=new l(p);return x.load(b),x}).then(function(b){var x=[a.Promise.resolve(b)],w=b.files;if(p.checkCRC32)for(var _=0;_<w.length;_++)x.push(d(w[_]));return a.Promise.all(x)}).then(function(b){for(var x=b.shift(),w=x.files,_=0;_<w.length;_++){var S=w[_],C=S.fileNameStr,E=s.resolve(S.fileNameStr);y.file(E,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:p.createFolders}),S.dir||(y.file(E).unsafeOriginalName=C)}return x.zipComment.length&&(y.comment=x.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,i){var s=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,i){var s=n("readable-stream").Readable;function a(o,l,c){s.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,i){r.exports={isNode:typeof sn<"u",newBufferFrom:function(s,a){if(sn.from&&sn.from!==Uint8Array.from)return sn.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new sn(s,a)},allocBuffer:function(s){if(sn.alloc)return sn.alloc(s);var a=new sn(s);return a.fill(0),a},isBuffer:function(s){return sn.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(n,r,i){function s(E,T,R){var M,N=o.getTypeOf(T),O=o.extend(R||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(E=w(E)),O.createFolders&&(M=x(E))&&_.call(this,M,!0);var B=N==="string"&&O.binary===!1&&O.base64===!1;R&&R.binary!==void 0||(O.binary=!B),(T instanceof d&&T.uncompressedSize===0||O.dir||!T||T.length===0)&&(O.base64=!1,O.binary=!0,T="",O.compression="STORE",N="string");var P=null;P=T instanceof d||T instanceof l?T:y.isNode&&y.isStream(T)?new b(E,T):o.prepareContent(E,T,O.binary,O.optimizedBinaryString,O.base64);var H=new h(E,P,O);this.files[E]=H}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),p=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),x=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var T=E.lastIndexOf("/");return 0<T?E.substring(0,T):""},w=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},_=function(E,T){return T=T!==void 0?T:u.createFolders,E=w(E),this.files[E]||s.call(this,E,null,{dir:!0,createFolders:T}),this.files[E]};function S(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var C={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var T,R,M;for(T in this.files)M=this.files[T],(R=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&E(R,M)},filter:function(E){var T=[];return this.forEach(function(R,M){E(R,M)&&T.push(M)}),T},file:function(E,T,R){if(arguments.length!==1)return E=this.root+E,s.call(this,E,T,R),this;if(S(E)){var M=E;return this.filter(function(O,B){return!B.dir&&M.test(O)})}var N=this.files[this.root+E];return N&&!N.dir?N:null},folder:function(E){if(!E)return this;if(S(E))return this.filter(function(N,O){return O.dir&&E.test(N)});var T=this.root+E,R=_.call(this,T),M=this.clone();return M.root=R.name,M},remove:function(E){E=this.root+E;var T=this.files[E];if(T||(E.slice(-1)!=="/"&&(E+="/"),T=this.files[E]),T&&!T.dir)delete this.files[E];else for(var R=this.filter(function(N,O){return O.name.slice(0,E.length)===E}),M=0;M<R.length;M++)delete this.files[R[M].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var T,R={};try{if((R=o.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");o.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var M=R.comment||this.comment||"";T=p.generateWorker(this,R,M)}catch(N){(T=new l("error")).error(N)}return new c(T,R.type||"string",R.mimeType)},generateAsync:function(E,T){return this.generateInternalStream(E).accumulate(T)},generateNodeStream:function(E,T){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(T)}};r.exports=C},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,i){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,i){var s=n("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,i){var s=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,i){var s=n("./Uint8ArrayReader");function a(o){s.call(this,o)}n("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,i){var s=n("./DataReader");function a(o){s.call(this,o)}n("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,i){var s=n("./ArrayReader");function a(o){s.call(this,o)}n("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,i){var s=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=s.getTypeOf(d);return s.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(s.transformTo("uint8array",d)):new o(s.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,i){var s=n("./GenericWorker"),a=n("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,i){var s=n("./GenericWorker"),a=n("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,i){var s=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,i){var s=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(n,r,i){var s=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(x,w){var _=[],S=y._internalType,C=y._outputType,E=y._mimeType;y.on("data",function(T,R){_.push(T),b&&b(R)}).on("error",function(T){_=[],w(T)}).on("end",function(){try{var T=function(R,M,N){switch(R){case"blob":return s.newBlob(s.transformTo("arraybuffer",M),N);case"base64":return l.encode(M);default:return s.transformTo(R,M)}}(C,function(R,M){var N,O=0,B=null,P=0;for(N=0;N<M.length;N++)P+=M[N].length;switch(R){case"string":return M.join("");case"array":return Array.prototype.concat.apply([],M);case"uint8array":for(B=new Uint8Array(P),N=0;N<M.length;N++)B.set(M[N],O),O+=M[N].length;return B;case"nodebuffer":return sn.concat(M);default:throw new Error("concat : unsupported type '"+R+"'")}}(S,_),E);x(T)}catch(R){w(R)}_=[]}).resume()})}function p(y,b,x){var w=b;switch(b){case"blob":case"arraybuffer":w="uint8array";break;case"base64":w="string"}try{this._internalType=w,this._outputType=b,this._mimeType=x,s.checkSupport(w),this._worker=y.pipe(new a(w)),y.lock()}catch(_){this._worker=new o("error"),this._worker.error(_)}}p.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var x=this;return y==="data"?this._worker.on(y,function(w){b.call(x,w.data,w.meta)}):this._worker.on(y,function(){s.delay(b,arguments,x)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof sn<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!n("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,i){for(var s=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}i.utf8encode=function(p){return a.nodebuffer?o.newBufferFrom(p,"utf-8"):function(y){var b,x,w,_,S,C=y.length,E=0;for(_=0;_<C;_++)(64512&(x=y.charCodeAt(_)))==55296&&_+1<C&&(64512&(w=y.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(w-56320),_++),E+=x<128?1:x<2048?2:x<65536?3:4;for(b=a.uint8array?new Uint8Array(E):new Array(E),_=S=0;S<E;_++)(64512&(x=y.charCodeAt(_)))==55296&&_+1<C&&(64512&(w=y.charCodeAt(_+1)))==56320&&(x=65536+(x-55296<<10)+(w-56320),_++),x<128?b[S++]=x:(x<2048?b[S++]=192|x>>>6:(x<65536?b[S++]=224|x>>>12:(b[S++]=240|x>>>18,b[S++]=128|x>>>12&63),b[S++]=128|x>>>6&63),b[S++]=128|63&x);return b}(p)},i.utf8decode=function(p){return a.nodebuffer?s.transformTo("nodebuffer",p).toString("utf-8"):function(y){var b,x,w,_,S=y.length,C=new Array(2*S);for(b=x=0;b<S;)if((w=y[b++])<128)C[x++]=w;else if(4<(_=c[w]))C[x++]=65533,b+=_-1;else{for(w&=_===2?31:_===3?15:7;1<_&&b<S;)w=w<<6|63&y[b++],_--;1<_?C[x++]=65533:w<65536?C[x++]=w:(w-=65536,C[x++]=55296|w>>10&1023,C[x++]=56320|1023&w)}return C.length!==x&&(C.subarray?C=C.subarray(0,x):C.length=x),s.applyFromCharCode(C)}(p=s.transformTo(a.uint8array?"uint8array":"array",p))},s.inherits(d,l),d.prototype.processChunk=function(p){var y=s.transformTo(a.uint8array?"uint8array":"array",p.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var x=function(_,S){var C;for((S=S||_.length)>_.length&&(S=_.length),C=S-1;0<=C&&(192&_[C])==128;)C--;return C<0||C===0?S:C+c[_[C]]>S?C:S}(y),w=y;x!==y.length&&(a.uint8array?(w=y.subarray(0,x),this.leftOver=y.subarray(x,y.length)):(w=y.slice(0,x),this.leftOver=y.slice(x,y.length))),this.push({data:i.utf8decode(w),meta:p.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=d,s.inherits(h,l),h.prototype.processChunk=function(p){this.push({data:i.utf8encode(p.data),meta:p.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,i){var s=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,x){for(var w=0;w<b.length;++w)x[w]=255&b.charCodeAt(w);return x}n("setimmediate"),i.newBlob=function(b,x){i.checkSupport("blob");try{return new Blob([b],{type:x})}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return w.append(b),w.getBlob(x)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,x,w){var _=[],S=0,C=b.length;if(C<=w)return String.fromCharCode.apply(null,b);for(;S<C;)x==="array"||x==="nodebuffer"?_.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+w,C)))):_.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+w,C)))),S+=w;return _.join("")},stringifyByChar:function(b){for(var x="",w=0;w<b.length;w++)x+=String.fromCharCode(b[w]);return x},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var x=65536,w=i.getTypeOf(b),_=!0;if(w==="uint8array"?_=d.applyCanBeUsed.uint8array:w==="nodebuffer"&&(_=d.applyCanBeUsed.nodebuffer),_)for(;1<x;)try{return d.stringifyByChunk(b,w,x)}catch{x=Math.floor(x/2)}return d.stringifyByChar(b)}function p(b,x){for(var w=0;w<b.length;w++)x[w]=b[w];return x}i.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return p(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return p(b,new Uint8Array(b.length))},nodebuffer:c},i.transformTo=function(b,x){if(x=x||"",!b)return x;i.checkSupport(b);var w=i.getTypeOf(x);return y[w][b](x)},i.resolve=function(b){for(var x=b.split("/"),w=[],_=0;_<x.length;_++){var S=x[_];S==="."||S===""&&_!==0&&_!==x.length-1||(S===".."?w.pop():w.push(S))}return w.join("/")},i.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(b)?"nodebuffer":s.uint8array&&b instanceof Uint8Array?"uint8array":s.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(b){if(!s[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(b){var x,w,_="";for(w=0;w<(b||"").length;w++)_+="\\x"+((x=b.charCodeAt(w))<16?"0":"")+x.toString(16).toUpperCase();return _},i.delay=function(b,x,w){setImmediate(function(){b.apply(w||null,x||[])})},i.inherits=function(b,x){function w(){}w.prototype=x.prototype,b.prototype=new w},i.extend=function(){var b,x,w={};for(b=0;b<arguments.length;b++)for(x in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],x)&&w[x]===void 0&&(w[x]=arguments[b][x]);return w},i.prepareContent=function(b,x,w,_,S){return l.Promise.resolve(x).then(function(C){return s.blob&&(C instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(C))!==-1)&&typeof FileReader<"u"?new l.Promise(function(E,T){var R=new FileReader;R.onload=function(M){E(M.target.result)},R.onerror=function(M){T(M.target.error)},R.readAsArrayBuffer(C)}):C}).then(function(C){var E=i.getTypeOf(C);return E?(E==="arraybuffer"?C=i.transformTo("uint8array",C):E==="string"&&(S?C=a.decode(C):w&&_!==!0&&(C=function(T){return u(T,s.uint8array?new Uint8Array(T.length):new Array(T.length))}(C))),C):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,i){var s=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var p=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(p),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",p=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(p)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,p,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),p=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:p}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var p=this.centralDirOffset+this.centralDirSize;this.zip64&&(p+=20,p+=12+this.zip64EndOfCentralSize);var y=h-p;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=s(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,i){var s=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(p,y){this.options=p,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(p){var y,b;if(p.skip(22),this.fileNameLength=p.readInt(2),b=p.readInt(2),this.fileName=p.readData(this.fileNameLength),p.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(x){for(var w in u)if(Object.prototype.hasOwnProperty.call(u,w)&&u[w].magic===x)return u[w];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,p.readData(this.compressedSize))},readCentralPart:function(p){this.versionMadeBy=p.readInt(2),p.skip(2),this.bitFlag=p.readInt(2),this.compressionMethod=p.readString(2),this.date=p.readDate(),this.crc32=p.readInt(4),this.compressedSize=p.readInt(4),this.uncompressedSize=p.readInt(4);var y=p.readInt(2);if(this.extraFieldsLength=p.readInt(2),this.fileCommentLength=p.readInt(2),this.diskNumberStart=p.readInt(2),this.internalFileAttributes=p.readInt(2),this.externalFileAttributes=p.readInt(4),this.localHeaderOffset=p.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");p.skip(y),this.readExtraFields(p),this.parseZIP64ExtraField(p),this.fileComment=p.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var p=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),p==0&&(this.dosPermissions=63&this.externalFileAttributes),p==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var p=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=p.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=p.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=p.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=p.readInt(4))}},readExtraFields:function(p){var y,b,x,w=p.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});p.index+4<w;)y=p.readInt(2),b=p.readInt(2),x=p.readData(b),this.extraFields[y]={id:y,length:b,value:x};p.setIndex(w)},handleUTF8:function(){var p=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(p,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var x=this.findExtraFieldUnicodeComment();if(x!==null)this.fileCommentStr=x;else{var w=a.transformTo(p,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(w)}}},findExtraFieldUnicodePath:function(){var p=this.extraFields[28789];if(p){var y=s(p.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(p.length-5))}return null},findExtraFieldUnicodeComment:function(){var p=this.extraFields[25461];if(p){var y=s(p.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(p.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,i){function s(y,b,x){this.name=y,this.dir=x.dir,this.date=x.date,this.comment=x.comment,this.unixPermissions=x.unixPermissions,this.dosPermissions=x.dosPermissions,this._data=b,this._dataBinary=x.binary,this.options={compression:x.compression,compressionOptions:x.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");s.prototype={internalStream:function(y){var b=null,x="string";try{if(!y)throw new Error("No output type specified.");var w=(x=y.toLowerCase())==="string"||x==="text";x!=="binarystring"&&x!=="text"||(x="string"),b=this._decompressWorker();var _=!this._dataBinary;_&&!w&&(b=b.pipe(new l.Utf8EncodeWorker)),!_&&w&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(S){(b=new u("error")).error(S)}return new a(b,x,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var x=this._decompressWorker();return this._dataBinary||(x=x.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(x,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<d.length;p++)s.prototype[d[p]]=h;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,i){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=s.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var b=s.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},s.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new s.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var p=[];function y(){var b,x;o=!0;for(var w=p.length;w;){for(x=p,p=[],b=-1;++b<w;)x[b]();w=p.length}o=!1}r.exports=function(b){p.push(b)!==1||o||a()}}).call(this,typeof cp<"u"?cp:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,i){var s=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(w){if(typeof w!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,w!==a&&b(this,w)}function h(w,_,S){this.promise=w,typeof _=="function"&&(this.onFulfilled=_,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function p(w,_,S){s(function(){var C;try{C=_(S)}catch(E){return o.reject(w,E)}C===w?o.reject(w,new TypeError("Cannot resolve promise with itself")):o.resolve(w,C)})}function y(w){var _=w&&w.then;if(w&&(typeof w=="object"||typeof w=="function")&&typeof _=="function")return function(){_.apply(w,arguments)}}function b(w,_){var S=!1;function C(R){S||(S=!0,o.reject(w,R))}function E(R){S||(S=!0,o.resolve(w,R))}var T=x(function(){_(E,C)});T.status==="error"&&C(T.value)}function x(w,_){var S={};try{S.value=w(_),S.status="success"}catch(C){S.status="error",S.value=C}return S}(r.exports=d).prototype.finally=function(w){if(typeof w!="function")return this;var _=this.constructor;return this.then(function(S){return _.resolve(w()).then(function(){return S})},function(S){return _.resolve(w()).then(function(){throw S})})},d.prototype.catch=function(w){return this.then(null,w)},d.prototype.then=function(w,_){if(typeof w!="function"&&this.state===c||typeof _!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?p(S,this.state===c?w:_,this.outcome):this.queue.push(new h(S,w,_)),S},h.prototype.callFulfilled=function(w){o.resolve(this.promise,w)},h.prototype.otherCallFulfilled=function(w){p(this.promise,this.onFulfilled,w)},h.prototype.callRejected=function(w){o.reject(this.promise,w)},h.prototype.otherCallRejected=function(w){p(this.promise,this.onRejected,w)},o.resolve=function(w,_){var S=x(y,_);if(S.status==="error")return o.reject(w,S.value);var C=S.value;if(C)b(w,C);else{w.state=c,w.outcome=_;for(var E=-1,T=w.queue.length;++E<T;)w.queue[E].callFulfilled(_)}return w},o.reject=function(w,_){w.state=l,w.outcome=_;for(var S=-1,C=w.queue.length;++S<C;)w.queue[S].callRejected(_);return w},d.resolve=function(w){return w instanceof this?w:o.resolve(new this(a),w)},d.reject=function(w){var _=new this(a);return o.reject(_,w)},d.all=function(w){var _=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=w.length,C=!1;if(!S)return this.resolve([]);for(var E=new Array(S),T=0,R=-1,M=new this(a);++R<S;)N(w[R],R);return M;function N(O,B){_.resolve(O).then(function(P){E[B]=P,++T!==S||C||(C=!0,o.resolve(M,E))},function(P){C||(C=!0,o.reject(M,P))})}},d.race=function(w){var _=this;if(Object.prototype.toString.call(w)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=w.length,C=!1;if(!S)return this.resolve([]);for(var E=-1,T=new this(a);++E<S;)R=w[E],_.resolve(R).then(function(M){C||(C=!0,o.resolve(T,M))},function(M){C||(C=!0,o.reject(T,M))});var R;return T}},{immediate:36}],38:[function(n,r,i){var s={};(0,n("./lib/utils/common").assign)(s,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,i){var s=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,p=0,y=8;function b(w){if(!(this instanceof b))return new b(w);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},w||{});var _=this.options;_.raw&&0<_.windowBits?_.windowBits=-_.windowBits:_.gzip&&0<_.windowBits&&_.windowBits<16&&(_.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=s.deflateInit2(this.strm,_.level,_.method,_.windowBits,_.memLevel,_.strategy);if(S!==d)throw new Error(l[S]);if(_.header&&s.deflateSetHeader(this.strm,_.header),_.dictionary){var C;if(C=typeof _.dictionary=="string"?o.string2buf(_.dictionary):u.call(_.dictionary)==="[object ArrayBuffer]"?new Uint8Array(_.dictionary):_.dictionary,(S=s.deflateSetDictionary(this.strm,C))!==d)throw new Error(l[S]);this._dict_set=!0}}function x(w,_){var S=new b(_);if(S.push(w,!0),S.err)throw S.msg||l[S.err];return S.result}b.prototype.push=function(w,_){var S,C,E=this.strm,T=this.options.chunkSize;if(this.ended)return!1;C=_===~~_?_:_===!0?4:0,typeof w=="string"?E.input=o.string2buf(w):u.call(w)==="[object ArrayBuffer]"?E.input=new Uint8Array(w):E.input=w,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(T),E.next_out=0,E.avail_out=T),(S=s.deflate(E,C))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);E.avail_out!==0&&(E.avail_in!==0||C!==4&&C!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(E.output,E.next_out))):this.onData(a.shrinkBuf(E.output,E.next_out)))}while((0<E.avail_in||E.avail_out===0)&&S!==1);return C===4?(S=s.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):C!==2||(this.onEnd(d),!(E.avail_out=0))},b.prototype.onData=function(w){this.chunks.push(w)},b.prototype.onEnd=function(w){w===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg},i.Deflate=b,i.deflate=x,i.deflateRaw=function(w,_){return(_=_||{}).raw=!0,x(w,_)},i.gzip=function(w,_){return(_=_||{}).gzip=!0,x(w,_)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,i){var s=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function p(b){if(!(this instanceof p))return new p(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var x=this.options;x.raw&&0<=x.windowBits&&x.windowBits<16&&(x.windowBits=-x.windowBits,x.windowBits===0&&(x.windowBits=-15)),!(0<=x.windowBits&&x.windowBits<16)||b&&b.windowBits||(x.windowBits+=32),15<x.windowBits&&x.windowBits<48&&(15&x.windowBits)==0&&(x.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var w=s.inflateInit2(this.strm,x.windowBits);if(w!==l.Z_OK)throw new Error(c[w]);this.header=new d,s.inflateGetHeader(this.strm,this.header)}function y(b,x){var w=new p(x);if(w.push(b,!0),w.err)throw w.msg||c[w.err];return w.result}p.prototype.push=function(b,x){var w,_,S,C,E,T,R=this.strm,M=this.options.chunkSize,N=this.options.dictionary,O=!1;if(this.ended)return!1;_=x===~~x?x:x===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?R.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?R.input=new Uint8Array(b):R.input=b,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new a.Buf8(M),R.next_out=0,R.avail_out=M),(w=s.inflate(R,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&N&&(T=typeof N=="string"?o.string2buf(N):h.call(N)==="[object ArrayBuffer]"?new Uint8Array(N):N,w=s.inflateSetDictionary(this.strm,T)),w===l.Z_BUF_ERROR&&O===!0&&(w=l.Z_OK,O=!1),w!==l.Z_STREAM_END&&w!==l.Z_OK)return this.onEnd(w),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&w!==l.Z_STREAM_END&&(R.avail_in!==0||_!==l.Z_FINISH&&_!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(R.output,R.next_out),C=R.next_out-S,E=o.buf2string(R.output,S),R.next_out=C,R.avail_out=M-C,C&&a.arraySet(R.output,R.output,S,C,0),this.onData(E)):this.onData(a.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(O=!0)}while((0<R.avail_in||R.avail_out===0)&&w!==l.Z_STREAM_END);return w===l.Z_STREAM_END&&(_=l.Z_FINISH),_===l.Z_FINISH?(w=s.inflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===l.Z_OK):_!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(R.avail_out=0))},p.prototype.onData=function(b){this.chunks.push(b)},p.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},i.Inflate=p,i.inflate=y,i.inflateRaw=function(b,x){return(x=x||{}).raw=!0,y(b,x)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var p=0;p<d;p++)l[h+p]=c[u+p]},flattenChunks:function(l){var c,u,d,h,p,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)p=l[c],y.set(p,h),h+=p.length;return y}},o={arraySet:function(l,c,u,d,h){for(var p=0;p<d;p++)l[h+p]=c[u+p]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(n,r,i){var s=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(d,h));for(var p="",y=0;y<h;y++)p+=String.fromCharCode(d[y]);return p}l[254]=l[254]=1,i.string2buf=function(d){var h,p,y,b,x,w=d.length,_=0;for(b=0;b<w;b++)(64512&(p=d.charCodeAt(b)))==55296&&b+1<w&&(64512&(y=d.charCodeAt(b+1)))==56320&&(p=65536+(p-55296<<10)+(y-56320),b++),_+=p<128?1:p<2048?2:p<65536?3:4;for(h=new s.Buf8(_),b=x=0;x<_;b++)(64512&(p=d.charCodeAt(b)))==55296&&b+1<w&&(64512&(y=d.charCodeAt(b+1)))==56320&&(p=65536+(p-55296<<10)+(y-56320),b++),p<128?h[x++]=p:(p<2048?h[x++]=192|p>>>6:(p<65536?h[x++]=224|p>>>12:(h[x++]=240|p>>>18,h[x++]=128|p>>>12&63),h[x++]=128|p>>>6&63),h[x++]=128|63&p);return h},i.buf2binstring=function(d){return u(d,d.length)},i.binstring2buf=function(d){for(var h=new s.Buf8(d.length),p=0,y=h.length;p<y;p++)h[p]=d.charCodeAt(p);return h},i.buf2string=function(d,h){var p,y,b,x,w=h||d.length,_=new Array(2*w);for(p=y=0;p<w;)if((b=d[p++])<128)_[y++]=b;else if(4<(x=l[b]))_[y++]=65533,p+=x-1;else{for(b&=x===2?31:x===3?15:7;1<x&&p<w;)b=b<<6|63&d[p++],x--;1<x?_[y++]=65533:b<65536?_[y++]=b:(b-=65536,_[y++]=55296|b>>10&1023,_[y++]=56320|1023&b)}return u(_,y)},i.utf8border=function(d,h){var p;for((h=h||d.length)>d.length&&(h=d.length),p=h-1;0<=p&&(192&d[p])==128;)p--;return p<0||p===0?h:p+l[d[p]]>h?p:h}},{"./common":41}],43:[function(n,r,i){r.exports=function(s,a,o,l){for(var c=65535&s|0,u=s>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,i){var s=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=s,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,i){var s,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,p=0,y=-2,b=-1,x=4,w=2,_=8,S=9,C=286,E=30,T=19,R=2*C+1,M=15,N=3,O=258,B=O+N+1,P=42,H=113,F=1,Q=2,q=3,K=4;function U(Y,be){return Y.msg=u[be],be}function re(Y){return(Y<<1)-(4<Y?9:0)}function G(Y){for(var be=Y.length;0<=--be;)Y[be]=0}function ne(Y){var be=Y.state,Re=be.pending;Re>Y.avail_out&&(Re=Y.avail_out),Re!==0&&(a.arraySet(Y.output,be.pending_buf,be.pending_out,Re,Y.next_out),Y.next_out+=Re,be.pending_out+=Re,Y.total_out+=Re,Y.avail_out-=Re,be.pending-=Re,be.pending===0&&(be.pending_out=0))}function te(Y,be){o._tr_flush_block(Y,0<=Y.block_start?Y.block_start:-1,Y.strstart-Y.block_start,be),Y.block_start=Y.strstart,ne(Y.strm)}function se(Y,be){Y.pending_buf[Y.pending++]=be}function pe(Y,be){Y.pending_buf[Y.pending++]=be>>>8&255,Y.pending_buf[Y.pending++]=255&be}function de(Y,be){var Re,ce,le=Y.max_chain_length,ae=Y.strstart,Te=Y.prev_length,$e=Y.nice_match,ke=Y.strstart>Y.w_size-B?Y.strstart-(Y.w_size-B):0,ot=Y.window,At=Y.w_mask,ft=Y.prev,jt=Y.strstart+O,Bt=ot[ae+Te-1],Ft=ot[ae+Te];Y.prev_length>=Y.good_match&&(le>>=2),$e>Y.lookahead&&($e=Y.lookahead);do if(ot[(Re=be)+Te]===Ft&&ot[Re+Te-1]===Bt&&ot[Re]===ot[ae]&&ot[++Re]===ot[ae+1]){ae+=2,Re++;do;while(ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ot[++ae]===ot[++Re]&&ae<jt);if(ce=O-(jt-ae),ae=jt-O,Te<ce){if(Y.match_start=be,$e<=(Te=ce))break;Bt=ot[ae+Te-1],Ft=ot[ae+Te]}}while((be=ft[be&At])>ke&&--le!=0);return Te<=Y.lookahead?Te:Y.lookahead}function Ne(Y){var be,Re,ce,le,ae,Te,$e,ke,ot,At,ft=Y.w_size;do{if(le=Y.window_size-Y.lookahead-Y.strstart,Y.strstart>=ft+(ft-B)){for(a.arraySet(Y.window,Y.window,ft,ft,0),Y.match_start-=ft,Y.strstart-=ft,Y.block_start-=ft,be=Re=Y.hash_size;ce=Y.head[--be],Y.head[be]=ft<=ce?ce-ft:0,--Re;);for(be=Re=ft;ce=Y.prev[--be],Y.prev[be]=ft<=ce?ce-ft:0,--Re;);le+=ft}if(Y.strm.avail_in===0)break;if(Te=Y.strm,$e=Y.window,ke=Y.strstart+Y.lookahead,ot=le,At=void 0,At=Te.avail_in,ot<At&&(At=ot),Re=At===0?0:(Te.avail_in-=At,a.arraySet($e,Te.input,Te.next_in,At,ke),Te.state.wrap===1?Te.adler=l(Te.adler,$e,At,ke):Te.state.wrap===2&&(Te.adler=c(Te.adler,$e,At,ke)),Te.next_in+=At,Te.total_in+=At,At),Y.lookahead+=Re,Y.lookahead+Y.insert>=N)for(ae=Y.strstart-Y.insert,Y.ins_h=Y.window[ae],Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[ae+1])&Y.hash_mask;Y.insert&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[ae+N-1])&Y.hash_mask,Y.prev[ae&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=ae,ae++,Y.insert--,!(Y.lookahead+Y.insert<N)););}while(Y.lookahead<B&&Y.strm.avail_in!==0)}function Pe(Y,be){for(var Re,ce;;){if(Y.lookahead<B){if(Ne(Y),Y.lookahead<B&&be===d)return F;if(Y.lookahead===0)break}if(Re=0,Y.lookahead>=N&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+N-1])&Y.hash_mask,Re=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),Re!==0&&Y.strstart-Re<=Y.w_size-B&&(Y.match_length=de(Y,Re)),Y.match_length>=N)if(ce=o._tr_tally(Y,Y.strstart-Y.match_start,Y.match_length-N),Y.lookahead-=Y.match_length,Y.match_length<=Y.max_lazy_match&&Y.lookahead>=N){for(Y.match_length--;Y.strstart++,Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+N-1])&Y.hash_mask,Re=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart,--Y.match_length!=0;);Y.strstart++}else Y.strstart+=Y.match_length,Y.match_length=0,Y.ins_h=Y.window[Y.strstart],Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+1])&Y.hash_mask;else ce=o._tr_tally(Y,0,Y.window[Y.strstart]),Y.lookahead--,Y.strstart++;if(ce&&(te(Y,!1),Y.strm.avail_out===0))return F}return Y.insert=Y.strstart<N-1?Y.strstart:N-1,be===h?(te(Y,!0),Y.strm.avail_out===0?q:K):Y.last_lit&&(te(Y,!1),Y.strm.avail_out===0)?F:Q}function Me(Y,be){for(var Re,ce,le;;){if(Y.lookahead<B){if(Ne(Y),Y.lookahead<B&&be===d)return F;if(Y.lookahead===0)break}if(Re=0,Y.lookahead>=N&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+N-1])&Y.hash_mask,Re=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),Y.prev_length=Y.match_length,Y.prev_match=Y.match_start,Y.match_length=N-1,Re!==0&&Y.prev_length<Y.max_lazy_match&&Y.strstart-Re<=Y.w_size-B&&(Y.match_length=de(Y,Re),Y.match_length<=5&&(Y.strategy===1||Y.match_length===N&&4096<Y.strstart-Y.match_start)&&(Y.match_length=N-1)),Y.prev_length>=N&&Y.match_length<=Y.prev_length){for(le=Y.strstart+Y.lookahead-N,ce=o._tr_tally(Y,Y.strstart-1-Y.prev_match,Y.prev_length-N),Y.lookahead-=Y.prev_length-1,Y.prev_length-=2;++Y.strstart<=le&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+N-1])&Y.hash_mask,Re=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),--Y.prev_length!=0;);if(Y.match_available=0,Y.match_length=N-1,Y.strstart++,ce&&(te(Y,!1),Y.strm.avail_out===0))return F}else if(Y.match_available){if((ce=o._tr_tally(Y,0,Y.window[Y.strstart-1]))&&te(Y,!1),Y.strstart++,Y.lookahead--,Y.strm.avail_out===0)return F}else Y.match_available=1,Y.strstart++,Y.lookahead--}return Y.match_available&&(ce=o._tr_tally(Y,0,Y.window[Y.strstart-1]),Y.match_available=0),Y.insert=Y.strstart<N-1?Y.strstart:N-1,be===h?(te(Y,!0),Y.strm.avail_out===0?q:K):Y.last_lit&&(te(Y,!1),Y.strm.avail_out===0)?F:Q}function Ee(Y,be,Re,ce,le){this.good_length=Y,this.max_lazy=be,this.nice_length=Re,this.max_chain=ce,this.func=le}function Ue(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*R),this.dyn_dtree=new a.Buf16(2*(2*E+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),G(this.dyn_ltree),G(this.dyn_dtree),G(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(M+1),this.heap=new a.Buf16(2*C+1),G(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*C+1),G(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function nt(Y){var be;return Y&&Y.state?(Y.total_in=Y.total_out=0,Y.data_type=w,(be=Y.state).pending=0,be.pending_out=0,be.wrap<0&&(be.wrap=-be.wrap),be.status=be.wrap?P:H,Y.adler=be.wrap===2?0:1,be.last_flush=d,o._tr_init(be),p):U(Y,y)}function He(Y){var be=nt(Y);return be===p&&function(Re){Re.window_size=2*Re.w_size,G(Re.head),Re.max_lazy_match=s[Re.level].max_lazy,Re.good_match=s[Re.level].good_length,Re.nice_match=s[Re.level].nice_length,Re.max_chain_length=s[Re.level].max_chain,Re.strstart=0,Re.block_start=0,Re.lookahead=0,Re.insert=0,Re.match_length=Re.prev_length=N-1,Re.match_available=0,Re.ins_h=0}(Y.state),be}function je(Y,be,Re,ce,le,ae){if(!Y)return y;var Te=1;if(be===b&&(be=6),ce<0?(Te=0,ce=-ce):15<ce&&(Te=2,ce-=16),le<1||S<le||Re!==_||ce<8||15<ce||be<0||9<be||ae<0||x<ae)return U(Y,y);ce===8&&(ce=9);var $e=new Ue;return(Y.state=$e).strm=Y,$e.wrap=Te,$e.gzhead=null,$e.w_bits=ce,$e.w_size=1<<$e.w_bits,$e.w_mask=$e.w_size-1,$e.hash_bits=le+7,$e.hash_size=1<<$e.hash_bits,$e.hash_mask=$e.hash_size-1,$e.hash_shift=~~(($e.hash_bits+N-1)/N),$e.window=new a.Buf8(2*$e.w_size),$e.head=new a.Buf16($e.hash_size),$e.prev=new a.Buf16($e.w_size),$e.lit_bufsize=1<<le+6,$e.pending_buf_size=4*$e.lit_bufsize,$e.pending_buf=new a.Buf8($e.pending_buf_size),$e.d_buf=1*$e.lit_bufsize,$e.l_buf=3*$e.lit_bufsize,$e.level=be,$e.strategy=ae,$e.method=Re,He(Y)}s=[new Ee(0,0,0,0,function(Y,be){var Re=65535;for(Re>Y.pending_buf_size-5&&(Re=Y.pending_buf_size-5);;){if(Y.lookahead<=1){if(Ne(Y),Y.lookahead===0&&be===d)return F;if(Y.lookahead===0)break}Y.strstart+=Y.lookahead,Y.lookahead=0;var ce=Y.block_start+Re;if((Y.strstart===0||Y.strstart>=ce)&&(Y.lookahead=Y.strstart-ce,Y.strstart=ce,te(Y,!1),Y.strm.avail_out===0)||Y.strstart-Y.block_start>=Y.w_size-B&&(te(Y,!1),Y.strm.avail_out===0))return F}return Y.insert=0,be===h?(te(Y,!0),Y.strm.avail_out===0?q:K):(Y.strstart>Y.block_start&&(te(Y,!1),Y.strm.avail_out),F)}),new Ee(4,4,8,4,Pe),new Ee(4,5,16,8,Pe),new Ee(4,6,32,32,Pe),new Ee(4,4,16,16,Me),new Ee(8,16,32,32,Me),new Ee(8,16,128,128,Me),new Ee(8,32,128,256,Me),new Ee(32,128,258,1024,Me),new Ee(32,258,258,4096,Me)],i.deflateInit=function(Y,be){return je(Y,be,_,15,8,0)},i.deflateInit2=je,i.deflateReset=He,i.deflateResetKeep=nt,i.deflateSetHeader=function(Y,be){return Y&&Y.state?Y.state.wrap!==2?y:(Y.state.gzhead=be,p):y},i.deflate=function(Y,be){var Re,ce,le,ae;if(!Y||!Y.state||5<be||be<0)return Y?U(Y,y):y;if(ce=Y.state,!Y.output||!Y.input&&Y.avail_in!==0||ce.status===666&&be!==h)return U(Y,Y.avail_out===0?-5:y);if(ce.strm=Y,Re=ce.last_flush,ce.last_flush=be,ce.status===P)if(ce.wrap===2)Y.adler=0,se(ce,31),se(ce,139),se(ce,8),ce.gzhead?(se(ce,(ce.gzhead.text?1:0)+(ce.gzhead.hcrc?2:0)+(ce.gzhead.extra?4:0)+(ce.gzhead.name?8:0)+(ce.gzhead.comment?16:0)),se(ce,255&ce.gzhead.time),se(ce,ce.gzhead.time>>8&255),se(ce,ce.gzhead.time>>16&255),se(ce,ce.gzhead.time>>24&255),se(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),se(ce,255&ce.gzhead.os),ce.gzhead.extra&&ce.gzhead.extra.length&&(se(ce,255&ce.gzhead.extra.length),se(ce,ce.gzhead.extra.length>>8&255)),ce.gzhead.hcrc&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending,0)),ce.gzindex=0,ce.status=69):(se(ce,0),se(ce,0),se(ce,0),se(ce,0),se(ce,0),se(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),se(ce,3),ce.status=H);else{var Te=_+(ce.w_bits-8<<4)<<8;Te|=(2<=ce.strategy||ce.level<2?0:ce.level<6?1:ce.level===6?2:3)<<6,ce.strstart!==0&&(Te|=32),Te+=31-Te%31,ce.status=H,pe(ce,Te),ce.strstart!==0&&(pe(ce,Y.adler>>>16),pe(ce,65535&Y.adler)),Y.adler=1}if(ce.status===69)if(ce.gzhead.extra){for(le=ce.pending;ce.gzindex<(65535&ce.gzhead.extra.length)&&(ce.pending!==ce.pending_buf_size||(ce.gzhead.hcrc&&ce.pending>le&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-le,le)),ne(Y),le=ce.pending,ce.pending!==ce.pending_buf_size));)se(ce,255&ce.gzhead.extra[ce.gzindex]),ce.gzindex++;ce.gzhead.hcrc&&ce.pending>le&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-le,le)),ce.gzindex===ce.gzhead.extra.length&&(ce.gzindex=0,ce.status=73)}else ce.status=73;if(ce.status===73)if(ce.gzhead.name){le=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>le&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-le,le)),ne(Y),le=ce.pending,ce.pending===ce.pending_buf_size)){ae=1;break}ae=ce.gzindex<ce.gzhead.name.length?255&ce.gzhead.name.charCodeAt(ce.gzindex++):0,se(ce,ae)}while(ae!==0);ce.gzhead.hcrc&&ce.pending>le&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-le,le)),ae===0&&(ce.gzindex=0,ce.status=91)}else ce.status=91;if(ce.status===91)if(ce.gzhead.comment){le=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>le&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-le,le)),ne(Y),le=ce.pending,ce.pending===ce.pending_buf_size)){ae=1;break}ae=ce.gzindex<ce.gzhead.comment.length?255&ce.gzhead.comment.charCodeAt(ce.gzindex++):0,se(ce,ae)}while(ae!==0);ce.gzhead.hcrc&&ce.pending>le&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-le,le)),ae===0&&(ce.status=103)}else ce.status=103;if(ce.status===103&&(ce.gzhead.hcrc?(ce.pending+2>ce.pending_buf_size&&ne(Y),ce.pending+2<=ce.pending_buf_size&&(se(ce,255&Y.adler),se(ce,Y.adler>>8&255),Y.adler=0,ce.status=H)):ce.status=H),ce.pending!==0){if(ne(Y),Y.avail_out===0)return ce.last_flush=-1,p}else if(Y.avail_in===0&&re(be)<=re(Re)&&be!==h)return U(Y,-5);if(ce.status===666&&Y.avail_in!==0)return U(Y,-5);if(Y.avail_in!==0||ce.lookahead!==0||be!==d&&ce.status!==666){var $e=ce.strategy===2?function(ke,ot){for(var At;;){if(ke.lookahead===0&&(Ne(ke),ke.lookahead===0)){if(ot===d)return F;break}if(ke.match_length=0,At=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++,At&&(te(ke,!1),ke.strm.avail_out===0))return F}return ke.insert=0,ot===h?(te(ke,!0),ke.strm.avail_out===0?q:K):ke.last_lit&&(te(ke,!1),ke.strm.avail_out===0)?F:Q}(ce,be):ce.strategy===3?function(ke,ot){for(var At,ft,jt,Bt,Ft=ke.window;;){if(ke.lookahead<=O){if(Ne(ke),ke.lookahead<=O&&ot===d)return F;if(ke.lookahead===0)break}if(ke.match_length=0,ke.lookahead>=N&&0<ke.strstart&&(ft=Ft[jt=ke.strstart-1])===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]){Bt=ke.strstart+O;do;while(ft===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]&&ft===Ft[++jt]&&jt<Bt);ke.match_length=O-(Bt-jt),ke.match_length>ke.lookahead&&(ke.match_length=ke.lookahead)}if(ke.match_length>=N?(At=o._tr_tally(ke,1,ke.match_length-N),ke.lookahead-=ke.match_length,ke.strstart+=ke.match_length,ke.match_length=0):(At=o._tr_tally(ke,0,ke.window[ke.strstart]),ke.lookahead--,ke.strstart++),At&&(te(ke,!1),ke.strm.avail_out===0))return F}return ke.insert=0,ot===h?(te(ke,!0),ke.strm.avail_out===0?q:K):ke.last_lit&&(te(ke,!1),ke.strm.avail_out===0)?F:Q}(ce,be):s[ce.level].func(ce,be);if($e!==q&&$e!==K||(ce.status=666),$e===F||$e===q)return Y.avail_out===0&&(ce.last_flush=-1),p;if($e===Q&&(be===1?o._tr_align(ce):be!==5&&(o._tr_stored_block(ce,0,0,!1),be===3&&(G(ce.head),ce.lookahead===0&&(ce.strstart=0,ce.block_start=0,ce.insert=0))),ne(Y),Y.avail_out===0))return ce.last_flush=-1,p}return be!==h?p:ce.wrap<=0?1:(ce.wrap===2?(se(ce,255&Y.adler),se(ce,Y.adler>>8&255),se(ce,Y.adler>>16&255),se(ce,Y.adler>>24&255),se(ce,255&Y.total_in),se(ce,Y.total_in>>8&255),se(ce,Y.total_in>>16&255),se(ce,Y.total_in>>24&255)):(pe(ce,Y.adler>>>16),pe(ce,65535&Y.adler)),ne(Y),0<ce.wrap&&(ce.wrap=-ce.wrap),ce.pending!==0?p:1)},i.deflateEnd=function(Y){var be;return Y&&Y.state?(be=Y.state.status)!==P&&be!==69&&be!==73&&be!==91&&be!==103&&be!==H&&be!==666?U(Y,y):(Y.state=null,be===H?U(Y,-3):p):y},i.deflateSetDictionary=function(Y,be){var Re,ce,le,ae,Te,$e,ke,ot,At=be.length;if(!Y||!Y.state||(ae=(Re=Y.state).wrap)===2||ae===1&&Re.status!==P||Re.lookahead)return y;for(ae===1&&(Y.adler=l(Y.adler,be,At,0)),Re.wrap=0,At>=Re.w_size&&(ae===0&&(G(Re.head),Re.strstart=0,Re.block_start=0,Re.insert=0),ot=new a.Buf8(Re.w_size),a.arraySet(ot,be,At-Re.w_size,Re.w_size,0),be=ot,At=Re.w_size),Te=Y.avail_in,$e=Y.next_in,ke=Y.input,Y.avail_in=At,Y.next_in=0,Y.input=be,Ne(Re);Re.lookahead>=N;){for(ce=Re.strstart,le=Re.lookahead-(N-1);Re.ins_h=(Re.ins_h<<Re.hash_shift^Re.window[ce+N-1])&Re.hash_mask,Re.prev[ce&Re.w_mask]=Re.head[Re.ins_h],Re.head[Re.ins_h]=ce,ce++,--le;);Re.strstart=ce,Re.lookahead=N-1,Ne(Re)}return Re.strstart+=Re.lookahead,Re.block_start=Re.strstart,Re.insert=Re.lookahead,Re.lookahead=0,Re.match_length=Re.prev_length=N-1,Re.match_available=0,Y.next_in=$e,Y.input=ke,Y.avail_in=Te,Re.wrap=ae,p},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,i){r.exports=function(s,a){var o,l,c,u,d,h,p,y,b,x,w,_,S,C,E,T,R,M,N,O,B,P,H,F,Q;o=s.state,l=s.next_in,F=s.input,c=l+(s.avail_in-5),u=s.next_out,Q=s.output,d=u-(a-s.avail_out),h=u+(s.avail_out-257),p=o.dmax,y=o.wsize,b=o.whave,x=o.wnext,w=o.window,_=o.hold,S=o.bits,C=o.lencode,E=o.distcode,T=(1<<o.lenbits)-1,R=(1<<o.distbits)-1;e:do{S<15&&(_+=F[l++]<<S,S+=8,_+=F[l++]<<S,S+=8),M=C[_&T];t:for(;;){if(_>>>=N=M>>>24,S-=N,(N=M>>>16&255)===0)Q[u++]=65535&M;else{if(!(16&N)){if((64&N)==0){M=C[(65535&M)+(_&(1<<N)-1)];continue t}if(32&N){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}O=65535&M,(N&=15)&&(S<N&&(_+=F[l++]<<S,S+=8),O+=_&(1<<N)-1,_>>>=N,S-=N),S<15&&(_+=F[l++]<<S,S+=8,_+=F[l++]<<S,S+=8),M=E[_&R];n:for(;;){if(_>>>=N=M>>>24,S-=N,!(16&(N=M>>>16&255))){if((64&N)==0){M=E[(65535&M)+(_&(1<<N)-1)];continue n}s.msg="invalid distance code",o.mode=30;break e}if(B=65535&M,S<(N&=15)&&(_+=F[l++]<<S,(S+=8)<N&&(_+=F[l++]<<S,S+=8)),p<(B+=_&(1<<N)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(_>>>=N,S-=N,(N=u-d)<B){if(b<(N=B-N)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if(H=w,(P=0)===x){if(P+=y-N,N<O){for(O-=N;Q[u++]=w[P++],--N;);P=u-B,H=Q}}else if(x<N){if(P+=y+x-N,(N-=x)<O){for(O-=N;Q[u++]=w[P++],--N;);if(P=0,x<O){for(O-=N=x;Q[u++]=w[P++],--N;);P=u-B,H=Q}}}else if(P+=x-N,N<O){for(O-=N;Q[u++]=w[P++],--N;);P=u-B,H=Q}for(;2<O;)Q[u++]=H[P++],Q[u++]=H[P++],Q[u++]=H[P++],O-=3;O&&(Q[u++]=H[P++],1<O&&(Q[u++]=H[P++]))}else{for(P=u-B;Q[u++]=Q[P++],Q[u++]=Q[P++],Q[u++]=Q[P++],2<(O-=3););O&&(Q[u++]=Q[P++],1<O&&(Q[u++]=Q[P++]))}break}}break}}while(l<c&&u<h);l-=O=S>>3,_&=(1<<(S-=O<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<h?h-u+257:257-(u-h),o.hold=_,o.bits=S}},{}],49:[function(n,r,i){var s=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,p=-2,y=1,b=852,x=592;function w(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function _(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(P){var H;return P&&P.state?(H=P.state,P.total_in=P.total_out=H.total=0,P.msg="",H.wrap&&(P.adler=1&H.wrap),H.mode=y,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new s.Buf32(b),H.distcode=H.distdyn=new s.Buf32(x),H.sane=1,H.back=-1,h):p}function C(P){var H;return P&&P.state?((H=P.state).wsize=0,H.whave=0,H.wnext=0,S(P)):p}function E(P,H){var F,Q;return P&&P.state?(Q=P.state,H<0?(F=0,H=-H):(F=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?p:(Q.window!==null&&Q.wbits!==H&&(Q.window=null),Q.wrap=F,Q.wbits=H,C(P))):p}function T(P,H){var F,Q;return P?(Q=new _,(P.state=Q).window=null,(F=E(P,H))!==h&&(P.state=null),F):p}var R,M,N=!0;function O(P){if(N){var H;for(R=new s.Buf32(512),M=new s.Buf32(32),H=0;H<144;)P.lens[H++]=8;for(;H<256;)P.lens[H++]=9;for(;H<280;)P.lens[H++]=7;for(;H<288;)P.lens[H++]=8;for(c(u,P.lens,0,288,R,0,P.work,{bits:9}),H=0;H<32;)P.lens[H++]=5;c(d,P.lens,0,32,M,0,P.work,{bits:5}),N=!1}P.lencode=R,P.lenbits=9,P.distcode=M,P.distbits=5}function B(P,H,F,Q){var q,K=P.state;return K.window===null&&(K.wsize=1<<K.wbits,K.wnext=0,K.whave=0,K.window=new s.Buf8(K.wsize)),Q>=K.wsize?(s.arraySet(K.window,H,F-K.wsize,K.wsize,0),K.wnext=0,K.whave=K.wsize):(Q<(q=K.wsize-K.wnext)&&(q=Q),s.arraySet(K.window,H,F-Q,q,K.wnext),(Q-=q)?(s.arraySet(K.window,H,F-Q,Q,0),K.wnext=Q,K.whave=K.wsize):(K.wnext+=q,K.wnext===K.wsize&&(K.wnext=0),K.whave<K.wsize&&(K.whave+=q))),0}i.inflateReset=C,i.inflateReset2=E,i.inflateResetKeep=S,i.inflateInit=function(P){return T(P,15)},i.inflateInit2=T,i.inflate=function(P,H){var F,Q,q,K,U,re,G,ne,te,se,pe,de,Ne,Pe,Me,Ee,Ue,nt,He,je,Y,be,Re,ce,le=0,ae=new s.Buf8(4),Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return p;(F=P.state).mode===12&&(F.mode=13),U=P.next_out,q=P.output,G=P.avail_out,K=P.next_in,Q=P.input,re=P.avail_in,ne=F.hold,te=F.bits,se=re,pe=G,be=h;e:for(;;)switch(F.mode){case y:if(F.wrap===0){F.mode=13;break}for(;te<16;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(2&F.wrap&&ne===35615){ae[F.check=0]=255&ne,ae[1]=ne>>>8&255,F.check=o(F.check,ae,2,0),te=ne=0,F.mode=2;break}if(F.flags=0,F.head&&(F.head.done=!1),!(1&F.wrap)||(((255&ne)<<8)+(ne>>8))%31){P.msg="incorrect header check",F.mode=30;break}if((15&ne)!=8){P.msg="unknown compression method",F.mode=30;break}if(te-=4,Y=8+(15&(ne>>>=4)),F.wbits===0)F.wbits=Y;else if(Y>F.wbits){P.msg="invalid window size",F.mode=30;break}F.dmax=1<<Y,P.adler=F.check=1,F.mode=512&ne?10:12,te=ne=0;break;case 2:for(;te<16;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(F.flags=ne,(255&F.flags)!=8){P.msg="unknown compression method",F.mode=30;break}if(57344&F.flags){P.msg="unknown header flags set",F.mode=30;break}F.head&&(F.head.text=ne>>8&1),512&F.flags&&(ae[0]=255&ne,ae[1]=ne>>>8&255,F.check=o(F.check,ae,2,0)),te=ne=0,F.mode=3;case 3:for(;te<32;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}F.head&&(F.head.time=ne),512&F.flags&&(ae[0]=255&ne,ae[1]=ne>>>8&255,ae[2]=ne>>>16&255,ae[3]=ne>>>24&255,F.check=o(F.check,ae,4,0)),te=ne=0,F.mode=4;case 4:for(;te<16;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}F.head&&(F.head.xflags=255&ne,F.head.os=ne>>8),512&F.flags&&(ae[0]=255&ne,ae[1]=ne>>>8&255,F.check=o(F.check,ae,2,0)),te=ne=0,F.mode=5;case 5:if(1024&F.flags){for(;te<16;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}F.length=ne,F.head&&(F.head.extra_len=ne),512&F.flags&&(ae[0]=255&ne,ae[1]=ne>>>8&255,F.check=o(F.check,ae,2,0)),te=ne=0}else F.head&&(F.head.extra=null);F.mode=6;case 6:if(1024&F.flags&&(re<(de=F.length)&&(de=re),de&&(F.head&&(Y=F.head.extra_len-F.length,F.head.extra||(F.head.extra=new Array(F.head.extra_len)),s.arraySet(F.head.extra,Q,K,de,Y)),512&F.flags&&(F.check=o(F.check,Q,de,K)),re-=de,K+=de,F.length-=de),F.length))break e;F.length=0,F.mode=7;case 7:if(2048&F.flags){if(re===0)break e;for(de=0;Y=Q[K+de++],F.head&&Y&&F.length<65536&&(F.head.name+=String.fromCharCode(Y)),Y&&de<re;);if(512&F.flags&&(F.check=o(F.check,Q,de,K)),re-=de,K+=de,Y)break e}else F.head&&(F.head.name=null);F.length=0,F.mode=8;case 8:if(4096&F.flags){if(re===0)break e;for(de=0;Y=Q[K+de++],F.head&&Y&&F.length<65536&&(F.head.comment+=String.fromCharCode(Y)),Y&&de<re;);if(512&F.flags&&(F.check=o(F.check,Q,de,K)),re-=de,K+=de,Y)break e}else F.head&&(F.head.comment=null);F.mode=9;case 9:if(512&F.flags){for(;te<16;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(ne!==(65535&F.check)){P.msg="header crc mismatch",F.mode=30;break}te=ne=0}F.head&&(F.head.hcrc=F.flags>>9&1,F.head.done=!0),P.adler=F.check=0,F.mode=12;break;case 10:for(;te<32;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}P.adler=F.check=w(ne),te=ne=0,F.mode=11;case 11:if(F.havedict===0)return P.next_out=U,P.avail_out=G,P.next_in=K,P.avail_in=re,F.hold=ne,F.bits=te,2;P.adler=F.check=1,F.mode=12;case 12:if(H===5||H===6)break e;case 13:if(F.last){ne>>>=7&te,te-=7&te,F.mode=27;break}for(;te<3;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}switch(F.last=1&ne,te-=1,3&(ne>>>=1)){case 0:F.mode=14;break;case 1:if(O(F),F.mode=20,H!==6)break;ne>>>=2,te-=2;break e;case 2:F.mode=17;break;case 3:P.msg="invalid block type",F.mode=30}ne>>>=2,te-=2;break;case 14:for(ne>>>=7&te,te-=7&te;te<32;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if((65535&ne)!=(ne>>>16^65535)){P.msg="invalid stored block lengths",F.mode=30;break}if(F.length=65535&ne,te=ne=0,F.mode=15,H===6)break e;case 15:F.mode=16;case 16:if(de=F.length){if(re<de&&(de=re),G<de&&(de=G),de===0)break e;s.arraySet(q,Q,K,de,U),re-=de,K+=de,G-=de,U+=de,F.length-=de;break}F.mode=12;break;case 17:for(;te<14;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(F.nlen=257+(31&ne),ne>>>=5,te-=5,F.ndist=1+(31&ne),ne>>>=5,te-=5,F.ncode=4+(15&ne),ne>>>=4,te-=4,286<F.nlen||30<F.ndist){P.msg="too many length or distance symbols",F.mode=30;break}F.have=0,F.mode=18;case 18:for(;F.have<F.ncode;){for(;te<3;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}F.lens[Te[F.have++]]=7&ne,ne>>>=3,te-=3}for(;F.have<19;)F.lens[Te[F.have++]]=0;if(F.lencode=F.lendyn,F.lenbits=7,Re={bits:F.lenbits},be=c(0,F.lens,0,19,F.lencode,0,F.work,Re),F.lenbits=Re.bits,be){P.msg="invalid code lengths set",F.mode=30;break}F.have=0,F.mode=19;case 19:for(;F.have<F.nlen+F.ndist;){for(;Ee=(le=F.lencode[ne&(1<<F.lenbits)-1])>>>16&255,Ue=65535&le,!((Me=le>>>24)<=te);){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(Ue<16)ne>>>=Me,te-=Me,F.lens[F.have++]=Ue;else{if(Ue===16){for(ce=Me+2;te<ce;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(ne>>>=Me,te-=Me,F.have===0){P.msg="invalid bit length repeat",F.mode=30;break}Y=F.lens[F.have-1],de=3+(3&ne),ne>>>=2,te-=2}else if(Ue===17){for(ce=Me+3;te<ce;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}te-=Me,Y=0,de=3+(7&(ne>>>=Me)),ne>>>=3,te-=3}else{for(ce=Me+7;te<ce;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}te-=Me,Y=0,de=11+(127&(ne>>>=Me)),ne>>>=7,te-=7}if(F.have+de>F.nlen+F.ndist){P.msg="invalid bit length repeat",F.mode=30;break}for(;de--;)F.lens[F.have++]=Y}}if(F.mode===30)break;if(F.lens[256]===0){P.msg="invalid code -- missing end-of-block",F.mode=30;break}if(F.lenbits=9,Re={bits:F.lenbits},be=c(u,F.lens,0,F.nlen,F.lencode,0,F.work,Re),F.lenbits=Re.bits,be){P.msg="invalid literal/lengths set",F.mode=30;break}if(F.distbits=6,F.distcode=F.distdyn,Re={bits:F.distbits},be=c(d,F.lens,F.nlen,F.ndist,F.distcode,0,F.work,Re),F.distbits=Re.bits,be){P.msg="invalid distances set",F.mode=30;break}if(F.mode=20,H===6)break e;case 20:F.mode=21;case 21:if(6<=re&&258<=G){P.next_out=U,P.avail_out=G,P.next_in=K,P.avail_in=re,F.hold=ne,F.bits=te,l(P,pe),U=P.next_out,q=P.output,G=P.avail_out,K=P.next_in,Q=P.input,re=P.avail_in,ne=F.hold,te=F.bits,F.mode===12&&(F.back=-1);break}for(F.back=0;Ee=(le=F.lencode[ne&(1<<F.lenbits)-1])>>>16&255,Ue=65535&le,!((Me=le>>>24)<=te);){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(Ee&&(240&Ee)==0){for(nt=Me,He=Ee,je=Ue;Ee=(le=F.lencode[je+((ne&(1<<nt+He)-1)>>nt)])>>>16&255,Ue=65535&le,!(nt+(Me=le>>>24)<=te);){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}ne>>>=nt,te-=nt,F.back+=nt}if(ne>>>=Me,te-=Me,F.back+=Me,F.length=Ue,Ee===0){F.mode=26;break}if(32&Ee){F.back=-1,F.mode=12;break}if(64&Ee){P.msg="invalid literal/length code",F.mode=30;break}F.extra=15&Ee,F.mode=22;case 22:if(F.extra){for(ce=F.extra;te<ce;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}F.length+=ne&(1<<F.extra)-1,ne>>>=F.extra,te-=F.extra,F.back+=F.extra}F.was=F.length,F.mode=23;case 23:for(;Ee=(le=F.distcode[ne&(1<<F.distbits)-1])>>>16&255,Ue=65535&le,!((Me=le>>>24)<=te);){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if((240&Ee)==0){for(nt=Me,He=Ee,je=Ue;Ee=(le=F.distcode[je+((ne&(1<<nt+He)-1)>>nt)])>>>16&255,Ue=65535&le,!(nt+(Me=le>>>24)<=te);){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}ne>>>=nt,te-=nt,F.back+=nt}if(ne>>>=Me,te-=Me,F.back+=Me,64&Ee){P.msg="invalid distance code",F.mode=30;break}F.offset=Ue,F.extra=15&Ee,F.mode=24;case 24:if(F.extra){for(ce=F.extra;te<ce;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}F.offset+=ne&(1<<F.extra)-1,ne>>>=F.extra,te-=F.extra,F.back+=F.extra}if(F.offset>F.dmax){P.msg="invalid distance too far back",F.mode=30;break}F.mode=25;case 25:if(G===0)break e;if(de=pe-G,F.offset>de){if((de=F.offset-de)>F.whave&&F.sane){P.msg="invalid distance too far back",F.mode=30;break}Ne=de>F.wnext?(de-=F.wnext,F.wsize-de):F.wnext-de,de>F.length&&(de=F.length),Pe=F.window}else Pe=q,Ne=U-F.offset,de=F.length;for(G<de&&(de=G),G-=de,F.length-=de;q[U++]=Pe[Ne++],--de;);F.length===0&&(F.mode=21);break;case 26:if(G===0)break e;q[U++]=F.length,G--,F.mode=21;break;case 27:if(F.wrap){for(;te<32;){if(re===0)break e;re--,ne|=Q[K++]<<te,te+=8}if(pe-=G,P.total_out+=pe,F.total+=pe,pe&&(P.adler=F.check=F.flags?o(F.check,q,pe,U-pe):a(F.check,q,pe,U-pe)),pe=G,(F.flags?ne:w(ne))!==F.check){P.msg="incorrect data check",F.mode=30;break}te=ne=0}F.mode=28;case 28:if(F.wrap&&F.flags){for(;te<32;){if(re===0)break e;re--,ne+=Q[K++]<<te,te+=8}if(ne!==(4294967295&F.total)){P.msg="incorrect length check",F.mode=30;break}te=ne=0}F.mode=29;case 29:be=1;break e;case 30:be=-3;break e;case 31:return-4;case 32:default:return p}return P.next_out=U,P.avail_out=G,P.next_in=K,P.avail_in=re,F.hold=ne,F.bits=te,(F.wsize||pe!==P.avail_out&&F.mode<30&&(F.mode<27||H!==4))&&B(P,P.output,P.next_out,pe-P.avail_out)?(F.mode=31,-4):(se-=P.avail_in,pe-=P.avail_out,P.total_in+=se,P.total_out+=pe,F.total+=pe,F.wrap&&pe&&(P.adler=F.check=F.flags?o(F.check,q,pe,P.next_out-pe):a(F.check,q,pe,P.next_out-pe)),P.data_type=F.bits+(F.last?64:0)+(F.mode===12?128:0)+(F.mode===20||F.mode===15?256:0),(se==0&&pe===0||H===4)&&be===h&&(be=-5),be)},i.inflateEnd=function(P){if(!P||!P.state)return p;var H=P.state;return H.window&&(H.window=null),P.state=null,h},i.inflateGetHeader=function(P,H){var F;return P&&P.state?(2&(F=P.state).wrap)==0?p:((F.head=H).done=!1,h):p},i.inflateSetDictionary=function(P,H){var F,Q=H.length;return P&&P.state?(F=P.state).wrap!==0&&F.mode!==11?p:F.mode===11&&a(1,H,Q,0)!==F.check?-3:B(P,H,Q,Q)?(F.mode=31,-4):(F.havedict=1,h):p},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,i){var s=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,p,y,b,x,w){var _,S,C,E,T,R,M,N,O,B=w.bits,P=0,H=0,F=0,Q=0,q=0,K=0,U=0,re=0,G=0,ne=0,te=null,se=0,pe=new s.Buf16(16),de=new s.Buf16(16),Ne=null,Pe=0;for(P=0;P<=15;P++)pe[P]=0;for(H=0;H<p;H++)pe[d[h+H]]++;for(q=B,Q=15;1<=Q&&pe[Q]===0;Q--);if(Q<q&&(q=Q),Q===0)return y[b++]=20971520,y[b++]=20971520,w.bits=1,0;for(F=1;F<Q&&pe[F]===0;F++);for(q<F&&(q=F),P=re=1;P<=15;P++)if(re<<=1,(re-=pe[P])<0)return-1;if(0<re&&(u===0||Q!==1))return-1;for(de[1]=0,P=1;P<15;P++)de[P+1]=de[P]+pe[P];for(H=0;H<p;H++)d[h+H]!==0&&(x[de[d[h+H]]++]=H);if(R=u===0?(te=Ne=x,19):u===1?(te=a,se-=257,Ne=o,Pe-=257,256):(te=l,Ne=c,-1),P=F,T=b,U=H=ne=0,C=-1,E=(G=1<<(K=q))-1,u===1&&852<G||u===2&&592<G)return 1;for(;;){for(M=P-U,O=x[H]<R?(N=0,x[H]):x[H]>R?(N=Ne[Pe+x[H]],te[se+x[H]]):(N=96,0),_=1<<P-U,F=S=1<<K;y[T+(ne>>U)+(S-=_)]=M<<24|N<<16|O|0,S!==0;);for(_=1<<P-1;ne&_;)_>>=1;if(_!==0?(ne&=_-1,ne+=_):ne=0,H++,--pe[P]==0){if(P===Q)break;P=d[h+x[H]]}if(q<P&&(ne&E)!==C){for(U===0&&(U=q),T+=F,re=1<<(K=P-U);K+U<Q&&!((re-=pe[K+U])<=0);)K++,re<<=1;if(G+=1<<K,u===1&&852<G||u===2&&592<G)return 1;y[C=ne&E]=q<<24|K<<16|T-b|0}}return ne!==0&&(y[T+ne]=P-U<<24|64<<16|0),w.bits=q,0}},{"../utils/common":41}],51:[function(n,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,i){var s=n("../utils/common"),a=0,o=1;function l(le){for(var ae=le.length;0<=--ae;)le[ae]=0}var c=0,u=29,d=256,h=d+1+u,p=30,y=19,b=2*h+1,x=15,w=16,_=7,S=256,C=16,E=17,T=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=new Array(2*(h+2));l(B);var P=new Array(2*p);l(P);var H=new Array(512);l(H);var F=new Array(256);l(F);var Q=new Array(u);l(Q);var q,K,U,re=new Array(p);function G(le,ae,Te,$e,ke){this.static_tree=le,this.extra_bits=ae,this.extra_base=Te,this.elems=$e,this.max_length=ke,this.has_stree=le&&le.length}function ne(le,ae){this.dyn_tree=le,this.max_code=0,this.stat_desc=ae}function te(le){return le<256?H[le]:H[256+(le>>>7)]}function se(le,ae){le.pending_buf[le.pending++]=255&ae,le.pending_buf[le.pending++]=ae>>>8&255}function pe(le,ae,Te){le.bi_valid>w-Te?(le.bi_buf|=ae<<le.bi_valid&65535,se(le,le.bi_buf),le.bi_buf=ae>>w-le.bi_valid,le.bi_valid+=Te-w):(le.bi_buf|=ae<<le.bi_valid&65535,le.bi_valid+=Te)}function de(le,ae,Te){pe(le,Te[2*ae],Te[2*ae+1])}function Ne(le,ae){for(var Te=0;Te|=1&le,le>>>=1,Te<<=1,0<--ae;);return Te>>>1}function Pe(le,ae,Te){var $e,ke,ot=new Array(x+1),At=0;for($e=1;$e<=x;$e++)ot[$e]=At=At+Te[$e-1]<<1;for(ke=0;ke<=ae;ke++){var ft=le[2*ke+1];ft!==0&&(le[2*ke]=Ne(ot[ft]++,ft))}}function Me(le){var ae;for(ae=0;ae<h;ae++)le.dyn_ltree[2*ae]=0;for(ae=0;ae<p;ae++)le.dyn_dtree[2*ae]=0;for(ae=0;ae<y;ae++)le.bl_tree[2*ae]=0;le.dyn_ltree[2*S]=1,le.opt_len=le.static_len=0,le.last_lit=le.matches=0}function Ee(le){8<le.bi_valid?se(le,le.bi_buf):0<le.bi_valid&&(le.pending_buf[le.pending++]=le.bi_buf),le.bi_buf=0,le.bi_valid=0}function Ue(le,ae,Te,$e){var ke=2*ae,ot=2*Te;return le[ke]<le[ot]||le[ke]===le[ot]&&$e[ae]<=$e[Te]}function nt(le,ae,Te){for(var $e=le.heap[Te],ke=Te<<1;ke<=le.heap_len&&(ke<le.heap_len&&Ue(ae,le.heap[ke+1],le.heap[ke],le.depth)&&ke++,!Ue(ae,$e,le.heap[ke],le.depth));)le.heap[Te]=le.heap[ke],Te=ke,ke<<=1;le.heap[Te]=$e}function He(le,ae,Te){var $e,ke,ot,At,ft=0;if(le.last_lit!==0)for(;$e=le.pending_buf[le.d_buf+2*ft]<<8|le.pending_buf[le.d_buf+2*ft+1],ke=le.pending_buf[le.l_buf+ft],ft++,$e===0?de(le,ke,ae):(de(le,(ot=F[ke])+d+1,ae),(At=R[ot])!==0&&pe(le,ke-=Q[ot],At),de(le,ot=te(--$e),Te),(At=M[ot])!==0&&pe(le,$e-=re[ot],At)),ft<le.last_lit;);de(le,S,ae)}function je(le,ae){var Te,$e,ke,ot=ae.dyn_tree,At=ae.stat_desc.static_tree,ft=ae.stat_desc.has_stree,jt=ae.stat_desc.elems,Bt=-1;for(le.heap_len=0,le.heap_max=b,Te=0;Te<jt;Te++)ot[2*Te]!==0?(le.heap[++le.heap_len]=Bt=Te,le.depth[Te]=0):ot[2*Te+1]=0;for(;le.heap_len<2;)ot[2*(ke=le.heap[++le.heap_len]=Bt<2?++Bt:0)]=1,le.depth[ke]=0,le.opt_len--,ft&&(le.static_len-=At[2*ke+1]);for(ae.max_code=Bt,Te=le.heap_len>>1;1<=Te;Te--)nt(le,ot,Te);for(ke=jt;Te=le.heap[1],le.heap[1]=le.heap[le.heap_len--],nt(le,ot,1),$e=le.heap[1],le.heap[--le.heap_max]=Te,le.heap[--le.heap_max]=$e,ot[2*ke]=ot[2*Te]+ot[2*$e],le.depth[ke]=(le.depth[Te]>=le.depth[$e]?le.depth[Te]:le.depth[$e])+1,ot[2*Te+1]=ot[2*$e+1]=ke,le.heap[1]=ke++,nt(le,ot,1),2<=le.heap_len;);le.heap[--le.heap_max]=le.heap[1],function(Ft,tn){var xe,D,X,me,De,we,Ie=tn.dyn_tree,fe=tn.max_code,yt=tn.stat_desc.static_tree,_t=tn.stat_desc.has_stree,z=tn.stat_desc.extra_bits,qe=tn.stat_desc.extra_base,rt=tn.stat_desc.max_length,ve=0;for(me=0;me<=x;me++)Ft.bl_count[me]=0;for(Ie[2*Ft.heap[Ft.heap_max]+1]=0,xe=Ft.heap_max+1;xe<b;xe++)rt<(me=Ie[2*Ie[2*(D=Ft.heap[xe])+1]+1]+1)&&(me=rt,ve++),Ie[2*D+1]=me,fe<D||(Ft.bl_count[me]++,De=0,qe<=D&&(De=z[D-qe]),we=Ie[2*D],Ft.opt_len+=we*(me+De),_t&&(Ft.static_len+=we*(yt[2*D+1]+De)));if(ve!==0){do{for(me=rt-1;Ft.bl_count[me]===0;)me--;Ft.bl_count[me]--,Ft.bl_count[me+1]+=2,Ft.bl_count[rt]--,ve-=2}while(0<ve);for(me=rt;me!==0;me--)for(D=Ft.bl_count[me];D!==0;)fe<(X=Ft.heap[--xe])||(Ie[2*X+1]!==me&&(Ft.opt_len+=(me-Ie[2*X+1])*Ie[2*X],Ie[2*X+1]=me),D--)}}(le,ae),Pe(ot,Bt,le.bl_count)}function Y(le,ae,Te){var $e,ke,ot=-1,At=ae[1],ft=0,jt=7,Bt=4;for(At===0&&(jt=138,Bt=3),ae[2*(Te+1)+1]=65535,$e=0;$e<=Te;$e++)ke=At,At=ae[2*($e+1)+1],++ft<jt&&ke===At||(ft<Bt?le.bl_tree[2*ke]+=ft:ke!==0?(ke!==ot&&le.bl_tree[2*ke]++,le.bl_tree[2*C]++):ft<=10?le.bl_tree[2*E]++:le.bl_tree[2*T]++,ot=ke,Bt=(ft=0)===At?(jt=138,3):ke===At?(jt=6,3):(jt=7,4))}function be(le,ae,Te){var $e,ke,ot=-1,At=ae[1],ft=0,jt=7,Bt=4;for(At===0&&(jt=138,Bt=3),$e=0;$e<=Te;$e++)if(ke=At,At=ae[2*($e+1)+1],!(++ft<jt&&ke===At)){if(ft<Bt)for(;de(le,ke,le.bl_tree),--ft!=0;);else ke!==0?(ke!==ot&&(de(le,ke,le.bl_tree),ft--),de(le,C,le.bl_tree),pe(le,ft-3,2)):ft<=10?(de(le,E,le.bl_tree),pe(le,ft-3,3)):(de(le,T,le.bl_tree),pe(le,ft-11,7));ot=ke,Bt=(ft=0)===At?(jt=138,3):ke===At?(jt=6,3):(jt=7,4)}}l(re);var Re=!1;function ce(le,ae,Te,$e){pe(le,(c<<1)+($e?1:0),3),function(ke,ot,At,ft){Ee(ke),se(ke,At),se(ke,~At),s.arraySet(ke.pending_buf,ke.window,ot,At,ke.pending),ke.pending+=At}(le,ae,Te)}i._tr_init=function(le){Re||(function(){var ae,Te,$e,ke,ot,At=new Array(x+1);for(ke=$e=0;ke<u-1;ke++)for(Q[ke]=$e,ae=0;ae<1<<R[ke];ae++)F[$e++]=ke;for(F[$e-1]=ke,ke=ot=0;ke<16;ke++)for(re[ke]=ot,ae=0;ae<1<<M[ke];ae++)H[ot++]=ke;for(ot>>=7;ke<p;ke++)for(re[ke]=ot<<7,ae=0;ae<1<<M[ke]-7;ae++)H[256+ot++]=ke;for(Te=0;Te<=x;Te++)At[Te]=0;for(ae=0;ae<=143;)B[2*ae+1]=8,ae++,At[8]++;for(;ae<=255;)B[2*ae+1]=9,ae++,At[9]++;for(;ae<=279;)B[2*ae+1]=7,ae++,At[7]++;for(;ae<=287;)B[2*ae+1]=8,ae++,At[8]++;for(Pe(B,h+1,At),ae=0;ae<p;ae++)P[2*ae+1]=5,P[2*ae]=Ne(ae,5);q=new G(B,R,d+1,h,x),K=new G(P,M,0,p,x),U=new G(new Array(0),N,0,y,_)}(),Re=!0),le.l_desc=new ne(le.dyn_ltree,q),le.d_desc=new ne(le.dyn_dtree,K),le.bl_desc=new ne(le.bl_tree,U),le.bi_buf=0,le.bi_valid=0,Me(le)},i._tr_stored_block=ce,i._tr_flush_block=function(le,ae,Te,$e){var ke,ot,At=0;0<le.level?(le.strm.data_type===2&&(le.strm.data_type=function(ft){var jt,Bt=4093624447;for(jt=0;jt<=31;jt++,Bt>>>=1)if(1&Bt&&ft.dyn_ltree[2*jt]!==0)return a;if(ft.dyn_ltree[18]!==0||ft.dyn_ltree[20]!==0||ft.dyn_ltree[26]!==0)return o;for(jt=32;jt<d;jt++)if(ft.dyn_ltree[2*jt]!==0)return o;return a}(le)),je(le,le.l_desc),je(le,le.d_desc),At=function(ft){var jt;for(Y(ft,ft.dyn_ltree,ft.l_desc.max_code),Y(ft,ft.dyn_dtree,ft.d_desc.max_code),je(ft,ft.bl_desc),jt=y-1;3<=jt&&ft.bl_tree[2*O[jt]+1]===0;jt--);return ft.opt_len+=3*(jt+1)+5+5+4,jt}(le),ke=le.opt_len+3+7>>>3,(ot=le.static_len+3+7>>>3)<=ke&&(ke=ot)):ke=ot=Te+5,Te+4<=ke&&ae!==-1?ce(le,ae,Te,$e):le.strategy===4||ot===ke?(pe(le,2+($e?1:0),3),He(le,B,P)):(pe(le,4+($e?1:0),3),function(ft,jt,Bt,Ft){var tn;for(pe(ft,jt-257,5),pe(ft,Bt-1,5),pe(ft,Ft-4,4),tn=0;tn<Ft;tn++)pe(ft,ft.bl_tree[2*O[tn]+1],3);be(ft,ft.dyn_ltree,jt-1),be(ft,ft.dyn_dtree,Bt-1)}(le,le.l_desc.max_code+1,le.d_desc.max_code+1,At+1),He(le,le.dyn_ltree,le.dyn_dtree)),Me(le),$e&&Ee(le)},i._tr_tally=function(le,ae,Te){return le.pending_buf[le.d_buf+2*le.last_lit]=ae>>>8&255,le.pending_buf[le.d_buf+2*le.last_lit+1]=255&ae,le.pending_buf[le.l_buf+le.last_lit]=255&Te,le.last_lit++,ae===0?le.dyn_ltree[2*Te]++:(le.matches++,ae--,le.dyn_ltree[2*(F[Te]+d+1)]++,le.dyn_dtree[2*te(ae)]++),le.last_lit===le.lit_bufsize-1},i._tr_align=function(le){pe(le,2,3),de(le,S,B),function(ae){ae.bi_valid===16?(se(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)}(le)}},{"../utils/common":41}],53:[function(n,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,i){(function(s){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,p={},y=!1,b=a.document,x=Object.getPrototypeOf&&Object.getPrototypeOf(a);x=x&&x.setTimeout?x:a,l={}.toString.call(a.process)==="[object process]"?function(C){es.nextTick(function(){_(C)})}:function(){if(a.postMessage&&!a.importScripts){var C=!0,E=a.onmessage;return a.onmessage=function(){C=!1},a.postMessage("","*"),a.onmessage=E,C}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(C){a.postMessage(d+C,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(C){_(C.data)},function(C){u.port2.postMessage(C)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(C){var E=b.createElement("script");E.onreadystatechange=function(){_(C),E.onreadystatechange=null,c.removeChild(E),E=null},c.appendChild(E)}):function(C){setTimeout(_,0,C)},x.setImmediate=function(C){typeof C!="function"&&(C=new Function(""+C));for(var E=new Array(arguments.length-1),T=0;T<E.length;T++)E[T]=arguments[T+1];var R={callback:C,args:E};return p[h]=R,l(h),h++},x.clearImmediate=w}function w(C){delete p[C]}function _(C){if(y)setTimeout(_,0,C);else{var E=p[C];if(E){y=!0;try{(function(T){var R=T.callback,M=T.args;switch(M.length){case 0:R();break;case 1:R(M[0]);break;case 2:R(M[0],M[1]);break;case 3:R(M[0],M[1],M[2]);break;default:R.apply(o,M)}})(E)}finally{w(C),y=!1}}}}function S(C){C.source===a&&typeof C.data=="string"&&C.data.indexOf(d)===0&&_(+C.data.slice(d.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof cp<"u"?cp:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(rM)),rM.exports}var pSe=hSe();const aP=aa(pSe),Ex=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,i=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,s)).toFixed(r))+" "+i[s]},jr=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},iu=(...e)=>jr(e.map(t=>t.trim()).filter(Boolean).join("/")),SE=e=>{const t=jr(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},ns=e=>{const t=jr(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},K3=(e,t)=>jr(e==="/"?`/${t}`:`${e}/${t}`);var iM,k$;function mSe(){if(k$)return iM;k$=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof es>"u"||typeof es.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,i){if(Array.isArray(t))return this._acquireBatch(t,n,r,i);if(typeof n!="function")throw new Error("You must pass a function to execute");var s=null,a=null,o=null;typeof r!="function"&&(i=r,r=null,o=new this.Promise(function(S,C){s=S,a=C})),i=i||{};var l=!1,c=null,u=null,d=null,h=this,p=function(S,C,E){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?C?a(C):s(E):typeof r=="function"&&r(C,E),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(S){if(l)return p(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=es.domain);var C=i.maxExecutionTime||h.maxExecutionTime;if(C&&(d=setTimeout(function(){h.queues[t]&&p(S,new Error("Maximum execution time is exceeded "+t))},C)),n.length===1){var E=!1;try{n(function(T,R){E||(E=!0,p(S,T,R))})}catch(T){E||(E=!0,p(S,T))}}else h._promiseTry(function(){return n()}).then(function(T){p(S,void 0,T)},function(T){p(S,T)})};h.domainReentrant&&es.domain&&(y=es.domain.bind(y));var b=i.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&es.domain&&es.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)p(!1,new Error("Too many pending tasks in queue "+t));else{var x=function(){y(!0)};i.skipQueue?h.queues[t].unshift(x):h.queues[t].push(x);var w=i.timeout||h.timeout;w&&(c=setTimeout(function(){c=null,p(!1,new Error("async-lock timed out in queue "+t))},w))}var _=i.maxOccupationTime||h.maxOccupationTime;if(_&&(u=setTimeout(function(){h.queues[t]&&p(!1,new Error("Maximum occupation time is exceeded in queue "+t))},_)),o)return o},e.prototype._acquireBatch=function(t,n,r,i){typeof r!="function"&&(i=r,r=null);var s=this,a=function(l,c){return function(u){s.acquire(l,c,u,i)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},iM=e,iM}var sM,E$;function gSe(){return E$||(E$=1,sM=mSe()),sM}var ySe=gSe();const Tx=aa(ySe);var lS={exports:{}},T$;function bSe(){return T$||(T$=1,typeof Object.create=="function"?lS.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:lS.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),lS.exports}var aM,A$;function vSe(){if(A$)return aM;A$=1;var e=YO().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var i=this._block,s=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%s,u=Math.min(a-l,s-c),d=0;d<u;d++)i[c+d]=n[l+d];o+=u,l+=u,o%s===0&&this._update(i)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=this._len*8;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var s=(i&4294967295)>>>0,a=(i-s)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(s,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},aM=t,aM}var oM,R$;function xSe(){if(R$)return oM;R$=1;var e=bSe(),t=vSe(),n=YO().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],i=new Array(80);function s(){this.init(),this._w=i,t.call(this,64,56)}e(s,t),s.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,p){return u===0?d&h|~d&p:u===2?d&h|d&p|h&p:d^h^p}return s.prototype._update=function(u){for(var d=this._w,h=this._a|0,p=this._b|0,y=this._c|0,b=this._d|0,x=this._e|0,w=0;w<16;++w)d[w]=u.readInt32BE(w*4);for(;w<80;++w)d[w]=a(d[w-3]^d[w-8]^d[w-14]^d[w-16]);for(var _=0;_<80;++_){var S=~~(_/20),C=o(h)+c(S,p,y,b)+x+d[_]+r[S]|0;x=b,b=y,y=l(p),p=h,h=C}this._a=h+this._a|0,this._b=p+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=x+this._e|0},s.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},oM=s,oM}var wSe=xSe();const FK=aa(wSe);var lM,I$;function _Se(){if(I$)return lM;I$=1;function e(i){if(typeof i!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(i))}function t(i,s){for(var a="",o=0,l=-1,c=0,u,d=0;d<=i.length;++d){if(d<i.length)u=i.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}s&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+i.slice(l+1,d):a=i.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(i,s){var a=s.dir||s.root,o=s.base||(s.name||"")+(s.ext||"");return a?a===s.root?a+o:a+i+o:o}var r={resolve:function(){for(var s="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=es.cwd()),c=o),e(c),c.length!==0&&(s=c+"/"+s,a=c.charCodeAt(0)===47)}return s=t(s,!a),a?s.length>0?"/"+s:"/":s.length>0?s:"."},normalize:function(s){if(e(s),s.length===0)return".";var a=s.charCodeAt(0)===47,o=s.charCodeAt(s.length-1)===47;return s=t(s,!a),s.length===0&&!a&&(s="."),s.length>0&&o&&(s+="/"),a?"/"+s:s},isAbsolute:function(s){return e(s),s.length>0&&s.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var s,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(s===void 0?s=o:s+="/"+o)}return s===void 0?".":r.normalize(s)},relative:function(s,a){if(e(s),e(a),s===a||(s=r.resolve(s),a=r.resolve(a),s===a))return"";for(var o=1;o<s.length&&s.charCodeAt(o)===47;++o);for(var l=s.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,p=c<h?c:h,y=-1,b=0;b<=p;++b){if(b===p){if(h>p){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>p&&(s.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var x=s.charCodeAt(o+b),w=a.charCodeAt(u+b);if(x!==w)break;x===47&&(y=b)}var _="";for(b=o+y+1;b<=l;++b)(b===l||s.charCodeAt(b)===47)&&(_.length===0?_+="..":_+="/..");return _.length>0?_+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(s){return s},dirname:function(s){if(e(s),s.length===0)return".";for(var a=s.charCodeAt(0),o=a===47,l=-1,c=!0,u=s.length-1;u>=1;--u)if(a=s.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":s.slice(0,l)},basename:function(s,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(s);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=s.length){if(a.length===s.length&&a===s)return"";var d=a.length-1,h=-1;for(u=s.length-1;u>=0;--u){var p=s.charCodeAt(u);if(p===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(p===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=s.length),s.slice(o,l)}else{for(u=s.length-1;u>=0;--u)if(s.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":s.slice(o,l)}},extname:function(s){e(s);for(var a=-1,o=0,l=-1,c=!0,u=0,d=s.length-1;d>=0;--d){var h=s.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":s.slice(a,l)},format:function(s){if(s===null||typeof s!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof s);return n("/",s)},parse:function(s){e(s);var a={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return a;var o=s.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,p=!0,y=s.length-1,b=0;y>=c;--y){if(o=s.charCodeAt(y),o===47){if(!p){d=y+1;break}continue}h===-1&&(p=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=s.slice(1,h):a.base=a.name=s.slice(d,h)):(d===0&&l?(a.name=s.slice(1,u),a.base=s.slice(1,h)):(a.name=s.slice(d,u),a.base=s.slice(d,h)),a.ext=s.slice(u,h)),d>0?a.dir=s.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,lM=r,lM}var Dt=_Se(),cM={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var M$;function SSe(){return M$||(M$=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var M=0,N=new Array(256),O=0;O!=256;++O)M=O,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,M=M&1?-306674912^M>>>1:M>>>1,N[O]=M;return typeof Int32Array<"u"?new Int32Array(N):N}var r=n();function i(M){var N=0,O=0,B=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)P[B]=M[B];for(B=0;B!=256;++B)for(O=M[B],N=256+B;N<4096;N+=256)O=P[N]=O>>>8^M[O&255];var H=[];for(B=1;B!=16;++B)H[B-1]=typeof Int32Array<"u"?P.subarray(B*256,B*256+256):P.slice(B*256,B*256+256);return H}var s=i(r),a=s[0],o=s[1],l=s[2],c=s[3],u=s[4],d=s[5],h=s[6],p=s[7],y=s[8],b=s[9],x=s[10],w=s[11],_=s[12],S=s[13],C=s[14];function E(M,N){for(var O=N^-1,B=0,P=M.length;B<P;)O=O>>>8^r[(O^M.charCodeAt(B++))&255];return~O}function T(M,N){for(var O=N^-1,B=M.length-15,P=0;P<B;)O=C[M[P++]^O&255]^S[M[P++]^O>>8&255]^_[M[P++]^O>>16&255]^w[M[P++]^O>>>24]^x[M[P++]]^b[M[P++]]^y[M[P++]]^p[M[P++]]^h[M[P++]]^d[M[P++]]^u[M[P++]]^c[M[P++]]^l[M[P++]]^o[M[P++]]^a[M[P++]]^r[M[P++]];for(B+=15;P<B;)O=O>>>8^r[(O^M[P++])&255];return~O}function R(M,N){for(var O=N^-1,B=0,P=M.length,H=0,F=0;B<P;)H=M.charCodeAt(B++),H<128?O=O>>>8^r[(O^H)&255]:H<2048?(O=O>>>8^r[(O^(192|H>>6&31))&255],O=O>>>8^r[(O^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,F=M.charCodeAt(B++)&1023,O=O>>>8^r[(O^(240|H>>8&7))&255],O=O>>>8^r[(O^(128|H>>2&63))&255],O=O>>>8^r[(O^(128|F>>6&15|(H&3)<<4))&255],O=O>>>8^r[(O^(128|F&63))&255]):(O=O>>>8^r[(O^(224|H>>12&15))&255],O=O>>>8^r[(O^(128|H>>6&63))&255],O=O>>>8^r[(O^(128|H&63))&255]);return~O}t.table=r,t.bstr=E,t.buf=T,t.str=R})}(cM)),cM}var CSe=SSe();const kSe=aa(CSe);var uM={},N$;function mh(){return N$||(N$=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(s,a){return Object.prototype.hasOwnProperty.call(s,a)}e.assign=function(s){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(s[l]=o[l])}}return s},e.shrinkBuf=function(s,a){return s.length===a?s:s.subarray?s.subarray(0,a):(s.length=a,s)};var r={arraySet:function(s,a,o,l,c){if(a.subarray&&s.subarray){s.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)s[c+u]=a[o+u]},flattenChunks:function(s){var a,o,l,c,u,d;for(l=0,a=0,o=s.length;a<o;a++)l+=s[a].length;for(d=new Uint8Array(l),c=0,a=0,o=s.length;a<o;a++)u=s[a],d.set(u,c),c+=u.length;return d}},i={arraySet:function(s,a,o,l,c){for(var u=0;u<l;u++)s[c+u]=a[o+u]},flattenChunks:function(s){return[].concat.apply([],s)}};e.setTyped=function(s){s?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,i))},e.setTyped(t)}(uM)),uM}var lg={},Dl={},Zh={},j$;function ESe(){if(j$)return Zh;j$=1;var e=mh(),t=4,n=0,r=1,i=2;function s(D){for(var X=D.length;--X>=0;)D[X]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,p=h+1+d,y=30,b=19,x=2*p+1,w=15,_=16,S=7,C=256,E=16,T=17,R=18,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=512,H=new Array((p+2)*2);s(H);var F=new Array(y*2);s(F);var Q=new Array(P);s(Q);var q=new Array(u-c+1);s(q);var K=new Array(d);s(K);var U=new Array(y);s(U);function re(D,X,me,De,we){this.static_tree=D,this.extra_bits=X,this.extra_base=me,this.elems=De,this.max_length=we,this.has_stree=D&&D.length}var G,ne,te;function se(D,X){this.dyn_tree=D,this.max_code=0,this.stat_desc=X}function pe(D){return D<256?Q[D]:Q[256+(D>>>7)]}function de(D,X){D.pending_buf[D.pending++]=X&255,D.pending_buf[D.pending++]=X>>>8&255}function Ne(D,X,me){D.bi_valid>_-me?(D.bi_buf|=X<<D.bi_valid&65535,de(D,D.bi_buf),D.bi_buf=X>>_-D.bi_valid,D.bi_valid+=me-_):(D.bi_buf|=X<<D.bi_valid&65535,D.bi_valid+=me)}function Pe(D,X,me){Ne(D,me[X*2],me[X*2+1])}function Me(D,X){var me=0;do me|=D&1,D>>>=1,me<<=1;while(--X>0);return me>>>1}function Ee(D){D.bi_valid===16?(de(D,D.bi_buf),D.bi_buf=0,D.bi_valid=0):D.bi_valid>=8&&(D.pending_buf[D.pending++]=D.bi_buf&255,D.bi_buf>>=8,D.bi_valid-=8)}function Ue(D,X){var me=X.dyn_tree,De=X.max_code,we=X.stat_desc.static_tree,Ie=X.stat_desc.has_stree,fe=X.stat_desc.extra_bits,yt=X.stat_desc.extra_base,_t=X.stat_desc.max_length,z,qe,rt,ve,Se,ze,Tt=0;for(ve=0;ve<=w;ve++)D.bl_count[ve]=0;for(me[D.heap[D.heap_max]*2+1]=0,z=D.heap_max+1;z<x;z++)qe=D.heap[z],ve=me[me[qe*2+1]*2+1]+1,ve>_t&&(ve=_t,Tt++),me[qe*2+1]=ve,!(qe>De)&&(D.bl_count[ve]++,Se=0,qe>=yt&&(Se=fe[qe-yt]),ze=me[qe*2],D.opt_len+=ze*(ve+Se),Ie&&(D.static_len+=ze*(we[qe*2+1]+Se)));if(Tt!==0){do{for(ve=_t-1;D.bl_count[ve]===0;)ve--;D.bl_count[ve]--,D.bl_count[ve+1]+=2,D.bl_count[_t]--,Tt-=2}while(Tt>0);for(ve=_t;ve!==0;ve--)for(qe=D.bl_count[ve];qe!==0;)rt=D.heap[--z],!(rt>De)&&(me[rt*2+1]!==ve&&(D.opt_len+=(ve-me[rt*2+1])*me[rt*2],me[rt*2+1]=ve),qe--)}}function nt(D,X,me){var De=new Array(w+1),we=0,Ie,fe;for(Ie=1;Ie<=w;Ie++)De[Ie]=we=we+me[Ie-1]<<1;for(fe=0;fe<=X;fe++){var yt=D[fe*2+1];yt!==0&&(D[fe*2]=Me(De[yt]++,yt))}}function He(){var D,X,me,De,we,Ie=new Array(w+1);for(me=0,De=0;De<d-1;De++)for(K[De]=me,D=0;D<1<<M[De];D++)q[me++]=De;for(q[me-1]=De,we=0,De=0;De<16;De++)for(U[De]=we,D=0;D<1<<N[De];D++)Q[we++]=De;for(we>>=7;De<y;De++)for(U[De]=we<<7,D=0;D<1<<N[De]-7;D++)Q[256+we++]=De;for(X=0;X<=w;X++)Ie[X]=0;for(D=0;D<=143;)H[D*2+1]=8,D++,Ie[8]++;for(;D<=255;)H[D*2+1]=9,D++,Ie[9]++;for(;D<=279;)H[D*2+1]=7,D++,Ie[7]++;for(;D<=287;)H[D*2+1]=8,D++,Ie[8]++;for(nt(H,p+1,Ie),D=0;D<y;D++)F[D*2+1]=5,F[D*2]=Me(D,5);G=new re(H,M,h+1,p,w),ne=new re(F,N,0,y,w),te=new re(new Array(0),O,0,b,S)}function je(D){var X;for(X=0;X<p;X++)D.dyn_ltree[X*2]=0;for(X=0;X<y;X++)D.dyn_dtree[X*2]=0;for(X=0;X<b;X++)D.bl_tree[X*2]=0;D.dyn_ltree[C*2]=1,D.opt_len=D.static_len=0,D.last_lit=D.matches=0}function Y(D){D.bi_valid>8?de(D,D.bi_buf):D.bi_valid>0&&(D.pending_buf[D.pending++]=D.bi_buf),D.bi_buf=0,D.bi_valid=0}function be(D,X,me,De){Y(D),de(D,me),de(D,~me),e.arraySet(D.pending_buf,D.window,X,me,D.pending),D.pending+=me}function Re(D,X,me,De){var we=X*2,Ie=me*2;return D[we]<D[Ie]||D[we]===D[Ie]&&De[X]<=De[me]}function ce(D,X,me){for(var De=D.heap[me],we=me<<1;we<=D.heap_len&&(we<D.heap_len&&Re(X,D.heap[we+1],D.heap[we],D.depth)&&we++,!Re(X,De,D.heap[we],D.depth));)D.heap[me]=D.heap[we],me=we,we<<=1;D.heap[me]=De}function le(D,X,me){var De,we,Ie=0,fe,yt;if(D.last_lit!==0)do De=D.pending_buf[D.d_buf+Ie*2]<<8|D.pending_buf[D.d_buf+Ie*2+1],we=D.pending_buf[D.l_buf+Ie],Ie++,De===0?Pe(D,we,X):(fe=q[we],Pe(D,fe+h+1,X),yt=M[fe],yt!==0&&(we-=K[fe],Ne(D,we,yt)),De--,fe=pe(De),Pe(D,fe,me),yt=N[fe],yt!==0&&(De-=U[fe],Ne(D,De,yt)));while(Ie<D.last_lit);Pe(D,C,X)}function ae(D,X){var me=X.dyn_tree,De=X.stat_desc.static_tree,we=X.stat_desc.has_stree,Ie=X.stat_desc.elems,fe,yt,_t=-1,z;for(D.heap_len=0,D.heap_max=x,fe=0;fe<Ie;fe++)me[fe*2]!==0?(D.heap[++D.heap_len]=_t=fe,D.depth[fe]=0):me[fe*2+1]=0;for(;D.heap_len<2;)z=D.heap[++D.heap_len]=_t<2?++_t:0,me[z*2]=1,D.depth[z]=0,D.opt_len--,we&&(D.static_len-=De[z*2+1]);for(X.max_code=_t,fe=D.heap_len>>1;fe>=1;fe--)ce(D,me,fe);z=Ie;do fe=D.heap[1],D.heap[1]=D.heap[D.heap_len--],ce(D,me,1),yt=D.heap[1],D.heap[--D.heap_max]=fe,D.heap[--D.heap_max]=yt,me[z*2]=me[fe*2]+me[yt*2],D.depth[z]=(D.depth[fe]>=D.depth[yt]?D.depth[fe]:D.depth[yt])+1,me[fe*2+1]=me[yt*2+1]=z,D.heap[1]=z++,ce(D,me,1);while(D.heap_len>=2);D.heap[--D.heap_max]=D.heap[1],Ue(D,X),nt(me,_t,D.bl_count)}function Te(D,X,me){var De,we=-1,Ie,fe=X[0*2+1],yt=0,_t=7,z=4;for(fe===0&&(_t=138,z=3),X[(me+1)*2+1]=65535,De=0;De<=me;De++)Ie=fe,fe=X[(De+1)*2+1],!(++yt<_t&&Ie===fe)&&(yt<z?D.bl_tree[Ie*2]+=yt:Ie!==0?(Ie!==we&&D.bl_tree[Ie*2]++,D.bl_tree[E*2]++):yt<=10?D.bl_tree[T*2]++:D.bl_tree[R*2]++,yt=0,we=Ie,fe===0?(_t=138,z=3):Ie===fe?(_t=6,z=3):(_t=7,z=4))}function $e(D,X,me){var De,we=-1,Ie,fe=X[0*2+1],yt=0,_t=7,z=4;for(fe===0&&(_t=138,z=3),De=0;De<=me;De++)if(Ie=fe,fe=X[(De+1)*2+1],!(++yt<_t&&Ie===fe)){if(yt<z)do Pe(D,Ie,D.bl_tree);while(--yt!==0);else Ie!==0?(Ie!==we&&(Pe(D,Ie,D.bl_tree),yt--),Pe(D,E,D.bl_tree),Ne(D,yt-3,2)):yt<=10?(Pe(D,T,D.bl_tree),Ne(D,yt-3,3)):(Pe(D,R,D.bl_tree),Ne(D,yt-11,7));yt=0,we=Ie,fe===0?(_t=138,z=3):Ie===fe?(_t=6,z=3):(_t=7,z=4)}}function ke(D){var X;for(Te(D,D.dyn_ltree,D.l_desc.max_code),Te(D,D.dyn_dtree,D.d_desc.max_code),ae(D,D.bl_desc),X=b-1;X>=3&&D.bl_tree[B[X]*2+1]===0;X--);return D.opt_len+=3*(X+1)+5+5+4,X}function ot(D,X,me,De){var we;for(Ne(D,X-257,5),Ne(D,me-1,5),Ne(D,De-4,4),we=0;we<De;we++)Ne(D,D.bl_tree[B[we]*2+1],3);$e(D,D.dyn_ltree,X-1),$e(D,D.dyn_dtree,me-1)}function At(D){var X=4093624447,me;for(me=0;me<=31;me++,X>>>=1)if(X&1&&D.dyn_ltree[me*2]!==0)return n;if(D.dyn_ltree[9*2]!==0||D.dyn_ltree[10*2]!==0||D.dyn_ltree[13*2]!==0)return r;for(me=32;me<h;me++)if(D.dyn_ltree[me*2]!==0)return r;return n}var ft=!1;function jt(D){ft||(He(),ft=!0),D.l_desc=new se(D.dyn_ltree,G),D.d_desc=new se(D.dyn_dtree,ne),D.bl_desc=new se(D.bl_tree,te),D.bi_buf=0,D.bi_valid=0,je(D)}function Bt(D,X,me,De){Ne(D,(a<<1)+(De?1:0),3),be(D,X,me)}function Ft(D){Ne(D,o<<1,3),Pe(D,C,H),Ee(D)}function tn(D,X,me,De){var we,Ie,fe=0;D.level>0?(D.strm.data_type===i&&(D.strm.data_type=At(D)),ae(D,D.l_desc),ae(D,D.d_desc),fe=ke(D),we=D.opt_len+3+7>>>3,Ie=D.static_len+3+7>>>3,Ie<=we&&(we=Ie)):we=Ie=me+5,me+4<=we&&X!==-1?Bt(D,X,me,De):D.strategy===t||Ie===we?(Ne(D,(o<<1)+(De?1:0),3),le(D,H,F)):(Ne(D,(l<<1)+(De?1:0),3),ot(D,D.l_desc.max_code+1,D.d_desc.max_code+1,fe+1),le(D,D.dyn_ltree,D.dyn_dtree)),je(D),De&&Y(D)}function xe(D,X,me){return D.pending_buf[D.d_buf+D.last_lit*2]=X>>>8&255,D.pending_buf[D.d_buf+D.last_lit*2+1]=X&255,D.pending_buf[D.l_buf+D.last_lit]=me&255,D.last_lit++,X===0?D.dyn_ltree[me*2]++:(D.matches++,X--,D.dyn_ltree[(q[me]+h+1)*2]++,D.dyn_dtree[pe(X)*2]++),D.last_lit===D.lit_bufsize-1}return Zh._tr_init=jt,Zh._tr_stored_block=Bt,Zh._tr_flush_block=tn,Zh._tr_tally=xe,Zh._tr_align=Ft,Zh}var dM,O$;function LK(){if(O$)return dM;O$=1;function e(t,n,r,i){for(var s=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+n[i++]|0,a=a+s|0;while(--o);s%=65521,a%=65521}return s|a<<16|0}return dM=e,dM}var fM,P$;function BK(){if(P$)return fM;P$=1;function e(){for(var r,i=[],s=0;s<256;s++){r=s;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;i[s]=r}return i}var t=e();function n(r,i,s,a){var o=t,l=a+s;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^i[c])&255];return r^-1}return fM=n,fM}var hM,D$;function oP(){return D$||(D$=1,hM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),hM}var F$;function TSe(){if(F$)return Dl;F$=1;var e=mh(),t=ESe(),n=LK(),r=BK(),i=oP(),s=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,p=-3,y=-5,b=-1,x=1,w=2,_=3,S=4,C=0,E=2,T=8,R=9,M=15,N=8,O=29,B=256,P=B+1+O,H=30,F=19,Q=2*P+1,q=15,K=3,U=258,re=U+K+1,G=32,ne=42,te=69,se=73,pe=91,de=103,Ne=113,Pe=666,Me=1,Ee=2,Ue=3,nt=4,He=3;function je(z,qe){return z.msg=i[qe],qe}function Y(z){return(z<<1)-(z>4?9:0)}function be(z){for(var qe=z.length;--qe>=0;)z[qe]=0}function Re(z){var qe=z.state,rt=qe.pending;rt>z.avail_out&&(rt=z.avail_out),rt!==0&&(e.arraySet(z.output,qe.pending_buf,qe.pending_out,rt,z.next_out),z.next_out+=rt,qe.pending_out+=rt,z.total_out+=rt,z.avail_out-=rt,qe.pending-=rt,qe.pending===0&&(qe.pending_out=0))}function ce(z,qe){t._tr_flush_block(z,z.block_start>=0?z.block_start:-1,z.strstart-z.block_start,qe),z.block_start=z.strstart,Re(z.strm)}function le(z,qe){z.pending_buf[z.pending++]=qe}function ae(z,qe){z.pending_buf[z.pending++]=qe>>>8&255,z.pending_buf[z.pending++]=qe&255}function Te(z,qe,rt,ve){var Se=z.avail_in;return Se>ve&&(Se=ve),Se===0?0:(z.avail_in-=Se,e.arraySet(qe,z.input,z.next_in,Se,rt),z.state.wrap===1?z.adler=n(z.adler,qe,Se,rt):z.state.wrap===2&&(z.adler=r(z.adler,qe,Se,rt)),z.next_in+=Se,z.total_in+=Se,Se)}function $e(z,qe){var rt=z.max_chain_length,ve=z.strstart,Se,ze,Tt=z.prev_length,ge=z.nice_match,Z=z.strstart>z.w_size-re?z.strstart-(z.w_size-re):0,W=z.window,J=z.w_mask,ye=z.prev,Oe=z.strstart+U,We=W[ve+Tt-1],vt=W[ve+Tt];z.prev_length>=z.good_match&&(rt>>=2),ge>z.lookahead&&(ge=z.lookahead);do if(Se=qe,!(W[Se+Tt]!==vt||W[Se+Tt-1]!==We||W[Se]!==W[ve]||W[++Se]!==W[ve+1])){ve+=2,Se++;do;while(W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&W[++ve]===W[++Se]&&ve<Oe);if(ze=U-(Oe-ve),ve=Oe-U,ze>Tt){if(z.match_start=qe,Tt=ze,ze>=ge)break;We=W[ve+Tt-1],vt=W[ve+Tt]}}while((qe=ye[qe&J])>Z&&--rt!==0);return Tt<=z.lookahead?Tt:z.lookahead}function ke(z){var qe=z.w_size,rt,ve,Se,ze,Tt;do{if(ze=z.window_size-z.lookahead-z.strstart,z.strstart>=qe+(qe-re)){e.arraySet(z.window,z.window,qe,qe,0),z.match_start-=qe,z.strstart-=qe,z.block_start-=qe,ve=z.hash_size,rt=ve;do Se=z.head[--rt],z.head[rt]=Se>=qe?Se-qe:0;while(--ve);ve=qe,rt=ve;do Se=z.prev[--rt],z.prev[rt]=Se>=qe?Se-qe:0;while(--ve);ze+=qe}if(z.strm.avail_in===0)break;if(ve=Te(z.strm,z.window,z.strstart+z.lookahead,ze),z.lookahead+=ve,z.lookahead+z.insert>=K)for(Tt=z.strstart-z.insert,z.ins_h=z.window[Tt],z.ins_h=(z.ins_h<<z.hash_shift^z.window[Tt+1])&z.hash_mask;z.insert&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[Tt+K-1])&z.hash_mask,z.prev[Tt&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=Tt,Tt++,z.insert--,!(z.lookahead+z.insert<K)););}while(z.lookahead<re&&z.strm.avail_in!==0)}function ot(z,qe){var rt=65535;for(rt>z.pending_buf_size-5&&(rt=z.pending_buf_size-5);;){if(z.lookahead<=1){if(ke(z),z.lookahead===0&&qe===s)return Me;if(z.lookahead===0)break}z.strstart+=z.lookahead,z.lookahead=0;var ve=z.block_start+rt;if((z.strstart===0||z.strstart>=ve)&&(z.lookahead=z.strstart-ve,z.strstart=ve,ce(z,!1),z.strm.avail_out===0)||z.strstart-z.block_start>=z.w_size-re&&(ce(z,!1),z.strm.avail_out===0))return Me}return z.insert=0,qe===l?(ce(z,!0),z.strm.avail_out===0?Ue:nt):(z.strstart>z.block_start&&(ce(z,!1),z.strm.avail_out===0),Me)}function At(z,qe){for(var rt,ve;;){if(z.lookahead<re){if(ke(z),z.lookahead<re&&qe===s)return Me;if(z.lookahead===0)break}if(rt=0,z.lookahead>=K&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+K-1])&z.hash_mask,rt=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),rt!==0&&z.strstart-rt<=z.w_size-re&&(z.match_length=$e(z,rt)),z.match_length>=K)if(ve=t._tr_tally(z,z.strstart-z.match_start,z.match_length-K),z.lookahead-=z.match_length,z.match_length<=z.max_lazy_match&&z.lookahead>=K){z.match_length--;do z.strstart++,z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+K-1])&z.hash_mask,rt=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart;while(--z.match_length!==0);z.strstart++}else z.strstart+=z.match_length,z.match_length=0,z.ins_h=z.window[z.strstart],z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+1])&z.hash_mask;else ve=t._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++;if(ve&&(ce(z,!1),z.strm.avail_out===0))return Me}return z.insert=z.strstart<K-1?z.strstart:K-1,qe===l?(ce(z,!0),z.strm.avail_out===0?Ue:nt):z.last_lit&&(ce(z,!1),z.strm.avail_out===0)?Me:Ee}function ft(z,qe){for(var rt,ve,Se;;){if(z.lookahead<re){if(ke(z),z.lookahead<re&&qe===s)return Me;if(z.lookahead===0)break}if(rt=0,z.lookahead>=K&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+K-1])&z.hash_mask,rt=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart),z.prev_length=z.match_length,z.prev_match=z.match_start,z.match_length=K-1,rt!==0&&z.prev_length<z.max_lazy_match&&z.strstart-rt<=z.w_size-re&&(z.match_length=$e(z,rt),z.match_length<=5&&(z.strategy===x||z.match_length===K&&z.strstart-z.match_start>4096)&&(z.match_length=K-1)),z.prev_length>=K&&z.match_length<=z.prev_length){Se=z.strstart+z.lookahead-K,ve=t._tr_tally(z,z.strstart-1-z.prev_match,z.prev_length-K),z.lookahead-=z.prev_length-1,z.prev_length-=2;do++z.strstart<=Se&&(z.ins_h=(z.ins_h<<z.hash_shift^z.window[z.strstart+K-1])&z.hash_mask,rt=z.prev[z.strstart&z.w_mask]=z.head[z.ins_h],z.head[z.ins_h]=z.strstart);while(--z.prev_length!==0);if(z.match_available=0,z.match_length=K-1,z.strstart++,ve&&(ce(z,!1),z.strm.avail_out===0))return Me}else if(z.match_available){if(ve=t._tr_tally(z,0,z.window[z.strstart-1]),ve&&ce(z,!1),z.strstart++,z.lookahead--,z.strm.avail_out===0)return Me}else z.match_available=1,z.strstart++,z.lookahead--}return z.match_available&&(ve=t._tr_tally(z,0,z.window[z.strstart-1]),z.match_available=0),z.insert=z.strstart<K-1?z.strstart:K-1,qe===l?(ce(z,!0),z.strm.avail_out===0?Ue:nt):z.last_lit&&(ce(z,!1),z.strm.avail_out===0)?Me:Ee}function jt(z,qe){for(var rt,ve,Se,ze,Tt=z.window;;){if(z.lookahead<=U){if(ke(z),z.lookahead<=U&&qe===s)return Me;if(z.lookahead===0)break}if(z.match_length=0,z.lookahead>=K&&z.strstart>0&&(Se=z.strstart-1,ve=Tt[Se],ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se])){ze=z.strstart+U;do;while(ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se]&&ve===Tt[++Se]&&Se<ze);z.match_length=U-(ze-Se),z.match_length>z.lookahead&&(z.match_length=z.lookahead)}if(z.match_length>=K?(rt=t._tr_tally(z,1,z.match_length-K),z.lookahead-=z.match_length,z.strstart+=z.match_length,z.match_length=0):(rt=t._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++),rt&&(ce(z,!1),z.strm.avail_out===0))return Me}return z.insert=0,qe===l?(ce(z,!0),z.strm.avail_out===0?Ue:nt):z.last_lit&&(ce(z,!1),z.strm.avail_out===0)?Me:Ee}function Bt(z,qe){for(var rt;;){if(z.lookahead===0&&(ke(z),z.lookahead===0)){if(qe===s)return Me;break}if(z.match_length=0,rt=t._tr_tally(z,0,z.window[z.strstart]),z.lookahead--,z.strstart++,rt&&(ce(z,!1),z.strm.avail_out===0))return Me}return z.insert=0,qe===l?(ce(z,!0),z.strm.avail_out===0?Ue:nt):z.last_lit&&(ce(z,!1),z.strm.avail_out===0)?Me:Ee}function Ft(z,qe,rt,ve,Se){this.good_length=z,this.max_lazy=qe,this.nice_length=rt,this.max_chain=ve,this.func=Se}var tn;tn=[new Ft(0,0,0,0,ot),new Ft(4,4,8,4,At),new Ft(4,5,16,8,At),new Ft(4,6,32,32,At),new Ft(4,4,16,16,ft),new Ft(8,16,32,32,ft),new Ft(8,16,128,128,ft),new Ft(8,32,128,256,ft),new Ft(32,128,258,1024,ft),new Ft(32,258,258,4096,ft)];function xe(z){z.window_size=2*z.w_size,be(z.head),z.max_lazy_match=tn[z.level].max_lazy,z.good_match=tn[z.level].good_length,z.nice_match=tn[z.level].nice_length,z.max_chain_length=tn[z.level].max_chain,z.strstart=0,z.block_start=0,z.lookahead=0,z.insert=0,z.match_length=z.prev_length=K-1,z.match_available=0,z.ins_h=0}function D(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(Q*2),this.dyn_dtree=new e.Buf16((2*H+1)*2),this.bl_tree=new e.Buf16((2*F+1)*2),be(this.dyn_ltree),be(this.dyn_dtree),be(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(q+1),this.heap=new e.Buf16(2*P+1),be(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*P+1),be(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X(z){var qe;return!z||!z.state?je(z,h):(z.total_in=z.total_out=0,z.data_type=E,qe=z.state,qe.pending=0,qe.pending_out=0,qe.wrap<0&&(qe.wrap=-qe.wrap),qe.status=qe.wrap?ne:Ne,z.adler=qe.wrap===2?0:1,qe.last_flush=s,t._tr_init(qe),u)}function me(z){var qe=X(z);return qe===u&&xe(z.state),qe}function De(z,qe){return!z||!z.state||z.state.wrap!==2?h:(z.state.gzhead=qe,u)}function we(z,qe,rt,ve,Se,ze){if(!z)return h;var Tt=1;if(qe===b&&(qe=6),ve<0?(Tt=0,ve=-ve):ve>15&&(Tt=2,ve-=16),Se<1||Se>R||rt!==T||ve<8||ve>15||qe<0||qe>9||ze<0||ze>S)return je(z,h);ve===8&&(ve=9);var ge=new D;return z.state=ge,ge.strm=z,ge.wrap=Tt,ge.gzhead=null,ge.w_bits=ve,ge.w_size=1<<ge.w_bits,ge.w_mask=ge.w_size-1,ge.hash_bits=Se+7,ge.hash_size=1<<ge.hash_bits,ge.hash_mask=ge.hash_size-1,ge.hash_shift=~~((ge.hash_bits+K-1)/K),ge.window=new e.Buf8(ge.w_size*2),ge.head=new e.Buf16(ge.hash_size),ge.prev=new e.Buf16(ge.w_size),ge.lit_bufsize=1<<Se+6,ge.pending_buf_size=ge.lit_bufsize*4,ge.pending_buf=new e.Buf8(ge.pending_buf_size),ge.d_buf=1*ge.lit_bufsize,ge.l_buf=3*ge.lit_bufsize,ge.level=qe,ge.strategy=ze,ge.method=rt,me(z)}function Ie(z,qe){return we(z,qe,T,M,N,C)}function fe(z,qe){var rt,ve,Se,ze;if(!z||!z.state||qe>c||qe<0)return z?je(z,h):h;if(ve=z.state,!z.output||!z.input&&z.avail_in!==0||ve.status===Pe&&qe!==l)return je(z,z.avail_out===0?y:h);if(ve.strm=z,rt=ve.last_flush,ve.last_flush=qe,ve.status===ne)if(ve.wrap===2)z.adler=0,le(ve,31),le(ve,139),le(ve,8),ve.gzhead?(le(ve,(ve.gzhead.text?1:0)+(ve.gzhead.hcrc?2:0)+(ve.gzhead.extra?4:0)+(ve.gzhead.name?8:0)+(ve.gzhead.comment?16:0)),le(ve,ve.gzhead.time&255),le(ve,ve.gzhead.time>>8&255),le(ve,ve.gzhead.time>>16&255),le(ve,ve.gzhead.time>>24&255),le(ve,ve.level===9?2:ve.strategy>=w||ve.level<2?4:0),le(ve,ve.gzhead.os&255),ve.gzhead.extra&&ve.gzhead.extra.length&&(le(ve,ve.gzhead.extra.length&255),le(ve,ve.gzhead.extra.length>>8&255)),ve.gzhead.hcrc&&(z.adler=r(z.adler,ve.pending_buf,ve.pending,0)),ve.gzindex=0,ve.status=te):(le(ve,0),le(ve,0),le(ve,0),le(ve,0),le(ve,0),le(ve,ve.level===9?2:ve.strategy>=w||ve.level<2?4:0),le(ve,He),ve.status=Ne);else{var Tt=T+(ve.w_bits-8<<4)<<8,ge=-1;ve.strategy>=w||ve.level<2?ge=0:ve.level<6?ge=1:ve.level===6?ge=2:ge=3,Tt|=ge<<6,ve.strstart!==0&&(Tt|=G),Tt+=31-Tt%31,ve.status=Ne,ae(ve,Tt),ve.strstart!==0&&(ae(ve,z.adler>>>16),ae(ve,z.adler&65535)),z.adler=1}if(ve.status===te)if(ve.gzhead.extra){for(Se=ve.pending;ve.gzindex<(ve.gzhead.extra.length&65535)&&!(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>Se&&(z.adler=r(z.adler,ve.pending_buf,ve.pending-Se,Se)),Re(z),Se=ve.pending,ve.pending===ve.pending_buf_size));)le(ve,ve.gzhead.extra[ve.gzindex]&255),ve.gzindex++;ve.gzhead.hcrc&&ve.pending>Se&&(z.adler=r(z.adler,ve.pending_buf,ve.pending-Se,Se)),ve.gzindex===ve.gzhead.extra.length&&(ve.gzindex=0,ve.status=se)}else ve.status=se;if(ve.status===se)if(ve.gzhead.name){Se=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>Se&&(z.adler=r(z.adler,ve.pending_buf,ve.pending-Se,Se)),Re(z),Se=ve.pending,ve.pending===ve.pending_buf_size)){ze=1;break}ve.gzindex<ve.gzhead.name.length?ze=ve.gzhead.name.charCodeAt(ve.gzindex++)&255:ze=0,le(ve,ze)}while(ze!==0);ve.gzhead.hcrc&&ve.pending>Se&&(z.adler=r(z.adler,ve.pending_buf,ve.pending-Se,Se)),ze===0&&(ve.gzindex=0,ve.status=pe)}else ve.status=pe;if(ve.status===pe)if(ve.gzhead.comment){Se=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>Se&&(z.adler=r(z.adler,ve.pending_buf,ve.pending-Se,Se)),Re(z),Se=ve.pending,ve.pending===ve.pending_buf_size)){ze=1;break}ve.gzindex<ve.gzhead.comment.length?ze=ve.gzhead.comment.charCodeAt(ve.gzindex++)&255:ze=0,le(ve,ze)}while(ze!==0);ve.gzhead.hcrc&&ve.pending>Se&&(z.adler=r(z.adler,ve.pending_buf,ve.pending-Se,Se)),ze===0&&(ve.status=de)}else ve.status=de;if(ve.status===de&&(ve.gzhead.hcrc?(ve.pending+2>ve.pending_buf_size&&Re(z),ve.pending+2<=ve.pending_buf_size&&(le(ve,z.adler&255),le(ve,z.adler>>8&255),z.adler=0,ve.status=Ne)):ve.status=Ne),ve.pending!==0){if(Re(z),z.avail_out===0)return ve.last_flush=-1,u}else if(z.avail_in===0&&Y(qe)<=Y(rt)&&qe!==l)return je(z,y);if(ve.status===Pe&&z.avail_in!==0)return je(z,y);if(z.avail_in!==0||ve.lookahead!==0||qe!==s&&ve.status!==Pe){var Z=ve.strategy===w?Bt(ve,qe):ve.strategy===_?jt(ve,qe):tn[ve.level].func(ve,qe);if((Z===Ue||Z===nt)&&(ve.status=Pe),Z===Me||Z===Ue)return z.avail_out===0&&(ve.last_flush=-1),u;if(Z===Ee&&(qe===a?t._tr_align(ve):qe!==c&&(t._tr_stored_block(ve,0,0,!1),qe===o&&(be(ve.head),ve.lookahead===0&&(ve.strstart=0,ve.block_start=0,ve.insert=0))),Re(z),z.avail_out===0))return ve.last_flush=-1,u}return qe!==l?u:ve.wrap<=0?d:(ve.wrap===2?(le(ve,z.adler&255),le(ve,z.adler>>8&255),le(ve,z.adler>>16&255),le(ve,z.adler>>24&255),le(ve,z.total_in&255),le(ve,z.total_in>>8&255),le(ve,z.total_in>>16&255),le(ve,z.total_in>>24&255)):(ae(ve,z.adler>>>16),ae(ve,z.adler&65535)),Re(z),ve.wrap>0&&(ve.wrap=-ve.wrap),ve.pending!==0?u:d)}function yt(z){var qe;return!z||!z.state?h:(qe=z.state.status,qe!==ne&&qe!==te&&qe!==se&&qe!==pe&&qe!==de&&qe!==Ne&&qe!==Pe?je(z,h):(z.state=null,qe===Ne?je(z,p):u))}function _t(z,qe){var rt=qe.length,ve,Se,ze,Tt,ge,Z,W,J;if(!z||!z.state||(ve=z.state,Tt=ve.wrap,Tt===2||Tt===1&&ve.status!==ne||ve.lookahead))return h;for(Tt===1&&(z.adler=n(z.adler,qe,rt,0)),ve.wrap=0,rt>=ve.w_size&&(Tt===0&&(be(ve.head),ve.strstart=0,ve.block_start=0,ve.insert=0),J=new e.Buf8(ve.w_size),e.arraySet(J,qe,rt-ve.w_size,ve.w_size,0),qe=J,rt=ve.w_size),ge=z.avail_in,Z=z.next_in,W=z.input,z.avail_in=rt,z.next_in=0,z.input=qe,ke(ve);ve.lookahead>=K;){Se=ve.strstart,ze=ve.lookahead-(K-1);do ve.ins_h=(ve.ins_h<<ve.hash_shift^ve.window[Se+K-1])&ve.hash_mask,ve.prev[Se&ve.w_mask]=ve.head[ve.ins_h],ve.head[ve.ins_h]=Se,Se++;while(--ze);ve.strstart=Se,ve.lookahead=K-1,ke(ve)}return ve.strstart+=ve.lookahead,ve.block_start=ve.strstart,ve.insert=ve.lookahead,ve.lookahead=0,ve.match_length=ve.prev_length=K-1,ve.match_available=0,z.next_in=Z,z.input=W,z.avail_in=ge,ve.wrap=Tt,u}return Dl.deflateInit=Ie,Dl.deflateInit2=we,Dl.deflateReset=me,Dl.deflateResetKeep=X,Dl.deflateSetHeader=De,Dl.deflate=fe,Dl.deflateEnd=yt,Dl.deflateSetDictionary=_t,Dl.deflateInfo="pako deflate (from Nodeca project)",Dl}var Xh={},L$;function $K(){if(L$)return Xh;L$=1;var e=mh(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),i=0;i<256;i++)r[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;r[254]=r[254]=1,Xh.string2buf=function(a){var o,l,c,u,d,h=a.length,p=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),p+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(p),d=0,u=0;d<p;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function s(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return Xh.buf2binstring=function(a){return s(a,a.length)},Xh.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},Xh.buf2string=function(a,o){var l,c,u,d,h=o||a.length,p=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){p[c++]=u;continue}if(d=r[u],d>4){p[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){p[c++]=65533;continue}u<65536?p[c++]=u:(u-=65536,p[c++]=55296|u>>10&1023,p[c++]=56320|u&1023)}return s(p,c)},Xh.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},Xh}var pM,B$;function zK(){if(B$)return pM;B$=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return pM=e,pM}var $$;function ASe(){if($$)return lg;$$=1;var e=TSe(),t=mh(),n=$K(),r=oP(),i=zK(),s=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,p=8;function y(_){if(!(this instanceof y))return new y(_);this.options=t.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},_||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var C=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(C!==l)throw new Error(r[C]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var E;if(typeof S.dictionary=="string"?E=n.string2buf(S.dictionary):s.call(S.dictionary)==="[object ArrayBuffer]"?E=new Uint8Array(S.dictionary):E=S.dictionary,C=e.deflateSetDictionary(this.strm,E),C!==l)throw new Error(r[C]);this._dict_set=!0}}y.prototype.push=function(_,S){var C=this.strm,E=this.options.chunkSize,T,R;if(this.ended)return!1;R=S===~~S?S:S===!0?o:a,typeof _=="string"?C.input=n.string2buf(_):s.call(_)==="[object ArrayBuffer]"?C.input=new Uint8Array(_):C.input=_,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new t.Buf8(E),C.next_out=0,C.avail_out=E),T=e.deflate(C,R),T!==c&&T!==l)return this.onEnd(T),this.ended=!0,!1;(C.avail_out===0||C.avail_in===0&&(R===o||R===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(C.output,C.next_out))):this.onData(t.shrinkBuf(C.output,C.next_out)))}while((C.avail_in>0||C.avail_out===0)&&T!==c);return R===o?(T=e.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l):(R===u&&(this.onEnd(l),C.avail_out=0),!0)},y.prototype.onData=function(_){this.chunks.push(_)},y.prototype.onEnd=function(_){_===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg};function b(_,S){var C=new y(S);if(C.push(_,!0),C.err)throw C.msg||r[C.err];return C.result}function x(_,S){return S=S||{},S.raw=!0,b(_,S)}function w(_,S){return S=S||{},S.gzip=!0,b(_,S)}return lg.Deflate=y,lg.deflate=b,lg.deflateRaw=x,lg.gzip=w,lg}var cg={},il={},mM,z$;function RSe(){if(z$)return mM;z$=1;var e=30,t=12;return mM=function(r,i){var s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E,T,R,M,N,O,B,P,H;s=r.state,a=r.next_in,P=r.input,o=a+(r.avail_in-5),l=r.next_out,H=r.output,c=l-(i-r.avail_out),u=l+(r.avail_out-257),d=s.dmax,h=s.wsize,p=s.whave,y=s.wnext,b=s.window,x=s.hold,w=s.bits,_=s.lencode,S=s.distcode,C=(1<<s.lenbits)-1,E=(1<<s.distbits)-1;e:do{w<15&&(x+=P[a++]<<w,w+=8,x+=P[a++]<<w,w+=8),T=_[x&C];t:for(;;){if(R=T>>>24,x>>>=R,w-=R,R=T>>>16&255,R===0)H[l++]=T&65535;else if(R&16){M=T&65535,R&=15,R&&(w<R&&(x+=P[a++]<<w,w+=8),M+=x&(1<<R)-1,x>>>=R,w-=R),w<15&&(x+=P[a++]<<w,w+=8,x+=P[a++]<<w,w+=8),T=S[x&E];n:for(;;){if(R=T>>>24,x>>>=R,w-=R,R=T>>>16&255,R&16){if(N=T&65535,R&=15,w<R&&(x+=P[a++]<<w,w+=8,w<R&&(x+=P[a++]<<w,w+=8)),N+=x&(1<<R)-1,N>d){r.msg="invalid distance too far back",s.mode=e;break e}if(x>>>=R,w-=R,R=l-c,N>R){if(R=N-R,R>p&&s.sane){r.msg="invalid distance too far back",s.mode=e;break e}if(O=0,B=b,y===0){if(O+=h-R,R<M){M-=R;do H[l++]=b[O++];while(--R);O=l-N,B=H}}else if(y<R){if(O+=h+y-R,R-=y,R<M){M-=R;do H[l++]=b[O++];while(--R);if(O=0,y<M){R=y,M-=R;do H[l++]=b[O++];while(--R);O=l-N,B=H}}}else if(O+=y-R,R<M){M-=R;do H[l++]=b[O++];while(--R);O=l-N,B=H}for(;M>2;)H[l++]=B[O++],H[l++]=B[O++],H[l++]=B[O++],M-=3;M&&(H[l++]=B[O++],M>1&&(H[l++]=B[O++]))}else{O=l-N;do H[l++]=H[O++],H[l++]=H[O++],H[l++]=H[O++],M-=3;while(M>2);M&&(H[l++]=H[O++],M>1&&(H[l++]=H[O++]))}}else if((R&64)===0){T=S[(T&65535)+(x&(1<<R)-1)];continue n}else{r.msg="invalid distance code",s.mode=e;break e}break}}else if((R&64)===0){T=_[(T&65535)+(x&(1<<R)-1)];continue t}else if(R&32){s.mode=t;break e}else{r.msg="invalid literal/length code",s.mode=e;break e}break}}while(a<o&&l<u);M=w>>3,a-=M,w-=M<<3,x&=(1<<w)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),s.hold=x,s.bits=w},mM}var gM,U$;function ISe(){if(U$)return gM;U$=1;var e=mh(),t=15,n=852,r=592,i=0,s=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return gM=function(h,p,y,b,x,w,_,S){var C=S.bits,E=0,T=0,R=0,M=0,N=0,O=0,B=0,P=0,H=0,F=0,Q,q,K,U,re,G=null,ne=0,te,se=new e.Buf16(t+1),pe=new e.Buf16(t+1),de=null,Ne=0,Pe,Me,Ee;for(E=0;E<=t;E++)se[E]=0;for(T=0;T<b;T++)se[p[y+T]]++;for(N=C,M=t;M>=1&&se[M]===0;M--);if(N>M&&(N=M),M===0)return x[w++]=1<<24|64<<16|0,x[w++]=1<<24|64<<16|0,S.bits=1,0;for(R=1;R<M&&se[R]===0;R++);for(N<R&&(N=R),P=1,E=1;E<=t;E++)if(P<<=1,P-=se[E],P<0)return-1;if(P>0&&(h===i||M!==1))return-1;for(pe[1]=0,E=1;E<t;E++)pe[E+1]=pe[E]+se[E];for(T=0;T<b;T++)p[y+T]!==0&&(_[pe[p[y+T]]++]=T);if(h===i?(G=de=_,te=19):h===s?(G=o,ne-=257,de=l,Ne-=257,te=256):(G=c,de=u,te=-1),F=0,T=0,E=R,re=w,O=N,B=0,K=-1,H=1<<N,U=H-1,h===s&&H>n||h===a&&H>r)return 1;for(;;){Pe=E-B,_[T]<te?(Me=0,Ee=_[T]):_[T]>te?(Me=de[Ne+_[T]],Ee=G[ne+_[T]]):(Me=96,Ee=0),Q=1<<E-B,q=1<<O,R=q;do q-=Q,x[re+(F>>B)+q]=Pe<<24|Me<<16|Ee|0;while(q!==0);for(Q=1<<E-1;F&Q;)Q>>=1;if(Q!==0?(F&=Q-1,F+=Q):F=0,T++,--se[E]===0){if(E===M)break;E=p[y+_[T]]}if(E>N&&(F&U)!==K){for(B===0&&(B=N),re+=R,O=E-B,P=1<<O;O+B<M&&(P-=se[O+B],!(P<=0));)O++,P<<=1;if(H+=1<<O,h===s&&H>n||h===a&&H>r)return 1;K=F&U,x[K]=N<<24|O<<16|re-w|0}}return F!==0&&(x[re+F]=E-B<<24|64<<16|0),S.bits=N,0},gM}var q$;function MSe(){if(q$)return il;q$=1;var e=mh(),t=LK(),n=BK(),r=RSe(),i=ISe(),s=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,p=2,y=-2,b=-3,x=-4,w=-5,_=8,S=1,C=2,E=3,T=4,R=5,M=6,N=7,O=8,B=9,P=10,H=11,F=12,Q=13,q=14,K=15,U=16,re=17,G=18,ne=19,te=20,se=21,pe=22,de=23,Ne=24,Pe=25,Me=26,Ee=27,Ue=28,nt=29,He=30,je=31,Y=32,be=852,Re=592,ce=15,le=ce;function ae(we){return(we>>>24&255)+(we>>>8&65280)+((we&65280)<<8)+((we&255)<<24)}function Te(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function $e(we){var Ie;return!we||!we.state?y:(Ie=we.state,we.total_in=we.total_out=Ie.total=0,we.msg="",Ie.wrap&&(we.adler=Ie.wrap&1),Ie.mode=S,Ie.last=0,Ie.havedict=0,Ie.dmax=32768,Ie.head=null,Ie.hold=0,Ie.bits=0,Ie.lencode=Ie.lendyn=new e.Buf32(be),Ie.distcode=Ie.distdyn=new e.Buf32(Re),Ie.sane=1,Ie.back=-1,d)}function ke(we){var Ie;return!we||!we.state?y:(Ie=we.state,Ie.wsize=0,Ie.whave=0,Ie.wnext=0,$e(we))}function ot(we,Ie){var fe,yt;return!we||!we.state||(yt=we.state,Ie<0?(fe=0,Ie=-Ie):(fe=(Ie>>4)+1,Ie<48&&(Ie&=15)),Ie&&(Ie<8||Ie>15))?y:(yt.window!==null&&yt.wbits!==Ie&&(yt.window=null),yt.wrap=fe,yt.wbits=Ie,ke(we))}function At(we,Ie){var fe,yt;return we?(yt=new Te,we.state=yt,yt.window=null,fe=ot(we,Ie),fe!==d&&(we.state=null),fe):y}function ft(we){return At(we,le)}var jt=!0,Bt,Ft;function tn(we){if(jt){var Ie;for(Bt=new e.Buf32(512),Ft=new e.Buf32(32),Ie=0;Ie<144;)we.lens[Ie++]=8;for(;Ie<256;)we.lens[Ie++]=9;for(;Ie<280;)we.lens[Ie++]=7;for(;Ie<288;)we.lens[Ie++]=8;for(i(a,we.lens,0,288,Bt,0,we.work,{bits:9}),Ie=0;Ie<32;)we.lens[Ie++]=5;i(o,we.lens,0,32,Ft,0,we.work,{bits:5}),jt=!1}we.lencode=Bt,we.lenbits=9,we.distcode=Ft,we.distbits=5}function xe(we,Ie,fe,yt){var _t,z=we.state;return z.window===null&&(z.wsize=1<<z.wbits,z.wnext=0,z.whave=0,z.window=new e.Buf8(z.wsize)),yt>=z.wsize?(e.arraySet(z.window,Ie,fe-z.wsize,z.wsize,0),z.wnext=0,z.whave=z.wsize):(_t=z.wsize-z.wnext,_t>yt&&(_t=yt),e.arraySet(z.window,Ie,fe-yt,_t,z.wnext),yt-=_t,yt?(e.arraySet(z.window,Ie,fe-yt,yt,0),z.wnext=yt,z.whave=z.wsize):(z.wnext+=_t,z.wnext===z.wsize&&(z.wnext=0),z.whave<z.wsize&&(z.whave+=_t))),0}function D(we,Ie){var fe,yt,_t,z,qe,rt,ve,Se,ze,Tt,ge,Z,W,J,ye=0,Oe,We,vt,Xt,jn,Yt,Qt,on,or=new e.Buf8(4),xr,Gr,Kr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!we||!we.state||!we.output||!we.input&&we.avail_in!==0)return y;fe=we.state,fe.mode===F&&(fe.mode=Q),qe=we.next_out,_t=we.output,ve=we.avail_out,z=we.next_in,yt=we.input,rt=we.avail_in,Se=fe.hold,ze=fe.bits,Tt=rt,ge=ve,on=d;e:for(;;)switch(fe.mode){case S:if(fe.wrap===0){fe.mode=Q;break}for(;ze<16;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(fe.wrap&2&&Se===35615){fe.check=0,or[0]=Se&255,or[1]=Se>>>8&255,fe.check=n(fe.check,or,2,0),Se=0,ze=0,fe.mode=C;break}if(fe.flags=0,fe.head&&(fe.head.done=!1),!(fe.wrap&1)||(((Se&255)<<8)+(Se>>8))%31){we.msg="incorrect header check",fe.mode=He;break}if((Se&15)!==_){we.msg="unknown compression method",fe.mode=He;break}if(Se>>>=4,ze-=4,Qt=(Se&15)+8,fe.wbits===0)fe.wbits=Qt;else if(Qt>fe.wbits){we.msg="invalid window size",fe.mode=He;break}fe.dmax=1<<Qt,we.adler=fe.check=1,fe.mode=Se&512?P:F,Se=0,ze=0;break;case C:for(;ze<16;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(fe.flags=Se,(fe.flags&255)!==_){we.msg="unknown compression method",fe.mode=He;break}if(fe.flags&57344){we.msg="unknown header flags set",fe.mode=He;break}fe.head&&(fe.head.text=Se>>8&1),fe.flags&512&&(or[0]=Se&255,or[1]=Se>>>8&255,fe.check=n(fe.check,or,2,0)),Se=0,ze=0,fe.mode=E;case E:for(;ze<32;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}fe.head&&(fe.head.time=Se),fe.flags&512&&(or[0]=Se&255,or[1]=Se>>>8&255,or[2]=Se>>>16&255,or[3]=Se>>>24&255,fe.check=n(fe.check,or,4,0)),Se=0,ze=0,fe.mode=T;case T:for(;ze<16;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}fe.head&&(fe.head.xflags=Se&255,fe.head.os=Se>>8),fe.flags&512&&(or[0]=Se&255,or[1]=Se>>>8&255,fe.check=n(fe.check,or,2,0)),Se=0,ze=0,fe.mode=R;case R:if(fe.flags&1024){for(;ze<16;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}fe.length=Se,fe.head&&(fe.head.extra_len=Se),fe.flags&512&&(or[0]=Se&255,or[1]=Se>>>8&255,fe.check=n(fe.check,or,2,0)),Se=0,ze=0}else fe.head&&(fe.head.extra=null);fe.mode=M;case M:if(fe.flags&1024&&(Z=fe.length,Z>rt&&(Z=rt),Z&&(fe.head&&(Qt=fe.head.extra_len-fe.length,fe.head.extra||(fe.head.extra=new Array(fe.head.extra_len)),e.arraySet(fe.head.extra,yt,z,Z,Qt)),fe.flags&512&&(fe.check=n(fe.check,yt,Z,z)),rt-=Z,z+=Z,fe.length-=Z),fe.length))break e;fe.length=0,fe.mode=N;case N:if(fe.flags&2048){if(rt===0)break e;Z=0;do Qt=yt[z+Z++],fe.head&&Qt&&fe.length<65536&&(fe.head.name+=String.fromCharCode(Qt));while(Qt&&Z<rt);if(fe.flags&512&&(fe.check=n(fe.check,yt,Z,z)),rt-=Z,z+=Z,Qt)break e}else fe.head&&(fe.head.name=null);fe.length=0,fe.mode=O;case O:if(fe.flags&4096){if(rt===0)break e;Z=0;do Qt=yt[z+Z++],fe.head&&Qt&&fe.length<65536&&(fe.head.comment+=String.fromCharCode(Qt));while(Qt&&Z<rt);if(fe.flags&512&&(fe.check=n(fe.check,yt,Z,z)),rt-=Z,z+=Z,Qt)break e}else fe.head&&(fe.head.comment=null);fe.mode=B;case B:if(fe.flags&512){for(;ze<16;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(Se!==(fe.check&65535)){we.msg="header crc mismatch",fe.mode=He;break}Se=0,ze=0}fe.head&&(fe.head.hcrc=fe.flags>>9&1,fe.head.done=!0),we.adler=fe.check=0,fe.mode=F;break;case P:for(;ze<32;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}we.adler=fe.check=ae(Se),Se=0,ze=0,fe.mode=H;case H:if(fe.havedict===0)return we.next_out=qe,we.avail_out=ve,we.next_in=z,we.avail_in=rt,fe.hold=Se,fe.bits=ze,p;we.adler=fe.check=1,fe.mode=F;case F:if(Ie===c||Ie===u)break e;case Q:if(fe.last){Se>>>=ze&7,ze-=ze&7,fe.mode=Ee;break}for(;ze<3;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}switch(fe.last=Se&1,Se>>>=1,ze-=1,Se&3){case 0:fe.mode=q;break;case 1:if(tn(fe),fe.mode=te,Ie===u){Se>>>=2,ze-=2;break e}break;case 2:fe.mode=re;break;case 3:we.msg="invalid block type",fe.mode=He}Se>>>=2,ze-=2;break;case q:for(Se>>>=ze&7,ze-=ze&7;ze<32;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if((Se&65535)!==(Se>>>16^65535)){we.msg="invalid stored block lengths",fe.mode=He;break}if(fe.length=Se&65535,Se=0,ze=0,fe.mode=K,Ie===u)break e;case K:fe.mode=U;case U:if(Z=fe.length,Z){if(Z>rt&&(Z=rt),Z>ve&&(Z=ve),Z===0)break e;e.arraySet(_t,yt,z,Z,qe),rt-=Z,z+=Z,ve-=Z,qe+=Z,fe.length-=Z;break}fe.mode=F;break;case re:for(;ze<14;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(fe.nlen=(Se&31)+257,Se>>>=5,ze-=5,fe.ndist=(Se&31)+1,Se>>>=5,ze-=5,fe.ncode=(Se&15)+4,Se>>>=4,ze-=4,fe.nlen>286||fe.ndist>30){we.msg="too many length or distance symbols",fe.mode=He;break}fe.have=0,fe.mode=G;case G:for(;fe.have<fe.ncode;){for(;ze<3;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}fe.lens[Kr[fe.have++]]=Se&7,Se>>>=3,ze-=3}for(;fe.have<19;)fe.lens[Kr[fe.have++]]=0;if(fe.lencode=fe.lendyn,fe.lenbits=7,xr={bits:fe.lenbits},on=i(s,fe.lens,0,19,fe.lencode,0,fe.work,xr),fe.lenbits=xr.bits,on){we.msg="invalid code lengths set",fe.mode=He;break}fe.have=0,fe.mode=ne;case ne:for(;fe.have<fe.nlen+fe.ndist;){for(;ye=fe.lencode[Se&(1<<fe.lenbits)-1],Oe=ye>>>24,We=ye>>>16&255,vt=ye&65535,!(Oe<=ze);){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(vt<16)Se>>>=Oe,ze-=Oe,fe.lens[fe.have++]=vt;else{if(vt===16){for(Gr=Oe+2;ze<Gr;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(Se>>>=Oe,ze-=Oe,fe.have===0){we.msg="invalid bit length repeat",fe.mode=He;break}Qt=fe.lens[fe.have-1],Z=3+(Se&3),Se>>>=2,ze-=2}else if(vt===17){for(Gr=Oe+3;ze<Gr;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}Se>>>=Oe,ze-=Oe,Qt=0,Z=3+(Se&7),Se>>>=3,ze-=3}else{for(Gr=Oe+7;ze<Gr;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}Se>>>=Oe,ze-=Oe,Qt=0,Z=11+(Se&127),Se>>>=7,ze-=7}if(fe.have+Z>fe.nlen+fe.ndist){we.msg="invalid bit length repeat",fe.mode=He;break}for(;Z--;)fe.lens[fe.have++]=Qt}}if(fe.mode===He)break;if(fe.lens[256]===0){we.msg="invalid code -- missing end-of-block",fe.mode=He;break}if(fe.lenbits=9,xr={bits:fe.lenbits},on=i(a,fe.lens,0,fe.nlen,fe.lencode,0,fe.work,xr),fe.lenbits=xr.bits,on){we.msg="invalid literal/lengths set",fe.mode=He;break}if(fe.distbits=6,fe.distcode=fe.distdyn,xr={bits:fe.distbits},on=i(o,fe.lens,fe.nlen,fe.ndist,fe.distcode,0,fe.work,xr),fe.distbits=xr.bits,on){we.msg="invalid distances set",fe.mode=He;break}if(fe.mode=te,Ie===u)break e;case te:fe.mode=se;case se:if(rt>=6&&ve>=258){we.next_out=qe,we.avail_out=ve,we.next_in=z,we.avail_in=rt,fe.hold=Se,fe.bits=ze,r(we,ge),qe=we.next_out,_t=we.output,ve=we.avail_out,z=we.next_in,yt=we.input,rt=we.avail_in,Se=fe.hold,ze=fe.bits,fe.mode===F&&(fe.back=-1);break}for(fe.back=0;ye=fe.lencode[Se&(1<<fe.lenbits)-1],Oe=ye>>>24,We=ye>>>16&255,vt=ye&65535,!(Oe<=ze);){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(We&&(We&240)===0){for(Xt=Oe,jn=We,Yt=vt;ye=fe.lencode[Yt+((Se&(1<<Xt+jn)-1)>>Xt)],Oe=ye>>>24,We=ye>>>16&255,vt=ye&65535,!(Xt+Oe<=ze);){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}Se>>>=Xt,ze-=Xt,fe.back+=Xt}if(Se>>>=Oe,ze-=Oe,fe.back+=Oe,fe.length=vt,We===0){fe.mode=Me;break}if(We&32){fe.back=-1,fe.mode=F;break}if(We&64){we.msg="invalid literal/length code",fe.mode=He;break}fe.extra=We&15,fe.mode=pe;case pe:if(fe.extra){for(Gr=fe.extra;ze<Gr;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}fe.length+=Se&(1<<fe.extra)-1,Se>>>=fe.extra,ze-=fe.extra,fe.back+=fe.extra}fe.was=fe.length,fe.mode=de;case de:for(;ye=fe.distcode[Se&(1<<fe.distbits)-1],Oe=ye>>>24,We=ye>>>16&255,vt=ye&65535,!(Oe<=ze);){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if((We&240)===0){for(Xt=Oe,jn=We,Yt=vt;ye=fe.distcode[Yt+((Se&(1<<Xt+jn)-1)>>Xt)],Oe=ye>>>24,We=ye>>>16&255,vt=ye&65535,!(Xt+Oe<=ze);){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}Se>>>=Xt,ze-=Xt,fe.back+=Xt}if(Se>>>=Oe,ze-=Oe,fe.back+=Oe,We&64){we.msg="invalid distance code",fe.mode=He;break}fe.offset=vt,fe.extra=We&15,fe.mode=Ne;case Ne:if(fe.extra){for(Gr=fe.extra;ze<Gr;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}fe.offset+=Se&(1<<fe.extra)-1,Se>>>=fe.extra,ze-=fe.extra,fe.back+=fe.extra}if(fe.offset>fe.dmax){we.msg="invalid distance too far back",fe.mode=He;break}fe.mode=Pe;case Pe:if(ve===0)break e;if(Z=ge-ve,fe.offset>Z){if(Z=fe.offset-Z,Z>fe.whave&&fe.sane){we.msg="invalid distance too far back",fe.mode=He;break}Z>fe.wnext?(Z-=fe.wnext,W=fe.wsize-Z):W=fe.wnext-Z,Z>fe.length&&(Z=fe.length),J=fe.window}else J=_t,W=qe-fe.offset,Z=fe.length;Z>ve&&(Z=ve),ve-=Z,fe.length-=Z;do _t[qe++]=J[W++];while(--Z);fe.length===0&&(fe.mode=se);break;case Me:if(ve===0)break e;_t[qe++]=fe.length,ve--,fe.mode=se;break;case Ee:if(fe.wrap){for(;ze<32;){if(rt===0)break e;rt--,Se|=yt[z++]<<ze,ze+=8}if(ge-=ve,we.total_out+=ge,fe.total+=ge,ge&&(we.adler=fe.check=fe.flags?n(fe.check,_t,ge,qe-ge):t(fe.check,_t,ge,qe-ge)),ge=ve,(fe.flags?Se:ae(Se))!==fe.check){we.msg="incorrect data check",fe.mode=He;break}Se=0,ze=0}fe.mode=Ue;case Ue:if(fe.wrap&&fe.flags){for(;ze<32;){if(rt===0)break e;rt--,Se+=yt[z++]<<ze,ze+=8}if(Se!==(fe.total&4294967295)){we.msg="incorrect length check",fe.mode=He;break}Se=0,ze=0}fe.mode=nt;case nt:on=h;break e;case He:on=b;break e;case je:return x;case Y:default:return y}return we.next_out=qe,we.avail_out=ve,we.next_in=z,we.avail_in=rt,fe.hold=Se,fe.bits=ze,(fe.wsize||ge!==we.avail_out&&fe.mode<He&&(fe.mode<Ee||Ie!==l))&&xe(we,we.output,we.next_out,ge-we.avail_out),Tt-=we.avail_in,ge-=we.avail_out,we.total_in+=Tt,we.total_out+=ge,fe.total+=ge,fe.wrap&&ge&&(we.adler=fe.check=fe.flags?n(fe.check,_t,ge,we.next_out-ge):t(fe.check,_t,ge,we.next_out-ge)),we.data_type=fe.bits+(fe.last?64:0)+(fe.mode===F?128:0)+(fe.mode===te||fe.mode===K?256:0),(Tt===0&&ge===0||Ie===l)&&on===d&&(on=w),on}function X(we){if(!we||!we.state)return y;var Ie=we.state;return Ie.window&&(Ie.window=null),we.state=null,d}function me(we,Ie){var fe;return!we||!we.state||(fe=we.state,(fe.wrap&2)===0)?y:(fe.head=Ie,Ie.done=!1,d)}function De(we,Ie){var fe=Ie.length,yt,_t,z;return!we||!we.state||(yt=we.state,yt.wrap!==0&&yt.mode!==H)?y:yt.mode===H&&(_t=1,_t=t(_t,Ie,fe,0),_t!==yt.check)?b:(z=xe(we,Ie,fe,fe),z?(yt.mode=je,x):(yt.havedict=1,d))}return il.inflateReset=ke,il.inflateReset2=ot,il.inflateResetKeep=$e,il.inflateInit=ft,il.inflateInit2=At,il.inflate=D,il.inflateEnd=X,il.inflateGetHeader=me,il.inflateSetDictionary=De,il.inflateInfo="pako inflate (from Nodeca project)",il}var yM,V$;function UK(){return V$||(V$=1,yM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),yM}var bM,H$;function NSe(){if(H$)return bM;H$=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return bM=e,bM}var W$;function jSe(){if(W$)return cg;W$=1;var e=MSe(),t=mh(),n=$K(),r=UK(),i=oP(),s=zK(),a=NSe(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var p=e.inflateInit2(this.strm,h.windowBits);if(p!==r.Z_OK)throw new Error(i[p]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(p=e.inflateSetDictionary(this.strm,h.dictionary),p!==r.Z_OK)))throw new Error(i[p])}l.prototype.push=function(d,h){var p=this.strm,y=this.options.chunkSize,b=this.options.dictionary,x,w,_,S,C,E=!1;if(this.ended)return!1;w=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?p.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?p.input=new Uint8Array(d):p.input=d,p.next_in=0,p.avail_in=p.input.length;do{if(p.avail_out===0&&(p.output=new t.Buf8(y),p.next_out=0,p.avail_out=y),x=e.inflate(p,r.Z_NO_FLUSH),x===r.Z_NEED_DICT&&b&&(x=e.inflateSetDictionary(this.strm,b)),x===r.Z_BUF_ERROR&&E===!0&&(x=r.Z_OK,E=!1),x!==r.Z_STREAM_END&&x!==r.Z_OK)return this.onEnd(x),this.ended=!0,!1;p.next_out&&(p.avail_out===0||x===r.Z_STREAM_END||p.avail_in===0&&(w===r.Z_FINISH||w===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(_=n.utf8border(p.output,p.next_out),S=p.next_out-_,C=n.buf2string(p.output,_),p.next_out=S,p.avail_out=y-S,S&&t.arraySet(p.output,p.output,_,S,0),this.onData(C)):this.onData(t.shrinkBuf(p.output,p.next_out))),p.avail_in===0&&p.avail_out===0&&(E=!0)}while((p.avail_in>0||p.avail_out===0)&&x!==r.Z_STREAM_END);return x===r.Z_STREAM_END&&(w=r.Z_FINISH),w===r.Z_FINISH?(x=e.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===r.Z_OK):(w===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),p.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var p=new l(h);if(p.push(d,!0),p.err)throw p.msg||i[p.err];return p.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return cg.Inflate=l,cg.inflate=c,cg.inflateRaw=u,cg.ungzip=c,cg}var vM,G$;function OSe(){if(G$)return vM;G$=1;var e=mh().assign,t=ASe(),n=jSe(),r=UK(),i={};return e(i,t,n,r),vM=i,vM}var PSe=OSe();const lP=aa(PSe);var xM,K$;function DSe(){if(K$)return xM;K$=1;const e=(t,n)=>function(...r){const i=n.promiseModule;return new i((s,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),s(o)):s(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):s(l)}):r.push(s),t.apply(this,r)})};return xM=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const i=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let s;r==="function"?s=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:s=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];s[a]=typeof o=="function"&&i(a)?e(o,n):o}return s},xM}var FSe=DSe();const wM=aa(FSe);var _M,Y$;function LSe(){if(Y$)return _M;Y$=1;var e={};function t(K){return Array.isArray(K)?K:[K]}const n="",r=" ",i="\\",s=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const p=h,y=(K,U,re)=>Object.defineProperty(K,U,{value:re}),b=/([0-z])-([0-z])/g,x=()=>!1,w=K=>K.replace(b,(U,re,G)=>re.charCodeAt(0)<=G.charCodeAt(0)?U:n),_=K=>{const{length:U}=K;return K.slice(0,U-U%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(K,U,re)=>U+(re.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(K,U)=>{const{length:re}=U;return U.slice(0,re-re%2)+r}],[/[\\$.|*+(){^]/g,K=>`\\${K}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(K,U,re)=>U+6<re.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(K,U,re)=>{const G=re.replace(/\\\*/g,"[^\\/]*");return U+G}],[/\\\\\\(?=[$.|*+(){^])/g,()=>i],[/\\\\/g,()=>i],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(K,U,re,G,ne)=>U===i?`\\[${re}${_(G)}${ne}`:ne==="]"&&G.length%2===0?`[${w(re)}${G}]`:"[]"],[/(?:[^*])$/,K=>/\/$/.test(K)?`${K}$`:`${K}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(K,U)=>`${U?`${U}[^/]+`:"[^/]*"}(?=$|\\/$)`]],C=Object.create(null),E=(K,U)=>{let re=C[K];return re||(re=S.reduce((G,[ne,te])=>G.replace(ne,te.bind(K)),K),C[K]=re),U?new RegExp(re,"i"):new RegExp(re)},T=K=>typeof K=="string",R=K=>K&&T(K)&&!s.test(K)&&!a.test(K)&&K.indexOf("#")!==0,M=K=>K.split(c);class N{constructor(U,re,G,ne){this.origin=U,this.pattern=re,this.negative=G,this.regex=ne}}const O=(K,U)=>{const re=K;let G=!1;K.indexOf("!")===0&&(G=!0,K=K.substr(1)),K=K.replace(o,"!").replace(l,"#");const ne=E(K,U);return new N(re,K,G,ne)},B=(K,U)=>{throw new U(K)},P=(K,U,re)=>T(K)?K?P.isNotRelative(K)?re(`path should be a \`path.relative()\`d string, but got "${U}"`,RangeError):!0:re("path must not be empty",TypeError):re(`path must be a string, but got \`${U}\``,TypeError),H=K=>u.test(K);P.isNotRelative=H,P.convert=K=>K;class F{constructor({ignorecase:U=!0,ignoreCase:re=U,allowRelativePaths:G=!1}={}){y(this,p,!0),this._rules=[],this._ignoreCase=re,this._allowRelativePaths=G,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(U){if(U&&U[p]){this._rules=this._rules.concat(U._rules),this._added=!0;return}if(R(U)){const re=O(U,this._ignoreCase);this._added=!0,this._rules.push(re)}}add(U){return this._added=!1,t(T(U)?M(U):U).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(U){return this.add(U)}_testOne(U,re){let G=!1,ne=!1;return this._rules.forEach(te=>{const{negative:se}=te;if(ne===se&&G!==ne||se&&!G&&!ne&&!re)return;te.regex.test(U)&&(G=!se,ne=se)}),{ignored:G,unignored:ne}}_test(U,re,G,ne){const te=U&&P.convert(U);return P(te,U,this._allowRelativePaths?x:B),this._t(te,re,G,ne)}_t(U,re,G,ne){if(U in re)return re[U];if(ne||(ne=U.split(d)),ne.pop(),!ne.length)return re[U]=this._testOne(U,G);const te=this._t(ne.join(d)+d,re,G,ne);return re[U]=te.ignored?te:this._testOne(U,G)}ignores(U){return this._test(U,this._ignoreCache,!1).ignored}createFilter(){return U=>!this.ignores(U)}filter(U){return t(U).filter(this.createFilter())}test(U){return this._test(U,this._testCache,!0)}}const Q=K=>new F(K),q=K=>P(K&&P.convert(K),K,x);if(Q.isPathValid=q,Q.default=Q,_M=Q,typeof es<"u"&&(e&&e.IGNORE_TEST_WIN32||es.platform==="win32")){const K=re=>/^\\\\\?\\/.test(re)||/["<>|\u0000-\u001F]+/u.test(re)?re:re.replace(/\\/g,"/");P.convert=K;const U=/^[a-z]:\//i;P.isNotRelative=re=>U.test(re)||H(re)}return _M}var BSe=LSe();const $Se=aa(BSe);var SM,Z$;function zSe(){if(Z$)return SM;Z$=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,i,s){return i=i instanceof RegExp?i:new RegExp(e(i),"g"),r.replace(i,s)}var n={clean:function(i){if(typeof i!="string")throw new Error("Expected a string, received: "+i);return i=t(i,"./","/"),i=t(i,"..","."),i=t(i," ","-"),i=t(i,/^[~^:?*\\\-]/g,""),i=t(i,/[~^:?*\\]/g,"-"),i=t(i,/[~^:?*\\\-]$/g,""),i=t(i,"@{","-"),i=t(i,/\.$/g,""),i=t(i,/\/$/g,""),i=t(i,/\.lock$/g,""),i}};return SM=n,SM}var USe=zSe();const Vc=aa(USe);var CM,X$;function qSe(){return X$||(X$=1,CM=function(e,t){var n=e,r=t,i=n.length,s=r.length,a=!1,o=null,l=i+1,c=[],u=[],d=[],h="",p=-1,y=0,b=1,x,w,_=function(){i>=s&&(x=n,w=i,n=r,r=x,i=s,s=w,a=!0,l=i+1)},S=function(R,M,N){return{x:R,y:M,k:N}},C=function(R,M){return{elem:R,t:M}},E=function(R,M,N){var O,B,P;for(M>N?O=c[R-1+l]:O=c[R+1+l],P=Math.max(M,N),B=P-R;B<i&&P<s&&n[B]===r[P];)++B,++P;return c[R+l]=u.length,u[u.length]=new S(B,P,O),P},T=function(R){var M,N,O;for(M=N=0,O=R.length-1;O>=0;--O)for(;M<R[O].x||N<R[O].y;)R[O].y-R[O].x>N-M?(a?d[d.length]=new C(r[N],p):d[d.length]=new C(r[N],b),++N):R[O].y-R[O].x<N-M?(a?d[d.length]=new C(n[M],b):d[d.length]=new C(n[M],p),++M):(d[d.length]=new C(n[M],y),h+=n[M],++M,++N)};return _(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var R,M,N,O,B,P,H,F;for(R=s-i,M=i+s+3,N={},H=0;H<M;++H)N[H]=-1,c[H]=-1;O=-1;do{for(++O,F=-O;F<=R-1;++F)N[F+l]=E(F,N[F-1+l]+1,N[F+1+l]);for(F=R+O;F>=R+1;--F)N[F+l]=E(F,N[F-1+l]+1,N[F+1+l]);N[R+l]=E(R,N[R-1+l]+1,N[R+1+l])}while(N[R+l]!==s);for(o=R+2*O,B=c[R+l],P=[];B!==-1;)P[P.length]=new S(u[B].x,u[B].y,null),B=u[B].k;T(P)}}}),CM}var kM,J$;function VSe(){if(J$)return kM;J$=1;var e=qSe();function t(s,a){var o=new e(s,a);o.compose();for(var l=o.getses(),c,u,d=s.length-1,h=a.length-1,p=l.length-1;p>=0;--p)l[p].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[p].t===o.SES_DELETE?d--:l[p].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(s,a){for(var o=[],l=s.length,c=a.length,u=t(s,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(s,a,o){var l,c=n(a,s),u=n(a,o),d=[];function h(U,re){d.push([U.file1[0],re,U.file1[1],U.file2[0],U.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function(U,re){return U[0]-re[0]});var p=[],y=0;function b(U){U>y&&(p.push([1,y,U-y]),y=U)}for(var x=0;x<d.length;x++){for(var w=x,_=d[x],S=_[0],C=S+_[2];x<d.length-1;){var E=d[x+1],T=E[0];if(T>C)break;C=Math.max(C,T+E[2]),x++}if(b(S),w==x)_[4]>0&&p.push([_[1],_[3],_[4]]);else{var R={0:[s.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=w;l<=x;l++){_=d[l];var M=_[1],N=R[M],O=_[0],B=O+_[2],P=_[3],H=P+_[4];N[0]=Math.min(P,N[0]),N[1]=Math.max(H,N[1]),N[2]=Math.min(O,N[2]),N[3]=Math.max(B,N[3])}var F=R[0][0]+(S-R[0][2]),Q=R[0][1]+(C-R[0][3]),q=R[2][0]+(S-R[2][2]),K=R[2][1]+(C-R[2][3]);p.push([-1,F,Q-F,S,C-S,q,K-q])}y=C}return b(a.length),p}function i(s,a,o){var l=[],c=[s,a,o],u=r(s,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function p(_){for(var S=0;S<_.length;S++)d.push(_[S])}function y(_){if(_[2]!=_[6])return!0;for(var S=_[1],C=_[5],E=0;E<_[2];E++)if(s[E+S]!=o[E+C])return!0;return!1}for(var b=0;b<u.length;b++){var x=u[b],w=x[0];w==-1?y(x)?(h(),l.push({conflict:{a:s.slice(x[1],x[1]+x[2]),aIndex:x[1],o:a.slice(x[3],x[3]+x[4]),oIndex:x[3],b:o.slice(x[5],x[5]+x[6]),bIndex:x[5]}})):p(c[0].slice(x[1],x[1]+x[2])):p(c[w].slice(x[1],x[1]+x[2]))}return h(),l}return kM=i,kM}var HSe=VSe();const WSe=aa(HSe);class qr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new qr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class $w extends qr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=$w.code,this.data={filepaths:t}}}$w.code="UnmergedPathsError";class fr extends qr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=fr.code,this.data={message:t}}}fr.code="InternalError";class oy extends qr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=oy.code,this.data={filepath:t}}}oy.code="UnsafeFilepathError";class zc{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const i=this.buffer.write(t,this._start,n,r);return this._start+=n,i}copy(t,n,r){const i=t.copy(this.buffer,this._start,n,r);return this._start+=i,i}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function CE(e,t){return-(e<t)||+(e>t)}function qK(e,t){return CE(e.path,t.path)}function VK(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const Ac=2**32;function Q$(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const i=Math.floor(n/1e3),s=(n-i*1e3)*1e6;return[i,s]}function y0(e){const[t,n]=Q$(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,i]=Q$(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%Ac,ctimeNanoseconds:n%Ac,mtimeSeconds:r%Ac,mtimeNanoseconds:i%Ac,dev:e.dev%Ac,ino:e.ino%Ac,mode:VK(e.mode%Ac),uid:e.uid%Ac,gid:e.gid%Ac,size:e.size>-1?e.size%Ac:0}}function GSe(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let EM=null;async function gd(e){return EM===null&&(EM=await YSe()),EM?HK(e):KSe(e)}function KSe(e){return new FK().update(e).digest("hex")}async function HK(e){const t=await crypto.subtle.digest("SHA-1",e);return GSe(t)}async function YSe(){try{if(await HK(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function ZSe(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function XSe(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(sn.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class op{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(sn.isBuffer(t))return op.fromBuffer(t);if(t===null)return new op(null);throw new fr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new fr("Index file is empty (.git/index)");const n=new op,r=new zc(t),i=r.toString("utf8",4);if(i!=="DIRC")throw new fr(`Invalid dircache magic file number: ${i}`);const s=await gd(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==s)throw new fr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${s}`);const o=r.readUInt32BE();if(o!==2)throw new fr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=ZSe(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new fr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new oy(u.path);let p=8-(r.tell()-12)%8;for(p===0&&(p=8);p--;){const y=r.readUInt8();if(y!==0)throw new fr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new fr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(qK)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:i=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=y0(n);const s=sn.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:i,nameLength:s.length<4095?s.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=sn.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,i=sn.alloc(r),s=new zc(i),a=y0(t);return s.writeUInt32BE(a.ctimeSeconds),s.writeUInt32BE(a.ctimeNanoseconds),s.writeUInt32BE(a.mtimeSeconds),s.writeUInt32BE(a.mtimeNanoseconds),s.writeUInt32BE(a.dev),s.writeUInt32BE(a.ino),s.writeUInt32BE(a.mode),s.writeUInt32BE(a.uid),s.writeUInt32BE(a.gid),s.writeUInt32BE(a.size),s.write(t.oid,20,"hex"),s.writeUInt16BE(XSe(t)),s.write(t.path,n.length,"utf8"),i}async toObject(){const t=sn.alloc(12),n=new zc(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(op._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(op._entryToBuffer(l));r=await Promise.all(r);const i=sn.concat(r),s=sn.concat([t,i]),a=await gd(s);return sn.concat([s,sn.from(a,"hex")])}}function mC(e,t,n=!0,r=!0){const i=y0(e),s=y0(t);return n&&i.mode!==s.mode||i.mtimeSeconds!==s.mtimeSeconds||i.ctimeSeconds!==s.ctimeSeconds||i.uid!==s.uid||i.gid!==s.gid||r&&i.ino!==s.ino||i.size!==s.size}let TM=null;const AM=Symbol("IndexCache");function JSe(){return{map:new Map,stats:new Map}}async function QSe(e,t,n){const[r,i]=await Promise.all([e.lstat(t),e.read(t)]),s=await op.from(i);n.map.set(t,s),n.stats.set(t,r)}async function e2e(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const i=await e.lstat(t);return i===null?!1:mC(r,i)}class $s{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:i=!0},s){r[AM]||(r[AM]=JSe());const a=`${n}/index`;TM===null&&(TM=new Tx({maxPending:1/0}));let o,l=[];return await TM.acquire(a,async()=>{const c=r[AM];await e2e(t,a,c)&&await QSe(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!i)throw new $w(l);if(o=await s(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function gC(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function b0(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function WK(e){const t=new Map,n=function(i){if(!t.has(i)){const s={type:"tree",fullpath:i,basename:gC(i),metadata:{},children:[]};t.set(i,s),s.parent=n(b0(i)),s.parent&&s.parent!==s&&s.parent.children.push(s)}return t.get(i)},r=function(i,s){if(!t.has(i)){const a={type:"blob",fullpath:i,basename:gC(i),metadata:s,parent:n(b0(i)),children:[]};a.parent&&a.parent.children.push(a),t.set(i,a)}return t.get(i)};n(".");for(const i of e)r(i.path,i);return t}function t2e(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new fr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class n2e{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=$s.acquire({fs:t,gitdir:n,cache:r},async function(s){return WK(s.entries)});const i=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,i=(await this.treePromise).get(n);if(!i||i.type==="blob")return null;if(i.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const s=i.children.map(a=>a.fullpath);return s.sort(CE),s}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const i=r.type==="tree"?{}:y0(r.metadata);t._type=r.type==="tree"?"tree":t2e(i.mode),t._mode=i.mode,r.type==="tree"?t._stat=void 0:t._stat=i}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const kE=Symbol("GitWalkSymbol");function ly(){const e=Object.create(null);return Object.defineProperty(e,kE,{value:function({fs:t,gitdir:n,cache:r}){return new n2e({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class mi extends qr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=mi.code,this.data={what:t}}}mi.code="NotFoundError";class Ga extends qr{constructor(t,n,r,i){super(`Object ${t} ${i?`at ${i}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=Ga.code,this.data={oid:t,actual:n,expected:r,filepath:i}}}Ga.code="ObjectTypeError";class Hf extends qr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Hf.code,this.data={value:t}}}Hf.code="InvalidOidError";class zw extends qr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=zw.code,this.data={remote:t}}}zw.code="NoRefspecError";class yC{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const i=r.indexOf(" ");if(r.startsWith("^")){const s=r.slice(1);return this.refs.set(n+"^{}",s),{line:r,ref:n,peeled:s}}else{const s=r.slice(0,i);return n=r.slice(i+1),this.refs.set(n,s),{line:r,ref:n,oid:s}}})}return this}static from(t){return new yC(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class bC{constructor({remotePath:t,localPath:n,force:r,matchPrefix:i}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:i})}static from(t){const[n,r,i,s,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=i==="*";if(l!==(a==="*"))throw new fr("Invalid refspec");return new bC({remotePath:r,localPath:s,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class cP{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(bC.from(r));return new cP(n)}add(t){const n=bC.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const i of t){const s=r.translate(i);s&&n.push([i,s])}return n}translateOne(t){let n=null;for(const r of this.rules){const i=r.translate(t);i&&(n=i)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function r2e(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),i=-(n<r)||+(n>r);return i===0?e.endsWith("^{}")?1:-1:i}const i2e=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},Gb=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},e9={core:{filemode:Gb,bare:Gb,logallrefupdates:Gb,symlinks:Gb,ignorecase:Gb,bigFileThreshold:i2e}},s2e=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,a2e=/^[A-Za-z0-9-.]+$/,o2e=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,l2e=/^[A-Za-z][A-Za-z-]*$/,c2e=/^(.*?)( *[#;].*)$/,u2e=e=>{const t=s2e.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},d2e=e=>{const t=o2e.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),i=f2e(r),s=h2e(i);return[n,s]}return null},f2e=e=>{const t=c2e.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return t9(n)&&t9(r)?`${n}${r}`:n},t9=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,h2e=e=>e.split("").reduce((t,n,r,i)=>{const s=n==='"'&&i[r-1]!=="\\",a=n==="\\"&&i[r+1]==='"';return s||a?t:t+n},""),n9=e=>e!=null?e.toLowerCase():null,Y3=(e,t,n)=>[n9(e),t,n9(n)].filter(r=>r!=null).join("."),r9=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),i=t.length?t.join("."):void 0;return{section:n,subsection:i,name:r,path:Y3(n,i,r),sectionPath:Y3(n,i,null),isSection:!!n}},p2e=(e,t)=>e.reduce((n,r,i)=>t(r)?i:n,-1);class uP{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(i=>{let s=null,a=null;const o=i.trim(),l=u2e(o),c=l!=null;if(c)[n,r]=l;else{const d=d2e(o);d!=null&&([s,a]=d)}const u=Y3(n,r,s);return{line:i,isSection:c,section:n,subsection:r,name:s,value:a,path:u}}):[]}static from(t){return new uP(t)}async get(t,n=!1){const r=r9(t).path,i=this.parsedConfig.filter(s=>s.path===r).map(({section:s,name:a,value:o})=>{const l=e9[s]&&e9[s][a];return l?l(o):o});return n?i:i.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:i,subsection:s,name:a,path:o,sectionPath:l,isSection:c}=r9(t),u=p2e(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(p=>p.path===l),h={section:i,subsection:s,name:a,value:n,modified:!0,path:o};if(a2e.test(i)&&l2e.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const p={isSection:c,section:i,subsection:s,modified:!0,path:l};this.parsedConfig.push(p,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:i,value:s,modified:a=!1})=>a?i!=null&&s!=null?typeof s=="string"&&/[#;]/.test(s)?`	${i} = "${s}"`:`	${i} = ${s}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class ms{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return uP.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const cS=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],m2e=["config","description","index","shallow","commondir"];let RM;async function gf(e,t){return RM===void 0&&(RM=new Tx),RM.acquire(e,t)}class Ht{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:i,symrefs:s,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const x of i.values())if(!x.match(/[0-9a-f]{40}/))throw new Hf(x);const u=await ms.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new zw(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=cP.from(o),h=new Map;if(c){const x=await Ht.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Ht.deleteRefs({fs:t,gitdir:n,refs:x.map(w=>`refs/tags/${w}`)})}if(a){for(const x of i.keys())if(x.startsWith("refs/tags")&&!x.endsWith("^{}")&&!await Ht.exists({fs:t,gitdir:n,ref:x})){const w=i.get(x);h.set(x,w)}}const p=d.translate([...i.keys()]);for(const[x,w]of p){const _=i.get(x);h.set(w,_)}const y=d.translate([...s.keys()]);for(const[x,w]of y){const _=s.get(x),S=d.translateOne(_);S&&h.set(w,`ref: ${S}`)}const b=[];if(l){for(const x of d.localNamespaces()){const w=(await Ht.listRefs({fs:t,gitdir:n,filepath:x})).map(_=>`${x}/${_}`);for(const _ of w)h.has(_)||b.push(_)}b.length>0&&await Ht.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[x,w]of h)await gf(x,async()=>t.write(Dt.join(n,x),`${w.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:i}){if(!i.match(/[0-9a-f]{40}/))throw new Hf(i);await gf(r,async()=>t.write(Dt.join(n,r),`${i.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:i}){await gf(r,async()=>t.write(Dt.join(n,r),`ref: ${i.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Ht.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm(Dt.join(n,o))));let i=await gf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const s=yC.from(i),a=s.refs.size;for(const o of r)s.refs.has(o)&&s.delete(o);s.refs.size<a&&(i=s.toString(),await gf("packed-refs",async()=>t.write(`${n}/packed-refs`,i,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:i=void 0}){if(i!==void 0&&(i--,i===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Ht.resolve({fs:t,gitdir:n,ref:r,depth:i});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Ht.packedRefs({fs:t,gitdir:n}),a=cS(r).filter(o=>!m2e.includes(o));for(const o of a){const l=await gf(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||s.get(o));if(l)return Ht.resolve({fs:t,gitdir:n,ref:l.trim(),depth:i})}throw new mi(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Ht.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Ht.packedRefs({fs:t,gitdir:n}),s=cS(r);for(const a of s)if(await gf(a,async()=>t.exists(`${n}/${a}`))||i.has(a))return a;throw new mi(r)}static async expandAgainstMap({ref:t,map:n}){const r=cS(t);for(const i of r)if(await n.has(i))return i;throw new mi(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:i}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Ht.resolveAgainstMap({ref:t,fullref:n,depth:r,map:i});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const s=cS(t);for(const a of s){const o=i.get(a);if(o)return Ht.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:i})}throw new mi(t)}static async packedRefs({fs:t,gitdir:n}){const r=await gf("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return yC.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const i=Ht.packedRefs({fs:t,gitdir:n});let s=null;try{s=await t.readdirDeep(`${n}/${r}`),s=s.map(a=>a.replace(`${n}/${r}/`,""))}catch{s=[]}for(let a of(await i).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),s.includes(a)||s.push(a));return s.sort(r2e),s}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Ht.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Ht.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Ht.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(i=>!i.endsWith("^{}"))}}function g2e(e,t){return CE(i9(e),i9(t))}function i9(e){return e.mode==="040000"?e.path+"/":e.path}function GK(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new fr(`Unexpected GitTree entry mode: ${e}`)}function y2e(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new fr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const i=e.indexOf(0,n);if(i===-1)throw new fr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let s=e.slice(n,r).toString("utf8");s==="40000"&&(s="040000");const a=GK(s),o=e.slice(r+1,i).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new oy(o);const l=e.slice(i+1,i+21).toString("hex");n=i+21,t.push({mode:s,path:o,oid:l,type:a})}return t}function b2e(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new fr(`Could not understand file mode: ${e}`)}function v2e(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=b2e(e.mode),e.type||(e.type=GK(e.mode)),e}class go{constructor(t){if(sn.isBuffer(t))this._entries=y2e(t);else if(Array.isArray(t))this._entries=t.map(v2e);else throw new fr("invalid type passed to GitTree constructor");this._entries.sort(qK)}static from(t){return new go(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(g2e),sn.concat(t.map(n=>{const r=sn.from(n.mode.replace(/^0/,"")),i=sn.from(" "),s=sn.from(n.path,"utf8"),a=sn.from([0]),o=sn.from(n.oid,"hex");return sn.concat([r,i,s,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class cy{static wrap({type:t,object:n}){return sn.concat([sn.from(`${t} ${n.byteLength.toString()}\0`),sn.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),i=t.slice(0,n).toString("utf8"),s=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(s)!==a)throw new fr(`Length mismatch: expected ${s} bytes but got ${a} instead.`);return{type:i,object:sn.from(t.slice(r+1))}}}async function KK({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,i=await e.read(`${t}/${r}`);return i?{object:i,format:"deflated",source:r}:null}function x2e(e,t){const n=new zc(e),r=s9(n);if(r!==t.byteLength)throw new fr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const i=s9(n);let s;const a=o9(n,t);if(a.byteLength===i)s=a;else{s=sn.alloc(i);const o=new zc(s);for(o.copy(a);!n.eof();)o.copy(o9(n,t));const l=o.tell();if(i!==l)throw new fr(`applyDelta expected target buffer to be ${i} bytes but the resulting buffer was ${l} bytes`)}return s}function s9(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function a9(e,t,n){let r=0,i=0;for(;n--;)t&1&&(r|=e.readUInt8()<<i),t>>=1,i+=8;return r}function o9(e,t){const n=e.readUInt8(),r=128,i=15,s=112;if(n&r){const a=a9(e,n&i,4);let o=a9(e,(n&s)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function w2e(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function YK(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:w2e(e)}class ZK{constructor(t){if(typeof sn>"u")throw new Error("Missing Buffer dependency");this.stream=YK(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?sn.alloc(0):(n&&(n=sn.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>_2e(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=sn.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function _2e(e){return e.reduce((t,n)=>t+n.length,0)}async function S2e(e,t){const n=new ZK(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new fr(`Invalid PACK header '${r}'`);let i=await n.read(4);if(i=i.readUInt32BE(0),i!==2)throw new fr(`Invalid packfile version: ${i}`);let s=await n.read(4);if(s=s.readUInt32BE(0),!(s<1))for(;!n.eof()&&s--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await C2e(n),d=new lP.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new fr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new fr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const p=n.tell();await t({data:d.result,type:o,num:s,offset:a,end:p,reference:u,ofs:c})}}}}async function C2e(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let i,s;if(n===6){let a=0;i=0;const o=[];do t=await e.byte(),i|=(t&127)<<a,a+=7,o.push(t);while(t&128);s=sn.from(o)}return n===7&&(s=await e.read(20)),{type:n,length:r,ofs:i,reference:s}}async function XK(e){return lP.inflate(e)}function k2e(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const i=n&127;t.push(i),r=n&128}while(r);return t.reduce((i,s)=>i+1<<7|s,-1)}function E2e(e,t){let n=t,r=4,i=null;do i=e.readUInt8(),n|=(i&127)<<r,r+=7;while(i&128);return n}class v0{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new zc(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const s=r.readUInt32BE();if(s!==2)throw new fr(`Unable to read version ${s} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new fr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new v0({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const i={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},s={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await S2e([t],async({data:x,type:w,reference:_,offset:S,num:C})=>{u===null&&(u=C);const E=Math.floor((u-C)*100/u);E!==d&&r&&await r({phase:"Receiving objects",loaded:u-C,total:u}),d=E,w=i[w],["commit","tree","blob","tag"].includes(w)?s[S]={type:w,offset:S}:w==="ofs-delta"?s[S]={type:w,offset:S}:w==="ref-delta"&&(s[S]={type:w,offset:S})});const h=Object.keys(s).map(Number);for(const[x,w]of h.entries()){const _=x+1===h.length?t.byteLength-20:h[x+1],S=s[w],C=kSe.buf(t.slice(w,_))>>>0;S.end=_,S.crc=C}const p=new v0({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let x in s){x=Number(x);const w=Math.floor(y*100/u);w!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=w;const _=s[x];if(!_.oid)try{p.readDepth=0,p.externalReadDepth=0;const{type:S,object:C}=await p.readSlice({start:x});b[p.readDepth]+=1;const E=await gd(cy.wrap({type:S,object:C}));_.oid=E,o.push(E),c.set(E,x),l[E]=_.crc}catch{continue}}return o.sort(),p}async toBuffer(){const t=[],n=(c,u)=>{t.push(sn.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new zc(sn.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const i=new zc(sn.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.crcs[c]);t.push(i.buffer);const s=new zc(sn.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.offsets.get(c));t.push(s.buffer),n(this.packfileSha,"hex");const a=sn.concat(t),o=await gd(a),l=sn.alloc(20);return l.write(o,"hex"),sn.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new fr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new fr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),i=new zc(r),s=i.readUInt8(),a=s&112;let o=n[a];if(o===void 0)throw new fr("Unrecognized type: 0b"+a.toString(2));const l=s&15;let c=l;s&128&&(c=E2e(i,l));let d=null,h=null;if(o==="ofs_delta"){const y=k2e(i),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=i.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const p=r.slice(i.tell());if(h=sn.from(await XK(p)),h.byteLength!==c)throw new fr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=sn.from(x2e(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const uS=Symbol("PackfileCache");async function T2e({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:i}){const s=await e.read(t);return v0.fromIdx({idx:s,getExternalRefDelta:n})}function dP({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:i,emitterPrefix:s}){t[uS]||(t[uS]=new Map);let a=t[uS].get(n);return a||(a=T2e({fs:e,filename:n,getExternalRefDelta:r,emitter:i,emitterPrefix:s}),t[uS].set(n,a)),a}async function A2e({fs:e,cache:t,gitdir:n,oid:r,format:i="content",getExternalRefDelta:s}){let a=await e.readdir(Dt.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await dP({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new fr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:s});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Di({fs:e,cache:t,gitdir:n,oid:r,format:i="content"}){const s=u=>Di({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:sn.from("tree 0\0")}),a||(a=await KK({fs:e,gitdir:n,oid:r})),!a){if(a=await A2e({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}),!a)throw new mi(r);return a}if(i==="deflated"||(a.format==="deflated"&&(a.object=sn.from(await XK(a.object)),a.format="wrapped"),i==="wrapped"))return a;const o=await gd(a.object);if(o!==r)throw new fr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=cy.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",i==="content")return a;throw new fr(`invalid requested format "${i}"`)}class fc extends qr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=fc.code,this.data={noun:t,where:n,canForce:r}}}fc.code="AlreadyExistsError";class Uw extends qr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=Uw.code,this.data={nouns:t,short:n,matches:r}}}Uw.code="AmbiguousError";class qw extends qr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=qw.code,this.data={filepaths:t}}}qw.code="CheckoutConflictError";class Vw extends qr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=Vw.code,this.data={ref:t,oid:n}}}Vw.code="CommitNotFetchedError";class Hw extends qr{constructor(){super("Empty response from git server."),this.code=this.name=Hw.code,this.data={}}}Hw.code="EmptyServerResponseError";class Ww extends qr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=Ww.code,this.data={}}}Ww.code="FastForwardError";class Gw extends qr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=Gw.code,this.data={prettyDetails:t,result:n}}}Gw.code="GitPushError";class x0 extends qr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=x0.code,this.data={statusCode:t,statusMessage:n,response:r}}}x0.code="HttpError";class Wf extends qr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=Wf.code,this.data={reason:t}}}Wf.code="InvalidFilepathError";class cc extends qr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=cc.code,this.data={ref:t,suggestion:n}}}cc.code="InvalidRefNameError";class Kw extends qr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=Kw.code,this.data={depth:t}}}Kw.code="MaxDepthError";class uy extends qr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=uy.code,this.data={}}}uy.code="MergeNotSupportedError";class dy extends qr{constructor(t,n,r,i){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=dy.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:i}}}dy.code="MergeConflictError";class _a extends qr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=_a.code,this.data={role:t}}}_a.code="MissingNameError";class fo extends qr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=fo.code,this.data={parameter:t}}}fo.code="MissingParameterError";class Yw extends qr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=Yw.code,this.data={errors:t},this.errors=t}}Yw.code="MultipleGitError";class om extends qr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=om.code,this.data={expected:t,actual:n}}}om.code="ParseError";class w0 extends qr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=w0.code,this.data={reason:t}}}w0.code="PushRejectedError";class Ef extends qr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=Ef.code,this.data={capability:t,parameter:n}}}Ef.code="RemoteCapabilityError";class Zw extends qr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=Zw.code,this.data={preview:t,response:n}}}Zw.code="SmartHttpError";class Xw extends qr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=Xw.code,this.data={url:t,transport:n,suggestion:r}}}Xw.code="UnknownTransportError";class Jw extends qr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=Jw.code,this.data={url:t}}}Jw.code="UrlParseError";class fy extends qr{constructor(){super("The operation was canceled."),this.code=this.name=fy.code,this.data={}}}fy.code="UserCanceledError";class Qw extends qr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=Qw.code,this.data={filepath:t}}}Qw.code="IndexResetError";class e1 extends qr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=e1.code,this.data={ref:t}}}e1.code="NoCommitError";var R2e=Object.freeze({__proto__:null,AlreadyExistsError:fc,AmbiguousError:Uw,CheckoutConflictError:qw,CommitNotFetchedError:Vw,EmptyServerResponseError:Hw,FastForwardError:Ww,GitPushError:Gw,HttpError:x0,InternalError:fr,InvalidFilepathError:Wf,InvalidOidError:Hf,InvalidRefNameError:cc,MaxDepthError:Kw,MergeNotSupportedError:uy,MergeConflictError:dy,MissingNameError:_a,MissingParameterError:fo,MultipleGitError:Yw,NoRefspecError:zw,NotFoundError:mi,ObjectTypeError:Ga,ParseError:om,PushRejectedError:w0,RemoteCapabilityError:Ef,SmartHttpError:Zw,UnknownTransportError:Xw,UnsafeFilepathError:oy,UrlParseError:Jw,UserCanceledError:fy,UnmergedPathsError:$w,IndexResetError:Qw,NoCommitError:e1});function Z3({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=I2e(r),`${e} <${t}> ${n} ${r}`}function I2e(e){const t=M2e(N2e(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),i=String(e);return r.length<2&&(r="0"+r),i.length<2&&(i="0"+i),(t===-1?"-":"+")+r+i}function M2e(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function N2e(e){return e===0?e:-e}function Zu(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function vC(e){const[,t,n,r,i]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:j2e(i)}}function j2e(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),O2e(r)}function O2e(e){return e===0?e:-e}class Ba{constructor(t){if(typeof t=="string")this._tag=t;else if(sn.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=Ba.render(t);else throw new fr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new Ba(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Z3(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const i of t)i[0]===" "?n[n.length-1]+=`
`+i.slice(1):n.push(i);const r={};for(const i of n){const s=i.slice(0,i.indexOf(" ")),a=i.slice(i.indexOf(" ")+1);Array.isArray(r[s])?r[s].push(a):r[s]=a}return r.tagger&&(r.tagger=vC(r.tagger)),r.committer&&(r.committer=vC(r.committer)),r}withoutSignature(){const t=Zu(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return Zu(t)}payload(){return this.withoutSignature()+`
`}toObject(){return sn.from(this._tag,"utf8")}static async sign(t,n,r){const i=t.payload();let{signature:s}=await n({payload:i,secretKey:r});s=Zu(s);const a=i+s;return Ba.from(a)}}function IM(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function P2e(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Oi{constructor(t){if(typeof t=="string")this._commit=t;else if(sn.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Oi.render(t);else throw new fr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Oi.justHeaders(t),i=Oi.justMessage(t),s=Zu(r+`
gpgsig`+IM(n)+`
`+i);return new Oi(s)}static from(t){return new Oi(t)}toObject(){return sn.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Oi.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return Zu(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Oi.justHeaders(this._commit).split(`
`),n=[];for(const i of t)i[0]===" "?n[n.length-1]+=`
`+i.slice(1):n.push(i);const r={parent:[]};for(const i of n){const s=i.slice(0,i.indexOf(" ")),a=i.slice(i.indexOf(" ")+1);Array.isArray(r[s])?r[s].push(a):r[s]=a}return r.author&&(r.author=vC(r.author)),r.committer&&(r.committer=vC(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new fr("commit 'parent' property should be an array");for(const s of t.parent)n+=`parent ${s}
`}const r=t.author;n+=`author ${Z3(r)}
`;const i=t.committer||t.author;return n+=`committer ${Z3(i)}
`,t.gpgsig&&(n+="gpgsig"+IM(t.gpgsig)),n}static render(t){return Oi.renderHeaders(t)+`
`+Zu(t.message)}render(){return this._commit}withoutSignature(){const t=Zu(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return Zu(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return P2e(t)}static async sign(t,n,r){const i=t.withoutSignature(),s=Oi.justMessage(t._commit);let{signature:a}=await n({payload:i,secretKey:r});a=Zu(a);const l=Oi.justHeaders(t._commit)+`
gpgsig`+IM(a)+`
`+s;return Oi.from(l)}}async function _0({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:go.from([]),oid:r};const{type:i,object:s}=await Di({fs:e,cache:t,gitdir:n,oid:r});if(i==="tag")return r=Ba.from(s).parse().object,_0({fs:e,cache:t,gitdir:n,oid:r});if(i==="commit")return r=Oi.from(s).parse().tree,_0({fs:e,cache:t,gitdir:n,oid:r});if(i!=="tree")throw new Ga(r,i,"tree");return{tree:go.from(s),oid:r}}class D2e{constructor({fs:t,gitdir:n,ref:r,cache:i}){this.fs=t,this.cache=i,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Ht.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof mi&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await _0({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const s=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:i,gitdir:s}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Di({fs:r,cache:i,gitdir:s,oid:l});if(c!==o.type)throw new Ga(l,c,o.type);const d=go.from(u);for(const h of d)a.set(Dt.join(n,h.path),h);return d.entries().map(h=>Dt.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=VK(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:i,gitdir:s}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Di({fs:r,cache:i,gitdir:s,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function yl({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,kE,{value:function({fs:n,gitdir:r,cache:i}){return new D2e({fs:n,gitdir:r,ref:e,cache:i})}}),Object.freeze(t),t}class F2e{constructor({fs:t,dir:n,gitdir:r,cache:i}){this.fs=t,this.cache=i,this.dir=n,this.gitdir=r,this.config=null;const s=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:i}=this,s=await r.readdir(Dt.join(i,n));return s===null?null:s.map(a=>Dt.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let i=await n.lstat(`${r}/${t._fullpath}`);if(!i)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let s=i.isDirectory()?"tree":"blob";s==="blob"&&!i.isFile()&&!i.isSymbolicLink()&&(s="special"),t._type=s,i=y0(i),t._mode=i.mode,i.size===-1&&t._actualSize&&(i.size=t._actualSize),t._stat=i}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:i}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,i)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:i,cache:s}=this;let a;await $s.acquire({fs:r,gitdir:i,cache:s},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,i)).get("core.filemode"),h=typeof es<"u"?es.platform!=="win32":!0;if(!l||mC(c,l,d,h)){const p=await t.content();p===void 0?a=void 0:(a=await gd(cy.wrap({type:"blob",object:p})),l&&a===l.oid&&(!d||c.mode===l.mode)&&mC(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await ms.get({fs:t,gitdir:n}),this.config)}}function t1(){const e=Object.create(null);return Object.defineProperty(e,kE,{value:function({fs:t,dir:n,gitdir:r,cache:i}){return new F2e({fs:t,dir:n,gitdir:r,cache:i})}}),Object.freeze(e),e}function L2e(e,t){const n=t-e;return Array.from({length:n},(r,i)=>e+i)}const JK=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class B2e{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*$2e(e){const t=new B2e;let n;const r=[],i=e.length;for(let s=0;s<i;s++)r[s]=e[s].next().value,r[s]!==void 0&&t.consider(r[s]);if(t.value!==null)for(;;){const s=[];n=t.value,t.reset();for(let a=0;a<i;a++)r[a]!==void 0&&r[a]===n?(s[a]=r[a],r[a]=e[a].next().value):s[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield s,t.value===null)return}}async function Gf({fs:e,cache:t,dir:n,gitdir:r,trees:i,map:s=async(l,c)=>c,reduce:a=async(l,c)=>{const u=JK(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=i.map(p=>p[kE]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=L2e(0,l.length),d=async p=>{u.map(x=>{const w=p[x];p[x]=w&&new l[x].ConstructEntry(w)});const b=(await Promise.all(u.map(x=>{const w=p[x];return w?l[x].readdir(w):[]}))).map(x=>(x===null?[]:x)[Symbol.iterator]());return{entries:p,children:$2e(b)}},h=async p=>{const{entries:y,children:b}=await d(p),x=y.find(_=>_&&_._fullpath)._fullpath,w=await s(x,y);if(w!==null){let _=await o(h,b);return _=_.filter(S=>S!==void 0),a(w,_)}};return h(c)}async function X3(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const i=Dt.join(t,r);return e.lstat(i).then(s=>{if(s)return s.isDirectory()?X3(e,i):e.rm(i)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function z2e(e){return U2e(e)&&l9(e.then)&&l9(e.catch)}function U2e(e){return e&&typeof e=="object"}function l9(e){return typeof e=="function"}function c9(e){return z2e((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const u9=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function d9(e,t){if(c9(t))for(const n of u9)e[`_${n}`]=t[n].bind(t);else for(const n of u9)e[`_${n}`]=wM(t[n].bind(t));c9(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=X3.bind(null,e):t.rm?e._rm=wM(t.rm.bind(t)):t.rmdir.length>2?e._rm=wM(t.rmdir.bind(t)):e._rm=X3.bind(null,e)}class xn{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?d9(this,t.promises):d9(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=sn.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(b0(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const i=b0(t);if(i==="."||i==="/"||i===t)throw r;await this.mkdir(i),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(CE),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async i=>{const s=t+"/"+i;return(await this._stat(s)).isDirectory()?this.readdirDeep(s):s}))).reduce((i,s)=>i.concat(s),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return sn.isBuffer(r)?r:sn.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function it(e,t){if(t===void 0)throw new fo(e)}async function xC(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function q2e({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),commit:r="HEAD",cache:i={}}){try{it("fs",e),it("dir",t),it("gitdir",n);const s=new xn(e),a=[yl({ref:r}),t1(),ly()];let o=[];await $s.acquire({fs:s,gitdir:n,cache:i},async function(c){o=c.unmergedPaths});const l=await Gf({fs:s,cache:i,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const p=!await xC(d,h),y=o.includes(c),b=!await xC(h,u);if(p||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new Qw(c)}});await $s.acquire({fs:s,gitdir:n,cache:i},async function(c){for(const u of l)if(u!==!1){if(!u){await s.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await s.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(s){throw s.caller="git.abortMerge",s}}class hy{static async isIgnored({fs:t,dir:n,gitdir:r=Dt.join(n,".git"),filepath:i}){if(gC(i)===".git")return!0;if(i===".")return!1;let s="";const a=Dt.join(r,"info","exclude");await t.exists(a)&&(s=await t.read(a,"utf8"));const o=[{gitignore:Dt.join(n,".gitignore"),filepath:i}],l=i.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:Dt.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=$Se().add(s);h.add(d);const p=b0(u.filepath);if(p!=="."&&h.ignores(p))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function V2e({fs:e,gitdir:t,object:n,format:r,oid:i}){const s=`objects/${i.slice(0,2)}/${i.slice(2)}`,a=`${t}/${s}`;await e.exists(a)||await e.write(a,n)}let MM=null;async function QK(e){return MM===null&&(MM=W2e()),MM?H2e(e):lP.deflate(e)}async function H2e(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function W2e(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function xo({fs:e,gitdir:t,type:n,object:r,format:i="content",oid:s=void 0,dryRun:a=!1}){return i!=="deflated"&&(i!=="wrapped"&&(r=cy.wrap({type:n,object:r})),s=await gd(r),r=sn.from(await QK(r))),a||await V2e({fs:e,gitdir:t,object:r,format:"deflated",oid:s}),s}function eY(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function G2e({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r,cache:i={},force:s=!1,parallel:a=!0}){try{it("fs",e),it("dir",t),it("gitdir",n),it("filepath",r);const o=new xn(e);await $s.acquire({fs:o,gitdir:n,cache:i},async l=>{const u=await(await ms.get({fs:o,gitdir:n})).get("core.autocrlf");return J3({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:s,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function J3({dir:e,gitdir:t,fs:n,filepath:r,index:i,force:s,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!s&&await hy.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const p=await n.lstat(Dt.join(e,h));if(!p)throw new mi(h);if(p.isDirectory()){const y=await n.readdir(Dt.join(e,h));if(a){const b=y.map(x=>J3({dir:e,gitdir:t,fs:n,filepath:[Dt.join(h,x)],index:i,force:s,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await J3({dir:e,gitdir:t,fs:n,filepath:[Dt.join(h,b)],index:i,force:s,parallel:a,autocrlf:o})}else{const y=p.isSymbolicLink()?await n.readlink(Dt.join(e,h)).then(eY):await n.read(Dt.join(e,h),{autocrlf:o});if(y===null)throw new mi(h);const b=await xo({fs:n,gitdir:t,type:"blob",object:y});i.insert({filepath:h,stats:p,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new Yw(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function Ax({fs:e,gitdir:t,path:n}){return(await ms.get({fs:e,gitdir:t})).get(n)}function tY(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const i=n[r];i!==void 0&&(e[r]=i)}return e}async function Kf({fs:e,gitdir:t,author:n,commit:r}){const i=Math.floor(Date.now()/1e3),s={name:await Ax({fs:e,gitdir:t,path:"user.name"}),email:await Ax({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},a=tY({},s,r?r.author:void 0,n);if(a.name!==void 0)return a}async function S0({fs:e,gitdir:t,author:n,committer:r,commit:i}){const s=Math.floor(Date.now()/1e3),a={name:await Ax({fs:e,gitdir:t,path:"user.name"}),email:await Ax({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},o=tY({},a,i?i.committer:void 0,n,r);if(o.name!==void 0)return o}async function nY({fs:e,cache:t,gitdir:n,oid:r}){const{type:i,object:s}=await Di({fs:e,cache:t,gitdir:n,oid:r});if(i==="tag")return r=Ba.from(s).parse().object,nY({fs:e,cache:t,gitdir:n,oid:r});if(i!=="commit")throw new Ga(r,i,"commit");return{commit:Oi.from(s),oid:r}}async function C0({fs:e,cache:t,gitdir:n,oid:r}){const{commit:i,oid:s}=await nY({fs:e,cache:t,gitdir:n,oid:r});return{oid:s,commit:i.parse(),payload:i.withoutSignature()}}async function EE({fs:e,cache:t,onSign:n,gitdir:r,message:i,author:s,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:p}){let y=!1;d||(d=await Ht.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,x;try{b=await Ht.resolve({fs:e,gitdir:r,ref:d}),x=await C0({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new e1(d);const w=l?await Kf({fs:e,gitdir:r,author:s,commit:x.commit}):await Kf({fs:e,gitdir:r,author:s});if(!w)throw new _a("author");const _=l?await S0({fs:e,gitdir:r,author:w,committer:a,commit:x.commit}):await S0({fs:e,gitdir:r,author:w,committer:a});if(!_)throw new _a("committer");return $s.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const E=WK(S.entries).get(".");if(p||(p=await rY({fs:e,gitdir:r,inode:E,dryRun:c})),h?h=await Promise.all(h.map(M=>Ht.resolve({fs:e,gitdir:r,ref:M}))):l?h=x.commit.parent:h=b?[b]:[],!i)if(l)i=x.commit.message;else throw new fo("message");let T=Oi.from({tree:p,parent:h,author:w,committer:_,message:i});o&&(T=await Oi.sign(T,n,o));const R=await xo({fs:e,gitdir:r,type:"commit",object:T.toObject(),dryRun:c});return!u&&!c&&await Ht.writeRef({fs:e,gitdir:r,ref:d,value:R}),R})}async function rY({fs:e,gitdir:t,inode:n,dryRun:r}){const i=n.children;for(const l of i)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await rY({fs:e,gitdir:t,inode:l,dryRun:r}));const s=i.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=go.from(s);return await xo({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function n1({fs:e,cache:t,gitdir:n,oid:r,filepath:i}){if(i.startsWith("/"))throw new Wf("leading-slash");if(i.endsWith("/"))throw new Wf("trailing-slash");const s=r,a=await _0({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(i==="")r=a.oid;else{const l=i.split("/");r=await iY({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:s,filepath:i})}return r}async function iY({fs:e,cache:t,gitdir:n,tree:r,pathArray:i,oid:s,filepath:a}){const o=i.shift();for(const l of r)if(l.path===o){if(i.length===0)return l.oid;{const{type:c,object:u}=await Di({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new Ga(s,c,"tree",a);return r=go.from(u),iY({fs:e,cache:t,gitdir:n,tree:r,pathArray:i,oid:s,filepath:a})}}throw new mi(`file or directory found at "${s}:${a}"`)}async function py({fs:e,cache:t,gitdir:n,oid:r,filepath:i=void 0}){i!==void 0&&(r=await n1({fs:e,cache:t,gitdir:n,oid:r,filepath:i}));const{tree:s,oid:a}=await _0({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:s.entries()}}async function r1({fs:e,gitdir:t,tree:n}){const r=go.from(n).toObject();return await xo({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function K2e({fs:e,cache:t,onSign:n,gitdir:r,ref:i,oid:s,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Ht.resolve({gitdir:r,fs:e,ref:i})}catch(w){if(!(w instanceof mi))throw w}let p=(await py({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)p=p.filter(w=>w.path!==s);else for(const w of p)if(w.path===s)throw new fc("note",s);typeof a=="string"&&(a=sn.from(a,"utf8"));const y=await xo({fs:e,gitdir:r,type:"blob",object:a,format:"content"});p.push({mode:"100644",path:s,oid:y,type:"blob"});const b=await r1({fs:e,gitdir:r,tree:p});return await EE({fs:e,cache:t,onSign:n,gitdir:r,ref:i,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function Y2e({fs:e,onSign:t,dir:n,gitdir:r=Dt.join(n,".git"),ref:i="refs/notes/commits",oid:s,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{it("fs",e),it("gitdir",r),it("oid",s),it("note",a),u&&it("onSign",t);const h=new xn(e),p=await Kf({fs:h,gitdir:r,author:l});if(!p)throw new _a("author");const y=await S0({fs:h,gitdir:r,author:p,committer:c});if(!y)throw new _a("committer");return await K2e({fs:new xn(h),cache:d,onSign:t,gitdir:r,ref:i,oid:s,note:a,force:o,author:p,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function sY({fs:e,gitdir:t,remote:n,url:r,force:i}){if(n!==Vc.clean(n))throw new cc(n,Vc.clean(n));const s=await ms.get({fs:e,gitdir:t});if(!i&&(await s.getSubsections("remote")).includes(n)&&r!==await s.get(`remote.${n}.url`))throw new fc("remote",n);await s.set(`remote.${n}.url`,r),await s.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await ms.save({fs:e,gitdir:t,config:s})}async function Z2e({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),remote:r,url:i,force:s=!1}){try{return it("fs",e),it("gitdir",n),it("remote",r),it("url",i),await sY({fs:new xn(e),gitdir:n,remote:r,url:i,force:s})}catch(a){throw a.caller="git.addRemote",a}}async function X2e({fs:e,cache:t,onSign:n,gitdir:r,ref:i,tagger:s,message:a=i,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(i=i.startsWith("refs/tags/")?i:`refs/tags/${i}`,!u&&await Ht.exists({fs:e,gitdir:r,ref:i}))throw new fc("tag",i);const d=await Ht.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Di({fs:e,cache:t,gitdir:r,oid:d});let p=Ba.from({object:d,type:h,tag:i.replace("refs/tags/",""),tagger:s,message:a,gpgsig:o});c&&(p=await Ba.sign(p,n,c));const y=await xo({fs:e,gitdir:r,type:"tag",object:p.toObject()});await Ht.writeRef({fs:e,gitdir:r,ref:i,value:y})}async function J2e({fs:e,onSign:t,dir:n,gitdir:r=Dt.join(n,".git"),ref:i,tagger:s,message:a=i,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{it("fs",e),it("gitdir",r),it("ref",i),c&&it("onSign",t);const h=new xn(e),p=await Kf({fs:h,gitdir:r,author:s});if(!p)throw new _a("tagger");return await X2e({fs:h,cache:d,onSign:t,gitdir:r,ref:i,tagger:p,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function Q2e({fs:e,gitdir:t,ref:n,object:r,checkout:i=!1,force:s=!1}){if(n!==Vc.clean(n))throw new cc(n,Vc.clean(n));const a=`refs/heads/${n}`;if(!s&&await Ht.exists({fs:e,gitdir:t,ref:a}))throw new fc("branch",n,!1);let o;try{o=await Ht.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Ht.writeRef({fs:e,gitdir:t,ref:a,value:o}),i&&await Ht.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function eCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r,object:i,checkout:s=!1,force:a=!1}){try{return it("fs",e),it("gitdir",n),it("ref",r),await Q2e({fs:new xn(e),gitdir:n,ref:r,object:i,checkout:s,force:a})}catch(o){throw o.caller="git.branch",o}}const aY=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function fP({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:i,gitdir:s,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:p=!0}){let y;if(r)try{y=await Ht.resolve({fs:e,gitdir:s,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Ht.resolve({fs:e,gitdir:s,ref:o})}catch(x){if(o==="HEAD")throw x;const w=`${a}/${o}`;if(b=await Ht.resolve({fs:e,gitdir:s,ref:w}),p){const _=await ms.get({fs:e,gitdir:s});await _.set(`branch.${o}.remote`,a),await _.set(`branch.${o}.merge`,`refs/heads/${o}`),await ms.save({fs:e,gitdir:s,config:_})}await Ht.writeRef({fs:e,gitdir:s,ref:`refs/heads/${o}`,value:b})}if(!c){let x;try{x=await tCe({fs:e,cache:t,onProgress:n,dir:i,gitdir:s,ref:o,force:h,filepaths:l})}catch(E){throw E instanceof mi&&E.data.what===b?new Vw(o,b):E}const w=x.filter(([E])=>E==="conflict").map(([E,T])=>T);if(w.length>0)throw new qw(w);const _=x.filter(([E])=>E==="error").map(([E,T])=>T);if(_.length>0)throw new fr(_.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const C=x.length;await $s.acquire({fs:e,gitdir:s,cache:t},async function(E){await Promise.all(x.filter(([T])=>T==="delete"||T==="delete-index").map(async function([T,R]){const M=`${i}/${R}`;T==="delete"&&await e.rm(M),E.delete({filepath:R}),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}))}),await $s.acquire({fs:e,gitdir:s,cache:t},async function(E){for(const[T,R]of x)if(T==="rmdir"||T==="rmdir-index"){const M=`${i}/${R}`;try{T==="rmdir-index"&&E.delete({filepath:R}),await e.rmdir(M),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}catch(N){if(N.code==="ENOTEMPTY")console.log(`Did not delete ${R} because directory is not empty`);else throw N}}}),await Promise.all(x.filter(([E])=>E==="mkdir"||E==="mkdir-index").map(async function([E,T]){const R=`${i}/${T}`;await e.mkdir(R),n&&await n({phase:"Updating workdir",loaded:++S,total:C})})),await $s.acquire({fs:e,gitdir:s,cache:t},async function(E){await Promise.all(x.filter(([T])=>T==="create"||T==="create-index"||T==="update"||T==="mkdir-index").map(async function([T,R,M,N,O]){const B=`${i}/${R}`;try{if(T!=="create-index"&&T!=="mkdir-index"){const{object:H}=await Di({fs:e,cache:t,gitdir:s,oid:M});if(O&&await e.rm(B),N===33188)await e.write(B,H);else if(N===33261)await e.write(B,H,{mode:511});else if(N===40960)await e.writelink(B,H);else throw new fr(`Invalid mode 0o${N.toString(8)} detected in blob ${M}`)}const P=await e.lstat(B);N===33261&&(P.mode=493),T==="mkdir-index"&&(P.mode=57344),E.insert({filepath:R,stats:P,oid:M}),n&&await n({phase:"Updating workdir",loaded:++S,total:C})}catch(P){console.log(P)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const x=await Ht.expand({fs:e,gitdir:s,ref:o});x.startsWith("refs/heads")?await Ht.writeSymbolicRef({fs:e,gitdir:s,ref:"HEAD",value:x}):await Ht.writeRef({fs:e,gitdir:s,ref:"HEAD",value:b})}}async function tCe({fs:e,cache:t,onProgress:n,dir:r,gitdir:i,ref:s,force:a,filepaths:o}){let l=0;return Gf({fs:e,cache:t,dir:r,gitdir:i,trees:[yl({ref:s}),t1(),ly()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>aY(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=JK(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function oY({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:i=Dt.join(r,".git"),remote:s="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:p={}}){try{it("fs",e),it("dir",r),it("gitdir",i);const y=a||"HEAD";return await fP({fs:new xn(e),cache:p,onProgress:t,onPostCheckout:n,dir:r,gitdir:i,remote:s,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const nCe=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function dp(e){const t=nCe.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function gh({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const i=await Ht.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Ht.resolve({fs:e,gitdir:t,ref:i})}catch{return}if(i.startsWith("refs/"))return n?i:dp(i)}function rCe(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function lY({username:e="",password:t=""}){return`Basic ${sn.from(`${e}:${t}`).toString("base64")}`}async function i1(e,t){const n=YK(e);for(;;){const{value:r,done:i}=await n.next();if(r&&await t(r),i)break}n.return&&n.return()}async function wC(e){let t=0;const n=[];await i1(e,s=>{n.push(s),t+=s.byteLength});const r=new Uint8Array(t);let i=0;for(const s of n)r.set(s,i),i+=s.byteLength;return r}function f9(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Q3(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class Qi{static flush(){return sn.from("0000","utf8")}static delim(){return sn.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=sn.from(t));const n=t.length+4,r=Q3(4,n);return sn.concat([sn.from(r,"utf8"),t])}static streamReader(t){const n=new ZK(t);return async function(){try{let i=await n.read(4);if(i==null)return!0;if(i=parseInt(i.toString("utf8"),16),i===0||i===1)return null;const s=await n.read(i-4);return s??!0}catch(i){return t.error=i,!0}}}}async function h9(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const i=n.slice(0,r),s=n.slice(r+1);t[i]=s}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function p9(e,{service:t}){const n=new Set,r=new Map,i=new Map,s=Qi.streamReader(e);let a=await s();for(;a===null;)a=await s();if(a===!0)throw new Hw;if(a.includes("version 2"))return h9(s);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new om(`# service=${t}\\n`,a.toString("utf8"));let o=await s();for(;o===null;)o=await s();if(o===!0)return{capabilities:n,refs:r,symrefs:i};if(o=o.toString("utf8"),o.includes("version 2"))return h9(s);const[l,c]=NM(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=NM(l," "," ");for(r.set(d,u);;){const h=await s();if(h===!0)break;if(h!==null){const[p,y]=NM(h.toString("utf8")," "," ");r.set(y,p)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&i.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:i}}function NM(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new om(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const m9=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,g9=(e,t)=>{(t.username||t.password)&&(e.Authorization=lY(t)),t.headers&&Object.assign(e,t.headers)},jM=async e=>{try{const t=sn.from(await wC(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class _C{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:i,onAuthFailure:s,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=f9(l);const p=a?m9(a,d):d;(h.username||h.password)&&(c.Authorization=lY(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,x=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${p}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const w=x?s:r;if(w){if(h=await w(d,{...h,headers:{...c}}),h&&h.cancel)throw new fy;h&&(g9(c,h),x=!0,b=!0)}}else y.statusCode===200&&x&&i&&await i(d,h);while(b);if(y.statusCode!==200){const{response:w}=await jM(y);throw new x0(y.statusCode,y.statusMessage,w)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const w=await p9(y.body,{service:o});return w.auth=h,w}else{const{preview:w,response:_,data:S}=await jM(y);try{const C=await p9([S],{service:o});return C.auth=h,C}catch{throw new Zw(w,_)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:i,url:s,auth:a,body:o,headers:l}){const c=f9(s);c&&(s=c.url),r&&(s=m9(r,s)),l["content-type"]=`application/x-${i}-request`,l.accept=`application/x-${i}-result`,g9(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${s}/${i}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=jM(u);throw new x0(u.statusCode,u.statusMessage,d)}return u}}function iCe({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class TE{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",_C),n.set("https",_C);const r=iCe({url:t});if(!r)throw new Jw(t);if(n.has(r.transport))return n.get(r.transport);throw new Xw(t,r.transport,r.transport==="ssh"?rCe(t):void 0)}}let Jh=null;class Rx{static async read({fs:t,gitdir:n}){Jh===null&&(Jh=new Tx);const r=Dt.join(n,"shallow"),i=new Set;return await Jh.acquire(r,async function(){const s=await t.read(r,{encoding:"utf8"});if(s===null||s.trim()==="")return i;s.trim().split(`
`).map(a=>i.add(a))}),i}static async write({fs:t,gitdir:n,oids:r}){Jh===null&&(Jh=new Tx);const i=Dt.join(n,"shallow");if(r.size>0){const s=[...r].join(`
`)+`
`;await Jh.acquire(i,async function(){await t.write(i,s,{encoding:"utf8"})})}else await Jh.acquire(i,async function(){await t.rm(i)})}}async function sCe({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function aCe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}){let s=await e.readdir(Dt.join(n,"objects/pack"));s=s.filter(a=>a.endsWith(".idx"));for(const a of s){const o=`${n}/objects/pack/${a}`,l=await dP({fs:e,cache:t,filename:o,getExternalRefDelta:i});if(l.error)throw new fr(l.error);if(l.offsets.has(r))return!0}return!1}async function y9({fs:e,cache:t,gitdir:n,oid:r,format:i="content"}){const s=o=>Di({fs:e,cache:t,gitdir:n,oid:o});let a=await sCe({fs:e,gitdir:n,oid:r});return a||(a=await aCe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s})),a}function oCe(e){const i="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===i}function cY(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const i=r.split("=",1)[0];return n.includes(i)})}const AE={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class e2{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function lCe(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function uY(e){const t=new e2;let n="";return(async()=>(await i1(e,r=>{for(r=r.toString("utf8"),n+=r;;){const i=lCe(n);if(i===-1)break;t.write(n.slice(0,i)),n=n.slice(i)}}),n.length>0&&t.write(n),t.end()))(),t}class dY{static demux(t){const n=Qi.streamReader(t),r=new e2,i=new e2,s=new e2,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),s.end(),t.error?i.destroy(t.error):i.end();return}switch(o[0]){case 1:{i.write(o.slice(1));break}case 2:{s.write(o.slice(1));break}case 3:{const l=o.slice(1);s.write(l),r.end(),s.end(),i.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:i,progress:s}}}async function cCe(e){const{packetlines:t,packfile:n,progress:r}=dY.demux(e),i=[],s=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{i1(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const p=h.slice(-41).trim();p.length!==40&&u(new Hf(p)),i.push(p)}else if(h.startsWith("unshallow")){const p=h.slice(-41).trim();p.length!==40&&u(new Hf(p)),s.push(p)}else if(h.startsWith("ACK")){const[,p,y]=h.split(" ");a.push({oid:p,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:i,unshallows:s,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:i,unshallows:s,acks:a,nak:o,packfile:n,progress:r}))})})}function uCe({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:i=null,since:s=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(Qi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(Qi.encode(`shallow ${c}
`));i!==null&&o.push(Qi.encode(`deepen ${i}
`)),s!==null&&o.push(Qi.encode(`deepen-since ${Math.floor(s.valueOf()/1e3)}
`));for(const c of a)o.push(Qi.encode(`deepen-not ${c}
`));o.push(Qi.flush());for(const c of n)o.push(Qi.encode(`have ${c}
`));return o.push(Qi.encode(`done
`)),o}async function hP({fs:e,cache:t,http:n,onProgress:r,onMessage:i,onAuth:s,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:p,depth:y=null,since:b=null,exclude:x=[],relative:w=!1,tags:_=!1,singleBranch:S=!1,headers:C={},prune:E=!1,pruneTags:T=!1}){const R=c||await gh({fs:e,gitdir:l,test:!0}),M=await ms.get({fs:e,gitdir:l}),N=d||R&&await M.get(`branch.${R}.remote`)||"origin",O=h||await M.get(`remote.${N}.url`);if(typeof O>"u")throw new fo("remote OR url");const B=u||R&&await M.get(`branch.${R}.merge`)||c||"HEAD";p===void 0&&(p=await M.get("http.corsProxy"));const P=TE.getRemoteHelperFor({url:O}),H=await P.discover({http:n,onAuth:s,onAuthSuccess:a,onAuthFailure:o,corsProxy:p,service:"git-upload-pack",url:O,headers:C,protocolVersion:1}),F=H.auth,Q=H.refs;if(Q.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!H.capabilities.has("shallow"))throw new Ef("shallow","depth");if(b!==null&&!H.capabilities.has("deepen-since"))throw new Ef("deepen-since","since");if(x.length>0&&!H.capabilities.has("deepen-not"))throw new Ef("deepen-not","exclude");if(w===!0&&!H.capabilities.has("deepen-relative"))throw new Ef("deepen-relative","relative");const{oid:q,fullref:K}=Ht.resolveAgainstMap({ref:B,map:Q});for(const He of Q.keys())He===K||He==="HEAD"||He.startsWith("refs/heads/")||_&&He.startsWith("refs/tags/")||Q.delete(He);const U=cY([...H.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${AE.agent}`]);w&&U.push("deepen-relative");const re=S?[q]:Q.values(),G=S?[R]:await Ht.listRefs({fs:e,gitdir:l,filepath:"refs"});let ne=[];for(let He of G)try{He=await Ht.expand({fs:e,gitdir:l,ref:He});const je=await Ht.resolve({fs:e,gitdir:l,ref:He});await y9({fs:e,cache:t,gitdir:l,oid:je})&&ne.push(je)}catch{}ne=[...new Set(ne)];const te=await Rx.read({fs:e,gitdir:l}),se=H.capabilities.has("shallow")?[...te]:[],pe=uCe({capabilities:U,wants:re,haves:ne,shallows:se,depth:y,since:b,exclude:x}),de=sn.from(await wC(pe)),Ne=await P.connect({http:n,onProgress:r,corsProxy:p,service:"git-upload-pack",url:O,auth:F,body:[de],headers:C}),Pe=await cCe(Ne.body);Ne.headers&&(Pe.headers=Ne.headers);for(const He of Pe.shallows)if(!te.has(He))try{const{object:je}=await Di({fs:e,cache:t,gitdir:l,oid:He}),Y=new Oi(je),be=await Promise.all(Y.headers().parent.map(ce=>y9({fs:e,cache:t,gitdir:l,oid:ce})));be.length===0||be.every(ce=>ce)||te.add(He)}catch{te.add(He)}for(const He of Pe.unshallows)te.delete(He);if(await Rx.write({fs:e,gitdir:l,oids:te}),S){const He=new Map([[K,q]]),je=new Map;let Y=10,be=K;for(;Y--;){const le=H.symrefs.get(be);if(le===void 0)break;je.set(be,le),be=le}const Re=Q.get(be);Re&&He.set(be,Re);const{pruned:ce}=await Ht.updateRemoteRefs({fs:e,gitdir:l,remote:N,refs:He,symrefs:je,tags:_,prune:E});E&&(Pe.pruned=ce)}else{const{pruned:He}=await Ht.updateRemoteRefs({fs:e,gitdir:l,remote:N,refs:Q,symrefs:H.symrefs,tags:_,prune:E,pruneTags:T});E&&(Pe.pruned=He)}if(Pe.HEAD=H.symrefs.get("HEAD"),Pe.HEAD===void 0){const{oid:He}=Ht.resolveAgainstMap({ref:"HEAD",map:Q});for(const[je,Y]of Q.entries())if(je!=="HEAD"&&Y===He){Pe.HEAD=je;break}}const Me=K.startsWith("refs/tags")?"tag":"branch";if(Pe.FETCH_HEAD={oid:q,description:`${Me} '${dp(K)}' of ${O}`},r||i){const He=uY(Pe.progress);i1(He,async je=>{if(i&&await i(je),r){const Y=je.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);Y&&await r({phase:Y[1].trim(),loaded:parseInt(Y[2],10),total:parseInt(Y[3],10)})}})}const Ee=sn.from(await wC(Pe.packfile));if(Ne.body.error)throw Ne.body.error;const Ue=Ee.slice(-20).toString("hex"),nt={defaultBranch:Pe.HEAD,fetchHead:Pe.FETCH_HEAD.oid,fetchHeadDescription:Pe.FETCH_HEAD.description};if(Pe.headers&&(nt.headers=Pe.headers),E&&(nt.pruned=Pe.pruned),Ue!==""&&!oCe(Ee)){nt.packfile=`objects/pack/pack-${Ue}.pack`;const He=Dt.join(l,nt.packfile);await e.write(He,Ee);const je=be=>Di({fs:e,cache:t,gitdir:l,oid:be}),Y=await v0.fromPack({pack:Ee,getExternalRefDelta:je,onProgress:r});await e.write(He.replace(/\.pack$/,".idx"),await Y.toBuffer())}return nt}async function fY({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:Dt.join(n,".git"),defaultBranch:i="master"}){if(await e.exists(r+"/config"))return;let s=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];s=s.map(a=>r+"/"+a);for(const a of s)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${i}
`)}async function dCe({fs:e,cache:t,http:n,onProgress:r,onMessage:i,onAuth:s,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:p,remote:y,depth:b,since:x,exclude:w,relative:_,singleBranch:S,noCheckout:C,noTags:E,headers:T}){try{if(await fY({fs:e,gitdir:u}),await sY({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const N=await ms.get({fs:e,gitdir:u});await N.set("http.corsProxy",h),await ms.save({fs:e,gitdir:u,config:N})}const{defaultBranch:R,fetchHead:M}=await hP({fs:e,cache:t,http:n,onProgress:r,onMessage:i,onAuth:s,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:p,remote:y,corsProxy:h,depth:b,since:x,exclude:w,relative:_,singleBranch:S,headers:T,tags:!E});if(M===null)return;p=p||R,p=p.replace("refs/heads/",""),await fP({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:p,remote:y,noCheckout:C})}catch(R){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),R}}async function fCe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=Dt.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:p="origin",depth:y=void 0,since:b=void 0,exclude:x=[],relative:w=!1,singleBranch:_=!1,noCheckout:S=!1,noTags:C=!1,headers:E={},cache:T={}}){try{return it("fs",e),it("http",t),it("gitdir",c),S||it("dir",l),it("url",u),await dCe({fs:new xn(e),cache:T,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:p,depth:y,since:b,exclude:x,relative:w,singleBranch:_,noCheckout:S,noTags:C,headers:E})}catch(R){throw R.caller="git.clone",R}}async function hCe({fs:e,onSign:t,dir:n,gitdir:r=Dt.join(n,".git"),message:i,author:s,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:p,cache:y={}}){try{it("fs",e),l||it("message",i),o&&it("onSign",t);const b=new xn(e);return await EE({fs:b,cache:y,onSign:t,gitdir:r,message:i,author:s,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:p})}catch(b){throw b.caller="git.commit",b}}async function pCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),fullname:r=!1,test:i=!1}){try{return it("fs",e),it("gitdir",n),await gh({fs:new xn(e),gitdir:n,fullname:r,test:i})}catch(s){throw s.caller="git.currentBranch",s}}async function mCe({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Ht.exists({fs:e,gitdir:t,ref:n}))throw new mi(n);const i=await Ht.expand({fs:e,gitdir:t,ref:n}),s=await gh({fs:e,gitdir:t,fullname:!0});if(i===s){const l=await Ht.resolve({fs:e,gitdir:t,ref:i});await Ht.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Ht.deleteRef({fs:e,gitdir:t,ref:i});const a=dp(n),o=await ms.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await ms.save({fs:e,gitdir:t,config:o})}async function gCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r}){try{return it("fs",e),it("ref",r),await mCe({fs:new xn(e),gitdir:n,ref:r})}catch(i){throw i.caller="git.deleteBranch",i}}async function yCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r}){try{it("fs",e),it("ref",r),await Ht.deleteRef({fs:new xn(e),gitdir:n,ref:r})}catch(i){throw i.caller="git.deleteRef",i}}async function bCe({fs:e,gitdir:t,remote:n}){const r=await ms.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await ms.save({fs:e,gitdir:t,config:r})}async function vCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),remote:r}){try{return it("fs",e),it("remote",r),await bCe({fs:new xn(e),gitdir:n,remote:r})}catch(i){throw i.caller="git.deleteRemote",i}}async function xCe({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Ht.deleteRef({fs:e,gitdir:t,ref:n})}async function wCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r}){try{return it("fs",e),it("ref",r),await xCe({fs:new xn(e),gitdir:n,ref:r})}catch(i){throw i.caller="git.deleteTag",i}}async function _Ce({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(s=>`${r}${s}`).filter(s=>s.startsWith(n))}async function SCe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}){const s=[];let a=await e.readdir(Dt.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await dP({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new fr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&s.push(u)}return s}async function CCe({fs:e,cache:t,gitdir:n,oid:r}){const i=o=>Di({fs:e,cache:t,gitdir:n,oid:o}),s=await _Ce({fs:e,gitdir:n,oid:r}),a=await SCe({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i});for(const o of a)s.indexOf(o)===-1&&s.push(o);if(s.length===1)return s[0];throw s.length>1?new Uw("oids",r,s):new mi(`an object matching "${r}"`)}async function kCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,cache:i={}}){try{return it("fs",e),it("gitdir",n),it("oid",r),await CCe({fs:new xn(e),cache:i,gitdir:n,oid:r})}catch(s){throw s.caller="git.expandOid",s}}async function ECe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r}){try{return it("fs",e),it("gitdir",n),it("ref",r),await Ht.expand({fs:new xn(e),gitdir:n,ref:r})}catch(i){throw i.caller="git.expandRef",i}}async function pP({fs:e,cache:t,gitdir:n,oids:r}){const i={},s=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)i[c]||(i[c]=new Set),i[c].add(u),i[c].size===s&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Di({fs:e,cache:t,gitdir:n,oid:c}),h=Oi.from(d),{parent:p}=h.parseHeaders();for(const y of p)(!i[y]||!i[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const OM=/^.*(\r?\n|$)/gm;function TCe({branches:e,contents:t}){const n=e[1],r=e[2],i=t[0],s=t[1],a=t[2],o=s.match(OM),l=i.match(OM),c=a.match(OM),u=WSe(o,l,c),d=7;let h="",p=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(p=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:p,mergedText:h}}async function ACe({fs:e,cache:t,dir:n,gitdir:r=Dt.join(n,".git"),index:i,ourOid:s,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:p}){const y=yl({ref:s}),b=yl({ref:a}),x=yl({ref:o}),w=[],_=[],S=[],C=[],E=await Gf({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,x],map:async function(T,[R,M,N]){const O=gC(T),B=await xC(R,M),P=await xC(N,M);switch(`${B}-${P}`){case"false-false":return{mode:await M.mode(),path:O,oid:await M.oid(),type:await M.type()};case"false-true":return N?{mode:await N.mode(),path:O,oid:await N.oid(),type:await N.type()}:void 0;case"true-false":return R?{mode:await R.mode(),path:O,oid:await R.oid(),type:await R.type()}:void 0;case"true-true":{if(R&&M&&N&&await R.type()==="blob"&&await M.type()==="blob"&&await N.type()==="blob")return RCe({fs:e,gitdir:r,path:O,ours:R,base:M,theirs:N,ourName:l,baseName:c,theirName:u,mergeDriver:p}).then(async H=>{if(H.cleanMerge)h||i.insert({filepath:T,oid:H.mergeResult.oid,stage:0});else if(w.push(T),_.push(T),!h){const F=await M.oid(),Q=await R.oid(),q=await N.oid();i.delete({filepath:T}),i.insert({filepath:T,oid:F,stage:1}),i.insert({filepath:T,oid:Q,stage:2}),i.insert({filepath:T,oid:q,stage:3})}return H.mergeResult});if(M&&!R&&N&&await M.type()==="blob"&&await N.type()==="blob"){if(w.push(T),S.push(T),!h){const H=await M.oid(),F=await N.oid();i.delete({filepath:T}),i.insert({filepath:T,oid:H,stage:1}),i.insert({filepath:T,oid:F,stage:3})}return{mode:await N.mode(),oid:await N.oid(),type:"blob",path:O}}if(M&&R&&!N&&await M.type()==="blob"&&await R.type()==="blob"){if(w.push(T),C.push(T),!h){const H=await M.oid(),F=await R.oid();i.delete({filepath:T}),i.insert({filepath:T,oid:H,stage:1}),i.insert({filepath:T,oid:F,stage:2})}return{mode:await R.mode(),oid:await R.oid(),type:"blob",path:O}}if(M&&!R&&!N&&await M.type()==="blob")return;throw new uy}}},reduce:w.length!==0&&(!n||h)?void 0:async(T,R)=>{const M=R.filter(Boolean);if(T&&!(T&&T.type==="tree"&&M.length===0)){if(M.length>0){const O=new go(M).toObject(),B=await xo({fs:e,gitdir:r,type:"tree",object:O,dryRun:d});T.oid=B}return T}}});return w.length!==0?(n&&!h&&await Gf({fs:e,cache:t,dir:n,gitdir:r,trees:[yl({ref:E.oid})],map:async function(T,[R]){const M=`${n}/${T}`;if(await R.type()==="blob"){const N=await R.mode(),O=new TextDecoder().decode(await R.content());await e.write(M,O,{mode:N})}return!0}}),new dy(w,_,S,C)):E.oid}async function RCe({fs:e,gitdir:t,path:n,ours:r,base:i,theirs:s,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=TCe}){const d="blob",h=await i.mode()===await r.mode()?await s.mode():await r.mode();if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await s.oid(),type:d}};if(await s.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const p=sn.from(await r.content()).toString("utf8"),y=sn.from(await i.content()).toString("utf8"),b=sn.from(await s.content()).toString("utf8"),{mergedText:x,cleanMerge:w}=await u({branches:[l,a,o],contents:[y,p,b],path:n}),_=await xo({fs:e,gitdir:t,type:"blob",object:sn.from(x,"utf8"),dryRun:c});return{cleanMerge:w,mergeResult:{mode:h,path:n,oid:_,type:d}}}async function hY({fs:e,cache:t,dir:n,gitdir:r,ours:i,theirs:s,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:p,signingKey:y,onSign:b,mergeDriver:x}){i===void 0&&(i=await gh({fs:e,gitdir:r,fullname:!0})),i=await Ht.expand({fs:e,gitdir:r,ref:i}),s=await Ht.expand({fs:e,gitdir:r,ref:s});const w=await Ht.resolve({fs:e,gitdir:r,ref:i}),_=await Ht.resolve({fs:e,gitdir:r,ref:s}),S=await pP({fs:e,cache:t,gitdir:r,oids:[w,_]});if(S.length!==1)throw new uy;const C=S[0];if(C===_)return{oid:w,alreadyMerged:!0};if(a&&C===w)return!l&&!c&&await Ht.writeRef({fs:e,gitdir:r,ref:i,value:_}),{oid:_,fastForward:!0};{if(o)throw new Ww;const E=await $s.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async R=>ACe({fs:e,cache:t,dir:n,gitdir:r,index:R,ourOid:w,theirOid:_,baseOid:C,ourName:dp(i),baseName:"base",theirName:dp(s),dryRun:l,abortOnConflict:u,mergeDriver:x}));if(E instanceof dy)throw E;return d||(d=`Merge branch '${dp(s)}' into ${dp(i)}`),{oid:await EE({fs:e,cache:t,gitdir:r,message:d,ref:i,tree:E,parent:[w,_],author:h,committer:p,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:E,mergeCommit:!0}}}async function pY({fs:e,cache:t,http:n,onProgress:r,onMessage:i,onAuth:s,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:p,prune:y,pruneTags:b,fastForward:x,fastForwardOnly:w,corsProxy:_,singleBranch:S,headers:C,author:E,committer:T,signingKey:R}){try{if(!u){const O=await gh({fs:e,gitdir:c});if(!O)throw new fo("ref");u=O}const{fetchHead:M,fetchHeadDescription:N}=await hP({fs:e,cache:t,http:n,onProgress:r,onMessage:i,onAuth:s,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:_,ref:u,url:d,remote:h,remoteRef:p,singleBranch:S,headers:C,prune:y,pruneTags:b});await hY({fs:e,cache:t,gitdir:c,ours:u,theirs:M,fastForward:x,fastForwardOnly:w,message:`Merge ${N}`,author:E,committer:T,signingKey:R,dryRun:!1,noUpdateBranch:!1}),await fP({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(M){throw M.caller="git.pull",M}}async function ICe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,dir:o,gitdir:l=Dt.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:p,singleBranch:y,headers:b={},cache:x={}}){try{it("fs",e),it("http",t),it("gitdir",l);const w={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await pY({fs:new xn(e),cache:x,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:p,singleBranch:y,headers:b,author:w,committer:w})}catch(w){throw w.caller="git.fastForward",w}}async function MCe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,dir:o,gitdir:l=Dt.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:p,depth:y=null,since:b=null,exclude:x=[],relative:w=!1,tags:_=!1,singleBranch:S=!1,headers:C={},prune:E=!1,pruneTags:T=!1,cache:R={}}){try{return it("fs",e),it("http",t),it("gitdir",l),await hP({fs:new xn(e),cache:R,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:p,depth:y,since:b,exclude:x,relative:w,tags:_,singleBranch:S,headers:C,prune:E,pruneTags:T})}catch(M){throw M.caller="git.fetch",M}}async function NCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oids:r,cache:i={}}){try{return it("fs",e),it("gitdir",n),it("oids",r),await pP({fs:new xn(e),cache:i,gitdir:n,oids:r})}catch(s){throw s.caller="git.findMergeBase",s}}async function mY({fs:e,filepath:t}){if(await e.exists(Dt.join(t,".git")))return t;{const n=b0(t);if(n===t)throw new mi(`git root for ${t}`);return mY({fs:e,filepath:n})}}async function jCe({fs:e,filepath:t}){try{return it("fs",e),it("filepath",t),await mY({fs:new xn(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function OCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),path:r}){try{return it("fs",e),it("gitdir",n),it("path",r),await Ax({fs:new xn(e),gitdir:n,path:r})}catch(i){throw i.caller="git.getConfig",i}}async function PCe({fs:e,gitdir:t,path:n}){return(await ms.get({fs:e,gitdir:t})).getall(n)}async function DCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),path:r}){try{return it("fs",e),it("gitdir",n),it("path",r),await PCe({fs:new xn(e),gitdir:n,path:r})}catch(i){throw i.caller="git.getConfigAll",i}}async function FCe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:i,url:s,headers:a={},forPush:o=!1}){try{it("http",e),it("url",s);const c=await TE.getRemoteHelperFor({url:s}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:i,service:o?"git-receive-pack":"git-upload-pack",url:s,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const p=d.split("/"),y=p.pop();let b=u;for(const x of p)b[x]=b[x]||{},b=b[x];b[y]=h}for(const[d,h]of c.symrefs){const p=d.split("/"),y=p.pop();let b=u;for(const x of p)b[x]=b[x]||{},b=b[x];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function gY(e,t,n,r){const i=[];for(const[s,a]of e.refs){if(t&&!s.startsWith(t))continue;if(s.endsWith("^{}")){if(r){const l=s.replace("^{}",""),c=i[i.length-1],u=c.ref===l?c:i.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:s,oid:a};n&&e.symrefs.has(s)&&(o.target=e.symrefs.get(s)),i.push(o)}return i}async function LCe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:i,url:s,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{it("http",e),it("url",s);const u=await TE.getRemoteHelperFor({url:s}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:i,service:o?"git-receive-pack":"git-upload-pack",url:s,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[p,y]=h.split("=");y?d[p]=y:d[p]=!0}return{protocolVersion:1,capabilities:d,refs:gY(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function BCe({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=cy.wrap({type:e,object:t})),r=await gd(t)),{oid:r,object:t}}async function $Ce({object:e}){try{it("object",e),typeof e=="string"?e=sn.from(e,"utf8"):e=sn.from(e);const t="blob",{oid:n,object:r}=await BCe({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function zCe({fs:e,cache:t,onProgress:n,dir:r,gitdir:i,filepath:s}){try{s=Dt.join(r,s);const a=await e.read(s),o=c=>Di({fs:e,cache:t,gitdir:i,oid:c}),l=await v0.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(s.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function UCe({fs:e,onProgress:t,dir:n,gitdir:r=Dt.join(n,".git"),filepath:i,cache:s={}}){try{return it("fs",e),it("dir",n),it("gitdir",n),it("filepath",i),await zCe({fs:new xn(e),cache:s,onProgress:t,dir:n,gitdir:r,filepath:i})}catch(a){throw a.caller="git.indexPack",a}}async function qCe({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:Dt.join(n,".git"),defaultBranch:i="master"}){try{return it("fs",e),it("gitdir",r),t||it("dir",n),await fY({fs:new xn(e),bare:t,dir:n,gitdir:r,defaultBranch:i})}catch(s){throw s.caller="git.init",s}}async function yY({fs:e,cache:t,gitdir:n,oid:r,ancestor:i,depth:s}){const a=await Rx.read({fs:e,gitdir:n});if(!r)throw new fo("oid");if(!i)throw new fo("ancestor");if(r===i)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===s)throw new Kw(s);const u=o.shift(),{type:d,object:h}=await Di({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new Ga(u,d,"commit");const p=Oi.from(h).parse();for(const y of p.parent)if(y===i)return!0;if(!a.has(u))for(const y of p.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function VCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,ancestor:i,depth:s=-1,cache:a={}}){try{return it("fs",e),it("gitdir",n),it("oid",r),it("ancestor",i),await yY({fs:new xn(e),cache:a,gitdir:n,oid:r,ancestor:i,depth:s})}catch(o){throw o.caller="git.isDescendent",o}}async function HCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r}){try{return it("fs",e),it("dir",t),it("gitdir",n),it("filepath",r),hy.isIgnored({fs:new xn(e),dir:t,gitdir:n,filepath:r})}catch(i){throw i.caller="git.isIgnored",i}}async function WCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),remote:r}){try{return it("fs",e),it("gitdir",n),Ht.listBranches({fs:new xn(e),gitdir:n,remote:r})}catch(i){throw i.caller="git.listBranches",i}}async function GCe({fs:e,gitdir:t,ref:n,cache:r}){if(n){const i=await Ht.resolve({gitdir:t,fs:e,ref:n}),s=[];return await bY({fs:e,cache:r,gitdir:t,oid:i,filenames:s,prefix:""}),s}else return $s.acquire({fs:e,gitdir:t,cache:r},async function(i){return i.entries.map(s=>s.path)})}async function bY({fs:e,cache:t,gitdir:n,oid:r,filenames:i,prefix:s}){const{tree:a}=await py({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await bY({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:i,prefix:Dt.join(s,o.path)}):i.push(Dt.join(s,o.path))}async function KCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r,cache:i={}}){try{return it("fs",e),it("gitdir",n),await GCe({fs:new xn(e),cache:i,gitdir:n,ref:r})}catch(s){throw s.caller="git.listFiles",s}}async function YCe({fs:e,cache:t,gitdir:n,ref:r}){let i;try{i=await Ht.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof mi)return[]}return(await py({fs:e,cache:t,gitdir:n,oid:i})).tree.map(o=>({target:o.path,note:o.oid}))}async function ZCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r="refs/notes/commits",cache:i={}}){try{return it("fs",e),it("gitdir",n),it("ref",r),await YCe({fs:new xn(e),cache:i,gitdir:n,ref:r})}catch(s){throw s.caller="git.listNotes",s}}async function XCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r}){try{return it("fs",e),it("gitdir",n),Ht.listRefs({fs:new xn(e),gitdir:n,filepath:r})}catch(i){throw i.caller="git.listRefs",i}}async function JCe({fs:e,gitdir:t}){const n=await ms.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async s=>{const a=await n.get(`remote.${s}.url`);return{remote:s,url:a}}))}async function QCe({fs:e,dir:t,gitdir:n=Dt.join(t,".git")}){try{return it("fs",e),it("gitdir",n),await JCe({fs:new xn(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function eke(e){const t=Qi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[i,s,...a]=r.split(" "),o={ref:s,oid:i};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function tke({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(Qi.encode(`command=ls-refs
`)),r.push(Qi.encode(`agent=${AE.agent}
`)),(n||t||e)&&r.push(Qi.delim()),n&&r.push(Qi.encode("peel")),t&&r.push(Qi.encode("symrefs")),e&&r.push(Qi.encode(`ref-prefix ${e}`)),r.push(Qi.flush()),r}async function nke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:i,url:s,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{it("http",e),it("url",s);const h=await _C.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:i,service:o?"git-receive-pack":"git-upload-pack",url:s,headers:a,protocolVersion:l});if(h.protocolVersion===1)return gY(h,c,u,d);const p=await tke({prefix:c,symrefs:u,peelTags:d}),y=await _C.connect({http:e,auth:h.auth,headers:a,corsProxy:i,service:o?"git-receive-pack":"git-upload-pack",url:s,body:p});return eke(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function rke({fs:e,dir:t,gitdir:n=Dt.join(t,".git")}){try{return it("fs",e),it("gitdir",n),Ht.listTags({fs:new xn(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function ike(e,t){return e.committer.timestamp-t.committer.timestamp}const ske="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function b9({fs:e,cache:t,gitdir:n,oid:r,fileId:i}){if(i===ske)return;const s=r;let a;const o=await _0({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return i===o.oid?a=o.path:(a=await vY({fs:e,cache:t,gitdir:n,tree:l,fileId:i,oid:s}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function vY({fs:e,cache:t,gitdir:n,tree:r,fileId:i,oid:s,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===i?(u=Dt.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Di({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return vY({fs:e,cache:t,gitdir:n,tree:go.from(d),fileId:i,oid:s,filepaths:a,parentPath:Dt.join(o,c.path)})})),u});return await Promise.all(l),a}async function ake({fs:e,cache:t,gitdir:n,filepath:r,ref:i,depth:s,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await Rx.read({fs:e,gitdir:n}),h=await Ht.resolve({fs:e,gitdir:n,ref:i}),p=[await C0({fs:e,cache:t,gitdir:n,oid:h})];let y,b,x;function w(_){x&&r&&u.push(_)}for(;p.length>0;){const _=p.pop();if(c!==void 0&&_.commit.committer.timestamp<=c)break;if(r){let S;try{S=await n1({fs:e,cache:t,gitdir:n,oid:_.commit.tree,filepath:r}),b&&y!==S&&u.push(b),y=S,b=_,x=!0}catch(C){if(C instanceof mi){let E=l&&y;if(E&&(E=await b9({fs:e,cache:t,gitdir:n,oid:_.commit.tree,fileId:y}),E))if(Array.isArray(E)){if(b){const T=await b9({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(T))if(E=E.filter(R=>T.indexOf(R)===-1),E.length===1)E=E[0],r=E,b&&u.push(b);else{E=!1,b&&u.push(b);break}}}else r=E,b&&u.push(b);if(!E){if(x&&y&&(u.push(b),!o))break;if(!o&&!l)throw C}b=_,x=!1}else throw C}}else u.push(_);if(s!==void 0&&u.length===s){w(_);break}if(!d.has(_.oid))for(const S of _.commit.parent){const C=await C0({fs:e,cache:t,gitdir:n,oid:S});p.map(E=>E.oid).includes(C.oid)||p.push(C)}p.length===0&&w(_),p.sort((S,C)=>ike(S.commit,C.commit))}return u}async function oke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r,ref:i="HEAD",depth:s,since:a,force:o,follow:l,cache:c={}}){try{return it("fs",e),it("gitdir",n),it("ref",i),await ake({fs:new xn(e),cache:c,gitdir:n,filepath:r,ref:i,depth:s,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function lke({fs:e,onSign:t,dir:n,gitdir:r=Dt.join(n,".git"),ours:i,theirs:s,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:p,signingKey:y,cache:b={},mergeDriver:x}){try{it("fs",e),y&&it("onSign",t);const w=new xn(e),_=await Kf({fs:w,gitdir:r,author:h});if(!_&&(!o||!a))throw new _a("author");const S=await S0({fs:w,gitdir:r,author:_,committer:p});if(!S&&(!o||!a))throw new _a("committer");return await hY({fs:w,cache:b,dir:n,gitdir:r,ours:i,theirs:s,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:_,committer:S,signingKey:y,onSign:t,mergeDriver:x})}catch(w){throw w.caller="git.merge",w}}const cke={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function xY({fs:e,cache:t,dir:n,gitdir:r=Dt.join(n,".git"),oids:i}){const s=new FK,a=[];function o(u,d){const h=sn.from(u,d);a.push(h),s.update(h)}async function l({stype:u,object:d}){const h=cke[u];let p=d.length,y=p>15?128:0;const b=p&15;p=p>>>4;let x=(y|h|b).toString(16);for(o(x,"hex");y;)y=p>127?128:0,x=y|p&127,o(Q3(2,x),"hex"),p=p>>>7;o(sn.from(await QK(d)))}o("PACK"),o("00000002","hex"),o(Q3(8,i.length),"hex");for(const u of i){const{type:d,object:h}=await Di({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=s.digest();return a.push(c),a}async function uke({fs:e,cache:t,gitdir:n,oids:r,write:i}){const s=await xY({fs:e,cache:t,gitdir:n,oids:r}),a=sn.from(await wC(s)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return i?(await e.write(Dt.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function dke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oids:r,write:i=!1,cache:s={}}){try{return it("fs",e),it("gitdir",n),it("oids",r),await uke({fs:new xn(e),cache:s,gitdir:n,oids:r,write:i})}catch(a){throw a.caller="git.packObjects",a}}async function fke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,dir:o,gitdir:l=Dt.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:p=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:x=!1,corsProxy:w,singleBranch:_,headers:S={},author:C,committer:E,signingKey:T,cache:R={}}){try{it("fs",e),it("gitdir",l);const M=new xn(e),N=await Kf({fs:M,gitdir:l,author:C});if(!N)throw new _a("author");const O=await S0({fs:M,gitdir:l,author:N,committer:E});if(!O)throw new _a("committer");return await pY({fs:M,cache:R,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:x,corsProxy:w,singleBranch:_,headers:S,author:N,committer:O,signingKey:T,prune:p,pruneTags:y})}catch(M){throw M.caller="git.pull",M}}async function hke({fs:e,cache:t,dir:n,gitdir:r=Dt.join(n,".git"),start:i,finish:s}){const a=await Rx.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of i)o.add(await Ht.resolve({fs:e,gitdir:r,ref:d}));for(const d of s)try{const h=await Ht.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:p}=await Di({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=Ba.from(p).headers().object;return u(b)}if(h!=="commit")throw new Ga(d,h,"commit");if(!a.has(d)){const b=Oi.from(p).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function PM({fs:e,cache:t,dir:n,gitdir:r=Dt.join(n,".git"),oids:i}){const s=new Set;async function a(o){if(s.has(o))return;s.add(o);const{type:l,object:c}=await Di({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=Ba.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Oi.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=go.from(c);for(const d of u)d.type==="blob"&&s.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of i)await a(o);return s}async function pke(e){const t={};let n="";const r=Qi.streamReader(e);let i=await r();for(;i!==!0;)i!==null&&(n+=i.toString("utf8")+`
`),i=await r();const s=n.toString("utf8").split(`
`);if(i=s.shift(),!i.startsWith("unpack "))throw new om('unpack ok" or "unpack [error message]',i);t.ok=i==="unpack ok",t.ok||(t.error=i.slice(7)),t.refs={};for(const a of s){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function mke({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const i of t)n.push(Qi.encode(`${i.oldoid} ${i.oid} ${i.fullRef}${r}
`)),r="";return n.push(Qi.flush()),n}async function gke({fs:e,cache:t,http:n,onProgress:r,onMessage:i,onAuth:s,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:p,force:y=!1,delete:b=!1,corsProxy:x,headers:w={}}){const _=u||await gh({fs:e,gitdir:c});if(typeof _>"u")throw new fo("ref");const S=await ms.get({fs:e,gitdir:c});h=h||await S.get(`branch.${_}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${_}.remote`)||"origin";const C=p||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof C>"u")throw new fo("remote OR url");const E=d||await S.get(`branch.${_}.merge`);if(typeof C>"u")throw new fo("remoteRef");x===void 0&&(x=await S.get("http.corsProxy"));const T=await Ht.expand({fs:e,gitdir:c,ref:_}),R=b?"0000000000000000000000000000000000000000":await Ht.resolve({fs:e,gitdir:c,ref:T}),M=TE.getRemoteHelperFor({url:C}),N=await M.discover({http:n,onAuth:s,onAuthSuccess:a,onAuthFailure:o,corsProxy:x,service:"git-receive-pack",url:C,headers:w,protocolVersion:1}),O=N.auth;let B;if(!E)B=T;else try{B=await Ht.expandAgainstMap({ref:E,map:N.refs})}catch(te){if(te instanceof mi)B=E.startsWith("refs/")?E:`refs/heads/${E}`;else throw te}const P=N.refs.get(B)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:C,localRef:{ref:b?"(delete)":T,oid:R},remoteRef:{ref:B,oid:P}}))throw new fy;const H=!N.capabilities.has("no-thin");let F=new Set;if(!b){const te=[...N.refs.values()];let se=new Set;if(P!=="0000000000000000000000000000000000000000"){const pe=await pP({fs:e,cache:t,gitdir:c,oids:[R,P]});for(const de of pe)te.push(de);H&&(se=await PM({fs:e,cache:t,gitdir:c,oids:pe}))}if(!te.includes(R)){const pe=await hke({fs:e,cache:t,gitdir:c,start:[R],finish:te});F=await PM({fs:e,cache:t,gitdir:c,oids:pe})}if(H){try{const pe=await Ht.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:de}=await Ht.resolveAgainstMap({ref:pe.replace(`refs/remotes/${h}/`,""),fullref:pe,map:N.refs}),Ne=[de];for(const Pe of await PM({fs:e,cache:t,gitdir:c,oids:Ne}))se.add(Pe)}catch{}for(const pe of se)F.delete(pe)}if(R===P&&(y=!0),!y){if(T.startsWith("refs/tags")&&P!=="0000000000000000000000000000000000000000")throw new w0("tag-exists");if(R!=="0000000000000000000000000000000000000000"&&P!=="0000000000000000000000000000000000000000"&&!await yY({fs:e,cache:t,gitdir:c,oid:R,ancestor:P,depth:-1}))throw new w0("not-fast-forward")}}const Q=cY([...N.capabilities],["report-status","side-band-64k",`agent=${AE.agent}`]),q=await mke({capabilities:Q,triplets:[{oldoid:P,oid:R,fullRef:B}]}),K=b?[]:await xY({fs:e,cache:t,gitdir:c,oids:[...F]}),U=await M.connect({http:n,onProgress:r,corsProxy:x,service:"git-receive-pack",url:C,auth:O,headers:w,body:[...q,...K]}),{packfile:re,progress:G}=await dY.demux(U.body);if(i){const te=uY(G);i1(te,async se=>{await i(se)})}const ne=await pke(re);if(U.headers&&(ne.headers=U.headers),h&&ne.ok&&ne.refs[B].ok&&!T.startsWith("refs/tags")){const te=`refs/remotes/${h}/${B.replace("refs/heads","")}`;b?await Ht.deleteRef({fs:e,gitdir:c,ref:te}):await Ht.writeRef({fs:e,gitdir:c,ref:te,value:R})}if(ne.ok&&Object.values(ne.refs).every(te=>te.ok))return ne;{const te=Object.entries(ne.refs).filter(([se,pe])=>!pe.ok).map(([se,pe])=>`
  - ${se}: ${pe.error}`).join("");throw new Gw(te,ne)}}async function yke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=Dt.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:p,force:y=!1,delete:b=!1,corsProxy:x,headers:w={},cache:_={}}){try{return it("fs",e),it("http",t),it("gitdir",c),await gke({fs:new xn(e),cache:_,http:t,onProgress:n,onMessage:r,onAuth:i,onAuthSuccess:s,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:p,force:y,delete:b,corsProxy:x,headers:w})}catch(S){throw S.caller="git.push",S}}async function wY({fs:e,cache:t,gitdir:n,oid:r}){const{type:i,object:s}=await Di({fs:e,cache:t,gitdir:n,oid:r});if(i==="tag")return r=Ba.from(s).parse().object,wY({fs:e,cache:t,gitdir:n,oid:r});if(i!=="blob")throw new Ga(r,i,"blob");return{oid:r,blob:new Uint8Array(s)}}async function _Y({fs:e,cache:t,gitdir:n,oid:r,filepath:i=void 0}){return i!==void 0&&(r=await n1({fs:e,cache:t,gitdir:n,oid:r,filepath:i})),await wY({fs:e,cache:t,gitdir:n,oid:r})}async function bke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,filepath:i,cache:s={}}){try{return it("fs",e),it("gitdir",n),it("oid",r),await _Y({fs:new xn(e),cache:s,gitdir:n,oid:r,filepath:i})}catch(a){throw a.caller="git.readBlob",a}}async function SY({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,cache:i={}}){try{return it("fs",e),it("gitdir",n),it("oid",r),await C0({fs:new xn(e),cache:i,gitdir:n,oid:r})}catch(s){throw s.caller="git.readCommit",s}}async function vke({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:i}){const s=await Ht.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await _Y({fs:e,cache:t,gitdir:n,oid:s,filepath:i});return a}async function xke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r="refs/notes/commits",oid:i,cache:s={}}){try{return it("fs",e),it("gitdir",n),it("ref",r),it("oid",i),await vke({fs:new xn(e),cache:s,gitdir:n,ref:r,oid:i})}catch(a){throw a.caller="git.readNote",a}}async function wke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,format:i="parsed",filepath:s=void 0,encoding:a=void 0,cache:o={}}){try{it("fs",e),it("gitdir",n),it("oid",r);const l=new xn(e);s!==void 0&&(r=await n1({fs:l,cache:o,gitdir:n,oid:r,filepath:s}));const u=await Di({fs:l,cache:o,gitdir:n,oid:r,format:i==="parsed"?"content":i});if(u.oid=r,i==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Oi.from(u.object).parse();break;case"tree":u.object=go.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=Ba.from(u.object).parse();break;default:throw new Ga(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function _ke({fs:e,cache:t,gitdir:n,oid:r}){const{type:i,object:s}=await Di({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(i!=="tag")throw new Ga(r,i,"tag");const a=Ba.from(s);return{oid:r,tag:a.parse(),payload:a.payload()}}async function Ske({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,cache:i={}}){try{return it("fs",e),it("gitdir",n),it("oid",r),await _ke({fs:new xn(e),cache:i,gitdir:n,oid:r})}catch(s){throw s.caller="git.readTag",s}}async function Cke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),oid:r,filepath:i=void 0,cache:s={}}){try{return it("fs",e),it("gitdir",n),it("oid",r),await py({fs:new xn(e),cache:s,gitdir:n,oid:r,filepath:i})}catch(a){throw a.caller="git.readTree",a}}async function kke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r,cache:i={}}){try{it("fs",e),it("gitdir",n),it("filepath",r),await $s.acquire({fs:new xn(e),gitdir:n,cache:i},async function(s){s.delete({filepath:r})})}catch(s){throw s.caller="git.remove",s}}async function Eke({fs:e,cache:t,onSign:n,gitdir:r,ref:i="refs/notes/commits",oid:s,author:a,committer:o,signingKey:l}){let c;try{c=await Ht.resolve({gitdir:r,fs:e,ref:i})}catch(y){if(!(y instanceof mi))throw y}let d=(await py({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==s);const h=await r1({fs:e,gitdir:r,tree:d});return await EE({fs:e,cache:t,onSign:n,gitdir:r,ref:i,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function Tke({fs:e,onSign:t,dir:n,gitdir:r=Dt.join(n,".git"),ref:i="refs/notes/commits",oid:s,author:a,committer:o,signingKey:l,cache:c={}}){try{it("fs",e),it("gitdir",r),it("oid",s);const u=new xn(e),d=await Kf({fs:u,gitdir:r,author:a});if(!d)throw new _a("author");const h=await S0({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new _a("committer");return await Eke({fs:u,cache:c,onSign:t,gitdir:r,ref:i,oid:s,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function Ake({fs:e,gitdir:t,oldref:n,ref:r,checkout:i=!1}){if(r!==Vc.clean(r))throw new cc(r,Vc.clean(r));if(n!==Vc.clean(n))throw new cc(n,Vc.clean(n));const s=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Ht.exists({fs:e,gitdir:t,ref:a}))throw new fc("branch",r,!1);const l=await Ht.resolve({fs:e,gitdir:t,ref:s,depth:1});await Ht.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Ht.deleteRef({fs:e,gitdir:t,ref:s});const u=await gh({fs:e,gitdir:t,fullname:!0})===s;(i||u)&&await Ht.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function Rke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r,oldref:i,checkout:s=!1}){try{return it("fs",e),it("gitdir",n),it("ref",r),it("oldref",i),await Ake({fs:new xn(e),gitdir:n,ref:r,oldref:i,checkout:s})}catch(a){throw a.caller="git.renameBranch",a}}async function CY({gitdir:e,type:t,object:n}){return gd(cy.wrap({type:t,object:n}))}async function Ike({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r,ref:i,cache:s={}}){try{it("fs",e),it("gitdir",n),it("filepath",r);const a=new xn(e);let o,l;try{o=await Ht.resolve({fs:a,gitdir:n,ref:i||"HEAD"})}catch(d){if(i)throw d}if(o)try{o=await n1({fs:a,cache:s,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read(Dt.join(t,r));u&&(l=await CY({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat(Dt.join(t,r)))),await $s.acquire({fs:a,gitdir:n,cache:s},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function Mke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r,depth:i}){try{return it("fs",e),it("gitdir",n),it("ref",r),await Ht.resolve({fs:new xn(e),gitdir:n,ref:r,depth:i})}catch(s){throw s.caller="git.resolveRef",s}}async function Nke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),path:r,value:i,append:s=!1}){try{it("fs",e),it("gitdir",n),it("path",r);const a=new xn(e),o=await ms.get({fs:a,gitdir:n});s?await o.append(r,i):await o.set(r,i),await ms.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function kY({fs:e,gitdir:t,commit:n}){const r=Oi.from(n).toObject();return await xo({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class SC{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const i=t.name.replace(/\s/g,""),s="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=SC.timezoneOffsetForRefLogEntry;return`${s} ${n} ${i} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(s=>s).reverse().map((s,a)=>n?`stash@{${a}}: ${s.split("	")[1]}`:s)}}const jke={stage:ly,workdir:t1};let DM;async function k0(e,t){return DM===void 0&&(DM=new Tx),DM.acquire(e,t)}async function Oke(e,t,n,r,i=null){const s=Dt.join(n,r),a=await e.lstat(s);if(!a)throw new mi(s);if(a.isDirectory())throw new fr(`${s}: file expected, but found directory`);const o=i?await KK({fs:e,gitdir:t,oid:i}):void 0;let l=o?i:void 0;return o||await k0({fs:e,gitdir:t,currentFilepath:s},async()=>{const c=a.isSymbolicLink()?await e.readlink(s).then(eY):await e.read(s);if(c===null)throw new mi(s);l=await xo({fs:e,gitdir:t,type:"blob",object:c})}),l}async function Pke({fs:e,dir:t,gitdir:n,entries:r}){async function i(s){if(s.type==="tree"){if(!s.oid){const a=await Promise.all(s.children.map(i));s.oid=await r1({fs:e,gitdir:n,tree:a}),s.mode=16384}}else s.type==="blob"&&(s.oid=await Oke(e,n,t,s.path,s.oid),s.mode=33188);return s.path=s.path.split("/").pop(),s}return Promise.all(r.map(i))}async function v9({fs:e,dir:t,gitdir:n,treePair:r}){const i=r[1]==="stage",s=r.map(p=>typeof p=="string"?jke[p]():p),a=[],u=await Gf({fs:e,cache:{},dir:t,gitdir:n,trees:s,map:async(p,[y,b])=>{if(!(p==="."||await hy.isIgnored({fs:e,dir:t,gitdir:n,filepath:p}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:p,oid:await b.oid(),type:await b.type()}},reduce:async(p,y)=>(y=y.filter(Boolean),p?(p.children=y,p):y.length>0?y:void 0),iterate:async(p,y)=>{const b=[];for(const x of y){const[w,_]=x;i?_&&(await e.exists(`${t}/${_.toString()}`)?b.push(x):a.push([null,_])):w&&(_?b.push(x):a.push([w,null]))}return b.length?Promise.all(b.map(p)):[]}});if(a.length===0||u.length===0)return null;const h=(await Pke({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(p=>({mode:p.mode,path:p.path,oid:p.oid,type:p.type}));return r1({fs:e,gitdir:n,tree:h})}async function Dke({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:i,wasStaged:s}){const a=[],o=[],l=await Gf({fs:e,cache:{},dir:t,gitdir:n,trees:[yl({ref:i}),yl({ref:r})],map:async(c,[u,d])=>{if(c==="."||await hy.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&s&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const p=await d.oid();if(!u||await u.oid()!==p)return h==="tree"?{method:"mkdir",filepath:c}:(s&&o.push({filepath:c,oid:p,stats:await e.lstat(Dt.join(t,c))}),{method:"write",filepath:c,oid:p})}});await k0({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=Dt.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Di({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await $s.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class sd{constructor({fs:t,dir:n,gitdir:r=Dt.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return Dt.join(this.gitdir,sd.refStash)}get refLogsStashPath(){return Dt.join(this.gitdir,sd.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await Kf({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new _a("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return kY({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new cc(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?C0({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Ht.writeRef({fs:this.fs,gitdir:this.gitdir,ref:sd.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),i=SC.createStashReflogEntry(r,t,n),s=this.refLogsStashPath;await k0({filepath:s,entry:i},async()=>{const a=await this.fs.exists(s)?await this.fs.read(s,"utf8"):"";await this.fs.write(s,a+i,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return SC.getStashReflogEntry(r,t)}}async function Fke({fs:e,dir:t,gitdir:n,message:r=""}){const i=new sd({fs:e,dir:t,gitdir:n});await i.getAuthor();const s=await gh({fs:e,gitdir:n,fullname:!1}),a=await Ht.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await SY({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=yl({ref:"HEAD"});const h=await v9({fs:e,dir:t,gitdir:n,treePair:[yl({ref:"HEAD"}),"stage"]});if(h){const x=await i.writeStashCommit({message:`stash-Index: WIP on ${s} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(x),u=h,d=ly()}const p=await v9({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(p){const x=await i.writeStashCommit({message:`stash-WorkDir: WIP on ${s} - ${new Date().toISOString()}`,tree:p,parent:[c[c.length-1]]});c.push(x),u=p}if(!u||!h&&!p)throw new mi("changes, nothing to stash");const y=(r.trim()||`WIP on ${s}`)+`: ${a.substring(0,7)} ${l}`,b=await i.writeStashCommit({message:y,tree:u,parent:c});return await i.writeStashRef(b),await i.writeStashReflogEntry({stashCommit:b,message:y}),await oY({fs:e,dir:t,gitdir:n,ref:s,track:!1,force:!0}),b}async function EY({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=await new sd({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=s.commit?s.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await C0({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await Dke({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function TY({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=new sd({fs:e,dir:t,gitdir:n});if(!(await i.readStashCommit(r)).commit)return;const a=i.refStashPath;await k0(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await i.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=i.refLogsStashPath;await k0({reflogEntries:o,stashReflogPath:l,stashMgr:i},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await i.writeStashRef(c)}else await e.rm(l)})}async function Lke({fs:e,dir:t,gitdir:n}){return new sd({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function Bke({fs:e,dir:t,gitdir:n}){const r=new sd({fs:e,dir:t,gitdir:n}),i=[r.refStashPath,r.refLogsStashPath];await k0(i,async()=>{await Promise.all(i.map(async s=>{if(await e.exists(s))return e.rm(s)}))})}async function $ke({fs:e,dir:t,gitdir:n,refIdx:r=0}){await EY({fs:e,dir:t,gitdir:n,refIdx:r}),await TY({fs:e,dir:t,gitdir:n,refIdx:r})}async function zke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),op:r="push",message:i="",refIdx:s=0}){it("fs",e),it("dir",t),it("gitdir",n),it("op",r);const a={push:Fke,apply:EY,drop:TY,list:Lke,clear:Bke,pop:$ke},o=["apply","drop","pop"];try{const l=new xn(e);["refs","logs","logs/refs"].map(d=>Dt.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&s<0)throw new cc(`stash@${s}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:i,refIdx:s})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function Uke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),filepath:r,cache:i={}}){try{it("fs",e),it("gitdir",n),it("filepath",r);const s=new xn(e);if(await hy.isIgnored({fs:s,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await qke({fs:s,cache:i,gitdir:n}),l=await AY({fs:s,cache:i,gitdir:n,tree:o,path:r}),c=await $s.acquire({fs:s,gitdir:n,cache:i},async function(b){for(const x of b)if(x.path===r)return x;return null}),u=await s.lstat(Dt.join(t,r)),d=l!==null,h=c!==null,p=u!==null,y=async()=>{if(h&&!mC(c,u))return c.oid;{const b=await s.read(Dt.join(t,r)),x=await CY({gitdir:n,type:"blob",object:b});return h&&c.oid===x&&u.size!==-1&&$s.acquire({fs:s,gitdir:n,cache:i},async function(w){w.insert({filepath:r,stats:u,oid:x})}),x}};if(!d&&!p&&!h)return"absent";if(!d&&!p&&h)return"*absent";if(!d&&p&&!h)return"*added";if(!d&&p&&h)return await y()===c.oid?"added":"*added";if(d&&!p&&!h)return"deleted";if(d&&!p&&h)return l===c.oid,"*deleted";if(d&&p&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&p&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(s){throw s.caller="git.status",s}}async function AY({fs:e,cache:t,gitdir:n,tree:r,path:i}){typeof i=="string"&&(i=i.split("/"));const s=i.shift();for(const a of r)if(a.path===s){if(i.length===0)return a.oid;const{type:o,object:l}=await Di({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=go.from(l);return AY({fs:e,cache:t,gitdir:n,tree:c,path:i})}if(o==="blob")throw new Ga(a.oid,o,"blob",i.join("/"))}return null}async function qke({fs:e,cache:t,gitdir:n}){let r;try{r=await Ht.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(s){if(s instanceof mi)return[]}const{tree:i}=await py({fs:e,cache:t,gitdir:n,oid:r});return i}async function Vke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r="HEAD",filepaths:i=["."],filter:s,cache:a={},ignored:o=!1}){try{it("fs",e),it("gitdir",n),it("ref",r);const l=new xn(e);return await Gf({fs:l,cache:a,dir:t,gitdir:n,trees:[yl({ref:r}),t1(),ly()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await hy.isIgnored({fs:l,dir:t,filepath:c})||!i.some(T=>aY(c,T)))return null;if(s&&!s(c))return;const[p,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),x=[p,y,b].includes("blob");if((p==="tree"||p==="special")&&!x)return;if(p==="commit")return null;if((y==="tree"||y==="special")&&!x)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!x)return;const w=p==="blob"?await u.oid():void 0,_=b==="blob"?await h.oid():void 0;let S;p!=="blob"&&y==="blob"&&b!=="blob"?S="42":y==="blob"&&(S=await d.oid());const C=[void 0,w,S,_],E=C.map(T=>C.indexOf(T));return E.shift(),[c,...E]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function Hke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r,object:i,force:s=!1}){try{it("fs",e),it("gitdir",n),it("ref",r);const a=new xn(e);if(r===void 0)throw new fo("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Ht.resolve({fs:a,gitdir:n,ref:i||"HEAD"});if(!s&&await Ht.exists({fs:a,gitdir:n,ref:r}))throw new fc("tag",r);await Ht.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function Wke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),cache:r={},filepath:i,oid:s,mode:a,add:o,remove:l,force:c}){try{it("fs",e),it("gitdir",n),it("filepath",i);const u=new xn(e);if(l)return await $s.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const p=await u.lstat(Dt.join(t,i));if(p){if(p.isDirectory())throw new Wf("directory");return}}h.has({filepath:i})&&h.delete({filepath:i})});let d;if(!s){if(d=await u.lstat(Dt.join(t,i)),!d)throw new mi(`file at "${i}" on disk and "remove" not set`);if(d.isDirectory())throw new Wf("directory")}return await $s.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:i}))throw new mi(`file at "${i}" in index and "add" not set`);let p;if(s)p={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{p=d;const y=p.isSymbolicLink()?await u.readlink(Dt.join(t,i)):await u.read(Dt.join(t,i));s=await xo({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:i,oid:s,stats:p}),s})}catch(u){throw u.caller="git.updateIndex",u}}function Gke(){try{return AE.version}catch(e){throw e.caller="git.version",e}}async function Kke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),trees:r,map:i,reduce:s,iterate:a,cache:o={}}){try{return it("fs",e),it("gitdir",n),it("trees",r),await Gf({fs:new xn(e),cache:o,dir:t,gitdir:n,trees:r,map:i,reduce:s,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function Yke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),blob:r}){try{return it("fs",e),it("gitdir",n),it("blob",r),await xo({fs:new xn(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(i){throw i.caller="git.writeBlob",i}}async function Zke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),commit:r}){try{return it("fs",e),it("gitdir",n),it("commit",r),await kY({fs:new xn(e),gitdir:n,commit:r})}catch(i){throw i.caller="git.writeCommit",i}}async function Xke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),type:r,object:i,format:s="parsed",oid:a,encoding:o=void 0}){try{const l=new xn(e);if(s==="parsed"){switch(r){case"commit":i=Oi.from(i).toObject();break;case"tree":i=go.from(i).toObject();break;case"blob":i=sn.from(i,o);break;case"tag":i=Ba.from(i).toObject();break;default:throw new Ga(a||"",r,"blob|commit|tag|tree")}s="content"}return a=await xo({fs:l,gitdir:n,type:r,object:i,oid:a,format:s}),a}catch(l){throw l.caller="git.writeObject",l}}async function Jke({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),ref:r,value:i,force:s=!1,symbolic:a=!1}){try{it("fs",e),it("gitdir",n),it("ref",r),it("value",i);const o=new xn(e);if(r!==Vc.clean(r))throw new cc(r,Vc.clean(r));if(!s&&await Ht.exists({fs:o,gitdir:n,ref:r}))throw new fc("ref",r);a?await Ht.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:i}):(i=await Ht.resolve({fs:o,gitdir:n,ref:i}),await Ht.writeRef({fs:o,gitdir:n,ref:r,value:i}))}catch(o){throw o.caller="git.writeRef",o}}async function Qke({fs:e,gitdir:t,tag:n}){const r=Ba.from(n).toObject();return await xo({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function eEe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),tag:r}){try{return it("fs",e),it("gitdir",n),it("tag",r),await Qke({fs:new xn(e),gitdir:n,tag:r})}catch(i){throw i.caller="git.writeTag",i}}async function tEe({fs:e,dir:t,gitdir:n=Dt.join(t,".git"),tree:r}){try{return it("fs",e),it("gitdir",n),it("tree",r),await r1({fs:new xn(e),gitdir:n,tree:r})}catch(i){throw i.caller="git.writeTree",i}}var _s={Errors:R2e,STAGE:ly,TREE:yl,WORKDIR:t1,add:G2e,abortMerge:q2e,addNote:Y2e,addRemote:Z2e,annotatedTag:J2e,branch:eCe,checkout:oY,clone:fCe,commit:hCe,getConfig:OCe,getConfigAll:DCe,setConfig:Nke,currentBranch:pCe,deleteBranch:gCe,deleteRef:yCe,deleteRemote:vCe,deleteTag:wCe,expandOid:kCe,expandRef:ECe,fastForward:ICe,fetch:MCe,findMergeBase:NCe,findRoot:jCe,getRemoteInfo:FCe,getRemoteInfo2:LCe,hashBlob:$Ce,indexPack:UCe,init:qCe,isDescendent:VCe,isIgnored:HCe,listBranches:WCe,listFiles:KCe,listNotes:ZCe,listRefs:XCe,listRemotes:QCe,listServerRefs:nke,listTags:rke,log:oke,merge:lke,packObjects:dke,pull:fke,push:yke,readBlob:bke,readCommit:SY,readNote:xke,readObject:wke,readTag:Ske,readTree:Cke,remove:kke,removeNote:Tke,renameBranch:Rke,resetIndex:Ike,updateIndex:Wke,resolveRef:Mke,status:Uke,statusMatrix:Vke,tag:Hke,version:Gke,walk:Kke,writeBlob:Yke,writeCommit:Zke,writeObject:Xke,writeRef:Jke,writeTag:eEe,writeTree:tEe,stash:zke};function nEe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function rEe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:nEe(e)}async function iEe(e,t){const n=rEe(e);for(;;){const{value:r,done:i}=await n.next();if(r&&await t(r),i)break}n.return&&n.return()}async function sEe(e){let t=0;const n=[];await iEe(e,s=>{n.push(s),t+=s.byteLength});const r=new Uint8Array(t);let i=0;for(const s of n)r.set(s,i),i+=s.byteLength;return r}function aEe(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function oEe({onProgress:e,url:t,method:n="GET",headers:r={},body:i}){i&&(i=await sEe(i));const s=await fetch(t,{method:n,headers:r,body:i}),a=s.body&&s.body.getReader?aEe(s.body):[new Uint8Array(await s.arrayBuffer())];r={};for(const[o,l]of s.headers.entries())r[o]=l;return{url:s.url,method:s.method,statusCode:s.status,statusMessage:s.statusText,body:a,headers:r}}var Ix={request:oEe};const Mx="https://cors.isomorphic-git.org",E0=new Map,RY=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=dr.getState();if(!n||!r)return Fe.error("Git user name and email must be configured in Settings before committing."),!1;try{const i=await _s.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),s=await _s.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return i!==n&&await _s.setConfig({fs:t,dir:e,path:"user.name",value:n}),s!==r&&await _s.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(i){return console.error("[VFS Git Op] Error checking/setting Git config:",i),Fe.error(`Failed to configure Git user: ${i instanceof Error?i.message:String(i)}`),!1}},Nx=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=E0.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const i=window.prompt(`Enter username for ${e}`);if(!i)return Fe.error("Authentication cancelled: Username not provided."),null;const s=window.prompt(`Enter password or token for ${i}@${e}`);return s?(E0.set(n,{username:i,password:s}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:i,password:s,authScheme:"Basic"}):(Fe.error("Authentication cancelled: Password/token not provided."),null)},jx=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),E0.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),E0.delete(n)),null},Ox=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!E0.has(n)&&t.username&&t.password&&(E0.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},Ug=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let i="";if(r)try{const s=JSON.parse(r);i=s.message||s.error||JSON.stringify(s)}catch{i=r}return`HTTP ${t} ${n}${i?`: ${i}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},lEe=async(e,t)=>{const n=Ws,r=jr(e),i=iu(r,".git");try{return(await n.promises.stat(i)).isDirectory()}catch(s){return s instanceof Error&&s.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,s),!1}},IY=async(e,t,n,r,i)=>{var o;const s=(i==null?void 0:i.fsInstance)??Ws,a=jr(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await s.promises.stat(iu(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=SE(a);if(c!=="/")try{await s.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await _s.getRemoteInfo({http:Ix,url:t,corsProxy:Mx,onAuth:p=>Nx(p,r),onAuthFailure:jx,onAuthSuccess:Ox})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${Ug(h)}`)}await _s.clone({fs:s,http:Ix,dir:a,corsProxy:Mx,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>Nx(h,r),onAuthFailure:jx,onAuthSuccess:Ox,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await s.promises.stat(iu(a,".git"));const d=await _s.currentBranch({fs:s,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await _s.checkout({fs:s,dir:a,ref:u})),Fe.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=Ug(l);if(l instanceof Error&&l.message.includes("already cloned")||Fe.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await s.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},MY=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??Ws,r=jr(e);try{await _s.init({fs:n,dir:r}),Fe.success(`Initialized empty Git repository in "${ns(r)}"`)}catch(i){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,i),Fe.error(`Git init failed: ${i instanceof Error?i.message:String(i)}`),i}},mP=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??Ws,i=jr(e);try{if(!await RY(i,r))throw new Error("Git user configuration is missing or invalid.");if(await _s.add({fs:r,dir:i,filepath:"."}),!(await _s.statusMatrix({fs:r,dir:i})).some(([,,c])=>c!==0)){Fe.info("No changes detected to commit.");return}const l=await _s.commit({fs:r,dir:i,message:t,author:{name:dr.getState().gitUserName,email:dr.getState().gitUserEmail}});Fe.success(`Changes committed: ${l.substring(0,7)}`)}catch(s){throw console.error(`[VFS Git Op] Git commit failed for ${i}:`,s),Fe.error(`Git commit failed: ${s instanceof Error?s.message:String(s)}`),s}},RE=async(e,t,n,r)=>{const i=(r==null?void 0:r.fsInstance)??Ws,s=jr(e);try{if(!await RY(s,i))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${s}`);const o=await _s.currentBranch({fs:i,dir:s,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await _s.checkout({fs:i,dir:s,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await _s.fetch({fs:i,http:Ix,dir:s,corsProxy:Mx,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>Nx(c,n),onAuthFailure:jx,onAuthSuccess:Ox}),await _s.branch({fs:i,dir:s,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${Ug(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${Ug(l)}`)}}await _s.pull({fs:i,http:Ix,dir:s,ref:t,singleBranch:!0,author:{name:dr.getState().gitUserName,email:dr.getState().gitUserEmail},corsProxy:Mx,onAuth:l=>Nx(l,n),onAuthFailure:jx,onAuthSuccess:Ox}),Fe.success(`Pulled changes successfully for "${ns(s)}"`),console.log(`[VFS Git Op] Pull successful for ${s}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${s}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?Fe.info(`Branch "${t}" is already up-to-date.`):Fe.error(`Git pull failed: ${Ug(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},gP=async(e,t,n,r)=>{var a,o;const i=(r==null?void 0:r.fsInstance)??Ws,s=jr(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${s}`);const l=await _s.push({fs:i,http:Ix,dir:s,corsProxy:Mx,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>Nx(c,n),onAuthFailure:jx,onAuthSuccess:Ox});if(l!=null&&l.ok)Fe.success(`Pushed changes successfully for "${ns(s)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))Fe.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(Fe.error(`Push rejected for "${ns(s)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${s}:`,l),l instanceof Error&&l.message.includes("rejected")||Fe.error(`Git push failed: ${Ug(l)}`),l}},NY=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??Ws,r=jr(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const i=await _s.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",i);const s=i.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);Fe.info(`Git Status for "${ns(r)}":
${s||"No changes"}`,{duration:15e3})}catch(i){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,i),Fe.error(`Git status failed: ${i instanceof Error?i.message:String(i)}`),i}},Fp=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??Ws,r=jr(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(i){if(i instanceof Error&&i.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,i),Fe.error(`Error creating directory "${ns(r)}": ${i instanceof Error?i.message:String(i)}`),i}},cEe=async e=>{try{const t={backend:fSe,name:`litechat_vfs_${e}`};return await iSe(t),Ws}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),Fe.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},yP=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??Ws,r=jr(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Fp(r,{fsInstance:n}),[];throw l}const s=(await n.promises.readdir(r)).map(async l=>{const c=iu(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(s)).filter(l=>l!==null)}catch(i){throw console.error(`[VFS Op] Failed to list directory ${r}:`,i),Fe.error(`Error listing files: ${i instanceof Error?i.message:String(i)}`),i}},yh=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??Ws,r=jr(e);try{const i=await n.promises.readFile(r);return Be.emit(ln.fileRead,{path:r}),i}catch(i){throw console.error(`[VFS Op] Failed to read file ${r}:`,i),Fe.error(`Error reading file "${ns(r)}": ${i instanceof Error?i.message:String(i)}`),i}},IE=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??Ws,i=jr(e),s=SE(i);try{s!=="/"&&await Fp(s,{fsInstance:r}),await r.promises.writeFile(i,t),Be.emit(ln.fileWritten,{path:i})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${i}:`,a),Fe.error(`Error writing file "${ns(i)}": ${a instanceof Error?a.message:String(a)}`)),a}},bP=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??Ws,i=jr(e);if(i==="/")throw Fe.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(i)).isDirectory()?(await r.promises.rm(i,{recursive:t}),Be.emit(ln.fileDeleted,{path:i})):(await r.promises.unlink(i),Be.emit(ln.fileDeleted,{path:i})),Fe.success(`"${ns(i)}" deleted.`)}catch(s){if(s instanceof Error&&s.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${i}`);return}throw console.error(`[VFS Op] Failed to delete ${i}:`,s),Fe.error(`Error deleting "${ns(i)}": ${s instanceof Error?s.message:String(s)}`),s}},jY=async(e,t)=>{await Fp(e,t)},uEe=async(e,t,n)=>{try{const r=await yh(e,n),i=new Blob([r]),s=URL.createObjectURL(i),a=document.createElement("a");a.href=s;const o=jr(e);a.download=t||ns(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||Fe.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},OY=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??Ws,i=jr(t);let s=0,a=0;const o=Array.from(e);try{await Fp(i,{fsInstance:r});for(const l of o){const c=iu(i,l.name);try{const u=await l.arrayBuffer();await IE(c,new Uint8Array(u),{fsInstance:r}),s++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${i} for upload:`,l)}finally{a>0&&s>0?Fe.warning(`Upload complete with issues. ${s} succeeded, ${a} failed.`):a===0&&s>0&&Fe.success(`Successfully uploaded ${s} file(s) to ${i==="/"?"root":ns(i)}.`)}},dEe=async(e,t,n)=>{const r=Ws;if(!e.name.toLowerCase().endsWith(".zip")){Fe.error("Please select a valid ZIP file.");return}const i=jr(t);let s;try{await Fp(i,{fsInstance:r}),s=await aP.loadAsync(e);const a=Object.values(s.files),o=await Promise.allSettled(a.map(async d=>{const h=iu(i,d.name);if(d.dir)await Fp(h,{fsInstance:r});else{const p=await d.async("uint8array");await IE(h,p,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?Fe.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):Fe.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${i==="/"?"root":ns(i)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),Fe.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},x9=async(e,t="/",n)=>{const r=Ws,i=new aP,s=jr(t),a=ns(s)||"root";try{try{if(!(await r.promises.stat(s)).isDirectory()){Fe.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?Fe.error(`Cannot export: Path "${a}" not found.`):Fe.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,p)=>{const y=await yP(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const x=p.folder(b.name);if(x)await o(b.path,x);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const x=await yh(b.path,{fsInstance:r});p.file(b.name,x)}};await o(s,i);const l=await i.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),Fe.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||Fe.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},PY=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??Ws,i=jr(e),s=jr(t);if(i==="/"||s==="/")throw Fe.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(i!==s)try{const a=SE(s);a!=="/"&&await Fp(a,{fsInstance:r}),await r.promises.rename(i,s),Fe.success(`Renamed "${ns(i)}" to "${ns(s)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||Fe.error(`Rename failed: Original item "${ns(i)}" not found.`):a instanceof Error&&a.code==="EEXIST"?Fe.error(`Rename failed: An item named "${ns(s)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||Fe.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${i} to ${s}:`,a),a}},fEe=1024*5,hEe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const i=new Uint8Array(r),s=new Blob([i],{type:t});return URL.createObjectURL(s)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},w9=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);const i=new Uint8Array(r);t=new Blob([i],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},DY=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,i]=A.useState(null),[s,a]=A.useState(null),[o,l]=A.useState(!1),[c,u]=A.useState(!1),[d,h]=A.useState(!0),p=e.type||"application/octet-stream",y=tx(e.name,p),b=p.startsWith("image/"),x=p.startsWith("audio/"),w=p.startsWith("video/"),_=e.source==="vfs";A.useEffect(()=>{let N=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(N=hEe(e.contentBase64,p),N||a("Failed to decode file content for preview."),i(N)):i(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>fEe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{N&&(URL.revokeObjectURL(N),i(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,p,y]);const S=async()=>{if(e.source==="vfs"){Fe.info("File is already in VFS.");return}const N=w9(e);if(!N){Fe.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await OY([N],"/"),Fe.success(`"${e.name}" added to VFS root.`)}catch(O){console.error("Failed to add file to VFS:",O),Fe.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},C=async()=>{u(!0);try{let N;if(e.source==="vfs"&&e.path){const P=await yh(e.path);N=new Blob([P],{type:p})}else{const P=w9(e);if(!P)throw new Error("Could not reconstruct file data.");N=P}const O=URL.createObjectURL(N),B=document.createElement("a");B.href=O,B.download=e.name,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(O)}catch(N){console.error("Failed to download file:",N),Fe.error(`Download failed: ${N instanceof Error?N.message:String(N)}`)}finally{u(!1)}},E=()=>h(N=>!N),T=()=>_?m.jsx(eO,{className:"h-5 w-5 text-cyan-500"}):y?m.jsx(Yfe,{className:"h-5 w-5 text-blue-500"}):b?m.jsx(Tp,{className:"h-5 w-5 text-purple-500"}):x?m.jsx(Ohe,{className:"h-5 w-5 text-green-500"}):w?m.jsx(Tpe,{className:"h-5 w-5 text-orange-500"}):m.jsx(Gfe,{className:"h-5 w-5 text-muted-foreground"}),R=()=>_?m.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):s?m.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[m.jsx(nc,{className:"h-4 w-4"}),m.jsx("span",{children:s})]}):y&&e.contentText!==void 0?m.jsx(ty,{lang:p==="text/markdown"?"markdown":"text",code:e.contentText}):b&&r?m.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):x&&r?m.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):w&&r?m.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):m.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),M=A.useMemo(()=>{let N="File";return _?N="VFS File":y?N="Text":b?N="Image":x?N="Audio":w&&(N="Video"),`${N} (${Ex(e.size)})`},[_,y,b,x,w,e.size]);return m.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[m.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[m.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[T(),m.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),m.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",Ex(e.size),")"]}),_&&e.path&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),m.jsx(yr,{children:m.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:C,disabled:c,"aria-label":"Download file",children:c?m.jsx(Hn,{className:"h-3.5 w-3.5 animate-spin"}):m.jsx(Gc,{className:"h-3.5 w-3.5"})})}),m.jsx(yr,{children:"Download File"})]})}),m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:E,"aria-label":d?"Unfold preview":"Fold preview",children:m.jsx(Pk,{className:"h-3.5 w-3.5"})})}),m.jsx(yr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&m.jsxs(m.Fragment,{children:[e.source==="direct"&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?m.jsx(Hn,{className:"h-3.5 w-3.5 animate-spin"}):m.jsx(BV,{className:"h-3.5 w-3.5"})})}),m.jsx(yr,{children:"Add to VFS"})]})}),m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:m.jsx(po,{className:"h-3.5 w-3.5"})})}),m.jsx(yr,{children:"Remove from Prompt"})]})})]})]})]}),d?m.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:E,children:M}):m.jsx("div",{className:dt("p-2 max-h-80 overflow-y-auto"),children:R()})]})},FY=6048e5,pEe=864e5,dS=43200,_9=1440,S9=Symbol.for("constructDateFrom");function yd(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&S9 in e?e[S9](t):e instanceof Date?new e.constructor(t):new Date(t)}function qs(e,t){return yd(t||e,e)}let mEe={};function s1(){return mEe}function Px(e,t){var o,l,c,u;const n=s1(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,i=qs(e,t==null?void 0:t.in),s=i.getDay(),a=(s<r?7:0)+s-r;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function CC(e,t){return Px(e,{...t,weekStartsOn:1})}function LY(e,t){const n=qs(e,t==null?void 0:t.in),r=n.getFullYear(),i=yd(n,0);i.setFullYear(r+1,0,4),i.setHours(0,0,0,0);const s=CC(i),a=yd(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=CC(a);return n.getTime()>=s.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function kC(e){const t=qs(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function ME(e,...t){const n=yd.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function C9(e,t){const n=qs(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function gEe(e,t,n){const[r,i]=ME(n==null?void 0:n.in,e,t),s=C9(r),a=C9(i),o=+s-kC(s),l=+a-kC(a);return Math.round((o-l)/pEe)}function yEe(e,t){const n=LY(e,t),r=yd(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),CC(r)}function t2(e,t){const n=+qs(e)-+qs(t);return n<0?-1:n>0?1:n}function bEe(e){return yd(e,Date.now())}function vEe(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function xEe(e){return!(!vEe(e)&&typeof e!="number"||isNaN(+qs(e)))}function wEe(e,t,n){const[r,i]=ME(n==null?void 0:n.in,e,t),s=r.getFullYear()-i.getFullYear(),a=r.getMonth()-i.getMonth();return s*12+a}function _Ee(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function SEe(e,t){return+qs(e)-+qs(t)}function CEe(e,t){const n=qs(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function kEe(e,t){const n=qs(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function EEe(e,t){const n=qs(e,t==null?void 0:t.in);return+CEe(n,t)==+kEe(n,t)}function TEe(e,t,n){const[r,i,s]=ME(n==null?void 0:n.in,e,e,t),a=t2(i,s),o=Math.abs(wEe(i,s));if(o<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-a*o);let l=t2(i,s)===-a;EEe(r)&&o===1&&t2(r,s)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function AEe(e,t,n){const r=SEe(e,t)/1e3;return _Ee(n==null?void 0:n.roundingMethod)(r)}function REe(e,t){const n=qs(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const IEe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},MEe=(e,t,n)=>{let r;const i=IEe[e];return typeof i=="string"?r=i:t===1?r=i.one:r=i.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function FM(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const NEe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},jEe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},OEe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},PEe={date:FM({formats:NEe,defaultWidth:"full"}),time:FM({formats:jEe,defaultWidth:"full"}),dateTime:FM({formats:OEe,defaultWidth:"full"})},DEe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},FEe=(e,t,n,r)=>DEe[e];function Kb(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let i;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;i=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;i=e.values[o]||e.values[a]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const LEe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},BEe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},$Ee={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},zEe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},UEe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},qEe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},VEe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},HEe={ordinalNumber:VEe,era:Kb({values:LEe,defaultWidth:"wide"}),quarter:Kb({values:BEe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Kb({values:$Ee,defaultWidth:"wide"}),day:Kb({values:zEe,defaultWidth:"wide"}),dayPeriod:Kb({values:UEe,defaultWidth:"wide",formattingValues:qEe,defaultFormattingWidth:"wide"})};function Yb(e){return(t,n={})=>{const r=n.width,i=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const a=s[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?GEe(o,d=>d.test(a)):WEe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function WEe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function GEe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function KEe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const i=r[0],s=t.match(e.parsePattern);if(!s)return null;let a=e.valueCallback?e.valueCallback(s[0]):s[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(i.length);return{value:a,rest:o}}}const YEe=/^(\d+)(th|st|nd|rd)?/i,ZEe=/\d+/i,XEe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},JEe={any:[/^b/i,/^(a|c)/i]},QEe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},eTe={any:[/1/i,/2/i,/3/i,/4/i]},tTe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},nTe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},rTe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},iTe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},sTe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},aTe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},oTe={ordinalNumber:KEe({matchPattern:YEe,parsePattern:ZEe,valueCallback:e=>parseInt(e,10)}),era:Yb({matchPatterns:XEe,defaultMatchWidth:"wide",parsePatterns:JEe,defaultParseWidth:"any"}),quarter:Yb({matchPatterns:QEe,defaultMatchWidth:"wide",parsePatterns:eTe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Yb({matchPatterns:tTe,defaultMatchWidth:"wide",parsePatterns:nTe,defaultParseWidth:"any"}),day:Yb({matchPatterns:rTe,defaultMatchWidth:"wide",parsePatterns:iTe,defaultParseWidth:"any"}),dayPeriod:Yb({matchPatterns:sTe,defaultMatchWidth:"any",parsePatterns:aTe,defaultParseWidth:"any"})},BY={code:"en-US",formatDistance:MEe,formatLong:PEe,formatRelative:FEe,localize:HEe,match:oTe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function lTe(e,t){const n=qs(e,t==null?void 0:t.in);return gEe(n,REe(n))+1}function cTe(e,t){const n=qs(e,t==null?void 0:t.in),r=+CC(n)-+yEe(n);return Math.round(r/FY)+1}function $Y(e,t){var u,d,h,p;const n=qs(e,t==null?void 0:t.in),r=n.getFullYear(),i=s1(),s=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??i.firstWeekContainsDate??((p=(h=i.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??1,a=yd((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,s),a.setHours(0,0,0,0);const o=Px(a,t),l=yd((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,s),l.setHours(0,0,0,0);const c=Px(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function uTe(e,t){var o,l,c,u;const n=s1(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,i=$Y(e,t),s=yd((t==null?void 0:t.in)||e,0);return s.setFullYear(i,0,r),s.setHours(0,0,0,0),Px(s,t)}function dTe(e,t){const n=qs(e,t==null?void 0:t.in),r=+Px(n,t)-+uTe(n,t);return Math.round(r/FY)+1}function li(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const yf={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return li(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):li(n+1,2)},d(e,t){return li(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return li(e.getHours()%12||12,t.length)},H(e,t){return li(e.getHours(),t.length)},m(e,t){return li(e.getMinutes(),t.length)},s(e,t){return li(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),i=Math.trunc(r*Math.pow(10,n-3));return li(i,t.length)}},ug={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},k9={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),i=r>0?r:1-r;return n.ordinalNumber(i,{unit:"year"})}return yf.y(e,t)},Y:function(e,t,n,r){const i=$Y(e,r),s=i>0?i:1-i;if(t==="YY"){const a=s%100;return li(a,2)}return t==="Yo"?n.ordinalNumber(s,{unit:"year"}):li(s,t.length)},R:function(e,t){const n=LY(e);return li(n,t.length)},u:function(e,t){const n=e.getFullYear();return li(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return li(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return li(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return yf.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return li(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const i=dTe(e,r);return t==="wo"?n.ordinalNumber(i,{unit:"week"}):li(i,t.length)},I:function(e,t,n){const r=cTe(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):li(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):yf.d(e,t)},D:function(e,t,n){const r=lTe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):li(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const i=e.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return li(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(i,{width:"short",context:"formatting"});case"eeee":default:return n.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const i=e.getDay(),s=(i-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return li(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(i,{width:"narrow",context:"standalone"});case"cccccc":return n.day(i,{width:"short",context:"standalone"});case"cccc":default:return n.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),i=r===0?7:r;switch(t){case"i":return String(i);case"ii":return li(i,t.length);case"io":return n.ordinalNumber(i,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let i;switch(r===12?i=ug.noon:r===0?i=ug.midnight:i=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let i;switch(r>=17?i=ug.evening:r>=12?i=ug.afternoon:r>=4?i=ug.morning:i=ug.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return yf.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):yf.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):li(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):li(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):yf.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):yf.s(e,t)},S:function(e,t){return yf.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return T9(r);case"XXXX":case"XX":return tp(r);case"XXXXX":case"XXX":default:return tp(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return T9(r);case"xxxx":case"xx":return tp(r);case"xxxxx":case"xxx":default:return tp(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+E9(r,":");case"OOOO":default:return"GMT"+tp(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+E9(r,":");case"zzzz":default:return"GMT"+tp(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return li(r,t.length)},T:function(e,t,n){return li(+e,t.length)}};function E9(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=Math.trunc(r/60),s=r%60;return s===0?n+String(i):n+String(i)+t+li(s,2)}function T9(e,t){return e%60===0?(e>0?"-":"+")+li(Math.abs(e)/60,2):tp(e,t)}function tp(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),i=li(Math.trunc(r/60),2),s=li(r%60,2);return n+i+t+s}const A9=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},zY=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},fTe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],i=n[2];if(!i)return A9(e,t);let s;switch(r){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",A9(r,t)).replace("{{time}}",zY(i,t))},hTe={p:zY,P:fTe},pTe=/^D+$/,mTe=/^Y+$/,gTe=["D","DD","YY","YYYY"];function yTe(e){return pTe.test(e)}function bTe(e){return mTe.test(e)}function vTe(e,t,n){const r=xTe(e,t,n);if(console.warn(r),gTe.includes(e))throw new RangeError(r)}function xTe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const wTe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_Te=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,STe=/^'([^]*?)'?$/,CTe=/''/g,kTe=/[a-zA-Z]/;function ej(e,t,n){var u,d,h,p;const r=s1(),i=r.locale??BY,s=r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,a=r.weekStartsOn??((p=(h=r.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??0,o=qs(e,n==null?void 0:n.in);if(!xEe(o))throw new RangeError("Invalid time value");let l=t.match(_Te).map(y=>{const b=y[0];if(b==="p"||b==="P"){const x=hTe[b];return x(y,i.formatLong)}return y}).join("").match(wTe).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:ETe(y)};if(k9[b])return{isToken:!0,value:y};if(b.match(kTe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});i.localize.preprocessor&&(l=i.localize.preprocessor(o,l));const c={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return l.map(y=>{if(!y.isToken)return y.value;const b=y.value;(bTe(b)||yTe(b))&&vTe(b,t,String(e));const x=k9[b[0]];return x(o,b,i.localize,c)}).join("")}function ETe(e){const t=e.match(STe);return t?t[1].replace(CTe,"'"):e}function TTe(e,t,n){const r=s1(),i=(n==null?void 0:n.locale)??r.locale??BY,s=2520,a=t2(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=ME(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=AEe(c,l),d=(kC(c)-kC(l))/1e3,h=Math.round((u-d)/60);let p;if(h<2)return n!=null&&n.includeSeconds?u<5?i.formatDistance("lessThanXSeconds",5,o):u<10?i.formatDistance("lessThanXSeconds",10,o):u<20?i.formatDistance("lessThanXSeconds",20,o):u<40?i.formatDistance("halfAMinute",0,o):u<60?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",1,o):h===0?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",h,o);if(h<45)return i.formatDistance("xMinutes",h,o);if(h<90)return i.formatDistance("aboutXHours",1,o);if(h<_9){const y=Math.round(h/60);return i.formatDistance("aboutXHours",y,o)}else{if(h<s)return i.formatDistance("xDays",1,o);if(h<dS){const y=Math.round(h/_9);return i.formatDistance("xDays",y,o)}else if(h<dS*2)return p=Math.round(h/dS),i.formatDistance("aboutXMonths",p,o)}if(p=TEe(c,l),p<12){const y=Math.round(h/dS);return i.formatDistance("xMonths",y,o)}else{const y=p%12,b=Math.trunc(p/12);return y<3?i.formatDistance("aboutXYears",b,o):y<9?i.formatDistance("overXYears",b,o):i.formatDistance("almostXYears",b+1,o)}}function UY(e,t){return TTe(e,bEe(e),t)}const Rn=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:i,disabled:s,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:a,size:o,onClick:i,disabled:s,className:dt("h-6 w-6",l),"aria-label":c??e,...u,children:d?m.jsx(t,{className:dt("h-3.5 w-3.5",n)}):t})}),m.jsx(yr,{side:r,children:m.jsx("p",{children:e})})]})})},R9={};function ATe(e){let t=R9[e];if(t)return t;t=R9[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function T0(e,t){typeof t!="string"&&(t=T0.defaultChars);const n=ATe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let i="";for(let s=0,a=r.length;s<a;s+=3){const o=parseInt(r.slice(s+1,s+3),16);if(o<128){i+=n[o];continue}if((o&224)===192&&s+3<a){const l=parseInt(r.slice(s+4,s+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?i+="":i+=String.fromCharCode(c),s+=3;continue}}if((o&240)===224&&s+6<a){const l=parseInt(r.slice(s+4,s+6),16),c=parseInt(r.slice(s+7,s+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?i+="":i+=String.fromCharCode(u),s+=6;continue}}if((o&248)===240&&s+9<a){const l=parseInt(r.slice(s+4,s+6),16),c=parseInt(r.slice(s+7,s+9),16),u=parseInt(r.slice(s+10,s+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?i+="":(d-=65536,i+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),s+=9;continue}}i+=""}return i})}T0.defaultChars=";/?:@&=+$,#";T0.componentChars="";const I9={};function RTe(e){let t=I9[e];if(t)return t;t=I9[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function a1(e,t,n){typeof t!="string"&&(n=t,t=a1.defaultChars),typeof n>"u"&&(n=!0);const r=RTe(t);let i="";for(let s=0,a=e.length;s<a;s++){const o=e.charCodeAt(s);if(n&&o===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(s+1,s+3))){i+=e.slice(s,s+3),s+=2;continue}if(o<128){i+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&s+1<a){const l=e.charCodeAt(s+1);if(l>=56320&&l<=57343){i+=encodeURIComponent(e[s]+e[s+1]),s++;continue}}i+="%EF%BF%BD";continue}i+=encodeURIComponent(e[s])}return i}a1.defaultChars=";/?:@&=+$,-_.!~*'()#";a1.componentChars="-_.!~*'()";function vP(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function EC(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const ITe=/^([a-z0-9.+-]+:)/i,MTe=/:[0-9]*$/,NTe=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,jTe=["<",">",'"',"`"," ","\r",`
`,"	"],OTe=["{","}","|","\\","^","`"].concat(jTe),PTe=["'"].concat(OTe),M9=["%","/","?",";","#"].concat(PTe),N9=["/","?","#"],DTe=255,j9=/^[+a-z0-9A-Z_-]{0,63}$/,FTe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,O9={javascript:!0,"javascript:":!0},P9={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function xP(e,t){if(e&&e instanceof EC)return e;const n=new EC;return n.parse(e,t),n}EC.prototype.parse=function(e,t){let n,r,i,s=e;if(s=s.trim(),!t&&e.split("#").length===1){const c=NTe.exec(s);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=ITe.exec(s);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(t||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(i=s.substr(0,2)==="//",i&&!(a&&O9[a])&&(s=s.substr(2),this.slashes=!0)),!O9[a]&&(i||a&&!P9[a])){let c=-1;for(let y=0;y<N9.length;y++)r=s.indexOf(N9[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=s.lastIndexOf("@"):d=s.lastIndexOf("@",c),d!==-1&&(u=s.slice(0,d),s=s.slice(d+1),this.auth=u),c=-1;for(let y=0;y<M9.length;y++)r=s.indexOf(M9[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=s.length),s[c-1]===":"&&c--;const h=s.slice(0,c);s=s.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const p=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!p){const y=this.hostname.split(/\./);for(let b=0,x=y.length;b<x;b++){const w=y[b];if(w&&!w.match(j9)){let _="";for(let S=0,C=w.length;S<C;S++)w.charCodeAt(S)>127?_+="x":_+=w[S];if(!_.match(j9)){const S=y.slice(0,b),C=y.slice(b+1),E=w.match(FTe);E&&(S.push(E[1]),C.unshift(E[2])),C.length&&(s=C.join(".")+s),this.hostname=S.join(".");break}}}}this.hostname.length>DTe&&(this.hostname=""),p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=s.indexOf("#");o!==-1&&(this.hash=s.substr(o),s=s.slice(0,o));const l=s.indexOf("?");return l!==-1&&(this.search=s.substr(l),s=s.slice(0,l)),s&&(this.pathname=s),P9[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};EC.prototype.parseHost=function(e){let t=MTe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const LTe=Object.freeze(Object.defineProperty({__proto__:null,decode:T0,encode:a1,format:vP,parse:xP},Symbol.toStringTag,{value:"Module"})),qY=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,VY=/[\0-\x1F\x7F-\x9F]/,BTe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,wP=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,HY=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,WY=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,$Te=Object.freeze(Object.defineProperty({__proto__:null,Any:qY,Cc:VY,Cf:BTe,P:wP,S:HY,Z:WY},Symbol.toStringTag,{value:"Module"})),zTe=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),UTe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var LM;const qTe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),VTe=(LM=String.fromCodePoint)!==null&&LM!==void 0?LM:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function HTe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=qTe.get(e))!==null&&t!==void 0?t:e}var Ls;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(Ls||(Ls={}));const WTe=32;var Tf;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(Tf||(Tf={}));function tj(e){return e>=Ls.ZERO&&e<=Ls.NINE}function GTe(e){return e>=Ls.UPPER_A&&e<=Ls.UPPER_F||e>=Ls.LOWER_A&&e<=Ls.LOWER_F}function KTe(e){return e>=Ls.UPPER_A&&e<=Ls.UPPER_Z||e>=Ls.LOWER_A&&e<=Ls.LOWER_Z||tj(e)}function YTe(e){return e===Ls.EQUALS||KTe(e)}var Os;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(Os||(Os={}));var Cf;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(Cf||(Cf={}));class ZTe{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=Os.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Cf.Strict}startEntity(t){this.decodeMode=t,this.state=Os.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case Os.EntityStart:return t.charCodeAt(n)===Ls.NUM?(this.state=Os.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=Os.NamedEntity,this.stateNamedEntity(t,n));case Os.NumericStart:return this.stateNumericStart(t,n);case Os.NumericDecimal:return this.stateNumericDecimal(t,n);case Os.NumericHex:return this.stateNumericHex(t,n);case Os.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|WTe)===Ls.LOWER_X?(this.state=Os.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=Os.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,i){if(n!==r){const s=r-n;this.result=this.result*Math.pow(i,s)+parseInt(t.substr(n,s),i),this.consumed+=s}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const i=t.charCodeAt(n);if(tj(i)||GTe(i))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(i,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const i=t.charCodeAt(n);if(tj(i))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(i,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===Ls.SEMI)this.consumed+=1;else if(this.decodeMode===Cf.Strict)return 0;return this.emitCodePoint(HTe(this.result),this.consumed),this.errors&&(t!==Ls.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let i=r[this.treeIndex],s=(i&Tf.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=XTe(r,i,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===Cf.Attribute&&(s===0||YTe(a))?0:this.emitNotTerminatedNamedEntity();if(i=r[this.treeIndex],s=(i&Tf.VALUE_LENGTH)>>14,s!==0){if(a===Ls.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Cf.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,i=(r[n]&Tf.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,i,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:i}=this;return this.emitCodePoint(n===1?i[t]&~Tf.VALUE_LENGTH:i[t+1],r),n===3&&this.emitCodePoint(i[t+2],r),r}end(){var t;switch(this.state){case Os.NamedEntity:return this.result!==0&&(this.decodeMode!==Cf.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Os.NumericDecimal:return this.emitNumericEntity(0,2);case Os.NumericHex:return this.emitNumericEntity(0,3);case Os.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Os.EntityStart:return 0}}}function GY(e){let t="";const n=new ZTe(e,r=>t+=VTe(r));return function(i,s){let a=0,o=0;for(;(o=i.indexOf("&",o))>=0;){t+=i.slice(a,o),n.startEntity(s);const c=n.write(i,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+i.slice(a);return t="",l}}function XTe(e,t,n,r){const i=(t&Tf.BRANCH_LENGTH)>>7,s=t&Tf.JUMP_TABLE;if(i===0)return s!==0&&r===s?n:-1;if(s){const l=r-s;return l<0||l>=i?-1:e[n+l]-1}let a=n,o=a+i-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+i]}return-1}const JTe=GY(zTe);GY(UTe);function KY(e,t=Cf.Legacy){return JTe(e,t)}function QTe(e){return Object.prototype.toString.call(e)}function _P(e){return QTe(e)==="[object String]"}const eAe=Object.prototype.hasOwnProperty;function tAe(e,t){return eAe.call(e,t)}function NE(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function YY(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function SP(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function TC(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const ZY=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,nAe=/&([a-z#][a-z0-9]{1,31});/gi,rAe=new RegExp(ZY.source+"|"+nAe.source,"gi"),iAe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function sAe(e,t){if(t.charCodeAt(0)===35&&iAe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return SP(r)?TC(r):e}const n=KY(e);return n!==e?n:e}function aAe(e){return e.indexOf("\\")<0?e:e.replace(ZY,"$1")}function A0(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(rAe,function(t,n,r){return n||sAe(t,r)})}const oAe=/[&<>"]/,lAe=/[&<>"]/g,cAe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function uAe(e){return cAe[e]}function Yf(e){return oAe.test(e)?e.replace(lAe,uAe):e}const dAe=/[.?*+^$[\]\\(){}|-]/g;function fAe(e){return e.replace(dAe,"\\$&")}function Ci(e){switch(e){case 9:case 32:return!0}return!1}function Dx(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Fx(e){return wP.test(e)||HY.test(e)}function Lx(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function jE(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const hAe={mdurl:LTe,ucmicro:$Te},pAe=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:YY,assign:NE,escapeHtml:Yf,escapeRE:fAe,fromCodePoint:TC,has:tAe,isMdAsciiPunct:Lx,isPunctChar:Fx,isSpace:Ci,isString:_P,isValidEntityCode:SP,isWhiteSpace:Dx,lib:hAe,normalizeReference:jE,unescapeAll:A0,unescapeMd:aAe},Symbol.toStringTag,{value:"Module"}));function mAe(e,t,n){let r,i,s,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(s=e.src.charCodeAt(e.pos),s===93&&(r--,r===0)){i=!0;break}if(a=e.pos,e.md.inline.skipToken(e),s===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return i&&(c=e.pos),e.pos=l,c}function gAe(e,t,n){let r,i=t;const s={ok:!1,pos:0,str:""};if(e.charCodeAt(i)===60){for(i++;i<n;){if(r=e.charCodeAt(i),r===10||r===60)return s;if(r===62)return s.pos=i+1,s.str=A0(e.slice(t+1,i)),s.ok=!0,s;if(r===92&&i+1<n){i+=2;continue}i++}return s}let a=0;for(;i<n&&(r=e.charCodeAt(i),!(r===32||r<32||r===127));){if(r===92&&i+1<n){if(e.charCodeAt(i+1)===32)break;i+=2;continue}if(r===40&&(a++,a>32))return s;if(r===41){if(a===0)break;a--}i++}return t===i||a!==0||(s.str=A0(e.slice(t,i)),s.pos=i,s.ok=!0),s}function yAe(e,t,n,r){let i,s=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(s>=n)return a;let o=e.charCodeAt(s);if(o!==34&&o!==39&&o!==40)return a;t++,s++,o===40&&(o=41),a.marker=o}for(;s<n;){if(i=e.charCodeAt(s),i===a.marker)return a.pos=s+1,a.str+=A0(e.slice(t,s)),a.ok=!0,a;if(i===40&&a.marker===41)return a;i===92&&s+1<n&&s++,s++}return a.can_continue=!0,a.str+=A0(e.slice(t,s)),a}const bAe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:gAe,parseLinkLabel:mAe,parseLinkTitle:yAe},Symbol.toStringTag,{value:"Module"})),du={};du.code_inline=function(e,t,n,r,i){const s=e[t];return"<code"+i.renderAttrs(s)+">"+Yf(s.content)+"</code>"};du.code_block=function(e,t,n,r,i){const s=e[t];return"<pre"+i.renderAttrs(s)+"><code>"+Yf(e[t].content)+`</code></pre>
`};du.fence=function(e,t,n,r,i){const s=e[t],a=s.info?A0(s.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(s.content,o,l)||Yf(s.content):c=Yf(s.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=s.attrIndex("class"),d=s.attrs?s.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${i.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${i.renderAttrs(s)}>${c}</code></pre>
`};du.image=function(e,t,n,r,i){const s=e[t];return s.attrs[s.attrIndex("alt")][1]=i.renderInlineAsText(s.children,n,r),i.renderToken(e,t,n)};du.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};du.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};du.text=function(e,t){return Yf(e[t].content)};du.html_block=function(e,t){return e[t].content};du.html_inline=function(e,t){return e[t].content};function my(){this.rules=NE({},du)}my.prototype.renderAttrs=function(t){let n,r,i;if(!t.attrs)return"";for(i="",n=0,r=t.attrs.length;n<r;n++)i+=" "+Yf(t.attrs[n][0])+'="'+Yf(t.attrs[n][1])+'"';return i};my.prototype.renderToken=function(t,n,r){const i=t[n];let s="";if(i.hidden)return"";i.block&&i.nesting!==-1&&n&&t[n-1].hidden&&(s+=`
`),s+=(i.nesting===-1?"</":"<")+i.tag,s+=this.renderAttrs(i),i.nesting===0&&r.xhtmlOut&&(s+=" /");let a=!1;if(i.block&&(a=!0,i.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===i.tag)&&(a=!1)}return s+=a?`>
`:">",s};my.prototype.renderInline=function(e,t,n){let r="";const i=this.rules;for(let s=0,a=e.length;s<a;s++){const o=e[s].type;typeof i[o]<"u"?r+=i[o](e,s,t,n,this):r+=this.renderToken(e,s,t)}return r};my.prototype.renderInlineAsText=function(e,t,n){let r="";for(let i=0,s=e.length;i<s;i++)switch(e[i].type){case"text":r+=e[i].content;break;case"image":r+=this.renderInlineAsText(e[i].children,t,n);break;case"html_inline":case"html_block":r+=e[i].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};my.prototype.render=function(e,t,n){let r="";const i=this.rules;for(let s=0,a=e.length;s<a;s++){const o=e[s].type;o==="inline"?r+=this.renderInline(e[s].children,t,n):typeof i[o]<"u"?r+=i[o](e,s,t,n,this):r+=this.renderToken(e,s,t,n)}return r};function yo(){this.__rules__=[],this.__cache__=null}yo.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};yo.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};yo.prototype.at=function(e,t,n){const r=this.__find__(e),i=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=i.alt||[],this.__cache__=null};yo.prototype.before=function(e,t,n,r){const i=this.__find__(e),s=r||{};if(i===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i,0,{name:t,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null};yo.prototype.after=function(e,t,n,r){const i=this.__find__(e),s=r||{};if(i===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(i+1,0,{name:t,enabled:!0,fn:n,alt:s.alt||[]}),this.__cache__=null};yo.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};yo.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const i=this.__find__(r);if(i<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!0,n.push(r)},this),this.__cache__=null,n};yo.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};yo.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const i=this.__find__(r);if(i<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[i].enabled=!1,n.push(r)},this),this.__cache__=null,n};yo.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function hc(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}hc.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,i=n.length;r<i;r++)if(n[r][0]===t)return r;return-1};hc.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};hc.prototype.attrSet=function(t,n){const r=this.attrIndex(t),i=[t,n];r<0?this.attrPush(i):this.attrs[r]=i};hc.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};hc.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function XY(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}XY.prototype.Token=hc;const vAe=/\r\n?|\n/g,xAe=/\0/g;function wAe(e){let t;t=e.src.replace(vAe,`
`),t=t.replace(xAe,""),e.src=t}function _Ae(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function SAe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const i=t[n];i.type==="inline"&&e.md.inline.parse(i.content,e.md,e.env,i.children)}}function CAe(e){return/^<a[>\s]/i.test(e)}function kAe(e){return/^<\/a\s*>/i.test(e)}function EAe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let i=t[n].children,s=0;for(let a=i.length-1;a>=0;a--){const o=i[a];if(o.type==="link_close"){for(a--;i[a].level!==o.level&&i[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(CAe(o.content)&&s>0&&s--,kAe(o.content)&&s++),!(s>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&i[a-1].type==="text_special"&&(c=c.slice(1));for(let p=0;p<c.length;p++){const y=c[p].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let x=c[p].text;c[p].schema?c[p].schema==="mailto:"&&!/^mailto:/i.test(x)?x=e.md.normalizeLinkText("mailto:"+x).replace(/^mailto:/,""):x=e.md.normalizeLinkText(x):x=e.md.normalizeLinkText("http://"+x).replace(/^http:\/\//,"");const w=c[p].index;if(w>h){const E=new e.Token("text","",0);E.content=l.slice(h,w),E.level=d,u.push(E)}const _=new e.Token("link_open","a",1);_.attrs=[["href",b]],_.level=d++,_.markup="linkify",_.info="auto",u.push(_);const S=new e.Token("text","",0);S.content=x,S.level=d,u.push(S);const C=new e.Token("link_close","a",-1);C.level=--d,C.markup="linkify",C.info="auto",u.push(C),h=c[p].lastIndex}if(h<l.length){const p=new e.Token("text","",0);p.content=l.slice(h),p.level=d,u.push(p)}t[n].children=i=YY(i,a,u)}}}}const JY=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,TAe=/\((c|tm|r)\)/i,AAe=/\((c|tm|r)\)/ig,RAe={c:"",r:"",tm:""};function IAe(e,t){return RAe[t.toLowerCase()]}function MAe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(AAe,IAe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function NAe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&JY.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function jAe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(TAe.test(e.tokens[t].content)&&MAe(e.tokens[t].children),JY.test(e.tokens[t].content)&&NAe(e.tokens[t].children))}const OAe=/['"]/,D9=/['"]/g,F9="";function fS(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function PAe(e,t){let n;const r=[];for(let i=0;i<e.length;i++){const s=e[i],a=e[i].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,s.type!=="text")continue;let o=s.content,l=0,c=o.length;e:for(;l<c;){D9.lastIndex=l;const u=D9.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const p=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=i-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=i+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const x=Lx(y)||Fx(String.fromCharCode(y)),w=Lx(b)||Fx(String.fromCharCode(b)),_=Dx(y),S=Dx(b);if(S?d=!1:w&&(_||x||(d=!1)),_?h=!1:x&&(S||w||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=x,h=w),!d&&!h){p&&(s.content=fS(s.content,u.index,F9));continue}if(h)for(n=r.length-1;n>=0;n--){let C=r[n];if(r[n].level<a)break;if(C.single===p&&r[n].level===a){C=r[n];let E,T;p?(E=t.md.options.quotes[2],T=t.md.options.quotes[3]):(E=t.md.options.quotes[0],T=t.md.options.quotes[1]),s.content=fS(s.content,u.index,T),e[C.token].content=fS(e[C.token].content,C.pos,E),l+=T.length-1,C.token===i&&(l+=E.length-1),o=s.content,c=o.length,r.length=n;continue e}}d?r.push({token:i,pos:u.index,single:p,level:a}):h&&p&&(s.content=fS(s.content,u.index,F9))}}}function DAe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!OAe.test(e.tokens[t].content)||PAe(e.tokens[t].children,e)}function FAe(e){let t,n;const r=e.tokens,i=r.length;for(let s=0;s<i;s++){if(r[s].type!=="inline")continue;const a=r[s].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const BM=[["normalize",wAe],["block",_Ae],["inline",SAe],["linkify",EAe],["replacements",jAe],["smartquotes",DAe],["text_join",FAe]];function CP(){this.ruler=new yo;for(let e=0;e<BM.length;e++)this.ruler.push(BM[e][0],BM[e][1])}CP.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};CP.prototype.State=XY;function fu(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const i=this.src;for(let s=0,a=0,o=0,l=0,c=i.length,u=!1;a<c;a++){const d=i.charCodeAt(a);if(!u)if(Ci(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,s=a+1)}this.bMarks.push(i.length),this.eMarks.push(i.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}fu.prototype.push=function(e,t,n){const r=new hc(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};fu.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};fu.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};fu.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Ci(r))break}return t};fu.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Ci(this.src.charCodeAt(--t)))return t+1;return t};fu.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};fu.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};fu.prototype.getLines=function(t,n,r,i){if(t>=n)return"";const s=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||i?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Ci(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?s[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):s[a]=this.src.slice(u,d)}return s.join("")};fu.prototype.Token=hc;const LAe=65536;function $M(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function L9(e){const t=[],n=e.length;let r=0,i=e.charCodeAt(r),s=!1,a=0,o="";for(;r<n;)i===124&&(s?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),s=i===92,r++,i=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function BAe(e,t,n,r){if(t+2>n)return!1;let i=t+1;if(e.sCount[i]<e.blkIndent||e.sCount[i]-e.blkIndent>=4)return!1;let s=e.bMarks[i]+e.tShift[i];if(s>=e.eMarks[i])return!1;const a=e.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=e.eMarks[i])return!1;const o=e.src.charCodeAt(s++);if(o!==124&&o!==45&&o!==58&&!Ci(o)||a===45&&Ci(o))return!1;for(;s<e.eMarks[i];){const C=e.src.charCodeAt(s);if(C!==124&&C!==45&&C!==58&&!Ci(C))return!1;s++}let l=$M(e,t+1),c=l.split("|");const u=[];for(let C=0;C<c.length;C++){const E=c[C].trim();if(!E){if(C===0||C===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(E))return!1;E.charCodeAt(E.length-1)===58?u.push(E.charCodeAt(0)===58?"center":"right"):E.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=$M(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=L9(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const p=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const x=e.push("thead_open","thead",1);x.map=[t,t+1];const w=e.push("tr_open","tr",1);w.map=[t,t+1];for(let C=0;C<c.length;C++){const E=e.push("th_open","th",1);u[C]&&(E.attrs=[["style","text-align:"+u[C]]]);const T=e.push("inline","",0);T.content=c[C].trim(),T.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let _,S=0;for(i=t+2;i<n&&!(e.sCount[i]<e.blkIndent);i++){let C=!1;for(let T=0,R=p.length;T<R;T++)if(p[T](e,i,n,!0)){C=!0;break}if(C||(l=$M(e,i).trim(),!l)||e.sCount[i]-e.blkIndent>=4||(c=L9(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>LAe))break;if(i===t+2){const T=e.push("tbody_open","tbody",1);T.map=_=[t+2,0]}const E=e.push("tr_open","tr",1);E.map=[i,i+1];for(let T=0;T<d;T++){const R=e.push("td_open","td",1);u[T]&&(R.attrs=[["style","text-align:"+u[T]]]);const M=e.push("inline","",0);M.content=c[T]?c[T].trim():"",M.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return _&&(e.push("tbody_close","tbody",-1),_[1]=i),e.push("table_close","table",-1),b[1]=i,e.parentType=h,e.line=i,!0}function $Ae(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,i=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,i=r;continue}break}e.line=i;const s=e.push("code_block","code",0);return s.content=e.getLines(t,i,4+e.blkIndent,!1)+`
`,s.map=[t,e.line],!0}function zAe(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||i+3>s)return!1;const a=e.src.charCodeAt(i);if(a!==126&&a!==96)return!1;let o=i;i=e.skipChars(i,a);let l=i-o;if(l<3)return!1;const c=e.src.slice(o,i),u=e.src.slice(i,s);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(i=o=e.bMarks[d]+e.tShift[d],s=e.eMarks[d],i<s&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(i)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(i=e.skipChars(i,a),!(i-o<l)&&(i=e.skipSpaces(i),!(i<s)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const p=e.push("fence","code",0);return p.info=u,p.content=e.getLines(t+1,d,l,!0),p.markup=c,p.map=[t,e.line],!0}function UAe(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(i)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let p=!1,y;for(y=t;y<n;y++){const S=e.sCount[y]<e.blkIndent;if(i=e.bMarks[y]+e.tShift[y],s=e.eMarks[y],i>=s)break;if(e.src.charCodeAt(i++)===62&&!S){let E=e.sCount[y]+1,T,R;e.src.charCodeAt(i)===32?(i++,E++,R=!1,T=!0):e.src.charCodeAt(i)===9?(T=!0,(e.bsCount[y]+E)%4===3?(i++,E++,R=!1):R=!0):T=!1;let M=E;for(o.push(e.bMarks[y]),e.bMarks[y]=i;i<s;){const N=e.src.charCodeAt(i);if(Ci(N))N===9?M+=4-(M+e.bsCount[y]+(R?1:0))%4:M++;else break;i++}p=i>=s,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(T?1:0),c.push(e.sCount[y]),e.sCount[y]=M-E,u.push(e.tShift[y]),e.tShift[y]=i-e.bMarks[y];continue}if(p)break;let C=!1;for(let E=0,T=d.length;E<T;E++)if(d[E](e,y,n,!0)){C=!0;break}if(C){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const x=e.push("blockquote_open","blockquote",1);x.markup=">";const w=[t,0];x.map=w,e.md.block.tokenize(e,t,y);const _=e.push("blockquote_close","blockquote",-1);_.markup=">",e.lineMax=a,e.parentType=h,w[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=b,!0}function qAe(e,t,n,r){const i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let s=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;s<i;){const c=e.src.charCodeAt(s++);if(c!==a&&!Ci(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function B9(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const i=e.src.charCodeAt(r++);if(i!==42&&i!==45&&i!==43)return-1;if(r<n){const s=e.src.charCodeAt(r);if(!Ci(s))return-1}return r}function $9(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let i=n;if(i+1>=r)return-1;let s=e.src.charCodeAt(i++);if(s<48||s>57)return-1;for(;;){if(i>=r)return-1;if(s=e.src.charCodeAt(i++),s>=48&&s<=57){if(i-n>=10)return-1;continue}if(s===41||s===46)break;return-1}return i<r&&(s=e.src.charCodeAt(i),!Ci(s))?-1:i}function VAe(e,t){const n=e.level+2;for(let r=t+2,i=e.tokens.length-2;r<i;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function HAe(e,t,n,r){let i,s,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,p;if((p=$9(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,p-1)),u&&h!==1)return!1}else if((p=B9(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(p)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(p-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const x=[l,0];o.map=x,o.markup=String.fromCharCode(y);let w=!1;const _=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){s=p,i=e.eMarks[l];const C=e.sCount[l]+p-(e.bMarks[l]+e.tShift[l]);let E=C;for(;s<i;){const Q=e.src.charCodeAt(s);if(Q===9)E+=4-(E+e.bsCount[l])%4;else if(Q===32)E++;else break;s++}const T=s;let R;T>=i?R=1:R=E-C,R>4&&(R=1);const M=C+R;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const N=[l,0];o.map=N,d&&(o.info=e.src.slice(a,p-1));const O=e.tight,B=e.tShift[l],P=e.sCount[l],H=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=M,e.tight=!0,e.tShift[l]=T-e.bMarks[l],e.sCount[l]=E,T>=i&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||w)&&(c=!1),w=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=H,e.tShift[l]=B,e.sCount[l]=P,e.tight=O,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,N[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let F=!1;for(let Q=0,q=_.length;Q<q;Q++)if(_[Q](e,l,n,!0)){F=!0;break}if(F)break;if(d){if(p=$9(e,l),p<0)break;a=e.bMarks[l]+e.tShift[l]}else if(p=B9(e,l),p<0)break;if(y!==e.src.charCodeAt(p-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),x[1]=l,e.line=l,e.parentType=S,c&&VAe(e,b),!0}function WAe(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],s=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(i)!==91)return!1;function o(_){const S=e.lineMax;if(_>=S||e.isEmpty(_))return null;let C=!1;if(e.sCount[_]-e.blkIndent>3&&(C=!0),e.sCount[_]<0&&(C=!0),!C){const R=e.md.block.ruler.getRules("reference"),M=e.parentType;e.parentType="reference";let N=!1;for(let O=0,B=R.length;O<B;O++)if(R[O](e,_,S,!0)){N=!0;break}if(e.parentType=M,N)return null}const E=e.bMarks[_]+e.tShift[_],T=e.eMarks[_];return e.src.slice(E,T+1)}let l=e.src.slice(i,s+1);s=l.length;let c=-1;for(i=1;i<s;i++){const _=l.charCodeAt(i);if(_===91)return!1;if(_===93){c=i;break}else if(_===10){const S=o(a);S!==null&&(l+=S,s=l.length,a++)}else if(_===92&&(i++,i<s&&l.charCodeAt(i)===10)){const S=o(a);S!==null&&(l+=S,s=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(i=c+2;i<s;i++){const _=l.charCodeAt(i);if(_===10){const S=o(a);S!==null&&(l+=S,s=l.length,a++)}else if(!Ci(_))break}const u=e.md.helpers.parseLinkDestination(l,i,s);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;i=u.pos;const h=i,p=a,y=i;for(;i<s;i++){const _=l.charCodeAt(i);if(_===10){const S=o(a);S!==null&&(l+=S,s=l.length,a++)}else if(!Ci(_))break}let b=e.md.helpers.parseLinkTitle(l,i,s);for(;b.can_continue;){const _=o(a);if(_===null)break;l+=_,i=s,s=l.length,a++,b=e.md.helpers.parseLinkTitle(l,i,s,b)}let x;for(i<s&&y!==i&&b.ok?(x=b.str,i=b.pos):(x="",i=h,a=p);i<s;){const _=l.charCodeAt(i);if(!Ci(_))break;i++}if(i<s&&l.charCodeAt(i)!==10&&x)for(x="",i=h,a=p;i<s;){const _=l.charCodeAt(i);if(!Ci(_))break;i++}if(i<s&&l.charCodeAt(i)!==10)return!1;const w=jE(l.slice(1,c));return w?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[w]>"u"&&(e.env.references[w]={title:x,href:d}),e.line=a),!0):!1}const GAe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],KAe="[a-zA-Z_:][a-zA-Z0-9:._-]*",YAe="[^\"'=<>`\\x00-\\x20]+",ZAe="'[^']*'",XAe='"[^"]*"',JAe="(?:"+YAe+"|"+ZAe+"|"+XAe+")",QAe="(?:\\s+"+KAe+"(?:\\s*=\\s*"+JAe+")?)",QY="<[A-Za-z][A-Za-z0-9\\-]*"+QAe+"*\\s*\\/?>",eZ="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",eRe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",tRe="<[?][\\s\\S]*?[?]>",nRe="<![A-Za-z][^>]*>",rRe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",iRe=new RegExp("^(?:"+QY+"|"+eZ+"|"+eRe+"|"+tRe+"|"+nRe+"|"+rRe+")"),sRe=new RegExp("^(?:"+QY+"|"+eZ+")"),dg=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+GAe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(sRe.source+"\\s*$"),/^$/,!1]];function aRe(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(i)!==60)return!1;let a=e.src.slice(i,s),o=0;for(;o<dg.length&&!dg[o][0].test(a);o++);if(o===dg.length)return!1;if(r)return dg[o][2];let l=t+1;if(!dg[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(i=e.bMarks[l]+e.tShift[l],s=e.eMarks[l],a=e.src.slice(i,s),dg[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function oRe(e,t,n,r){let i=e.bMarks[t]+e.tShift[t],s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(i);if(a!==35||i>=s)return!1;let o=1;for(a=e.src.charCodeAt(++i);a===35&&i<s&&o<=6;)o++,a=e.src.charCodeAt(++i);if(o>6||i<s&&!Ci(a))return!1;if(r)return!0;s=e.skipSpacesBack(s,i);const l=e.skipCharsBack(s,35,i);l>i&&Ci(e.src.charCodeAt(l-1))&&(s=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(i,s).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function lRe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const i=e.parentType;e.parentType="paragraph";let s=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let p=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(p<y&&(a=e.src.charCodeAt(p),(a===45||a===61)&&(p=e.skipChars(p,a),p=e.skipSpaces(p),p>=y))){s=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let p=0,y=r.length;p<y;p++)if(r[p](e,o,n,!0)){h=!0;break}if(h)break}if(!s)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(s),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(s),-1);return d.markup=String.fromCharCode(a),e.parentType=i,!0}function cRe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),i=e.parentType;let s=t+1;for(e.parentType="paragraph";s<n&&!e.isEmpty(s);s++){if(e.sCount[s]-e.blkIndent>3||e.sCount[s]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,s,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,s,e.blkIndent,!1).trim();e.line=s;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=i,!0}const hS=[["table",BAe,["paragraph","reference"]],["code",$Ae],["fence",zAe,["paragraph","reference","blockquote","list"]],["blockquote",UAe,["paragraph","reference","blockquote","list"]],["hr",qAe,["paragraph","reference","blockquote","list"]],["list",HAe,["paragraph","reference","blockquote"]],["reference",WAe],["html_block",aRe,["paragraph","reference","blockquote"]],["heading",oRe,["paragraph","reference","blockquote"]],["lheading",lRe],["paragraph",cRe]];function OE(){this.ruler=new yo;for(let e=0;e<hS.length;e++)this.ruler.push(hS[e][0],hS[e][1],{alt:(hS[e][2]||[]).slice()})}OE.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),i=r.length,s=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=s){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<i;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};OE.prototype.parse=function(e,t,n,r){if(!e)return;const i=new this.State(e,t,n,r);this.tokenize(i,i.line,i.lineMax)};OE.prototype.State=fu;function o1(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}o1.prototype.pushPending=function(){const e=new hc("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};o1.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new hc(e,t,n);let i=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],i={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(i),r};o1.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),i=e>0?this.src.charCodeAt(e-1):32;let s=e;for(;s<n&&this.src.charCodeAt(s)===r;)s++;const a=s-e,o=s<n?this.src.charCodeAt(s):32,l=Lx(i)||Fx(String.fromCharCode(i)),c=Lx(o)||Fx(String.fromCharCode(o)),u=Dx(i),d=Dx(o),h=!d&&(!c||u||l),p=!u&&(!l||d||c);return{can_open:h&&(t||!p||l),can_close:p&&(t||!h||c),length:a}};o1.prototype.Token=hc;function uRe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function dRe(e,t){let n=e.pos;for(;n<e.posMax&&!uRe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const fRe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function hRe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const i=e.pending.match(fRe);if(!i)return!1;const s=i[1],a=e.md.linkify.matchAtStart(e.src.slice(n-s.length));if(!a)return!1;let o=a.url;if(o.length<=s.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-s.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-s.length,!0}function pRe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,i=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let s=r-1;for(;s>=1&&e.pending.charCodeAt(s-1)===32;)s--;e.pending=e.pending.slice(0,s),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<i&&Ci(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const kP=[];for(let e=0;e<256;e++)kP.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){kP[e.charCodeAt(0)]=1});function mRe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let i=e.src.charCodeAt(n);if(i===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(i=e.src.charCodeAt(n),!!Ci(i));)n++;return e.pos=n,!0}let s=e.src[n];if(i>=55296&&i<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(s+=e.src[n+1],n++)}const a="\\"+s;if(!t){const o=e.push("text_special","",0);i<256&&kP[i]!==0?o.content=s:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function gRe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const i=n;n++;const s=e.posMax;for(;n<s&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(i,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=i)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<s&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function yRe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const i=e.scanDelims(e.pos,!0);let s=i.length;const a=String.fromCharCode(r);if(s<2)return!1;let o;s%2&&(o=e.push("text","",0),o.content=a,s--);for(let l=0;l<s;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close});return e.pos+=i.length,!0}function z9(e,t){let n;const r=[],i=t.length;for(let s=0;s<i;s++){const a=t[s];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const s=r.pop();let a=s+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,s!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[s],e.tokens[s]=n)}}function bRe(e){const t=e.tokens_meta,n=e.tokens_meta.length;z9(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&z9(e,t[r].delimiters)}const tZ={tokenize:yRe,postProcess:bRe};function vRe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const i=e.scanDelims(e.pos,r===42);for(let s=0;s<i.length;s++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:i.length,token:e.tokens.length-1,end:-1,open:i.can_open,close:i.can_close})}return e.pos+=i.length,!0}function U9(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const i=t[r];if(i.marker!==95&&i.marker!==42||i.end===-1)continue;const s=t[i.end],a=r>0&&t[r-1].end===i.end+1&&t[r-1].marker===i.marker&&t[r-1].token===i.token-1&&t[i.end+1].token===s.token+1,o=String.fromCharCode(i.marker),l=e.tokens[i.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[s.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[i.end+1].token].content="",r--)}}function xRe(e){const t=e.tokens_meta,n=e.tokens_meta.length;U9(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&U9(e,t[r].delimiters)}const nZ={tokenize:vRe,postProcess:xRe};function wRe(e,t){let n,r,i,s,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,p=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(p<0)return!1;let y=p+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Ci(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,i=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),i.ok){for(a=e.md.normalizeLink(i.str),e.md.validateLink(a)?y=i.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Ci(n)&&n!==10));y++);if(i=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&i.ok)for(o=i.str,y=i.pos;y<d&&(n=e.src.charCodeAt(y),!(!Ci(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=p+1):y=p+1,r||(r=e.src.slice(h,p)),s=e.env.references[jE(r)],!s)return e.pos=u,!1;a=s.href,o=s.title}if(!t){e.pos=h,e.posMax=p;const b=e.push("link_open","a",1),x=[["href",a]];b.attrs=x,o&&x.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function _Re(e,t){let n,r,i,s,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const p=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(s=y+1,s<h&&e.src.charCodeAt(s)===40){for(s++;s<h&&(n=e.src.charCodeAt(s),!(!Ci(n)&&n!==10));s++);if(s>=h)return!1;for(c=s,o=e.md.helpers.parseLinkDestination(e.src,s,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?s=o.pos:u=""),c=s;s<h&&(n=e.src.charCodeAt(s),!(!Ci(n)&&n!==10));s++);if(o=e.md.helpers.parseLinkTitle(e.src,s,e.posMax),s<h&&c!==s&&o.ok)for(l=o.str,s=o.pos;s<h&&(n=e.src.charCodeAt(s),!(!Ci(n)&&n!==10));s++);else l="";if(s>=h||e.src.charCodeAt(s)!==41)return e.pos=d,!1;s++}else{if(typeof e.env.references>"u")return!1;if(s<h&&e.src.charCodeAt(s)===91?(c=s+1,s=e.md.helpers.parseLinkLabel(e,s),s>=0?i=e.src.slice(c,s++):s=y+1):s=y+1,i||(i=e.src.slice(p,y)),a=e.env.references[jE(i)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(p,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const x=e.push("image","img",0),w=[["src",u],["alt",""]];x.attrs=w,x.children=b,x.content=r,l&&w.push(["title",l])}return e.pos=s,e.posMax=h,!0}const SRe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,CRe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function kRe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,i=e.posMax;for(;;){if(++n>=i)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const s=e.src.slice(r+1,n);if(CRe.test(s)){const a=e.md.normalizeLink(s);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(s);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=s.length+2,!0}if(SRe.test(s)){const a=e.md.normalizeLink("mailto:"+s);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(s);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=s.length+2,!0}return!1}function ERe(e){return/^<a[>\s]/i.test(e)}function TRe(e){return/^<\/a\s*>/i.test(e)}function ARe(e){const t=e|32;return t>=97&&t<=122}function RRe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const i=e.src.charCodeAt(r+1);if(i!==33&&i!==63&&i!==47&&!ARe(i))return!1;const s=e.src.slice(r).match(iRe);if(!s)return!1;if(!t){const a=e.push("html_inline","",0);a.content=s[0],ERe(a.content)&&e.linkLevel++,TRe(a.content)&&e.linkLevel--}return e.pos+=s[0].length,!0}const IRe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,MRe=/^&([a-z][a-z0-9]{1,31});/i;function NRe(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const s=e.src.slice(n).match(IRe);if(s){if(!t){const a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),o=e.push("text_special","",0);o.content=SP(a)?TC(a):TC(65533),o.markup=s[0],o.info="entity"}return e.pos+=s[0].length,!0}}else{const s=e.src.slice(n).match(MRe);if(s){const a=KY(s[0]);if(a!==s[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=s[0],o.info="entity"}return e.pos+=s[0].length,!0}}}return!1}function q9(e){const t={},n=e.length;if(!n)return;let r=0,i=-2;const s=[];for(let a=0;a<n;a++){const o=e[a];if(s.push(0),(e[r].marker!==o.marker||i!==o.token-1)&&(r=a),i=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-s[r]-1,u=c;for(;c>l;c-=s[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const p=c>0&&!e[c-1].open?s[c-1]+1:0;s[a]=a-c+p,s[c]=p,o.open=!1,d.end=a,d.close=!1,u=-1,i=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function jRe(e){const t=e.tokens_meta,n=e.tokens_meta.length;q9(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&q9(t[r].delimiters)}function ORe(e){let t,n,r=0;const i=e.tokens,s=e.tokens.length;for(t=n=0;t<s;t++)i[t].nesting<0&&r--,i[t].level=r,i[t].nesting>0&&r++,i[t].type==="text"&&t+1<s&&i[t+1].type==="text"?i[t+1].content=i[t].content+i[t+1].content:(t!==n&&(i[n]=i[t]),n++);t!==n&&(i.length=n)}const zM=[["text",dRe],["linkify",hRe],["newline",pRe],["escape",mRe],["backticks",gRe],["strikethrough",tZ.tokenize],["emphasis",nZ.tokenize],["link",wRe],["image",_Re],["autolink",kRe],["html_inline",RRe],["entity",NRe]],UM=[["balance_pairs",jRe],["strikethrough",tZ.postProcess],["emphasis",nZ.postProcess],["fragments_join",ORe]];function l1(){this.ruler=new yo;for(let e=0;e<zM.length;e++)this.ruler.push(zM[e][0],zM[e][1]);this.ruler2=new yo;for(let e=0;e<UM.length;e++)this.ruler2.push(UM[e][0],UM[e][1])}l1.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,i=e.md.options.maxNesting,s=e.cache;if(typeof s[t]<"u"){e.pos=s[t];return}let a=!1;if(e.level<i){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,s[t]=e.pos};l1.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,i=e.md.options.maxNesting;for(;e.pos<r;){const s=e.pos;let a=!1;if(e.level<i){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(s>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};l1.prototype.parse=function(e,t,n,r){const i=new this.State(e,t,n,r);this.tokenize(i);const s=this.ruler2.getRules(""),a=s.length;for(let o=0;o<a;o++)s[o](i)};l1.prototype.State=o1;function PRe(e){const t={};e=e||{},t.src_Any=qY.source,t.src_Cc=VY.source,t.src_Z=WY.source,t.src_P=wP.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function nj(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function PE(e){return Object.prototype.toString.call(e)}function DRe(e){return PE(e)==="[object String]"}function FRe(e){return PE(e)==="[object Object]"}function LRe(e){return PE(e)==="[object RegExp]"}function V9(e){return PE(e)==="[object Function]"}function BRe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const rZ={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function $Re(e){return Object.keys(e||{}).reduce(function(t,n){return t||rZ.hasOwnProperty(n)},!1)}const zRe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},URe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",qRe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function VRe(e){e.__index__=-1,e.__text_cache__=""}function HRe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function H9(){return function(e,t){t.normalize(e)}}function AC(e){const t=e.re=PRe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(URe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const i=[];e.__compiled__={};function s(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,FRe(l)){LRe(l.validate)?c.validate=HRe(l.validate):V9(l.validate)?c.validate=l.validate:s(o,l),V9(l.normalize)?c.normalize=l.normalize:l.normalize?s(o,l):c.normalize=H9();return}if(DRe(l)){i.push(o);return}s(o,l)}),i.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:H9()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(BRe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),VRe(e)}function WRe(e,t){const n=e.__index__,r=e.__last_index__,i=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=i,this.text=i,this.url=i}function rj(e,t){const n=new WRe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function Uo(e,t){if(!(this instanceof Uo))return new Uo(e,t);t||$Re(e)&&(t=e,e={}),this.__opts__=nj({},rZ,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=nj({},zRe,e),this.__compiled__={},this.__tlds__=qRe,this.__tlds_replaced__=!1,this.re={},AC(this)}Uo.prototype.add=function(t,n){return this.__schemas__[t]=n,AC(this),this};Uo.prototype.set=function(t){return this.__opts__=nj(this.__opts__,t),this};Uo.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,i,s,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(s=this.testSchemaAt(t,n[2],l.lastIndex),s){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(i=t.match(this.re.email_fuzzy))!==null&&(a=i.index+i[1].length,o=i.index+i[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};Uo.prototype.pretest=function(t){return this.re.pretest.test(t)};Uo.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};Uo.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(rj(this,r)),r=this.__last_index__);let i=r?t.slice(r):t;for(;this.test(i);)n.push(rj(this,r)),i=i.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};Uo.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,rj(this,0)):null};Uo.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,i,s){return r!==s[i-1]}).reverse(),AC(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,AC(this),this)};Uo.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};Uo.prototype.onCompile=function(){};const qg=2147483647,Hc=36,EP=1,Bx=26,GRe=38,KRe=700,iZ=72,sZ=128,aZ="-",YRe=/^xn--/,ZRe=/[^\0-\x7F]/,XRe=/[\x2E\u3002\uFF0E\uFF61]/g,JRe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},qM=Hc-EP,Wc=Math.floor,VM=String.fromCharCode;function wf(e){throw new RangeError(JRe[e])}function QRe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function oZ(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(XRe,".");const i=e.split("."),s=QRe(i,t).join(".");return r+s}function lZ(e){const t=[];let n=0;const r=e.length;for(;n<r;){const i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<r){const s=e.charCodeAt(n++);(s&64512)==56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),n--)}else t.push(i)}return t}const eIe=e=>String.fromCodePoint(...e),tIe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:Hc},W9=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},cZ=function(e,t,n){let r=0;for(e=n?Wc(e/KRe):e>>1,e+=Wc(e/t);e>qM*Bx>>1;r+=Hc)e=Wc(e/qM);return Wc(r+(qM+1)*e/(e+GRe))},uZ=function(e){const t=[],n=e.length;let r=0,i=sZ,s=iZ,a=e.lastIndexOf(aZ);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&wf("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=Hc;;d+=Hc){o>=n&&wf("invalid-input");const h=tIe(e.charCodeAt(o++));h>=Hc&&wf("invalid-input"),h>Wc((qg-r)/u)&&wf("overflow"),r+=h*u;const p=d<=s?EP:d>=s+Bx?Bx:d-s;if(h<p)break;const y=Hc-p;u>Wc(qg/y)&&wf("overflow"),u*=y}const c=t.length+1;s=cZ(r-l,c,l==0),Wc(r/c)>qg-i&&wf("overflow"),i+=Wc(r/c),r%=c,t.splice(r++,0,i)}return String.fromCodePoint(...t)},dZ=function(e){const t=[];e=lZ(e);const n=e.length;let r=sZ,i=0,s=iZ;for(const l of e)l<128&&t.push(VM(l));const a=t.length;let o=a;for(a&&t.push(aZ);o<n;){let l=qg;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>Wc((qg-i)/c)&&wf("overflow"),i+=(l-r)*c,r=l;for(const u of e)if(u<r&&++i>qg&&wf("overflow"),u===r){let d=i;for(let h=Hc;;h+=Hc){const p=h<=s?EP:h>=s+Bx?Bx:h-s;if(d<p)break;const y=d-p,b=Hc-p;t.push(VM(W9(p+y%b,0))),d=Wc(y/b)}t.push(VM(W9(d,0))),s=cZ(i,c,o===a),i=0,++o}++i,++r}return t.join("")},nIe=function(e){return oZ(e,function(t){return YRe.test(t)?uZ(t.slice(4).toLowerCase()):t})},rIe=function(e){return oZ(e,function(t){return ZRe.test(t)?"xn--"+dZ(t):t})},fZ={version:"2.3.1",ucs2:{decode:lZ,encode:eIe},decode:uZ,encode:dZ,toASCII:rIe,toUnicode:nIe},iIe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},sIe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},aIe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},oIe={default:iIe,zero:sIe,commonmark:aIe},lIe=/^(vbscript|javascript|file|data):/,cIe=/^data:image\/(gif|png|jpeg|webp);/;function uIe(e){const t=e.trim().toLowerCase();return lIe.test(t)?cIe.test(t):!0}const hZ=["http:","https:","mailto:"];function dIe(e){const t=xP(e,!0);if(t.hostname&&(!t.protocol||hZ.indexOf(t.protocol)>=0))try{t.hostname=fZ.toASCII(t.hostname)}catch{}return a1(vP(t))}function fIe(e){const t=xP(e,!0);if(t.hostname&&(!t.protocol||hZ.indexOf(t.protocol)>=0))try{t.hostname=fZ.toUnicode(t.hostname)}catch{}return T0(vP(t),T0.defaultChars+"%")}function qo(e,t){if(!(this instanceof qo))return new qo(e,t);t||_P(e)||(t=e||{},e="default"),this.inline=new l1,this.block=new OE,this.core=new CP,this.renderer=new my,this.linkify=new Uo,this.validateLink=uIe,this.normalizeLink=dIe,this.normalizeLinkText=fIe,this.utils=pAe,this.helpers=NE({},bAe),this.options={},this.configure(e),t&&this.set(t)}qo.prototype.set=function(e){return NE(this.options,e),this};qo.prototype.configure=function(e){const t=this;if(_P(e)){const n=e;if(e=oIe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};qo.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(i){n=n.concat(this[i].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(i){return n.indexOf(i)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};qo.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(i){n=n.concat(this[i].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(i){return n.indexOf(i)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};qo.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};qo.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};qo.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};qo.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};qo.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const HM=new qo({html:!1,linkify:!0,breaks:!0});function DE(e){return A.useMemo(()=>{var n;if(!e)return[];try{const r=HM.parse(e,{}),i=[];let s="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){s&&(i.push(s),s="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;c==="mermaid"?i.push({type:"mermaid",code:o.content}):i.push({type:"code",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(s+=HM.renderer.render(l,HM.options,{}))}}return s&&i.push(s),i}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const hIe="modulepreload",pIe=function(e){return"/"+e},G9={},zr=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=pIe(l),l in G9)return;G9[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":hIe,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};var n2={exports:{}},mIe=n2.exports,K9;function gIe(){return K9||(K9=1,function(e,t){(function(n,r){e.exports=r()})(mIe,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",p="year",y="date",b="Invalid Date",x=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,w=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(F){var Q=["th","st","nd","rd"],q=F%100;return"["+F+(Q[(q-20)%10]||Q[q]||Q[0])+"]"}},S=function(F,Q,q){var K=String(F);return!K||K.length>=Q?F:""+Array(Q+1-K.length).join(q)+F},C={s:S,z:function(F){var Q=-F.utcOffset(),q=Math.abs(Q),K=Math.floor(q/60),U=q%60;return(Q<=0?"+":"-")+S(K,2,"0")+":"+S(U,2,"0")},m:function F(Q,q){if(Q.date()<q.date())return-F(q,Q);var K=12*(q.year()-Q.year())+(q.month()-Q.month()),U=Q.clone().add(K,d),re=q-U<0,G=Q.clone().add(K+(re?-1:1),d);return+(-(K+(q-U)/(re?U-G:G-U))||0)},a:function(F){return F<0?Math.ceil(F)||0:Math.floor(F)},p:function(F){return{M:d,y:p,w:u,d:c,D:y,h:l,m:o,s:a,ms:s,Q:h}[F]||String(F||"").toLowerCase().replace(/s$/,"")},u:function(F){return F===void 0}},E="en",T={};T[E]=_;var R="$isDayjsObject",M=function(F){return F instanceof P||!(!F||!F[R])},N=function F(Q,q,K){var U;if(!Q)return E;if(typeof Q=="string"){var re=Q.toLowerCase();T[re]&&(U=re),q&&(T[re]=q,U=re);var G=Q.split("-");if(!U&&G.length>1)return F(G[0])}else{var ne=Q.name;T[ne]=Q,U=ne}return!K&&U&&(E=U),U||!K&&E},O=function(F,Q){if(M(F))return F.clone();var q=typeof Q=="object"?Q:{};return q.date=F,q.args=arguments,new P(q)},B=C;B.l=N,B.i=M,B.w=function(F,Q){return O(F,{locale:Q.$L,utc:Q.$u,x:Q.$x,$offset:Q.$offset})};var P=function(){function F(q){this.$L=N(q.locale,null,!0),this.parse(q),this.$x=this.$x||q.x||{},this[R]=!0}var Q=F.prototype;return Q.parse=function(q){this.$d=function(K){var U=K.date,re=K.utc;if(U===null)return new Date(NaN);if(B.u(U))return new Date;if(U instanceof Date)return new Date(U);if(typeof U=="string"&&!/Z$/i.test(U)){var G=U.match(x);if(G){var ne=G[2]-1||0,te=(G[7]||"0").substring(0,3);return re?new Date(Date.UTC(G[1],ne,G[3]||1,G[4]||0,G[5]||0,G[6]||0,te)):new Date(G[1],ne,G[3]||1,G[4]||0,G[5]||0,G[6]||0,te)}}return new Date(U)}(q),this.init()},Q.init=function(){var q=this.$d;this.$y=q.getFullYear(),this.$M=q.getMonth(),this.$D=q.getDate(),this.$W=q.getDay(),this.$H=q.getHours(),this.$m=q.getMinutes(),this.$s=q.getSeconds(),this.$ms=q.getMilliseconds()},Q.$utils=function(){return B},Q.isValid=function(){return this.$d.toString()!==b},Q.isSame=function(q,K){var U=O(q);return this.startOf(K)<=U&&U<=this.endOf(K)},Q.isAfter=function(q,K){return O(q)<this.startOf(K)},Q.isBefore=function(q,K){return this.endOf(K)<O(q)},Q.$g=function(q,K,U){return B.u(q)?this[K]:this.set(U,q)},Q.unix=function(){return Math.floor(this.valueOf()/1e3)},Q.valueOf=function(){return this.$d.getTime()},Q.startOf=function(q,K){var U=this,re=!!B.u(K)||K,G=B.p(q),ne=function(Ee,Ue){var nt=B.w(U.$u?Date.UTC(U.$y,Ue,Ee):new Date(U.$y,Ue,Ee),U);return re?nt:nt.endOf(c)},te=function(Ee,Ue){return B.w(U.toDate()[Ee].apply(U.toDate("s"),(re?[0,0,0,0]:[23,59,59,999]).slice(Ue)),U)},se=this.$W,pe=this.$M,de=this.$D,Ne="set"+(this.$u?"UTC":"");switch(G){case p:return re?ne(1,0):ne(31,11);case d:return re?ne(1,pe):ne(0,pe+1);case u:var Pe=this.$locale().weekStart||0,Me=(se<Pe?se+7:se)-Pe;return ne(re?de-Me:de+(6-Me),pe);case c:case y:return te(Ne+"Hours",0);case l:return te(Ne+"Minutes",1);case o:return te(Ne+"Seconds",2);case a:return te(Ne+"Milliseconds",3);default:return this.clone()}},Q.endOf=function(q){return this.startOf(q,!1)},Q.$set=function(q,K){var U,re=B.p(q),G="set"+(this.$u?"UTC":""),ne=(U={},U[c]=G+"Date",U[y]=G+"Date",U[d]=G+"Month",U[p]=G+"FullYear",U[l]=G+"Hours",U[o]=G+"Minutes",U[a]=G+"Seconds",U[s]=G+"Milliseconds",U)[re],te=re===c?this.$D+(K-this.$W):K;if(re===d||re===p){var se=this.clone().set(y,1);se.$d[ne](te),se.init(),this.$d=se.set(y,Math.min(this.$D,se.daysInMonth())).$d}else ne&&this.$d[ne](te);return this.init(),this},Q.set=function(q,K){return this.clone().$set(q,K)},Q.get=function(q){return this[B.p(q)]()},Q.add=function(q,K){var U,re=this;q=Number(q);var G=B.p(K),ne=function(pe){var de=O(re);return B.w(de.date(de.date()+Math.round(pe*q)),re)};if(G===d)return this.set(d,this.$M+q);if(G===p)return this.set(p,this.$y+q);if(G===c)return ne(1);if(G===u)return ne(7);var te=(U={},U[o]=r,U[l]=i,U[a]=n,U)[G]||1,se=this.$d.getTime()+q*te;return B.w(se,this)},Q.subtract=function(q,K){return this.add(-1*q,K)},Q.format=function(q){var K=this,U=this.$locale();if(!this.isValid())return U.invalidDate||b;var re=q||"YYYY-MM-DDTHH:mm:ssZ",G=B.z(this),ne=this.$H,te=this.$m,se=this.$M,pe=U.weekdays,de=U.months,Ne=U.meridiem,Pe=function(Ue,nt,He,je){return Ue&&(Ue[nt]||Ue(K,re))||He[nt].slice(0,je)},Me=function(Ue){return B.s(ne%12||12,Ue,"0")},Ee=Ne||function(Ue,nt,He){var je=Ue<12?"AM":"PM";return He?je.toLowerCase():je};return re.replace(w,function(Ue,nt){return nt||function(He){switch(He){case"YY":return String(K.$y).slice(-2);case"YYYY":return B.s(K.$y,4,"0");case"M":return se+1;case"MM":return B.s(se+1,2,"0");case"MMM":return Pe(U.monthsShort,se,de,3);case"MMMM":return Pe(de,se);case"D":return K.$D;case"DD":return B.s(K.$D,2,"0");case"d":return String(K.$W);case"dd":return Pe(U.weekdaysMin,K.$W,pe,2);case"ddd":return Pe(U.weekdaysShort,K.$W,pe,3);case"dddd":return pe[K.$W];case"H":return String(ne);case"HH":return B.s(ne,2,"0");case"h":return Me(1);case"hh":return Me(2);case"a":return Ee(ne,te,!0);case"A":return Ee(ne,te,!1);case"m":return String(te);case"mm":return B.s(te,2,"0");case"s":return String(K.$s);case"ss":return B.s(K.$s,2,"0");case"SSS":return B.s(K.$ms,3,"0");case"Z":return G}return null}(Ue)||G.replace(":","")})},Q.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Q.diff=function(q,K,U){var re,G=this,ne=B.p(K),te=O(q),se=(te.utcOffset()-this.utcOffset())*r,pe=this-te,de=function(){return B.m(G,te)};switch(ne){case p:re=de()/12;break;case d:re=de();break;case h:re=de()/3;break;case u:re=(pe-se)/6048e5;break;case c:re=(pe-se)/864e5;break;case l:re=pe/i;break;case o:re=pe/r;break;case a:re=pe/n;break;default:re=pe}return U?re:B.a(re)},Q.daysInMonth=function(){return this.endOf(d).$D},Q.$locale=function(){return T[this.$L]},Q.locale=function(q,K){if(!q)return this.$L;var U=this.clone(),re=N(q,K,!0);return re&&(U.$L=re),U},Q.clone=function(){return B.w(this.$d,this)},Q.toDate=function(){return new Date(this.valueOf())},Q.toJSON=function(){return this.isValid()?this.toISOString():null},Q.toISOString=function(){return this.$d.toISOString()},Q.toString=function(){return this.$d.toUTCString()},F}(),H=P.prototype;return O.prototype=H,[["$ms",s],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",p],["$D",y]].forEach(function(F){H[F[1]]=function(Q){return this.$g(Q,F[0],F[1])}}),O.extend=function(F,Q){return F.$i||(F(Q,P,O),F.$i=!0),O},O.locale=N,O.isDayjs=M,O.unix=function(F){return O(1e3*F)},O.en=T[E],O.Ls=T,O.p={},O})}(n2)),n2.exports}var yIe=gIe();const bIe=aa(yIe),r2={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const i=n<.5?n*(1+t):n+t-n*t,s=2*n-i;switch(r){case"r":return r2.hue2rgb(s,i,e+1/3)*255;case"g":return r2.hue2rgb(s,i,e)*255;case"b":return r2.hue2rgb(s,i,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const i=Math.max(e,t,n),s=Math.min(e,t,n),a=(i+s)/2;if(r==="l")return a*100;if(i===s)return 0;const o=i-s,l=a>.5?o/(2-i-s):o/(i+s);if(r==="s")return l*100;switch(i){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},vIe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},xIe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},er={channel:r2,lang:vIe,unit:xIe},bf={};for(let e=0;e<=255;e++)bf[e]=er.unit.dec2hex(e);const ha={ALL:0,RGB:1,HSL:2};class wIe{constructor(){this.type=ha.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=ha.ALL}is(t){return this.type===t}}class _Ie{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new wIe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=ha.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:i}=t;n===void 0&&(t.h=er.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=er.channel.rgb2hsl(t,"s")),i===void 0&&(t.l=er.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:i}=t;n===void 0&&(t.r=er.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=er.channel.hsl2rgb(t,"g")),i===void 0&&(t.b=er.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(ha.HSL)&&n!==void 0?n:(this._ensureHSL(),er.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(ha.HSL)&&n!==void 0?n:(this._ensureHSL(),er.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(ha.HSL)&&n!==void 0?n:(this._ensureHSL(),er.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(ha.RGB)&&n!==void 0?n:(this._ensureRGB(),er.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(ha.RGB)&&n!==void 0?n:(this._ensureRGB(),er.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(ha.RGB)&&n!==void 0?n:(this._ensureRGB(),er.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(ha.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(ha.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(ha.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(ha.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(ha.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(ha.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const FE=new _Ie({r:0,g:0,b:0,a:0},"transparent"),Vg={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(Vg.re);if(!t)return;const n=t[1],r=parseInt(n,16),i=n.length,s=i%4===0,a=i>4,o=a?1:17,l=a?8:4,c=s?0:-1,u=a?255:15;return FE.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:s?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:i}=e;return i<1?`#${bf[Math.round(t)]}${bf[Math.round(n)]}${bf[Math.round(r)]}${bf[Math.round(i*255)]}`:`#${bf[Math.round(t)]}${bf[Math.round(n)]}${bf[Math.round(r)]}`}},fp={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(fp.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return er.channel.clamp.h(parseFloat(n)*.9);case"rad":return er.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return er.channel.clamp.h(parseFloat(n)*360)}}return er.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(fp.re);if(!n)return;const[,r,i,s,a,o]=n;return FE.set({h:fp._hue2deg(r),s:er.channel.clamp.s(parseFloat(i)),l:er.channel.clamp.l(parseFloat(s)),a:a?er.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:i}=e;return i<1?`hsla(${er.lang.round(t)}, ${er.lang.round(n)}%, ${er.lang.round(r)}%, ${i})`:`hsl(${er.lang.round(t)}, ${er.lang.round(n)}%, ${er.lang.round(r)}%)`}},Mv={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=Mv.colors[e];if(t)return Vg.parse(t)},stringify:e=>{const t=Vg.stringify(e);for(const n in Mv.colors)if(Mv.colors[n]===t)return n}},mv={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(mv.re);if(!n)return;const[,r,i,s,a,o,l,c,u]=n;return FE.set({r:er.channel.clamp.r(i?parseFloat(r)*2.55:parseFloat(r)),g:er.channel.clamp.g(a?parseFloat(s)*2.55:parseFloat(s)),b:er.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?er.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:i}=e;return i<1?`rgba(${er.lang.round(t)}, ${er.lang.round(n)}, ${er.lang.round(r)}, ${er.lang.round(i)})`:`rgb(${er.lang.round(t)}, ${er.lang.round(n)}, ${er.lang.round(r)})`}},su={format:{keyword:Mv,hex:Vg,rgb:mv,rgba:mv,hsl:fp,hsla:fp},parse:e=>{if(typeof e!="string")return e;const t=Vg.parse(e)||mv.parse(e)||fp.parse(e)||Mv.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(ha.HSL)||e.data.r===void 0?fp.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?mv.stringify(e):Vg.stringify(e)},pZ=(e,t)=>{const n=su.parse(e);for(const r in t)n[r]=er.channel.clamp[r](t[r]);return su.stringify(n)},Nv=(e,t,n=0,r=1)=>{if(typeof e!="number")return pZ(e,{a:t});const i=FE.set({r:er.channel.clamp.r(e),g:er.channel.clamp.g(t),b:er.channel.clamp.b(n),a:er.channel.clamp.a(r)});return su.stringify(i)},SIe=e=>{const{r:t,g:n,b:r}=su.parse(e),i=.2126*er.channel.toLinear(t)+.7152*er.channel.toLinear(n)+.0722*er.channel.toLinear(r);return er.lang.round(i)},CIe=e=>SIe(e)>=.5,c1=e=>!CIe(e),mZ=(e,t,n)=>{const r=su.parse(e),i=r[t],s=er.channel.clamp[t](i+n);return i!==s&&(r[t]=s),su.stringify(r)},bn=(e,t)=>mZ(e,"l",t),Nn=(e,t)=>mZ(e,"l",-t),mt=(e,t)=>{const n=su.parse(e),r={};for(const i in t)t[i]&&(r[i]=n[i]+t[i]);return pZ(e,r)},kIe=(e,t,n=50)=>{const{r,g:i,b:s,a}=su.parse(e),{r:o,g:l,b:c,a:u}=su.parse(t),d=n/100,h=d*2-1,p=a-u,b=((h*p===-1?h:(h+p)/(1+h*p))+1)/2,x=1-b,w=r*b+o*x,_=i*b+l*x,S=s*b+c*x,C=a*d+u*(1-d);return Nv(w,_,S,C)},an=(e,t=100)=>{const n=su.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,kIe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:gZ,setPrototypeOf:Y9,isFrozen:EIe,getPrototypeOf:TIe,getOwnPropertyDescriptor:AIe}=Object;let{freeze:Va,seal:xl,create:yZ}=Object,{apply:ij,construct:sj}=typeof Reflect<"u"&&Reflect;Va||(Va=function(t){return t});xl||(xl=function(t){return t});ij||(ij=function(t,n,r){return t.apply(n,r)});sj||(sj=function(t,n){return new t(...n)});const pS=Ha(Array.prototype.forEach),RIe=Ha(Array.prototype.lastIndexOf),Z9=Ha(Array.prototype.pop),Zb=Ha(Array.prototype.push),IIe=Ha(Array.prototype.splice),i2=Ha(String.prototype.toLowerCase),WM=Ha(String.prototype.toString),X9=Ha(String.prototype.match),Xb=Ha(String.prototype.replace),MIe=Ha(String.prototype.indexOf),NIe=Ha(String.prototype.trim),Bl=Ha(Object.prototype.hasOwnProperty),ja=Ha(RegExp.prototype.test),Jb=jIe(TypeError);function Ha(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ij(e,t,r)}}function jIe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return sj(e,n)}}function Mr(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:i2;Y9&&Y9(e,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i=="string"){const s=n(i);s!==i&&(EIe(t)||(t[r]=s),i=s)}e[i]=!0}return e}function OIe(e){for(let t=0;t<e.length;t++)Bl(e,t)||(e[t]=null);return e}function Hu(e){const t=yZ(null);for(const[n,r]of gZ(e))Bl(e,n)&&(Array.isArray(r)?t[n]=OIe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=Hu(r):t[n]=r);return t}function Qb(e,t){for(;e!==null;){const r=AIe(e,t);if(r){if(r.get)return Ha(r.get);if(typeof r.value=="function")return Ha(r.value)}e=TIe(e)}function n(){return null}return n}const J9=Va(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),GM=Va(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),KM=Va(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),PIe=Va(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),YM=Va(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),DIe=Va(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Q9=Va(["#text"]),ez=Va(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ZM=Va(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),tz=Va(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),mS=Va(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),FIe=xl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),LIe=xl(/<%[\w\W]*|[\w\W]*%>/gm),BIe=xl(/\$\{[\w\W]*/gm),$Ie=xl(/^data-[\-\w.\u00B7-\uFFFF]+$/),zIe=xl(/^aria-[\-\w]+$/),bZ=xl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),UIe=xl(/^(?:\w+script|data):/i),qIe=xl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),vZ=xl(/^html$/i),VIe=xl(/^[a-z][.\w]*(-[.\w]+)+$/i);var nz=Object.freeze({__proto__:null,ARIA_ATTR:zIe,ATTR_WHITESPACE:qIe,CUSTOM_ELEMENT:VIe,DATA_ATTR:$Ie,DOCTYPE_NAME:vZ,ERB_EXPR:LIe,IS_ALLOWED_URI:bZ,IS_SCRIPT_OR_DATA:UIe,MUSTACHE_EXPR:FIe,TMPLIT_EXPR:BIe});const ev={element:1,text:3,progressingInstruction:7,comment:8,document:9},HIe=function(){return typeof window>"u"?null:window},WIe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";n&&n.hasAttribute(i)&&(r=n.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return t.createPolicy(s,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},rz=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function xZ(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:HIe();const t=un=>xZ(un);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==ev.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:p}=e,y=l.prototype,b=Qb(y,"cloneNode"),x=Qb(y,"remove"),w=Qb(y,"nextSibling"),_=Qb(y,"childNodes"),S=Qb(y,"parentNode");if(typeof a=="function"){const un=n.createElement("template");un.content&&un.content.ownerDocument&&(n=un.content.ownerDocument)}let C,E="";const{implementation:T,createNodeIterator:R,createDocumentFragment:M,getElementsByTagName:N}=n,{importNode:O}=r;let B=rz();t.isSupported=typeof gZ=="function"&&typeof S=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:P,ERB_EXPR:H,TMPLIT_EXPR:F,DATA_ATTR:Q,ARIA_ATTR:q,IS_SCRIPT_OR_DATA:K,ATTR_WHITESPACE:U,CUSTOM_ELEMENT:re}=nz;let{IS_ALLOWED_URI:G}=nz,ne=null;const te=Mr({},[...J9,...GM,...KM,...YM,...Q9]);let se=null;const pe=Mr({},[...ez,...ZM,...tz,...mS]);let de=Object.seal(yZ(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ne=null,Pe=null,Me=!0,Ee=!0,Ue=!1,nt=!0,He=!1,je=!0,Y=!1,be=!1,Re=!1,ce=!1,le=!1,ae=!1,Te=!0,$e=!1;const ke="user-content-";let ot=!0,At=!1,ft={},jt=null;const Bt=Mr({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ft=null;const tn=Mr({},["audio","video","img","source","image","track"]);let xe=null;const D=Mr({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),X="http://www.w3.org/1998/Math/MathML",me="http://www.w3.org/2000/svg",De="http://www.w3.org/1999/xhtml";let we=De,Ie=!1,fe=null;const yt=Mr({},[X,me,De],WM);let _t=Mr({},["mi","mo","mn","ms","mtext"]),z=Mr({},["annotation-xml"]);const qe=Mr({},["title","style","font","a","script"]);let rt=null;const ve=["application/xhtml+xml","text/html"],Se="text/html";let ze=null,Tt=null;const ge=n.createElement("form"),Z=function(Ze){return Ze instanceof RegExp||Ze instanceof Function},W=function(){let Ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Tt&&Tt===Ze)){if((!Ze||typeof Ze!="object")&&(Ze={}),Ze=Hu(Ze),rt=ve.indexOf(Ze.PARSER_MEDIA_TYPE)===-1?Se:Ze.PARSER_MEDIA_TYPE,ze=rt==="application/xhtml+xml"?WM:i2,ne=Bl(Ze,"ALLOWED_TAGS")?Mr({},Ze.ALLOWED_TAGS,ze):te,se=Bl(Ze,"ALLOWED_ATTR")?Mr({},Ze.ALLOWED_ATTR,ze):pe,fe=Bl(Ze,"ALLOWED_NAMESPACES")?Mr({},Ze.ALLOWED_NAMESPACES,WM):yt,xe=Bl(Ze,"ADD_URI_SAFE_ATTR")?Mr(Hu(D),Ze.ADD_URI_SAFE_ATTR,ze):D,Ft=Bl(Ze,"ADD_DATA_URI_TAGS")?Mr(Hu(tn),Ze.ADD_DATA_URI_TAGS,ze):tn,jt=Bl(Ze,"FORBID_CONTENTS")?Mr({},Ze.FORBID_CONTENTS,ze):Bt,Ne=Bl(Ze,"FORBID_TAGS")?Mr({},Ze.FORBID_TAGS,ze):Hu({}),Pe=Bl(Ze,"FORBID_ATTR")?Mr({},Ze.FORBID_ATTR,ze):Hu({}),ft=Bl(Ze,"USE_PROFILES")?Ze.USE_PROFILES:!1,Me=Ze.ALLOW_ARIA_ATTR!==!1,Ee=Ze.ALLOW_DATA_ATTR!==!1,Ue=Ze.ALLOW_UNKNOWN_PROTOCOLS||!1,nt=Ze.ALLOW_SELF_CLOSE_IN_ATTR!==!1,He=Ze.SAFE_FOR_TEMPLATES||!1,je=Ze.SAFE_FOR_XML!==!1,Y=Ze.WHOLE_DOCUMENT||!1,ce=Ze.RETURN_DOM||!1,le=Ze.RETURN_DOM_FRAGMENT||!1,ae=Ze.RETURN_TRUSTED_TYPE||!1,Re=Ze.FORCE_BODY||!1,Te=Ze.SANITIZE_DOM!==!1,$e=Ze.SANITIZE_NAMED_PROPS||!1,ot=Ze.KEEP_CONTENT!==!1,At=Ze.IN_PLACE||!1,G=Ze.ALLOWED_URI_REGEXP||bZ,we=Ze.NAMESPACE||De,_t=Ze.MATHML_TEXT_INTEGRATION_POINTS||_t,z=Ze.HTML_INTEGRATION_POINTS||z,de=Ze.CUSTOM_ELEMENT_HANDLING||{},Ze.CUSTOM_ELEMENT_HANDLING&&Z(Ze.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=Ze.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Ze.CUSTOM_ELEMENT_HANDLING&&Z(Ze.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=Ze.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Ze.CUSTOM_ELEMENT_HANDLING&&typeof Ze.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=Ze.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),He&&(Ee=!1),le&&(ce=!0),ft&&(ne=Mr({},Q9),se=[],ft.html===!0&&(Mr(ne,J9),Mr(se,ez)),ft.svg===!0&&(Mr(ne,GM),Mr(se,ZM),Mr(se,mS)),ft.svgFilters===!0&&(Mr(ne,KM),Mr(se,ZM),Mr(se,mS)),ft.mathMl===!0&&(Mr(ne,YM),Mr(se,tz),Mr(se,mS))),Ze.ADD_TAGS&&(ne===te&&(ne=Hu(ne)),Mr(ne,Ze.ADD_TAGS,ze)),Ze.ADD_ATTR&&(se===pe&&(se=Hu(se)),Mr(se,Ze.ADD_ATTR,ze)),Ze.ADD_URI_SAFE_ATTR&&Mr(xe,Ze.ADD_URI_SAFE_ATTR,ze),Ze.FORBID_CONTENTS&&(jt===Bt&&(jt=Hu(jt)),Mr(jt,Ze.FORBID_CONTENTS,ze)),ot&&(ne["#text"]=!0),Y&&Mr(ne,["html","head","body"]),ne.table&&(Mr(ne,["tbody"]),delete Ne.tbody),Ze.TRUSTED_TYPES_POLICY){if(typeof Ze.TRUSTED_TYPES_POLICY.createHTML!="function")throw Jb('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Ze.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Jb('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=Ze.TRUSTED_TYPES_POLICY,E=C.createHTML("")}else C===void 0&&(C=WIe(p,i)),C!==null&&typeof E=="string"&&(E=C.createHTML(""));Va&&Va(Ze),Tt=Ze}},J=Mr({},[...GM,...KM,...PIe]),ye=Mr({},[...YM,...DIe]),Oe=function(Ze){let $t=S(Ze);(!$t||!$t.tagName)&&($t={namespaceURI:we,tagName:"template"});const dn=i2(Ze.tagName),Gn=i2($t.tagName);return fe[Ze.namespaceURI]?Ze.namespaceURI===me?$t.namespaceURI===De?dn==="svg":$t.namespaceURI===X?dn==="svg"&&(Gn==="annotation-xml"||_t[Gn]):!!J[dn]:Ze.namespaceURI===X?$t.namespaceURI===De?dn==="math":$t.namespaceURI===me?dn==="math"&&z[Gn]:!!ye[dn]:Ze.namespaceURI===De?$t.namespaceURI===me&&!z[Gn]||$t.namespaceURI===X&&!_t[Gn]?!1:!ye[dn]&&(qe[dn]||!J[dn]):!!(rt==="application/xhtml+xml"&&fe[Ze.namespaceURI]):!1},We=function(Ze){Zb(t.removed,{element:Ze});try{S(Ze).removeChild(Ze)}catch{x(Ze)}},vt=function(Ze,$t){try{Zb(t.removed,{attribute:$t.getAttributeNode(Ze),from:$t})}catch{Zb(t.removed,{attribute:null,from:$t})}if($t.removeAttribute(Ze),Ze==="is")if(ce||le)try{We($t)}catch{}else try{$t.setAttribute(Ze,"")}catch{}},Xt=function(Ze){let $t=null,dn=null;if(Re)Ze="<remove></remove>"+Ze;else{const Vr=X9(Ze,/^[\r\n\t ]+/);dn=Vr&&Vr[0]}rt==="application/xhtml+xml"&&we===De&&(Ze='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Ze+"</body></html>");const Gn=C?C.createHTML(Ze):Ze;if(we===De)try{$t=new h().parseFromString(Gn,rt)}catch{}if(!$t||!$t.documentElement){$t=T.createDocument(we,"template",null);try{$t.documentElement.innerHTML=Ie?E:Gn}catch{}}const gi=$t.body||$t.documentElement;return Ze&&dn&&gi.insertBefore(n.createTextNode(dn),gi.childNodes[0]||null),we===De?N.call($t,Y?"html":"body")[0]:Y?$t.documentElement:gi},jn=function(Ze){return R.call(Ze.ownerDocument||Ze,Ze,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Yt=function(Ze){return Ze instanceof d&&(typeof Ze.nodeName!="string"||typeof Ze.textContent!="string"||typeof Ze.removeChild!="function"||!(Ze.attributes instanceof u)||typeof Ze.removeAttribute!="function"||typeof Ze.setAttribute!="function"||typeof Ze.namespaceURI!="string"||typeof Ze.insertBefore!="function"||typeof Ze.hasChildNodes!="function")},Qt=function(Ze){return typeof o=="function"&&Ze instanceof o};function on(un,Ze,$t){pS(un,dn=>{dn.call(t,Ze,$t,Tt)})}const or=function(Ze){let $t=null;if(on(B.beforeSanitizeElements,Ze,null),Yt(Ze))return We(Ze),!0;const dn=ze(Ze.nodeName);if(on(B.uponSanitizeElement,Ze,{tagName:dn,allowedTags:ne}),je&&Ze.hasChildNodes()&&!Qt(Ze.firstElementChild)&&ja(/<[/\w!]/g,Ze.innerHTML)&&ja(/<[/\w!]/g,Ze.textContent)||Ze.nodeType===ev.progressingInstruction||je&&Ze.nodeType===ev.comment&&ja(/<[/\w]/g,Ze.data))return We(Ze),!0;if(!ne[dn]||Ne[dn]){if(!Ne[dn]&&Gr(dn)&&(de.tagNameCheck instanceof RegExp&&ja(de.tagNameCheck,dn)||de.tagNameCheck instanceof Function&&de.tagNameCheck(dn)))return!1;if(ot&&!jt[dn]){const Gn=S(Ze)||Ze.parentNode,gi=_(Ze)||Ze.childNodes;if(gi&&Gn){const Vr=gi.length;for(let gs=Vr-1;gs>=0;--gs){const Ki=b(gi[gs],!0);Ki.__removalCount=(Ze.__removalCount||0)+1,Gn.insertBefore(Ki,w(Ze))}}}return We(Ze),!0}return Ze instanceof l&&!Oe(Ze)||(dn==="noscript"||dn==="noembed"||dn==="noframes")&&ja(/<\/no(script|embed|frames)/i,Ze.innerHTML)?(We(Ze),!0):(He&&Ze.nodeType===ev.text&&($t=Ze.textContent,pS([P,H,F],Gn=>{$t=Xb($t,Gn," ")}),Ze.textContent!==$t&&(Zb(t.removed,{element:Ze.cloneNode()}),Ze.textContent=$t)),on(B.afterSanitizeElements,Ze,null),!1)},xr=function(Ze,$t,dn){if(Te&&($t==="id"||$t==="name")&&(dn in n||dn in ge))return!1;if(!(Ee&&!Pe[$t]&&ja(Q,$t))){if(!(Me&&ja(q,$t))){if(!se[$t]||Pe[$t]){if(!(Gr(Ze)&&(de.tagNameCheck instanceof RegExp&&ja(de.tagNameCheck,Ze)||de.tagNameCheck instanceof Function&&de.tagNameCheck(Ze))&&(de.attributeNameCheck instanceof RegExp&&ja(de.attributeNameCheck,$t)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck($t))||$t==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&ja(de.tagNameCheck,dn)||de.tagNameCheck instanceof Function&&de.tagNameCheck(dn))))return!1}else if(!xe[$t]){if(!ja(G,Xb(dn,U,""))){if(!(($t==="src"||$t==="xlink:href"||$t==="href")&&Ze!=="script"&&MIe(dn,"data:")===0&&Ft[Ze])){if(!(Ue&&!ja(K,Xb(dn,U,"")))){if(dn)return!1}}}}}}return!0},Gr=function(Ze){return Ze!=="annotation-xml"&&X9(Ze,re)},Kr=function(Ze){on(B.beforeSanitizeAttributes,Ze,null);const{attributes:$t}=Ze;if(!$t||Yt(Ze))return;const dn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:se,forceKeepAttr:void 0};let Gn=$t.length;for(;Gn--;){const gi=$t[Gn],{name:Vr,namespaceURI:gs,value:Ki}=gi,Ta=ze(Vr),Gs=Ki;let Mi=Vr==="value"?Gs:NIe(Gs);if(dn.attrName=Ta,dn.attrValue=Mi,dn.keepAttr=!0,dn.forceKeepAttr=void 0,on(B.uponSanitizeAttribute,Ze,dn),Mi=dn.attrValue,$e&&(Ta==="id"||Ta==="name")&&(vt(Vr,Ze),Mi=ke+Mi),je&&ja(/((--!?|])>)|<\/(style|title)/i,Mi)){vt(Vr,Ze);continue}if(dn.forceKeepAttr)continue;if(!dn.keepAttr){vt(Vr,Ze);continue}if(!nt&&ja(/\/>/i,Mi)){vt(Vr,Ze);continue}He&&pS([P,H,F],Wo=>{Mi=Xb(Mi,Wo," ")});const _o=ze(Ze.nodeName);if(!xr(_o,Ta,Mi)){vt(Vr,Ze);continue}if(C&&typeof p=="object"&&typeof p.getAttributeType=="function"&&!gs)switch(p.getAttributeType(_o,Ta)){case"TrustedHTML":{Mi=C.createHTML(Mi);break}case"TrustedScriptURL":{Mi=C.createScriptURL(Mi);break}}if(Mi!==Gs)try{gs?Ze.setAttributeNS(gs,Vr,Mi):Ze.setAttribute(Vr,Mi),Yt(Ze)?We(Ze):Z9(t.removed)}catch{vt(Vr,Ze)}}on(B.afterSanitizeAttributes,Ze,null)},pr=function un(Ze){let $t=null;const dn=jn(Ze);for(on(B.beforeSanitizeShadowDOM,Ze,null);$t=dn.nextNode();)on(B.uponSanitizeShadowNode,$t,null),or($t),Kr($t),$t.content instanceof s&&un($t.content);on(B.afterSanitizeShadowDOM,Ze,null)};return t.sanitize=function(un){let Ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},$t=null,dn=null,Gn=null,gi=null;if(Ie=!un,Ie&&(un="<!-->"),typeof un!="string"&&!Qt(un))if(typeof un.toString=="function"){if(un=un.toString(),typeof un!="string")throw Jb("dirty is not a string, aborting")}else throw Jb("toString is not a function");if(!t.isSupported)return un;if(be||W(Ze),t.removed=[],typeof un=="string"&&(At=!1),At){if(un.nodeName){const Ki=ze(un.nodeName);if(!ne[Ki]||Ne[Ki])throw Jb("root node is forbidden and cannot be sanitized in-place")}}else if(un instanceof o)$t=Xt("<!---->"),dn=$t.ownerDocument.importNode(un,!0),dn.nodeType===ev.element&&dn.nodeName==="BODY"||dn.nodeName==="HTML"?$t=dn:$t.appendChild(dn);else{if(!ce&&!He&&!Y&&un.indexOf("<")===-1)return C&&ae?C.createHTML(un):un;if($t=Xt(un),!$t)return ce?null:ae?E:""}$t&&Re&&We($t.firstChild);const Vr=jn(At?un:$t);for(;Gn=Vr.nextNode();)or(Gn),Kr(Gn),Gn.content instanceof s&&pr(Gn.content);if(At)return un;if(ce){if(le)for(gi=M.call($t.ownerDocument);$t.firstChild;)gi.appendChild($t.firstChild);else gi=$t;return(se.shadowroot||se.shadowrootmode)&&(gi=O.call(r,gi,!0)),gi}let gs=Y?$t.outerHTML:$t.innerHTML;return Y&&ne["!doctype"]&&$t.ownerDocument&&$t.ownerDocument.doctype&&$t.ownerDocument.doctype.name&&ja(vZ,$t.ownerDocument.doctype.name)&&(gs="<!DOCTYPE "+$t.ownerDocument.doctype.name+`>
`+gs),He&&pS([P,H,F],Ki=>{gs=Xb(gs,Ki," ")}),C&&ae?C.createHTML(gs):gs},t.setConfig=function(){let un=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};W(un),be=!0},t.clearConfig=function(){Tt=null,be=!1},t.isValidAttribute=function(un,Ze,$t){Tt||W({});const dn=ze(un),Gn=ze(Ze);return xr(dn,Gn,$t)},t.addHook=function(un,Ze){typeof Ze=="function"&&Zb(B[un],Ze)},t.removeHook=function(un,Ze){if(Ze!==void 0){const $t=RIe(B[un],Ze);return $t===-1?void 0:IIe(B[un],$t,1)[0]}return Z9(B[un])},t.removeHooks=function(un){B[un]=[]},t.removeAllHooks=function(){B=rz()},t}var R0=xZ(),wZ=Object.defineProperty,ie=(e,t)=>wZ(e,"name",{value:t,configurable:!0}),GIe=(e,t)=>{for(var n in t)wZ(e,n,{get:t[n],enumerable:!0})},$u={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},Lt={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},TP=ie(function(e="fatal"){let t=$u.fatal;typeof e=="string"?e.toLowerCase()in $u&&(t=$u[e]):typeof e=="number"&&(t=e),Lt.trace=()=>{},Lt.debug=()=>{},Lt.info=()=>{},Lt.warn=()=>{},Lt.error=()=>{},Lt.fatal=()=>{},t<=$u.fatal&&(Lt.fatal=console.error?console.error.bind(console,sl("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",sl("FATAL"))),t<=$u.error&&(Lt.error=console.error?console.error.bind(console,sl("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",sl("ERROR"))),t<=$u.warn&&(Lt.warn=console.warn?console.warn.bind(console,sl("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",sl("WARN"))),t<=$u.info&&(Lt.info=console.info?console.info.bind(console,sl("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",sl("INFO"))),t<=$u.debug&&(Lt.debug=console.debug?console.debug.bind(console,sl("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",sl("DEBUG"))),t<=$u.trace&&(Lt.trace=console.debug?console.debug.bind(console,sl("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",sl("TRACE")))},"setLogLevel"),sl=ie(e=>`%c${bIe().format("ss.SSS")} : ${e} : `,"format"),_Z=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,jv=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,KIe=/\s*%%.*\n/gm,Jg,SZ=(Jg=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(Jg,"UnknownDiagramError"),Jg),I0={},AP=ie(function(e,t){e=e.replace(_Z,"").replace(jv,"").replace(KIe,`
`);for(const[n,{detector:r}]of Object.entries(I0))if(r(e,t))return n;throw new SZ(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),CZ=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)kZ(t,n,r)},"registerLazyLoadedDiagrams"),kZ=ie((e,t,n)=>{I0[e]&&Lt.warn(`Detector with key ${e} already exists. Overwriting.`),I0[e]={detector:t,loader:n},Lt.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),YIe=ie(e=>I0[e].loader,"getDiagramLoader"),aj=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const i={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(s=>aj(e,s,i)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(s=>{e.includes(s)||e.push(s)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(s=>{typeof t[s]=="object"&&(e[s]===void 0||typeof e[s]=="object")?(e[s]===void 0&&(e[s]=Array.isArray(t[s])?[]:{}),e[s]=aj(e[s],t[s],{depth:n-1,clobber:r})):(r||typeof e[s]!="object"&&typeof t[s]!="object")&&(e[s]=t[s])}),e)},"assignWithDepth"),ra=aj,LE="#ffffff",BE="#f2f2f2",Pa=ie((e,t)=>t?mt(e,{s:-40,l:10}):mt(e,{s:-40,l:-10}),"mkBorder"),Qg,ZIe=(Qg=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,i,s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E,T;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||mt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||mt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Pa(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Pa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Pa(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Pa(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||an(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||an(this.tertiaryColor),this.lineColor=this.lineColor||an(this.background),this.arrowheadColor=this.arrowheadColor||an(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?Nn(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||Nn(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||an(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||bn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||Nn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Nn(this.mainBkg,10)):(this.rowOdd=this.rowOdd||bn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||bn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||mt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||mt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||mt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||mt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||mt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||mt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||mt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||mt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||mt(this.primaryColor,{h:330}),this.darkMode)for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=Nn(this["cScale"+R],75);else for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScale"+R]=Nn(this["cScale"+R],25);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleInv"+R]=this["cScaleInv"+R]||an(this["cScale"+R]);for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this.darkMode?this["cScalePeer"+R]=this["cScalePeer"+R]||bn(this["cScale"+R],10):this["cScalePeer"+R]=this["cScalePeer"+R]||Nn(this["cScale"+R],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let R=0;R<this.THEME_COLOR_LIMIT;R++)this["cScaleLabel"+R]=this["cScaleLabel"+R]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let R=0;R<5;R++)this["surface"+R]=this["surface"+R]||mt(this.mainBkg,{h:180,s:-15,l:t*(5+R*3)}),this["surfacePeer"+R]=this["surfacePeer"+R]||mt(this.mainBkg,{h:180,s:-15,l:t*(8+R*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||mt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||mt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||mt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||mt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||mt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||mt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||mt(this.primaryColor,{l:-10}),this.pie5=this.pie5||mt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||mt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||mt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||mt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||mt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||mt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||mt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||mt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((i=this.radar)==null?void 0:i.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||mt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||mt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||mt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||mt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||mt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||mt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c1(this.quadrant1Fill)?bn(this.quadrant1Fill):Nn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((p=this.xyChart)==null?void 0:p.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((x=this.xyChart)==null?void 0:x.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((w=this.xyChart)==null?void 0:w.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((_=this.xyChart)==null?void 0:_.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((C=this.xyChart)==null?void 0:C.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((E=this.xyChart)==null?void 0:E.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((T=this.xyChart)==null?void 0:T.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Nn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||mt(this.primaryColor,{h:-30}),this.git4=this.git4||mt(this.primaryColor,{h:-60}),this.git5=this.git5||mt(this.primaryColor,{h:-90}),this.git6=this.git6||mt(this.primaryColor,{h:60}),this.git7=this.git7||mt(this.primaryColor,{h:120}),this.darkMode?(this.git0=bn(this.git0,25),this.git1=bn(this.git1,25),this.git2=bn(this.git2,25),this.git3=bn(this.git3,25),this.git4=bn(this.git4,25),this.git5=bn(this.git5,25),this.git6=bn(this.git6,25),this.git7=bn(this.git7,25)):(this.git0=Nn(this.git0,25),this.git1=Nn(this.git1,25),this.git2=Nn(this.git2,25),this.git3=Nn(this.git3,25),this.git4=Nn(this.git4,25),this.git5=Nn(this.git5,25),this.git6=Nn(this.git6,25),this.git7=Nn(this.git7,25)),this.gitInv0=this.gitInv0||an(this.git0),this.gitInv1=this.gitInv1||an(this.git1),this.gitInv2=this.gitInv2||an(this.git2),this.gitInv3=this.gitInv3||an(this.git3),this.gitInv4=this.gitInv4||an(this.git4),this.gitInv5=this.gitInv5||an(this.git5),this.gitInv6=this.gitInv6||an(this.git6),this.gitInv7=this.gitInv7||an(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||LE,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||BE}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(Qg,"Theme"),Qg),XIe=ie(e=>{const t=new ZIe;return t.calculate(e),t},"getThemeVariables"),e0,JIe=(e0=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=bn(this.primaryColor,16),this.tertiaryColor=mt(this.primaryColor,{h:-160}),this.primaryBorderColor=an(this.background),this.secondaryBorderColor=Pa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Pa(this.tertiaryColor,this.darkMode),this.primaryTextColor=an(this.primaryColor),this.secondaryTextColor=an(this.secondaryColor),this.tertiaryTextColor=an(this.tertiaryColor),this.lineColor=an(this.background),this.textColor=an(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=bn(an("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=Nv(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=Nn("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=Nn(this.sectionBkgColor,10),this.taskBorderColor=Nv(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=Nv(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||bn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Nn(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,i,s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E;this.secondBkg=bn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=bn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=bn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=mt(this.primaryColor,{h:64}),this.fillType3=mt(this.secondaryColor,{h:64}),this.fillType4=mt(this.primaryColor,{h:-64}),this.fillType5=mt(this.secondaryColor,{h:-64}),this.fillType6=mt(this.primaryColor,{h:128}),this.fillType7=mt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||mt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||mt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||mt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||mt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||mt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||mt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||mt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||mt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||mt(this.primaryColor,{h:330});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||an(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScalePeer"+T]=this["cScalePeer"+T]||bn(this["cScale"+T],10);for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||mt(this.mainBkg,{h:30,s:-30,l:-(-10+T*4)}),this["surfacePeer"+T]=this["surfacePeer"+T]||mt(this.mainBkg,{h:30,s:-30,l:-(-7+T*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||mt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||mt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||mt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||mt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||mt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||mt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c1(this.quadrant1Fill)?bn(this.quadrant1Fill):Nn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((i=this.xyChart)==null?void 0:i.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((s=this.xyChart)==null?void 0:s.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((p=this.radar)==null?void 0:p.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((x=this.radar)==null?void 0:x.curveStrokeWidth)||2,graticuleColor:((w=this.radar)==null?void 0:w.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((_=this.radar)==null?void 0:_.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((C=this.radar)==null?void 0:C.legendBoxSize)||12,legendFontSize:((E=this.radar)==null?void 0:E.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Nn(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=bn(this.secondaryColor,20),this.git1=bn(this.pie2||this.secondaryColor,20),this.git2=bn(this.pie3||this.tertiaryColor,20),this.git3=bn(this.pie4||mt(this.primaryColor,{h:-30}),20),this.git4=bn(this.pie5||mt(this.primaryColor,{h:-60}),20),this.git5=bn(this.pie6||mt(this.primaryColor,{h:-90}),10),this.git6=bn(this.pie7||mt(this.primaryColor,{h:60}),10),this.git7=bn(this.pie8||mt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||an(this.git0),this.gitInv1=this.gitInv1||an(this.git1),this.gitInv2=this.gitInv2||an(this.git2),this.gitInv3=this.gitInv3||an(this.git3),this.gitInv4=this.gitInv4||an(this.git4),this.gitInv5=this.gitInv5||an(this.git5),this.gitInv6=this.gitInv6||an(this.git6),this.gitInv7=this.gitInv7||an(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||an(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||an(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||bn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||bn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(e0,"Theme"),e0),QIe=ie(e=>{const t=new JIe;return t.calculate(e),t},"getThemeVariables"),t0,eMe=(t0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=mt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=mt(this.primaryColor,{h:-160}),this.primaryBorderColor=Pa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Pa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Pa(this.tertiaryColor,this.darkMode),this.primaryTextColor=an(this.primaryColor),this.secondaryTextColor=an(this.secondaryColor),this.tertiaryTextColor=an(this.tertiaryColor),this.lineColor=an(this.background),this.textColor=an(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=Nv(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,i,s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||mt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||mt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||mt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||mt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||mt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||mt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||mt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||mt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||mt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Nn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Nn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Nn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Nn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||mt(this["cScale"+T],{h:180});for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||mt(this.mainBkg,{h:30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||mt(this.mainBkg,{h:30,l:-(7+T*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||an(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||an(this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=bn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||bn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||bn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=mt(this.primaryColor,{h:64}),this.fillType3=mt(this.secondaryColor,{h:64}),this.fillType4=mt(this.primaryColor,{h:-64}),this.fillType5=mt(this.secondaryColor,{h:-64}),this.fillType6=mt(this.primaryColor,{h:128}),this.fillType7=mt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||mt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||mt(this.primaryColor,{l:-10}),this.pie5=this.pie5||mt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||mt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||mt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||mt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||mt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||mt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||mt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||mt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||mt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||mt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||mt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||mt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||mt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||mt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c1(this.quadrant1Fill)?bn(this.quadrant1Fill):Nn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((s=this.radar)==null?void 0:s.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((p=this.xyChart)==null?void 0:p.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((_=this.xyChart)==null?void 0:_.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((E=this.xyChart)==null?void 0:E.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||mt(this.primaryColor,{h:-30}),this.git4=this.git4||mt(this.primaryColor,{h:-60}),this.git5=this.git5||mt(this.primaryColor,{h:-90}),this.git6=this.git6||mt(this.primaryColor,{h:60}),this.git7=this.git7||mt(this.primaryColor,{h:120}),this.darkMode?(this.git0=bn(this.git0,25),this.git1=bn(this.git1,25),this.git2=bn(this.git2,25),this.git3=bn(this.git3,25),this.git4=bn(this.git4,25),this.git5=bn(this.git5,25),this.git6=bn(this.git6,25),this.git7=bn(this.git7,25)):(this.git0=Nn(this.git0,25),this.git1=Nn(this.git1,25),this.git2=Nn(this.git2,25),this.git3=Nn(this.git3,25),this.git4=Nn(this.git4,25),this.git5=Nn(this.git5,25),this.git6=Nn(this.git6,25),this.git7=Nn(this.git7,25)),this.gitInv0=this.gitInv0||Nn(an(this.git0),25),this.gitInv1=this.gitInv1||an(this.git1),this.gitInv2=this.gitInv2||an(this.git2),this.gitInv3=this.gitInv3||an(this.git3),this.gitInv4=this.gitInv4||an(this.git4),this.gitInv5=this.gitInv5||an(this.git5),this.gitInv6=this.gitInv6||an(this.git6),this.gitInv7=this.gitInv7||an(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||an(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||an(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||LE,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||BE}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(t0,"Theme"),t0),tMe=ie(e=>{const t=new eMe;return t.calculate(e),t},"getThemeVariables"),n0,nMe=(n0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=bn("#cde498",10),this.primaryBorderColor=Pa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Pa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Pa(this.tertiaryColor,this.darkMode),this.primaryTextColor=an(this.primaryColor),this.secondaryTextColor=an(this.secondaryColor),this.tertiaryTextColor=an(this.primaryColor),this.lineColor=an(this.background),this.textColor=an(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,i,s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E;this.actorBorder=Nn(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||mt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||mt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||mt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||mt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||mt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||mt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||mt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||mt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||mt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Nn(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Nn(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Nn(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Nn(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||mt(this["cScale"+T],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||mt(this.mainBkg,{h:30,s:-30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||mt(this.mainBkg,{h:30,s:-30,l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||bn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||bn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=mt(this.primaryColor,{h:64}),this.fillType3=mt(this.secondaryColor,{h:64}),this.fillType4=mt(this.primaryColor,{h:-64}),this.fillType5=mt(this.secondaryColor,{h:-64}),this.fillType6=mt(this.primaryColor,{h:128}),this.fillType7=mt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||mt(this.primaryColor,{l:-30}),this.pie5=this.pie5||mt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||mt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||mt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||mt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||mt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||mt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||mt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||mt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||mt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||mt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||mt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||mt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||mt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||mt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c1(this.quadrant1Fill)?bn(this.quadrant1Fill):Nn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((s=this.radar)==null?void 0:s.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((p=this.xyChart)==null?void 0:p.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((_=this.xyChart)==null?void 0:_.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((E=this.xyChart)==null?void 0:E.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||mt(this.primaryColor,{h:-30}),this.git4=this.git4||mt(this.primaryColor,{h:-60}),this.git5=this.git5||mt(this.primaryColor,{h:-90}),this.git6=this.git6||mt(this.primaryColor,{h:60}),this.git7=this.git7||mt(this.primaryColor,{h:120}),this.darkMode?(this.git0=bn(this.git0,25),this.git1=bn(this.git1,25),this.git2=bn(this.git2,25),this.git3=bn(this.git3,25),this.git4=bn(this.git4,25),this.git5=bn(this.git5,25),this.git6=bn(this.git6,25),this.git7=bn(this.git7,25)):(this.git0=Nn(this.git0,25),this.git1=Nn(this.git1,25),this.git2=Nn(this.git2,25),this.git3=Nn(this.git3,25),this.git4=Nn(this.git4,25),this.git5=Nn(this.git5,25),this.git6=Nn(this.git6,25),this.git7=Nn(this.git7,25)),this.gitInv0=this.gitInv0||an(this.git0),this.gitInv1=this.gitInv1||an(this.git1),this.gitInv2=this.gitInv2||an(this.git2),this.gitInv3=this.gitInv3||an(this.git3),this.gitInv4=this.gitInv4||an(this.git4),this.gitInv5=this.gitInv5||an(this.git5),this.gitInv6=this.gitInv6||an(this.git6),this.gitInv7=this.gitInv7||an(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||an(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||an(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||LE,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||BE}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(n0,"Theme"),n0),rMe=ie(e=>{const t=new nMe;return t.calculate(e),t},"getThemeVariables"),r0,iMe=(r0=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=bn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=mt(this.primaryColor,{h:-160}),this.primaryBorderColor=Pa(this.primaryColor,this.darkMode),this.secondaryBorderColor=Pa(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Pa(this.tertiaryColor,this.darkMode),this.primaryTextColor=an(this.primaryColor),this.secondaryTextColor=an(this.secondaryColor),this.tertiaryTextColor=an(this.tertiaryColor),this.lineColor=an(this.background),this.textColor=an(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||bn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,i,s,a,o,l,c,u,d,h,p,y,b,x,w,_,S,C,E;this.secondBkg=bn(this.contrast,55),this.border2=this.contrast,this.actorBorder=bn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||an(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this.darkMode?this["cScalePeer"+T]=this["cScalePeer"+T]||bn(this["cScale"+T],10):this["cScalePeer"+T]=this["cScalePeer"+T]||Nn(this["cScale"+T],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||mt(this.mainBkg,{l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||mt(this.mainBkg,{l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=bn(this.contrast,30),this.sectionBkgColor2=bn(this.contrast,30),this.taskBorderColor=Nn(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=bn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=Nn(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=mt(this.primaryColor,{h:64}),this.fillType3=mt(this.secondaryColor,{h:64}),this.fillType4=mt(this.primaryColor,{h:-64}),this.fillType5=mt(this.secondaryColor,{h:-64}),this.fillType6=mt(this.primaryColor,{h:128}),this.fillType7=mt(this.secondaryColor,{h:128});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||mt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||mt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||mt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||mt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||mt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||mt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||c1(this.quadrant1Fill)?bn(this.quadrant1Fill):Nn(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((i=this.xyChart)==null?void 0:i.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((s=this.xyChart)==null?void 0:s.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((p=this.radar)==null?void 0:p.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((x=this.radar)==null?void 0:x.curveStrokeWidth)||2,graticuleColor:((w=this.radar)==null?void 0:w.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((_=this.radar)==null?void 0:_.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((C=this.radar)==null?void 0:C.legendBoxSize)||12,legendFontSize:((E=this.radar)==null?void 0:E.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Nn(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||mt(this.primaryColor,{h:-30}),this.git4=this.pie5||mt(this.primaryColor,{h:-60}),this.git5=this.pie6||mt(this.primaryColor,{h:-90}),this.git6=this.pie7||mt(this.primaryColor,{h:60}),this.git7=this.pie8||mt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||an(this.git0),this.gitInv1=this.gitInv1||an(this.git1),this.gitInv2=this.gitInv2||an(this.git2),this.gitInv3=this.gitInv3||an(this.git3),this.gitInv4=this.gitInv4||an(this.git4),this.gitInv5=this.gitInv5||an(this.git5),this.gitInv6=this.gitInv6||an(this.git6),this.gitInv7=this.gitInv7||an(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||LE,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||BE}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(r0,"Theme"),r0),sMe=ie(e=>{const t=new iMe;return t.calculate(e),t},"getThemeVariables"),ad={base:{getThemeVariables:XIe},dark:{getThemeVariables:QIe},default:{getThemeVariables:tMe},forest:{getThemeVariables:rMe},neutral:{getThemeVariables:sMe}},zu={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},EZ={...zu,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:ad.default.getThemeVariables(),sequence:{...zu.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...zu.gantt,tickInterval:void 0,useWidth:void 0},c4:{...zu.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...zu.pie,useWidth:984},xyChart:{...zu.xyChart,useWidth:void 0},requirement:{...zu.requirement,useWidth:void 0},packet:{...zu.packet},radar:{...zu.radar}},TZ=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...TZ(e[r],"")]:[...n,t+r],[]),"keyify"),aMe=new Set(TZ(EZ,"")),AZ=EZ,RC=ie(e=>{if(Lt.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>RC(t));return}for(const t of Object.keys(e)){if(Lt.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!aMe.has(t)||e[t]==null){Lt.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){Lt.debug("sanitizing object",t),RC(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(Lt.debug("sanitizing css option",t),e[t]=oMe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}Lt.debug("After sanitization",e)}},"sanitizeDirective"),oMe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),M0=Object.freeze(AZ),no=ra({},M0),RZ,N0=[],Ov=ra({},M0),$E=ie((e,t)=>{let n=ra({},e),r={};for(const i of t)NZ(i),r=ra(r,i);if(n=ra(n,r),r.theme&&r.theme in ad){const i=ra({},RZ),s=ra(i.themeVariables||{},r.themeVariables);n.theme&&n.theme in ad&&(n.themeVariables=ad[n.theme].getThemeVariables(s))}return Ov=n,jZ(Ov),Ov},"updateCurrentConfig"),lMe=ie(e=>(no=ra({},M0),no=ra(no,e),e.theme&&ad[e.theme]&&(no.themeVariables=ad[e.theme].getThemeVariables(e.themeVariables)),$E(no,N0),no),"setSiteConfig"),cMe=ie(e=>{RZ=ra({},e)},"saveConfigFromInitialize"),uMe=ie(e=>(no=ra(no,e),$E(no,N0),no),"updateSiteConfig"),IZ=ie(()=>ra({},no),"getSiteConfig"),MZ=ie(e=>(jZ(e),ra(Ov,e),ho()),"setConfig"),ho=ie(()=>ra({},Ov),"getConfig"),NZ=ie(e=>{e&&(["secure",...no.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(Lt.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&NZ(e[t])}))},"sanitize"),dMe=ie(e=>{var t;RC(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),N0.push(e),$E(no,N0)},"addDirective"),IC=ie((e=no)=>{N0=[],$E(e,N0)},"reset"),fMe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},iz={},hMe=ie(e=>{iz[e]||(Lt.warn(fMe[e]),iz[e]=!0)},"issueWarning"),jZ=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&hMe("LAZY_LOAD_DEPRECATED")},"checkConfig"),u1=/<br\s*\/?>/gi,pMe=ie(e=>e?DZ(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),mMe=(()=>{let e=!1;return()=>{e||(OZ(),e=!0)}})();function OZ(){const e="data-temp-href-target";R0.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),R0.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(OZ,"setupDompurifyHooks");var PZ=ie(e=>(mMe(),R0.sanitize(e)),"removeScript"),sz=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=PZ(e):r!=="loose"&&(e=DZ(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=vMe(e))}return e},"sanitizeMore"),Lp=ie((e,t)=>e&&(t.dompurifyConfig?e=R0.sanitize(sz(e,t),t.dompurifyConfig).toString():e=R0.sanitize(sz(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),gMe=ie((e,t)=>typeof e=="string"?Lp(e,t):e.flat().map(n=>Lp(n,t)),"sanitizeTextOrArray"),yMe=ie(e=>u1.test(e),"hasBreaks"),bMe=ie(e=>e.split(u1),"splitBreaks"),vMe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),DZ=ie(e=>e.replace(u1,"#br#"),"breakToPlaceholder"),xMe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Es=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),wMe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),_Me=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),az=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let i=t[r];if(i===","&&r>0&&r+1<t.length){const s=t[r-1],a=t[r+1];SMe(s,a)&&(i=s+","+a,r++,n.pop())}n.push(CMe(i))}return n.join("")},"parseGenericTypes"),oj=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),SMe=ie((e,t)=>{const n=oj(e,"~"),r=oj(t,"~");return n===1&&r===1},"shouldCombineSets"),CMe=ie(e=>{const t=oj(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let i=r.indexOf("~"),s=r.lastIndexOf("~");for(;i!==-1&&s!==-1&&i!==s;)r[i]="<",r[s]=">",i=r.indexOf("~"),s=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),oz=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),lj=/\$\$(.*)\$\$/g,j0=ie(e=>{var t;return(((t=e.match(lj))==null?void 0:t.length)??0)>0},"hasKatex"),kst=ie(async(e,t)=>{e=await RP(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const i={width:n.clientWidth,height:n.clientHeight};return n.remove(),i},"calculateMathMLDimensions"),RP=ie(async(e,t)=>{if(!j0(e))return e;if(!(oz()||t.legacyMathML||t.forceLegacyMathML))return e.replace(lj,"MathML is unsupported in this environment.");const{default:n}=await zr(async()=>{const{default:i}=await import("./katex-ChWnQ-fc.js");return{default:i}},[]),r=t.forceLegacyMathML||!oz()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(u1).map(i=>j0(i)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${i}</div>`:`<div>${i}</div>`).join("").replace(lj,(i,s)=>n.renderToString(s,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),gy={getRows:pMe,sanitizeText:Lp,sanitizeTextOrArray:gMe,hasBreaks:yMe,splitBreaks:bMe,lineBreakRegex:u1,removeScript:PZ,getUrl:xMe,evaluate:Es,getMax:wMe,getMin:_Me},kMe=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),EMe=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),FZ=ie(function(e,t,n,r){const i=EMe(t,n,r);kMe(e,i)},"configureSvgSize"),TMe=ie(function(e,t,n,r){const i=t.node().getBBox(),s=i.width,a=i.height;Lt.info(`SVG bounds: ${s}x${a}`,i);let o=0,l=0;Lt.info(`Graph bounds: ${o}x${l}`,e),o=s+n*2,l=a+n*2,Lt.info(`Calculated bounds: ${o}x${l}`),FZ(t,l,o,r);const c=`${i.x-n} ${i.y-n} ${i.width+2*n} ${i.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),s2={},AMe=ie((e,t,n)=>{let r="";return e in s2&&s2[e]?r=s2[e](n):Lt.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),RMe=ie((e,t)=>{t!==void 0&&(s2[e]=t)},"addStylesForDiagram"),IMe=AMe,LZ={};GIe(LZ,{clear:()=>MMe,getAccDescription:()=>PMe,getAccTitle:()=>jMe,getDiagramTitle:()=>FMe,setAccDescription:()=>OMe,setAccTitle:()=>NMe,setDiagramTitle:()=>DMe});var IP="",MP="",NP="",jP=ie(e=>Lp(e,ho()),"sanitizeText"),MMe=ie(()=>{IP="",NP="",MP=""},"clear"),NMe=ie(e=>{IP=jP(e).replace(/^\s+/g,"")},"setAccTitle"),jMe=ie(()=>IP,"getAccTitle"),OMe=ie(e=>{NP=jP(e).replace(/\n\s+/g,`
`)},"setAccDescription"),PMe=ie(()=>NP,"getAccDescription"),DMe=ie(e=>{MP=jP(e)},"setDiagramTitle"),FMe=ie(()=>MP,"getDiagramTitle"),lz=Lt,LMe=TP,Xr=ho,Est=MZ,Tst=M0,OP=ie(e=>Lp(e,Xr()),"sanitizeText"),BMe=TMe,$Me=ie(()=>LZ,"getCommonDb"),MC={},NC=ie((e,t,n)=>{var r;MC[e]&&lz.warn(`Diagram with id ${e} already registered. Overwriting.`),MC[e]=t,n&&kZ(e,n),RMe(e,t.styles),(r=t.injectUtils)==null||r.call(t,lz,LMe,Xr,OP,BMe,$Me(),()=>{})},"registerDiagram"),cj=ie(e=>{if(e in MC)return MC[e];throw new zMe(e)},"getDiagram"),i0,zMe=(i0=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(i0,"DiagramNotFoundError"),i0);function PP(e){return typeof e>"u"||e===null}ie(PP,"isNothing");function BZ(e){return typeof e=="object"&&e!==null}ie(BZ,"isObject");function $Z(e){return Array.isArray(e)?e:PP(e)?[]:[e]}ie($Z,"toArray");function zZ(e,t){var n,r,i,s;if(t)for(s=Object.keys(t),n=0,r=s.length;n<r;n+=1)i=s[n],e[i]=t[i];return e}ie(zZ,"extend");function UZ(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(UZ,"repeat");function qZ(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(qZ,"isNegativeZero");var UMe=PP,qMe=BZ,VMe=$Z,HMe=UZ,WMe=qZ,GMe=zZ,Ss={isNothing:UMe,isObject:qMe,toArray:VMe,repeat:HMe,isNegativeZero:WMe,extend:GMe};function DP(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(DP,"formatError");function O0(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=DP(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(O0,"YAMLException$1");O0.prototype=Object.create(Error.prototype);O0.prototype.constructor=O0;O0.prototype.toString=ie(function(t){return this.name+": "+DP(this,t)},"toString");var oo=O0;function a2(e,t,n,r,i){var s="",a="",o=Math.floor(i/2)-1;return r-t>o&&(s=" ... ",t=r-o+s.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:s+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+s.length}}ie(a2,"getLine");function o2(e,t){return Ss.repeat(" ",t-e.length)+e}ie(o2,"padStart");function VZ(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],i=[],s,a=-1;s=n.exec(e.buffer);)i.push(s.index),r.push(s.index+s[0].length),e.position<=s.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,i.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=a2(e.buffer,r[a-l],i[a-l],e.position-(r[a]-r[a-l]),d),o=Ss.repeat(" ",t.indent)+o2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=a2(e.buffer,r[a],i[a],e.position,d),o+=Ss.repeat(" ",t.indent)+o2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=Ss.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=i.length);l++)c=a2(e.buffer,r[a+l],i[a+l],e.position-(r[a]-r[a+l]),d),o+=Ss.repeat(" ",t.indent)+o2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(VZ,"makeSnippet");var KMe=VZ,YMe=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],ZMe=["scalar","sequence","mapping"];function HZ(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(HZ,"compileStyleAliases");function WZ(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(YMe.indexOf(n)===-1)throw new oo('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=HZ(t.styleAliases||null),ZMe.indexOf(this.kind)===-1)throw new oo('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(WZ,"Type$1");var ba=WZ;function uj(e,t){var n=[];return e[t].forEach(function(r){var i=n.length;n.forEach(function(s,a){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(i=a)}),n[i]=r}),n}ie(uj,"compileList");function GZ(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(GZ,"compileMap");function jC(e){return this.extend(e)}ie(jC,"Schema$1");jC.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof ba)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new oo("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(s){if(!(s instanceof ba))throw new oo("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new oo("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new oo("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof ba))throw new oo("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(jC.prototype);return i.implicit=(this.implicit||[]).concat(n),i.explicit=(this.explicit||[]).concat(r),i.compiledImplicit=uj(i,"implicit"),i.compiledExplicit=uj(i,"explicit"),i.compiledTypeMap=GZ(i.compiledImplicit,i.compiledExplicit),i},"extend");var XMe=jC,JMe=new ba("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),QMe=new ba("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),eNe=new ba("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),tNe=new XMe({explicit:[JMe,QMe,eNe]});function KZ(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(KZ,"resolveYamlNull");function YZ(){return null}ie(YZ,"constructYamlNull");function ZZ(e){return e===null}ie(ZZ,"isNull");var nNe=new ba("tag:yaml.org,2002:null",{kind:"scalar",resolve:KZ,construct:YZ,predicate:ZZ,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function XZ(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(XZ,"resolveYamlBoolean");function JZ(e){return e==="true"||e==="True"||e==="TRUE"}ie(JZ,"constructYamlBoolean");function QZ(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(QZ,"isBoolean");var rNe=new ba("tag:yaml.org,2002:bool",{kind:"scalar",resolve:XZ,construct:JZ,predicate:QZ,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function eX(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(eX,"isHexCode");function tX(e){return 48<=e&&e<=55}ie(tX,"isOctCode");function nX(e){return 48<=e&&e<=57}ie(nX,"isDecCode");function rX(e){if(e===null)return!1;var t=e.length,n=0,r=!1,i;if(!t)return!1;if(i=e[n],(i==="-"||i==="+")&&(i=e[++n]),i==="0"){if(n+1===t)return!0;if(i=e[++n],i==="b"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(i!=="0"&&i!=="1")return!1;r=!0}return r&&i!=="_"}if(i==="x"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!eX(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}if(i==="o"){for(n++;n<t;n++)if(i=e[n],i!=="_"){if(!tX(e.charCodeAt(n)))return!1;r=!0}return r&&i!=="_"}}if(i==="_")return!1;for(;n<t;n++)if(i=e[n],i!=="_"){if(!nX(e.charCodeAt(n)))return!1;r=!0}return!(!r||i==="_")}ie(rX,"resolveYamlInteger");function iX(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(iX,"constructYamlInteger");function sX(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!Ss.isNegativeZero(e)}ie(sX,"isInteger");var iNe=new ba("tag:yaml.org,2002:int",{kind:"scalar",resolve:rX,construct:iX,predicate:sX,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),sNe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function aX(e){return!(e===null||!sNe.test(e)||e[e.length-1]==="_")}ie(aX,"resolveYamlFloat");function oX(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(oX,"constructYamlFloat");var aNe=/^[-+]?[0-9]+e/;function lX(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Ss.isNegativeZero(e))return"-0.0";return n=e.toString(10),aNe.test(n)?n.replace("e",".e"):n}ie(lX,"representYamlFloat");function cX(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||Ss.isNegativeZero(e))}ie(cX,"isFloat");var oNe=new ba("tag:yaml.org,2002:float",{kind:"scalar",resolve:aX,construct:oX,predicate:cX,represent:lX,defaultStyle:"lowercase"}),uX=tNe.extend({implicit:[nNe,rNe,iNe,oNe]}),lNe=uX,dX=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),fX=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function hX(e){return e===null?!1:dX.exec(e)!==null||fX.exec(e)!==null}ie(hX,"resolveYamlTimestamp");function pX(e){var t,n,r,i,s,a,o,l=0,c=null,u,d,h;if(t=dX.exec(e),t===null&&(t=fX.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,r,i));if(s=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,i,s,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(pX,"constructYamlTimestamp");function mX(e){return e.toISOString()}ie(mX,"representYamlTimestamp");var cNe=new ba("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:hX,construct:pX,instanceOf:Date,represent:mX});function gX(e){return e==="<<"||e===null}ie(gX,"resolveYamlMerge");var uNe=new ba("tag:yaml.org,2002:merge",{kind:"scalar",resolve:gX}),FP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function yX(e){if(e===null)return!1;var t,n,r=0,i=e.length,s=FP;for(n=0;n<i;n++)if(t=s.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(yX,"resolveYamlBinary");function bX(e){var t,n,r=e.replace(/[\r\n=]/g,""),i=r.length,s=FP,a=0,o=[];for(t=0;t<i;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|s.indexOf(r.charAt(t));return n=i%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie(bX,"constructYamlBinary");function vX(e){var t="",n=0,r,i,s=e.length,a=FP;for(r=0;r<s;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return i=s%3,i===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):i===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):i===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(vX,"representYamlBinary");function xX(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(xX,"isBinary");var dNe=new ba("tag:yaml.org,2002:binary",{kind:"scalar",resolve:yX,construct:bX,predicate:xX,represent:vX}),fNe=Object.prototype.hasOwnProperty,hNe=Object.prototype.toString;function wX(e){if(e===null)return!0;var t=[],n,r,i,s,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(i=o[n],a=!1,hNe.call(i)!=="[object Object]")return!1;for(s in i)if(fNe.call(i,s))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(s)===-1)t.push(s);else return!1}return!0}ie(wX,"resolveYamlOmap");function _X(e){return e!==null?e:[]}ie(_X,"constructYamlOmap");var pNe=new ba("tag:yaml.org,2002:omap",{kind:"sequence",resolve:wX,construct:_X}),mNe=Object.prototype.toString;function SX(e){if(e===null)return!0;var t,n,r,i,s,a=e;for(s=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],mNe.call(r)!=="[object Object]"||(i=Object.keys(r),i.length!==1))return!1;s[t]=[i[0],r[i[0]]]}return!0}ie(SX,"resolveYamlPairs");function CX(e){if(e===null)return[];var t,n,r,i,s,a=e;for(s=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],i=Object.keys(r),s[t]=[i[0],r[i[0]]];return s}ie(CX,"constructYamlPairs");var gNe=new ba("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:SX,construct:CX}),yNe=Object.prototype.hasOwnProperty;function kX(e){if(e===null)return!0;var t,n=e;for(t in n)if(yNe.call(n,t)&&n[t]!==null)return!1;return!0}ie(kX,"resolveYamlSet");function EX(e){return e!==null?e:{}}ie(EX,"constructYamlSet");var bNe=new ba("tag:yaml.org,2002:set",{kind:"mapping",resolve:kX,construct:EX}),TX=lNe.extend({implicit:[cNe,uNe],explicit:[dNe,pNe,gNe,bNe]}),Zf=Object.prototype.hasOwnProperty,OC=1,AX=2,RX=3,PC=4,XM=1,vNe=2,cz=3,xNe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,wNe=/[\x85\u2028\u2029]/,_Ne=/[,\[\]\{\}]/,IX=/^(?:!|!!|![a-z\-]+!)$/i,MX=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function dj(e){return Object.prototype.toString.call(e)}ie(dj,"_class");function ec(e){return e===10||e===13}ie(ec,"is_EOL");function Rf(e){return e===9||e===32}ie(Rf,"is_WHITE_SPACE");function Da(e){return e===9||e===32||e===10||e===13}ie(Da,"is_WS_OR_EOL");function hp(e){return e===44||e===91||e===93||e===123||e===125}ie(hp,"is_FLOW_INDICATOR");function NX(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(NX,"fromHexCode");function jX(e){return e===120?2:e===117?4:e===85?8:0}ie(jX,"escapedHexLen");function OX(e){return 48<=e&&e<=57?e-48:-1}ie(OX,"fromDecimalCode");function fj(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}ie(fj,"simpleEscapeSequence");function PX(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(PX,"charFromCodepoint");var DX=new Array(256),FX=new Array(256);for(Qh=0;Qh<256;Qh++)DX[Qh]=fj(Qh)?1:0,FX[Qh]=fj(Qh);var Qh;function LX(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||TX,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(LX,"State$1");function LP(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=KMe(n),new oo(t,n)}ie(LP,"generateError");function An(e,t){throw LP(e,t)}ie(An,"throwError");function $x(e,t){e.onWarning&&e.onWarning.call(null,LP(e,t))}ie($x,"throwWarning");var uz={YAML:ie(function(t,n,r){var i,s,a;t.version!==null&&An(t,"duplication of %YAML directive"),r.length!==1&&An(t,"YAML directive accepts exactly one argument"),i=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),i===null&&An(t,"ill-formed argument of the YAML directive"),s=parseInt(i[1],10),a=parseInt(i[2],10),s!==1&&An(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&$x(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var i,s;r.length!==2&&An(t,"TAG directive accepts exactly two arguments"),i=r[0],s=r[1],IX.test(i)||An(t,"ill-formed tag handle (first argument) of the TAG directive"),Zf.call(t.tagMap,i)&&An(t,'there is a previously declared suffix for "'+i+'" tag handle'),MX.test(s)||An(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{An(t,"tag prefix is malformed: "+s)}t.tagMap[i]=s},"handleTagDirective")};function od(e,t,n,r){var i,s,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(i=0,s=o.length;i<s;i+=1)a=o.charCodeAt(i),a===9||32<=a&&a<=1114111||An(e,"expected valid JSON character");else xNe.test(o)&&An(e,"the stream contains non-printable characters");e.result+=o}}ie(od,"captureSegment");function hj(e,t,n,r){var i,s,a,o;for(Ss.isObject(n)||An(e,"cannot merge mappings; the provided source object is unacceptable"),i=Object.keys(n),a=0,o=i.length;a<o;a+=1)s=i[a],Zf.call(t,s)||(t[s]=n[s],r[s]=!0)}ie(hj,"mergeMappings");function pp(e,t,n,r,i,s,a,o,l){var c,u;if(Array.isArray(i))for(i=Array.prototype.slice.call(i),c=0,u=i.length;c<u;c+=1)Array.isArray(i[c])&&An(e,"nested arrays are not supported inside keys"),typeof i=="object"&&dj(i[c])==="[object Object]"&&(i[c]="[object Object]");if(typeof i=="object"&&dj(i)==="[object Object]"&&(i="[object Object]"),i=String(i),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(c=0,u=s.length;c<u;c+=1)hj(e,t,s[c],n);else hj(e,t,s,n);else!e.json&&!Zf.call(n,i)&&Zf.call(t,i)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,An(e,"duplicated mapping key")),i==="__proto__"?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[i]=s,delete n[i];return t}ie(pp,"storeMappingPair");function zE(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):An(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(zE,"readLineBreak");function ts(e,t,n){for(var r=0,i=e.input.charCodeAt(e.position);i!==0;){for(;Rf(i);)i===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&i===35)do i=e.input.charCodeAt(++e.position);while(i!==10&&i!==13&&i!==0);if(ec(i))for(zE(e),i=e.input.charCodeAt(e.position),r++,e.lineIndent=0;i===32;)e.lineIndent++,i=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&$x(e,"deficient indentation"),r}ie(ts,"skipSeparationSpace");function d1(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||Da(n)))}ie(d1,"testDocumentSeparator");function UE(e,t){t===1?e.result+=" ":t>1&&(e.result+=Ss.repeat(`
`,t-1))}ie(UE,"writeFoldedLines");function BX(e,t,n){var r,i,s,a,o,l,c,u,d=e.kind,h=e.result,p;if(p=e.input.charCodeAt(e.position),Da(p)||hp(p)||p===35||p===38||p===42||p===33||p===124||p===62||p===39||p===34||p===37||p===64||p===96||(p===63||p===45)&&(i=e.input.charCodeAt(e.position+1),Da(i)||n&&hp(i)))return!1;for(e.kind="scalar",e.result="",s=a=e.position,o=!1;p!==0;){if(p===58){if(i=e.input.charCodeAt(e.position+1),Da(i)||n&&hp(i))break}else if(p===35){if(r=e.input.charCodeAt(e.position-1),Da(r))break}else{if(e.position===e.lineStart&&d1(e)||n&&hp(p))break;if(ec(p))if(l=e.line,c=e.lineStart,u=e.lineIndent,ts(e,!1,-1),e.lineIndent>=t){o=!0,p=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(od(e,s,a,!1),UE(e,e.line-l),s=a=e.position,o=!1),Rf(p)||(a=e.position+1),p=e.input.charCodeAt(++e.position)}return od(e,s,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(BX,"readPlainScalar");function $X(e,t){var n,r,i;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=i=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(od(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,i=e.position;else return!0;else ec(n)?(od(e,r,i,!0),UE(e,ts(e,!1,t)),r=i=e.position):e.position===e.lineStart&&d1(e)?An(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);An(e,"unexpected end of the stream within a single quoted scalar")}ie($X,"readSingleQuotedScalar");function zX(e,t){var n,r,i,s,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return od(e,n,e.position,!0),e.position++,!0;if(o===92){if(od(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),ec(o))ts(e,!1,t);else if(o<256&&DX[o])e.result+=FX[o],e.position++;else if((a=jX(o))>0){for(i=a,s=0;i>0;i--)o=e.input.charCodeAt(++e.position),(a=NX(o))>=0?s=(s<<4)+a:An(e,"expected hexadecimal character");e.result+=PX(s),e.position++}else An(e,"unknown escape sequence");n=r=e.position}else ec(o)?(od(e,n,r,!0),UE(e,ts(e,!1,t)),n=r=e.position):e.position===e.lineStart&&d1(e)?An(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}An(e,"unexpected end of the stream within a double quoted scalar")}ie(zX,"readDoubleQuotedScalar");function UX(e,t){var n=!0,r,i,s,a=e.tag,o,l=e.anchor,c,u,d,h,p,y=Object.create(null),b,x,w,_;if(_=e.input.charCodeAt(e.position),_===91)u=93,p=!1,o=[];else if(_===123)u=125,p=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),_=e.input.charCodeAt(++e.position);_!==0;){if(ts(e,!0,t),_=e.input.charCodeAt(e.position),_===u)return e.position++,e.tag=a,e.anchor=l,e.kind=p?"mapping":"sequence",e.result=o,!0;n?_===44&&An(e,"expected the node content, but found ','"):An(e,"missed comma between flow collection entries"),x=b=w=null,d=h=!1,_===63&&(c=e.input.charCodeAt(e.position+1),Da(c)&&(d=h=!0,e.position++,ts(e,!0,t))),r=e.line,i=e.lineStart,s=e.position,Bp(e,t,OC,!1,!0),x=e.tag,b=e.result,ts(e,!0,t),_=e.input.charCodeAt(e.position),(h||e.line===r)&&_===58&&(d=!0,_=e.input.charCodeAt(++e.position),ts(e,!0,t),Bp(e,t,OC,!1,!0),w=e.result),p?pp(e,o,y,x,b,w,r,i,s):d?o.push(pp(e,null,y,x,b,w,r,i,s)):o.push(b),ts(e,!0,t),_=e.input.charCodeAt(e.position),_===44?(n=!0,_=e.input.charCodeAt(++e.position)):n=!1}An(e,"unexpected end of the stream within a flow collection")}ie(UX,"readFlowCollection");function qX(e,t){var n,r,i=XM,s=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)XM===i?i=d===43?cz:vNe:An(e,"repeat of a chomping mode identifier");else if((u=OX(d))>=0)u===0?An(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?An(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(Rf(d)){do d=e.input.charCodeAt(++e.position);while(Rf(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!ec(d)&&d!==0)}for(;d!==0;){for(zE(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),ec(d)){l++;continue}if(e.lineIndent<o){i===cz?e.result+=Ss.repeat(`
`,s?1+l:l):i===XM&&s&&(e.result+=`
`);break}for(r?Rf(d)?(c=!0,e.result+=Ss.repeat(`
`,s?1+l:l)):c?(c=!1,e.result+=Ss.repeat(`
`,l+1)):l===0?s&&(e.result+=" "):e.result+=Ss.repeat(`
`,l):e.result+=Ss.repeat(`
`,s?1+l:l),s=!0,a=!0,l=0,n=e.position;!ec(d)&&d!==0;)d=e.input.charCodeAt(++e.position);od(e,n,e.position,!1)}return!0}ie(qX,"readBlockScalar");function pj(e,t){var n,r=e.tag,i=e.anchor,s=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=s),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,An(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!Da(a))));){if(o=!0,e.position++,ts(e,!0,-1)&&e.lineIndent<=t){s.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,Bp(e,t,RX,!1,!0),s.push(e.result),ts(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)An(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=i,e.kind="sequence",e.result=s,!0):!1}ie(pj,"readBlockSequence");function VX(e,t,n){var r,i,s,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),p=null,y=null,b=null,x=!1,w=!1,_;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),_=e.input.charCodeAt(e.position);_!==0;){if(!x&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,An(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,(_===63||_===58)&&Da(r))_===63?(x&&(pp(e,d,h,p,y,null,a,o,l),p=y=b=null),w=!0,x=!0,i=!0):x?(x=!1,i=!0):An(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,_=r;else{if(a=e.line,o=e.lineStart,l=e.position,!Bp(e,n,AX,!1,!0))break;if(e.line===s){for(_=e.input.charCodeAt(e.position);Rf(_);)_=e.input.charCodeAt(++e.position);if(_===58)_=e.input.charCodeAt(++e.position),Da(_)||An(e,"a whitespace character is expected after the key-value separator within a block mapping"),x&&(pp(e,d,h,p,y,null,a,o,l),p=y=b=null),w=!0,x=!1,i=!1,p=e.tag,y=e.result;else if(w)An(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(w)An(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===s||e.lineIndent>t)&&(x&&(a=e.line,o=e.lineStart,l=e.position),Bp(e,t,PC,!0,i)&&(x?y=e.result:b=e.result),x||(pp(e,d,h,p,y,b,a,o,l),p=y=b=null),ts(e,!0,-1),_=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&_!==0)An(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return x&&pp(e,d,h,p,y,null,a,o,l),w&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),w}ie(VX,"readBlockMapping");function HX(e){var t,n=!1,r=!1,i,s,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&An(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,i="!!",a=e.input.charCodeAt(++e.position)):i="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(s=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):An(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!Da(a);)a===33&&(r?An(e,"tag suffix cannot contain exclamation marks"):(i=e.input.slice(t-1,e.position+1),IX.test(i)||An(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);s=e.input.slice(t,e.position),_Ne.test(s)&&An(e,"tag suffix cannot contain flow indicator characters")}s&&!MX.test(s)&&An(e,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{An(e,"tag name is malformed: "+s)}return n?e.tag=s:Zf.call(e.tagMap,i)?e.tag=e.tagMap[i]+s:i==="!"?e.tag="!"+s:i==="!!"?e.tag="tag:yaml.org,2002:"+s:An(e,'undeclared tag handle "'+i+'"'),!0}ie(HX,"readTagProperty");function WX(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&An(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!Da(n)&&!hp(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&An(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(WX,"readAnchorProperty");function GX(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!Da(r)&&!hp(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&An(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Zf.call(e.anchorMap,n)||An(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],ts(e,!0,-1),!0}ie(GX,"readAlias");function Bp(e,t,n,r,i){var s,a,o,l=1,c=!1,u=!1,d,h,p,y,b,x;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=a=o=PC===n||RX===n,r&&ts(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;HX(e)||WX(e);)ts(e,!0,-1)?(c=!0,o=s,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||i),(l===1||PC===n)&&(OC===n||AX===n?b=t:b=t+1,x=e.position-e.lineStart,l===1?o&&(pj(e,x)||VX(e,x,b))||UX(e,b)?u=!0:(a&&qX(e,b)||$X(e,b)||zX(e,b)?u=!0:GX(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&An(e,"alias node should not have any properties")):BX(e,b,OC===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&pj(e,x))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&An(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Zf.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,p=e.typeMap.multi[e.kind||"fallback"],d=0,h=p.length;d<h;d+=1)if(e.tag.slice(0,p[d].tag.length)===p[d].tag){y=p[d];break}y||An(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&An(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):An(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie(Bp,"composeNode");function KX(e){var t=e.position,n,r,i,s=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(ts(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(s=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!Da(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),i=[],r.length<1&&An(e,"directive name must not be less than one character in length");a!==0;){for(;Rf(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!ec(a));break}if(ec(a))break;for(n=e.position;a!==0&&!Da(a);)a=e.input.charCodeAt(++e.position);i.push(e.input.slice(n,e.position))}a!==0&&zE(e),Zf.call(uz,r)?uz[r](e,r,i):$x(e,'unknown document directive "'+r+'"')}if(ts(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,ts(e,!0,-1)):s&&An(e,"directives end mark is expected"),Bp(e,e.lineIndent-1,PC,!1,!0),ts(e,!0,-1),e.checkLineBreaks&&wNe.test(e.input.slice(t,e.position))&&$x(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&d1(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,ts(e,!0,-1));return}if(e.position<e.length-1)An(e,"end of the stream or a document separator is expected");else return}ie(KX,"readDocument");function BP(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new LX(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,An(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)KX(n);return n.documents}ie(BP,"loadDocuments");function SNe(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=BP(e,n);if(typeof t!="function")return r;for(var i=0,s=r.length;i<s;i+=1)t(r[i])}ie(SNe,"loadAll$1");function YX(e,t){var n=BP(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new oo("expected a single document in the stream, but found more")}}ie(YX,"load$1");var CNe=YX,kNe={load:CNe},ZX=Object.prototype.toString,XX=Object.prototype.hasOwnProperty,$P=65279,ENe=9,zx=10,TNe=13,ANe=32,RNe=33,INe=34,mj=35,MNe=37,NNe=38,jNe=39,ONe=42,JX=44,PNe=45,DC=58,DNe=61,FNe=62,LNe=63,BNe=64,QX=91,eJ=93,$Ne=96,tJ=123,zNe=124,nJ=125,Ea={};Ea[0]="\\0";Ea[7]="\\a";Ea[8]="\\b";Ea[9]="\\t";Ea[10]="\\n";Ea[11]="\\v";Ea[12]="\\f";Ea[13]="\\r";Ea[27]="\\e";Ea[34]='\\"';Ea[92]="\\\\";Ea[133]="\\N";Ea[160]="\\_";Ea[8232]="\\L";Ea[8233]="\\P";var UNe=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],qNe=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function rJ(e,t){var n,r,i,s,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),i=0,s=r.length;i<s;i+=1)a=r[i],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&XX.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(rJ,"compileStyleMap");function iJ(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new oo("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+Ss.repeat("0",r-t.length)+t}ie(iJ,"encodeHex");var VNe=1,Ux=2;function sJ(e){this.schema=e.schema||TX,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Ss.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=rJ(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?Ux:VNe,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(sJ,"State");function gj(e,t){for(var n=Ss.repeat(" ",t),r=0,i=-1,s="",a,o=e.length;r<o;)i=e.indexOf(`
`,r),i===-1?(a=e.slice(r),r=o):(a=e.slice(r,i+1),r=i+1),a.length&&a!==`
`&&(s+=n),s+=a;return s}ie(gj,"indentString");function FC(e,t){return`
`+Ss.repeat(" ",e.indent*t)}ie(FC,"generateNextLine");function aJ(e,t){var n,r,i;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(i=e.implicitTypes[n],i.resolve(t))return!0;return!1}ie(aJ,"testImplicitResolving");function qx(e){return e===ANe||e===ENe}ie(qx,"isWhitespace");function P0(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==$P||65536<=e&&e<=1114111}ie(P0,"isPrintable");function yj(e){return P0(e)&&e!==$P&&e!==TNe&&e!==zx}ie(yj,"isNsCharOrWhitespace");function bj(e,t,n){var r=yj(e),i=r&&!qx(e);return(n?r:r&&e!==JX&&e!==QX&&e!==eJ&&e!==tJ&&e!==nJ)&&e!==mj&&!(t===DC&&!i)||yj(t)&&!qx(t)&&e===mj||t===DC&&i}ie(bj,"isPlainSafe");function oJ(e){return P0(e)&&e!==$P&&!qx(e)&&e!==PNe&&e!==LNe&&e!==DC&&e!==JX&&e!==QX&&e!==eJ&&e!==tJ&&e!==nJ&&e!==mj&&e!==NNe&&e!==ONe&&e!==RNe&&e!==zNe&&e!==DNe&&e!==FNe&&e!==jNe&&e!==INe&&e!==MNe&&e!==BNe&&e!==$Ne}ie(oJ,"isPlainSafeFirst");function lJ(e){return!qx(e)&&e!==DC}ie(lJ,"isPlainSafeLast");function Rg(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(Rg,"codePointAt");function zP(e){var t=/^\n* /;return t.test(e)}ie(zP,"needIndentIndicator");var cJ=1,vj=2,uJ=3,dJ=4,wg=5;function fJ(e,t,n,r,i,s,a,o){var l,c=0,u=null,d=!1,h=!1,p=r!==-1,y=-1,b=oJ(Rg(e,0))&&lJ(Rg(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=Rg(e,l),!P0(c))return wg;b=b&&bj(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=Rg(e,l),c===zx)d=!0,p&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!P0(c))return wg;b=b&&bj(c,u,o),u=c}h=h||p&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!i(e)?cJ:s===Ux?wg:vj:n>9&&zP(e)?wg:a?s===Ux?wg:vj:h?dJ:uJ}ie(fJ,"chooseScalarStyle");function hJ(e,t,n,r,i){e.dump=function(){if(t.length===0)return e.quotingType===Ux?'""':"''";if(!e.noCompatMode&&(UNe.indexOf(t)!==-1||qNe.test(t)))return e.quotingType===Ux?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return aJ(e,c)}switch(ie(l,"testAmbiguity"),fJ(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,i)){case cJ:return t;case vj:return"'"+t.replace(/'/g,"''")+"'";case uJ:return"|"+xj(t,e.indent)+wj(gj(t,s));case dJ:return">"+xj(t,e.indent)+wj(gj(pJ(t,a),s));case wg:return'"'+mJ(t)+'"';default:throw new oo("impossible error: invalid scalar style")}}()}ie(hJ,"writeScalar");function xj(e,t){var n=zP(e)?String(t):"",r=e[e.length-1]===`
`,i=r&&(e[e.length-2]===`
`||e===`
`),s=i?"+":r?"":"-";return n+s+`
`}ie(xj,"blockHeader");function wj(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(wj,"dropEndingNewline");function pJ(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,_j(e.slice(0,c),t)}(),i=e[0]===`
`||e[0]===" ",s,a;a=n.exec(e);){var o=a[1],l=a[2];s=l[0]===" ",r+=o+(!i&&!s&&l!==""?`
`:"")+_j(l,t),i=s}return r}ie(pJ,"foldString");function _j(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,i=0,s,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-i>t&&(s=a>i?a:o,l+=`
`+e.slice(i,s),i=s+1),a=o;return l+=`
`,e.length-i>t&&a>i?l+=e.slice(i,a)+`
`+e.slice(a+1):l+=e.slice(i),l.slice(1)}ie(_j,"foldLine");function mJ(e){for(var t="",n=0,r,i=0;i<e.length;n>=65536?i+=2:i++)n=Rg(e,i),r=Ea[n],!r&&P0(n)?(t+=e[i],n>=65536&&(t+=e[i+1])):t+=r||iJ(n);return t}ie(mJ,"escapeString");function gJ(e,t,n){var r="",i=e.tag,s,a,o;for(s=0,a=n.length;s<a;s+=1)o=n[s],e.replacer&&(o=e.replacer.call(n,String(s),o)),(au(e,t,o,!1,!1)||typeof o>"u"&&au(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=i,e.dump="["+r+"]"}ie(gJ,"writeFlowSequence");function Sj(e,t,n,r){var i="",s=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(au(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&au(e,t+1,null,!0,!0,!1,!0))&&((!r||i!=="")&&(i+=FC(e,t)),e.dump&&zx===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}ie(Sj,"writeBlockSequence");function yJ(e,t,n){var r="",i=e.tag,s=Object.keys(n),a,o,l,c,u;for(a=0,o=s.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=s[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),au(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),au(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=i,e.dump="{"+r+"}"}ie(yJ,"writeFlowMapping");function bJ(e,t,n,r){var i="",s=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new oo("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||i!=="")&&(h+=FC(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),au(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&zx===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=FC(e,t)),au(e,t+1,u,!0,d)&&(e.dump&&zx===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,i+=h));e.tag=s,e.dump=i||"{}"}ie(bJ,"writeBlockMapping");function Cj(e,t,n){var r,i,s,a,o,l;for(i=n?e.explicitTypes:e.implicitTypes,s=0,a=i.length;s<a;s+=1)if(o=i[s],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,ZX.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(XX.call(o.represent,l))r=o.represent[l](t,l);else throw new oo("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(Cj,"detectType");function au(e,t,n,r,i,s,a){e.tag=null,e.dump=n,Cj(e,n,!1)||Cj(e,n,!0);var o=ZX.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(i=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?(bJ(e,t,e.dump,i),h&&(e.dump="&ref_"+d+e.dump)):(yJ(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?Sj(e,t-1,e.dump,i):Sj(e,t,e.dump,i),h&&(e.dump="&ref_"+d+e.dump)):(gJ(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&hJ(e,e.dump,t,s,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new oo("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(au,"writeNode");function vJ(e,t){var n=[],r=[],i,s;for(LC(e,n,r),i=0,s=r.length;i<s;i+=1)t.duplicates.push(n[r[i]]);t.usedDuplicates=new Array(s)}ie(vJ,"getDuplicateReferences");function LC(e,t,n){var r,i,s;if(e!==null&&typeof e=="object")if(i=t.indexOf(e),i!==-1)n.indexOf(i)===-1&&n.push(i);else if(t.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)LC(e[i],t,n);else for(r=Object.keys(e),i=0,s=r.length;i<s;i+=1)LC(e[r[i]],t,n)}ie(LC,"inspectNode");function HNe(e,t){t=t||{};var n=new sJ(t);n.noRefs||vJ(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),au(n,0,r,!0,!0)?n.dump+`
`:""}ie(HNe,"dump$1");function WNe(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(WNe,"renamed");var GNe=uX,KNe=kNe.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var al={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function gv(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=ji(e),t=ji(t);const[n,r]=[e.x,e.y],[i,s]=[t.x,t.y],a=i-n,o=s-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(gv,"calculateDeltaAndAngle");var ji=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),YNe=ie(e=>({x:ie(function(t,n,r){let i=0;const s=ji(r[0]).x<ji(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(al,e.arrowTypeStart)){const{angle:p,deltaX:y}=gv(r[0],r[1]);i=al[e.arrowTypeStart]*Math.cos(p)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(al,e.arrowTypeEnd)){const{angle:p,deltaX:y}=gv(r[r.length-1],r[r.length-2]);i=al[e.arrowTypeEnd]*Math.cos(p)*(y>=0?1:-1)}const a=Math.abs(ji(t).x-ji(r[r.length-1]).x),o=Math.abs(ji(t).y-ji(r[r.length-1]).y),l=Math.abs(ji(t).x-ji(r[0]).x),c=Math.abs(ji(t).y-ji(r[0]).y),u=al[e.arrowTypeStart],d=al[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let p=d+h-a;p*=s==="right"?-1:1,i-=p}if(l<u&&l>0&&c<u){let p=u+h-l;p*=s==="right"?-1:1,i+=p}return ji(t).x+i},"x"),y:ie(function(t,n,r){let i=0;const s=ji(r[0]).y<ji(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(al,e.arrowTypeStart)){const{angle:p,deltaY:y}=gv(r[0],r[1]);i=al[e.arrowTypeStart]*Math.abs(Math.sin(p))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(al,e.arrowTypeEnd)){const{angle:p,deltaY:y}=gv(r[r.length-1],r[r.length-2]);i=al[e.arrowTypeEnd]*Math.abs(Math.sin(p))*(y>=0?1:-1)}const a=Math.abs(ji(t).y-ji(r[r.length-1]).y),o=Math.abs(ji(t).x-ji(r[r.length-1]).x),l=Math.abs(ji(t).y-ji(r[0]).y),c=Math.abs(ji(t).x-ji(r[0]).x),u=al[e.arrowTypeStart],d=al[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let p=d+h-a;p*=s==="up"?-1:1,i-=p}if(l<u&&l>0&&c<u){let p=u+h-l;p*=s==="up"?-1:1,i+=p}return ji(t).y+i},"y")}),"getLineFunctionsWithOffset"),UP=ie(({flowchart:e})=>{var i,s;const t=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.top)??0,n=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const ZNe=Object.freeze({left:0,top:0,width:16,height:16}),BC=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),xJ=Object.freeze({...ZNe,...BC}),XNe=Object.freeze({...xJ,body:"",hidden:!1}),JNe=Object.freeze({width:null,height:null}),QNe=Object.freeze({...JNe,...BC}),e3e=(e,t,n,r="")=>{const i=e.split(":");if(e.slice(0,1)==="@"){if(i.length<2||i.length>3)return null;r=i.shift().slice(1)}if(i.length>3||!i.length)return null;if(i.length>1){const o=i.pop(),l=i.pop(),c={provider:i.length>0?i[0]:r,prefix:l,name:o};return JM(c)?c:null}const s=i[0],a=s.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return JM(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:s};return JM(o,n)?o:null}return null},JM=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function t3e(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function dz(e,t){const n=t3e(e,t);for(const r in XNe)r in BC?r in e&&!(r in n)&&(n[r]=BC[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function n3e(e,t){const n=e.icons,r=e.aliases||Object.create(null),i=Object.create(null);function s(a){if(n[a])return i[a]=[];if(!(a in i)){i[a]=null;const o=r[a]&&r[a].parent,l=o&&s(o);l&&(i[a]=[o].concat(l))}return i[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(s),i}function fz(e,t,n){const r=e.icons,i=e.aliases||Object.create(null);let s={};function a(o){s=dz(r[o]||i[o],s)}return a(t),n.forEach(a),dz(e,s)}function r3e(e,t){if(e.icons[t])return fz(e,t,[]);const n=n3e(e,[t])[t];return n?fz(e,t,n):null}const i3e=/(-?[0-9.]*[0-9]+[0-9.]*)/g,s3e=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function hz(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(i3e);if(r===null||!r.length)return e;const i=[];let s=r.shift(),a=s3e.test(s);for(;;){if(a){const o=parseFloat(s);isNaN(o)?i.push(s):i.push(Math.ceil(o*t*n)/n)}else i.push(s);if(s=r.shift(),s===void 0)return i.join("");a=!a}}function a3e(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const i=e.indexOf(">",r),s=e.indexOf("</"+t);if(i===-1||s===-1)break;const a=e.indexOf(">",s);if(a===-1)break;n+=e.slice(i+1,s).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function o3e(e,t){return e?"<defs>"+e+"</defs>"+t:t}function l3e(e,t,n){const r=a3e(e);return o3e(r.defs,t+r.content+n)}const c3e=e=>e==="unset"||e==="undefined"||e==="none";function u3e(e,t){const n={...xJ,...e},r={...QNe,...t},i={left:n.left,top:n.top,width:n.width,height:n.height};let s=n.body;[n,r].forEach(b=>{const x=[],w=b.hFlip,_=b.vFlip;let S=b.rotate;w?_?S+=2:(x.push("translate("+(i.width+i.left).toString()+" "+(0-i.top).toString()+")"),x.push("scale(-1 1)"),i.top=i.left=0):_&&(x.push("translate("+(0-i.left).toString()+" "+(i.height+i.top).toString()+")"),x.push("scale(1 -1)"),i.top=i.left=0);let C;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:C=i.height/2+i.top,x.unshift("rotate(90 "+C.toString()+" "+C.toString()+")");break;case 2:x.unshift("rotate(180 "+(i.width/2+i.left).toString()+" "+(i.height/2+i.top).toString()+")");break;case 3:C=i.width/2+i.left,x.unshift("rotate(-90 "+C.toString()+" "+C.toString()+")");break}S%2===1&&(i.left!==i.top&&(C=i.left,i.left=i.top,i.top=C),i.width!==i.height&&(C=i.width,i.width=i.height,i.height=C)),x.length&&(s=l3e(s,'<g transform="'+x.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=i.width,c=i.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=hz(d,l/c)):(u=a==="auto"?l:a,d=o===null?hz(u,c/l):o==="auto"?c:o);const h={},p=(b,x)=>{c3e(x)||(h[b]=x.toString())};p("width",u),p("height",d);const y=[i.left,i.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:s}}const d3e=/\sid="(\S+)"/g,f3e="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let h3e=0;function p3e(e,t=f3e){const n=[];let r;for(;r=d3e.exec(e);)n.push(r[1]);if(!n.length)return e;const i="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(s=>{const a=typeof t=="function"?t(s):t+(h3e++).toString(),o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+i+"$3")}),e=e.replace(new RegExp(i,"g"),""),e}function m3e(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var g3e={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},kj=new Map,wJ=new Map,y3e=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(Lt.debug("Registering icon pack:",t.name),"loader"in t)wJ.set(t.name,t.loader);else if("icons"in t)kj.set(t.name,t.icons);else throw Lt.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),b3e=ie(async(e,t)=>{const n=e3e(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let i=kj.get(r);if(!i){const a=wJ.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{i={...await a(),prefix:r},kj.set(r,i)}catch(o){throw Lt.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const s=r3e(i,n.name);if(!s)throw new Error(`Icon not found: ${e}`);return s},"getRegisteredIconData"),qE=ie(async(e,t)=>{let n;try{n=await b3e(e,t==null?void 0:t.fallbackPrefix)}catch(s){Lt.error(s),n=g3e}const r=u3e(n,t);return m3e(p3e(r.body),r.attributes)},"getIconSVG"),tv={},xs={},pz;function v3e(){return pz||(pz=1,Object.defineProperty(xs,"__esModule",{value:!0}),xs.BLANK_URL=xs.relativeFirstCharacters=xs.whitespaceEscapeCharsRegex=xs.urlSchemeRegex=xs.ctrlCharactersRegex=xs.htmlCtrlEntityRegex=xs.htmlEntitiesRegex=xs.invalidProtocolRegex=void 0,xs.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,xs.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,xs.htmlCtrlEntityRegex=/&(newline|tab);/gi,xs.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,xs.urlSchemeRegex=/^.+(:|&colon;)/gim,xs.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,xs.relativeFirstCharacters=[".","/"],xs.BLANK_URL="about:blank"),xs}var mz;function x3e(){if(mz)return tv;mz=1,Object.defineProperty(tv,"__esModule",{value:!0}),tv.sanitizeUrl=void 0;var e=v3e();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function i(a){try{return decodeURIComponent(a)}catch{return a}}function s(a){if(!a)return e.BLANK_URL;var o,l=i(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=i(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var p=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return p;if(h==="http:"||h==="https:"){if(!r(p))return e.BLANK_URL;var y=new URL(p);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return p}return tv.sanitizeUrl=s,tv}var w3e=x3e(),_3e={value:()=>{}};function _J(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new l2(n)}function l2(e){this._=e}function S3e(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}l2.prototype=_J.prototype={constructor:l2,on:function(e,t){var n=this._,r=S3e(e+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(e=r[s]).type)&&(i=C3e(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(i=(e=r[s]).type)n[i]=gz(n[i],e.name,t);else if(t==null)for(i in n)n[i]=gz(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new l2(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function C3e(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function gz(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=_3e,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Ej="http://www.w3.org/1999/xhtml";const yz={svg:"http://www.w3.org/2000/svg",xhtml:Ej,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function VE(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),yz.hasOwnProperty(t)?{space:yz[t],local:e}:e}function k3e(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Ej&&t.documentElement.namespaceURI===Ej?t.createElement(e):t.createElementNS(n,e)}}function E3e(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function SJ(e){var t=VE(e);return(t.local?E3e:k3e)(t)}function T3e(){}function qP(e){return e==null?T3e:function(){return this.querySelector(e)}}function A3e(e){typeof e!="function"&&(e=qP(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=new Array(a),l,c,u=0;u<a;++u)(l=s[u])&&(c=e.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new Vo(r,this._parents)}function R3e(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function I3e(){return[]}function CJ(e){return e==null?I3e:function(){return this.querySelectorAll(e)}}function M3e(e){return function(){return R3e(e.apply(this,arguments))}}function N3e(e){typeof e=="function"?e=M3e(e):e=CJ(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var a=t[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),i.push(l));return new Vo(r,i)}function kJ(e){return function(){return this.matches(e)}}function EJ(e){return function(t){return t.matches(e)}}var j3e=Array.prototype.find;function O3e(e){return function(){return j3e.call(this.children,e)}}function P3e(){return this.firstElementChild}function D3e(e){return this.select(e==null?P3e:O3e(typeof e=="function"?e:EJ(e)))}var F3e=Array.prototype.filter;function L3e(){return Array.from(this.children)}function B3e(e){return function(){return F3e.call(this.children,e)}}function $3e(e){return this.selectAll(e==null?L3e:B3e(typeof e=="function"?e:EJ(e)))}function z3e(e){typeof e!="function"&&(e=kJ(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=[],l,c=0;c<a;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&o.push(l);return new Vo(r,this._parents)}function TJ(e){return new Array(e.length)}function U3e(){return new Vo(this._enter||this._groups.map(TJ),this._parents)}function $C(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}$C.prototype={constructor:$C,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function q3e(e){return function(){return e}}function V3e(e,t,n,r,i,s){for(var a=0,o,l=t.length,c=s.length;a<c;++a)(o=t[a])?(o.__data__=s[a],r[a]=o):n[a]=new $C(e,s[a]);for(;a<l;++a)(o=t[a])&&(i[a]=o)}function H3e(e,t,n,r,i,s,a){var o,l,c=new Map,u=t.length,d=s.length,h=new Array(u),p;for(o=0;o<u;++o)(l=t[o])&&(h[o]=p=a.call(l,l.__data__,o,t)+"",c.has(p)?i[o]=l:c.set(p,l));for(o=0;o<d;++o)p=a.call(e,s[o],o,s)+"",(l=c.get(p))?(r[o]=l,l.__data__=s[o],c.delete(p)):n[o]=new $C(e,s[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(i[o]=l)}function W3e(e){return e.__data__}function G3e(e,t){if(!arguments.length)return Array.from(this,W3e);var n=t?H3e:V3e,r=this._parents,i=this._groups;typeof e!="function"&&(e=q3e(e));for(var s=i.length,a=new Array(s),o=new Array(s),l=new Array(s),c=0;c<s;++c){var u=r[c],d=i[c],h=d.length,p=K3e(e.call(u,u&&u.__data__,c,r)),y=p.length,b=o[c]=new Array(y),x=a[c]=new Array(y),w=l[c]=new Array(h);n(u,d,b,x,w,p,t);for(var _=0,S=0,C,E;_<y;++_)if(C=b[_]){for(_>=S&&(S=_+1);!(E=x[S])&&++S<y;);C._next=E||null}}return a=new Vo(a,r),a._enter=o,a._exit=l,a}function K3e(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Y3e(){return new Vo(this._exit||this._groups.map(TJ),this._parents)}function Z3e(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function X3e(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,a=Math.min(i,s),o=new Array(i),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),p,y=0;y<d;++y)(p=c[y]||u[y])&&(h[y]=p);for(;l<i;++l)o[l]=n[l];return new Vo(o,this._parents)}function J3e(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],a;--i>=0;)(a=r[i])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function Q3e(e){e||(e=eje);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a=n[s],o=a.length,l=i[s]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new Vo(i,this._parents).order()}function eje(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function tje(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function nje(){return Array.from(this)}function rje(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null}function ije(){let e=0;for(const t of this)++e;return e}function sje(){return!this.node()}function aje(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,a=i.length,o;s<a;++s)(o=i[s])&&e.call(o,o.__data__,s,i);return this}function oje(e){return function(){this.removeAttribute(e)}}function lje(e){return function(){this.removeAttributeNS(e.space,e.local)}}function cje(e,t){return function(){this.setAttribute(e,t)}}function uje(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function dje(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function fje(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function hje(e,t){var n=VE(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?lje:oje:typeof t=="function"?n.local?fje:dje:n.local?uje:cje)(n,t))}function AJ(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function pje(e){return function(){this.style.removeProperty(e)}}function mje(e,t,n){return function(){this.style.setProperty(e,t,n)}}function gje(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function yje(e,t,n){return arguments.length>1?this.each((t==null?pje:typeof t=="function"?gje:mje)(e,t,n??"")):D0(this.node(),e)}function D0(e,t){return e.style.getPropertyValue(t)||AJ(e).getComputedStyle(e,null).getPropertyValue(t)}function bje(e){return function(){delete this[e]}}function vje(e,t){return function(){this[e]=t}}function xje(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function wje(e,t){return arguments.length>1?this.each((t==null?bje:typeof t=="function"?xje:vje)(e,t)):this.node()[e]}function RJ(e){return e.trim().split(/^|\s+/)}function VP(e){return e.classList||new IJ(e)}function IJ(e){this._node=e,this._names=RJ(e.getAttribute("class")||"")}IJ.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function MJ(e,t){for(var n=VP(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function NJ(e,t){for(var n=VP(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function _je(e){return function(){MJ(this,e)}}function Sje(e){return function(){NJ(this,e)}}function Cje(e,t){return function(){(t.apply(this,arguments)?MJ:NJ)(this,e)}}function kje(e,t){var n=RJ(e+"");if(arguments.length<2){for(var r=VP(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Cje:t?_je:Sje)(n,t))}function Eje(){this.textContent=""}function Tje(e){return function(){this.textContent=e}}function Aje(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Rje(e){return arguments.length?this.each(e==null?Eje:(typeof e=="function"?Aje:Tje)(e)):this.node().textContent}function Ije(){this.innerHTML=""}function Mje(e){return function(){this.innerHTML=e}}function Nje(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function jje(e){return arguments.length?this.each(e==null?Ije:(typeof e=="function"?Nje:Mje)(e)):this.node().innerHTML}function Oje(){this.nextSibling&&this.parentNode.appendChild(this)}function Pje(){return this.each(Oje)}function Dje(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fje(){return this.each(Dje)}function Lje(e){var t=typeof e=="function"?e:SJ(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Bje(){return null}function $je(e,t){var n=typeof e=="function"?e:SJ(e),r=t==null?Bje:typeof t=="function"?t:qP(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function zje(){var e=this.parentNode;e&&e.removeChild(this)}function Uje(){return this.each(zje)}function qje(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Vje(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Hje(e){return this.select(e?Vje:qje)}function Wje(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Gje(e){return function(t){e.call(this,t,this.__data__)}}function Kje(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Yje(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function Zje(e,t,n){return function(){var r=this.__on,i,s=Gje(t);if(r){for(var a=0,o=r.length;a<o;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function Xje(e,t,n){var r=Kje(e+""),i,s=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(i=0,u=o[l];i<s;++i)if((a=r[i]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?Zje:Yje,i=0;i<s;++i)this.each(o(r[i],t,n));return this}function jJ(e,t,n){var r=AJ(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function Jje(e,t){return function(){return jJ(this,e,t)}}function Qje(e,t){return function(){return jJ(this,e,t.apply(this,arguments))}}function e4e(e,t){return this.each((typeof t=="function"?Qje:Jje)(e,t))}function*t4e(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,a;i<s;++i)(a=r[i])&&(yield a)}var OJ=[null];function Vo(e,t){this._groups=e,this._parents=t}function f1(){return new Vo([[document.documentElement]],OJ)}function n4e(){return this}Vo.prototype=f1.prototype={constructor:Vo,select:A3e,selectAll:N3e,selectChild:D3e,selectChildren:$3e,filter:z3e,data:G3e,enter:U3e,exit:Y3e,join:Z3e,merge:X3e,selection:n4e,order:J3e,sort:Q3e,call:tje,nodes:nje,node:rje,size:ije,empty:sje,each:aje,attr:hje,style:yje,property:wje,classed:kje,text:Rje,html:jje,raise:Pje,lower:Fje,append:Lje,insert:$je,remove:Uje,clone:Hje,datum:Wje,on:Xje,dispatch:e4e,[Symbol.iterator]:t4e};function Lr(e){return typeof e=="string"?new Vo([[document.querySelector(e)]],[document.documentElement]):new Vo([[e]],OJ)}function HP(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function PJ(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function h1(){}var Vx=.7,zC=1/Vx,Hg="\\s*([+-]?\\d+)\\s*",Hx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",r4e=/^#([0-9a-f]{3,8})$/,i4e=new RegExp(`^rgb\\(${Hg},${Hg},${Hg}\\)$`),s4e=new RegExp(`^rgb\\(${Yc},${Yc},${Yc}\\)$`),a4e=new RegExp(`^rgba\\(${Hg},${Hg},${Hg},${Hx}\\)$`),o4e=new RegExp(`^rgba\\(${Yc},${Yc},${Yc},${Hx}\\)$`),l4e=new RegExp(`^hsl\\(${Hx},${Yc},${Yc}\\)$`),c4e=new RegExp(`^hsla\\(${Hx},${Yc},${Yc},${Hx}\\)$`),bz={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};HP(h1,Wx,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:vz,formatHex:vz,formatHex8:u4e,formatHsl:d4e,formatRgb:xz,toString:xz});function vz(){return this.rgb().formatHex()}function u4e(){return this.rgb().formatHex8()}function d4e(){return DJ(this).formatHsl()}function xz(){return this.rgb().formatRgb()}function Wx(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=r4e.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?wz(t):n===3?new lo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?gS(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?gS(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=i4e.exec(e))?new lo(t[1],t[2],t[3],1):(t=s4e.exec(e))?new lo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=a4e.exec(e))?gS(t[1],t[2],t[3],t[4]):(t=o4e.exec(e))?gS(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=l4e.exec(e))?Cz(t[1],t[2]/100,t[3]/100,1):(t=c4e.exec(e))?Cz(t[1],t[2]/100,t[3]/100,t[4]):bz.hasOwnProperty(e)?wz(bz[e]):e==="transparent"?new lo(NaN,NaN,NaN,0):null}function wz(e){return new lo(e>>16&255,e>>8&255,e&255,1)}function gS(e,t,n,r){return r<=0&&(e=t=n=NaN),new lo(e,t,n,r)}function f4e(e){return e instanceof h1||(e=Wx(e)),e?(e=e.rgb(),new lo(e.r,e.g,e.b,e.opacity)):new lo}function Tj(e,t,n,r){return arguments.length===1?f4e(e):new lo(e,t,n,r??1)}function lo(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}HP(lo,Tj,PJ(h1,{brighter(e){return e=e==null?zC:Math.pow(zC,e),new lo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Vx:Math.pow(Vx,e),new lo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new lo(_p(this.r),_p(this.g),_p(this.b),UC(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_z,formatHex:_z,formatHex8:h4e,formatRgb:Sz,toString:Sz}));function _z(){return`#${mp(this.r)}${mp(this.g)}${mp(this.b)}`}function h4e(){return`#${mp(this.r)}${mp(this.g)}${mp(this.b)}${mp((isNaN(this.opacity)?1:this.opacity)*255)}`}function Sz(){const e=UC(this.opacity);return`${e===1?"rgb(":"rgba("}${_p(this.r)}, ${_p(this.g)}, ${_p(this.b)}${e===1?")":`, ${e})`}`}function UC(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function _p(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function mp(e){return e=_p(e),(e<16?"0":"")+e.toString(16)}function Cz(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ql(e,t,n,r)}function DJ(e){if(e instanceof ql)return new ql(e.h,e.s,e.l,e.opacity);if(e instanceof h1||(e=Wx(e)),!e)return new ql;if(e instanceof ql)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new ql(a,o,l,e.opacity)}function p4e(e,t,n,r){return arguments.length===1?DJ(e):new ql(e,t,n,r??1)}function ql(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}HP(ql,p4e,PJ(h1,{brighter(e){return e=e==null?zC:Math.pow(zC,e),new ql(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Vx:Math.pow(Vx,e),new ql(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new lo(QM(e>=240?e-240:e+120,i,r),QM(e,i,r),QM(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ql(kz(this.h),yS(this.s),yS(this.l),UC(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=UC(this.opacity);return`${e===1?"hsl(":"hsla("}${kz(this.h)}, ${yS(this.s)*100}%, ${yS(this.l)*100}%${e===1?")":`, ${e})`}`}}));function kz(e){return e=(e||0)%360,e<0?e+360:e}function yS(e){return Math.max(0,Math.min(1,e||0))}function QM(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const WP=e=>()=>e;function FJ(e,t){return function(n){return e+n*t}}function m4e(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ast(e,t){var n=t-e;return n?FJ(e,n>180||n<-180?n-360*Math.round(n/360):n):WP(isNaN(e)?t:e)}function g4e(e){return(e=+e)==1?LJ:function(t,n){return n-t?m4e(t,n,e):WP(isNaN(t)?n:t)}}function LJ(e,t){var n=t-e;return n?FJ(e,n):WP(isNaN(e)?t:e)}const Ez=function e(t){var n=g4e(t);function r(i,s){var a=n((i=Tj(i)).r,(s=Tj(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),c=LJ(i.opacity,s.opacity);return function(u){return i.r=a(u),i.g=o(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=e,r}(1);function _f(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Aj=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,eN=new RegExp(Aj.source,"g");function y4e(e){return function(){return e}}function b4e(e){return function(t){return e(t)+""}}function v4e(e,t){var n=Aj.lastIndex=eN.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=Aj.exec(e))&&(i=eN.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:_f(r,i)})),n=eN.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?b4e(l[0].x):y4e(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var Tz=180/Math.PI,Rj={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function BJ(e,t,n,r,i,s){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Tz,skewX:Math.atan(l)*Tz,scaleX:a,scaleY:o}}var bS;function x4e(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Rj:BJ(t.a,t.b,t.c,t.d,t.e,t.f)}function w4e(e){return e==null||(bS||(bS=document.createElementNS("http://www.w3.org/2000/svg","g")),bS.setAttribute("transform",e),!(e=bS.transform.baseVal.consolidate()))?Rj:(e=e.matrix,BJ(e.a,e.b,e.c,e.d,e.e,e.f))}function $J(e,t,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,u,d,h,p,y){if(c!==d||u!==h){var b=p.push("translate(",null,t,null,n);y.push({i:b-4,x:_f(c,d)},{i:b-2,x:_f(u,h)})}else(d||h)&&p.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(i(d)+"rotate(",null,r)-2,x:_f(c,u)})):u&&d.push(i(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(i(d)+"skewX(",null,r)-2,x:_f(c,u)}):u&&d.push(i(d)+"skewX("+u+r)}function l(c,u,d,h,p,y){if(c!==d||u!==h){var b=p.push(i(p)+"scale(",null,",",null,")");y.push({i:b-4,x:_f(c,d)},{i:b-2,x:_f(u,h)})}else(d!==1||h!==1)&&p.push(i(p)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),s(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(p){for(var y=-1,b=h.length,x;++y<b;)d[(x=h[y]).i]=x.x(p);return d.join("")}}}var _4e=$J(x4e,"px, ","px)","deg)"),S4e=$J(w4e,", ",")",")"),F0=0,yv=0,nv=0,zJ=1e3,qC,bv,VC=0,$p=0,HE=0,Gx=typeof performance=="object"&&performance.now?performance:Date,UJ=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function GP(){return $p||(UJ(C4e),$p=Gx.now()+HE)}function C4e(){$p=0}function HC(){this._call=this._time=this._next=null}HC.prototype=qJ.prototype={constructor:HC,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?GP():+n)+(t==null?0:+t),!this._next&&bv!==this&&(bv?bv._next=this:qC=this,bv=this),this._call=e,this._time=n,Ij()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ij())}};function qJ(e,t,n){var r=new HC;return r.restart(e,t,n),r}function k4e(){GP(),++F0;for(var e=qC,t;e;)(t=$p-e._time)>=0&&e._call.call(void 0,t),e=e._next;--F0}function Az(){$p=(VC=Gx.now())+HE,F0=yv=0;try{k4e()}finally{F0=0,T4e(),$p=0}}function E4e(){var e=Gx.now(),t=e-VC;t>zJ&&(HE-=t,VC=e)}function T4e(){for(var e,t=qC,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:qC=n);bv=e,Ij(r)}function Ij(e){if(!F0){yv&&(yv=clearTimeout(yv));var t=e-$p;t>24?(e<1/0&&(yv=setTimeout(Az,e-Gx.now()-HE)),nv&&(nv=clearInterval(nv))):(nv||(VC=Gx.now(),nv=setInterval(E4e,zJ)),F0=1,UJ(Az))}}function Rz(e,t,n){var r=new HC;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var A4e=_J("start","end","cancel","interrupt"),R4e=[],VJ=0,Iz=1,Mj=2,c2=3,Mz=4,Nj=5,u2=6;function WE(e,t,n,r,i,s){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;I4e(e,n,{name:t,index:r,group:i,on:A4e,tween:R4e,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:VJ})}function KP(e,t){var n=pc(e,t);if(n.state>VJ)throw new Error("too late; already scheduled");return n}function hu(e,t){var n=pc(e,t);if(n.state>c2)throw new Error("too late; already running");return n}function pc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function I4e(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=qJ(s,0,n.time);function s(c){n.state=Iz,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,p;if(n.state!==Iz)return l();for(u in r)if(p=r[u],p.name===n.name){if(p.state===c2)return Rz(a);p.state===Mz?(p.state=u2,p.timer.stop(),p.on.call("interrupt",e,e.__data__,p.index,p.group),delete r[u]):+u<t&&(p.state=u2,p.timer.stop(),p.on.call("cancel",e,e.__data__,p.index,p.group),delete r[u])}if(Rz(function(){n.state===c2&&(n.state=Mz,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=Mj,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Mj){for(n.state=c2,i=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(p=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++d]=p);i.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Nj,1),d=-1,h=i.length;++d<h;)i[d].call(e,u);n.state===Nj&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=u2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function M4e(e,t){var n=e.__transition,r,i,s=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){s=!1;continue}i=r.state>Mj&&r.state<Nj,r.state=u2,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}s&&delete e.__transition}}function N4e(e){return this.each(function(){M4e(this,e)})}function j4e(e,t){var n,r;return function(){var i=hu(this,e),s=i.tween;if(s!==n){r=n=s;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function O4e(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=hu(this,e),a=s.tween;if(a!==r){i=(r=a).slice();for(var o={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=o;break}l===c&&i.push(o)}s.tween=i}}function P4e(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=pc(this.node(),n).tween,i=0,s=r.length,a;i<s;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?j4e:O4e)(n,e,t))}function YP(e,t,n){var r=e._id;return e.each(function(){var i=hu(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return pc(i,r).value[t]}}function HJ(e,t){var n;return(typeof t=="number"?_f:t instanceof Wx?Ez:(n=Wx(t))?(t=n,Ez):v4e)(e,t)}function D4e(e){return function(){this.removeAttribute(e)}}function F4e(e){return function(){this.removeAttributeNS(e.space,e.local)}}function L4e(e,t,n){var r,i=n+"",s;return function(){var a=this.getAttribute(e);return a===i?null:a===r?s:s=t(r=a,n)}}function B4e(e,t,n){var r,i=n+"",s;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?s:s=t(r=a,n)}}function $4e(e,t,n){var r,i,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===i?s:(i=l,s=t(r=a,o)))}}function z4e(e,t,n){var r,i,s;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===i?s:(i=l,s=t(r=a,o)))}}function U4e(e,t){var n=VE(e),r=n==="transform"?S4e:HJ;return this.attrTween(e,typeof t=="function"?(n.local?z4e:$4e)(n,r,YP(this,"attr."+e,t)):t==null?(n.local?F4e:D4e)(n):(n.local?B4e:L4e)(n,r,t))}function q4e(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function V4e(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function H4e(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&V4e(e,s)),n}return i._value=t,i}function W4e(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&q4e(e,s)),n}return i._value=t,i}function G4e(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=VE(e);return this.tween(n,(r.local?H4e:W4e)(r,t))}function K4e(e,t){return function(){KP(this,e).delay=+t.apply(this,arguments)}}function Y4e(e,t){return t=+t,function(){KP(this,e).delay=t}}function Z4e(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?K4e:Y4e)(t,e)):pc(this.node(),t).delay}function X4e(e,t){return function(){hu(this,e).duration=+t.apply(this,arguments)}}function J4e(e,t){return t=+t,function(){hu(this,e).duration=t}}function Q4e(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?X4e:J4e)(t,e)):pc(this.node(),t).duration}function eOe(e,t){if(typeof t!="function")throw new Error;return function(){hu(this,e).ease=t}}function tOe(e){var t=this._id;return arguments.length?this.each(eOe(t,e)):pc(this.node(),t).ease}function nOe(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;hu(this,e).ease=n}}function rOe(e){if(typeof e!="function")throw new Error;return this.each(nOe(this._id,e))}function iOe(e){typeof e!="function"&&(e=kJ(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=[],l,c=0;c<a;++c)(l=s[c])&&e.call(l,l.__data__,c,s)&&o.push(l);return new bd(r,this._parents,this._name,this._id)}function sOe(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,p=0;p<u;++p)(h=l[p]||c[p])&&(d[p]=h);for(;o<r;++o)a[o]=t[o];return new bd(a,this._parents,this._name,this._id)}function aOe(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function oOe(e,t,n){var r,i,s=aOe(t)?KP:hu;return function(){var a=s(this,e),o=a.on;o!==r&&(i=(r=o).copy()).on(t,n),a.on=i}}function lOe(e,t){var n=this._id;return arguments.length<2?pc(this.node(),n).on.on(e):this.each(oOe(n,e,t))}function cOe(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function uOe(){return this.on("end.remove",cOe(this._id))}function dOe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=qP(e));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var o=r[a],l=o.length,c=s[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,WE(c[h],t,n,h,c,pc(u,n)));return new bd(s,this._parents,t,n)}function fOe(e){var t=this._name,n=this._id;typeof e!="function"&&(e=CJ(e));for(var r=this._groups,i=r.length,s=[],a=[],o=0;o<i;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),p,y=pc(u,n),b=0,x=h.length;b<x;++b)(p=h[b])&&WE(p,t,n,b,h,y);s.push(h),a.push(u)}return new bd(s,a,t,n)}var hOe=f1.prototype.constructor;function pOe(){return new hOe(this._groups,this._parents)}function mOe(e,t){var n,r,i;return function(){var s=D0(this,e),a=(this.style.removeProperty(e),D0(this,e));return s===a?null:s===n&&a===r?i:i=t(n=s,r=a)}}function WJ(e){return function(){this.style.removeProperty(e)}}function gOe(e,t,n){var r,i=n+"",s;return function(){var a=D0(this,e);return a===i?null:a===r?s:s=t(r=a,n)}}function yOe(e,t,n){var r,i,s;return function(){var a=D0(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),D0(this,e))),a===l?null:a===r&&l===i?s:(i=l,s=t(r=a,o))}}function bOe(e,t){var n,r,i,s="style."+t,a="end."+s,o;return function(){var l=hu(this,e),c=l.on,u=l.value[s]==null?o||(o=WJ(t)):void 0;(c!==n||i!==u)&&(r=(n=c).copy()).on(a,i=u),l.on=r}}function vOe(e,t,n){var r=(e+="")=="transform"?_4e:HJ;return t==null?this.styleTween(e,mOe(e,r)).on("end.style."+e,WJ(e)):typeof t=="function"?this.styleTween(e,yOe(e,r,YP(this,"style."+e,t))).each(bOe(this._id,e)):this.styleTween(e,gOe(e,r,t),n).on("end.style."+e,null)}function xOe(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function wOe(e,t,n){var r,i;function s(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&xOe(e,a,n)),r}return s._value=t,s}function _Oe(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,wOe(e,t,n??""))}function SOe(e){return function(){this.textContent=e}}function COe(e){return function(){var t=e(this);this.textContent=t??""}}function kOe(e){return this.tween("text",typeof e=="function"?COe(YP(this,"text",e)):SOe(e==null?"":e+""))}function EOe(e){return function(t){this.textContent=e.call(this,t)}}function TOe(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&EOe(i)),t}return r._value=e,r}function AOe(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,TOe(e))}function ROe(){for(var e=this._name,t=this._id,n=GJ(),r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=pc(l,t);WE(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new bd(r,this._parents,e,n)}function IOe(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,a){var o={value:a},l={value:function(){--i===0&&s()}};n.each(function(){var c=hu(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),i===0&&s()})}var MOe=0;function bd(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function GJ(){return++MOe}var Uu=f1.prototype;bd.prototype={constructor:bd,select:dOe,selectAll:fOe,selectChild:Uu.selectChild,selectChildren:Uu.selectChildren,filter:iOe,merge:sOe,selection:pOe,transition:ROe,call:Uu.call,nodes:Uu.nodes,node:Uu.node,size:Uu.size,empty:Uu.empty,each:Uu.each,on:lOe,attr:U4e,attrTween:G4e,style:vOe,styleTween:_Oe,text:kOe,textTween:AOe,remove:uOe,tween:P4e,delay:Z4e,duration:Q4e,ease:tOe,easeVarying:rOe,end:IOe,[Symbol.iterator]:Uu[Symbol.iterator]};function NOe(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var jOe={time:null,delay:0,duration:250,ease:NOe};function OOe(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function POe(e){var t,n;e instanceof bd?(t=e._id,e=e._name):(t=GJ(),(n=jOe).time=GP(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],o=a.length,l,c=0;c<o;++c)(l=a[c])&&WE(l,e,t,c,a,n||OOe(l,t));return new bd(r,this._parents,e,t)}f1.prototype.interrupt=N4e;f1.prototype.transition=POe;const jj=Math.PI,Oj=2*jj,np=1e-6,DOe=Oj-np;function KJ(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function FOe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return KJ;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class LOe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?KJ:FOe(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-t,c=i-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>np)if(!(Math.abs(d*l-c*u)>np)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let p=r-a,y=i-o,b=l*l+c*c,x=p*p+y*y,w=Math.sqrt(b),_=Math.sqrt(h),S=s*Math.tan((jj-Math.acos((b+h-x)/(2*w*_)))/2),C=S/_,E=S/w;Math.abs(C-1)>np&&this._append`L${t+C*u},${n+C*d}`,this._append`A${s},${s},0,0,${+(d*p>u*y)},${this._x1=t+E*l},${this._y1=n+E*c}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),c=t+o,u=n+l,d=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>np||Math.abs(this._y1-u)>np)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%Oj+Oj),h>DOe?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>np&&this._append`A${r},${r},0,${+(h>=jj)},${d},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function fg(e){return function(){return e}}const Rst=Math.abs,Ist=Math.atan2,Mst=Math.cos,Nst=Math.max,jst=Math.min,Ost=Math.sin,Pst=Math.sqrt,Nz=1e-12,ZP=Math.PI,jz=ZP/2,Dst=2*ZP;function Fst(e){return e>1?0:e<-1?ZP:Math.acos(e)}function Lst(e){return e>=1?jz:e<=-1?-jz:Math.asin(e)}function BOe(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new LOe(t)}function $Oe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function YJ(e){this._context=e}YJ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function WC(e){return new YJ(e)}function zOe(e){return e[0]}function UOe(e){return e[1]}function qOe(e,t){var n=fg(!0),r=null,i=WC,s=null,a=BOe(o);e=typeof e=="function"?e:e===void 0?zOe:fg(e),t=typeof t=="function"?t:t===void 0?UOe:fg(t);function o(l){var c,u=(l=$Oe(l)).length,d,h=!1,p;for(r==null&&(s=i(p=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(d,c,l),+t(d,c,l));if(p)return s=null,p+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:fg(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:fg(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:fg(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}class ZJ{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function XJ(e){return new ZJ(e,!0)}function JJ(e){return new ZJ(e,!1)}function Xf(){}function GC(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function GE(e){this._context=e}GE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:GC(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:GC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function d2(e){return new GE(e)}function QJ(e){this._context=e}QJ.prototype={areaStart:Xf,areaEnd:Xf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:GC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function VOe(e){return new QJ(e)}function eQ(e){this._context=e}eQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:GC(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function HOe(e){return new eQ(e)}function tQ(e,t){this._basis=new GE(e),this._beta=t}tQ.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*s),this._beta*t[o]+(1-this._beta)*(i+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const WOe=function e(t){function n(r){return t===1?new GE(r):new tQ(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function KC(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function XP(e,t){this._context=e,this._k=(1-t)/6}XP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:KC(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:KC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const nQ=function e(t){function n(r){return new XP(r,t)}return n.tension=function(r){return e(+r)},n}(0);function JP(e,t){this._context=e,this._k=(1-t)/6}JP.prototype={areaStart:Xf,areaEnd:Xf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:KC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const GOe=function e(t){function n(r){return new JP(r,t)}return n.tension=function(r){return e(+r)},n}(0);function QP(e,t){this._context=e,this._k=(1-t)/6}QP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:KC(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const KOe=function e(t){function n(r){return new QP(r,t)}return n.tension=function(r){return e(+r)},n}(0);function eD(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>Nz){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>Nz){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function rQ(e,t){this._context=e,this._alpha=t}rQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:eD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const iQ=function e(t){function n(r){return t?new rQ(r,t):new XP(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function sQ(e,t){this._context=e,this._alpha=t}sQ.prototype={areaStart:Xf,areaEnd:Xf,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:eD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const YOe=function e(t){function n(r){return t?new sQ(r,t):new JP(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function aQ(e,t){this._context=e,this._alpha=t}aQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:eD(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ZOe=function e(t){function n(r){return t?new aQ(r,t):new QP(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function oQ(e){this._context=e}oQ.prototype={areaStart:Xf,areaEnd:Xf,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function XOe(e){return new oQ(e)}function Oz(e){return e<0?-1:1}function Pz(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(Oz(s)+Oz(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function Dz(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function tN(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function YC(e){this._context=e}YC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tN(this,this._t0,Dz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,tN(this,Dz(this,n=Pz(this,e,t)),n);break;default:tN(this,this._t0,n=Pz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function lQ(e){this._context=new cQ(e)}(lQ.prototype=Object.create(YC.prototype)).point=function(e,t){YC.prototype.point.call(this,t,e)};function cQ(e){this._context=e}cQ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function uQ(e){return new YC(e)}function dQ(e){return new lQ(e)}function fQ(e){this._context=e}fQ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Fz(e),i=Fz(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Fz(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function hQ(e){return new fQ(e)}function KE(e,t){this._context=e,this._t=t}KE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function pQ(e){return new KE(e,.5)}function mQ(e){return new KE(e,0)}function gQ(e){return new KE(e,1)}function vv(e,t,n){this.k=e,this.x=t,this.y=n}vv.prototype={constructor:vv,scale:function(e){return e===1?this:new vv(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new vv(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};vv.prototype;const Ig=globalThis||void 0||self;var yQ=typeof Ig=="object"&&Ig&&Ig.Object===Object&&Ig,JOe=typeof self=="object"&&self&&self.Object===Object&&self,pu=yQ||JOe||Function("return this")(),ZC=pu.Symbol,bQ=Object.prototype,QOe=bQ.hasOwnProperty,ePe=bQ.toString,rv=ZC?ZC.toStringTag:void 0;function tPe(e){var t=QOe.call(e,rv),n=e[rv];try{e[rv]=void 0;var r=!0}catch{}var i=ePe.call(e);return r&&(t?e[rv]=n:delete e[rv]),i}var nPe=Object.prototype,rPe=nPe.toString;function iPe(e){return rPe.call(e)}var sPe="[object Null]",aPe="[object Undefined]",Lz=ZC?ZC.toStringTag:void 0;function yy(e){return e==null?e===void 0?aPe:sPe:Lz&&Lz in Object(e)?tPe(e):iPe(e)}function lm(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var oPe="[object AsyncFunction]",lPe="[object Function]",cPe="[object GeneratorFunction]",uPe="[object Proxy]";function tD(e){if(!lm(e))return!1;var t=yy(e);return t==lPe||t==cPe||t==oPe||t==uPe}var nN=pu["__core-js_shared__"],Bz=function(){var e=/[^.]+$/.exec(nN&&nN.keys&&nN.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function dPe(e){return!!Bz&&Bz in e}var fPe=Function.prototype,hPe=fPe.toString;function cm(e){if(e!=null){try{return hPe.call(e)}catch{}try{return e+""}catch{}}return""}var pPe=/[\\^$.*+?()[\]{}|]/g,mPe=/^\[object .+?Constructor\]$/,gPe=Function.prototype,yPe=Object.prototype,bPe=gPe.toString,vPe=yPe.hasOwnProperty,xPe=RegExp("^"+bPe.call(vPe).replace(pPe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function wPe(e){if(!lm(e)||dPe(e))return!1;var t=tD(e)?xPe:mPe;return t.test(cm(e))}function _Pe(e,t){return e==null?void 0:e[t]}function um(e,t){var n=_Pe(e,t);return wPe(n)?n:void 0}var Kx=um(Object,"create");function SPe(){this.__data__=Kx?Kx(null):{},this.size=0}function CPe(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var kPe="__lodash_hash_undefined__",EPe=Object.prototype,TPe=EPe.hasOwnProperty;function APe(e){var t=this.__data__;if(Kx){var n=t[e];return n===kPe?void 0:n}return TPe.call(t,e)?t[e]:void 0}var RPe=Object.prototype,IPe=RPe.hasOwnProperty;function MPe(e){var t=this.__data__;return Kx?t[e]!==void 0:IPe.call(t,e)}var NPe="__lodash_hash_undefined__";function jPe(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Kx&&t===void 0?NPe:t,this}function zp(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}zp.prototype.clear=SPe;zp.prototype.delete=CPe;zp.prototype.get=APe;zp.prototype.has=MPe;zp.prototype.set=jPe;function OPe(){this.__data__=[],this.size=0}function YE(e,t){return e===t||e!==e&&t!==t}function ZE(e,t){for(var n=e.length;n--;)if(YE(e[n][0],t))return n;return-1}var PPe=Array.prototype,DPe=PPe.splice;function FPe(e){var t=this.__data__,n=ZE(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():DPe.call(t,n,1),--this.size,!0}function LPe(e){var t=this.__data__,n=ZE(t,e);return n<0?void 0:t[n][1]}function BPe(e){return ZE(this.__data__,e)>-1}function $Pe(e,t){var n=this.__data__,r=ZE(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function Td(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Td.prototype.clear=OPe;Td.prototype.delete=FPe;Td.prototype.get=LPe;Td.prototype.has=BPe;Td.prototype.set=$Pe;var Yx=um(pu,"Map");function zPe(){this.size=0,this.__data__={hash:new zp,map:new(Yx||Td),string:new zp}}function UPe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function XE(e,t){var n=e.__data__;return UPe(t)?n[typeof t=="string"?"string":"hash"]:n.map}function qPe(e){var t=XE(this,e).delete(e);return this.size-=t?1:0,t}function VPe(e){return XE(this,e).get(e)}function HPe(e){return XE(this,e).has(e)}function WPe(e,t){var n=XE(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function bh(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}bh.prototype.clear=zPe;bh.prototype.delete=qPe;bh.prototype.get=VPe;bh.prototype.has=HPe;bh.prototype.set=WPe;var GPe="Expected a function";function p1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(GPe);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=e.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(p1.Cache||bh),n}p1.Cache=bh;function KPe(){this.__data__=new Td,this.size=0}function YPe(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function ZPe(e){return this.__data__.get(e)}function XPe(e){return this.__data__.has(e)}var JPe=200;function QPe(e,t){var n=this.__data__;if(n instanceof Td){var r=n.__data__;if(!Yx||r.length<JPe-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new bh(r)}return n.set(e,t),this.size=n.size,this}function by(e){var t=this.__data__=new Td(e);this.size=t.size}by.prototype.clear=KPe;by.prototype.delete=YPe;by.prototype.get=ZPe;by.prototype.has=XPe;by.prototype.set=QPe;var XC=function(){try{var e=um(Object,"defineProperty");return e({},"",{}),e}catch{}}();function nD(e,t,n){t=="__proto__"&&XC?XC(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Pj(e,t,n){(n!==void 0&&!YE(e[t],n)||n===void 0&&!(t in e))&&nD(e,t,n)}function eDe(e){return function(t,n,r){for(var i=-1,s=Object(t),a=r(t),o=a.length;o--;){var l=a[++i];if(n(s[l],l,s)===!1)break}return t}}var tDe=eDe(),vQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$z=vQ&&typeof module=="object"&&module&&!module.nodeType&&module,nDe=$z&&$z.exports===vQ,zz=nDe?pu.Buffer:void 0,Uz=zz?zz.allocUnsafe:void 0;function rDe(e,t){if(t)return e.slice();var n=e.length,r=Uz?Uz(n):new e.constructor(n);return e.copy(r),r}var qz=pu.Uint8Array;function iDe(e){var t=new e.constructor(e.byteLength);return new qz(t).set(new qz(e)),t}function sDe(e,t){var n=t?iDe(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function aDe(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Vz=Object.create,oDe=function(){function e(){}return function(t){if(!lm(t))return{};if(Vz)return Vz(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function xQ(e,t){return function(n){return e(t(n))}}var wQ=xQ(Object.getPrototypeOf,Object),lDe=Object.prototype;function JE(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||lDe;return e===n}function cDe(e){return typeof e.constructor=="function"&&!JE(e)?oDe(wQ(e)):{}}function m1(e){return e!=null&&typeof e=="object"}var uDe="[object Arguments]";function Hz(e){return m1(e)&&yy(e)==uDe}var _Q=Object.prototype,dDe=_Q.hasOwnProperty,fDe=_Q.propertyIsEnumerable,JC=Hz(function(){return arguments}())?Hz:function(e){return m1(e)&&dDe.call(e,"callee")&&!fDe.call(e,"callee")},QC=Array.isArray,hDe=9007199254740991;function SQ(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=hDe}function QE(e){return e!=null&&SQ(e.length)&&!tD(e)}function pDe(e){return m1(e)&&QE(e)}function mDe(){return!1}var CQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Wz=CQ&&typeof module=="object"&&module&&!module.nodeType&&module,gDe=Wz&&Wz.exports===CQ,Gz=gDe?pu.Buffer:void 0,yDe=Gz?Gz.isBuffer:void 0,rD=yDe||mDe,bDe="[object Object]",vDe=Function.prototype,xDe=Object.prototype,kQ=vDe.toString,wDe=xDe.hasOwnProperty,_De=kQ.call(Object);function SDe(e){if(!m1(e)||yy(e)!=bDe)return!1;var t=wQ(e);if(t===null)return!0;var n=wDe.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&kQ.call(n)==_De}var CDe="[object Arguments]",kDe="[object Array]",EDe="[object Boolean]",TDe="[object Date]",ADe="[object Error]",RDe="[object Function]",IDe="[object Map]",MDe="[object Number]",NDe="[object Object]",jDe="[object RegExp]",ODe="[object Set]",PDe="[object String]",DDe="[object WeakMap]",FDe="[object ArrayBuffer]",LDe="[object DataView]",BDe="[object Float32Array]",$De="[object Float64Array]",zDe="[object Int8Array]",UDe="[object Int16Array]",qDe="[object Int32Array]",VDe="[object Uint8Array]",HDe="[object Uint8ClampedArray]",WDe="[object Uint16Array]",GDe="[object Uint32Array]",Ti={};Ti[BDe]=Ti[$De]=Ti[zDe]=Ti[UDe]=Ti[qDe]=Ti[VDe]=Ti[HDe]=Ti[WDe]=Ti[GDe]=!0;Ti[CDe]=Ti[kDe]=Ti[FDe]=Ti[EDe]=Ti[LDe]=Ti[TDe]=Ti[ADe]=Ti[RDe]=Ti[IDe]=Ti[MDe]=Ti[NDe]=Ti[jDe]=Ti[ODe]=Ti[PDe]=Ti[DDe]=!1;function KDe(e){return m1(e)&&SQ(e.length)&&!!Ti[yy(e)]}function YDe(e){return function(t){return e(t)}}var EQ=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Pv=EQ&&typeof module=="object"&&module&&!module.nodeType&&module,ZDe=Pv&&Pv.exports===EQ,rN=ZDe&&yQ.process,Kz=function(){try{var e=Pv&&Pv.require&&Pv.require("util").types;return e||rN&&rN.binding&&rN.binding("util")}catch{}}(),Yz=Kz&&Kz.isTypedArray,iD=Yz?YDe(Yz):KDe;function Dj(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var XDe=Object.prototype,JDe=XDe.hasOwnProperty;function QDe(e,t,n){var r=e[t];(!(JDe.call(e,t)&&YE(r,n))||n===void 0&&!(t in e))&&nD(e,t,n)}function e6e(e,t,n,r){var i=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=void 0;l===void 0&&(l=e[o]),i?nD(n,o,l):QDe(n,o,l)}return n}function t6e(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var n6e=9007199254740991,r6e=/^(?:0|[1-9]\d*)$/;function TQ(e,t){var n=typeof e;return t=t??n6e,!!t&&(n=="number"||n!="symbol"&&r6e.test(e))&&e>-1&&e%1==0&&e<t}var i6e=Object.prototype,s6e=i6e.hasOwnProperty;function a6e(e,t){var n=QC(e),r=!n&&JC(e),i=!n&&!r&&rD(e),s=!n&&!r&&!i&&iD(e),a=n||r||i||s,o=a?t6e(e.length,String):[],l=o.length;for(var c in e)(t||s6e.call(e,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||TQ(c,l)))&&o.push(c);return o}function o6e(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var l6e=Object.prototype,c6e=l6e.hasOwnProperty;function u6e(e){if(!lm(e))return o6e(e);var t=JE(e),n=[];for(var r in e)r=="constructor"&&(t||!c6e.call(e,r))||n.push(r);return n}function AQ(e){return QE(e)?a6e(e,!0):u6e(e)}function d6e(e){return e6e(e,AQ(e))}function f6e(e,t,n,r,i,s,a){var o=Dj(e,n),l=Dj(t,n),c=a.get(l);if(c){Pj(e,n,c);return}var u=s?s(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=QC(l),p=!h&&rD(l),y=!h&&!p&&iD(l);u=l,h||p||y?QC(o)?u=o:pDe(o)?u=aDe(o):p?(d=!1,u=rDe(l,!0)):y?(d=!1,u=sDe(l,!0)):u=[]:SDe(l)||JC(l)?(u=o,JC(o)?u=d6e(o):(!lm(o)||tD(o))&&(u=cDe(l))):d=!1}d&&(a.set(l,u),i(u,l,r,s,a),a.delete(l)),Pj(e,n,u)}function RQ(e,t,n,r,i){e!==t&&tDe(t,function(s,a){if(i||(i=new by),lm(s))f6e(e,t,a,n,RQ,r,i);else{var o=r?r(Dj(e,a),s,a+"",e,t,i):void 0;o===void 0&&(o=s),Pj(e,a,o)}},AQ)}function IQ(e){return e}function h6e(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Zz=Math.max;function p6e(e,t,n){return t=Zz(t===void 0?e.length-1:t,0),function(){for(var r=arguments,i=-1,s=Zz(r.length-t,0),a=Array(s);++i<s;)a[i]=r[t+i];i=-1;for(var o=Array(t+1);++i<t;)o[i]=r[i];return o[t]=n(a),h6e(e,this,o)}}function m6e(e){return function(){return e}}var g6e=XC?function(e,t){return XC(e,"toString",{configurable:!0,enumerable:!1,value:m6e(t),writable:!0})}:IQ,y6e=800,b6e=16,v6e=Date.now;function x6e(e){var t=0,n=0;return function(){var r=v6e(),i=b6e-(r-n);if(n=r,i>0){if(++t>=y6e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var w6e=x6e(g6e);function _6e(e,t){return w6e(p6e(e,t,IQ),e+"")}function S6e(e,t,n){if(!lm(n))return!1;var r=typeof t;return(r=="number"?QE(n)&&TQ(t,n.length):r=="string"&&t in n)?YE(n[t],e):!1}function C6e(e){return _6e(function(t,n){var r=-1,i=n.length,s=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(s=e.length>3&&typeof s=="function"?(i--,s):void 0,a&&S6e(n[0],n[1],a)&&(s=i<3?void 0:s,i=1),t=Object(t);++r<i;){var o=n[r];o&&e(t,o,r,s)}return t})}var k6e=C6e(function(e,t,n){RQ(e,t,n)}),E6e="",T6e={curveBasis:d2,curveBasisClosed:VOe,curveBasisOpen:HOe,curveBumpX:XJ,curveBumpY:JJ,curveBundle:WOe,curveCardinalClosed:GOe,curveCardinalOpen:KOe,curveCardinal:nQ,curveCatmullRomClosed:YOe,curveCatmullRomOpen:ZOe,curveCatmullRom:iQ,curveLinear:WC,curveLinearClosed:XOe,curveMonotoneX:uQ,curveMonotoneY:dQ,curveNatural:hQ,curveStep:pQ,curveStepAfter:gQ,curveStepBefore:mQ},A6e=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,R6e=ie(function(e,t){const n=MQ(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);RC(a),r=ra(r,[...a])}else r=n.args;if(!r)return;let i=AP(e,t);const s="config";return r[s]!==void 0&&(i==="flowchart-v2"&&(i="flowchart"),r[i]=r[s],delete r[s]),r},"detectInit"),MQ=ie(function(e,t=null){var n,r;try{const i=new RegExp(`[%]{2}(?![{]${A6e.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(i,"").replace(/'/gm,'"'),Lt.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let s;const a=[];for(;(s=jv.exec(e))!==null;)if(s.index===jv.lastIndex&&jv.lastIndex++,s&&!t||t&&((n=s[1])!=null&&n.match(t))||t&&((r=s[2])!=null&&r.match(t))){const o=s[1]?s[1]:s[2],l=s[3]?s[3].trim():s[4]?JSON.parse(s[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(i){return Lt.error(`ERROR: ${i.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),I6e=ie(function(e){return e.replace(jv,"")},"removeDirectives"),M6e=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function sD(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return T6e[n]??t}ie(sD,"interpolateToCurve");function NQ(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?w3e.sanitizeUrl(n):n}ie(NQ,"formatUrl");var N6e=ie((e,...t)=>{const n=e.split("."),r=n.length-1,i=n[r];let s=window;for(let a=0;a<r;a++)if(s=s[n[a]],!s){Lt.error(`Function name: ${e} not found in window`);return}s[i](...t)},"runFunc");function aD(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(aD,"distance");function jQ(e){let t,n=0;e.forEach(i=>{n+=aD(i,t),t=i});const r=n/2;return oD(e,r)}ie(jQ,"traverseEdge");function OQ(e){return e.length===1?e[0]:jQ(e)}ie(OQ,"calcLabelPosition");var Xz=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),oD=ie((e,t)=>{let n,r=t;for(const i of e){if(n){const s=aD(i,n);if(s===0)return n;if(s<r)r-=s;else{const a=r/s;if(a<=0)return n;if(a>=1)return{x:i.x,y:i.y};if(a>0&&a<1)return{x:Xz((1-a)*n.x+a*i.x,5),y:Xz((1-a)*n.y+a*i.y,5)}}}n=i}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),j6e=ie((e,t,n)=>{Lt.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const i=oD(t,25),s=e?10:5,a=Math.atan2(t[0].y-i.y,t[0].x-i.x),o={x:0,y:0};return o.x=Math.sin(a)*s+(t[0].x+i.x)/2,o.y=-Math.cos(a)*s+(t[0].y+i.y)/2,o},"calcCardinalityPosition");function PQ(e,t,n){const r=structuredClone(n);Lt.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const i=25+e,s=oD(r,i),a=10+e*.5,o=Math.atan2(r[0].y-s.y,r[0].x-s.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+s.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+s.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+s.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+s.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+s.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+s.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+s.x)/2,l.y=-Math.cos(o)*a+(r[0].y+s.y)/2),l}ie(PQ,"calcTerminalLabelPosition");function DQ(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(DQ,"getStylesFromArray");var Jz=0,O6e=ie(()=>(Jz++,"id-"+Math.random().toString(36).substr(2,12)+"-"+Jz),"generateId");function FQ(e){let t="";const n="0123456789abcdef",r=n.length;for(let i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(FQ,"makeRandomHex");var P6e=ie(e=>FQ(e.length),"random"),D6e=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),F6e=ie(function(e,t){const n=t.text.replace(gy.lineBreakRegex," "),[,r]=eT(t.fontSize),i=e.append("text");i.attr("x",t.x),i.attr("y",t.y),i.style("text-anchor",t.anchor),i.style("font-family",t.fontFamily),i.style("font-size",r),i.style("font-weight",t.fontWeight),i.attr("fill",t.fill),t.class!==void 0&&i.attr("class",t.class);const s=i.append("tspan");return s.attr("x",t.x+t.textMargin*2),s.attr("fill",t.fill),s.text(n),i},"drawSimpleText"),L6e=p1((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),gy.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),i=[];let s="";return r.forEach((a,o)=>{const l=vd(`${a} `,n),c=vd(s,n);if(l>t){const{hyphenatedStrings:h,remainingWord:p}=B6e(a,t,"-",n);i.push(s,...h),s=p}else c+l>=t?(i.push(s),s=a):s=[s,a].filter(Boolean).join(" ");o+1===r.length&&i.push(s)}),i.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),B6e=p1((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const i=[...e],s=[];let a="";return i.forEach((o,l)=>{const c=`${a}${o}`;if(vd(c,r)>=t){const d=l+1,h=i.length===d,p=`${c}${n}`;s.push(h?c:p),a=""}else a=c}),{hyphenatedStrings:s,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function LQ(e,t){return lD(e,t).height}ie(LQ,"calculateTextHeight");function vd(e,t){return lD(e,t).width}ie(vd,"calculateTextWidth");var lD=p1((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:i=400}=t;if(!e)return{width:0,height:0};const[,s]=eT(n),a=["sans-serif",r],o=e.split(gy.lineBreakRegex),l=[],c=Lr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let p=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const x=D6e();x.text=b||E6e;const w=F6e(u,x).style("font-size",s).style("font-weight",i).style("font-family",h),_=(w._groups||w)[0][0].getBBox();if(_.width===0&&_.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,_.width)),p=Math.round(_.height),y.height+=p,y.lineHeight=Math.round(Math.max(y.lineHeight,p))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),s0,$6e=(s0=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(s0,"InitIDGenerator"),s0),vS,z6e=ie(function(e){return vS=vS||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),vS.innerHTML=e,unescape(vS.textContent)},"entityDecode");function cD(e){return"str"in e}ie(cD,"isDetailedError");var U6e=ie((e,t,n,r)=>{var s;if(!r)return;const i=(s=e.node())==null?void 0:s.getBBox();i&&e.append("text").text(r).attr("text-anchor","middle").attr("x",i.x+i.width/2).attr("y",-n).attr("class",t)},"insertTitle"),eT=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function uD(e,t){return k6e({},e,t)}ie(uD,"cleanAndMerge");var Uc={assignWithDepth:ra,wrapLabel:L6e,calculateTextHeight:LQ,calculateTextWidth:vd,calculateTextDimensions:lD,cleanAndMerge:uD,detectInit:R6e,detectDirective:MQ,isSubstringInArray:M6e,interpolateToCurve:sD,calcLabelPosition:OQ,calcCardinalityPosition:j6e,calcTerminalLabelPosition:PQ,formatUrl:NQ,getStylesFromArray:DQ,generateId:O6e,random:P6e,runFunc:N6e,entityDecode:z6e,insertTitle:U6e,parseFontSize:eT,InitIDGenerator:$6e},q6e=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?""+r+"":""+r+""}),t},"encodeEntities"),dm=ie(function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),Bst=ie((e,t,{counter:n=0,prefix:r,suffix:i},s)=>s||`${r?`${r}_`:""}${e}_${t}_${n}${i?`_${i}`:""}`,"getEdgeId");function $a(e){return e??null}ie($a,"handleUndefinedAttr");function dD(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var fm=dD();function BQ(e){fm=e}var Dv={exec:()=>null};function ii(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(i,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(Fa.caret,"$1"),n=n.replace(i,a),r},getRegex:()=>new RegExp(n,t)};return r}var Fa={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},V6e=/^(?:[ \t]*(?:\n|$))+/,H6e=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,W6e=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,g1=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,G6e=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,fD=/(?:[*+-]|\d{1,9}[.)])/,$Q=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,zQ=ii($Q).replace(/bull/g,fD).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),K6e=ii($Q).replace(/bull/g,fD).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),hD=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Y6e=/^[^\n]+/,pD=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Z6e=ii(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",pD).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),X6e=ii(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,fD).getRegex(),tT="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",mD=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,J6e=ii("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",mD).replace("tag",tT).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),UQ=ii(hD).replace("hr",g1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",tT).getRegex(),Q6e=ii(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",UQ).getRegex(),gD={blockquote:Q6e,code:H6e,def:Z6e,fences:W6e,heading:G6e,hr:g1,html:J6e,lheading:zQ,list:X6e,newline:V6e,paragraph:UQ,table:Dv,text:Y6e},Qz=ii("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",g1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",tT).getRegex(),e5e={...gD,lheading:K6e,table:Qz,paragraph:ii(hD).replace("hr",g1).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Qz).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",tT).getRegex()},t5e={...gD,html:ii(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",mD).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Dv,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:ii(hD).replace("hr",g1).replace("heading",` *#{1,6} *[^
]`).replace("lheading",zQ).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},n5e=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,r5e=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,qQ=/^( {2,}|\\)\n(?!\s*$)/,i5e=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,nT=/[\p{P}\p{S}]/u,yD=/[\s\p{P}\p{S}]/u,VQ=/[^\s\p{P}\p{S}]/u,s5e=ii(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,yD).getRegex(),HQ=/(?!~)[\p{P}\p{S}]/u,a5e=/(?!~)[\s\p{P}\p{S}]/u,o5e=/(?:[^\s\p{P}\p{S}]|~)/u,l5e=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,WQ=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,c5e=ii(WQ,"u").replace(/punct/g,nT).getRegex(),u5e=ii(WQ,"u").replace(/punct/g,HQ).getRegex(),GQ="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",d5e=ii(GQ,"gu").replace(/notPunctSpace/g,VQ).replace(/punctSpace/g,yD).replace(/punct/g,nT).getRegex(),f5e=ii(GQ,"gu").replace(/notPunctSpace/g,o5e).replace(/punctSpace/g,a5e).replace(/punct/g,HQ).getRegex(),h5e=ii("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,VQ).replace(/punctSpace/g,yD).replace(/punct/g,nT).getRegex(),p5e=ii(/\\(punct)/,"gu").replace(/punct/g,nT).getRegex(),m5e=ii(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),g5e=ii(mD).replace("(?:-->|$)","-->").getRegex(),y5e=ii("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",g5e).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ek=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,b5e=ii(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",ek).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),KQ=ii(/^!?\[(label)\]\[(ref)\]/).replace("label",ek).replace("ref",pD).getRegex(),YQ=ii(/^!?\[(ref)\](?:\[\])?/).replace("ref",pD).getRegex(),v5e=ii("reflink|nolink(?!\\()","g").replace("reflink",KQ).replace("nolink",YQ).getRegex(),bD={_backpedal:Dv,anyPunctuation:p5e,autolink:m5e,blockSkip:l5e,br:qQ,code:r5e,del:Dv,emStrongLDelim:c5e,emStrongRDelimAst:d5e,emStrongRDelimUnd:h5e,escape:n5e,link:b5e,nolink:YQ,punctuation:s5e,reflink:KQ,reflinkSearch:v5e,tag:y5e,text:i5e,url:Dv},x5e={...bD,link:ii(/^!?\[(label)\]\((.*?)\)/).replace("label",ek).getRegex(),reflink:ii(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ek).getRegex()},Fj={...bD,emStrongRDelimAst:f5e,emStrongLDelim:u5e,url:ii(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},w5e={...Fj,br:ii(qQ).replace("{2,}","*").getRegex(),text:ii(Fj.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},xS={normal:gD,gfm:e5e,pedantic:t5e},iv={normal:bD,gfm:Fj,breaks:w5e,pedantic:x5e},_5e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},e7=e=>_5e[e];function Mc(e,t){if(t){if(Fa.escapeTest.test(e))return e.replace(Fa.escapeReplace,e7)}else if(Fa.escapeTestNoEncode.test(e))return e.replace(Fa.escapeReplaceNoEncode,e7);return e}function t7(e){try{e=encodeURI(e).replace(Fa.percentDecode,"%")}catch{return null}return e}function n7(e,t){var s;const n=e.replace(Fa.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(Fa.splitPipe);let i=0;if(r[0].trim()||r.shift(),r.length>0&&!((s=r.at(-1))!=null&&s.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Fa.slashPipe,"|");return r}function sv(e,t,n){const r=e.length;if(r===0)return"";let i=0;for(;i<r&&e.charAt(r-i-1)===t;)i++;return e.slice(0,r-i)}function S5e(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function r7(e,t,n,r,i){const s=t.href,a=t.title||null,o=e[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:s,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function C5e(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const i=r[1];return t.split(`
`).map(s=>{const a=s.match(n.other.beginningSpace);if(a===null)return s;const[o]=a;return o.length>=i.length?s.slice(i.length):s}).join(`
`)}var tk=class{constructor(e){_e(this,"options");_e(this,"rules");_e(this,"lexer");this.options=e||fm}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:sv(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=C5e(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=sv(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:sv(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=sv(t[0],`
`).split(`
`),r="",i="";const s=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,i=i?`${i}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=d,n.length===0)break;const h=s.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const p=h,y=p.raw+`
`+n.join(`
`),b=this.blockquote(y);s[s.length-1]=b,r=r.substring(0,r.length-p.raw.length)+b.raw,i=i.substring(0,i.length-p.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const p=h,y=p.raw+`
`+n.join(`
`),b=this.list(y);s[s.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,i=i.substring(0,i.length-p.raw.length)+b.raw,n=y.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,i={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const s=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,w=>" ".repeat(3*w.length)),h=e.split(`
`,1)[0],p=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):p?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),p&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const w=this.rules.other.nextBulletRegex(y),_=this.rules.other.hrRegex(y),S=this.rules.other.fencesBeginRegex(y),C=this.rules.other.headingBeginRegex(y),E=this.rules.other.htmlBeginRegex(y);for(;e;){const T=e.split(`
`,1)[0];let R;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),R=h):R=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||C.test(h)||E.test(h)||w.test(h)||_.test(h))break;if(R.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+R.slice(y);else{if(p||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||C.test(d)||_.test(d))break;u+=`
`+h}!p&&!h.trim()&&(p=!0),c+=T+`
`,e=e.substring(T.length+1),d=R.slice(y)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,x;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(x=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!b,checked:x,loose:!1,text:u,tokens:[]}),i.raw+=c}const o=i.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l=0;l<i.items.length;l++)if(this.lexer.state.top=!1,i.items[l].tokens=this.lexer.blockTokens(i.items[l].text,[]),!i.loose){const c=i.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));i.loose=u}if(i.loose)for(let l=0;l<i.items.length;l++)i.items[l].loose=!0;return i}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:i}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=n7(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?s.align.push("right"):this.rules.other.tableAlignCenter.test(o)?s.align.push("center"):this.rules.other.tableAlignLeft.test(o)?s.align.push("left"):s.align.push(null);for(let o=0;o<n.length;o++)s.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:s.align[o]});for(const o of i)s.rows.push(n7(o,s.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:s.align[c]})));return s}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const s=sv(n.slice(0,-1),"\\");if((n.length-s.length)%2===0)return}else{const s=S5e(t[2],"()");if(s===-2)return;if(s>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],i="";if(this.options.pedantic){const s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],i=s[3])}else i=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),r7(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=t[r.toLowerCase()];if(!i){const s=n[0].charAt(0);return{type:"text",raw:s,text:s}}return r7(n,i,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const s=[...r[0]].length-1;let a,o,l=s,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+s);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&s%3&&!((s+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,s+r.index+d+o);if(Math.min(s,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const p=h.slice(2,-2);return{type:"strong",raw:h,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),i=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&i&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,i;if(t[2]==="@")r=t[0],i="mailto:"+r;else{let s;do s=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(s!==t[0]);r=t[0],t[1]==="www."?i="http://"+t[0]:i=t[0]}return{type:"link",raw:t[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},ed=class Lj{constructor(t){_e(this,"tokens");_e(this,"options");_e(this,"state");_e(this,"tokenizer");_e(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||fm,this.options.tokenizer=this.options.tokenizer||new tk,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:Fa,block:xS.normal,inline:iv.normal};this.options.pedantic?(n.block=xS.pedantic,n.inline=iv.pedantic):this.options.gfm&&(n.block=xS.gfm,this.options.breaks?n.inline=iv.breaks:n.inline=iv.gfm),this.tokenizer.rules=n}static get rules(){return{block:xS,inline:iv}}static lex(t,n){return new Lj(n).lex(t)}static lexInline(t,n){return new Lj(n).inlineTokens(t)}lex(t){t=t.replace(Fa.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var i,s,a;for(this.options.pedantic&&(t=t.replace(Fa.tabCharGlobal,"    ").replace(Fa.spaceLine,""));t;){let o;if((s=(i=this.options.extensions)==null?void 0:i.block)!=null&&s.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,i=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;t;){s||(a=""),s=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const p=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},p),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),s=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},nk=class{constructor(e){_e(this,"options");_e(this,"parser");this.options=e||fm}space(e){return""}code({text:e,lang:t,escaped:n}){var s;const r=(s=(t||"").match(Fa.notSpaceStart))==null?void 0:s[0],i=e.replace(Fa.endingNewline,"")+`
`;return r?'<pre><code class="language-'+Mc(r)+'">'+(n?i:Mc(i,!0))+`</code></pre>
`:"<pre><code>"+(n?i:Mc(i,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const i=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+i+s+`>
`+r+"</"+i+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+Mc(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let i=0;i<e.header.length;i++)n+=this.tablecell(e.header[i]);t+=this.tablerow({text:n});let r="";for(let i=0;i<e.rows.length;i++){const s=e.rows[i];n="";for(let a=0;a<s.length;a++)n+=this.tablecell(s[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Mc(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),i=t7(e);if(i===null)return r;e=i;let s='<a href="'+e+'"';return t&&(s+=' title="'+Mc(t)+'"'),s+=">"+r+"</a>",s}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const i=t7(e);if(i===null)return Mc(n);e=i;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${Mc(t)}"`),s+=">",s}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Mc(e.text)}},vD=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},td=class Bj{constructor(t){_e(this,"options");_e(this,"renderer");_e(this,"textRenderer");this.options=t||fm,this.options.renderer=this.options.renderer||new nk,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new vD}static parse(t,n){return new Bj(n).parse(t)}static parseInline(t,n){return new Bj(n).parseInline(t)}parse(t,n=!0){var i,s;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var i,s;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((s=(i=this.options.extensions)==null?void 0:i.renderers)!=null&&s[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},a3,f2=(a3=class{constructor(e){_e(this,"options");_e(this,"block");this.options=e||fm}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?ed.lex:ed.lexInline}provideParser(){return this.block?td.parse:td.parseInline}},_e(a3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),a3),k5e=class{constructor(...e){_e(this,"defaults",dD());_e(this,"options",this.setOptions);_e(this,"parse",this.parseMarkdown(!0));_e(this,"parseInline",this.parseMarkdown(!1));_e(this,"Parser",td);_e(this,"Renderer",nk);_e(this,"TextRenderer",vD);_e(this,"Lexer",ed);_e(this,"Tokenizer",tk);_e(this,"Hooks",f2);this.use(...e)}walkTokens(e,t){var r,i;let n=[];for(const s of e)switch(n=n.concat(t.call(this,s)),s.type){case"table":{const a=s;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=s;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=s;(i=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&i[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){const s=t.renderers[i.name];s?t.renderers[i.name]=function(...a){let o=i.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:t.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const s=t[i.level];s?s.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level==="block"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level==="inline"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),r.extensions=t),n.renderer){const i=this.defaults.renderer||new nk(this.defaults);for(const s in n.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;const a=s,o=n.renderer[a],l=i[a];i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u||""}}r.renderer=i}if(n.tokenizer){const i=this.defaults.tokenizer||new tk(this.defaults);for(const s in n.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;const a=s,o=n.tokenizer[a],l=i[a];i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.tokenizer=i}if(n.hooks){const i=this.defaults.hooks||new f2;for(const s in n.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;const a=s,o=n.hooks[a],l=i[a];f2.passThroughHooks.has(s)?i[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(i,c)).then(d=>l.call(i,d));const u=o.call(i,c);return l.call(i,u)}:i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.hooks=i}if(n.walkTokens){const i=this.defaults.walkTokens,s=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),i&&(o=o.concat(i.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return ed.lex(e,t??this.defaults)}parser(e,t){return td.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const i={...r},s={...this.defaults,...i},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));s.hooks&&(s.hooks.options=s,s.hooks.block=e);const o=s.hooks?s.hooks.provideLexer():e?ed.lex:ed.lexInline,l=s.hooks?s.hooks.provideParser():e?td.parse:td.parseInline;if(s.async)return Promise.resolve(s.hooks?s.hooks.preprocess(n):n).then(c=>o(c,s)).then(c=>s.hooks?s.hooks.processAllTokens(c):c).then(c=>s.walkTokens?Promise.all(this.walkTokens(c,s.walkTokens)).then(()=>c):c).then(c=>l(c,s)).then(c=>s.hooks?s.hooks.postprocess(c):c).catch(a);try{s.hooks&&(n=s.hooks.preprocess(n));let c=o(n,s);s.hooks&&(c=s.hooks.processAllTokens(c)),s.walkTokens&&this.walkTokens(c,s.walkTokens);let u=l(c,s);return s.hooks&&(u=s.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Mc(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},Up=new k5e;function ti(e,t){return Up.parse(e,t)}ti.options=ti.setOptions=function(e){return Up.setOptions(e),ti.defaults=Up.defaults,BQ(ti.defaults),ti};ti.getDefaults=dD;ti.defaults=fm;ti.use=function(...e){return Up.use(...e),ti.defaults=Up.defaults,BQ(ti.defaults),ti};ti.walkTokens=function(e,t){return Up.walkTokens(e,t)};ti.parseInline=Up.parseInline;ti.Parser=td;ti.parser=td.parse;ti.Renderer=nk;ti.TextRenderer=vD;ti.Lexer=ed;ti.lexer=ed.lex;ti.Tokenizer=tk;ti.Hooks=f2;ti.parse=ti;ti.options;ti.setOptions;ti.use;ti.walkTokens;ti.parseInline;td.parse;ed.lex;function ZQ(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var i=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(i.length){var s=new RegExp(`
[	 ]{`+Math.min.apply(Math,i)+"}","g");r=r.map(function(o){return o.replace(s,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,p){return p===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function XQ(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),i=ZQ(r);return t===!1?i.replace(/ /g,"&nbsp;"):i}ie(XQ,"preprocessMarkdown");function JQ(e,t={}){const n=XQ(e,t),r=ti.lexer(n),i=[[]];let s=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(s++,i.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&i[s].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&i[s].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&i[s].push({content:o.text,type:"normal"})}),i}ie(JQ,"markdownToLines");function QQ(e,{markdownAutoWrap:t}={}){const n=ti.lexer(e);function r(i){var s,a,o;return i.type==="text"?t===!1?i.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):i.text.replace(/\n */g,"<br/>"):i.type==="strong"?`<strong>${(s=i.tokens)==null?void 0:s.map(r).join("")}</strong>`:i.type==="em"?`<em>${(a=i.tokens)==null?void 0:a.map(r).join("")}</em>`:i.type==="paragraph"?`<p>${(o=i.tokens)==null?void 0:o.map(r).join("")}</p>`:i.type==="space"?"":i.type==="html"?`${i.text}`:i.type==="escape"?i.text:`Unsupported markdown: ${i.type}`}return ie(r,"output"),n.map(r).join("")}ie(QQ,"markdownToHTML");function eee(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(eee,"splitTextToChars");function tee(e,t){const n=eee(t.content);return xD(e,[],n,t.type)}ie(tee,"splitWordToFitWidth");function xD(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[i,...s]=n,a=[...t,i];return e([{content:a.join(""),type:r}])?xD(e,a,s,r):(t.length===0&&i&&(t.push(i),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(xD,"splitWordToFitWidthRecursion");function nee(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return rk(e,t)}ie(nee,"splitLineToFitWidth");function rk(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let i="";e[0].content===" "&&(i=" ",e.shift());const s=e.shift()??{content:" ",type:"normal"},a=[...r];if(i!==""&&a.push({content:i,type:"normal"}),a.push(s),t(a))return rk(e,t,n,a);if(r.length>0)n.push(r),e.unshift(s);else if(s.content){const[o,l]=tee(t,s);n.push([o]),l.content&&e.unshift(l)}return rk(e,t,n)}ie(rk,"splitLineToFitWidthRecursion");function $j(e,t){t&&e.attr("style",t)}ie($j,"applyStyle");async function ree(e,t,n,r,i=!1){const s=e.append("foreignObject");s.attr("width",`${10*n}px`),s.attr("height",`${10*n}px`);const a=s.append("xhtml:div");let o=t.label;t.label&&j0(t.label)&&(o=await RP(t.label.replace(gy.lineBreakRegex,`
`),Xr()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),$j(c,t.labelStyle),c.attr("class",`${l} ${r}`),$j(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),i&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),s.node()}ie(ree,"addHtmlSpan");function rT(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(rT,"createTspan");function iee(e,t,n){const r=e.append("text"),i=rT(r,1,t);iT(i,n);const s=i.node().getComputedTextLength();return r.remove(),s}ie(iee,"computeWidthOfText");function E5e(e,t,n){var a;const r=e.append("text"),i=rT(r,1,t);iT(i,[{content:n,type:"normal"}]);const s=(a=i.node())==null?void 0:a.getBoundingClientRect();return s&&r.remove(),s}ie(E5e,"computeDimensionOfText");function see(e,t,n,r=!1){const s=t.append("g"),a=s.insert("rect").attr("class","background").attr("style","stroke: none"),o=s.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>iee(s,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:nee(c,u);for(const h of d){const p=rT(o,l,1.1);iT(p,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),s.node()}else return o.node()}ie(see,"createFormattedText");function iT(e,t){e.text(""),t.forEach((n,r)=>{const i=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?i.text(n.content):i.text(" "+n.content)})}ie(iT,"updateTextContentAndStyles");function aee(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(aee,"replaceIconSubstring");var vh=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:i="",useHtmlLabels:s=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(Lt.debug("XYZ createText",t,n,r,i,s,a,"addSvgBackground: ",l),s){const u=QQ(t,c),d=aee(dm(u)),h=t.replace(/\\\\/g,"\\"),p={isNode:a,label:j0(t)?h:d,labelStyle:n.replace("fill:","color:")};return await ree(e,p,o,i,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=JQ(u.replace("<br>","<br/>"),c),h=see(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const p=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Lr(h).attr("style",p)}else{const p=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Lr(h).select("rect").attr("style",p.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Lr(h).select("text").attr("style",y)}return h}},"createText");function iN(e,t,n){if(e&&e.length){const[r,i]=t,s=Math.PI/180*n,a=Math.cos(s),o=Math.sin(s);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-i)*o+r,l[1]=(c-r)*o+(u-i)*a+i}}}function T5e(e,t){return e[0]===t[0]&&e[1]===t[1]}function A5e(e,t,n,r=1){const i=n,s=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(i)for(const c of a)iN(c,o,i);const l=function(c,u,d){const h=[];for(const _ of c){const S=[..._];T5e(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const p=[];u=Math.max(u,.1);const y=[];for(const _ of h)for(let S=0;S<_.length-1;S++){const C=_[S],E=_[S+1];if(C[1]!==E[1]){const T=Math.min(C[1],E[1]);y.push({ymin:T,ymax:Math.max(C[1],E[1]),x:T===C[1]?C[0]:E[0],islope:(E[0]-C[0])/(E[1]-C[1])})}}if(y.sort((_,S)=>_.ymin<S.ymin?-1:_.ymin>S.ymin?1:_.x<S.x?-1:_.x>S.x?1:_.ymax===S.ymax?0:(_.ymax-S.ymax)/Math.abs(_.ymax-S.ymax)),!y.length)return p;let b=[],x=y[0].ymin,w=0;for(;b.length||y.length;){if(y.length){let _=-1;for(let S=0;S<y.length&&!(y[S].ymin>x);S++)_=S;y.splice(0,_+1).forEach(S=>{b.push({s:x,edge:S})})}if(b=b.filter(_=>!(_.edge.ymax<=x)),b.sort((_,S)=>_.edge.x===S.edge.x?0:(_.edge.x-S.edge.x)/Math.abs(_.edge.x-S.edge.x)),(d!==1||w%u==0)&&b.length>1)for(let _=0;_<b.length;_+=2){const S=_+1;if(S>=b.length)break;const C=b[_].edge,E=b[S].edge;p.push([[Math.round(C.x),x],[Math.round(E.x),x]])}x+=d,b.forEach(_=>{_.edge.x=_.edge.x+d*_.edge.islope}),w++}return p}(a,s,r);if(i){for(const c of a)iN(c,o,-i);(function(c,u,d){const h=[];c.forEach(p=>h.push(...p)),iN(h,u,d)})(l,o,-i)}return l}function y1(e,t){var n;const r=t.hachureAngle+90;let i=t.hachureGap;i<0&&(i=4*t.strokeWidth),i=Math.round(Math.max(i,.1));let s=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(s=i),A5e(e,i,r,s||1)}class wD{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=y1(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const i of t)r.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],n));return r}}function sT(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class R5e extends wD{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const i=y1(t,Object.assign({},n,{hachureGap:r})),s=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(s),l=.5*r*Math.sin(s);for(const[c,u]of i)sT([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class I5e extends wD{fillPolygons(t,n){const r=this._fillPolygons(t,n),i=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),s=this._fillPolygons(t,i);return r.ops=r.ops.concat(s.ops),r}}class M5e{constructor(t){this.helper=t}fillPolygons(t,n){const r=y1(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let i=n.hachureGap;i<0&&(i=4*n.strokeWidth),i=Math.max(i,.1);let s=n.fillWeight;s<0&&(s=n.strokeWidth/2);const a=i/4;for(const o of t){const l=sT(o),c=l/i,u=Math.ceil(c)-1,d=l-u*i,h=(o[0][0]+o[1][0])/2-i/4,p=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=p+d+y*i,x=h-a+2*Math.random()*a,w=b-a+2*Math.random()*a,_=this.helper.ellipse(x,w,s,s,n);r.push(..._.ops)}}return{type:"fillSketch",ops:r}}}class N5e{constructor(t){this.helper=t}fillPolygons(t,n){const r=y1(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,i=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,s=[];return t.forEach(a=>{const o=sT(a),l=Math.floor(o/(r+i)),c=(o+i-l*(r+i))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let p=0;p<l;p++){const y=p*(r+i),b=y+r,x=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],w=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];s.push(...this.helper.doubleLineOps(x[0],x[1],w[0],w[1],n))}}),s}}class j5e{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,i=n.zigzagOffset<0?r:n.zigzagOffset,s=y1(t,n=Object.assign({},n,{hachureGap:r+i}));return{type:"fillSketch",ops:this.zigzagLines(s,i,n)}}zigzagLines(t,n,r){const i=[];return t.forEach(s=>{const a=sT(s),o=Math.round(a/(2*n));let l=s[0],c=s[1];l[0]>c[0]&&(l=s[1],c=s[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,p=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],x=[l[0]+p*Math.cos(u),l[1]+p*Math.sin(u)],w=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];i.push(...this.helper.doubleLineOps(b[0],b[1],w[0],w[1],r),...this.helper.doubleLineOps(w[0],w[1],x[0],x[1],r))}}),i}}const Qa={};let O5e=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}};const P5e=0,sN=1,i7=2,wS={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function aN(e,t){return e.type===t}function _D(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:P5e,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:sN,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:i7,text:""},o}(e);let r="BOD",i=0,s=n[i];for(;!aN(s,i7);){let a=0;const o=[];if(r==="BOD"){if(s.text!=="M"&&s.text!=="m")return _D("M0,0"+e);i++,a=wS[s.text],r=s.text}else aN(s,sN)?a=wS[r]:(i++,a=wS[s.text],r=s.text);if(!(i+a<n.length))throw new Error("Path data ended short");for(let l=i;l<i+a;l++){const c=n[l];if(!aN(c,sN))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof wS[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),i+=a,s=n[i],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function oee(e){let t=0,n=0,r=0,i=0;const s=[];for(const{key:a,data:o}of e)switch(a){case"M":s.push({key:"M",data:[...o]}),[t,n]=o,[r,i]=o;break;case"m":t+=o[0],n+=o[1],s.push({key:"M",data:[t,n]}),r=t,i=n;break;case"L":s.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],s.push({key:"L",data:[t,n]});break;case"C":s.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);s.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":s.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);s.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":s.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],s.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":s.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],s.push({key:"H",data:[t]});break;case"V":s.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],s.push({key:"V",data:[n]});break;case"S":s.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);s.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":s.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],s.push({key:"T",data:[t,n]});break;case"Z":case"z":s.push({key:"Z",data:[]}),t=r,n=i}return s}function lee(e){const t=[];let n="",r=0,i=0,s=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,i]=u,[s,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],i=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,i]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,i]});break;case"V":i=u[0],t.push({key:"L",data:[r,i]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=i+(i-l)):(d=r,h=i),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],i=u[3];break}case"T":{const[d,h]=u;let p=0,y=0;n==="Q"||n==="T"?(p=r+(r-o),y=i+(i-l)):(p=r,y=i);const b=r+2*(p-r)/3,x=i+2*(y-i)/3,w=d+2*(p-d)/3,_=h+2*(y-h)/3;t.push({key:"C",data:[b,x,w,_,d,h]}),o=p,l=y,r=d,i=h;break}case"Q":{const[d,h,p,y]=u,b=r+2*(d-r)/3,x=i+2*(h-i)/3,w=p+2*(d-p)/3,_=y+2*(h-y)/3;t.push({key:"C",data:[b,x,w,_,p,y]}),o=d,l=h,r=p,i=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),p=u[2],y=u[3],b=u[4],x=u[5],w=u[6];d===0||h===0?(t.push({key:"C",data:[r,i,x,w,x,w]}),r=x,i=w):(r!==x||i!==w)&&(cee(r,i,x,w,d,h,p,y,b).forEach(function(_){t.push({key:"C",data:_})}),r=x,i=w);break}case"Z":t.push({key:"Z",data:[]}),r=s,i=a}n=c}return t}function av(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function cee(e,t,n,r,i,s,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],p=0,y=0,b=0,x=0;if(c)[p,y,b,x]=c;else{[e,t]=av(e,t,-u),[n,r]=av(n,r,-u);const H=(e-n)/2,F=(t-r)/2;let Q=H*H/(i*i)+F*F/(s*s);Q>1&&(Q=Math.sqrt(Q),i*=Q,s*=Q);const q=i*i,K=s*s,U=q*K-q*F*F-K*H*H,re=q*F*F+K*H*H,G=(o===l?-1:1)*Math.sqrt(Math.abs(U/re));b=G*i*F/s+(e+n)/2,x=G*-s*H/i+(t+r)/2,p=Math.asin(parseFloat(((t-x)/s).toFixed(9))),y=Math.asin(parseFloat(((r-x)/s).toFixed(9))),e<b&&(p=Math.PI-p),n<b&&(y=Math.PI-y),p<0&&(p=2*Math.PI+p),y<0&&(y=2*Math.PI+y),l&&p>y&&(p-=2*Math.PI),!l&&y>p&&(y-=2*Math.PI)}let w=y-p;if(Math.abs(w)>120*Math.PI/180){const H=y,F=n,Q=r;y=l&&y>p?p+120*Math.PI/180*1:p+120*Math.PI/180*-1,h=cee(n=b+i*Math.cos(y),r=x+s*Math.sin(y),F,Q,i,s,a,0,l,[y,H,b,x])}w=y-p;const _=Math.cos(p),S=Math.sin(p),C=Math.cos(y),E=Math.sin(y),T=Math.tan(w/4),R=4/3*i*T,M=4/3*s*T,N=[e,t],O=[e+R*S,t-M*_],B=[n+R*E,r-M*C],P=[n,r];if(O[0]=2*N[0]-O[0],O[1]=2*N[1]-O[1],c)return[O,B,P].concat(h);{h=[O,B,P].concat(h);const H=[];for(let F=0;F<h.length;F+=3){const Q=av(h[F][0],h[F][1],u),q=av(h[F+1][0],h[F+1][1],u),K=av(h[F+2][0],h[F+2][1],u);H.push([Q[0],Q[1],q[0],q[1],K[0],K[1]])}return H}}const D5e={randOffset:function(e,t){return Vn(e,t)},randOffsetWithRange:function(e,t,n){return ik(e,t,n)},ellipse:function(e,t,n,r,i){const s=dee(n,r,i);return zj(e,t,i,s).opset},doubleLineOps:function(e,t,n,r,i){return Jf(e,t,n,r,i,!0)}};function uee(e,t,n,r,i){return{type:"path",ops:Jf(e,t,n,r,i)}}function h2(e,t,n){const r=(e||[]).length;if(r>2){const i=[];for(let s=0;s<r-1;s++)i.push(...Jf(e[s][0],e[s][1],e[s+1][0],e[s+1][1],n));return t&&i.push(...Jf(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:i}}return r===2?uee(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function F5e(e,t,n,r,i){return function(s,a){return h2(s,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],i)}function s7(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=_S(n[0],1*(1+.2*t.roughness),t),i=t.disableMultiStroke?[]:_S(n[0],1.5*(1+.22*t.roughness),l7(t));for(let s=1;s<n.length;s++){const a=n[s];if(a.length){const o=_S(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:_S(a,1.5*(1+.22*t.roughness),l7(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&i.push(c)}}return{type:"path",ops:r.concat(i)}}return{type:"path",ops:[]}}function dee(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),i=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),s=2*Math.PI/i;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=Vn(a*l,n),o+=Vn(o*l,n),{increment:s,rx:a,ry:o}}function zj(e,t,n,r){const[i,s]=c7(r.increment,e,t,r.rx,r.ry,1,r.increment*ik(.1,ik(.4,1,n),n),n);let a=sk(i,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=c7(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=sk(o,null,n);a=a.concat(l)}return{estimatedPoints:s,opset:{type:"path",ops:a}}}function a7(e,t,n,r,i,s,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=Vn(.01*d,l),h+=Vn(.01*h,l);let p=i,y=s;for(;p<0;)p+=2*Math.PI,y+=2*Math.PI;y-p>2*Math.PI&&(p=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,x=Math.min(b/2,(y-p)/2),w=u7(x,c,u,d,h,p,y,1,l);if(!l.disableMultiStroke){const _=u7(x,c,u,d,h,p,y,1.5,l);w.push(..._)}return a&&(o?w.push(...Jf(c,u,c+d*Math.cos(p),u+h*Math.sin(p),l),...Jf(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):w.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(p),u+h*Math.sin(p)]})),{type:"path",ops:w}}function o7(e,t){const n=lee(oee(_D(e))),r=[];let i=[0,0],s=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":s=[o[0],o[1]],i=[o[0],o[1]];break;case"L":r.push(...Jf(s[0],s[1],o[0],o[1],t)),s=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,p]=o;r.push(...L5e(l,c,u,d,h,p,s,t)),s=[h,p];break}case"Z":r.push(...Jf(s[0],s[1],i[0],i[1],t)),s=[i[0],i[1]]}return{type:"path",ops:r}}function oN(e,t){const n=[];for(const r of e)if(r.length){const i=t.maxRandomnessOffset||0,s=r.length;if(s>2){n.push({op:"move",data:[r[0][0]+Vn(i,t),r[0][1]+Vn(i,t)]});for(let a=1;a<s;a++)n.push({op:"lineTo",data:[r[a][0]+Vn(i,t),r[a][1]+Vn(i,t)]})}}return{type:"fillPath",ops:n}}function hg(e,t){return function(n,r){let i=n.fillStyle||"hachure";if(!Qa[i])switch(i){case"zigzag":Qa[i]||(Qa[i]=new R5e(r));break;case"cross-hatch":Qa[i]||(Qa[i]=new I5e(r));break;case"dots":Qa[i]||(Qa[i]=new M5e(r));break;case"dashed":Qa[i]||(Qa[i]=new N5e(r));break;case"zigzag-line":Qa[i]||(Qa[i]=new j5e(r));break;default:i="hachure",Qa[i]||(Qa[i]=new wD(r))}return Qa[i]}(t,D5e).fillPolygons(e,t)}function l7(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function fee(e){return e.randomizer||(e.randomizer=new O5e(e.seed||0)),e.randomizer.next()}function ik(e,t,n,r=1){return n.roughness*r*(fee(n)*(t-e)+e)}function Vn(e,t,n=1){return ik(-e,e,t,n)}function Jf(e,t,n,r,i,s=!1){const a=s?i.disableMultiStrokeFill:i.disableMultiStroke,o=Uj(e,t,n,r,i,!0,!1);if(a)return o;const l=Uj(e,t,n,r,i,!0,!0);return o.concat(l)}function Uj(e,t,n,r,i,s,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=i.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*fee(i);let p=i.bowing*i.maxRandomnessOffset*(r-t)/200,y=i.bowing*i.maxRandomnessOffset*(e-n)/200;p=Vn(p,i,c),y=Vn(y,i,c);const b=[],x=()=>Vn(d,i,c),w=()=>Vn(u,i,c),_=i.preserveVertices;return a?b.push({op:"move",data:[e+(_?0:x()),t+(_?0:x())]}):b.push({op:"move",data:[e+(_?0:Vn(u,i,c)),t+(_?0:Vn(u,i,c))]}),a?b.push({op:"bcurveTo",data:[p+e+(n-e)*h+x(),y+t+(r-t)*h+x(),p+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(_?0:x()),r+(_?0:x())]}):b.push({op:"bcurveTo",data:[p+e+(n-e)*h+w(),y+t+(r-t)*h+w(),p+e+2*(n-e)*h+w(),y+t+2*(r-t)*h+w(),n+(_?0:w()),r+(_?0:w())]}),b}function _S(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+Vn(t,n),e[0][1]+Vn(t,n)]),r.push([e[0][0]+Vn(t,n),e[0][1]+Vn(t,n)]);for(let i=1;i<e.length;i++)r.push([e[i][0]+Vn(t,n),e[i][1]+Vn(t,n)]),i===e.length-1&&r.push([e[i][0]+Vn(t,n),e[i][1]+Vn(t,n)]);return sk(r,null,n)}function sk(e,t,n){const r=e.length,i=[];if(r>3){const s=[],a=1-n.curveTightness;i.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];s[0]=[l[0],l[1]],s[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],s[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],s[3]=[e[o+1][0],e[o+1][1]],i.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else r===3?(i.push({op:"move",data:[e[1][0],e[1][1]]}),i.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&i.push(...Uj(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return i}function c7(e,t,n,r,i,s,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+i*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+i*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+i*Math.sin(0)]),c.push([t+r*Math.cos(e),n+i*Math.sin(e)])}else{const u=Vn(.5,o)-Math.PI/2;c.push([Vn(s,o)+t+.9*r*Math.cos(u-e),Vn(s,o)+n+.9*i*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const p=[Vn(s,o)+t+r*Math.cos(h),Vn(s,o)+n+i*Math.sin(h)];l.push(p),c.push(p)}c.push([Vn(s,o)+t+r*Math.cos(u+2*Math.PI+.5*a),Vn(s,o)+n+i*Math.sin(u+2*Math.PI+.5*a)]),c.push([Vn(s,o)+t+.98*r*Math.cos(u+a),Vn(s,o)+n+.98*i*Math.sin(u+a)]),c.push([Vn(s,o)+t+.9*r*Math.cos(u+.5*a),Vn(s,o)+n+.9*i*Math.sin(u+.5*a)])}return[c,l]}function u7(e,t,n,r,i,s,a,o,l){const c=s+Vn(.1,l),u=[];u.push([Vn(o,l)+t+.9*r*Math.cos(c-e),Vn(o,l)+n+.9*i*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([Vn(o,l)+t+r*Math.cos(d),Vn(o,l)+n+i*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+i*Math.sin(a)]),u.push([t+r*Math.cos(a),n+i*Math.sin(a)]),sk(u,null,l)}function L5e(e,t,n,r,i,s,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let p=0;p<d;p++)p===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:Vn(c[0],o)),a[1]+(h?0:Vn(c[0],o))]}),u=h?[i,s]:[i+Vn(c[p],o),s+Vn(c[p],o)],l.push({op:"bcurveTo",data:[e+Vn(c[p],o),t+Vn(c[p],o),n+Vn(c[p],o),r+Vn(c[p],o),u[0],u[1]]});return l}function ov(e){return[...e]}function d7(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(ov(e[0]),ov(e[1]),ov(e[2]),ov(e[2]));else{const i=[];i.push(e[0],e[0]);for(let o=1;o<e.length;o++)i.push(e[o]),o===e.length-1&&i.push(e[o]);const s=[],a=1-t;r.push(ov(i[0]));for(let o=1;o+2<i.length;o++){const l=i[o];s[0]=[l[0],l[1]],s[1]=[l[0]+(a*i[o+1][0]-a*i[o-1][0])/6,l[1]+(a*i[o+1][1]-a*i[o-1][1])/6],s[2]=[i[o+1][0]+(a*i[o][0]-a*i[o+2][0])/6,i[o+1][1]+(a*i[o][1]-a*i[o+2][1])/6],s[3]=[i[o+1][0],i[o+1][1]],r.push(s[1],s[2],s[3])}}return r}function p2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function B5e(e,t,n){const r=p2(t,n);if(r===0)return p2(e,t);let i=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return i=Math.max(0,Math.min(1,i)),p2(e,rp(t,n,i))}function rp(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function qj(e,t,n,r){const i=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let p=3*u[0]-2*c[0]-h[0];p*=p;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let x=3*d[1]-2*h[1]-c[1];return x*=x,p<b&&(p=b),y<x&&(y=x),p+y}(e,t)<n){const o=e[t+0];i.length?(s=i[i.length-1],a=o,Math.sqrt(p2(s,a))>1&&i.push(o)):i.push(o),i.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=rp(l,c,.5),p=rp(c,u,.5),y=rp(u,d,.5),b=rp(h,p,.5),x=rp(p,y,.5),w=rp(b,x,.5);qj([l,h,b,w],0,n,i),qj([w,x,y,d],0,n,i)}var s,a;return i}function $5e(e,t){return ak(e,0,e.length,t)}function ak(e,t,n,r,i){const s=i||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=B5e(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(ak(e,t,c+1,r,s),ak(e,c,n,r,s)):(s.length||s.push(a),s.push(o)),s}function lN(e,t=.15,n){const r=[],i=(e.length-1)/3;for(let s=0;s<i;s++)qj(e,3*s,t,r);return n&&n>0?ak(r,0,r.length,n):r}const No="none";class ok{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,i,s){const a=this._o(s);return this._d("line",[uee(t,n,r,i,a)],a)}rectangle(t,n,r,i,s){const a=this._o(s),o=[],l=F5e(t,n,r,i,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+i],[t,n+i]];a.fillStyle==="solid"?o.push(oN([c],a)):o.push(hg([c],a))}return a.stroke!==No&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,i,s){const a=this._o(s),o=[],l=dee(r,i,a),c=zj(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=zj(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(hg([c.estimatedPoints],a));return a.stroke!==No&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,i){const s=this.ellipse(t,n,r,r,i);return s.shape="circle",s}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[h2(t,!1,r)],r)}arc(t,n,r,i,s,a,o=!1,l){const c=this._o(l),u=[],d=a7(t,n,r,i,s,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const p=a7(t,n,r,i,s,a,!0,!1,h);p.type="fillPath",u.push(p)}else u.push(function(h,p,y,b,x,w,_){const S=h,C=p;let E=Math.abs(y/2),T=Math.abs(b/2);E+=Vn(.01*E,_),T+=Vn(.01*T,_);let R=x,M=w;for(;R<0;)R+=2*Math.PI,M+=2*Math.PI;M-R>2*Math.PI&&(R=0,M=2*Math.PI);const N=(M-R)/_.curveStepCount,O=[];for(let B=R;B<=M;B+=N)O.push([S+E*Math.cos(B),C+T*Math.sin(B)]);return O.push([S+E*Math.cos(M),C+T*Math.sin(M)]),O.push([S,C]),hg([O],_)}(t,n,r,i,s,a,c));return c.stroke!==No&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),i=[],s=s7(t,r);if(r.fill&&r.fill!==No)if(r.fillStyle==="solid"){const a=s7(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...lN(d7([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...lN(d7(c),10,(1+r.roughness)/2))}a.length&&i.push(hg([a],r))}return r.stroke!==No&&i.push(s),this._d("curve",i,r)}polygon(t,n){const r=this._o(n),i=[],s=h2(t,!0,r);return r.fill&&(r.fillStyle==="solid"?i.push(oN([t],r)):i.push(hg([t],r))),r.stroke!==No&&i.push(s),this._d("polygon",i,r)}path(t,n){const r=this._o(n),i=[];if(!t)return this._d("path",i,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=r.fill&&r.fill!=="transparent"&&r.fill!==No,a=r.stroke!==No,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const p=lee(oee(_D(u))),y=[];let b=[],x=[0,0],w=[];const _=()=>{w.length>=4&&b.push(...lN(w,d)),w=[]},S=()=>{_(),b.length&&(y.push(b),b=[])};for(const{key:E,data:T}of p)switch(E){case"M":S(),x=[T[0],T[1]],b.push(x);break;case"L":_(),b.push([T[0],T[1]]);break;case"C":if(!w.length){const R=b.length?b[b.length-1]:x;w.push([R[0],R[1]])}w.push([T[0],T[1]]),w.push([T[2],T[3]]),w.push([T[4],T[5]]);break;case"Z":_(),b.push([x[0],x[1]])}if(S(),!h)return y;const C=[];for(const E of y){const T=$5e(E,h);T.length&&C.push(T)}return C}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=o7(t,r);if(s)if(r.fillStyle==="solid")if(l.length===1){const u=o7(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else i.push(oN(l,r));else i.push(hg(l,r));return a&&(o?l.forEach(u=>{i.push(h2(u,!1,r))}):i.push(c)),this._d("path",i,r)}opsToPath(t,n){let r="";for(const i of t.ops){const s=typeof n=="number"&&n>=0?i.data.map(a=>+a.toFixed(n)):i.data;switch(i.op){case"move":r+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":r+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":r+=`L${s[0]} ${s[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,i=[];for(const s of n){let a=null;switch(s.type){case"path":a={d:this.opsToPath(s),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:No};break;case"fillPath":a={d:this.opsToPath(s),stroke:No,strokeWidth:0,fill:r.fill||No};break;case"fillSketch":a=this.fillSketch(s,r)}a&&i.push(a)}return i}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||No,strokeWidth:r,fill:No}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class z5e{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new ok(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),i=this.ctx,s=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":i.save(),i.strokeStyle=r.stroke==="none"?"transparent":r.stroke,i.lineWidth=r.strokeWidth,r.strokeLineDash&&i.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(i.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(i,a,s),i.restore();break;case"fillPath":{i.save(),i.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,a,s,o),i.restore();break}case"fillSketch":this.fillSketch(i,a,r)}}fillSketch(t,n,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=i,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,i="nonzero"){t.beginPath();for(const s of n.ops){const a=typeof r=="number"&&r>=0?s.data.map(o=>+o.toFixed(r)):s.data;switch(s.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(i):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,i,s){const a=this.gen.line(t,n,r,i,s);return this.draw(a),a}rectangle(t,n,r,i,s){const a=this.gen.rectangle(t,n,r,i,s);return this.draw(a),a}ellipse(t,n,r,i,s){const a=this.gen.ellipse(t,n,r,i,s);return this.draw(a),a}circle(t,n,r,i){const s=this.gen.circle(t,n,r,i);return this.draw(s),s}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,i,s,a,o=!1,l){const c=this.gen.arc(t,n,r,i,s,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const SS="http://www.w3.org/2000/svg";class U5e{constructor(t,n){this.svg=t,this.gen=new ok(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,s=i.createElementNS(SS,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=i.createElementNS(SS,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=i.createElementNS(SS,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(i,o,r)}l&&s.appendChild(l)}return s}fillSketch(t,n,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);const s=t.createElementNS(SS,"path");return s.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),s.setAttribute("stroke",r.fill||""),s.setAttribute("stroke-width",i+""),s.setAttribute("fill","none"),r.fillLineDash&&s.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,i,s){const a=this.gen.line(t,n,r,i,s);return this.draw(a)}rectangle(t,n,r,i,s){const a=this.gen.rectangle(t,n,r,i,s);return this.draw(a)}ellipse(t,n,r,i,s){const a=this.gen.ellipse(t,n,r,i,s);return this.draw(a)}circle(t,n,r,i){const s=this.gen.circle(t,n,r,i);return this.draw(s)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,i,s,a,o=!1,l){const c=this.gen.arc(t,n,r,i,s,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var wn={canvas:(e,t)=>new z5e(e,t),svg:(e,t)=>new U5e(e,t),generator:e=>new ok(e),newSeed:()=>ok.newSeed()},rr=ie(async(e,t,n)=>{var d,h;let r;const i=t.useHtmlLabels||Es((d=Xr())==null?void 0:d.htmlLabels);n?r=n:r="node default";const s=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=s.insert("g").attr("class","label").attr("style",$a(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await vh(a,Lp(dm(o),Xr()),{useHtmlLabels:i,width:t.width||((h=Xr().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(i){const p=l.children[0],y=Lr(l),b=p.getElementsByTagName("img");if(b){const x=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(w=>new Promise(_=>{function S(){if(w.style.display="flex",w.style.flexDirection="column",x){const C=Xr().fontSize?Xr().fontSize:window.getComputedStyle(document.body).fontSize,E=5,[T=AZ.fontSize]=eT(C),R=T*E+"px";w.style.minWidth=R,w.style.maxWidth=R}else w.style.width="100%";_(w)}ie(S,"setupImage"),setTimeout(()=>{w.complete&&S()}),w.addEventListener("error",S),w.addEventListener("load",S)})))}c=p.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return i?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:s,bbox:c,halfPadding:u,label:a}},"labelHelper"),cN=ie(async(e,t,n)=>{var l,c,u,d,h,p;const r=n.useHtmlLabels||Es((c=(l=Xr())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),i=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),s=await vh(i,Lp(dm(t),Xr()),{useHtmlLabels:r,width:n.width||((d=(u=Xr())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=s.getBBox();const o=n.padding/2;if(Es((p=(h=Xr())==null?void 0:h.flowchart)==null?void 0:p.htmlLabels)){const y=s.children[0],b=Lr(s);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):i.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),i.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:i}},"insertLabel"),kn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),Wn=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Ur(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Ur,"createPathFromPoints");function Qf(e,t,n,r,i,s){const a=[],l=n-e,c=r-t,u=l/s,d=2*Math.PI/u,h=t+c/2;for(let p=0;p<=50;p++){const y=p/50,b=e+y*l,x=h+i*Math.sin(d*(b-e));a.push({x:b,y:x})}return a}ie(Qf,"generateFullSineWavePoints");function SD(e,t,n,r,i,s){const a=[],o=i*Math.PI/180,u=(s*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-p,y:-y})}return a}ie(SD,"generateCirclePoints");var q5e=ie((e,t)=>{var n=e.x,r=e.y,i=t.x-n,s=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(s)*a>Math.abs(i)*o?(s<0&&(o=-o),l=s===0?0:o*i/s,c=o):(i<0&&(a=-a),l=a,c=i===0?0:a*s/i),{x:n+l,y:r+c}},"intersectRect"),vy=q5e;function hee(e,t){t&&e.attr("style",t)}ie(hee,"applyStyle");async function pee(e){const t=Lr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&j0(e.label)&&(r=await RP(e.label.replace(gy.lineBreakRegex,`
`),Xr()));const i=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+i+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),hee(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(pee,"addHtmlLabel");var V5e=ie(async(e,t,n,r)=>{let i=e||"";if(typeof i=="object"&&(i=i[0]),Es(Xr().flowchart.htmlLabels)){i=i.replace(/\\n|\n/g,"<br />"),Lt.info("vertexText"+i);const s={isNode:r,label:dm(i).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await pee(s)}else{const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof i=="string"?a=i.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(i)?a=i:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),s.appendChild(l)}return s}},"createLabel"),gp=V5e,Ad=ie((e,t,n,r,i)=>["M",e+i,t,"H",e+n-i,"A",i,i,0,0,1,e+n,t+i,"V",t+r-i,"A",i,i,0,0,1,e+n-i,t+r,"H",e+i,"A",i,i,0,0,1,e,t+r-i,"V",t+i,"A",i,i,0,0,1,e+i,t,"Z"].join(" "),"createRoundedRectPathD"),H5e=ie(e=>{const{handDrawnSeed:t}=Xr();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),xy=ie(e=>{const t=W5e([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),W5e=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,i]=n.split(":");t.set(r.trim(),i==null?void 0:i.trim())}),t},"styles2Map"),mee=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),En=ie(e=>{const{stylesArray:t}=xy(e),n=[],r=[],i=[],s=[];return t.forEach(a=>{const o=a[0];mee(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&i.push(a.join(":")+" !important"),o==="fill"&&s.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:i,backgroundStyles:s}},"styles2String"),Sn=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=Xr(),{nodeBorder:i,mainBkg:s}=n,{stylesMap:a}=xy(e);return Object.assign({roughness:.7,fill:a.get("fill")||s,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||i,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),gee=ie(async(e,t)=>{Lt.info("Creating subgraph rect for ",t.id,t);const n=Xr(),{themeVariables:r,handDrawnSeed:i}=n,{clusterBkg:s,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=En(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Es(n.flowchart.htmlLabels),p=d.insert("g").attr("class","cluster-label "),y=await vh(p,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Es(n.flowchart.htmlLabels)){const R=y.children[0],M=Lr(y);b=R.getBoundingClientRect(),M.attr("width",b.width),M.attr("height",b.height)}const x=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height,_=t.x-x/2,S=t.y-w/2;Lt.trace("Data ",t,JSON.stringify(t));let C;if(t.look==="handDrawn"){const R=wn.svg(d),M=Sn(t,{roughness:.7,fill:s,stroke:a,fillWeight:3,seed:i}),N=R.path(Ad(_,S,x,w,0),M);C=d.insert(()=>(Lt.debug("Rough node insert CXC",N),N),":first-child"),C.select("path:nth-child(2)").attr("style",c.join(";")),C.select("path").attr("style",u.join(";").replace("fill","stroke"))}else C=d.insert("rect",":first-child"),C.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",_).attr("y",S).attr("width",x).attr("height",w);const{subGraphTitleTopMargin:E}=UP(n);if(p.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+E})`),o){const R=p.select("span");R&&R.attr("style",o)}const T=C.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return vy(t,R)},{cluster:d,labelBBox:b}},"rect"),G5e=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),i=0*t.padding,s=i/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-s).attr("y",t.y-t.height/2-s).attr("width",t.width+i).attr("height",t.height+i).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return vy(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),K5e=ie(async(e,t)=>{const n=Xr(),{themeVariables:r,handDrawnSeed:i}=n,{altBackground:s,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const p=d.node().appendChild(await gp(t.label,t.labelStyle,void 0,!0));let y=p.getBBox();if(Es(n.flowchart.htmlLabels)){const N=p.children[0],O=Lr(p);y=N.getBoundingClientRect(),O.attr("width",y.width),O.attr("height",y.height)}const b=0*t.padding,x=b/2,w=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(w-t.width)/2-t.padding:t.diff=-t.padding;const _=t.height+b,S=t.height+b-y.height-6,C=t.x-w/2,E=t.y-_/2;t.width=w;const T=t.y-t.height/2-x+y.height+2;let R;if(t.look==="handDrawn"){const N=t.cssClasses.includes("statediagram-cluster-alt"),O=wn.svg(c),B=t.rx||t.ry?O.path(Ad(C,E,w,_,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:i}):O.rectangle(C,E,w,_,{seed:i});R=c.insert(()=>B,":first-child");const P=O.rectangle(C,T,w,S,{fill:N?s:a,fillStyle:N?"hachure":"solid",stroke:l,seed:i});R=c.insert(()=>B,":first-child"),h=c.insert(()=>P)}else R=u.insert("rect",":first-child"),R.attr("class","outer").attr("x",C).attr("y",E).attr("width",w).attr("height",_).attr("data-look",t.look),h.attr("class","inner").attr("x",C).attr("y",T).attr("width",w).attr("height",S);d.attr("transform",`translate(${t.x-y.width/2}, ${E+1-(Es(n.flowchart.htmlLabels)?0:3)})`);const M=R.node().getBBox();return t.height=M.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(N){return vy(t,N)},{cluster:c,labelBBox:y}},"roundedWithTitle"),Y5e=ie(async(e,t)=>{Lt.info("Creating subgraph rect for ",t.id,t);const n=Xr(),{themeVariables:r,handDrawnSeed:i}=n,{clusterBkg:s,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=En(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Es(n.flowchart.htmlLabels),p=d.insert("g").attr("class","cluster-label "),y=await vh(p,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Es(n.flowchart.htmlLabels)){const R=y.children[0],M=Lr(y);b=R.getBoundingClientRect(),M.attr("width",b.width),M.attr("height",b.height)}const x=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height,_=t.x-x/2,S=t.y-w/2;Lt.trace("Data ",t,JSON.stringify(t));let C;if(t.look==="handDrawn"){const R=wn.svg(d),M=Sn(t,{roughness:.7,fill:s,stroke:a,fillWeight:4,seed:i}),N=R.path(Ad(_,S,x,w,t.rx),M);C=d.insert(()=>(Lt.debug("Rough node insert CXC",N),N),":first-child"),C.select("path:nth-child(2)").attr("style",c.join(";")),C.select("path").attr("style",u.join(";").replace("fill","stroke"))}else C=d.insert("rect",":first-child"),C.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",_).attr("y",S).attr("width",x).attr("height",w);const{subGraphTitleTopMargin:E}=UP(n);if(p.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+E})`),o){const R=p.select("span");R&&R.attr("style",o)}const T=C.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(R){return vy(t,R)},{cluster:d,labelBBox:b}},"kanbanSection"),Z5e=ie((e,t)=>{const n=Xr(),{themeVariables:r,handDrawnSeed:i}=n,{nodeBorder:s}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let p;if(t.look==="handDrawn"){const x=wn.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:s,seed:i});p=a.insert(()=>x,":first-child")}else p=o.insert("rect",":first-child"),p.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=p.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return vy(t,b)},{cluster:a,labelBBox:{}}},"divider"),X5e=gee,J5e={rect:gee,squareRect:X5e,roundedWithTitle:K5e,noteGroup:G5e,divider:Z5e,kanbanSection:Y5e},yee=new Map,Q5e=ie(async(e,t)=>{const n=t.shape||"rect",r=await J5e[n](e,t);return yee.set(t.id,r),r},"insertCluster"),zst=ie(()=>{yee=new Map},"clear");function bee(e,t){return e.intersect(t)}ie(bee,"intersectNode");var eFe=bee;function vee(e,t,n,r){var i=e.x,s=e.y,a=i-r.x,o=s-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<i&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<s&&(u=-u),{x:i+c,y:s+u}}ie(vee,"intersectEllipse");var xee=vee;function wee(e,t,n){return xee(e,t,t,n)}ie(wee,"intersectCircle");var tFe=wee;function _ee(e,t,n,r){var i,s,a,o,l,c,u,d,h,p,y,b,x,w,_;if(i=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=i*n.x+a*n.y+l,p=i*r.x+a*r.y+l,!(h!==0&&p!==0&&Vj(h,p))&&(s=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=s*e.x+o*e.y+c,d=s*t.x+o*t.y+c,!(u!==0&&d!==0&&Vj(u,d))&&(y=i*o-s*a,y!==0)))return b=Math.abs(y/2),x=a*c-o*l,w=x<0?(x-b)/y:(x+b)/y,x=s*l-i*c,_=x<0?(x-b)/y:(x+b)/y,{x:w,y:_}}ie(_ee,"intersectLine");function Vj(e,t){return e*t>0}ie(Vj,"sameSign");var nFe=_ee;function See(e,t,n){let r=e.x,i=e.y,s=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=i-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],p=nFe(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});p&&s.push(p)}return s.length?(s.length>1&&s.sort(function(u,d){let h=u.x-n.x,p=u.y-n.y,y=Math.sqrt(h*h+p*p),b=d.x-n.x,x=d.y-n.y,w=Math.sqrt(b*b+x*x);return y<w?-1:y===w?0:1}),s[0]):e}ie(See,"intersectPolygon");var rFe=See,vn={node:eFe,circle:tFe,ellipse:xee,polygon:rFe,rect:vy};function Cee(e,t){const{labelStyles:n}=En(t);t.labelStyle=n;const r=Wn(t);let i=r;r||(i="anchor");const s=e.insert("g").attr("class",i).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=wn.svg(s),c=Sn(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=s.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",$a(o)),kn(t,d),t.intersect=function(h){return Lt.info("Circle intersect",t,a,h),vn.circle(t,a,h)},s}ie(Cee,"anchor");function Hj(e,t,n,r,i,s,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,p=d/i,y=h/s,b=Math.sqrt(p**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const x=Math.sqrt(1-b**2),w=l+x*s*Math.sin(u)*(a?-1:1),_=c-x*i*Math.cos(u)*(a?-1:1),S=Math.atan2((t-_)/s,(e-w)/i);let E=Math.atan2((r-_)/s,(n-w)/i)-S;a&&E<0&&(E+=2*Math.PI),!a&&E>0&&(E-=2*Math.PI);const T=[];for(let R=0;R<20;R++){const M=R/19,N=S+M*E,O=w+i*Math.cos(N),B=_+s*Math.sin(N);T.push({x:O,y:B})}return T}ie(Hj,"generateArcPoints");async function kee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=s.width+t.padding+20,o=s.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...Hj(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...Hj(a/2,o/2,a/2,-o/2,c,l,!0)],h=wn.svg(i),p=Sn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=Ur(d),b=h.path(y,p),x=i.insert(()=>b,":first-child");return x.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),x.attr("transform",`translate(${c/2}, 0)`),kn(t,x),t.intersect=function(w){return vn.polygon(t,d,w)},i}ie(kee,"bowTieRect");function Rd(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(i){return i.x+","+i.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(Rd,"insertPolygonShape");async function Eee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=s.height+t.padding,o=12,l=s.width+t.padding+o,c=0,u=l,d=-a,h=0,p=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const x=wn.svg(i),w=Sn(t,{}),_=Ur(p),S=x.path(_,w);y=i.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=Rd(i,l,a,p);return r&&y.attr("style",r),kn(t,y),t.intersect=function(x){return vn.polygon(t,p,x)},i}ie(Eee,"card");function Tee(e,t){const{nodeStyles:n}=En(t);t.label="";const r=e.insert("g").attr("class",Wn(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,s=Math.max(28,t.width??0),a=[{x:0,y:s/2},{x:s/2,y:0},{x:0,y:-s/2},{x:-s/2,y:0}],o=wn.svg(r),l=Sn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Ur(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return i&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",i),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return vn.polygon(t,a,h)},r}ie(Tee,"choice");async function Aee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,halfPadding:a}=await rr(e,t,Wn(t)),o=s.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=wn.svg(i),d=Sn(t,{}),h=u.circle(0,0,o*2,d);l=i.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",$a(c))}else l=i.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return kn(t,l),t.intersect=function(u){return Lt.info("Circle intersect",t,o,u),vn.circle(t,o,u)},i}ie(Aee,"circle");function Ree(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,i={x:r/2*t,y:r/2*n},s={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${s.x},${s.y} L ${o.x},${o.y}
                   M ${i.x},${i.y} L ${a.x},${a.y}`}ie(Ree,"createLine");function Iee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n,t.label="";const i=e.insert("g").attr("class",Wn(t)).attr("id",t.domId??t.id),s=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=wn.svg(i),l=Sn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,s*2,l),u=Ree(s),d=o.path(u,l),h=i.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),kn(t,h),t.intersect=function(p){return Lt.info("crossedCircle intersect",t,{radius:s,point:p}),vn.circle(t,s,p)},i}ie(Iee,"crossedCircle");function Wu(e,t,n,r=100,i=0,s=180){const a=[],o=i*Math.PI/180,u=(s*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-p,y:-y})}return a}ie(Wu,"generateCirclePoints");async function Mee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=s.width+(t.padding??0),l=s.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Wu(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...Wu(o/2+c*2,-c,c,20,-180,-270),...Wu(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...Wu(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...Wu(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...Wu(o/2+o*.1,-c,c,20,-180,-270),...Wu(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...Wu(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],p=wn.svg(i),y=Sn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Ur(d).replace("Z",""),w=p.path(x,y),_=Ur(h),S=p.path(_,{...y}),C=i.insert("g",":first-child");return C.insert(()=>S,":first-child").attr("stroke-opacity",0),C.insert(()=>w,":first-child"),C.attr("class","text"),u&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(s.x-(s.left??0))},${-l/2+(t.padding??0)/2-(s.y-(s.top??0))})`),kn(t,C),t.intersect=function(E){return vn.polygon(t,h,E)},i}ie(Mee,"curlyBraceLeft");function Gu(e,t,n,r=100,i=0,s=180){const a=[],o=i*Math.PI/180,u=(s*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:p,y})}return a}ie(Gu,"generateCirclePoints");async function Nee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=s.width+(t.padding??0),l=s.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Gu(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...Gu(o/2+c*2,-c,c,20,-180,-270),...Gu(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...Gu(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},...Gu(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...Gu(o/2+c*2,-c,c,20,-180,-270),...Gu(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...Gu(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],p=wn.svg(i),y=Sn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Ur(d).replace("Z",""),w=p.path(x,y),_=Ur(h),S=p.path(_,{...y}),C=i.insert("g",":first-child");return C.insert(()=>S,":first-child").attr("stroke-opacity",0),C.insert(()=>w,":first-child"),C.attr("class","text"),u&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(s.x-(s.left??0))},${-l/2+(t.padding??0)/2-(s.y-(s.top??0))})`),kn(t,C),t.intersect=function(E){return vn.polygon(t,h,E)},i}ie(Nee,"curlyBraceRight");function Js(e,t,n,r=100,i=0,s=180){const a=[],o=i*Math.PI/180,u=(s*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,p=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-p,y:-y})}return a}ie(Js,"generateCirclePoints");async function jee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=s.width+(t.padding??0),l=s.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Js(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...Js(o/2+c*2,-c,c,20,-180,-270),...Js(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...Js(o/2,l/2,c,20,0,90)],h=[...Js(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...Js(-o/2-c/2,-c,c,20,0,90),...Js(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...Js(-o/2+c+c/2,l/2,c,30,-180,-270)],p=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...Js(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...Js(o/2+c*2,-c,c,20,-180,-270),...Js(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...Js(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...Js(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...Js(-o/2-c/2,-c,c,20,0,90),...Js(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...Js(-o/2+c+c/2,l/2,c,30,-180,-270)],y=wn.svg(i),b=Sn(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const w=Ur(d).replace("Z",""),_=y.path(w,b),C=Ur(h).replace("Z",""),E=y.path(C,b),T=Ur(p),R=y.path(T,{...b}),M=i.insert("g",":first-child");return M.insert(()=>R,":first-child").attr("stroke-opacity",0),M.insert(()=>_,":first-child"),M.insert(()=>E,":first-child"),M.attr("class","text"),u&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",r),M.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(s.x-(s.left??0))},${-l/2+(t.padding??0)/2-(s.y-(s.top??0))})`),kn(t,M),t.intersect=function(N){return vn.polygon(t,p,N)},i}ie(jee,"curlyBraces");async function Oee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=80,o=20,l=Math.max(a,(s.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=wn.svg(i),p=Sn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=l,b=c,x=y-u,w=b/4,_=[{x,y:0},{x:w,y:0},{x:0,y:b/2},{x:w,y:b},{x,y:b},...SD(-x,-b/2,u,50,270,90)],S=Ur(_),C=h.path(S,p),E=i.insert(()=>C,":first-child");return E.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&E.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&E.selectChildren("path").attr("style",r),E.attr("transform",`translate(${-l/2}, ${-c/2})`),kn(t,E),t.intersect=function(T){return vn.polygon(t,_,T)},i}ie(Oee,"curvedTrapezoid");var iFe=ie((e,t,n,r,i,s)=>[`M${e},${t+s}`,`a${i},${s} 0,0,0 ${n},0`,`a${i},${s} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${s} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),sFe=ie((e,t,n,r,i,s)=>[`M${e},${t+s}`,`M${e+n},${t+s}`,`a${i},${s} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${s} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),aFe=ie((e,t,n,r,i,s)=>[`M${e-n/2},${-r/2}`,`a${i},${s} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function Pee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(s.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const p=wn.svg(i),y=sFe(0,0,o,u,l,c),b=aFe(0,c,o,u,l,c),x=p.path(y,Sn(t,{})),w=p.path(b,Sn(t,{fill:"none"}));d=i.insert(()=>w,":first-child"),d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const p=iFe(0,0,o,u,l,c);d=i.insert("path",":first-child").attr("d",p).attr("class","basic label-container").attr("style",$a(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),kn(t,d),a.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+(t.padding??0)/1.5-(s.y-(s.top??0))})`),t.intersect=function(p){const y=vn.rect(t,p),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-b*b/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,p.y-(t.y??0)>0&&(x=-x),y.y+=x}return y},i}ie(Pee,"cylinder");async function Dee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=s.width+t.padding,l=s.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,p=wn.svg(i),y=Sn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],x=p.polygon(b.map(_=>[_.x,_.y]),y),w=i.insert(()=>x,":first-child");return w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(s.x-(s.left??0))}, ${d+c+(t.padding??0)/2-(s.y-(s.top??0))})`),kn(t,w),t.intersect=function(_){return vn.rect(t,_)},i}ie(Dee,"dividedRectangle");async function Fee(e,t){var h,p;const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,halfPadding:a}=await rr(e,t,Wn(t)),l=s.width/2+a+5,c=s.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=wn.svg(i),b=Sn(t,{roughness:.2,strokeWidth:2.5}),x=Sn(t,{roughness:.2,strokeWidth:1.5}),w=y.circle(0,0,l*2,b),_=y.circle(0,0,c*2,x);u=i.insert("g",":first-child"),u.attr("class",$a(t.cssClasses)).attr("style",$a(d)),(h=u.node())==null||h.appendChild(w),(p=u.node())==null||p.appendChild(_)}else{u=i.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return kn(t,u),t.intersect=function(y){return Lt.info("DoubleCircle intersect",t,l,y),vn.circle(t,l,y)},i}ie(Fee,"doublecircle");function Lee(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:i}=En(t);t.label="",t.labelStyle=r;const s=e.insert("g").attr("class",Wn(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=wn.svg(s),{nodeBorder:c}=n,u=Sn(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=s.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",i),kn(t,h),t.intersect=function(p){return Lt.info("filledCircle intersect",t,{radius:a,point:p}),vn.circle(t,a,p)},s}ie(Lee,"filledCircle");async function Bee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=s.width+(t.padding??0),l=o+s.height,c=o+s.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=wn.svg(i),p=Sn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=Ur(u),b=h.path(y,p),x=i.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=o,t.height=l,kn(t,x),a.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${-l/2+(t.padding??0)/2+(s.y-(s.top??0))})`),t.intersect=function(w){return Lt.info("Triangle intersect",t,u,w),vn.polygon(t,u,w)},i}ie(Bee,"flippedTriangle");function $ee(e,t,{dir:n,config:{state:r,themeVariables:i}}){const{nodeStyles:s}=En(t);t.label="";const a=e.insert("g").attr("class",Wn(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=wn.svg(a),p=Sn(t,{stroke:i.lineColor,fill:i.lineColor});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=h.rectangle(u,d,l,c,p),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),kn(t,b);const x=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=x/2||0,t.height+=x/2||0),t.intersect=function(w){return vn.rect(t,w)},a}ie($ee,"forkJoin");async function zee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const i=80,s=50,{shapeSvg:a,bbox:o}=await rr(e,t,Wn(t)),l=Math.max(i,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(s,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=wn.svg(a),p=Sn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...SD(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Ur(y),x=h.path(b,p),w=a.insert(()=>x,":first-child");return w.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",r),kn(t,w),t.intersect=function(_){return Lt.info("Pill intersect",t,{radius:u,point:_}),vn.polygon(t,y,_)},a}ie(zee,"halfRoundedRectangle");var oFe=ie((e,t,n,r,i)=>[`M${e+i},${t}`,`L${e+n-i},${t}`,`L${e+n},${t-r/2}`,`L${e+n-i},${t-r}`,`L${e+i},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function Uee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=4,o=s.height+t.padding,l=o/a,c=s.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const p=wn.svg(i),y=Sn(t,{}),b=oFe(0,0,c,o,l),x=p.path(b,y);d=i.insert(()=>x,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=Rd(i,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,kn(t,d),t.intersect=function(p){return vn.polygon(t,u,p)},i}ie(Uee,"hexagon");async function qee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.label="",t.labelStyle=n;const{shapeSvg:i}=await rr(e,t,Wn(t)),s=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=wn.svg(i),c=Sn(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:s,y:0},{x:0,y:a},{x:s,y:a}],d=Ur(u),h=l.path(d,c),p=i.insert(()=>h,":first-child");return p.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&p.selectChildren("path").attr("style",r),p.attr("transform",`translate(${-s/2}, ${-a/2})`),kn(t,p),t.intersect=function(y){return Lt.info("Pill intersect",t,{points:u}),vn.polygon(t,u,y)},i}ie(qee,"hourglass");async function Vee(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:i}=En(t);t.labelStyle=i;const s=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(s,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await rr(e,t,"icon-shape default"),h=t.pos==="t",p=o,y=o,{nodeBorder:b}=n,{stylesMap:x}=xy(t),w=-y/2,_=-p/2,S=t.label?8:0,C=wn.svg(c),E=Sn(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(E.roughness=0,E.fillStyle="solid");const T=C.rectangle(w,_,y,p,E),R=Math.max(y,u.width),M=p+u.height+S,N=C.rectangle(-R/2,-M/2,R,M,{...E,fill:"transparent",stroke:"none"}),O=c.insert(()=>T,":first-child"),B=c.insert(()=>N);if(t.icon){const P=c.append("g");P.html(`<g>${await qE(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const H=P.node().getBBox(),F=H.width,Q=H.height,q=H.x,K=H.y;P.attr("transform",`translate(${-F/2-q},${h?u.height/2+S/2-Q/2-K:-u.height/2-S/2-Q/2-K})`),P.attr("style",`color: ${x.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-M/2:M/2-u.height})`),O.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),kn(t,B),t.intersect=function(P){if(Lt.info("iconSquare intersect",t,P),!t.label)return vn.rect(t,P);const H=t.x??0,F=t.y??0,Q=t.height??0;let q=[];return h?q=[{x:H-u.width/2,y:F-Q/2},{x:H+u.width/2,y:F-Q/2},{x:H+u.width/2,y:F-Q/2+u.height+S},{x:H+y/2,y:F-Q/2+u.height+S},{x:H+y/2,y:F+Q/2},{x:H-y/2,y:F+Q/2},{x:H-y/2,y:F-Q/2+u.height+S},{x:H-u.width/2,y:F-Q/2+u.height+S}]:q=[{x:H-y/2,y:F-Q/2},{x:H+y/2,y:F-Q/2},{x:H+y/2,y:F-Q/2+p},{x:H+u.width/2,y:F-Q/2+p},{x:H+u.width/2/2,y:F+Q/2},{x:H-u.width/2,y:F+Q/2},{x:H-u.width/2,y:F-Q/2+p},{x:H-y/2,y:F-Q/2+p}],vn.polygon(t,q,P)},c}ie(Vee,"icon");async function Hee(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:i}=En(t);t.labelStyle=i;const s=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(s,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await rr(e,t,"icon-shape default"),h=20,p=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:x}=n,{stylesMap:w}=xy(t),_=wn.svg(c),S=Sn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=w.get("fill");S.stroke=C??x;const E=c.append("g");t.icon&&E.html(`<g>${await qE(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const T=E.node().getBBox(),R=T.width,M=T.height,N=T.x,O=T.y,B=Math.max(R,M)*Math.SQRT2+h*2,P=_.circle(0,0,B,S),H=Math.max(B,u.width),F=B+u.height+p,Q=_.rectangle(-H/2,-F/2,H,F,{...S,fill:"transparent",stroke:"none"}),q=c.insert(()=>P,":first-child"),K=c.insert(()=>Q);return E.attr("transform",`translate(${-R/2-N},${y?u.height/2+p/2-M/2-O:-u.height/2-p/2-M/2-O})`),E.attr("style",`color: ${w.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-F/2:F/2-u.height})`),q.attr("transform",`translate(0,${y?u.height/2+p/2:-u.height/2-p/2})`),kn(t,K),t.intersect=function(U){return Lt.info("iconSquare intersect",t,U),vn.rect(t,U)},c}ie(Hee,"iconCircle");async function Wee(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:i}=En(t);t.labelStyle=i;const s=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(s,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await rr(e,t,"icon-shape default"),p=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:x,mainBkg:w}=n,{stylesMap:_}=xy(t),S=-b/2,C=-y/2,E=t.label?8:0,T=wn.svg(c),R=Sn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const M=_.get("fill");R.stroke=M??w;const N=T.path(Ad(S,C,b,y,5),R),O=Math.max(b,u.width),B=y+u.height+E,P=T.rectangle(-O/2,-B/2,O,B,{...R,fill:"transparent",stroke:"none"}),H=c.insert(()=>N,":first-child").attr("class","icon-shape2"),F=c.insert(()=>P);if(t.icon){const Q=c.append("g");Q.html(`<g>${await qE(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const q=Q.node().getBBox(),K=q.width,U=q.height,re=q.x,G=q.y;Q.attr("transform",`translate(${-K/2-re},${p?u.height/2+E/2-U/2-G:-u.height/2-E/2-U/2-G})`),Q.attr("style",`color: ${_.get("stroke")??x};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${p?-B/2:B/2-u.height})`),H.attr("transform",`translate(0,${p?u.height/2+E/2:-u.height/2-E/2})`),kn(t,F),t.intersect=function(Q){if(Lt.info("iconSquare intersect",t,Q),!t.label)return vn.rect(t,Q);const q=t.x??0,K=t.y??0,U=t.height??0;let re=[];return p?re=[{x:q-u.width/2,y:K-U/2},{x:q+u.width/2,y:K-U/2},{x:q+u.width/2,y:K-U/2+u.height+E},{x:q+b/2,y:K-U/2+u.height+E},{x:q+b/2,y:K+U/2},{x:q-b/2,y:K+U/2},{x:q-b/2,y:K-U/2+u.height+E},{x:q-u.width/2,y:K-U/2+u.height+E}]:re=[{x:q-b/2,y:K-U/2},{x:q+b/2,y:K-U/2},{x:q+b/2,y:K-U/2+y},{x:q+u.width/2,y:K-U/2+y},{x:q+u.width/2/2,y:K+U/2},{x:q-u.width/2,y:K+U/2},{x:q-u.width/2,y:K-U/2+y},{x:q-b/2,y:K-U/2+y}],vn.polygon(t,re,Q)},c}ie(Wee,"iconRounded");async function Gee(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:i}=En(t);t.labelStyle=i;const s=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(s,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await rr(e,t,"icon-shape default"),p=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:x,mainBkg:w}=n,{stylesMap:_}=xy(t),S=-b/2,C=-y/2,E=t.label?8:0,T=wn.svg(c),R=Sn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const M=_.get("fill");R.stroke=M??w;const N=T.path(Ad(S,C,b,y,.1),R),O=Math.max(b,u.width),B=y+u.height+E,P=T.rectangle(-O/2,-B/2,O,B,{...R,fill:"transparent",stroke:"none"}),H=c.insert(()=>N,":first-child"),F=c.insert(()=>P);if(t.icon){const Q=c.append("g");Q.html(`<g>${await qE(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const q=Q.node().getBBox(),K=q.width,U=q.height,re=q.x,G=q.y;Q.attr("transform",`translate(${-K/2-re},${p?u.height/2+E/2-U/2-G:-u.height/2-E/2-U/2-G})`),Q.attr("style",`color: ${_.get("stroke")??x};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${p?-B/2:B/2-u.height})`),H.attr("transform",`translate(0,${p?u.height/2+E/2:-u.height/2-E/2})`),kn(t,F),t.intersect=function(Q){if(Lt.info("iconSquare intersect",t,Q),!t.label)return vn.rect(t,Q);const q=t.x??0,K=t.y??0,U=t.height??0;let re=[];return p?re=[{x:q-u.width/2,y:K-U/2},{x:q+u.width/2,y:K-U/2},{x:q+u.width/2,y:K-U/2+u.height+E},{x:q+b/2,y:K-U/2+u.height+E},{x:q+b/2,y:K+U/2},{x:q-b/2,y:K+U/2},{x:q-b/2,y:K-U/2+u.height+E},{x:q-u.width/2,y:K-U/2+u.height+E}]:re=[{x:q-b/2,y:K-U/2},{x:q+b/2,y:K-U/2},{x:q+b/2,y:K-U/2+y},{x:q+u.width/2,y:K-U/2+y},{x:q+u.width/2/2,y:K+U/2},{x:q-u.width/2,y:K+U/2},{x:q-u.width/2,y:K-U/2+y},{x:q-b/2,y:K-U/2+y}],vn.polygon(t,re,Q)},c}ie(Gee,"iconSquare");async function Kee(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const i=Number(r.naturalWidth.toString().replace("px","")),s=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=i/s;const{labelStyles:a}=En(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??i),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??s;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:p}=await rr(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,x=-u/2,w=t.label?8:0,_=wn.svg(d),S=Sn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=_.rectangle(b,x,c,u,S),E=Math.max(c,h.width),T=u+h.height+w,R=_.rectangle(-E/2,-T/2,E,T,{...S,fill:"none",stroke:"none"}),M=d.insert(()=>C,":first-child"),N=d.insert(()=>R);if(t.img){const O=d.append("image");O.attr("href",t.img),O.attr("width",c),O.attr("height",u),O.attr("preserveAspectRatio","none"),O.attr("transform",`translate(${-c/2},${y?T/2-u:-T/2})`)}return p.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-w/2:u/2-h.height/2+w/2})`),M.attr("transform",`translate(0,${y?h.height/2+w/2:-h.height/2-w/2})`),kn(t,N),t.intersect=function(O){if(Lt.info("iconSquare intersect",t,O),!t.label)return vn.rect(t,O);const B=t.x??0,P=t.y??0,H=t.height??0;let F=[];return y?F=[{x:B-h.width/2,y:P-H/2},{x:B+h.width/2,y:P-H/2},{x:B+h.width/2,y:P-H/2+h.height+w},{x:B+c/2,y:P-H/2+h.height+w},{x:B+c/2,y:P+H/2},{x:B-c/2,y:P+H/2},{x:B-c/2,y:P-H/2+h.height+w},{x:B-h.width/2,y:P-H/2+h.height+w}]:F=[{x:B-c/2,y:P-H/2},{x:B+c/2,y:P-H/2},{x:B+c/2,y:P-H/2+u},{x:B+h.width/2,y:P-H/2+u},{x:B+h.width/2/2,y:P+H/2},{x:B-h.width/2,y:P+H/2},{x:B-h.width/2,y:P-H/2+u},{x:B-c/2,y:P-H/2+u}],vn.polygon(t,F,O)},d}ie(Kee,"imageSquare");async function Yee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=wn.svg(i),h=Sn(t,{}),p=Ur(l),y=d.path(p,h);c=i.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Rd(i,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,kn(t,c),t.intersect=function(d){return vn.polygon(t,l,d)},i}ie(Yee,"inv_trapezoid");async function b1(e,t,n){const{labelStyles:r,nodeStyles:i}=En(t);t.labelStyle=r;const{shapeSvg:s,bbox:a}=await rr(e,t,Wn(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:p}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,p=n.ry),t.look==="handDrawn"){const b=wn.svg(s),x=Sn(t,{}),w=h||p?b.path(Ad(c,u,o,l,h||0),x):b.rectangle(c,u,o,l,x);d=s.insert(()=>w,":first-child"),d.attr("class","basic label-container").attr("style",$a(y))}else d=s.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",i).attr("rx",$a(h)).attr("ry",$a(p)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return kn(t,d),t.intersect=function(b){return vn.rect(t,b)},s}ie(b1,"drawRect");async function Zee(e,t){const{shapeSvg:n,bbox:r,label:i}=await rr(e,t,"label"),s=n.insert("rect",":first-child");return s.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),i.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),kn(t,s),t.intersect=function(l){return vn.rect(t,l)},n}ie(Zee,"labelRect");async function Xee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=Math.max(s.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(s.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=wn.svg(i),h=Sn(t,{}),p=Ur(l),y=d.path(p,h);c=i.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Rd(i,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,kn(t,c),t.intersect=function(d){return vn.polygon(t,l,d)},i}ie(Xee,"lean_left");async function Jee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=Math.max(s.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(s.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=wn.svg(i),h=Sn(t,{}),p=Ur(l),y=d.path(p,h);c=i.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Rd(i,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,kn(t,c),t.intersect=function(d){return vn.polygon(t,l,d)},i}ie(Jee,"lean_right");function Qee(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.label="",t.labelStyle=n;const i=e.insert("g").attr("class",Wn(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=wn.svg(i),d=Sn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Ur(c),p=u.path(h,d),y=i.insert(()=>p,":first-child");return s&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",s),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),kn(t,y),t.intersect=function(b){return Lt.info("lightningBolt intersect",t,b),vn.polygon(t,c,b)},i}ie(Qee,"lightningBolt");var lFe=ie((e,t,n,r,i,s,a)=>[`M${e},${t+s}`,`a${i},${s} 0,0,0 ${n},0`,`a${i},${s} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${s} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+s+a}`,`a${i},${s} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),cFe=ie((e,t,n,r,i,s,a)=>[`M${e},${t+s}`,`M${e+n},${t+s}`,`a${i},${s} 0,0,0 ${-n},0`,`l0,${r}`,`a${i},${s} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+s+a}`,`a${i},${s} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),uFe=ie((e,t,n,r,i,s)=>[`M${e-n/2},${-r/2}`,`a${i},${s} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function ete(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(s.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:p}=t;if(t.look==="handDrawn"){const y=wn.svg(i),b=cFe(0,0,o,u,l,c,d),x=uFe(0,c,o,u,l,c),w=Sn(t,{}),_=y.path(b,w),S=y.path(x,w);i.insert(()=>S,":first-child").attr("class","line"),h=i.insert(()=>_,":first-child"),h.attr("class","basic label-container"),p&&h.attr("style",p)}else{const y=lFe(0,0,o,u,l,c,d);h=i.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",$a(p)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),kn(t,h),a.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+c-(s.y-(s.top??0))})`),t.intersect=function(y){const b=vn.rect(t,y),x=b.x-(t.x??0);if(l!=0&&(Math.abs(x)<(t.width??0)/2||Math.abs(x)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let w=c*c*(1-x*x/(l*l));w>0&&(w=Math.sqrt(w)),w=c-w,y.y-(t.y??0)>0&&(w=-w),b.y+=w}return b},i}ie(ete,"linedCylinder");async function tte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=wn.svg(i),p=Sn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...Qf(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(w=>[w.x,w.y]),p),x=i.insert(()=>b,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),x.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(s.x-(s.left??0))},${-l/2+(t.padding??0)-c/2-(s.y-(s.top??0))})`),kn(t,x),t.intersect=function(w){return vn.polygon(t,y,w)},i}ie(tte,"linedWaveEdgedRect");async function nte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,p=wn.svg(i),y=Sn(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],x=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const w=Ur(b),_=p.path(w,y),S=Ur(x),C=p.path(S,{...y,fill:"none"}),E=i.insert(()=>C,":first-child");return E.insert(()=>_,":first-child"),E.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(s.width/2)-c-(s.x-(s.left??0))}, ${-(s.height/2)+c-(s.y-(s.top??0))})`),kn(t,E),t.intersect=function(T){return vn.polygon(t,b,T)},i}ie(nte,"multiRect");async function rte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,p=5,{cssStyles:y}=t,b=Qf(d-p,h+u+p,d+o-p,h+u+p,c,.8),x=b==null?void 0:b[b.length-1],w=[{x:d-p,y:h+p},{x:d-p,y:h+u+p},...b,{x:d+o-p,y:x.y-p},{x:d+o,y:x.y-p},{x:d+o,y:x.y-2*p},{x:d+o+p,y:x.y-2*p},{x:d+o+p,y:h-p},{x:d+p,y:h-p},{x:d+p,y:h},{x:d,y:h},{x:d,y:h+p}],_=[{x:d,y:h+p},{x:d+o-p,y:h+p},{x:d+o-p,y:x.y-p},{x:d+o,y:x.y-p},{x:d+o,y:h},{x:d,y:h}],S=wn.svg(i),C=Sn(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const E=Ur(w),T=S.path(E,C),R=Ur(_),M=S.path(R,C),N=i.insert(()=>T,":first-child");return N.insert(()=>M),N.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(s.width/2)-p-(s.x-(s.left??0))}, ${-(s.height/2)+p-c/2-(s.y-(s.top??0))})`),kn(t,N),t.intersect=function(O){return vn.polygon(t,w,O)},i}ie(rte,"multiWaveEdgedRectangle");async function ite(e,t,{config:{themeVariables:n}}){var w;const{labelStyles:r,nodeStyles:i}=En(t);t.labelStyle=r,t.useHtmlLabels||((w=ho().flowchart)==null?void 0:w.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await rr(e,t,Wn(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,p=wn.svg(a),y=Sn(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=p.rectangle(u,d,l,c,y),x=a.insert(()=>b,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),i&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",i),kn(t,x),t.intersect=function(_){return vn.rect(t,_)},a}ie(ite,"note");var dFe=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function ste(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=s.width+t.padding,o=s.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=wn.svg(i),p=Sn(t,{}),y=dFe(0,0,l),b=h.path(y,p);u=i.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=Rd(i,l,l,c);return r&&u.attr("style",r),kn(t,u),t.intersect=function(h){return Lt.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,vn.polygon(t,c,h)),vn.polygon(t,c,h)},i}ie(ste,"question");async function ate(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:p}=t,y=wn.svg(i),b=Sn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Ur(h),w=y.path(x,b),_=i.insert(()=>w,":first-child");return _.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",r),_.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-s.width/2-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),kn(t,_),t.intersect=function(S){return vn.polygon(t,h,S)},i}ie(ate,"rect_left_inv_arrow");async function ote(e,t){var M,N;const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;let i;t.cssClasses?i="node "+t.cssClasses:i="node default";const s=e.insert("g").attr("class",i).attr("id",t.domId||t.id),a=s.insert("g"),o=s.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await gp(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Es((N=(M=Xr())==null?void 0:M.flowchart)==null?void 0:N.htmlLabels)){const O=u.children[0],B=Lr(u);d=O.getBoundingClientRect(),B.attr("width",d.width),B.attr("height",d.height)}Lt.info("Text 2",l);const h=l||[],p=u.getBBox(),y=o.node().appendChild(await gp(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],x=Lr(y);d=b.getBoundingClientRect(),x.attr("width",d.width),x.attr("height",d.height);const w=(t.padding||0)/2;Lr(y).attr("transform","translate( "+(d.width>p.width?0:(p.width-d.width)/2)+", "+(p.height+w+5)+")"),Lr(u).attr("transform","translate( "+(d.width<p.width?0:-(p.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-w+3)+")");const _=d.width+(t.padding||0),S=d.height+(t.padding||0),C=-d.width/2-w,E=-d.height/2-w;let T,R;if(t.look==="handDrawn"){const O=wn.svg(s),B=Sn(t,{}),P=O.path(Ad(C,E,_,S,t.rx||0),B),H=O.line(-d.width/2-w,-d.height/2-w+p.height+w,d.width/2+w,-d.height/2-w+p.height+w,B);R=s.insert(()=>(Lt.debug("Rough node insert CXC",P),H),":first-child"),T=s.insert(()=>(Lt.debug("Rough node insert CXC",P),P),":first-child")}else T=a.insert("rect",":first-child"),R=a.insert("line"),T.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-w).attr("y",-d.height/2-w).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),R.attr("class","divider").attr("x1",-d.width/2-w).attr("x2",d.width/2+w).attr("y1",-d.height/2-w+p.height+w).attr("y2",-d.height/2-w+p.height+w);return kn(t,T),t.intersect=function(O){return vn.rect(t,O)},s}ie(ote,"rectWithTitle");async function lte(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return b1(e,t,n)}ie(lte,"roundedRect");async function cte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-s.width/2-o,d=-s.height/2-o,{cssStyles:h}=t,p=wn.svg(i),y=Sn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],x=p.polygon(b.map(_=>[_.x,_.y]),y),w=i.insert(()=>x,":first-child");return w.attr("class","basic label-container").attr("style",$a(h)),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(s.x-(s.left??0))},${-c/2+(t.padding??0)-(s.y-(s.top??0))})`),kn(t,w),t.intersect=function(_){return vn.rect(t,_)},i}ie(cte,"shadedProcess");async function ute(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=wn.svg(i),p=Sn(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Ur(y),x=h.path(b,p),w=i.insert(()=>x,":first-child");return w.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",r),w.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(s.x-(s.left??0))}, ${-l/4+(t.padding??0)-(s.y-(s.top??0))})`),kn(t,w),t.intersect=function(_){return vn.polygon(t,y,_)},i}ie(ute,"slopedRect");async function dte(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return b1(e,t,n)}ie(dte,"squareRect");async function fte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=s.height+t.padding,o=s.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=wn.svg(i),d=Sn(t,{}),h=Ad(-o/2,-a/2,o,a,a/2),p=u.path(h,d);l=i.insert(()=>p,":first-child"),l.attr("class","basic label-container").attr("style",$a(c))}else l=i.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return kn(t,l),t.intersect=function(u){return vn.rect(t,u)},i}ie(fte,"stadium");async function hte(e,t){return b1(e,t,{rx:5,ry:5})}ie(hte,"state");function pte(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:i}=En(t);t.labelStyle=r;const{cssStyles:s}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=wn.svg(c),d=Sn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),p=o??l,y=u.circle(0,0,5,{...d,fill:p,stroke:p,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),s&&b.selectAll("path").attr("style",s),i&&b.selectAll("path").attr("style",i),kn(t,b),t.intersect=function(x){return vn.circle(t,7,x)},c}ie(pte,"stateEnd");function mte(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,i=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let s;if(t.look==="handDrawn"){const o=wn.svg(i).circle(0,0,14,H5e(r));s=i.insert(()=>o),s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else s=i.insert("circle",":first-child"),s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return kn(t,s),t.intersect=function(a){return vn.circle(t,7,a)},i}ie(mte,"stateStart");async function gte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=((t==null?void 0:t.padding)||0)/2,o=s.width+t.padding,l=s.height+t.padding,c=-s.width/2-a,u=-s.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=wn.svg(i),p=Sn(t,{}),y=h.rectangle(c-8,u,o+16,l,p),b=h.line(c,u,c,u+l,p),x=h.line(c+o,u,c+o,u+l,p);i.insert(()=>b,":first-child"),i.insert(()=>x,":first-child");const w=i.insert(()=>y,":first-child"),{cssStyles:_}=t;w.attr("class","basic label-container").attr("style",$a(_)),kn(t,w)}else{const h=Rd(i,o,l,d);r&&h.attr("style",r),kn(t,h)}return t.intersect=function(h){return vn.polygon(t,d,h)},i}ie(gte,"subroutine");async function yte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,p=wn.svg(i),y=Sn(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],x=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const w=Ur(b),_=p.path(w,y),S=Ur(x),C=p.path(S,{...y,fillStyle:"solid"}),E=i.insert(()=>C,":first-child");return E.insert(()=>_,":first-child"),E.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",r),kn(t,E),t.intersect=function(T){return vn.polygon(t,b,T)},i}ie(yte,"taggedRect");async function bte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:p}=t,y=wn.svg(i),b=Sn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=[{x:-o/2-o/2*.1,y:h/2},...Qf(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],w=-o/2+o/2*.1,_=-h/2-d*.4,S=[{x:w+o-u,y:(_+l)*1.4},{x:w+o,y:_+l-d},{x:w+o,y:(_+l)*.9},...Qf(w+o,(_+l)*1.3,w+o-u,(_+l)*1.5,-l*.03,.5)],C=Ur(x),E=y.path(C,b),T=Ur(S),R=y.path(T,{...b,fillStyle:"solid"}),M=i.insert(()=>R,":first-child");return M.insert(()=>E,":first-child"),M.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",r),M.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(s.x-(s.left??0))},${-l/2+(t.padding??0)-c/2-(s.y-(s.top??0))})`),kn(t,M),t.intersect=function(N){return vn.polygon(t,x,N)},i}ie(bte,"taggedWaveEdgedRectangle");async function vte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=Math.max(s.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(s.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=i.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),kn(t,u),t.intersect=function(d){return vn.rect(t,d)},i}ie(vte,"text");var fFe=ie((e,t,n,r,i,s)=>`M${e},${t}
    a${i},${s} 0,0,1 0,${-r}
    l${n},0
    a${i},${s} 0,0,1 0,${r}
    M${n},${-r}
    a${i},${s} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),hFe=ie((e,t,n,r,i,s)=>[`M${e},${t}`,`M${e+n},${t}`,`a${i},${s} 0,0,0 0,${-r}`,`l${-n},0`,`a${i},${s} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),pFe=ie((e,t,n,r,i,s)=>[`M${e+n/2},${-r/2}`,`a${i},${s} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function xte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a,halfPadding:o}=await rr(e,t,Wn(t)),l=t.look==="neo"?o*2:o,c=s.height+l,u=c/2,d=u/(2.5+c/50),h=s.width+d+l,{cssStyles:p}=t;let y;if(t.look==="handDrawn"){const b=wn.svg(i),x=hFe(0,0,h,c,d,u),w=pFe(0,0,h,c,d,u),_=b.path(x,Sn(t,{})),S=b.path(w,Sn(t,{fill:"none"}));y=i.insert(()=>S,":first-child"),y=i.insert(()=>_,":first-child"),y.attr("class","basic label-container"),p&&y.attr("style",p)}else{const b=fFe(0,0,h,c,d,u);y=i.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",$a(p)).attr("style",r),y.attr("class","basic label-container"),p&&y.selectAll("path").attr("style",p),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(s.width/2)-d-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),kn(t,y),t.intersect=function(b){const x=vn.rect(t,b),w=x.y-(t.y??0);if(u!=0&&(Math.abs(w)<(t.height??0)/2||Math.abs(w)==(t.height??0)/2&&Math.abs(x.x-(t.x??0))>(t.width??0)/2-d)){let _=d*d*(1-w*w/(u*u));_!=0&&(_=Math.sqrt(Math.abs(_))),_=d-_,b.x-(t.x??0)>0&&(_=-_),x.x+=_}return x},i}ie(xte,"tiltedCylinder");async function wte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=s.width+t.padding,o=s.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=wn.svg(i),h=Sn(t,{}),p=Ur(l),y=d.path(p,h);c=i.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=Rd(i,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,kn(t,c),t.intersect=function(d){return vn.polygon(t,l,d)},i}ie(wte,"trapezoid");async function _te(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=60,o=20,l=Math.max(a,s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=wn.svg(i),h=Sn(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const p=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Ur(p),b=d.path(y,h),x=i.insert(()=>b,":first-child");return x.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),kn(t,x),t.intersect=function(w){return vn.polygon(t,p,w)},i}ie(_te,"trapezoidalPentagon");async function Ste(e,t){var _;const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Es((_=Xr().flowchart)==null?void 0:_.htmlLabels),l=s.width+(t.padding??0),c=l+s.height,u=l+s.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,p=wn.svg(i),y=Sn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Ur(d),x=p.path(b,y),w=i.insert(()=>x,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectChildren("path").attr("style",r),t.width=l,t.height=c,kn(t,w),a.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${c/2-(s.height+(t.padding??0)/(o?2:1)-(s.y-(s.top??0)))})`),t.intersect=function(S){return Lt.info("Triangle intersect",t,d,S),vn.polygon(t,d,S)},i}ie(Ste,"triangle");async function Cte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,p=70-o,y=p>0?p/2:0,b=wn.svg(i),x=Sn(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-o/2-y,y:u/2},...Qf(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],_=Ur(w),S=b.path(_,x),C=i.insert(()=>S,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),C.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(s.x-(s.left??0))},${-l/2+(t.padding??0)-c-(s.y-(s.top??0))})`),kn(t,C),t.intersect=function(E){return vn.polygon(t,w,E)},i}ie(Cte,"waveEdgedRectangle");async function kte(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s}=await rr(e,t,Wn(t)),a=100,o=50,l=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const p=Math.min(h*.2,h/4),y=h+p*2,{cssStyles:b}=t,x=wn.svg(i),w=Sn(t,{});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");const _=[{x:-d/2,y:y/2},...Qf(-d/2,y/2,d/2,y/2,p,1),{x:d/2,y:-y/2},...Qf(d/2,-y/2,-d/2,-y/2,p,-1)],S=Ur(_),C=x.path(S,w),E=i.insert(()=>C,":first-child");return E.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",r),kn(t,E),t.intersect=function(T){return vn.polygon(t,_,T)},i}ie(kte,"waveRectangle");async function Ete(e,t){const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const{shapeSvg:i,bbox:s,label:a}=await rr(e,t,Wn(t)),o=Math.max(s.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(s.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,p=wn.svg(i),y=Sn(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],x=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const w=p.path(x,y),_=i.insert(()=>w,":first-child");return _.attr("transform",`translate(${c/2}, ${c/2})`),_.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&_.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(s.width/2)+c/2-(s.x-(s.left??0))}, ${-(s.height/2)+c/2-(s.y-(s.top??0))})`),kn(t,_),t.intersect=function(S){return vn.polygon(t,b,S)},i}ie(Ete,"windowPane");async function CD(e,t){var re,G,ne;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:te}=ho(),{background:se}=te,pe={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${se}`]};await CD(e,pe)}const r=ho();t.useHtmlLabels=r.htmlLabels;let i=((re=r.er)==null?void 0:re.diagramPadding)??10,s=((G=r.er)==null?void 0:G.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=En(t);if(n.attributes.length===0&&t.label){const te={rx:0,ry:0,labelPaddingX:i,labelPaddingY:i*1.5};vd(t.label,r)+te.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const se=await b1(e,t,te);if(!Es(r.htmlLabels)){const pe=se.select("text"),de=(ne=pe.node())==null?void 0:ne.getBBox();pe.attr("transform",`translate(${-de.width/2}, 0)`)}return se}r.htmlLabels||(i*=1.25,s*=1.25);let l=Wn(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await _g(c,t.label??"",r,0,0,["name"],o);u.height+=s;let d=0;const h=[];let p=0,y=0,b=0,x=0,w=!0,_=!0;for(const te of n.attributes){const se=await _g(c,te.type,r,0,d,["attribute-type"],o);p=Math.max(p,se.width+i);const pe=await _g(c,te.name,r,0,d,["attribute-name"],o);y=Math.max(y,pe.width+i);const de=await _g(c,te.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,de.width+i);const Ne=await _g(c,te.comment,r,0,d,["attribute-comment"],o);x=Math.max(x,Ne.width+i),d+=Math.max(se.height,pe.height,de.height,Ne.height)+s,h.push(d)}h.pop();let S=4;b<=i&&(w=!1,b=0,S--),x<=i&&(_=!1,x=0,S--);const C=c.node().getBBox();if(u.width+i*2-(p+y+b+x)>0){const te=u.width+i*2-(p+y+b+x);p+=te/S,y+=te/S,b>0&&(b+=te/S),x>0&&(x+=te/S)}const E=p+y+b+x,T=wn.svg(c),R=Sn(t,{});t.look!=="handDrawn"&&(R.roughness=0,R.fillStyle="solid");const M=Math.max(C.width+i*2,(t==null?void 0:t.width)||0,E),N=Math.max(C.height+(h[0]||d)+s,(t==null?void 0:t.height)||0),O=-M/2,B=-N/2;c.selectAll("g:not(:first-child)").each((te,se,pe)=>{const de=Lr(pe[se]),Ne=de.attr("transform");let Pe=0,Me=0;if(Ne){const Ue=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Ne);Ue&&(Pe=parseFloat(Ue[1]),Me=parseFloat(Ue[2]),de.attr("class").includes("attribute-name")?Pe+=p:de.attr("class").includes("attribute-keys")?Pe+=p+y:de.attr("class").includes("attribute-comment")&&(Pe+=p+y+b))}de.attr("transform",`translate(${O+i/2+Pe}, ${Me+B+u.height+s/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(B+s/2)+")");const P=T.rectangle(O,B,M,N,R),H=c.insert(()=>P,":first-child").attr("style",a.join("")),{themeVariables:F}=ho(),{rowEven:Q,rowOdd:q,nodeBorder:K}=F;h.push(0);for(const[te,se]of h.entries()){if(te===0&&h.length>1)continue;const pe=te%2===0&&se!==0,de=T.rectangle(O,u.height+B+se,M,u.height,{...R,fill:pe?Q:q,stroke:K});c.insert(()=>de,"g.label").attr("style",a.join("")).attr("class",`row-rect-${te%2===0?"even":"odd"}`)}let U=T.line(O,u.height+B,M+O,u.height+B,R);c.insert(()=>U).attr("class","divider"),U=T.line(p+O,u.height+B,p+O,N+B,R),c.insert(()=>U).attr("class","divider"),w&&(U=T.line(p+y+O,u.height+B,p+y+O,N+B,R),c.insert(()=>U).attr("class","divider")),_&&(U=T.line(p+y+b+O,u.height+B,p+y+b+O,N+B,R),c.insert(()=>U).attr("class","divider"));for(const te of h)U=T.line(O,u.height+B+te,M+O,u.height+B+te,R),c.insert(()=>U).attr("class","divider");return kn(t,H),t.intersect=function(te){return vn.rect(t,te)},c}ie(CD,"erBox");async function _g(e,t,n,r=0,i=0,s=[],a=""){const o=e.insert("g").attr("class",`label ${s.join(" ")}`).attr("transform",`translate(${r}, ${i})`).attr("style",a);t!==az(t)&&(t=az(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await vh(o,t,{width:vd(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Es(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Lr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(_g,"addText");async function Tte(e,t,n,r,i=n.class.padding??12){const s=r?0:3,a=e.insert("g").attr("class",Wn(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,p=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const _=t.annotations[0];await xv(o,{text:`${_}`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await xv(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const _ of t.members){const S=await xv(c,_,b,[_.parseClassifier()]);b+=S+s}p=c.node().getBBox().height,p<=0&&(p=i/2),u=a.insert("g").attr("class","methods-group text");let x=0;for(const _ of t.methods){const S=await xv(u,_,x,[_.parseClassifier()]);x+=S+s}let w=a.node().getBBox();if(o!==null){const _=o.node().getBBox();o.attr("transform",`translate(${-_.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),w=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+i*2})`),w=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(p?p+i*4:i*2)})`),w=a.node().getBBox(),{shapeSvg:a,bbox:w}}ie(Tte,"textHelper");async function xv(e,t,n,r=[]){const i=e.insert("g").attr("class","label").attr("style",r.join("; ")),s=ho();let a="useHtmlLabels"in t?t.useHtmlLabels:Es(s.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),j0(o)&&(a=!0);const l=await vh(i,OP(dm(o)),{width:vd(o,s)+50,classes:"markdown-node-label",useHtmlLabels:a},s);let c,u=1;if(a){const d=l.children[0],h=Lr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const p=d.getElementsByTagName("img");if(p){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...p].map(b=>new Promise(x=>{function w(){var _;if(b.style.display="flex",b.style.flexDirection="column",y){const S=((_=s.fontSize)==null?void 0:_.toString())??window.getComputedStyle(document.body).fontSize,E=parseInt(S,10)*5+"px";b.style.minWidth=E,b.style.maxWidth=E}else b.style.width="100%";x(b)}ie(w,"setupImage"),setTimeout(()=>{b.complete&&w()}),b.addEventListener("error",w),b.addEventListener("load",w)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Lr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return i.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(xv,"addText");async function Ate(e,t){var N,O;const n=Xr(),r=n.class.padding??12,i=r,s=t.useHtmlLabels??Es(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await Tte(e,t,n,s,i),{labelStyles:c,nodeStyles:u}=En(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((N=a.styles)==null?void 0:N.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((O=n.class)!=null&&O.hideEmptyMembersBox),p=wn.svg(o),y=Sn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let x=l.height;a.members.length===0&&a.methods.length===0?x+=i:a.members.length>0&&a.methods.length===0&&(x+=i*2);const w=-b/2,_=-x/2,S=p.rectangle(w-r,_-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,x+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),C=o.insert(()=>S,":first-child");C.attr("class","basic label-container");const E=C.node().getBBox();o.selectAll(".text").each((B,P,H)=>{var re;const F=Lr(H[P]),Q=F.attr("transform");let q=0;if(Q){const ne=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Q);ne&&(q=parseFloat(ne[2]))}let K=q+_+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);s||(K-=4);let U=w;(F.attr("class").includes("label-group")||F.attr("class").includes("annotation-group"))&&(U=-((re=F.node())==null?void 0:re.getBBox().width)/2||0,o.selectAll("text").each(function(G,ne,te){window.getComputedStyle(te[ne]).textAnchor==="middle"&&(U=0)})),F.attr("transform",`translate(${U}, ${K})`)});const T=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,R=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,M=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const B=p.line(E.x,T+R+_+r,E.x+E.width,T+R+_+r,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const B=p.line(E.x,T+R+M+_+i*2+r,E.x+E.width,T+R+M+_+r+i*2,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),C.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!s){const B=RegExp(/color\s*:\s*([^;]*)/),P=B.exec(d);if(P){const H=P[0].replace("color","fill");o.selectAll("tspan").attr("style",H)}else if(c){const H=B.exec(c);if(H){const F=H[0].replace("color","fill");o.selectAll("tspan").attr("style",F)}}}return kn(t,C),t.intersect=function(B){return vn.rect(t,B)},o}ie(Ate,"classBox");async function Rte(e,t){var T,R;const{labelStyles:n,nodeStyles:r}=En(t);t.labelStyle=n;const i=t,s=t,a=20,o=20,l="verifyMethod"in t,c=Wn(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await Nc(u,`&lt;&lt;${i.type}&gt;&gt;`,0,t.labelStyle):d=await Nc(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const p=await Nc(u,i.name,h,t.labelStyle+"; font-weight: bold;");if(h+=p+o,l){const M=await Nc(u,`${i.requirementId?`Id: ${i.requirementId}`:""}`,h,t.labelStyle);h+=M;const N=await Nc(u,`${i.text?`Text: ${i.text}`:""}`,h,t.labelStyle);h+=N;const O=await Nc(u,`${i.risk?`Risk: ${i.risk}`:""}`,h,t.labelStyle);h+=O,await Nc(u,`${i.verifyMethod?`Verification: ${i.verifyMethod}`:""}`,h,t.labelStyle)}else{const M=await Nc(u,`${s.type?`Type: ${s.type}`:""}`,h,t.labelStyle);h+=M,await Nc(u,`${s.docRef?`Doc Ref: ${s.docRef}`:""}`,h,t.labelStyle)}const y=(((T=u.node())==null?void 0:T.getBBox().width)??200)+a,b=(((R=u.node())==null?void 0:R.getBBox().height)??200)+a,x=-y/2,w=-b/2,_=wn.svg(u),S=Sn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const C=_.rectangle(x,w,y,b,S),E=u.insert(()=>C,":first-child");if(E.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((M,N,O)=>{const B=Lr(O[N]),P=B.attr("transform");let H=0,F=0;if(P){const U=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(P);U&&(H=parseFloat(U[1]),F=parseFloat(U[2]))}const Q=F-b/2;let q=x+a/2;(N===0||N===1)&&(q=H),B.attr("transform",`translate(${q}, ${Q+a})`)}),h>d+p+o){const M=_.line(x,w+d+p+o,x+y,w+d+p+o,S);u.insert(()=>M).attr("style",r)}return kn(t,E),t.intersect=function(M){return vn.rect(t,M)},u}ie(Rte,"requirementBox");async function Nc(e,t,n,r=""){if(t==="")return 0;const i=e.insert("g").attr("class","label").attr("style",r),s=Xr(),a=s.htmlLabels??!0,o=await vh(i,OP(dm(t)),{width:vd(t,s)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},s);let l;if(a){const c=o.children[0],u=Lr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return i.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(Nc,"addText");var mFe=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Ite(e,t,{config:n}){var P,H;const{labelStyles:r,nodeStyles:i}=En(t);t.labelStyle=r||"";const s=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await rr(e,t,Wn(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((P=n==null?void 0:n.kanban)!=null&&P.ticketBaseUrl)&&(d=(H=n==null?void 0:n.kanban)==null?void 0:H.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const p={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await cN(h,"ticket"in t&&t.ticket||"",p):{label:y,bbox:b}=await cN(o,"ticket"in t&&t.ticket||"",p);const{label:x,bbox:w}=await cN(o,"assigned"in t&&t.assigned||"",p);t.width=a;const _=10,S=(t==null?void 0:t.width)||0,C=Math.max(b.height,w.height)/2,E=Math.max(l.height+_*2,(t==null?void 0:t.height)||0)+C,T=-S/2,R=-E/2;c.attr("transform","translate("+(u-S/2)+", "+(-C-l.height/2)+")"),y.attr("transform","translate("+(u-S/2)+", "+(-C+l.height/2)+")"),x.attr("transform","translate("+(u+S/2-w.width-2*s)+", "+(-C+l.height/2)+")");let M;const{rx:N,ry:O}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){const F=wn.svg(o),Q=Sn(t,{}),q=N||O?F.path(Ad(T,R,S,E,N||0),Q):F.rectangle(T,R,S,E,Q);M=o.insert(()=>q,":first-child"),M.attr("class","basic label-container").attr("style",B||null)}else{M=o.insert("rect",":first-child"),M.attr("class","basic label-container __APA__").attr("style",i).attr("rx",N??5).attr("ry",O??5).attr("x",T).attr("y",R).attr("width",S).attr("height",E);const F="priority"in t&&t.priority;if(F){const Q=o.append("line"),q=T+2,K=R+Math.floor((N??0)/2),U=R+E-Math.floor((N??0)/2);Q.attr("x1",q).attr("y1",K).attr("x2",q).attr("y2",U).attr("stroke-width","4").attr("stroke",mFe(F))}}return kn(t,M),t.height=E,t.intersect=function(F){return vn.rect(t,F)},o}ie(Ite,"kanbanItem");var gFe=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:dte},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:lte},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:fte},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:gte},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:Pee},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Aee},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:ste},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:Uee},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:Jee},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Xee},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:wte},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Yee},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:Fee},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:vte},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Eee},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:cte},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:mte},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:pte},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:$ee},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:qee},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Mee},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:Nee},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:jee},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:Qee},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Cte},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:zee},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:xte},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:ete},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:Oee},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:Dee},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Ste},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Ete},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:Lee},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:_te},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:Bee},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:ute},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:rte},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:nte},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:kee},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Iee},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:bte},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:yte},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:kte},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:ate},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:tte}],yFe=ie(()=>{const t=[...Object.entries({state:hte,choice:Tee,note:ite,rectWithTitle:ote,labelRect:Zee,iconSquare:Gee,iconCircle:Hee,icon:Vee,iconRounded:Wee,imageSquare:Kee,anchor:Cee,kanbanItem:Ite,classBox:Ate,erBox:CD,requirementBox:Rte}),...gFe.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(i=>[i,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),Mte=yFe();function bFe(e){return e in Mte}ie(bFe,"isValidShape");var aT=new Map;async function Nte(e,t,n){let r,i;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const s=t.shape?Mte[t.shape]:void 0;if(!s)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),i=await s(r,t,n)}else i=await s(e,t,n),r=i;return t.tooltip&&i.attr("title",t.tooltip),aT.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(Nte,"insertNode");var Ust=ie((e,t)=>{aT.set(t.id,e)},"setNodeElem"),qst=ie(()=>{aT.clear()},"clear"),Vst=ie(e=>{const t=aT.get(e.id);Lt.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),vFe=ie((e,t,n,r,i,s)=>{t.arrowTypeStart&&f7(e,"start",t.arrowTypeStart,n,r,i,s),t.arrowTypeEnd&&f7(e,"end",t.arrowTypeEnd,n,r,i,s)},"addEdgeMarkers"),xFe={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},f7=ie((e,t,n,r,i,s,a)=>{var d;const o=xFe[n];if(!o){Lt.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${i}_${s}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),p=`${u}_${h}`;if(!document.getElementById(p)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=p,b.querySelectorAll("path, circle, line").forEach(w=>{w.setAttribute("stroke",a),o.fill&&w.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${p})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),lk=new Map,ea=new Map,Hst=ie(()=>{lk.clear(),ea.clear()},"clear"),lv=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),wFe=ie(async(e,t)=>{let n=Es(Xr().flowchart.htmlLabels);const r=await vh(e,t.label,{style:lv(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});Lt.info("abc82",t,t.labelType);const i=e.insert("g").attr("class","edgeLabel"),s=i.insert("g").attr("class","label");s.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Lr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),lk.set(t.id,i),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await gp(t.startLabelLeft,lv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ea.get(t.id)||ea.set(t.id,{}),ea.get(t.id).startLeft=c,wv(o,t.startLabelLeft)}if(t.startLabelRight){const l=await gp(t.startLabelRight,lv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),ea.get(t.id)||ea.set(t.id,{}),ea.get(t.id).startRight=c,wv(o,t.startLabelRight)}if(t.endLabelLeft){const l=await gp(t.endLabelLeft,lv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ea.get(t.id)||ea.set(t.id,{}),ea.get(t.id).endLeft=c,wv(o,t.endLabelLeft)}if(t.endLabelRight){const l=await gp(t.endLabelRight,lv(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),ea.get(t.id)||ea.set(t.id,{}),ea.get(t.id).endRight=c,wv(o,t.endLabelRight)}return r},"insertEdgeLabel");function wv(e,t){Xr().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(wv,"setTerminalWidth");var _Fe=ie((e,t)=>{Lt.debug("Moving label abc88 ",e.id,e.label,lk.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=Xr(),{subGraphTitleTotalMargin:i}=UP(r);if(e.label){const s=lk.get(e.id);let a=e.x,o=e.y;if(n){const l=Uc.calcLabelPosition(n);Lt.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}s.attr("transform",`translate(${a}, ${o+i/2})`)}if(e.startLabelLeft){const s=ea.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=Uc.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}s.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const s=ea.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=Uc.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}s.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const s=ea.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=Uc.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}s.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const s=ea.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=Uc.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}s.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),SFe=ie((e,t)=>{const n=e.x,r=e.y,i=Math.abs(t.x-n),s=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return i>=a||s>=o},"outsideNode"),CFe=ie((e,t,n)=>{Lt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,i=e.y,s=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-s:a+s;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(i-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-i:i-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),Lt.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,p=n.y<t.y?n.y+d:n.y-d;return Lt.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:p}),o===0&&(h=t.x,p=t.y),u===0&&(h=t.x),c===0&&(p=t.y),{x:h,y:p}}},"intersection"),h7=ie((e,t)=>{Lt.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],i=!1;return e.forEach(s=>{if(Lt.info("abc88 checking point",s,t),!SFe(t,s)&&!i){const a=CFe(t,r,s);Lt.debug("abc88 inside",s,r,a),Lt.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?Lt.warn("abc88 no intersect",a,n):n.push(a),i=!0}else Lt.warn("abc88 outside",s,r),r=s,i||n.push(s)}),Lt.debug("returning points",n),n},"cutPathAtIntersect");function jte(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const i=e[r-1],s=e[r],a=e[r+1];(i.x===s.x&&s.y===a.y&&Math.abs(s.x-a.x)>5&&Math.abs(s.y-i.y)>5||i.y===s.y&&s.x===a.x&&Math.abs(s.x-i.x)>5&&Math.abs(s.y-a.y)>5)&&(t.push(s),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(jte,"extractCornerPoints");var p7=ie(function(e,t,n){const r=t.x-e.x,i=t.y-e.y,s=Math.sqrt(r*r+i*i),a=n/s;return{x:t.x-a*r,y:t.y-a*i}},"findAdjacentPoint"),kFe=ie(function(e){const{cornerPointPositions:t}=jte(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const i=e[r-1],s=e[r+1],a=e[r],o=p7(i,a,5),l=p7(s,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(s.x-i.x)>10&&Math.abs(s.y-i.y)>=10){Lt.debug("Corner point fixing",Math.abs(s.x-i.x),Math.abs(s.y-i.y));const p=5;a.x===o.x?h={x:c<0?o.x-p+d:o.x+p-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-p+d:o.y+p-d}}else Lt.debug("Corner point skipping fixing",Math.abs(s.x-i.x),Math.abs(s.y-i.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),EFe=ie(function(e,t,n,r,i,s,a){var N;const{handDrawnSeed:o}=Xr();let l=t.points,c=!1;const u=i;var d=s;const h=[];for(const O in t.cssCompiledStyles)mee(O)||h.push(t.cssCompiledStyles[O]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),Lt.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(Lt.info("to cluster abc88",n.get(t.toCluster)),l=h7(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(Lt.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=h7(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let p=l.filter(O=>!Number.isNaN(O.y));p=kFe(p);let y=d2;switch(y=WC,t.curve){case"linear":y=WC;break;case"basis":y=d2;break;case"cardinal":y=nQ;break;case"bumpX":y=XJ;break;case"bumpY":y=JJ;break;case"catmullRom":y=iQ;break;case"monotoneX":y=uQ;break;case"monotoneY":y=dQ;break;case"natural":y=hQ;break;case"step":y=pQ;break;case"stepAfter":y=gQ;break;case"stepBefore":y=mQ;break;default:y=d2}const{x:b,y:x}=YNe(t),w=qOe().x(b).y(x).curve(y);let _;switch(t.thickness){case"normal":_="edge-thickness-normal";break;case"thick":_="edge-thickness-thick";break;case"invisible":_="edge-thickness-invisible";break;default:_="edge-thickness-normal"}switch(t.pattern){case"solid":_+=" edge-pattern-solid";break;case"dotted":_+=" edge-pattern-dotted";break;case"dashed":_+=" edge-pattern-dashed";break;default:_+=" edge-pattern-solid"}let S,C=w(p);const E=Array.isArray(t.style)?t.style:[t.style];let T=E.find(O=>O==null?void 0:O.startsWith("stroke:"));if(t.look==="handDrawn"){const O=wn.svg(e);Object.assign([],p);const B=O.path(C,{roughness:.3,seed:o});_+=" transition",S=Lr(B).select("path").attr("id",t.id).attr("class"," "+_+(t.classes?" "+t.classes:"")).attr("style",E?E.reduce((H,F)=>H+";"+F,""):"");let P=S.attr("d");S.attr("d",P),e.node().appendChild(S.node())}else{const O=h.join(";"),B=E?E.reduce((F,Q)=>F+Q+";",""):"";let P="";t.animate&&(P=" edge-animation-fast"),t.animation&&(P=" edge-animation-"+t.animation);const H=O?O+";"+B+";":B;S=e.append("path").attr("d",C).attr("id",t.id).attr("class"," "+_+(t.classes?" "+t.classes:"")+(P??"")).attr("style",H),T=(N=H.match(/stroke:([^;]+)/))==null?void 0:N[1]}let R="";(Xr().flowchart.arrowMarkerAbsolute||Xr().state.arrowMarkerAbsolute)&&(R=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,R=R.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),Lt.info("arrowTypeStart",t.arrowTypeStart),Lt.info("arrowTypeEnd",t.arrowTypeEnd),vFe(S,t,R,a,r,T);let M={};return c&&(M.updatedPath=l),M.originalPath=t.points,M},"insertEdge"),TFe=ie((e,t,n,r)=>{t.forEach(i=>{qFe[i](e,n,r)})},"insertMarkers"),AFe=ie((e,t,n)=>{Lt.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),RFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),IFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),MFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),NFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),jFe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),OFe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),PFe=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),DFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),FFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),LFe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const i=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");i.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),i.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),BFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),$Fe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const i=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");i.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),i.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),zFe=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),UFe=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),qFe={extension:AFe,composition:RFe,aggregation:IFe,dependency:MFe,lollipop:NFe,point:jFe,circle:OFe,cross:PFe,barb:DFe,only_one:FFe,zero_or_one:LFe,one_or_more:BFe,zero_or_more:$Fe,requirement_arrow:zFe,requirement_contains:UFe},VFe=TFe,HFe={common:gy,getConfig:ho,insertCluster:Q5e,insertEdge:EFe,insertEdgeLabel:wFe,insertMarkers:VFe,insertNode:Nte,interpolateToCurve:sD,labelHelper:rr,log:Lt,positionEdgeLabel:_Fe},Zx={},Ote=ie(e=>{for(const t of e)Zx[t.name]=t},"registerLayoutLoaders"),WFe=ie(()=>{Ote([{name:"dagre",loader:ie(async()=>await zr(()=>import("./dagre-OKDRZEBW-ji5THaZ7.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");WFe();var Wst=ie(async(e,t)=>{if(!(e.layoutAlgorithm in Zx))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=Zx[e.layoutAlgorithm];return(await n.loader()).render(e,t,HFe,{algorithm:n.algorithm})},"render"),Gst=ie((e="",{fallback:t="dagre"}={})=>{if(e in Zx)return e;if(t in Zx)return Lt.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),m7={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},GFe=ie(e=>{var i;const{securityLevel:t}=Xr();let n=Lr("body");if(t==="sandbox"){const a=((i=Lr(`#i${e}`).node())==null?void 0:i.contentDocument)??document;n=Lr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),Pte="comm",Dte="rule",Fte="decl",KFe="@import",YFe="@namespace",ZFe="@keyframes",XFe="@layer",Lte=Math.abs,kD=String.fromCharCode;function Bte(e){return e.trim()}function m2(e,t,n){return e.replace(t,n)}function JFe(e,t,n){return e.indexOf(t,n)}function Wg(e,t){return e.charCodeAt(t)|0}function L0(e,t,n){return e.slice(t,n)}function Fc(e){return e.length}function QFe(e){return e.length}function CS(e,t){return t.push(e),e}var oT=1,B0=1,$te=0,wl=0,hs=0,wy="";function ED(e,t,n,r,i,s,a,o){return{value:e,root:t,parent:n,type:r,props:i,children:s,line:oT,column:B0,length:a,return:"",siblings:o}}function e8e(){return hs}function t8e(){return hs=wl>0?Wg(wy,--wl):0,B0--,hs===10&&(B0=1,oT--),hs}function tc(){return hs=wl<$te?Wg(wy,wl++):0,B0++,hs===10&&(B0=1,oT++),hs}function Af(){return Wg(wy,wl)}function g2(){return wl}function lT(e,t){return L0(wy,e,t)}function Xx(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function n8e(e){return oT=B0=1,$te=Fc(wy=e),wl=0,[]}function r8e(e){return wy="",e}function uN(e){return Bte(lT(wl-1,Wj(e===91?e+2:e===40?e+1:e)))}function i8e(e){for(;(hs=Af())&&hs<33;)tc();return Xx(e)>2||Xx(hs)>3?"":" "}function s8e(e,t){for(;--t&&tc()&&!(hs<48||hs>102||hs>57&&hs<65||hs>70&&hs<97););return lT(e,g2()+(t<6&&Af()==32&&tc()==32))}function Wj(e){for(;tc();)switch(hs){case e:return wl;case 34:case 39:e!==34&&e!==39&&Wj(hs);break;case 40:e===41&&Wj(e);break;case 92:tc();break}return wl}function a8e(e,t){for(;tc()&&e+hs!==57;)if(e+hs===84&&Af()===47)break;return"/*"+lT(t,wl-1)+"*"+kD(e===47?e:tc())}function o8e(e){for(;!Xx(Af());)tc();return lT(e,wl)}function l8e(e){return r8e(y2("",null,null,null,[""],e=n8e(e),0,[0],e))}function y2(e,t,n,r,i,s,a,o,l){for(var c=0,u=0,d=a,h=0,p=0,y=0,b=1,x=1,w=1,_=0,S="",C=i,E=s,T=r,R=S;x;)switch(y=_,_=tc()){case 40:if(y!=108&&Wg(R,d-1)==58){JFe(R+=m2(uN(_),"&","&\f"),"&\f",Lte(c?o[c-1]:0))!=-1&&(w=-1);break}case 34:case 39:case 91:R+=uN(_);break;case 9:case 10:case 13:case 32:R+=i8e(y);break;case 92:R+=s8e(g2()-1,7);continue;case 47:switch(Af()){case 42:case 47:CS(c8e(a8e(tc(),g2()),t,n,l),l),(Xx(y||1)==5||Xx(Af()||1)==5)&&Fc(R)&&L0(R,-1,void 0)!==" "&&(R+=" ");break;default:R+="/"}break;case 123*b:o[c++]=Fc(R)*w;case 125*b:case 59:case 0:switch(_){case 0:case 125:x=0;case 59+u:w==-1&&(R=m2(R,/\f/g,"")),p>0&&(Fc(R)-d||b===0&&y===47)&&CS(p>32?y7(R+";",r,n,d-1,l):y7(m2(R," ","")+";",r,n,d-2,l),l);break;case 59:R+=";";default:if(CS(T=g7(R,t,n,c,u,i,o,S,C=[],E=[],d,s),s),_===123)if(u===0)y2(R,t,T,T,C,s,d,o,E);else{switch(h){case 99:if(Wg(R,3)===110)break;case 108:if(Wg(R,2)===97)break;default:u=0;case 100:case 109:case 115:}u?y2(e,T,T,r&&CS(g7(e,T,T,0,0,i,o,S,i,C=[],d,E),E),i,E,d,o,r?C:E):y2(R,T,T,T,[""],E,0,o,E)}}c=u=p=0,b=w=1,S=R="",d=a;break;case 58:d=1+Fc(R),p=y;default:if(b<1){if(_==123)--b;else if(_==125&&b++==0&&t8e()==125)continue}switch(R+=kD(_),_*b){case 38:w=u>0?1:(R+="\f",-1);break;case 44:o[c++]=(Fc(R)-1)*w,w=1;break;case 64:Af()===45&&(R+=uN(tc())),h=Af(),u=d=Fc(S=R+=o8e(g2())),_++;break;case 45:y===45&&Fc(R)==2&&(b=0)}}return s}function g7(e,t,n,r,i,s,a,o,l,c,u,d){for(var h=i-1,p=i===0?s:[""],y=QFe(p),b=0,x=0,w=0;b<r;++b)for(var _=0,S=L0(e,h+1,h=Lte(x=a[b])),C=e;_<y;++_)(C=Bte(x>0?p[_]+" "+S:m2(S,/&\f/g,p[_])))&&(l[w++]=C);return ED(e,t,n,i===0?Dte:o,l,c,u,d)}function c8e(e,t,n,r){return ED(e,t,n,Pte,kD(e8e()),L0(e,2,-2),0,r)}function y7(e,t,n,r,i){return ED(e,t,n,Fte,L0(e,0,r),L0(e,r+1,-1),r,i)}function Gj(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function u8e(e,t,n,r){switch(e.type){case XFe:if(e.children.length)break;case KFe:case YFe:case Fte:return e.return=e.return||e.value;case Pte:return"";case ZFe:return e.return=e.value+"{"+Gj(e.children,r)+"}";case Dte:if(!Fc(e.value=e.props.join(",")))return""}return Fc(n=Gj(e.children,r))?e.return=e.value+"{"+n+"}":""}var d8e=xQ(Object.keys,Object),f8e=Object.prototype,h8e=f8e.hasOwnProperty;function p8e(e){if(!JE(e))return d8e(e);var t=[];for(var n in Object(e))h8e.call(e,n)&&n!="constructor"&&t.push(n);return t}var Kj=um(pu,"DataView"),Yj=um(pu,"Promise"),Zj=um(pu,"Set"),Xj=um(pu,"WeakMap"),b7="[object Map]",m8e="[object Object]",v7="[object Promise]",x7="[object Set]",w7="[object WeakMap]",_7="[object DataView]",g8e=cm(Kj),y8e=cm(Yx),b8e=cm(Yj),v8e=cm(Zj),x8e=cm(Xj),ip=yy;(Kj&&ip(new Kj(new ArrayBuffer(1)))!=_7||Yx&&ip(new Yx)!=b7||Yj&&ip(Yj.resolve())!=v7||Zj&&ip(new Zj)!=x7||Xj&&ip(new Xj)!=w7)&&(ip=function(e){var t=yy(e),n=t==m8e?e.constructor:void 0,r=n?cm(n):"";if(r)switch(r){case g8e:return _7;case y8e:return b7;case b8e:return v7;case v8e:return x7;case x8e:return w7}return t});var w8e="[object Map]",_8e="[object Set]",S8e=Object.prototype,C8e=S8e.hasOwnProperty;function S7(e){if(e==null)return!0;if(QE(e)&&(QC(e)||typeof e=="string"||typeof e.splice=="function"||rD(e)||iD(e)||JC(e)))return!e.length;var t=ip(e);if(t==w8e||t==_8e)return!e.size;if(JE(e))return!p8e(e).length;for(var n in e)if(C8e.call(e,n))return!1;return!0}var zte="c4",k8e=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),E8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-Ch5Uo_Zg.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:zte,diagram:e}},"loader"),T8e={id:zte,detector:k8e,loader:E8e},A8e=T8e,Ute="flowchart",R8e=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),I8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-CwHcuQCt.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Ute,diagram:e}},"loader"),M8e={id:Ute,detector:R8e,loader:I8e},N8e=M8e,qte="flowchart-v2",j8e=ie((e,t)=>{var n,r,i;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((i=t==null?void 0:t.flowchart)==null?void 0:i.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),O8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-CwHcuQCt.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:qte,diagram:e}},"loader"),P8e={id:qte,detector:j8e,loader:O8e},D8e=P8e,Vte="er",F8e=ie(e=>/^\s*erDiagram/.test(e),"detector"),L8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-DNyKjoxr.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:Vte,diagram:e}},"loader"),B8e={id:Vte,detector:F8e,loader:L8e},$8e=B8e,Hte="gitGraph",z8e=ie(e=>/^\s*gitGraph/.test(e),"detector"),U8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-D0UafhDo.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:Hte,diagram:e}},"loader"),q8e={id:Hte,detector:z8e,loader:U8e},V8e=q8e,Wte="gantt",H8e=ie(e=>/^\s*gantt/.test(e),"detector"),W8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-CFVgmY2g.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:Wte,diagram:e}},"loader"),G8e={id:Wte,detector:H8e,loader:W8e},K8e=G8e,Gte="info",Y8e=ie(e=>/^\s*info/.test(e),"detector"),Z8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-rQ-DVwCM.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:Gte,diagram:e}},"loader"),X8e={id:Gte,detector:Y8e,loader:Z8e},Kte="pie",J8e=ie(e=>/^\s*pie/.test(e),"detector"),Q8e=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-BQeroX41.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:Kte,diagram:e}},"loader"),eLe={id:Kte,detector:J8e,loader:Q8e},Yte="quadrantChart",tLe=ie(e=>/^\s*quadrantChart/.test(e),"detector"),nLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-BQCJO31M.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:Yte,diagram:e}},"loader"),rLe={id:Yte,detector:tLe,loader:nLe},iLe=rLe,Zte="xychart",sLe=ie(e=>/^\s*xychart-beta/.test(e),"detector"),aLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-Cga-8etu.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:Zte,diagram:e}},"loader"),oLe={id:Zte,detector:sLe,loader:aLe},lLe=oLe,Xte="requirement",cLe=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),uLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-HPZT71Wm.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:Xte,diagram:e}},"loader"),dLe={id:Xte,detector:cLe,loader:uLe},fLe=dLe,Jte="sequence",hLe=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),pLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-BxyPNmiq.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:Jte,diagram:e}},"loader"),mLe={id:Jte,detector:hLe,loader:pLe},gLe=mLe,Qte="class",yLe=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),bLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-DGbwr2Dn.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:Qte,diagram:e}},"loader"),vLe={id:Qte,detector:yLe,loader:bLe},xLe=vLe,ene="classDiagram",wLe=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),_Le=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-DGbwr2Dn.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:ene,diagram:e}},"loader"),SLe={id:ene,detector:wLe,loader:_Le},CLe=SLe,tne="state",kLe=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),ELe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-DsASCFOu.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:tne,diagram:e}},"loader"),TLe={id:tne,detector:kLe,loader:ELe},ALe=TLe,nne="stateDiagram",RLe=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),ILe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-CWqWliNZ.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:nne,diagram:e}},"loader"),MLe={id:nne,detector:RLe,loader:ILe},NLe=MLe,rne="journey",jLe=ie(e=>/^\s*journey/.test(e),"detector"),OLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-D1Pv6_md.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:rne,diagram:e}},"loader"),PLe={id:rne,detector:jLe,loader:OLe},DLe=PLe,FLe=ie((e,t,n)=>{Lt.debug(`rendering svg for syntax error
`);const r=GFe(t),i=r.append("g");r.attr("viewBox","0 0 2412 512"),FZ(r,100,512,!0),i.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),i.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),i.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),i.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),i.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),i.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),i.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),i.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),ine={draw:FLe},LLe=ine,BLe={db:{},renderer:ine,parser:{parse:ie(()=>{},"parse")}},$Le=BLe,sne="flowchart-elk",zLe=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),ULe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-CwHcuQCt.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:sne,diagram:e}},"loader"),qLe={id:sne,detector:zLe,loader:ULe},VLe=qLe,ane="timeline",HLe=ie(e=>/^\s*timeline/.test(e),"detector"),WLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-DbdJxsmN.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:ane,diagram:e}},"loader"),GLe={id:ane,detector:HLe,loader:WLe},KLe=GLe,one="mindmap",YLe=ie(e=>/^\s*mindmap/.test(e),"detector"),ZLe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-D59GPnpC.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:one,diagram:e}},"loader"),XLe={id:one,detector:YLe,loader:ZLe},JLe=XLe,lne="kanban",QLe=ie(e=>/^\s*kanban/.test(e),"detector"),eBe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-R7mpjN0_.js");return{diagram:t}},[]);return{id:lne,diagram:e}},"loader"),tBe={id:lne,detector:QLe,loader:eBe},nBe=tBe,cne="sankey",rBe=ie(e=>/^\s*sankey-beta/.test(e),"detector"),iBe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-D8MnYMw9.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:cne,diagram:e}},"loader"),sBe={id:cne,detector:rBe,loader:iBe},aBe=sBe,une="packet",oBe=ie(e=>/^\s*packet-beta/.test(e),"detector"),lBe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-DTJcd4FQ.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:une,diagram:e}},"loader"),cBe={id:une,detector:oBe,loader:lBe},dne="radar",uBe=ie(e=>/^\s*radar-beta/.test(e),"detector"),dBe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-DUjMcu2H.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:dne,diagram:e}},"loader"),fBe={id:dne,detector:uBe,loader:dBe},fne="block",hBe=ie(e=>/^\s*block-beta/.test(e),"detector"),pBe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-BmASdRVq.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:fne,diagram:e}},"loader"),mBe={id:fne,detector:hBe,loader:pBe},gBe=mBe,hne="architecture",yBe=ie(e=>/^\s*architecture/.test(e),"detector"),bBe=ie(async()=>{const{diagram:e}=await zr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-CmcroAkn.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:hne,diagram:e}},"loader"),vBe={id:hne,detector:yBe,loader:bBe},xBe=vBe,C7=!1,cT=ie(()=>{C7||(C7=!0,NC("error",$Le,e=>e.toLowerCase().trim()==="error"),NC("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),CZ(A8e,nBe,CLe,xLe,$8e,K8e,X8e,eLe,fLe,gLe,VLe,D8e,N8e,JLe,KLe,V8e,NLe,ALe,DLe,iLe,aBe,cBe,lLe,gBe,xBe,fBe))},"addDiagrams"),wBe=ie(async()=>{Lt.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(I0).map(async([n,{detector:r,loader:i}])=>{if(i)try{cj(n)}catch{try{const{diagram:s,id:a}=await i();NC(a,s,r)}catch(s){throw Lt.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete I0[n],s}}}))).filter(n=>n.status==="rejected");if(t.length>0){Lt.error(`Failed to load ${t.length} external diagrams`);for(const n of t)Lt.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),_Be="graphics-document document";function pne(e,t){e.attr("role",_Be),t!==""&&e.attr("aria-roledescription",t)}ie(pne,"setA11yDiagramInfo");function mne(e,t,n,r){if(e.insert!==void 0){if(n){const i=`chart-desc-${r}`;e.attr("aria-describedby",i),e.insert("desc",":first-child").attr("id",i).text(n)}if(t){const i=`chart-title-${r}`;e.attr("aria-labelledby",i),e.insert("title",":first-child").attr("id",i).text(t)}}}ie(mne,"addSVGa11yTitleDescription");var Ep,Jj=(Ep=class{constructor(t,n,r,i,s){this.type=t,this.text=n,this.db=r,this.parser=i,this.renderer=s}static async fromText(t,n={}){var c,u;const r=ho(),i=AP(t,r);t=q6e(t)+`
`;try{cj(i)}catch{const d=YIe(i);if(!d)throw new SZ(`Diagram ${i} not found.`);const{id:h,diagram:p}=await d();NC(h,p)}const{db:s,parser:a,renderer:o,init:l}=cj(i);return a.parser&&(a.parser.yy=s),(c=s.clear)==null||c.call(s),l==null||l(r),n.title&&((u=s.setDiagramTitle)==null||u.call(s,n.title)),await a.parse(t),new Ep(i,t,s,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(Ep,"Diagram"),Ep),k7=[],SBe=ie(()=>{k7.forEach(e=>{e()}),k7=[]},"attachFunctions"),CBe=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function gne(e){const t=e.match(_Z);if(!t)return{text:e,metadata:{}};let n=KNe(t[1],{schema:GNe})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(gne,"extractFrontMatter");var kBe=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),EBe=ie(e=>{const{text:t,metadata:n}=gne(e),{displayMode:r,title:i,config:s={}}=n;return r&&(s.gantt||(s.gantt={}),s.gantt.displayMode=r),{title:i,config:s,text:t}},"processFrontmatter"),TBe=ie(e=>{const t=Uc.detectInit(e)??{},n=Uc.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:I6e(e),directive:t}},"processDirectives");function TD(e){const t=kBe(e),n=EBe(t),r=TBe(n.text),i=uD(n.config,r.directive);return e=CBe(r.text),{code:e,title:n.title,config:i}}ie(TD,"preprocessDiagram");function yne(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(yne,"toBase64");var ABe=5e4,RBe="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",IBe="sandbox",MBe="loose",NBe="http://www.w3.org/2000/svg",jBe="http://www.w3.org/1999/xlink",OBe="http://www.w3.org/1999/xhtml",PBe="100%",DBe="100%",FBe="border:0;margin:0;",LBe="margin:0",BBe="allow-top-navigation-by-user-activation allow-popups",$Be='The "iframe" tag is not supported by your browser.',zBe=["foreignobject"],UBe=["dominant-baseline"];function AD(e){const t=TD(e);return IC(),dMe(t.config??{}),t}ie(AD,"processAndSetConfigs");async function bne(e,t){cT();try{const{code:n,config:r}=AD(e);return{diagramType:(await xne(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie(bne,"parse");var E7=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),qBe=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{S7(l.styles)||o.forEach(c=>{n+=E7(l.id,c,l.styles)}),S7(l.textStyles)||(n+=E7(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),VBe=ie((e,t,n,r)=>{const i=qBe(e,n),s=IMe(t,i,e.themeVariables);return Gj(l8e(`${r}{${s}}`),u8e)},"createUserStyles"),HBe=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=dm(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),WBe=ie((e="",t)=>{var i,s;const n=(s=(i=t==null?void 0:t.viewBox)==null?void 0:i.baseVal)!=null&&s.height?t.viewBox.baseVal.height+"px":DBe,r=yne(`<body style="${LBe}">${e}</body>`);return`<iframe style="width:${PBe};height:${n};${FBe}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${BBe}">
  ${$Be}
</iframe>`},"putIntoIFrame"),T7=ie((e,t,n,r,i)=>{const s=e.append("div");s.attr("id",n),r&&s.attr("style",r);const a=s.append("svg").attr("id",t).attr("width","100%").attr("xmlns",NBe);return i&&a.attr("xmlns:xlink",i),a.append("g"),e},"appendDivSvgG");function Qj(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(Qj,"sandboxedIframe");var GBe=ie((e,t,n,r)=>{var i,s,a;(i=e.getElementById(t))==null||i.remove(),(s=e.getElementById(n))==null||s.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),KBe=ie(async function(e,t,n){var P,H,F,Q,q,K;cT();const r=AD(t);t=r.code;const i=ho();Lt.debug(i),t.length>((i==null?void 0:i.maxTextSize)??ABe)&&(t=RBe);const s="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const re=Lr(h?o:c).node();re&&"remove"in re&&re.remove()},"removeTempElements");let d=Lr("body");const h=i.securityLevel===IBe,p=i.securityLevel===MBe,y=i.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const U=Qj(Lr(n),a);d=Lr(U.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Lr(n);T7(d,e,l,`font-family: ${y}`,jBe)}else{if(GBe(document,e,l,a),h){const U=Qj(Lr("body"),a);d=Lr(U.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Lr("body");T7(d,e,l)}let b,x;try{b=await Jj.fromText(t,{title:r.title})}catch(U){if(i.suppressErrorRendering)throw u(),U;b=await Jj.fromText("error"),x=U}const w=d.select(c).node(),_=b.type,S=w.firstChild,C=S.firstChild,E=(H=(P=b.renderer).getClasses)==null?void 0:H.call(P,t,b),T=VBe(i,_,E,s),R=document.createElement("style");R.innerHTML=T,S.insertBefore(R,C);try{await b.renderer.draw(t,e,m7.version,b)}catch(U){throw i.suppressErrorRendering?u():LLe.draw(t,e,m7.version),U}const M=d.select(`${c} svg`),N=(Q=(F=b.db).getAccTitle)==null?void 0:Q.call(F),O=(K=(q=b.db).getAccDescription)==null?void 0:K.call(q);wne(_,M,N,O),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",OBe);let B=d.select(c).node().innerHTML;if(Lt.debug("config.arrowMarkerAbsolute",i.arrowMarkerAbsolute),B=HBe(B,h,Es(i.arrowMarkerAbsolute)),h){const U=d.select(c+" svg").node();B=WBe(B,U)}else p||(B=R0.sanitize(B,{ADD_TAGS:zBe,ADD_ATTR:UBe,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(SBe(),x)throw x;return u(),{diagramType:_,svg:B,bindFunctions:b.db.bindFunctions}},"render");function vne(e={}){var r;const t=ra({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),cMe(t),t!=null&&t.theme&&t.theme in ad?t.themeVariables=ad[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=ad.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?lMe(t):IZ();TP(n.logLevel),cT()}ie(vne,"initialize");var xne=ie((e,t={})=>{const{code:n}=TD(e);return Jj.fromText(n,t)},"getDiagramFromText");function wne(e,t,n,r){pne(t,e),mne(t,n,r,t.attr("id"))}ie(wne,"addA11yInfo");var qp=Object.freeze({render:KBe,parse:bne,getDiagramFromText:xne,initialize:vne,getConfig:ho,setConfig:MZ,getSiteConfig:IZ,updateSiteConfig:uMe,reset:ie(()=>{IC()},"reset"),globalReset:ie(()=>{IC(M0)},"globalReset"),defaultConfig:M0});TP(ho().logLevel);IC(ho());var YBe=ie((e,t,n)=>{Lt.warn(e),cD(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),_ne=ie(async function(e={querySelector:".mermaid"}){try{await ZBe(e)}catch(t){if(cD(t)&&Lt.error(t.str),$o.parseError&&$o.parseError(t),!e.suppressErrors)throw Lt.error("Use the suppressErrors option to suppress these errors"),t}},"run"),ZBe=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=qp.getConfig();Lt.debug(`${e?"":"No "}Callback function found`);let i;if(n)i=n;else if(t)i=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");Lt.debug(`Found ${i.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(Lt.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),qp.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const s=new Uc.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(i)){if(Lt.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${s.next()}`;a=l.innerHTML,a=ZQ(Uc.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=Uc.detectInit(a);u&&Lt.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await Ene(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){YBe(d,o,$o.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),Sne=ie(function(e){qp.initialize(e)},"initialize"),XBe=ie(async function(e,t,n){Lt.warn("mermaid.init is deprecated. Please use run instead."),e&&Sne(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await _ne(r)},"init"),JBe=ie(async(e,{lazyLoad:t=!0}={})=>{cT(),CZ(...e),t===!1&&await wBe()},"registerExternalDiagrams"),Cne=ie(function(){if($o.startOnLoad){const{startOnLoad:e}=qp.getConfig();e&&$o.run().catch(t=>Lt.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",Cne,!1);var QBe=ie(function(e){$o.parseError=e},"setParseErrorHandler"),ck=[],dN=!1,kne=ie(async()=>{if(!dN){for(dN=!0;ck.length>0;){const e=ck.shift();if(e)try{await e()}catch(t){Lt.error("Error executing queue",t)}}dN=!1}},"executeQueue"),e$e=ie(async(e,t)=>new Promise((n,r)=>{const i=ie(()=>new Promise((s,a)=>{qp.parse(e,t).then(o=>{s(o),n(o)},o=>{var l;Lt.error("Error parsing",o),(l=$o.parseError)==null||l.call($o,o),a(o),r(o)})}),"performCall");ck.push(i),kne().catch(r)}),"parse"),Ene=ie((e,t,n)=>new Promise((r,i)=>{const s=ie(()=>new Promise((a,o)=>{qp.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;Lt.error("Error parsing",l),(c=$o.parseError)==null||c.call($o,l),o(l),i(l)})}),"performCall");ck.push(s),kne().catch(i)}),"render"),$o={startOnLoad:!0,mermaidAPI:qp,parse:e$e,render:Ene,init:XBe,run:_ne,registerExternalDiagrams:JBe,registerLayoutLoaders:Ote,initialize:Sne,parseError:void 0,contentLoaded:Cne,setParseErrorHandler:QBe,detectType:AP,registerIconPacks:y3e},t$e=$o;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const n$e=new DOMParser,r$e=new XMLSerializer;function A7(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const i of n.split(/\s+/)){const s=e.getElementById(i);s&&(r+=s.textContent)}return r}let R7=0;const i$e=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async i=>{const s=`${(t==null?void 0:t.prefix)??"mermaid"}-${R7}`;R7+=1;const{svg:a}=await t$e.render(s,i,n),o=n$e.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=A7(l,"aria-describedby"),h=A7(l,"aria-labelledby"),p={height:c,id:s,svg:r$e.serializeToString(l),width:u};return d&&(p.description=d),h&&(p.title=h),p}));return n.remove(),r},s$e=()=>i$e,a$e=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=dr(Cn(_=>({foldStreamingCodeBlocks:_.foldStreamingCodeBlocks}))),[r,i]=A.useState(t?n:!1),[s,a]=A.useState(null),[o,l]=A.useState(!1),[c,u]=A.useState(null),d=A.useRef(null),h=Ho(Cn(_=>Object.values(_.canvasControls))),p=A.useCallback((_,S,C,E,T)=>h.filter(R=>R.type==="codeblock"&&R.targetSlot===_&&R.renderer).map(R=>{if(R.renderer){const M={codeBlockContent:S,codeBlockLang:"mermaid",isFolded:E,toggleFold:T,canvasContextType:"codeblock"};return m.jsx(ut.Fragment,{children:R.renderer(M)},R.id)}return null}).filter(Boolean),[h]),y=A.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const S=await s$e()([e]);if(S.length>0&&S[0].status==="fulfilled")a(S[0].value.svg);else if(S.length>0&&S[0].status==="rejected"){const C=S[0].reason;u((C==null?void 0:C.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(_){console.error("Mermaid rendering error:",_),u(_ instanceof Error?_.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);A.useEffect(()=>{!r&&e.trim()&&y()},[e,r,y]);const b=()=>{const _=r;i(S=>!S),_&&setTimeout(y,0)},x=A.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),w=p("codeblock-header-actions",e,"mermaid",r,b);return m.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[m.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),m.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:w})]}),m.jsx("div",{})]}),!r&&m.jsxs("div",{className:"overflow-hidden w-full",children:[o&&m.jsxs("div",{className:"flex items-center justify-center p-8",children:[m.jsx(Hn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),m.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&m.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[m.jsx(nc,{className:"h-5 w-5 text-destructive flex-shrink-0"}),m.jsxs("div",{className:"text-sm text-destructive",children:[m.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),m.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),s&&!o&&!c&&m.jsx("div",{ref:d,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:s}})]}),r&&m.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:b,children:m.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:x})})]})},RD=A.memo(a$e),o$e=({markdownContent:e})=>{const t=DE(e);return e!=null&&e.trim()?m.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return m.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const i=n;return m.jsx(ty,{lang:i.lang,code:i.code,filepath:i.filepath},`code-${r}`)}else if(n.type==="mermaid"){const i=n;return m.jsx(RD,{code:i.code},`mermaid-${r}`)}return null})}):null},uT=ut.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0})=>{var b,x;const i=dr(w=>w.foldUserMessagesOnCompletion),[s,a]=A.useState(r&&i),[o,l]=A.useState(!1);A.useEffect(()=>{r&&i&&a(!0)},[r,i]);const c=t?UY(new Date(t),{addSuffix:!0}):"Sending...",u=((b=e.metadata)==null?void 0:b.attachedFiles)&&e.metadata.attachedFiles.length>0,d=e.content&&e.content.trim().length>0,h=A.useCallback(()=>a(w=>!w),[]),p=A.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),l(!0),Fe.success("User prompt copied!"),setTimeout(()=>l(!1),1500)}catch(w){Fe.error("Failed to copy prompt."),console.error("Clipboard copy failed:",w)}},[e.content]),y=A.useMemo(()=>{var _;let w="";return d&&(w+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),d&&u&&(w+=" + "),u&&(w+=`${(_=e.metadata.attachedFiles)==null?void 0:_.length} file(s)`),w||"[Empty Prompt]"},[d,u,e.content,e.metadata]);return m.jsxs("div",{className:dt("user-prompt relative group/user overflow-wrap-anywhere",n),children:[m.jsxs("div",{className:dt("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[m.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[m.jsx(Cpe,{className:"h-4 w-4 text-primary flex-shrink-0"}),m.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),m.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[d&&m.jsx(Rn,{tooltipText:"Copy Prompt",onClick:p,"aria-label":"Copy user prompt",icon:o?m.jsx(za,{className:"text-green-500"}):m.jsx(Fk,{}),className:"h-5 w-5"}),(d||u)&&m.jsx(Rn,{tooltipText:s?"Unfold":"Fold",onClick:h,"aria-label":s?"Unfold prompt":"Fold prompt",icon:s?m.jsx(cu,{}):m.jsx(ah,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),m.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:m.jsx("span",{className:"text-xs text-muted-foreground",children:c})})]}),!s&&m.jsxs(m.Fragment,{children:[u&&m.jsx("div",{className:"mb-2 space-y-1",children:(x=e.metadata.attachedFiles)==null?void 0:x.map(w=>m.jsx(DY,{fileMeta:w,isReadOnly:!0},w.id))}),m.jsx(o$e,{markdownContent:e.content})]}),s&&m.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:h,children:y})]})});uT.displayName="UserPromptDisplay";const l$e=(e,t,n,r,i)=>{if(typeof e=="string")return e.trim()?m.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null;if(e.type==="code"){const s=e,a=s.lang?`language-${s.lang}`:"language-plaintext";return n?m.jsx(ty,{lang:s.lang,code:s.code,filepath:s.filepath,isStreaming:r},`code-${t}`):m.jsxs("pre",{className:"code-block-container my-4 border border-border rounded-lg overflow-x-auto",children:[m.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border-b border-border bg-muted/50",children:m.jsx("div",{className:"text-sm font-medium",children:s.lang?s.lang.toUpperCase():"CODE"})}),m.jsx("code",{className:dt(a,"block p-4 font-mono text-sm leading-relaxed"),children:s.code})]},`pre-${t}`)}else if(e.type==="mermaid"){const s=e;return m.jsx(RD,{code:s.code,isStreaming:r},`mermaid-${t}`)}return null},c$e=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:i,enableStreamingCodeBlockParsing:s}=dr(Cn(p=>({enableStreamingMarkdown:p.enableStreamingMarkdown,enableStreamingCodeBlockParsing:p.enableStreamingCodeBlockParsing}))),a=DE(i?t:null),o=Ho(Cn(p=>Object.values(p.canvasControls))),l=A.useCallback((p,y)=>o.filter(b=>b.type==="tool-call-step"&&b.targetSlot===p&&b.renderer).map(b=>b.renderer?m.jsx(ut.Fragment,{children:b.renderer(y)},b.id):null).filter(Boolean),[o]),{toolCallStrings:c,toolResultStrings:u}=On(Cn(p=>{var b,x;const y=p.interactions.find(w=>w.id===e);return{toolCallStrings:(b=y==null?void 0:y.metadata)==null?void 0:b.toolCalls,toolResultStrings:(x=y==null?void 0:y.metadata)==null?void 0:x.toolResults}})),d=A.useMemo(()=>{if(!c)return[];try{const p=c.map(b=>JSON.parse(b)),y=(u==null?void 0:u.map(b=>JSON.parse(b)))??[];return p.map(b=>{const x=y.find(w=>w.toolCallId===b.toolCallId);return{call:b,result:x}})}catch(p){return console.error("[StreamingContentView] Error parsing tool call/result strings:",p),[]}},[c,u]),h=A.useMemo(()=>i?a.map((p,y)=>l$e(p,y,s,n&&y===a.length-1)).filter(Boolean):[],[i,a,s,n,e]);return!i&&!t&&d.length===0?n?m.jsx("div",{className:dt("text-muted-foreground italic",r),children:"Generating response..."}):null:m.jsxs("div",{className:dt("streaming-content-view overflow-wrap-anywhere",r),children:[d.map(({call:p,result:y},b)=>{const x={interactionId:e,toolCall:p,toolResult:y,canvasContextType:"tool-call-step"};return m.jsx(ut.Fragment,{children:l("tool-call-content",x)},`tool-step-${p.toolCallId||b}`)}),i?h:t?m.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new qo().render(t)}}):null]})},u$e=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":i="Stop Generation"})=>m.jsx(Rn,{tooltipText:"Stop",onClick:e,"aria-label":i,icon:m.jsx(ppe,{}),variant:r,size:n,className:t}),d$e=Symbol("Let zodToJsonSchema decide on which parser to use"),I7={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},f$e=e=>typeof e=="string"?{...I7,name:e}:{...I7,...e},h$e=e=>{const t=f$e(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,i])=>[i._def,{def:i._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function Tne(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function ci(e,t,n,r,i){e[t]=n,Tne(e,t,r,i)}function p$e(){return{}}function m$e(e,t){var r,i,s;const n={type:"array"};return(r=e.type)!=null&&r._def&&((s=(i=e.type)==null?void 0:i._def)==null?void 0:s.typeName)!==Gt.ZodAny&&(n.items=Jr(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&ci(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&ci(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(ci(n,"minItems",e.exactLength.value,e.exactLength.message,t),ci(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function g$e(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?ci(n,"minimum",r.value,r.message,t):ci(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ci(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ci(n,"maximum",r.value,r.message,t):ci(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ci(n,"maximum",r.value,r.message,t));break;case"multipleOf":ci(n,"multipleOf",r.value,r.message,t);break}return n}function y$e(){return{type:"boolean"}}function Ane(e,t){return Jr(e.type._def,t)}const b$e=(e,t)=>Jr(e.innerType._def,t);function Rne(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((i,s)=>Rne(e,t,i))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return v$e(e,t)}}const v$e=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":ci(n,"minimum",r.value,r.message,t);break;case"max":ci(n,"maximum",r.value,r.message,t);break}return n};function x$e(e,t){return{...Jr(e.innerType._def,t),default:e.defaultValue()}}function w$e(e,t){return t.effectStrategy==="input"?Jr(e.schema._def,t):{}}function _$e(e){return{type:"string",enum:Array.from(e.values)}}const S$e=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function C$e(e,t){const n=[Jr(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),Jr(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(s=>!!s);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const i=[];return n.forEach(s=>{if(S$e(s))i.push(...s.allOf),s.unevaluatedProperties===void 0&&(r=void 0);else{let a=s;if("additionalProperties"in s&&s.additionalProperties===!1){const{additionalProperties:o,...l}=s;a=l}else r=void 0;i.push(a)}}),i.length?{allOf:i,...r}:void 0}function k$e(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let fN;const Fl={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(fN===void 0&&(fN=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),fN),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function Ine(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":ci(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":ci(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":Ll(n,"email",r.message,t);break;case"format:idn-email":Ll(n,"idn-email",r.message,t);break;case"pattern:zod":Oa(n,Fl.email,r.message,t);break}break;case"url":Ll(n,"uri",r.message,t);break;case"uuid":Ll(n,"uuid",r.message,t);break;case"regex":Oa(n,r.regex,r.message,t);break;case"cuid":Oa(n,Fl.cuid,r.message,t);break;case"cuid2":Oa(n,Fl.cuid2,r.message,t);break;case"startsWith":Oa(n,RegExp(`^${hN(r.value,t)}`),r.message,t);break;case"endsWith":Oa(n,RegExp(`${hN(r.value,t)}$`),r.message,t);break;case"datetime":Ll(n,"date-time",r.message,t);break;case"date":Ll(n,"date",r.message,t);break;case"time":Ll(n,"time",r.message,t);break;case"duration":Ll(n,"duration",r.message,t);break;case"length":ci(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),ci(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Oa(n,RegExp(hN(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&Ll(n,"ipv4",r.message,t),r.version!=="v4"&&Ll(n,"ipv6",r.message,t);break}case"base64url":Oa(n,Fl.base64url,r.message,t);break;case"jwt":Oa(n,Fl.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Oa(n,Fl.ipv4Cidr,r.message,t),r.version!=="v4"&&Oa(n,Fl.ipv6Cidr,r.message,t);break}case"emoji":Oa(n,Fl.emoji(),r.message,t);break;case"ulid":{Oa(n,Fl.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{Ll(n,"binary",r.message,t);break}case"contentEncoding:base64":{ci(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Oa(n,Fl.base64,r.message,t);break}}break}case"nanoid":Oa(n,Fl.nanoid,r.message,t)}return n}function hN(e,t){return t.patternStrategy==="escape"?T$e(e):e}const E$e=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function T$e(e){let t="";for(let n=0;n<e.length;n++)E$e.has(e[n])||(t+="\\"),t+=e[n];return t}function Ll(e,t,n,r){var i;e.format||(i=e.anyOf)!=null&&i.some(s=>s.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):ci(e,"format",t,n,r)}function Oa(e,t,n,r){var i;e.pattern||(i=e.allOf)!=null&&i.some(s=>s.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:M7(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):ci(e,"pattern",M7(t,r),n,r)}function M7(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let i="",s=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(s){i+=r[c],s=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(i+=r[c],i+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(i+=r[c],o=!0):i+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){i+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){i+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){i+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}i+=r[c],r[c]==="\\"?s=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return i}function Mne(e,t){var r,i,s,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===Gt.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:Jr(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:Jr(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((i=e.keyType)==null?void 0:i._def.typeName)===Gt.ZodString&&((s=e.keyType._def.checks)!=null&&s.length)){const{type:c,...u}=Ine(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===Gt.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===Gt.ZodBranded&&e.keyType._def.type._def.typeName===Gt.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=Ane(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function A$e(e,t){if(t.mapStrategy==="record")return Mne(e,t);const n=Jr(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=Jr(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function R$e(e){const t=e.values,r=Object.keys(e.values).filter(s=>typeof t[t[s]]!="number").map(s=>t[s]),i=Array.from(new Set(r.map(s=>typeof s)));return{type:i.length===1?i[0]==="string"?"string":"number":["string","number"],enum:r}}function I$e(){return{not:{}}}function M$e(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const uk={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function N$e(e,t){if(t.target==="openApi3")return N7(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in uk&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((i,s)=>{const a=uk[s._def.typeName];return a&&!i.includes(a)?[...i,a]:i},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((i,s)=>{const a=typeof s._def.value;switch(a){case"string":case"number":case"boolean":return[...i,a];case"bigint":return[...i,"integer"];case"object":if(s._def.value===null)return[...i,"null"];case"symbol":case"undefined":case"function":default:return i}},[]);if(r.length===n.length){const i=r.filter((s,a,o)=>o.indexOf(s)===a);return{type:i.length>1?i:i[0],enum:n.reduce((s,a)=>s.includes(a._def.value)?s:[...s,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,i)=>[...r,...i._def.values.filter(s=>!r.includes(s))],[])};return N7(e,t)}const N7=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,i)=>Jr(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${i}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function j$e(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:uk[e.innerType._def.typeName],nullable:!0}:{type:[uk[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=Jr(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Jr(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function O$e(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",Tne(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?ci(n,"minimum",r.value,r.message,t):ci(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ci(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ci(n,"maximum",r.value,r.message,t):ci(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ci(n,"maximum",r.value,r.message,t));break;case"multipleOf":ci(n,"multipleOf",r.value,r.message,t);break}return n}function P$e(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},i=[],s=e.shape();for(const o in s){let l=s[o];if(l===void 0||l._def===void 0)continue;let c=F$e(l);c&&n&&(l instanceof Zl&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=Jr(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||i.push(o))}i.length&&(r.required=i);const a=D$e(e,t);return a!==void 0&&(r.additionalProperties=a),r}function D$e(e,t){if(e.catchall._def.typeName!=="ZodNever")return Jr(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function F$e(e){try{return e.isOptional()}catch{return!0}}const L$e=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return Jr(e.innerType._def,t);const n=Jr(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},B$e=(e,t)=>{if(t.pipeStrategy==="input")return Jr(e.in._def,t);if(t.pipeStrategy==="output")return Jr(e.out._def,t);const n=Jr(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=Jr(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(i=>i!==void 0)}};function $$e(e,t){return Jr(e.type._def,t)}function z$e(e,t){const r={type:"array",uniqueItems:!0,items:Jr(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&ci(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&ci(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function U$e(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>Jr(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Jr(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>Jr(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function q$e(){return{not:{}}}function V$e(){return{}}const H$e=(e,t)=>Jr(e.innerType._def,t),W$e=(e,t,n)=>{switch(t){case Gt.ZodString:return Ine(e,n);case Gt.ZodNumber:return O$e(e,n);case Gt.ZodObject:return P$e(e,n);case Gt.ZodBigInt:return g$e(e,n);case Gt.ZodBoolean:return y$e();case Gt.ZodDate:return Rne(e,n);case Gt.ZodUndefined:return q$e();case Gt.ZodNull:return M$e(n);case Gt.ZodArray:return m$e(e,n);case Gt.ZodUnion:case Gt.ZodDiscriminatedUnion:return N$e(e,n);case Gt.ZodIntersection:return C$e(e,n);case Gt.ZodTuple:return U$e(e,n);case Gt.ZodRecord:return Mne(e,n);case Gt.ZodLiteral:return k$e(e,n);case Gt.ZodEnum:return _$e(e);case Gt.ZodNativeEnum:return R$e(e);case Gt.ZodNullable:return j$e(e,n);case Gt.ZodOptional:return L$e(e,n);case Gt.ZodMap:return A$e(e,n);case Gt.ZodSet:return z$e(e,n);case Gt.ZodLazy:return()=>e.getter()._def;case Gt.ZodPromise:return $$e(e,n);case Gt.ZodNaN:case Gt.ZodNever:return I$e();case Gt.ZodEffects:return w$e(e,n);case Gt.ZodAny:return p$e();case Gt.ZodUnknown:return V$e();case Gt.ZodDefault:return x$e(e,n);case Gt.ZodBranded:return Ane(e,n);case Gt.ZodReadonly:return H$e(e,n);case Gt.ZodCatch:return b$e(e,n);case Gt.ZodPipeline:return B$e(e,n);case Gt.ZodFunction:case Gt.ZodVoid:case Gt.ZodSymbol:return;default:return(r=>{})()}};function Jr(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==d$e)return l}if(r&&!n){const l=G$e(r,t);if(l!==void 0)return l}const i={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,i);const s=W$e(e,e.typeName,t),a=typeof s=="function"?Jr(s(),t):s;if(a&&Y$e(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return i.jsonSchema=a,l}return i.jsonSchema=a,a}const G$e=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:K$e(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},K$e=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},Y$e=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),Z$e=(e,t)=>{const n=h$e(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:Jr(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,i=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,s=Jr(e._def,i===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,i]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(s.title=a);const o=i===void 0?r?{...s,[n.definitionPath]:r}:s:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,i].join("/"),[n.definitionPath]:{...r,[i]:s}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Jx={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},Qx={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},ew={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},tw={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},nw={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},X$e=[Jx,Qx,ew,tw,nw];Jx.code+"",Qx.code+"",ew.code+"",tw.code+"",nw.code+"";Jx.name+"",Jx.code,Qx.name+"",Qx.code,ew.name+"",ew.code,tw.name+"",tw.code,nw.name+"",nw.code;X$e.map(e=>e.code);function J$e(e){const t=["ROOT"];let n=-1,r=null;function i(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function s(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":i(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{i(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{s(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,i(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{i(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&s(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?s(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function Q$e(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=Mp({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=Mp({text:J$e(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var e9e={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},t9e={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},n9e={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},r9e={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},i9e={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},s9e={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},a9e={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},o9e={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},l9e={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},c9e={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},u9e={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},d9e={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},f9e={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},h9e={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},p9e={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},m9e={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},dT=[e9e,t9e,n9e,r9e,i9e,s9e,a9e,o9e,l9e,c9e,u9e,d9e,f9e,h9e,p9e,m9e];Object.fromEntries(dT.map(e=>[e.code,e]));Object.fromEntries(dT.map(e=>[e.name,e.code]));dT.map(e=>e.code);function fa(e,t){const n=dT.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function g9e(e,t){var n;const r=(n=void 0)!=null?n:!1;return y9e(Z$e(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:i=>{const s=e.safeParse(i);return s.success?{success:!0,value:s.data}:{success:!1,error:s.error}}})}var e4=Symbol.for("vercel.ai.schema");function y9e(e,{validate:t}={}){return{[e4]:!0,_type:void 0,[P2]:!0,jsonSchema:e,validate:t}}function b9e(e){return typeof e=="object"&&e!==null&&e4 in e&&e[e4]===!0&&"jsonSchema"in e&&"validate"in e}function fT(e){return b9e(e)?e:g9e(e)}var v9e=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof Ig=="object"?Ig:{},yp="1.9.0",j7=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function x9e(e){var t=new Set([e]),n=new Set,r=e.match(j7);if(!r)return function(){return!1};var i={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(i.prerelease!=null)return function(l){return l===e};function s(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(j7);if(!c)return s(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||i.major!==u.major?s(l):i.major===0?i.minor===u.minor&&i.patch<=u.patch?a(l):s(l):i.minor<=u.minor?a(l):s(l)}}var w9e=x9e(yp),_9e=yp.split(".")[0],rw=Symbol.for("opentelemetry.js.api."+_9e),iw=v9e;function ID(e,t,n,r){var i;r===void 0&&(r=!1);var s=iw[rw]=(i=iw[rw])!==null&&i!==void 0?i:{version:yp};if(!r&&s[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(s.version!==yp){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+e+" does not match previously registered API v"+yp);return n.error(a.stack||a.message),!1}return s[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+yp+"."),!0}function sw(e){var t,n,r=(t=iw[rw])===null||t===void 0?void 0:t.version;if(!(!r||!w9e(r)))return(n=iw[rw])===null||n===void 0?void 0:n[e]}function MD(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+yp+".");var n=iw[rw];n&&delete n[e]}var S9e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s},C9e=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},k9e=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return cv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return cv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return cv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return cv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return cv("verbose",this._namespace,t)},e}();function cv(e,t,n){var r=sw("diag");if(r)return n.unshift(t),r[e].apply(r,C9e([],S9e(n),!1))}var Oo;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Oo||(Oo={}));function E9e(e,t){e<Oo.NONE?e=Oo.NONE:e>Oo.ALL&&(e=Oo.ALL),t=t||{};function n(r,i){var s=t[r];return typeof s=="function"&&e>=i?s.bind(t):function(){}}return{error:n("error",Oo.ERROR),warn:n("warn",Oo.WARN),info:n("info",Oo.INFO),debug:n("debug",Oo.DEBUG),verbose:n("verbose",Oo.VERBOSE)}}var T9e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s},A9e=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},R9e="diag",dk=function(){function e(){function t(i){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var o=sw("diag");if(o)return o[i].apply(o,A9e([],T9e(s),!1))}}var n=this,r=function(i,s){var a,o,l;if(s===void 0&&(s={logLevel:Oo.INFO}),i===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof s=="number"&&(s={logLevel:s});var u=sw("diag"),d=E9e((o=s.logLevel)!==null&&o!==void 0?o:Oo.INFO,i);if(u&&!s.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return ID("diag",d,n,!0)};n.setLogger=r,n.disable=function(){MD(R9e,n)},n.createComponentLogger=function(i){return new k9e(i)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function I9e(e){return Symbol.for(e)}var M9e=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,i){var s=new e(n._currentContext);return s._currentContext.set(r,i),s},n.deleteValue=function(r){var i=new e(n._currentContext);return i._currentContext.delete(r),i}}return e}(),N9e=new M9e,j9e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s},O9e=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},P9e=function(){function e(){}return e.prototype.active=function(){return N9e},e.prototype.with=function(t,n,r){for(var i=[],s=3;s<arguments.length;s++)i[s-3]=arguments[s];return n.call.apply(n,O9e([r],j9e(i),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),D9e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return s},F9e=function(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))},pN="context",L9e=new P9e,Nne=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return ID(pN,t,dk.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var i,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return(i=this._getContextManager()).with.apply(i,F9e([t,n,r],D9e(s),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return sw(pN)||L9e},e.prototype.disable=function(){this._getContextManager().disable(),MD(pN,dk.instance())},e}(),t4;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(t4||(t4={}));var jne="0000000000000000",One="00000000000000000000000000000000",B9e={traceId:One,spanId:jne,traceFlags:t4.NONE},Fv=function(){function e(t){t===void 0&&(t=B9e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),ND=I9e("OpenTelemetry Context Key SPAN");function jD(e){return e.getValue(ND)||void 0}function $9e(){return jD(Nne.getInstance().active())}function OD(e,t){return e.setValue(ND,t)}function z9e(e){return e.deleteValue(ND)}function U9e(e,t){return OD(e,new Fv(t))}function Pne(e){var t;return(t=jD(e))===null||t===void 0?void 0:t.spanContext()}var q9e=/^([0-9a-f]{32})$/i,V9e=/^[0-9a-f]{16}$/i;function H9e(e){return q9e.test(e)&&e!==One}function W9e(e){return V9e.test(e)&&e!==jne}function Dne(e){return H9e(e.traceId)&&W9e(e.spanId)}function G9e(e){return new Fv(e)}var mN=Nne.getInstance(),Fne=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=mN.active());var i=!!(n!=null&&n.root);if(i)return new Fv;var s=r&&Pne(r);return K9e(s)&&Dne(s)?new Fv(s):new Fv},e.prototype.startActiveSpan=function(t,n,r,i){var s,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(s=n,o=r):(s=n,a=r,o=i);var l=a??mN.active(),c=this.startSpan(t,s,l),u=OD(l,c);return mN.with(u,o,void 0,c)}},e}();function K9e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var Y9e=new Fne,Z9e=function(){function e(t,n,r,i){this._provider=t,this.name=n,this.version=r,this.options=i}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,i){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Y9e},e}(),X9e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new Fne},e}(),J9e=new X9e,O7=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var i;return(i=this.getDelegateTracer(t,n,r))!==null&&i!==void 0?i:new Z9e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:J9e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var i;return(i=this._delegate)===null||i===void 0?void 0:i.getTracer(t,n,r)},e}(),fk;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(fk||(fk={}));var gN="trace",Q9e=function(){function e(){this._proxyTracerProvider=new O7,this.wrapSpanContext=G9e,this.isSpanContextValid=Dne,this.deleteSpan=z9e,this.getSpan=jD,this.getActiveSpan=$9e,this.getSpanContext=Pne,this.setSpan=OD,this.setSpanContext=U9e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=ID(gN,this._proxyTracerProvider,dk.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return sw(gN)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){MD(gN,dk.instance()),this._proxyTracerProvider=new O7},e}(),eze=Q9e.getInstance(),tze=Object.defineProperty,PD=(e,t)=>{for(var n in t)tze(e,n,{get:t[n],enumerable:!0})};function hk(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function P7(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[i,s]of Object.entries(e))r[i]=s;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function D7({response:e,status:t,statusText:n,headers:r,stream:i}){e.writeHead(t??200,n,r);const s=i.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await s.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var Lne="AI_InvalidArgumentError",Bne=`vercel.ai.error.${Lne}`,nze=Symbol.for(Bne),$ne,Ul=class extends nr{constructor({parameter:e,value:t,message:n}){super({name:Lne,message:`Invalid argument for parameter ${e}: ${n}`}),this[$ne]=!0,this.parameter=e,this.value=t}static isInstance(e){return nr.hasMarker(e,Bne)}};$ne=nze;var zne="AI_RetryError",Une=`vercel.ai.error.${zne}`,rze=Symbol.for(Une),qne,F7=class extends nr{constructor({message:e,reason:t,errors:n}){super({name:zne,message:e}),this[qne]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return nr.hasMarker(e,Une)}};qne=rze;var ize=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>Vne(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function Vne(e,{maxRetries:t,delayInMs:n,backoffFactor:r},i=[]){try{return await e()}catch(s){if(ZS(s)||t===0)throw s;const a=nge(s),o=[...i,s],l=o.length;if(l>t)throw new F7({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(s instanceof Error&&gl.isInstance(s)&&s.isRetryable===!0&&l<=t)return await Qme(n),Vne(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?s:new F7({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function sze({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new Ul({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new Ul({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:ize({maxRetries:t})}}function n4({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function aze({model:e,settings:t,telemetry:n,headers:r}){var i;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((s,[a,o])=>(s[`ai.settings.${a}`]=o,s),{}),...Object.entries((i=n==null?void 0:n.metadata)!=null?i:{}).reduce((s,[a,o])=>(s[`ai.telemetry.metadata.${a}`]=o,s),{}),...Object.entries(r??{}).reduce((s,[a,o])=>(o!==void 0&&(s[`ai.request.headers.${a}`]=o),s),{})}}var oze={startSpan(){return kS},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(kS);if(typeof n=="function")return n(kS);if(typeof r=="function")return r(kS)}},kS={spanContext(){return lze},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},lze={traceId:"",spanId:"",traceFlags:0};function cze({isEnabled:e=!1,tracer:t}={}){return e?t||eze.getTracer("ai"):oze}function r4({name:e,tracer:t,attributes:n,fn:r,endWhenDone:i=!0}){return t.startActiveSpan(e,{attributes:n},async s=>{try{const a=await r(s);return i&&s.end(),a}catch(a){try{a instanceof Error?(s.recordException({name:a.name,message:a.message,stack:a.stack}),s.setStatus({code:fk.ERROR,message:a.message})):s.setStatus({code:fk.ERROR})}finally{s.end()}throw a}})}function Mg({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,i])=>{if(i===void 0)return n;if(typeof i=="object"&&"input"in i&&typeof i.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const s=i.input();return s===void 0?n:{...n,[r]:s}}if(typeof i=="object"&&"output"in i&&typeof i.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const s=i.output();return s===void 0?n:{...n,[r]:s}}return{...n,[r]:i}},{})}var uze=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Pf(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=Hk(this.base64Data)),this.uint8ArrayData}},dze=class extends uze{constructor(e){super(e),this.type="file"}},fze=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],hze=e=>{const t=typeof e=="string"?Hk(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function pze(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?hze(e):e}function mze({data:e,signatures:t}){const n=pze(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((i,s)=>n[s]===i))return r.mimeType}var Hne="AI_NoObjectGeneratedError",Wne=`vercel.ai.error.${Hne}`,gze=Symbol.for(Wne),Gne,L7=class extends nr{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:i,finishReason:s}){super({name:Hne,message:e,cause:t}),this[Gne]=!0,this.text=n,this.response=r,this.usage=i,this.finishReason=s}static isInstance(e){return nr.hasMarker(e,Wne)}};Gne=gze;var Kne="AI_DownloadError",Yne=`vercel.ai.error.${Kne}`,yze=Symbol.for(Yne),Zne,yN=class extends nr{constructor({url:e,statusCode:t,statusText:n,cause:r,message:i=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:Kne,message:i,cause:r}),this[Zne]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return nr.hasMarker(e,Yne)}};Zne=yze;async function bze({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new yN({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw yN.isInstance(r)?r:new yN({url:n,cause:r})}}var Xne="AI_InvalidDataContentError",Jne=`vercel.ai.error.${Xne}`,vze=Symbol.for(Jne),Qne,B7=class extends nr{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:Xne,message:n,cause:t}),this[Qne]=!0,this.content=e}static isInstance(e){return nr.hasMarker(e,Jne)}};Qne=vze;var ere=L.union([L.string(),L.instanceof(Uint8Array),L.instanceof(ArrayBuffer),L.custom(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function DD(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Pf(new Uint8Array(e)):Pf(e)}function pk(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return Hk(e)}catch(t){throw new B7({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new B7({content:e})}function xze(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var tre="AI_InvalidMessageRoleError",nre=`vercel.ai.error.${tre}`,wze=Symbol.for(nre),rre,_ze=class extends nr{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:tre,message:t}),this[rre]=!0,this.role=e}static isInstance(e){return nr.hasMarker(e,nre)}};rre=wze;function Sze(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function Cze({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=bze}){const i=await Eze(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(s=>kze(s,i))]}function kze(e,t){var n,r,i,s,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>Tze(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:DD(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new _ze({role:c})}}}async function Eze(e,t,n,r){const i=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),s=await Promise.all(i.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(s.map(({url:a,data:o})=>[a.toString(),o]))}function Tze(e,t){var n,r,i,s;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=Sze(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=pk(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=pk(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=mze({data:c,signatures:fze}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?DD(c):c,filename:e.filename,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata}}}}function Aze({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:i,frequencyPenalty:s,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new Ul({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new Ul({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new Ul({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new Ul({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new Ul({parameter:"topK",value:r,message:"topK must be a number"});if(i!=null&&typeof i!="number")throw new Ul({parameter:"presencePenalty",value:i,message:"presencePenalty must be a number"});if(s!=null&&typeof s!="number")throw new Ul({parameter:"frequencyPenalty",value:s,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new Ul({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:i,frequencyPenalty:s,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function $7(e){var t,n,r;const i=[];for(const s of e){let a;try{a=new URL(s.url)}catch{throw new Error(`Invalid URL: ${s.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=s.contentType)!=null&&t.startsWith("image/"))i.push({type:"image",image:a});else{if(!s.contentType)throw new Error("If the attachment is not an image, it must specify a content type");i.push({type:"file",data:a,mimeType:s.contentType})}break}case"data:":{let o,l,c;try{[o,l]=s.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${s.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${s.url}`);if((n=s.contentType)!=null&&n.startsWith("image/"))i.push({type:"image",image:pk(l)});else if((r=s.contentType)!=null&&r.startsWith("text/"))i.push({type:"text",text:xze(pk(l))});else{if(!s.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");i.push({type:"file",data:l,mimeType:s.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return i}var ire="AI_MessageConversionError",sre=`vercel.ai.error.${ire}`,Rze=Symbol.for(sre),are,bN=class extends nr{constructor({originalMessage:e,message:t}){super({name:ire,message:t}),this[are]=!0,this.originalMessage=e}static isInstance(e){return nr.hasMarker(e,sre)}};are=Rze;function Ize(e,t){var n,r;const i=(n=t==null?void 0:t.tools)!=null?n:{},s=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{s.push({role:"system",content:u});break}case"user":{if(o.parts==null)s.push({role:"user",content:d?[{type:"text",text:u},...$7(d)]:u});else{const h=o.parts.filter(p=>p.type==="text").map(p=>({type:"text",text:p.text}));s.push({role:"user",content:d?[...h,...$7(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const _=[];for(const C of w)switch(C.type){case"file":case"text":{_.push(C);break}case"reasoning":{for(const E of C.details)switch(E.type){case"text":_.push({type:"reasoning",text:E.text,signature:E.signature});break;case"redacted":_.push({type:"redacted-reasoning",data:E.data});break}break}case"tool-invocation":_.push({type:"tool-call",toolCallId:C.toolInvocation.toolCallId,toolName:C.toolInvocation.toolName,args:C.toolInvocation.args});break;default:{const E=C;throw new Error(`Unsupported part: ${E}`)}}s.push({role:"assistant",content:_});const S=w.filter(C=>C.type==="tool-invocation").map(C=>C.toolInvocation);S.length>0&&s.push({role:"tool",content:S.map(C=>{if(!("result"in C))throw new bN({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(C)});const{toolCallId:E,toolName:T,result:R}=C,M=i[T];return(M==null?void 0:M.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:E,toolName:T,result:M.experimental_toToolResultContent(R),experimental_content:M.experimental_toToolResultContent(R)}:{type:"tool-result",toolCallId:E,toolName:T,result:R}})}),w=[],x=!1,b++},b=0,x=!1,w=[];for(const _ of o.parts)switch(_.type){case"text":{x&&y(),w.push(_);break}case"file":case"reasoning":{w.push(_);break}case"tool-invocation":{((r=_.toolInvocation.step)!=null?r:0)!==b&&y(),w.push(_),x=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){s.push({role:"assistant",content:u});break}const p=h.reduce((y,b)=>{var x;return Math.max(y,(x=b.step)!=null?x:0)},0);for(let y=0;y<=p;y++){const b=h.filter(x=>{var w;return((w=x.step)!=null?w:0)===y});b.length!==0&&(s.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:x,toolName:w,args:_})=>({type:"tool-call",toolCallId:x,toolName:w,args:_}))]}),s.push({role:"tool",content:b.map(x=>{if(!("result"in x))throw new bN({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(x)});const{toolCallId:w,toolName:_,result:S}=x,C=i[_];return(C==null?void 0:C.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:w,toolName:_,result:C.experimental_toToolResultContent(S),experimental_content:C.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:w,toolName:_,result:S}})}))}u&&!l&&s.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new bN({originalMessage:o,message:`Unsupported role: ${h}`})}}}return s}var i4=L.lazy(()=>L.union([L.null(),L.string(),L.number(),L.boolean(),L.record(L.string(),i4),L.array(i4)])),Gi=L.record(L.string(),L.record(L.string(),i4)),Mze=L.array(L.union([L.object({type:L.literal("text"),text:L.string()}),L.object({type:L.literal("image"),data:L.string(),mimeType:L.string().optional()})])),ore=L.object({type:L.literal("text"),text:L.string(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Nze=L.object({type:L.literal("image"),image:L.union([ere,L.instanceof(URL)]),mimeType:L.string().optional(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),lre=L.object({type:L.literal("file"),data:L.union([ere,L.instanceof(URL)]),filename:L.string().optional(),mimeType:L.string(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),jze=L.object({type:L.literal("reasoning"),text:L.string(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Oze=L.object({type:L.literal("redacted-reasoning"),data:L.string(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Pze=L.object({type:L.literal("tool-call"),toolCallId:L.string(),toolName:L.string(),args:L.unknown(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Dze=L.object({type:L.literal("tool-result"),toolCallId:L.string(),toolName:L.string(),result:L.unknown(),content:Mze.optional(),isError:L.boolean().optional(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Fze=L.object({role:L.literal("system"),content:L.string(),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Lze=L.object({role:L.literal("user"),content:L.union([L.string(),L.array(L.union([ore,Nze,lre]))]),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),Bze=L.object({role:L.literal("assistant"),content:L.union([L.string(),L.array(L.union([ore,lre,jze,Oze,Pze]))]),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),$ze=L.object({role:L.literal("tool"),content:L.array(Dze),providerOptions:Gi.optional(),experimental_providerMetadata:Gi.optional()}),zze=L.union([Fze,Lze,Bze,$ze]);function Uze({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new Lc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new Lc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new Lc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new Lc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=qze(e.messages)==="ui-messages"?Ize(e.messages,{tools:t}):e.messages;if(r.length===0)throw new Lc({prompt:e,message:"messages must not be empty"});const i=Y0({value:r,schema:L.array(zze)});if(!i.success)throw new Lc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${i.error.message}`].join(`
`),cause:i.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function qze(e){if(!Array.isArray(e))throw new Lc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(Vze);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new Lc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function Vze(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Hze({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function Wze(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var Gze="JSON schema:",Kze="You MUST answer with a JSON object that matches the JSON schema above.",Yze="You MUST answer with JSON.";function Zze({prompt:e,schema:t,schemaPrefix:n=t!=null?Gze:void 0,schemaSuffix:r=t!=null?Kze:Yze}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(i=>i!=null).join(`
`)}function vN(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:i}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:i}}}},t}function Xze(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(Jze)}));return JSON.stringify(t)}function Jze(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?DD(e.image):e.image}:e}Kp({prefix:"aiobj",size:24});var eo=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function z7(){let e,t;return{promise:new Promise((r,i)=>{e=r,t=i}),resolve:e,reject:t}}function Qze(){let e=[],t=null,n=!1,r=z7();const i=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=z7(),await r.promise,i();try{const{value:s,done:a}=await e[0].read();a?(e.shift(),e.length>0?await i():n&&(t==null||t.close())):t==null||t.enqueue(s)}catch(s){t==null||t.error(s),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(s){t=s},pull:i,async cancel(){for(const s of e)await s.cancel();e=[],n=!0}}),addStream:s=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(s.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(s=>s.cancel()),e=[],t==null||t.close()}}}function e7e(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Kp({prefix:"aiobj",size:24});var cre="AI_NoOutputSpecifiedError",ure=`vercel.ai.error.${cre}`,t7e=Symbol.for(ure),dre,n7e=class extends nr{constructor({message:e="No output specified."}={}){super({name:cre,message:e}),this[dre]=!0}static isInstance(e){return nr.hasMarker(e,ure)}};dre=t7e;var fre="AI_ToolExecutionError",hre=`vercel.ai.error.${fre}`,r7e=Symbol.for(hre),pre,i7e=class extends nr{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:i=`Error executing tool ${t}: ${Aw(r)}`}){super({name:fre,message:i,cause:r}),this[pre]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return nr.hasMarker(e,hre)}};pre=r7e;function s7e(e){return e!=null&&Object.keys(e).length>0}function a7e({tools:e,toolChoice:t,activeTools:n}){return s7e(e)?{tools:(n!=null?Object.entries(e).filter(([i])=>n.includes(i)):Object.entries(e)).map(([i,s])=>{const a=s.type;switch(a){case void 0:case"function":return{type:"function",name:i,description:s.description,parameters:fT(s.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:i,id:s.id,args:s.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var o7e=/^([\s\S]*?)(\s+)(\S*)$/;function l7e(e){const t=e.match(o7e);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var mre="AI_InvalidToolArgumentsError",gre=`vercel.ai.error.${mre}`,c7e=Symbol.for(gre),yre,bre=class extends nr{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${Aw(n)}`}){super({name:mre,message:r,cause:n}),this[yre]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return nr.hasMarker(e,gre)}};yre=c7e;var vre="AI_NoSuchToolError",xre=`vercel.ai.error.${vre}`,u7e=Symbol.for(xre),wre,s4=class extends nr{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:vre,message:n}),this[wre]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return nr.hasMarker(e,xre)}};wre=u7e;var _re="AI_ToolCallRepairError",Sre=`vercel.ai.error.${_re}`,d7e=Symbol.for(Sre),Cre,f7e=class extends nr{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${Aw(e)}`}){super({name:_re,message:n,cause:e}),this[Cre]=!0,this.originalError=t}static isInstance(e){return nr.hasMarker(e,Sre)}};Cre=d7e;async function h7e({toolCall:e,tools:t,repairToolCall:n,system:r,messages:i}){if(t==null)throw new s4({toolName:e.toolName});try{return await U7({toolCall:e,tools:t})}catch(s){if(n==null||!(s4.isInstance(s)||bre.isInstance(s)))throw s;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>fT(t[o].parameters).jsonSchema,system:r,messages:i,error:s})}catch(o){throw new f7e({cause:o,originalError:s})}if(a==null)throw s;return await U7({toolCall:a,tools:t})}}async function U7({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new s4({toolName:e.toolName,availableTools:Object.keys(t)});const i=fT(r.parameters),s=e.args.trim()===""?Y0({value:{},schema:i}):Mp({text:e.args,schema:i});if(s.success===!1)throw new bre({toolName:n,toolArgs:e.args,cause:s.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:s.value}}function p7e(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function q7({text:e="",files:t,reasoning:n,tools:r,toolCalls:i,toolResults:s,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),i.length>0&&c.push(...i),c.length>0&&l.push({role:"assistant",content:c,id:a}),s.length>0&&l.push({role:"tool",id:o(),content:s.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Kp({prefix:"aitxt",size:24});Kp({prefix:"msg",size:24});var m7e={};PD(m7e,{object:()=>v7e,text:()=>b7e});var kre="AI_InvalidStreamPartError",Ere=`vercel.ai.error.${kre}`,g7e=Symbol.for(Ere),Tre,y7e=class extends nr{constructor({chunk:e,message:t}){super({name:kre,message:t}),this[Tre]=!0,this.chunk=e}static isInstance(e){return nr.hasMarker(e,Ere)}};Tre=g7e;var b7e=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),v7e=({schema:e})=>{const t=fT(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:Zze({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=Q$e(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const i=r.state;throw new Error(`Unsupported parse state: ${i}`)}}},parseOutput({text:n},r){const i=Mp({text:n});if(!i.success)throw new L7({message:"No object generated: could not parse the response.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const s=Y0({value:i.value,schema:t});if(!s.success)throw new L7({message:"No object generated: response did not match schema.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return s.value}}};function x7e(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function w7e({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function FD(e,t){const n=e.getReader(),r=t.getReader();let i,s,a=!1,o=!1;async function l(u){try{i==null&&(i=n.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{s==null&&(s=r.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}i==null&&(i=n.read()),s==null&&(s=r.read());const{result:d,reader:h}=await Promise.race([i.then(p=>({result:p,reader:n})),s.then(p=>({result:p,reader:r}))]);d.done||u.enqueue(d.value),h===n?(i=void 0,d.done&&(await c(u),a=!0)):(s=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function _7e({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:i,system:s,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(w){c=w}}),d={},h=new Set;let p=!1,y;function b(){p&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const x=new TransformStream({async transform(w,_){const S=w.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{_.enqueue(w);break}case"file":{_.enqueue(new dze({data:w.data,mimeType:w.mimeType}));break}case"tool-call-delta":{n&&(d[w.toolCallId]||(_.enqueue({type:"tool-call-streaming-start",toolCallId:w.toolCallId,toolName:w.toolName}),d[w.toolCallId]=!0),_.enqueue({type:"tool-call-delta",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.argsTextDelta}));break}case"tool-call":{try{const C=await h7e({toolCall:w,tools:e,repairToolCall:l,system:s,messages:a});_.enqueue(C);const E=e[C.toolName];if(E.execute!=null){const T=ro();h.add(T),r4({name:"ai.toolCall",attributes:Mg({telemetry:i,attributes:{...n4({operationId:"ai.toolCall",telemetry:i}),"ai.toolCall.name":C.toolName,"ai.toolCall.id":C.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(C.args)}}}),tracer:r,fn:async R=>E.execute(C.args,{toolCallId:C.toolCallId,messages:a,abortSignal:o}).then(M=>{c.enqueue({...C,type:"tool-result",result:M}),h.delete(T),b();try{R.setAttributes(Mg({telemetry:i,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(M)}}}))}catch{}},M=>{c.enqueue({type:"error",error:new i7e({toolCallId:C.toolCallId,toolName:C.toolName,toolArgs:C.args,cause:M})}),h.delete(T),b()})})}}catch(C){c.enqueue({type:"error",error:C})}break}case"finish":{y={type:"finish",finishReason:w.finishReason,logprobs:w.logprobs,usage:Hze(w.usage),experimental_providerMetadata:w.providerMetadata};break}default:{const C=S;throw new Error(`Unhandled chunk type: ${C}`)}}},flush(){p=!0,b()}});return new ReadableStream({async start(w){return Promise.all([t.pipeThrough(x).pipeTo(new WritableStream({write(_){w.enqueue(_)},close(){}})),u.pipeTo(new WritableStream({write(_){w.enqueue(_)},close(){w.close()}}))])}})}var S7e=Kp({prefix:"aitxt",size:24}),C7e=Kp({prefix:"msg",size:24});function k7e({model:e,tools:t,toolChoice:n,system:r,prompt:i,messages:s,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=C7e,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:p,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:x=!1,toolCallStreaming:w=x,experimental_activeTools:_,experimental_repairToolCall:S,experimental_transform:C,onChunk:E,onError:T,onFinish:R,onStepFinish:M,_internal:{now:N=e7e,generateId:O=S7e,currentDate:B=()=>new Date}={},...P}){return new T7e({model:e,telemetry:p,headers:l,settings:P,maxRetries:a,abortSignal:o,system:r,prompt:i,messages:s,tools:t,toolChoice:n,toolCallStreaming:w,transforms:x7e(C),activeTools:_,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:E,onError:T,onFinish:R,onStepFinish:M,now:N,currentDate:B,generateId:O,generateMessageId:u})}function E7e(e){if(!e)return new TransformStream({transform(s,a){a.enqueue({part:s,partialOutput:void 0})}});let t="",n="",r="";function i({controller:s,partialOutput:a=void 0}){s.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(s,a){if(s.type==="step-finish"&&i({controller:a}),s.type!=="text-delta"){a.enqueue({part:s,partialOutput:void 0});return}t+=s.textDelta,n+=s.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(i({controller:a,partialOutput:o.partial}),r=l)}},flush(s){n.length>0&&i({controller:s})}})}var T7e=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:i,abortSignal:s,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:p,repairToolCall:y,maxSteps:b,output:x,continueSteps:w,providerOptions:_,now:S,currentDate:C,generateId:E,generateMessageId:T,onChunk:R,onError:M,onFinish:N,onStepFinish:O}){this.warningsPromise=new eo,this.usagePromise=new eo,this.finishReasonPromise=new eo,this.providerMetadataPromise=new eo,this.textPromise=new eo,this.reasoningPromise=new eo,this.reasoningDetailsPromise=new eo,this.sourcesPromise=new eo,this.filesPromise=new eo,this.toolCallsPromise=new eo,this.toolResultsPromise=new eo,this.requestPromise=new eo,this.responsePromise=new eo,this.stepsPromise=new eo;var B;if(b<1)throw new Ul({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=x;let P="",H="",F="",Q=[],q=[],K,U=[];const re=[],G={id:E(),timestamp:C(),modelId:e.modelId,messages:[]};let ne=[],te=[],se,pe,de="initial";const Ne=[];let Pe;const Me=new TransformStream({async transform(ce,le){le.enqueue(ce);const{part:ae}=ce;if((ae.type==="text-delta"||ae.type==="reasoning"||ae.type==="source"||ae.type==="tool-call"||ae.type==="tool-result"||ae.type==="tool-call-streaming-start"||ae.type==="tool-call-delta")&&await(R==null?void 0:R({chunk:ae})),ae.type==="error"&&await(M==null?void 0:M({error:ae.error})),ae.type==="text-delta"&&(P+=ae.textDelta,H+=ae.textDelta,F+=ae.textDelta),ae.type==="reasoning"&&(K==null?(K={type:"text",text:ae.textDelta},Q.push(K)):K.text+=ae.textDelta),ae.type==="reasoning-signature"){if(K==null)throw new nr({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});K.signature=ae.signature,K=void 0}if(ae.type==="redacted-reasoning"&&Q.push({type:"redacted",data:ae.data}),ae.type==="file"&&q.push(ae),ae.type==="source"&&(re.push(ae.source),U.push(ae.source)),ae.type==="tool-call"&&ne.push(ae),ae.type==="tool-result"&&te.push(ae),ae.type==="step-finish"){const Te=q7({text:H,files:q,reasoning:Q,tools:c??{},toolCalls:ne,toolResults:te,messageId:ae.messageId,generateMessageId:T}),$e=Ne.length;let ke="done";$e+1<b&&(w&&ae.finishReason==="length"&&ne.length===0?ke="continue":ne.length>0&&te.length===ne.length&&(ke="tool-result"));const ot={stepType:de,text:P,reasoning:p7e(Q),reasoningDetails:Q,files:q,sources:U,toolCalls:ne,toolResults:te,finishReason:ae.finishReason,usage:ae.usage,warnings:ae.warnings,logprobs:ae.logprobs,request:ae.request,response:{...ae.response,messages:[...G.messages,...Te]},providerMetadata:ae.experimental_providerMetadata,experimental_providerMetadata:ae.experimental_providerMetadata,isContinued:ae.isContinued};await(O==null?void 0:O(ot)),Ne.push(ot),ne=[],te=[],P="",U=[],Q=[],q=[],K=void 0,ke!=="done"&&(de=ke),ke!=="continue"&&(G.messages.push(...Te),H="")}ae.type==="finish"&&(G.id=ae.response.id,G.timestamp=ae.response.timestamp,G.modelId=ae.response.modelId,G.headers=ae.response.headers,pe=ae.usage,se=ae.finishReason)},async flush(ce){var le;try{if(Ne.length===0)return;const ae=Ne[Ne.length-1];Re.warningsPromise.resolve(ae.warnings),Re.requestPromise.resolve(ae.request),Re.responsePromise.resolve(ae.response),Re.toolCallsPromise.resolve(ae.toolCalls),Re.toolResultsPromise.resolve(ae.toolResults),Re.providerMetadataPromise.resolve(ae.experimental_providerMetadata),Re.reasoningPromise.resolve(ae.reasoning),Re.reasoningDetailsPromise.resolve(ae.reasoningDetails);const Te=se??"unknown",$e=pe??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Re.finishReasonPromise.resolve(Te),Re.usagePromise.resolve($e),Re.textPromise.resolve(F),Re.sourcesPromise.resolve(re),Re.filesPromise.resolve(ae.files),Re.stepsPromise.resolve(Ne),await(N==null?void 0:N({finishReason:Te,logprobs:void 0,usage:$e,text:F,reasoning:ae.reasoning,reasoningDetails:ae.reasoningDetails,files:ae.files,sources:ae.sources,toolCalls:ae.toolCalls,toolResults:ae.toolResults,request:(le=ae.request)!=null?le:{},response:ae.response,warnings:ae.warnings,providerMetadata:ae.providerMetadata,experimental_providerMetadata:ae.experimental_providerMetadata,steps:Ne})),Pe.setAttributes(Mg({telemetry:t,attributes:{"ai.response.finishReason":Te,"ai.response.text":{output:()=>F},"ai.response.toolCalls":{output:()=>{var ke;return(ke=ae.toolCalls)!=null&&ke.length?JSON.stringify(ae.toolCalls):void 0}},"ai.usage.promptTokens":$e.promptTokens,"ai.usage.completionTokens":$e.completionTokens}}))}catch(ae){ce.error(ae)}finally{Pe.end()}}}),Ee=Qze();this.addStream=Ee.addStream,this.closeStream=Ee.close;let Ue=Ee.stream;for(const ce of h)Ue=Ue.pipeThrough(ce({tools:c,stopStream(){Ee.terminate()}}));this.baseStream=Ue.pipeThrough(E7e(x)).pipeThrough(Me);const{maxRetries:nt,retry:He}=sze({maxRetries:i}),je=cze(t),Y=aze({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:nt}}),be=Uze({prompt:{system:(B=x==null?void 0:x.injectIntoSystemPrompt({system:a,model:e}))!=null?B:a,prompt:o,messages:l},tools:c}),Re=this;r4({name:"ai.streamText",attributes:Mg({telemetry:t,attributes:{...n4({operationId:"ai.streamText",telemetry:t}),...Y,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:je,endWhenDone:!1,fn:async ce=>{Pe=ce;async function le({currentStep:ae,responseMessages:Te,usage:$e,stepType:ke,previousStepText:ot,hasLeadingWhitespace:At,messageId:ft}){var jt;const Bt=Te.length===0?be.type:"messages",Ft=[...be.messages,...Te],tn=await Cze({prompt:{type:Bt,system:be.system,messages:Ft},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(jt=e.supportsUrl)==null?void 0:jt.bind(e)}),xe={type:"regular",...a7e({tools:c,toolChoice:u,activeTools:p})},{result:{stream:D,warnings:X,rawResponse:me,request:De},doStreamSpan:we,startTimestampMs:Ie}=await He(()=>r4({name:"ai.streamText.doStream",attributes:Mg({telemetry:t,attributes:{...n4({operationId:"ai.streamText.doStream",telemetry:t}),...Y,"ai.prompt.format":{input:()=>Bt},"ai.prompt.messages":{input:()=>Xze(tn)},"ai.prompt.tools":{input:()=>{var Yt;return(Yt=xe.tools)==null?void 0:Yt.map(Qt=>JSON.stringify(Qt))}},"ai.prompt.toolChoice":{input:()=>xe.toolChoice!=null?JSON.stringify(xe.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:je,endWhenDone:!1,fn:async Yt=>({startTimestampMs:S(),doStreamSpan:Yt,result:await e.doStream({mode:xe,...Aze(r),inputFormat:Bt,responseFormat:x==null?void 0:x.responseFormat({model:e}),prompt:tn,providerMetadata:_,abortSignal:s,headers:n})})})),fe=_7e({tools:c,generatorStream:D,toolCallStreaming:d,tracer:je,telemetry:t,system:a,messages:Ft,repairToolCall:y,abortSignal:s}),yt=De??{},_t=[],z=[],qe=[],rt=[];let ve,Se="unknown",ze={promptTokens:0,completionTokens:0,totalTokens:0},Tt,ge=!0,Z="",W=ke==="continue"?ot:"",J,ye={id:E(),timestamp:C(),modelId:e.modelId},Oe="",We=!1,vt=!0,Xt=!1;async function jn({controller:Yt,chunk:Qt}){Yt.enqueue(Qt),Z+=Qt.textDelta,W+=Qt.textDelta,We=!0,Xt=Qt.textDelta.trimEnd()!==Qt.textDelta}Re.addStream(fe.pipeThrough(new TransformStream({async transform(Yt,Qt){var on,or,xr;if(ge){const Kr=S()-Ie;ge=!1,we.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":Kr}),we.setAttributes({"ai.response.msToFirstChunk":Kr}),Qt.enqueue({type:"step-start",messageId:ft,request:yt,warnings:X??[]})}if(Yt.type==="text-delta"&&Yt.textDelta.length===0)return;const Gr=Yt.type;switch(Gr){case"text-delta":{if(w){const Kr=vt&&At?Yt.textDelta.trimStart():Yt.textDelta;if(Kr.length===0)break;vt=!1,Oe+=Kr;const pr=l7e(Oe);pr!=null&&(Oe=pr.suffix,await jn({controller:Qt,chunk:{type:"text-delta",textDelta:pr.prefix+pr.whitespace}}))}else await jn({controller:Qt,chunk:Yt});break}case"reasoning":{Qt.enqueue(Yt),ve==null?(ve={type:"text",text:Yt.textDelta},qe.push(ve)):ve.text+=Yt.textDelta;break}case"reasoning-signature":{if(Qt.enqueue(Yt),ve==null)throw new y7e({chunk:Yt,message:"reasoning-signature without reasoning"});ve.signature=Yt.signature,ve=void 0;break}case"redacted-reasoning":{Qt.enqueue(Yt),qe.push({type:"redacted",data:Yt.data});break}case"tool-call":{Qt.enqueue(Yt),_t.push(Yt);break}case"tool-result":{Qt.enqueue(Yt),z.push(Yt);break}case"response-metadata":{ye={id:(on=Yt.id)!=null?on:ye.id,timestamp:(or=Yt.timestamp)!=null?or:ye.timestamp,modelId:(xr=Yt.modelId)!=null?xr:ye.modelId};break}case"finish":{ze=Yt.usage,Se=Yt.finishReason,Tt=Yt.experimental_providerMetadata,J=Yt.logprobs;const Kr=S()-Ie;we.addEvent("ai.stream.finish"),we.setAttributes({"ai.response.msToFinish":Kr,"ai.response.avgCompletionTokensPerSecond":1e3*ze.completionTokens/Kr});break}case"file":{rt.push(Yt),Qt.enqueue(Yt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{Qt.enqueue(Yt);break}case"error":{Qt.enqueue(Yt),Se="error";break}default:{const Kr=Gr;throw new Error(`Unknown chunk type: ${Kr}`)}}},async flush(Yt){const Qt=_t.length>0?JSON.stringify(_t):void 0;let on="done";ae+1<b&&(w&&Se==="length"&&_t.length===0?on="continue":_t.length>0&&z.length===_t.length&&(on="tool-result")),w&&Oe.length>0&&(on!=="continue"||ke==="continue"&&!We)&&(await jn({controller:Yt,chunk:{type:"text-delta",textDelta:Oe}}),Oe="");try{we.setAttributes(Mg({telemetry:t,attributes:{"ai.response.finishReason":Se,"ai.response.text":{output:()=>Z},"ai.response.toolCalls":{output:()=>Qt},"ai.response.id":ye.id,"ai.response.model":ye.modelId,"ai.response.timestamp":ye.timestamp.toISOString(),"ai.usage.promptTokens":ze.promptTokens,"ai.usage.completionTokens":ze.completionTokens,"gen_ai.response.finish_reasons":[Se],"gen_ai.response.id":ye.id,"gen_ai.response.model":ye.modelId,"gen_ai.usage.input_tokens":ze.promptTokens,"gen_ai.usage.output_tokens":ze.completionTokens}}))}catch{}finally{we.end()}Yt.enqueue({type:"step-finish",finishReason:Se,usage:ze,providerMetadata:Tt,experimental_providerMetadata:Tt,logprobs:J,request:yt,response:{...ye,headers:me==null?void 0:me.headers},warnings:X,isContinued:on==="continue",messageId:ft});const or=Wze($e,ze);if(on==="done")Yt.enqueue({type:"finish",finishReason:Se,usage:or,providerMetadata:Tt,experimental_providerMetadata:Tt,logprobs:J,response:{...ye,headers:me==null?void 0:me.headers}}),Re.closeStream();else{if(ke==="continue"){const xr=Te[Te.length-1];typeof xr.content=="string"?xr.content+=Z:xr.content.push({text:Z,type:"text"})}else Te.push(...q7({text:Z,files:rt,reasoning:qe,tools:c??{},toolCalls:_t,toolResults:z,messageId:ft,generateMessageId:T}));await le({currentStep:ae+1,responseMessages:Te,usage:or,stepType:on,previousStepText:W,hasLeadingWhitespace:Xt,messageId:on==="continue"?ft:T()})}}})))}await le({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:T()})}}).catch(ce=>{Re.addStream(new ReadableStream({start(le){le.enqueue({type:"error",error:ce}),le.close()}})),Re.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return vN(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return vN(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await w7e({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new n7e;return vN(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:i=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(s,a)=>{const o=s.type;switch(o){case"text-delta":{a.enqueue(fa("text",s.textDelta));break}case"reasoning":{n&&a.enqueue(fa("reasoning",s.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(fa("redacted_reasoning",{data:s.data}));break}case"reasoning-signature":{n&&a.enqueue(fa("reasoning_signature",{signature:s.signature}));break}case"file":{a.enqueue(fa("file",{mimeType:s.mimeType,data:s.base64}));break}case"source":{r&&a.enqueue(fa("source",s.source));break}case"tool-call-streaming-start":{a.enqueue(fa("tool_call_streaming_start",{toolCallId:s.toolCallId,toolName:s.toolName}));break}case"tool-call-delta":{a.enqueue(fa("tool_call_delta",{toolCallId:s.toolCallId,argsTextDelta:s.argsTextDelta}));break}case"tool-call":{a.enqueue(fa("tool_call",{toolCallId:s.toolCallId,toolName:s.toolName,args:s.args}));break}case"tool-result":{a.enqueue(fa("tool_result",{toolCallId:s.toolCallId,result:s.result}));break}case"error":{a.enqueue(fa("error",e(s.error)));break}case"step-start":{a.enqueue(fa("start_step",{messageId:s.messageId}));break}case"step-finish":{a.enqueue(fa("finish_step",{finishReason:s.finishReason,usage:t?{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens}:void 0,isContinued:s.isContinued}));break}case"finish":{i&&a.enqueue(fa("finish_message",{finishReason:s.finishReason,usage:t?{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:i,getErrorMessage:s,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){D7({response:e,status:t,statusText:n,headers:P7(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:i,getErrorMessage:s,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){D7({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:P7(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?FD(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:i,sendUsage:s,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:i,sendUsage:s,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:hk(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:hk(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}},A7e=L.object({name:L.string(),version:L.string()}).passthrough(),LD=L.object({_meta:L.optional(L.object({}).passthrough())}).passthrough(),aw=LD,R7e=L.object({method:L.string(),params:L.optional(LD)}),I7e=L.object({experimental:L.optional(L.object({}).passthrough()),logging:L.optional(L.object({}).passthrough()),prompts:L.optional(L.object({listChanged:L.optional(L.boolean())}).passthrough()),resources:L.optional(L.object({subscribe:L.optional(L.boolean()),listChanged:L.optional(L.boolean())}).passthrough()),tools:L.optional(L.object({listChanged:L.optional(L.boolean())}).passthrough())}).passthrough();aw.extend({protocolVersion:L.string(),capabilities:I7e,serverInfo:A7e,instructions:L.optional(L.string())});var M7e=aw.extend({nextCursor:L.optional(L.string())}),N7e=L.object({name:L.string(),description:L.optional(L.string()),inputSchema:L.object({type:L.literal("object"),properties:L.optional(L.object({}).passthrough())}).passthrough()}).passthrough();M7e.extend({tools:L.array(N7e)});var j7e=L.object({type:L.literal("text"),text:L.string()}).passthrough(),O7e=L.object({type:L.literal("image"),data:L.string().base64(),mimeType:L.string()}).passthrough(),Are=L.object({uri:L.string(),mimeType:L.optional(L.string())}).passthrough(),P7e=Are.extend({text:L.string()}),D7e=Are.extend({blob:L.string().base64()}),F7e=L.object({type:L.literal("resource"),resource:L.union([P7e,D7e])}).passthrough();aw.extend({content:L.array(L.union([j7e,O7e,F7e])),isError:L.boolean().default(!1).optional()}).or(aw.extend({toolResult:L.unknown()}));var hT="2.0",L7e=L.object({jsonrpc:L.literal(hT),id:L.union([L.string(),L.number().int()])}).merge(R7e).strict(),B7e=L.object({jsonrpc:L.literal(hT),id:L.union([L.string(),L.number().int()]),result:aw}).strict(),$7e=L.object({jsonrpc:L.literal(hT),id:L.union([L.string(),L.number().int()]),error:L.object({code:L.number().int(),message:L.string(),data:L.optional(L.unknown())})}).strict(),z7e=L.object({jsonrpc:L.literal(hT)}).merge(L.object({method:L.string(),params:L.optional(LD)})).strict();L.union([L7e,z7e,B7e,$7e]);var U7e={};PD(U7e,{mergeIntoDataStream:()=>H7e,toDataStream:()=>q7e,toDataStreamResponse:()=>V7e});function Rre(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,i){i.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function BD(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var i;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&V7((i=n.data)==null?void 0:i.chunk,r);return}V7(n,r)}})).pipeThrough(Rre(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(fa("text",n))}}))}function q7e(e,t){return BD(e,t).pipeThrough(new TextEncoderStream)}function V7e(e,t){var n;const r=BD(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),i=t==null?void 0:t.data,s=t==null?void 0:t.init,a=i?FD(i.stream,r):r;return new Response(a,{status:(n=s==null?void 0:s.status)!=null?n:200,statusText:s==null?void 0:s.statusText,headers:hk(s==null?void 0:s.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function H7e(e,t){t.dataStream.merge(BD(e,t.callbacks))}function V7(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var W7e={};PD(W7e,{mergeIntoDataStream:()=>Y7e,toDataStream:()=>G7e,toDataStreamResponse:()=>K7e});function $D(e,t){const n=Z7e();return Jme(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,i){i.enqueue(n(r.delta))}})).pipeThrough(Rre(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,i)=>{i.enqueue(fa("text",r))}}))}function G7e(e,t){return $D(e,t).pipeThrough(new TextEncoderStream)}function K7e(e,t={}){var n;const{init:r,data:i,callbacks:s}=t,a=$D(e,s).pipeThrough(new TextEncoderStream),o=i?FD(i.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:hk(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function Y7e(e,t){t.dataStream.merge($D(e,t.callbacks))}function Z7e(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class X7e{static async executeInteraction(t,n,r){let i,s=!1,a=null,o,l,c;try{i=await k7e(n);for await(const u of i.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"finish":s=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type}`,u);break}}i!=null&&i.reasoning?(c=await i.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&s?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!s&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const J7e=".litechat/conversations",Ire="/synced_repos";async function Q7e(e,t,n,r=!1){n(t.id,"syncing");const i=jr(`${Ire}/${t.id}`),s={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(iu(i,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||Fe.info(`Pulling latest changes for "${t.name}"...`),await RE(i,a,s,{fsInstance:e}),r||Fe.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||Fe.info(`Cloning repository "${t.name}"...`),await IY(i,t.remoteUrl,a,s,{fsInstance:e}),r||Fe.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function eUe(e,t,n,r,i,s,a,o=!1){var h,p;r(t.id,"syncing");const l=jr(`${Ire}/${n.id}`),c=iu(l,J7e,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(iu(l,".git"))}catch(_){if(_.code==="ENOENT"){Fe.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw _}o||Fe.info(`Pulling latest changes for "${n.name}"...`),await RE(l,d,u,{fsInstance:e});let y=null,b=null;try{const _=await yh(c,{fsInstance:e}),S=new TextDecoder().decode(_);y=JSON.parse(S),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(_){_.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${_.message}`),Fe.warning(`Could not read remote version of conversation: ${_.message}`))}const x=t.updatedAt.getTime(),w=((p=t.lastSyncedAt)==null?void 0:p.getTime())??0;if(!y||x>(b??0)||x>w&&x>=(b??0)){o||Fe.info("Local changes detected. Pushing to remote...");const _=await Rt.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...C}=t,E=JSON.stringify({conversation:C,interactions:_},null,2);await IE(c,E,{fsInstance:e}),await mP(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await gP(l,d,u,{fsInstance:e}),await i(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||Fe.success("Conversation synced successfully (pushed).")}else if(b&&b>x){o||Fe.info("Remote changes detected. Updating local conversation...");const _={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await Rt.saveConversation(_),await Rt.deleteInteractionsForConversation(t.id);const S=y.interactions.map(C=>Rt.saveInteraction({...C,conversationId:t.id,startedAt:C.startedAt?new Date(C.startedAt):null,endedAt:C.endedAt?new Date(C.endedAt):null}));await Promise.all(S),s()===t.id&&a()==="conversation"&&await On.getState().loadInteractions(t.id),r(t.id,"idle"),o||Fe.success("Conversation synced successfully (pulled).")}else o||Fe.info("Conversation already up-to-date."),await i(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const na={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},Un={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},bo=_l(Sl((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await Rt.loadProjects();e({projects:n,isLoading:!1}),Be.emit(na.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Be.emit(na.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=zs(),i=new Date,s=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=jr(`${s}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:i,updatedAt:i,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await Rt.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Be.emit(na.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const i=t().getProjectById(n);if(!i){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const s={...i,...r,updatedAt:new Date};if(r.name&&r.name!==i.name){const o=i.parentId?((a=t().getProjectById(i.parentId))==null?void 0:a.path)??"/":"/";s.path=jr(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await Rt.saveProject(s),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=s,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Be.emit(na.updated,{projectId:n,updates:s})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const i=new Set,s=a=>{i.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>s(o.id))};s(n);try{await Rt.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!i.has(o.id))})),Be.emit(Un.loadConversationsRequest,void 0),Be.emit(na.deleted,{projectId:n}),Fe.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const i=t().getProjectById(r.parentId);if(!i)break;r=i}return r.id},getEffectiveProjectSettings:n=>{const r=dr.getState(),i=Er.getState().selectedModelId,s={systemPrompt:r.globalSystemPrompt,modelId:i,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return s;const a=t().getProjectById(n);if(!a)return s;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):s;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),i=s=>async a=>{await s(a)};return[{eventName:na.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:na.addProjectRequest,handler:i(r.addProject),storeId:n},{eventName:na.updateProjectRequest,handler:s=>r.updateProject(s.id,s.updates),storeId:n},{eventName:na.deleteProjectRequest,handler:s=>r.deleteProject(s.id),storeId:n}]}}))),ES=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},tUe=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${ej(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${ej(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,i)=>r.index-i.index).forEach(r=>{var i,s,a,o,l,c,u,d;((i=r.prompt)!=null&&i.content||(o=(a=(s=r.prompt)==null?void 0:s.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${Ex(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class Ng{static async importConversation(t,n,r){try{const i=await t.text(),s=JSON.parse(i);if(!s||typeof s!="object"||!s.conversation||!Array.isArray(s.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=s.conversation,o=s.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>Rt.saveInteraction({...u,conversationId:l,id:zs()}));await Promise.all(c),await r(l,"conversation"),Fe.success("Conversation imported successfully.")}catch(i){throw console.error("ImportExportService: Error importing conversation",i),Fe.error(`Import failed: ${i instanceof Error?i.message:String(i)}`),i}}static async exportConversation(t,n){try{const r=Dn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const i=await Rt.loadInteractionsForConversation(t);let s,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:i},null,2);s=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=tUe(r,i);s=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");ES(s,a),Fe.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),Fe.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=bo.getState(),{conversations:i}=Dn.getState(),s=r(t);if(!s)throw new Error("Project not found.");const a=async h=>{const p=n.find(w=>w.id===h);if(!p)throw new Error(`Project ${h} not found in state.`);const y=n.filter(w=>w.parentId===h),b=i.filter(w=>w.projectId===h),x=[];for(const w of y)x.push(await a(w.id));for(const w of b){const _=await Rt.loadInteractionsForConversation(w.id);x.push({conversation:w,interactions:_})}return{project:p,children:x}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${s.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;ES(c,d),Fe.success(`Project "${s.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),Fe.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=Dn.getState().conversations,n=[];for(const a of t){const o=await Rt.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),i=new Blob([r],{type:"application/json"}),s=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;ES(i,s),Fe.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),Fe.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await Rt.getAllDataForExport(t),r=JSON.stringify(n,null,2),i=new Blob([r],{type:"application/json"}),s=`litechat_full_export_${new Date().toISOString().split("T")[0]}.json`;ES(i,s),Fe.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),Fe.error(`Full export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importFullConfiguration(t,n){try{const r=await t.text(),i=JSON.parse(r);if(!i||typeof i!="object"||!i.version)throw new Error("Invalid import file format. Missing version or basic structure.");await Rt.importAllData(i,n),Fe.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),Fe.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}}const Rc="sync_repos",ei={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},Bi=_l(Sl((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Be.emit(ln.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Be.emit(ln.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&Fe.error(`VFS Error: ${n}`)}),Be.emit(ln.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const i={};n.forEach(s=>{r.nodes[s.id]=s;const a=s.parentId??r.rootId??"";i[a]||(i[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),i[a].includes(s.id)||i[a].push(s.id)});for(const s in i)(!r.childrenMap[s]||JSON.stringify(r.childrenMap[s].sort())!==JSON.stringify(i[s].sort()))&&(r.childrenMap[s]=i[s])}),Be.emit(ln.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(i=>{i.nodes[n]&&Object.assign(i.nodes[n],r)}),Be.emit(ln.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(i=>{const s=r.nodes[i];if(s){const a=s.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==i)),delete r.nodes[i],r.selectedFileIds.delete(i),s.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===i).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[i]}}})}),Be.emit(ln.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Be.emit(ln.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Be.emit(ln.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Be.emit(ln.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Be.emit(ln.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Be.emit(ln.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,i=t().configuredVfsKey;if(n===r){n&&n!==i&&!t().initializingKey&&t().initializeVFS(n).catch(s=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,s)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${i}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Be.emit(ln.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(s=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,s)})}},initializeVFS:async(n,r)=>{let i,s;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),i=String(n.vfsKey),s=n.options;else if(typeof n=="string")i=n,s=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!i||i.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${i}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(s==null?void 0:s.force)===!0;if(t().initializingKey===i){const h=`Initialization skipped for "${i}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((p,y)=>{const b=setInterval(()=>{const x=t();x.initializingKey!==i&&(clearInterval(b),x.configuredVfsKey===i&&x.fs?p(x.fs):y(new Error(`VFS initialization for "${i}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${i}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===i&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==i){const h=`UI Initialization aborted for "${i}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==i){const h=`UI Initialization skipped for "${i}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${i} (Forced: ${a})`),e({initializingKey:i}),a||(o(!0),l(null));try{const h=await cEe(i);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==i){const b=`UI Initialization for key "${i}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(i),e({initializingKey:null}),Be.emit(ln.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(i),console.log(`[VfsStore] UI VFS instance configured for key: ${i}`);const p="vfs-root";let y=t().nodes[p];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:p,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const p=`Failed to initialize VFS (${i}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${p}`,h),t().initializingKey===i&&(l(p),a||(u(null),d(null))),new Error(p)}finally{t().initializingKey===i&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:i,_addNodes:s,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],p=h?h.path:"/",y=await yP(p,{fsInstance:a}),b=n??l??"",x=new Set(y.map(E=>E.path)),S=(t().childrenMap[b]||[]).map(E=>t().nodes[E]).filter(Boolean).filter(E=>!x.has(E.path)).map(E=>E.id);S.length>0&&t()._removeNodes(S);const C=y.map(E=>{const T=Object.values(t().nodes).find(M=>M.path===E.path),R=Date.now();return{id:(T==null?void 0:T.id)||zs(),parentId:n,name:E.name,path:E.path,type:E.isDirectory?"folder":"file",size:E.size,createdAt:(T==null?void 0:T.createdAt)??R,lastModified:E.lastModified.getTime(),mimeType:E.isDirectory?void 0:E.mimeType}});C.length>0&&s(C),e(E=>{const T=C.map(R=>R.id);(!E.childrenMap[b]||JSON.stringify(E.childrenMap[b].sort())!==JSON.stringify(T.sort()))&&(E.childrenMap[b]=T)})}catch(h){console.error("Failed to fetch VFS nodes:",h),i("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=jr(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const i=t().rootId;return i?t().nodes[i]:void 0}return Object.values(t().nodes).find(i=>i.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:i,rootId:s,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=jr(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await i(l.id)):o==="/"&&s?(e(c=>{c.currentParentId=s}),t().childrenMap[s]||await i(s)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:i,_setError:s,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){s("Filesystem not ready.");return}if(!r.trim()){s("Directory name cannot be empty.");return}i(!0);try{const h=n?o[n]:o[l||""],p=h?h.path:"/",y=K3(p,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(_){if(_.code!=="ENOENT")throw _}await jY(y,{fsInstance:a});const b=Date.now(),w={id:zs(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([w])}catch(h){console.error("Failed to create directory:",h),s(h.message||"Failed to create directory.")}finally{i(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:i,_setError:s,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){s("Filesystem not ready.");return}i(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await OY(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),s("Failed to upload one or more files.")}finally{i(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:i,_removeNodes:s,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){i("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await bP(u.path,u.type==="folder",{fsInstance:a});s(n)}catch(c){console.error("Failed to delete nodes:",c),i("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:i,_setError:s,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){s("Filesystem not ready.");return}if(!r.trim()){s("Name cannot be empty.");return}const h=o[n];if(!h){s("Item not found.");return}if(h.name!==r.trim()){i(!0);try{const p=h.parentId?o[h.parentId]:o[c||""],y=p?p.path:"/",b=K3(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await PY(h.path,b,{fsInstance:l});const x={name:r.trim(),path:b,lastModified:Date.now()};a(n,x)}catch(p){console.error("Failed to rename item:",p),s(p.message||"Failed to rename item.")}finally{i(!1)}}},downloadFile:async n=>{const{nodes:r,fs:i,_setError:s,configuredVfsKey:a,vfsKey:o}=t();if(!i||a!==o)return s("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return s("File not found."),null;try{const c=await yh(l.path,{fsInstance:i}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),s("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Be.emit(ln.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Be.emit(ln.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Be.emit(ln.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),i=s=>async a=>{await s(a)};return[{eventName:ln.setVfsKeyRequest,handler:s=>r.setVfsKey(s.key),storeId:n},{eventName:ln.initializeVFSRequest,handler:async s=>{await r.initializeVFS(s.vfsKey,s.options)},storeId:n},{eventName:ln.fetchNodesRequest,handler:s=>r.fetchNodes(s.parentId),storeId:n},{eventName:ln.setCurrentPathRequest,handler:s=>r.setCurrentPath(s.path),storeId:n},{eventName:ln.createDirectoryRequest,handler:s=>r.createDirectory(s.parentId,s.name),storeId:n},{eventName:ln.uploadFilesRequest,handler:s=>r.uploadFiles(s.parentId,s.files),storeId:n},{eventName:ln.deleteNodesRequest,handler:s=>r.deleteNodes(s.ids),storeId:n},{eventName:ln.renameNodeRequest,handler:s=>r.renameNode(s.id,s.newName),storeId:n},{eventName:ln.downloadFileRequest,handler:i(r.downloadFile),storeId:n},{eventName:ln.selectFileRequest,handler:s=>r.selectFile(s.fileId),storeId:n},{eventName:ln.deselectFileRequest,handler:s=>r.deselectFile(s.fileId),storeId:n},{eventName:ln.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:ln.setEnableVfsRequest,handler:s=>r._setEnableVfs(s.enabled),storeId:n}]}}))),nUe="/synced_repos",Dn=_l(Sl((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),Bi.getState().initializingKey===Rc&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),Bi.getState().resetStuckInitialization()),new Promise((r,i)=>{let s=null;const a=()=>{Be.off(ln.fsInstanceChanged,o),Be.off(ln.loadingStateChanged,l),s&&(clearTimeout(s),s=null)},o=u=>{Bi.getState().configuredVfsKey===Rc&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${Rc}.`),a(),r(u.fsInstance))},l=u=>{const d=Bi.getState();d.configuredVfsKey===Rc&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${Rc}: ${u.error}`),a(),i(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${Rc}.`),a(),r(d.fs)))};Be.on(ln.fsInstanceChanged,o),Be.on(ln.loadingStateChanged,l);const c=Bi.getState();if(c.configuredVfsKey===Rc&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${Rc}.`),a(),r(c.fs);return}s=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${Rc}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),i(new Error(u))},3e4),Be.emit(ln.initializeVFSRequest,{vfsKey:Rc,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([Rt.loadConversations(),Rt.loadSyncRepos()]),i={};n.forEach(s=>{if(s.syncRepoId){const a=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,o=s.updatedAt instanceof Date?s.updatedAt.getTime():null;a?o&&o>a?i[s.id]="needs-sync":i[s.id]="idle":i[s.id]="needs-sync"}else i[s.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:i,repoInitializationStatus:{},isLoading:!1}),Be.emit(Un.conversationsLoaded,{conversations:n}),Be.emit(Un.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Be.emit(Un.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=zs(),i=new Date,s={id:r,createdAt:i,updatedAt:i,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(s);return await Rt.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===s.id)||(l.conversations.unshift(s),l.conversationSyncStatus[r]=s.syncRepoId?"needs-sync":"idle")}),Be.emit(Un.conversationAdded,{conversation:s}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const i=t().getConversationById(n);if(!i){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,p=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||p>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const s=t().getConversationById(n);if(s)try{const a=JSON.parse(JSON.stringify(s));await Rt.saveConversation(a),Be.emit(Un.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=i;const c=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,u=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&c&&u<=c?"idle":i.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=i;const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();a.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,i=t().selectedItemType,s=t().conversations.find(a=>a.id===n);if(s){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&i==="conversation"?null:r,selectedItemType:r===n&&i==="conversation"?null:i,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await Rt.deleteConversation(n),await Rt.deleteInteractionsForConversation(n),Be.emit(Un.conversationDeleted,{conversationId:n}),r===n&&i==="conversation"&&(Be.emit(Xn.setCurrentConversationIdRequest,{id:null}),Be.emit(Un.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(s){o.conversations.push(s);const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}r===n&&i==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const i=t().selectedItemId,s=t().selectedItemType;if(i===n&&s===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${i} (${s})`);const a=r==="conversation"?n:null;a&&(Be.emit(Xn.setCurrentConversationIdRequest,{id:a}),Be.emit(Xn.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Be.emit(Un.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await Ng.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await Ng.exportConversation(n,r)},exportProject:async n=>{await Ng.exportProject(n)},exportAllConversations:async()=>{await Ng.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await Rt.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Be.emit(Un.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Be.emit(Un.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=zs(),i=new Date,s={id:r,createdAt:i,updatedAt:i,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(s)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await Rt.saveSyncRepo(o),Be.emit(ei.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");Fe.success(`Sync repository "${s.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${s.name}":`,o),Fe.warning(`Repository "${s.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const i=t().syncRepos.find(a=>a.id===n);if(!i){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const s=t().syncRepos.find(a=>a.id===n);if(s)try{const a=JSON.parse(JSON.stringify(s));await Rt.saveSyncRepo(a),Be.emit(ei.repoChanged,{repoId:n,action:"updated"}),Fe.success(`Sync repository "${s.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=i),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=i),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(i=>i.id===n);if(r)try{let i;try{i=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),Fe.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await Rt.deleteSyncRepo(n);const s=jr(`${nUe}/${n}`);try{await bP(s,!0,{fsInstance:i}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${s}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${s}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Be.emit(ei.repoChanged,{repoId:n,action:"deleted"}),Fe.success(`Sync repository "${r.name}" deleted.`)}catch(i){throw console.error("ConversationStore: Error deleting sync repo",i),e(s=>{s.error="Failed to delete sync repository"}),i}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),Fe.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,i=null)=>{e(s=>{s.conversationSyncStatus[n]=r,r==="error"&&i&&console.error(`Sync error for ${n}: ${i}`)}),Be.emit(Un.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(i=>{i.repoInitializationStatus[n]=r}),Be.emit(ei.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const i=t().syncRepos.find(a=>a.id===n);if(!i){r||Fe.error("Sync repsitory configuration not found.");return}let s;try{s=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await Q7e(s,i,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const i=t().getConversationById(n);if(!i){r||Fe.error("Conversation not found for syncing.");return}if(!i.syncRepoId){r||Fe.info("Conversation not linked to a sync repository.");return}const s=t().syncRepos.find(l=>l.id===i.syncRepoId);if(!s){r||Fe.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await eUe(a,i,s,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Zg);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Zg);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await zr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>Zg);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:i,updateConversation:s}=t();if(i!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await s(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(i=>{i.conversations=i.conversations.map(s=>s.projectId&&r.has(s.projectId)?{...s,projectId:null}:s)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),i=s=>async a=>{await s(a)};return[{eventName:Un.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:Un.addConversationRequest,handler:i(r.addConversation),storeId:n},{eventName:Un.updateConversationRequest,handler:s=>r.updateConversation(s.id,s.updates),storeId:n},{eventName:Un.deleteConversationRequest,handler:s=>r.deleteConversation(s.id),storeId:n},{eventName:Un.selectItemRequest,handler:s=>r.selectItem(s.id,s.type),storeId:n},{eventName:Un.importConversationRequest,handler:s=>r.importConversation(s.file),storeId:n},{eventName:Un.exportConversationRequest,handler:s=>r.exportConversation(s.conversationId,s.format),storeId:n},{eventName:Un.exportProjectRequest,handler:s=>r.exportProject(s.projectId),storeId:n},{eventName:Un.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:Un.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:Un.addSyncRepoRequest,handler:i(r.addSyncRepo),storeId:n},{eventName:Un.updateSyncRepoRequest,handler:s=>r.updateSyncRepo(s.id,s.updates),storeId:n},{eventName:Un.deleteSyncRepoRequest,handler:s=>r.deleteSyncRepo(s.id),storeId:n},{eventName:Un.linkConversationToRepoRequest,handler:s=>r.linkConversationToRepo(s.conversationId,s.repoId),storeId:n},{eventName:Un.syncConversationRequest,handler:s=>r.syncConversation(s.conversationId),storeId:n},{eventName:Un.initializeOrSyncRepoRequest,handler:s=>r.initializeOrSyncRepo(s.repoId),storeId:n},{eventName:Un.updateCurrentConversationToolSettingsRequest,handler:s=>r.updateCurrentConversationToolSettings(s),storeId:n}]}}))),Vl={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request"},Lv={async submitPrompt(e){var O,B,P,H,F,Q;console.log("[ConversationService] submitPrompt called",e);const t=On.getState(),n=bo.getState(),r=mo.getState(),i=Dn.getState(),s=dr.getState(),a=t.currentConversationId;if(!a){Fe.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=i.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(q=>q.conversationId===a).length===0&&s.autoTitleEnabled&&((O=e.metadata)==null?void 0:O.autoTitleEnabledForTurn)===!0&&s.autoTitleModelId,p=t.interactions.filter(q=>q.parentId===null&&q.status==="COMPLETED").sort((q,K)=>q.index-K.index).map(q=>{var K;if(q.type==="message.assistant_regen"&&((K=q.metadata)!=null&&K.regeneratedFromId)){const U=t.interactions.find(re=>re.id===q.metadata.regeneratedFromId);if(U&&U.prompt&&U.type==="message.user_assistant")return{...q,prompt:U.prompt,type:"message.user_assistant"}}return q.type==="message.user_assistant"&&q.prompt?q:null}).filter(Boolean),y=j3(p);let b=e.content;const x=[],w=((B=e.metadata)==null?void 0:B.effectiveRulesContent)??[],_=w.filter(q=>q.type==="system").map(q=>q.content),S=w.filter(q=>q.type==="before").map(q=>q.content),C=w.filter(q=>q.type==="after").map(q=>q.content);S.length>0&&(b=`${S.join(`
`)}

${b}`),C.length>0&&(b=`${b}

    ${C.join(`
`)}`),b&&x.push({type:"text",text:b});const E=((P=e.metadata)==null?void 0:P.attachedFiles)??[];if(E.length>0){const q=await this._processFilesForPrompt(E,a);x.unshift(...q)}x.length>0?y.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let R=((H=e.metadata)==null?void 0:H.turnSystemPrompt)??c.systemPrompt??void 0;_.length>0&&(R=`${R?`${R}

        `:""}${_.join(`
`)}`);const M={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(M).forEach(q=>{(M[q]===null||M[q]===void 0)&&delete M[q]});const N={system:R,messages:y,parameters:M,metadata:{...(({turnSystemPrompt:q,activeTagIds:K,activeRuleIds:U,effectiveRulesContent:re,autoTitleEnabledForTurn:G,...ne})=>({...ne,effectivelyAppliedTagIds:K,effectivelyAppliedRuleIds:U}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(F=e.metadata.attachedFiles)==null?void 0:F.map(({contentBase64:q,contentText:K,...U})=>U)}};try{const q=Sp.startInteraction(N,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const K=(((Q=e.metadata)==null?void 0:Q.effectiveRulesContent)??[]).map(U=>({id:U.sourceRuleId||zs(),name:U.sourceRuleId?`Rule ${U.sourceRuleId.substring(0,4)}`:"Context Rule",content:U.content,type:U.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,K).catch(U=>{console.error("[ConversationService] Background title generation failed:",U)})}await q}catch(q){throw console.error("[ConversationService] Error starting interaction:",q),Fe.error(`Failed to start interaction: ${q instanceof Error?q.message:String(q)}`),q}},async generateConversationTitle(e,t,n){var o,l;const r=dr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let i=t.content;if(i.length>r.autoTitlePromptMaxLength&&(i=i.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");i+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");i+=`

[Active rules: ${c}]`}const s={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:i}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:zs(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:s.parameters,metadata:{...s.metadata,originalTurnId:t.id}};try{await Sp.startInteraction(s,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var P,H,F,Q;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=On.getState(),n=bo.getState(),r=mo.getState(),i=Dn.getState(),s=t.interactions.find(q=>q.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(s))),!s||!s.prompt){Fe.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=s.index,l=s.prompt,c=s.conversationId,u=i.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),p=s.index,y=t.interactions.filter(q=>q.conversationId===c&&q.index<p&&q.status==="COMPLETED"&&q.type==="message.user_assistant"&&q.parentId===null).sort((q,K)=>q.index-K.index),b=j3(y);let x=l.content;const w=[],_=((P=l.metadata)==null?void 0:P.effectiveRulesContent)??[],S=_.filter(q=>q.type==="system").map(q=>q.content),C=_.filter(q=>q.type==="before").map(q=>q.content),E=_.filter(q=>q.type==="after").map(q=>q.content);C.length>0&&(x=`${C.join(`
`)}

${x}`),E.length>0&&(x=`${x}

    ${E.join(`
`)}`),x&&w.push({type:"text",text:x});const T=((H=l.metadata)==null?void 0:H.attachedFiles)??[];if(T.length>0){const q=await this._processFilesForPrompt(T,c);w.unshift(...q)}w.length>0?b.push({role:"user",content:w}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let M=((F=l.metadata)==null?void 0:F.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(M=`${M?`${M}

        `:""}${S.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(N).forEach(q=>{(N[q]===null||N[q]===void 0)&&delete N[q]});const O={system:M,messages:b,parameters:N,metadata:{...(({turnSystemPrompt:q,activeTagIds:K,activeRuleIds:U,effectiveRulesContent:re,autoTitleEnabledForTurn:G,...ne})=>({...ne,effectivelyAppliedTagIds:K,effectivelyAppliedRuleIds:U}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:T.map(({contentBase64:q,contentText:K,...U})=>U)}};let B=null;try{if(B=await Sp.startInteraction(O,c,l,"message.assistant_regen"),!B)throw new Error("Failed to create new interaction for regeneration.");const q={};let K=!1;B.index!==o&&(q.index=o,K=!0),B.parentId!==a&&(q.parentId=a,K=!0);let U=B;K&&(t._updateInteractionInState(B.id,q),U={...B,...q},await Rt.saveInteraction(U)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify(U)));const re=[];let G=s;for(;G;){re.push(G);const te=(Q=G.metadata)==null?void 0:Q.regeneratedFromId;te?G=t.interactions.find(se=>se.id===te):G=null}const ne=re.sort((te,se)=>{var Ne,Pe;const pe=((Ne=te.startedAt)==null?void 0:Ne.getTime())??0,de=((Pe=se.startedAt)==null?void 0:Pe.getTime())??0;return pe-de});for(let te=0;te<ne.length;te++){const se=ne[te],pe={parentId:U.id,index:te};console.log(`[ConversationService] Updating old version ${se.id} to be child of ${U.id} with childIndex ${te}`,JSON.parse(JSON.stringify(pe))),t._updateInteractionInState(se.id,pe),await Rt.saveInteraction({...se,...pe})}}catch(q){throw console.error("[ConversationService] Error during regeneration process:",q),Fe.error(`Failed to regenerate response: ${q instanceof Error?q.message:String(q)}`),q}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(s=>s.source==="vfs");let i;if(r.length>0){const s=Dn.getState().getConversationById(t),a=(s==null?void 0:s.projectId)??"orphan";try{i=await this._ensureVfsReady(a)}catch{Fe.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),i=void 0}}for(const s of e){let a=null;try{if(s.source==="direct")a=fB(s);else if(s.source==="vfs"&&i&&s.path){console.log(`[ConversationService] Fetching VFS file: ${s.path}`);const o=await yh(s.path,{fsInstance:i});a=fB({...s,contentBytes:o})}else if(s.source==="vfs"&&!i)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${s.name}:`,o),n.push({type:"text",text:`[Error processing file: ${s.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{Bi.getState().configuredVfsKey===e&&(s(),t(o.fsInstance))},i=o=>{if(Bi.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)s(),n(new Error(o.error));else{const l=Bi.getState().fs;l&&(s(),t(l))}},s=()=>{Be.off(ln.fsInstanceChanged,r),Be.off(ln.loadingStateChanged,i)};Be.on(ln.fsInstanceChanged,r),Be.on(ln.loadingStateChanged,i);const a=Bi.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){s(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){s(),n(new Error(a.error));return}Be.emit(ln.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},Sp={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Be.on(Vl.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=On.getState().interactions.find(i=>i.id===t);if(!n){Fe.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){Fe.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),Fe.success("Response copied!")}catch(i){Fe.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",i)}}),Be.on(Vl.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=On.getState().interactions.find(o=>o.id===t);if(!n){Fe.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=On.getState();if(r.status==="streaming"){Fe.info("Cannot regenerate while another response is streaming.");return}const s=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=s.length>0?s[s.length-1]:null;if((a==null?void 0:a.id)!==t){Fe.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),console.log(`[InteractionService] Starting ConversationService.regenerateInteraction for ${t}`),await Lv.regenerateInteraction(t),console.log(`[InteractionService] Finished ConversationService.regenerateInteraction for ${t}`)}catch(o){Fe.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Be.on(Vl.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received regenerateInteractionWithModelRequest for ${t} with model ${n}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=On.getState().interactions.find(l=>l.id===t);if(!r){Fe.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const i=On.getState();if(i.status==="streaming"){Fe.info("Cannot regenerate while another response is streaming.");return}const a=i.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){Fe.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=mo.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{console.log(`[InteractionService] Starting ConversationService.regenerateInteraction for ${t} with model ${n}`),await Lv.regenerateInteraction(t),console.log(`[InteractionService] Finished ConversationService.regenerateInteraction for ${t}`)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){Fe.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Be.on(Vl.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e;console.log(`[InteractionService] Received raceInteractionRequest for ${t} with ${n.length} models`);const i=On.getState().interactions.find(c=>c.id===t);if(!i){Fe.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const s=On.getState();if(s.status==="streaming"){Fe.info("Cannot start race while another response is streaming.");return}const o=s.interactions.filter(c=>c.conversationId===i.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){Fe.info("Can only race from the last response in the conversation.");return}if(n.length<2){Fe.error("Need at least 2 models to race");return}try{const c=mo.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),Fe.info(`Starting race with ${n.length} models...`);const d=n.map((b,x)=>new Promise(w=>{setTimeout(async()=>{try{c.setModelId(b),console.log(`[InteractionService] Starting race participant ${x+1}/${n.length} with model ${b}`),await Lv.regenerateInteraction(t),console.log(`[InteractionService] Race participant ${x+1} finished`),w({success:!0,modelId:b,index:x})}catch(_){console.error(`[InteractionService] Race participant ${x+1} failed:`,_),w({success:!1,modelId:b,index:x,error:_})}},x*r)})),h=await Promise.all(d);c.setModelId(u);const p=h.filter(b=>b.success).length,y=h.length-p;p>0?Fe.success(`Race completed! ${p} models responded${y>0?`, ${y} failed`:""}`):Fe.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){Fe.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Be.on(Vl.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:i}=e;if(!t||t.trim()===""){Fe.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),Fe.success(`Code block ${i?`(${i}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${i}`)}catch(s){Fe.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",s)}})},async startInteraction(e,t,n,r="message.user_assistant"){var N,O,B,P,H,F,Q,q,K,U;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const i=await rC(f0.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(i===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const s=i&&typeof i=="object"?i.prompt:e,a=zs(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=On.getState(),u=l.interactions.filter(re=>re.conversationId===t),d=r==="conversation.title_generation"?-1:u.reduce((re,G)=>Math.max(re,G.index),-1)+1,h=null,p=performance.now();this._interactionStartTimes.set(a,p);const y={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...s.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation"},index:d,parentId:h};r!=="conversation.title_generation"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added title generation interaction ${a} to state.`)),Rt.saveInteraction({...y}).catch(re=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,re)}),Be.emit(Xn.started,{interactionId:a,conversationId:t,type:y.type});const b=(N=s.metadata)==null?void 0:N.modelId;if(!b)return this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:x,modelId:w}=Xl(b);if(!x||!w)return this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const _=Er.getState().dbProviderConfigs.find(re=>re.id===x);if(!_)return this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${x}`),r),null;const S=Er.getState().getApiKeyForProvider(x),C=fO(_,w,S);if(!C)return this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${_.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const E=r!=="conversation.title_generation"?(((O=s.metadata)==null?void 0:O.enabledTools)??[]).reduce((re,G)=>{const te=Ho.getState().getRegisteredTools()[G];if(te!=null&&te.implementation){const se={...te.definition};se.execute=async pe=>{const de=On.getState().currentConversationId,Ne=de?Dn.getState().getConversationById(de):null;let Pe;Ne&&Ne.projectId?typeof Ne.projectId=="string"?Pe=Ne.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${de} is not a string (type: ${typeof Ne.projectId}). Defaulting VFS key to "orphan". Value:`,Ne.projectId),Pe="orphan"):Pe="orphan";let Me;try{if(Be.emit(ln.initializeVFSRequest,{vfsKey:Pe,options:{force:!0}}),await new Promise(Ee=>setTimeout(Ee,100)),Me=Bi.getState().fs,Bi.getState().configuredVfsKey!==Pe||!Me)throw new Error(`Filesystem for key "${Pe}" not ready after request.`)}catch(Ee){return{_isError:!0,error:`Filesystem error: ${Ee.message}`}}try{const Ee=eve(),Ue=te.definition.parameters.parse(pe),nt=te.implementation,He={...Ee,fsInstance:Me};return await nt(Ue,He)}catch(Ee){const Ue=Ee instanceof Error?Ee.message:String(Ee);return Ee instanceof L.ZodError?{_isError:!0,error:`Invalid arguments: ${Ee.errors.map(nt=>`${nt.path.join(".")} (${nt.message})`).join(", ")}`}:{_isError:!0,error:Ue}}},re[G]=se}return re},{}):void 0,T=((B=s.parameters)==null?void 0:B.maxSteps)??dr.getState().toolMaxSteps,R={model:C,messages:s.messages,abortSignal:o.signal,system:s.system,temperature:(P=s.parameters)==null?void 0:P.temperature,maxTokens:(H=s.parameters)==null?void 0:H.max_tokens,topP:(F=s.parameters)==null?void 0:F.top_p,topK:(Q=s.parameters)==null?void 0:Q.top_k,presencePenalty:(q=s.parameters)==null?void 0:q.presence_penalty,frequencyPenalty:(K=s.parameters)==null?void 0:K.frequency_penalty,maxSteps:T,...E&&Object.keys(E).length>0&&{tools:E},...((U=s.parameters)==null?void 0:U.providerOptions)&&{providerOptions:s.parameters.providerOptions},toolChoice:s.toolChoice},M={onChunk:re=>this._handleChunk(a,re),onReasoningChunk:re=>this._handleReasoningChunk(a,re),onToolCall:re=>this._handleToolCall(a,re),onToolResult:re=>this._handleToolResult(a,re),onFinish:re=>this._handleFinish(a,re,r),onError:re=>this._handleError(a,re,r)};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),X7e.executeInteraction(a,R,M).catch(re=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,re);const G=On.getState().interactions.find(ne=>ne.id===a);G&&G.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",re instanceof Error?re:new Error(String(re)),r)}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),Fe.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=On.getState(),r=n.interactions.find(i=>i.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant"))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await rC(f0.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const i=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;On.getState().appendInteractionResponseChunk(e,i),Be.emit(Xn.streamChunk,{interactionId:e,chunk:i})}},_handleReasoningChunk(e,t){On.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),On.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),On.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},_handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},_handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},_finalizeInteraction(e,t,n,r="message.user_assistant",i){var E;const s=On.getState(),a=s.interactions.find(T=>T.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=s.activeStreamBuffers[e]??"",l=s.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),p=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&p?Math.round(p-h):void 0,x=(i==null?void 0:i.reasoning)??l,w={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(i==null?void 0:i.usage)&&{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens,totalTokens:i.usage.totalTokens},...(i==null?void 0:i.providerMetadata)&&{providerMetadata:i.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:x||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&w.response&&typeof w.response=="string"){const T=w.response.trim().replace(/^"|"$/g,"");T&&a&&(console.log(`[InteractionService] Updating conversation ${a.conversationId} title to: "${T}"`),Be.emit(Un.updateConversationRequest,{id:a.conversationId,updates:{title:T}}))}s._updateInteractionInState(e,w),s._removeStreamingId(e);const _=On.getState().interactions.find(T=>T.id===e);_?(console.log(`[InteractionService] Persisting final state for ${e}. Response length: ${((E=_.response)==null?void 0:E.length)??0}`),Rt.saveInteraction({..._}).catch(T=>{console.error(`[InteractionService] Failed final persistence for ${e}`,T)})):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],C=[];try{S=c.calls.map(T=>JSON.parse(T)),C=c.results.map(T=>JSON.parse(T))}catch(T){console.error("[InteractionService] Failed to parse tool strings for event emitter:",T)}Be.emit(Xn.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:C}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e),console.log(`[InteractionService] Finalized interaction ${e} with status ${t}.`)}},mk=ut.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var F;const{interaction:i,interactionStatus:s}=On(Cn(Q=>{const q=Q.interactions.find(K=>K.id===e);return{interaction:q,interactionStatus:q==null?void 0:q.status}})),a=dr(Q=>Q.streamingRenderFPS),[o,l]=A.useState(""),[c,u]=A.useState(""),[d,h]=A.useState(!0),[p,y]=A.useState(!1),b=A.useRef(null),x=A.useRef(0),w=A.useRef(null);A.useEffect(()=>{const Q=1e3/a;let q=!0;const K=U=>{if(!q)return;if(On.getState().streamingInteractionIds.includes(e)){if(U-x.current>=Q){const G=On.getState().activeStreamBuffers[e]??"",ne=On.getState().activeReasoningBuffers[e]??"";l(G),u(ne),x.current=U}b.current=requestAnimationFrame(K)}else{const G=On.getState().activeStreamBuffers[e]??"",ne=On.getState().activeReasoningBuffers[e]??"";l(G),u(ne),b.current=null}};return b.current=requestAnimationFrame(K),()=>{q=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),A.useEffect(()=>{if(s&&s!=="STREAMING"){const Q=On.getState().activeStreamBuffers[e]??"",q=On.getState().activeReasoningBuffers[e]??"";l(Q),u(q),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[s,e]);const{dbProviderConfigs:_,getAllAvailableModelDefsForProvider:S}=Er(Cn(Q=>({dbProviderConfigs:Q.dbProviderConfigs,getAllAvailableModelDefsForProvider:Q.getAllAvailableModelDefsForProvider}))),C=A.useMemo(()=>{var te;const Q=(te=i==null?void 0:i.metadata)==null?void 0:te.modelId;if(!Q)return"Loading Model...";const{providerId:q,modelId:K}=Xl(Q);if(!q||!K)return Q;const U=_.find(se=>se.id===q),re=(U==null?void 0:U.name)??q,ne=S(q).find(se=>se.id===K);return`${(ne==null?void 0:ne.name)??K} (${re})`},[(F=i==null?void 0:i.metadata)==null?void 0:F.modelId,_,S]),E=A.useCallback(()=>h(Q=>!Q),[]),T=A.useCallback(()=>{y(!1)},[]),R=A.useCallback(()=>{y(!0)},[]),M=A.useCallback(()=>{p?T():R()},[p,T,R]);if(!i)return r?m.jsxs("div",{className:dt("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[m.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),m.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),m.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),m.jsxs("div",{className:"space-y-2 mt-2",children:[m.jsx("div",{className:"h-4 bg-muted rounded w-full"}),m.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),m.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):m.jsxs("div",{className:dt("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[m.jsxs("div",{className:"flex justify-between items-center mb-2",children:[m.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),m.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),m.jsxs("div",{className:"space-y-2 mt-2",children:[m.jsx("div",{className:"h-4 bg-muted rounded w-full"}),m.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),m.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const N=()=>{Sp.abortInteraction(e)},O=n==null?void 0:n("header-actions",i,{isFolded:p,toggleFold:M}),B=n==null?void 0:n("actions",i),P=n==null?void 0:n("content",i),H=n==null?void 0:n("menu",i);return m.jsxs("div",{ref:w,className:dt("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",s==="ERROR"?"border-destructive/50 bg-destructive/5":s==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&i.prompt&&m.jsx(uT,{turnData:i.prompt,timestamp:i.startedAt,isAssistantComplete:!1}),m.jsxs("div",{className:dt("relative group/assistant",r&&i.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[H,m.jsxs("div",{className:dt("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[m.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[m.jsx(FV,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),m.jsx("div",{className:"flex flex-col min-w-0",children:m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",C,")"]}),m.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:O})]})})]}),m.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:m.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!p&&m.jsxs(m.Fragment,{children:[P,c&&m.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:E,children:[m.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[m.jsx(sh,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),m.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:m.jsx(Rn,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:Q=>{Q.stopPropagation(),E()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?m.jsx(cu,{}):m.jsx(ah,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&m.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),m.jsx(c$e,{interactionId:e,markdownContent:o,isStreaming:!0})]}),p&&m.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:M,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),m.jsxs("div",{className:dt("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[B,m.jsx(u$e,{onStop:N,"aria-label":"Stop Generation"})]})]})});mk.displayName="StreamingInteractionCard";const H7=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,rUe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:i,generationTime:s,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return m.jsxs("div",{className:dt("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[m.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[m.jsx(FV,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),m.jsxs("div",{className:"flex flex-col min-w-0",children:[m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),m.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),m.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsxs(gr,{className:"flex items-center gap-0.5 cursor-default",children:[m.jsx(Nfe,{className:"h-3 w-3"}),m.jsx("span",{children:o.toLocaleString()})]}),m.jsxs(yr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),i!==void 0&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsxs(gr,{className:"flex items-center gap-0.5 cursor-default",children:[m.jsx(Mpe,{className:"h-3 w-3"}),m.jsx("span",{children:H7(i)})]}),m.jsx(yr,{side:"bottom",children:"Time to First Token"})]})}),s!==void 0&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsxs(gr,{className:"flex items-center gap-0.5 cursor-default",children:[m.jsx(Efe,{className:"h-3 w-3"}),m.jsx("span",{children:H7(s)})]}),m.jsx(yr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),m.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:m.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},iUe=({markdownContent:e})=>{const t=DE(e);return e!=null&&e.trim()?m.jsx("div",{className:"overflow-wrap-anywhere",children:t.map((n,r)=>{if(typeof n=="string")return m.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:n}},`html-${r}`);if(n.type==="code"){const i=n;return m.jsx(ty,{lang:i.lang,code:i.code,filepath:i.filepath},`code-${r}`)}else if(n.type==="mermaid"){const i=n;return m.jsx(RD,{code:i.code},`mermaid-${r}`)}return null})}):null},sUe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:i,isError:s,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=A.useState(!0),[d,h]=A.useState(!1),p=Ho(Cn(E=>Object.values(E.canvasControls))),y=A.useCallback((E,T)=>p.filter(R=>R.type==="tool-call-step"&&R.targetSlot===E&&R.renderer).map(R=>R.renderer?m.jsx(ut.Fragment,{children:R.renderer(T)},R.id):null).filter(Boolean),[p]),b=A.useMemo(()=>{if(!n)return[];const E=n.map(R=>JSON.parse(R)),T=(r==null?void 0:r.map(R=>JSON.parse(R)))??[];return E.map(R=>{const M=T.find(N=>N.toolCallId===R.toolCallId);return{call:R,result:M}})},[n,r]),x=A.useCallback(()=>u(E=>!E),[]),w=A.useCallback(async()=>{if(i)try{await navigator.clipboard.writeText(i),h(!0),Fe.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(E){Fe.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",E)}},[i]),_=!!i,S=t&&(typeof t!="string"||t.trim().length>0),C=b&&b.length>0;return o?m.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[_?"[Reasoning] ":"",C?`[${b==null?void 0:b.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:C||_?"":"[No text response]"]}):m.jsxs(m.Fragment,{children:[s&&a&&m.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[m.jsx("p",{className:"font-semibold",children:"Error:"}),m.jsx("p",{children:a})]}),_&&m.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:x,children:[m.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[m.jsx(sh,{className:"h-3.5 w-3.5"})," Reasoning"]}),m.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[m.jsx(Rn,{tooltipText:"Copy Reasoning",onClick:E=>{E.stopPropagation(),w()},"aria-label":"Copy reasoning",icon:d?m.jsx(za,{className:"text-green-500"}):m.jsx(Fk,{}),className:"h-5 w-5 text-muted-foreground"}),m.jsx(Rn,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:E=>{E.stopPropagation(),x()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?m.jsx(cu,{}):m.jsx(ah,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&m.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:i})]}),b.map(({call:E,result:T},R)=>{const M={interactionId:e,toolCall:E,toolResult:T,canvasContextType:"tool-call-step"};return m.jsx(ut.Fragment,{children:y("tool-call-content",M)},`tool-step-${E.toolCallId||R}`)}),S&&typeof t=="string"&&m.jsx(iUe,{markdownContent:t,interactionId:e}),!S&&!C&&!_&&!s&&m.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},a4=ut.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var O,B,P,H,F,Q,q,K,U,re,G,ne;const[i,s]=A.useState(!1),a=A.useRef(null),o=A.useCallback(()=>{s(!1)},[]),l=A.useCallback(()=>{s(!0)},[]),c=A.useCallback(()=>{i?o():l()},[i,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Er(Cn(te=>({dbProviderConfigs:te.dbProviderConfigs,getAllAvailableModelDefsForProvider:te.getAllAvailableModelDefsForProvider}))),h=e.endedAt?UY(new Date(e.endedAt),{addSuffix:!0}):"Processing...",p=A.useMemo(()=>{var Ee;const te=(Ee=e.metadata)==null?void 0:Ee.modelId;if(!te)return"Unknown Model";const{providerId:se,modelId:pe}=Xl(te);if(!se||!pe)return te;const de=u.find(Ue=>Ue.id===se),Ne=(de==null?void 0:de.name)??se,Me=d(se).find(Ue=>Ue.id===pe);return`${(Me==null?void 0:Me.name)??pe} (${Ne})`},[(O=e.metadata)==null?void 0:O.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",x=e.status==="ERROR",w=e.response&&(typeof e.response!="string"||e.response.trim().length>0),_=((B=e.metadata)==null?void 0:B.toolCalls)&&e.metadata.toolCalls.length>0,S=((P=e.metadata)==null?void 0:P.toolResults)&&e.metadata.toolResults.length>0,C=!!((H=e.metadata)!=null&&H.reasoning),E=w||_||S||C,T=n==null?void 0:n("header-actions",e,{isFolded:i,toggleFold:c}),R=n==null?void 0:n("actions",e),M=n==null?void 0:n("content",e),N=n==null?void 0:n("menu",e);return m.jsxs("div",{ref:a,className:dt("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",x?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&m.jsx(uT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y}),m.jsxs("div",{className:dt("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[N,m.jsx(rUe,{displayModelName:p,timeAgo:h,isFolded:i,toggleFold:c,canFold:E,promptTokens:(F=e.metadata)==null?void 0:F.promptTokens,completionTokens:(Q=e.metadata)==null?void 0:Q.completionTokens,timeToFirstToken:(q=e.metadata)==null?void 0:q.timeToFirstToken,generationTime:(K=e.metadata)==null?void 0:K.generationTime,headerActionsSlot:T&&T.length>0?m.jsx(m.Fragment,{children:T}):void 0}),M,m.jsx(sUe,{interactionId:e.id,response:e.response,toolCalls:(U=e.metadata)==null?void 0:U.toolCalls,toolResults:(re=e.metadata)==null?void 0:re.toolResults,reasoning:(G=e.metadata)==null?void 0:G.reasoning,isError:x,errorMessage:(ne=e.metadata)==null?void 0:ne.error,isFolded:i,toggleFold:c})]}),b&&R&&R.length>0&&m.jsx("div",{className:dt("absolute bottom-1 right-1 md:bottom-2 md:right-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:R})]})});a4.displayName="InteractionCard";const aUe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,i]=A.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return m.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?m.jsx(mk,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):m.jsx(a4,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const s=e[r];return m.jsxs("div",{className:"response-tabs-container flex flex-col",children:[m.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?m.jsx(_L,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):m.jsx(_L,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?m.jsx(WV,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?m.jsx(GV,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):m.jsx(yhe,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return m.jsxs(Et,{variant:"ghost",size:"sm",onClick:()=>i(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),m.jsxs("div",{className:"tab-content pt-1",children:[" ",s&&(s.id===n&&s.status==="STREAMING"?m.jsx(mk,{interactionId:s.id,renderSlot:t,showPrompt:!1},s.id):m.jsx(a4,{interaction:s,renderSlot:t,showPrompt:!1},s.id))]})]})};var oUe=A.createContext(void 0);function _y(e){const t=A.useContext(oUe);return e||t||"ltr"}function ow(e,[t,n]){return Math.min(n,Math.max(t,e))}function lUe(e,t){return A.useReducer((n,r)=>t[n][r]??n,e)}var zD="ScrollArea",[Mre,Kst]=Ca(zD),[cUe,Tl]=Mre(zD),Nre=A.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:i,scrollHideDelay:s=600,...a}=e,[o,l]=A.useState(null),[c,u]=A.useState(null),[d,h]=A.useState(null),[p,y]=A.useState(null),[b,x]=A.useState(null),[w,_]=A.useState(0),[S,C]=A.useState(0),[E,T]=A.useState(!1),[R,M]=A.useState(!1),N=tr(t,B=>l(B)),O=_y(i);return m.jsx(cUe,{scope:n,type:r,dir:O,scrollHideDelay:s,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:p,onScrollbarXChange:y,scrollbarXEnabled:E,onScrollbarXEnabledChange:T,scrollbarY:b,onScrollbarYChange:x,scrollbarYEnabled:R,onScrollbarYEnabledChange:M,onCornerWidthChange:_,onCornerHeightChange:C,children:m.jsx(pn.div,{dir:O,...a,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});Nre.displayName=zD;var jre="ScrollAreaViewport",Ore=A.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:i,...s}=e,a=Tl(jre,n),o=A.useRef(null),l=tr(t,o,a.onViewportChange);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),m.jsx(pn.div,{"data-radix-scroll-area-viewport":"",...s,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:m.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});Ore.displayName=jre;var mu="ScrollAreaScrollbar",Pre=A.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=Tl(mu,e.__scopeScrollArea),{onScrollbarXEnabledChange:s,onScrollbarYEnabledChange:a}=i,o=e.orientation==="horizontal";return A.useEffect(()=>(o?s(!0):a(!0),()=>{o?s(!1):a(!1)}),[o,s,a]),i.type==="hover"?m.jsx(uUe,{...r,ref:t,forceMount:n}):i.type==="scroll"?m.jsx(dUe,{...r,ref:t,forceMount:n}):i.type==="auto"?m.jsx(Dre,{...r,ref:t,forceMount:n}):i.type==="always"?m.jsx(UD,{...r,ref:t}):null});Pre.displayName=mu;var uUe=A.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=Tl(mu,e.__scopeScrollArea),[s,a]=A.useState(!1);return A.useEffect(()=>{const o=i.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),i.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[i.scrollArea,i.scrollHideDelay]),m.jsx(Hs,{present:n||s,children:m.jsx(Dre,{"data-state":s?"visible":"hidden",...r,ref:t})})}),dUe=A.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=Tl(mu,e.__scopeScrollArea),s=e.orientation==="horizontal",a=mT(()=>l("SCROLL_END"),100),[o,l]=lUe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return A.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,i.scrollHideDelay,l]),A.useEffect(()=>{const c=i.viewport,u=s?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const p=c[u];d!==p&&(l("SCROLL"),a()),d=p};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[i.viewport,s,l,a]),m.jsx(Hs,{present:n||o!=="hidden",children:m.jsx(UD,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Kt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Kt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),Dre=A.forwardRef((e,t)=>{const n=Tl(mu,e.__scopeScrollArea),{forceMount:r,...i}=e,[s,a]=A.useState(!1),o=e.orientation==="horizontal",l=mT(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return $0(n.viewport,l),$0(n.content,l),m.jsx(Hs,{present:r||s,children:m.jsx(UD,{"data-state":s?"visible":"hidden",...i,ref:t})})}),UD=A.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,i=Tl(mu,e.__scopeScrollArea),s=A.useRef(null),a=A.useRef(0),[o,l]=A.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=zre(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>s.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,p){return yUe(h,a.current,o,p)}return n==="horizontal"?m.jsx(fUe,{...u,ref:t,onThumbPositionChange:()=>{if(i.viewport&&s.current){const h=i.viewport.scrollLeft,p=W7(h,o,i.dir);s.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{i.viewport&&(i.viewport.scrollLeft=h)},onDragScroll:h=>{i.viewport&&(i.viewport.scrollLeft=d(h,i.dir))}}):n==="vertical"?m.jsx(hUe,{...u,ref:t,onThumbPositionChange:()=>{if(i.viewport&&s.current){const h=i.viewport.scrollTop,p=W7(h,o);s.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{i.viewport&&(i.viewport.scrollTop=h)},onDragScroll:h=>{i.viewport&&(i.viewport.scrollTop=d(h))}}):null}),fUe=A.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...i}=e,s=Tl(mu,e.__scopeScrollArea),[a,o]=A.useState(),l=A.useRef(null),c=tr(t,l,s.onScrollbarXChange);return A.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),m.jsx(Lre,{"data-orientation":"horizontal",...i,ref:c,sizes:n,style:{bottom:0,left:s.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:s.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":pT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(s.viewport){const h=s.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),qre(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&s.viewport&&a&&r({content:s.viewport.scrollWidth,viewport:s.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:yk(a.paddingLeft),paddingEnd:yk(a.paddingRight)}})}})}),hUe=A.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...i}=e,s=Tl(mu,e.__scopeScrollArea),[a,o]=A.useState(),l=A.useRef(null),c=tr(t,l,s.onScrollbarYChange);return A.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),m.jsx(Lre,{"data-orientation":"vertical",...i,ref:c,sizes:n,style:{top:0,right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":pT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(s.viewport){const h=s.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),qre(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&s.viewport&&a&&r({content:s.viewport.scrollHeight,viewport:s.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:yk(a.paddingTop),paddingEnd:yk(a.paddingBottom)}})}})}),[pUe,Fre]=Mre(mu),Lre=A.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:i,onThumbChange:s,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,p=Tl(mu,n),[y,b]=A.useState(null),x=tr(t,N=>b(N)),w=A.useRef(null),_=A.useRef(""),S=p.viewport,C=r.content-r.viewport,E=Fs(u),T=Fs(l),R=mT(d,10);function M(N){if(w.current){const O=N.clientX-w.current.left,B=N.clientY-w.current.top;c({x:O,y:B})}}return A.useEffect(()=>{const N=O=>{const B=O.target;(y==null?void 0:y.contains(B))&&E(O,C)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[S,y,C,E]),A.useEffect(T,[r,T]),$0(y,R),$0(p.content,R),m.jsx(pUe,{scope:n,scrollbar:y,hasThumb:i,onThumbChange:Fs(s),onThumbPointerUp:Fs(a),onThumbPositionChange:T,onThumbPointerDown:Fs(o),children:m.jsx(pn.div,{...h,ref:x,style:{position:"absolute",...h.style},onPointerDown:Kt(e.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),w.current=y.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),M(N))}),onPointerMove:Kt(e.onPointerMove,M),onPointerUp:Kt(e.onPointerUp,N=>{const O=N.target;O.hasPointerCapture(N.pointerId)&&O.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=_.current,p.viewport&&(p.viewport.style.scrollBehavior=""),w.current=null})})})}),gk="ScrollAreaThumb",Bre=A.forwardRef((e,t)=>{const{forceMount:n,...r}=e,i=Fre(gk,e.__scopeScrollArea);return m.jsx(Hs,{present:n||i.hasThumb,children:m.jsx(mUe,{ref:t,...r})})}),mUe=A.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...i}=e,s=Tl(gk,n),a=Fre(gk,n),{onThumbPositionChange:o}=a,l=tr(t,d=>a.onThumbChange(d)),c=A.useRef(void 0),u=mT(()=>{c.current&&(c.current(),c.current=void 0)},100);return A.useEffect(()=>{const d=s.viewport;if(d){const h=()=>{if(u(),!c.current){const p=bUe(d,o);c.current=p,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[s.viewport,u,o]),m.jsx(pn.div,{"data-state":a.hasThumb?"visible":"hidden",...i,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Kt(e.onPointerDownCapture,d=>{const p=d.target.getBoundingClientRect(),y=d.clientX-p.left,b=d.clientY-p.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Kt(e.onPointerUp,a.onThumbPointerUp)})});Bre.displayName=gk;var qD="ScrollAreaCorner",$re=A.forwardRef((e,t)=>{const n=Tl(qD,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?m.jsx(gUe,{...e,ref:t}):null});$re.displayName=qD;var gUe=A.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,i=Tl(qD,n),[s,a]=A.useState(0),[o,l]=A.useState(0),c=!!(s&&o);return $0(i.scrollbarX,()=>{var d;const u=((d=i.scrollbarX)==null?void 0:d.offsetHeight)||0;i.onCornerHeightChange(u),l(u)}),$0(i.scrollbarY,()=>{var d;const u=((d=i.scrollbarY)==null?void 0:d.offsetWidth)||0;i.onCornerWidthChange(u),a(u)}),c?m.jsx(pn.div,{...r,ref:t,style:{width:s,height:o,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function yk(e){return e?parseInt(e,10):0}function zre(e,t){const n=e/t;return isNaN(n)?0:n}function pT(e){const t=zre(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function yUe(e,t,n,r="ltr"){const i=pT(n),s=i/2,a=t||s,o=i-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return Ure([l,c],d)(e)}function W7(e,t,n="ltr"){const r=pT(t),i=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=t.scrollbar.size-i,a=t.content-t.viewport,o=s-r,l=n==="ltr"?[0,a]:[a*-1,0],c=ow(e,l);return Ure([0,a],[0,o])(c)}function Ure(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function qre(e,t){return e>0&&e<t}var bUe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function i(){const s={left:e.scrollLeft,top:e.scrollTop},a=n.left!==s.left,o=n.top!==s.top;(a||o)&&t(),n=s,r=window.requestAnimationFrame(i)}(),()=>window.cancelAnimationFrame(r)};function mT(e,t){const n=Fs(e),r=A.useRef(0);return A.useEffect(()=>()=>window.clearTimeout(r.current),[]),A.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function $0(e,t){const n=Fs(t);sa(()=>{let r=0;if(e){const i=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return i.observe(e),()=>{window.cancelAnimationFrame(r),i.unobserve(e)}}},[e,n])}var vUe=Nre,xUe=Ore,wUe=$re;function Sa({className:e,children:t,...n}){return m.jsxs(vUe,{"data-slot":"scroll-area",className:dt("relative",e),...n,children:[m.jsx(xUe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),m.jsx(_Ue,{}),m.jsx(wUe,{})]})}function _Ue({className:e,orientation:t="vertical",...n}){return m.jsx(Pre,{"data-slot":"scroll-area-scrollbar",orientation:t,className:dt("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:m.jsx(Bre,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Pr({className:e,...t}){return m.jsx("div",{"data-slot":"skeleton",className:dt("bg-accent animate-pulse rounded-md",e),...t})}const SUe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[m.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:m.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),m.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[m.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),m.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),m.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[m.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),m.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),m.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:m.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function VD({className:e,...t}){return m.jsx("div",{"data-slot":"card",className:dt("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function HD({className:e,...t}){return m.jsx("div",{"data-slot":"card-header",className:dt("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function WD({className:e,...t}){return m.jsx("div",{"data-slot":"card-title",className:dt("leading-none font-semibold",e),...t})}function Vre({className:e,...t}){return m.jsx("div",{"data-slot":"card-description",className:dt("text-muted-foreground text-sm",e),...t})}function GD({className:e,...t}){return m.jsx("div",{"data-slot":"card-content",className:dt("px-6",e),...t})}const kr={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},CUe=({title:e,description:t,icon:n,onClick:r})=>m.jsxs(VD,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[m.jsxs(HD,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[m.jsxs(WD,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),m.jsx(rfe,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),m.jsx(GD,{children:m.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),Hre=()=>{const e=(r,i)=>{Be.emit(kr.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:i})},t=()=>{Be.emit(kr.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:m.jsx(T2,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:m.jsx(p3,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:m.jsx(eO,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:m.jsx(A2,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:m.jsx(Zv,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:m.jsx(rc,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>m.jsx(CUe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},G7=()=>m.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[m.jsx(SUe,{className:"h-16 w-16 text-muted-foreground mb-4"}),m.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),m.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),m.jsx(Hre,{})]}),KD=A.createContext({});function YD(e){const t=A.useRef(null);return t.current===null&&(t.current=e()),t.current}const ZD=typeof window<"u",Wre=ZD?A.useLayoutEffect:A.useEffect,gT=A.createContext(null),XD=A.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class kUe extends A.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,i=r instanceof HTMLElement&&r.offsetWidth||0,s=this.props.sizeRef.current;s.height=n.offsetHeight||0,s.width=n.offsetWidth||0,s.top=n.offsetTop,s.left=n.offsetLeft,s.right=i-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function EUe({children:e,isPresent:t,anchorX:n}){const r=A.useId(),i=A.useRef(null),s=A.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=A.useContext(XD);return A.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=s.current;if(t||!i.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;i.current.dataset.motionPopId=r;const p=document.createElement("style");return a&&(p.nonce=a),document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(p)&&document.head.removeChild(p)}},[t]),m.jsx(kUe,{isPresent:t,childRef:i,sizeRef:s,children:A.cloneElement(e,{ref:i})})}const TUe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a,anchorX:o})=>{const l=YD(AUe),c=A.useId();let u=!0,d=A.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:i,onExitComplete:h=>{l.set(h,!0);for(const p of l.values())if(!p)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return s&&u&&(d={...d}),A.useMemo(()=>{l.forEach((h,p)=>l.set(p,!1))},[n]),A.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=m.jsx(EUe,{isPresent:n,anchorX:o,children:e})),m.jsx(gT.Provider,{value:d,children:e})};function AUe(){return new Map}function Gre(e=!0){const t=A.useContext(gT);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=t,s=A.useId();A.useEffect(()=>{if(e)return i(s)},[e]);const a=A.useCallback(()=>e&&r&&r(s),[s,r,e]);return!n&&r?[!1,a]:[!0]}const TS=e=>e.key||"";function K7(e){const t=[];return A.Children.forEach(e,n=>{A.isValidElement(n)&&t.push(n)}),t}const RUe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=Gre(a),u=A.useMemo(()=>K7(e),[e]),d=a&&!l?[]:u.map(TS),h=A.useRef(!0),p=A.useRef(u),y=YD(()=>new Map),[b,x]=A.useState(u),[w,_]=A.useState(u);Wre(()=>{h.current=!1,p.current=u;for(let E=0;E<w.length;E++){const T=TS(w[E]);d.includes(T)?y.delete(T):y.get(T)!==!0&&y.set(T,!1)}},[w,d.length,d.join("-")]);const S=[];if(u!==b){let E=[...u];for(let T=0;T<w.length;T++){const R=w[T],M=TS(R);d.includes(M)||(E.splice(T,0,R),S.push(R))}return s==="wait"&&S.length&&(E=S),_(K7(E)),x(u),null}const{forceRender:C}=A.useContext(KD);return m.jsx(m.Fragment,{children:w.map(E=>{const T=TS(E),R=a&&!l?!1:u===w||d.includes(T),M=()=>{if(y.has(T))y.set(T,!0);else return;let N=!0;y.forEach(O=>{O||(N=!1)}),N&&(C==null||C(),_(p.current),a&&(c==null||c()),r&&r())};return m.jsx(TUe,{isPresent:R,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:i,mode:s,onExitComplete:R?void 0:M,anchorX:o,children:E},T)})})},AS=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Y7={value:null};function IUe(e,t){let n=new Set,r=new Set,i=!1,s=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,p=!1)=>{const b=p&&i?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,i){s=!0;return}i=!0,[n,r]=[r,n],n.forEach(c),t&&Y7.value&&Y7.value.frameloop[t].push(l),l=0,n.clear(),i=!1,s&&(s=!1,u.process(d))}};return u}const xd={},MUe=40;function Kre(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,a=AS.reduce((S,C)=>(S[C]=IUe(s,t?C:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:p,postRender:y}=a,b=()=>{const S=xd.useManualTiming?i.timestamp:performance.now();n=!1,xd.useManualTiming||(i.delta=r?1e3/60:Math.max(Math.min(S-i.timestamp,MUe),1)),i.timestamp=S,i.isProcessing=!0,o.process(i),l.process(i),c.process(i),u.process(i),d.process(i),h.process(i),p.process(i),y.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(b))},x=()=>{n=!0,r=!0,i.isProcessing||e(b)};return{schedule:AS.reduce((S,C)=>{const E=a[C];return S[C]=(T,R=!1,M=!1)=>(n||x(),E.schedule(T,R,M)),S},{}),cancel:S=>{for(let C=0;C<AS.length;C++)a[AS[C]].cancel(S)},state:i,steps:a}}const bl=e=>e,{schedule:Ui,cancel:eh,state:ta,steps:xN}=Kre(typeof requestAnimationFrame<"u"?requestAnimationFrame:bl,!0),Yre=A.createContext({strict:!1}),Z7={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},z0={};for(const e in Z7)z0[e]={isEnabled:t=>Z7[e].some(n=>!!t[n])};function NUe(e){for(const t in e)z0[t]={...z0[t],...e[t]}}const jUe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function bk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||jUe.has(e)}let Zre=e=>!bk(e);function OUe(e){e&&(Zre=t=>t.startsWith("on")?!bk(t):e(t))}try{OUe(require("@emotion/is-prop-valid").default)}catch{}function PUe(e,t,n){const r={};for(const i in e)i==="values"&&typeof e.values=="object"||(Zre(i)||n===!0&&bk(i)||!t&&!bk(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}function DUe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,i)=>i==="create"?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}const yT=A.createContext({});function bT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function lw(e){return typeof e=="string"||Array.isArray(e)}const JD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],QD=["initial",...JD];function vT(e){return bT(e.animate)||QD.some(t=>lw(e[t]))}function Xre(e){return!!(vT(e)||e.variants)}function FUe(e,t){if(vT(e)){const{initial:n,animate:r}=e;return{initial:n===!1||lw(n)?n:void 0,animate:lw(r)?r:void 0}}return e.inherit!==!1?t:{}}function LUe(e){const{initial:t,animate:n}=FUe(e,A.useContext(yT));return A.useMemo(()=>({initial:t,animate:n}),[X7(t),X7(n)])}function X7(e){return Array.isArray(e)?e.join(" "):e}const BUe=Symbol.for("motionComponentSymbol");function jg(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function $Ue(e,t,n){return A.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):jg(n)&&(n.current=r))},[t])}const e6=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),zUe="framerAppearId",Jre="data-"+e6(zUe),Qre=A.createContext({}),{schedule:t6}=Kre(queueMicrotask,!1);function UUe(e,t,n,r,i){var b,x;const{visualElement:s}=A.useContext(yT),a=A.useContext(Yre),o=A.useContext(gT),l=A.useContext(XD).reducedMotion,c=A.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=A.useContext(Qre);u&&!u.projection&&i&&(u.type==="html"||u.type==="svg")&&qUe(c.current,n,i,d);const h=A.useRef(!1);A.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const p=n[Jre],y=A.useRef(!!p&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,p))&&((x=window.MotionHasOptimisedAnimation)==null?void 0:x.call(window,p)));return Wre(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),t6.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),A.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,p)}),y.current=!1))}),u}function qUe(e,t,n,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:eie(e.parent)),e.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&jg(o),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function eie(e){if(e)return e.options.allowProjection!==!1?e.projection:eie(e.parent)}let n6=()=>{};function VUe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:i}){e&&NUe(e);function s(o,l){let c;const u={...A.useContext(XD),...o,layoutId:HUe(o)},{isStatic:d}=u,h=LUe(o),p=r(o,d);if(!d&&ZD){WUe();const y=GUe(u);c=y.MeasureLayout,h.visualElement=UUe(i,p,u,t,y.ProjectionNode)}return m.jsxs(yT.Provider,{value:h,children:[c&&h.visualElement?m.jsx(c,{visualElement:h.visualElement,...u}):null,n(i,o,$Ue(p,h.visualElement,l),p,d,h.visualElement)]})}s.displayName=`motion.${typeof i=="string"?i:`create(${i.displayName??i.name??""})`}`;const a=A.forwardRef(s);return a[BUe]=i,a}function HUe({layoutId:e}){const t=A.useContext(KD).id;return t&&e!==void 0?t+"-"+e:e}function WUe(e,t){A.useContext(Yre).strict}function GUe(e){const{drag:t,layout:n}=z0;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const tie=e=>t=>typeof t=="string"&&t.startsWith(e),r6=tie("--"),KUe=tie("var(--"),i6=e=>KUe(e)?YUe.test(e.split("/*")[0].trim()):!1,YUe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,cw={};function ZUe(e){for(const t in e)cw[t]=e[t],r6(t)&&(cw[t].isCSSVariable=!0)}const Sy=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Cy=new Set(Sy);function nie(e,{layout:t,layoutId:n}){return Cy.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!cw[e]||e==="opacity")}const ya=e=>!!(e&&e.getVelocity),rie=(e,t)=>t&&typeof e=="number"?t.transform(e):e,wd=(e,t,n)=>n>t?t:n<e?e:n,ky={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},uw={...ky,transform:e=>wd(0,1,e)},RS={...ky,default:1},J7={...ky,transform:Math.round},v1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),vf=v1("deg"),Zc=v1("%"),Zn=v1("px"),XUe=v1("vh"),JUe=v1("vw"),Q7={...Zc,parse:e=>Zc.parse(e)/100,transform:e=>Zc.transform(e*100)},QUe={rotate:vf,rotateX:vf,rotateY:vf,rotateZ:vf,scale:RS,scaleX:RS,scaleY:RS,scaleZ:RS,skew:vf,skewX:vf,skewY:vf,distance:Zn,translateX:Zn,translateY:Zn,translateZ:Zn,x:Zn,y:Zn,z:Zn,perspective:Zn,transformPerspective:Zn,opacity:uw,originX:Q7,originY:Q7,originZ:Zn},s6={borderWidth:Zn,borderTopWidth:Zn,borderRightWidth:Zn,borderBottomWidth:Zn,borderLeftWidth:Zn,borderRadius:Zn,radius:Zn,borderTopLeftRadius:Zn,borderTopRightRadius:Zn,borderBottomRightRadius:Zn,borderBottomLeftRadius:Zn,width:Zn,maxWidth:Zn,height:Zn,maxHeight:Zn,top:Zn,right:Zn,bottom:Zn,left:Zn,padding:Zn,paddingTop:Zn,paddingRight:Zn,paddingBottom:Zn,paddingLeft:Zn,margin:Zn,marginTop:Zn,marginRight:Zn,marginBottom:Zn,marginLeft:Zn,backgroundPositionX:Zn,backgroundPositionY:Zn,...QUe,zIndex:J7,fillOpacity:uw,strokeOpacity:uw,numOctaves:J7},eqe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tqe=Sy.length;function nqe(e,t,n){let r="",i=!0;for(let s=0;s<tqe;s++){const a=Sy[s],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=rie(o,s6[a]);if(!l){i=!1;const u=eqe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}function a6(e,t,n){const{style:r,vars:i,transformOrigin:s}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(Cy.has(l)){a=!0;continue}else if(r6(l)){i[l]=c;continue}else{const u=rie(c,s6[l]);l.startsWith("origin")?(o=!0,s[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=nqe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=s;r.transformOrigin=`${l} ${c} ${u}`}}const o6=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function iie(e,t,n){for(const r in t)!ya(t[r])&&!nie(r,n)&&(e[r]=t[r])}function rqe({transformTemplate:e},t){return A.useMemo(()=>{const n=o6();return a6(n,t,e),Object.assign({},n.vars,n.style)},[t])}function iqe(e,t){const n=e.style||{},r={};return iie(r,n,e),Object.assign(r,rqe(e,t)),r}function sqe(e,t){const n={},r=iqe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const aqe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function l6(e){return typeof e!="string"||e.includes("-")?!1:!!(aqe.indexOf(e)>-1||/[A-Z]/u.test(e))}const oqe={offset:"stroke-dashoffset",array:"stroke-dasharray"},lqe={offset:"strokeDashoffset",array:"strokeDasharray"};function cqe(e,t,n=1,r=0,i=!0){e.pathLength=1;const s=i?oqe:lqe;e[s.offset]=Zn.transform(-r);const a=Zn.transform(t),o=Zn.transform(n);e[s.array]=`${a} ${o}`}function sie(e,{attrX:t,attrY:n,attrScale:r,pathLength:i,pathSpacing:s=1,pathOffset:a=0,...o},l,c,u){if(a6(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),i!==void 0&&cqe(d,i,s,a,!1)}const aie=()=>({...o6(),attrs:{}}),oie=e=>typeof e=="string"&&e.toLowerCase()==="svg";function uqe(e,t,n,r){const i=A.useMemo(()=>{const s=aie();return sie(s,t,oie(r),e.transformTemplate,e.style),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};iie(s,e.style,e),i.style={...s,...i.style}}return i}function dqe(e=!1){return(n,r,i,{latestValues:s},a)=>{const l=(l6(n)?uqe:sqe)(r,s,a,n),c=PUe(r,typeof n=="string",e),u=n!==A.Fragment?{...c,...l,ref:i}:{},{children:d}=r,h=A.useMemo(()=>ya(d)?d.get():d,[d]);return A.createElement(n,{...u,children:h})}}function eU(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function c6(e,t,n,r){if(typeof t=="function"){const[i,s]=eU(r);t=t(n!==void 0?n:e.custom,i,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[i,s]=eU(r);t=t(n!==void 0?n:e.custom,i,s)}return t}function b2(e){return ya(e)?e.get():e}function fqe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,i){return{latestValues:hqe(n,r,i,e),renderState:t()}}const lie=e=>(t,n)=>{const r=A.useContext(yT),i=A.useContext(gT),s=()=>fqe(e,t,r,i);return n?s():YD(s)};function hqe(e,t,n,r){const i={},s=r(e,{});for(const h in s)i[h]=b2(s[h]);let{initial:a,animate:o}=e;const l=vT(e),c=Xre(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!bT(d)){const h=Array.isArray(d)?d:[d];for(let p=0;p<h.length;p++){const y=c6(e,h[p]);if(y){const{transitionEnd:b,transition:x,...w}=y;for(const _ in w){let S=w[_];if(Array.isArray(S)){const C=u?S.length-1:0;S=S[C]}S!==null&&(i[_]=S)}for(const _ in b)i[_]=b[_]}}}return i}function u6(e,t,n){var s;const{style:r}=e,i={};for(const a in r)(ya(r[a])||t.style&&ya(t.style[a])||nie(a,e)||((s=n==null?void 0:n.getValue(a))==null?void 0:s.liveStyle)!==void 0)&&(i[a]=r[a]);return i}const pqe={useVisualState:lie({scrapeMotionValuesFromProps:u6,createRenderState:o6})};function cie(e,t,n){const r=u6(e,t,n);for(const i in e)if(ya(e[i])||ya(t[i])){const s=Sy.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=e[i]}return r}const mqe={useVisualState:lie({scrapeMotionValuesFromProps:cie,createRenderState:aie})};function gqe(e,t){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...l6(r)?mqe:pqe,preloadedFeatures:e,useRender:dqe(i),createVisualElement:t,Component:r};return VUe(a)}}function dw(e,t,n){const r=e.getProps();return c6(r,t,n!==void 0?n:r.custom,e)}const o4=e=>Array.isArray(e);let v2;function yqe(){v2=void 0}const co={now:()=>(v2===void 0&&co.set(ta.isProcessing||xd.useManualTiming?ta.timestamp:performance.now()),v2),set:e=>{v2=e,queueMicrotask(yqe)}};function d6(e,t){e.indexOf(t)===-1&&e.push(t)}function f6(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class h6{constructor(){this.subscriptions=[]}add(t){return d6(this.subscriptions,t),()=>f6(this.subscriptions,t)}notify(t,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,n,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function uie(e,t){return t?e*(1e3/t):0}const tU=30,bqe=e=>!isNaN(parseFloat(e));class vqe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{var a,o;const s=co.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),i&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=co.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=bqe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new h6);const r=this.events[t].add(n);return t==="change"?()=>{r(),Ui.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=co.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>tU)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,tU);return uie(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function fw(e,t){return new vqe(e,t)}function xqe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,fw(n))}function wqe(e){return o4(e)?e[e.length-1]||0:e}function _qe(e,t){const n=dw(e,t);let{transitionEnd:r={},transition:i={},...s}=n||{};s={...s,...r};for(const a in s){const o=wqe(s[a]);xqe(e,a,o)}}function Sqe(e){return!!(ya(e)&&e.add)}function l4(e,t){const n=e.getValue("willChange");if(Sqe(n))return n.add(t);if(!n&&xd.WillChange){const r=new xd.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function die(e){return e.props[Jre]}const Cqe=e=>e!==null;function kqe(e,{repeat:t,repeatType:n="loop"},r){const i=e.filter(Cqe),s=t&&n!=="loop"&&t%2===1?0:i.length-1;return i[s]}const Eqe={type:"spring",stiffness:500,damping:25,restSpeed:10},Tqe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Aqe={type:"keyframes",duration:.8},Rqe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Iqe=(e,{keyframes:t})=>t.length>2?Aqe:Cy.has(e)?e.startsWith("scale")?Tqe(t[1]):Eqe:Rqe;function Mqe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function p6(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Xc=e=>e*1e3,Jc=e=>e/1e3,Bv=e=>Math.round(e*1e5)/1e5,m6=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Nqe(e){return e==null}const jqe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,g6=(e,t)=>n=>!!(typeof n=="string"&&jqe.test(n)&&n.startsWith(e)||t&&!Nqe(n)&&Object.prototype.hasOwnProperty.call(n,t)),fie=(e,t,n)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(m6);return{[e]:parseFloat(i),[t]:parseFloat(s),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Oqe=e=>wd(0,255,e),wN={...ky,transform:e=>Math.round(Oqe(e))},bp={test:g6("rgb","red"),parse:fie("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+wN.transform(e)+", "+wN.transform(t)+", "+wN.transform(n)+", "+Bv(uw.transform(r))+")"};function Pqe(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const c4={test:g6("#"),parse:Pqe,transform:bp.transform},Og={test:g6("hsl","hue"),parse:fie("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Zc.transform(Bv(t))+", "+Zc.transform(Bv(n))+", "+Bv(uw.transform(r))+")"},pa={test:e=>bp.test(e)||c4.test(e)||Og.test(e),parse:e=>bp.test(e)?bp.parse(e):Og.test(e)?Og.parse(e):c4.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?bp.transform(e):Og.transform(e)},Dqe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Fqe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(m6))==null?void 0:t.length)||0)+(((n=e.match(Dqe))==null?void 0:n.length)||0)>0}const hie="number",pie="color",Lqe="var",Bqe="var(",nU="${}",$qe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function hw(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=t.replace($qe,l=>(pa.test(l)?(r.color.push(s),i.push(pie),n.push(pa.parse(l))):l.startsWith(Bqe)?(r.var.push(s),i.push(Lqe),n.push(l)):(r.number.push(s),i.push(hie),n.push(parseFloat(l))),++s,nU)).split(nU);return{values:n,split:o,indexes:r,types:i}}function mie(e){return hw(e).values}function gie(e){const{split:t,types:n}=hw(e),r=t.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=t[a],i[a]!==void 0){const o=n[a];o===hie?s+=Bv(i[a]):o===pie?s+=pa.transform(i[a]):s+=i[a]}return s}}const zqe=e=>typeof e=="number"?0:e;function Uqe(e){const t=mie(e);return gie(e)(t.map(zqe))}const th={test:Fqe,parse:mie,createTransformer:gie,getAnimatableNone:Uqe};function _N(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function qqe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let i=0,s=0,a=0;if(!t)i=s=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;i=_N(l,o,e+1/3),s=_N(l,o,e),a=_N(l,o,e-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function vk(e,t){return n=>n>0?t:e}const $i=(e,t,n)=>e+(t-e)*n,SN=(e,t,n)=>{const r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},Vqe=[c4,bp,Og],Hqe=e=>Vqe.find(t=>t.test(e));function rU(e){const t=Hqe(e);if(!t)return!1;let n=t.parse(e);return t===Og&&(n=qqe(n)),n}const iU=(e,t)=>{const n=rU(e),r=rU(t);if(!n||!r)return vk(e,t);const i={...n};return s=>(i.red=SN(n.red,r.red,s),i.green=SN(n.green,r.green,s),i.blue=SN(n.blue,r.blue,s),i.alpha=$i(n.alpha,r.alpha,s),bp.transform(i))},u4=new Set(["none","hidden"]);function Wqe(e,t){return u4.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const Gqe=(e,t)=>n=>t(e(n)),x1=(...e)=>e.reduce(Gqe);function Kqe(e,t){return n=>$i(e,t,n)}function y6(e){return typeof e=="number"?Kqe:typeof e=="string"?i6(e)?vk:pa.test(e)?iU:Xqe:Array.isArray(e)?yie:typeof e=="object"?pa.test(e)?iU:Yqe:vk}function yie(e,t){const n=[...e],r=n.length,i=e.map((s,a)=>y6(s)(s,t[a]));return s=>{for(let a=0;a<r;a++)n[a]=i[a](s);return n}}function Yqe(e,t){const n={...e,...t},r={};for(const i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=y6(e[i])(e[i],t[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}}function Zqe(e,t){const n=[],r={color:0,var:0,number:0};for(let i=0;i<t.values.length;i++){const s=t.types[i],a=e.indexes[s][r[s]],o=e.values[a]??0;n[i]=o,r[s]++}return n}const Xqe=(e,t)=>{const n=th.createTransformer(t),r=hw(e),i=hw(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?u4.has(e)&&!i.values.length||u4.has(t)&&!r.values.length?Wqe(e,t):x1(yie(Zqe(r,i),i.values),n):vk(e,t)};function bie(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?$i(e,t,n):y6(e)(e,t)}const Jqe=e=>{const t=({timestamp:n})=>e(n);return{start:()=>Ui.update(t,!0),stop:()=>eh(t),now:()=>ta.isProcessing?ta.timestamp:co.now()}},vie=(e,t,n=10)=>{let r="";const i=Math.max(Math.round(t/n),2);for(let s=0;s<i;s++)r+=e(s/(i-1))+", ";return`linear(${r.substring(0,r.length-2)})`},xk=2e4;function b6(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<xk;)t+=n,r=e.next(t);return t>=xk?1/0:t}function Qqe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),i=Math.min(b6(r),xk);return{type:"keyframes",ease:s=>r.next(i*s).value/t,duration:Jc(i)}}const eVe=5;function xie(e,t,n){const r=Math.max(t-eVe,0);return uie(n-e(r),t-r)}const Hi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},sU=.001;function tVe({duration:e=Hi.duration,bounce:t=Hi.bounce,velocity:n=Hi.velocity,mass:r=Hi.mass}){let i,s,a=1-t;a=wd(Hi.minDamping,Hi.maxDamping,a),e=wd(Hi.minDuration,Hi.maxDuration,Jc(e)),a<1?(i=c=>{const u=c*a,d=u*e,h=u-n,p=d4(c,a),y=Math.exp(-d);return sU-h/p*y},s=c=>{const d=c*a*e,h=d*n+n,p=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=d4(Math.pow(c,2),a);return(-i(c)+sU>0?-1:1)*((h-p)*y)/b}):(i=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},s=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=rVe(i,s,o);if(e=Xc(e),isNaN(l))return{stiffness:Hi.stiffness,damping:Hi.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const nVe=12;function rVe(e,t,n){let r=n;for(let i=1;i<nVe;i++)r=r-e(r)/t(r);return r}function d4(e,t){return e*Math.sqrt(1-t*t)}const iVe=["duration","bounce"],sVe=["stiffness","damping","mass"];function aU(e,t){return t.some(n=>e[n]!==void 0)}function aVe(e){let t={velocity:Hi.velocity,stiffness:Hi.stiffness,damping:Hi.damping,mass:Hi.mass,isResolvedFromDuration:!1,...e};if(!aU(e,sVe)&&aU(e,iVe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,s=2*wd(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:Hi.mass,stiffness:i,damping:s}}else{const n=tVe(e);t={...t,...n,mass:Hi.mass},t.isResolvedFromDuration=!0}return t}function wk(e=Hi.visualDuration,t=Hi.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:i}=n;const s=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:p}=aVe({...n,velocity:-Jc(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),x=a-s,w=Jc(Math.sqrt(l/u)),_=Math.abs(x)<5;r||(r=_?Hi.restSpeed.granular:Hi.restSpeed.default),i||(i=_?Hi.restDelta.granular:Hi.restDelta.default);let S;if(b<1){const E=d4(w,b);S=T=>{const R=Math.exp(-b*w*T);return a-R*((y+b*w*x)/E*Math.sin(E*T)+x*Math.cos(E*T))}}else if(b===1)S=E=>a-Math.exp(-w*E)*(x+(y+w*x)*E);else{const E=w*Math.sqrt(b*b-1);S=T=>{const R=Math.exp(-b*w*T),M=Math.min(E*T,300);return a-R*((y+b*w*x)*Math.sinh(M)+E*x*Math.cosh(M))/E}}const C={calculatedDuration:p&&d||null,next:E=>{const T=S(E);if(p)o.done=E>=d;else{let R=E===0?y:0;b<1&&(R=E===0?Xc(y):xie(S,E,T));const M=Math.abs(R)<=r,N=Math.abs(a-T)<=i;o.done=M&&N}return o.value=o.done?a:T,o},toString:()=>{const E=Math.min(b6(C),xk),T=vie(R=>C.next(E*R).value,E,30);return E+"ms "+T},toTransition:()=>{}};return C}wk.applyToOptions=e=>{const t=Qqe(e,100,wk);return e.ease=t.ease,e.duration=Xc(t.duration),e.type="keyframes",e};function f4({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},p=M=>o!==void 0&&M<o||l!==void 0&&M>l,y=M=>o===void 0?l:l===void 0||Math.abs(o-M)<Math.abs(l-M)?o:l;let b=n*t;const x=d+b,w=a===void 0?x:a(x);w!==x&&(b=w-d);const _=M=>-b*Math.exp(-M/r),S=M=>w+_(M),C=M=>{const N=_(M),O=S(M);h.done=Math.abs(N)<=c,h.value=h.done?w:O};let E,T;const R=M=>{p(h.value)&&(E=M,T=wk({keyframes:[h.value,y(h.value)],velocity:xie(S,M,h.value),damping:i,stiffness:s,restDelta:c,restSpeed:u}))};return R(0),{calculatedDuration:null,next:M=>{let N=!1;return!T&&E===void 0&&(N=!0,C(M),R(M)),E!==void 0&&M>=E?T.next(M-E):(!N&&C(M),h)}}}const pw=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function oVe(e,t,n){const r=[],i=n||xd.mix||bie,s=e.length-1;for(let a=0;a<s;a++){let o=i(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||bl:t;o=x1(l,o)}r.push(o)}return r}function lVe(e,t,{clamp:n=!0,ease:r,mixer:i}={}){const s=e.length;if(n6(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=oVe(t,r,i),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=pw(e[d],e[d+1],u);return o[d](h)};return n?u=>c(wd(e[0],e[s-1],u)):c}function cVe(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=pw(0,t,r);e.push($i(n,1,i))}}function uVe(e){const t=[0];return cVe(t,e.length-1),t}function dVe(e,t){return e.map(n=>n*t)}const wie=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,fVe=1e-7,hVe=12;function pVe(e,t,n,r,i){let s,a,o=0;do a=t+(n-t)/2,s=wie(a,r,i)-e,s>0?n=a:t=a;while(Math.abs(s)>fVe&&++o<hVe);return a}function w1(e,t,n,r){if(e===t&&n===r)return bl;const i=s=>pVe(s,0,1,e,n);return s=>s===0||s===1?s:wie(i(s),t,r)}const mVe=w1(.42,0,1,1),gVe=w1(0,0,.58,1),_ie=w1(.42,0,.58,1),yVe=e=>Array.isArray(e)&&typeof e[0]!="number",Sie=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Cie=e=>t=>1-e(1-t),kie=w1(.33,1.53,.69,.99),v6=Cie(kie),Eie=Sie(v6),Tie=e=>(e*=2)<1?.5*v6(e):.5*(2-Math.pow(2,-10*(e-1))),x6=e=>1-Math.sin(Math.acos(e)),Aie=Cie(x6),Rie=Sie(x6),Iie=e=>Array.isArray(e)&&typeof e[0]=="number",bVe={linear:bl,easeIn:mVe,easeInOut:_ie,easeOut:gVe,circIn:x6,circInOut:Rie,circOut:Aie,backIn:v6,backInOut:Eie,backOut:kie,anticipate:Tie},vVe=e=>typeof e=="string",oU=e=>{if(Iie(e)){n6(e.length===4);const[t,n,r,i]=e;return w1(t,n,r,i)}else if(vVe(e))return bVe[e];return e};function xVe(e,t){return e.map(()=>t||_ie).splice(0,e.length-1)}function $v({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const i=yVe(r)?r.map(oU):oU(r),s={done:!1,value:t[0]},a=dVe(n&&n.length===t.length?n:uVe(t),e),o=lVe(a,t,{ease:Array.isArray(i)?i:xVe(t,i)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}const wVe=e=>e!==null;function w6(e,{repeat:t,repeatType:n="loop"},r,i=1){const s=e.filter(wVe),o=i<0||t&&n!=="loop"&&t%2===1?0:s.length-1;return!o||r===void 0?s[o]:r}const _Ve={decay:f4,inertia:f4,tween:$v,keyframes:$v,spring:wk};function Mie(e){typeof e.type=="string"&&(e.type=_Ve[e.type])}class _6{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const SVe=e=>e/100;class Nie extends _6{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==co.now()&&this.tick(co.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;Mie(t);const{type:n=$v,repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=t;let{keyframes:o}=t;const l=n||$v;l!==$v&&typeof o[0]!="number"&&(this.mixKeyframes=x1(SVe,bie(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});s==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=b6(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+i,this.totalDuration=this.resolvedDuration*(r+1)-i,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:i,mixKeyframes:s,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:p,type:y,onUpdate:b,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-i/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const w=this.currentTime-c*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?w<0:w>i;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=i);let S=this.currentTime,C=r;if(d){const M=Math.min(this.currentTime,i)/o;let N=Math.floor(M),O=M%1;!O&&M>=1&&(O=1),O===1&&N--,N=Math.min(N,d+1),!!(N%2)&&(h==="reverse"?(O=1-O,p&&(O-=p/o)):h==="mirror"&&(C=a)),S=wd(0,1,O)*o}const E=_?{done:!1,value:u[0]}:C.next(S);s&&(E.value=s(E.value));let{done:T}=E;!_&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=i:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return R&&y!==f4&&(E.value=w6(u,this.options,x,this.speed)),b&&b(E.value),R&&this.finish(),E}then(t,n){return this.finished.then(t,n)}get duration(){return Jc(this.calculatedDuration)}get time(){return Jc(this.currentTime)}set time(t){t=Xc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(co.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Jc(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Jqe,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),n&&n();const i=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=i):this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime||(this.startTime=r??i),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(co.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function CVe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const vp=e=>e*180/Math.PI,h4=e=>{const t=vp(Math.atan2(e[1],e[0]));return p4(t)},kVe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:h4,rotateZ:h4,skewX:e=>vp(Math.atan(e[1])),skewY:e=>vp(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},p4=e=>(e=e%360,e<0&&(e+=360),e),lU=h4,cU=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),uU=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),EVe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:cU,scaleY:uU,scale:e=>(cU(e)+uU(e))/2,rotateX:e=>p4(vp(Math.atan2(e[6],e[5]))),rotateY:e=>p4(vp(Math.atan2(-e[2],e[0]))),rotateZ:lU,rotate:lU,skewX:e=>vp(Math.atan(e[4])),skewY:e=>vp(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function dU(e){return e.includes("scale")?1:0}function m4(e,t){if(!e||e==="none")return dU(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,i;if(n)r=EVe,i=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=kVe,i=o}if(!i)return dU(t);const s=r[t],a=i[1].split(",").map(AVe);return typeof s=="function"?s(a):a[s]}const TVe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return m4(n,t)};function AVe(e){return parseFloat(e.trim())}const fU=e=>e===ky||e===Zn,RVe=new Set(["x","y","z"]),IVe=Sy.filter(e=>!RVe.has(e));function MVe(e){const t=[];return IVe.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const Cp={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>m4(t,"x"),y:(e,{transform:t})=>m4(t,"y")};Cp.translateX=Cp.x;Cp.translateY=Cp.y;const kp=new Set;let g4=!1,y4=!1,b4=!1;function jie(){if(y4){const e=Array.from(kp).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const i=MVe(r);i.length&&(n.set(r,i),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}y4=!1,g4=!1,kp.forEach(e=>e.complete(b4)),kp.clear()}function Oie(){kp.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(y4=!0)})}function NVe(){b4=!0,Oie(),jie(),b4=!1}class S6{constructor(t,n,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(kp.add(this),g4||(g4=!0,Ui.read(Oie),Ui.resolveKeyframes(jie))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:i}=this;if(t[0]===null){const s=i==null?void 0:i.get(),a=t[t.length-1];if(s!==void 0)t[0]=s;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),i&&s===void 0&&i.set(t[0])}CVe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),kp.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,kp.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const jVe=e=>e.startsWith("--");function OVe(e,t,n){jVe(t)?e.style.setProperty(t,n):e.style[t]=n}function C6(e){let t;return()=>(t===void 0&&(t=e()),t)}const PVe=C6(()=>window.ScrollTimeline!==void 0),DVe={};function FVe(e,t){const n=C6(e);return()=>DVe[t]??n()}const Pie=FVe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),_v=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,hU={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_v([0,.65,.55,1]),circOut:_v([.55,0,1,.45]),backIn:_v([.31,.01,.66,-.59]),backOut:_v([.33,1.53,.69,.99])};function Die(e,t){if(e)return typeof e=="function"?Pie()?vie(e,t):"ease-out":Iie(e)?_v(e):Array.isArray(e)?e.map(n=>Die(n,t)||hU.easeOut):hU[e]}function LVe(e,t,n,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=Die(o,i);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:i,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function Fie(e){return typeof e=="function"&&"applyToOptions"in e}function BVe({type:e,...t}){return Fie(e)&&Pie()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class $Ve extends _6{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:i,pseudoElement:s,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!s,this.allowFlatten=a,this.options=t,n6(typeof t.type!="string");const c=BVe(t);this.animation=LVe(n,r,i,c,s),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const u=w6(i,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):OVe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Jc(Number(t))}get time(){return Jc(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Xc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&PVe()?(this.animation.timeline=t,bl):n(this)}}const Lie={anticipate:Tie,backInOut:Eie,circInOut:Rie};function zVe(e){return e in Lie}function UVe(e){typeof e.ease=="string"&&zVe(e.ease)&&(e.ease=Lie[e.ease])}const pU=10;class qVe extends $Ve{constructor(t){UVe(t),Mie(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:i,element:s,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new Nie({...a,autoplay:!1}),l=Xc(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-pU).value,o.sample(l).value,pU),o.stop()}}const mU=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(th.test(e)||e==="0")&&!e.startsWith("url("));function VVe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function HVe(e,t,n,r){const i=e[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],a=mU(i,t),o=mU(s,t);return!a||!o?!1:VVe(e)||(n==="spring"||Fie(n))&&r}const WVe=new Set(["opacity","clipPath","filter","transform"]),GVe=C6(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function KVe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:i,damping:s,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return GVe()&&n&&WVe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&i!=="mirror"&&s!==0&&a!=="inertia"}const YVe=40;class ZVe extends _6{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,x;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(x=this.keyframeResolver)==null||x.cancel()},this.createdAt=co.now();const h={autoplay:t,delay:n,type:r,repeat:i,repeatDelay:s,repeatType:a,name:l,motionValue:c,element:u,...d},p=(u==null?void 0:u.KeyframeResolver)||S6;this.keyframeResolver=new p(o,(b,x,w)=>this.onKeyframesResolved(b,x,h,!w),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,i){this.keyframeResolver=void 0;const{name:s,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=co.now(),HVe(t,s,a,o)||((xd.instantAnimations||!l)&&(u==null||u(w6(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:i?this.resolvedAt?this.resolvedAt-this.createdAt>YVe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},p=!c&&KVe(h)?new qVe({...h,element:h.motionValue.owner.current}):new Nie(h);p.finished.then(()=>this.notifyFinished()).catch(bl),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||NVe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const k6=(e,t,n,r={},i,s)=>a=>{const o=p6(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Xc(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:i};Mqe(o)||Object.assign(u,Iqe(e,u)),u.duration&&(u.duration=Xc(u.duration)),u.repeatDelay&&(u.repeatDelay=Xc(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(xd.instantAnimations||xd.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!s&&t.get()!==void 0){const h=kqe(u.keyframes,o);if(h!==void 0){Ui.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new ZVe(u)},Bie=new Set(["width","height","top","left","right","bottom",...Sy]);function XVe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function $ie(e,t,{delay:n=0,transitionOverride:r,type:i}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(s=r);const l=[],c=i&&e.animationState&&e.animationState.getState()[i];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&XVe(c,u))continue;const p={delay:n,...p6(s||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!p.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const w=die(e);if(w){const _=window.MotionHandoffAnimation(w,u,Ui);_!==null&&(p.startTime=_,b=!0)}}l4(e,u),d.start(k6(u,d,h,e.shouldReduceMotion&&Bie.has(u)?{type:!1}:p,e,b));const x=d.animation;x&&l.push(x)}return a&&Promise.all(l).then(()=>{Ui.update(()=>{a&&_qe(e,a)})}),l}function v4(e,t,n={}){var l;const r=dw(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(i=n.transitionOverride);const s=r?()=>Promise.all($ie(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=i;return JVe(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=i;if(o){const[c,u]=o==="beforeChildren"?[s,a]:[a,s];return c().then(()=>u())}else return Promise.all([s(),a(n.delay)])}function JVe(e,t,n=0,r=0,i=1,s){const a=[],o=(e.variantChildren.size-1)*r,l=i===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(QVe).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(v4(c,t,{...s,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function QVe(e,t){return e.sortNodePosition(t)}function eHe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const i=t.map(s=>v4(e,s,n));r=Promise.all(i)}else if(typeof t=="string")r=v4(e,t,n);else{const i=typeof t=="function"?dw(e,t,n.custom):t;r=Promise.all($ie(e,i,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function zie(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const tHe=QD.length;function Uie(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?Uie(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<tHe;n++){const r=QD[n],i=e.props[r];(lw(i)||i===!1)&&(t[r]=i)}return t}const nHe=[...JD].reverse(),rHe=JD.length;function iHe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>eHe(e,n,r)))}function sHe(e){let t=iHe(e),n=gU(),r=!0;const i=l=>(c,u)=>{var h;const d=dw(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:p,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function s(l){t=l(e)}function a(l){const{props:c}=e,u=Uie(e.parent)||{},d=[],h=new Set;let p={},y=1/0;for(let x=0;x<rHe;x++){const w=nHe[x],_=n[w],S=c[w]!==void 0?c[w]:u[w],C=lw(S),E=w===l?_.isActive:null;E===!1&&(y=x);let T=S===u[w]&&S!==c[w]&&C;if(T&&r&&e.manuallyAnimateOnMount&&(T=!1),_.protectedKeys={...p},!_.isActive&&E===null||!S&&!_.prevProp||bT(S)||typeof S=="boolean")continue;const R=aHe(_.prevProp,S);let M=R||w===l&&_.isActive&&!T&&C||x>y&&C,N=!1;const O=Array.isArray(S)?S:[S];let B=O.reduce(i(w),{});E===!1&&(B={});const{prevResolvedValues:P={}}=_,H={...P,...B},F=K=>{M=!0,h.has(K)&&(N=!0,h.delete(K)),_.needsAnimating[K]=!0;const U=e.getValue(K);U&&(U.liveStyle=!1)};for(const K in H){const U=B[K],re=P[K];if(p.hasOwnProperty(K))continue;let G=!1;o4(U)&&o4(re)?G=!zie(U,re):G=U!==re,G?U!=null?F(K):h.add(K):U!==void 0&&h.has(K)?F(K):_.protectedKeys[K]=!0}_.prevProp=S,_.prevResolvedValues=B,_.isActive&&(p={...p,...B}),r&&e.blockInitialAnimation&&(M=!1),M&&(!(T&&R)||N)&&d.push(...O.map(K=>({animation:K,options:{type:w}})))}if(h.size){const x={};if(typeof c.initial!="boolean"){const w=dw(e,Array.isArray(c.initial)?c.initial[0]:c.initial);w&&w.transition&&(x.transition=w.transition)}h.forEach(w=>{const _=e.getBaseTarget(w),S=e.getValue(w);S&&(S.liveStyle=!0),x[w]=_??null}),d.push({animation:x})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var p;return(p=h.animationState)==null?void 0:p.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>n,reset:()=>{n=gU(),r=!0}}}function aHe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!zie(t,e):!1}function ep(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function gU(){return{animate:ep(!0),whileInView:ep(),whileHover:ep(),whileTap:ep(),whileDrag:ep(),whileFocus:ep(),exit:ep()}}class xh{constructor(t){this.isMounted=!1,this.node=t}update(){}}class oHe extends xh{constructor(t){super(t),t.animationState||(t.animationState=sHe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();bT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let lHe=0;class cHe extends xh{constructor(){super(...arguments),this.id=lHe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const i=this.node.animationState.setActive("exit",!t);n&&!t&&i.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const uHe={animation:{Feature:oHe},exit:{Feature:cHe}};function mw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const E6=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function _1(e){return{point:{x:e.pageX,y:e.pageY}}}const dHe=e=>t=>E6(t)&&e(t,_1(t));function zv(e,t,n,r){return mw(e,t,dHe(n),r)}function qie({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function fHe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function hHe(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const Vie=1e-4,pHe=1-Vie,mHe=1+Vie,Hie=.01,gHe=0-Hie,yHe=0+Hie;function La(e){return e.max-e.min}function bHe(e,t,n){return Math.abs(e-t)<=n}function yU(e,t,n,r=.5){e.origin=r,e.originPoint=$i(t.min,t.max,e.origin),e.scale=La(n)/La(t),e.translate=$i(n.min,n.max,e.origin)-e.originPoint,(e.scale>=pHe&&e.scale<=mHe||isNaN(e.scale))&&(e.scale=1),(e.translate>=gHe&&e.translate<=yHe||isNaN(e.translate))&&(e.translate=0)}function Uv(e,t,n,r){yU(e.x,t.x,n.x,r?r.originX:void 0),yU(e.y,t.y,n.y,r?r.originY:void 0)}function bU(e,t,n){e.min=n.min+t.min,e.max=e.min+La(t)}function vHe(e,t,n){bU(e.x,t.x,n.x),bU(e.y,t.y,n.y)}function vU(e,t,n){e.min=t.min-n.min,e.max=e.min+La(t)}function qv(e,t,n){vU(e.x,t.x,n.x),vU(e.y,t.y,n.y)}const xU=()=>({translate:0,scale:1,origin:0,originPoint:0}),Pg=()=>({x:xU(),y:xU()}),wU=()=>({min:0,max:0}),Ji=()=>({x:wU(),y:wU()});function cl(e){return[e("x"),e("y")]}function CN(e){return e===void 0||e===1}function x4({scale:e,scaleX:t,scaleY:n}){return!CN(e)||!CN(t)||!CN(n)}function sp(e){return x4(e)||Wie(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function Wie(e){return _U(e.x)||_U(e.y)}function _U(e){return e&&e!=="0%"}function _k(e,t,n){const r=e-n,i=t*r;return n+i}function SU(e,t,n,r,i){return i!==void 0&&(e=_k(e,i,r)),_k(e,n,r)+t}function w4(e,t=0,n=1,r,i){e.min=SU(e.min,t,n,r,i),e.max=SU(e.max,t,n,r,i)}function Gie(e,{x:t,y:n}){w4(e.x,t.translate,t.scale,t.originPoint),w4(e.y,n.translate,n.scale,n.originPoint)}const CU=.999999999999,kU=1.0000000000001;function xHe(e,t,n,r=!1){const i=n.length;if(!i)return;t.x=t.y=1;let s,a;for(let o=0;o<i;o++){s=n[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Fg(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,Gie(e,a)),r&&sp(s.latestValues)&&Fg(e,s.latestValues))}t.x<kU&&t.x>CU&&(t.x=1),t.y<kU&&t.y>CU&&(t.y=1)}function Dg(e,t){e.min=e.min+t,e.max=e.max+t}function EU(e,t,n,r,i=.5){const s=$i(e.min,e.max,i);w4(e,t,n,s,r)}function Fg(e,t){EU(e.x,t.x,t.scaleX,t.scale,t.originX),EU(e.y,t.y,t.scaleY,t.scale,t.originY)}function Kie(e,t){return qie(hHe(e.getBoundingClientRect(),t))}function wHe(e,t,n){const r=Kie(e,n),{scroll:i}=t;return i&&(Dg(r.x,i.offset.x),Dg(r.y,i.offset.y)),r}const Yie=({current:e})=>e?e.ownerDocument.defaultView:null,TU=(e,t)=>Math.abs(e-t);function _He(e,t){const n=TU(e.x,t.x),r=TU(e.y,t.y);return Math.sqrt(n**2+r**2)}class Zie{constructor(t,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=EN(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,p=_He(d.offset,{x:0,y:0})>=3;if(!h&&!p)return;const{point:y}=d,{timestamp:b}=ta;this.history.push({...y,timestamp:b});const{onStart:x,onMove:w}=this.handlers;h||(x&&x(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=kN(h,this.transformPagePoint),Ui.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:p,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=EN(d.type==="pointercancel"?this.lastMoveEventInfo:kN(h,this.transformPagePoint),this.history);this.startEvent&&p&&p(d,x),y&&y(d,x)},!E6(t))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const a=_1(t),o=kN(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=ta;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,EN(o,this.history)),this.removeListeners=x1(zv(this.contextWindow,"pointermove",this.handlePointerMove),zv(this.contextWindow,"pointerup",this.handlePointerUp),zv(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),eh(this.updatePoint)}}function kN(e,t){return t?{point:t(e.point)}:e}function AU(e,t){return{x:e.x-t.x,y:e.y-t.y}}function EN({point:e},t){return{point:e,delta:AU(e,Xie(t)),offset:AU(e,SHe(t)),velocity:CHe(t,.1)}}function SHe(e){return e[0]}function Xie(e){return e[e.length-1]}function CHe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const i=Xie(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>Xc(t)));)n--;if(!r)return{x:0,y:0};const s=Jc(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function kHe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?$i(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?$i(n,e,r.max):Math.min(e,n)),e}function RU(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function EHe(e,{top:t,left:n,bottom:r,right:i}){return{x:RU(e.x,n,i),y:RU(e.y,t,r)}}function IU(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function THe(e,t){return{x:IU(e.x,t.x),y:IU(e.y,t.y)}}function AHe(e,t){let n=.5;const r=La(e),i=La(t);return i>r?n=pw(t.min,t.max-r,e.min):r>i&&(n=pw(e.min,e.max-i,t.min)),wd(0,1,n)}function RHe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const _4=.35;function IHe(e=_4){return e===!1?e=0:e===!0&&(e=_4),{x:MU(e,"left","right"),y:MU(e,"top","bottom")}}function MU(e,t,n){return{min:NU(e,t),max:NU(e,n)}}function NU(e,t){return typeof e=="number"?e:e[t]||0}const $l={x:!1,y:!1};function Jie(){return $l.x||$l.y}function MHe(e){return e==="x"||e==="y"?$l[e]?null:($l[e]=!0,()=>{$l[e]=!1}):$l.x||$l.y?null:($l.x=$l.y=!0,()=>{$l.x=$l.y=!1})}const NHe=new WeakMap;class jHe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ji(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(_1(u).point)},s=(u,d)=>{const{drag:h,dragPropagation:p,onDragStart:y}=this.getProps();if(h&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=MHe(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),cl(x=>{let w=this.getAxisMotionValue(x).get()||0;if(Zc.test(w)){const{projection:_}=this.visualElement;if(_&&_.layout){const S=_.layout.layoutBox[x];S&&(w=La(S)*(parseFloat(w)/100))}}this.originPoint[x]=w}),y&&Ui.postRender(()=>y(u,d)),l4(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:p,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:x}=d;if(p&&this.currentDirection===null){this.currentDirection=OHe(x),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,x),this.updateAxis("y",d.point,x),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>cl(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new Zie(t,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:Yie(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&Ui.postRender(()=>s(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:i}=this.getProps();if(!r||!IS(t,i,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=kHe(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){var s;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,i=this.constraints;t&&jg(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=EHe(r.layoutBox,t):this.constraints=!1,this.elastic=IHe(n),i!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&cl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=RHe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!jg(t))return!1;const r=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=wHe(r,i.root,this.visualElement.getTransformPagePoint());let a=THe(i.layout.layoutBox,s);if(n){const o=n(fHe(a));this.hasMutatedConstraints=!!o,o&&(a=qie(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=cl(u=>{if(!IS(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=i?200:1e6,p=i?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...s,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return l4(this.visualElement,t),r.start(k6(t,r,0,n,this.visualElement,!1))}stopAnimation(){cl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){cl(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){cl(n=>{const{drag:r}=this.getProps();if(!IS(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[n];s.set(t[n]-$i(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!jg(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};cl(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=AHe({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),cl(a=>{if(!IS(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set($i(l,c,i[a]))})}addListeners(){if(!this.visualElement.current)return;NHe.set(this.visualElement,this);const t=this.visualElement.current,n=zv(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();jg(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),Ui.read(r);const a=mw(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(cl(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=_4,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function IS(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function OHe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class PHe extends xh{constructor(t){super(t),this.removeGroupControls=bl,this.removeListeners=bl,this.controls=new jHe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||bl}unmount(){this.removeGroupControls(),this.removeListeners()}}const jU=e=>(t,n)=>{e&&Ui.postRender(()=>e(t,n))};class DHe extends xh{constructor(){super(...arguments),this.removePointerDownListener=bl}onPointerDown(t){this.session=new Zie(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Yie(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:jU(t),onStart:jU(n),onMove:r,onEnd:(s,a)=>{delete this.session,i&&Ui.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=zv(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const x2={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function OU(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const uv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Zn.test(e))e=parseFloat(e);else return e;const n=OU(e,t.target.x),r=OU(e,t.target.y);return`${n}% ${r}%`}},FHe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,i=th.parse(e);if(i.length>5)return r;const s=th.createTransformer(e),a=typeof i[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;i[0+a]/=o,i[1+a]/=l;const c=$i(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=c),typeof i[3+a]=="number"&&(i[3+a]/=c),s(i)}};class LHe extends A.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=t;ZUe(BHe),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),x2.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,{projection:a}=r;return a&&(a.isPresent=s,i||t.layoutDependency!==n||n===void 0||t.isPresent!==s?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||Ui.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),t6.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function Qie(e){const[t,n]=Gre(),r=A.useContext(KD);return m.jsx(LHe,{...e,layoutGroup:r,switchLayoutGroup:A.useContext(Qre),isPresent:t,safeToRemove:n})}const BHe={borderRadius:{...uv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:uv,borderTopRightRadius:uv,borderBottomLeftRadius:uv,borderBottomRightRadius:uv,boxShadow:FHe};function $He(e,t,n){const r=ya(e)?e:fw(e);return r.start(k6("",r,t,n)),r.animation}function zHe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const UHe=(e,t)=>e.depth-t.depth;class qHe{constructor(){this.children=[],this.isDirty=!1}add(t){d6(this.children,t),this.isDirty=!0}remove(t){f6(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(UHe),this.isDirty=!1,this.children.forEach(t)}}function VHe(e,t){const n=co.now(),r=({timestamp:i})=>{const s=i-n;s>=t&&(eh(r),e(s-t))};return Ui.setup(r,!0),()=>eh(r)}const ese=["TopLeft","TopRight","BottomLeft","BottomRight"],HHe=ese.length,PU=e=>typeof e=="string"?parseFloat(e):e,DU=e=>typeof e=="number"||Zn.test(e);function WHe(e,t,n,r,i,s){i?(e.opacity=$i(0,n.opacity??1,GHe(r)),e.opacityExit=$i(t.opacity??1,0,KHe(r))):s&&(e.opacity=$i(t.opacity??1,n.opacity??1,r));for(let a=0;a<HHe;a++){const o=`border${ese[a]}Radius`;let l=FU(t,o),c=FU(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||DU(l)===DU(c)?(e[o]=Math.max($i(PU(l),PU(c),r),0),(Zc.test(c)||Zc.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=$i(t.rotate||0,n.rotate||0,r))}function FU(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const GHe=tse(0,.5,Aie),KHe=tse(.5,.95,bl);function tse(e,t,n){return r=>r<e?0:r>t?1:n(pw(e,t,r))}function LU(e,t){e.min=t.min,e.max=t.max}function ol(e,t){LU(e.x,t.x),LU(e.y,t.y)}function BU(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function $U(e,t,n,r,i){return e-=t,e=_k(e,1/n,r),i!==void 0&&(e=_k(e,1/i,r)),e}function YHe(e,t=0,n=1,r=.5,i,s=e,a=e){if(Zc.test(t)&&(t=parseFloat(t),t=$i(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=$i(s.min,s.max,r);e===s&&(o-=t),e.min=$U(e.min,t,n,o,i),e.max=$U(e.max,t,n,o,i)}function zU(e,t,[n,r,i],s,a){YHe(e,t[n],t[r],t[i],t.scale,s,a)}const ZHe=["x","scaleX","originX"],XHe=["y","scaleY","originY"];function UU(e,t,n,r){zU(e.x,t,ZHe,n?n.x:void 0,r?r.x:void 0),zU(e.y,t,XHe,n?n.y:void 0,r?r.y:void 0)}function qU(e){return e.translate===0&&e.scale===1}function nse(e){return qU(e.x)&&qU(e.y)}function VU(e,t){return e.min===t.min&&e.max===t.max}function JHe(e,t){return VU(e.x,t.x)&&VU(e.y,t.y)}function HU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function rse(e,t){return HU(e.x,t.x)&&HU(e.y,t.y)}function WU(e){return La(e.x)/La(e.y)}function GU(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class QHe{constructor(){this.members=[]}add(t){d6(this.members,t),t.scheduleRender()}remove(t){if(f6(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(i=>t===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function eWe(e,t,n){let r="";const i=e.x.translate/t.x,s=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:p,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),p&&(r+=`skewX(${p}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const TN=["","X","Y","Z"],tWe={visibility:"hidden"},KU=1e3;let nWe=0;function AN(e,t,n,r){const{latestValues:i}=t;i[e]&&(n[e]=i[e],t.setStaticValue(e,0),r&&(r[e]=0))}function ise(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=die(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",Ui,!(i||s))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&ise(r)}function sse({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=t==null?void 0:t()){this.id=nWe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(sWe),this.nodes.forEach(uWe),this.nodes.forEach(dWe),this.nodes.forEach(aWe)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new qHe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new h6),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=zHe(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=VHe(d,250),x2.hasAnimatedSinceResize&&(x2.hasAnimatedSinceResize=!1,this.nodes.forEach(ZU))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||gWe,{onLayoutAnimationStart:b,onLayoutAnimationComplete:x}=c.getProps(),w=!this.targetLayout||!rse(this.targetLayout,p),_=!d&&h;if(this.options.layoutRoot||this.resumeFrom||_||d&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,_);const S={...p6(y,"layout"),onPlay:b,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||ZU(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),eh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(fWe),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&ise(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(YU);return}this.isUpdating||this.nodes.forEach(lWe),this.isUpdating=!1,this.nodes.forEach(cWe),this.nodes.forEach(rWe),this.nodes.forEach(iWe),this.clearAllSnapshots();const o=co.now();ta.delta=wd(0,1e3/60,o-ta.timestamp),ta.timestamp=o,ta.isProcessing=!0,xN.update.process(ta),xN.preRender.process(ta),xN.render.process(ta),ta.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,t6.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(oWe),this.sharedNodes.forEach(hWe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ui.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ui.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!La(this.snapshot.measuredBox.x)&&!La(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ji(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!nse(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||sp(this.latestValues)||u)&&(i(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),yWe(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return Ji();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(bWe))){const{scroll:u}=this.root;u&&(Dg(o.x,u.offset.x),Dg(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=Ji();if(ol(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&ol(o,a),Dg(o.x,d.offset.x),Dg(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=Ji();ol(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Fg(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),sp(u.latestValues)&&Fg(l,u.latestValues)}return sp(this.latestValues)&&Fg(l,this.latestValues),l}removeTransform(a){const o=Ji();ol(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!sp(c.latestValues))continue;x4(c.latestValues)&&c.updateSnapshot();const u=Ji(),d=c.measurePageBox();ol(u,d),UU(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return sp(this.latestValues)&&UU(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ta.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=ta.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ji(),this.relativeTargetOrigin=Ji(),qv(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ol(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ji(),this.targetWithTransforms=Ji()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),vHe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ol(this.target,this.layout.layoutBox),Gie(this.target,this.targetDelta)):ol(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ji(),this.relativeTargetOrigin=Ji(),qv(this.relativeTargetOrigin,this.target,p.target),ol(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||x4(this.parent.latestValues)||Wie(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===ta.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;ol(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;xHe(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Ji());const{target:p}=a;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(BU(this.prevProjectionDelta.x,this.projectionDelta.x),BU(this.prevProjectionDelta.y,this.projectionDelta.y)),Uv(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!GU(this.projectionDelta.x,this.prevProjectionDelta.x)||!GU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Pg(),this.projectionDelta=Pg(),this.projectionDeltaWithTransform=Pg()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=Pg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Ji(),p=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=p!==y,x=this.getStack(),w=!x||x.members.length<=1,_=!!(b&&!w&&this.options.crossfade===!0&&!this.path.some(mWe));this.animationProgress=0;let S;this.mixTargetDelta=C=>{const E=C/1e3;XU(d.x,a.x,E),XU(d.y,a.y,E),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(qv(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),pWe(this.relativeTarget,this.relativeTargetOrigin,h,E),S&&JHe(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=Ji()),ol(S,this.relativeTarget)),b&&(this.animationValues=u,WHe(u,c,this.latestValues,E,_,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(eh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ui.update(()=>{x2.hasAnimatedSinceResize=!0,this.currentAnimation=$He(0,KU,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(KU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&ase(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Ji();const d=La(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=La(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}ol(o,l),Fg(o,u),Uv(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new QHe),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&AN("z",a,c,this.animationValues);for(let u=0;u<TN.length;u++)AN(`rotate${TN[u]}`,a,c,this.animationValues),AN(`skew${TN[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return tWe;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=b2(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=b2(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!sp(this.latestValues)&&(p.transform=l?l({},""):"none",this.hasProjected=!1),p}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=eWe(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in cw){if(u[p]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:x}=cw[p],w=o.transform==="none"?u[p]:y(u[p],c);if(b){const _=b.length;for(let S=0;S<_;S++)o[b[S]]=w}else x?this.options.visualElement.renderState.vars[p]=w:o[p]=w}return this.options.layoutId&&(o.pointerEvents=c===this?b2(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(YU),this.root.sharedNodes.clear()}}}function rWe(e){e.updateLayout()}function iWe(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?cl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],p=La(h);h.min=r[d].min,h.max=h.min+p}):ase(s,t.layoutBox,r)&&cl(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],p=La(r[d]);h.max=h.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+p)});const o=Pg();Uv(o,r,t.layoutBox);const l=Pg();a?Uv(l,e.applyTransform(i,!0),t.measuredBox):Uv(l,r,t.layoutBox);const c=!nse(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:p}=d;if(h&&p){const y=Ji();qv(y,t.layoutBox,h.layoutBox);const b=Ji();qv(b,r,p.layoutBox),rse(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function sWe(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function aWe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function oWe(e){e.clearSnapshot()}function YU(e){e.clearMeasurements()}function lWe(e){e.isLayoutDirty=!1}function cWe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function ZU(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function uWe(e){e.resolveTargetDelta()}function dWe(e){e.calcProjection()}function fWe(e){e.resetSkewAndRotation()}function hWe(e){e.removeLeadSnapshot()}function XU(e,t,n){e.translate=$i(t.translate,0,n),e.scale=$i(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function JU(e,t,n,r){e.min=$i(t.min,n.min,r),e.max=$i(t.max,n.max,r)}function pWe(e,t,n,r){JU(e.x,t.x,n.x,r),JU(e.y,t.y,n.y,r)}function mWe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const gWe={duration:.45,ease:[.4,0,.1,1]},QU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),eq=QU("applewebkit/")&&!QU("chrome/")?Math.round:bl;function tq(e){e.min=eq(e.min),e.max=eq(e.max)}function yWe(e){tq(e.x),tq(e.y)}function ase(e,t,n){return e==="position"||e==="preserve-aspect"&&!bHe(WU(t),WU(n),.2)}function bWe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const vWe=sse({attachResizeListener:(e,t)=>mw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),RN={current:void 0},ose=sse({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!RN.current){const e=new vWe({});e.mount(window),e.setOptions({layoutScroll:!0}),RN.current=e}return RN.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),xWe={pan:{Feature:DHe},drag:{Feature:PHe,ProjectionNode:ose,MeasureLayout:Qie}};function wWe(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const i=(n==null?void 0:n[e])??r.querySelectorAll(e);return i?Array.from(i):[]}return Array.from(e)}function lse(e,t){const n=wWe(e),r=new AbortController,i={passive:!0,...t,signal:r.signal};return[n,i,()=>r.abort()]}function nq(e){return!(e.pointerType==="touch"||Jie())}function _We(e,t,n={}){const[r,i,s]=lse(e,n),a=o=>{if(!nq(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{nq(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,i)};return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}function rq(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,s=r[i];s&&Ui.postRender(()=>s(t,_1(t)))}class SWe extends xh{mount(){const{current:t}=this.node;t&&(this.unmount=_We(t,(n,r)=>(rq(this.node,r,"Start"),i=>rq(this.node,i,"End"))))}unmount(){}}class CWe extends xh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=x1(mw(this.node.current,"focus",()=>this.onFocus()),mw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const cse=(e,t)=>t?e===t?!0:cse(e,t.parentElement):!1,kWe=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function EWe(e){return kWe.has(e.tagName)||e.tabIndex!==-1}const Sv=new WeakSet;function iq(e){return t=>{t.key==="Enter"&&e(t)}}function IN(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const TWe=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=iq(()=>{if(Sv.has(n))return;IN(n,"down");const i=iq(()=>{IN(n,"up")}),s=()=>IN(n,"cancel");n.addEventListener("keyup",i,t),n.addEventListener("blur",s,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function sq(e){return E6(e)&&!Jie()}function AWe(e,t,n={}){const[r,i,s]=lse(e,n),a=o=>{const l=o.currentTarget;if(!sq(o)||Sv.has(l))return;Sv.add(l);const c=t(l,o),u=(p,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!sq(p)||!Sv.has(l))&&(Sv.delete(l),typeof c=="function"&&c(p,{success:y}))},d=p=>{u(p,l===window||l===document||n.useGlobalTarget||cse(l,p.target))},h=p=>{u(p,!1)};window.addEventListener("pointerup",d,i),window.addEventListener("pointercancel",h,i)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o instanceof HTMLElement&&(o.addEventListener("focus",c=>TWe(c,i)),!EWe(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),s}function aq(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),s=r[i];s&&Ui.postRender(()=>s(t,_1(t)))}class RWe extends xh{mount(){const{current:t}=this.node;t&&(this.unmount=AWe(t,(n,r)=>(aq(this.node,r,"Start"),(i,{success:s})=>aq(this.node,i,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const S4=new WeakMap,MN=new WeakMap,IWe=e=>{const t=S4.get(e.target);t&&t(e)},MWe=e=>{e.forEach(IWe)};function NWe({root:e,...t}){const n=e||document;MN.has(n)||MN.set(n,{});const r=MN.get(n),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(MWe,{root:e,...t})),r[i]}function jWe(e,t,n){const r=NWe(t);return S4.set(e,n),r.observe(e),()=>{S4.delete(e),r.unobserve(e)}}const OWe={some:0,all:1};class PWe extends xh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:OWe[i]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return jWe(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(DWe(t,n))&&this.startObserver()}unmount(){}}function DWe({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const FWe={inView:{Feature:PWe},tap:{Feature:RWe},focus:{Feature:CWe},hover:{Feature:SWe}},LWe={layout:{ProjectionNode:ose,MeasureLayout:Qie}},C4={current:null},use={current:!1};function BWe(){if(use.current=!0,!!ZD)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>C4.current=e.matches;e.addListener(t),t()}else C4.current=!1}const $We=new WeakMap;function zWe(e,t,n){for(const r in t){const i=t[r],s=n[r];if(ya(i))e.addValue(r,i);else if(ya(s))e.addValue(r,fw(i,{owner:e}));else if(s!==i)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=e.getStaticValue(r);e.addValue(r,fw(a!==void 0?a:i,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const dse=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),fse=e=>/^0[^.\s]+$/u.test(e),UWe={test:e=>e==="auto",parse:e=>e},hse=e=>t=>t.test(e),pse=[ky,Zn,Zc,vf,JUe,XUe,UWe],oq=e=>pse.find(hse(e)),qWe=[...pse,pa,th],VWe=e=>qWe.find(hse(e)),HWe=new Set(["brightness","contrast","saturate","opacity"]);function WWe(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(m6)||[];if(!r)return e;const i=n.replace(r,"");let s=HWe.has(t)?1:0;return r!==n&&(s*=100),t+"("+s+i+")"}const GWe=/\b([a-z-]*)\(.*?\)/gu,k4={...th,getAnimatableNone:e=>{const t=e.match(GWe);return t?t.map(WWe).join(" "):e}},KWe={...s6,color:pa,backgroundColor:pa,outlineColor:pa,fill:pa,stroke:pa,borderColor:pa,borderTopColor:pa,borderRightColor:pa,borderBottomColor:pa,borderLeftColor:pa,filter:k4,WebkitFilter:k4},mse=e=>KWe[e];function gse(e,t){let n=mse(e);return n!==k4&&(n=th),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const lq=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class YWe{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=S6,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=co.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Ui.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=vT(n),this.isVariantNode=Xre(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const p=d[h];l[h]!==void 0&&ya(p)&&p.set(l[h],!1)}}mount(t){this.current=t,$We.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),use.current||BWe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:C4.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),eh(this.notifyUpdate),eh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Cy.has(t);r&&this.onBindTransform&&this.onBindTransform();const i=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&Ui.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{i(),s(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in z0){const n=z0[t];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[t]&&i&&r(this.props)&&(this.features[t]=new i(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ji()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<lq.length;r++){const i=lq[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=t[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=zWe(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=fw(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(dse(r)||fse(r))?r=parseFloat(r):!VWe(r)&&th.test(n)&&(r=gse(t,n)),this.setBaseTarget(t,ya(r)?r.get():r)),ya(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var s;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=c6(this.props,n,(s=this.presenceContext)==null?void 0:s.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!ya(i)?i:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new h6),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const ZWe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function XWe(e){const t=ZWe.exec(e);if(!t)return[,];const[,n,r,i]=t;return[`--${n??r}`,i]}function yse(e,t,n=1){const[r,i]=XWe(e);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const a=s.trim();return dse(a)?parseFloat(a):a}return i6(i)?yse(i,t,n+1):i}function JWe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||fse(e):!0}const QWe=new Set(["auto","none","0"]);function eGe(e,t,n){let r=0,i;for(;r<e.length&&!i;){const s=e[r];typeof s=="string"&&!QWe.has(s)&&hw(s).values.length&&(i=e[r]),r++}if(i&&n)for(const s of t)e[s]=gse(n,i)}class tGe extends S6{constructor(t,n,r,i,s){super(t,n,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),i6(c))){const u=yse(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Bie.has(r)||t.length!==2)return;const[i,s]=t,a=oq(i),o=oq(s);if(a!==o)if(fU(a)&&fU(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else Cp[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let i=0;i<t.length;i++)(t[i]===null||JWe(t[i]))&&r.push(i);r.length&&eGe(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Cp[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&t.getValue(r,i).jump(i,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const i=t.getValue(n);i&&i.jump(this.measuredOrigin,!1);const s=r.length-1,a=r[s];r[s]=Cp[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class bse extends YWe{constructor(){super(...arguments),this.KeyframeResolver=tGe}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ya(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function vse(e,{style:t,vars:n},r,i){Object.assign(e.style,t,i&&i.getProjectionStyles(r));for(const s in n)e.style.setProperty(s,n[s])}function nGe(e){return window.getComputedStyle(e)}class rGe extends bse{constructor(){super(...arguments),this.type="html",this.renderInstance=vse}readValueFromInstance(t,n){if(Cy.has(n))return TVe(t,n);{const r=nGe(t),i=(r6(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:n}){return Kie(t,n)}build(t,n,r){a6(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return u6(t,n,r)}}const xse=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function iGe(e,t,n,r){vse(e,t,void 0,r);for(const i in t.attrs)e.setAttribute(xse.has(i)?i:e6(i),t.attrs[i])}class sGe extends bse{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ji}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Cy.has(n)){const r=mse(n);return r&&r.default||0}return n=xse.has(n)?n:e6(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return cie(t,n,r)}build(t,n,r){sie(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,i){iGe(t,n,r,i)}mount(t){this.isSVGTag=oie(t.tagName),super.mount(t)}}const aGe=(e,t)=>l6(e)?new sGe(t):new rGe(t,{allowProjection:e!==A.Fragment}),oGe=gqe({...uHe,...FWe,...xWe,...LWe},aGe),Bc=DUe(oGe),Gg=new WeakMap,w2=new WeakMap,Sk={current:[]};let NN=!1,Vv=0;const Cv=new Set,MS=new Map;function wse(e){const t=Array.from(e).sort((n,r)=>n instanceof ld&&n.options.deps.includes(r)?1:r instanceof ld&&r.options.deps.includes(n)?-1:0);for(const n of t){if(Sk.current.includes(n))continue;Sk.current.push(n),n.recompute();const r=w2.get(n);if(r)for(const i of r){const s=Gg.get(i);s&&wse(s)}}}function lGe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function cGe(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function _se(e){if(Vv>0&&!MS.has(e)&&MS.set(e,e.prevState),Cv.add(e),!(Vv>0)&&!NN)try{for(NN=!0;Cv.size>0;){const t=Array.from(Cv);Cv.clear();for(const n of t){const r=MS.get(n)??n.prevState;n.prevState=r,lGe(n)}for(const n of t){const r=Gg.get(n);r&&(Sk.current.push(n),wse(r))}for(const n of t){const r=Gg.get(n);if(r)for(const i of r)cGe(i)}}}finally{NN=!1,Sk.current=[],MS.clear()}}function jc(e){Vv++;try{e()}finally{if(Vv--,Vv===0){const t=Array.from(Cv)[0];t&&_se(t)}}}class E4{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var i,s;this.listeners.add(r);const a=(s=(i=this.options)==null?void 0:i.onSubscribe)==null?void 0:s.call(i,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.setState=r=>{var i,s,a;this.prevState=this.state,this.state=(i=this.options)!=null&&i.updateFn?this.options.updateFn(this.prevState)(r):r(this.prevState),(a=(s=this.options)==null?void 0:s.onUpdate)==null||a.call(s),_se(this)},this.prevState=t,this.state=t,this.options=n}}class ld{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const i of this.options.deps)n.push(i.prevState),r.push(i.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:i,currDepVals:s,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:i,currDepVals:s,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const s of this.options.deps)s instanceof ld&&s.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:i}=this.getDepVals();for(let s=0;s<i.length;s++)if(i[s]!==r[s]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,i;this.listeners.add(n);const s=(i=(r=this.options).onSubscribe)==null?void 0:i.call(r,n,this);return()=>{this.listeners.delete(n),s==null||s()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof ld)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof E4){let r=Gg.get(n);r||(r=new Set,Gg.set(n,r)),r.add(this);let i=w2.get(this);i||(i=new Set,w2.set(this,i)),i.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof ld)this.unregisterFromGraph(n.options.deps);else if(n instanceof E4){const r=Gg.get(n);r&&r.delete(this);const i=w2.get(this);i&&i.delete(n)}}}function xT(e,t){return typeof e=="function"?e(t):e}function _2(e,t){return T6(t).reduce((r,i)=>{if(r===null)return null;if(typeof r<"u")return r[i]},e)}function jN(e,t,n){const r=T6(t);function i(s){if(!r.length)return xT(n,s);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(s))return typeof s=="object"?(s===null&&(s={}),{...s,[a]:i(s[a])}):{[a]:i()};if(Array.isArray(s)&&typeof a=="number"){const o=s.slice(0,a);return[...o.length?o:new Array(a),i(s[a]),...s.slice(a+1)]}return[...new Array(a),i()]}return i(e)}function uGe(e,t){const n=T6(t);function r(i){if(!i)return;if(n.length===1){const a=n[0];if(Array.isArray(i)&&typeof a=="number")return i.filter((c,u)=>u!==a);const{[a]:o,...l}=i;return l}const s=n.shift();if(typeof s=="string"&&typeof i=="object")return{...i,[s]:r(i[s])};if(typeof s=="number"&&Array.isArray(i)){if(s>=i.length)return i;const a=i.slice(0,s);return[...a.length?a:new Array(s),r(i[s]),...i.slice(s+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const dGe=/^(\d*)$/gm,fGe=/\.(\d*)\./gm,hGe=/^(\d*)\./gm,pGe=/\.(\d*$)/gm,mGe=/\.{2,}/gm,T4="__int__",NS=`${T4}$1`;function T6(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/\[/g,".").replace(/\]/g,"").replace(dGe,NS).replace(fGe,`.${NS}.`).replace(hGe,`${NS}.`).replace(pGe,`.${NS}`).replace(mGe,".").split(".").map(t=>t.indexOf(T4)===0?parseInt(t.substring(T4.length),10):t)}function gGe(e){return!(Array.isArray(e)&&e.length===0)}function A4(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:i,onSubmitAsync:s,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:i,debounceMs:a??l},d={cause:"submit",validate:s,debounceMs:0},h=p=>({...p,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function R4(e,t){const{onChange:n,onBlur:r,onSubmit:i,onMount:s}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:i},c={cause:"mount",validate:s},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const I4=e=>!!e&&typeof e=="object"&&"fields"in e;function Sg(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[i,s]of e)if(!t.has(i)||!Object.is(s,t.get(i)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const i of e)if(!t.has(i))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n)if(!r.includes(i)||!Sg(e[i],t[i]))return!1;return!0}const cq=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},uq=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function yGe(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(i=>{const s=typeof i=="object"?i.key:i;return typeof s=="number"?`[${s}]`:s}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const dq=e=>{const t=yGe(e);return{form:t,fields:t}},Kg={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:dq(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:dq(r.issues)}},Sse=e=>!!e&&"~standard"in e,Ck={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function jS(e){function t(d,h,p,y){const b=r(d,h,p,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[p]()}function n(d,h){return`${d}[${h}]`}function r(d,h,p,y){const b=[n(d,h)];if(p==="swap")b.push(n(d,y));else if(p==="move"){const[x,w]=[Math.min(h,y),Math.max(h,y)];for(let _=x;_<=w;_++)b.push(n(d,_))}else{const x=e.getFieldValue(d),w=Array.isArray(x)?x.length:0;for(let _=h+1;_<w;_++)b.push(n(d,_))}return Object.keys(e.fieldInfo).filter(x=>b.some(w=>x.startsWith(w)))}function i(d,h){return d.replace(/\[(\d+)\]/,(p,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function s(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=i(y.toString(),h),x=e.getFieldMeta(b);x?e.setFieldMeta(y,x):e.setFieldMeta(y,a())})}const a=()=>Ck,o=(d,h,p)=>{s(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,p))&&e.setFieldMeta(y,a())})},l=d=>{s(d,"up")},c=(d,h,p,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(x=>x.startsWith(n(h,p))).map(x=>[x,e.getFieldMeta(x)]));s(d,p<y?"up":"down"),Object.keys(e.fieldInfo).filter(x=>x.startsWith(n(h,y))).forEach(x=>{const w=x.replace(n(h,y),n(h,p)),_=b.get(w);_&&e.setFieldMeta(x,_)})},u=(d,h,p,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,p)))return;const x=b.toString().replace(n(h,p),n(h,y)),[w,_]=[e.getFieldMeta(b),e.getFieldMeta(x)];w&&e.setFieldMeta(x,w),_&&e.setFieldMeta(b,_)})};return{handleArrayFieldMetaShift:t}}function ON(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class bGe{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,i;const s=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{s(),a()};(i=(r=this.options.listeners)==null?void 0:r.onMount)==null||i.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var i,s;if(!r)return;const a=this.options;this.options=r;const o=!!((s=(i=r.transform)==null?void 0:i.deps)!=null&&s.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!Sg(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!Sg(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||jc(()=>{this.baseStore.setState(()=>ON(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,i)=>{const{fieldMeta:s}=this.state,a=this.resetFieldMeta(s);r&&!(i!=null&&i.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return ON({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const i=[];return jc(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;i.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(i)).flat()},this.validateArrayFieldsStartingFrom=async(r,i,s)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${i}]`];for(let h=i+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(p=>h.startsWith(p))),u=[];return jc(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,s)))})}),(await Promise.all(u)).flat()},this.validateField=(r,i)=>{var s;const a=(s=this.fieldInfo[r])==null?void 0:s.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(i)):[]},this.validateSync=r=>{const i=R4(r,this.options);let s=!1;const a={};return jc(()=>{var o,l;for(const u of i){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:p}=S2(d),y=OS(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const x=this.getFieldMeta(b);if(!x)continue;const{errorMap:w,errorSourceMap:_}=x,S=p==null?void 0:p[b],{newErrorValue:C,newSource:E}=cq({newFormValidatorError:S,isPreviousErrorFromFormValidator:(_==null?void 0:_[y])==="form",previousErrorValue:w==null?void 0:w[y]});E==="form"&&(a[b]={...a[b],[y]:S}),(w==null?void 0:w[y])!==C&&this.setFieldMeta(b,T=>({...T,errorMap:{...T.errorMap,[y]:C},errorSourceMap:{...T.errorSourceMap,[y]:E}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||p)&&(s=!0)}const c=OS("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!s&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:s,fieldsErrorMap:a}},this.validateAsync=async r=>{const i=A4(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const s=[];let a;for(const c of i){if(!c.validate)continue;const u=OS(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},s.push(new Promise(async p=>{let y;try{y=await new Promise((_,S)=>{setTimeout(async()=>{if(h.signal.aborted)return _(void 0);try{_(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(C){S(C)}},c.debounceMs)})}catch(_){y=_}const{formError:b,fieldErrors:x}=S2(y);x&&(a=a?{...a,...x}:x);const w=OS(c.cause);for(const _ of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(_);if(!S)continue;const{errorMap:C,errorSourceMap:E}=S,T=a==null?void 0:a[_],{newErrorValue:R,newSource:M}=cq({newFormValidatorError:T,isPreviousErrorFromFormValidator:(E==null?void 0:E[w])==="form",previousErrorValue:C==null?void 0:C[w]});(C==null?void 0:C[w])!==R&&this.setFieldMeta(_,N=>({...N,errorMap:{...N.errorMap,[w]:R},errorSourceMap:{...N.errorSourceMap,[w]:M}}))}this.baseStore.setState(_=>({..._,errorMap:{..._.errorMap,[w]:b}})),p(a?{fieldErrors:a,errorMapKey:w}:void 0)}))}let o=[];const l={};if(s.length){o=await Promise.all(s);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:i,fieldsErrorMap:s}=this.validateSync(r);return i&&!this.options.asyncAlways?s:this.validateAsync(r)},this.getFieldValue=r=>_2(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var i;return(i=this.fieldInfo)[r]||(i[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,i)=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:xT(i,s.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((i,s)=>{const a=s;return i[a]=Ck,i},{}),this.setFieldValue=(r,i,s)=>{const a=(s==null?void 0:s.dontUpdateMeta)??!1;jc(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:jN(o.values,r,i)}))})},this.deleteField=r=>{const s=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return s.forEach(l=>{o.values=uGe(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,i,s)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],i],s),this.validateField(r,"change")},this.insertFieldValue=async(r,i,s,a)=>{this.setFieldValue(r,o=>[...o.slice(0,i),s,...o.slice(i)],a),await this.validateField(r,"change"),jS(this).handleArrayFieldMetaShift(r,i,"insert"),await this.validateArrayFieldsStartingFrom(r,i,"change")},this.replaceFieldValue=async(r,i,s,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===i?s:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,i,"change")},this.removeFieldValue=async(r,i,s)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==i),s),jS(this).handleArrayFieldMetaShift(r,i,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,i,"change")},this.swapFieldValues=(r,i,s,a)=>{this.setFieldValue(r,o=>{const l=o[i],c=o[s];return jN(jN(o,`${i}`,c),`${s}`,l)},a),jS(this).handleArrayFieldMetaShift(r,i,"swap",s),this.validateField(r,"change"),this.validateField(`${r}[${i}]`,"change"),this.validateField(`${r}[${s}]`,"change")},this.moveFieldValues=(r,i,s,a)=>{this.setFieldValue(r,o=>(o.splice(s,0,o.splice(i,1)[0]),o),a),jS(this).handleArrayFieldMetaShift(r,i,"move",s),this.validateField(r,"change"),this.validateField(`${r}[${i}]`,"change"),this.validateField(`${r}[${s}]`,"change")},this.resetField=r=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:Ck},values:{...i.values,[r]:this.options.defaultValues&&this.options.defaultValues[r]}}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[i,s])=>(Object.keys(s).length&&s.errors.length&&(r[i]={errors:s.errors,errorMap:s.errorMap}),r),{})}),this.parseValuesWithSchema=r=>Kg.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>Kg.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new E4(ON({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new ld({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:i,prevVal:s})=>{var a,o,l;const c=s,u=r==null?void 0:r[0],d=i[0];let h=0;const p={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],x=u==null?void 0:u.fieldMetaBase[y],w=c==null?void 0:c[y],_=_2(d.values,y);let S=w==null?void 0:w.errors;if(!x||b.errorMap!==x.errorMap){S=Object.values(b.errorMap??{}).filter(M=>M!==void 0);const R=(a=this.getFieldInfo(y))==null?void 0:a.instance;R&&!R.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const C=!gGe(S??[]),E=!b.isDirty,T=Sg(_,_2(this.options.defaultValues,y))||Sg(_,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(w&&w.isPristine===E&&w.isValid===C&&w.isDefaultValue===T&&w.errors===S&&b===x){p[y]=w,h++;continue}p[y]={...b,errors:S,isPristine:E,isValid:C,isDefaultValue:T}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:p}}),this.store=new ld({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:i,prevVal:s})=>{var a,o,l,c;const u=s,d=r==null?void 0:r[0],h=i[0],p=i[1],y=Object.values(p).filter(Boolean),b=y.some(U=>U.isValidating),x=y.every(U=>U.isValid),w=y.some(U=>U.isTouched),_=y.some(U=>U.isBlurred),S=y.every(U=>U.isDefaultValue),C=w&&((a=h.errorMap)==null?void 0:a.onMount),E=y.some(U=>U.isDirty),T=!E,R=!!((o=h.errorMap)!=null&&o.onMount||y.some(U=>{var re;return(re=U==null?void 0:U.errorMap)==null?void 0:re.onMount})),M=!!b;let N=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(N=Object.values(h.errorMap).reduce((U,re)=>re===void 0?U:re&&I4(re)?(U.push(re.form),U):(U.push(re),U),[]));const O=N.length===0,B=x&&O,P=this.options.canSubmitWhenInvalid??!1,H=h.submissionAttempts===0&&!w&&!R||!M&&!h.isSubmitting&&B||P;let F=h.errorMap;if(C&&(N=N.filter(U=>U!==h.errorMap.onMount),F=Object.assign(F,{onMount:void 0})),u&&d&&u.errorMap===F&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===N&&u.isFieldsValidating===b&&u.isFieldsValid===x&&u.isFormValid===O&&u.isValid===B&&u.canSubmit===H&&u.isTouched===w&&u.isBlurred===_&&u.isPristine===T&&u.isDefaultValue===S&&u.isDirty===E&&Sg(d,h))return u;let Q={...h,errorMap:F,fieldMeta:this.fieldMetaDerived.state,errors:N,isFieldsValidating:b,isFieldsValid:x,isFormValid:O,isValid:B,canSubmit:H,isTouched:w,isBlurred:_,isPristine:T,isDefaultValue:S,isDirty:E};const q=((l=this.options.transform)==null?void 0:l.deps)??[];if(q.length!==this.prevTransformArray.length||q.some((U,re)=>U!==this.prevTransformArray[re])){const U=Object.assign({},this,{state:Q});(c=this.options.transform)==null||c.fn(U),Q=U.state,this.prevTransformArray=q}return Q}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return Sse(t.validate)?Kg[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,i,s,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),jc(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(s=(i=this.options).onSubmitInvalid)==null||s.call(i,{value:this.state.values,formApi:this});return}jc(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,p,y;(y=(p=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:p.onSubmit)==null||y.call(p,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),jc(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){jc(()=>{Object.entries(t).forEach(([n,r])=>{const i=n;if(I4(r)){const{formError:s,fieldErrors:a}=S2(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[i]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[i]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[i]:s}}))}else this.baseStore.setState(s=>({...s,errorMap:{...s.errorMap,[i]:r}}))})})}}function S2(e){if(e){if(I4(e)){const t=S2(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function OS(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class vGe{constructor(t){this.options={},this.mount=()=>{var n,r;const i=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const s=this.getInfo();s.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),i},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const i=_2(n.form.options.defaultValues,n.name),s=n.defaultValue??i;r?this.setValue(a=>a||s,{dontUpdateMeta:!0}):s!==void 0&&this.setValue(s,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,i)=>{this.form.insertFieldValue(this.name,n,r,i),this.triggerOnChangeListener()},this.replaceValue=(n,r,i)=>{this.form.replaceFieldValue(this.name,n,r,i),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,i)=>{this.form.swapFieldValues(this.name,n,r,i),this.triggerOnChangeListener()},this.moveValue=(n,r,i)=>{this.form.moveFieldValues(this.name,n,r,i),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),i=[];for(const s of r){if(!s.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=s.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&i.push(s.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&i.push(s.instance)}return i},this.validateSync=(n,r)=>{var i;const s=R4(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=R4(n,d.options);return h.forEach(p=>{p.field=d}),u.concat(h)},[]);let l=!1;jc(()=>{const u=(d,h)=>{var p;const y=PS(h.cause),b=h.validate?fq(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,x=r[y],{newErrorValue:w,newSource:_}=uq({formLevelError:x,fieldLevelError:b});((p=d.state.meta.errorMap)==null?void 0:p[y])!==w&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[y]:w},errorSourceMap:{...S.errorSourceMap,[y]:_}})),w&&(l=!0)};for(const d of s)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=PS("submit");return(i=this.state.meta.errorMap)!=null&&i[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const i=A4(n,this.options),s=await r,a=this.getLinkedFields(n),o=a.reduce((h,p)=>{const y=A4(n,p.options);return y.forEach(b=>{b.field=p}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(p=>({...p,isValidating:!0}));const l=[],c=[],u=(h,p,y)=>{const b=PS(p.cause),x=h.getInfo().validationMetaMap[b];x==null||x.lastAbortController.abort();const w=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:w},y.push(new Promise(async _=>{var S;let C;try{C=await new Promise((N,O)=>{this.timeoutIds.validations[p.cause]&&clearTimeout(this.timeoutIds.validations[p.cause]),this.timeoutIds.validations[p.cause]=setTimeout(async()=>{if(w.signal.aborted)return N(void 0);try{N(await this.runValidator({validate:p.validate,value:{value:h.store.state.value,fieldApi:h,signal:w.signal,validationSource:"field"},type:"validateAsync"}))}catch(B){O(B)}},p.debounceMs)})}catch(N){C=N}if(w.signal.aborted)return _(void 0);const E=fq(C),T=(S=s[this.name])==null?void 0:S[b],{newErrorValue:R,newSource:M}=uq({formLevelError:T,fieldLevelError:E});h.setMeta(N=>({...N,errorMap:{...N==null?void 0:N.errorMap,[b]:R},errorSourceMap:{...N.errorSourceMap,[b]:M}})),_(R)}))};for(const h of i)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(p=>({...p,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var i;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:s}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,s[this.name]??{});if(a&&!this.options.asyncAlways)return(i=this.getInfo().validationMetaMap[PS(n)])==null||i.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>Kg.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>Kg.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new ld({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...Ck,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return Sse(t.validate)?Kg[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,i,s,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(i=this.options.listeners)==null?void 0:i.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(s=this.options.listeners)==null?void 0:s.onBlur)==null||a.call(s,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,i,s,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(i=this.options.listeners)==null?void 0:i.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(s=this.options.listeners)==null?void 0:s.onChange)==null||a.call(s,{value:this.state.value,fieldApi:this})}}function fq(e){if(e)return e}function PS(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var PN={exports:{}},DN={},FN={exports:{}},LN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hq;function xGe(){if(hq)return LN;hq=1;var e=Ew();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,i=e.useEffect,s=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var p=h(),y=r({inst:{value:p,getSnapshot:h}}),b=y[0].inst,x=y[1];return s(function(){b.value=p,b.getSnapshot=h,l(b)&&x({inst:b})},[d,p,h]),i(function(){return l(b)&&x({inst:b}),d(function(){l(b)&&x({inst:b})})},[d]),a(p),p}function l(d){var h=d.getSnapshot;d=d.value;try{var p=h();return!n(d,p)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return LN.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,LN}var pq;function wGe(){return pq||(pq=1,FN.exports=xGe()),FN.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mq;function _Ge(){if(mq)return DN;mq=1;var e=Ew(),t=wGe();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,i=t.useSyncExternalStore,s=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return DN.useSyncExternalStoreWithSelector=function(c,u,d,h,p){var y=s(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function w(T){if(!_){if(_=!0,S=T,T=h(T),p!==void 0&&b.hasValue){var R=b.value;if(p(R,T))return C=R}return C=T}if(R=C,r(S,T))return R;var M=h(T);return p!==void 0&&p(R,M)?(S=T,R):(S=T,C=M)}var _=!1,S,C,E=d===void 0?null:d;return[function(){return w(u())},E===null?void 0:function(){return w(E())}]},[u,d,h,p]);var x=i(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=x},[x]),l(x),x},DN}var gq;function SGe(){return gq||(gq=1,PN.exports=_Ge()),PN.exports}var CGe=SGe();function A6(e,t=n=>n){return CGe.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,kGe)}function kGe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,i]of e)if(!t.has(r)||!Object.is(i,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const kk=typeof window<"u"?A.useLayoutEffect:A.useEffect;function EGe(e){const[t]=A.useState(()=>{const r=new vGe({...e,form:e.form,name:e.name});return r.Field=Cse,r});return kk(t.mount,[t]),kk(()=>{t.update(e)}),A6(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const Cse=({children:e,...t})=>{const n=EGe(t),r=A.useMemo(()=>xT(e,n),[e,n,n.state.value,n.state.meta]);return m.jsx(m.Fragment,{children:r})};function TGe({form:e,selector:t,children:n}){const r=A6(e.store,t);return xT(n,r)}function Vs(e){const[t]=A.useState(()=>{const n=new bGe(e),r=n;return r.Field=function(s){return m.jsx(Cse,{...s,form:n})},r.Subscribe=i=>m.jsx(TGe,{form:n,selector:i.selector,children:i.children}),r});return kk(t.mount,[]),A6(t.store,n=>n.isSubmitting),kk(()=>{t.update(e)}),t}function ur({className:e,type:t,...n}){return m.jsx("input",{type:t,"data-slot":"input",className:dt("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function wT(e){const t=e+"CollectionProvider",[n,r]=Ca(t),[i,s]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:x,children:w}=b,_=ut.useRef(null),S=ut.useRef(new Map).current;return m.jsx(i,{scope:x,itemMap:S,collectionRef:_,children:w})};a.displayName=t;const o=e+"CollectionSlot",l=Nf(o),c=ut.forwardRef((b,x)=>{const{scope:w,children:_}=b,S=s(o,w),C=tr(x,S.collectionRef);return m.jsx(l,{ref:C,children:_})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=Nf(u),p=ut.forwardRef((b,x)=>{const{scope:w,children:_,...S}=b,C=ut.useRef(null),E=tr(x,C),T=s(u,w);return ut.useEffect(()=>(T.itemMap.set(C,{ref:C,...S}),()=>void T.itemMap.delete(C))),m.jsx(h,{[d]:"",ref:E,children:_})});p.displayName=u;function y(b){const x=s(e+"CollectionConsumer",b);return ut.useCallback(()=>{const _=x.collectionRef.current;if(!_)return[];const S=Array.from(_.querySelectorAll(`[${d}]`));return Array.from(x.itemMap.values()).sort((T,R)=>S.indexOf(T.ref.current)-S.indexOf(R.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:a,Slot:c,ItemSlot:p},y,r]}var BN=0;function _T(){A.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??yq()),document.body.insertAdjacentElement("beforeend",e[1]??yq()),BN++,()=>{BN===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),BN--}},[])}function yq(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var $N="focusScope.autoFocusOnMount",zN="focusScope.autoFocusOnUnmount",bq={bubbles:!1,cancelable:!0},AGe="FocusScope",S1=A.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=e,[o,l]=A.useState(null),c=Fs(i),u=Fs(s),d=A.useRef(null),h=tr(t,b=>l(b)),p=A.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;A.useEffect(()=>{if(r){let b=function(S){if(p.paused||!o)return;const C=S.target;o.contains(C)?d.current=C:xf(d.current,{select:!0})},x=function(S){if(p.paused||!o)return;const C=S.relatedTarget;C!==null&&(o.contains(C)||xf(d.current,{select:!0}))},w=function(S){if(document.activeElement===document.body)for(const E of S)E.removedNodes.length>0&&xf(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",x);const _=new MutationObserver(w);return o&&_.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",x),_.disconnect()}}},[r,o,p.paused]),A.useEffect(()=>{if(o){xq.add(p);const b=document.activeElement;if(!o.contains(b)){const w=new CustomEvent($N,bq);o.addEventListener($N,c),o.dispatchEvent(w),w.defaultPrevented||(RGe(OGe(kse(o)),{select:!0}),document.activeElement===b&&xf(o))}return()=>{o.removeEventListener($N,c),setTimeout(()=>{const w=new CustomEvent(zN,bq);o.addEventListener(zN,u),o.dispatchEvent(w),w.defaultPrevented||xf(b??document.body,{select:!0}),o.removeEventListener(zN,u),xq.remove(p)},0)}}},[o,c,u,p]);const y=A.useCallback(b=>{if(!n&&!r||p.paused)return;const x=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,w=document.activeElement;if(x&&w){const _=b.currentTarget,[S,C]=IGe(_);S&&C?!b.shiftKey&&w===C?(b.preventDefault(),n&&xf(S,{select:!0})):b.shiftKey&&w===S&&(b.preventDefault(),n&&xf(C,{select:!0})):w===_&&b.preventDefault()}},[n,r,p.paused]);return m.jsx(pn.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});S1.displayName=AGe;function RGe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(xf(r,{select:t}),document.activeElement!==n)return}function IGe(e){const t=kse(e),n=vq(t,e),r=vq(t.reverse(),e);return[n,r]}function kse(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function vq(e,t){for(const n of e)if(!MGe(n,{upTo:t}))return n}function MGe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function NGe(e){return e instanceof HTMLInputElement&&"select"in e}function xf(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&NGe(e)&&t&&e.select()}}var xq=jGe();function jGe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=wq(e,t),e.unshift(t)},remove(t){var n;e=wq(e,t),(n=e[0])==null||n.resume()}}}function wq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function OGe(e){return e.filter(t=>t.tagName!=="A")}function ST(e){const t=A.useRef({value:e,previous:e});return A.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var PGe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},pg=new WeakMap,DS=new WeakMap,FS={},UN=0,Ese=function(e){return e&&(e.host||Ese(e.parentNode))},DGe=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Ese(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},FGe=function(e,t,n,r){var i=DGe(t,Array.isArray(e)?e:[e]);FS[n]||(FS[n]=new WeakMap);var s=FS[n],a=[],o=new Set,l=new Set(i),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var p=h.getAttribute(r),y=p!==null&&p!=="false",b=(pg.get(h)||0)+1,x=(s.get(h)||0)+1;pg.set(h,b),s.set(h,x),a.push(h),b===1&&y&&DS.set(h,!0),x===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(w){console.error("aria-hidden: cannot operate on ",h,w)}})};return u(t),o.clear(),UN++,function(){a.forEach(function(d){var h=pg.get(d)-1,p=s.get(d)-1;pg.set(d,h),s.set(d,p),h||(DS.has(d)||d.removeAttribute(r),DS.delete(d)),p||d.removeAttribute(n)}),UN--,UN||(pg=new WeakMap,pg=new WeakMap,DS=new WeakMap,FS={})}},CT=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),i=PGe(e);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),FGe(r,i,n,"aria-hidden")):function(){return null}},qc=function(){return qc=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},qc.apply(this,arguments)};function Tse(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function LGe(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,s;r<i;r++)(s||!(r in t))&&(s||(s=Array.prototype.slice.call(t,0,r)),s[r]=t[r]);return e.concat(s||Array.prototype.slice.call(t))}var C2="right-scroll-bar-position",k2="width-before-scroll-bar",BGe="with-scroll-bars-hidden",$Ge="--removed-body-scroll-bar-size";function qN(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function zGe(e,t){var n=A.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=t,n.facade}var UGe=typeof window<"u"?A.useLayoutEffect:A.useEffect,_q=new WeakMap;function qGe(e,t){var n=zGe(null,function(r){return e.forEach(function(i){return qN(i,r)})});return UGe(function(){var r=_q.get(n);if(r){var i=new Set(r),s=new Set(e),a=n.current;i.forEach(function(o){s.has(o)||qN(o,null)}),s.forEach(function(o){i.has(o)||qN(o,a)})}_q.set(n,e)},[e]),n}function VGe(e){return e}function HGe(e,t){t===void 0&&(t=VGe);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(s){var a=t(s,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(r=!0;n.length;){var a=n;n=[],a.forEach(s)}n={push:function(o){return s(o)},filter:function(){return n}}},assignMedium:function(s){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(s),a=n}var l=function(){var u=a;a=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return i}function WGe(e){e===void 0&&(e={});var t=HGe(null);return t.options=qc({async:!0,ssr:!1},e),t}var Ase=function(e){var t=e.sideCar,n=Tse(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return A.createElement(r,qc({},n))};Ase.isSideCarExport=!0;function GGe(e,t){return e.useMedium(t),Ase}var Rse=WGe(),VN=function(){},kT=A.forwardRef(function(e,t){var n=A.useRef(null),r=A.useState({onScrollCapture:VN,onWheelCapture:VN,onTouchMoveCapture:VN}),i=r[0],s=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,p=e.noIsolation,y=e.inert,b=e.allowPinchZoom,x=e.as,w=x===void 0?"div":x,_=e.gapMode,S=Tse(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),C=h,E=qGe([n,t]),T=qc(qc({},S),i);return A.createElement(A.Fragment,null,u&&A.createElement(C,{sideCar:Rse,removeScrollBar:c,shards:d,noIsolation:p,inert:y,setCallbacks:s,allowPinchZoom:!!b,lockRef:n,gapMode:_}),a?A.cloneElement(A.Children.only(o),qc(qc({},T),{ref:E})):A.createElement(w,qc({},T,{className:l,ref:E}),o))});kT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};kT.classNames={fullWidth:k2,zeroRight:C2};var KGe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function YGe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=KGe();return t&&e.setAttribute("nonce",t),e}function ZGe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function XGe(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var JGe=function(){var e=0,t=null;return{add:function(n){e==0&&(t=YGe())&&(ZGe(t,n),XGe(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},QGe=function(){var e=JGe();return function(t,n){A.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Ise=function(){var e=QGe(),t=function(n){var r=n.styles,i=n.dynamic;return e(r,i),null};return t},eKe={left:0,top:0,right:0,gap:0},HN=function(e){return parseInt(e||"",10)||0},tKe=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[HN(n),HN(r),HN(i)]},nKe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return eKe;var t=tKe(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},rKe=Ise(),Yg="data-scroll-locked",iKe=function(e,t,n,r){var i=e.left,s=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(BGe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(Yg,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(C2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(k2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(C2," .").concat(C2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(k2," .").concat(k2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Yg,`] {
    `).concat($Ge,": ").concat(o,`px;
  }
`)},Sq=function(){var e=parseInt(document.body.getAttribute(Yg)||"0",10);return isFinite(e)?e:0},sKe=function(){A.useEffect(function(){return document.body.setAttribute(Yg,(Sq()+1).toString()),function(){var e=Sq()-1;e<=0?document.body.removeAttribute(Yg):document.body.setAttribute(Yg,e.toString())}},[])},aKe=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,i=r===void 0?"margin":r;sKe();var s=A.useMemo(function(){return nKe(i)},[i]);return A.createElement(rKe,{styles:iKe(s,!t,i,n?"":"!important")})},M4=!1;if(typeof window<"u")try{var LS=Object.defineProperty({},"passive",{get:function(){return M4=!0,!0}});window.addEventListener("test",LS,LS),window.removeEventListener("test",LS,LS)}catch{M4=!1}var mg=M4?{passive:!1}:!1,oKe=function(e){return e.tagName==="TEXTAREA"},Mse=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!oKe(e)&&n[t]==="visible")},lKe=function(e){return Mse(e,"overflowY")},cKe=function(e){return Mse(e,"overflowX")},Cq=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=Nse(e,r);if(i){var s=jse(e,r),a=s[1],o=s[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},uKe=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},dKe=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Nse=function(e,t){return e==="v"?lKe(t):cKe(t)},jse=function(e,t){return e==="v"?uKe(t):dKe(t)},fKe=function(e,t){return e==="h"&&t==="rtl"?-1:1},hKe=function(e,t,n,r,i){var s=fKe(e,window.getComputedStyle(t).direction),a=s*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var p=jse(e,o),y=p[0],b=p[1],x=p[2],w=b-x-s*y;(y||w)&&Nse(e,o)&&(d+=w,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},BS=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},kq=function(e){return[e.deltaX,e.deltaY]},Eq=function(e){return e&&"current"in e?e.current:e},pKe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},mKe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},gKe=0,gg=[];function yKe(e){var t=A.useRef([]),n=A.useRef([0,0]),r=A.useRef(),i=A.useState(gKe++)[0],s=A.useState(Ise)[0],a=A.useRef(e);A.useEffect(function(){a.current=e},[e]),A.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var b=LGe([e.lockRef.current],(e.shards||[]).map(Eq),!0).filter(Boolean);return b.forEach(function(x){return x.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),b.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var o=A.useCallback(function(b,x){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var w=BS(b),_=n.current,S="deltaX"in b?b.deltaX:_[0]-w[0],C="deltaY"in b?b.deltaY:_[1]-w[1],E,T=b.target,R=Math.abs(S)>Math.abs(C)?"h":"v";if("touches"in b&&R==="h"&&T.type==="range")return!1;var M=Cq(R,T);if(!M)return!0;if(M?E=R:(E=R==="v"?"h":"v",M=Cq(R,T)),!M)return!1;if(!r.current&&"changedTouches"in b&&(S||C)&&(r.current=E),!E)return!0;var N=r.current||E;return hKe(N,x,b,N==="h"?S:C)},[]),l=A.useCallback(function(b){var x=b;if(!(!gg.length||gg[gg.length-1]!==s)){var w="deltaY"in x?kq(x):BS(x),_=t.current.filter(function(E){return E.name===x.type&&(E.target===x.target||x.target===E.shadowParent)&&pKe(E.delta,w)})[0];if(_&&_.should){x.cancelable&&x.preventDefault();return}if(!_){var S=(a.current.shards||[]).map(Eq).filter(Boolean).filter(function(E){return E.contains(x.target)}),C=S.length>0?o(x,S[0]):!a.current.noIsolation;C&&x.cancelable&&x.preventDefault()}}},[]),c=A.useCallback(function(b,x,w,_){var S={name:b,delta:x,target:w,should:_,shadowParent:bKe(w)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(C){return C!==S})},1)},[]),u=A.useCallback(function(b){n.current=BS(b),r.current=void 0},[]),d=A.useCallback(function(b){c(b.type,kq(b),b.target,o(b,e.lockRef.current))},[]),h=A.useCallback(function(b){c(b.type,BS(b),b.target,o(b,e.lockRef.current))},[]);A.useEffect(function(){return gg.push(s),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,mg),document.addEventListener("touchmove",l,mg),document.addEventListener("touchstart",u,mg),function(){gg=gg.filter(function(b){return b!==s}),document.removeEventListener("wheel",l,mg),document.removeEventListener("touchmove",l,mg),document.removeEventListener("touchstart",u,mg)}},[]);var p=e.removeScrollBar,y=e.inert;return A.createElement(A.Fragment,null,y?A.createElement(s,{styles:mKe(i)}):null,p?A.createElement(aKe,{gapMode:e.gapMode}):null)}function bKe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const vKe=GGe(Rse,yKe);var C1=A.forwardRef(function(e,t){return A.createElement(kT,qc({},e,{ref:t,sideCar:vKe}))});C1.classNames=kT.classNames;var xKe=[" ","Enter","ArrowUp","ArrowDown"],wKe=[" ","Enter"],Vp="Select",[ET,TT,_Ke]=wT(Vp),[Ey,Zst]=Ca(Vp,[_Ke,lh]),AT=lh(),[SKe,wh]=Ey(Vp),[CKe,kKe]=Ey(Vp),Ose=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:i,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:p,form:y}=e,b=AT(t),[x,w]=A.useState(null),[_,S]=A.useState(null),[C,E]=A.useState(!1),T=_y(c),[R,M]=oc({prop:r,defaultProp:i??!1,onChange:s,caller:Vp}),[N,O]=oc({prop:a,defaultProp:o,onChange:l,caller:Vp}),B=A.useRef(null),P=x?y||!!x.closest("form"):!0,[H,F]=A.useState(new Set),Q=Array.from(H).map(q=>q.props.value).join(";");return m.jsx(eE,{...b,children:m.jsxs(SKe,{required:p,scope:t,trigger:x,onTriggerChange:w,valueNode:_,onValueNodeChange:S,valueNodeHasChildren:C,onValueNodeHasChildrenChange:E,contentId:Bs(),value:N,onValueChange:O,open:R,onOpenChange:M,dir:T,triggerPointerDownPosRef:B,disabled:h,children:[m.jsx(ET.Provider,{scope:t,children:m.jsx(CKe,{scope:e.__scopeSelect,onNativeOptionAdd:A.useCallback(q=>{F(K=>new Set(K).add(q))},[]),onNativeOptionRemove:A.useCallback(q=>{F(K=>{const U=new Set(K);return U.delete(q),U})},[]),children:n})}),P?m.jsxs(nae,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:d,value:N,onChange:q=>O(q.target.value),disabled:h,form:y,children:[N===void 0?m.jsx("option",{value:""}):null,Array.from(H)]},Q):null]})})};Ose.displayName=Vp;var Pse="SelectTrigger",Dse=A.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...i}=e,s=AT(n),a=wh(Pse,n),o=a.disabled||r,l=tr(t,a.onTriggerChange),c=TT(n),u=A.useRef("touch"),[d,h,p]=iae(b=>{const x=c().filter(S=>!S.disabled),w=x.find(S=>S.value===a.value),_=sae(x,b,w);_!==void 0&&a.onValueChange(_.value)}),y=b=>{o||(a.onOpenChange(!0),p()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return m.jsx(Mw,{asChild:!0,...s,children:m.jsx(pn.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":rae(a.value)?"":void 0,...i,ref:l,onClick:Kt(i.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Kt(i.onPointerDown,b=>{u.current=b.pointerType;const x=b.target;x.hasPointerCapture(b.pointerId)&&x.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Kt(i.onKeyDown,b=>{const x=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(x&&b.key===" ")&&xKe.includes(b.key)&&(y(),b.preventDefault())})})})});Dse.displayName=Pse;var Fse="SelectValue",Lse=A.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:i,children:s,placeholder:a="",...o}=e,l=wh(Fse,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=tr(t,l.onValueNodeChange);return sa(()=>{c(u)},[c,u]),m.jsx(pn.span,{...o,ref:d,style:{pointerEvents:"none"},children:rae(l.value)?m.jsx(m.Fragment,{children:a}):s})});Lse.displayName=Fse;var EKe="SelectIcon",Bse=A.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...i}=e;return m.jsx(pn.span,{"aria-hidden":!0,...i,ref:t,children:r||""})});Bse.displayName=EKe;var TKe="SelectPortal",$se=e=>m.jsx(ey,{asChild:!0,...e});$se.displayName=TKe;var Hp="SelectContent",zse=A.forwardRef((e,t)=>{const n=wh(Hp,e.__scopeSelect),[r,i]=A.useState();if(sa(()=>{i(new DocumentFragment)},[]),!n.open){const s=r;return s?Hl.createPortal(m.jsx(Use,{scope:e.__scopeSelect,children:m.jsx(ET.Slot,{scope:e.__scopeSelect,children:m.jsx("div",{children:e.children})})}),s):null}return m.jsx(qse,{...e,ref:t})});zse.displayName=Hp;var zl=10,[Use,_h]=Ey(Hp),AKe="SelectContentImpl",RKe=Nf("SelectContent.RemoveScroll"),qse=A.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:y,hideWhenDetached:b,avoidCollisions:x,...w}=e,_=wh(Hp,n),[S,C]=A.useState(null),[E,T]=A.useState(null),R=tr(t,Pe=>C(Pe)),[M,N]=A.useState(null),[O,B]=A.useState(null),P=TT(n),[H,F]=A.useState(!1),Q=A.useRef(!1);A.useEffect(()=>{if(S)return CT(S)},[S]),_T();const q=A.useCallback(Pe=>{const[Me,...Ee]=P().map(He=>He.ref.current),[Ue]=Ee.slice(-1),nt=document.activeElement;for(const He of Pe)if(He===nt||(He==null||He.scrollIntoView({block:"nearest"}),He===Me&&E&&(E.scrollTop=0),He===Ue&&E&&(E.scrollTop=E.scrollHeight),He==null||He.focus(),document.activeElement!==nt))return},[P,E]),K=A.useCallback(()=>q([M,S]),[q,M,S]);A.useEffect(()=>{H&&K()},[H,K]);const{onOpenChange:U,triggerPointerDownPosRef:re}=_;A.useEffect(()=>{if(S){let Pe={x:0,y:0};const Me=Ue=>{var nt,He;Pe={x:Math.abs(Math.round(Ue.pageX)-(((nt=re.current)==null?void 0:nt.x)??0)),y:Math.abs(Math.round(Ue.pageY)-(((He=re.current)==null?void 0:He.y)??0))}},Ee=Ue=>{Pe.x<=10&&Pe.y<=10?Ue.preventDefault():S.contains(Ue.target)||U(!1),document.removeEventListener("pointermove",Me),re.current=null};return re.current!==null&&(document.addEventListener("pointermove",Me),document.addEventListener("pointerup",Ee,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Me),document.removeEventListener("pointerup",Ee,{capture:!0})}}},[S,U,re]),A.useEffect(()=>{const Pe=()=>U(!1);return window.addEventListener("blur",Pe),window.addEventListener("resize",Pe),()=>{window.removeEventListener("blur",Pe),window.removeEventListener("resize",Pe)}},[U]);const[G,ne]=iae(Pe=>{const Me=P().filter(nt=>!nt.disabled),Ee=Me.find(nt=>nt.ref.current===document.activeElement),Ue=sae(Me,Pe,Ee);Ue&&setTimeout(()=>Ue.ref.current.focus())}),te=A.useCallback((Pe,Me,Ee)=>{const Ue=!Q.current&&!Ee;(_.value!==void 0&&_.value===Me||Ue)&&(N(Pe),Ue&&(Q.current=!0))},[_.value]),se=A.useCallback(()=>S==null?void 0:S.focus(),[S]),pe=A.useCallback((Pe,Me,Ee)=>{const Ue=!Q.current&&!Ee;(_.value!==void 0&&_.value===Me||Ue)&&B(Pe)},[_.value]),de=r==="popper"?N4:Vse,Ne=de===N4?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:y,hideWhenDetached:b,avoidCollisions:x}:{};return m.jsx(Use,{scope:n,content:S,viewport:E,onViewportChange:T,itemRefCallback:te,selectedItem:M,onItemLeave:se,itemTextRefCallback:pe,focusSelectedItem:K,selectedItemText:O,position:r,isPositioned:H,searchRef:G,children:m.jsx(C1,{as:RKe,allowPinchZoom:!0,children:m.jsx(S1,{asChild:!0,trapped:_.open,onMountAutoFocus:Pe=>{Pe.preventDefault()},onUnmountAutoFocus:Kt(i,Pe=>{var Me;(Me=_.trigger)==null||Me.focus({preventScroll:!0}),Pe.preventDefault()}),children:m.jsx(X0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:Pe=>Pe.preventDefault(),onDismiss:()=>_.onOpenChange(!1),children:m.jsx(de,{role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:Pe=>Pe.preventDefault(),...w,...Ne,onPlaced:()=>F(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:Kt(w.onKeyDown,Pe=>{const Me=Pe.ctrlKey||Pe.altKey||Pe.metaKey;if(Pe.key==="Tab"&&Pe.preventDefault(),!Me&&Pe.key.length===1&&ne(Pe.key),["ArrowUp","ArrowDown","Home","End"].includes(Pe.key)){let Ue=P().filter(nt=>!nt.disabled).map(nt=>nt.ref.current);if(["ArrowUp","End"].includes(Pe.key)&&(Ue=Ue.slice().reverse()),["ArrowUp","ArrowDown"].includes(Pe.key)){const nt=Pe.target,He=Ue.indexOf(nt);Ue=Ue.slice(He+1)}setTimeout(()=>q(Ue)),Pe.preventDefault()}})})})})})})});qse.displayName=AKe;var IKe="SelectItemAlignedPosition",Vse=A.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...i}=e,s=wh(Hp,n),a=_h(Hp,n),[o,l]=A.useState(null),[c,u]=A.useState(null),d=tr(t,R=>u(R)),h=TT(n),p=A.useRef(!1),y=A.useRef(!0),{viewport:b,selectedItem:x,selectedItemText:w,focusSelectedItem:_}=a,S=A.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&c&&b&&x&&w){const R=s.trigger.getBoundingClientRect(),M=c.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),O=w.getBoundingClientRect();if(s.dir!=="rtl"){const nt=O.left-M.left,He=N.left-nt,je=R.left-He,Y=R.width+je,be=Math.max(Y,M.width),Re=window.innerWidth-zl,ce=ow(He,[zl,Math.max(zl,Re-be)]);o.style.minWidth=Y+"px",o.style.left=ce+"px"}else{const nt=M.right-O.right,He=window.innerWidth-N.right-nt,je=window.innerWidth-R.right-He,Y=R.width+je,be=Math.max(Y,M.width),Re=window.innerWidth-zl,ce=ow(He,[zl,Math.max(zl,Re-be)]);o.style.minWidth=Y+"px",o.style.right=ce+"px"}const B=h(),P=window.innerHeight-zl*2,H=b.scrollHeight,F=window.getComputedStyle(c),Q=parseInt(F.borderTopWidth,10),q=parseInt(F.paddingTop,10),K=parseInt(F.borderBottomWidth,10),U=parseInt(F.paddingBottom,10),re=Q+q+H+U+K,G=Math.min(x.offsetHeight*5,re),ne=window.getComputedStyle(b),te=parseInt(ne.paddingTop,10),se=parseInt(ne.paddingBottom,10),pe=R.top+R.height/2-zl,de=P-pe,Ne=x.offsetHeight/2,Pe=x.offsetTop+Ne,Me=Q+q+Pe,Ee=re-Me;if(Me<=pe){const nt=B.length>0&&x===B[B.length-1].ref.current;o.style.bottom="0px";const He=c.clientHeight-b.offsetTop-b.offsetHeight,je=Math.max(de,Ne+(nt?se:0)+He+K),Y=Me+je;o.style.height=Y+"px"}else{const nt=B.length>0&&x===B[0].ref.current;o.style.top="0px";const je=Math.max(pe,Q+b.offsetTop+(nt?te:0)+Ne)+Ee;o.style.height=je+"px",b.scrollTop=Me-pe+b.offsetTop}o.style.margin=`${zl}px 0`,o.style.minHeight=G+"px",o.style.maxHeight=P+"px",r==null||r(),requestAnimationFrame(()=>p.current=!0)}},[h,s.trigger,s.valueNode,o,c,b,x,w,s.dir,r]);sa(()=>S(),[S]);const[C,E]=A.useState();sa(()=>{c&&E(window.getComputedStyle(c).zIndex)},[c]);const T=A.useCallback(R=>{R&&y.current===!0&&(S(),_==null||_(),y.current=!1)},[S,_]);return m.jsx(NKe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:T,children:m.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:m.jsx(pn.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Vse.displayName=IKe;var MKe="SelectPopperPosition",N4=A.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=zl,...s}=e,a=AT(n);return m.jsx(tE,{...a,...s,ref:t,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});N4.displayName=MKe;var[NKe,R6]=Ey(Hp,{}),j4="SelectViewport",Hse=A.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...i}=e,s=_h(j4,n),a=R6(j4,n),o=tr(t,s.onViewportChange),l=A.useRef(0);return m.jsxs(m.Fragment,{children:[m.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),m.jsx(ET.Slot,{scope:n,children:m.jsx(pn.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Kt(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const p=Math.abs(l.current-u.scrollTop);if(p>0){const y=window.innerHeight-zl*2,b=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),w=Math.max(b,x);if(w<y){const _=w+p,S=Math.min(y,_),C=_-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});Hse.displayName=j4;var Wse="SelectGroup",[jKe,OKe]=Ey(Wse),PKe=A.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,i=Bs();return m.jsx(jKe,{scope:n,id:i,children:m.jsx(pn.div,{role:"group","aria-labelledby":i,...r,ref:t})})});PKe.displayName=Wse;var Gse="SelectLabel",DKe=A.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,i=OKe(Gse,n);return m.jsx(pn.div,{id:i.id,...r,ref:t})});DKe.displayName=Gse;var Ek="SelectItem",[FKe,Kse]=Ey(Ek),Yse=A.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:s,...a}=e,o=wh(Ek,n),l=_h(Ek,n),c=o.value===r,[u,d]=A.useState(s??""),[h,p]=A.useState(!1),y=tr(t,_=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,_,r,i)}),b=Bs(),x=A.useRef("touch"),w=()=>{i||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return m.jsx(FKe,{scope:n,value:r,disabled:i,textId:b,isSelected:c,onItemTextChange:A.useCallback(_=>{d(S=>S||((_==null?void 0:_.textContent)??"").trim())},[]),children:m.jsx(ET.ItemSlot,{scope:n,value:r,disabled:i,textValue:u,children:m.jsx(pn.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:y,onFocus:Kt(a.onFocus,()=>p(!0)),onBlur:Kt(a.onBlur,()=>p(!1)),onClick:Kt(a.onClick,()=>{x.current!=="mouse"&&w()}),onPointerUp:Kt(a.onPointerUp,()=>{x.current==="mouse"&&w()}),onPointerDown:Kt(a.onPointerDown,_=>{x.current=_.pointerType}),onPointerMove:Kt(a.onPointerMove,_=>{var S;x.current=_.pointerType,i?(S=l.onItemLeave)==null||S.call(l):x.current==="mouse"&&_.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Kt(a.onPointerLeave,_=>{var S;_.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Kt(a.onKeyDown,_=>{var C;((C=l.searchRef)==null?void 0:C.current)!==""&&_.key===" "||(wKe.includes(_.key)&&w(),_.key===" "&&_.preventDefault())})})})})});Yse.displayName=Ek;var kv="SelectItemText",Zse=A.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:i,...s}=e,a=wh(kv,n),o=_h(kv,n),l=Kse(kv,n),c=kKe(kv,n),[u,d]=A.useState(null),h=tr(t,w=>d(w),l.onItemTextChange,w=>{var _;return(_=o.itemTextRefCallback)==null?void 0:_.call(o,w,l.value,l.disabled)}),p=u==null?void 0:u.textContent,y=A.useMemo(()=>m.jsx("option",{value:l.value,disabled:l.disabled,children:p},l.value),[l.disabled,l.value,p]),{onNativeOptionAdd:b,onNativeOptionRemove:x}=c;return sa(()=>(b(y),()=>x(y)),[b,x,y]),m.jsxs(m.Fragment,{children:[m.jsx(pn.span,{id:l.textId,...s,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Hl.createPortal(s.children,a.valueNode):null]})});Zse.displayName=kv;var Xse="SelectItemIndicator",Jse=A.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return Kse(Xse,n).isSelected?m.jsx(pn.span,{"aria-hidden":!0,...r,ref:t}):null});Jse.displayName=Xse;var O4="SelectScrollUpButton",Qse=A.forwardRef((e,t)=>{const n=_h(O4,e.__scopeSelect),r=R6(O4,e.__scopeSelect),[i,s]=A.useState(!1),a=tr(t,r.onScrollButtonChange);return sa(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),i?m.jsx(tae,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});Qse.displayName=O4;var P4="SelectScrollDownButton",eae=A.forwardRef((e,t)=>{const n=_h(P4,e.__scopeSelect),r=R6(P4,e.__scopeSelect),[i,s]=A.useState(!1),a=tr(t,r.onScrollButtonChange);return sa(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),i?m.jsx(tae,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});eae.displayName=P4;var tae=A.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=e,s=_h("SelectScrollButton",n),a=A.useRef(null),o=TT(n),l=A.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return A.useEffect(()=>()=>l(),[l]),sa(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),m.jsx(pn.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:Kt(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Kt(i.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Kt(i.onPointerLeave,()=>{l()})})}),LKe="SelectSeparator",BKe=A.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return m.jsx(pn.div,{"aria-hidden":!0,...r,ref:t})});BKe.displayName=LKe;var D4="SelectArrow",$Ke=A.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,i=AT(n),s=wh(D4,n),a=_h(D4,n);return s.open&&a.position==="popper"?m.jsx(nE,{...i,...r,ref:t}):null});$Ke.displayName=D4;var zKe="SelectBubbleInput",nae=A.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const i=A.useRef(null),s=tr(r,i),a=ST(t);return A.useEffect(()=>{const o=i.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),m.jsx(pn.select,{...n,style:{...yG,...n.style},ref:s,defaultValue:t})});nae.displayName=zKe;function rae(e){return e===""||e===void 0}function iae(e){const t=Fs(e),n=A.useRef(""),r=A.useRef(0),i=A.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),s=A.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return A.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,s]}function sae(e,t,n){const i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let a=UKe(e,Math.max(s,0));i.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function UKe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var qKe=Ose,VKe=Dse,HKe=Lse,WKe=Bse,GKe=$se,KKe=zse,YKe=Hse,ZKe=Yse,XKe=Zse,JKe=Jse,QKe=Qse,eYe=eae;function k1({...e}){return m.jsx(qKe,{"data-slot":"select",...e})}function E1({...e}){return m.jsx(HKe,{"data-slot":"select-value",...e})}function T1({className:e,size:t="default",children:n,...r}){return m.jsxs(VKe,{"data-slot":"select-trigger","data-size":t,className:dt("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,m.jsx(WKe,{asChild:!0,children:m.jsx(cu,{className:"size-4 opacity-50"})})]})}function A1({className:e,children:t,position:n="popper",...r}){return m.jsx(GKe,{children:m.jsxs(KKe,{"data-slot":"select-content",className:dt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[m.jsx(tYe,{}),m.jsx(YKe,{className:dt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),m.jsx(nYe,{})]})})}function nh({className:e,children:t,...n}){return m.jsxs(ZKe,{"data-slot":"select-item",className:dt("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[m.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:m.jsx(JKe,{children:m.jsx(za,{className:"size-4"})})}),m.jsx(XKe,{children:t})]})}function tYe({className:e,...t}){return m.jsx(QKe,{"data-slot":"select-scroll-up-button",className:dt("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(ah,{className:"size-4"})})}function nYe({className:e,...t}){return m.jsx(eYe,{"data-slot":"select-scroll-down-button",className:dt("flex cursor-default items-center justify-center py-1",e),...t,children:m.jsx(cu,{className:"size-4"})})}var rYe="Label",aae=A.forwardRef((e,t)=>m.jsx(pn.label,{...e,ref:t,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=e.onMouseDown)==null||i.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));aae.displayName=rYe;var iYe=aae;function Jt({className:e,...t}){return m.jsx(iYe,{"data-slot":"label",className:dt("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const ps=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?m.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,sYe=io.map(e=>e.value),$S=L.object({keyName:L.string().min(1,"Key Name is required."),providerType:L.enum(sYe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:L.string().min(1,"API Key Value is required.")}),oae=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:i,disabled:s=!1,className:a})=>{const o=A.useRef(null),l=Vs({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:$S,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});A.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,x;if(!u)return;const h=(b=io.find(w=>w.value===u))==null?void 0:b.label,p=l.getFieldValue("providerType"),y=(x=io.find(w=>w.value===p))==null?void 0:x.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var w;(w=o.current)==null||w.focus()})};return m.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:dt("space-y-6",a),children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsx(l.Field,{name:"providerType",validators:{onChange:$S.shape.providerType},children:u=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:u.name,children:"Provider Type"}),m.jsxs(k1,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:s||l.state.isSubmitting,children:[m.jsx(T1,{id:u.name,children:m.jsx(E1,{placeholder:"Select Provider Type"})}),m.jsx(A1,{children:io.map(d=>m.jsx(nh,{value:d.value,children:d.label},d.value))})]}),m.jsx(ps,{field:u})]})}),m.jsx(l.Field,{name:"keyName",validators:{onChange:$S.shape.keyName},children:u=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:u.name,children:"Key Name"}),m.jsx(ur,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:s||l.state.isSubmitting}),m.jsx(ps,{field:u})]})}),m.jsx(l.Field,{name:"keyValue",validators:{onChange:$S.shape.keyValue},children:u=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:u.name,children:"API Key Value"}),m.jsx(ur,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:s||l.state.isSubmitting,autoComplete:"new-password"}),m.jsx(ps,{field:u})]})})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Et,{variant:"ghost",size:"sm",onClick:i,disabled:s||l.state.isSubmitting,type:"button",children:[m.jsx(po,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,p])=>m.jsxs(Et,{type:"submit",size:"sm",disabled:s||!u||d||h||!p,children:[(d||h)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},aYe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:i,disabled:s=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=i.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return m.jsxs(k1,{value:n??"none",onValueChange:a,disabled:s||i.length===0,children:[m.jsx(T1,{className:dt("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:m.jsx(E1,{asChild:!0,children:m.jsxs("div",{className:"flex items-center overflow-hidden",children:[m.jsx(Zv,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),m.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&m.jsxs("span",{className:"mr-1",children:[t,":"]}),i.length===0?m.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),m.jsxs(A1,{className:"bg-popover border-border text-popover-foreground",children:[m.jsx(nh,{value:"none",children:m.jsx("span",{className:"text-muted-foreground",children:"None"})}),i.map(u=>m.jsx(nh,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function gw({form:e,name:t,label:n,type:r="text",placeholder:i,disabled:s,wrapperClassName:a,className:o,...l}){return m.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return m.jsxs("div",{className:dt("space-y-1.5",a),children:[m.jsx(Jt,{htmlFor:c.name,className:"text-sm",children:n}),m.jsx(ur,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:i,disabled:s??c.form.state.isSubmitting,className:dt(o,c.state.meta.errors.length?"border-destructive":""),...l}),m.jsx(ps,{field:c})]})}})}function Hv({form:e,name:t,label:n,options:r,placeholder:i,disabled:s,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return console.log("SelectField",t),m.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return m.jsxs("div",{className:dt("space-y-1.5",a),children:[m.jsx(Jt,{htmlFor:u.name,className:"text-sm",children:n}),m.jsxs(k1,{value:d,onValueChange:h=>u.handleChange(h),disabled:s??u.form.state.isSubmitting,...c,children:[m.jsx(T1,{id:u.name,onBlur:u.handleBlur,className:dt(o,u.state.meta.errors.length?"border-destructive":""),children:m.jsx(E1,{placeholder:i})}),m.jsx(A1,{className:l,children:r.map(h=>m.jsx(nh,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),m.jsx(ps,{field:u})]})}})}var RT="Switch",[oYe,Xst]=Ca(RT),[lYe,cYe]=oYe(RT),lae=A.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:s,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,p]=A.useState(null),y=tr(t,S=>p(S)),b=A.useRef(!1),x=h?u||!!h.closest("form"):!0,[w,_]=oc({prop:i,defaultProp:s??!1,onChange:c,caller:RT});return m.jsxs(lYe,{scope:n,checked:w,disabled:o,children:[m.jsx(pn.button,{type:"button",role:"switch","aria-checked":w,"aria-required":a,"data-state":fae(w),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Kt(e.onClick,S=>{_(C=>!C),x&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),x&&m.jsx(dae,{control:h,bubbles:!b.current,name:r,value:l,checked:w,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});lae.displayName=RT;var cae="SwitchThumb",uae=A.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,i=cYe(cae,n);return m.jsx(pn.span,{"data-state":fae(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t})});uae.displayName=cae;var uYe="SwitchBubbleInput",dae=A.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...i},s)=>{const a=A.useRef(null),o=tr(a,s),l=ST(n),c=Qk(t);return A.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&p){const y=new Event("click",{bubbles:r});p.call(u,n),u.dispatchEvent(y)}},[l,n,r]),m.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:o,style:{...i.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});dae.displayName=uYe;function fae(e){return e?"checked":"unchecked"}var dYe=lae,fYe=uae;function Qc({className:e,...t}){return m.jsx(dYe,{"data-slot":"switch",className:dt("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:m.jsx(fYe,{"data-slot":"switch-thumb",className:dt("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function lp({form:e,name:t,label:n,description:r,disabled:i,wrapperClassName:s,className:a,labelClassName:o,...l}){return m.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return m.jsxs("div",{className:dt("space-y-1.5",s),children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Jt,{htmlFor:c.name,className:dt("text-sm font-medium leading-none cursor-pointer",o),children:n}),m.jsx(Qc,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:i??c.form.state.isSubmitting,className:dt(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&m.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),m.jsx(ps,{field:c})]})}})}const hYe=io.map(e=>e.value),pYe=L.object({name:L.string().min(1,"Provider Name is required."),type:L.enum(hYe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:L.boolean(),apiKeyId:L.string().nullable(),baseURL:L.string().url().nullable().or(L.literal("")),autoFetchModels:L.boolean()}).refine(e=>nC(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>d0(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),mYe=io.map(e=>({value:e.value,label:e.label})),hae=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:i,isSavingExt:s=!1,disabled:a=!1,className:o})=>{var x;const l=Vs({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((x=io[0])==null?void 0:x.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:pYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{const _={...w,baseURL:(w.baseURL===null||typeof w.baseURL=="string"&&w.baseURL.trim()==="")&&!nC(w.type)?null:w.baseURL};await t(_)}}),c=A.useRef(l.state.values);A.useEffect(()=>{const w=l.store.subscribe(()=>{const _=l.state.values,S=c.current;if(n&&S)for(const C in _){const E=C;_[E]!==S[E]&&n(E,_[E])}c.current={..._}});return l.state.values!==c.current&&(c.current=l.state.values),w},[l,n]),A.useEffect(()=>{var S,C;const w=(e==null?void 0:e.type)||((S=io[0])==null?void 0:S.value),_={name:(e==null?void 0:e.name)||((C=io.find(E=>E.value===w))==null?void 0:C.label)||"",type:w,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??wp(w)};l.reset(_),c.current=_},[e]);const u=l.state.values.type,d=d0(u??null),h=nC(u??null),p=wp(u??null),y=A.useCallback(w=>{var S,C;if(!w)return;const _=l.state.values.type;if(w!==_){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",wp(w));const E=(S=io.find(M=>M.value===w))==null?void 0:S.label,T=(C=io.find(M=>M.value===_))==null?void 0:C.label,R=l.state.values.name;E&&(!(R!=null&&R.trim())||R===T)&&l.setFieldValue("name",E)}},[l]);A.useEffect(()=>{const w=l.state.values.type;w!==void 0&&y(w)},[l.state.values.type,y]);const b=(i||[]).filter(w=>!u||w.providerId===u);return m.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),l.handleSubmit()},className:dt("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[m.jsx(Hv,{form:l,name:"type",label:"Provider Type",options:mYe,disabled:a||s,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),m.jsx(gw,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||s,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&m.jsx(l.Field,{name:"apiKeyId",children:w=>m.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[m.jsx(Jt,{htmlFor:`${w.name}-trigger`,children:"API Key"})," ",m.jsx(aYe,{selectedKeyId:w.state.value??null,onKeySelected:_=>{w.handleChange(_),w.handleBlur()},apiKeys:b,disabled:a||s||!u}),m.jsx(ps,{field:w})]})}),h&&m.jsx(gw,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||s||!u,wrapperClassName:"md:col-span-2"}),p&&m.jsx(lp,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||s||!u,wrapperClassName:"md:col-span-2"}),m.jsx(lp,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||s,wrapperClassName:"md:col-span-2"})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Et,{variant:"ghost",size:"sm",onClick:r,disabled:a||s,type:"button",children:[m.jsx(po,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsx(l.Subscribe,{selector:w=>[w.canSubmit,w.isSubmitting,w.isValidating,w.isValid],children:([w,_,S,C])=>m.jsxs(Et,{type:"submit",size:"sm",disabled:a||s||!w||_||!C||S,children:[(s||_||S)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"})," ",s||_||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},pae=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:i="",initialApiKeyId:s=null})=>{const[a,o]=A.useState(!1),[l,c]=A.useState({name:i,type:r,isEnabled:!0,apiKeyId:s,baseURL:null,autoFetchModels:wp(r)});A.useEffect(()=>{c(h=>({...h,name:i||h.name||"",type:r||h.type||null,apiKeyId:s||h.apiKeyId||null,autoFetchModels:!1}))},[i,r,s]);const u=A.useCallback((h,p)=>new Promise(y=>{c(b=>{var _,S;const x={...b,[h]:p},w=b.name||"";if(h==="type"){const C=p,E=(_=io.find(R=>R.value===b.type))==null?void 0:_.label;x.apiKeyId=null,x.baseURL=null,x.autoFetchModels=C?wp(C):!1;const T=(S=io.find(R=>R.value===C))==null?void 0:S.label;if(T&&(!w.trim()||w===E)&&(x.name=T),C&&d0(C)){const R=(e||[]).filter(M=>M.providerId===C);R.length>0&&(x.apiKeyId=R[0].id)}}return x}),y(void 0)}),[e]),d=A.useCallback(async()=>{var h,p;if(!((h=l.name)!=null&&h.trim())||!l.type){Fe.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??wp(y),x={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((p=l.baseURL)==null?void 0:p.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(x),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return m.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),m.jsx(hae,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},Xu=ut.forwardRef(({className:e,href:t,children:n,...r},i)=>m.jsx("a",{ref:i,href:t,target:"_blank",rel:"noopener noreferrer",className:dt("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));Xu.displayName="Lnk";const gYe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[m.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:m.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),m.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[m.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),m.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),m.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[m.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),m.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),m.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:m.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},yYe=Z4("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function If({className:e,variant:t,asChild:n=!1,...r}){const i=n?xV:"span";return m.jsx(i,{"data-slot":"badge",className:dt(yYe({variant:t}),e),...r})}const bYe=()=>{const[e,t]=A.useState(!1);A.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},i=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],s=o=>{let l=[o];return i.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(m.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(m.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return m.jsxs(Bc.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[m.jsx("div",{className:"flex justify-center mb-4",children:m.jsxs(If,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[m.jsx(KV,{className:"w-4 h-4 mr-2 text-yellow-500"}),m.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>m.jsx(Bc.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:s(o)},l)),m.jsxs(Bc.div,{variants:r,className:"pt-2",children:[m.jsx(If,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),m.jsx(If,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var I6="Progress",M6=100,[vYe,Jst]=Ca(I6),[xYe,wYe]=vYe(I6),mae=A.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:i,getValueLabel:s=_Ye,...a}=e;(i||i===0)&&!Tq(i)&&console.error(SYe(`${i}`,"Progress"));const o=Tq(i)?i:M6;r!==null&&!Aq(r,o)&&console.error(CYe(`${r}`,"Progress"));const l=Aq(r,o)?r:null,c=Tk(l)?s(l,o):void 0;return m.jsx(xYe,{scope:n,value:l,max:o,children:m.jsx(pn.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Tk(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":bae(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});mae.displayName=I6;var gae="ProgressIndicator",yae=A.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,i=wYe(gae,n);return m.jsx(pn.div,{"data-state":bae(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:t})});yae.displayName=gae;function _Ye(e,t){return`${Math.round(e/t*100)}%`}function bae(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Tk(e){return typeof e=="number"}function Tq(e){return Tk(e)&&!isNaN(e)&&e>0}function Aq(e,t){return Tk(e)&&!isNaN(e)&&e<=t&&e>=0}function SYe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${M6}\`.`}function CYe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${M6} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var vae=mae,kYe=yae;const yw=A.forwardRef(({className:e,value:t,...n},r)=>m.jsx(vae,{ref:r,className:dt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:m.jsx(kYe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));yw.displayName=vae.displayName;var IT="Popover",[xae,Qst]=Ca(IT,[lh]),R1=lh(),[EYe,Sh]=xae(IT),wae=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:a=!1}=e,o=R1(t),l=A.useRef(null),[c,u]=A.useState(!1),[d,h]=oc({prop:r,defaultProp:i??!1,onChange:s,caller:IT});return m.jsx(eE,{...o,children:m.jsx(EYe,{scope:t,contentId:Bs(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:A.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:c,onCustomAnchorAdd:A.useCallback(()=>u(!0),[]),onCustomAnchorRemove:A.useCallback(()=>u(!1),[]),modal:a,children:n})})};wae.displayName=IT;var _ae="PopoverAnchor",TYe=A.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,i=Sh(_ae,n),s=R1(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=i;return A.useEffect(()=>(a(),()=>o()),[a,o]),m.jsx(Mw,{...s,...r,ref:t})});TYe.displayName=_ae;var Sae="PopoverTrigger",Cae=A.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,i=Sh(Sae,n),s=R1(n),a=tr(t,i.triggerRef),o=m.jsx(pn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":Rae(i.open),...r,ref:a,onClick:Kt(e.onClick,i.onOpenToggle)});return i.hasCustomAnchor?o:m.jsx(Mw,{asChild:!0,...s,children:o})});Cae.displayName=Sae;var N6="PopoverPortal",[AYe,RYe]=xae(N6,{forceMount:void 0}),kae=e=>{const{__scopePopover:t,forceMount:n,children:r,container:i}=e,s=Sh(N6,t);return m.jsx(AYe,{scope:t,forceMount:n,children:m.jsx(Hs,{present:n||s.open,children:m.jsx(ey,{asChild:!0,container:i,children:r})})})};kae.displayName=N6;var U0="PopoverContent",Eae=A.forwardRef((e,t)=>{const n=RYe(U0,e.__scopePopover),{forceMount:r=n.forceMount,...i}=e,s=Sh(U0,e.__scopePopover);return m.jsx(Hs,{present:r||s.open,children:s.modal?m.jsx(MYe,{...i,ref:t}):m.jsx(NYe,{...i,ref:t})})});Eae.displayName=U0;var IYe=Nf("PopoverContent.RemoveScroll"),MYe=A.forwardRef((e,t)=>{const n=Sh(U0,e.__scopePopover),r=A.useRef(null),i=tr(t,r),s=A.useRef(!1);return A.useEffect(()=>{const a=r.current;if(a)return CT(a)},[]),m.jsx(C1,{as:IYe,allowPinchZoom:!0,children:m.jsx(Tae,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),s.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Kt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Kt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),NYe=A.forwardRef((e,t)=>{const n=Sh(U0,e.__scopePopover),r=A.useRef(!1),i=A.useRef(!1);return m.jsx(Tae,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,s),s.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),Tae=A.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=Sh(U0,n),p=R1(n);return _T(),m.jsx(S1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:m.jsx(X0,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:m.jsx(tE,{"data-state":Rae(h.open),role:"dialog",id:h.contentId,...p,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Aae="PopoverClose",jYe=A.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,i=Sh(Aae,n);return m.jsx(pn.button,{type:"button",...r,ref:t,onClick:Kt(e.onClick,()=>i.onOpenChange(!1))})});jYe.displayName=Aae;var OYe="PopoverArrow",PYe=A.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,i=R1(n);return m.jsx(nE,{...i,...r,ref:t})});PYe.displayName=OYe;function Rae(e){return e?"open":"closed"}var DYe=wae,FYe=Cae,LYe=kae,BYe=Eae;function Al({...e}){return m.jsx(DYe,{"data-slot":"popover",...e})}function Rl({...e}){return m.jsx(FYe,{"data-slot":"popover-trigger",...e})}function Il({className:e,align:t="center",sideOffset:n=4,...r}){return m.jsx(LYe,{children:m.jsx(BYe,{"data-slot":"popover-content",align:t,sideOffset:n,className:dt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}function yg(e,t,n){let r=n.initialDeps??[],i;function s(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return i;r=d;let p;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(p=Date.now()),i=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-p)*100)/100,x=b/16,w=(_,S)=>{for(_=String(_);_.length<S;)_=" "+_;return _};console.info(`%c ${w(b,5)} /${w(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*x,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,i),i}return s.updateDeps=a=>{r=a},s}function WN(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const $Ye=(e,t)=>Math.abs(e-t)<=1,zYe=(e,t,n)=>{let r;return function(...i){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,i),n)}},Rq=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},UYe=e=>e,qYe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let i=t;i<=n;i++)r.push(i);return r},VYe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const i=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(i(Rq(n)),!r.ResizeObserver)return()=>{};const s=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){i({width:c.inlineSize,height:c.blockSize});return}}i(Rq(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return s.observe(n,{box:"border-box"}),()=>{s.unobserve(n)}},Iq={passive:!0},Mq=typeof window>"u"?!0:"onscrollend"in window,HYe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let i=0;const s=e.options.useScrollendEvent&&Mq?()=>{}:zYe(r,()=>{t(i,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;i=d?n.scrollLeft*(h&&-1||1):n.scrollTop,s(),t(i,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,Iq);const c=e.options.useScrollendEvent&&Mq;return c&&n.addEventListener("scrollend",l,Iq),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},WYe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},GYe=(e,{adjustments:t=0,behavior:n},r)=>{var i,s;const a=e+t;(s=(i=r.scrollElement)==null?void 0:i.scrollTo)==null||s.call(i,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class KYe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(i=>{i.forEach(s=>{const a=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var i;(i=r())==null||i.disconnect(),n=null},observe:i=>{var s;return(s=r())==null?void 0:s.observe(i,{box:"border-box"})},unobserve:i=>{var s;return(s=r())==null?void 0:s.unobserve(i)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,i])=>{typeof i>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:UYe,rangeExtractor:qYe,onChange:()=>{},measureElement:WYe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,i;(i=(r=this.options).onChange)==null||i.call(r,this,n)},this.maybeNotify=yg(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=s,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const i=new Map,s=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(i.has(o.lane))continue;const l=s.get(o.lane);if(l==null||o.end>l.end?s.set(o.lane,o):o.end<l.end&&i.set(o.lane,!0),i.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=yg(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,i,s,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:i,getItemKey:s,enabled:a}),{key:!1}),this.getMeasurements=yg(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:i,getItemKey:s,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=s(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),p=h?h.end+this.options.gap:r+i,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),x=p+b,w=h?h.lane:u%this.options.lanes;c[u]={index:u,start:p,size:b,end:x,key:d,lane:w}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=yg(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,i,s)=>this.range=n.length>0&&r>0?YYe({measurements:n,outerSize:r,scrollOffset:i,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=yg(()=>{let n=null,r=null;const i=this.calculateRange();return i&&(n=i.startIndex,r=i.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,i,s,a)=>s===null||a===null?[]:n({startIndex:s,endIndex:a,overscan:r,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,i=n.getAttribute(r);return i?parseInt(i,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const i=this.indexFromElement(n),s=this.measurementsCache[i];if(!s)return;const a=s.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(i,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const i=this.measurementsCache[n];if(!i)return;const s=this.itemSizeCache.get(i.key)??i.size,a=r-s;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,a,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,i)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(i))});return}this._measureElement(n,void 0)},this.getVirtualItems=yg(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const i=[];for(let s=0,a=n.length;s<a;s++){const o=n[s],l=r[o];i.push(l)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return WN(r[Iae(0,r.length-1,i=>WN(r[i]).start,n)])},this.getOffsetForAlignment=(n,r,i=0)=>{const s=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+s?"end":"start"),r==="center"?n+=(i-s)/2:r==="end"&&(n-=s);const o=this.getTotalSize()-s;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const i=this.measurementsCache[n];if(!i)return;const s=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(i.end>=a+s-this.options.scrollPaddingEnd)r="end";else if(i.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,i.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:i}={})=>{this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:i})},this.scrollToIndex=(n,{align:r="auto",behavior:i}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const s=this.getOffsetForIndex(n,r);if(!s)return;const[a,o]=s;this._scrollToOffset(a,{adjustments:void 0,behavior:i}),i!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=WN(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();$Ye(c,u)||this.scrollToIndex(n,{align:o,behavior:i})}else this.scrollToIndex(n,{align:o,behavior:i})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let i;if(r.length===0)i=this.options.paddingStart;else if(this.options.lanes===1)i=((n=r[r.length-1])==null?void 0:n.end)??0;else{const s=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&s.some(o=>o===null);){const o=r[a];s[o.lane]===null&&(s[o.lane]=o.end),a--}i=Math.max(...s.filter(o=>o!==null))}return Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:i})=>{this.options.scrollToFn(n,{behavior:i,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const Iae=(e,t,n,r)=>{for(;e<=t;){const i=(e+t)/2|0,s=n(i);if(s<r)e=i+1;else if(s>r)t=i-1;else return i}return e>0?e-1:0};function YYe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const i=e.length-1,s=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:i};let a=Iae(0,i,s,n),o=a;if(r===1)for(;o<i&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<i&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(i,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const Nq=typeof document<"u"?A.useLayoutEffect:A.useEffect;function ZYe(e){const t=A.useReducer(()=>({}),{})[1],n={...e,onChange:(i,s)=>{var a;s?Hl.flushSync(t):t(),(a=e.onChange)==null||a.call(e,i,s)}},[r]=A.useState(()=>new KYe(n));return r.setOptions(n),Nq(()=>r._didMount(),[]),Nq(()=>r._willUpdate()),r}function j6(e){return ZYe({observeElementRect:VYe,observeElementOffset:HYe,scrollToFn:GYe,...e})}const jq=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},O6=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:i=!1,disabled:s=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=A.useState(null),u=A.useCallback(Q=>{if(Q){const q=Q.querySelector("[data-radix-scroll-area-viewport]");if(q)c(q);else{const K=new MutationObserver(()=>{const U=Q.querySelector("[data-radix-scroll-area-viewport]");U&&(c(U),K.disconnect())});return K.observe(Q,{childList:!0,subtree:!0}),()=>K.disconnect()}}else c(null)},[]),[d,h]=A.useState(""),[p,y]=A.useState(!1),[b,x]=A.useState("all"),[w,_]=A.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[S,C]=A.useState(""),[E,T]=A.useState(""),[R,M]=A.useState(""),[N,O]=A.useState(""),B=A.useMemo(()=>{let Q=[...t];if(b==="enabled"?Q=Q.filter(de=>n.has(de.id)):b==="disabled"&&(Q=Q.filter(de=>!n.has(de.id))),d.trim()){const de=d.toLowerCase();Q=Q.filter(Ne=>Ne.name.toLowerCase().includes(de)||Ne.id.toLowerCase().includes(de))}const q=Object.entries(w).filter(([,de])=>de).map(([de])=>de);q.length>0&&(Q=Q.filter(de=>{var Me;const Ne=new Set(de.supported_parameters??[]),Pe=new Set(((Me=de.architecture)==null?void 0:Me.input_modalities)??[]);return q.every(Ee=>{switch(Ee){case"reasoning":return Ne.has("reasoning");case"webSearch":return Ne.has("web_search")||Ne.has("web_search_options");case"tools":return Ne.has("tools");case"multimodal":return Array.from(Pe).some(Ue=>Ue!=="text");default:return!0}})}));const K=parseFloat(S),U=parseFloat(E),re=parseFloat(R),G=parseFloat(N),ne=!isNaN(K),te=!isNaN(U),se=!isNaN(re),pe=!isNaN(G);return(ne||te||se||pe)&&(Q=Q.filter(de=>{var be,Re;const Ne=jq((be=de.pricing)==null?void 0:be.prompt),Pe=jq((Re=de.pricing)==null?void 0:Re.completion),Me=ne?K/1e6:-1/0,Ee=te?U/1e6:1/0,Ue=se?re/1e6:-1/0,nt=pe?G/1e6:1/0,He=Ne!==null&&Ne>=Me&&Ne<=Ee,je=Pe!==null&&Pe>=Ue&&Pe<=nt;let Y=!0;return(ne||te)&&Y&&(Y=He),(se||pe)&&Y&&(Y=je),Y})),Q},[t,d,b,n,w,S,E,R,N]),P=j6({count:B.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),H=Q=>{_(q=>({...q,[Q]:!q[Q]}))},F=(b!=="all"?1:0)+Object.values(w).filter(Boolean).length+(S||E||R||N?1:0);return i?m.jsxs("div",{className:dt("space-y-2",a),children:[m.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),m.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),m.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?m.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):m.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[m.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m.jsxs("div",{className:"relative flex-grow",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{value:d,onChange:Q=>h(Q.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:s})]}),m.jsxs(Al,{open:p,onOpenChange:y,children:[m.jsx(Rl,{asChild:!0,children:m.jsxs(Et,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:s,children:[m.jsx(J4,{className:"h-4 w-4 mr-1"}),"Filters",F>0&&m.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:F})]})}),m.jsxs(Il,{className:"w-72 p-4 space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Jt,{className:"text-xs font-semibold",children:"Status"}),m.jsxs("div",{className:"flex gap-1",children:[m.jsx(Et,{variant:b==="all"?"secondary":"outline",size:"sm",onClick:()=>x("all"),children:"All"}),m.jsxs(Et,{variant:b==="enabled"?"secondary":"outline",size:"sm",onClick:()=>x("enabled"),children:[m.jsx(za,{className:"h-3 w-3 mr-1"})," Enabled"]}),m.jsxs(Et,{variant:b==="disabled"?"secondary":"outline",size:"sm",onClick:()=>x("disabled"),children:[m.jsx(ofe,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Jt,{className:"text-xs font-semibold",children:"Capabilities"}),m.jsxs("div",{className:"flex flex-wrap gap-1",children:[m.jsx(Rn,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:m.jsx(sh,{}),onClick:()=>H("reasoning"),variant:w.reasoning?"secondary":"outline",className:dt(w.reasoning&&"text-primary")}),m.jsx(Rn,{tooltipText:"Web Search","aria-label":"Web Search",icon:m.jsx(va,{}),onClick:()=>H("webSearch"),variant:w.webSearch?"secondary":"outline",className:dt(w.webSearch&&"text-primary")}),m.jsx(Rn,{tooltipText:"Tools","aria-label":"Tools",icon:m.jsx(Rp,{}),onClick:()=>H("tools"),variant:w.tools?"secondary":"outline",className:dt(w.tools&&"text-primary")}),m.jsx(Rn,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:m.jsx(Tp,{}),onClick:()=>H("multimodal"),variant:w.multimodal?"secondary":"outline",className:dt(w.multimodal&&"text-primary")})]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs(Jt,{className:"text-xs font-semibold flex items-center gap-1",children:[m.jsx(Dfe,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsx(ur,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:S,onChange:Q=>C(Q.target.value),className:"h-8 text-xs"}),m.jsx(ur,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:E,onChange:Q=>T(Q.target.value),className:"h-8 text-xs"}),m.jsx(ur,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:R,onChange:Q=>M(Q.target.value),className:"h-8 text-xs"}),m.jsx(ur,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:N,onChange:Q=>O(Q.target.value),className:"h-8 text-xs"})]})]})]})]})]}),m.jsxs(Sa,{className:dt("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&m.jsx("div",{style:{height:`${P.getTotalSize()}px`,width:"100%",position:"relative"},children:B.length===0&&!i?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):P.getVirtualItems().map(Q=>{const q=B[Q.index];return q?m.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${Q.size}px`,transform:`translateY(${Q.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[m.jsx(Qc,{id:`enable-model-${e}-${q.id}`,checked:n.has(q.id),onCheckedChange:K=>r(q.id,K),disabled:s,"aria-label":`Enable model ${q.name||q.id}`,className:"flex-shrink-0",onClick:K=>K.stopPropagation()}),m.jsx(Jt,{htmlFor:`enable-model-${e}-${q.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:q.name||q.id,onClick:o?()=>o(q.id):void 0,children:q.name||q.id})]},q.id):null})}),!l&&!i&&m.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},XYe=({stepNumber:e,title:t,description:n,isComplete:r,isActive:i,openOnComplete:s=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=A.useState(!1);return A.useEffect(()=>{u(i||r&&s)},[i,r,s]),m.jsxs(VD,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":i?"border-l-4 border-l-primary/70":""}`,children:[m.jsx(HD,{className:"pb-2",children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":i?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?m.jsx(Dk,{className:"h-5 w-5"}):m.jsx("div",{className:"flex items-center justify-center",children:o})}),m.jsxs("div",{className:"flex-1",children:[m.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[m.jsxs(WD,{className:"text-base",children:[m.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),m.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:m.jsx(LV,{className:"h-4 w-4"})})]}),!c&&m.jsx(Vre,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),m.jsx(RUe,{children:c&&m.jsx(Bc.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:m.jsxs(GD,{className:"pt-2",children:[typeof n=="string"?m.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):m.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),m.jsx("div",{className:a,children:l})]})})})]})},JYe=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:i,getAllAvailableModelDefsForProvider:s,isLoading:a,enableApiKeyManagement:o}=Er(Cn(se=>({apiKeys:se.dbApiKeys,addApiKey:se.addApiKey,providers:se.dbProviderConfigs,addProviderConfig:se.addProviderConfig,updateProviderConfig:se.updateProviderConfig,getAllAvailableModelDefsForProvider:se.getAllAvailableModelDefsForProvider,isLoading:se.isLoading,enableApiKeyManagement:se.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=Dn(Cn(se=>({addConversation:se.addConversation,selectItem:se.selectItem}))),[u,d]=A.useState(!1),[h,p]=A.useState(!1),[y,b]=A.useState(!1),[x,w]=A.useState(!1),[_,S]=A.useState(!1),C=A.useMemo(()=>!o||e.length>0,[o,e]),E=A.useMemo(()=>n.length>0,[n]),T=A.useMemo(()=>n.some(se=>se.isEnabled&&se.enabledModels&&se.enabledModels.length>0),[n]),R=A.useMemo(()=>{const se=[...n].sort((pe,de)=>de.createdAt.getTime()-pe.createdAt.getTime());return se.length>0?se[0]:null},[n]),M=A.useMemo(()=>R?s(R.id):[],[R,s]),N=A.useMemo(()=>new Set((R==null?void 0:R.enabledModels)??[]),[R]),{initialProviderTypeForForm:O,initialProviderNameForForm:B,initialApiKeyIdForForm:P}=A.useMemo(()=>{var se;if(E)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const de=[...e].sort((Ne,Pe)=>Pe.createdAt.getTime()-Ne.createdAt.getTime()).find(Ne=>d0(Ne.providerId));if(de){const Ne=de.providerId,Pe=((se=io.find(Me=>Me.value===Ne))==null?void 0:se.label)||Ne;return{initialProviderTypeForForm:Ne,initialProviderNameForForm:Pe,initialApiKeyIdForForm:de.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,E]),H=A.useCallback(async(se,pe,de)=>{d(!0);try{await t(se,pe,de),Fe.success("API key added successfully!")}finally{d(!1)}},[t]),F=A.useCallback(async se=>{p(!0);try{const pe={...se,apiKeyId:se.apiKeyId??(d0(se.type)?P??null:null)},de=await r(pe);return Fe.success("Provider added successfully!"),de}finally{p(!1)}},[r,P]),Q=A.useCallback(async(se,pe)=>{if(!R)return;w(!0);const de=new Set(R.enabledModels??[]);pe?de.add(se):de.delete(se);const Ne=Array.from(de);try{await i(R.id,{enabledModels:Ne}),Fe.success(pe?"Model enabled successfully!":"Model disabled successfully!")}catch(Pe){Fe.error("Failed to update model status."),console.error("Failed to save model toggle:",Pe)}finally{w(!1)}},[R,i]),q=A.useCallback(async()=>{b(!0),S(!0);try{await new Promise(pe=>setTimeout(pe,800));const se=await l({title:"New Chat"});await c(se,"conversation"),Fe.success("Welcome to your first chat!")}catch(se){Fe.error("Failed to start your first chat."),console.error("Failed to start first chat:",se),b(!1),S(!1)}},[l,c]),K=()=>{Be.emit(kr.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},U=[C,E,T].filter(Boolean).length,re=o?3:2,G=U/re*100,ne=[...o?[{id:"api-key",title:"Add API Key",description:m.jsxs("div",{className:"space-y-2",children:[m.jsxs("p",{children:["To use providers like"," ",m.jsx(Xu,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",m.jsx(Xu,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",m.jsx(Xu,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",m.jsx(Xu,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),m.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",m.jsx(Xu,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",m.jsx(Xu,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:C,content:m.jsx(oae,{onSave:H,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:O}),icon:m.jsx(Zv,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),m.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:E,content:m.jsx(pae,{apiKeys:e,onAddProvider:F,onCancel:()=>{},initialType:O,initialName:B,initialApiKeyId:P}),icon:m.jsx(A2,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:m.jsxs("div",{className:"space-y-2",children:[m.jsxs("p",{children:["Enable models for the provider you just added (",m.jsx("span",{className:"font-medium text-primary",children:(R==null?void 0:R.name)||"..."}),")."]}),m.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),m.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:T,content:R?m.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:m.jsx(O6,{providerId:R.id,allAvailableModels:M,enabledModelIds:N,onToggleModel:Q,isLoading:a||x,listHeightClass:"h-[26rem]"})}):m.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[m.jsx(nc,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:m.jsx(sh,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:m.jsxs("div",{children:[_&&m.jsx(Bc.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:m.jsx(yw,{value:y?void 0:100,className:"h-2"})}),m.jsxs(Et,{onClick:q,disabled:y||!T,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[m.jsx(Ihe,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),m.jsx(Hre,{})]}),contentClassName:"p-4",icon:m.jsx(Xhe,{className:"h-4 w-4"})}],te=ne.findIndex(se=>!se.isComplete);return a?m.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:m.jsxs(Bc.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[m.jsx(Pr,{className:"h-12 w-1/2 mx-auto mb-6"}),m.jsx(Pr,{className:"h-8 w-3/4 mx-auto mb-2"}),m.jsx(Pr,{className:"h-4 w-1/2 mx-auto mb-8"}),m.jsx(Pr,{className:"h-20 w-full mb-6"}),m.jsx(Pr,{className:"h-20 w-full mb-6"}),m.jsx(Pr,{className:"h-20 w-full"})]})}):m.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:m.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[m.jsxs("div",{className:"text-center mb-8",children:[m.jsx(Bc.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:m.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[m.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),m.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:m.jsx(gYe,{className:"h-10 w-10 text-white"})})]})}),m.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),m.jsx(bYe,{})]}),m.jsxs(Bc.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[m.jsx(hr,{children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[m.jsx(yw,{value:G,className:"h-1.5"}),m.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(G),"%"]})]})}),m.jsx(yr,{children:m.jsxs("p",{children:["Steps completed: ",U," of ",re]})})]})}),ne.map((se,pe)=>{const de=pe===te;return m.jsx(Bc.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:pe*.1,duration:.3},children:m.jsx(XYe,{stepNumber:pe+1,title:se.title,description:se.description,isComplete:se.id!=="start-chat"&&se.isComplete,isActive:de,openOnComplete:se.id==="enable-models",contentClassName:se.id==="add-provider"||se.id==="api-key"?"p-0 border-none shadow-none bg-transparent":se.contentClassName,icon:se.icon,children:se.content})},se.id)})]}),!a&&!E&&te===-1&&m.jsxs(Bc.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[m.jsx(nc,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),m.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),m.jsx(Et,{variant:"outline",size:"sm",onClick:K,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},zS=["conversation.title_generation"],QYe=({conversationId:e,interactions:t,status:n,className:r})=>{const i=A.useRef(null),s=A.useRef(null),[a,o]=A.useState(!1),l=A.useRef(null),c=On(F=>F.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=dr(Cn(F=>({chatMaxWidth:F.chatMaxWidth,autoScrollInterval:F.autoScrollInterval,enableAutoScrollOnStream:F.enableAutoScrollOnStream}))),p=dr(F=>F.setEnableAutoScrollOnStream),y=A.useMemo(()=>F=>({isLoading:F.isLoading}),[]),b=A.useMemo(()=>F=>({conversationCount:F.conversations.length,isConversationLoading:F.isLoading}),[]),{isLoading:x}=Er(Cn(y)),{conversationCount:w,isConversationLoading:_}=Dn(Cn(b)),{projectCount:S,isProjectLoading:C}=bo(Cn(F=>({projectCount:F.projects.length,isProjectLoading:F.isLoading}))),E=A.useMemo(()=>x||_||C?!1:w===0&&S===0,[w,S,x,_,C]),T=A.useMemo(()=>t.filter(q=>q.parentId===null&&!zS.includes(q.type)).sort((q,K)=>q.index-K.index).map(q=>{const K=t.filter(U=>U.parentId===q.id&&!zS.includes(U.type)).sort((U,re)=>U.index-re.index);return[q,...K]}),[t]),R=Ho(Cn(F=>Object.values(F.canvasControls))),M=A.useCallback((F,Q,q,K)=>R.filter(re=>{const G=re.type===F,ne=re.targetSlot===Q,te=!!re.renderer;return G&&ne&&te}).map(re=>{if(re.renderer){const ne={...{interaction:q,interactionId:q==null?void 0:q.id,responseContent:typeof(q==null?void 0:q.response)=="string"?q.response:void 0,canvasContextType:F},...K};return m.jsx(ut.Fragment,{children:re.renderer(ne)},re.id)}return null}).filter(Boolean),[R]),N=(F="smooth")=>{s.current&&s.current.scrollTo({top:s.current.scrollHeight,behavior:F})};A.useEffect(()=>{if(s.current){const{scrollHeight:F,clientHeight:Q,scrollTop:q}=s.current;(F-Q<=q+150||n!=="streaming")&&requestAnimationFrame(()=>{N(n==="streaming"?"smooth":"auto")})}},[T.length,n]),A.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{N("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),A.useEffect(()=>{const F=s.current;if(!F)return;const Q=()=>{if(!s.current)return;const{scrollHeight:q,clientHeight:K,scrollTop:U}=s.current,re=U<q-K-K*.5;o(re)};return F.addEventListener("scroll",Q,{passive:!0}),Q(),()=>{s.current&&s.current.removeEventListener("scroll",Q)}},[]),A.useEffect(()=>{i.current&&(s.current=i.current.querySelector("[data-radix-scroll-area-viewport]"))},[]);const O=A.useMemo(()=>{const F=[];return[...t].sort((K,U)=>{var re,G;return K.index!==U.index?K.index-U.index:K.parentId===null&&U.parentId!==null?-1:K.parentId!==null&&U.parentId===null?1:K.parentId!==null&&U.parentId!==null&&K.parentId===U.parentId?K.index-U.index:(((re=K.startedAt)==null?void 0:re.getTime())??0)-(((G=U.startedAt)==null?void 0:G.getTime())??0)}).filter(K=>K.parentId===null&&!zS.includes(K.type)).forEach(K=>{var ne,te;let U=null;if(K.type==="message.user_assistant"&&K.prompt)U=K.prompt;else if(K.type==="message.assistant_regen"&&((ne=K.metadata)!=null&&ne.regeneratedFromId)){let se,pe=K;const de=new Set;for(;pe&&!de.has(pe.id);){if(de.add(pe.id),pe.type==="message.user_assistant"&&pe.prompt){se=pe;break}if((te=pe.metadata)!=null&&te.regeneratedFromId)pe=t.find(Ne=>Ne.id===pe.metadata.regeneratedFromId);else break}se?U=se.prompt:K.prompt?U=K.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${K.id} of type ${K.type}. Displaying turn without prompt.`)}if(U)F.push(m.jsx(uT,{turnData:U,timestamp:K.startedAt,isAssistantComplete:K.status==="COMPLETED"||K.status==="ERROR"},`prompt-${K.id}`));else if(K.type!=="message.user_assistant"&&K.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",K.id,K.type);return}const re=t.filter(se=>se.parentId===K.id&&!zS.includes(se.type)).sort((se,pe)=>se.index-pe.index),G=[K,...re];G.length>0&&F.push(m.jsx(aUe,{interactionGroup:G,renderSlot:(se,pe,de)=>M("interaction",se,pe,de),activeStreamingInteractionId:c.find(se=>G.some(pe=>pe.id===se))},`tabs-${K.id}`))}),F},[t,M,c]),B=A.useMemo(()=>c.filter(F=>!t.some(Q=>Q.id===F)).map(F=>m.jsx(mk,{interactionId:F,renderSlot:(Q,q,K)=>M("interaction",Q,q,K)},`${F}-streaming-new`)),[c,t,M]),P=()=>x||_||C?m.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[m.jsx(Pr,{className:"h-24 w-full"}),m.jsx(Pr,{className:"h-32 w-full"}),m.jsx(Pr,{className:"h-20 w-full"})]}):e?T.length===0&&n!=="streaming"&&c.length===0?m.jsx(G7,{}):m.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[O,B]}):m.jsx(G7,{}),H=u||"max-w-7xl";return m.jsx("div",{className:dt("flex-grow relative",r),children:E?m.jsx(Sa,{className:"h-full w-full",children:m.jsx("div",{className:dt("mx-auto w-full",H),children:m.jsx(JYe,{})})}):m.jsxs(m.Fragment,{children:[m.jsx(Sa,{className:"h-full w-full",ref:i,children:m.jsx("div",{className:dt("mx-auto w-full",H),children:P()})}),a&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>N(),"aria-label":"Scroll to bottom",children:m.jsx(DV,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>p(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?m.jsx(qhe,{className:"h-4 w-4"}):m.jsx(Whe,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},eZe=ut.memo(QYe),bg=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const i=e.filter(s=>(s.panel??"main")===t&&(s.show?s.show():!0));return i.length===0?null:m.jsx("div",{className:dt(r),children:i.map(s=>{const a=n==="icon"?s.iconRenderer:s.renderer;return m.jsx(ut.Fragment,{children:a?a():null},s.id)})})},bw=_l(Sl((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const i=t().isChatControlPanelOpen[n]??!1,s=r??!i;i!==s&&(e(a=>{a.isChatControlPanelOpen[n]=s}),Be.emit(kr.chatControlPanelVisibilityChanged,{panelId:n,isOpen:s}))},togglePromptControlPanel:(n,r)=>{const i=t().isPromptControlPanelOpen[n]??!1,s=r??!i;i!==s&&(e(a=>{a.isPromptControlPanelOpen[n]=s}),Be.emit(kr.promptControlPanelVisibilityChanged,{controlId:n,isOpen:s}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,i=n??!r;r!==i&&(e({isSidebarCollapsed:i}),Be.emit(kr.sidebarVisibilityChanged,{isCollapsed:i}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Be.emit(kr.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Be.emit(kr.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Be.emit(kr.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:kr.toggleSidebarRequest,handler:i=>r.toggleSidebar(i==null?void 0:i.isCollapsed),storeId:n},{eventName:kr.toggleChatControlPanelRequest,handler:i=>r.toggleChatControlPanel(i.panelId,i.isOpen),storeId:n},{eventName:kr.togglePromptControlPanelRequest,handler:i=>r.togglePromptControlPanel(i.controlId,i.isOpen),storeId:n},{eventName:kr.setGlobalLoadingRequest,handler:i=>r.setGlobalLoading(i.loading),storeId:n},{eventName:kr.setGlobalErrorRequest,handler:i=>r.setGlobalError(i.error),storeId:n},{eventName:kr.setFocusInputFlagRequest,handler:i=>r.setFocusInputFlag(i.focus),storeId:n}]}})));var tZe=(e,t,n,r,i,s,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(p){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",x=b&&s?i.map(w=>s[w]||w):i;b?(l.classList.remove(...x),l.classList.add(s&&s[p]?s[p]:p)):l.setAttribute(y,p)}),d(p)}function d(p){o&&c.includes(p)&&(l.style.colorScheme=p)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let p=localStorage.getItem(t)||n,y=a&&p==="system"?h():p;u(y)}catch{}},nZe=A.createContext(void 0),rZe={setTheme:e=>{},themes:[]},iZe=()=>{var e;return(e=A.useContext(nZe))!=null?e:rZe};A.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:i,defaultTheme:s,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,s,e,o,a,r,i]).slice(1,-1);return A.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${tZe.toString()})(${u})`}})});const sZe=({...e})=>{const{theme:t="system"}=iZe();return m.jsx(kme,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function Id({className:e,...t}){return m.jsx("textarea",{"data-slot":"textarea",className:dt("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const Mae=A.memo(A.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:i,onValueChange:s,...a},o)=>{const l=A.useRef(null),[c,u]=A.useState(e);A.useImperativeHandle(o,()=>({getValue:()=>c,setValue:p=>{u(p),s&&s(p),Be.emit(Pn.inputChanged,{value:p}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var p;return(p=l.current)==null?void 0:p.focus()},clearValue:()=>{u(""),s&&s(""),Be.emit(Pn.inputChanged,{value:""}),requestAnimationFrame(()=>{const p=l.current;p&&(p.style.height="auto",p.style.height=`${p.scrollHeight}px`,p.style.overflowY="hidden")})}}));const d=p=>{var y;if(p.key==="Enter"&&!p.shiftKey&&!n){p.preventDefault();const b=Of.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=p=>{const y=p.target.value;u(y),s&&s(y),Be.emit(Pn.inputChanged,{value:y})};return A.useEffect(()=>{const p=l.current;if(p){p.style.height="auto";const y=p.scrollHeight,b=250;p.style.height=`${Math.min(y,b)}px`,p.style.overflowY=y>b?"auto":"hidden"}},[c]),A.useEffect(()=>{e!==c&&(u(e),s&&s(e))},[e,s]),m.jsx(Id,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:dt("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",i),"aria-label":"Chat input",...a})}));Mae.displayName="InputArea";const ds={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},rh=_l(Sl((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await Rt.loadMods();e({dbMods:n,isLoading:!1}),Be.emit(ds.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Be.emit(ds.loadingStateChanged,{isLoading:!1,error:r}),Fe.error(r)}},addDbMod:async n=>{const r=zs(),i={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(s=>{s.dbMods.push(i),s.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await Rt.saveMod(i),Fe.success(`Mod "${i.name}" added.`),Be.emit(ds.dbModsLoaded,{dbMods:t().dbMods}),r}catch(s){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",s),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Be.emit(ds.loadingStateChanged,{isLoading:t().isLoading,error:a}),Fe.error(a),s}},updateDbMod:async(n,r)=>{let i,s=-1;e(o=>{s=o.dbMods.findIndex(l=>l.id===n),s!==-1?(i={...o.dbMods[s]},o.dbMods[s]={...o.dbMods[s],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=s!==-1?t().dbMods[s]:void 0;if(a)try{await Rt.saveMod(a),Fe.success(`Mod "${a.name}" updated.`),Be.emit(ds.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&i&&(c.dbMods[u]=i,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Be.emit(ds.loadingStateChanged,{isLoading:t().isLoading,error:l}),Fe.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(s=>s.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const i=r.name;e(s=>({dbMods:s.dbMods.filter(a=>a.id!==n)}));try{await Rt.deleteMod(n),Fe.success(`Mod "${i}" deleted.`),Be.emit(ds.dbModsLoaded,{dbMods:t().dbMods})}catch(s){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",s),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Be.emit(ds.loadingStateChanged,{isLoading:t().isLoading,error:a}),Fe.error(a),s}},setLoadedMods:n=>{e({loadedMods:n}),Be.emit(ds.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(i=>i.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((i,s)=>(i.order??999)-(s.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const i=r.modSettingsTabs.findIndex(s=>s.id===n.id);r.modSettingsTabs[i]=n,r.modSettingsTabs.sort((s,a)=>(s.order??999)-(a.order??999))}}),Be.emit(ds.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(i=>i.id!==n)}),Be.emit(ds.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),i=s=>async a=>{await s(a)};return[{eventName:ds.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:ds.addDbModRequest,handler:i(r.addDbMod),storeId:n},{eventName:ds.updateDbModRequest,handler:s=>r.updateDbMod(s.id,s.changes),storeId:n},{eventName:ds.deleteDbModRequest,handler:s=>r.deleteDbMod(s.id),storeId:n}]}}))),Ch={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function F4(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:i=>(Be.emit(Nr.registerPromptControlRequest,{control:i}),()=>Be.emit(Nr.unregisterPromptControlRequest,{id:i.id})),registerChatControl:i=>{const s={...i,status:i.status??(()=>"ready")};return Be.emit(Nr.registerChatControlRequest,{control:s}),()=>Be.emit(Nr.unregisterChatControlRequest,{id:i.id})},registerCanvasControl:i=>(Be.emit(Nr.registerCanvasControlRequest,{control:i}),()=>Be.emit(Nr.unregisterCanvasControlRequest,{id:i.id})),registerTool:(i,s,a)=>(console.log(`[${n}] Registering tool: ${i}`),Be.emit(Nr.registerToolRequest,{modId:t,toolName:i,definition:s,implementation:a}),()=>Be.emit(Nr.unregisterToolRequest,{toolName:i})),on:(i,s)=>(Be.on(i,s),()=>Be.off(i,s)),emit:(i,s)=>{Be.emit(i,s)},addMiddleware:(i,s)=>(Be.emit(Nr.registerMiddlewareRequest,{hookName:i,modId:t,callback:s}),()=>Be.emit(Nr.unregisterMiddlewareRequest,{hookName:i,modId:t,callback:s})),registerSettingsTab:i=>(rh.getState()._addSettingsTab(i),()=>rh.getState()._removeSettingsTab(i.id)),getContextSnapshot:()=>{const i=On.getState(),s=Dn.getState(),a=dr.getState(),o=Er.getState(),{providerId:l}=Xl(o.selectedModelId),c=s.selectedItemType==="conversation"?s.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(i.currentConversationId===c?i.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:i.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(i,s)=>{Fe[i](`[Mod: ${n}] ${s}`)},log:(i,...s)=>{console[i](`[Mod: ${n}]`,...s)},registerModalProvider:(i,s)=>(Be.emit(Nr.registerModalProviderRequest,{modalId:i,provider:s}),()=>Be.emit(Nr.unregisterModalProviderRequest,{modalId:i})),getVfsInstance:async i=>Bi.getState().initializeVFS(i,{force:!0})}}async function aZe(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let i=r.scriptContent,s=null,a=null;try{if(s=F4(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);i=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!i)throw new Error("Mod script content is empty.");new Function("modApi",i)(s),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),Fe.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}s||(s=F4(r));const o={id:r.id,name:r.name,api:s,error:a};return Be.emit(o.error?ds.modError:ds.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Be.emit(Ch.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const lr={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},Oq=null;class oZe{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return Oq!==null}static getBundledConfig(){return Oq}}class vw{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){Fe.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=Dn.getState(),i=r.syncRepos,s=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?i.length:0,completedRepos:0,totalConversations:n.syncConversations?s.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Be.emit(ei.bulkSyncStarted,{progress:a}),Fe.info(`Starting bulk sync: ${i.length} repositories, ${s.length} conversations`),n.syncRepos&&i.length>0&&await this.syncRepositoriesInBatches(i,n,a),n.syncConversations&&s.length>0&&await this.syncConversationsInBatches(s,n,a);const o=a.errors.length>0;Be.emit(ei.bulkSyncCompleted,{progress:a,success:!o}),o?(Fe.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):Fe.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),Fe.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Be.emit(ei.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=Dn.getState(),n=t.conversations.filter(r=>{const i=t.conversationSyncStatus[r.id];return r.syncRepoId&&i==="needs-sync"});if(n.length===0){Fe.info("No conversations need syncing");return}Fe.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=Dn.getState().syncRepos;if(n.length===0){Fe.info("No repositories configured");return}Fe.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),Fe.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var s;r.currentOperation="Initializing repositories...",Be.emit(ei.bulkSyncProgress,{progress:r});const i=this.createBatches(t,n.maxConcurrent);for(const a of i){if((s=this.abortController)!=null&&s.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Be.emit(ei.bulkSyncProgress,{progress:r}),await Dn.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Be.emit(ei.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var s;r.currentOperation="Syncing conversations...",Be.emit(ei.bulkSyncProgress,{progress:r});const i=this.createBatches(t,n.maxConcurrent);for(const a of i){if((s=this.abortController)!=null&&s.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Be.emit(ei.bulkSyncProgress,{progress:r}),await Dn.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Be.emit(ei.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let i=0;i<t.length;i+=n)r.push(t.slice(i,i+n));return r}}_e(vw,"isRunning",!1),_e(vw,"abortController",null);const Zg=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:vw},Symbol.toStringTag,{value:"Module"}));class Nae{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=Dn.getState(),n=dr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,i=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${i.length} synced conversations`);const s=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});s.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${s.length} repositories in background`),setTimeout(async()=>{try{await vw.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):s.length>0&&console.log(`[StartupSync] Found ${s.length} uninitialized repositories, but auto-initialization is disabled`);const a=i.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await vw.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}_e(Nae,"hasRunStartupSync",!1);function lZe(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,i=[];function s(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),Fe.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),Fe.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!s(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),i.push(a),!0}for(const a of e)if(!n.has(a.id)&&!s(a))return null;return i}async function cZe(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await oZe.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(nn.loadSettingsRequest,void 0),t.emit(ir.loadInitialDataRequest,void 0),t.emit(lr.loadRulesAndTagsRequest,void 0),t.emit(Un.loadConversationsRequest,void 0),t.emit(na.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,i=!1,s=!1,a=!1,o=!1;const l=()=>{r&&i&&s&&a&&o&&n()},c=t.on(nn.loaded,()=>{r=!0,c(),l()}),u=t.on(ir.initialDataLoaded,()=>{i=!0,u(),l()}),d=t.on(lr.dataLoaded,()=>{s=!0,d(),l()}),h=t.on(Un.conversationsLoaded,()=>{a=!0,h(),l()}),p=t.on(na.loaded,()=>{o=!0,p(),l()})}),Be.emit(Ch.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{Nae.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function uZe(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(i=>new i),r=lZe(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(i=>i.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const i of r)try{await i.initialize(t)}catch(s){console.error(`[Init] Error initializing module "${i.id}":`,s),Fe.error(`Module Init Error (${i.id}): ${s instanceof Error?s.message:String(s)}`)}return Be.emit(Ch.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function dZe(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),Fe.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Be.emit(Ch.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function fZe(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(ds.loadDbModsRequest,void 0),await new Promise(i=>{const s=t.on(ds.dbModsLoaded,()=>{s(),i()})});const n=rh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await aZe(n);rh.getState().setLoadedMods(r),Be.emit(Ch.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function hZe(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,i=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,s=e.getEffectiveProjectSettings(i);t.emit(Pn.initializePromptStateRequest,{effectiveSettings:s}),Be.emit(Ch.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function pZe(e,t){console.log("[Init] LiteChat Full Initialization START"),Sp.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(nn.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(ir.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(lr.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(Un.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(na.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(ds.loadDbModsRequest,void 0),setLoadedMods:rh.getState().setLoadedMods,getConversationById:Dn.getState().getConversationById,getEffectiveProjectSettings:bo.getState().getEffectiveProjectSettings,initializePromptState:mo.getState().initializePromptState,selectedItemId:Dn.getState().selectedItemId,selectedItemType:Dn.getState().selectedItemType};let r=[];try{await cZe(n,t),r=await uZe(e,t),dZe(r,t),await fZe(n,t),hZe(n,t),Be.emit(Ch.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(i){throw console.error("LiteChat: Full initialization sequence FAILED:",i),Fe.error(`Initialization sequence failed: ${i instanceof Error?i.message:String(i)}`),bw.getState().setGlobalError("Initialization sequence failed."),i}return r}const mZe=_l(Sl((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,i]=await Promise.all([Rt.loadRules(),Rt.loadTags(),Rt.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:i,isLoading:!1}),Be.emit(lr.dataLoaded,{rules:n,tags:r,links:i})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),Fe.error("Failed to load rules and tags."),Be.emit(lr.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=zs(),i=new Date,s={id:r,createdAt:i,updatedAt:i,...n};e(a=>{a.rules.push(s),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await Rt.saveRule(s),Fe.success(`Rule "${s.name}" added.`),Be.emit(lr.ruleSaved,{rule:s});const{rules:a,tags:o,tagRuleLinks:l}=t();return Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),Fe.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const i=t().rules.find(a=>a.id===n);if(!i)throw Fe.error("Rule not found for update."),new Error("Rule not found");const s={...i,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=s,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Rt.saveRule(s),Fe.success(`Rule "${s.name}" updated.`),Be.emit(lr.ruleSaved,{rule:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=i,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),Fe.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw Fe.error("Rule not found for deletion."),new Error("Rule not found");const i=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],s={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await Rt.deleteRule(n),Fe.success(`Rule "${r.name}" deleted.`),Be.emit(lr.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===s.id)||(o.rules.push(s),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),Fe.error("Failed to delete rule."),a}},addTag:async n=>{const r=zs(),i=new Date,s={id:r,createdAt:i,updatedAt:i,...n};e(a=>{a.tags.push(s),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await Rt.saveTag(s),Fe.success(`Tag "${s.name}" added.`),Be.emit(lr.tagSaved,{tag:s});const{rules:a,tags:o,tagRuleLinks:l}=t();return Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),Fe.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const i=t().tags.find(a=>a.id===n);if(!i)throw Fe.error("Tag not found for update."),new Error("Tag not found");const s={...i,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=s,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await Rt.saveTag(s),Fe.success(`Tag "${s.name}" updated.`),Be.emit(lr.tagSaved,{tag:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=i,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),Fe.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw Fe.error("Tag not found for deletion."),new Error("Tag not found");const i={...r},s=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await Rt.deleteTag(n),Fe.success(`Tag "${r.name}" deleted.`),Be.emit(lr.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===i.id)||(o.tags.push(i),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),Fe.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const i=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===i)){Fe.info("Link already exists.");return}const s={id:i,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(s)});try{await Rt.saveTagRuleLink(s),Fe.success("Tag linked to rule."),lr.linkSaved&&Be.emit(lr.linkSaved,{link:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==i),o.error="Failed to link tag to rule"}),Fe.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const i=`${n}-${r}`,s=t().tagRuleLinks.find(a=>a.id===i);s||Fe.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==i)});try{await Rt.deleteTagRuleLink(i),Fe.success("Tag unlinked from rule."),lr.linkDeleted&&Be.emit(lr.linkDeleted,{linkId:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Be.emit(lr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),s&&e(o=>{o.tagRuleLinks.some(l=>l.id===s.id)||o.tagRuleLinks.push(s),o.error="Failed to unlink tag from rule"}),Fe.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),i=new Set(r.tagRuleLinks.filter(s=>s.tagId===n).map(s=>s.ruleId));return r.rules.filter(s=>i.has(s.id))},getTagsForRule:n=>{const r=t(),i=new Set(r.tagRuleLinks.filter(s=>s.ruleId===n).map(s=>s.tagId));return r.tags.filter(s=>i.has(s.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(i=>r.has(i.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),i=s=>async a=>{await s(a)};return[{eventName:lr.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:lr.addRuleRequest,handler:i(r.addRule),storeId:n},{eventName:lr.updateRuleRequest,handler:s=>r.updateRule(s.id,s.updates),storeId:n},{eventName:lr.deleteRuleRequest,handler:s=>r.deleteRule(s.id),storeId:n},{eventName:lr.addTagRequest,handler:i(r.addTag),storeId:n},{eventName:lr.updateTagRequest,handler:s=>r.updateTag(s.id,s.updates),storeId:n},{eventName:lr.deleteTagRequest,handler:s=>r.deleteTag(s.id),storeId:n},{eventName:lr.linkTagToRuleRequest,handler:s=>r.linkTagToRule(s.tagId,s.ruleId),storeId:n},{eventName:lr.unlinkTagFromRuleRequest,handler:s=>r.unlinkTagFromRule(s.tagId,s.ruleId),storeId:n}]}}))),gZe=[dr,Er,mZe,Dn,bo,On,Of,mo,rh,bw,Bi,Ho];class jae{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];gZe.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const i=r.getRegisteredActionHandlers();Array.isArray(i)?t.push(...i):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(i){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",i)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Be.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}_e(jae,"isInitialized",!1);const yZe=()=>{const[e,t]=A.useState({}),n=Ho(r=>r.modalProviders);return A.useEffect(()=>{const r=s=>{t(a=>({...a,[s.modalId]:{...s,isOpen:!0}})),Be.emit(kr.modalStateChanged,{...s,isOpen:!0})},i=s=>{t(a=>{const o={...a};return o[s.modalId]&&(o[s.modalId].isOpen=!1),o}),Be.emit(kr.modalStateChanged,{modalId:s.modalId,isOpen:!1})};return Be.on(kr.openModalRequest,r),Be.on(kr.closeModalRequest,i),()=>{Be.off(kr.openModalRequest,r),Be.off(kr.closeModalRequest,i)}},[]),m.jsx(m.Fragment,{children:Object.entries(e).map(([r,i])=>{if(!i.isOpen)return null;const s=n[r];if(!s)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Be.emit(kr.closeModalRequest,{modalId:r}),modalProps:i.modalProps,targetId:i.targetId,initialTab:i.initialTab,initialSubTab:i.initialSubTab};return m.jsx(s,{...a},r)})})};let Pq=[],Dq=null,qu=!1;const bZe=({controls:e=[]})=>{const[t,n]=A.useState(!0),[r,i]=A.useState(!1),s=A.useRef(null),a=A.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=Dn(Cn(N=>({selectedItemId:N.selectedItemId,selectedItemType:N.selectedItemType,getConversationById:N.getConversationById}))),{getEffectiveProjectSettings:u}=bo(Cn(N=>({getEffectiveProjectSettings:N.getEffectiveProjectSettings}))),{interactions:d,status:h}=On(Cn(N=>({interactions:N.interactions,status:N.status}))),{globalError:p,isSidebarCollapsed:y,isChatControlPanelOpen:b}=bw(Cn(N=>({globalError:N.globalError,isSidebarCollapsed:N.isSidebarCollapsed,isChatControlPanelOpen:N.isChatControlPanelOpen}))),x=Ho(Cn(N=>Object.values(N.chatControls))),w=A.useMemo(()=>x.filter(N=>(N.panel??"main")==="sidebar"&&(N.show?N.show():!0)),[x]),_=A.useMemo(()=>x.filter(N=>N.panel==="sidebar-footer"&&(N.show?N.show():!0)),[x]),S=A.useMemo(()=>x.filter(N=>N.panel==="header"&&(N.show?N.show():!0)),[x]),C=A.useCallback(()=>{i(N=>!N)},[]);A.useEffect(()=>{r&&i(!1)},[o,l,r]),A.useEffect(()=>{a.current||(a.current=F4({id:"core-litechat-app",name:"LiteChat App Core"}));const N=a.current;jae.initialize(),Dq||(Dq=(async()=>{if(qu){n(!1);return}n(!0);try{Pq=await pZe(e,N),qu=!0}catch(B){console.error("[LiteChat] App: Top-level initialization error:",B),qu=!1}finally{n(!1)}})().then(()=>Pq))},[e]);const E=A.useRef({itemId:null,itemType:null,effectiveSettingsString:""});A.useEffect(()=>{if(t||!qu||!a.current)return;const N=a.current,O={itemId:o,itemType:l};let B=null;if(l==="project")B=o;else if(l==="conversation"&&o){const F=c(o);B=(F==null?void 0:F.projectId)??null}const P=u(B),H=JSON.stringify(P);(O.itemId!==E.current.itemId||O.itemType!==E.current.itemType||H!==E.current.effectiveSettingsString)&&(N.emit(Pn.initializePromptStateRequest,{effectiveSettings:P}),N.emit(kr.contextChanged,{selectedItemId:o,selectedItemType:l}),E.current={...O,effectiveSettingsString:H})},[o,l,c,u,t,qu]),A.useEffect(()=>{if(t||!qu||!a.current)return;const N=a.current,O=()=>{let Q=null;if(l==="project")Q=o;else if(l==="conversation"&&o){const K=c(o);Q=(K==null?void 0:K.projectId)??null}const q=u(Q);N.emit(Pn.initializePromptStateRequest,{effectiveSettings:q})},B=N.on(nn.loaded,O),P=N.on(na.updated,O),H=N.on(nn.globalSystemPromptChanged,O),F=N.on(nn.temperatureChanged,O);return()=>{B(),P(),H(),F()}},[o,l,c,u,t,qu]),A.useEffect(()=>{if(t||!qu||!a.current)return;const N=a.current;let O=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")O=o;else if(l==="conversation"){const H=c(o);O=(H==null?void 0:H.projectId)??"orphan"}else O="orphan";else if(l==="conversation"){const H=c(o);O=(H==null?void 0:H.projectId)??"orphan"}let P=null;typeof O=="string"?P=O:O===null?P=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof O}, Value:`,O,"Defaulting to 'orphan'."),P="orphan"),Bi.getState().vfsKey!==P&&N.emit(ln.setVfsKeyRequest,{key:P})},[o,l,c,t,qu,b]);const T=async N=>{const O=Dn.getState(),B=await O.addConversation(N);return console.log("New conversation ID:",B),await O.selectItem(B,"conversation"),console.log("conv selected:",B),B},R=A.useCallback(async N=>{var H;if(!a.current){Fe.error("Application core not ready. Please try again.");return}const O=Dn.getState();let B=O.selectedItemType==="conversation"?O.selectedItemId:null;const P=O.selectedItemType==="project"?O.selectedItemId:O.selectedItemType==="conversation"?((H=O.getConversationById(O.selectedItemId))==null?void 0:H.projectId)??null:null;if(!B)try{B=await T({title:"New Chat",projectId:P}),console.log("New conversation ID 2:",B)}catch(F){console.error("[LiteChat] App: Failed to create new conversation",F),Fe.error("Failed to start new chat.");return}try{const F=mo.getState(),Q={...N,metadata:{...N.metadata,modelId:F.modelId}};await Lv.submitPrompt(Q)}catch(F){console.error("[LiteChat] App: Error submitting prompt:",F),Fe.error("Failed to send message.")}},[]),M=l==="conversation"?o:null;return t?m.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:m.jsxs("div",{className:"flex flex-col items-center gap-4",children:[m.jsx(Hn,{className:"h-12 w-12 animate-spin text-primary"}),m.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):m.jsxs(m.Fragment,{children:[m.jsx(yZe,{}),m.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[m.jsxs("div",{className:dt("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[m.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[m.jsx("div",{className:dt(y?"hidden":"block"),children:m.jsx(bg,{controls:w,panelId:"sidebar",renderMode:"full",className:"h-full"})}),m.jsx("div",{className:dt(y?"block":"hidden"),children:m.jsx(bg,{controls:w,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),m.jsx("div",{className:dt("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:m.jsx(bg,{controls:_,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:dt("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&m.jsxs("div",{className:"md:hidden fixed inset-0 z-50 flex",children:[m.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm animate-fadeIn",onClick:C}),m.jsxs("div",{className:"relative w-4/5 max-w-xs bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft",children:[m.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[m.jsx("h2",{className:"font-semibold",children:"LiteChat Menu"}),m.jsx("button",{onClick:C,className:"p-1 rounded-md hover:bg-muted","aria-label":"Close menu",children:m.jsx(po,{className:"h-5 w-5"})})]}),m.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:m.jsx(bg,{controls:w,panelId:"sidebar",renderMode:"full",className:"h-full"})}),m.jsx("div",{className:"flex-shrink-0 border-t border-border p-4",children:m.jsx(bg,{controls:_,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"})})]})]}),m.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[m.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[m.jsx("button",{className:"md:hidden p-2 rounded-md hover:bg-muted",onClick:C,"aria-label":"Open menu",children:m.jsx(Ahe,{className:"h-5 w-5"})}),m.jsx(bg,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),m.jsx(eZe,{conversationId:M,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),p&&m.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",p]}),m.jsx(ive,{InputAreaRenderer:Mae,onSubmit:R,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:s,selectedItemId:o,selectedItemType:l})]})]}),m.jsx(sZe,{richColors:!0,position:"bottom-right",closeButton:!0})]})},vZe="prism-theme-link",xZe="prism-default-light-theme-link",wZe="prism-default-dark-theme-link",_Ze="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",SZe="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",GN=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},CZe=()=>{const{prismThemeUrl:e,theme:t}=dr(Cn(i=>({prismThemeUrl:i.prismThemeUrl,theme:i.theme}))),n=A.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=A.useMemo(()=>{const i=t==="system"?n:t;return i==="dark"||i==="TijuDark"?"dark":"light"},[t,n]);return A.useEffect(()=>{if(typeof window>"u")return;const i=GN(xZe),s=GN(wZe),a=GN(vZe);return i.disabled=!0,s.disabled=!0,a.disabled=!0,i.href=_Ze,s.href=SZe,e?(a.href=e,a.disabled=!1):(console.log(r),r==="dark"?s.disabled=!1:i.disabled=!1),()=>{}},[e,r]),null},KN=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),YN=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],kZe=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=dr(Cn(i=>({theme:i.theme,customFontFamily:i.customFontFamily,customFontSize:i.customFontSize,customThemeColors:i.customThemeColors})));return A.useEffect(()=>{const i=document.body,s=document.documentElement;i.classList.remove("light","dark","TijuLight","TijuDark","custom"),YN.forEach(a=>{s.style.removeProperty(`--${KN(a)}`)}),s.style.removeProperty("--custom-font-family"),s.style.removeProperty("--custom-font-size"),e==="light"?i.classList.add("light"):e==="dark"?i.classList.add("dark"):e==="TijuLight"?i.classList.add("TijuLight"):e==="TijuDark"?i.classList.add("TijuDark"):e==="custom"?(i.classList.add("custom"),t?s.style.setProperty("--custom-font-family",t):s.style.removeProperty("--custom-font-family"),n?s.style.setProperty("--custom-font-size",`${n}px`):s.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&YN.includes(a)){const l=`--${KN(a)}`;s.style.setProperty(l,o)}else if(YN.includes(a)){const l=`--${KN(a)}`;s.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?i.classList.add("dark"):i.classList.add("light")},[e,t,n,r]),null},EZe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return m.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[m.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:m.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),m.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[m.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),m.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),m.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[m.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),m.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),m.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:m.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},Fq="0.1.0-dev",Lq="https://github.com/DimitriGilbert/LiteChat",Bq=({textToCopy:e,label:t,className:n})=>{const[r,i]=A.useState(!1),s=async()=>{try{await navigator.clipboard.writeText(e),i(!0),Fe.success(`${t} copied to clipboard!`),setTimeout(()=>i(!1),2e3)}catch(a){Fe.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return m.jsxs(Et,{variant:"outline",onClick:s,className:n,children:[r?m.jsx(za,{className:"mr-2 h-4 w-4 text-green-500"}):m.jsx(Ofe,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class TZe extends A.Component{constructor(){super(...arguments);_e(this,"state",{hasError:!1,error:null,errorInfo:null});_e(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),Fe.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${Lq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){Fe.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const i=`${Lq}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(i,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var s;const{error:n,errorInfo:r}=this.state;let i="Crash Report: ";if(r!=null&&r.componentStack){const a=(s=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:s.split(" ")[0];a&&(i+=`Error in <${a}> - `)}return i+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(i+="..."),i}generateErrorReport(n=!1){const{error:r,errorInfo:i}=this.state,s=`
`,a=n?"```":"";let o=`## LiteChat Error Report${s}${s}`;return o+=`**Version:** ${Fq}${s}`,o+=`**Timestamp:** ${new Date().toISOString()}${s}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${s}${s}`,r?o+=`**Error Message:**${s}${a}${s}${r.message}${s}${a}${s}${s}`:o+=`**Error Message:** Unknown Error${s}${s}`,i!=null&&i.componentStack&&(o+=`**Component Stack:**${s}${a}text${s}${i.componentStack.trim()}${s}${a}${s}${s}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${s}${a}text${s}${r.stack.trim()}${s}${a}${s}${s}`),o+=`**Steps to Reproduce (Please Describe):**${s}1. ...${s}2. ...${s}${s}`,o+=`**Expected Behavior:**${s}...${s}${s}`,o+=`**Actual Behavior:**${s}...${s}`,o}generateAIPrompt(){var s,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${Fq}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((s=r==null?void 0:r.componentStack)==null?void 0:s.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:m.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:m.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[m.jsx(EZe,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),m.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),m.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),m.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),m.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[m.jsx(Et,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),m.jsx(Bq,{textToCopy:this.generateErrorReport(),label:"Details"}),m.jsx(Bq,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),m.jsxs(Et,{variant:"outline",onClick:this.handleReportOnGitHub,children:[m.jsx($V,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const Oae=(e,t)=>{if(!t)return null;let n=rc,r="text-muted-foreground/70",i=`Linked to ${t}`;switch(e){case"syncing":n=Hn,r="animate-spin text-blue-500",i=`Syncing with ${t}...`;break;case"error":n=nc,r="text-destructive",i=`Sync error with ${t}`;break;case"needs-sync":n=iO,r="text-orange-500",i=`Needs sync with ${t}`;break;case"idle":n=Dk,r="text-green-500",i=`Synced with ${t}`;break;default:n=rc,r="text-muted-foreground/70",i=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(n,{className:dt("h-3 w-3 ml-1 flex-shrink-0",r)})}),m.jsx(yr,{side:"right",children:i})]})})},Pae=A.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:i,onSelectItem:s,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:p,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:x,isSavingEdit:w,originalNameToCompare:_})=>{const S=e.id===n,C=e.itemType==="project",E=e.id===h&&e.itemType===p,[T,R]=A.useState(C?e.name:e.title),M=A.useRef(null);A.useEffect(()=>{if(E){const de=C?e.name:e.title;R(de),requestAnimationFrame(()=>{var Ne,Pe;(Ne=M.current)==null||Ne.focus(),(Pe=M.current)==null||Pe.select()})}},[E,e,C]),A.useEffect(()=>{if(!E){const de=C?e.name:e.title;T!==de&&R(de)}},[C?e.name:e.title,E,T,C]);const N=C&&u.has(e.id),O=C,B=!C&&e.syncRepoId?r[e.id]:void 0,P=!C&&e.syncRepoId?i.get(e.syncRepoId):void 0,H=!C&&P?Oae(B,P):null,F=de=>{de.stopPropagation(),Be.emit(kr.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},Q=()=>{E||(C&&d(e.id),s(e.id,e.itemType))},q=de=>{de.stopPropagation(),C?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,de):a(e.id,de)},K=de=>{de.stopPropagation(),y(e)},U=()=>{R(_),x(e.itemType==="project"&&_==="New Project")},re=async()=>{if(w)return;const de=T.trim();await b(e.id,e.itemType,de)},G=()=>{var Pe;if(w)return;const de=T.trim(),Ne=e.itemType==="project"&&_==="New Project";if(!de){_!=="New Project"?(Fe.error("Name cannot be empty."),R(_),(Pe=M.current)==null||Pe.focus()):U();return}de!==_||Ne?re():U()},ne=de=>{de.key==="Enter"?(de.preventDefault(),re()):de.key==="Escape"&&(de.preventDefault(),U())},te=C?e.name:e.title,se=w?Hn:za,pe=w?"h-3 w-3 animate-spin":"h-3 w-3";return m.jsxs("li",{className:dt("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!E&&"hover:bg-muted/50 hover:text-primary/80",S&&!E?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",E&&"bg-muted ring-1 ring-primary",!E&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:Q,title:E?"":te,children:[m.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[O&&m.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:de=>{de.stopPropagation(),d(e.id)},children:N?m.jsx(cu,{className:"h-3 w-3 text-muted-foreground"}):m.jsx(LV,{className:"h-3 w-3 text-muted-foreground"})}),!O&&m.jsx("span",{className:"w-3 flex-shrink-0"}),C?m.jsx(jf,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):m.jsx(f3,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),E?m.jsx(ur,{ref:M,value:T,onChange:de=>R(de.target.value),onKeyDown:ne,onBlur:G,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:de=>de.stopPropagation(),disabled:w}):m.jsx("span",{className:"truncate min-w-0 flex-1",children:te}),H]}),m.jsx("div",{className:dt("items-center flex-shrink-0 ml-1",E?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:de=>de.stopPropagation(),children:E?m.jsxs(m.Fragment,{children:[m.jsx(Rn,{tooltipText:"Save (Enter)",onClick:de=>{de.stopPropagation(),re()},disabled:w||!T.trim(),"aria-label":"Save changes",icon:m.jsx(se,{}),iconClassName:pe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),m.jsx(Rn,{tooltipText:"Cancel (Esc)",onClick:de=>{de.stopPropagation(),U()},disabled:w,"aria-label":"Cancel edit",icon:m.jsx(po,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):m.jsxs(m.Fragment,{children:[C&&m.jsx(Rn,{tooltipText:"Project Settings",onClick:F,"aria-label":`Settings for ${te}`,icon:m.jsx(Ife,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),m.jsx(Rn,{tooltipText:"Edit",onClick:K,"aria-label":`Edit ${te}`,icon:m.jsx(Tw,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),C?m.jsx(Rn,{tooltipText:"Export Project (JSON)",onClick:de=>c(e.id,de),"aria-label":`Export project ${te}`,icon:m.jsx(Hfe,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):m.jsxs("div",{className:"relative group/export",children:[m.jsx(Rn,{tooltipText:"Export Conversation","aria-label":`Export ${te}`,icon:m.jsx(Gc,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),m.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:de=>de.stopPropagation(),children:[m.jsx(Et,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:de=>l(e.id,"json",de),children:"JSON"}),m.jsx(Et,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:de=>l(e.id,"md",de),children:"MD"})]})]}),m.jsx(Rn,{tooltipText:"Delete",onClick:q,"aria-label":`Delete ${te}`,icon:m.jsx(Fo,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});Pae.displayName="ConversationItemRenderer";function AZe({updateProject:e,updateConversation:t,deleteProject:n}){const[r,i]=A.useState(null),[s,a]=A.useState(null),[o,l]=A.useState(""),[c,u]=A.useState(!1),d=A.useCallback(y=>{i(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=A.useCallback(y=>{const b=r,x=y??(s==="project"&&o==="New Project");i(null),a(null),l(""),u(!1),x&&b&&n(b).catch(w=>{console.error("Failed to delete new project on cancel:",w),Fe.error("Failed to clean up cancelled new project.")})},[r,s,o,n]),p=A.useCallback(async(y,b,x)=>{if(y!==r||b!==s||c)return;const w=x==null?void 0:x.trim();if(!w){Fe.error("Name cannot be empty.");return}if(w===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:w}):await t(y,{title:w}),Fe.success("Item renamed successfully."),i(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),Fe.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,s,c,e,t,h,o]);return{editingItemId:r,editingItemType:s,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:p,handleCancelEdit:h,originalNameToCompare:o}}const Dae=(e,t,n,r,i,s,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=s.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],p=a.get(e)||[];for(const y of p)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(Dae(y.id,"project",n,r,i,s,a,o,l)){u=!0;break}}}}return l[c]=u,u},RZe=({module:e})=>{const t=A.useRef(null),n=A.useRef(null),[r,i]=A.useState(!1),[,s]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>s({})),e.isLoading&&!Dn.getState().isLoading&&!bo.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),A.useEffect(()=>{const be=t.current;if(be){const Re=be.querySelector("[data-radix-scroll-area-viewport]");if(Re&&n.current!==Re?(n.current=Re,r||i(!0),s({})):!Re&&n.current&&(n.current=null,i(!1)),!n.current){const ce=new MutationObserver(()=>{const le=be.querySelector("[data-radix-scroll-area-viewport]");le&&n.current!==le&&(n.current=le,i(!0),s({}),ce.disconnect())});return ce.observe(be,{childList:!0,subtree:!0}),()=>ce.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:p,deleteConversation:y,exportConversation:b,exportProject:x,getConversationById:w}=Dn(Cn(be=>({selectedItemId:be.selectedItemId,selectedItemType:be.selectedItemType,conversations:be.conversations,syncRepos:be.syncRepos,conversationSyncStatus:be.conversationSyncStatus,selectItem:be.selectItem,addConversation:be.addConversation,updateConversation:be.updateConversation,deleteConversation:be.deleteConversation,exportConversation:be.exportConversation,exportProject:be.exportProject,getConversationById:be.getConversationById}))),{projects:_,addProject:S,updateProject:C,deleteProject:E,getProjectById:T}=bo(Cn(be=>({projects:be.projects,addProject:be.addProject,updateProject:be.updateProject,deleteProject:be.deleteProject,getProjectById:be.getProjectById}))),R=e.isLoading,[M,N]=ut.useState(new Set),[O,B]=A.useState(""),P=AZe({updateProject:C,updateConversation:p,deleteProject:E}),{editingItemId:H,editingItemType:F,isSavingEdit:Q,handleStartEditing:q,handleSaveEdit:K,handleCancelEdit:U,originalNameToCompare:re}=P,G=A.useCallback(be=>{N(Re=>{const ce=new Set(Re);return ce.has(be)?ce.delete(be):ce.add(be),ce})},[]),ne=A.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const be=w(a);return(be==null?void 0:be.projectId)??null}return null},[a,o,w]),te=A.useCallback(async()=>{if(!H)try{const be=ne(),Re=await h({title:"New Chat",projectId:be});d(Re,"conversation")}catch(be){console.error("Failed to create new chat:",be),Fe.error("Failed to create new chat.")}},[H,ne,h,d]),se=A.useCallback(async()=>{if(!H)try{const be=ne(),Re=await S({name:"New Project",parentId:be});d(Re,"project"),be&&N(ce=>new Set(ce).add(be)),setTimeout(()=>{const ce=T(Re);ce&&q({...ce,itemType:"project"})},50)}catch(be){console.error("Failed to create new project:",be)}},[H,ne,S,d,T,q]),pe=A.useCallback((be,Re)=>{be===H&&Re===F||(H&&(be!==H||Re!==F)&&U(),(be!==a||Re!==o)&&d(be,Re))},[H,F,a,o,U,d]),de=A.useCallback((be,Re)=>{Re.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(be).catch(ce=>{console.error("Failed to delete conversation:",ce),Fe.error("Failed to delete conversation.")})},[y]),Ne=A.useCallback((be,Re)=>{Re.stopPropagation(),E(be).catch(ce=>{console.error("Failed to delete project:",ce),Fe.error("Failed to delete project.")})},[E]),Pe=A.useCallback(async(be,Re,ce)=>{ce.stopPropagation();try{await b(be,Re)}catch(le){console.error(`Failed to export conversation as ${Re}:`,le)}},[b]),Me=A.useCallback(async(be,Re)=>{Re.stopPropagation();try{await x(be)}catch(ce){console.error("Failed to export project:",ce)}},[x]),Ee=A.useMemo(()=>new Map((c||[]).map(be=>[be.id,be.name])),[c]),{projectsById:Ue,conversationsByProjectId:nt,projectsByParentId:He}=A.useMemo(()=>{const be=new Map(_.map(le=>[le.id,le])),Re=new Map;l.forEach(le=>{const ae=le.projectId??null;Re.has(ae)||Re.set(ae,[]),Re.get(ae).push(le)});const ce=new Map;return _.forEach(le=>{const ae=le.parentId??null;ce.has(ae)||ce.set(ae,[]),ce.get(ae).push(le)}),{projectsById:be,conversationsByProjectId:Re,projectsByParentId:ce}},[_,l]),je=A.useMemo(()=>{const be=[],Re=O.toLowerCase(),ce={};function le(ae,Te){const $e=(He.get(ae)||[]).filter(At=>Dae(At.id,"project",Re,_,l,Ue,nt,He,ce)),ke=(nt.get(ae)||[]).filter(At=>At.title.toLowerCase().includes(Re)),ot=[...$e,...ke];ot.sort((At,ft)=>new Date(ft.updatedAt).getTime()-new Date(At.updatedAt).getTime()),ot.forEach(At=>{"path"in At?(be.push({id:`project-${At.id}`,originalId:At.id,type:"project",level:Te,data:At,updatedAt:At.updatedAt}),M.has(At.id)&&le(At.id,Te+1)):be.push({id:`conversation-${At.id}`,originalId:At.id,type:"conversation",level:Te,data:At,updatedAt:At.updatedAt})})}return le(null,0),be},[_,l,O,M,Ue,nt,He]),Y=j6({count:je.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return m.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),m.jsx(Xu,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:m.jsx(Et,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:m.jsx(dhe,{className:"h-4 w-4"})})}),m.jsx(Xu,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:m.jsx(Et,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:m.jsx(Gc,{className:"h-4 w-4"})})})]}),m.jsxs("div",{className:"flex items-center",children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{size:"sm",variant:"ghost",onClick:se,"aria-label":"New Project",disabled:R||!!H,className:"h-7 w-7 p-0",children:m.jsx(qV,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"bottom",children:"New Project"})]})}),m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{size:"sm",variant:"ghost",onClick:te,"aria-label":"New Chat",disabled:R||!!H,className:"h-7 w-7 p-0",children:m.jsx(W0,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"bottom",children:"New Chat"})]})})]})]}),m.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[m.jsx(va,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter...",value:O,onChange:be=>B(be.target.value),className:"h-8 text-xs pl-8",disabled:R})]}),m.jsxs(Sa,{className:"flex-grow",ref:t,children:[R&&je.length===0?m.jsxs("div",{className:"space-y-1 p-1",children:[m.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),m.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),m.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!R&&je.length===0?m.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:O.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&m.jsx("div",{style:{height:`${Y.getTotalSize()}px`,width:"100%",position:"relative"},children:Y.getVirtualItems().map(be=>{const Re=je[be.index];if(!Re)return null;const ce={...Re.data,itemType:Re.type};return m.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${be.size}px`,transform:`translateY(${be.start}px)`},className:"px-1",children:m.jsx(Pae,{item:ce,level:Re.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ee,onSelectItem:()=>pe(Re.originalId,Re.type),onDeleteConversation:de,onDeleteProject:Ne,onExportConversation:Pe,onExportProject:Me,expandedProjects:M,toggleProjectExpansion:G,editingItemId:H,editingItemType:F,handleStartEditing:q,handleSaveEdit:K,handleCancelEdit:U,isSavingEdit:Q,originalNameToCompare:re})},Re.id)})}),!r&&!R&&m.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},IZe=({module:e})=>{const{selectedItemType:t}=Dn(Cn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?m.jsx(Hn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?m.jsx(jf,{className:"h-5 w-5 text-primary"}):t==="conversation"?m.jsx(vL,{className:"h-5 w-5 text-primary"}):m.jsx(vL,{className:"h-5 w-5 text-muted-foreground"})};class MZe{constructor(){_e(this,"id","core-conversation-list");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"isLoading",!0);_e(this,"conversationsLoading",!0);_e(this,"projectsLoading",!0);_e(this,"notifyComponentUpdate",null);_e(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=Dn.getState().isLoading,this.projectsLoading=bo.getState().isLoading,this.updateCombinedLoadingState(),t.emit(Un.loadConversationsRequest,void 0),t.emit(na.loadProjectsRequest,void 0);const n=t.on(Un.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(na.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),i=t.on(Un.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),s=t.on(na.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,i,s)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>ut.createElement(RZe,{module:this}),iconRenderer:()=>ut.createElement(IZe,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const $q=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:m.jsx(h3,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:"Settings"})]})})};var MT="Dialog",[Fae,eat]=Ca(MT),[NZe,mc]=Fae(MT),Lae=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:a=!0}=e,o=A.useRef(null),l=A.useRef(null),[c,u]=oc({prop:r,defaultProp:i??!1,onChange:s,caller:MT});return m.jsx(NZe,{scope:t,triggerRef:o,contentRef:l,contentId:Bs(),titleId:Bs(),descriptionId:Bs(),open:c,onOpenChange:u,onOpenToggle:A.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};Lae.displayName=MT;var Bae="DialogTrigger",jZe=A.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=mc(Bae,n),s=tr(t,i.triggerRef);return m.jsx(pn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":F6(i.open),...r,ref:s,onClick:Kt(e.onClick,i.onOpenToggle)})});jZe.displayName=Bae;var P6="DialogPortal",[OZe,$ae]=Fae(P6,{forceMount:void 0}),zae=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:i}=e,s=mc(P6,t);return m.jsx(OZe,{scope:t,forceMount:n,children:A.Children.map(r,a=>m.jsx(Hs,{present:n||s.open,children:m.jsx(ey,{asChild:!0,container:i,children:a})}))})};zae.displayName=P6;var Ak="DialogOverlay",Uae=A.forwardRef((e,t)=>{const n=$ae(Ak,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,s=mc(Ak,e.__scopeDialog);return s.modal?m.jsx(Hs,{present:r||s.open,children:m.jsx(DZe,{...i,ref:t})}):null});Uae.displayName=Ak;var PZe=Nf("DialogOverlay.RemoveScroll"),DZe=A.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=mc(Ak,n);return m.jsx(C1,{as:PZe,allowPinchZoom:!0,shards:[i.contentRef],children:m.jsx(pn.div,{"data-state":F6(i.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Wp="DialogContent",qae=A.forwardRef((e,t)=>{const n=$ae(Wp,e.__scopeDialog),{forceMount:r=n.forceMount,...i}=e,s=mc(Wp,e.__scopeDialog);return m.jsx(Hs,{present:r||s.open,children:s.modal?m.jsx(FZe,{...i,ref:t}):m.jsx(LZe,{...i,ref:t})})});qae.displayName=Wp;var FZe=A.forwardRef((e,t)=>{const n=mc(Wp,e.__scopeDialog),r=A.useRef(null),i=tr(t,n.contentRef,r);return A.useEffect(()=>{const s=r.current;if(s)return CT(s)},[]),m.jsx(Vae,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Kt(e.onCloseAutoFocus,s=>{var a;s.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Kt(e.onPointerDownOutside,s=>{const a=s.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&s.preventDefault()}),onFocusOutside:Kt(e.onFocusOutside,s=>s.preventDefault())})}),LZe=A.forwardRef((e,t)=>{const n=mc(Wp,e.__scopeDialog),r=A.useRef(!1),i=A.useRef(!1);return m.jsx(Vae,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,s),s.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),Vae=A.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=e,o=mc(Wp,n),l=A.useRef(null),c=tr(t,l);return _T(),m.jsxs(m.Fragment,{children:[m.jsx(S1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:m.jsx(X0,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":F6(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),m.jsxs(m.Fragment,{children:[m.jsx(BZe,{titleId:o.titleId}),m.jsx(zZe,{contentRef:l,descriptionId:o.descriptionId})]})]})}),D6="DialogTitle",Hae=A.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=mc(D6,n);return m.jsx(pn.h2,{id:i.titleId,...r,ref:t})});Hae.displayName=D6;var Wae="DialogDescription",Gae=A.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=mc(Wae,n);return m.jsx(pn.p,{id:i.descriptionId,...r,ref:t})});Gae.displayName=Wae;var Kae="DialogClose",Yae=A.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,i=mc(Kae,n);return m.jsx(pn.button,{type:"button",...r,ref:t,onClick:Kt(e.onClick,()=>i.onOpenChange(!1))})});Yae.displayName=Kae;function F6(e){return e?"open":"closed"}var Zae="DialogTitleWarning",[tat,Xae]=sve(Zae,{contentName:Wp,titleName:D6,docsSlug:"dialog"}),BZe=({titleId:e})=>{const t=Xae(Zae),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return A.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},$Ze="DialogDescriptionWarning",zZe=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Xae($Ze).contentName}}.`;return A.useEffect(()=>{var s;const i=(s=e.current)==null?void 0:s.getAttribute("aria-describedby");t&&i&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Jae=Lae,Qae=zae,eoe=Uae,toe=qae,UZe=Hae,qZe=Gae,noe=Yae;function Ty({...e}){return m.jsx(Jae,{"data-slot":"dialog",...e})}function VZe({...e}){return m.jsx(Qae,{"data-slot":"dialog-portal",...e})}function HZe({...e}){return m.jsx(noe,{"data-slot":"dialog-close",...e})}function WZe({className:e,...t}){return m.jsx(eoe,{"data-slot":"dialog-overlay",className:dt("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function Ay({className:e,children:t,...n}){return m.jsxs(VZe,{"data-slot":"dialog-portal",children:[m.jsx(WZe,{}),m.jsxs(toe,{"data-slot":"dialog-content",className:dt("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,m.jsxs(noe,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[m.jsx(po,{}),m.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function Ry({className:e,...t}){return m.jsx("div",{"data-slot":"dialog-header",className:dt("flex flex-col gap-2 text-center sm:text-left",e),...t})}function Iy({className:e,...t}){return m.jsx("div",{"data-slot":"dialog-footer",className:dt("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function My({className:e,...t}){return m.jsx(UZe,{"data-slot":"dialog-title",className:dt("text-lg leading-none font-semibold",e),...t})}function I1({className:e,...t}){return m.jsx(qZe,{"data-slot":"dialog-description",className:dt("text-muted-foreground text-sm",e),...t})}var ZN="rovingFocusGroup.onEntryFocus",GZe={bubbles:!1,cancelable:!0},M1="RovingFocusGroup",[L4,roe,KZe]=wT(M1),[YZe,NT]=Ca(M1,[KZe]),[ZZe,XZe]=YZe(M1),ioe=A.forwardRef((e,t)=>m.jsx(L4.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(L4.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(JZe,{...e,ref:t})})}));ioe.displayName=M1;var JZe=A.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=A.useRef(null),p=tr(t,h),y=_y(s),[b,x]=oc({prop:a,defaultProp:o??null,onChange:l,caller:M1}),[w,_]=A.useState(!1),S=Fs(c),C=roe(n),E=A.useRef(!1),[T,R]=A.useState(0);return A.useEffect(()=>{const M=h.current;if(M)return M.addEventListener(ZN,S),()=>M.removeEventListener(ZN,S)},[S]),m.jsx(ZZe,{scope:n,orientation:r,dir:y,loop:i,currentTabStopId:b,onItemFocus:A.useCallback(M=>x(M),[x]),onItemShiftTab:A.useCallback(()=>_(!0),[]),onFocusableItemAdd:A.useCallback(()=>R(M=>M+1),[]),onFocusableItemRemove:A.useCallback(()=>R(M=>M-1),[]),children:m.jsx(pn.div,{tabIndex:w||T===0?-1:0,"data-orientation":r,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:Kt(e.onMouseDown,()=>{E.current=!0}),onFocus:Kt(e.onFocus,M=>{const N=!E.current;if(M.target===M.currentTarget&&N&&!w){const O=new CustomEvent(ZN,GZe);if(M.currentTarget.dispatchEvent(O),!O.defaultPrevented){const B=C().filter(q=>q.focusable),P=B.find(q=>q.active),H=B.find(q=>q.id===b),Q=[P,H,...B].filter(Boolean).map(q=>q.ref.current);ooe(Q,u)}}E.current=!1}),onBlur:Kt(e.onBlur,()=>_(!1))})})}),soe="RovingFocusGroupItem",aoe=A.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:s,children:a,...o}=e,l=Bs(),c=s||l,u=XZe(soe,n),d=u.currentTabStopId===c,h=roe(n),{onFocusableItemAdd:p,onFocusableItemRemove:y,currentTabStopId:b}=u;return A.useEffect(()=>{if(r)return p(),()=>y()},[r,p,y]),m.jsx(L4.ItemSlot,{scope:n,id:c,focusable:r,active:i,children:m.jsx(pn.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Kt(e.onMouseDown,x=>{r?u.onItemFocus(c):x.preventDefault()}),onFocus:Kt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Kt(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const w=tXe(x,u.orientation,u.dir);if(w!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let S=h().filter(C=>C.focusable).map(C=>C.ref.current);if(w==="last")S.reverse();else if(w==="prev"||w==="next"){w==="prev"&&S.reverse();const C=S.indexOf(x.currentTarget);S=u.loop?nXe(S,C+1):S.slice(C+1)}setTimeout(()=>ooe(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});aoe.displayName=soe;var QZe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function eXe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function tXe(e,t,n){const r=eXe(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return QZe[r]}function ooe(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function nXe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var loe=ioe,coe=aoe,jT="Tabs",[rXe,nat]=Ca(jT,[NT]),uoe=NT(),[iXe,L6]=rXe(jT),doe=A.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=_y(o),[d,h]=oc({prop:r,onChange:i,defaultProp:s??"",caller:jT});return m.jsx(iXe,{scope:n,baseId:Bs(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:m.jsx(pn.div,{dir:u,"data-orientation":a,...c,ref:t})})});doe.displayName=jT;var foe="TabsList",hoe=A.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...i}=e,s=L6(foe,n),a=uoe(n);return m.jsx(loe,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:r,children:m.jsx(pn.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:t})})});hoe.displayName=foe;var poe="TabsTrigger",moe=A.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...s}=e,a=L6(poe,n),o=uoe(n),l=boe(a.baseId,r),c=voe(a.baseId,r),u=r===a.value;return m.jsx(coe,{asChild:!0,...o,focusable:!i,active:u,children:m.jsx(pn.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l,...s,ref:t,onMouseDown:Kt(e.onMouseDown,d=>{!i&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Kt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Kt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!i&&d&&a.onValueChange(r)})})})});moe.displayName=poe;var goe="TabsContent",yoe=A.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:i,children:s,...a}=e,o=L6(goe,n),l=boe(o.baseId,r),c=voe(o.baseId,r),u=r===o.value,d=A.useRef(u);return A.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),m.jsx(Hs,{present:i||u,children:({present:h})=>m.jsx(pn.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});yoe.displayName=goe;function boe(e,t){return`${e}-trigger-${t}`}function voe(e,t){return`${e}-content-${t}`}var sXe=doe,aXe=hoe,oXe=moe,lXe=yoe;function cXe({className:e,...t}){return m.jsx(sXe,{"data-slot":"tabs",className:dt("flex flex-col gap-2",e),...t})}function uXe({className:e,...t}){return m.jsx(aXe,{"data-slot":"tabs-list",className:dt("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function dXe({className:e,...t}){return m.jsx(oXe,{"data-slot":"tabs-trigger",className:dt("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function fXe({className:e,...t}){return m.jsx(lXe,{"data-slot":"tabs-content",className:dt("flex-1 outline-none",e),...t})}const Md=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:i,listClassName:s,contentContainerClassName:a,scrollable:o})=>{var p;const[l,c]=A.useState(n??t??((p=e[0])==null?void 0:p.value));A.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{console.log("handleValueChange",y),c(y),r&&r(y)},d=dt("px-3 py-1.5 text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const b=dt("flex-grow overflow-y-auto pb-6 pr-2 -mr-2",a);return o?m.jsx(Sa,{className:b,children:y}):m.jsx("div",{className:b,children:y})};return m.jsxs(cXe,{value:l,onValueChange:u,defaultValue:t,className:dt("flex flex-col h-full",i),children:[m.jsx(uXe,{className:dt("flex-shrink-0 sticky top-0 bg-background z-10 mb-4 flex-wrap h-auto justify-start border-b gap-1 p-1 -mx-6 px-6",s),children:e.map(y=>m.jsx(dXe,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),m.jsx(h,{children:e.map(y=>m.jsx(fXe,{value:y.value,className:"data-[state=inactive]:hidden h-full",children:y.content},y.value))})]})},xoe=A.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=rh(Cn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),i=A.useMemo(()=>[...r.map(h=>{const p=h.component;return{value:h.id,label:h.title,content:m.jsx(p,{}),order:h.order??999}})].sort((h,p)=>(h.order??999)-(p.order??999)),[r]),s=A.useCallback(()=>i.length>0?i[0].value:"general",[i]),[a,o]=A.useState(s());A.useEffect(()=>{if(e){let u=s();n&&i.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),Fe.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,i,s]);const l=u=>{u||t()},c=u=>{o(u)};return m.jsx(Ty,{open:e,onOpenChange:l,children:m.jsxs(Ay,{className:dt("w-[95vw] h-[90vh] flex flex-col p-0","sm:w-[90vw] sm:h-[85vh]","md:w-[85vw] md:max-w-[1200px] md:h-[80vh]","lg:w-[75vw]","min-h-[500px] max-h-[95vh]"),children:[m.jsxs(Ry,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[m.jsx(My,{children:"Settings"}),m.jsx(I1,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),i.length>0?m.jsx(Md,{tabs:i,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6",scrollable:!1},a):m.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),m.jsx(Iy,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:m.jsx(Et,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});xoe.displayName="SettingsModalComponent";const hXe=xoe;class pXe{constructor(){_e(this,"id","core-settings-trigger");_e(this,"modalId","settingsModal");_e(this,"unregisterChatControlCallback",null);_e(this,"unregisterModalProviderCallback",null);_e(this,"modApiRef",null);_e(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(kr.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});_e(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(kr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>ut.createElement($q,{module:this}),iconRenderer:()=>ut.createElement($q,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>ut.createElement(hXe,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const mXe=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?m.jsx($he,{className:"h-4 w-4"}):m.jsx(Lhe,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class gXe{constructor(){_e(this,"id","core-sidebar-toggle");_e(this,"unregisterCallback",null);_e(this,"notifyComponentUpdate",null);_e(this,"modApiRef",null);_e(this,"getIsSidebarCollapsed",()=>bw.getState().isSidebarCollapsed);_e(this,"toggleSidebar",t=>{var i,s;const n=bw.getState().isSidebarCollapsed,r=t??!n;n!==r&&((i=this.modApiRef)==null||i.emit(kr.toggleSidebarRequest,{isCollapsed:r}),(s=this.notifyComponentUpdate)==null||s.call(this))});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>ut.createElement(mXe,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function q0({form:e,name:t,label:n,placeholder:r,disabled:i,wrapperClassName:s,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return m.jsx(e.Field,{name:t,children:p=>{const y=w=>{const _=w.target.value;if(_===""&&a)p.handleChange(null);else{const S=parseFloat(_);isNaN(S)?_===""&&!a&&p.handleChange(_):p.handleChange(S)}},b=typeof p.state.value=="number"?p.state.value.toString():(p.state.value===null&&a,""),x=w=>{p.handleBlur(),d&&d(w)};return m.jsxs("div",{className:dt("space-y-1.5",s),children:[" ",m.jsx(Jt,{htmlFor:p.name,className:"text-sm",children:n}),m.jsx(ur,{id:p.name,name:p.name,type:"number",value:b,onBlur:x,onChange:y,placeholder:r,disabled:i??p.form.state.isSubmitting,min:o,max:l,step:c,className:dt(u,p.state.meta.errors.length?"border-destructive":""),...h}),m.jsx(ps,{field:p})]})}})}var woe=["PageUp","PageDown"],_oe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Soe={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Ny="Slider",[B4,yXe,bXe]=wT(Ny),[Coe,rat]=Ca(Ny,[bXe]),[vXe,OT]=Coe(Ny),koe=A.forwardRef((e,t)=>{const{name:n,min:r=0,max:i=100,step:s=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:p=!1,form:y,...b}=e,x=A.useRef(new Set),w=A.useRef(0),S=a==="horizontal"?xXe:wXe,[C=[],E]=oc({prop:u,defaultProp:c,onChange:B=>{var H;(H=[...x.current][w.current])==null||H.focus(),d(B)}}),T=A.useRef(C);function R(B){const P=EXe(C,B);O(B,P)}function M(B){O(B,w.current)}function N(){const B=T.current[w.current];C[w.current]!==B&&h(C)}function O(B,P,{commit:H}={commit:!1}){const F=IXe(s),Q=MXe(Math.round((B-r)/s)*s+r,F),q=ow(Q,[r,i]);E((K=[])=>{const U=CXe(K,q,P);if(RXe(U,l*s)){w.current=U.indexOf(q);const re=String(U)!==String(K);return re&&H&&h(U),re?U:K}else return K})}return m.jsx(vXe,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:i,valueIndexToChangeRef:w,thumbs:x.current,values:C,orientation:a,form:y,children:m.jsx(B4.Provider,{scope:e.__scopeSlider,children:m.jsx(B4.Slot,{scope:e.__scopeSlider,children:m.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Kt(b.onPointerDown,()=>{o||(T.current=C)}),min:r,max:i,inverted:p,onSlideStart:o?void 0:R,onSlideMove:o?void 0:M,onSlideEnd:o?void 0:N,onHomeKeyDown:()=>!o&&O(r,0,{commit:!0}),onEndKeyDown:()=>!o&&O(i,C.length-1,{commit:!0}),onStepKeyDown:({event:B,direction:P})=>{if(!o){const Q=woe.includes(B.key)||B.shiftKey&&_oe.includes(B.key)?10:1,q=w.current,K=C[q],U=s*Q*P;O(K+U,q,{commit:!0})}}})})})})});koe.displayName=Ny;var[Eoe,Toe]=Coe(Ny,{startEdge:"left",endEdge:"right",size:"width",direction:1}),xXe=A.forwardRef((e,t)=>{const{min:n,max:r,dir:i,inverted:s,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=A.useState(null),p=tr(t,S=>h(S)),y=A.useRef(void 0),b=_y(i),x=b==="ltr",w=x&&!s||!x&&s;function _(S){const C=y.current||d.getBoundingClientRect(),E=[0,C.width],R=B6(E,w?[n,r]:[r,n]);return y.current=C,R(S-C.left)}return m.jsx(Eoe,{scope:e.__scopeSlider,startEdge:w?"left":"right",endEdge:w?"right":"left",direction:w?1:-1,size:"width",children:m.jsx(Aoe,{dir:b,"data-orientation":"horizontal",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const C=_(S.clientX);a==null||a(C)},onSlideMove:S=>{const C=_(S.clientX);o==null||o(C)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:S=>{const E=Soe[w?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:E?-1:1})}})})}),wXe=A.forwardRef((e,t)=>{const{min:n,max:r,inverted:i,onSlideStart:s,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=A.useRef(null),d=tr(t,u),h=A.useRef(void 0),p=!i;function y(b){const x=h.current||u.current.getBoundingClientRect(),w=[0,x.height],S=B6(w,p?[r,n]:[n,r]);return h.current=x,S(b-x.top)}return m.jsx(Eoe,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:m.jsx(Aoe,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const x=y(b.clientY);s==null||s(x)},onSlideMove:b=>{const x=y(b.clientY);a==null||a(x)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const w=Soe[p?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:w?-1:1})}})})}),Aoe=A.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=OT(Ny,n);return m.jsx(pn.span,{...c,ref:t,onKeyDown:Kt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):woe.concat(_oe).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Kt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Kt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:Kt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),Roe="SliderTrack",Ioe=A.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,i=OT(Roe,n);return m.jsx(pn.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:t})});Ioe.displayName=Roe;var $4="SliderRange",Moe=A.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,i=OT($4,n),s=Toe($4,n),a=A.useRef(null),o=tr(t,a),l=i.values.length,c=i.values.map(h=>Ooe(h,i.min,i.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return m.jsx(pn.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:o,style:{...e.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});Moe.displayName=$4;var z4="SliderThumb",Noe=A.forwardRef((e,t)=>{const n=yXe(e.__scopeSlider),[r,i]=A.useState(null),s=tr(t,o=>i(o)),a=A.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return m.jsx(_Xe,{...e,ref:s,index:a})}),_Xe=A.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:i,...s}=e,a=OT(z4,n),o=Toe(z4,n),[l,c]=A.useState(null),u=tr(t,_=>c(_)),d=l?a.form||!!l.closest("form"):!0,h=Qk(l),p=a.values[r],y=p===void 0?0:Ooe(p,a.min,a.max),b=kXe(r,a.values.length),x=h==null?void 0:h[o.size],w=x?TXe(x,y,o.direction):0;return A.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),m.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${w}px)`},children:[m.jsx(B4.ItemSlot,{scope:e.__scopeSlider,children:m.jsx(pn.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":p,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...s,ref:u,style:p===void 0?{display:"none"}:e.style,onFocus:Kt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&m.jsx(joe,{name:i??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:p},r)]})});Noe.displayName=z4;var SXe="RadioBubbleInput",joe=A.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const i=A.useRef(null),s=tr(i,r),a=ST(t);return A.useEffect(()=>{const o=i.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),m.jsx(pn.input,{style:{display:"none"},...n,ref:s,defaultValue:t})});joe.displayName=SXe;function CXe(e=[],t,n){const r=[...e];return r[n]=t,r.sort((i,s)=>i-s)}function Ooe(e,t,n){const s=100/(n-t)*(e-t);return ow(s,[0,100])}function kXe(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function EXe(e,t){if(e.length===1)return 0;const n=e.map(i=>Math.abs(i-t)),r=Math.min(...n);return n.indexOf(r)}function TXe(e,t,n){const r=e/2,s=B6([0,50],[0,r]);return(r-s(t)*n)*n}function AXe(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function RXe(e,t){if(t>0){const n=AXe(e);return Math.min(...n)>=t}return!0}function B6(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function IXe(e){return(String(e).split(".")[1]||"").length}function MXe(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var NXe=koe,jXe=Ioe,OXe=Moe,PXe=Noe;function Ev({className:e,defaultValue:t,value:n,min:r=0,max:i=100,...s}){const a=A.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,i],[n,t,r,i]);return m.jsxs(NXe,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:i,className:dt("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...s,children:[m.jsx(jXe,{"data-slot":"slider-track",className:dt("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:m.jsx(OXe,{"data-slot":"slider-range",className:dt("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>m.jsx(PXe,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function Kl({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:i="",valueDisplayPrecision:s=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...p}){return m.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,x=b.toFixed(s);return m.jsxs("div",{className:dt("space-y-1.5",l),children:[m.jsxs(Jt,{htmlFor:y.name,className:"text-sm",children:[n," (",r,x,i,")",a&&m.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),m.jsx(Ev,{id:y.name,name:y.name,value:[b],onValueChange:w=>y.handleChange(w[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:dt(c,y.state.meta.errors.length?"border-destructive":""),...p}),m.jsx(ps,{field:y})]})}})}const DXe=L.object({temperature:L.number().min(0).max(1),topP:L.number().min(0).max(1),maxTokens:L.number().min(1).nullable(),topK:L.number().min(1).nullable(),presencePenalty:L.number().min(-2).max(2),frequencyPenalty:L.number().min(-2).max(2)}),FXe=({module:e,className:t})=>{const n=Vs({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:DXe,onChangeAsyncDebounceMs:500}});A.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=ut.useState({});A.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const i=A.useCallback((u,d,h)=>{var p;((p=n.getFieldMeta(u))==null?void 0:p.errors.length)===0&&d(h)},[n,e]),s=A.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const p=n.getFieldValue(u);d(p)}},[n,e]),a=A.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,p,y="N/A")=>{var b;return!l||p===void 0?null:m.jsxs(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,p??null),disabled:d===null,children:["Use Default (",((b=p==null?void 0:p.toFixed)==null?void 0:b.call(p,2))??y,")"]})};return m.jsxs("div",{className:dt("space-y-4 p-4",t),children:[o.has("temperature")&&m.jsxs("div",{className:"space-y-0.5",children:[" ",m.jsx(Kl,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>i("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(Kl,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>i("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(q0,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>s("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(q0,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>s("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(Kl,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>i("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&m.jsxs("div",{className:"space-y-0.5",children:[m.jsx(Kl,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>i("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},LXe=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?m.jsxs(Al,{children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:m.jsx(ope,{className:"h-4 w-4"})})})}),m.jsx(yr,{side:"top",children:"Advanced Parameters"})]})}),m.jsx(Il,{className:"w-auto p-0",align:"start",children:m.jsx(FXe,{module:e})})]}):null};class BXe{constructor(){_e(this,"id","core-parameters");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"temperature",null);_e(this,"topP",null);_e(this,"maxTokens",null);_e(this,"topK",null);_e(this,"presencePenalty",null);_e(this,"frequencyPenalty",null);_e(this,"defaultTemperature",null);_e(this,"defaultTopP",null);_e(this,"defaultMaxTokens",null);_e(this,"defaultTopK",null);_e(this,"defaultPresencePenalty",null);_e(this,"defaultFrequencyPenalty",null);_e(this,"isStreaming",!1);_e(this,"isVisible",!0);_e(this,"supportedParams",new Set);_e(this,"notifyComponentUpdate",null);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getIsVisible",()=>this.isVisible);_e(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(Pn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(Pn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(Pn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(Pn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(Pn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(Pn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(ir.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(nn.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Pn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,i,s)}loadInitialState(){const t=dr.getState(),n=mo.getState();this.isStreaming=On.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Er.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=Xl(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const i=t.dbProviderConfigs.find(l=>l.id===n);if(!i){this.supportedParams=new Set;return}const s=t.dbApiKeys.find(l=>l.id===i.apiKeyId),a=WW(i,r,s==null?void 0:s.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=dr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(i=>this.supportedParams.has(i));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(LXe,{module:this}),getParameters:()=>{const n={},r=(i,s)=>{s!==null&&(n[i]=s)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const $Xe=({module:e})=>{const t=A.useRef(null),[,n]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),i=e.getModelSupportsNonText(),s=A.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),p=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(p&&i){const y=new FileReader,b=new Promise((w,_)=>{y.onload=()=>w(y.result),y.onerror=S=>_(S)});y.readAsDataURL(u);const x=await b;x&&x.includes(",")&&(d.contentBase64=x.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),Fe.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,i]),a=()=>{var l;(l=t.current)==null||l.click()},o=i?"Attach Files (Text, Images, etc.)":"Attach Text Files";return m.jsxs(m.Fragment,{children:[m.jsx("input",{type:"file",ref:t,onChange:s,multiple:!0,className:"hidden",disabled:r}),m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:m.jsx(nO,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:o})]})})]})},zXe=({module:e})=>{const[,t]=A.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:m.jsx("div",{className:dt("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(i=>m.jsx(DY,{fileMeta:i,onRemove:e.onFileRemove,isReadOnly:r},i.id))})},Poe=20,UXe=Poe*1024*1024;class qXe{constructor(){_e(this,"id","core-file-attachment");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"isStreaming",!1);_e(this,"modelSupportsNonText",!0);_e(this,"attachedFiles",[]);_e(this,"notifyComponentUpdate",null);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);_e(this,"getAttachedFiles",()=>this.attachedFiles);_e(this,"isLikelyTextFile",(t,n)=>tx(t,n));_e(this,"onFileAdd",t=>{var r;if(t.size>UXe){Fe.error(`File "${t.name}" exceeds the ${Poe}MB limit.`);return}if(!tx(t.name,t.type)&&!this.modelSupportsNonText){Fe.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(hl.addAttachedFileRequest,t)});_e(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(hl.removeAttachedFileRequest,{attachmentId:t})});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.isStreaming=On.getState().status==="streaming",this.attachedFiles=Of.getState().attachedFilesMetadata,this.updateModelSupport(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(ir.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(hl.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,i)}updateModelSupport(){var s,a;const{getSelectedModel:t}=Er.getState(),n=t(),r=(a=(s=n==null?void 0:n.metadata)==null?void 0:s.architecture)==null?void 0:a.input_modalities,i=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==i&&(this.modelSupportsNonText=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>ut.createElement($Xe,{module:this}),renderer:()=>ut.createElement(zXe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const VXe=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,i=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,s=Of.getState().addAttachedFile,a=()=>{const o=Bi.getState().selectedFileIds;if(o.size===0){Fe.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(s({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(Fe.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):Fe.warning("No valid files were selected to attach.")};return i?m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:dt("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:m.jsx(eO,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs(Et,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[m.jsx(nO,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),m.jsx(yr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function hm({className:e,...t}){return m.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:m.jsx("table",{"data-slot":"table",className:dt("w-full caption-bottom text-sm",e),...t})})}function jy({className:e,...t}){return m.jsx("thead",{"data-slot":"table-header",className:dt("[&_tr]:border-b",e),...t})}function pm({className:e,...t}){return m.jsx("tbody",{"data-slot":"table-body",className:dt("[&_tr:last-child]:border-0",e),...t})}function Pi({className:e,...t}){return m.jsx("tr",{"data-slot":"table-row",className:dt("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function pi({className:e,...t}){return m.jsx("th",{"data-slot":"table-head",className:dt("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function cr({className:e,...t}){return m.jsx("td",{"data-slot":"table-cell",className:dt("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function HXe({className:e,...t}){return m.jsx("caption",{"data-slot":"table-caption",className:dt("text-muted-foreground mt-4 text-sm",e),...t})}const Doe=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:i,isOperationLoading:s,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?m.jsxs("div",{className:"flex items-center gap-2 p-1",children:[m.jsx(jf,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),m.jsx(ur,{ref:i,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:s}),m.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[m.jsx(Et,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:s||!e.trim(),children:s?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(za,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:s,children:m.jsx(po,{className:"h-4 w-4"})})]})]}):m.jsxs(Pi,{className:"bg-muted/30",children:[m.jsx(cr,{className:"px-2 py-1"}),m.jsx(cr,{className:"px-2 py-1",children:m.jsx(jf,{className:"h-5 w-5 text-yellow-400"})}),m.jsx(cr,{className:"py-1 px-2",colSpan:3,children:m.jsx(ur,{ref:i,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:s})}),m.jsx(cr,{className:"text-right pr-4 py-1",children:m.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:s||!e.trim(),children:s?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(za,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:"Create (Enter)"})]})}),m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:s,children:m.jsx(po,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};var PT="Checkbox",[WXe,iat]=Ca(PT),[GXe,KXe]=WXe(PT),Foe=A.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:i,defaultChecked:s,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,p]=A.useState(null),y=tr(t,C=>p(C)),b=A.useRef(!1),x=h?u||!!h.closest("form"):!0,[w,_]=oc({prop:i,defaultProp:s??!1,onChange:c,caller:PT}),S=A.useRef(w);return A.useEffect(()=>{const C=h==null?void 0:h.form;if(C){const E=()=>_(S.current);return C.addEventListener("reset",E),()=>C.removeEventListener("reset",E)}},[h,_]),m.jsxs(GXe,{scope:n,state:w,disabled:o,children:[m.jsx(pn.button,{type:"button",role:"checkbox","aria-checked":Mf(w)?"mixed":w,"aria-required":a,"data-state":zoe(w),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onKeyDown:Kt(e.onKeyDown,C=>{C.key==="Enter"&&C.preventDefault()}),onClick:Kt(e.onClick,C=>{_(E=>Mf(E)?!0:!E),x&&(b.current=C.isPropagationStopped(),b.current||C.stopPropagation())})}),x&&m.jsx($oe,{control:h,bubbles:!b.current,name:r,value:l,checked:w,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Mf(s)?!1:s})]})});Foe.displayName=PT;var Loe="CheckboxIndicator",Boe=A.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...i}=e,s=KXe(Loe,n);return m.jsx(Hs,{present:r||Mf(s.state)||s.state===!0,children:m.jsx(pn.span,{"data-state":zoe(s.state),"data-disabled":s.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});Boe.displayName=Loe;var YXe="CheckboxBubbleInput",$oe=A.forwardRef(({__scopeCheckbox:e,control:t,checked:n,bubbles:r=!0,defaultChecked:i,...s},a)=>{const o=A.useRef(null),l=tr(o,a),c=ST(n),u=Qk(t);A.useEffect(()=>{const h=o.current;if(!h)return;const p=window.HTMLInputElement.prototype,b=Object.getOwnPropertyDescriptor(p,"checked").set;if(c!==n&&b){const x=new Event("click",{bubbles:r});h.indeterminate=Mf(n),b.call(h,Mf(n)?!1:n),h.dispatchEvent(x)}},[c,n,r]);const d=A.useRef(Mf(n)?!1:n);return m.jsx(pn.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??d.current,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});$oe.displayName=YXe;function Mf(e){return e==="indeterminate"}function zoe(e){return Mf(e)?"indeterminate":e?"checked":"unchecked"}var ZXe=Foe,XXe=Boe;function ou({className:e,...t}){return m.jsx(ZXe,{"data-slot":"checkbox",className:dt("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:m.jsx(XXe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:m.jsx(za,{className:"size-3.5"})})})}var U4=["Enter"," "],JXe=["ArrowDown","PageUp","Home"],Uoe=["ArrowUp","PageDown","End"],QXe=[...JXe,...Uoe],eJe={ltr:[...U4,"ArrowRight"],rtl:[...U4,"ArrowLeft"]},tJe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},N1="Menu",[xw,nJe,rJe]=wT(N1),[mm,DT]=Ca(N1,[rJe,lh,NT]),FT=lh(),qoe=NT(),[iJe,gm]=mm(N1),[sJe,j1]=mm(N1),Voe=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:i,onOpenChange:s,modal:a=!0}=e,o=FT(t),[l,c]=A.useState(null),u=A.useRef(!1),d=Fs(s),h=_y(i);return A.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),m.jsx(eE,{...o,children:m.jsx(iJe,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:m.jsx(sJe,{scope:t,onClose:A.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};Voe.displayName=N1;var aJe="MenuAnchor",$6=A.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,i=FT(n);return m.jsx(Mw,{...i,...r,ref:t})});$6.displayName=aJe;var z6="MenuPortal",[oJe,Hoe]=mm(z6,{forceMount:void 0}),Woe=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:i}=e,s=gm(z6,t);return m.jsx(oJe,{scope:t,forceMount:n,children:m.jsx(Hs,{present:n||s.open,children:m.jsx(ey,{asChild:!0,container:i,children:r})})})};Woe.displayName=z6;var vl="MenuContent",[lJe,U6]=mm(vl),Goe=A.forwardRef((e,t)=>{const n=Hoe(vl,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,s=gm(vl,e.__scopeMenu),a=j1(vl,e.__scopeMenu);return m.jsx(xw.Provider,{scope:e.__scopeMenu,children:m.jsx(Hs,{present:r||s.open,children:m.jsx(xw.Slot,{scope:e.__scopeMenu,children:a.modal?m.jsx(cJe,{...i,ref:t}):m.jsx(uJe,{...i,ref:t})})})})}),cJe=A.forwardRef((e,t)=>{const n=gm(vl,e.__scopeMenu),r=A.useRef(null),i=tr(t,r);return A.useEffect(()=>{const s=r.current;if(s)return CT(s)},[]),m.jsx(q6,{...e,ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Kt(e.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),uJe=A.forwardRef((e,t)=>{const n=gm(vl,e.__scopeMenu);return m.jsx(q6,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),dJe=Nf("MenuContent.ScrollLock"),q6=A.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:y,...b}=e,x=gm(vl,n),w=j1(vl,n),_=FT(n),S=qoe(n),C=nJe(n),[E,T]=A.useState(null),R=A.useRef(null),M=tr(t,R,x.onContentChange),N=A.useRef(0),O=A.useRef(""),B=A.useRef(0),P=A.useRef(null),H=A.useRef("right"),F=A.useRef(0),Q=y?C1:A.Fragment,q=y?{as:dJe,allowPinchZoom:!0}:void 0,K=re=>{var Pe,Me;const G=O.current+re,ne=C().filter(Ee=>!Ee.disabled),te=document.activeElement,se=(Pe=ne.find(Ee=>Ee.ref.current===te))==null?void 0:Pe.textValue,pe=ne.map(Ee=>Ee.textValue),de=SJe(pe,G,se),Ne=(Me=ne.find(Ee=>Ee.textValue===de))==null?void 0:Me.ref.current;(function Ee(Ue){O.current=Ue,window.clearTimeout(N.current),Ue!==""&&(N.current=window.setTimeout(()=>Ee(""),1e3))})(G),Ne&&setTimeout(()=>Ne.focus())};A.useEffect(()=>()=>window.clearTimeout(N.current),[]),_T();const U=A.useCallback(re=>{var ne,te;return H.current===((ne=P.current)==null?void 0:ne.side)&&kJe(re,(te=P.current)==null?void 0:te.area)},[]);return m.jsx(lJe,{scope:n,searchRef:O,onItemEnter:A.useCallback(re=>{U(re)&&re.preventDefault()},[U]),onItemLeave:A.useCallback(re=>{var G;U(re)||((G=R.current)==null||G.focus(),T(null))},[U]),onTriggerLeave:A.useCallback(re=>{U(re)&&re.preventDefault()},[U]),pointerGraceTimerRef:B,onPointerGraceIntentChange:A.useCallback(re=>{P.current=re},[]),children:m.jsx(Q,{...q,children:m.jsx(S1,{asChild:!0,trapped:i,onMountAutoFocus:Kt(s,re=>{var G;re.preventDefault(),(G=R.current)==null||G.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:m.jsx(X0,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:p,children:m.jsx(loe,{asChild:!0,...S,dir:w.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:T,onEntryFocus:Kt(l,re=>{w.isUsingKeyboardRef.current||re.preventDefault()}),preventScrollOnEntryFocus:!0,children:m.jsx(tE,{role:"menu","aria-orientation":"vertical","data-state":cle(x.open),"data-radix-menu-content":"",dir:w.dir,..._,...b,ref:M,style:{outline:"none",...b.style},onKeyDown:Kt(b.onKeyDown,re=>{const ne=re.target.closest("[data-radix-menu-content]")===re.currentTarget,te=re.ctrlKey||re.altKey||re.metaKey,se=re.key.length===1;ne&&(re.key==="Tab"&&re.preventDefault(),!te&&se&&K(re.key));const pe=R.current;if(re.target!==pe||!QXe.includes(re.key))return;re.preventDefault();const Ne=C().filter(Pe=>!Pe.disabled).map(Pe=>Pe.ref.current);Uoe.includes(re.key)&&Ne.reverse(),wJe(Ne)}),onBlur:Kt(e.onBlur,re=>{re.currentTarget.contains(re.target)||(window.clearTimeout(N.current),O.current="")}),onPointerMove:Kt(e.onPointerMove,ww(re=>{const G=re.target,ne=F.current!==re.clientX;if(re.currentTarget.contains(G)&&ne){const te=re.clientX>F.current?"right":"left";H.current=te,F.current=re.clientX}}))})})})})})})});Goe.displayName=vl;var fJe="MenuGroup",V6=A.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return m.jsx(pn.div,{role:"group",...r,ref:t})});V6.displayName=fJe;var hJe="MenuLabel",Koe=A.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return m.jsx(pn.div,{...r,ref:t})});Koe.displayName=hJe;var Rk="MenuItem",zq="menu.itemSelect",LT=A.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...i}=e,s=A.useRef(null),a=j1(Rk,e.__scopeMenu),o=U6(Rk,e.__scopeMenu),l=tr(t,s),c=A.useRef(!1),u=()=>{const d=s.current;if(!n&&d){const h=new CustomEvent(zq,{bubbles:!0,cancelable:!0});d.addEventListener(zq,p=>r==null?void 0:r(p),{once:!0}),KW(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return m.jsx(Yoe,{...i,ref:l,disabled:n,onClick:Kt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Kt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Kt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||U4.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});LT.displayName=Rk;var Yoe=A.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...s}=e,a=U6(Rk,n),o=qoe(n),l=A.useRef(null),c=tr(t,l),[u,d]=A.useState(!1),[h,p]=A.useState("");return A.useEffect(()=>{const y=l.current;y&&p((y.textContent??"").trim())},[s.children]),m.jsx(xw.ItemSlot,{scope:n,disabled:r,textValue:i??h,children:m.jsx(coe,{asChild:!0,...o,focusable:!r,children:m.jsx(pn.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...s,ref:c,onPointerMove:Kt(e.onPointerMove,ww(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Kt(e.onPointerLeave,ww(y=>a.onItemLeave(y))),onFocus:Kt(e.onFocus,()=>d(!0)),onBlur:Kt(e.onBlur,()=>d(!1))})})})}),pJe="MenuCheckboxItem",Zoe=A.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...i}=e;return m.jsx(tle,{scope:e.__scopeMenu,checked:n,children:m.jsx(LT,{role:"menuitemcheckbox","aria-checked":Ik(n)?"mixed":n,...i,ref:t,"data-state":W6(n),onSelect:Kt(i.onSelect,()=>r==null?void 0:r(Ik(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Zoe.displayName=pJe;var Xoe="MenuRadioGroup",[mJe,gJe]=mm(Xoe,{value:void 0,onValueChange:()=>{}}),Joe=A.forwardRef((e,t)=>{const{value:n,onValueChange:r,...i}=e,s=Fs(r);return m.jsx(mJe,{scope:e.__scopeMenu,value:n,onValueChange:s,children:m.jsx(V6,{...i,ref:t})})});Joe.displayName=Xoe;var Qoe="MenuRadioItem",ele=A.forwardRef((e,t)=>{const{value:n,...r}=e,i=gJe(Qoe,e.__scopeMenu),s=n===i.value;return m.jsx(tle,{scope:e.__scopeMenu,checked:s,children:m.jsx(LT,{role:"menuitemradio","aria-checked":s,...r,ref:t,"data-state":W6(s),onSelect:Kt(r.onSelect,()=>{var a;return(a=i.onValueChange)==null?void 0:a.call(i,n)},{checkForDefaultPrevented:!1})})})});ele.displayName=Qoe;var H6="MenuItemIndicator",[tle,yJe]=mm(H6,{checked:!1}),nle=A.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...i}=e,s=yJe(H6,n);return m.jsx(Hs,{present:r||Ik(s.checked)||s.checked===!0,children:m.jsx(pn.span,{...i,ref:t,"data-state":W6(s.checked)})})});nle.displayName=H6;var bJe="MenuSeparator",rle=A.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return m.jsx(pn.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});rle.displayName=bJe;var vJe="MenuArrow",ile=A.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,i=FT(n);return m.jsx(nE,{...i,...r,ref:t})});ile.displayName=vJe;var xJe="MenuSub",[sat,sle]=mm(xJe),Tv="MenuSubTrigger",ale=A.forwardRef((e,t)=>{const n=gm(Tv,e.__scopeMenu),r=j1(Tv,e.__scopeMenu),i=sle(Tv,e.__scopeMenu),s=U6(Tv,e.__scopeMenu),a=A.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=s,c={__scopeMenu:e.__scopeMenu},u=A.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return A.useEffect(()=>u,[u]),A.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),m.jsx($6,{asChild:!0,...c,children:m.jsx(Yoe,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":cle(n.open),...e,ref:cd(t,i.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Kt(e.onPointerMove,ww(d=>{s.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(s.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Kt(e.onPointerLeave,ww(d=>{var p,y;u();const h=(p=n.content)==null?void 0:p.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,x=b==="right",w=x?-5:5,_=h[x?"left":"right"],S=h[x?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+w,y:d.clientY},{x:_,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:_,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:Kt(e.onKeyDown,d=>{var p;const h=s.searchRef.current!=="";e.disabled||h&&d.key===" "||eJe[r.dir].includes(d.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),d.preventDefault())})})})});ale.displayName=Tv;var ole="MenuSubContent",lle=A.forwardRef((e,t)=>{const n=Hoe(vl,e.__scopeMenu),{forceMount:r=n.forceMount,...i}=e,s=gm(vl,e.__scopeMenu),a=j1(vl,e.__scopeMenu),o=sle(ole,e.__scopeMenu),l=A.useRef(null),c=tr(t,l);return m.jsx(xw.Provider,{scope:e.__scopeMenu,children:m.jsx(Hs,{present:r||s.open,children:m.jsx(xw.Slot,{scope:e.__scopeMenu,children:m.jsx(q6,{id:o.contentId,"aria-labelledby":o.triggerId,...i,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Kt(e.onFocusOutside,u=>{u.target!==o.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:Kt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Kt(e.onKeyDown,u=>{var p;const d=u.currentTarget.contains(u.target),h=tJe[a.dir].includes(u.key);d&&h&&(s.onOpenChange(!1),(p=o.trigger)==null||p.focus(),u.preventDefault())})})})})})});lle.displayName=ole;function cle(e){return e?"open":"closed"}function Ik(e){return e==="indeterminate"}function W6(e){return Ik(e)?"indeterminate":e?"checked":"unchecked"}function wJe(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function _Je(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function SJe(e,t,n){const i=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,s=n?e.indexOf(n):-1;let a=_Je(e,Math.max(s,0));i.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function CJe(e,t){const{x:n,y:r}=e;let i=!1;for(let s=0,a=t.length-1;s<t.length;a=s++){const o=t[s],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(i=!i)}return i}function kJe(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return CJe(n,t)}function ww(e){return t=>t.pointerType==="mouse"?e(t):void 0}var ule=Voe,dle=$6,fle=Woe,hle=Goe,ple=V6,mle=Koe,gle=LT,yle=Zoe,ble=Joe,vle=ele,xle=nle,wle=rle,_le=ile,Sle=ale,Cle=lle,G6="ContextMenu",[EJe,aat]=Ca(G6,[DT]),Ka=DT(),[TJe,kle]=EJe(G6),Ele=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:i,modal:s=!0}=e,[a,o]=A.useState(!1),l=Ka(t),c=Fs(r),u=A.useCallback(d=>{o(d),c(d)},[c]);return m.jsx(TJe,{scope:t,open:a,onOpenChange:u,modal:s,children:m.jsx(ule,{...l,dir:i,open:a,onOpenChange:u,modal:s,children:n})})};Ele.displayName=G6;var Tle="ContextMenuTrigger",Ale=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...i}=e,s=kle(Tle,n),a=Ka(n),o=A.useRef({x:0,y:0}),l=A.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=A.useRef(0),u=A.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},s.onOpenChange(!0)};return A.useEffect(()=>u,[u]),A.useEffect(()=>void(r&&u()),[r,u]),m.jsxs(m.Fragment,{children:[m.jsx(dle,{...a,virtualRef:l}),m.jsx(pn.span,{"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,...i,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Kt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Kt(e.onPointerDown,US(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Kt(e.onPointerMove,US(u)),onPointerCancel:r?e.onPointerCancel:Kt(e.onPointerCancel,US(u)),onPointerUp:r?e.onPointerUp:Kt(e.onPointerUp,US(u))})]})});Ale.displayName=Tle;var AJe="ContextMenuPortal",Rle=e=>{const{__scopeContextMenu:t,...n}=e,r=Ka(t);return m.jsx(fle,{...r,...n})};Rle.displayName=AJe;var Ile="ContextMenuContent",Mle=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=kle(Ile,n),s=Ka(n),a=A.useRef(!1);return m.jsx(hle,{...s,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!i.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Mle.displayName=Ile;var RJe="ContextMenuGroup",IJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(ple,{...i,...r,ref:t})});IJe.displayName=RJe;var MJe="ContextMenuLabel",NJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(mle,{...i,...r,ref:t})});NJe.displayName=MJe;var jJe="ContextMenuItem",Nle=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(gle,{...i,...r,ref:t})});Nle.displayName=jJe;var OJe="ContextMenuCheckboxItem",PJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(yle,{...i,...r,ref:t})});PJe.displayName=OJe;var DJe="ContextMenuRadioGroup",FJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(ble,{...i,...r,ref:t})});FJe.displayName=DJe;var LJe="ContextMenuRadioItem",BJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(vle,{...i,...r,ref:t})});BJe.displayName=LJe;var $Je="ContextMenuItemIndicator",zJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(xle,{...i,...r,ref:t})});zJe.displayName=$Je;var UJe="ContextMenuSeparator",jle=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(wle,{...i,...r,ref:t})});jle.displayName=UJe;var qJe="ContextMenuArrow",VJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(_le,{...i,...r,ref:t})});VJe.displayName=qJe;var HJe="ContextMenuSubTrigger",WJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(Sle,{...i,...r,ref:t})});WJe.displayName=HJe;var GJe="ContextMenuSubContent",KJe=A.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,i=Ka(n);return m.jsx(Cle,{...i,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});KJe.displayName=GJe;function US(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var YJe=Ele,ZJe=Ale,XJe=Rle,JJe=Mle,QJe=Nle,eQe=jle;function Uq({...e}){return m.jsx(YJe,{"data-slot":"context-menu",...e})}function qq({...e}){return m.jsx(ZJe,{"data-slot":"context-menu-trigger",...e})}function Vq({className:e,...t}){return m.jsx(XJe,{children:m.jsx(JJe,{"data-slot":"context-menu-content",className:dt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function jo({className:e,inset:t,variant:n="default",...r}){return m.jsx(QJe,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:dt("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Hq({className:e,...t}){return m.jsx(eQe,{"data-slot":"context-menu-separator",className:dt("bg-border -mx-1 my-1 h-px",e),...t})}const tQe=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:i,isOperationLoading:s,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:p,setNewName:y,renameInputRef:b,handleGitInit:x,handleGitPull:w,handleGitCommit:_,handleGitPush:S,handleGitStatus:C})=>{const E=e.type==="folder",T=B=>{B.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||s||(E?o(e):l(!n,e.id))},R=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()},M=E?r?UV:jf:zV,N=E?r?"text-green-400":"text-yellow-400":"text-blue-400",O=m.jsxs(Pi,{className:dt("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",s&&"opacity-70 cursor-not-allowed",!E&&"cursor-pointer"),onClick:T,onDoubleClick:()=>!s&&!t&&o(e),children:[m.jsx(cr,{className:"px-2 py-1",children:m.jsx(ou,{checked:n,onCheckedChange:B=>l(!!B,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:s||E})}),m.jsx(cr,{className:"px-2 py-1",children:m.jsx(M,{className:dt("h-5 w-5",N)})}),m.jsx(cr,{className:"py-1 px-2",children:t?m.jsx(ur,{ref:b,value:i,onChange:B=>y(B.target.value),onBlur:d,onKeyDown:R,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:B=>B.stopPropagation(),disabled:s}):m.jsx("span",{className:dt("truncate",E&&"cursor-pointer hover:underline"),title:e.name,onClick:B=>{E&&(B.stopPropagation(),o(e))},children:e.name})}),m.jsx(cr,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?Ex(e.size):""}),m.jsx(cr,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),m.jsx(cr,{className:"text-right pr-4 py-1",children:m.jsx("div",{className:dt("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",s&&"opacity-30"),children:t?m.jsxs(m.Fragment,{children:[m.jsx(Rn,{tooltipText:"Save (Enter)",onClick:B=>{B.stopPropagation(),d()},"aria-label":"Save name",disabled:s||!i.trim(),icon:s?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(za,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),m.jsx(Rn,{tooltipText:"Cancel (Esc)",onClick:B=>{B.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:s,icon:m.jsx(po,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):m.jsxs(m.Fragment,{children:[m.jsx(Rn,{tooltipText:"Rename",onClick:B=>{B.stopPropagation(),c(e)},"aria-label":"Rename",disabled:s||a,icon:m.jsx(KS,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),m.jsx(Rn,{tooltipText:E?"Download folder (.zip)":"Download file",onClick:B=>{B.stopPropagation(),h(e)},"aria-label":E?"Download folder as ZIP":"Download file",disabled:s,icon:m.jsx(Gc,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),m.jsx(Rn,{tooltipText:"Delete",onClick:B=>{B.stopPropagation(),p(e)},"aria-label":`Delete ${E?"folder":"file"}`,disabled:s,icon:m.jsx(Fo,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return E?m.jsxs(Uq,{children:[m.jsx(qq,{disabled:t||s,asChild:!0,children:O}),m.jsxs(Vq,{children:[m.jsx(jo,{onSelect:()=>o(e),disabled:t||s,children:"Open Folder"}),m.jsx(Hq,{}),r?m.jsxs(m.Fragment,{children:[m.jsxs(jo,{onSelect:()=>w(e.path),disabled:s,children:[m.jsx(HV,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),m.jsxs(jo,{onSelect:()=>_(e.path),disabled:s,children:[m.jsx(VV,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),m.jsxs(jo,{onSelect:()=>S(e.path),disabled:s,children:[m.jsx(Q4,{className:"mr-2 h-4 w-4"}),"Git Push"]}),m.jsxs(jo,{onSelect:()=>C(e.path),disabled:s,children:[m.jsx(tO,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):m.jsxs(jo,{onSelect:()=>x(e.path),disabled:s,children:[m.jsx(rc,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),m.jsx(Hq,{}),m.jsxs(jo,{onSelect:()=>c(e),disabled:s,children:[m.jsx(KS,{className:"mr-2 h-4 w-4"}),"Rename"]}),m.jsxs(jo,{onSelect:()=>h(e),disabled:s,children:[m.jsx(Gc,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),m.jsxs(jo,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>p(e),disabled:s,children:[m.jsx(Fo,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):m.jsxs(Uq,{children:[m.jsx(qq,{disabled:t||s,asChild:!0,children:O}),m.jsxs(Vq,{children:[m.jsxs(jo,{onSelect:()=>l(!n,e.id),disabled:s,children:[n?"Deselect":"Select"," File"]}),m.jsxs(jo,{onSelect:()=>c(e),disabled:s,children:[m.jsx(KS,{className:"mr-2 h-4 w-4"}),"Rename"]}),m.jsxs(jo,{onSelect:()=>h(e),disabled:s,children:[m.jsx(Gc,{className:"mr-2 h-4 w-4"}),"Download File"]}),m.jsxs(jo,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>p(e),disabled:s,children:[m.jsx(Fo,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},nQe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:i,selectedFileIds:s,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:p,handleDownload:y,handleDelete:b,setNewName:x,setNewFolderName:w,renameInputRef:_,newFolderInputRef:S,gitRepoStatus:C,handleGitInit:E,handleGitPull:T,handleGitCommit:R,handleGitPush:M,handleGitStatus:N})=>{const O=A.useMemo(()=>e,[e]);return a&&e.length===0&&!r?m.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):m.jsx("div",{className:"relative h-full",children:m.jsxs(hm,{className:"w-full text-sm",children:[m.jsx(jy,{className:"sticky top-0 bg-card z-10",children:m.jsxs(Pi,{className:"hover:bg-card",children:[m.jsx(pi,{className:"w-[40px] px-2"}),m.jsx(pi,{className:"w-[40px] px-2"}),m.jsx(pi,{children:"Name"}),m.jsx(pi,{className:"w-[100px] text-right",children:"Size"}),m.jsx(pi,{className:"w-[150px] text-right",children:"Modified"}),m.jsx(pi,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),m.jsxs(pm,{children:[r&&m.jsx(Doe,{newFolderName:i,setNewFolderName:w,handleCreateFolder:p,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),O.map(B=>{const P=t===B.path,H=s.has(B.id),F=C[B.path]??!1;return m.jsx(tQe,{entry:B,isEditingThis:P,isChecked:H,isGitRepo:F,newName:P?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:x,renameInputRef:_,handleGitInit:E,handleGitPull:T,handleGitCommit:R,handleGitPush:M,handleGitStatus:N},B.id)}),e.length===0&&!r&&!a&&m.jsx(Pi,{children:m.jsx(cr,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},rQe=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:i,creatingFolder:s,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:p,handleCloneClick:y,fileInputRef:b,folderInputRef:x,archiveInputRef:w,handleFileChange:_,handleArchiveChange:S})=>m.jsxs(m.Fragment,{children:[m.jsx("input",{type:"file",ref:b,onChange:_,className:"hidden",multiple:!0,disabled:t}),m.jsx("input",{type:"file",ref:x,onChange:_,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),m.jsx("input",{type:"file",ref:w,onChange:S,className:"hidden",accept:".zip",disabled:t}),m.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[m.jsx(Et,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:m.jsx(vhe,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:m.jsx(rhe,{className:"h-4 w-4"})}),m.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),m.jsx("div",{className:"flex-grow"}),m.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",m.jsx(Et,{variant:"ghost",size:"icon",onClick:C=>{C.preventDefault(),C.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Ap,{className:"h-4 w-4"})}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),c()},disabled:t||s||!!i,className:"h-8",title:"Create New Folder",type:"button",children:[n&&s?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(qV,{className:"h-4 w-4 mr-1"}),m.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(BV,{className:"h-4 w-4 mr-1"}),m.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(jf,{className:"h-4 w-4 mr-1"}),m.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(zfe,{className:"h-4 w-4 mr-1"}),m.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(rc,{className:"h-4 w-4 mr-1"}),m.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:C=>{C.preventDefault(),C.stopPropagation(),p()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(PV,{className:"h-4 w-4 mr-1"}),m.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),Ole=({isOpen:e,onOpenChange:t,title:n,description:r,children:i,submitLabel:s="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return m.jsx(Ty,{open:e,onOpenChange:t,children:m.jsxs(Ay,{className:dt(c),children:[m.jsxs(Ry,{children:[m.jsx(My,{children:n}),r&&m.jsx(I1,{children:r})]}),m.jsx("div",{className:dt("py-4",u),children:i}),m.jsxs(Iy,{children:[m.jsx(HZe,{asChild:!0,children:m.jsx(Et,{variant:"outline",disabled:o,children:"Cancel"})}),m.jsxs(Et,{onClick:d,disabled:o||l,children:[o&&m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":s]})]})]})})},iQe=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:i,setCloneBranch:s,isCloning:a,onSubmitClone:o,currentPath:l})=>m.jsx(Ole,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:m.jsxs(m.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",m.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:m.jsxs("div",{className:"grid gap-4",children:[m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(Jt,{htmlFor:"clone-url",className:"text-right",children:"URL"}),m.jsx(ur,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(Jt,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),m.jsx(ur,{id:"clone-branch",value:i,onChange:c=>s(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),sQe=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:i,isCommitting:s,onSubmitCommit:a})=>m.jsx(Ole,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:m.jsxs(m.Fragment,{children:["Enter a commit message for the changes in ",m.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:s,submitDisabled:!r.trim(),children:m.jsx("div",{className:"grid gap-4",children:m.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[m.jsx(Jt,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),m.jsx(ur,{id:"commit-msg",value:r,onChange:o=>i(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:s})]})})});var BT="DropdownMenu",[aQe,oat]=Ca(BT,[DT]),Ya=DT(),[oQe,Ple]=aQe(BT),Dle=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:i,defaultOpen:s,onOpenChange:a,modal:o=!0}=e,l=Ya(t),c=A.useRef(null),[u,d]=oc({prop:i,defaultProp:s??!1,onChange:a,caller:BT});return m.jsx(oQe,{scope:t,triggerId:Bs(),triggerRef:c,contentId:Bs(),open:u,onOpenChange:d,onOpenToggle:A.useCallback(()=>d(h=>!h),[d]),modal:o,children:m.jsx(ule,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};Dle.displayName=BT;var Fle="DropdownMenuTrigger",Lle=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=e,s=Ple(Fle,n),a=Ya(n);return m.jsx(dle,{asChild:!0,...a,children:m.jsx(pn.button,{type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...i,ref:cd(t,s.triggerRef),onPointerDown:Kt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(s.onOpenToggle(),s.open||o.preventDefault())}),onKeyDown:Kt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&s.onOpenToggle(),o.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});Lle.displayName=Fle;var lQe="DropdownMenuPortal",Ble=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Ya(t);return m.jsx(fle,{...r,...n})};Ble.displayName=lQe;var $le="DropdownMenuContent",zle=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ple($le,n),s=Ya(n),a=A.useRef(!1);return m.jsx(hle,{id:i.contentId,"aria-labelledby":i.triggerId,...s,...r,ref:t,onCloseAutoFocus:Kt(e.onCloseAutoFocus,o=>{var l;a.current||(l=i.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Kt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!i.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});zle.displayName=$le;var cQe="DropdownMenuGroup",uQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(ple,{...i,...r,ref:t})});uQe.displayName=cQe;var dQe="DropdownMenuLabel",fQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(mle,{...i,...r,ref:t})});fQe.displayName=dQe;var hQe="DropdownMenuItem",Ule=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(gle,{...i,...r,ref:t})});Ule.displayName=hQe;var pQe="DropdownMenuCheckboxItem",mQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(yle,{...i,...r,ref:t})});mQe.displayName=pQe;var gQe="DropdownMenuRadioGroup",yQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(ble,{...i,...r,ref:t})});yQe.displayName=gQe;var bQe="DropdownMenuRadioItem",vQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(vle,{...i,...r,ref:t})});vQe.displayName=bQe;var xQe="DropdownMenuItemIndicator",wQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(xle,{...i,...r,ref:t})});wQe.displayName=xQe;var _Qe="DropdownMenuSeparator",qle=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(wle,{...i,...r,ref:t})});qle.displayName=_Qe;var SQe="DropdownMenuArrow",CQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(_le,{...i,...r,ref:t})});CQe.displayName=SQe;var kQe="DropdownMenuSubTrigger",EQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(Sle,{...i,...r,ref:t})});EQe.displayName=kQe;var TQe="DropdownMenuSubContent",AQe=A.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,i=Ya(n);return m.jsx(Cle,{...i,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});AQe.displayName=TQe;var RQe=Dle,IQe=Lle,MQe=Ble,NQe=zle,jQe=Ule,OQe=qle;function PQe({...e}){return m.jsx(RQe,{"data-slot":"dropdown-menu",...e})}function DQe({...e}){return m.jsx(IQe,{"data-slot":"dropdown-menu-trigger",...e})}function FQe({className:e,sideOffset:t=4,...n}){return m.jsx(MQe,{children:m.jsx(NQe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:dt("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function Ic({className:e,inset:t,variant:n="default",...r}){return m.jsx(jQe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:dt("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Wq({className:e,...t}){return m.jsx(OQe,{"data-slot":"dropdown-menu-separator",className:dt("bg-border -mx-1 my-1 h-px",e),...t})}const LQe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:i,selectedFileIds:s,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:p,handleDownload:y,handleDelete:b,setNewName:x,setNewFolderName:w,renameInputRef:_,newFolderInputRef:S,gitRepoStatus:C,handleGitInit:E,handleGitPull:T,handleGitCommit:R,handleGitPush:M,handleGitStatus:N})=>{const O=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()};return a&&e.length===0&&!r?m.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):m.jsxs("div",{className:"p-2 space-y-1",children:[r&&m.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:m.jsx(Doe,{newFolderName:i,setNewFolderName:w,handleCreateFolder:p,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(B=>{const P=t===B.path,H=s.has(B.id),F=C[B.path]??!1,Q=B.type==="folder",q=Q?F?UV:jf:zV,K=Q?F?"text-green-400":"text-yellow-400":"text-blue-400";return m.jsxs("div",{className:dt("flex items-center justify-between p-2 border rounded-md",P&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!P&&"hover:bg-muted/50",!P&&"cursor-pointer"),onClick:()=>{P||a||(Q?o(B):l(!H,B.id))},children:[m.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!Q&&m.jsx(ou,{checked:H,onCheckedChange:U=>l(!!U,B.id),"aria-label":`Select ${B.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:U=>U.stopPropagation()}),Q&&m.jsx("div",{className:"w-6 flex-shrink-0"}),m.jsx(q,{className:dt("h-5 w-5 flex-shrink-0",K)}),m.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[P?m.jsx(ur,{ref:_,value:n,onChange:U=>x(U.target.value),onBlur:d,onKeyDown:O,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:U=>U.stopPropagation(),disabled:a}):m.jsx("span",{className:"text-sm font-medium truncate",title:B.name,children:B.name}),m.jsx("span",{className:"text-xs text-muted-foreground",children:B.type==="file"&&B.size!==void 0?Ex(B.size):B.type==="folder"?F?"Git Repository":"Folder":""})]})]}),m.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:P?m.jsxs(m.Fragment,{children:[m.jsx(Et,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:U=>{U.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(za,{className:"h-4 w-4"})}),m.jsx(Et,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:U=>{U.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:m.jsx(po,{className:"h-4 w-4"})})]}):m.jsxs(PQe,{children:[m.jsx(DQe,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:U=>U.stopPropagation(),disabled:a,"aria-label":"More actions",children:m.jsx(Bfe,{className:"h-4 w-4"})})}),m.jsxs(FQe,{align:"end",onClick:U=>U.stopPropagation(),children:[Q&&m.jsx(Ic,{onSelect:()=>o(B),children:"Open Folder"}),!Q&&m.jsxs(Ic,{onSelect:()=>l(!H,B.id),children:[H?"Deselect":"Select"," File"]}),m.jsxs(Ic,{onSelect:()=>c(B),children:[m.jsx(KS,{className:"mr-2 h-4 w-4"})," Rename"]}),m.jsxs(Ic,{onSelect:()=>y(B),children:[m.jsx(Gc,{className:"mr-2 h-4 w-4"})," Download"," ",Q?"as ZIP":""]}),Q&&m.jsx(Wq,{}),Q&&F&&m.jsxs(m.Fragment,{children:[m.jsxs(Ic,{onSelect:()=>T(B.path),children:[m.jsx(HV,{className:"mr-2 h-4 w-4"})," Git Pull"]}),m.jsxs(Ic,{onSelect:()=>R(B.path),children:[m.jsx(VV,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),m.jsxs(Ic,{onSelect:()=>M(B.path),children:[m.jsx(Q4,{className:"mr-2 h-4 w-4"})," Git Push"]}),m.jsxs(Ic,{onSelect:()=>N(B.path),children:[m.jsx(tO,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),Q&&!F&&m.jsxs(Ic,{onSelect:()=>E(B.path),children:[m.jsx(rc,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),m.jsx(Wq,{}),m.jsxs(Ic,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(B),children:[m.jsx(Fo,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},B.id)}),e.length===0&&!r&&!a&&m.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},K6=A.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:i,error:s,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=Bi(Cn(Se=>({nodes:Se.nodes,childrenMap:Se.childrenMap,currentParentId:Se.currentParentId,selectedFileIds:Se.selectedFileIds,loading:Se.loading,operationLoading:Se.operationLoading,error:Se.error,rootId:Se.rootId,vfsKey:Se.vfsKey,configuredVfsKey:Se.configuredVfsKey,initializingKey:Se.initializingKey}))),[d,h]=A.useState(""),[p,y]=A.useState(null),[b,x]=A.useState(!1),[w,_]=A.useState(""),[S,C]=A.useState({}),[E,T]=A.useState(!1),[R,M]=A.useState(""),[N,O]=A.useState(""),[B,P]=A.useState(!1),[H,F]=A.useState(!1),[Q,q]=A.useState(null),[K,U]=A.useState(""),[re,G]=A.useState(!1),[ne,te]=A.useState({}),se=A.useRef(null),pe=A.useRef(null),de=A.useRef(null),Ne=A.useRef(null),Pe=A.useRef(null),Me=n?e[n]:null,Ee=Me?Me.path:"/",nt=(t[n||a||""]||[]).map(Se=>e[Se]).filter(Se=>!!Se).sort((Se,ze)=>Se.type==="folder"&&ze.type==="file"?-1:Se.type==="file"&&ze.type==="folder"?1:Se.name.localeCompare(ze.name)),He=A.useMemo(()=>nt.filter(Se=>Se.type==="folder").map(Se=>Se.path),[nt]),je=r||u!==null||l!==c,Y=i||B||re||Object.values(ne).some(Boolean);A.useEffect(()=>{n!==null&&!t[n]&&!je&&c===l?Be.emit(ln.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!je&&c===l&&Be.emit(ln.fetchNodesRequest,{parentId:a})},[n,t,a,je,c,l]),A.useEffect(()=>{var Se,ze;p&&((Se=Ne.current)==null||Se.focus(),(ze=Ne.current)==null||ze.select())},[p]),A.useEffect(()=>{var Se;b&&((Se=Pe.current)==null||Se.focus())},[b]),A.useEffect(()=>{(async()=>{if(je||He.length===0)return;const ze={};let Tt=!1;for(const ge of He)try{const Z=await lEe(ge);S[ge]!==Z&&(ze[ge]=Z,Tt=!0)}catch(Z){console.error(`Error checking git status for ${ge}:`,Z),S[ge]!==!1&&(ze[ge]=!1,Tt=!0)}Tt&&C(ge=>({...ge,...ze}))})()},[He,je,S]);const be=A.useCallback(async(Se,ze,Tt)=>{if(!(Y||je)){Tt!==!1&&Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Be.emit(Se,ze)}catch(ge){console.error("[FileManager Operation Error]:",ge),Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:i,error:ge instanceof Error?ge.message:String(ge)})}finally{Tt!==!1&&Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!1,error:s})}}},[Y,je,r,i,s]),Re=A.useCallback(Se=>{Y||je||p||Se.type==="folder"&&be(ln.setCurrentPathRequest,{path:Se.path},!1)},[Y,je,p,be]),ce=A.useCallback(()=>{if(Y||je||Ee==="/")return;const Se=SE(Ee);be(ln.setCurrentPathRequest,{path:Se},!1)},[Y,je,Ee,be]),le=A.useCallback(()=>{Y||je||Ee==="/"||be(ln.setCurrentPathRequest,{path:"/"},!1)},[Y,je,Ee,be]),ae=A.useCallback(()=>{je||be(ln.fetchNodesRequest,{parentId:n},!1)},[be,n,je]),Te=A.useCallback((Se,ze)=>{const Tt=e[ze];Tt&&Tt.type==="file"?Se?Be.emit(ln.selectFileRequest,{fileId:ze}):Be.emit(ln.deselectFileRequest,{fileId:ze}):Tt&&Tt.type==="folder"&&Fe.info("Folders cannot be attached to the prompt.")},[e]),$e=A.useCallback(Se=>{Y||je||b||(y(Se.path),h(Se.name),x(!1))},[Y,je,b]),ke=A.useCallback(()=>{y(null),h("")},[]),ot=A.useCallback(async()=>{if(!p||!d.trim()){ke();return}const Se=Object.values(e).find(ze=>ze.path===p);Se&&Se.name!==d.trim()&&await be(ln.renameNodeRequest,{id:Se.id,newName:d.trim()}),ke()},[p,d,e,ke,be]),At=A.useCallback(()=>{Y||je||p||(x(!0),_(""),y(null))},[Y,je,p]),ft=A.useCallback(()=>{x(!1),_("")},[]),jt=A.useCallback(async()=>{if(!w.trim()){ft();return}await be(ln.createDirectoryRequest,{parentId:n,name:w.trim()}),ft()},[w,n,ft,be]),Bt=()=>{var Se;return(Se=se.current)==null?void 0:Se.click()},Ft=()=>{var Se;return(Se=pe.current)==null?void 0:Se.click()},tn=()=>{var Se;return(Se=de.current)==null?void 0:Se.click()},xe=A.useCallback(async Se=>{const ze=Se.target.files;ze&&ze.length>0&&(await be(ln.uploadFilesRequest,{parentId:n,files:ze}),Se.target&&(Se.target.value=""))},[n,be]),D=A.useCallback(async Se=>{var Tt;const ze=(Tt=Se.target.files)==null?void 0:Tt[0];if(ze){Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await dEe(ze,Ee),Be.emit(ln.fetchNodesRequest,{parentId:n})}catch(ge){console.error("Archive upload error:",ge)}finally{Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!1,error:s}),Se.target&&(Se.target.value="")}}},[Ee,n,r,s]),X=A.useCallback(async Se=>{window.confirm(`Delete ${Se.type} "${Se.name}"?${Se.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await be(ln.deleteNodesRequest,{ids:[Se.id]})},[be]),me=A.useCallback(async Se=>{Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Se.type==="file"?await uEe(Se.path):await x9(`${Se.name}.zip`,Se.path)}catch(ze){console.error("Download error:",ze)}finally{Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!1,error:s})}},[r,s]),De=A.useCallback(async()=>{if(nt.length!==0){Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const Se=ns(Ee)||"root";await x9(`${Se}_export.zip`,Ee)}catch(Se){console.error("Download all error:",Se)}finally{Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:!1,error:s})}}},[Ee,nt.length,r,s]),we=A.useCallback(async(Se,ze)=>{if(!(ne[Se]||je||i)){te(Tt=>({...Tt,[Se]:!0})),Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:i,error:null});try{await ze()}catch(Tt){console.error(`[FileManager Git Op Error @ ${Se}]:`,Tt)}finally{te(Tt=>({...Tt,[Se]:!1}))}}},[ne,je,i,r]),Ie=A.useCallback(Se=>{we(Se,async()=>{await MY(Se),C(ze=>({...ze,[Se]:!0}))})},[we]),fe=A.useCallback(Se=>{Fe.info("Pulling default branch (auth not implemented yet)..."),we(Se,()=>RE(Se,"main"))},[we]),yt=A.useCallback(Se=>{q(Se),U(""),F(!0)},[]),_t=A.useCallback(Se=>{Fe.info("Pushing default branch (auth not implemented yet)..."),we(Se,()=>gP(Se,"main"))},[we]),z=A.useCallback(Se=>{we(Se,()=>NY(Se))},[we]),qe=A.useCallback(()=>{M(""),O(""),T(!0)},[]),rt=A.useCallback(async()=>{if(!R.trim()){Fe.error("Repository URL cannot be empty.");return}P(!0),Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:i,error:null});try{const Se=ns(R.trim().replace(/\.git$/,""))||"cloned_repo",ze=K3(Ee,Se);await IY(ze,R.trim(),N.trim()||void 0),T(!1),Be.emit(ln.fetchNodesRequest,{parentId:n})}catch{}finally{P(!1)}},[R,N,Ee,n,r,i]),ve=A.useCallback(async()=>{if(!Q||!K.trim()){Fe.error("Commit message cannot be empty.");return}G(!0),Be.emit(ln.loadingStateChanged,{isLoading:r,operationLoading:i,error:null});try{await mP(Q,K.trim()),F(!1)}catch{}finally{G(!1)}},[Q,K,r,i]);return je?m.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[m.jsx(Hn,{className:"h-8 w-8 animate-spin mb-2"}),m.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),s&&m.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",s]})]}):s&&!je?m.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[m.jsxs("p",{children:["Error loading filesystem: ",s]}),m.jsx(Et,{variant:"outline",size:"sm",onClick:()=>Be.emit(ln.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):m.jsxs("div",{className:dt("flex h-full flex-col bg-card text-card-foreground"),children:[m.jsx(rQe,{currentPath:Ee,isAnyLoading:Y||je,isOperationLoading:i,entries:nt,editingPath:p,creatingFolder:b,handleNavigateHome:le,handleNavigateUp:ce,handleRefresh:ae,startCreatingFolder:At,handleUploadClick:Bt,handleFolderUploadClick:Ft,handleArchiveUploadClick:tn,handleDownloadAll:De,handleCloneClick:qe,fileInputRef:se,folderInputRef:pe,archiveInputRef:de,handleFileChange:xe,handleArchiveChange:D}),m.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:m.jsx(nQe,{entries:nt,editingPath:p,newName:d,creatingFolder:b,newFolderName:w,selectedFileIds:o,isOperationLoading:Y,handleNavigate:Re,handleCheckboxChange:Te,startEditing:$e,cancelEditing:ke,handleRename:ot,cancelCreatingFolder:ft,handleCreateFolder:jt,handleDownload:me,handleDelete:X,setNewName:h,setNewFolderName:_,renameInputRef:Ne,newFolderInputRef:Pe,gitRepoStatus:S,handleGitInit:Ie,handleGitPull:fe,handleGitCommit:yt,handleGitPush:_t,handleGitStatus:z})}),m.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:m.jsx(LQe,{entries:nt,editingPath:p,newName:d,creatingFolder:b,newFolderName:w,selectedFileIds:o,isOperationLoading:Y,handleNavigate:Re,handleCheckboxChange:Te,startEditing:$e,cancelEditing:ke,handleRename:ot,cancelCreatingFolder:ft,handleCreateFolder:jt,handleDownload:me,handleDelete:X,setNewName:h,setNewFolderName:_,renameInputRef:Ne,newFolderInputRef:Pe,gitRepoStatus:S,handleGitInit:Ie,handleGitPull:fe,handleGitCommit:yt,handleGitPush:_t,handleGitStatus:z})}),m.jsx(iQe,{isOpen:E,onOpenChange:T,cloneRepoUrl:R,setCloneRepoUrl:M,cloneBranch:N,setCloneBranch:O,isCloning:B,onSubmitClone:rt,currentPath:Ee}),m.jsx(sQe,{isOpen:H,onOpenChange:F,commitPath:Q,commitMessage:K,setCommitMessage:U,isCommitting:re,onSubmitCommit:ve})]})});K6.displayName="FileManager";const BQe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?m.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[m.jsx(SL,{className:"h-4 w-4"}),m.jsxs("span",{children:[m.jsx("b",{children:"Shared VFS:"})," All chats ",m.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?m.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[m.jsx(SL,{className:"h-4 w-4"}),m.jsxs("span",{children:[m.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?m.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[m.jsx(jf,{className:"h-4 w-4"}),m.jsxs("span",{children:[m.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,$Qe=({module:e,isOpen:t,onClose:n})=>{const[r,i]=A.useState(e.getSelectedFileIdsCount()),[s,a]=A.useState(null);A.useEffect(()=>{const u=h=>{i(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Be.on(ln.selectionChanged,u),Be.on(Un.selectedItemChanged,d),()=>{Be.off(ln.selectionChanged,u),Be.off(Un.selectedItemChanged,d)}},[]);const o=Bi.getState().vfsKey,l=()=>{const u=Bi.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){Fe.info("No files selected in VFS to attach.");return}let h=0;u.forEach(p=>{const y=d[p];y&&y.type==="file"&&(Be.emit(hl.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(Fe.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):Fe.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return m.jsx(Ty,{open:t,onOpenChange:u=>!u&&c(),children:m.jsxs(Ay,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[m.jsxs(Ry,{className:"p-4 pb-2 border-b flex-shrink-0",children:[m.jsx(My,{children:"Virtual Filesystem"}),m.jsx(I1,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),m.jsx(BQe,{vfsKey:o,selectedItemType:s})]}),m.jsx("div",{className:"flex-grow overflow-hidden",children:m.jsx(K6,{})}),m.jsxs(Iy,{className:"p-4 pt-2 border-t flex-shrink-0",children:[m.jsx(Et,{variant:"outline",onClick:c,children:"Close"}),m.jsxs(Et,{onClick:l,disabled:r===0,children:[m.jsx(nO,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class zQe{constructor(){_e(this,"id","core-vfs");_e(this,"modalId","core-vfs-modal-panel");_e(this,"unregisterCallbacks",[]);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"notifyTriggerUpdate",null);_e(this,"isModalOpenByManager",!1);_e(this,"getEnableVfs",()=>Bi.getState().enableVfs);_e(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);_e(this,"getSelectedFileIdsCount",()=>Bi.getState().selectedFileIds.size);_e(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(kr.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(kr.openModalRequest,{modalId:this.modalId})});_e(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(ln.clearSelectionRequest,void 0)});_e(this,"getVfsNodes",()=>Bi.getState().nodes);_e(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(kr.contextChanged,()=>{var i;this.updateVfsKeyBasedOnContext(),(i=this.notifyTriggerUpdate)==null||i.call(this)}),r=t.on(kr.modalStateChanged,i=>{var s;if(i.modalId===this.modalId){const a=i.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(s=this.notifyTriggerUpdate)==null||s.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var s;const{selectedItemId:t,selectedItemType:n}=Dn.getState(),r=Bi.getState().vfsKey;let i=null;if(this.isModalOpenByManager)if(n==="project")i=t;else if(n==="conversation"){const a=Dn.getState().getConversationById(t);i=(a==null?void 0:a.projectId)??"orphan"}else i="orphan";else if(n==="project")i=t;else if(n==="conversation"){const a=Dn.getState().getConversationById(t);i=(a==null?void 0:a.projectId)??"orphan"}else i="orphan";r!==i&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${i}"`),(s=this.modApiRef)==null||s.emit(ln.setVfsKeyRequest,{key:i}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>ut.createElement(VXe,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,i=>ut.createElement($Qe,{module:this,...i}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const UQe=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,i=e.syncRepos,s=e.conversationSyncStatus,a=e.isStreaming,[o,l]=A.useState(null),[c,u]=A.useState("idle"),[d,h]=A.useState(!1),[p,y]=A.useState(!1);A.useEffect(()=>{if(r==="conversation"&&n){const T=e.getConversationById(n);l((T==null?void 0:T.syncRepoId)??null),u(s[n]??"idle")}else l(null),u("idle")},[n,r,s,e]);const b=ut.useMemo(()=>new Map(i.map(T=>[T.id,T.name])),[i]),x=o?b.get(o):void 0,w=A.useCallback(async T=>{if(!n||r!=="conversation")return;h(!0);const R=T==="none"?null:T;await e.linkConversationToRepo(n,R),h(!1)},[n,r,e]),_=A.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),S=Oae(c,x),C=!o||p||d||a||c==="syncing";return r==="conversation"&&i.length>0?m.jsxs(Al,{children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||p,"aria-label":"Configure Git Sync",children:c==="syncing"||p||d?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(rc,{className:"h-4 w-4"})})})}),m.jsx(yr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),m.jsxs(Il,{className:"w-64 p-4 space-y-3",align:"start",children:[m.jsx(Jt,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),m.jsxs(k1,{value:o??"none",onValueChange:w,disabled:d||p||a,children:[m.jsx(T1,{id:"sync-repo-select",className:"w-full h-9",children:m.jsx(E1,{placeholder:"Select repository..."})}),m.jsxs(A1,{children:[m.jsx(nh,{value:"none",children:m.jsx("span",{className:"text-muted-foreground",children:"None"})}),i.map(T=>m.jsx(nh,{value:T.id,children:T.name},T.id))]})]}),m.jsxs("div",{className:"flex items-center justify-between pt-2",children:[m.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),m.jsxs(Et,{size:"sm",variant:"outline",onClick:_,disabled:C,className:"h-8",children:[p||c==="syncing"?m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}):m.jsx(Q4,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},Av=({title:e,description:t,children:n,className:r,titleClassName:i,descriptionClassName:s,contentClassName:a})=>m.jsxs("div",{className:dt("space-y-2",r),children:[m.jsxs("div",{children:[m.jsx("h3",{className:dt("text-lg font-medium",i),children:e}),t&&m.jsx("p",{className:dt("text-sm text-muted-foreground",s),children:t})]}),m.jsx("div",{className:dt(a),children:n})]}),qQe=L.object({gitUserName:L.string().min(1,"User name cannot be empty."),gitUserEmail:L.string().email("Invalid email address.")});function Gq({field:e}){return m.jsx(m.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?m.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const VQe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=dr(Cn(s=>({gitUserName:s.gitUserName,setGitUserName:s.setGitUserName,gitUserEmail:s.gitUserEmail,setGitUserEmail:s.setGitUserEmail}))),i=Vs({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:qQe},onSubmit:async({value:s})=>{try{t(s.gitUserName),r(s.gitUserEmail),Fe.success("Git user configuration updated!")}catch(a){Fe.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return A.useEffect(()=>{i.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,i]),m.jsx("div",{className:"space-y-4 p-1",children:m.jsx(Av,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:m.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),i.handleSubmit()},className:"space-y-3",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsx(i.Field,{name:"gitUserName",children:s=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:s.name,children:"Git User Name"}),m.jsx(ur,{id:s.name,value:s.state.value,onBlur:s.handleBlur,onChange:a=>s.handleChange(a.target.value),placeholder:"Your Name",className:s.state.meta.errors.length?"border-destructive":""}),m.jsx(Gq,{field:s})]})}),m.jsx(i.Field,{name:"gitUserEmail",children:s=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:s.name,children:"Git User Email"}),m.jsx(ur,{id:s.name,type:"email",value:s.state.value,onBlur:s.handleBlur,onChange:a=>s.handleChange(a.target.value),placeholder:"your.email@example.com",className:s.state.meta.errors.length?"border-destructive":""}),m.jsx(Gq,{field:s})]})})]}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(i.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting,s.isValidating,s.isValid],children:([s,a,o,l])=>m.jsx(Et,{type:"submit",size:"sm",disabled:!s||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},HQe=ut.memo(VQe),WQe=Z4("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Vle({className:e,variant:t,...n}){return m.jsx("div",{"data-slot":"alert",role:"alert",className:dt(WQe({variant:t}),e),...n})}function Hle({className:e,...t}){return m.jsx("div",{"data-slot":"alert-title",className:dt("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function Wle({className:e,...t}){return m.jsx("div",{"data-slot":"alert-description",className:dt("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var GQe="Separator",Kq="horizontal",KQe=["horizontal","vertical"],Gle=A.forwardRef((e,t)=>{const{decorative:n,orientation:r=Kq,...i}=e,s=YQe(r)?r:Kq,o=n?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return m.jsx(pn.div,{"data-orientation":s,...o,...i,ref:t})});Gle.displayName=GQe;function YQe(e){return KQe.includes(e)}var ZQe=Gle;function _d({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return m.jsx(ZQe,{"data-slot":"separator-root",decorative:n,orientation:t,className:dt("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const XQe=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:i=!1,totalRepos:s,totalConversations:a,pendingConversations:o})=>{const[l,c]=A.useState(null),[u,d]=A.useState(!1);A.useEffect(()=>{const S=R=>{R&&R.progress&&(c(R.progress),d(!0))},C=R=>{R&&R.progress&&c(R.progress)},E=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},2e3))},T=R=>{R&&R.progress&&(c(R.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Be.on(ei.bulkSyncStarted,S),Be.on(ei.bulkSyncProgress,C),Be.on(ei.bulkSyncCompleted,E),Be.on(ei.bulkSyncFailed,T),()=>{Be.off(ei.bulkSyncStarted,S),Be.off(ei.bulkSyncProgress,C),Be.off(ei.bulkSyncCompleted,E),Be.off(ei.bulkSyncFailed,T)}},[]);const h=i||u,p=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},x=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},w=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},_=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return m.jsxs(VD,{className:"w-full",children:[m.jsxs(HD,{className:"pb-3",children:[m.jsxs(WD,{className:"flex items-center gap-2",children:[m.jsx(rc,{className:"h-5 w-5"}),"Bulk Git Sync"]}),m.jsx(Vre,{children:"Manage synchronization across all repositories and conversations"})]}),m.jsxs(GD,{className:"space-y-4",children:[m.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"font-medium text-lg",children:s}),m.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"font-medium text-lg",children:a}),m.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:dt("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),m.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),m.jsx(_d,{}),l&&m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between text-sm",children:[m.jsx("span",{className:"font-medium",children:"Current Operation"}),m.jsx(If,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),m.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Repository Progress"}),m.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),m.jsx(yw,{value:p,className:"h-2"})]}),l.totalConversations>0&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"flex justify-between text-sm",children:[m.jsx("span",{children:"Conversation Progress"}),m.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),m.jsx(yw,{value:y,className:"h-2"})]}),l.errors.length>0&&m.jsxs("div",{className:"mt-2",children:[m.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[m.jsx(nc,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),m.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,C)=>m.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[m.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},C)),l.errors.length>5&&m.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),m.jsx(_d,{}),m.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[m.jsx(hr,{children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs(Et,{onClick:w,disabled:h||s===0,variant:"outline",size:"sm",className:"w-full",children:[m.jsx(Gc,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),m.jsx(yr,{children:"Initialize/clone all configured repositories"})]})}),m.jsx(hr,{children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs(Et,{onClick:x,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[m.jsx(YV,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),m.jsx(yr,{children:"Sync only conversations that need syncing"})]})}),m.jsx(hr,{children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs(Et,{onClick:b,disabled:h||s===0&&a===0,size:"sm",className:"w-full",children:[m.jsx(Ap,{className:dt("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),m.jsx(yr,{children:"Sync all repositories and conversations"})]})}),m.jsxs(Et,{onClick:_,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[m.jsx(wfe,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},JQe=L.object({name:L.string().min(1,"Repository Name is required."),remoteUrl:L.string().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:L.string().min(1,"Branch name is required (e.g., main)."),username:L.string().nullable().optional(),password:L.string().nullable().optional()}),qS={name:"",remoteUrl:"",branch:"main",username:null,password:null},QQe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:i}=Dn(Cn(C=>({syncRepos:C.syncRepos,addSyncRepo:C.addSyncRepo,updateSyncRepo:C.updateSyncRepo,repoInitializationStatus:C.repoInitializationStatus,isLoading:C.isLoading}))),{autoSyncOnStreamComplete:s,setAutoSyncOnStreamComplete:a}=dr(Cn(C=>({autoSyncOnStreamComplete:C.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:C.setAutoSyncOnStreamComplete}))),[o,l]=A.useState(!1),[c,u]=A.useState(null),[d,h]=A.useState({});A.useEffect(()=>{const C=E=>{E&&E.action==="deleted"&&E.repoId&&h(T=>({...T,[E.repoId]:!1}))};return Be.on(ei.repoChanged,C),()=>Be.off(ei.repoChanged,C)},[]);const p=Vs({defaultValues:qS,validators:{onChangeAsync:JQe,onChangeAsyncDebounceMs:500},onSubmit:async({value:C})=>{var E,T,R,M;if(!((E=C.name)!=null&&E.trim())||!((T=C.remoteUrl)!=null&&T.trim())){Fe.error("Repository Name and Remote URL are required.");return}try{const N={name:C.name.trim(),remoteUrl:C.remoteUrl.trim(),branch:((R=C.branch)==null?void 0:R.trim())||"main",username:((M=C.username)==null?void 0:M.trim())||null,password:C.password||null};c?await n(c,N):await t(N),y()}catch(N){console.error("Failed to save sync repo:",N)}}}),y=A.useCallback(()=>{p.reset(qS),l(!1),u(null)},[p]);A.useEffect(()=>{if(c){const C=e.find(E=>E.id===c);C?(p.reset({name:C.name,remoteUrl:C.remoteUrl,branch:C.branch||"main",username:C.username??null,password:C.password??null}),l(!1)):y()}else o||p.reset(qS)},[c,e,p,o,y]);const b=C=>{u(C.id),l(!1)},x=A.useCallback((C,E)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${E}"? This will unlink it from any conversations and remove the local copy.`)){h(T=>({...T,[C]:!0}));try{Be.emit(Un.deleteSyncRepoRequest,{id:C}),c===C&&y()}catch(T){console.error("Failed to delete sync repo:",T),h(R=>({...R,[C]:!1}))}}},[c,y]),w=A.useCallback(C=>{Be.emit(Un.initializeOrSyncRepoRequest,{repoId:C})},[]),_=()=>{u(null),p.reset(qS),l(!0)},S=()=>m.jsxs("form",{onSubmit:C=>{C.preventDefault(),C.stopPropagation(),p.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[m.jsx(p.Field,{name:"name",children:C=>m.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[m.jsx(Jt,{htmlFor:C.name,children:"Name"}),m.jsx(ur,{id:C.name,value:C.state.value??"",onChange:E=>C.handleChange(E.target.value),onBlur:C.handleBlur,placeholder:"e.g., My Backup",disabled:p.state.isSubmitting}),m.jsx(ps,{field:C})]})}),m.jsx(p.Field,{name:"remoteUrl",children:C=>m.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[m.jsx(Jt,{htmlFor:C.name,children:"Remote URL (HTTPS)"}),m.jsx(ur,{id:C.name,type:"url",value:C.state.value??"",onChange:E=>C.handleChange(E.target.value),onBlur:C.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:p.state.isSubmitting}),m.jsx(ps,{field:C})]})}),m.jsx(p.Field,{name:"branch",children:C=>m.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[m.jsx(Jt,{htmlFor:C.name,children:"Branch"}),m.jsx(ur,{id:C.name,value:C.state.value??"",onChange:E=>C.handleChange(E.target.value),onBlur:C.handleBlur,placeholder:"main",disabled:p.state.isSubmitting}),m.jsx(ps,{field:C})]})})]}),m.jsxs("div",{className:"pt-2",children:[m.jsx(Jt,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),m.jsxs(Vle,{variant:"destructive",className:"mt-2 mb-3",children:[m.jsx(iO,{className:"h-4 w-4"}),m.jsx(Hle,{children:"Security Warning"}),m.jsx(Wle,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[m.jsx(p.Field,{name:"username",children:C=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:C.name,children:"Username"}),m.jsx(ur,{id:C.name,value:C.state.value??"",onChange:E=>C.handleChange(E.target.value),onBlur:C.handleBlur,placeholder:"Git Username (Optional)",disabled:p.state.isSubmitting,autoComplete:"off"}),m.jsx(ps,{field:C})]})}),m.jsx(p.Field,{name:"password",children:C=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:C.name,children:"Password / Token"}),m.jsx(ur,{id:C.name,type:"password",value:C.state.value??"",onChange:E=>C.handleChange(E.target.value),onBlur:C.handleBlur,placeholder:"Password or PAT (Optional)",disabled:p.state.isSubmitting,autoComplete:"new-password"}),m.jsx(ps,{field:C})]})})]})]}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Et,{variant:"ghost",size:"sm",onClick:y,disabled:p.state.isSubmitting,type:"button",children:[m.jsx(po,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsx(p.Subscribe,{selector:C=>[C.canSubmit,C.isSubmitting,C.isValidating,C.isValid],children:([C,E,T,R])=>m.jsxs(Et,{variant:"secondary",size:"sm",type:"submit",disabled:E||!C||!R||T,children:[(E||T)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"})," ",E||T?"Saving...":"Save Repository"]})})]})]});return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),m.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx(Jt,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),m.jsx(Qc,{id:"auto-sync-toggle",checked:s,onCheckedChange:a})]}),m.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[m.jsxs("div",{className:"space-y-1",children:[m.jsx(Jt,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),m.jsx(Qc,{id:"auto-init-repos-toggle",checked:dr(C=>C.autoInitializeReposOnStartup),onCheckedChange:dr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&m.jsx(XQe,{onSyncAll:async()=>{await Dn.getState().syncAllConversations()},onSyncPending:async()=>{await Dn.getState().syncPendingConversations()},onInitializeRepos:async()=>{await Dn.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:C}=await zr(async()=>{const{BulkSyncService:E}=await Promise.resolve().then(()=>Zg);return{BulkSyncService:E}},void 0);C.abort()},totalRepos:e.length,totalConversations:Dn.getState().conversations.filter(C=>C.syncRepoId).length,pendingConversations:Dn.getState().conversations.filter(C=>{const E=Dn.getState().conversationSyncStatus[C.id];return C.syncRepoId&&E==="needs-sync"}).length})]}),!o&&!c&&m.jsxs(Et,{onClick:_,variant:"outline",className:"w-full mb-4",disabled:i,children:[m.jsx(W0,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),m.jsxs("div",{children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),i&&!o&&!c?m.jsxs("div",{className:"space-y-2",children:[m.jsx(Pr,{className:"h-10 w-full"}),m.jsx(Pr,{className:"h-10 w-full"}),m.jsx(Pr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):m.jsx("div",{className:"border rounded-md overflow-x-auto",children:m.jsxs(hm,{children:[m.jsx(jy,{children:m.jsxs(Pi,{children:[m.jsx(pi,{children:"Name"}),m.jsx(pi,{className:"hidden md:table-cell",children:"Remote URL"}),m.jsx(pi,{className:"hidden lg:table-cell",children:"Branch"}),m.jsx(pi,{className:"hidden lg:table-cell",children:"Auth"}),m.jsx(pi,{className:"text-right",children:"Actions"})]})}),m.jsx(pm,{children:e.map(C=>{const E=d[C.id],T=c===C.id,R=!!C.username||!!C.password,M=r[C.id]||"idle",N=M==="syncing",O=E||p.state.isSubmitting||!!c||N;let B=null,P="Initialize/Sync Repository";return M==="syncing"?(B=m.jsx(Hn,{className:"h-4 w-4 animate-spin mr-1"}),P="Initializing/Syncing..."):M==="idle"?(B=m.jsx(Dk,{className:"h-4 w-4 text-green-500 mr-1"}),P="Sync Successful / Ready"):M==="error"?(B=m.jsx(nc,{className:"h-4 w-4 text-destructive mr-1"}),P="Sync Failed"):B=m.jsx(Ap,{className:"h-4 w-4 mr-1"}),m.jsxs(Pi,{className:dt(T?"bg-muted/50":"",O&&!T?"opacity-70":""),children:[m.jsx(cr,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:C.name}),m.jsx(cr,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:C.remoteUrl}),m.jsx(cr,{className:"hidden lg:table-cell",children:C.branch||"main"}),m.jsx(cr,{className:"text-xs hidden lg:table-cell",children:R?"Configured":"None"}),m.jsxs(cr,{className:"text-right space-x-1",children:[m.jsx(Rn,{tooltipText:P,onClick:()=>w(C.id),"aria-label":`Initialize or Sync repo ${C.name}`,disabled:O,icon:B,variant:"outline",className:"h-8 w-8"}),m.jsx(Rn,{tooltipText:"Edit",onClick:()=>b(C),"aria-label":`Edit repo ${C.name}`,disabled:O,icon:m.jsx(Tw,{}),className:"h-8 w-8"}),m.jsx(Rn,{tooltipText:"Delete",onClick:()=>x(C.id,C.name),"aria-label":`Delete repo ${C.name}`,disabled:O,icon:E?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Fo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},C.id)})})]})})]})]})},eet=ut.memo(QQe),tet=()=>{const e=A.useMemo(()=>[{value:"config",label:"User Config",content:m.jsx(HQe,{})},{value:"sync",label:"Sync Repositories",content:m.jsx(eet,{})}],[]);return m.jsx(Md,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},net=ut.memo(tet);class ret{constructor(){_e(this,"id","core-git-sync");_e(this,"unregisterPromptControlCallback",null);_e(this,"unregisterSettingsTabCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"selectedItemId",null);_e(this,"selectedItemType",null);_e(this,"syncRepos",[]);_e(this,"conversationSyncStatus",{});_e(this,"isStreaming",!1);_e(this,"autoSyncEnabled",!1);_e(this,"isBulkSyncing",!1);_e(this,"bulkSyncProgress",null);_e(this,"notifyComponentUpdate",null);_e(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Un.linkConversationToRepoRequest,{conversationId:t,repoId:n})});_e(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(Un.syncConversationRequest,{conversationId:t})});_e(this,"getConversationById",t=>Dn.getState().getConversationById(t));_e(this,"syncAllConversations",async()=>{await Dn.getState().syncAllConversations()});_e(this,"syncPendingConversations",async()=>{await Dn.getState().syncPendingConversations()});_e(this,"initializeAllRepositories",async()=>{await Dn.getState().initializeAllRepositories()});_e(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await zr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>Zg);return{BulkSyncService:n}},void 0);t.abort()});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(kr.contextChanged,p=>{var y;this.selectedItemId=p.selectedItemId,this.selectedItemType=p.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(ei.repoChanged,()=>{var p;this.syncRepos=Dn.getState().syncRepos,(p=this.notifyComponentUpdate)==null||p.call(this)}),i=t.on(Un.conversationSyncStatusChanged,p=>{var y;typeof p=="object"&&p&&"conversationId"in p&&"status"in p&&(this.conversationSyncStatus={...this.conversationSyncStatus,[p.conversationId]:p.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),s=t.on(Xn.statusChanged,p=>{var y;typeof p=="object"&&p&&"status"in p&&(this.isStreaming=p.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(Xn.completed,async p=>{typeof p=="object"&&p&&"interactionId"in p&&"status"in p&&p.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(nn.autoSyncOnStreamCompleteChanged,p=>{var y;typeof p=="object"&&p&&"enabled"in p&&(this.autoSyncEnabled=p.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(ei.bulkSyncStarted,p=>{var y;typeof p=="object"&&p&&"progress"in p&&(this.isBulkSyncing=!0,this.bulkSyncProgress=p.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(ei.bulkSyncProgress,p=>{var y;typeof p=="object"&&p&&"progress"in p&&(this.bulkSyncProgress=p.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(ei.bulkSyncCompleted,p=>{var y;typeof p=="object"&&p&&"progress"in p&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(ei.bulkSyncFailed,p=>{var y;typeof p=="object"&&p&&"progress"in p&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(Un.conversationUpdated,p=>{var y;typeof p=="object"&&p&&"conversationId"in p&&"updates"in p&&p.conversationId===this.selectedItemId&&p.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,i,s,a,o,l,c,u,d,h)}loadInitialState(){const t=Dn.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=On.getState().status==="streaming",this.autoSyncEnabled=dr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>ut.createElement(UQe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:net,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const iet=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=Dn(Cn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),i=()=>{e.syncAllRepos()},s=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return m.jsx(hr,{delayDuration:100,children:m.jsxs(Al,{children:[m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(rc,{className:"h-4 w-4"})})})}),m.jsx(yr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),m.jsx(Il,{className:"w-80 p-4",align:"start",children:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:i,disabled:!o||a||l,className:"h-8",children:[a||l?m.jsx(Hn,{className:"h-3 w-3 mr-1 animate-spin"}):m.jsx(Ap,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?m.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return m.jsxs("div",{className:dt("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[m.jsxs("div",{className:"min-w-0 flex-1",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),m.jsx(If,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),m.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),m.jsx(Et,{variant:"ghost",size:"sm",onClick:()=>s(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?m.jsx(Hn,{className:"h-3 w-3 animate-spin"}):m.jsx(Ap,{className:"h-3 w-3"})})]},c.id)})}):m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings  Git  Sync Repositories to add one."})]})})]})})};class set{constructor(){_e(this,"id","core-manual-git-sync-sidebar");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"syncRepos",[]);_e(this,"repoInitializationStatus",{});_e(this,"isSyncing",!1);_e(this,"notifyComponentUpdate",null);_e(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await zr(async()=>{const{BulkSyncService:i}=await Promise.resolve().then(()=>Zg);return{BulkSyncService:i}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});_e(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(i=>i.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(Un.initializeOrSyncRepoRequest,{repoId:t})});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(ei.repoChanged,()=>{var s;this.syncRepos=Dn.getState().syncRepos,(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(ei.repoInitStatusChanged,s=>{var a;typeof s=="object"&&s&&"repoId"in s&&"status"in s&&(this.repoInitializationStatus={...this.repoInitializationStatus,[s.repoId]:s.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),i=t.on(Un.syncReposLoaded,()=>{var s;this.loadInitialState(),(s=this.notifyComponentUpdate)==null||s.call(this)});this.eventUnsubscribers.push(n,r,i)}loadInitialState(){const t=Dn.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>ut.createElement(iet,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const aet=L.object({path:L.string().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),oet=L.object({path:L.string().describe("The path of the file to read within the VFS."),encoding:L.enum(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),cet=L.object({path:L.string().describe("The path where the file should be written."),content:L.string().describe("The content to write to the file."),encoding:L.enum(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),uet=L.object({path:L.string().describe("The path of the file or directory to delete."),recursive:L.boolean().optional().default(!1).describe("Whether to delete directories recursively.")}),det=L.object({path:L.string().describe("The path of the directory to create (including parents).")}),fet=L.object({oldPath:L.string().describe("The current path of the item to rename."),newName:L.string().describe("The new name for the item.")});class het{constructor(){_e(this,"id","core-vfs-tools");_e(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:aet};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=jr(l||"/");try{const h=await yP(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(p=>({name:p.name,type:p.isDirectory?"folder":"file",size:p.size,lastModified:p.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:oet};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=jr(l);try{const p=await yh(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...p)):y=new TextDecoder().decode(p),{success:!0,path:h,content:y,encoding:c}}catch(p){return{success:!1,path:h,error:p.message}}}));const i={description:"Write content to a file in the VFS.",parameters:cet};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",i,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const p=jr(l);try{let y;if(u==="base64"){const b=atob(c),x=b.length,w=new Uint8Array(x);for(let _=0;_<x;_++)w[_]=b.charCodeAt(_);y=w}else y=c;return await IE(p,y,{fsInstance:h}),{success:!0,path:p}}catch(y){return{success:!1,path:p,error:y.message}}}));const s={description:"Delete a file or directory from the VFS.",parameters:uet};this.unregisterCallbacks.push(t.registerTool("vfsDelete",s,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=jr(l);try{return await bP(h,c,{fsInstance:d}),{success:!0,path:h}}catch(p){return{success:!1,path:h,error:p.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:det};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=jr(l);try{return await jY(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:fet};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=jr(l),p=jr(h.substring(0,h.lastIndexOf("/"))||"/"),y=iu(p,c);try{return await PY(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const pet=L.object({path:L.string().describe("The directory path within the VFS to initialize as a Git repository.")}),met=L.object({path:L.string().describe("The directory path of the Git repository within the VFS to commit."),message:L.string().describe("The commit message.")}),get=L.object({path:L.string().describe("The directory path of the Git repository within the VFS to pull from."),branch:L.string().optional().describe("The branch name to pull.")}),yet=L.object({path:L.string().describe("The directory path of the Git repository within the VFS to push."),branch:L.string().optional().describe("The branch name to push.")}),bet=L.object({path:L.string().describe("The directory path of the Git repository within the VFS to check status.")});class vet{constructor(){_e(this,"id","core-git-tools");_e(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:pet};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await MY(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:met};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=dr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await mP(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const i={description:"Pull changes from the remote repository for the specified branch.",parameters:get};this.unregisterCallbacks.push(t.registerTool("gitPull",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await RE(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const s={description:"Push committed changes from the local branch to the remote repository.",parameters:yet};this.unregisterCallbacks.push(t.registerTool("gitPush",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await gP(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:bet};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await NY(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const xet=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const i=e.getEnabledTools(),s=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=Ho(_=>_.tools),[c,u]=A.useState(""),d=A.useMemo(()=>Object.entries(l).map(([_,{definition:S,modId:C}])=>({name:_,description:S.description??"No description provided.",modId:C})).sort((_,S)=>_.name.localeCompare(S.name)),[l]),h=A.useMemo(()=>{const _=c.trim().toLowerCase();return _?d.filter(S=>S.name.toLowerCase().includes(_)||S.description.toLowerCase().includes(_)||S.modId.toLowerCase().includes(_)):d},[d,c]),p=A.useCallback((_,S)=>{e.setEnabledTools(C=>{const E=new Set(C);return S?E.add(_):E.delete(_),E})},[e]),y=A.useCallback(_=>{e.setEnabledTools(()=>_?new Set(d.map(S=>S.name)):new Set)},[d,e]),b=_=>{const S=_.target.value;if(S===""){n(null);return}const C=parseInt(S,10);if(isNaN(C))n(null);else{const E=Math.max(1,Math.min(20,C));n(E)}},x=t===null?"":String(t),w=a!=="conversation"||!s;return m.jsxs("div",{className:dt("p-4 h-[28rem] max-w-2xl space-y-3",r),children:[m.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),m.jsxs("div",{className:"relative",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter tools...",value:c,onChange:_=>u(_.target.value),className:"pl-8 h-9",disabled:w})]}),m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs(Jt,{className:"text-xs text-muted-foreground",children:[h.length," tools shown (",i.size," enabled)"]}),m.jsxs("div",{className:"space-x-2",children:[m.jsx(Et,{variant:"outline",size:"sm",onClick:()=>y(!0),disabled:w||d.length===0,children:"Enable All"}),m.jsx(Et,{variant:"outline",size:"sm",onClick:()=>y(!1),disabled:w||d.length===0||i.size===0,children:"Disable All"})]})]}),m.jsx(Sa,{className:"h-56 border rounded-md p-2 bg-background/50",children:w?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Select a conversation to manage tools."}):d.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):h.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):m.jsx("div",{className:"space-y-1",children:h.map(_=>m.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[m.jsx(Qc,{id:`tool-switch-${_.name}`,checked:i.has(_.name),onCheckedChange:S=>p(_.name,S),className:"flex-shrink-0",disabled:w}),m.jsxs(Jt,{htmlFor:`tool-switch-${_.name}`,className:dt("text-sm font-normal flex-grow pl-2 space-y-0.5",w?"cursor-not-allowed":"cursor-pointer"),title:`${_.name} (from ${_.modId})`,children:[m.jsx("span",{className:"block font-medium",children:_.name}),m.jsx("span",{className:"block text-xs text-muted-foreground break-words",children:_.description})]})]},_.name))})}),m.jsxs("div",{className:"pt-2",children:[m.jsx(Jt,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),m.jsx(ur,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:x,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o??5),disabled:w}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},wet=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=A.useState(!1),[i,s]=A.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();A.useEffect(()=>{s(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=p=>{r(p),!p&&i!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(i)},d=a.size>0||o!==null,h=l;return c?m.jsxs(Al,{open:n,onOpenChange:u,children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:m.jsx(Rp,{className:"h-4 w-4"})})})}),m.jsx(yr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),m.jsx(Il,{className:"w-auto p-0",align:"start",children:m.jsx(xet,{module:e,popoverMaxSteps:i,setPopoverMaxSteps:s})})]}):null};class _et{constructor(){_e(this,"id","core-tool-selector");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"transientEnabledTools",new Set);_e(this,"transientMaxStepsOverride",null);_e(this,"isStreaming",!1);_e(this,"isVisible",!0);_e(this,"selectedItemId",null);_e(this,"selectedItemType",null);_e(this,"allToolsCount",0);_e(this,"globalDefaultMaxSteps",5);_e(this,"notifyComponentUpdate",null);_e(this,"getEnabledTools",()=>this.transientEnabledTools);_e(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getIsVisible",()=>this.isVisible);_e(this,"getSelectedItemId",()=>this.selectedItemId);_e(this,"getSelectedItemType",()=>this.selectedItemType);_e(this,"getAllToolsCount",()=>this.allToolsCount);_e(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);_e(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});_e(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(Xn.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(ir.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),i=t.on(kr.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),s=t.on(nn.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on(Nr.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,i,s,a)}loadInitialState(){this.isStreaming=On.getState().status==="streaming",this.selectedItemId=Dn.getState().selectedItemId,this.selectedItemType=Dn.getState().selectedItemType,this.allToolsCount=Object.keys(Ho.getState().tools).length,this.globalDefaultMaxSteps=dr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Er.getState(),n=t(),r=this.allToolsCount>0,i=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,s=r&&i;this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>ut.createElement(wet,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var Yq=1,Cet=.9,ket=.8,Eet=.17,XN=.1,JN=.999,Tet=.9999,Aet=.99,Ret=/[\\\/_+.#"@\[\(\{&]/,Iet=/[\\\/_+.#"@\[\(\{&]/g,Met=/[\s-]/,Kle=/[\s-]/g;function q4(e,t,n,r,i,s,a){if(s===t.length)return i===e.length?Yq:Aet;var o=`${i},${s}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(s),c=n.indexOf(l,i),u=0,d,h,p,y;c>=0;)d=q4(e,t,n,r,c+1,s+1,a),d>u&&(c===i?d*=Yq:Ret.test(e.charAt(c-1))?(d*=ket,p=e.slice(i,c-1).match(Iet),p&&i>0&&(d*=Math.pow(JN,p.length))):Met.test(e.charAt(c-1))?(d*=Cet,y=e.slice(i,c-1).match(Kle),y&&i>0&&(d*=Math.pow(JN,y.length))):(d*=Eet,i>0&&(d*=Math.pow(JN,c-i))),e.charAt(c)!==t.charAt(s)&&(d*=Tet)),(d<XN&&n.charAt(c-1)===r.charAt(s+1)||r.charAt(s+1)===r.charAt(s)&&n.charAt(c-1)!==r.charAt(s))&&(h=q4(e,t,n,r,c+1,s+2,a),h*XN>d&&(d=h*XN)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function Zq(e){return e.toLowerCase().replace(Kle," ")}function Net(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,q4(e,t,Zq(e),Zq(t),0,0,{})}var dv='[cmdk-group=""]',QN='[cmdk-group-items=""]',jet='[cmdk-group-heading=""]',Yle='[cmdk-item=""]',Xq=`${Yle}:not([aria-disabled="true"])`,V4="cmdk-item-select",Cg="data-value",Oet=(e,t,n)=>Net(e,t,n),Zle=A.createContext(void 0),O1=()=>A.useContext(Zle),Xle=A.createContext(void 0),Y6=()=>A.useContext(Xle),Jle=A.createContext(void 0),Qle=A.forwardRef((e,t)=>{let n=kg(()=>{var te,se;return{search:"",value:(se=(te=e.value)!=null?te:e.defaultValue)!=null?se:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=kg(()=>new Set),i=kg(()=>new Map),s=kg(()=>new Map),a=kg(()=>new Set),o=ece(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:p,loop:y,disablePointerSelection:b=!1,vimBindings:x=!0,...w}=e,_=Bs(),S=Bs(),C=Bs(),E=A.useRef(null),T=Het();Gp(()=>{if(u!==void 0){let te=u.trim();n.current.value=te,R.emit()}},[u]),Gp(()=>{T(6,H)},[]);let R=A.useMemo(()=>({subscribe:te=>(a.current.add(te),()=>a.current.delete(te)),snapshot:()=>n.current,setState:(te,se,pe)=>{var de,Ne,Pe,Me;if(!Object.is(n.current[te],se)){if(n.current[te]=se,te==="search")P(),O(),T(1,B);else if(te==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ee=document.getElementById(C);Ee?Ee.focus():(de=document.getElementById(_))==null||de.focus()}if(T(7,()=>{var Ee;n.current.selectedItemId=(Ee=F())==null?void 0:Ee.id,R.emit()}),pe||T(5,H),((Ne=o.current)==null?void 0:Ne.value)!==void 0){let Ee=se??"";(Me=(Pe=o.current).onValueChange)==null||Me.call(Pe,Ee);return}}R.emit()}},emit:()=>{a.current.forEach(te=>te())}}),[]),M=A.useMemo(()=>({value:(te,se,pe)=>{var de;se!==((de=s.current.get(te))==null?void 0:de.value)&&(s.current.set(te,{value:se,keywords:pe}),n.current.filtered.items.set(te,N(se,pe)),T(2,()=>{O(),R.emit()}))},item:(te,se)=>(r.current.add(te),se&&(i.current.has(se)?i.current.get(se).add(te):i.current.set(se,new Set([te]))),T(3,()=>{P(),O(),n.current.value||B(),R.emit()}),()=>{s.current.delete(te),r.current.delete(te),n.current.filtered.items.delete(te);let pe=F();T(4,()=>{P(),(pe==null?void 0:pe.getAttribute("id"))===te&&B(),R.emit()})}),group:te=>(i.current.has(te)||i.current.set(te,new Set),()=>{s.current.delete(te),i.current.delete(te)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:_,inputId:C,labelId:S,listInnerRef:E}),[]);function N(te,se){var pe,de;let Ne=(de=(pe=o.current)==null?void 0:pe.filter)!=null?de:Oet;return te?Ne(te,n.current.search,se):0}function O(){if(!n.current.search||o.current.shouldFilter===!1)return;let te=n.current.filtered.items,se=[];n.current.filtered.groups.forEach(de=>{let Ne=i.current.get(de),Pe=0;Ne.forEach(Me=>{let Ee=te.get(Me);Pe=Math.max(Ee,Pe)}),se.push([de,Pe])});let pe=E.current;Q().sort((de,Ne)=>{var Pe,Me;let Ee=de.getAttribute("id"),Ue=Ne.getAttribute("id");return((Pe=te.get(Ue))!=null?Pe:0)-((Me=te.get(Ee))!=null?Me:0)}).forEach(de=>{let Ne=de.closest(QN);Ne?Ne.appendChild(de.parentElement===Ne?de:de.closest(`${QN} > *`)):pe.appendChild(de.parentElement===pe?de:de.closest(`${QN} > *`))}),se.sort((de,Ne)=>Ne[1]-de[1]).forEach(de=>{var Ne;let Pe=(Ne=E.current)==null?void 0:Ne.querySelector(`${dv}[${Cg}="${encodeURIComponent(de[0])}"]`);Pe==null||Pe.parentElement.appendChild(Pe)})}function B(){let te=Q().find(pe=>pe.getAttribute("aria-disabled")!=="true"),se=te==null?void 0:te.getAttribute(Cg);R.setState("value",se||void 0)}function P(){var te,se,pe,de;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Ne=0;for(let Pe of r.current){let Me=(se=(te=s.current.get(Pe))==null?void 0:te.value)!=null?se:"",Ee=(de=(pe=s.current.get(Pe))==null?void 0:pe.keywords)!=null?de:[],Ue=N(Me,Ee);n.current.filtered.items.set(Pe,Ue),Ue>0&&Ne++}for(let[Pe,Me]of i.current)for(let Ee of Me)if(n.current.filtered.items.get(Ee)>0){n.current.filtered.groups.add(Pe);break}n.current.filtered.count=Ne}function H(){var te,se,pe;let de=F();de&&(((te=de.parentElement)==null?void 0:te.firstChild)===de&&((pe=(se=de.closest(dv))==null?void 0:se.querySelector(jet))==null||pe.scrollIntoView({block:"nearest"})),de.scrollIntoView({block:"nearest"}))}function F(){var te;return(te=E.current)==null?void 0:te.querySelector(`${Yle}[aria-selected="true"]`)}function Q(){var te;return Array.from(((te=E.current)==null?void 0:te.querySelectorAll(Xq))||[])}function q(te){let se=Q()[te];se&&R.setState("value",se.getAttribute(Cg))}function K(te){var se;let pe=F(),de=Q(),Ne=de.findIndex(Me=>Me===pe),Pe=de[Ne+te];(se=o.current)!=null&&se.loop&&(Pe=Ne+te<0?de[de.length-1]:Ne+te===de.length?de[0]:de[Ne+te]),Pe&&R.setState("value",Pe.getAttribute(Cg))}function U(te){let se=F(),pe=se==null?void 0:se.closest(dv),de;for(;pe&&!de;)pe=te>0?qet(pe,dv):Vet(pe,dv),de=pe==null?void 0:pe.querySelector(Xq);de?R.setState("value",de.getAttribute(Cg)):K(te)}let re=()=>q(Q().length-1),G=te=>{te.preventDefault(),te.metaKey?re():te.altKey?U(1):K(1)},ne=te=>{te.preventDefault(),te.metaKey?q(0):te.altKey?U(-1):K(-1)};return A.createElement(pn.div,{ref:t,tabIndex:-1,...w,"cmdk-root":"",onKeyDown:te=>{var se;(se=w.onKeyDown)==null||se.call(w,te);let pe=te.nativeEvent.isComposing||te.keyCode===229;if(!(te.defaultPrevented||pe))switch(te.key){case"n":case"j":{x&&te.ctrlKey&&G(te);break}case"ArrowDown":{G(te);break}case"p":case"k":{x&&te.ctrlKey&&ne(te);break}case"ArrowUp":{ne(te);break}case"Home":{te.preventDefault(),q(0);break}case"End":{te.preventDefault(),re();break}case"Enter":{te.preventDefault();let de=F();if(de){let Ne=new Event(V4);de.dispatchEvent(Ne)}}}}},A.createElement("label",{"cmdk-label":"",htmlFor:M.inputId,id:M.labelId,style:Get},l),$T(e,te=>A.createElement(Xle.Provider,{value:R},A.createElement(Zle.Provider,{value:M},te))))}),Pet=A.forwardRef((e,t)=>{var n,r;let i=Bs(),s=A.useRef(null),a=A.useContext(Jle),o=O1(),l=ece(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Gp(()=>{if(!c)return o.item(i,a==null?void 0:a.id)},[c]);let u=tce(i,s,[e.value,e.children,s],e.keywords),d=Y6(),h=ih(T=>T.value&&T.value===u.current),p=ih(T=>c||o.filter()===!1?!0:T.search?T.filtered.items.get(i)>0:!0);A.useEffect(()=>{let T=s.current;if(!(!T||e.disabled))return T.addEventListener(V4,y),()=>T.removeEventListener(V4,y)},[p,e.onSelect,e.disabled]);function y(){var T,R;b(),(R=(T=l.current).onSelect)==null||R.call(T,u.current)}function b(){d.setState("value",u.current,!0)}if(!p)return null;let{disabled:x,value:w,onSelect:_,forceMount:S,keywords:C,...E}=e;return A.createElement(pn.div,{ref:cd(s,t),...E,id:i,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!h,"data-disabled":!!x,"data-selected":!!h,onPointerMove:x||o.getDisablePointerSelection()?void 0:b,onClick:x?void 0:y},e.children)}),Det=A.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:i,...s}=e,a=Bs(),o=A.useRef(null),l=A.useRef(null),c=Bs(),u=O1(),d=ih(p=>i||u.filter()===!1?!0:p.search?p.filtered.groups.has(a):!0);Gp(()=>u.group(a),[]),tce(a,o,[e.value,e.heading,l]);let h=A.useMemo(()=>({id:a,forceMount:i}),[i]);return A.createElement(pn.div,{ref:cd(o,t),...s,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&A.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),$T(e,p=>A.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},A.createElement(Jle.Provider,{value:h},p))))}),Fet=A.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,i=A.useRef(null),s=ih(a=>!a.search);return!n&&!s?null:A.createElement(pn.div,{ref:cd(i,t),...r,"cmdk-separator":"",role:"separator"})}),Let=A.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,i=e.value!=null,s=Y6(),a=ih(c=>c.search),o=ih(c=>c.selectedItemId),l=O1();return A.useEffect(()=>{e.value!=null&&s.setState("search",e.value)},[e.value]),A.createElement(pn.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:i?e.value:a,onChange:c=>{i||s.setState("search",c.target.value),n==null||n(c.target.value)}})}),Bet=A.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...i}=e,s=A.useRef(null),a=A.useRef(null),o=ih(c=>c.selectedItemId),l=O1();return A.useEffect(()=>{if(a.current&&s.current){let c=a.current,u=s.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let p=c.offsetHeight;u.style.setProperty("--cmdk-list-height",p.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),A.createElement(pn.div,{ref:cd(s,t),...i,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},$T(e,c=>A.createElement("div",{ref:cd(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),$et=A.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:i,contentClassName:s,container:a,...o}=e;return A.createElement(Jae,{open:n,onOpenChange:r},A.createElement(Qae,{container:a},A.createElement(eoe,{"cmdk-overlay":"",className:i}),A.createElement(toe,{"aria-label":e.label,"cmdk-dialog":"",className:s},A.createElement(Qle,{ref:t,...o}))))}),zet=A.forwardRef((e,t)=>ih(n=>n.filtered.count===0)?A.createElement(pn.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Uet=A.forwardRef((e,t)=>{let{progress:n,children:r,label:i="Loading...",...s}=e;return A.createElement(pn.div,{ref:t,...s,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":i},$T(e,a=>A.createElement("div",{"aria-hidden":!0},a)))}),Oy=Object.assign(Qle,{List:Bet,Item:Pet,Input:Let,Group:Det,Separator:Fet,Dialog:$et,Empty:zet,Loading:Uet});function qet(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Vet(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function ece(e){let t=A.useRef(e);return Gp(()=>{t.current=e}),t}var Gp=typeof window>"u"?A.useEffect:A.useLayoutEffect;function kg(e){let t=A.useRef();return t.current===void 0&&(t.current=e()),t}function ih(e){let t=Y6(),n=()=>e(t.snapshot());return A.useSyncExternalStore(t.subscribe,n,n)}function tce(e,t,n,r=[]){let i=A.useRef(),s=O1();return Gp(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():i.current}})(),l=r.map(c=>c.trim());s.value(e,o,l),(a=t.current)==null||a.setAttribute(Cg,o),i.current=o}),i}var Het=()=>{let[e,t]=A.useState(),n=kg(()=>new Map);return Gp(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,i)=>{n.current.set(r,i),t({})}};function Wet(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function $T({asChild:e,children:t},n){return e&&A.isValidElement(t)?A.cloneElement(Wet(t),{ref:t.ref},n(t.props.children)):n(t)}var Get={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function nce({className:e,...t}){return m.jsx(Oy,{"data-slot":"command",className:dt("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function rce({className:e,...t}){return m.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[m.jsx(va,{className:"size-4 shrink-0 opacity-50"}),m.jsx(Oy.Input,{"data-slot":"command-input",className:dt("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function ice({className:e,...t}){return m.jsx(Oy.List,{"data-slot":"command-list",className:dt("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function sce({...e}){return m.jsx(Oy.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function ace({className:e,...t}){return m.jsx(Oy.Group,{"data-slot":"command-group",className:dt("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function oce({className:e,...t}){return m.jsx(Oy.Item,{"data-slot":"command-item",className:dt("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const Z6=({models:e,value:t,onChange:n,className:r,disabled:i,isLoading:s})=>{const[a,o]=A.useState(!1),[l,c]=A.useState(""),[u,d]=A.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=A.useMemo(()=>{let _=e;if(l.trim()){const C=l.toLowerCase();_=e.filter(E=>E.name.toLowerCase().includes(C)||E.providerName.toLowerCase().includes(C)||E.id.toLowerCase().includes(C))}const S=Object.entries(u).filter(([,C])=>C).map(([C])=>C);return S.length===0?_:_.filter(C=>{var M,N,O;const E=new Set(((M=C.metadataSummary)==null?void 0:M.supported_parameters)??[]),T=new Set(((N=C.metadataSummary)==null?void 0:N.input_modalities)??[]),R=new Set(((O=C.metadataSummary)==null?void 0:O.output_modalities)??[]);return S.every(B=>{switch(B){case"reasoning":return E.has("reasoning");case"webSearch":return E.has("web_search")||E.has("web_search_options");case"tools":return E.has("tools");case"multimodal":return Array.from(T).some(P=>P!=="text");case"imageGeneration":return R.has("image");default:return!0}})})},[e,l,u]),p=A.useMemo(()=>e.find(_=>_.id===t),[e,t]),y=A.useCallback(_=>{const S=_===t?null:_;n==null||n(S),o(!1),c("")},[t,n]),b=_=>{d(S=>({...S,[_]:!S[_]}))};if(s)return m.jsx(Pr,{className:dt("h-9 w-[250px]",r)});const w=Object.values(u).filter(Boolean).length;return m.jsxs(Al,{open:a,onOpenChange:o,children:[m.jsx(Rl,{asChild:!0,children:m.jsxs(Et,{variant:"outline",role:"combobox","aria-expanded":a,disabled:i||e.length===0,className:dt("w-auto justify-between h-9 text-sm font-normal relative",r),children:[m.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:p?`${p.name} (${p.providerName})`:"Select Model..."}),m.jsx(Pk,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),w>0&&m.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:w})]})}),m.jsx(Il,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden"},children:m.jsxs(nce,{shouldFilter:!1,children:[m.jsxs("div",{className:"flex items-center border-b px-3",children:[m.jsx(va,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),m.jsx(rce,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),m.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[m.jsx(Et,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:dt("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:m.jsx(gL,{className:"h-4 w-4"})}),m.jsx(Et,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:dt("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:m.jsx(bL,{className:"h-4 w-4"})}),m.jsx(Et,{variant:u.tools?"secondary":"ghost",size:"sm",className:dt("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:m.jsx(Rp,{className:"h-4 w-4"})}),m.jsx(Et,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:dt("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:m.jsx(Tp,{className:"h-4 w-4"})}),m.jsx(Et,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:dt("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:m.jsx(T2,{className:"h-4 w-4"})})]})]}),m.jsxs(ice,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[m.jsx(sce,{children:w>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),m.jsx(ace,{children:h.map(_=>{var S,C,E,T,R,M,N,O,B,P,H,F;return m.jsx(oce,{value:_.id,onSelect:y,className:"flex items-center",children:m.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsx("div",{className:"text-sm font-medium",children:_.name}),m.jsx("div",{className:"text-xs text-muted-foreground",children:_.providerName})]}),m.jsxs("div",{className:"flex gap-1 ml-2",children:[((C=(S=_.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:C.includes("reasoning"))&&m.jsx(gL,{className:"h-3.5 w-3.5 text-purple-500"}),(((T=(E=_.metadataSummary)==null?void 0:E.supported_parameters)==null?void 0:T.includes("web_search"))||((M=(R=_.metadataSummary)==null?void 0:R.supported_parameters)==null?void 0:M.includes("web_search_options")))&&m.jsx(bL,{className:"h-3.5 w-3.5 text-blue-500"}),((O=(N=_.metadataSummary)==null?void 0:N.supported_parameters)==null?void 0:O.includes("tools"))&&m.jsx(Rp,{className:"h-3.5 w-3.5 text-orange-500"}),((P=(B=_.metadataSummary)==null?void 0:B.input_modalities)==null?void 0:P.some(Q=>Q!=="text"))&&m.jsx(Tp,{className:"h-3.5 w-3.5 text-green-500"}),((F=(H=_.metadataSummary)==null?void 0:H.output_modalities)==null?void 0:F.includes("image"))&&m.jsx(T2,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},_.id)})})]})]})})]})},e3=L.object({systemPrompt:L.string().nullable(),modelId:L.string().nullable()}),Ket=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:i,isParentSaving:s=!1})=>{var u;const{getAvailableModelListItems:a}=Er(Cn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===i))==null?void 0:u.name)||i,c=Vs({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:e3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return A.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),m.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[m.jsx(c.Field,{name:"systemPrompt",validators:{onChange:e3.shape.systemPrompt},children:d=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),m.jsx(Id,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||s,className:"mt-1"}),m.jsx(ps,{field:d}),m.jsx(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||s||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),m.jsx(c.Field,{name:"modelId",validators:{onChange:e3.shape.modelId},children:d=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{children:"Default Model (Overrides Parent/Global)"}),m.jsx(Z6,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||s,className:"w-full mt-1"}),m.jsx(ps,{field:d}),m.jsxs(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||s||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,p,y])=>m.jsxs(Et,{type:"submit",size:"sm",disabled:s||!d||h||p||!y,children:[(h||p)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"}),h||p?"Saving...":"Save Prompt Settings"]})})})]})};function vg({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?m.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const Yet=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:i,effectiveTopK:s,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>m.jsxs("div",{className:"space-y-4",children:[m.jsx(e.Field,{name:"temperature",children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),m.jsx(Ev,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),m.jsxs(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),m.jsx(vg,{field:l})]})}),m.jsx(e.Field,{name:"topP",children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??i??1).toFixed(2),")"]}),m.jsx(Ev,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??i??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),m.jsxs(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(i==null?void 0:i.toFixed(2))??"N/A",")"]}),m.jsx(vg,{field:l})]})}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[m.jsx(e.Field,{name:"maxTokens",children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),m.jsx(ur,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),m.jsx(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),m.jsx(vg,{field:l})]})}),m.jsx(e.Field,{name:"topK",children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:l.name,className:"text-xs",children:"Top K"}),m.jsx(ur,{id:l.name,type:"number",placeholder:`Inherited: ${s??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),m.jsx(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),m.jsx(vg,{field:l})]})})]}),m.jsx(e.Field,{name:"presencePenalty",children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),m.jsx(Ev,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),m.jsxs(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),m.jsx(vg,{field:l})]})}),m.jsx(e.Field,{name:"frequencyPenalty",children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsxs(Jt,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),m.jsx(Ev,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),m.jsxs(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),m.jsx(vg,{field:l})]})})]}),Jq=L.object({syncRepoId:L.string().nullable()}),Zet=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:i=!1})=>{var o;const s=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=Vs({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:Jq,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return A.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),m.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[m.jsx(a.Field,{name:"syncRepoId",validators:{onChange:Jq.shape.syncRepoId},children:l=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),m.jsxs(k1,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||i||r.length===0,children:[m.jsx(T1,{id:l.name,children:m.jsx(E1,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${s}`})}),m.jsxs(A1,{children:[m.jsx(nh,{value:"none",children:m.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",s,")"]})}),r.map(c=>m.jsx(nh,{value:c.id,children:c.name},c.id))]})]}),m.jsx(ps,{field:l}),m.jsx(Et,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||i||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>m.jsxs(Et,{type:"submit",size:"sm",disabled:i||!l||c||u||!d||r.length===0,children:[(c||u)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},Xet=({projectId:e})=>{const t=A.useMemo(()=>[{value:"manage",label:"Manage Files",content:m.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?m.jsx(K6,{}):m.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsx(Jt,{children:"Project Filesystem Info"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),m.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",m.jsxs("p",{children:[m.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",m.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),m.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[m.jsx(Jt,{className:"text-destructive",children:"Danger Zone"}),m.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return m.jsx(Md,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:dt("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},Jet=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[i,s]=A.useState(""),a=A.useMemo(()=>{const o=i.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,i]);return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"relative",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter rules...",value:i,onChange:o=>s(o.target.value),className:"pl-8 h-9",disabled:r})]}),m.jsx(Sa,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):m.jsx("div",{className:"space-y-1",children:a.map(o=>m.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:m.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[m.jsx(ou,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),m.jsxs(Jt,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[m.jsx("span",{className:"block font-medium",children:o.name}),m.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),m.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},Qet=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const i=A.useMemo(()=>new Set(e??[]),[e]),s=A.useCallback((a,o)=>{const l=new Set(i);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[i,t]);return m.jsxs("div",{className:"space-y-4",children:[m.jsx(Jt,{children:"Default Rules for this Project"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),m.jsx(Jet,{allRules:r,selectedRuleIds:i,onSelectionChange:s,disabled:n})]})},ett=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:i})=>{const[s,a]=A.useState(""),o=A.useMemo(()=>{const l=s.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,s]);return m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"relative",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter tags...",value:s,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),m.jsx(Sa,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):m.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=i(l.id);return m.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:m.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[m.jsx(ou,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),m.jsxs(Jt,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[m.jsx("span",{className:"block font-medium",children:l.name}),l.description&&m.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&m.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},ttt=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:i})=>{const s=A.useMemo(()=>new Set(e??[]),[e]),a=A.useCallback((o,l)=>{const c=new Set(s);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[s,t]);return m.jsxs("div",{className:"space-y-4",children:[m.jsx(Jt,{children:"Default Tags for this Project"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),m.jsx(ett,{allTags:r,selectedTagIds:s,onSelectionChange:a,disabled:n,getRulesForTag:i})]})},ntt=L.object({temperature:L.number().min(0).max(1),topP:L.number().min(0).max(1),maxTokens:L.number().min(1).nullable(),topK:L.number().min(1).nullable(),presencePenalty:L.number().min(-2).max(2),frequencyPenalty:L.number().min(-2).max(2)}),rtt=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:i,updateProject:s}=bo(Cn(q=>({getProjectById:q.getProjectById,updateProject:q.updateProject}))),a=bo(q=>q.getEffectiveProjectSettings),o=Dn(q=>q.syncRepos),l=dr(Cn(q=>({globalSystemPrompt:q.globalSystemPrompt,temperature:q.temperature,maxTokens:q.maxTokens,topP:q.topP,topK:q.topK,presencePenalty:q.presencePenalty,frequencyPenalty:q.frequencyPenalty}))),c=Er(q=>q.selectedModelId),u=Bi(q=>q.setVfsKey),[d,h]=A.useState(null),[p,y]=A.useState(null),[b,x]=A.useState(null),[w,_]=A.useState(null),[S,C]=A.useState(null),[E,T]=A.useState(!1),[R,M]=A.useState("prompt"),{project:N,effectiveSettings:O}=A.useMemo(()=>{const q=n?i(n):null,K=n?a(n):null;return{project:q,effectiveSettings:K}},[n,i,a]),B=Vs({defaultValues:{temperature:(N==null?void 0:N.temperature)??.7,topP:(N==null?void 0:N.topP)??1,maxTokens:(N==null?void 0:N.maxTokens)??null,topK:(N==null?void 0:N.topK)??null,presencePenalty:(N==null?void 0:N.presencePenalty)??0,frequencyPenalty:(N==null?void 0:N.presencePenalty)??0},validators:{onChangeAsync:ntt,onChangeAsyncDebounceMs:500}}),P=A.useCallback(q=>{var U;if(!q)return null;const K=i(q);return K?((U=K.metadata)==null?void 0:U.syncRepoId)!==void 0?K.metadata.syncRepoId:P(K.parentId):null},[i]),H=n?P(n):null;A.useEffect(()=>{var q;e&&n&&N&&O?(u(n),h(N.systemPrompt??null),y(N.modelId??null),x(((q=N.metadata)==null?void 0:q.syncRepoId)??null),_(N.defaultTagIds??null),C(N.defaultRuleIds??null),B.reset({temperature:N.temperature??.7,topP:N.topP??1,maxTokens:N.maxTokens??null,topK:N.topK??null,presencePenalty:N.presencePenalty??0,frequencyPenalty:N.frequencyPenalty??0}),M("prompt")):e||(u(null),h(null),y(null),x(null),_(null),C(null),B.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,N,O,u,B]);const F=async()=>{if(!(!n||!N)){T(!0);try{const q=N.parentId?a(N.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},K=N.parentId?P(N.parentId):null,U={},re={...N.metadata??{}},G=B.state.values;d!==q.systemPrompt?U.systemPrompt=d:U.systemPrompt=void 0,p!==q.modelId?U.modelId=p:U.modelId=void 0,G.temperature!==q.temperature?U.temperature=G.temperature:U.temperature=void 0,G.maxTokens!==q.maxTokens?U.maxTokens=G.maxTokens:U.maxTokens=void 0,G.topP!==q.topP?U.topP=G.topP:U.topP=void 0,G.topK!==q.topK?U.topK=G.topK:U.topK=void 0,G.presencePenalty!==q.presencePenalty?U.presencePenalty=G.presencePenalty:U.presencePenalty=void 0,G.frequencyPenalty!==q.frequencyPenalty?U.frequencyPenalty=G.frequencyPenalty:U.frequencyPenalty=void 0,b!==K?re.syncRepoId=b:delete re.syncRepoId,JSON.stringify(w)!==JSON.stringify(q.defaultTagIds)?U.defaultTagIds=w:U.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(q.defaultRuleIds)?U.defaultRuleIds=S:U.defaultRuleIds=void 0,U.metadata=re,await s(n,U),Fe.success(`Project "${N.name}" settings updated.`),t()}catch(q){Fe.error("Failed to save project settings."),console.error("Failed to save project settings:",q)}finally{T(!1)}}},Q=A.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:m.jsx(Ket,{initialSystemPrompt:d,initialModelId:p,onSave:({systemPrompt:q,modelId:K})=>{h(q),y(K)},effectiveSystemPrompt:(O==null?void 0:O.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(O==null?void 0:O.modelId)??c,isParentSaving:E})},{value:"params",label:"Parameters",content:m.jsx(Yet,{form:B,effectiveTemperature:(O==null?void 0:O.temperature)??l.temperature,effectiveMaxTokens:(O==null?void 0:O.maxTokens)??l.maxTokens,effectiveTopP:(O==null?void 0:O.topP)??l.topP??1,effectiveTopK:(O==null?void 0:O.topK)??l.topK,effectivePresencePenalty:(O==null?void 0:O.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(O==null?void 0:O.frequencyPenalty)??l.frequencyPenalty??0,isSaving:E})},{value:"rules-tags",label:"Rules & Tags",content:m.jsxs("div",{className:"space-y-6",children:[m.jsx(Qet,{defaultRuleIds:S,setDefaultRuleIds:C,isSaving:E,allRules:r.getAllRules()}),m.jsx(ttt,{defaultTagIds:w,setDefaultTagIds:_,isSaving:E,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:m.jsx(Zet,{initialSyncRepoId:b,onSave:({syncRepoId:q})=>{x(q)},effectiveSyncRepoId:H,syncRepos:o,isParentSaving:E})},{value:"vfs",label:"Filesystem",content:m.jsx(Xet,{projectId:n,projectName:(N==null?void 0:N.name)??null,isSaving:E})}],[d,p,b,w,S,B,O,l,c,E,H,o,n,N==null?void 0:N.name,r]);return m.jsx(Ty,{open:e,onOpenChange:t,children:m.jsxs(Ay,{className:dt("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[m.jsxs(Ry,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[m.jsxs(My,{children:["Project Settings: ",N==null?void 0:N.name]}),m.jsx(I1,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),m.jsx(Md,{tabs:Q,initialValue:R,onValueChange:M,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),m.jsxs(Iy,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[m.jsx(Et,{variant:"outline",onClick:t,disabled:E,children:"Cancel"}),m.jsxs(Et,{onClick:F,disabled:E,children:[E&&m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class itt{constructor(){_e(this,"id","core-project-settings");_e(this,"modalId","projectSettingsModal");_e(this,"unregisterModalProviderCallback",null);_e(this,"modApiRef",null);_e(this,"eventUnsubscribers",[]);_e(this,"allRules",[]);_e(this,"allTags",[]);_e(this,"tagRuleLinks",[]);_e(this,"getAllRules",()=>this.allRules);_e(this,"getAllTags",()=>this.allTags);_e(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});_e(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(kr.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});_e(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(kr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(lr.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(i=>({tagId:i.tagId,ruleId:i.ruleId})))});this.eventUnsubscribers.push(n),t.emit(lr.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>ut.createElement(rtt,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const X6=ut.memo(({module:e,value:t,onChange:n,className:r,disabled:i})=>{const[,s]=A.useState({});A.useEffect(()=>{if(e)return e.setNotifyCallback(()=>s({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:i,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Er(h=>h.getGloballyEnabledModelDefinitions()),d=A.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return m.jsx(Z6,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});X6.displayName="GlobalModelSelector";class stt{constructor(){_e(this,"id","core-global-model-selector");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"selectedModelId",null);_e(this,"isStreaming",!1);_e(this,"isLoadingProviders",!0);_e(this,"globallyEnabledModels",[]);_e(this,"notifyComponentUpdate",null);_e(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(ir.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(Pn.setModelIdRequest,{id:t})});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Er.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=On.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(Xn.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),i=t.on(ir.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(Pn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(ir.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Er.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Er.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(Pn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(ir.initialDataLoaded,()=>{var u,d;const o=Er.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(Pn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,i,s,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>ut.createElement(X6,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const att=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=A.useState(!1),[i,s]=A.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();A.useEffect(()=>{n&&s(e.getTurnSystemPrompt())},[n,e]),A.useEffect(()=>{const p=e.getTurnSystemPrompt();i!==p&&s(p)},[e.getTurnSystemPrompt(),i]);const c=A.useCallback(()=>{e.setTurnSystemPrompt(i.trim()),r(!1)},[i,e]),u=A.useCallback(()=>{s(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=p=>{p&&s(e.getTurnSystemPrompt()),r(p)},h=l.trim().length>0;return m.jsxs(Al,{open:n,onOpenChange:d,children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:m.jsx(vpe,{className:"h-4 w-4"})})})}),m.jsx(yr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),m.jsxs(Il,{className:"w-80 p-4 space-y-3",align:"start",children:[m.jsx(Jt,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),m.jsx(Id,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:i,onChange:p=>s(p.target.value),rows:5,className:"text-sm"}),m.jsxs("div",{className:"flex justify-between",children:[m.jsx(Et,{variant:"outline",size:"sm",onClick:u,disabled:!i.trim(),children:"Clear Override"}),m.jsx(Et,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class ott{constructor(){_e(this,"id","core-system-prompt");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"turnSystemPromptValue","");_e(this,"effectiveSystemPrompt",null);_e(this,"isStreaming",!1);_e(this,"notifyComponentUpdate",null);_e(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);_e(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=On.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(kr.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(na.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(nn.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,i,s)}updateEffectivePrompt(){var a;const t=Dn.getState(),n=bo.getState(),r=dr.getState(),i=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,s=n.getEffectiveProjectSettings(i).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==s&&(this.effectiveSystemPrompt=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(att,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const ltt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,i]=A.useState(!1),[s,a]=A.useState(n??""),[o,l]=A.useState(""),[c,u]=A.useState([]),d=A.useCallback(()=>{try{JSON.parse(s),e.setStructuredOutputJson(s.trim()||null),i(!1),Fe.success("Structured output applied for next turn.")}catch{Fe.error("Invalid JSON format.")}},[s,e]),h=A.useCallback(()=>{a(""),e.setStructuredOutputJson(null),i(!1),Fe.info("Structured output cleared.")},[e]),p=A.useCallback(()=>{if(!o.trim()){Fe.error("Please provide a name to save to the library.");return}try{JSON.parse(s);const _={id:Date.now().toString(),name:o.trim(),json:s};u(S=>[...S,_]),l(""),Fe.success(`"${_.name}" saved to library.`)}catch{Fe.error("Cannot save invalid JSON to library.")}},[s,o]),y=A.useCallback(_=>{a(_.json),e.setStructuredOutputJson(_.json),i(!1),Fe.success(`Loaded "${_.name}" from library.`)},[e]),b=A.useCallback(_=>{u(S=>S.filter(C=>C.id!==_)),Fe.info("Item removed from library.")},[]);A.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const x=[{value:"entry",label:"Entry",content:m.jsxs("div",{className:"space-y-3 p-1",children:[m.jsx(Jt,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),m.jsx(Id,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:s,onChange:_=>a(_.target.value),rows:8,className:"font-mono text-xs"}),m.jsxs("div",{className:"flex justify-between items-end gap-2",children:[m.jsxs("div",{className:"flex-grow space-y-1",children:[m.jsx(Jt,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),m.jsx(ur,{id:"structured-output-name",value:o,onChange:_=>l(_.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),m.jsxs(Et,{size:"sm",variant:"outline",onClick:p,disabled:!o.trim()||!s.trim(),className:"h-8",children:[m.jsx(oh,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),m.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[m.jsx(Et,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),m.jsx(Et,{size:"sm",onClick:d,disabled:!s,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:m.jsx("div",{className:"space-y-2 p-1",children:c.length===0?m.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(_=>m.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[m.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:_.name}),m.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[m.jsx(Et,{size:"sm",variant:"outline",onClick:()=>y(_),className:"h-7 px-2 text-xs",children:"Use"}),m.jsx(Et,{size:"icon",variant:"ghost",onClick:()=>b(_.id),className:"h-7 w-7 text-destructive",children:m.jsx(Fo,{className:"h-3.5 w-3.5"})})]})]},_.id))})}],w=!!n;return m.jsxs(Al,{open:r,onOpenChange:i,children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:w?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:m.jsx($V,{className:"h-4 w-4"})})})}),m.jsx(yr,{side:"top",children:w?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),m.jsx(Il,{className:"w-[450px] p-0",align:"start",children:m.jsx(Md,{tabs:x,defaultValue:"entry"})})]})},ctt=({module:e})=>{const[,t]=A.useState({});return A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?m.jsx(ltt,{module:e}):null};class utt{constructor(){_e(this,"id","core-structured-output");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"structuredOutputJson",null);_e(this,"isVisible",!0);_e(this,"notifyComponentUpdate",null);_e(this,"getStructuredOutputJson",()=>this.structuredOutputJson);_e(this,"getIsVisible",()=>this.isVisible);_e(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(Pn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.structuredOutputJson=mo.getState().structuredOutputJson,this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(ir.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(Pn.parameterChanged,s=>{var a;if(typeof s=="object"&&s&&"params"in s){const o=s.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var s;const{getSelectedModel:t}=Er.getState(),n=t(),r=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters,i=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(ctt,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Pn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const dtt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),i=e.getTotalEstimatedTokens(),s=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=A.useMemo(()=>s>85?"text-red-600 dark:text-red-500":s>70?"text-orange-500 dark:text-orange-400":s>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[s]);if(!(o!==null&&n>0))return null;const u=`Context: ~${i.toLocaleString()} / ${n.toLocaleString()} tokens (${s}%) [History: ${a}, Input: ${r}]`;return m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:m.jsx(Sfe,{className:dt("h-3 w-3 fill-current",l)})})}),m.jsx(yr,{side:"top",children:u})]})})},lce=4,ftt=e=>{let t=0;return e.forEach(n=>{var r,i,s,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(s=(i=n.prompt)==null?void 0:i.metadata)==null?void 0:s.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/lce)};class htt{constructor(){_e(this,"id","core-usage-display");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"currentInputText","");_e(this,"historyTokens",0);_e(this,"attachedFiles",[]);_e(this,"selectedModelId",null);_e(this,"contextLength",0);_e(this,"notifyComponentUpdate",null);_e(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,i)=>r+i.size,0);return Math.ceil((t+n)/lce)});_e(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());_e(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(Pn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(hl.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(ir.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Xn.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(kr.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,i,s,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=Of.getState(),n=Er.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=On.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=ftt(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Er.getState(),{providerId:r,modelId:i}=Xl(this.selectedModelId);if(!r||!i){this.contextLength=0;return}const s=t.find(u=>u.id===r);if(!s){this.contextLength=0;return}const a=n.find(u=>u.id===s.apiKeyId),o=WW(s,i,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(dtt,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const ptt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),i=e.getIsVisible(),s=n===!0,a=A.useCallback(()=>{const o=s?null:!0;e.setReasoningEnabled(o)},[s,e]);return i?m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:s?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":s?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:m.jsx(sh,{className:dt("h-4 w-4",s?"text-primary":"text-muted-foreground")})})}),m.jsx(yr,{side:"top",children:s?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class mtt{constructor(){_e(this,"id","core-reasoning");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"reasoningEnabled",null);_e(this,"isStreaming",!1);_e(this,"isVisible",!0);_e(this,"notifyComponentUpdate",null);_e(this,"getReasoningEnabled",()=>this.reasoningEnabled);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getIsVisible",()=>this.isVisible);_e(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(Pn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.reasoningEnabled=mo.getState().reasoningEnabled,this.isStreaming=On.getState().status==="streaming",this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(ir.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(Pn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,i)}updateVisibility(){var i,s;const{getSelectedModel:t}=Er.getState(),n=t(),r=((s=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)==null?void 0:s.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(ptt,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Pn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const gtt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),i=e.getIsVisible(),s=n===!0,a=A.useCallback(()=>{const o=s?null:!0;e.setWebSearchEnabled(o)},[s,e]);return i?m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:s?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":s?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:m.jsx(va,{className:dt("h-4 w-4",s?"text-primary":"text-muted-foreground")})})}),m.jsx(yr,{side:"top",children:s?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class ytt{constructor(){_e(this,"id","core-web-search");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"webSearchEnabled",null);_e(this,"isStreaming",!1);_e(this,"isVisible",!0);_e(this,"notifyComponentUpdate",null);_e(this,"getWebSearchEnabled",()=>this.webSearchEnabled);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getIsVisible",()=>this.isVisible);_e(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(Pn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.webSearchEnabled=mo.getState().webSearchEnabled,this.isStreaming=On.getState().status==="streaming",this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Xn.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(ir.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(Pn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,i)}updateVisibility(){var s;const{getSelectedModel:t}=Er.getState(),n=t(),r=((s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)??[],i=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(gtt,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(Pn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const btt=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:i,allTags:s,getRulesForTag:a})=>{const[o,l]=A.useState(""),[c,u]=A.useState(""),d=A.useMemo(()=>{const _=o.toLowerCase();return _?s.filter(S=>{var C;return S.name.toLowerCase().includes(_)||((C=S.description)==null?void 0:C.toLowerCase().includes(_))}):s},[s,o]),h=A.useMemo(()=>{const _=c.toLowerCase();return _?i.filter(S=>S.name.toLowerCase().includes(_)||S.content.toLowerCase().includes(_)||S.type.toLowerCase().includes(_)):i},[i,c]),p=A.useCallback((_,S)=>{n(_,S)},[n]),y=A.useCallback((_,S)=>{r(_,S)},[r]),b=()=>m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"relative",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter tags...",value:o,onChange:_=>l(_.target.value),className:"pl-8 h-9"})]}),m.jsx(Sa,{className:"h-64 border rounded-md p-2 bg-background/50",children:d.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No tags defined.":"No tags match filter."}):m.jsx("div",{className:"space-y-1",children:d.map(_=>{const S=a(_.id);return m.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:m.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[m.jsx(ou,{id:`tag-activate-${_.id}`,checked:e.has(_.id),onCheckedChange:C=>p(_.id,!!C),className:"mt-0.5"}),m.jsxs(Jt,{htmlFor:`tag-activate-${_.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[m.jsx("span",{className:"block font-medium",children:_.name}),_.description&&m.jsx("span",{className:"block text-xs text-muted-foreground",children:_.description}),S.length>0&&m.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",S.map(C=>C.name).join(", ")]})]})]})},_.id)})})})]}),x=()=>m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"relative",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter rules...",value:c,onChange:_=>u(_.target.value),className:"pl-8 h-9"})]}),m.jsx(Sa,{className:"h-64 border rounded-md p-2 bg-background/50",children:h.length===0?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No rules defined.":"No rules match filter."}):m.jsx("div",{className:"space-y-1",children:h.map(_=>m.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:m.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[m.jsx(ou,{id:`rule-activate-${_.id}`,checked:t.has(_.id),onCheckedChange:S=>y(_.id,!!S),className:"mt-0.5"}),m.jsxs(Jt,{htmlFor:`rule-activate-${_.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[m.jsx("span",{className:"block font-medium",children:_.name}),m.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",_.type]}),m.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",_.content]})]})]})},_.id))})})]}),w=[{value:"tags",label:"Activate Tags",content:b()},{value:"rules",label:"Activate Rules",content:x()}];return m.jsx("div",{className:"p-0 h-[28rem] max-w-lg",children:m.jsx(Md,{tabs:w,defaultValue:"tags"})})},vtt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=A.useState(!1),i=e.getActiveTagIds(),s=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=A.useCallback((x,w)=>{e.setActiveTagIds(_=>{const S=new Set(_);return w?S.add(x):S.delete(x),S})},[e]),h=A.useCallback((x,w)=>{e.setActiveRuleIds(_=>{const S=new Set(_);return w?S.add(x):S.delete(x),S})},[e]),p=()=>{o?r(x=>!x):e.handleTriggerClick()&&r(!1)},y=i.size>0||s.size>0,b=a;return m.jsxs(Al,{open:n,onOpenChange:r,children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:o?m.jsx(Rl,{asChild:!0,children:m.jsx(Et,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:p,children:m.jsx(wL,{className:"h-4 w-4"})})}):m.jsx(Et,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:p,children:m.jsx(wL,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",children:o?y?`Rules/Tags Active (${i.size} tags, ${s.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&m.jsx(Il,{className:"w-auto p-0",align:"start",children:m.jsx(btt,{activeTagIds:i,activeRuleIds:s,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function xtt({form:e,name:t,label:n,description:r,placeholder:i,disabled:s,wrapperClassName:a,className:o,rows:l,...c}){return m.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return m.jsxs("div",{className:dt("space-y-1.5",a),children:[m.jsx(Jt,{htmlFor:u.name,className:"text-sm",children:n}),r&&m.jsx("p",{className:"text-xs text-muted-foreground",children:r}),m.jsx(Id,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:i,disabled:s??u.form.state.isSubmitting,rows:l,className:dt(o,u.state.meta.errors.length?"border-destructive":""),...c}),m.jsx(ps,{field:u})]})}})}const wtt=L.object({name:L.string().min(1,"Rule Name is required."),content:L.string().min(1,"Rule Content is required."),type:L.enum(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),_tt=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],Stt=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const i=Vs({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:wtt,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{await n({name:s.name.trim(),content:s.content.trim(),type:s.type})}});return A.useEffect(()=>{i.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,i]),m.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),i.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[m.jsx(gw,{form:i,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),m.jsx(Hv,{form:i,name:"type",label:"Rule Type",options:_tt,placeholder:"Select Type",disabled:t})]}),m.jsx(xtt,{form:i,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Et,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[m.jsx(po,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsx(i.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting,s.isValidating,s.isValid],children:([s,a,o,l])=>m.jsxs(Et,{variant:"secondary",size:"sm",type:"submit",disabled:t||!s||a||!l||o,children:[(t||a||o)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},Ctt=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:i})=>{const s=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&i(a.id,a.name)};return m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(hm,{children:[m.jsx(jy,{children:m.jsxs(Pi,{children:[m.jsx(pi,{children:"Name"}),m.jsx(pi,{children:"Type"}),m.jsx(pi,{children:"Content Preview"}),m.jsx(pi,{className:"text-right",children:"Actions"})]})}),m.jsx(pm,{children:t?m.jsxs(m.Fragment,{children:[m.jsx(Pi,{children:m.jsx(cr,{colSpan:4,children:m.jsx(Pr,{className:"h-10 w-full"})})}),m.jsx(Pi,{children:m.jsx(cr,{colSpan:4,children:m.jsx(Pr,{className:"h-10 w-full"})})})]}):e.length===0?m.jsx(Pi,{children:m.jsx(cr,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return m.jsxs(Pi,{children:[m.jsx(cr,{className:"font-medium",children:a.name}),m.jsx(cr,{className:"capitalize",children:a.type}),m.jsx(cr,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),m.jsxs(cr,{className:"text-right space-x-1",children:[m.jsx(Rn,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:m.jsx(Tw,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),m.jsx(Rn,{tooltipText:"Delete Rule",onClick:()=>s(a),disabled:o,icon:o?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Fo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},ktt=({module:e})=>{const[,t]=A.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[i,s]=A.useState(!1),[a,o]=A.useState(null),[l,c]=A.useState(!1),[u,d]=A.useState({});A.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),s(!0)},p=w=>{o(w),s(!0)},y=A.useCallback(()=>{s(!1),o(null),c(!1)},[]),b=A.useCallback(async w=>{c(!0);try{a?e.updateRule(a.id,w):e.addRule(w),y()}catch{}finally{c(!1)}},[e,a,y]),x=A.useCallback(async w=>{d(_=>({..._,[w]:!0}));try{e.deleteRule(w),(a==null?void 0:a.id)===w&&y()}catch{}finally{d(_=>({..._,[w]:!1}))}},[e,a,y]);return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!i&&m.jsxs(Et,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[m.jsx(W0,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),i&&m.jsx(Stt,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),m.jsxs("div",{className:"pt-4",children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),m.jsx(Ctt,{rules:n,isLoading:r,isDeleting:u,onEdit:p,onDelete:x})]})]})},t3=L.object({name:L.string().min(1,"Tag Name is required."),description:L.string().nullable()}),Ett=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const i=Vs({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:t3,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{var a;await n({name:s.name.trim(),description:((a=s.description)==null?void 0:a.trim())||null})}});return A.useEffect(()=>{i.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,i]),m.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),i.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),m.jsx(i.Field,{name:"name",validators:{onChange:t3.shape.name},children:s=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:s.name,children:"Tag Name"}),m.jsx(ur,{id:s.name,value:s.state.value??"",onChange:a=>s.handleChange(a.target.value),onBlur:s.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:i.state.isSubmitting||t}),m.jsx(ps,{field:s})]})}),m.jsx(i.Field,{name:"description",validators:{onChange:t3.shape.description},children:s=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:s.name,children:"Description (Optional)"}),m.jsx(Id,{id:s.name,value:s.state.value??"",onChange:a=>s.handleChange(a.target.value),onBlur:s.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:i.state.isSubmitting||t}),m.jsx(ps,{field:s})]})}),m.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[m.jsxs(Et,{variant:"ghost",size:"sm",onClick:r,disabled:i.state.isSubmitting||t,type:"button",children:[m.jsx(po,{className:"h-4 w-4 mr-1"})," Cancel"]}),m.jsx(i.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting,s.isValidating,s.isValid],children:([s,a,o,l])=>m.jsxs(Et,{variant:"secondary",size:"sm",type:"submit",disabled:t||!s||a||o||!l,children:[(a||o)&&m.jsx(Hn,{className:"h-4 w-4 mr-1 animate-spin"}),m.jsx(oh,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},Ttt=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:i,onDelete:s})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&s(o.id,o.name)};return m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(hm,{children:[m.jsx(jy,{children:m.jsxs(Pi,{children:[m.jsx(pi,{children:"Name"}),m.jsx(pi,{children:"Description"}),m.jsx(pi,{children:"Linked Rules"}),m.jsx(pi,{className:"text-right",children:"Actions"})]})}),m.jsx(pm,{children:n?m.jsxs(m.Fragment,{children:[m.jsx(Pi,{children:m.jsx(cr,{colSpan:4,children:m.jsx(Pr,{className:"h-10 w-full"})})}),m.jsx(Pi,{children:m.jsx(cr,{colSpan:4,children:m.jsx(Pr,{className:"h-10 w-full"})})})]}):e.length===0?m.jsx(Pi,{children:m.jsx(cr,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return m.jsxs(Pi,{children:[m.jsx(cr,{className:"font-medium",children:o.name}),m.jsx(cr,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),m.jsx(cr,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),m.jsxs(cr,{className:"text-right space-x-1",children:[m.jsx(Rn,{tooltipText:"Edit Tag & Rules",onClick:()=>i(o),disabled:l,icon:m.jsx(Tw,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),m.jsx(Rn,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Fo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},Att=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:i=!1})=>{const[s,a]=A.useState(!1),[o,l]=A.useState(""),c=A.useMemo(()=>[...t].sort((y,b)=>y.name.localeCompare(b.name)),[t]),u=A.useMemo(()=>{const y=o.toLowerCase();return y?c.filter(b=>b.name.toLowerCase().includes(y)||b.content.toLowerCase().includes(y)||b.type.toLowerCase().includes(y)):c},[c,o]),d=A.useCallback(y=>{const b=n.has(y);r(e.id,y,!b),l("")},[n,r,e.id]),h=A.useCallback((y,b)=>{b.stopPropagation(),r(e.id,y,!1)},[r,e.id]),p=A.useMemo(()=>c.filter(y=>n.has(y.id)),[c,n]);return m.jsxs("div",{className:"space-y-3",children:[m.jsxs(Jt,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),m.jsxs(Al,{open:s,onOpenChange:a,children:[m.jsx(Rl,{asChild:!0,children:m.jsxs(Et,{variant:"outline",role:"combobox","aria-expanded":s,className:"w-full justify-between h-9",disabled:i||t.length===0,children:[m.jsx("span",{className:"truncate",children:p.length>0?`${p.length} rule(s) selected`:"Select rules..."}),m.jsx(Pk,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),m.jsx(Il,{className:"w-[--radix-popover-trigger-width] p-0",children:m.jsxs(nce,{shouldFilter:!1,children:[m.jsx(rce,{placeholder:"Search rules...",value:o,onValueChange:l}),m.jsxs(ice,{children:[m.jsx(sce,{children:t.length===0?"No rules defined.":"No rules found."}),m.jsx(ace,{children:u.map(y=>{const b=n.has(y.id);return m.jsxs(oce,{value:y.id,onSelect:()=>d(y.id),className:"cursor-pointer",children:[m.jsx(za,{className:dt("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),m.jsx("span",{className:"truncate",children:y.name}),m.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]})})]}),p.length>0&&m.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:p.map(y=>m.jsxs(If,{variant:"secondary",className:"flex items-center gap-1",children:[m.jsx("span",{className:"truncate",children:y.name}),m.jsx(Et,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>h(y.id,b),disabled:i,"aria-label":`Unlink rule ${y.name}`,children:m.jsx(po,{className:"h-3 w-3"})})]},y.id))})]})},Rtt=({module:e})=>{const[,t]=A.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),i=e.getTagRuleLinks(),s=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=A.useState(!1),[c,u]=A.useState(null),[d,h]=A.useState(!1),[p,y]=A.useState({});A.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},x=R=>{u(R),l(!0)},w=A.useCallback(()=>{l(!1),u(null),h(!1)},[]),_=A.useCallback(async R=>{h(!0);try{c?e.updateTag(c.id,R):e.addTag(R),c||w()}catch{}finally{h(!1)}},[e,c,w]),S=A.useCallback(async R=>{y(M=>({...M,[R]:!0}));try{e.deleteTag(R),(c==null?void 0:c.id)===R&&w()}catch{}finally{y(M=>({...M,[R]:!1}))}},[e,c,w]),C=A.useCallback(async(R,M,N)=>{try{N?e.linkTagToRule(R,M):e.unlinkTagFromRule(R,M)}catch{}},[e]),E=A.useMemo(()=>{const R=new Map;return n.forEach(M=>{R.set(M.id,s(M.id))}),R},[n,s]),T=A.useMemo(()=>c?new Set(i.filter(R=>R.tagId===c.id).map(R=>R.ruleId)):new Set,[c,i]);return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&m.jsxs(Et,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[m.jsx(W0,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&m.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.jsx(Ett,{initialData:c??void 0,isParentSaving:d,onSave:_,onCancel:w}),c&&m.jsx(Att,{tag:c,allRules:r,linkedRuleIds:T,onLinkChange:C,disabled:d})]}),m.jsx(_d,{}),m.jsxs("div",{className:"pt-4",children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),m.jsx(Ttt,{tags:n,rulesByTagId:E,isLoading:a,isDeleting:p,onEdit:x,onDelete:S})]})]})},Itt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=A.useMemo(()=>[{value:"rules",label:"Rules",content:m.jsx(ktt,{module:e})},{value:"tags",label:"Tags",content:m.jsx(Rtt,{module:e})}],[e]);return m.jsx(Md,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class Mtt{constructor(){_e(this,"id","core-rules-tags");_e(this,"unregisterPromptControlCallback",null);_e(this,"unregisterSettingsTabCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"modApiRef",null);_e(this,"allRules",[]);_e(this,"allTags",[]);_e(this,"tagRuleLinks",[]);_e(this,"transientActiveTagIds",new Set);_e(this,"transientActiveRuleIds",new Set);_e(this,"isStreaming",!1);_e(this,"hasRulesOrTags",!1);_e(this,"isLoadingRules",!0);_e(this,"notifyComponentUpdate",null);_e(this,"notifySettingsComponentUpdate",null);_e(this,"getAllRules",()=>this.allRules);_e(this,"getAllTags",()=>this.allTags);_e(this,"getTagRuleLinks",()=>this.tagRuleLinks);_e(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});_e(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));_e(this,"getTagById",t=>this.allTags.find(n=>n.id===t));_e(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});_e(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(lr.addRuleRequest,t)});_e(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(lr.updateRuleRequest,{id:t,updates:n})});_e(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(lr.deleteRuleRequest,{id:t})});_e(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(lr.addTagRequest,t)});_e(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(lr.updateTagRequest,{id:t,updates:n})});_e(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(lr.deleteTagRequest,{id:t})});_e(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(lr.linkTagToRuleRequest,{tagId:t,ruleId:n})});_e(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(lr.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});_e(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(kr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);_e(this,"getIsLoadingRules",()=>this.isLoadingRules);_e(this,"getActiveTagIds",()=>this.transientActiveTagIds);_e(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);_e(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});_e(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});_e(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(lr.loadRulesAndTagsRequest,void 0);const n=t.on(Xn.statusChanged,i=>{var s;typeof i=="object"&&i&&"status"in i&&this.isStreaming!==(i.status==="streaming")&&(this.isStreaming=i.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))}),r=t.on(lr.dataLoaded,i=>{var s,a;i&&(this.allRules=i.rules||[],this.allTags=i.tags||[],this.tagRuleLinks=(i.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(s=this.notifyComponentUpdate)==null||s.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>ut.createElement(vtt,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),i=[],s=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>s.add(o.id))}),s.forEach(a=>{const o=this.getRuleById(a);o&&i.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||i.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:i}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>ut.createElement(Itt,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Ntt=({module:e})=>{const[,t]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),i=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),s=A.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return i?m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:s,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:m.jsx(KV,{className:dt("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),m.jsx(yr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class jtt{constructor(){_e(this,"id","core-auto-title");_e(this,"unregisterCallback",null);_e(this,"eventUnsubscribers",[]);_e(this,"turnAutoTitleEnabled",!1);_e(this,"isStreaming",!1);_e(this,"isFirstInteraction",!1);_e(this,"globalAutoTitleEnabled",!0);_e(this,"notifyComponentUpdate",null);_e(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"getIsFirstInteraction",()=>this.isFirstInteraction);_e(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);_e(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=On.getState().status==="streaming",this.globalAutoTitleEnabled=dr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(Xn.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(kr.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(Xn.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(nn.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,i,s)}checkFirstInteraction(){const t=On.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>ut.createElement(Ntt,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function Ott(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),i=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:i}}class Ptt{constructor(){_e(this,"id","core-url-parameters");_e(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(Ch.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),Fe.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,i;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=Ott();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){Fe.info("Processing parameters from URL...");try{const s=await new Promise((a,o)=>{const l=t.on(Un.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(Un.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(Un.selectItemRequest,{id:s,type:"conversation"}),n.modelId){const a=Er.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(Pn.setModelIdRequest,{id:o}),t.emit(ir.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);Fe.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else Fe.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){Fe.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await yh(l,{fsInstance:o}),u=await o.promises.stat(l),d=ns(l),h="application/octet-stream",p=tx(d,h);let y={};if(p)y.contentText=new TextDecoder().decode(c);else{let b="";const x=c.byteLength;for(let w=0;w<x;w++)b+=String.fromCharCode(c[w]);y.contentBase64=window.btoa(b)}t.emit(hl.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),Fe.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?Fe.warning(`VFS file not found: ${l}`):Fe.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(Pn.inputChanged,{value:n.query}),Fe.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=Of.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:zs(),content:n.query,parameters:a,metadata:o};t.emit(Pn.submitted,{turnData:c});const u=await rC(f0.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){Fe.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await Lv.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(i=n.vfsFiles)!=null&&i.length)&&(Fe.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(s){Fe.error(`Failed to process URL parameters: ${s instanceof Error?s.message:String(s)}`),console.error("Error processing URL parameters:",s)}}}}const Dtt=({module:e})=>{const[t,n]=A.useState(!1),[,r]=A.useState({});A.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),A.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const i=e.getIsVisible(),s=e.getIsStreaming(),a=A.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return i?m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx(Et,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:s,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:m.jsx(T2,{className:dt("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),m.jsx(yr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class Ftt{constructor(){_e(this,"id","core-image-generation");_e(this,"modApiRef",null);_e(this,"isImageGenerationEnabled",null);_e(this,"unregisterCallback",null);_e(this,"notifyComponentUpdate",null);_e(this,"eventUnsubscribers",[]);_e(this,"isVisible",!1);_e(this,"isStreaming",!1);_e(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);_e(this,"getIsVisible",()=>this.isVisible);_e(this,"getIsStreaming",()=>this.isStreaming);_e(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(Pn.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});_e(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=On.getState().status==="streaming",this.updateVisibility();const n=t.on(ir.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(Xn.statusChanged,i=>{var s;typeof i=="object"&&i&&"status"in i&&this.isStreaming!==(i.status==="streaming")&&(this.isStreaming=i.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var s,a;const{getSelectedModel:t}=Er.getState(),n=t(),i=(((a=(s=n==null?void 0:n.metadata)==null?void 0:s.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(Dtt,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var i;(i=this.modApiRef)==null||i.emit(Pn.setImageGenerationEnabledRequest,{enabled:null})}});const n=i=>{var s;i.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=i.enabled,(s=this.notifyComponentUpdate)==null||s.call(this))},r=this.modApiRef.on(Pn.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Ltt=({module:e})=>{const[t,n]=A.useState(!1),[r,i]=A.useState([]),[s,a]=A.useState(250),[,o]=A.useState({}),{status:l}=On(Cn(b=>({status:b.status})));A.useEffect(()=>{if(e)return e.setNotifyCallback(()=>o({})),()=>e.setNotifyCallback(null)},[e]);const c=(b,x)=>{i(w=>x?[...w,b]:w.filter(_=>_!==b))},u=()=>{if(r.length<2){Fe.error("Please select at least 2 models to race");return}e.setRaceMode(!0,r,s),n(!1),Fe.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),i([]),a(250)},d=()=>{e.setRaceMode(!1),Fe.info("Race mode disabled")},h=b=>{if(b.stopPropagation(),e.isRaceModeActive){d();return}if(l==="streaming"){Fe.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){Fe.info("Need at least 2 models enabled to race");return}n(!0)},p=l!=="streaming"&&e.globallyEnabledModels.length>=2,y=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":l==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return m.jsxs(m.Fragment,{children:[m.jsx(Rn,{tooltipText:y(),onClick:h,"aria-label":"Race Multiple Models Against Each Other",disabled:!p,icon:m.jsx(WV,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),m.jsx(Ty,{open:t,onOpenChange:n,children:m.jsxs(Ay,{className:"max-w-md",children:[m.jsxs(Ry,{children:[m.jsx(My,{children:"Race Models"}),m.jsx(I1,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(Jt,{htmlFor:"stagger-input",children:"Stagger Delay (ms)"}),m.jsx(ur,{id:"stagger-input",type:"number",min:"0",max:"5000",step:"50",value:s,onChange:b=>a(parseInt(b.target.value)||250),placeholder:"250",className:"w-full"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Delay between starting each model (0-5000ms)"})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs(Jt,{children:["Select Models to Race (",r.length," selected)"]}),m.jsx(Sa,{className:"h-48 w-full border rounded-md p-3",children:m.jsx("div",{className:"space-y-2",children:e.globallyEnabledModels.map(b=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(ou,{id:`model-${b.id}`,checked:r.includes(b.id),onCheckedChange:x=>c(b.id,x===!0)}),m.jsx(Jt,{htmlFor:`model-${b.id}`,className:"text-sm cursor-pointer flex-1 min-w-0",children:m.jsxs("div",{className:"truncate",children:[m.jsx("span",{className:"font-medium",children:b.name}),m.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",b.providerName,")"]})]})})]},b.id))})}),e.globallyEnabledModels.length===0&&m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No models available"})]})]}),m.jsxs(Iy,{children:[m.jsx(Et,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),m.jsx(Et,{onClick:u,disabled:r.length<2||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class Btt{constructor(){_e(this,"id","race-prompt-control");_e(this,"eventUnsubscribers",[]);_e(this,"modApi",null);_e(this,"notifyComponentUpdate",null);_e(this,"isRaceMode",!1);_e(this,"raceModelIds",[]);_e(this,"raceStaggerMs",250);_e(this,"globallyEnabledModels",[]);_e(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Er.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(ir.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),i=t.on(ir.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.addMiddleware(f0.PROMPT_TURN_FINALIZE,async a=>this.isRaceMode?await this.handleRaceSubmission(a.turnData):a);this.eventUnsubscribers.push(r,i,s)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n,r){var i;this.isRaceMode=t,t&&n&&r!==void 0?(this.raceModelIds=n,this.raceStaggerMs=r):(this.raceModelIds=[],this.raceStaggerMs=250),(i=this.notifyComponentUpdate)==null||i.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceSubmission(t){try{console.log(`[RacePromptControlModule] Starting race submission with ${this.raceModelIds.length} models:`,this.raceModelIds);const n=On.getState(),r=n.currentConversationId;if(!r)return Fe.error("No active conversation for racing"),!1;if(this.raceModelIds.length===0)return Fe.error("No models selected for racing"),this.setRaceMode(!1),!1;Fe.info(`Racing ${this.raceModelIds.length} models with your prompt...`);const s=n.interactions.filter(y=>y.conversationId===r).reduce((y,b)=>Math.max(y,b.index),-1)+1,a=await this.buildPromptObject(t,r,s),o=[...this.raceModelIds],l=this.raceStaggerMs,u=mo.getState().modelId;if(!u)return Fe.error("No model currently selected"),this.setRaceMode(!1),!1;this.setRaceMode(!1);const d={...a,metadata:{...a.metadata,modelId:u}},h=await Sp.startInteraction(d,r,t,"message.user_assistant");if(!h)throw new Error("Failed to create main race interaction");const p=o.map((y,b)=>new Promise(x=>{setTimeout(async()=>{try{const w={...a,metadata:{...a.metadata,modelId:y,raceTab:!0,raceParticipantIndex:b+1}},_=await Sp.startInteraction(w,r,t,"message.assistant_regen");if(_){const S={parentId:h.id,index:b+1};n._updateInteractionInState(_.id,S),await Rt.saveInteraction({..._,...S})}x()}catch(w){console.error(`[RacePromptControlModule] Race participant ${b+1} failed:`,w),x()}},(b+1)*l)}));return await Promise.all(p),Fe.success(`Race started! Current model + ${o.length} race models responding in tabs.`),!1}catch(n){return Fe.error(`Race failed: ${String(n)}`),console.error("[RacePromptControlModule] Error during race:",n),this.setRaceMode(!1),!1}}async buildPromptObject(t,n,r){var R,M,N;const i=On.getState(),s=bo.getState(),o=Dn.getState().getConversationById(n),l=(o==null?void 0:o.projectId)??null,c=s.getEffectiveProjectSettings(l),u=i.interactions.filter(O=>O.conversationId===n&&O.index<r&&O.status==="COMPLETED"&&O.type==="message.user_assistant"&&O.parentId===null).sort((O,B)=>O.index-B.index),d=j3(u);let h=t.content;const p=[],y=((R=t.metadata)==null?void 0:R.effectiveRulesContent)??[],b=y.filter(O=>O.type==="system").map(O=>O.content),x=y.filter(O=>O.type==="before").map(O=>O.content),w=y.filter(O=>O.type==="after").map(O=>O.content);x.length>0&&(h=`${x.join(`
`)}

${h}`),w.length>0&&(h=`${h}

${w.join(`
`)}`),h&&p.push({type:"text",text:h});const _=((M=t.metadata)==null?void 0:M.attachedFiles)??[];_.length>0,p.length>0&&d.push({role:"user",content:p});let C=((N=t.metadata)==null?void 0:N.turnSystemPrompt)??c.systemPrompt??void 0;b.length>0&&(C=`${C?`${C}

`:""}${b.join(`
`)}`);const E=mo.getState(),T={temperature:E.temperature,max_tokens:E.maxTokens,top_p:E.topP,top_k:E.topK,presence_penalty:E.presencePenalty,frequency_penalty:E.frequencyPenalty,...t.parameters??{}};return Object.keys(T).forEach(O=>{(T[O]===null||T[O]===void 0)&&delete T[O]}),{system:C,messages:d,parameters:T,metadata:{...t.metadata??{},attachedFiles:_.map(({contentBase64:O,contentText:B,...P})=>P)}}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>ut.createElement(Ltt,{module:this})})}}const $tt=L.object({enableStreamingMarkdown:L.boolean(),enableStreamingCodeBlockParsing:L.boolean(),foldStreamingCodeBlocks:L.boolean(),foldUserMessagesOnCompletion:L.boolean(),enableAutoScrollOnStream:L.boolean(),streamingRenderFPS:L.number().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:L.number().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),ztt=()=>{const e=dr(Cn(i=>({setEnableStreamingMarkdown:i.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:i.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:i.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:i.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:i.setStreamingRenderFPS,setAutoScrollInterval:i.setAutoScrollInterval,setEnableAutoScrollOnStream:i.setEnableAutoScrollOnStream,resetGeneralSettings:i.resetGeneralSettings}))),t=dr(Cn(i=>({enableStreamingMarkdown:i.enableStreamingMarkdown,enableStreamingCodeBlockParsing:i.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:i.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:i.foldUserMessagesOnCompletion,streamingRenderFPS:i.streamingRenderFPS,autoScrollInterval:i.autoScrollInterval,enableAutoScrollOnStream:i.enableAutoScrollOnStream}))),n=Vs({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:$tt,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{e.setEnableStreamingMarkdown(i.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(i.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(i.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(i.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(i.enableAutoScrollOnStream),e.setStreamingRenderFPS(i.streamingRenderFPS),e.setAutoScrollInterval(i.autoScrollInterval)}});A.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return m.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[m.jsxs("div",{className:"space-y-3",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),m.jsx(lp,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),m.jsx(lp,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),m.jsx(lp,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),m.jsx(lp,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),m.jsx(lp,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),m.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[m.jsx(Kl,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),m.jsx(q0,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),m.jsx("p",{className:dt("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),m.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[m.jsx(Kl,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),m.jsx(q0,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),m.jsx("p",{className:dt("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),m.jsx(_d,{}),m.jsx("div",{className:"flex items-center justify-between pt-3",children:m.jsx(n.Subscribe,{children:i=>{const s=i.canSubmit,a=i.isSubmitting,o=i.isValidating,l=i.isValid;return m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Et,{type:"submit",size:"sm",disabled:!s||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),m.jsxs(Et,{variant:"outline",size:"sm",onClick:r,type:"button",children:[m.jsx(rO,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},Utt=ut.memo(ztt);class qtt{constructor(){_e(this,"id","core-settings-general");_e(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:Utt,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Vtt=({label:e,colorKey:t,value:n,onChange:r})=>{const[i,s]=A.useState(n??"");A.useEffect(()=>{s(n??"")},[n]);const a=()=>{r(t,i.trim()||null)},o=l=>{s(l.target.value)};return m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx(Jt,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),m.jsx(ur,{id:`color-${t}`,type:"text",value:i,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),m.jsx(ur,{type:"color",value:i!=null&&i.startsWith("#")?i:"#000000",onChange:l=>{s(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},Htt=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],Wtt=L.enum(["system","light","dark","TijuLight","TijuDark","custom"]),Gtt=L.object({theme:Wtt,prismThemeUrl:L.string(),customFontFamily:L.string(),customFontSize:L.number().min(12).max(20),chatMaxWidth:L.string(),customThemeColors:L.record(L.string(),L.string().nullable())}),Ktt=()=>{const e=dr(Cn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=dr(Cn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=Vs({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:Gtt,onChangeAsyncDebounceMs:300}});A.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},i=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],s=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return m.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[m.jsx(Av,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx(Jt,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),m.jsx(Hv,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),m.jsxs(Av,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[m.jsxs("div",{children:[m.jsx(gw,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Kl,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),m.jsxs("div",{children:[m.jsx(Hv,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:i,triggerClassName:"w-full mt-1"}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),m.jsxs(Av,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[m.jsx(Hv,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:Htt,triggerClassName:"w-full"}),m.jsx(gw,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),m.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&m.jsx(Av,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:s.map(({key:a,label:o})=>{var l;return m.jsx(Vtt,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),m.jsx(_d,{}),m.jsxs("div",{className:"flex justify-between pt-3",children:[m.jsxs(Et,{variant:"outline",size:"sm",onClick:r,type:"button",children:[m.jsx(rO,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),m.jsx(Et,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},Ytt=ut.memo(Ktt);class Ztt{constructor(){_e(this,"id","core-settings-theme");_e(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:Ytt,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const Xtt=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:i,onUpdate:s,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var M,N;const[c,u]=A.useState(!0),d=d0(e.type),h=nC(e.type),p=wp(e.type),y=a==="fetching"||o,b=o||a==="fetching",x=o||a==="fetching",w=A.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),_=e.apiKeyId?t.some(O=>O.id===e.apiKeyId):!1,S=d&&!_,C=A.useCallback(async(O,B)=>{const P=new Set(e.enabledModels??[]);B?P.add(O):P.delete(O);const H=Array.from(P);try{await s(e.id,{enabledModels:H})}catch(F){Fe.error("Failed to update model status."),console.error("Failed to save model toggle:",F)}},[e.enabledModels,e.id,s]),E=()=>u(O=>!O),T=((M=e.enabledModels)==null?void 0:M.length)??0,R=l.length;return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{children:m.jsx("span",{className:dt("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),m.jsx(yr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),m.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),m.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{children:m.jsx(nc,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),m.jsx(yr,{side:"top",children:m.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),m.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[m.jsx(Rn,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:m.jsx(Tw,{}),className:"h-8 w-8"}),m.jsx(Rn,{tooltipText:"Delete",onClick:r,disabled:x,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Fo,{})})]})]}),m.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&m.jsxs("div",{children:["API Key:"," ",e.apiKeyId?_?m.jsx("span",{className:"text-green-400",children:((N=t.find(O=>O.id===e.apiKeyId))==null?void 0:N.name)||"Linked (Unnamed Key)"}):m.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):m.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&m.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),m.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?m.jsx("span",{className:"text-green-400",children:"Enabled"}):m.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&m.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),p&&m.jsx("div",{className:"pt-1",children:m.jsxs(Et,{variant:"outline",size:"sm",onClick:i,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&m.jsx(Hn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&m.jsx(za,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&m.jsx(nc,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&m.jsx(Ap,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),m.jsxs("div",{className:"space-y-1 pt-2",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",T," / ",R," enabled)"]}),m.jsx(Rn,{tooltipText:c?"Show Models":"Hide Models",onClick:E,"aria-label":c?"Show model list":"Hide model list",icon:c?m.jsx(cu,{}):m.jsx(ah,{}),className:"h-6 w-6"})]}),!c&&m.jsx(O6,{providerId:e.id,allAvailableModels:l,enabledModelIds:w,onToggleModel:C,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},Jtt=ut.memo(Xtt),Qtt=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:i,onCancel:s,onSave:a,onChange:o})=>{const l=A.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=A.useCallback((d,h)=>{const p=new Set(t.enabledModels??[]);h?p.add(d):p.delete(d);const y=Array.from(p);o("enabledModels",y)},[t.enabledModels,o]),u=A.useCallback((d,h)=>new Promise(p=>{o(d,h),p(void 0)}),[o]);return m.jsx("div",{className:"space-y-4",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"space-y-3",children:[m.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),m.jsx(hae,{initialData:t,onChange:u,onSubmit:a,onCancel:s,apiKeys:n,disabled:i})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),m.jsx(O6,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:i,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},ent=ut.memo(Qtt),tnt=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:i,fetchStatus:s,onSelectModelForDetails:a})=>{const[o,l]=A.useState(!1),[c,u]=A.useState(!1),[d,h]=A.useState(!1),[p,y]=A.useState({name:"placeholder"}),b=Er(N=>N.getAllAvailableModelDefsForProvider),[x,w]=A.useState([]),_=A.useMemo(()=>[...b(e.id)].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id)),[e.id,b]);A.useEffect(()=>{if(o){const N=b(e.id);w([...N].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else w([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const S=()=>l(!0),C=()=>{l(!1),y({}),u(!1)},E=A.useCallback(async()=>{u(!0);try{const N=p.enabledModels&&p.enabledModels.length>0?p.enabledModels:null,O={name:p.name,type:p.type,isEnabled:p.isEnabled,apiKeyId:p.apiKeyId,baseURL:p.baseURL,autoFetchModels:p.autoFetchModels,enabledModels:N};Object.keys(O).forEach(B=>{O[B]===void 0&&delete O[B]}),await n(e.id,O),l(!1),y({}),Fe.success(`Provider "${O.name||e.name}" updated.`)}catch(N){console.error("Failed to save provider update:",N),Fe.error("Failed to save provider configuration.")}finally{u(!1)}},[p,n,e.id,e.name]),T=A.useCallback((N,O)=>{y(B=>({...B,[N]:O}))},[]),R=A.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(N){console.error("Failed to delete provider:",N),h(!1)}}},[r,e.id,e.name]),M=A.useCallback(async()=>{if(await i(e.id),o){const N=b(e.id);w([...N].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id)))}},[i,e.id,o,b]);return m.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?m.jsx(ent,{providerId:e.id,editData:p,apiKeys:t,allAvailableModels:x,isSaving:c,onCancel:C,onSave:E,onChange:T}):m.jsx(Jtt,{provider:e,apiKeys:t,onEdit:S,onDelete:R,onFetchModels:M,onUpdate:n,fetchStatus:s,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:_})})},nnt=ut.memo(tnt);function rnt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return A.useMemo(()=>r=>{t.forEach(i=>i(r))},t)}const zT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Py(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function J6(e){return"nodeType"in e}function wo(e){var t,n;return e?Py(e)?e:J6(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Q6(e){const{Document:t}=wo(e);return e instanceof t}function P1(e){return Py(e)?!1:e instanceof wo(e).HTMLElement}function cce(e){return e instanceof wo(e).SVGElement}function Dy(e){return e?Py(e)?e.document:J6(e)?Q6(e)?e:P1(e)||cce(e)?e.ownerDocument:document:document:document}const lu=zT?A.useLayoutEffect:A.useEffect;function e5(e){const t=A.useRef(e);return lu(()=>{t.current=e}),A.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function int(){const e=A.useRef(null),t=A.useCallback((r,i)=>{e.current=setInterval(r,i)},[]),n=A.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function _w(e,t){t===void 0&&(t=[e]);const n=A.useRef(e);return lu(()=>{n.current!==e&&(n.current=e)},t),n}function D1(e,t){const n=A.useRef();return A.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Mk(e){const t=e5(e),n=A.useRef(null),r=A.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,r]}function H4(e){const t=A.useRef();return A.useEffect(()=>{t.current=e},[e]),t.current}let n3={};function F1(e,t){return A.useMemo(()=>{if(t)return t;const n=n3[e]==null?0:n3[e]+1;return n3[e]=n,e+"-"+n},[e,t])}function uce(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((s,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=s[l];u!=null&&(s[l]=u+e*c)}return s},{...t})}}const Xg=uce(1),Sw=uce(-1);function snt(e){return"clientX"in e&&"clientY"in e}function t5(e){if(!e)return!1;const{KeyboardEvent:t}=wo(e.target);return t&&e instanceof t}function ant(e){if(!e)return!1;const{TouchEvent:t}=wo(e.target);return t&&e instanceof t}function W4(e){if(ant(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return snt(e)?{x:e.clientX,y:e.clientY}:null}const Cw=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Cw.Translate.toString(e),Cw.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Qq="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ont(e){return e.matches(Qq)?e:e.querySelector(Qq)}const lnt={display:"none"};function cnt(e){let{id:t,value:n}=e;return ut.createElement("div",{id:t,style:lnt},n)}function unt(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ut.createElement("div",{id:t,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function dnt(){const[e,t]=A.useState("");return{announce:A.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const dce=A.createContext(null);function fnt(e){const t=A.useContext(dce);A.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function hnt(){const[e]=A.useState(()=>new Set),t=A.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[A.useCallback(r=>{let{type:i,event:s}=r;e.forEach(a=>{var o;return(o=a[i])==null?void 0:o.call(a,s)})},[e]),t]}const pnt={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},mnt={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function gnt(e){let{announcements:t=mnt,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=pnt}=e;const{announce:s,announcement:a}=dnt(),o=F1("DndLiveRegion"),[l,c]=A.useState(!1);if(A.useEffect(()=>{c(!0)},[]),fnt(A.useMemo(()=>({onDragStart(d){let{active:h}=d;s(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:p}=d;t.onDragMove&&s(t.onDragMove({active:h,over:p}))},onDragOver(d){let{active:h,over:p}=d;s(t.onDragOver({active:h,over:p}))},onDragEnd(d){let{active:h,over:p}=d;s(t.onDragEnd({active:h,over:p}))},onDragCancel(d){let{active:h,over:p}=d;s(t.onDragCancel({active:h,over:p}))}}),[s,t])),!l)return null;const u=ut.createElement(ut.Fragment,null,ut.createElement(cnt,{id:r,value:i.draggable}),ut.createElement(unt,{id:o,announcement:a}));return n?Hl.createPortal(u,n):u}var ws;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ws||(ws={}));function Nk(){}function eV(e,t){return A.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ynt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return A.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const uc=Object.freeze({x:0,y:0});function fce(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function hce(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function bnt(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function tV(e){let{left:t,top:n,height:r,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+r},{x:t+i,y:n+r}]}function pce(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function nV(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const vnt=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=nV(t,t.left,t.top),s=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=fce(nV(l),i);s.push({id:o,data:{droppableContainer:a,value:c}})}}return s.sort(hce)},xnt=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=tV(t),s=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=tV(l),u=i.reduce((h,p,y)=>h+fce(c[y],p),0),d=Number((u/4).toFixed(4));s.push({id:o,data:{droppableContainer:a,value:d}})}}return s.sort(hce)};function wnt(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=i-r,o=s-n;if(r<i&&n<s){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const _nt=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=[];for(const s of r){const{id:a}=s,o=n.get(a);if(o){const l=wnt(o,t);l>0&&i.push({id:a,data:{droppableContainer:s,value:l}})}}return i.sort(bnt)};function Snt(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function mce(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:uc}function Cnt(e){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return i.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const knt=Cnt(1);function Ent(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Tnt(e,t,n){const r=Ent(t);if(!r)return e;const{scaleX:i,scaleY:s,x:a,y:o}=r,l=e.left-a-(1-i)*parseFloat(n),c=e.top-o-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),u=i?e.width/i:e.width,d=s?e.height/s:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const Ant={ignoreTransform:!1};function Fy(e,t){t===void 0&&(t=Ant);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=wo(e).getComputedStyle(e);c&&(n=Tnt(n,c,u))}const{top:r,left:i,width:s,height:a,bottom:o,right:l}=n;return{top:r,left:i,width:s,height:a,bottom:o,right:l}}function rV(e){return Fy(e,{ignoreTransform:!0})}function Rnt(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Int(e,t){return t===void 0&&(t=wo(e).getComputedStyle(e)),t.position==="fixed"}function Mnt(e,t){t===void 0&&(t=wo(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?n.test(s):!1})}function UT(e,t){const n=[];function r(i){if(t!=null&&n.length>=t||!i)return n;if(Q6(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!P1(i)||cce(i)||n.includes(i))return n;const s=wo(e).getComputedStyle(i);return i!==e&&Mnt(i,s)&&n.push(i),Int(i,s)?n:r(i.parentNode)}return e?r(e):n}function gce(e){const[t]=UT(e,1);return t??null}function r3(e){return!zT||!e?null:Py(e)?e:J6(e)?Q6(e)||e===Dy(e).scrollingElement?window:P1(e)?e:null:null}function yce(e){return Py(e)?e.scrollX:e.scrollLeft}function bce(e){return Py(e)?e.scrollY:e.scrollTop}function G4(e){return{x:yce(e),y:bce(e)}}var Ds;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ds||(Ds={}));function vce(e){return!zT||!e?!1:e===document.scrollingElement}function xce(e){const t={x:0,y:0},n=vce(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:i,isLeft:s,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const Nnt={x:.2,y:.2};function jnt(e,t,n,r,i){let{top:s,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),i===void 0&&(i=Nnt);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=xce(e),p={x:0,y:0},y={x:0,y:0},b={height:t.height*i.y,width:t.width*i.x};return!c&&s<=t.top+b.height?(p.y=Ds.Backward,y.y=r*Math.abs((t.top+b.height-s)/b.height)):!u&&l>=t.bottom-b.height&&(p.y=Ds.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(p.x=Ds.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(p.x=Ds.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:p,speed:y}}function Ont(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:i,width:e.clientWidth,height:e.clientHeight}}function wce(e){return e.reduce((t,n)=>Xg(t,G4(n)),uc)}function Pnt(e){return e.reduce((t,n)=>t+yce(n),0)}function Dnt(e){return e.reduce((t,n)=>t+bce(n),0)}function Fnt(e,t){if(t===void 0&&(t=Fy),!e)return;const{top:n,left:r,bottom:i,right:s}=t(e);gce(e)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Lnt=[["x",["left","right"],Pnt],["y",["top","bottom"],Dnt]];class n5{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=UT(n),i=wce(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,o]of Lnt)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=i[s]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Wv{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var i;(i=this.target)==null||i.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function Bnt(e){const{EventTarget:t}=wo(e);return e instanceof t?e:Dy(e)}function i3(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var fl;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(fl||(fl={}));function iV(e){e.preventDefault()}function $nt(e){e.stopPropagation()}var Or;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Or||(Or={}));const _ce={start:[Or.Space,Or.Enter],cancel:[Or.Esc],end:[Or.Space,Or.Enter,Or.Tab]},znt=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Or.Right:return{...n,x:n.x+25};case Or.Left:return{...n,x:n.x-25};case Or.Down:return{...n,y:n.y+25};case Or.Up:return{...n,y:n.y-25}}};class r5{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Wv(Dy(n)),this.windowListeners=new Wv(wo(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(fl.Resize,this.handleCancel),this.windowListeners.add(fl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(fl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&Fnt(r),n(uc)}handleKeyDown(t){if(t5(t)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:s=_ce,coordinateGetter:a=znt,scrollBehavior:o="smooth"}=i,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:uc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=Sw(d,u),p={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const x=t.code,{isTop:w,isRight:_,isLeft:S,isBottom:C,maxScroll:E,minScroll:T}=xce(b),R=Ont(b),M={x:Math.min(x===Or.Right?R.right-R.width/2:R.right,Math.max(x===Or.Right?R.left:R.left+R.width/2,d.x)),y:Math.min(x===Or.Down?R.bottom-R.height/2:R.bottom,Math.max(x===Or.Down?R.top:R.top+R.height/2,d.y))},N=x===Or.Right&&!_||x===Or.Left&&!S,O=x===Or.Down&&!C||x===Or.Up&&!w;if(N&&M.x!==d.x){const B=b.scrollLeft+h.x,P=x===Or.Right&&B<=E.x||x===Or.Left&&B>=T.x;if(P&&!h.y){b.scrollTo({left:B,behavior:o});return}P?p.x=b.scrollLeft-B:p.x=x===Or.Right?b.scrollLeft-E.x:b.scrollLeft-T.x,p.x&&b.scrollBy({left:-p.x,behavior:o});break}else if(O&&M.y!==d.y){const B=b.scrollTop+h.y,P=x===Or.Down&&B<=E.y||x===Or.Up&&B>=T.y;if(P&&!h.x){b.scrollTo({top:B,behavior:o});return}P?p.y=b.scrollTop-B:p.y=x===Or.Down?b.scrollTop-E.y:b.scrollTop-T.y,p.y&&b.scrollBy({top:-p.y,behavior:o});break}}this.handleMove(t,Xg(Sw(d,this.referenceCoordinates),p))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}r5.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=_ce,onActivation:i}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=s.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function sV(e){return!!(e&&"distance"in e)}function aV(e){return!!(e&&"delay"in e)}class i5{constructor(t,n,r){var i;r===void 0&&(r=Bnt(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=Dy(a),this.documentListeners=new Wv(this.document),this.listeners=new Wv(r),this.windowListeners=new Wv(wo(a)),this.initialCoordinates=(i=W4(s))!=null?i:uc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(fl.Resize,this.handleCancel),this.windowListeners.add(fl.DragStart,iV),this.windowListeners.add(fl.VisibilityChange,this.handleCancel),this.windowListeners.add(fl.ContextMenu,iV),this.documentListeners.add(fl.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(aV(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(sV(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:i}=this.props;i(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(fl.Click,$nt,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(fl.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:i,props:s}=this,{onMove:a,options:{activationConstraint:o}}=s;if(!i)return;const l=(n=W4(t))!=null?n:uc,c=Sw(i,l);if(!r&&o){if(sV(o)){if(o.tolerance!=null&&i3(c,o.tolerance))return this.handleCancel();if(i3(c,o.distance))return this.handleStart()}if(aV(o)&&i3(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Or.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Unt={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class s5 extends i5{constructor(t){const{event:n}=t,r=Dy(n.target);super(t,Unt,r)}}s5.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const qnt={move:{name:"mousemove"},end:{name:"mouseup"}};var K4;(function(e){e[e.RightClick=2]="RightClick"})(K4||(K4={}));class Vnt extends i5{constructor(t){super(t,qnt,Dy(t.event.target))}}Vnt.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===K4.RightClick?!1:(r==null||r({event:n}),!0)}}];const s3={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Hnt extends i5{constructor(t){super(t,s3)}static setup(){return window.addEventListener(s3.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(s3.move.name,t)};function t(){}}}Hnt.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var Gv;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Gv||(Gv={}));var jk;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(jk||(jk={}));function Wnt(e){let{acceleration:t,activator:n=Gv.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:a=5,order:o=jk.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const p=Knt({delta:d,disabled:!s}),[y,b]=int(),x=A.useRef({x:0,y:0}),w=A.useRef({x:0,y:0}),_=A.useMemo(()=>{switch(n){case Gv.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Gv.DraggableRect:return i}},[n,i,l]),S=A.useRef(null),C=A.useCallback(()=>{const T=S.current;if(!T)return;const R=x.current.x*w.current.x,M=x.current.y*w.current.y;T.scrollBy(R,M)},[]),E=A.useMemo(()=>o===jk.TreeOrder?[...c].reverse():c,[o,c]);A.useEffect(()=>{if(!s||!c.length||!_){b();return}for(const T of E){if((r==null?void 0:r(T))===!1)continue;const R=c.indexOf(T),M=u[R];if(!M)continue;const{direction:N,speed:O}=jnt(T,M,_,t,h);for(const B of["x","y"])p[B][N[B]]||(O[B]=0,N[B]=0);if(O.x>0||O.y>0){b(),S.current=T,y(C,a),x.current=O,w.current=N;return}}x.current={x:0,y:0},w.current={x:0,y:0},b()},[t,C,r,b,s,a,JSON.stringify(_),JSON.stringify(p),y,c,E,u,JSON.stringify(h)])}const Gnt={x:{[Ds.Backward]:!1,[Ds.Forward]:!1},y:{[Ds.Backward]:!1,[Ds.Forward]:!1}};function Knt(e){let{delta:t,disabled:n}=e;const r=H4(t);return D1(i=>{if(n||!r||!i)return Gnt;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Ds.Backward]:i.x[Ds.Backward]||s.x===-1,[Ds.Forward]:i.x[Ds.Forward]||s.x===1},y:{[Ds.Backward]:i.y[Ds.Backward]||s.y===-1,[Ds.Forward]:i.y[Ds.Forward]||s.y===1}}},[n,t,r])}function Ynt(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return D1(i=>{var s;return t==null?null:(s=r??i)!=null?s:null},[r,t])}function Znt(e,t){return A.useMemo(()=>e.reduce((n,r)=>{const{sensor:i}=r,s=i.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var kw;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(kw||(kw={}));var Y4;(function(e){e.Optimized="optimized"})(Y4||(Y4={}));const oV=new Map;function Xnt(e,t){let{dragging:n,dependencies:r,config:i}=t;const[s,a]=A.useState(null),{frequency:o,measure:l,strategy:c}=i,u=A.useRef(e),d=x(),h=_w(d),p=A.useCallback(function(w){w===void 0&&(w=[]),!h.current&&a(_=>_===null?w:_.concat(w.filter(S=>!_.includes(S))))},[h]),y=A.useRef(null),b=D1(w=>{if(d&&!n)return oV;if(!w||w===oV||u.current!==e||s!=null){const _=new Map;for(let S of e){if(!S)continue;if(s&&s.length>0&&!s.includes(S.id)&&S.rect.current){_.set(S.id,S.rect.current);continue}const C=S.node.current,E=C?new n5(l(C),C):null;S.rect.current=E,E&&_.set(S.id,E)}return _}return w},[e,s,n,d,l]);return A.useEffect(()=>{u.current=e},[e]),A.useEffect(()=>{d||p()},[n,d]),A.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),A.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{p(),y.current=null},o))},[o,d,p,...r]),{droppableRects:b,measureDroppableContainers:p,measuringScheduled:s!=null};function x(){switch(c){case kw.Always:return!1;case kw.BeforeDragging:return n;default:return!n}}}function Sce(e,t){return D1(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Jnt(e,t){return Sce(e,t)}function Qnt(e){let{callback:t,disabled:n}=e;const r=e5(t),i=A.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return A.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function qT(e){let{callback:t,disabled:n}=e;const r=e5(t),i=A.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return A.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function ert(e){return new n5(Fy(e),e)}function lV(e,t,n){t===void 0&&(t=ert);const[r,i]=A.useState(null);function s(){i(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=Qnt({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){s();break}}}}),o=qT({callback:s});return lu(()=>{s(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function trt(e){const t=Sce(e);return mce(e,t)}const cV=[];function nrt(e){const t=A.useRef(e),n=D1(r=>e?r&&r!==cV&&e&&t.current&&e.parentNode===t.current.parentNode?r:UT(e):cV,[e]);return A.useEffect(()=>{t.current=e},[e]),n}function rrt(e){const[t,n]=A.useState(null),r=A.useRef(e),i=A.useCallback(s=>{const a=r3(s.target);a&&n(o=>o?(o.set(a,G4(a)),new Map(o)):null)},[]);return A.useEffect(()=>{const s=r.current;if(e!==s){a(s);const o=e.map(l=>{const c=r3(l);return c?(c.addEventListener("scroll",i,{passive:!0}),[c,G4(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(s)};function a(o){o.forEach(l=>{const c=r3(l);c==null||c.removeEventListener("scroll",i)})}},[i,e]),A.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>Xg(s,a),uc):wce(e):uc,[e,t])}function uV(e,t){t===void 0&&(t=[]);const n=A.useRef(null);return A.useEffect(()=>{n.current=null},t),A.useEffect(()=>{const r=e!==uc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?Sw(e,n.current):uc}function irt(e){A.useEffect(()=>{if(!zT)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function srt(e,t){return A.useMemo(()=>e.reduce((n,r)=>{let{eventName:i,handler:s}=r;return n[i]=a=>{s(a,t)},n},{}),[e,t])}function Cce(e){return A.useMemo(()=>e?Rnt(e):null,[e])}const dV=[];function art(e,t){t===void 0&&(t=Fy);const[n]=e,r=Cce(n?wo(n):null),[i,s]=A.useState(dV);function a(){s(()=>e.length?e.map(l=>vce(l)?r:new n5(t(l),l)):dV)}const o=qT({callback:a});return lu(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),i}function ort(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return P1(t)?t:e}function lrt(e){let{measure:t}=e;const[n,r]=A.useState(null),i=A.useCallback(c=>{for(const{target:u}of c)if(P1(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),s=qT({callback:i}),a=A.useCallback(c=>{const u=ort(c);s==null||s.disconnect(),u&&(s==null||s.observe(u)),r(u?t(u):null)},[t,s]),[o,l]=Mk(a);return A.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const crt=[{sensor:s5,options:{}},{sensor:r5,options:{}}],urt={current:{}},E2={draggable:{measure:rV},droppable:{measure:rV,strategy:kw.WhileDragging,frequency:Y4.Optimized},dragOverlay:{measure:Fy}};class Kv extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const drt={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Kv,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Nk},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:E2,measureDroppableContainers:Nk,windowRect:null,measuringScheduled:!1},frt={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Nk,draggableNodes:new Map,over:null,measureDroppableContainers:Nk},VT=A.createContext(frt),kce=A.createContext(drt);function hrt(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Kv}}}function prt(e,t){switch(t.type){case ws.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ws.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ws.DragEnd:case ws.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ws.RegisterDroppable:{const{element:n}=t,{id:r}=n,i=new Kv(e.droppable.containers);return i.set(r,n),{...e,droppable:{...e.droppable,containers:i}}}case ws.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new Kv(e.droppable.containers);return a.set(n,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:a}}}case ws.UnregisterDroppable:{const{id:n,key:r}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Kv(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function mrt(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:i}=A.useContext(VT),s=H4(r),a=H4(n==null?void 0:n.id);return A.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!t5(s)||document.activeElement===s.target)return;const o=i.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=ont(u);if(d){d.focus();break}}})}},[r,t,i,a,s]),null}function grt(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...r}),n):n}function yrt(e){return A.useMemo(()=>({draggable:{...E2.draggable,...e==null?void 0:e.draggable},droppable:{...E2.droppable,...e==null?void 0:e.droppable},dragOverlay:{...E2.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function brt(e){let{activeNode:t,measure:n,initialRect:r,config:i=!0}=e;const s=A.useRef(!1),{x:a,y:o}=typeof i=="boolean"?{x:i,y:i}:i;lu(()=>{if(!a&&!o||!t){s.current=!1;return}if(s.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=mce(u,r);if(a||(d.x=0),o||(d.y=0),s.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=gce(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const Ece=A.createContext({...uc,scaleX:1,scaleY:1});var Sf;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Sf||(Sf={}));const vrt=A.memo(function(t){var n,r,i,s;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=crt,collisionDetection:d=_nt,measuring:h,modifiers:p,...y}=t;const b=A.useReducer(prt,void 0,hrt),[x,w]=b,[_,S]=hnt(),[C,E]=A.useState(Sf.Uninitialized),T=C===Sf.Initialized,{draggable:{active:R,nodes:M,translate:N},droppable:{containers:O}}=x,B=R!=null?M.get(R):null,P=A.useRef({initial:null,translated:null}),H=A.useMemo(()=>{var rt;return R!=null?{id:R,data:(rt=B==null?void 0:B.data)!=null?rt:urt,rect:P}:null},[R,B]),F=A.useRef(null),[Q,q]=A.useState(null),[K,U]=A.useState(null),re=_w(y,Object.values(y)),G=F1("DndDescribedBy",a),ne=A.useMemo(()=>O.getEnabled(),[O]),te=yrt(h),{droppableRects:se,measureDroppableContainers:pe,measuringScheduled:de}=Xnt(ne,{dragging:T,dependencies:[N.x,N.y],config:te.droppable}),Ne=Ynt(M,R),Pe=A.useMemo(()=>K?W4(K):null,[K]),Me=qe(),Ee=Jnt(Ne,te.draggable.measure);brt({activeNode:R!=null?M.get(R):null,config:Me.layoutShiftCompensation,initialRect:Ee,measure:te.draggable.measure});const Ue=lV(Ne,te.draggable.measure,Ee),nt=lV(Ne?Ne.parentElement:null),He=A.useRef({activatorEvent:null,active:null,activeNode:Ne,collisionRect:null,collisions:null,droppableRects:se,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=O.getNodeFor((n=He.current.over)==null?void 0:n.id),Y=lrt({measure:te.dragOverlay.measure}),be=(r=Y.nodeRef.current)!=null?r:Ne,Re=T?(i=Y.rect)!=null?i:Ue:null,ce=!!(Y.nodeRef.current&&Y.rect),le=trt(ce?null:Ue),ae=Cce(be?wo(be):null),Te=nrt(T?je??Ne:null),$e=art(Te),ke=grt(p,{transform:{x:N.x-le.x,y:N.y-le.y,scaleX:1,scaleY:1},activatorEvent:K,active:H,activeNodeRect:Ue,containerNodeRect:nt,draggingNodeRect:Re,over:He.current.over,overlayNodeRect:Y.rect,scrollableAncestors:Te,scrollableAncestorRects:$e,windowRect:ae}),ot=Pe?Xg(Pe,N):null,At=rrt(Te),ft=uV(At),jt=uV(At,[Ue]),Bt=Xg(ke,ft),Ft=Re?knt(Re,ke):null,tn=H&&Ft?d({active:H,collisionRect:Ft,droppableRects:se,droppableContainers:ne,pointerCoordinates:ot}):null,xe=pce(tn,"id"),[D,X]=A.useState(null),me=ce?ke:Xg(ke,jt),De=Snt(me,(s=D==null?void 0:D.rect)!=null?s:null,Ue),we=A.useRef(null),Ie=A.useCallback((rt,ve)=>{let{sensor:Se,options:ze}=ve;if(F.current==null)return;const Tt=M.get(F.current);if(!Tt)return;const ge=rt.nativeEvent,Z=new Se({active:F.current,activeNode:Tt,event:ge,options:ze,context:He,onAbort(J){if(!M.get(J))return;const{onDragAbort:Oe}=re.current,We={id:J};Oe==null||Oe(We),_({type:"onDragAbort",event:We})},onPending(J,ye,Oe,We){if(!M.get(J))return;const{onDragPending:Xt}=re.current,jn={id:J,constraint:ye,initialCoordinates:Oe,offset:We};Xt==null||Xt(jn),_({type:"onDragPending",event:jn})},onStart(J){const ye=F.current;if(ye==null)return;const Oe=M.get(ye);if(!Oe)return;const{onDragStart:We}=re.current,vt={activatorEvent:ge,active:{id:ye,data:Oe.data,rect:P}};Hl.unstable_batchedUpdates(()=>{We==null||We(vt),E(Sf.Initializing),w({type:ws.DragStart,initialCoordinates:J,active:ye}),_({type:"onDragStart",event:vt}),q(we.current),U(ge)})},onMove(J){w({type:ws.DragMove,coordinates:J})},onEnd:W(ws.DragEnd),onCancel:W(ws.DragCancel)});we.current=Z;function W(J){return async function(){const{active:Oe,collisions:We,over:vt,scrollAdjustedTranslate:Xt}=He.current;let jn=null;if(Oe&&Xt){const{cancelDrop:Yt}=re.current;jn={activatorEvent:ge,active:Oe,collisions:We,delta:Xt,over:vt},J===ws.DragEnd&&typeof Yt=="function"&&await Promise.resolve(Yt(jn))&&(J=ws.DragCancel)}F.current=null,Hl.unstable_batchedUpdates(()=>{w({type:J}),E(Sf.Uninitialized),X(null),q(null),U(null),we.current=null;const Yt=J===ws.DragEnd?"onDragEnd":"onDragCancel";if(jn){const Qt=re.current[Yt];Qt==null||Qt(jn),_({type:Yt,event:jn})}})}}},[M]),fe=A.useCallback((rt,ve)=>(Se,ze)=>{const Tt=Se.nativeEvent,ge=M.get(ze);if(F.current!==null||!ge||Tt.dndKit||Tt.defaultPrevented)return;const Z={active:ge};rt(Se,ve.options,Z)===!0&&(Tt.dndKit={capturedBy:ve.sensor},F.current=ze,Ie(Se,ve))},[M,Ie]),yt=Znt(u,fe);irt(u),lu(()=>{Ue&&C===Sf.Initializing&&E(Sf.Initialized)},[Ue,C]),A.useEffect(()=>{const{onDragMove:rt}=re.current,{active:ve,activatorEvent:Se,collisions:ze,over:Tt}=He.current;if(!ve||!Se)return;const ge={active:ve,activatorEvent:Se,collisions:ze,delta:{x:Bt.x,y:Bt.y},over:Tt};Hl.unstable_batchedUpdates(()=>{rt==null||rt(ge),_({type:"onDragMove",event:ge})})},[Bt.x,Bt.y]),A.useEffect(()=>{const{active:rt,activatorEvent:ve,collisions:Se,droppableContainers:ze,scrollAdjustedTranslate:Tt}=He.current;if(!rt||F.current==null||!ve||!Tt)return;const{onDragOver:ge}=re.current,Z=ze.get(xe),W=Z&&Z.rect.current?{id:Z.id,rect:Z.rect.current,data:Z.data,disabled:Z.disabled}:null,J={active:rt,activatorEvent:ve,collisions:Se,delta:{x:Tt.x,y:Tt.y},over:W};Hl.unstable_batchedUpdates(()=>{X(W),ge==null||ge(J),_({type:"onDragOver",event:J})})},[xe]),lu(()=>{He.current={activatorEvent:K,active:H,activeNode:Ne,collisionRect:Ft,collisions:tn,droppableRects:se,draggableNodes:M,draggingNode:be,draggingNodeRect:Re,droppableContainers:O,over:D,scrollableAncestors:Te,scrollAdjustedTranslate:Bt},P.current={initial:Re,translated:Ft}},[H,Ne,tn,Ft,M,be,Re,se,O,D,Te,Bt]),Wnt({...Me,delta:N,draggingRect:Ft,pointerCoordinates:ot,scrollableAncestors:Te,scrollableAncestorRects:$e});const _t=A.useMemo(()=>({active:H,activeNode:Ne,activeNodeRect:Ue,activatorEvent:K,collisions:tn,containerNodeRect:nt,dragOverlay:Y,draggableNodes:M,droppableContainers:O,droppableRects:se,over:D,measureDroppableContainers:pe,scrollableAncestors:Te,scrollableAncestorRects:$e,measuringConfiguration:te,measuringScheduled:de,windowRect:ae}),[H,Ne,Ue,K,tn,nt,Y,M,O,se,D,pe,Te,$e,te,de,ae]),z=A.useMemo(()=>({activatorEvent:K,activators:yt,active:H,activeNodeRect:Ue,ariaDescribedById:{draggable:G},dispatch:w,draggableNodes:M,over:D,measureDroppableContainers:pe}),[K,yt,H,Ue,w,G,M,D,pe]);return ut.createElement(dce.Provider,{value:S},ut.createElement(VT.Provider,{value:z},ut.createElement(kce.Provider,{value:_t},ut.createElement(Ece.Provider,{value:De},c)),ut.createElement(mrt,{disabled:(o==null?void 0:o.restoreFocus)===!1})),ut.createElement(gnt,{...o,hiddenTextDescribedById:G}));function qe(){const rt=(Q==null?void 0:Q.autoScrollEnabled)===!1,ve=typeof l=="object"?l.enabled===!1:l===!1,Se=T&&!rt&&!ve;return typeof l=="object"?{...l,enabled:Se}:{enabled:Se}}}),xrt=A.createContext(null),fV="button",wrt="Draggable";function _rt(e){let{id:t,data:n,disabled:r=!1,attributes:i}=e;const s=F1(wrt),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=A.useContext(VT),{role:p=fV,roleDescription:y="draggable",tabIndex:b=0}=i??{},x=(l==null?void 0:l.id)===t,w=A.useContext(x?Ece:xrt),[_,S]=Mk(),[C,E]=Mk(),T=srt(a,t),R=_w(n);lu(()=>(d.set(t,{id:t,key:s,node:_,activatorNode:C,data:R}),()=>{const N=d.get(t);N&&N.key===s&&d.delete(t)}),[d,t]);const M=A.useMemo(()=>({role:p,tabIndex:b,"aria-disabled":r,"aria-pressed":x&&p===fV?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,p,b,x,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:M,isDragging:x,listeners:r?void 0:T,node:_,over:h,setNodeRef:S,setActivatorNodeRef:E,transform:w}}function Srt(){return A.useContext(kce)}const Crt="Droppable",krt={timeout:25};function Ert(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:i}=e;const s=F1(Crt),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=A.useContext(VT),u=A.useRef({disabled:n}),d=A.useRef(!1),h=A.useRef(null),p=A.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:x}={...krt,...i},w=_w(b??r),_=A.useCallback(()=>{if(!d.current){d.current=!0;return}p.current!=null&&clearTimeout(p.current),p.current=setTimeout(()=>{c(Array.isArray(w.current)?w.current:[w.current]),p.current=null},x)},[x]),S=qT({callback:_,disabled:y||!a}),C=A.useCallback((M,N)=>{S&&(N&&(S.unobserve(N),d.current=!1),M&&S.observe(M))},[S]),[E,T]=Mk(C),R=_w(t);return A.useEffect(()=>{!S||!E.current||(S.disconnect(),d.current=!1,S.observe(E.current))},[E,S]),A.useEffect(()=>(o({type:ws.RegisterDroppable,element:{id:r,key:s,disabled:n,node:E,rect:h,data:R}}),()=>o({type:ws.UnregisterDroppable,key:s,id:r})),[r]),A.useEffect(()=>{n!==u.current.disabled&&(o({type:ws.SetDroppableDisabled,id:r,key:s,disabled:n}),u.current.disabled=n)},[r,s,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:E,over:l,setNodeRef:T}}function Yv(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Trt(e,t){return e.reduce((n,r,i)=>{const s=t.get(r);return s&&(n[i]=s),n},Array(e.length))}function VS(e){return e!==null&&e>=0}function Art(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Rrt(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Tce=e=>{let{rects:t,activeIndex:n,overIndex:r,index:i}=e;const s=Yv(t,r,n),a=t[i],o=s[i];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},HS={scaleX:1,scaleY:1},Irt=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:a}=e;const o=(t=s[n])!=null?t:r;if(!o)return null;if(i===n){const c=s[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...HS}:null}const l=Mrt(s,i,n);return i>n&&i<=a?{x:0,y:-o.height-l,...HS}:i<n&&i>=a?{x:0,y:o.height+l,...HS}:{x:0,y:0,...HS}};function Mrt(e,t,n){const r=e[t],i=e[t-1],s=e[t+1];return r?n<t?i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const Ace="Sortable",Rce=ut.createContext({activeIndex:-1,containerId:Ace,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Tce,disabled:{draggable:!1,droppable:!1}});function Nrt(e){let{children:t,id:n,items:r,strategy:i=Tce,disabled:s=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=Srt(),d=F1(Ace,n),h=o.rect!==null,p=A.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),y=a!=null,b=a?p.indexOf(a.id):-1,x=c?p.indexOf(c.id):-1,w=A.useRef(p),_=!Art(p,w.current),S=x!==-1&&b===-1||_,C=Rrt(s);lu(()=>{_&&y&&u(p)},[_,p,y,u]),A.useEffect(()=>{w.current=p},[p]);const E=A.useMemo(()=>({activeIndex:b,containerId:d,disabled:C,disableTransforms:S,items:p,overIndex:x,useDragOverlay:h,sortedRects:Trt(p,l),strategy:i}),[b,d,C.draggable,C.droppable,S,p,x,l,h,i]);return ut.createElement(Rce.Provider,{value:E},t)}const jrt=e=>{let{id:t,items:n,activeIndex:r,overIndex:i}=e;return Yv(n,r,i).indexOf(t)},Ort=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:i,items:s,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==s&&i===a?!1:n?!0:a!==i&&t===l},Prt={duration:200,easing:"ease"},Ice="transform",Drt=Cw.Transition.toString({property:Ice,duration:0,easing:"linear"}),Frt={roleDescription:"sortable"};function Lrt(e){let{disabled:t,index:n,node:r,rect:i}=e;const[s,a]=A.useState(null),o=A.useRef(n);return lu(()=>{if(!t&&n!==o.current&&r.current){const l=i.current;if(l){const c=Fy(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,i]),A.useEffect(()=>{s&&a(null)},[s]),s}function Brt(e){let{animateLayoutChanges:t=Ort,attributes:n,disabled:r,data:i,getNewIndex:s=jrt,id:a,strategy:o,resizeObserverConfig:l,transition:c=Prt}=e;const{items:u,containerId:d,activeIndex:h,disabled:p,disableTransforms:y,sortedRects:b,overIndex:x,useDragOverlay:w,strategy:_}=A.useContext(Rce),S=$rt(r,p),C=u.indexOf(a),E=A.useMemo(()=>({sortable:{containerId:d,index:C,items:u},...i}),[d,i,C,u]),T=A.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:R,node:M,isOver:N,setNodeRef:O}=Ert({id:a,data:E,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...l}}),{active:B,activatorEvent:P,activeNodeRect:H,attributes:F,setNodeRef:Q,listeners:q,isDragging:K,over:U,setActivatorNodeRef:re,transform:G}=_rt({id:a,data:E,attributes:{...Frt,...n},disabled:S.draggable}),ne=rnt(O,Q),te=!!B,se=te&&!y&&VS(h)&&VS(x),pe=!w&&K,de=pe&&se?G:null,Pe=se?de??(o??_)({rects:b,activeNodeRect:H,activeIndex:h,overIndex:x,index:C}):null,Me=VS(h)&&VS(x)?s({id:a,items:u,activeIndex:h,overIndex:x}):C,Ee=B==null?void 0:B.id,Ue=A.useRef({activeId:Ee,items:u,newIndex:Me,containerId:d}),nt=u!==Ue.current.items,He=t({active:B,containerId:d,isDragging:K,isSorting:te,id:a,index:C,items:u,newIndex:Ue.current.newIndex,previousItems:Ue.current.items,previousContainerId:Ue.current.containerId,transition:c,wasDragging:Ue.current.activeId!=null}),je=Lrt({disabled:!He,index:C,node:M,rect:R});return A.useEffect(()=>{te&&Ue.current.newIndex!==Me&&(Ue.current.newIndex=Me),d!==Ue.current.containerId&&(Ue.current.containerId=d),u!==Ue.current.items&&(Ue.current.items=u)},[te,Me,d,u]),A.useEffect(()=>{if(Ee===Ue.current.activeId)return;if(Ee!=null&&Ue.current.activeId==null){Ue.current.activeId=Ee;return}const be=setTimeout(()=>{Ue.current.activeId=Ee},50);return()=>clearTimeout(be)},[Ee]),{active:B,activeIndex:h,attributes:F,data:E,rect:R,index:C,newIndex:Me,items:u,isOver:N,isSorting:te,isDragging:K,listeners:q,node:M,overIndex:x,over:U,setNodeRef:ne,setActivatorNodeRef:re,setDroppableNodeRef:O,setDraggableNodeRef:Q,transform:je??Pe,transition:Y()};function Y(){if(je||nt&&Ue.current.newIndex===C)return Drt;if(!(pe&&!t5(P)||!c)&&(te||He))return Cw.Transition.toString({...c,property:Ice})}}function $rt(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Ok(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const zrt=[Or.Down,Or.Right,Or.Up,Or.Left],Urt=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:i,droppableContainers:s,over:a,scrollableAncestors:o}}=t;if(zrt.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];s.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=i.get(d.id);if(h)switch(e.code){case Or.Down:r.top<h.top&&l.push(d);break;case Or.Up:r.top>h.top&&l.push(d);break;case Or.Left:r.left>h.left&&l.push(d);break;case Or.Right:r.left<h.left&&l.push(d);break}});const c=xnt({collisionRect:r,droppableRects:i,droppableContainers:l});let u=pce(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=s.get(n.id),h=s.get(u),p=h?i.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&p&&d&&h){const x=UT(y).some((T,R)=>o[R]!==T),w=Mce(d,h),_=qrt(d,h),S=x||!w?{x:0,y:0}:{x:_?r.width-p.width:0,y:_?r.height-p.height:0},C={x:p.left,y:p.top};return S.x&&S.y?C:Sw(C,S)}}}};function Mce(e,t){return!Ok(e)||!Ok(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function qrt(e,t){return!Ok(e)||!Ok(t)||!Mce(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const Vrt=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:i,onMoveDown:s,isFirst:a,isLast:o})=>{var E,T,R;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:p}=Brt({id:e,disabled:!1}),y={transform:Cw.Transform.toString(d),transition:h,zIndex:p?10:void 0},b=new Set(((E=t.metadataSummary)==null?void 0:E.supported_parameters)??[]),x=new Set(((T=t.metadataSummary)==null?void 0:T.input_modalities)??[]),w=b.has("reasoning"),_=b.has("web_search")||b.has("web_search_options"),S=b.has("tools"),C=Array.from(x).some(M=>M!=="text");return m.jsxs("div",{ref:u,style:y,className:dt("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",p&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[m.jsx("button",{...l,...c,type:"button",className:dt("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:m.jsx(phe,{className:"h-5 w-5 text-muted-foreground"})}),m.jsxs("div",{className:"flex-grow min-w-0",children:[m.jsxs(Jt,{className:dt("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",m.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),m.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[w&&m.jsx(sh,{className:"h-3 w-3 text-blue-500"}),_&&m.jsx(va,{className:"h-3 w-3 text-green-500"}),S&&m.jsx(Rp,{className:"h-3 w-3 text-orange-500"}),C&&m.jsx(Tp,{className:"h-3 w-3 text-purple-500"})]})]}),m.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((R=t.metadataSummary)==null?void 0:R.description)&&m.jsx(hr,{delayDuration:100,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:m.jsx(tO,{className:"h-4 w-4"})})}),m.jsx(yr,{side:"top",align:"end",className:"max-w-xs break-words",children:m.jsx("p",{children:t.metadataSummary.description})})]})}),m.jsx(Rn,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:m.jsx(yfe,{}),className:"h-6 w-6"}),m.jsx(Rn,{tooltipText:"Move Up",onClick:()=>i(e),disabled:a||n,icon:m.jsx(sfe,{}),className:"h-6 w-6"}),m.jsx(Rn,{tooltipText:"Move Down",onClick:()=>s(e),disabled:o||n,icon:m.jsx(DV,{}),className:"h-6 w-6"})]})]})},Hrt=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:i}=Er(Cn(N=>({dbProviderConfigs:N.dbProviderConfigs,globalModelSortOrder:N.globalModelSortOrder,isLoading:N.isLoading,getAvailableModelListItems:N.getAvailableModelListItems}))),[s,a]=A.useState(""),[o,l]=A.useState(!1),[c,u]=A.useState(()=>new Set(t.map(N=>N.id))),[d,h]=A.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});A.useEffect(()=>{u(new Set(t.map(N=>N.id)))},[t]);const p=A.useMemo(()=>{const N=i(),O=new Map(N.map(Q=>[Q.id,Q])),B=new Set;t.forEach(Q=>{Q.isEnabled&&Q.enabledModels&&Q.enabledModels.forEach(q=>{B.add(Rv(Q.id,q))})});const P=N.filter(Q=>B.has(Q.id)),H=[],F=new Set;return n.forEach(Q=>{if(B.has(Q)){const q=O.get(Q);q&&!F.has(Q)&&(H.push(q),F.add(Q))}}),P.forEach(Q=>{F.has(Q.id)||H.push(Q)}),H},[t,n,i]),y=A.useMemo(()=>{let N=p;if(c.size!==t.length&&(N=N.filter(B=>c.has(B.providerId))),s.trim()){const B=s.toLowerCase();N=N.filter(P=>P.name.toLowerCase().includes(B)||P.providerName.toLowerCase().includes(B)||P.id.toLowerCase().includes(B))}const O=Object.entries(d).filter(([,B])=>B).map(([B])=>B);return O.length>0&&(N=N.filter(B=>{var F,Q;const P=new Set(((F=B.metadataSummary)==null?void 0:F.supported_parameters)??[]),H=new Set(((Q=B.metadataSummary)==null?void 0:Q.input_modalities)??[]);return O.every(q=>{switch(q){case"reasoning":return P.has("reasoning");case"webSearch":return P.has("web_search")||P.has("web_search_options");case"tools":return P.has("tools");case"multimodal":return Array.from(H).some(K=>K!=="text");default:return!0}})})),N},[p,s,c,t.length,d]),b=s.trim().length>0||c.size!==t.length||Object.values(d).some(Boolean),x=A.useMemo(()=>y.map(N=>N.id),[y]),w=A.useCallback(N=>{const{active:O,over:B}=N;if(B&&O.id!==B.id){const P=p.map(K=>K.id),H=O.id,F=B.id,Q=P.indexOf(H),q=P.indexOf(F);if(Q!==-1&&q!==-1){const K=Yv(P,Q,q);e(K)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[p,e]),_=A.useCallback((N,O)=>{if(b)return;const B=p.map(F=>F.id),P=B.indexOf(N);if(P===-1)return;let H;if(O==="top"){if(P===0)return;const F=B.splice(P,1)[0];B.unshift(F),H=B}else if(O==="up"){if(P===0)return;H=Yv(B,P,P-1)}else{if(P===B.length-1)return;H=Yv(B,P,P+1)}e(H)},[p,e,b]),S=ynt(eV(s5),eV(r5,{coordinateGetter:Urt})),C=A.useCallback((N,O)=>{u(B=>{const P=new Set(B);return O?P.add(N):P.delete(N),P})},[]),E=N=>{h(O=>({...O,[N]:!O[N]}))},T=c.size!==t.length?1:0,R=Object.values(d).filter(Boolean).length,M=T+R;return r?m.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[m.jsx(Pr,{className:"h-8 w-1/3"}),m.jsx(Pr,{className:"h-6 w-1/2"}),m.jsx(Pr,{className:"h-64 w-full"})]}):m.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),m.jsx(_d,{}),m.jsxs("div",{className:"space-y-3",children:[m.jsx(Jt,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("div",{className:"relative flex-grow",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter models by name or provider...",value:s,onChange:N=>a(N.target.value),className:"pl-8 w-full h-9",disabled:r})]}),m.jsxs(Al,{open:o,onOpenChange:l,children:[m.jsx(Rl,{asChild:!0,children:m.jsxs(Et,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:r||t.length===0,children:[m.jsx(J4,{className:"h-4 w-4 mr-1"}),"Filters",M>0&&m.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:M})]})}),m.jsx(Il,{className:"w-64 p-0",children:m.jsxs("div",{className:"p-2 space-y-3",children:[m.jsxs("div",{children:[m.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),m.jsx(Sa,{className:"h-32 border rounded-md p-1",children:t.map(N=>m.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[m.jsx(ou,{id:`organizer-provider-filter-${N.id}`,checked:c.has(N.id),onCheckedChange:O=>C(N.id,!!O)}),m.jsxs(Jt,{htmlFor:`organizer-provider-filter-${N.id}`,className:"text-sm font-normal cursor-pointer",children:[N.name," (",N.type,")"]})]},N.id))})]}),m.jsxs("div",{children:[m.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),m.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[m.jsx(Rn,{tooltipText:"Reasoning",icon:m.jsx(sh,{}),onClick:()=>E("reasoning"),variant:d.reasoning?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",d.reasoning&&"text-primary"),children:"Reasoning"}),m.jsx(Rn,{tooltipText:"Web Search",icon:m.jsx(va,{}),onClick:()=>E("webSearch"),variant:d.webSearch?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",d.webSearch&&"text-primary"),children:"Web"}),m.jsx(Rn,{tooltipText:"Tools",icon:m.jsx(Rp,{}),onClick:()=>E("tools"),variant:d.tools?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",d.tools&&"text-primary"),children:"Tools"}),m.jsx(Rn,{tooltipText:"Multimodal",icon:m.jsx(Tp,{}),onClick:()=>E("multimodal"),variant:d.multimodal?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",d.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),m.jsx(Sa,{className:"h-[calc(20*2.75rem+2px)] w-full rounded-md border border-border p-3 bg-background/50",children:y.length>0?m.jsx(vrt,{sensors:S,collisionDetection:vnt,onDragEnd:w,children:m.jsx(Nrt,{items:x,strategy:Irt,children:y.map(N=>m.jsx(Vrt,{id:N.id,modelDetails:N,onMoveToTop:()=>_(N.id,"top"),onMoveUp:()=>_(N.id,"up"),onMoveDown:()=>_(N.id,"down"),isFirst:p.findIndex(O=>O.id===N.id)===0,isLast:p.findIndex(O=>O.id===N.id)===p.length-1,buttonsDisabled:b},N.id))})}):m.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:b?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},WS=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},ll=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:m.jsxs(Pi,{children:[m.jsx(cr,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),m.jsx(cr,{className:"text-xs py-1.5 px-3 break-all",children:n?m.jsx(If,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?m.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((i,s)=>m.jsx(If,{variant:"outline",className:"text-xs",children:String(i)},s))}):String(t)})]}),Wrt=({modelId:e})=>{var p,y,b,x,w,_,S,C,E,T,R,M;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:i,isLoading:s}=Er(Cn(N=>({createAiModelConfig:N.createAiModelConfig,dbProviderConfigs:N.dbProviderConfigs,dbApiKeys:N.dbApiKeys,updateProviderConfig:N.updateProviderConfig,isLoading:N.isLoading}))),a=A.useMemo(()=>{if(!e)return;const{providerId:N,modelId:O}=Xl(e);if(!N||!O)return;const B=n.find(H=>H.id===N);if(!B)return;const P=r.find(H=>H.id===B.apiKeyId);return t(B,O,P==null?void 0:P.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=A.useCallback(async()=>{if(!a||!e)return;const{providerId:N,modelId:O}=Xl(e);if(!N||!O)return;const B=n.find(Q=>Q.id===N);if(!B){Fe.error("Provider configuration not found.");return}const P=new Set(B.enabledModels??[]),H=P.has(O);H?P.delete(O):P.add(O);const F=Array.from(P);try{await i(B.id,{enabledModels:F}),Fe.success(`Model "${a.name}" ${H?"disabled":"enabled"}.`)}catch{Fe.error("Failed to update model status.")}},[a,e,n,i]);if(s)return m.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[m.jsx(Pr,{className:"h-8 w-3/4 flex-shrink-0"}),m.jsx(Pr,{className:"h-4 w-1/2 flex-shrink-0"}),m.jsxs("div",{className:"flex-grow space-y-2",children:[m.jsx(Pr,{className:"h-10 w-full"}),m.jsx(Pr,{className:"h-10 w-full"}),m.jsx(Pr,{className:"h-10 w-full"}),m.jsx(Pr,{className:"h-10 w-full"})]})]});if(!e)return m.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[m.jsx(nc,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),m.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return m.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[m.jsx(nc,{className:"mx-auto h-10 w-10 mb-2"}),m.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=Xl(e),d=n.find(N=>N.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((p=d==null?void 0:d.enabledModels)==null?void 0:p.includes(u))===!0;return m.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[m.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[m.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,m.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Jt,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),m.jsx(Qc,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&m.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),m.jsx(Sa,{className:"flex-grow border rounded-md bg-background/30",children:m.jsxs(hm,{children:[m.jsxs(HXe,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),m.jsxs(pm,{children:[ll("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),ll("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),ll("Input Modalities",(x=o.architecture)==null?void 0:x.input_modalities),ll("Output Modalities",(w=o.architecture)==null?void 0:w.output_modalities),ll("Tokenizer",(_=o.architecture)==null?void 0:_.tokenizer,!0),ll("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),ll("Pricing (Prompt)",WS((C=o.pricing)==null?void 0:C.prompt)),ll("Pricing (Completion)",WS((E=o.pricing)==null?void 0:E.completion)),ll("Pricing (Image)",WS((T=o.pricing)==null?void 0:T.image)),ll("Pricing (Request)",WS((R=o.pricing)==null?void 0:R.request)),ll("Supported Parameters",o.supported_parameters),ll("Moderated",(M=o.top_provider)!=null&&M.is_moderated?m.jsx(Dk,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},Grt=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Er(Cn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[i,s]=A.useState(!1),[a,o]=A.useState(!1),[l,c]=A.useState({}),u=A.useCallback(async(h,p,y)=>{o(!0);try{await t(h,p,y),s(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=A.useCallback(async(h,p)=>{if(window.confirm(`Are you sure you want to delete the API key "${p}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),m.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!i&&m.jsxs(Et,{onClick:()=>s(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[m.jsx(W0,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),i&&m.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[m.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),m.jsx(oae,{onSave:u,onCancel:()=>s(!1),disabled:a})]}),m.jsxs("div",{children:[m.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!i?m.jsxs("div",{className:"space-y-2",children:[m.jsx(Pr,{className:"h-10 w-full"}),m.jsx(Pr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!i?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):m.jsx("div",{className:"border rounded-md overflow-hidden",children:m.jsxs(hm,{children:[m.jsx(jy,{children:m.jsxs(Pi,{children:[m.jsx(pi,{children:"Name"}),m.jsx(pi,{children:"Provider Type"}),m.jsx(pi,{children:"Created"}),m.jsx(pi,{className:"text-right",children:"Actions"})]})}),m.jsx(pm,{children:(e||[]).map(h=>{const p=l[h.id];return m.jsxs(Pi,{className:p?"opacity-50":"",children:[m.jsx(cr,{className:"font-medium",children:h.name||"Unnamed Key"}),m.jsx(cr,{children:h.providerId||"Unknown"}),m.jsx(cr,{className:"text-xs text-muted-foreground",children:ej(new Date(h.createdAt),"PPp")}),m.jsx(cr,{className:"text-right",children:m.jsx(Rn,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:p,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:p?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Fo,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},Krt=ut.memo(Grt),Yrt=({onSelectModelForDetails:e})=>{const[t,n]=A.useState(null),[r,i]=A.useState(null),s=A.useCallback(O=>{if(O){n(O);const B=O.querySelector("[data-radix-scroll-area-viewport]");if(B)i(B);else{const P=new MutationObserver(()=>{const H=O.querySelector("[data-radix-scroll-area-viewport]");H&&(i(H),P.disconnect())});return P.observe(O,{childList:!0,subtree:!0}),()=>P.disconnect()}}else n(null),i(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Er(Cn(O=>({getAvailableModelListItems:O.getAvailableModelListItems,isLoading:O.isLoading,dbProviderConfigs:O.dbProviderConfigs}))),[c,u]=A.useState(""),[d,h]=A.useState(!1),[p,y]=A.useState(()=>new Set(l.map(O=>O.id))),[b,x]=A.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),w=A.useMemo(()=>a(),[a]);A.useEffect(()=>{y(new Set(l.map(O=>O.id)))},[l]);const _=A.useMemo(()=>{let O=w;if(p.size!==l.length&&(O=O.filter(P=>p.has(P.providerId))),c.trim()){const P=c.toLowerCase();O=O.filter(H=>H.name.toLowerCase().includes(P)||H.providerName.toLowerCase().includes(P)||H.id.toLowerCase().includes(P))}const B=Object.entries(b).filter(([,P])=>P).map(([P])=>P);return B.length>0&&(O=O.filter(P=>{var Q,q;const H=new Set(((Q=P.metadataSummary)==null?void 0:Q.supported_parameters)??[]),F=new Set(((q=P.metadataSummary)==null?void 0:q.input_modalities)??[]);return B.every(K=>{switch(K){case"reasoning":return H.has("reasoning");case"webSearch":return H.has("web_search")||H.has("web_search_options");case"tools":return H.has("tools");case"multimodal":return Array.from(F).some(U=>U!=="text");default:return!0}})})),O.sort((P,H)=>{const F=P.providerName.localeCompare(H.providerName);return F!==0?F:P.name.localeCompare(H.name)})},[w,c,p,l.length,b]),S=j6({count:_.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),C=A.useCallback((O,B)=>{y(P=>{const H=new Set(P);return B?H.add(O):H.delete(O),H})},[]),E=O=>{x(B=>({...B,[O]:!B[O]}))},T=O=>{e(O)},R=p.size!==l.length?1:0,M=Object.values(b).filter(Boolean).length,N=R+M;return o?m.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[m.jsx(Pr,{className:"h-9 w-full flex-shrink-0"}),m.jsx(Pr,{className:"h-full w-full flex-grow"})]}):m.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[m.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[m.jsxs("div",{className:"relative flex-grow",children:[m.jsx(va,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),m.jsx(ur,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:O=>u(O.target.value),className:"pl-8 w-full h-9",disabled:o})]}),m.jsxs(Al,{open:d,onOpenChange:h,children:[m.jsx(Rl,{asChild:!0,children:m.jsxs(Et,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:o||l.length===0,children:[m.jsx(J4,{className:"h-4 w-4 mr-1"}),"Filters",N>0&&m.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:N})]})}),m.jsx(Il,{className:"w-64 p-0",children:m.jsxs("div",{className:"p-2 space-y-3",children:[m.jsxs("div",{children:[m.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),m.jsx(Sa,{className:"h-32 border rounded-md p-1",children:l.map(O=>m.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[m.jsx(ou,{id:`model-browser-provider-filter-${O.id}`,checked:p.has(O.id),onCheckedChange:B=>C(O.id,!!B)}),m.jsxs(Jt,{htmlFor:`model-browser-provider-filter-${O.id}`,className:"text-sm font-normal cursor-pointer",children:[O.name," (",O.type,")"]})]},O.id))})]}),m.jsxs("div",{children:[m.jsx(Jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Capabilities"}),m.jsxs("div",{className:"flex flex-wrap gap-1 p-1 border rounded-md",children:[m.jsx(Rn,{tooltipText:"Reasoning",icon:m.jsx(sh,{}),onClick:()=>E("reasoning"),variant:b.reasoning?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",b.reasoning&&"text-primary"),children:"Reasoning"}),m.jsx(Rn,{tooltipText:"Web Search",icon:m.jsx(va,{}),onClick:()=>E("webSearch"),variant:b.webSearch?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",b.webSearch&&"text-primary"),children:"Web"}),m.jsx(Rn,{tooltipText:"Tools",icon:m.jsx(Rp,{}),onClick:()=>E("tools"),variant:b.tools?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",b.tools&&"text-primary"),children:"Tools"}),m.jsx(Rn,{tooltipText:"Multimodal",icon:m.jsx(Tp,{}),onClick:()=>E("multimodal"),variant:b.multimodal?"secondary":"outline",className:dt("h-7 w-auto px-2 text-xs",b.multimodal&&"text-primary"),children:"Multimodal"})]})]})]})})]})]}),m.jsxs(Sa,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:s,children:[r&&m.jsx("div",{style:{height:`${S.getTotalSize()}px`,width:"100%",position:"relative"},children:_.length===0&&!o?m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):S.getVirtualItems().map(O=>{var P;const B=_[O.index];return B?m.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${O.size}px`,transform:`translateY(${O.start}px)`},className:"p-1",children:m.jsx(hr,{delayDuration:300,children:m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>T(B.id),children:[m.jsx("span",{className:"text-sm font-medium truncate",children:B.name}),m.jsx("span",{className:"text-xs text-muted-foreground truncate",children:B.providerName})]})}),((P=B.metadataSummary)==null?void 0:P.description)&&m.jsx(yr,{side:"bottom",align:"start",className:"max-w-xs",children:m.jsx("p",{children:B.metadataSummary.description})})]})})},B.id):null})}),!r&&!o&&m.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},Zrt=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:i,providerFetchStatus:s,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Er(Cn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=A.useState(!1),d=()=>u(!0),h=A.useCallback(()=>u(!1),[]),p=A.useCallback(async b=>{await i(b)},[i]),y=A.useMemo(()=>a||[],[a]);return m.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),m.jsx("div",{className:"flex-shrink-0",children:c?m.jsx(pae,{apiKeys:o||[],onAddProvider:t,onCancel:h}):m.jsxs(Et,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[m.jsx(W0,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),m.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:m.jsxs("div",{className:"space-y-2",children:[l&&!c?m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[m.jsx(Pr,{className:"h-24 w-full"}),m.jsx(Pr,{className:"h-24 w-full"}),m.jsx(Pr,{className:"h-24 w-full"})]}):m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>m.jsx(nnt,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:p,fetchStatus:s[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&m.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},Xrt=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Er(Cn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,i]=A.useState("providers-config"),s=A.useCallback(o=>{n(o),o&&i("providers-details-current")},[n,i]),a=A.useMemo(()=>[{value:"providers-config",label:"Configuration",content:m.jsx(Zrt,{onSelectModelForDetails:s})},{value:"providers-order",label:"Model Order",content:m.jsx(Hrt,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:m.jsx(Krt,{})},{value:"providers-details-current",label:"Selected Model",content:m.jsx(Wrt,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:m.jsx(Yrt,{onSelectModelForDetails:s})}],[t,s,e]);return m.jsx(Md,{tabs:a,initialValue:r,onValueChange:i,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},Jrt=ut.memo(Xrt);class Qrt{constructor(){_e(this,"id","core-provider-settings");_e(this,"modApiRef",null);_e(this,"eventUnsubscribers",[]);_e(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(ir.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>ut.createElement(Jrt,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const eit=L.object({globalSystemPrompt:L.string()});function tit({field:e}){return m.jsx(m.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?m.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const nit=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=dr(Cn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=Vs({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:eit,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),Fe.success("Global system prompt updated!")}catch(i){Fe.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",i)}}});return A.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),m.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[m.jsx("div",{children:m.jsx(n.Field,{name:"globalSystemPrompt",children:r=>m.jsxs(m.Fragment,{children:[m.jsx(Jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),m.jsx(Id,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:i=>r.handleChange(i.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),m.jsx(tit,{field:r})]})})}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,i,s,a])=>m.jsx(Et,{type:"submit",size:"sm",disabled:!r||i||s||!a,children:i?"Saving...":s?"Validating...":"Save Prompt"})})})]})},rit=L.object({temperature:L.number().min(0).max(1),topP:L.number().min(0).max(1),maxTokens:L.number().min(1).nullable(),topK:L.number().min(1).nullable(),presencePenalty:L.number().min(-2).max(2),frequencyPenalty:L.number().min(-2).max(2)}),iit=()=>{const e=dr(Cn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=Vs({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:rit,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),Fe.success("Assistant parameters updated!")}catch(r){Fe.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return A.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),m.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[m.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),m.jsx(Kl,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),m.jsx(Kl,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[m.jsx(q0,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),m.jsx(q0,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),m.jsx(Kl,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),m.jsx(Kl,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),m.jsxs("div",{className:"flex justify-end space-x-2",children:[m.jsx(Et,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),m.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>m.jsx(Et,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},sit=L.object({toolMaxSteps:L.number({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function ait({field:e}){return m.jsx(m.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?m.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const oit=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=dr(Cn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=Vs({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:sit,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),Fe.success("Tool settings updated!")}catch(i){Fe.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",i)}}});return A.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),m.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[m.jsx(n.Field,{name:"toolMaxSteps",children:r=>m.jsxs("div",{children:[m.jsx(Jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),m.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),m.jsx(ur,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:i=>{const s=i.target.valueAsNumber;isNaN(s)?i.target.value===""&&r.handleChange(void 0):r.handleChange(s)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),m.jsx(ait,{field:r})]})}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,i,s,a])=>m.jsx(Et,{type:"submit",size:"sm",disabled:!r||i||s||!a,children:i?"Saving...":s?"Validating...":"Save Tool Settings"})})})]})},lit=L.object({autoTitleEnabled:L.boolean(),autoTitleModelId:L.string().nullable(),autoTitlePromptMaxLength:L.number().min(100).max(4e3),autoTitleIncludeFiles:L.boolean(),autoTitleIncludeRules:L.boolean()});function fv({field:e}){return m.jsx(m.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?m.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const cit=()=>{const e=dr(Cn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=Vs({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:lit,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),Fe.success("Auto-title settings updated!")}catch(r){Fe.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return A.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),m.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[m.jsx(t.Field,{name:"autoTitleEnabled",children:n=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Qc,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),m.jsx(Jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),m.jsx(fv,{field:n})]})}),t.state.values.autoTitleEnabled&&m.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[m.jsx(t.Field,{name:"autoTitleModelId",children:n=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:n.name,children:"Model for Title Generation"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),m.jsx(X6,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),m.jsx(fv,{field:n})]})}),m.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>m.jsxs("div",{className:"space-y-1.5",children:[m.jsx(Jt,{htmlFor:n.name,children:"Conversation Content Length Limit"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),m.jsx(ur,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const i=r.target.valueAsNumber;isNaN(i)||n.handleChange(i)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),m.jsx(fv,{field:n})]})}),m.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Qc,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),m.jsx(Jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),m.jsx(fv,{field:n})]})}),m.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Qc,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),m.jsx(Jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),m.jsx(fv,{field:n})]})})]}),m.jsx("div",{className:"flex justify-end pt-2",children:m.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,i,s])=>m.jsx(Et,{type:"submit",size:"sm",disabled:!n||r||i||!s,children:r?"Saving...":i?"Validating...":"Save Title Settings"})})})]})},uit=()=>{const{resetAssistantSettings:e}=dr(Cn(r=>({resetAssistantSettings:r.resetAssistantSettings}))),t=()=>{window.confirm("Are you sure you want to reset all Assistant settings (Prompt, Parameters, Tools, Auto-Title) to their defaults?")&&e()},n=A.useMemo(()=>[{value:"prompt",label:"System Prompt",content:m.jsx(nit,{})},{value:"parameters",label:"Parameters",content:m.jsx(iit,{})},{value:"tools",label:"Tools",content:m.jsx(oit,{})},{value:"titles",label:"Auto-Titles",content:m.jsx(cit,{})}],[]);return m.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[m.jsx(Md,{tabs:n,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3 flex-grow overflow-y-auto",scrollable:!0}),m.jsx(_d,{className:"mt-auto"}),m.jsx("div",{className:"flex justify-end pt-3 flex-shrink-0",children:m.jsxs(Et,{variant:"outline",size:"sm",onClick:t,children:[m.jsx(rO,{className:"mr-2 h-4 w-4"}),"Reset All Assistant Settings"]})})]})},dit=ut.memo(uit);class fit{constructor(){_e(this,"id","core-settings-assistant");_e(this,"unregisterCallback",null);_e(this,"modApiRef",null);_e(this,"eventUnsubscribers",[]);_e(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=dr.getState().enableAdvancedSettings;const n=t.on(nn.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:dit,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const hit=L.object({importSettings:L.boolean(),importApiKeys:L.boolean(),importProviderConfigs:L.boolean(),importProjects:L.boolean(),importConversations:L.boolean(),importRulesAndTags:L.boolean(),importMods:L.boolean(),importSyncRepos:L.boolean()}),pit=L.object({importSettings:L.boolean(),importApiKeys:L.boolean(),importProviderConfigs:L.boolean(),importProjects:L.boolean(),importConversations:L.boolean(),importRulesAndTags:L.boolean(),importMods:L.boolean(),importSyncRepos:L.boolean()}),mit=()=>{const{importConversation:e,exportAllConversations:t}=Dn(Cn(M=>({importConversation:M.importConversation,exportAllConversations:M.exportAllConversations}))),n=A.useRef(null),r=A.useRef(null),[i,s]=A.useState(!1),[a,o]=A.useState(!1),[l,c]=A.useState(!1),[u,d]=A.useState(!1),[h,p]=A.useState(!1),y=Vs({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:hit}}),b=Vs({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0},validators:{onChange:pit}}),x=()=>{var M;(M=n.current)==null||M.click()},w=()=>{var M;(M=r.current)==null||M.click()},_=A.useCallback(async M=>{var O;const N=(O=M.target.files)==null?void 0:O[0];if(N){s(!0);try{await e(N)}catch(B){console.error("Import failed (from component):",B)}finally{n.current&&(n.current.value=""),s(!1)}}},[e]),S=A.useCallback(async M=>{var O;const N=(O=M.target.files)==null?void 0:O[0];if(N){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}p(!0);try{await Ng.importFullConfiguration(N,y.state.values)}catch(B){console.error("Full import failed (from component):",B)}finally{r.current&&(r.current.value=""),p(!1)}}},[y]),C=A.useCallback(async()=>{o(!0);try{await t()}catch(M){console.error("Export all failed (from component):",M)}finally{o(!1)}},[t]),E=A.useCallback(async()=>{d(!0);try{await Ng.exportFullConfiguration(b.state.values)}catch(M){console.error("Full export failed (from component):",M)}finally{d(!1)}},[b]),T=A.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await Rt.clearAllData(),Fe.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(M){const N="Failed to clear all data";console.error(N,M),Fe.error(`${N}: ${M instanceof Error?M.message:String(M)}`),c(!1)}}},[]),R=(M,N,O,B,P,H)=>{const F=`${H}-${N}-checkbox`;return m.jsx(M.Field,{name:N,children:Q=>m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(ou,{id:F,checked:Q.state.value,onCheckedChange:q=>Q.handleChange(!!q),disabled:P}),m.jsxs(Jt,{htmlFor:F,className:"text-sm font-normal flex items-center gap-1.5",children:[m.jsx(B,{className:"h-4 w-4 text-muted-foreground"})," ",O]})]})},N)};return m.jsxs("div",{className:"space-y-4 p-1",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[m.jsx(Jt,{className:"font-semibold",children:"Import Conversation"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),m.jsx("input",{type:"file",ref:n,onChange:_,accept:".json",className:"hidden",id:"import-file-input",disabled:i}),m.jsxs(Et,{onClick:x,variant:"outline",size:"sm",disabled:i,children:[i?m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(YV,{className:"mr-2 h-4 w-4"}),i?"Importing...":"Select File..."]})]}),m.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[m.jsx(Jt,{className:"font-semibold",children:"Export All Conversations"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),m.jsxs(Et,{onClick:C,variant:"outline",size:"sm",disabled:a,children:[a?m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(Gc,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),m.jsx(_d,{}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[m.jsx(Jt,{className:"font-semibold",children:"Import Full Configuration"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),m.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(y,"importSettings","Settings",h3,h,"import"),R(y,"importApiKeys","API Keys",Zv,h,"import"),R(y,"importProviderConfigs","Providers",A2,h,"import"),R(y,"importProjects","Projects",yL,h,"import"),R(y,"importConversations","Conversations",f3,h,"import"),R(y,"importRulesAndTags","Rules & Tags",p3,h,"import"),R(y,"importMods","Mods",xL,h,"import"),R(y,"importSyncRepos","Sync Repos",rc,h,"import")]}),m.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),m.jsxs(Et,{onClick:w,variant:"outline",size:"sm",disabled:h,children:[h?m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(Xfe,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),m.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[m.jsx(Jt,{className:"font-semibold",children:"Export Full Configuration"}),m.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),m.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[R(b,"importSettings","Settings",h3,u,"export"),R(b,"importApiKeys","API Keys",Zv,u,"export"),R(b,"importProviderConfigs","Providers",A2,u,"export"),R(b,"importProjects","Projects",yL,u,"export"),R(b,"importConversations","Conversations",f3,u,"export"),R(b,"importRulesAndTags","Rules & Tags",p3,u,"export"),R(b,"importMods","Mods",xL,u,"export"),R(b,"importSyncRepos","Sync Repos",rc,u,"export")]}),m.jsxs(Et,{onClick:E,variant:"secondary",size:"sm",disabled:u,children:[u?m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(qfe,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),m.jsx(_d,{}),m.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[m.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),m.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),m.jsxs(Et,{onClick:T,variant:"destructive",disabled:l,children:[l?m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}):m.jsx(Fo,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},git=ut.memo(mit);class yit{constructor(){_e(this,"id","core-settings-data");_e(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:git,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const bit=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:i,isLoading:s}=rh(Cn(T=>({loadedMods:T.loadedMods,addDbMod:T.addDbMod,updateDbMod:T.updateDbMod,deleteDbMod:T.deleteDbMod,dbMods:T.dbMods,isLoading:T.isLoading}))),[a,o]=A.useState(""),[l,c]=A.useState(""),[u,d]=A.useState(""),[h,p]=A.useState(!1),[y,b]=A.useState({}),[x,w]=A.useState({}),_=A.useCallback(async()=>{if(!a.trim()){Fe.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){Fe.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){Fe.error("Provide either a Mod URL or Script Content, not both.");return}p(!0);try{const T={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((i==null?void 0:i.length)??1)*10};await t(T),o(""),c(""),d(""),Fe.info("Mod added. Reload required for changes to take effect.")}catch(T){console.error("Failed to add mod (from component):",T)}finally{p(!1)}},[a,l,u,t,i==null?void 0:i.length]),S=A.useCallback(async T=>{b(R=>({...R,[T.id]:!0}));try{await n(T.id,{enabled:!T.enabled}),Fe.info(`Mod "${T.name}" ${T.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(R){console.error("Failed to update mod (from component):",R)}finally{b(R=>({...R,[T.id]:!1}))}},[n]),C=A.useCallback(async T=>{if(window.confirm(`Are you sure you want to delete the mod "${T.name}"? This cannot be undone.`)){w(R=>({...R,[T.id]:!0}));try{await r(T.id),Fe.info("Mod deleted. Reload required for changes to take effect.")}catch(R){console.error("Failed to delete mod (from component):",R)}finally{w(R=>({...R,[T.id]:!1}))}}},[r]),E=A.useCallback(T=>{const R=e.find(N=>N.id===T);if(R)if(R.error){const N=R.error instanceof Error?R.error.message:String(R.error);return{status:"Error",error:R.error,tooltip:N}}else return{status:"Loaded"};const M=(i||[]).find(N=>N.id===T);return M?M.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,i]);return m.jsxs("div",{className:"space-y-6 p-1",children:[m.jsxs(Vle,{variant:"destructive",className:"border-destructive/50",children:[m.jsx(iO,{className:"h-4 w-4"}),m.jsx(Hle,{children:"Security Warning"}),m.jsx(Wle,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),m.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Jt,{htmlFor:"mod-name",children:"Mod Name"}),m.jsx(ur,{id:"mod-name",value:a,onChange:T=>o(T.target.value),placeholder:"My Awesome Mod",disabled:h})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Jt,{htmlFor:"mod-url",children:"Source URL (Optional)"}),m.jsx(ur,{id:"mod-url",type:"url",value:l,onChange:T=>c(T.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(Jt,{htmlFor:"mod-script",children:"Script Content (Optional)"}),m.jsx(Id,{id:"mod-script",value:u,onChange:T=>d(T.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),m.jsxs(Et,{onClick:_,disabled:h,children:[h&&m.jsx(Hn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),m.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),m.jsx("div",{className:"rounded-md border",children:m.jsx(hr,{delayDuration:100,children:m.jsxs(hm,{children:[m.jsx(jy,{children:m.jsxs(Pi,{children:[m.jsx(pi,{children:"Name"}),m.jsx(pi,{children:"Source"}),m.jsx(pi,{children:"Status"}),m.jsx(pi,{className:"text-center",children:"Enabled"}),m.jsx(pi,{className:"text-right",children:"Actions"})]})}),m.jsx(pm,{children:s?m.jsxs(m.Fragment,{children:[m.jsx(Pi,{children:m.jsx(cr,{colSpan:5,children:m.jsx(Pr,{className:"h-10 w-full"})})}),m.jsx(Pi,{children:m.jsx(cr,{colSpan:5,children:m.jsx(Pr,{className:"h-10 w-full"})})})]}):(i||[]).length===0?m.jsx(Pi,{children:m.jsx(cr,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(i||[]).map(T=>{const{status:R,error:M,tooltip:N}=E(T.id),O=T.sourceUrl?new URL(T.sourceUrl).hostname:"Direct Script",B=y[T.id],P=x[T.id],H=B||P,F=R==="Error";return m.jsxs(Pi,{children:[m.jsx(cr,{className:"font-medium",children:T.name}),m.jsx(cr,{className:"text-muted-foreground",children:O}),m.jsxs(cr,{children:[m.jsxs(mr,{children:[m.jsx(gr,{asChild:!0,children:m.jsx("span",{className:F?"text-destructive font-semibold cursor-help":"",children:R})}),N&&m.jsx(yr,{className:"max-w-xs break-words",children:m.jsx("p",{children:N})})]}),F&&M&&m.jsx("p",{className:"text-xs text-destructive truncate",children:M instanceof Error?M.message:String(M)})]}),m.jsxs(cr,{className:"text-center",children:[m.jsx(Qc,{checked:T.enabled??!1,onCheckedChange:()=>S(T),disabled:H,"aria-label":`Enable ${T.name}`}),B&&m.jsx(Hn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),m.jsx(cr,{className:"text-right",children:m.jsx(Et,{variant:"ghost",size:"icon",onClick:()=>C(T),disabled:H,"aria-label":`Delete ${T.name}`,className:"text-destructive hover:text-destructive/80",children:P?m.jsx(Hn,{className:"h-4 w-4 animate-spin"}):m.jsx(Fo,{className:"h-4 w-4"})})})]},T.id)})})]})})})]})]})},vit=ut.memo(bit);class xit{constructor(){_e(this,"id","core-settings-mods");_e(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:vit,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const wit=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=A.useState(!1),i=A.useCallback(async s=>{if(s.stopPropagation(),n||!t){Fe.info("No content to copy or action disabled.");return}Be.emit(Vl.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return m.jsx(Rn,{tooltipText:"Copy",onClick:i,"aria-label":"Copy content",disabled:n||!t,icon:r?m.jsx(za,{className:"text-green-500"}):m.jsx(Fk,{}),className:"h-5 w-5"})};class _it{constructor(){_e(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?ut.createElement(wit,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const Sit=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Fe.info("Regeneration is currently disabled.");return}Be.emit(Vl.regenerateInteractionRequest,{interactionId:e})};return m.jsx(Rn,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:m.jsx(Ap,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Cit{constructor(){_e(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=On.getState(),s=i.status,a=i.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&s!=="streaming";return ut.createElement(Sit,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const kit=({module:e,interactionId:t,disabled:n})=>{const[r,i]=A.useState(!1),[,s]=A.useState({});A.useEffect(()=>{if(e)return e.setNotifyCallback(()=>s({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){i(!1);return}i(!1),Be.emit(Vl.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Fe.info("Regeneration is currently disabled.");return}i(!r)};return r?m.jsx("div",{className:"relative",children:m.jsx(Z6,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):m.jsx(Rn,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:m.jsx(khe,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class Eit{constructor(){_e(this,"id","core-canvas-regenerate-with-model-action");_e(this,"eventUnsubscribers",[]);_e(this,"notifyComponentUpdate",null);_e(this,"globallyEnabledModels",[]);_e(this,"isLoadingProviders",!0)}async initialize(t){const n=Er.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(ir.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Er.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(ir.initialDataLoaded,()=>{var c;const a=Er.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Xn.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,i,s)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=On.getState(),s=i.status,a=i.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,c=(o==null?void 0:o.id)===r.id&&(r.status==="COMPLETED"||r.status==="ERROR")&&s!=="streaming";return ut.createElement(kit,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const Tit=({interactionId:e,currentRating:t})=>{const n=i=>{const s=i===t?null:i;Be.emit(Xn.rateInteractionRequest,{interactionId:e,rating:s})},r=Array.from({length:11},(i,s)=>s-5);return m.jsx("div",{className:"flex items-center gap-1",children:r.map(i=>{let s="";i===-5?s="Terrible":i===-4?s="Very Bad":i===-3?s="Bad":i===-2?s="Poor":i===-1?s="Below Average":i===0?s="Neutral":i===1?s="Above Average":i===2?s="Good":i===3?s="Very Good":i===4?s="Excellent":i===5&&(s="Perfect");let a="text-muted-foreground",o="hover:text-foreground",l="";i<0?(o="hover:text-red-500",t===i&&(a="text-red-500",l="fill-red-500")):i===0?(o="hover:text-gray-500",t===i&&(a="text-gray-500",l="fill-gray-500")):(o="hover:text-green-500",t===i&&(a="text-green-500",l="fill-green-500"));const c=t===i?"bg-muted":"";return m.jsx(Rn,{tooltipText:s,onClick:()=>n(i),"aria-label":`Rate response as ${s}`,icon:m.jsx(gpe,{className:dt(l,t===i?"fill-current":"fill-none")}),variant:"ghost",className:dt("h-4 w-4 md:h-5 md:w-5 p-0",a,o,c)},i)})})};class Ait{constructor(){_e(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:ut.createElement(Tit,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const Rit=({interactionId:e,response:t,disabled:n})=>{const[r,i]=A.useState(!1),[s,a]=A.useState(""),o=u=>{if(u.stopPropagation(),n){Fe.info("Response editing is currently disabled.");return}a(t||""),i(!0)},l=()=>{if(s.trim()===""){Fe.error("Response cannot be empty");return}Be.emit(Vl.editResponseRequest,{interactionId:e,newContent:s.trim()}),i(!1),Fe.success("Response edited successfully")},c=()=>{i(!1),a("")};return m.jsxs(m.Fragment,{children:[m.jsx(Rn,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:m.jsx(GV,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),m.jsx(Ty,{open:r,onOpenChange:i,children:m.jsxs(Ay,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[m.jsx(Ry,{children:m.jsx(My,{children:"Edit Assistant Response"})}),m.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:m.jsxs("div",{className:"space-y-2 h-full",children:[m.jsx(Jt,{htmlFor:"response-edit",children:"Response Content"}),m.jsx(Id,{id:"response-edit",value:s,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),m.jsxs(Iy,{className:"flex-shrink-0",children:[m.jsx(Et,{variant:"outline",onClick:c,children:"Cancel"}),m.jsx(Et,{onClick:l,children:"Save Changes"})]})]})})]})};class Iit{constructor(){_e(this,"id","core-canvas-edit-response-action");_e(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(Vl.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const i=On.getState(),s=i.interactions.find(y=>y.id===t);if(!s)throw new Error("Original interaction not found");if(s.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=zs(),o={...s,id:a,response:n,parentId:null,index:s.index,metadata:{...s.metadata,editedResponse:!0,editedFromId:s.id},endedAt:new Date};i._addInteractionToState(o);const l=i.interactions.filter(y=>y.parentId===s.id),c=[];let u=s;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=i.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var _,S;const x=((_=y.startedAt)==null?void 0:_.getTime())??0,w=((S=b.startedAt)==null?void 0:S.getTime())??0;return x-w}),h=d.map(async(y,b)=>{const x={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),i._updateInteractionInState(y.id,x),Rt.saveInteraction({...y,...x})}),p=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return i._updateInteractionInState(y.id,b),Rt.saveInteraction({...y,...b})});await Promise.all([Rt.saveInteraction(o),...h,...p]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(i){throw console.error("[EditResponseControlModule] Failed to edit response:",i),i}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=On.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&s!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?ut.createElement(Rit,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const Mit=({context:e})=>{const t=()=>{Fe.info(`Example Canvas Action Clicked! Interaction ID: ${e.interactionId}`)};return m.jsxs(Et,{variant:"outline",size:"sm",onClick:t,className:"h-6 px-2 text-xs",children:[m.jsx(cpe,{className:"h-3 w-3 mr-1"})," Example Action"]})};class Nit{constructor(){_e(this,"id","example-canvas-control-module")}async initialize(t){}register(t){t.registerCanvasControl({id:"example-canvas-action",type:"interaction",targetSlot:"actions",renderer:n=>ut.createElement(Mit,{context:n})})}destroy(t){}}const jit=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=i=>{i.stopPropagation(),t()};return m.jsx(Rn,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?m.jsx(cu,{}):m.jsx(ah,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class Oit{constructor(){_e(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:ut.createElement(jit,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const Pit=({context:e})=>{const t=DE(e.responseContent||""),n=A.useMemo(()=>{const i=[];return t.forEach(s=>{if(typeof s=="object"&&s.type==="code"){const a=s;a.filepath&&a.filepath.trim()&&i.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),i},[t]),r=A.useCallback(async()=>{var i;if(n.length===0){Fe.info("No code blocks with filepaths found to download");return}try{const s=new aP,a=new Set;n.forEach(({filepath:h,code:p})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let _=1;_<b.length;_++){const S=b.slice(0,_).join("/");a.has(S)||(s.folder(S),a.add(S))}let x=y,w=1;for(;s.file(x);){const _=y.lastIndexOf(".");if(_>0){const S=y.substring(0,_),C=y.substring(_);x=`${S}_${w}${C}`}else x=`${y}_${w}`;w++}s.file(x,p)});const o=await s.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((i=e.interactionId)==null?void 0:i.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),Fe.success(`Downloaded ${n.length} code files as ZIP`)}catch(s){console.error("ZIP download failed:",s),Fe.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:m.jsx(Rn,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:m.jsx(PV,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class Dit{constructor(){_e(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:ut.createElement(Pit,{context:n})})}destroy(t){}}const Fit=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:i})=>{const[s,a]=A.useState(!1),o=A.useCallback(async l=>{l.stopPropagation(),!(i||!r)&&(Be.emit(Vl.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,i]);return m.jsx(Rn,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:i||!r,icon:s?m.jsx(za,{className:"text-green-500"}):m.jsx(Fk,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class Lit{constructor(){_e(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>ut.createElement(Fit,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const Bit=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return m.jsx(Rn,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:m.jsx(Pk,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class $it{constructor(){_e(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:ut.createElement(Bit,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const zit=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:i,disabled:s})=>{const a=A.useCallback(l=>{if(l.stopPropagation(),!(s||!r))try{let c;if(i){const p=i.split("/");c=p[p.length-1]}else c=`code${Uit(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),Fe.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),Fe.error("Failed to download file")}},[e,t,n,r,i,s]),o=i||r&&r.trim().length>5e3;return console.log("shouldShow",o,r.trim().length),o?m.jsx(Rn,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:s||!r,icon:m.jsx(Gc,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function Uit(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class qit{constructor(){_e(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>ut.createElement(zit,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const Vit=({toolCall:e})=>{const[t,n]=A.useState(!0),r=()=>n(s=>!s),i=A.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return m.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",m.jsx("code",{className:"font-mono",children:e.toolName})]}),m.jsx(Rn,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?m.jsx(cu,{}):m.jsx(ah,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&m.jsx(ty,{lang:"json",code:i})]})},Hit=({toolResult:e})=>{const[t,n]=A.useState(!0),r=()=>n(a=>!a),i=A.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),s=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return m.jsxs("div",{className:dt("my-2 p-2 border rounded-md text-xs",s?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[m.jsxs("div",{className:"flex items-center justify-between mb-1",children:[m.jsxs("span",{className:dt("font-semibold",s?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",m.jsx("code",{className:"font-mono",children:e.toolName})]}),m.jsx(Rn,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?m.jsx(cu,{}):m.jsx(ah,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&m.jsx(ty,{lang:s?"text":"json",code:i})]})},Wit=({interactionId:e,toolCall:t,toolResult:n})=>m.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[m.jsx(Vit,{toolCall:t}),n&&m.jsx(Hit,{toolResult:n})]});class Git{constructor(){_e(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):ut.createElement(Wit,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const Kit=[Ptt,qtt,Ztt,Qrt,fit,yit,xit,MZe,gXe,pXe,itt,stt,jtt,htt,mtt,ytt,Ftt,qXe,zQe,Mtt,ott,_et,BXe,utt,Btt,ret,set,het,vet,_it,Oit,Dit,Cit,Eit,Iit,Ait,Lit,$it,qit,Nit,Git];function Yit(){return m.jsxs(TZe,{children:[m.jsx(kZe,{}),m.jsx(CZe,{}),m.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:m.jsx("main",{className:"flex-grow overflow-hidden",children:m.jsx(bZe,{controls:Kit})})})]})}Hpe();cde.createRoot(document.getElementById("root")).render(m.jsx(ut.StrictMode,{children:m.jsx(Yit,{})}));export{BOe as $,Nv as A,GIe as B,BMe as C,uD as D,ho as E,AZ as F,P6e as G,GFe as H,m7 as I,GNe as J,tMe as K,j0 as L,kst as M,eT as N,RP as O,az as P,qOe as Q,d2 as R,O6e as S,u1 as T,TMe as U,c1 as V,bn as W,Nn as X,LZ as Y,E6e as Z,ie as _,jMe as a,bIe as a$,ZP as a0,Mst as a1,Ost as a2,fg as a3,jz as a4,Nz as a5,Dst as a6,Pst as a7,jst as a8,Rst as a9,_6e as aA,pDe as aB,m6e as aC,tD as aD,S7 as aE,E5e as aF,$Oe as aG,aa as aH,qE as aI,y3e as aJ,g3e as aK,lm as aL,S6e as aM,AQ as aN,YE as aO,QE as aP,QC as aQ,IQ as aR,TQ as aS,QDe as aT,lo as aU,f4e as aV,HP as aW,PJ as aX,h1 as aY,LJ as aZ,Ast as a_,Ist as aa,Lst as ab,Nst as ac,Fst as ad,Q5e as ae,Nte as af,Vst as ag,YNe as ah,Es as ai,vh as aj,UP as ak,aee as al,dm as am,DQ as an,er as ao,su as ap,Ig as aq,VFe as ar,qst as as,Hst as at,zst as au,kn as av,Ust as aw,EFe as ax,_Fe as ay,wFe as az,NMe as b,WP as b0,_f as b1,Ez as b2,v4e as b3,Wx as b4,w6e as b5,p6e as b6,tDe as b7,nD as b8,YDe as b9,es as bA,zr as bB,k6e as ba,m1 as bb,yy as bc,ZC as bd,a6e as be,p8e as bf,p1 as bg,JC as bh,e6e as bi,wQ as bj,iDe as bk,sDe as bl,ip as bm,Kz as bn,aDe as bo,rD as bp,rDe as bq,cDe as br,by as bs,bh as bt,qz as bu,iD as bv,SQ as bw,Zj as bx,C6e as by,JE as bz,Xr as c,Lr as d,FZ as e,ra as f,PMe as g,vd as h,Lp as i,w3e as j,gy as k,Lt as l,LQ as m,Est as n,Gst as o,DMe as p,FMe as q,Wst as r,OMe as s,KNe as t,Uc as u,bFe as v,L6e as w,Bst as x,MMe as y,Tst as z};
